
Load Dataset
label column: label
label dictionary: {'Normal': 0, '19DEL': 1, 'L858R': 2, 'Other': 3, 'Wild': 4}
number of classes: 5
slide-level counts:  
 label
0    163
2    183
3    138
1    116
4    142
Name: count, dtype: int64
Patient-LVL; Number of samples registered in class 0: 163
Slide-LVL; Number of samples registered in class 0: 163
Patient-LVL; Number of samples registered in class 1: 116
Slide-LVL; Number of samples registered in class 1: 116
Patient-LVL; Number of samples registered in class 2: 183
Slide-LVL; Number of samples registered in class 2: 183
Patient-LVL; Number of samples registered in class 3: 138
Slide-LVL; Number of samples registered in class 3: 138
Patient-LVL; Number of samples registered in class 4: 142
Slide-LVL; Number of samples registered in class 4: 142
split_dir:  /home/graduate2024/code/baseline/CLAM-master/splits/EGFR_Five_subtyping_fengru_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  EGFR_Five_subtyping_fengru
max_epochs:  200
results_dir:  /home/graduate2024/code/baseline/CLAM-master/results/EGFR_only_Res3x2_UNI_d1024
lr:  0.0002
experiment:  EGFR_only_Res3x2_fengru
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_mb
model_size:  small
use_drop_out:  0.25
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  /home/graduate2024/code/baseline/CLAM-master/splits/EGFR_Five_subtyping_fengru_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0010, instance_loss: 0.6025, weighted_loss: 1.5815, label: 1, bag_size: 355
batch 39, loss: 2.4495, instance_loss: 0.5169, weighted_loss: 1.8697, label: 2, bag_size: 219
batch 59, loss: 1.8706, instance_loss: 0.5069, weighted_loss: 1.4615, label: 3, bag_size: 312
batch 79, loss: 0.9983, instance_loss: 0.5544, weighted_loss: 0.8651, label: 1, bag_size: 855
batch 99, loss: 2.3790, instance_loss: 0.5712, weighted_loss: 1.8366, label: 2, bag_size: 331
batch 119, loss: 0.5207, instance_loss: 0.4480, weighted_loss: 0.4989, label: 3, bag_size: 894
batch 139, loss: 1.0620, instance_loss: 0.5426, weighted_loss: 0.9062, label: 2, bag_size: 1975
batch 159, loss: 2.6544, instance_loss: 0.5383, weighted_loss: 2.0196, label: 2, bag_size: 363
batch 179, loss: 1.4094, instance_loss: 0.5417, weighted_loss: 1.1491, label: 3, bag_size: 272
batch 199, loss: 1.8619, instance_loss: 0.5943, weighted_loss: 1.4816, label: 2, bag_size: 350
batch 219, loss: 0.9027, instance_loss: 0.4886, weighted_loss: 0.7784, label: 0, bag_size: 581
batch 239, loss: 1.1727, instance_loss: 0.4914, weighted_loss: 0.9683, label: 4, bag_size: 730
batch 259, loss: 2.0450, instance_loss: 0.5647, weighted_loss: 1.6009, label: 0, bag_size: 581
batch 279, loss: 1.6023, instance_loss: 0.4855, weighted_loss: 1.2673, label: 4, bag_size: 769
batch 299, loss: 0.1176, instance_loss: 0.3678, weighted_loss: 0.1926, label: 0, bag_size: 258
batch 319, loss: 1.4846, instance_loss: 0.5741, weighted_loss: 1.2114, label: 3, bag_size: 393
batch 339, loss: 1.5614, instance_loss: 0.4591, weighted_loss: 1.2307, label: 1, bag_size: 397
batch 359, loss: 1.6085, instance_loss: 0.4920, weighted_loss: 1.2736, label: 4, bag_size: 563
batch 379, loss: 1.5113, instance_loss: 0.5033, weighted_loss: 1.2089, label: 2, bag_size: 953
batch 399, loss: 0.6678, instance_loss: 0.4329, weighted_loss: 0.5973, label: 0, bag_size: 77
batch 419, loss: 2.2044, instance_loss: 0.6197, weighted_loss: 1.7290, label: 1, bag_size: 391
batch 439, loss: 1.1516, instance_loss: 0.4920, weighted_loss: 0.9537, label: 0, bag_size: 615
batch 459, loss: 0.7655, instance_loss: 0.4215, weighted_loss: 0.6623, label: 1, bag_size: 960
batch 479, loss: 3.7035, instance_loss: 0.4738, weighted_loss: 2.7346, label: 0, bag_size: 62
batch 499, loss: 3.0280, instance_loss: 0.6040, weighted_loss: 2.3008, label: 3, bag_size: 282
batch 519, loss: 1.1251, instance_loss: 0.4027, weighted_loss: 0.9084, label: 1, bag_size: 605
batch 539, loss: 1.1225, instance_loss: 0.4991, weighted_loss: 0.9355, label: 3, bag_size: 309
batch 559, loss: 1.8112, instance_loss: 0.5378, weighted_loss: 1.4292, label: 4, bag_size: 690
batch 579, loss: 1.1974, instance_loss: 0.5290, weighted_loss: 0.9969, label: 2, bag_size: 376


class 0 clustering acc 0.9988636363636364: correct 23733/23760
class 1 clustering acc 0.001473063973063973: correct 7/4752
Epoch: 0, train_loss: 1.5155, train_clustering_loss:  0.5127, train_error: 0.6279
class 0: acc 0.7192982456140351, correct 82/114
class 1: acc 0.4230769230769231, correct 55/130
class 2: acc 0.18803418803418803, correct 22/117
class 3: acc 0.27350427350427353, correct 32/117
class 4: acc 0.25862068965517243, correct 30/116

Val Set, val_loss: 1.3764, val_error: 0.5811, auc: 0.6999
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.376370).  Saving model ...


batch 19, loss: 1.6781, instance_loss: 0.6031, weighted_loss: 1.3556, label: 3, bag_size: 872
batch 39, loss: 0.1968, instance_loss: 0.3804, weighted_loss: 0.2519, label: 0, bag_size: 578
batch 59, loss: 1.0236, instance_loss: 0.4309, weighted_loss: 0.8458, label: 0, bag_size: 428
batch 79, loss: 1.4830, instance_loss: 0.4607, weighted_loss: 1.1763, label: 2, bag_size: 519
batch 99, loss: 1.1900, instance_loss: 0.5280, weighted_loss: 0.9914, label: 2, bag_size: 860
batch 119, loss: 1.0569, instance_loss: 0.4018, weighted_loss: 0.8604, label: 1, bag_size: 398
batch 139, loss: 1.0910, instance_loss: 0.4242, weighted_loss: 0.8910, label: 1, bag_size: 381
batch 159, loss: 1.5384, instance_loss: 0.5302, weighted_loss: 1.2359, label: 4, bag_size: 853
batch 179, loss: 2.7068, instance_loss: 0.6341, weighted_loss: 2.0850, label: 0, bag_size: 492
batch 199, loss: 0.3994, instance_loss: 0.3276, weighted_loss: 0.3779, label: 0, bag_size: 73
batch 219, loss: 0.3775, instance_loss: 0.3670, weighted_loss: 0.3743, label: 0, bag_size: 190
batch 239, loss: 2.5704, instance_loss: 0.5969, weighted_loss: 1.9783, label: 2, bag_size: 607
batch 259, loss: 2.1458, instance_loss: 0.5352, weighted_loss: 1.6626, label: 1, bag_size: 697
batch 279, loss: 1.0410, instance_loss: 0.4553, weighted_loss: 0.8653, label: 0, bag_size: 888
batch 299, loss: 1.5290, instance_loss: 0.5286, weighted_loss: 1.2289, label: 3, bag_size: 282
batch 319, loss: 4.0907, instance_loss: 0.6309, weighted_loss: 3.0527, label: 0, bag_size: 732
batch 339, loss: 0.1098, instance_loss: 0.3136, weighted_loss: 0.1709, label: 0, bag_size: 425
batch 359, loss: 1.1411, instance_loss: 0.4783, weighted_loss: 0.9423, label: 4, bag_size: 503
batch 379, loss: 2.0497, instance_loss: 0.5520, weighted_loss: 1.6004, label: 3, bag_size: 638
batch 399, loss: 1.5316, instance_loss: 0.5183, weighted_loss: 1.2276, label: 4, bag_size: 1031
batch 419, loss: 1.2753, instance_loss: 0.4925, weighted_loss: 1.0404, label: 1, bag_size: 371
batch 439, loss: 1.9919, instance_loss: 0.5932, weighted_loss: 1.5723, label: 4, bag_size: 604
batch 459, loss: 3.4749, instance_loss: 0.5237, weighted_loss: 2.5895, label: 0, bag_size: 62
batch 479, loss: 1.1572, instance_loss: 0.5000, weighted_loss: 0.9600, label: 4, bag_size: 687
batch 499, loss: 1.4285, instance_loss: 0.5552, weighted_loss: 1.1665, label: 0, bag_size: 277
batch 519, loss: 1.2792, instance_loss: 0.4481, weighted_loss: 1.0298, label: 2, bag_size: 394
batch 539, loss: 0.1391, instance_loss: 0.3176, weighted_loss: 0.1927, label: 0, bag_size: 350
batch 559, loss: 1.6953, instance_loss: 0.6036, weighted_loss: 1.3678, label: 3, bag_size: 1060
batch 579, loss: 1.1601, instance_loss: 0.4550, weighted_loss: 0.9486, label: 2, bag_size: 315


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.00021043771043771043: correct 1/4752
Epoch: 1, train_loss: 1.4276, train_clustering_loss:  0.5011, train_error: 0.6566
class 0: acc 0.7563025210084033, correct 90/119
class 1: acc 0.10852713178294573, correct 14/129
class 2: acc 0.29464285714285715, correct 33/112
class 3: acc 0.3333333333333333, correct 42/126
class 4: acc 0.23148148148148148, correct 25/108

Val Set, val_loss: 1.3846, val_error: 0.6486, auc: 0.7044
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9706, instance_loss: 0.4848, weighted_loss: 0.8248, label: 3, bag_size: 488
batch 39, loss: 1.1041, instance_loss: 0.3959, weighted_loss: 0.8916, label: 1, bag_size: 410
batch 59, loss: 2.3353, instance_loss: 0.5712, weighted_loss: 1.8060, label: 2, bag_size: 317
batch 79, loss: 0.1338, instance_loss: 0.2859, weighted_loss: 0.1794, label: 0, bag_size: 79
batch 99, loss: 0.6866, instance_loss: 0.5084, weighted_loss: 0.6332, label: 4, bag_size: 618
batch 119, loss: 1.8317, instance_loss: 0.4957, weighted_loss: 1.4309, label: 1, bag_size: 391
batch 139, loss: 1.2012, instance_loss: 0.4657, weighted_loss: 0.9806, label: 3, bag_size: 369
batch 159, loss: 1.2446, instance_loss: 0.4624, weighted_loss: 1.0100, label: 4, bag_size: 520
batch 179, loss: 1.7810, instance_loss: 0.5344, weighted_loss: 1.4070, label: 1, bag_size: 389
batch 199, loss: 1.6185, instance_loss: 0.5247, weighted_loss: 1.2903, label: 1, bag_size: 1121
batch 219, loss: 2.8771, instance_loss: 0.7217, weighted_loss: 2.2305, label: 0, bag_size: 1073
batch 239, loss: 0.9031, instance_loss: 0.3859, weighted_loss: 0.7480, label: 4, bag_size: 318
batch 259, loss: 1.2804, instance_loss: 0.5258, weighted_loss: 1.0540, label: 3, bag_size: 393
batch 279, loss: 1.9153, instance_loss: 0.4862, weighted_loss: 1.4866, label: 1, bag_size: 490
batch 299, loss: 3.5373, instance_loss: 0.8114, weighted_loss: 2.7195, label: 0, bag_size: 352
batch 319, loss: 1.5006, instance_loss: 0.7221, weighted_loss: 1.2671, label: 3, bag_size: 543
batch 339, loss: 2.2965, instance_loss: 0.5847, weighted_loss: 1.7830, label: 4, bag_size: 363
batch 359, loss: 0.7126, instance_loss: 0.4025, weighted_loss: 0.6195, label: 1, bag_size: 522
batch 379, loss: 1.1355, instance_loss: 0.4449, weighted_loss: 0.9283, label: 3, bag_size: 858
batch 399, loss: 2.6744, instance_loss: 0.7543, weighted_loss: 2.0984, label: 2, bag_size: 445
batch 419, loss: 1.8116, instance_loss: 0.5858, weighted_loss: 1.4439, label: 4, bag_size: 468
batch 439, loss: 0.0424, instance_loss: 0.2350, weighted_loss: 0.1002, label: 0, bag_size: 255
batch 459, loss: 1.2374, instance_loss: 0.4651, weighted_loss: 1.0057, label: 2, bag_size: 633
batch 479, loss: 1.5502, instance_loss: 0.5695, weighted_loss: 1.2559, label: 4, bag_size: 699
batch 499, loss: 3.1742, instance_loss: 0.6214, weighted_loss: 2.4083, label: 4, bag_size: 270
batch 519, loss: 0.1794, instance_loss: 0.2586, weighted_loss: 0.2031, label: 0, bag_size: 282
batch 539, loss: 1.3852, instance_loss: 0.5508, weighted_loss: 1.1349, label: 3, bag_size: 453
batch 559, loss: 1.8204, instance_loss: 0.5186, weighted_loss: 1.4298, label: 2, bag_size: 953
batch 579, loss: 3.2515, instance_loss: 0.7768, weighted_loss: 2.5091, label: 0, bag_size: 587


class 0 clustering acc 0.9982744107744108: correct 23719/23760
class 1 clustering acc 0.037247474747474744: correct 177/4752
Epoch: 2, train_loss: 1.3543, train_clustering_loss:  0.4858, train_error: 0.6027
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.27419354838709675, correct 34/124
class 2: acc 0.17272727272727273, correct 19/110
class 3: acc 0.38016528925619836, correct 46/121
class 4: acc 0.3559322033898305, correct 42/118

Val Set, val_loss: 1.4157, val_error: 0.6892, auc: 0.7069
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.1009, instance_loss: 0.5980, weighted_loss: 1.6500, label: 2, bag_size: 769
batch 39, loss: 1.5217, instance_loss: 0.7484, weighted_loss: 1.2897, label: 2, bag_size: 208
batch 59, loss: 0.0484, instance_loss: 0.2629, weighted_loss: 0.1128, label: 0, bag_size: 258
batch 79, loss: 2.0663, instance_loss: 0.6782, weighted_loss: 1.6499, label: 3, bag_size: 98
batch 99, loss: 1.7539, instance_loss: 0.5208, weighted_loss: 1.3840, label: 1, bag_size: 397
batch 119, loss: 2.3411, instance_loss: 0.6502, weighted_loss: 1.8339, label: 3, bag_size: 533
batch 139, loss: 1.7051, instance_loss: 0.5008, weighted_loss: 1.3438, label: 2, bag_size: 720
batch 159, loss: 1.7396, instance_loss: 0.5377, weighted_loss: 1.3791, label: 4, bag_size: 944
batch 179, loss: 0.9492, instance_loss: 0.4863, weighted_loss: 0.8104, label: 3, bag_size: 309
batch 199, loss: 1.1298, instance_loss: 0.5079, weighted_loss: 0.9433, label: 3, bag_size: 282
batch 219, loss: 1.5455, instance_loss: 0.5216, weighted_loss: 1.2383, label: 4, bag_size: 744
batch 239, loss: 1.3148, instance_loss: 0.4207, weighted_loss: 1.0466, label: 1, bag_size: 591
batch 259, loss: 1.6690, instance_loss: 0.5695, weighted_loss: 1.3391, label: 3, bag_size: 1060
batch 279, loss: 0.8751, instance_loss: 0.4979, weighted_loss: 0.7619, label: 3, bag_size: 498
batch 299, loss: 0.8657, instance_loss: 0.4398, weighted_loss: 0.7379, label: 3, bag_size: 1021
batch 319, loss: 1.3712, instance_loss: 0.5175, weighted_loss: 1.1151, label: 1, bag_size: 616
batch 339, loss: 1.0863, instance_loss: 0.4050, weighted_loss: 0.8819, label: 0, bag_size: 277
batch 359, loss: 1.3635, instance_loss: 0.4957, weighted_loss: 1.1031, label: 4, bag_size: 589
batch 379, loss: 1.1601, instance_loss: 0.4617, weighted_loss: 0.9506, label: 1, bag_size: 892
batch 399, loss: 1.2169, instance_loss: 0.4370, weighted_loss: 0.9829, label: 1, bag_size: 544
batch 419, loss: 1.7330, instance_loss: 0.5737, weighted_loss: 1.3852, label: 3, bag_size: 192
batch 439, loss: 2.5970, instance_loss: 0.6493, weighted_loss: 2.0127, label: 0, bag_size: 352
batch 459, loss: 1.5886, instance_loss: 0.5587, weighted_loss: 1.2797, label: 3, bag_size: 476
batch 479, loss: 0.0966, instance_loss: 0.2680, weighted_loss: 0.1480, label: 0, bag_size: 295
batch 499, loss: 1.0110, instance_loss: 0.4813, weighted_loss: 0.8521, label: 3, bag_size: 272
batch 519, loss: 1.3973, instance_loss: 0.4545, weighted_loss: 1.1145, label: 2, bag_size: 572
batch 539, loss: 1.1621, instance_loss: 0.4217, weighted_loss: 0.9400, label: 1, bag_size: 892
batch 559, loss: 1.7009, instance_loss: 0.5436, weighted_loss: 1.3537, label: 3, bag_size: 857
batch 579, loss: 0.4693, instance_loss: 0.4145, weighted_loss: 0.4529, label: 4, bag_size: 773


class 0 clustering acc 0.9984006734006734: correct 23722/23760
class 1 clustering acc 0.026094276094276093: correct 124/4752
Epoch: 3, train_loss: 1.3419, train_clustering_loss:  0.4882, train_error: 0.6044
class 0: acc 0.7322834645669292, correct 93/127
class 1: acc 0.211864406779661, correct 25/118
class 2: acc 0.33858267716535434, correct 43/127
class 3: acc 0.2920353982300885, correct 33/113
class 4: acc 0.3761467889908257, correct 41/109

Val Set, val_loss: 1.6663, val_error: 0.6486, auc: 0.6889
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.15202702702702703: correct 90/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6147, instance_loss: 0.6016, weighted_loss: 1.3108, label: 4, bag_size: 937
batch 39, loss: 0.3523, instance_loss: 0.3315, weighted_loss: 0.3461, label: 0, bag_size: 49
batch 59, loss: 1.8118, instance_loss: 0.5314, weighted_loss: 1.4277, label: 1, bag_size: 599
batch 79, loss: 2.2682, instance_loss: 0.6499, weighted_loss: 1.7827, label: 1, bag_size: 177
batch 99, loss: 2.2646, instance_loss: 0.6388, weighted_loss: 1.7769, label: 4, bag_size: 359
batch 119, loss: 0.2043, instance_loss: 0.2705, weighted_loss: 0.2242, label: 0, bag_size: 258
batch 139, loss: 1.8014, instance_loss: 0.5341, weighted_loss: 1.4212, label: 4, bag_size: 244
batch 159, loss: 1.1053, instance_loss: 0.4397, weighted_loss: 0.9057, label: 4, bag_size: 687
batch 179, loss: 3.0954, instance_loss: 0.6627, weighted_loss: 2.3656, label: 0, bag_size: 283
batch 199, loss: 1.7356, instance_loss: 0.5715, weighted_loss: 1.3863, label: 1, bag_size: 949
batch 219, loss: 1.3495, instance_loss: 0.4212, weighted_loss: 1.0710, label: 4, bag_size: 1031
batch 239, loss: 1.0394, instance_loss: 0.5100, weighted_loss: 0.8806, label: 2, bag_size: 596
batch 259, loss: 1.6481, instance_loss: 0.5154, weighted_loss: 1.3082, label: 1, bag_size: 1009
batch 279, loss: 1.2228, instance_loss: 0.4740, weighted_loss: 0.9981, label: 0, bag_size: 888
batch 299, loss: 1.4751, instance_loss: 0.5385, weighted_loss: 1.1941, label: 1, bag_size: 525
batch 319, loss: 2.1717, instance_loss: 0.5632, weighted_loss: 1.6892, label: 3, bag_size: 818
batch 339, loss: 1.3627, instance_loss: 0.4722, weighted_loss: 1.0955, label: 4, bag_size: 113
batch 359, loss: 1.4730, instance_loss: 0.5144, weighted_loss: 1.1854, label: 2, bag_size: 799
batch 379, loss: 1.1456, instance_loss: 0.4406, weighted_loss: 0.9341, label: 4, bag_size: 689
batch 399, loss: 1.3921, instance_loss: 0.4772, weighted_loss: 1.1176, label: 4, bag_size: 363
batch 419, loss: 1.3479, instance_loss: 0.5801, weighted_loss: 1.1176, label: 2, bag_size: 96
batch 439, loss: 2.0135, instance_loss: 0.6501, weighted_loss: 1.6045, label: 4, bag_size: 690
batch 459, loss: 1.6994, instance_loss: 0.5487, weighted_loss: 1.3542, label: 4, bag_size: 590
batch 479, loss: 1.1388, instance_loss: 0.4863, weighted_loss: 0.9430, label: 4, bag_size: 574
batch 499, loss: 1.2425, instance_loss: 0.4696, weighted_loss: 1.0107, label: 3, bag_size: 230
batch 519, loss: 2.6519, instance_loss: 0.6640, weighted_loss: 2.0555, label: 1, bag_size: 272
batch 539, loss: 1.4192, instance_loss: 0.5429, weighted_loss: 1.1563, label: 3, bag_size: 1057
batch 559, loss: 1.6081, instance_loss: 0.5435, weighted_loss: 1.2887, label: 3, bag_size: 301
batch 579, loss: 1.8714, instance_loss: 0.6228, weighted_loss: 1.4968, label: 4, bag_size: 277


class 0 clustering acc 0.9968013468013468: correct 23684/23760
class 1 clustering acc 0.026936026936026935: correct 128/4752
Epoch: 4, train_loss: 1.3882, train_clustering_loss:  0.4945, train_error: 0.6313
class 0: acc 0.775, correct 93/120
class 1: acc 0.05555555555555555, correct 6/108
class 2: acc 0.3235294117647059, correct 44/136
class 3: acc 0.2641509433962264, correct 28/106
class 4: acc 0.3870967741935484, correct 48/124

Val Set, val_loss: 1.3606, val_error: 0.5811, auc: 0.7212
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.376370 --> 1.360599).  Saving model ...


batch 19, loss: 2.4425, instance_loss: 0.6211, weighted_loss: 1.8961, label: 0, bag_size: 115
batch 39, loss: 0.9015, instance_loss: 0.4268, weighted_loss: 0.7591, label: 2, bag_size: 783
batch 59, loss: 0.0747, instance_loss: 0.2273, weighted_loss: 0.1205, label: 0, bag_size: 282
batch 79, loss: 1.0728, instance_loss: 0.4604, weighted_loss: 0.8891, label: 3, bag_size: 102
batch 99, loss: 1.7077, instance_loss: 0.5129, weighted_loss: 1.3493, label: 2, bag_size: 317
batch 119, loss: 1.3857, instance_loss: 0.4425, weighted_loss: 1.1027, label: 3, bag_size: 344
batch 139, loss: 0.9360, instance_loss: 0.4704, weighted_loss: 0.7963, label: 1, bag_size: 874
batch 159, loss: 0.8787, instance_loss: 0.4080, weighted_loss: 0.7375, label: 3, bag_size: 473
batch 179, loss: 1.2024, instance_loss: 0.4662, weighted_loss: 0.9816, label: 1, bag_size: 460
batch 199, loss: 1.6847, instance_loss: 0.5035, weighted_loss: 1.3304, label: 2, bag_size: 953
batch 219, loss: 1.1604, instance_loss: 0.4510, weighted_loss: 0.9475, label: 2, bag_size: 348
batch 239, loss: 1.8084, instance_loss: 0.4910, weighted_loss: 1.4132, label: 2, bag_size: 361
batch 259, loss: 2.0742, instance_loss: 0.6420, weighted_loss: 1.6445, label: 1, bag_size: 272
batch 279, loss: 1.6049, instance_loss: 0.5478, weighted_loss: 1.2878, label: 1, bag_size: 1023
batch 299, loss: 1.4327, instance_loss: 0.5547, weighted_loss: 1.1693, label: 2, bag_size: 554
batch 319, loss: 0.3571, instance_loss: 0.2727, weighted_loss: 0.3318, label: 0, bag_size: 281
batch 339, loss: 1.3967, instance_loss: 0.4946, weighted_loss: 1.1261, label: 2, bag_size: 285
batch 359, loss: 1.4472, instance_loss: 0.4840, weighted_loss: 1.1582, label: 2, bag_size: 135
batch 379, loss: 2.0338, instance_loss: 0.6175, weighted_loss: 1.6089, label: 3, bag_size: 598
batch 399, loss: 1.9120, instance_loss: 0.5816, weighted_loss: 1.5128, label: 4, bag_size: 312
batch 419, loss: 0.2734, instance_loss: 0.2082, weighted_loss: 0.2538, label: 0, bag_size: 573
batch 439, loss: 2.5286, instance_loss: 0.7002, weighted_loss: 1.9801, label: 4, bag_size: 476
batch 459, loss: 1.4656, instance_loss: 0.5471, weighted_loss: 1.1900, label: 4, bag_size: 712
batch 479, loss: 1.7479, instance_loss: 0.4734, weighted_loss: 1.3655, label: 2, bag_size: 936
batch 499, loss: 1.5050, instance_loss: 0.4816, weighted_loss: 1.1980, label: 1, bag_size: 1121
batch 519, loss: 0.9362, instance_loss: 0.4085, weighted_loss: 0.7779, label: 1, bag_size: 892
batch 539, loss: 1.6224, instance_loss: 0.5687, weighted_loss: 1.3063, label: 4, bag_size: 228
batch 559, loss: 0.7252, instance_loss: 0.4422, weighted_loss: 0.6403, label: 2, bag_size: 1975
batch 579, loss: 2.0003, instance_loss: 0.5950, weighted_loss: 1.5787, label: 0, bag_size: 435


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.03598484848484849: correct 171/4752
Epoch: 5, train_loss: 1.3438, train_clustering_loss:  0.4885, train_error: 0.5724
class 0: acc 0.736, correct 92/125
class 1: acc 0.26666666666666666, correct 32/120
class 2: acc 0.3225806451612903, correct 40/124
class 3: acc 0.5083333333333333, correct 61/120
class 4: acc 0.2761904761904762, correct 29/105

Val Set, val_loss: 1.3805, val_error: 0.6216, auc: 0.6874
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8691, instance_loss: 0.5530, weighted_loss: 1.4743, label: 1, bag_size: 231
batch 39, loss: 0.2472, instance_loss: 0.2716, weighted_loss: 0.2545, label: 0, bag_size: 399
batch 59, loss: 1.5886, instance_loss: 0.5095, weighted_loss: 1.2649, label: 2, bag_size: 315
batch 79, loss: 0.9817, instance_loss: 0.4366, weighted_loss: 0.8181, label: 3, bag_size: 797
batch 99, loss: 0.8276, instance_loss: 0.4592, weighted_loss: 0.7171, label: 4, bag_size: 683
batch 119, loss: 1.5159, instance_loss: 0.5035, weighted_loss: 1.2122, label: 1, bag_size: 361
batch 139, loss: 0.6517, instance_loss: 0.5666, weighted_loss: 0.6262, label: 0, bag_size: 306
batch 159, loss: 1.6153, instance_loss: 0.5046, weighted_loss: 1.2821, label: 2, bag_size: 558
batch 179, loss: 1.9317, instance_loss: 0.5181, weighted_loss: 1.5076, label: 3, bag_size: 301
batch 199, loss: 1.2021, instance_loss: 0.4725, weighted_loss: 0.9833, label: 2, bag_size: 812
batch 219, loss: 0.1310, instance_loss: 0.2264, weighted_loss: 0.1596, label: 0, bag_size: 366
batch 239, loss: 1.5797, instance_loss: 0.4532, weighted_loss: 1.2418, label: 1, bag_size: 544
batch 259, loss: 4.1255, instance_loss: 0.8128, weighted_loss: 3.1317, label: 0, bag_size: 169
batch 279, loss: 1.8355, instance_loss: 0.5402, weighted_loss: 1.4469, label: 4, bag_size: 266
batch 299, loss: 1.0332, instance_loss: 0.4883, weighted_loss: 0.8697, label: 4, bag_size: 730
batch 319, loss: 1.2834, instance_loss: 0.4843, weighted_loss: 1.0437, label: 1, bag_size: 865
batch 339, loss: 0.0834, instance_loss: 0.2558, weighted_loss: 0.1351, label: 0, bag_size: 188
batch 359, loss: 0.5616, instance_loss: 0.3390, weighted_loss: 0.4948, label: 0, bag_size: 73
batch 379, loss: 0.9584, instance_loss: 0.5151, weighted_loss: 0.8254, label: 1, bag_size: 371
batch 399, loss: 2.4191, instance_loss: 0.6197, weighted_loss: 1.8792, label: 3, bag_size: 897
batch 419, loss: 1.2890, instance_loss: 0.6070, weighted_loss: 1.0844, label: 3, bag_size: 496
batch 439, loss: 2.0086, instance_loss: 0.6464, weighted_loss: 1.6000, label: 4, bag_size: 572
batch 459, loss: 1.2171, instance_loss: 0.5032, weighted_loss: 1.0029, label: 2, bag_size: 96
batch 479, loss: 1.3393, instance_loss: 0.4897, weighted_loss: 1.0844, label: 2, bag_size: 597
batch 499, loss: 1.6236, instance_loss: 0.5312, weighted_loss: 1.2959, label: 1, bag_size: 328
batch 519, loss: 1.1852, instance_loss: 0.4491, weighted_loss: 0.9643, label: 2, bag_size: 369
batch 539, loss: 1.0342, instance_loss: 0.5526, weighted_loss: 0.8897, label: 4, bag_size: 729
batch 559, loss: 1.5562, instance_loss: 0.5523, weighted_loss: 1.2551, label: 3, bag_size: 533
batch 579, loss: 1.7043, instance_loss: 0.4692, weighted_loss: 1.3338, label: 3, bag_size: 1021


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.058712121212121215: correct 279/4752
Epoch: 6, train_loss: 1.3206, train_clustering_loss:  0.4872, train_error: 0.5724
class 0: acc 0.7777777777777778, correct 98/126
class 1: acc 0.28448275862068967, correct 33/116
class 2: acc 0.25892857142857145, correct 29/112
class 3: acc 0.3445378151260504, correct 41/119
class 4: acc 0.4380165289256198, correct 53/121

Val Set, val_loss: 1.3429, val_error: 0.5946, auc: 0.7286
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.07142857142857142, correct 1/14
Validation loss decreased (1.360599 --> 1.342916).  Saving model ...


batch 19, loss: 0.0727, instance_loss: 0.1871, weighted_loss: 0.1070, label: 0, bag_size: 255
batch 39, loss: 0.7566, instance_loss: 0.4585, weighted_loss: 0.6671, label: 3, bag_size: 309
batch 59, loss: 2.1812, instance_loss: 0.7294, weighted_loss: 1.7457, label: 3, bag_size: 156
batch 79, loss: 3.6911, instance_loss: 0.7206, weighted_loss: 2.7999, label: 0, bag_size: 367
batch 99, loss: 3.3698, instance_loss: 0.6273, weighted_loss: 2.5470, label: 4, bag_size: 264
batch 119, loss: 0.8303, instance_loss: 0.4052, weighted_loss: 0.7027, label: 1, bag_size: 1103
batch 139, loss: 1.1798, instance_loss: 0.4687, weighted_loss: 0.9665, label: 0, bag_size: 615
batch 159, loss: 1.6703, instance_loss: 0.5124, weighted_loss: 1.3229, label: 1, bag_size: 823
batch 179, loss: 0.9606, instance_loss: 0.4398, weighted_loss: 0.8044, label: 2, bag_size: 783
batch 199, loss: 1.6700, instance_loss: 0.4842, weighted_loss: 1.3142, label: 2, bag_size: 1608
batch 219, loss: 1.7152, instance_loss: 0.5766, weighted_loss: 1.3736, label: 3, bag_size: 149
batch 239, loss: 0.0756, instance_loss: 0.1774, weighted_loss: 0.1061, label: 0, bag_size: 221
batch 259, loss: 1.1358, instance_loss: 0.4705, weighted_loss: 0.9362, label: 3, bag_size: 230
batch 279, loss: 0.6584, instance_loss: 0.5408, weighted_loss: 0.6231, label: 4, bag_size: 231
batch 299, loss: 0.9994, instance_loss: 0.4821, weighted_loss: 0.8442, label: 2, bag_size: 1608
batch 319, loss: 0.9720, instance_loss: 0.4575, weighted_loss: 0.8176, label: 1, bag_size: 1009
batch 339, loss: 0.1873, instance_loss: 0.1894, weighted_loss: 0.1879, label: 0, bag_size: 133
batch 359, loss: 1.2306, instance_loss: 0.4985, weighted_loss: 1.0110, label: 2, bag_size: 363
batch 379, loss: 1.0156, instance_loss: 0.5261, weighted_loss: 0.8688, label: 4, bag_size: 446
batch 399, loss: 1.3559, instance_loss: 0.4813, weighted_loss: 1.0935, label: 4, bag_size: 731
batch 419, loss: 0.9414, instance_loss: 0.4920, weighted_loss: 0.8066, label: 2, bag_size: 567
batch 439, loss: 1.2046, instance_loss: 0.4065, weighted_loss: 0.9652, label: 2, bag_size: 340
batch 459, loss: 1.1889, instance_loss: 0.4925, weighted_loss: 0.9799, label: 3, bag_size: 274
batch 479, loss: 2.3219, instance_loss: 0.6541, weighted_loss: 1.8216, label: 1, bag_size: 823
batch 499, loss: 0.7801, instance_loss: 0.3725, weighted_loss: 0.6578, label: 0, bag_size: 81
batch 519, loss: 1.4205, instance_loss: 0.4992, weighted_loss: 1.1441, label: 1, bag_size: 1104
batch 539, loss: 2.4393, instance_loss: 0.5601, weighted_loss: 1.8755, label: 2, bag_size: 563
batch 559, loss: 1.3227, instance_loss: 0.5251, weighted_loss: 1.0834, label: 4, bag_size: 1064
batch 579, loss: 1.2786, instance_loss: 0.5662, weighted_loss: 1.0649, label: 2, bag_size: 1066


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.03367003367003367: correct 160/4752
Epoch: 7, train_loss: 1.3407, train_clustering_loss:  0.4915, train_error: 0.5791
class 0: acc 0.7722772277227723, correct 78/101
class 1: acc 0.22522522522522523, correct 25/111
class 2: acc 0.40601503759398494, correct 54/133
class 3: acc 0.4728682170542636, correct 61/129
class 4: acc 0.26666666666666666, correct 32/120

Val Set, val_loss: 1.2364, val_error: 0.5405, auc: 0.7636
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.342916 --> 1.236377).  Saving model ...


batch 19, loss: 1.2899, instance_loss: 0.5150, weighted_loss: 1.0574, label: 4, bag_size: 572
batch 39, loss: 0.4006, instance_loss: 0.3200, weighted_loss: 0.3765, label: 0, bag_size: 141
batch 59, loss: 1.3852, instance_loss: 0.5092, weighted_loss: 1.1224, label: 4, bag_size: 714
batch 79, loss: 0.0870, instance_loss: 0.1895, weighted_loss: 0.1177, label: 0, bag_size: 285
batch 99, loss: 1.8244, instance_loss: 0.5560, weighted_loss: 1.4439, label: 1, bag_size: 413
batch 119, loss: 1.3354, instance_loss: 0.4913, weighted_loss: 1.0822, label: 3, bag_size: 1060
batch 139, loss: 1.7444, instance_loss: 0.5515, weighted_loss: 1.3865, label: 4, bag_size: 266
batch 159, loss: 1.9101, instance_loss: 0.5258, weighted_loss: 1.4948, label: 2, bag_size: 779
batch 179, loss: 4.9119, instance_loss: 0.8292, weighted_loss: 3.6871, label: 2, bag_size: 176
batch 199, loss: 1.4147, instance_loss: 0.4945, weighted_loss: 1.1387, label: 1, bag_size: 460
batch 219, loss: 0.9501, instance_loss: 0.5085, weighted_loss: 0.8176, label: 1, bag_size: 231
batch 239, loss: 1.1860, instance_loss: 0.4635, weighted_loss: 0.9692, label: 4, bag_size: 589
batch 259, loss: 0.0830, instance_loss: 0.1383, weighted_loss: 0.0996, label: 0, bag_size: 212
batch 279, loss: 1.0180, instance_loss: 0.4441, weighted_loss: 0.8458, label: 3, bag_size: 423
batch 299, loss: 0.9414, instance_loss: 0.5241, weighted_loss: 0.8162, label: 3, bag_size: 282
batch 319, loss: 1.3577, instance_loss: 0.5392, weighted_loss: 1.1121, label: 4, bag_size: 468
batch 339, loss: 1.2636, instance_loss: 0.5040, weighted_loss: 1.0357, label: 1, bag_size: 271
batch 359, loss: 0.2877, instance_loss: 0.2777, weighted_loss: 0.2847, label: 0, bag_size: 231
batch 379, loss: 1.6329, instance_loss: 0.5918, weighted_loss: 1.3206, label: 4, bag_size: 1297
batch 399, loss: 0.9190, instance_loss: 0.4600, weighted_loss: 0.7813, label: 3, bag_size: 746
batch 419, loss: 0.2348, instance_loss: 0.2267, weighted_loss: 0.2324, label: 0, bag_size: 355
batch 439, loss: 1.7220, instance_loss: 0.6704, weighted_loss: 1.4065, label: 4, bag_size: 729
batch 459, loss: 1.8150, instance_loss: 0.6456, weighted_loss: 1.4642, label: 2, bag_size: 340
batch 479, loss: 1.0768, instance_loss: 0.4568, weighted_loss: 0.8908, label: 2, bag_size: 315
batch 499, loss: 0.4056, instance_loss: 0.2491, weighted_loss: 0.3587, label: 0, bag_size: 81
batch 519, loss: 1.1695, instance_loss: 0.5169, weighted_loss: 0.9737, label: 3, bag_size: 727
batch 539, loss: 0.1910, instance_loss: 0.2248, weighted_loss: 0.2011, label: 0, bag_size: 493
batch 559, loss: 0.8143, instance_loss: 0.4523, weighted_loss: 0.7057, label: 4, bag_size: 506
batch 579, loss: 1.1371, instance_loss: 0.4736, weighted_loss: 0.9381, label: 2, bag_size: 633


class 0 clustering acc 0.9945286195286195: correct 23630/23760
class 1 clustering acc 0.10648148148148148: correct 506/4752
Epoch: 8, train_loss: 1.2424, train_clustering_loss:  0.4708, train_error: 0.5505
class 0: acc 0.8650306748466258, correct 141/163
class 1: acc 0.35, correct 42/120
class 2: acc 0.13978494623655913, correct 13/93
class 3: acc 0.34210526315789475, correct 39/114
class 4: acc 0.3076923076923077, correct 32/104

Val Set, val_loss: 1.3578, val_error: 0.5676, auc: 0.7490
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.13513513513513514: correct 80/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2279, instance_loss: 0.6016, weighted_loss: 1.7400, label: 2, bag_size: 713
batch 39, loss: 1.6655, instance_loss: 0.5195, weighted_loss: 1.3217, label: 1, bag_size: 960
batch 59, loss: 0.5002, instance_loss: 0.3419, weighted_loss: 0.4527, label: 0, bag_size: 168
batch 79, loss: 1.5282, instance_loss: 0.5060, weighted_loss: 1.2215, label: 2, bag_size: 744
batch 99, loss: 0.8363, instance_loss: 0.6403, weighted_loss: 0.7775, label: 0, bag_size: 732
batch 119, loss: 1.8061, instance_loss: 0.4858, weighted_loss: 1.4100, label: 1, bag_size: 361
batch 139, loss: 1.7099, instance_loss: 0.5302, weighted_loss: 1.3560, label: 4, bag_size: 1351
batch 159, loss: 0.0540, instance_loss: 0.1004, weighted_loss: 0.0679, label: 0, bag_size: 350
batch 179, loss: 0.9718, instance_loss: 0.5236, weighted_loss: 0.8373, label: 4, bag_size: 853
batch 199, loss: 0.1355, instance_loss: 0.2443, weighted_loss: 0.1681, label: 0, bag_size: 81
batch 219, loss: 1.5275, instance_loss: 0.6795, weighted_loss: 1.2731, label: 4, bag_size: 110
batch 239, loss: 1.9107, instance_loss: 0.5357, weighted_loss: 1.4982, label: 2, bag_size: 133
batch 259, loss: 0.2713, instance_loss: 0.2058, weighted_loss: 0.2516, label: 0, bag_size: 74
batch 279, loss: 1.6105, instance_loss: 0.5560, weighted_loss: 1.2942, label: 4, bag_size: 233
batch 299, loss: 1.4505, instance_loss: 0.4990, weighted_loss: 1.1650, label: 2, bag_size: 684
batch 319, loss: 1.2603, instance_loss: 0.5264, weighted_loss: 1.0401, label: 4, bag_size: 1077
batch 339, loss: 1.2993, instance_loss: 0.5722, weighted_loss: 1.0812, label: 4, bag_size: 986
batch 359, loss: 1.0334, instance_loss: 0.4676, weighted_loss: 0.8636, label: 2, bag_size: 607
batch 379, loss: 1.9932, instance_loss: 0.4752, weighted_loss: 1.5378, label: 0, bag_size: 1414
batch 399, loss: 1.0546, instance_loss: 0.4615, weighted_loss: 0.8766, label: 3, bag_size: 344
batch 419, loss: 2.0695, instance_loss: 0.6198, weighted_loss: 1.6346, label: 4, bag_size: 944
batch 439, loss: 4.4071, instance_loss: 0.8506, weighted_loss: 3.3402, label: 0, bag_size: 214
batch 459, loss: 1.0879, instance_loss: 0.4940, weighted_loss: 0.9097, label: 2, bag_size: 613
batch 479, loss: 0.9269, instance_loss: 0.5193, weighted_loss: 0.8046, label: 4, bag_size: 875
batch 499, loss: 0.8337, instance_loss: 0.3913, weighted_loss: 0.7010, label: 1, bag_size: 981
batch 519, loss: 1.9454, instance_loss: 0.5052, weighted_loss: 1.5134, label: 4, bag_size: 250
batch 539, loss: 0.9319, instance_loss: 0.3740, weighted_loss: 0.7645, label: 0, bag_size: 552
batch 559, loss: 0.8584, instance_loss: 0.4399, weighted_loss: 0.7328, label: 3, bag_size: 274
batch 579, loss: 1.2949, instance_loss: 0.5144, weighted_loss: 1.0608, label: 4, bag_size: 1104


class 0 clustering acc 0.9958333333333333: correct 23661/23760
class 1 clustering acc 0.09006734006734007: correct 428/4752
Epoch: 9, train_loss: 1.2867, train_clustering_loss:  0.4797, train_error: 0.5690
class 0: acc 0.8294573643410853, correct 107/129
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.3387096774193548, correct 42/124
class 3: acc 0.23529411764705882, correct 24/102
class 4: acc 0.4573643410852713, correct 59/129

Val Set, val_loss: 1.2819, val_error: 0.4865, auc: 0.7612
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.10304054054054054: correct 61/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1159, instance_loss: 0.4685, weighted_loss: 0.9217, label: 1, bag_size: 814
batch 39, loss: 2.6569, instance_loss: 0.6367, weighted_loss: 2.0508, label: 3, bag_size: 282
batch 59, loss: 1.4081, instance_loss: 0.4941, weighted_loss: 1.1339, label: 3, bag_size: 1328
batch 79, loss: 1.6452, instance_loss: 0.5255, weighted_loss: 1.3092, label: 3, bag_size: 928
batch 99, loss: 0.0121, instance_loss: 0.2524, weighted_loss: 0.0842, label: 0, bag_size: 80
batch 119, loss: 1.7434, instance_loss: 0.6012, weighted_loss: 1.4007, label: 2, bag_size: 470
batch 139, loss: 0.7487, instance_loss: 0.4169, weighted_loss: 0.6492, label: 3, bag_size: 272
batch 159, loss: 1.6477, instance_loss: 0.5264, weighted_loss: 1.3113, label: 2, bag_size: 769
batch 179, loss: 1.4943, instance_loss: 0.5651, weighted_loss: 1.2155, label: 4, bag_size: 293
batch 199, loss: 1.3061, instance_loss: 0.4790, weighted_loss: 1.0580, label: 2, bag_size: 606
batch 219, loss: 1.6317, instance_loss: 0.5572, weighted_loss: 1.3093, label: 4, bag_size: 1351
batch 239, loss: 1.2941, instance_loss: 0.5675, weighted_loss: 1.0761, label: 4, bag_size: 727
batch 259, loss: 1.2857, instance_loss: 0.4318, weighted_loss: 1.0295, label: 1, bag_size: 764
batch 279, loss: 0.1242, instance_loss: 0.1996, weighted_loss: 0.1468, label: 0, bag_size: 355
batch 299, loss: 1.2665, instance_loss: 0.5211, weighted_loss: 1.0429, label: 2, bag_size: 867
batch 319, loss: 1.0584, instance_loss: 0.4396, weighted_loss: 0.8728, label: 1, bag_size: 410
batch 339, loss: 1.4743, instance_loss: 0.5632, weighted_loss: 1.2010, label: 4, bag_size: 695
batch 359, loss: 1.3049, instance_loss: 0.4697, weighted_loss: 1.0544, label: 1, bag_size: 355
batch 379, loss: 1.5818, instance_loss: 0.5037, weighted_loss: 1.2584, label: 4, bag_size: 176
batch 399, loss: 1.3976, instance_loss: 0.5123, weighted_loss: 1.1320, label: 4, bag_size: 699
batch 419, loss: 0.4359, instance_loss: 0.2792, weighted_loss: 0.3889, label: 0, bag_size: 400
batch 439, loss: 1.7846, instance_loss: 0.5528, weighted_loss: 1.4151, label: 4, bag_size: 714
batch 459, loss: 1.2830, instance_loss: 0.5516, weighted_loss: 1.0636, label: 4, bag_size: 110
batch 479, loss: 1.8403, instance_loss: 0.6164, weighted_loss: 1.4732, label: 4, bag_size: 590
batch 499, loss: 1.4745, instance_loss: 0.4505, weighted_loss: 1.1673, label: 2, bag_size: 821
batch 519, loss: 1.5192, instance_loss: 0.4833, weighted_loss: 1.2084, label: 1, bag_size: 509
batch 539, loss: 0.1083, instance_loss: 0.2387, weighted_loss: 0.1474, label: 0, bag_size: 98
batch 559, loss: 1.3491, instance_loss: 0.4742, weighted_loss: 1.0866, label: 2, bag_size: 554
batch 579, loss: 1.3460, instance_loss: 0.5027, weighted_loss: 1.0930, label: 4, bag_size: 652


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.0707070707070707: correct 336/4752
Epoch: 10, train_loss: 1.2911, train_clustering_loss:  0.4835, train_error: 0.5758
class 0: acc 0.8099173553719008, correct 98/121
class 1: acc 0.3412698412698413, correct 43/126
class 2: acc 0.2892561983471074, correct 35/121
class 3: acc 0.33636363636363636, correct 37/110
class 4: acc 0.33620689655172414, correct 39/116

Val Set, val_loss: 1.3521, val_error: 0.5270, auc: 0.7436
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8060, instance_loss: 0.3803, weighted_loss: 0.6783, label: 2, bag_size: 253
batch 39, loss: 1.9777, instance_loss: 0.6203, weighted_loss: 1.5705, label: 0, bag_size: 587
batch 59, loss: 0.7848, instance_loss: 0.5211, weighted_loss: 0.7057, label: 4, bag_size: 773
batch 79, loss: 1.5008, instance_loss: 0.5422, weighted_loss: 1.2132, label: 3, bag_size: 779
batch 99, loss: 0.1643, instance_loss: 0.3477, weighted_loss: 0.2193, label: 0, bag_size: 51
batch 119, loss: 1.1832, instance_loss: 0.4765, weighted_loss: 0.9712, label: 4, bag_size: 589
batch 139, loss: 0.0750, instance_loss: 0.2581, weighted_loss: 0.1299, label: 0, bag_size: 366
batch 159, loss: 0.8748, instance_loss: 0.4869, weighted_loss: 0.7585, label: 4, bag_size: 652
batch 179, loss: 1.6209, instance_loss: 0.6072, weighted_loss: 1.3168, label: 2, bag_size: 348
batch 199, loss: 0.9106, instance_loss: 0.5027, weighted_loss: 0.7882, label: 2, bag_size: 1608
batch 219, loss: 2.5123, instance_loss: 0.6235, weighted_loss: 1.9457, label: 4, bag_size: 937
batch 239, loss: 1.2459, instance_loss: 0.4562, weighted_loss: 1.0090, label: 3, bag_size: 301
batch 259, loss: 1.1811, instance_loss: 0.4748, weighted_loss: 0.9692, label: 1, bag_size: 605
batch 279, loss: 1.0127, instance_loss: 0.5534, weighted_loss: 0.8749, label: 4, bag_size: 129
batch 299, loss: 1.6260, instance_loss: 0.5903, weighted_loss: 1.3153, label: 4, bag_size: 937
batch 319, loss: 1.5392, instance_loss: 0.4718, weighted_loss: 1.2190, label: 1, bag_size: 672
batch 339, loss: 1.3004, instance_loss: 0.4454, weighted_loss: 1.0439, label: 3, bag_size: 982
batch 359, loss: 1.8800, instance_loss: 0.6192, weighted_loss: 1.5017, label: 2, bag_size: 821
batch 379, loss: 0.0622, instance_loss: 0.2505, weighted_loss: 0.1187, label: 0, bag_size: 523
batch 399, loss: 1.4365, instance_loss: 0.5084, weighted_loss: 1.1581, label: 1, bag_size: 766
batch 419, loss: 2.3361, instance_loss: 0.5714, weighted_loss: 1.8067, label: 2, bag_size: 1074
batch 439, loss: 1.7122, instance_loss: 0.7453, weighted_loss: 1.4221, label: 1, bag_size: 371
batch 459, loss: 3.4706, instance_loss: 0.6389, weighted_loss: 2.6211, label: 4, bag_size: 270
batch 479, loss: 0.6761, instance_loss: 0.4931, weighted_loss: 0.6212, label: 4, bag_size: 744
batch 499, loss: 0.7845, instance_loss: 0.4089, weighted_loss: 0.6718, label: 2, bag_size: 557
batch 519, loss: 0.6879, instance_loss: 0.5309, weighted_loss: 0.6408, label: 0, bag_size: 282
batch 539, loss: 1.2521, instance_loss: 0.4607, weighted_loss: 1.0147, label: 3, bag_size: 473
batch 559, loss: 0.8343, instance_loss: 0.3929, weighted_loss: 0.7019, label: 3, bag_size: 727
batch 579, loss: 1.5822, instance_loss: 0.4862, weighted_loss: 1.2534, label: 1, bag_size: 697


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.03535353535353535: correct 168/4752
Epoch: 11, train_loss: 1.2991, train_clustering_loss:  0.4936, train_error: 0.5926
class 0: acc 0.7254901960784313, correct 74/102
class 1: acc 0.1864406779661017, correct 22/118
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.45255474452554745, correct 62/137
class 4: acc 0.424, correct 53/125

Val Set, val_loss: 1.3213, val_error: 0.6081, auc: 0.7673
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.1457, instance_loss: 0.5928, weighted_loss: 1.6798, label: 1, bag_size: 599
batch 39, loss: 1.0452, instance_loss: 0.3760, weighted_loss: 0.8445, label: 2, bag_size: 135
batch 59, loss: 1.6549, instance_loss: 0.5889, weighted_loss: 1.3351, label: 4, bag_size: 726
batch 79, loss: 1.2601, instance_loss: 0.5366, weighted_loss: 1.0430, label: 4, bag_size: 363
batch 99, loss: 0.7383, instance_loss: 0.4027, weighted_loss: 0.6376, label: 3, bag_size: 737
batch 119, loss: 1.1219, instance_loss: 0.4652, weighted_loss: 0.9249, label: 2, bag_size: 697
batch 139, loss: 1.1394, instance_loss: 0.5119, weighted_loss: 0.9511, label: 3, bag_size: 1057
batch 159, loss: 0.9192, instance_loss: 0.4380, weighted_loss: 0.7749, label: 3, bag_size: 818
batch 179, loss: 1.3689, instance_loss: 0.4915, weighted_loss: 1.1057, label: 2, bag_size: 783
batch 199, loss: 1.1578, instance_loss: 0.4579, weighted_loss: 0.9478, label: 1, bag_size: 141
batch 219, loss: 1.4532, instance_loss: 0.5055, weighted_loss: 1.1689, label: 2, bag_size: 543
batch 239, loss: 0.9427, instance_loss: 0.4618, weighted_loss: 0.7984, label: 1, bag_size: 593
batch 259, loss: 1.9629, instance_loss: 0.6326, weighted_loss: 1.5638, label: 4, bag_size: 270
batch 279, loss: 0.9924, instance_loss: 0.5991, weighted_loss: 0.8744, label: 4, bag_size: 854
batch 299, loss: 0.4391, instance_loss: 0.3282, weighted_loss: 0.4059, label: 0, bag_size: 383
batch 319, loss: 1.0404, instance_loss: 0.4738, weighted_loss: 0.8704, label: 3, bag_size: 928
batch 339, loss: 1.0585, instance_loss: 0.4966, weighted_loss: 0.8899, label: 3, bag_size: 533
batch 359, loss: 1.1111, instance_loss: 0.4782, weighted_loss: 0.9212, label: 3, bag_size: 796
batch 379, loss: 1.7308, instance_loss: 0.5753, weighted_loss: 1.3842, label: 4, bag_size: 547
batch 399, loss: 0.8777, instance_loss: 0.4988, weighted_loss: 0.7641, label: 1, bag_size: 892
batch 419, loss: 1.0769, instance_loss: 0.4403, weighted_loss: 0.8859, label: 4, bag_size: 868
batch 439, loss: 1.1502, instance_loss: 0.5246, weighted_loss: 0.9625, label: 4, bag_size: 520
batch 459, loss: 1.1883, instance_loss: 0.5419, weighted_loss: 0.9944, label: 2, bag_size: 445
batch 479, loss: 1.0173, instance_loss: 0.4768, weighted_loss: 0.8552, label: 2, bag_size: 361
batch 499, loss: 1.6930, instance_loss: 0.5256, weighted_loss: 1.3428, label: 4, bag_size: 986
batch 519, loss: 1.3575, instance_loss: 0.4745, weighted_loss: 1.0926, label: 3, bag_size: 472
batch 539, loss: 1.2140, instance_loss: 0.5000, weighted_loss: 0.9998, label: 1, bag_size: 390
batch 559, loss: 1.1244, instance_loss: 0.4100, weighted_loss: 0.9101, label: 2, bag_size: 812
batch 579, loss: 0.3491, instance_loss: 0.3758, weighted_loss: 0.3571, label: 0, bag_size: 281


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.025673400673400674: correct 122/4752
Epoch: 12, train_loss: 1.3144, train_clustering_loss:  0.4933, train_error: 0.5471
class 0: acc 0.7692307692307693, correct 80/104
class 1: acc 0.3769230769230769, correct 49/130
class 2: acc 0.4296875, correct 55/128
class 3: acc 0.42748091603053434, correct 56/131
class 4: acc 0.2871287128712871, correct 29/101

Val Set, val_loss: 1.1937, val_error: 0.5270, auc: 0.7829
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.236377 --> 1.193748).  Saving model ...


batch 19, loss: 0.9449, instance_loss: 0.4240, weighted_loss: 0.7886, label: 2, bag_size: 702
batch 39, loss: 1.1868, instance_loss: 0.5381, weighted_loss: 0.9922, label: 1, bag_size: 981
batch 59, loss: 1.3366, instance_loss: 0.5937, weighted_loss: 1.1138, label: 3, bag_size: 497
batch 79, loss: 0.0454, instance_loss: 0.3077, weighted_loss: 0.1240, label: 0, bag_size: 524
batch 99, loss: 0.7798, instance_loss: 0.4399, weighted_loss: 0.6778, label: 2, bag_size: 348
batch 119, loss: 1.4572, instance_loss: 0.4834, weighted_loss: 1.1651, label: 1, bag_size: 865
batch 139, loss: 2.1795, instance_loss: 0.5448, weighted_loss: 1.6891, label: 3, bag_size: 342
batch 159, loss: 1.5426, instance_loss: 0.5870, weighted_loss: 1.2559, label: 0, bag_size: 317
batch 179, loss: 0.0252, instance_loss: 0.2425, weighted_loss: 0.0904, label: 0, bag_size: 706
batch 199, loss: 0.8051, instance_loss: 0.4613, weighted_loss: 0.7020, label: 4, bag_size: 639
batch 219, loss: 1.2674, instance_loss: 0.5365, weighted_loss: 1.0482, label: 2, bag_size: 286
batch 239, loss: 3.6684, instance_loss: 0.6619, weighted_loss: 2.7665, label: 4, bag_size: 270
batch 259, loss: 1.0337, instance_loss: 0.4969, weighted_loss: 0.8727, label: 1, bag_size: 1091
batch 279, loss: 0.2987, instance_loss: 0.5173, weighted_loss: 0.3643, label: 0, bag_size: 613
batch 299, loss: 1.7440, instance_loss: 0.5472, weighted_loss: 1.3850, label: 1, bag_size: 697
batch 319, loss: 0.9263, instance_loss: 0.5016, weighted_loss: 0.7989, label: 4, bag_size: 875
batch 339, loss: 1.0997, instance_loss: 0.4597, weighted_loss: 0.9077, label: 2, bag_size: 498
batch 359, loss: 0.9264, instance_loss: 0.4366, weighted_loss: 0.7795, label: 4, bag_size: 780
batch 379, loss: 1.0954, instance_loss: 0.5519, weighted_loss: 0.9324, label: 4, bag_size: 1297
batch 399, loss: 1.0204, instance_loss: 0.4548, weighted_loss: 0.8507, label: 2, bag_size: 769
batch 419, loss: 0.9340, instance_loss: 0.4165, weighted_loss: 0.7788, label: 2, bag_size: 290
batch 439, loss: 1.1957, instance_loss: 0.4582, weighted_loss: 0.9744, label: 3, bag_size: 102
batch 459, loss: 0.6951, instance_loss: 0.4924, weighted_loss: 0.6343, label: 0, bag_size: 416
batch 479, loss: 1.5427, instance_loss: 0.5475, weighted_loss: 1.2441, label: 4, bag_size: 960
batch 499, loss: 0.6356, instance_loss: 0.4540, weighted_loss: 0.5811, label: 4, bag_size: 744
batch 519, loss: 1.1057, instance_loss: 0.4764, weighted_loss: 0.9169, label: 2, bag_size: 253
batch 539, loss: 0.1695, instance_loss: 0.2769, weighted_loss: 0.2017, label: 0, bag_size: 51
batch 559, loss: 0.9617, instance_loss: 0.5089, weighted_loss: 0.8259, label: 3, bag_size: 727
batch 579, loss: 1.4707, instance_loss: 0.4870, weighted_loss: 1.1756, label: 4, bag_size: 198


class 0 clustering acc 0.9968013468013468: correct 23684/23760
class 1 clustering acc 0.02335858585858586: correct 111/4752
Epoch: 13, train_loss: 1.2422, train_clustering_loss:  0.4884, train_error: 0.5522
class 0: acc 0.7706422018348624, correct 84/109
class 1: acc 0.19, correct 19/100
class 2: acc 0.4351145038167939, correct 57/131
class 3: acc 0.3858267716535433, correct 49/127
class 4: acc 0.44881889763779526, correct 57/127

Val Set, val_loss: 1.2177, val_error: 0.5676, auc: 0.7819
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4061, instance_loss: 0.5173, weighted_loss: 1.1395, label: 1, bag_size: 605
batch 39, loss: 1.4418, instance_loss: 0.5048, weighted_loss: 1.1607, label: 4, bag_size: 1031
batch 59, loss: 1.4237, instance_loss: 0.5395, weighted_loss: 1.1585, label: 0, bag_size: 376
batch 79, loss: 1.7298, instance_loss: 0.6743, weighted_loss: 1.4132, label: 1, bag_size: 311
batch 99, loss: 1.1020, instance_loss: 0.5075, weighted_loss: 0.9237, label: 0, bag_size: 1414
batch 119, loss: 3.2714, instance_loss: 0.7220, weighted_loss: 2.5066, label: 0, bag_size: 478
batch 139, loss: 1.4315, instance_loss: 0.5300, weighted_loss: 1.1611, label: 3, bag_size: 230
batch 159, loss: 1.4269, instance_loss: 0.5268, weighted_loss: 1.1569, label: 3, bag_size: 641
batch 179, loss: 1.5180, instance_loss: 0.5907, weighted_loss: 1.2398, label: 0, bag_size: 319
batch 199, loss: 1.0268, instance_loss: 0.4739, weighted_loss: 0.8609, label: 3, bag_size: 857
batch 219, loss: 0.9687, instance_loss: 0.4732, weighted_loss: 0.8200, label: 3, bag_size: 492
batch 239, loss: 1.3088, instance_loss: 0.4900, weighted_loss: 1.0632, label: 3, bag_size: 497
batch 259, loss: 0.8921, instance_loss: 0.4113, weighted_loss: 0.7479, label: 1, bag_size: 1091
batch 279, loss: 2.4181, instance_loss: 0.6551, weighted_loss: 1.8892, label: 2, bag_size: 606
batch 299, loss: 1.3254, instance_loss: 0.5447, weighted_loss: 1.0912, label: 2, bag_size: 363
batch 319, loss: 3.7516, instance_loss: 1.0511, weighted_loss: 2.9415, label: 2, bag_size: 809
batch 339, loss: 2.0593, instance_loss: 0.5875, weighted_loss: 1.6177, label: 4, bag_size: 176
batch 359, loss: 1.3388, instance_loss: 0.4688, weighted_loss: 1.0778, label: 1, bag_size: 1121
batch 379, loss: 1.1023, instance_loss: 0.4865, weighted_loss: 0.9176, label: 4, bag_size: 755
batch 399, loss: 0.2652, instance_loss: 0.4132, weighted_loss: 0.3096, label: 0, bag_size: 188
batch 419, loss: 1.3653, instance_loss: 0.5125, weighted_loss: 1.1094, label: 3, bag_size: 476
batch 439, loss: 0.1879, instance_loss: 0.4082, weighted_loss: 0.2540, label: 0, bag_size: 188
batch 459, loss: 2.3670, instance_loss: 0.5352, weighted_loss: 1.8175, label: 2, bag_size: 1122
batch 479, loss: 1.2430, instance_loss: 0.5146, weighted_loss: 1.0245, label: 3, bag_size: 499
batch 499, loss: 0.2933, instance_loss: 0.3351, weighted_loss: 0.3058, label: 0, bag_size: 212
batch 519, loss: 1.2084, instance_loss: 0.4273, weighted_loss: 0.9741, label: 1, bag_size: 490
batch 539, loss: 0.1447, instance_loss: 0.3235, weighted_loss: 0.1983, label: 0, bag_size: 71
batch 559, loss: 1.3879, instance_loss: 0.5415, weighted_loss: 1.1340, label: 2, bag_size: 337
batch 579, loss: 3.6403, instance_loss: 0.6288, weighted_loss: 2.7368, label: 3, bag_size: 638


class 0 clustering acc 0.9967171717171717: correct 23682/23760
class 1 clustering acc 0.03135521885521886: correct 149/4752
Epoch: 14, train_loss: 1.2787, train_clustering_loss:  0.4907, train_error: 0.5774
class 0: acc 0.7661290322580645, correct 95/124
class 1: acc 0.2713178294573643, correct 35/129
class 2: acc 0.2545454545454545, correct 28/110
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.512396694214876, correct 62/121

Val Set, val_loss: 1.2141, val_error: 0.5270, auc: 0.7758
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5523, instance_loss: 0.5536, weighted_loss: 1.2527, label: 1, bag_size: 272
batch 39, loss: 1.0988, instance_loss: 0.5033, weighted_loss: 0.9202, label: 3, bag_size: 857
batch 59, loss: 0.7806, instance_loss: 0.3915, weighted_loss: 0.6639, label: 0, bag_size: 613
batch 79, loss: 1.3536, instance_loss: 0.4431, weighted_loss: 1.0804, label: 4, bag_size: 944
batch 99, loss: 2.2320, instance_loss: 0.6577, weighted_loss: 1.7597, label: 1, bag_size: 311
batch 119, loss: 0.7044, instance_loss: 0.4801, weighted_loss: 0.6371, label: 2, bag_size: 640
batch 139, loss: 1.6450, instance_loss: 0.4916, weighted_loss: 1.2990, label: 3, bag_size: 337
batch 159, loss: 1.0726, instance_loss: 0.5926, weighted_loss: 0.9286, label: 4, bag_size: 432
batch 179, loss: 1.2147, instance_loss: 0.5171, weighted_loss: 1.0054, label: 4, bag_size: 875
batch 199, loss: 1.9471, instance_loss: 0.5004, weighted_loss: 1.5131, label: 3, bag_size: 492
batch 219, loss: 1.8532, instance_loss: 0.5558, weighted_loss: 1.4640, label: 3, bag_size: 300
batch 239, loss: 0.6863, instance_loss: 0.3537, weighted_loss: 0.5865, label: 0, bag_size: 77
batch 259, loss: 1.1029, instance_loss: 0.4886, weighted_loss: 0.9186, label: 2, bag_size: 119
batch 279, loss: 0.3291, instance_loss: 0.3010, weighted_loss: 0.3207, label: 0, bag_size: 88
batch 299, loss: 0.6468, instance_loss: 0.5219, weighted_loss: 0.6093, label: 3, bag_size: 608
batch 319, loss: 2.2452, instance_loss: 0.6002, weighted_loss: 1.7517, label: 0, bag_size: 888
batch 339, loss: 1.1773, instance_loss: 0.4370, weighted_loss: 0.9552, label: 2, bag_size: 598
batch 359, loss: 0.7995, instance_loss: 0.4268, weighted_loss: 0.6877, label: 3, bag_size: 739
batch 379, loss: 0.3543, instance_loss: 0.3762, weighted_loss: 0.3609, label: 0, bag_size: 319
batch 399, loss: 1.2197, instance_loss: 0.5032, weighted_loss: 1.0047, label: 3, bag_size: 982
batch 419, loss: 1.6486, instance_loss: 0.4985, weighted_loss: 1.3036, label: 4, bag_size: 854
batch 439, loss: 2.1445, instance_loss: 0.4805, weighted_loss: 1.6453, label: 2, bag_size: 219
batch 459, loss: 1.0202, instance_loss: 0.4430, weighted_loss: 0.8470, label: 2, bag_size: 717
batch 479, loss: 0.5698, instance_loss: 0.3748, weighted_loss: 0.5113, label: 0, bag_size: 297
batch 499, loss: 0.1718, instance_loss: 0.3432, weighted_loss: 0.2232, label: 0, bag_size: 101
batch 519, loss: 0.4348, instance_loss: 0.3688, weighted_loss: 0.4150, label: 0, bag_size: 33
batch 539, loss: 0.7224, instance_loss: 0.4138, weighted_loss: 0.6298, label: 4, bag_size: 498
batch 559, loss: 0.8219, instance_loss: 0.4132, weighted_loss: 0.6993, label: 4, bag_size: 652
batch 579, loss: 1.2909, instance_loss: 0.4758, weighted_loss: 1.0464, label: 1, bag_size: 660


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.021464646464646464: correct 102/4752
Epoch: 15, train_loss: 1.2382, train_clustering_loss:  0.4877, train_error: 0.5286
class 0: acc 0.7862595419847328, correct 103/131
class 1: acc 0.2222222222222222, correct 24/108
class 2: acc 0.546875, correct 70/128
class 3: acc 0.23423423423423423, correct 26/111
class 4: acc 0.49137931034482757, correct 57/116

Val Set, val_loss: 1.2248, val_error: 0.5541, auc: 0.7883
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6311, instance_loss: 0.4233, weighted_loss: 0.5688, label: 2, bag_size: 607
batch 39, loss: 1.0729, instance_loss: 0.6256, weighted_loss: 0.9387, label: 2, bag_size: 96
batch 59, loss: 0.1818, instance_loss: 0.3782, weighted_loss: 0.2407, label: 0, bag_size: 702
batch 79, loss: 0.7502, instance_loss: 0.3995, weighted_loss: 0.6450, label: 2, bag_size: 659
batch 99, loss: 1.9712, instance_loss: 0.6585, weighted_loss: 1.5774, label: 3, bag_size: 342
batch 119, loss: 1.1402, instance_loss: 0.4825, weighted_loss: 0.9429, label: 3, bag_size: 822
batch 139, loss: 1.9885, instance_loss: 0.5370, weighted_loss: 1.5531, label: 2, bag_size: 744
batch 159, loss: 0.9928, instance_loss: 0.4627, weighted_loss: 0.8338, label: 1, bag_size: 960
batch 179, loss: 2.4859, instance_loss: 0.5975, weighted_loss: 1.9194, label: 0, bag_size: 745
batch 199, loss: 0.8917, instance_loss: 0.4823, weighted_loss: 0.7688, label: 4, bag_size: 263
batch 219, loss: 0.8055, instance_loss: 0.4349, weighted_loss: 0.6944, label: 4, bag_size: 506
batch 239, loss: 1.1369, instance_loss: 0.4904, weighted_loss: 0.9429, label: 2, bag_size: 783
batch 259, loss: 1.3416, instance_loss: 0.5097, weighted_loss: 1.0920, label: 0, bag_size: 587
batch 279, loss: 0.3774, instance_loss: 0.3075, weighted_loss: 0.3564, label: 0, bag_size: 513
batch 299, loss: 1.2357, instance_loss: 0.4988, weighted_loss: 1.0146, label: 1, bag_size: 372
batch 319, loss: 0.0991, instance_loss: 0.2731, weighted_loss: 0.1513, label: 0, bag_size: 517
batch 339, loss: 0.8734, instance_loss: 0.4324, weighted_loss: 0.7411, label: 3, bag_size: 488
batch 359, loss: 0.9496, instance_loss: 0.4537, weighted_loss: 0.8008, label: 3, bag_size: 789
batch 379, loss: 1.0079, instance_loss: 0.5147, weighted_loss: 0.8599, label: 4, bag_size: 730
batch 399, loss: 0.3785, instance_loss: 0.3976, weighted_loss: 0.3843, label: 0, bag_size: 238
batch 419, loss: 0.1515, instance_loss: 0.3565, weighted_loss: 0.2130, label: 0, bag_size: 283
batch 439, loss: 1.7407, instance_loss: 0.5369, weighted_loss: 1.3796, label: 3, bag_size: 498
batch 459, loss: 1.4103, instance_loss: 0.4718, weighted_loss: 1.1288, label: 1, bag_size: 389
batch 479, loss: 0.9727, instance_loss: 0.4192, weighted_loss: 0.8066, label: 0, bag_size: 62
batch 499, loss: 0.0099, instance_loss: 0.2120, weighted_loss: 0.0705, label: 0, bag_size: 49
batch 519, loss: 1.7391, instance_loss: 0.4999, weighted_loss: 1.3674, label: 2, bag_size: 350
batch 539, loss: 1.4817, instance_loss: 0.5771, weighted_loss: 1.2103, label: 0, bag_size: 732
batch 559, loss: 1.5871, instance_loss: 0.5139, weighted_loss: 1.2651, label: 2, bag_size: 398
batch 579, loss: 1.1755, instance_loss: 0.4915, weighted_loss: 0.9703, label: 2, bag_size: 592


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.04019360269360269: correct 191/4752
Epoch: 16, train_loss: 1.2453, train_clustering_loss:  0.4836, train_error: 0.5337
class 0: acc 0.7720588235294118, correct 105/136
class 1: acc 0.3, correct 36/120
class 2: acc 0.33620689655172414, correct 39/116
class 3: acc 0.4782608695652174, correct 55/115
class 4: acc 0.3925233644859813, correct 42/107

Val Set, val_loss: 1.1881, val_error: 0.5541, auc: 0.8071
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.193748 --> 1.188076).  Saving model ...


batch 19, loss: 0.1945, instance_loss: 0.2874, weighted_loss: 0.2224, label: 0, bag_size: 71
batch 39, loss: 1.1100, instance_loss: 0.4569, weighted_loss: 0.9140, label: 3, bag_size: 899
batch 59, loss: 0.9732, instance_loss: 0.4942, weighted_loss: 0.8295, label: 3, bag_size: 473
batch 79, loss: 1.0821, instance_loss: 0.4786, weighted_loss: 0.9011, label: 3, bag_size: 451
batch 99, loss: 2.4723, instance_loss: 0.5970, weighted_loss: 1.9097, label: 2, bag_size: 563
batch 119, loss: 2.0440, instance_loss: 0.4775, weighted_loss: 1.5741, label: 1, bag_size: 361
batch 139, loss: 1.5811, instance_loss: 0.6228, weighted_loss: 1.2936, label: 2, bag_size: 219
batch 159, loss: 1.1680, instance_loss: 0.4583, weighted_loss: 0.9551, label: 2, bag_size: 1013
batch 179, loss: 1.3678, instance_loss: 0.5436, weighted_loss: 1.1206, label: 1, bag_size: 697
batch 199, loss: 0.7884, instance_loss: 0.4389, weighted_loss: 0.6836, label: 4, bag_size: 744
batch 219, loss: 0.3326, instance_loss: 0.3252, weighted_loss: 0.3304, label: 0, bag_size: 159
batch 239, loss: 0.9039, instance_loss: 0.4284, weighted_loss: 0.7612, label: 4, bag_size: 986
batch 259, loss: 1.6792, instance_loss: 0.5551, weighted_loss: 1.3420, label: 1, bag_size: 988
batch 279, loss: 1.2434, instance_loss: 0.4559, weighted_loss: 1.0072, label: 2, bag_size: 592
batch 299, loss: 2.1400, instance_loss: 0.5271, weighted_loss: 1.6561, label: 2, bag_size: 720
batch 319, loss: 0.6389, instance_loss: 0.5375, weighted_loss: 0.6085, label: 3, bag_size: 674
batch 339, loss: 1.0611, instance_loss: 0.4784, weighted_loss: 0.8863, label: 3, bag_size: 1078
batch 359, loss: 1.6181, instance_loss: 0.4720, weighted_loss: 1.2743, label: 3, bag_size: 301
batch 379, loss: 1.2533, instance_loss: 0.5805, weighted_loss: 1.0515, label: 4, bag_size: 780
batch 399, loss: 0.8602, instance_loss: 0.4195, weighted_loss: 0.7280, label: 3, bag_size: 337
batch 419, loss: 3.2988, instance_loss: 0.6746, weighted_loss: 2.5116, label: 1, bag_size: 45
batch 439, loss: 1.1027, instance_loss: 0.4882, weighted_loss: 0.9183, label: 4, bag_size: 418
batch 459, loss: 0.8266, instance_loss: 0.4097, weighted_loss: 0.7016, label: 3, bag_size: 1328
batch 479, loss: 1.7398, instance_loss: 0.5825, weighted_loss: 1.3926, label: 4, bag_size: 730
batch 499, loss: 1.9241, instance_loss: 0.5159, weighted_loss: 1.5017, label: 2, bag_size: 597
batch 519, loss: 1.5095, instance_loss: 0.5662, weighted_loss: 1.2265, label: 1, bag_size: 321
batch 539, loss: 0.9710, instance_loss: 0.4687, weighted_loss: 0.8203, label: 2, bag_size: 598
batch 559, loss: 1.4778, instance_loss: 0.5738, weighted_loss: 1.2066, label: 3, bag_size: 192
batch 579, loss: 1.5215, instance_loss: 0.6034, weighted_loss: 1.2461, label: 2, bag_size: 96


class 0 clustering acc 0.9971801346801347: correct 23693/23760
class 1 clustering acc 0.03345959595959596: correct 159/4752
Epoch: 17, train_loss: 1.2295, train_clustering_loss:  0.4868, train_error: 0.5135
class 0: acc 0.8376068376068376, correct 98/117
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.3893129770992366, correct 51/131
class 3: acc 0.5555555555555556, correct 70/126
class 4: acc 0.41818181818181815, correct 46/110

Val Set, val_loss: 1.2663, val_error: 0.5541, auc: 0.7913
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9831, instance_loss: 0.4542, weighted_loss: 0.8244, label: 3, bag_size: 608
batch 39, loss: 0.8971, instance_loss: 0.5462, weighted_loss: 0.7919, label: 3, bag_size: 192
batch 59, loss: 2.3562, instance_loss: 0.5821, weighted_loss: 1.8239, label: 1, bag_size: 988
batch 79, loss: 1.5259, instance_loss: 0.5551, weighted_loss: 1.2346, label: 4, bag_size: 824
batch 99, loss: 0.1482, instance_loss: 0.3715, weighted_loss: 0.2152, label: 0, bag_size: 59
batch 119, loss: 0.0288, instance_loss: 0.2058, weighted_loss: 0.0819, label: 0, bag_size: 706
batch 139, loss: 0.8973, instance_loss: 0.4940, weighted_loss: 0.7763, label: 1, bag_size: 960
batch 159, loss: 1.2015, instance_loss: 0.4839, weighted_loss: 0.9862, label: 1, bag_size: 500
batch 179, loss: 0.8474, instance_loss: 0.4491, weighted_loss: 0.7279, label: 3, bag_size: 398
batch 199, loss: 1.0401, instance_loss: 0.5578, weighted_loss: 0.8954, label: 4, bag_size: 446
batch 219, loss: 0.1292, instance_loss: 0.2528, weighted_loss: 0.1663, label: 0, bag_size: 366
batch 239, loss: 0.9163, instance_loss: 0.4893, weighted_loss: 0.7882, label: 1, bag_size: 865
batch 259, loss: 1.4786, instance_loss: 0.5202, weighted_loss: 1.1911, label: 2, bag_size: 522
batch 279, loss: 3.1874, instance_loss: 0.6242, weighted_loss: 2.4184, label: 3, bag_size: 520
batch 299, loss: 0.8288, instance_loss: 0.5519, weighted_loss: 0.7457, label: 3, bag_size: 102
batch 319, loss: 1.9509, instance_loss: 0.6007, weighted_loss: 1.5458, label: 1, bag_size: 483
batch 339, loss: 1.3100, instance_loss: 0.5072, weighted_loss: 1.0692, label: 3, bag_size: 473
batch 359, loss: 1.7460, instance_loss: 0.5452, weighted_loss: 1.3857, label: 4, bag_size: 196
batch 379, loss: 1.1350, instance_loss: 0.4679, weighted_loss: 0.9349, label: 3, bag_size: 1021
batch 399, loss: 0.7465, instance_loss: 0.4735, weighted_loss: 0.6646, label: 2, bag_size: 535
batch 419, loss: 1.6516, instance_loss: 0.5164, weighted_loss: 1.3110, label: 1, bag_size: 618
batch 439, loss: 3.1331, instance_loss: 0.7427, weighted_loss: 2.4159, label: 2, bag_size: 809
batch 459, loss: 0.9191, instance_loss: 0.4459, weighted_loss: 0.7771, label: 0, bag_size: 493
batch 479, loss: 0.8374, instance_loss: 0.4271, weighted_loss: 0.7143, label: 4, bag_size: 1041
batch 499, loss: 1.0095, instance_loss: 0.4574, weighted_loss: 0.8438, label: 2, bag_size: 421
batch 519, loss: 1.0202, instance_loss: 0.4748, weighted_loss: 0.8566, label: 1, bag_size: 672
batch 539, loss: 1.5611, instance_loss: 0.4940, weighted_loss: 1.2409, label: 1, bag_size: 390
batch 559, loss: 1.6988, instance_loss: 0.5361, weighted_loss: 1.3500, label: 3, bag_size: 474
batch 579, loss: 1.3860, instance_loss: 0.6275, weighted_loss: 1.1585, label: 2, bag_size: 779


class 0 clustering acc 0.9965909090909091: correct 23679/23760
class 1 clustering acc 0.04019360269360269: correct 191/4752
Epoch: 18, train_loss: 1.2151, train_clustering_loss:  0.4863, train_error: 0.5404
class 0: acc 0.8064516129032258, correct 100/124
class 1: acc 0.32231404958677684, correct 39/121
class 2: acc 0.29245283018867924, correct 31/106
class 3: acc 0.3968253968253968, correct 50/126
class 4: acc 0.452991452991453, correct 53/117

Val Set, val_loss: 1.2487, val_error: 0.5405, auc: 0.8034
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6893, instance_loss: 0.5430, weighted_loss: 1.3454, label: 2, bag_size: 1308
batch 39, loss: 1.1455, instance_loss: 0.4747, weighted_loss: 0.9443, label: 2, bag_size: 285
batch 59, loss: 2.0260, instance_loss: 0.6053, weighted_loss: 1.5998, label: 4, bag_size: 530
batch 79, loss: 1.3358, instance_loss: 0.8117, weighted_loss: 1.1786, label: 4, bag_size: 854
batch 99, loss: 0.9071, instance_loss: 0.3969, weighted_loss: 0.7540, label: 2, bag_size: 380
batch 119, loss: 1.0697, instance_loss: 0.4533, weighted_loss: 0.8847, label: 3, bag_size: 818
batch 139, loss: 0.1498, instance_loss: 0.2905, weighted_loss: 0.1920, label: 0, bag_size: 51
batch 159, loss: 0.0045, instance_loss: 0.1962, weighted_loss: 0.0620, label: 0, bag_size: 258
batch 179, loss: 1.2499, instance_loss: 0.4998, weighted_loss: 1.0249, label: 3, bag_size: 486
batch 199, loss: 1.4794, instance_loss: 0.5056, weighted_loss: 1.1873, label: 1, bag_size: 823
batch 219, loss: 1.0699, instance_loss: 0.4938, weighted_loss: 0.8971, label: 2, bag_size: 404
batch 239, loss: 1.7929, instance_loss: 0.6730, weighted_loss: 1.4569, label: 2, bag_size: 96
batch 259, loss: 1.1523, instance_loss: 0.4855, weighted_loss: 0.9522, label: 1, bag_size: 106
batch 279, loss: 0.1158, instance_loss: 0.2753, weighted_loss: 0.1636, label: 0, bag_size: 188
batch 299, loss: 0.0642, instance_loss: 0.2239, weighted_loss: 0.1122, label: 0, bag_size: 493
batch 319, loss: 1.0103, instance_loss: 0.4460, weighted_loss: 0.8410, label: 2, bag_size: 1013
batch 339, loss: 0.0837, instance_loss: 0.4335, weighted_loss: 0.1887, label: 2, bag_size: 1608
batch 359, loss: 0.8570, instance_loss: 0.5136, weighted_loss: 0.7540, label: 3, bag_size: 282
batch 379, loss: 0.8650, instance_loss: 0.4600, weighted_loss: 0.7435, label: 3, bag_size: 739
batch 399, loss: 2.5633, instance_loss: 0.5868, weighted_loss: 1.9703, label: 2, bag_size: 713
batch 419, loss: 1.1921, instance_loss: 0.5599, weighted_loss: 1.0024, label: 1, bag_size: 892
batch 439, loss: 1.1305, instance_loss: 0.5244, weighted_loss: 0.9486, label: 1, bag_size: 371
batch 459, loss: 1.4442, instance_loss: 0.4483, weighted_loss: 1.1454, label: 2, bag_size: 522
batch 479, loss: 2.1990, instance_loss: 0.4837, weighted_loss: 1.6844, label: 4, bag_size: 886
batch 499, loss: 1.1114, instance_loss: 0.5261, weighted_loss: 0.9358, label: 3, bag_size: 369
batch 519, loss: 1.3926, instance_loss: 0.4724, weighted_loss: 1.1165, label: 2, bag_size: 530
batch 539, loss: 1.3807, instance_loss: 0.4628, weighted_loss: 1.1053, label: 1, bag_size: 1121
batch 559, loss: 0.6511, instance_loss: 0.4496, weighted_loss: 0.5906, label: 4, bag_size: 627
batch 579, loss: 0.6826, instance_loss: 0.4446, weighted_loss: 0.6112, label: 4, bag_size: 520


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.04713804713804714: correct 224/4752
Epoch: 19, train_loss: 1.1317, train_clustering_loss:  0.4767, train_error: 0.4966
class 0: acc 0.8454545454545455, correct 93/110
class 1: acc 0.4827586206896552, correct 70/145
class 2: acc 0.34782608695652173, correct 40/115
class 3: acc 0.4224137931034483, correct 49/116
class 4: acc 0.4351851851851852, correct 47/108

Val Set, val_loss: 1.1641, val_error: 0.4459, auc: 0.8123
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.188076 --> 1.164071).  Saving model ...


batch 19, loss: 0.2751, instance_loss: 0.2939, weighted_loss: 0.2807, label: 0, bag_size: 702
batch 39, loss: 0.5918, instance_loss: 0.4301, weighted_loss: 0.5433, label: 2, bag_size: 410
batch 59, loss: 1.1529, instance_loss: 0.4718, weighted_loss: 0.9486, label: 0, bag_size: 223
batch 79, loss: 0.1771, instance_loss: 0.3950, weighted_loss: 0.2424, label: 0, bag_size: 80
batch 99, loss: 0.5714, instance_loss: 0.4070, weighted_loss: 0.5221, label: 4, bag_size: 574
batch 119, loss: 1.5160, instance_loss: 0.5260, weighted_loss: 1.2190, label: 3, bag_size: 598
batch 139, loss: 0.2808, instance_loss: 0.2473, weighted_loss: 0.2708, label: 0, bag_size: 223
batch 159, loss: 0.8143, instance_loss: 0.3981, weighted_loss: 0.6894, label: 3, bag_size: 1154
batch 179, loss: 0.8493, instance_loss: 0.4255, weighted_loss: 0.7222, label: 3, bag_size: 1328
batch 199, loss: 0.0147, instance_loss: 0.2959, weighted_loss: 0.0991, label: 0, bag_size: 15
batch 219, loss: 1.7518, instance_loss: 0.5277, weighted_loss: 1.3846, label: 1, bag_size: 742
batch 239, loss: 1.5707, instance_loss: 0.4868, weighted_loss: 1.2456, label: 1, bag_size: 697
batch 259, loss: 3.5028, instance_loss: 0.7811, weighted_loss: 2.6863, label: 2, bag_size: 258
batch 279, loss: 1.0165, instance_loss: 0.4385, weighted_loss: 0.8431, label: 3, bag_size: 149
batch 299, loss: 1.9668, instance_loss: 0.6135, weighted_loss: 1.5608, label: 2, bag_size: 640
batch 319, loss: 1.9980, instance_loss: 0.5351, weighted_loss: 1.5591, label: 1, bag_size: 272
batch 339, loss: 0.6619, instance_loss: 0.4406, weighted_loss: 0.5955, label: 4, bag_size: 204
batch 359, loss: 4.3411, instance_loss: 0.5956, weighted_loss: 3.2174, label: 2, bag_size: 219
batch 379, loss: 0.7450, instance_loss: 0.4719, weighted_loss: 0.6630, label: 1, bag_size: 766
batch 399, loss: 1.2027, instance_loss: 0.4726, weighted_loss: 0.9836, label: 3, bag_size: 472
batch 419, loss: 0.0342, instance_loss: 0.2558, weighted_loss: 0.1007, label: 0, bag_size: 51
batch 439, loss: 1.2325, instance_loss: 0.6309, weighted_loss: 1.0520, label: 4, bag_size: 1351
batch 459, loss: 0.5452, instance_loss: 0.4332, weighted_loss: 0.5116, label: 0, bag_size: 317
batch 479, loss: 0.8054, instance_loss: 0.4579, weighted_loss: 0.7011, label: 3, bag_size: 472
batch 499, loss: 1.0731, instance_loss: 0.4859, weighted_loss: 0.8969, label: 4, bag_size: 1077
batch 519, loss: 0.6332, instance_loss: 0.4379, weighted_loss: 0.5746, label: 4, bag_size: 652
batch 539, loss: 0.4362, instance_loss: 0.4888, weighted_loss: 0.4520, label: 2, bag_size: 596
batch 559, loss: 2.3520, instance_loss: 0.6134, weighted_loss: 1.8304, label: 1, bag_size: 272
batch 579, loss: 1.3356, instance_loss: 0.5007, weighted_loss: 1.0851, label: 1, bag_size: 490


class 0 clustering acc 0.9948232323232323: correct 23637/23760
class 1 clustering acc 0.0625: correct 297/4752
Epoch: 20, train_loss: 1.1559, train_clustering_loss:  0.4706, train_error: 0.4731
class 0: acc 0.8394160583941606, correct 115/137
class 1: acc 0.36363636363636365, correct 40/110
class 2: acc 0.39215686274509803, correct 40/102
class 3: acc 0.4732824427480916, correct 62/131
class 4: acc 0.49122807017543857, correct 56/114

Val Set, val_loss: 1.2719, val_error: 0.5946, auc: 0.7929
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9312, instance_loss: 0.7762, weighted_loss: 0.8847, label: 3, bag_size: 98
batch 39, loss: 1.6450, instance_loss: 0.5300, weighted_loss: 1.3105, label: 2, bag_size: 286
batch 59, loss: 0.5742, instance_loss: 0.4467, weighted_loss: 0.5360, label: 4, bag_size: 780
batch 79, loss: 1.1499, instance_loss: 0.5727, weighted_loss: 0.9768, label: 3, bag_size: 566
batch 99, loss: 1.1745, instance_loss: 0.5468, weighted_loss: 0.9862, label: 1, bag_size: 1009
batch 119, loss: 3.1490, instance_loss: 0.8595, weighted_loss: 2.4622, label: 0, bag_size: 370
batch 139, loss: 1.1255, instance_loss: 0.4228, weighted_loss: 0.9147, label: 2, bag_size: 799
batch 159, loss: 0.6168, instance_loss: 0.4485, weighted_loss: 0.5663, label: 4, bag_size: 1041
batch 179, loss: 0.8109, instance_loss: 0.4105, weighted_loss: 0.6908, label: 3, bag_size: 369
batch 199, loss: 3.1924, instance_loss: 0.7256, weighted_loss: 2.4524, label: 3, bag_size: 638
batch 219, loss: 1.1967, instance_loss: 0.5381, weighted_loss: 0.9991, label: 2, bag_size: 1066
batch 239, loss: 1.1962, instance_loss: 0.5020, weighted_loss: 0.9879, label: 2, bag_size: 363
batch 259, loss: 0.8479, instance_loss: 0.4413, weighted_loss: 0.7259, label: 4, bag_size: 318
batch 279, loss: 0.8992, instance_loss: 0.4796, weighted_loss: 0.7733, label: 3, bag_size: 102
batch 299, loss: 1.2384, instance_loss: 0.5094, weighted_loss: 1.0197, label: 4, bag_size: 318
batch 319, loss: 0.0992, instance_loss: 0.1934, weighted_loss: 0.1274, label: 0, bag_size: 221
batch 339, loss: 0.0761, instance_loss: 0.2198, weighted_loss: 0.1192, label: 0, bag_size: 103
batch 359, loss: 0.0437, instance_loss: 0.2493, weighted_loss: 0.1054, label: 0, bag_size: 230
batch 379, loss: 1.0537, instance_loss: 0.4672, weighted_loss: 0.8777, label: 3, bag_size: 489
batch 399, loss: 1.3121, instance_loss: 0.4948, weighted_loss: 1.0669, label: 3, bag_size: 872
batch 419, loss: 0.8487, instance_loss: 0.4570, weighted_loss: 0.7312, label: 4, bag_size: 1041
batch 439, loss: 0.9448, instance_loss: 0.4529, weighted_loss: 0.7972, label: 3, bag_size: 779
batch 459, loss: 0.5305, instance_loss: 0.4244, weighted_loss: 0.4987, label: 0, bag_size: 306
batch 479, loss: 0.9731, instance_loss: 0.4303, weighted_loss: 0.8102, label: 2, bag_size: 597
batch 499, loss: 2.1780, instance_loss: 0.5947, weighted_loss: 1.7030, label: 1, bag_size: 350
batch 519, loss: 1.0221, instance_loss: 0.4329, weighted_loss: 0.8453, label: 1, bag_size: 534
batch 539, loss: 1.1337, instance_loss: 0.4879, weighted_loss: 0.9400, label: 1, bag_size: 960
batch 559, loss: 1.1988, instance_loss: 0.5052, weighted_loss: 0.9907, label: 1, bag_size: 1023
batch 579, loss: 0.8989, instance_loss: 0.4460, weighted_loss: 0.7630, label: 3, bag_size: 818


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.05555555555555555: correct 264/4752
Epoch: 21, train_loss: 1.1997, train_clustering_loss:  0.4857, train_error: 0.5269
class 0: acc 0.7355371900826446, correct 89/121
class 1: acc 0.2782608695652174, correct 32/115
class 2: acc 0.4453125, correct 57/128
class 3: acc 0.35964912280701755, correct 41/114
class 4: acc 0.5344827586206896, correct 62/116

Val Set, val_loss: 1.2080, val_error: 0.5541, auc: 0.8058
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9675, instance_loss: 0.4766, weighted_loss: 0.8203, label: 3, bag_size: 498
batch 39, loss: 1.9614, instance_loss: 0.7603, weighted_loss: 1.6011, label: 1, bag_size: 44
batch 59, loss: 1.0618, instance_loss: 0.4919, weighted_loss: 0.8908, label: 1, bag_size: 823
batch 79, loss: 1.2232, instance_loss: 0.4406, weighted_loss: 0.9884, label: 2, bag_size: 706
batch 99, loss: 1.9626, instance_loss: 0.6050, weighted_loss: 1.5553, label: 3, bag_size: 1057
batch 119, loss: 0.6799, instance_loss: 0.4683, weighted_loss: 0.6164, label: 3, bag_size: 301
batch 139, loss: 1.9103, instance_loss: 0.4889, weighted_loss: 1.4839, label: 1, bag_size: 381
batch 159, loss: 1.2223, instance_loss: 0.4957, weighted_loss: 1.0043, label: 1, bag_size: 599
batch 179, loss: 0.9406, instance_loss: 0.5100, weighted_loss: 0.8114, label: 4, bag_size: 685
batch 199, loss: 2.6490, instance_loss: 0.6101, weighted_loss: 2.0373, label: 2, bag_size: 629
batch 219, loss: 0.8903, instance_loss: 0.4856, weighted_loss: 0.7689, label: 4, bag_size: 204
batch 239, loss: 0.9494, instance_loss: 0.4865, weighted_loss: 0.8105, label: 4, bag_size: 868
batch 259, loss: 0.9214, instance_loss: 0.4476, weighted_loss: 0.7793, label: 2, bag_size: 613
batch 279, loss: 2.7721, instance_loss: 0.6807, weighted_loss: 2.1447, label: 3, bag_size: 856
batch 299, loss: 1.6665, instance_loss: 0.5269, weighted_loss: 1.3246, label: 3, bag_size: 194
batch 319, loss: 1.4259, instance_loss: 0.4637, weighted_loss: 1.1372, label: 2, bag_size: 258
batch 339, loss: 1.5530, instance_loss: 0.4976, weighted_loss: 1.2364, label: 1, bag_size: 829
batch 359, loss: 0.0000, instance_loss: 0.5024, weighted_loss: 0.1507, label: 1, bag_size: 669
batch 379, loss: 0.6893, instance_loss: 0.4415, weighted_loss: 0.6149, label: 2, bag_size: 549
batch 399, loss: 0.4650, instance_loss: 0.3816, weighted_loss: 0.4400, label: 2, bag_size: 613
batch 419, loss: 0.1125, instance_loss: 0.2376, weighted_loss: 0.1500, label: 0, bag_size: 295
batch 439, loss: 0.6459, instance_loss: 0.5980, weighted_loss: 0.6315, label: 3, bag_size: 737
batch 459, loss: 1.5284, instance_loss: 0.6930, weighted_loss: 1.2778, label: 1, bag_size: 1091
batch 479, loss: 0.8190, instance_loss: 0.4889, weighted_loss: 0.7199, label: 3, bag_size: 364
batch 499, loss: 2.5758, instance_loss: 0.6197, weighted_loss: 1.9890, label: 0, bag_size: 273
batch 519, loss: 4.6441, instance_loss: 0.5965, weighted_loss: 3.4298, label: 4, bag_size: 530
batch 539, loss: 1.8281, instance_loss: 0.5442, weighted_loss: 1.4429, label: 3, bag_size: 423
batch 559, loss: 2.0471, instance_loss: 0.5574, weighted_loss: 1.6002, label: 2, bag_size: 627
batch 579, loss: 0.2589, instance_loss: 0.4955, weighted_loss: 0.3299, label: 4, bag_size: 231


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.034511784511784514: correct 164/4752
Epoch: 22, train_loss: 1.1801, train_clustering_loss:  0.4898, train_error: 0.5067
class 0: acc 0.7272727272727273, correct 88/121
class 1: acc 0.4186046511627907, correct 54/129
class 2: acc 0.38333333333333336, correct 46/120
class 3: acc 0.4396551724137931, correct 51/116
class 4: acc 0.5, correct 54/108

Val Set, val_loss: 1.2217, val_error: 0.5405, auc: 0.7958
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8004, instance_loss: 0.4420, weighted_loss: 0.6928, label: 2, bag_size: 613
batch 39, loss: 0.9498, instance_loss: 0.3869, weighted_loss: 0.7809, label: 3, bag_size: 615
batch 59, loss: 0.7799, instance_loss: 0.5017, weighted_loss: 0.6964, label: 1, bag_size: 925
batch 79, loss: 1.6480, instance_loss: 0.5878, weighted_loss: 1.3299, label: 2, bag_size: 640
batch 99, loss: 0.5867, instance_loss: 0.4611, weighted_loss: 0.5490, label: 4, bag_size: 228
batch 119, loss: 0.1002, instance_loss: 0.2812, weighted_loss: 0.1545, label: 0, bag_size: 97
batch 139, loss: 1.1428, instance_loss: 0.5216, weighted_loss: 0.9564, label: 3, bag_size: 499
batch 159, loss: 1.4881, instance_loss: 0.5318, weighted_loss: 1.2012, label: 0, bag_size: 428
batch 179, loss: 1.4726, instance_loss: 0.7134, weighted_loss: 1.2448, label: 3, bag_size: 608
batch 199, loss: 1.5516, instance_loss: 0.4875, weighted_loss: 1.2324, label: 2, bag_size: 421
batch 219, loss: 0.0565, instance_loss: 0.2803, weighted_loss: 0.1236, label: 0, bag_size: 285
batch 239, loss: 0.4216, instance_loss: 0.3929, weighted_loss: 0.4130, label: 4, bag_size: 652
batch 259, loss: 1.3726, instance_loss: 0.4737, weighted_loss: 1.1029, label: 2, bag_size: 627
batch 279, loss: 2.4019, instance_loss: 0.5563, weighted_loss: 1.8483, label: 2, bag_size: 629
batch 299, loss: 1.8247, instance_loss: 0.6135, weighted_loss: 1.4614, label: 1, bag_size: 419
batch 319, loss: 0.6774, instance_loss: 0.4120, weighted_loss: 0.5978, label: 4, bag_size: 744
batch 339, loss: 0.7308, instance_loss: 0.4461, weighted_loss: 0.6454, label: 4, bag_size: 446
batch 359, loss: 4.2572, instance_loss: 0.5837, weighted_loss: 3.1551, label: 4, bag_size: 101
batch 379, loss: 0.3609, instance_loss: 0.4800, weighted_loss: 0.3966, label: 0, bag_size: 316
batch 399, loss: 1.1279, instance_loss: 0.5094, weighted_loss: 0.9423, label: 1, bag_size: 599
batch 419, loss: 1.9889, instance_loss: 0.5140, weighted_loss: 1.5464, label: 3, bag_size: 474
batch 439, loss: 0.3095, instance_loss: 0.3308, weighted_loss: 0.3159, label: 0, bag_size: 397
batch 459, loss: 1.5841, instance_loss: 0.5314, weighted_loss: 1.2683, label: 2, bag_size: 717
batch 479, loss: 0.7255, instance_loss: 0.4480, weighted_loss: 0.6423, label: 1, bag_size: 599
batch 499, loss: 1.5391, instance_loss: 0.4453, weighted_loss: 1.2110, label: 2, bag_size: 421
batch 519, loss: 1.0243, instance_loss: 0.4803, weighted_loss: 0.8611, label: 1, bag_size: 960
batch 539, loss: 0.0613, instance_loss: 0.2325, weighted_loss: 0.1126, label: 0, bag_size: 306
batch 559, loss: 0.7608, instance_loss: 0.4293, weighted_loss: 0.6614, label: 3, bag_size: 496
batch 579, loss: 1.1461, instance_loss: 0.5517, weighted_loss: 0.9678, label: 1, bag_size: 371


class 0 clustering acc 0.9981481481481481: correct 23716/23760
class 1 clustering acc 0.020833333333333332: correct 99/4752
Epoch: 23, train_loss: 1.1683, train_clustering_loss:  0.4899, train_error: 0.4832
class 0: acc 0.7105263157894737, correct 81/114
class 1: acc 0.4715447154471545, correct 58/123
class 2: acc 0.4666666666666667, correct 56/120
class 3: acc 0.4580152671755725, correct 60/131
class 4: acc 0.49056603773584906, correct 52/106

Val Set, val_loss: 1.3144, val_error: 0.5270, auc: 0.7831
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7916, instance_loss: 0.4962, weighted_loss: 0.7030, label: 3, bag_size: 473
batch 39, loss: 0.8446, instance_loss: 0.5012, weighted_loss: 0.7416, label: 4, bag_size: 468
batch 59, loss: 0.7029, instance_loss: 0.4638, weighted_loss: 0.6311, label: 2, bag_size: 690
batch 79, loss: 0.9492, instance_loss: 0.4017, weighted_loss: 0.7849, label: 2, bag_size: 543
batch 99, loss: 1.6017, instance_loss: 0.5206, weighted_loss: 1.2774, label: 3, bag_size: 344
batch 119, loss: 1.0118, instance_loss: 0.4718, weighted_loss: 0.8498, label: 1, bag_size: 981
batch 139, loss: 0.8052, instance_loss: 0.4936, weighted_loss: 0.7117, label: 3, bag_size: 245
batch 159, loss: 0.7364, instance_loss: 0.5013, weighted_loss: 0.6659, label: 4, bag_size: 854
batch 179, loss: 0.0465, instance_loss: 0.3842, weighted_loss: 0.1478, label: 2, bag_size: 1608
batch 199, loss: 0.7380, instance_loss: 0.5104, weighted_loss: 0.6697, label: 1, bag_size: 231
batch 219, loss: 2.2167, instance_loss: 0.6034, weighted_loss: 1.7327, label: 3, bag_size: 154
batch 239, loss: 1.6220, instance_loss: 0.5108, weighted_loss: 1.2886, label: 2, bag_size: 208
batch 259, loss: 0.0059, instance_loss: 0.2195, weighted_loss: 0.0700, label: 0, bag_size: 80
batch 279, loss: 0.6993, instance_loss: 0.5179, weighted_loss: 0.6449, label: 3, bag_size: 817
batch 299, loss: 0.1652, instance_loss: 0.2720, weighted_loss: 0.1972, label: 0, bag_size: 212
batch 319, loss: 2.0539, instance_loss: 0.6334, weighted_loss: 1.6278, label: 4, bag_size: 228
batch 339, loss: 0.8040, instance_loss: 0.4234, weighted_loss: 0.6898, label: 1, bag_size: 823
batch 359, loss: 0.8608, instance_loss: 0.5347, weighted_loss: 0.7629, label: 3, bag_size: 398
batch 379, loss: 0.9847, instance_loss: 0.5071, weighted_loss: 0.8414, label: 3, bag_size: 856
batch 399, loss: 0.8992, instance_loss: 0.5132, weighted_loss: 0.7834, label: 4, bag_size: 780
batch 419, loss: 1.2958, instance_loss: 0.5333, weighted_loss: 1.0671, label: 2, bag_size: 554
batch 439, loss: 1.7978, instance_loss: 0.5487, weighted_loss: 1.4231, label: 1, bag_size: 184
batch 459, loss: 2.2425, instance_loss: 0.5834, weighted_loss: 1.7448, label: 4, bag_size: 1351
batch 479, loss: 0.8396, instance_loss: 0.4867, weighted_loss: 0.7337, label: 1, bag_size: 321
batch 499, loss: 0.4670, instance_loss: 0.3529, weighted_loss: 0.4328, label: 4, bag_size: 266
batch 519, loss: 0.9624, instance_loss: 0.5206, weighted_loss: 0.8299, label: 3, bag_size: 897
batch 539, loss: 1.0350, instance_loss: 0.4445, weighted_loss: 0.8579, label: 0, bag_size: 1414
batch 559, loss: 0.0501, instance_loss: 0.2310, weighted_loss: 0.1043, label: 0, bag_size: 188
batch 579, loss: 0.8796, instance_loss: 0.4406, weighted_loss: 0.7479, label: 2, bag_size: 702


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.03935185185185185: correct 187/4752
Epoch: 24, train_loss: 1.1565, train_clustering_loss:  0.4847, train_error: 0.5051
class 0: acc 0.7734375, correct 99/128
class 1: acc 0.358974358974359, correct 42/117
class 2: acc 0.3761467889908257, correct 41/109
class 3: acc 0.38596491228070173, correct 44/114
class 4: acc 0.5396825396825397, correct 68/126

Val Set, val_loss: 1.1130, val_error: 0.5135, auc: 0.8326
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.164071 --> 1.113036).  Saving model ...


batch 19, loss: 0.4389, instance_loss: 0.3542, weighted_loss: 0.4135, label: 0, bag_size: 74
batch 39, loss: 0.4365, instance_loss: 0.3915, weighted_loss: 0.4230, label: 4, bag_size: 746
batch 59, loss: 1.0003, instance_loss: 0.4754, weighted_loss: 0.8428, label: 1, bag_size: 697
batch 79, loss: 0.3770, instance_loss: 0.5030, weighted_loss: 0.4148, label: 2, bag_size: 376
batch 99, loss: 0.6596, instance_loss: 0.4146, weighted_loss: 0.5861, label: 3, bag_size: 944
batch 119, loss: 0.6034, instance_loss: 0.3881, weighted_loss: 0.5388, label: 3, bag_size: 739
batch 139, loss: 0.3192, instance_loss: 0.4503, weighted_loss: 0.3585, label: 0, bag_size: 316
batch 159, loss: 0.7551, instance_loss: 0.4398, weighted_loss: 0.6605, label: 3, bag_size: 457
batch 179, loss: 0.8326, instance_loss: 0.4366, weighted_loss: 0.7138, label: 3, bag_size: 428
batch 199, loss: 2.4756, instance_loss: 0.6423, weighted_loss: 1.9256, label: 4, bag_size: 333
batch 219, loss: 2.0870, instance_loss: 0.5771, weighted_loss: 1.6340, label: 1, bag_size: 390
batch 239, loss: 0.0161, instance_loss: 0.1244, weighted_loss: 0.0486, label: 0, bag_size: 295
batch 259, loss: 0.0420, instance_loss: 0.2405, weighted_loss: 0.1016, label: 0, bag_size: 397
batch 279, loss: 0.5298, instance_loss: 0.5768, weighted_loss: 0.5439, label: 4, bag_size: 854
batch 299, loss: 1.0598, instance_loss: 0.4604, weighted_loss: 0.8800, label: 3, bag_size: 684
batch 319, loss: 2.5079, instance_loss: 0.6769, weighted_loss: 1.9586, label: 1, bag_size: 272
batch 339, loss: 0.8144, instance_loss: 0.4206, weighted_loss: 0.6962, label: 2, bag_size: 779
batch 359, loss: 0.0569, instance_loss: 0.2596, weighted_loss: 0.1177, label: 0, bag_size: 578
batch 379, loss: 2.0901, instance_loss: 0.6031, weighted_loss: 1.6440, label: 1, bag_size: 272
batch 399, loss: 0.7189, instance_loss: 0.5114, weighted_loss: 0.6566, label: 1, bag_size: 972
batch 419, loss: 0.7777, instance_loss: 0.4888, weighted_loss: 0.6910, label: 4, bag_size: 1351
batch 439, loss: 0.0919, instance_loss: 0.3576, weighted_loss: 0.1716, label: 4, bag_size: 231
batch 459, loss: 1.0277, instance_loss: 0.5513, weighted_loss: 0.8848, label: 1, bag_size: 355
batch 479, loss: 1.3314, instance_loss: 0.5532, weighted_loss: 1.0979, label: 3, bag_size: 476
batch 499, loss: 0.6335, instance_loss: 0.4982, weighted_loss: 0.5929, label: 3, bag_size: 474
batch 519, loss: 1.3148, instance_loss: 0.5465, weighted_loss: 1.0843, label: 3, bag_size: 301
batch 539, loss: 0.0062, instance_loss: 0.1413, weighted_loss: 0.0467, label: 0, bag_size: 221
batch 559, loss: 1.0004, instance_loss: 0.4621, weighted_loss: 0.8389, label: 3, bag_size: 779
batch 579, loss: 0.8665, instance_loss: 0.5496, weighted_loss: 0.7714, label: 3, bag_size: 818


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.07491582491582492: correct 356/4752
Epoch: 25, train_loss: 1.1156, train_clustering_loss:  0.4736, train_error: 0.4966
class 0: acc 0.813953488372093, correct 105/129
class 1: acc 0.3389830508474576, correct 40/118
class 2: acc 0.40336134453781514, correct 48/119
class 3: acc 0.48717948717948717, correct 57/117
class 4: acc 0.44144144144144143, correct 49/111

Val Set, val_loss: 1.1917, val_error: 0.5000, auc: 0.8163
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8108, instance_loss: 0.5388, weighted_loss: 0.7292, label: 4, bag_size: 937
batch 39, loss: 2.5754, instance_loss: 0.6975, weighted_loss: 2.0120, label: 0, bag_size: 370
batch 59, loss: 1.0098, instance_loss: 0.4224, weighted_loss: 0.8336, label: 0, bag_size: 478
batch 79, loss: 1.2781, instance_loss: 0.4698, weighted_loss: 1.0356, label: 1, bag_size: 874
batch 99, loss: 2.1086, instance_loss: 0.5613, weighted_loss: 1.6444, label: 1, bag_size: 397
batch 119, loss: 0.5111, instance_loss: 0.4387, weighted_loss: 0.4894, label: 1, bag_size: 748
batch 139, loss: 0.6547, instance_loss: 0.4367, weighted_loss: 0.5893, label: 1, bag_size: 522
batch 159, loss: 1.5195, instance_loss: 0.5432, weighted_loss: 1.2266, label: 4, bag_size: 530
batch 179, loss: 0.0313, instance_loss: 0.1186, weighted_loss: 0.0575, label: 0, bag_size: 101
batch 199, loss: 2.0977, instance_loss: 0.6161, weighted_loss: 1.6532, label: 4, bag_size: 590
batch 219, loss: 1.0267, instance_loss: 0.4541, weighted_loss: 0.8549, label: 3, bag_size: 337
batch 239, loss: 3.1757, instance_loss: 0.6336, weighted_loss: 2.4131, label: 2, bag_size: 1319
batch 259, loss: 1.5959, instance_loss: 0.5355, weighted_loss: 1.2778, label: 4, bag_size: 729
batch 279, loss: 0.0430, instance_loss: 0.2597, weighted_loss: 0.1080, label: 0, bag_size: 15
batch 299, loss: 0.5286, instance_loss: 0.4240, weighted_loss: 0.4972, label: 2, bag_size: 571
batch 319, loss: 0.9387, instance_loss: 0.4115, weighted_loss: 0.7805, label: 2, bag_size: 851
batch 339, loss: 0.0968, instance_loss: 0.2235, weighted_loss: 0.1348, label: 0, bag_size: 71
batch 359, loss: 2.6104, instance_loss: 0.6158, weighted_loss: 2.0120, label: 1, bag_size: 381
batch 379, loss: 2.7787, instance_loss: 0.5696, weighted_loss: 2.1160, label: 3, bag_size: 520
batch 399, loss: 0.9723, instance_loss: 0.5114, weighted_loss: 0.8340, label: 1, bag_size: 483
batch 419, loss: 0.9481, instance_loss: 0.4920, weighted_loss: 0.8113, label: 1, bag_size: 328
batch 439, loss: 2.4896, instance_loss: 0.8032, weighted_loss: 1.9836, label: 0, bag_size: 352
batch 459, loss: 1.6263, instance_loss: 0.5262, weighted_loss: 1.2963, label: 3, bag_size: 797
batch 479, loss: 0.9936, instance_loss: 0.4314, weighted_loss: 0.8249, label: 2, bag_size: 253
batch 499, loss: 2.9504, instance_loss: 0.5757, weighted_loss: 2.2380, label: 2, bag_size: 829
batch 519, loss: 0.7287, instance_loss: 0.5329, weighted_loss: 0.6699, label: 3, bag_size: 674
batch 539, loss: 2.4654, instance_loss: 0.5773, weighted_loss: 1.8990, label: 1, bag_size: 361
batch 559, loss: 0.0951, instance_loss: 0.3185, weighted_loss: 0.1621, label: 0, bag_size: 59
batch 579, loss: 1.4870, instance_loss: 0.4490, weighted_loss: 1.1756, label: 1, bag_size: 840


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.0707070707070707: correct 336/4752
Epoch: 26, train_loss: 1.1265, train_clustering_loss:  0.4752, train_error: 0.4764
class 0: acc 0.824, correct 103/125
class 1: acc 0.4098360655737705, correct 50/122
class 2: acc 0.415929203539823, correct 47/113
class 3: acc 0.4715447154471545, correct 58/123
class 4: acc 0.4774774774774775, correct 53/111

Val Set, val_loss: 1.1525, val_error: 0.4730, auc: 0.8268
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0109, instance_loss: 0.4224, weighted_loss: 0.8343, label: 3, bag_size: 309
batch 39, loss: 1.8291, instance_loss: 0.5287, weighted_loss: 1.4390, label: 4, bag_size: 246
batch 59, loss: 0.6567, instance_loss: 0.4610, weighted_loss: 0.5980, label: 2, bag_size: 288
batch 79, loss: 1.3497, instance_loss: 0.4813, weighted_loss: 1.0892, label: 4, bag_size: 476
batch 99, loss: 1.2399, instance_loss: 0.5439, weighted_loss: 1.0311, label: 1, bag_size: 381
batch 119, loss: 1.2089, instance_loss: 0.4782, weighted_loss: 0.9897, label: 4, bag_size: 1351
batch 139, loss: 0.0638, instance_loss: 0.3169, weighted_loss: 0.1397, label: 0, bag_size: 230
batch 159, loss: 2.5185, instance_loss: 0.6407, weighted_loss: 1.9552, label: 0, bag_size: 964
batch 179, loss: 0.8745, instance_loss: 0.4694, weighted_loss: 0.7530, label: 4, bag_size: 714
batch 199, loss: 0.0468, instance_loss: 0.1951, weighted_loss: 0.0913, label: 0, bag_size: 341
batch 219, loss: 1.1820, instance_loss: 0.4238, weighted_loss: 0.9546, label: 2, bag_size: 445
batch 239, loss: 1.0015, instance_loss: 0.5230, weighted_loss: 0.8579, label: 3, bag_size: 804
batch 259, loss: 1.3173, instance_loss: 0.5268, weighted_loss: 1.0802, label: 3, bag_size: 301
batch 279, loss: 0.8594, instance_loss: 0.3508, weighted_loss: 0.7068, label: 4, bag_size: 1031
batch 299, loss: 0.8104, instance_loss: 0.4288, weighted_loss: 0.6959, label: 4, bag_size: 775
batch 319, loss: 0.3133, instance_loss: 0.3813, weighted_loss: 0.3337, label: 4, bag_size: 228
batch 339, loss: 0.0852, instance_loss: 0.2142, weighted_loss: 0.1239, label: 0, bag_size: 706
batch 359, loss: 2.2526, instance_loss: 0.5702, weighted_loss: 1.7478, label: 1, bag_size: 840
batch 379, loss: 0.1723, instance_loss: 0.2685, weighted_loss: 0.2011, label: 0, bag_size: 306
batch 399, loss: 0.2127, instance_loss: 0.3367, weighted_loss: 0.2499, label: 0, bag_size: 71
batch 419, loss: 0.7071, instance_loss: 0.4028, weighted_loss: 0.6158, label: 2, bag_size: 706
batch 439, loss: 1.1366, instance_loss: 0.5884, weighted_loss: 0.9722, label: 3, bag_size: 228
batch 459, loss: 1.4606, instance_loss: 0.5845, weighted_loss: 1.1977, label: 1, bag_size: 525
batch 479, loss: 1.7785, instance_loss: 0.5980, weighted_loss: 1.4243, label: 1, bag_size: 617
batch 499, loss: 2.0869, instance_loss: 0.5237, weighted_loss: 1.6179, label: 3, bag_size: 258
batch 519, loss: 0.2594, instance_loss: 0.3698, weighted_loss: 0.2925, label: 0, bag_size: 159
batch 539, loss: 1.2028, instance_loss: 0.4936, weighted_loss: 0.9900, label: 3, bag_size: 282
batch 559, loss: 0.7795, instance_loss: 0.4898, weighted_loss: 0.6926, label: 1, bag_size: 814
batch 579, loss: 1.0800, instance_loss: 0.4550, weighted_loss: 0.8925, label: 3, bag_size: 872


class 0 clustering acc 0.9967171717171717: correct 23682/23760
class 1 clustering acc 0.05134680134680135: correct 244/4752
Epoch: 27, train_loss: 1.1658, train_clustering_loss:  0.4823, train_error: 0.5370
class 0: acc 0.7522935779816514, correct 82/109
class 1: acc 0.23300970873786409, correct 24/103
class 2: acc 0.4672131147540984, correct 57/122
class 3: acc 0.3333333333333333, correct 43/129
class 4: acc 0.5267175572519084, correct 69/131

Val Set, val_loss: 1.2605, val_error: 0.5676, auc: 0.8074
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0936, instance_loss: 0.4541, weighted_loss: 0.9018, label: 3, bag_size: 727
batch 39, loss: 0.9121, instance_loss: 0.3765, weighted_loss: 0.7514, label: 2, bag_size: 340
batch 59, loss: 0.6622, instance_loss: 0.4571, weighted_loss: 0.6007, label: 1, bag_size: 398
batch 79, loss: 0.4571, instance_loss: 0.4317, weighted_loss: 0.4495, label: 4, bag_size: 685
batch 99, loss: 1.0879, instance_loss: 0.4919, weighted_loss: 0.9091, label: 4, bag_size: 238
batch 119, loss: 1.1231, instance_loss: 0.5215, weighted_loss: 0.9426, label: 3, bag_size: 451
batch 139, loss: 1.3293, instance_loss: 0.5909, weighted_loss: 1.1078, label: 2, bag_size: 96
batch 159, loss: 0.6087, instance_loss: 0.4809, weighted_loss: 0.5704, label: 3, bag_size: 928
batch 179, loss: 3.8707, instance_loss: 0.7405, weighted_loss: 2.9317, label: 4, bag_size: 310
batch 199, loss: 1.2686, instance_loss: 0.5632, weighted_loss: 1.0570, label: 2, bag_size: 171
batch 219, loss: 0.7504, instance_loss: 0.3887, weighted_loss: 0.6419, label: 1, bag_size: 1121
batch 239, loss: 1.0672, instance_loss: 0.6004, weighted_loss: 0.9271, label: 4, bag_size: 690
batch 259, loss: 0.8321, instance_loss: 0.4854, weighted_loss: 0.7281, label: 1, bag_size: 591
batch 279, loss: 1.1562, instance_loss: 0.4900, weighted_loss: 0.9564, label: 1, bag_size: 874
batch 299, loss: 1.2874, instance_loss: 0.4902, weighted_loss: 1.0482, label: 2, bag_size: 597
batch 319, loss: 0.6460, instance_loss: 0.5763, weighted_loss: 0.6251, label: 1, bag_size: 44
batch 339, loss: 0.8750, instance_loss: 0.3956, weighted_loss: 0.7312, label: 2, bag_size: 598
batch 359, loss: 0.3463, instance_loss: 0.4290, weighted_loss: 0.3711, label: 4, bag_size: 266
batch 379, loss: 0.2770, instance_loss: 0.5187, weighted_loss: 0.3495, label: 2, bag_size: 936
batch 399, loss: 0.3185, instance_loss: 0.3778, weighted_loss: 0.3363, label: 0, bag_size: 513
batch 419, loss: 0.4621, instance_loss: 0.3714, weighted_loss: 0.4349, label: 4, bag_size: 266
batch 439, loss: 0.0197, instance_loss: 0.1047, weighted_loss: 0.0452, label: 0, bag_size: 133
batch 459, loss: 0.6874, instance_loss: 0.4761, weighted_loss: 0.6240, label: 1, bag_size: 413
batch 479, loss: 1.2858, instance_loss: 0.4434, weighted_loss: 1.0331, label: 1, bag_size: 617
batch 499, loss: 0.0222, instance_loss: 0.1587, weighted_loss: 0.0632, label: 0, bag_size: 306
batch 519, loss: 1.1121, instance_loss: 0.5143, weighted_loss: 0.9328, label: 0, bag_size: 62
batch 539, loss: 1.8369, instance_loss: 0.6195, weighted_loss: 1.4717, label: 1, bag_size: 391
batch 559, loss: 0.2895, instance_loss: 0.3516, weighted_loss: 0.3081, label: 2, bag_size: 614
batch 579, loss: 1.1947, instance_loss: 0.4661, weighted_loss: 0.9761, label: 1, bag_size: 599


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.06902356902356903: correct 328/4752
Epoch: 28, train_loss: 1.1219, train_clustering_loss:  0.4714, train_error: 0.5067
class 0: acc 0.813953488372093, correct 105/129
class 1: acc 0.4921875, correct 63/128
class 2: acc 0.2807017543859649, correct 32/114
class 3: acc 0.34210526315789475, correct 39/114
class 4: acc 0.4954128440366973, correct 54/109

Val Set, val_loss: 1.1794, val_error: 0.5405, auc: 0.8122
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.11655405405405406: correct 69/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1220, instance_loss: 0.3736, weighted_loss: 0.1975, label: 0, bag_size: 79
batch 39, loss: 0.0063, instance_loss: 0.1967, weighted_loss: 0.0634, label: 0, bag_size: 59
batch 59, loss: 0.7793, instance_loss: 0.4637, weighted_loss: 0.6846, label: 4, bag_size: 204
batch 79, loss: 1.3003, instance_loss: 0.4877, weighted_loss: 1.0565, label: 2, bag_size: 640
batch 99, loss: 0.7811, instance_loss: 0.4140, weighted_loss: 0.6709, label: 3, bag_size: 476
batch 119, loss: 0.6501, instance_loss: 0.4104, weighted_loss: 0.5782, label: 3, bag_size: 102
batch 139, loss: 1.8562, instance_loss: 0.6260, weighted_loss: 1.4871, label: 4, bag_size: 246
batch 159, loss: 0.3030, instance_loss: 0.3648, weighted_loss: 0.3215, label: 4, bag_size: 948
batch 179, loss: 1.7224, instance_loss: 0.5689, weighted_loss: 1.3763, label: 1, bag_size: 184
batch 199, loss: 1.7526, instance_loss: 0.4912, weighted_loss: 1.3742, label: 3, bag_size: 789
batch 219, loss: 0.9286, instance_loss: 0.4666, weighted_loss: 0.7900, label: 3, bag_size: 459
batch 239, loss: 1.4080, instance_loss: 0.4681, weighted_loss: 1.1260, label: 4, bag_size: 731
batch 259, loss: 1.1814, instance_loss: 0.5238, weighted_loss: 0.9841, label: 2, bag_size: 288
batch 279, loss: 0.9511, instance_loss: 0.6961, weighted_loss: 0.8746, label: 3, bag_size: 98
batch 299, loss: 1.2396, instance_loss: 0.4809, weighted_loss: 1.0120, label: 3, bag_size: 499
batch 319, loss: 2.7209, instance_loss: 0.6190, weighted_loss: 2.0904, label: 2, bag_size: 1308
batch 339, loss: 1.2179, instance_loss: 0.4968, weighted_loss: 1.0015, label: 1, bag_size: 766
batch 359, loss: 0.6948, instance_loss: 0.4644, weighted_loss: 0.6257, label: 2, bag_size: 613
batch 379, loss: 0.1693, instance_loss: 0.2395, weighted_loss: 0.1904, label: 0, bag_size: 210
batch 399, loss: 0.9244, instance_loss: 0.4112, weighted_loss: 0.7705, label: 3, bag_size: 499
batch 419, loss: 0.0694, instance_loss: 0.3073, weighted_loss: 0.1408, label: 4, bag_size: 769
batch 439, loss: 0.2803, instance_loss: 0.3504, weighted_loss: 0.3013, label: 2, bag_size: 614
batch 459, loss: 1.0493, instance_loss: 0.4206, weighted_loss: 0.8607, label: 2, bag_size: 998
batch 479, loss: 0.4419, instance_loss: 0.3500, weighted_loss: 0.4143, label: 2, bag_size: 1079
batch 499, loss: 2.1695, instance_loss: 0.7209, weighted_loss: 1.7349, label: 4, bag_size: 310
batch 519, loss: 1.0572, instance_loss: 0.5132, weighted_loss: 0.8940, label: 0, bag_size: 269
batch 539, loss: 1.3532, instance_loss: 0.5341, weighted_loss: 1.1075, label: 3, bag_size: 1060
batch 559, loss: 0.0000, instance_loss: 0.5209, weighted_loss: 0.1563, label: 1, bag_size: 669
batch 579, loss: 1.6068, instance_loss: 0.4214, weighted_loss: 1.2512, label: 2, bag_size: 361


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.07596801346801346: correct 361/4752
Epoch: 29, train_loss: 1.1145, train_clustering_loss:  0.4764, train_error: 0.4663
class 0: acc 0.7480314960629921, correct 95/127
class 1: acc 0.37735849056603776, correct 40/106
class 2: acc 0.44144144144144143, correct 49/111
class 3: acc 0.5681818181818182, correct 75/132
class 4: acc 0.4915254237288136, correct 58/118

Val Set, val_loss: 1.1410, val_error: 0.5541, auc: 0.8126
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7375, instance_loss: 0.4400, weighted_loss: 0.6483, label: 4, bag_size: 695
batch 39, loss: 0.0139, instance_loss: 0.2065, weighted_loss: 0.0717, label: 0, bag_size: 706
batch 59, loss: 0.6085, instance_loss: 0.4230, weighted_loss: 0.5529, label: 2, bag_size: 171
batch 79, loss: 0.7148, instance_loss: 0.4770, weighted_loss: 0.6435, label: 0, bag_size: 317
batch 99, loss: 0.2610, instance_loss: 0.4622, weighted_loss: 0.3213, label: 4, bag_size: 124
batch 119, loss: 2.9033, instance_loss: 0.7235, weighted_loss: 2.2493, label: 2, bag_size: 219
batch 139, loss: 0.9092, instance_loss: 0.4514, weighted_loss: 0.7718, label: 2, bag_size: 754
batch 159, loss: 0.3024, instance_loss: 0.2449, weighted_loss: 0.2852, label: 0, bag_size: 399
batch 179, loss: 0.9992, instance_loss: 0.5003, weighted_loss: 0.8495, label: 1, bag_size: 960
batch 199, loss: 0.8044, instance_loss: 0.5132, weighted_loss: 0.7170, label: 2, bag_size: 410
batch 219, loss: 0.1710, instance_loss: 0.3612, weighted_loss: 0.2280, label: 0, bag_size: 141
batch 239, loss: 1.0795, instance_loss: 0.5094, weighted_loss: 0.9085, label: 0, bag_size: 283
batch 259, loss: 0.2998, instance_loss: 0.4022, weighted_loss: 0.3305, label: 4, bag_size: 563
batch 279, loss: 1.1444, instance_loss: 0.5152, weighted_loss: 0.9556, label: 3, bag_size: 474
batch 299, loss: 0.7241, instance_loss: 0.4092, weighted_loss: 0.6296, label: 2, bag_size: 363
batch 319, loss: 0.8293, instance_loss: 0.4620, weighted_loss: 0.7191, label: 3, bag_size: 727
batch 339, loss: 0.6548, instance_loss: 0.4220, weighted_loss: 0.5850, label: 1, bag_size: 460
batch 359, loss: 1.4922, instance_loss: 0.5492, weighted_loss: 1.2093, label: 3, bag_size: 523
batch 379, loss: 0.1543, instance_loss: 0.3321, weighted_loss: 0.2076, label: 0, bag_size: 428
batch 399, loss: 0.3965, instance_loss: 0.3992, weighted_loss: 0.3973, label: 4, bag_size: 744
batch 419, loss: 2.9935, instance_loss: 0.7113, weighted_loss: 2.3088, label: 0, bag_size: 352
batch 439, loss: 0.9727, instance_loss: 0.4448, weighted_loss: 0.8143, label: 4, bag_size: 110
batch 459, loss: 0.6888, instance_loss: 0.4942, weighted_loss: 0.6304, label: 1, bag_size: 391
batch 479, loss: 0.7504, instance_loss: 0.5871, weighted_loss: 0.7014, label: 1, bag_size: 141
batch 499, loss: 0.9180, instance_loss: 0.4317, weighted_loss: 0.7721, label: 4, bag_size: 1077
batch 519, loss: 2.0791, instance_loss: 0.5719, weighted_loss: 1.6269, label: 2, bag_size: 706
batch 539, loss: 1.2121, instance_loss: 0.4855, weighted_loss: 0.9941, label: 3, bag_size: 476
batch 559, loss: 0.7686, instance_loss: 0.4070, weighted_loss: 0.6602, label: 1, bag_size: 829
batch 579, loss: 4.5132, instance_loss: 0.7984, weighted_loss: 3.3987, label: 1, bag_size: 45


class 0 clustering acc 0.9957070707070707: correct 23658/23760
class 1 clustering acc 0.07154882154882154: correct 340/4752
Epoch: 30, train_loss: 1.0849, train_clustering_loss:  0.4710, train_error: 0.4579
class 0: acc 0.7868852459016393, correct 96/122
class 1: acc 0.46551724137931033, correct 54/116
class 2: acc 0.3684210526315789, correct 35/95
class 3: acc 0.40476190476190477, correct 51/126
class 4: acc 0.6370370370370371, correct 86/135

Val Set, val_loss: 1.1511, val_error: 0.4865, auc: 0.8456
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0625: correct 37/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3999, instance_loss: 0.5017, weighted_loss: 1.1304, label: 2, bag_size: 851
batch 39, loss: 0.3176, instance_loss: 0.3688, weighted_loss: 0.3329, label: 4, bag_size: 960
batch 59, loss: 1.6829, instance_loss: 0.5789, weighted_loss: 1.3517, label: 0, bag_size: 115
batch 79, loss: 2.7911, instance_loss: 0.6023, weighted_loss: 2.1344, label: 3, bag_size: 323
batch 99, loss: 1.5505, instance_loss: 0.5702, weighted_loss: 1.2564, label: 2, bag_size: 337
batch 119, loss: 1.2732, instance_loss: 0.5135, weighted_loss: 1.0453, label: 2, bag_size: 321
batch 139, loss: 0.4789, instance_loss: 0.4589, weighted_loss: 0.4729, label: 4, bag_size: 665
batch 159, loss: 0.3176, instance_loss: 0.3028, weighted_loss: 0.3131, label: 0, bag_size: 613
batch 179, loss: 1.1617, instance_loss: 0.5067, weighted_loss: 0.9652, label: 0, bag_size: 587
batch 199, loss: 0.6392, instance_loss: 0.4050, weighted_loss: 0.5689, label: 0, bag_size: 455
batch 219, loss: 0.5893, instance_loss: 0.4605, weighted_loss: 0.5507, label: 1, bag_size: 544
batch 239, loss: 0.8755, instance_loss: 0.4275, weighted_loss: 0.7411, label: 2, bag_size: 286
batch 259, loss: 0.0973, instance_loss: 0.4714, weighted_loss: 0.2095, label: 2, bag_size: 1608
batch 279, loss: 2.8238, instance_loss: 0.6501, weighted_loss: 2.1717, label: 4, bag_size: 757
batch 299, loss: 2.2883, instance_loss: 0.5513, weighted_loss: 1.7672, label: 0, bag_size: 305
batch 319, loss: 0.7968, instance_loss: 0.4753, weighted_loss: 0.7004, label: 1, bag_size: 500
batch 339, loss: 1.0377, instance_loss: 0.5175, weighted_loss: 0.8816, label: 2, bag_size: 303
batch 359, loss: 0.4014, instance_loss: 0.4237, weighted_loss: 0.4081, label: 1, bag_size: 1104
batch 379, loss: 1.3281, instance_loss: 0.5236, weighted_loss: 1.0867, label: 2, bag_size: 659
batch 399, loss: 1.8564, instance_loss: 0.6471, weighted_loss: 1.4936, label: 0, bag_size: 587
batch 419, loss: 0.7341, instance_loss: 0.4569, weighted_loss: 0.6509, label: 2, bag_size: 410
batch 439, loss: 1.0485, instance_loss: 0.4798, weighted_loss: 0.8779, label: 1, bag_size: 960
batch 459, loss: 0.6846, instance_loss: 0.4764, weighted_loss: 0.6221, label: 1, bag_size: 814
batch 479, loss: 1.1497, instance_loss: 0.4992, weighted_loss: 0.9546, label: 4, bag_size: 395
batch 499, loss: 0.7852, instance_loss: 0.4368, weighted_loss: 0.6807, label: 3, bag_size: 102
batch 519, loss: 0.7751, instance_loss: 0.4664, weighted_loss: 0.6825, label: 3, bag_size: 282
batch 539, loss: 0.7201, instance_loss: 0.4285, weighted_loss: 0.6327, label: 2, bag_size: 315
batch 559, loss: 1.9228, instance_loss: 0.4938, weighted_loss: 1.4941, label: 1, bag_size: 350
batch 579, loss: 0.8580, instance_loss: 0.4163, weighted_loss: 0.7255, label: 2, bag_size: 883


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.0563973063973064: correct 268/4752
Epoch: 31, train_loss: 1.0976, train_clustering_loss:  0.4780, train_error: 0.4545
class 0: acc 0.7565217391304347, correct 87/115
class 1: acc 0.5652173913043478, correct 78/138
class 2: acc 0.3684210526315789, correct 42/114
class 3: acc 0.46226415094339623, correct 49/106
class 4: acc 0.5619834710743802, correct 68/121

Val Set, val_loss: 1.1699, val_error: 0.5000, auc: 0.8279
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0116, instance_loss: 0.1520, weighted_loss: 0.0537, label: 0, bag_size: 350
batch 39, loss: 1.7742, instance_loss: 0.5661, weighted_loss: 1.4118, label: 3, bag_size: 337
batch 59, loss: 0.0994, instance_loss: 0.3102, weighted_loss: 0.1626, label: 0, bag_size: 97
batch 79, loss: 2.0505, instance_loss: 0.5594, weighted_loss: 1.6031, label: 2, bag_size: 512
batch 99, loss: 2.2377, instance_loss: 0.5962, weighted_loss: 1.7452, label: 2, bag_size: 934
batch 119, loss: 1.4174, instance_loss: 0.5004, weighted_loss: 1.1423, label: 2, bag_size: 851
batch 139, loss: 1.2138, instance_loss: 0.4454, weighted_loss: 0.9833, label: 1, bag_size: 544
batch 159, loss: 0.8632, instance_loss: 0.5216, weighted_loss: 0.7607, label: 4, bag_size: 824
batch 179, loss: 0.7671, instance_loss: 0.4046, weighted_loss: 0.6583, label: 4, bag_size: 498
batch 199, loss: 1.0197, instance_loss: 0.4921, weighted_loss: 0.8614, label: 0, bag_size: 404
batch 219, loss: 2.1141, instance_loss: 0.5265, weighted_loss: 1.6378, label: 3, bag_size: 453
batch 239, loss: 1.3042, instance_loss: 0.4640, weighted_loss: 1.0522, label: 1, bag_size: 697
batch 259, loss: 0.7114, instance_loss: 0.3996, weighted_loss: 0.6179, label: 2, bag_size: 783
batch 279, loss: 0.9495, instance_loss: 0.5257, weighted_loss: 0.8224, label: 3, bag_size: 641
batch 299, loss: 1.1617, instance_loss: 0.4708, weighted_loss: 0.9544, label: 4, bag_size: 780
batch 319, loss: 0.2807, instance_loss: 0.2855, weighted_loss: 0.2822, label: 0, bag_size: 223
batch 339, loss: 0.8253, instance_loss: 0.5319, weighted_loss: 0.7373, label: 3, bag_size: 393
batch 359, loss: 0.0278, instance_loss: 0.3651, weighted_loss: 0.1290, label: 0, bag_size: 435
batch 379, loss: 0.8531, instance_loss: 0.4756, weighted_loss: 0.7398, label: 1, bag_size: 1009
batch 399, loss: 1.1991, instance_loss: 0.4471, weighted_loss: 0.9735, label: 3, bag_size: 1078
batch 419, loss: 1.0438, instance_loss: 0.4583, weighted_loss: 0.8681, label: 2, bag_size: 769
batch 439, loss: 0.5772, instance_loss: 0.4132, weighted_loss: 0.5280, label: 3, bag_size: 625
batch 459, loss: 1.1325, instance_loss: 0.4917, weighted_loss: 0.9403, label: 2, bag_size: 240
batch 479, loss: 1.5780, instance_loss: 0.5656, weighted_loss: 1.2743, label: 2, bag_size: 941
batch 499, loss: 0.8206, instance_loss: 0.4855, weighted_loss: 0.7201, label: 0, bag_size: 178
batch 519, loss: 2.6711, instance_loss: 0.5233, weighted_loss: 2.0268, label: 3, bag_size: 473
batch 539, loss: 0.9186, instance_loss: 0.5018, weighted_loss: 0.7936, label: 3, bag_size: 473
batch 559, loss: 0.8452, instance_loss: 0.4379, weighted_loss: 0.7230, label: 4, bag_size: 690
batch 579, loss: 0.1709, instance_loss: 0.3431, weighted_loss: 0.2225, label: 4, bag_size: 854


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.05997474747474747: correct 285/4752
Epoch: 32, train_loss: 1.1408, train_clustering_loss:  0.4708, train_error: 0.4865
class 0: acc 0.7606837606837606, correct 89/117
class 1: acc 0.4344262295081967, correct 53/122
class 2: acc 0.3391304347826087, correct 39/115
class 3: acc 0.40336134453781514, correct 48/119
class 4: acc 0.628099173553719, correct 76/121

Val Set, val_loss: 1.1222, val_error: 0.4459, auc: 0.8341
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.06756756756756757: correct 40/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0643, instance_loss: 0.6338, weighted_loss: 0.9352, label: 2, bag_size: 404
batch 39, loss: 0.6696, instance_loss: 0.4023, weighted_loss: 0.5894, label: 2, bag_size: 769
batch 59, loss: 1.7314, instance_loss: 0.5654, weighted_loss: 1.3816, label: 4, bag_size: 318
batch 79, loss: 1.0367, instance_loss: 0.4633, weighted_loss: 0.8647, label: 4, bag_size: 730
batch 99, loss: 0.5713, instance_loss: 0.4952, weighted_loss: 0.5485, label: 1, bag_size: 231
batch 119, loss: 0.9670, instance_loss: 0.4715, weighted_loss: 0.8183, label: 4, bag_size: 937
batch 139, loss: 0.2737, instance_loss: 0.3839, weighted_loss: 0.3068, label: 0, bag_size: 345
batch 159, loss: 0.1455, instance_loss: 0.2170, weighted_loss: 0.1669, label: 0, bag_size: 227
batch 179, loss: 0.1513, instance_loss: 0.4429, weighted_loss: 0.2388, label: 1, bag_size: 1497
batch 199, loss: 0.0111, instance_loss: 0.1024, weighted_loss: 0.0385, label: 0, bag_size: 101
batch 219, loss: 0.5026, instance_loss: 0.4294, weighted_loss: 0.4806, label: 3, bag_size: 625
batch 239, loss: 0.7698, instance_loss: 0.5013, weighted_loss: 0.6892, label: 3, bag_size: 476
batch 259, loss: 1.3293, instance_loss: 0.4686, weighted_loss: 1.0711, label: 3, bag_size: 523
batch 279, loss: 1.8689, instance_loss: 0.6423, weighted_loss: 1.5009, label: 1, bag_size: 413
batch 299, loss: 0.9501, instance_loss: 0.4753, weighted_loss: 0.8077, label: 3, bag_size: 857
batch 319, loss: 0.1458, instance_loss: 0.1736, weighted_loss: 0.1542, label: 0, bag_size: 227
batch 339, loss: 0.8609, instance_loss: 0.3819, weighted_loss: 0.7172, label: 0, bag_size: 77
batch 359, loss: 1.6299, instance_loss: 0.5387, weighted_loss: 1.3025, label: 3, bag_size: 492
batch 379, loss: 2.2849, instance_loss: 0.6237, weighted_loss: 1.7865, label: 0, bag_size: 888
batch 399, loss: 0.0669, instance_loss: 0.2810, weighted_loss: 0.1312, label: 4, bag_size: 1113
batch 419, loss: 3.1404, instance_loss: 0.8841, weighted_loss: 2.4635, label: 1, bag_size: 617
batch 439, loss: 0.8975, instance_loss: 0.4891, weighted_loss: 0.7750, label: 3, bag_size: 102
batch 459, loss: 0.9714, instance_loss: 0.4341, weighted_loss: 0.8102, label: 1, bag_size: 1103
batch 479, loss: 1.5790, instance_loss: 0.5358, weighted_loss: 1.2661, label: 3, bag_size: 615
batch 499, loss: 0.7555, instance_loss: 0.6132, weighted_loss: 0.7128, label: 2, bag_size: 571
batch 519, loss: 0.0306, instance_loss: 0.3570, weighted_loss: 0.1285, label: 4, bag_size: 769
batch 539, loss: 0.9071, instance_loss: 0.4786, weighted_loss: 0.7786, label: 3, bag_size: 894
batch 559, loss: 0.1008, instance_loss: 0.2770, weighted_loss: 0.1536, label: 0, bag_size: 397
batch 579, loss: 1.1660, instance_loss: 0.4898, weighted_loss: 0.9632, label: 2, bag_size: 380


class 0 clustering acc 0.995496632996633: correct 23653/23760
class 1 clustering acc 0.09364478114478114: correct 445/4752
Epoch: 33, train_loss: 1.0465, train_clustering_loss:  0.4637, train_error: 0.4310
class 0: acc 0.8188976377952756, correct 104/127
class 1: acc 0.45081967213114754, correct 55/122
class 2: acc 0.45871559633027525, correct 50/109
class 3: acc 0.48360655737704916, correct 59/122
class 4: acc 0.6140350877192983, correct 70/114

Val Set, val_loss: 1.4965, val_error: 0.5946, auc: 0.7902
class 0 clustering acc 0.9918918918918919: correct 2936/2960
class 1 clustering acc 0.17398648648648649: correct 103/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.8002, instance_loss: 0.4864, weighted_loss: 0.7061, label: 3, bag_size: 982
batch 39, loss: 0.2654, instance_loss: 0.3042, weighted_loss: 0.2770, label: 2, bag_size: 614
batch 59, loss: 0.9853, instance_loss: 0.5464, weighted_loss: 0.8536, label: 1, bag_size: 389
batch 79, loss: 0.5583, instance_loss: 0.5293, weighted_loss: 0.5496, label: 4, bag_size: 652
batch 99, loss: 3.5732, instance_loss: 0.6903, weighted_loss: 2.7083, label: 0, bag_size: 608
batch 119, loss: 0.7472, instance_loss: 0.4429, weighted_loss: 0.6559, label: 1, bag_size: 1103
batch 139, loss: 0.1117, instance_loss: 0.2056, weighted_loss: 0.1399, label: 0, bag_size: 513
batch 159, loss: 0.4491, instance_loss: 0.4636, weighted_loss: 0.4535, label: 1, bag_size: 672
batch 179, loss: 1.1539, instance_loss: 0.5411, weighted_loss: 0.9701, label: 3, bag_size: 109
batch 199, loss: 1.0934, instance_loss: 0.5003, weighted_loss: 0.9155, label: 4, bag_size: 312
batch 219, loss: 0.6596, instance_loss: 0.4247, weighted_loss: 0.5891, label: 1, bag_size: 599
batch 239, loss: 1.4790, instance_loss: 0.5959, weighted_loss: 1.2141, label: 3, bag_size: 309
batch 259, loss: 1.1947, instance_loss: 0.4823, weighted_loss: 0.9810, label: 4, bag_size: 238
batch 279, loss: 1.3993, instance_loss: 0.4524, weighted_loss: 1.1152, label: 2, bag_size: 315
batch 299, loss: 2.6575, instance_loss: 0.5743, weighted_loss: 2.0326, label: 2, bag_size: 1074
batch 319, loss: 0.7388, instance_loss: 0.5379, weighted_loss: 0.6786, label: 3, bag_size: 817
batch 339, loss: 2.0906, instance_loss: 0.5340, weighted_loss: 1.6236, label: 0, bag_size: 1414
batch 359, loss: 1.8986, instance_loss: 0.7099, weighted_loss: 1.5420, label: 0, bag_size: 352
batch 379, loss: 1.0261, instance_loss: 0.4879, weighted_loss: 0.8646, label: 2, bag_size: 557
batch 399, loss: 1.9067, instance_loss: 0.5158, weighted_loss: 1.4894, label: 2, bag_size: 582
batch 419, loss: 0.0091, instance_loss: 0.0886, weighted_loss: 0.0329, label: 0, bag_size: 236
batch 439, loss: 1.8832, instance_loss: 0.5615, weighted_loss: 1.4867, label: 1, bag_size: 397
batch 459, loss: 1.1216, instance_loss: 0.5054, weighted_loss: 0.9367, label: 3, bag_size: 727
batch 479, loss: 1.1033, instance_loss: 0.5034, weighted_loss: 0.9233, label: 3, bag_size: 510
batch 499, loss: 0.0936, instance_loss: 0.1740, weighted_loss: 0.1177, label: 0, bag_size: 97
batch 519, loss: 1.0963, instance_loss: 0.5173, weighted_loss: 0.9226, label: 4, bag_size: 886
batch 539, loss: 0.0084, instance_loss: 0.1710, weighted_loss: 0.0572, label: 0, bag_size: 236
batch 559, loss: 1.6268, instance_loss: 0.4962, weighted_loss: 1.2876, label: 2, bag_size: 582
batch 579, loss: 0.6885, instance_loss: 0.4434, weighted_loss: 0.6149, label: 4, bag_size: 627


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.07765151515151515: correct 369/4752
Epoch: 34, train_loss: 1.1389, train_clustering_loss:  0.4741, train_error: 0.4731
class 0: acc 0.7567567567567568, correct 84/111
class 1: acc 0.6258503401360545, correct 92/147
class 2: acc 0.3177570093457944, correct 34/107
class 3: acc 0.39316239316239315, correct 46/117
class 4: acc 0.5089285714285714, correct 57/112

Val Set, val_loss: 1.1000, val_error: 0.5000, auc: 0.8334
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.113036 --> 1.100015).  Saving model ...


batch 19, loss: 1.8772, instance_loss: 0.5135, weighted_loss: 1.4681, label: 2, bag_size: 361
batch 39, loss: 0.0138, instance_loss: 0.1385, weighted_loss: 0.0512, label: 0, bag_size: 366
batch 59, loss: 0.1509, instance_loss: 0.6819, weighted_loss: 0.3102, label: 0, bag_size: 435
batch 79, loss: 1.1237, instance_loss: 0.4888, weighted_loss: 0.9332, label: 1, bag_size: 398
batch 99, loss: 1.3245, instance_loss: 0.5322, weighted_loss: 1.0868, label: 1, bag_size: 372
batch 119, loss: 2.0182, instance_loss: 0.6978, weighted_loss: 1.6221, label: 2, bag_size: 177
batch 139, loss: 1.1056, instance_loss: 0.4379, weighted_loss: 0.9053, label: 2, bag_size: 1003
batch 159, loss: 0.1454, instance_loss: 0.1800, weighted_loss: 0.1558, label: 0, bag_size: 73
batch 179, loss: 0.3089, instance_loss: 0.3659, weighted_loss: 0.3260, label: 4, bag_size: 409
batch 199, loss: 0.7257, instance_loss: 0.4136, weighted_loss: 0.6320, label: 4, bag_size: 895
batch 219, loss: 1.2699, instance_loss: 0.6350, weighted_loss: 1.0794, label: 3, bag_size: 109
batch 239, loss: 2.7859, instance_loss: 0.6615, weighted_loss: 2.1486, label: 4, bag_size: 264
batch 259, loss: 1.2052, instance_loss: 0.5758, weighted_loss: 1.0164, label: 1, bag_size: 1091
batch 279, loss: 0.7248, instance_loss: 0.7105, weighted_loss: 0.7205, label: 1, bag_size: 106
batch 299, loss: 1.2460, instance_loss: 0.4994, weighted_loss: 1.0220, label: 2, bag_size: 135
batch 319, loss: 1.1423, instance_loss: 0.7366, weighted_loss: 1.0206, label: 3, bag_size: 543
batch 339, loss: 0.6788, instance_loss: 0.3706, weighted_loss: 0.5864, label: 4, bag_size: 875
batch 359, loss: 0.9145, instance_loss: 0.6237, weighted_loss: 0.8273, label: 3, bag_size: 737
batch 379, loss: 0.4796, instance_loss: 0.3736, weighted_loss: 0.4478, label: 4, bag_size: 418
batch 399, loss: 0.9942, instance_loss: 0.5082, weighted_loss: 0.8484, label: 2, bag_size: 290
batch 419, loss: 0.1328, instance_loss: 0.2595, weighted_loss: 0.1708, label: 0, bag_size: 366
batch 439, loss: 0.8710, instance_loss: 0.4402, weighted_loss: 0.7417, label: 2, bag_size: 315
batch 459, loss: 0.8059, instance_loss: 0.4936, weighted_loss: 0.7122, label: 1, bag_size: 620
batch 479, loss: 0.7046, instance_loss: 0.4599, weighted_loss: 0.6312, label: 0, bag_size: 578
batch 499, loss: 1.7635, instance_loss: 0.5267, weighted_loss: 1.3925, label: 4, bag_size: 703
batch 519, loss: 0.5544, instance_loss: 0.4287, weighted_loss: 0.5167, label: 2, bag_size: 317
batch 539, loss: 1.0630, instance_loss: 0.4618, weighted_loss: 0.8827, label: 3, bag_size: 473
batch 559, loss: 0.0022, instance_loss: 0.0529, weighted_loss: 0.0174, label: 0, bag_size: 133
batch 579, loss: 0.5732, instance_loss: 0.4451, weighted_loss: 0.5348, label: 3, bag_size: 1007


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.09490740740740741: correct 451/4752
Epoch: 35, train_loss: 1.0359, train_clustering_loss:  0.4673, train_error: 0.4411
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.475, correct 57/120
class 2: acc 0.41964285714285715, correct 47/112
class 3: acc 0.5630252100840336, correct 67/119
class 4: acc 0.5213675213675214, correct 61/117

Val Set, val_loss: 1.1471, val_error: 0.5000, auc: 0.8235
class 0 clustering acc 0.9905405405405405: correct 2932/2960
class 1 clustering acc 0.13006756756756757: correct 77/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1731, instance_loss: 0.5136, weighted_loss: 0.9753, label: 1, bag_size: 500
batch 39, loss: 0.9491, instance_loss: 0.5006, weighted_loss: 0.8145, label: 1, bag_size: 697
batch 59, loss: 0.5672, instance_loss: 0.4049, weighted_loss: 0.5185, label: 2, bag_size: 290
batch 79, loss: 1.4846, instance_loss: 0.4957, weighted_loss: 1.1879, label: 4, bag_size: 1064
batch 99, loss: 0.8353, instance_loss: 0.4635, weighted_loss: 0.7237, label: 4, bag_size: 755
batch 119, loss: 2.0028, instance_loss: 0.5227, weighted_loss: 1.5588, label: 2, bag_size: 318
batch 139, loss: 0.9116, instance_loss: 0.4886, weighted_loss: 0.7847, label: 1, bag_size: 855
batch 159, loss: 0.7422, instance_loss: 0.5168, weighted_loss: 0.6746, label: 3, bag_size: 300
batch 179, loss: 0.6905, instance_loss: 0.8003, weighted_loss: 0.7235, label: 2, bag_size: 596
batch 199, loss: 1.5664, instance_loss: 0.5374, weighted_loss: 1.2577, label: 3, bag_size: 457
batch 219, loss: 0.9426, instance_loss: 0.4223, weighted_loss: 0.7865, label: 1, bag_size: 695
batch 239, loss: 0.7409, instance_loss: 0.4538, weighted_loss: 0.6547, label: 3, bag_size: 472
batch 259, loss: 0.7131, instance_loss: 0.6290, weighted_loss: 0.6879, label: 1, bag_size: 44
batch 279, loss: 0.0131, instance_loss: 0.0955, weighted_loss: 0.0379, label: 0, bag_size: 255
batch 299, loss: 1.5591, instance_loss: 0.5427, weighted_loss: 1.2542, label: 3, bag_size: 230
batch 319, loss: 0.4964, instance_loss: 0.3714, weighted_loss: 0.4589, label: 0, bag_size: 143
batch 339, loss: 1.5669, instance_loss: 0.6066, weighted_loss: 1.2788, label: 2, bag_size: 498
batch 359, loss: 0.1571, instance_loss: 0.2902, weighted_loss: 0.1970, label: 0, bag_size: 188
batch 379, loss: 1.2034, instance_loss: 0.5023, weighted_loss: 0.9931, label: 1, bag_size: 534
batch 399, loss: 1.1027, instance_loss: 0.5230, weighted_loss: 0.9288, label: 1, bag_size: 742
batch 419, loss: 0.3078, instance_loss: 0.3929, weighted_loss: 0.3333, label: 4, bag_size: 683
batch 439, loss: 0.9105, instance_loss: 0.4390, weighted_loss: 0.7690, label: 2, bag_size: 119
batch 459, loss: 0.7167, instance_loss: 0.4105, weighted_loss: 0.6248, label: 4, bag_size: 729
batch 479, loss: 0.9275, instance_loss: 0.4364, weighted_loss: 0.7801, label: 2, bag_size: 697
batch 499, loss: 0.0479, instance_loss: 0.1242, weighted_loss: 0.0708, label: 0, bag_size: 399
batch 519, loss: 0.8123, instance_loss: 0.3820, weighted_loss: 0.6832, label: 2, bag_size: 697
batch 539, loss: 1.5445, instance_loss: 0.5615, weighted_loss: 1.2496, label: 1, bag_size: 177
batch 559, loss: 1.2165, instance_loss: 0.4550, weighted_loss: 0.9881, label: 4, bag_size: 780
batch 579, loss: 0.8385, instance_loss: 0.4630, weighted_loss: 0.7259, label: 1, bag_size: 328


class 0 clustering acc 0.9946127946127946: correct 23632/23760
class 1 clustering acc 0.06923400673400673: correct 329/4752
Epoch: 36, train_loss: 1.0707, train_clustering_loss:  0.4732, train_error: 0.4579
class 0: acc 0.7767857142857143, correct 87/112
class 1: acc 0.4453125, correct 57/128
class 2: acc 0.47368421052631576, correct 63/133
class 3: acc 0.4789915966386555, correct 57/119
class 4: acc 0.5686274509803921, correct 58/102

Val Set, val_loss: 1.1713, val_error: 0.4730, auc: 0.8229
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.0945945945945946: correct 56/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0405, instance_loss: 0.4804, weighted_loss: 0.8725, label: 1, bag_size: 522
batch 39, loss: 2.6201, instance_loss: 0.5830, weighted_loss: 2.0089, label: 2, bag_size: 629
batch 59, loss: 0.4479, instance_loss: 0.6106, weighted_loss: 0.4967, label: 0, bag_size: 283
batch 79, loss: 1.5230, instance_loss: 0.6053, weighted_loss: 1.2477, label: 1, bag_size: 355
batch 99, loss: 1.7508, instance_loss: 0.4991, weighted_loss: 1.3753, label: 1, bag_size: 1023
batch 119, loss: 0.1245, instance_loss: 0.3587, weighted_loss: 0.1948, label: 4, bag_size: 773
batch 139, loss: 0.9174, instance_loss: 0.5304, weighted_loss: 0.8013, label: 2, bag_size: 350
batch 159, loss: 1.3449, instance_loss: 0.5777, weighted_loss: 1.1147, label: 0, bag_size: 178
batch 179, loss: 0.7636, instance_loss: 0.5256, weighted_loss: 0.6922, label: 2, bag_size: 285
batch 199, loss: 1.2416, instance_loss: 0.3932, weighted_loss: 0.9871, label: 4, bag_size: 652
batch 219, loss: 4.4277, instance_loss: 0.7628, weighted_loss: 3.3282, label: 0, bag_size: 1039
batch 239, loss: 1.1604, instance_loss: 0.4640, weighted_loss: 0.9515, label: 1, bag_size: 695
batch 259, loss: 0.6306, instance_loss: 0.5319, weighted_loss: 0.6010, label: 0, bag_size: 367
batch 279, loss: 1.3906, instance_loss: 0.5266, weighted_loss: 1.1314, label: 3, bag_size: 393
batch 299, loss: 0.7277, instance_loss: 0.5003, weighted_loss: 0.6595, label: 3, bag_size: 1186
batch 319, loss: 0.0933, instance_loss: 0.1505, weighted_loss: 0.1104, label: 0, bag_size: 282
batch 339, loss: 1.7877, instance_loss: 0.6052, weighted_loss: 1.4329, label: 4, bag_size: 757
batch 359, loss: 1.4869, instance_loss: 0.4929, weighted_loss: 1.1887, label: 4, bag_size: 196
batch 379, loss: 2.0440, instance_loss: 0.6576, weighted_loss: 1.6281, label: 0, bag_size: 370
batch 399, loss: 0.8871, instance_loss: 0.4628, weighted_loss: 0.7598, label: 3, bag_size: 982
batch 419, loss: 0.3412, instance_loss: 0.3074, weighted_loss: 0.3311, label: 0, bag_size: 324
batch 439, loss: 0.4367, instance_loss: 0.3931, weighted_loss: 0.4236, label: 1, bag_size: 748
batch 459, loss: 1.8119, instance_loss: 0.5156, weighted_loss: 1.4230, label: 1, bag_size: 764
batch 479, loss: 0.5708, instance_loss: 0.4281, weighted_loss: 0.5280, label: 1, bag_size: 509
batch 499, loss: 1.6086, instance_loss: 0.5560, weighted_loss: 1.2928, label: 1, bag_size: 419
batch 519, loss: 0.6570, instance_loss: 0.3734, weighted_loss: 0.5719, label: 3, bag_size: 1186
batch 539, loss: 1.6830, instance_loss: 0.5492, weighted_loss: 1.3428, label: 1, bag_size: 1023
batch 559, loss: 0.1694, instance_loss: 0.3360, weighted_loss: 0.2194, label: 0, bag_size: 238
batch 579, loss: 0.0346, instance_loss: 0.1733, weighted_loss: 0.0762, label: 0, bag_size: 103


class 0 clustering acc 0.9953282828282828: correct 23649/23760
class 1 clustering acc 0.09154040404040405: correct 435/4752
Epoch: 37, train_loss: 1.1011, train_clustering_loss:  0.4694, train_error: 0.4714
class 0: acc 0.8278688524590164, correct 101/122
class 1: acc 0.33035714285714285, correct 37/112
class 2: acc 0.42857142857142855, correct 54/126
class 3: acc 0.5075757575757576, correct 67/132
class 4: acc 0.5392156862745098, correct 55/102

Val Set, val_loss: 1.3043, val_error: 0.5405, auc: 0.7971
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.13851351351351351: correct 82/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4101, instance_loss: 0.5443, weighted_loss: 1.1504, label: 4, bag_size: 589
batch 39, loss: 0.6463, instance_loss: 0.4674, weighted_loss: 0.5926, label: 3, bag_size: 894
batch 59, loss: 0.0838, instance_loss: 0.2047, weighted_loss: 0.1201, label: 0, bag_size: 351
batch 79, loss: 0.6091, instance_loss: 0.4162, weighted_loss: 0.5512, label: 3, bag_size: 282
batch 99, loss: 0.2704, instance_loss: 0.4141, weighted_loss: 0.3135, label: 4, bag_size: 1113
batch 119, loss: 0.8936, instance_loss: 0.4851, weighted_loss: 0.7710, label: 4, bag_size: 574
batch 139, loss: 0.3501, instance_loss: 0.3794, weighted_loss: 0.3589, label: 4, bag_size: 409
batch 159, loss: 1.1122, instance_loss: 0.4705, weighted_loss: 0.9197, label: 4, bag_size: 110
batch 179, loss: 0.2527, instance_loss: 0.2508, weighted_loss: 0.2521, label: 0, bag_size: 428
batch 199, loss: 3.0446, instance_loss: 0.7760, weighted_loss: 2.3640, label: 0, bag_size: 1039
batch 219, loss: 1.2591, instance_loss: 0.5180, weighted_loss: 1.0367, label: 3, bag_size: 312
batch 239, loss: 0.4610, instance_loss: 0.3893, weighted_loss: 0.4395, label: 4, bag_size: 506
batch 259, loss: 1.0819, instance_loss: 0.4923, weighted_loss: 0.9050, label: 2, bag_size: 697
batch 279, loss: 0.5049, instance_loss: 0.4249, weighted_loss: 0.4809, label: 0, bag_size: 277
batch 299, loss: 0.0000, instance_loss: 0.3951, weighted_loss: 0.1185, label: 1, bag_size: 669
batch 319, loss: 0.8186, instance_loss: 0.5734, weighted_loss: 0.7451, label: 1, bag_size: 605
batch 339, loss: 0.0845, instance_loss: 0.3124, weighted_loss: 0.1529, label: 0, bag_size: 282
batch 359, loss: 2.2813, instance_loss: 0.6640, weighted_loss: 1.7961, label: 3, bag_size: 533
batch 379, loss: 0.7555, instance_loss: 0.4237, weighted_loss: 0.6559, label: 2, bag_size: 337
batch 399, loss: 0.7708, instance_loss: 0.4380, weighted_loss: 0.6710, label: 4, bag_size: 639
batch 419, loss: 0.8119, instance_loss: 0.4782, weighted_loss: 0.7118, label: 0, bag_size: 62
batch 439, loss: 1.3842, instance_loss: 0.5950, weighted_loss: 1.1474, label: 3, bag_size: 1022
batch 459, loss: 1.6428, instance_loss: 0.5543, weighted_loss: 1.3162, label: 3, bag_size: 154
batch 479, loss: 0.6014, instance_loss: 0.4909, weighted_loss: 0.5682, label: 2, bag_size: 883
batch 499, loss: 1.0190, instance_loss: 0.4085, weighted_loss: 0.8359, label: 4, bag_size: 740
batch 519, loss: 0.0183, instance_loss: 0.1265, weighted_loss: 0.0508, label: 0, bag_size: 453
batch 539, loss: 0.7954, instance_loss: 0.4502, weighted_loss: 0.6918, label: 1, bag_size: 1019
batch 559, loss: 1.3321, instance_loss: 0.5563, weighted_loss: 1.0993, label: 2, bag_size: 554
batch 579, loss: 0.9392, instance_loss: 0.5053, weighted_loss: 0.8091, label: 3, bag_size: 317


class 0 clustering acc 0.9949074074074075: correct 23639/23760
class 1 clustering acc 0.10542929292929293: correct 501/4752
Epoch: 38, train_loss: 1.0484, train_clustering_loss:  0.4661, train_error: 0.4192
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.45454545454545453, correct 55/121
class 2: acc 0.4766355140186916, correct 51/107
class 3: acc 0.4576271186440678, correct 54/118
class 4: acc 0.6929133858267716, correct 88/127

Val Set, val_loss: 1.1561, val_error: 0.4730, auc: 0.8390
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.13682432432432431: correct 81/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6755, instance_loss: 0.4338, weighted_loss: 0.6030, label: 1, bag_size: 1104
batch 39, loss: 0.7257, instance_loss: 0.4459, weighted_loss: 0.6417, label: 4, bag_size: 293
batch 59, loss: 0.5201, instance_loss: 0.4145, weighted_loss: 0.4884, label: 3, bag_size: 432
batch 79, loss: 0.2443, instance_loss: 0.3233, weighted_loss: 0.2680, label: 0, bag_size: 297
batch 99, loss: 0.8831, instance_loss: 0.5026, weighted_loss: 0.7689, label: 3, bag_size: 608
batch 119, loss: 0.1713, instance_loss: 0.4030, weighted_loss: 0.2408, label: 2, bag_size: 1975
batch 139, loss: 1.2391, instance_loss: 0.4526, weighted_loss: 1.0032, label: 2, bag_size: 659
batch 159, loss: 0.6729, instance_loss: 0.4510, weighted_loss: 0.6063, label: 4, bag_size: 1031
batch 179, loss: 0.9063, instance_loss: 0.4550, weighted_loss: 0.7709, label: 4, bag_size: 1064
batch 199, loss: 2.2122, instance_loss: 0.5475, weighted_loss: 1.7128, label: 3, bag_size: 282
batch 219, loss: 0.1311, instance_loss: 0.3303, weighted_loss: 0.1908, label: 4, bag_size: 1113
batch 239, loss: 0.1759, instance_loss: 0.3408, weighted_loss: 0.2254, label: 0, bag_size: 97
batch 259, loss: 0.3033, instance_loss: 0.4868, weighted_loss: 0.3584, label: 3, bag_size: 496
batch 279, loss: 3.8152, instance_loss: 0.6586, weighted_loss: 2.8683, label: 2, bag_size: 1319
batch 299, loss: 1.1493, instance_loss: 0.5438, weighted_loss: 0.9677, label: 1, bag_size: 231
batch 319, loss: 0.0092, instance_loss: 0.1813, weighted_loss: 0.0609, label: 0, bag_size: 230
batch 339, loss: 0.0082, instance_loss: 0.1567, weighted_loss: 0.0528, label: 0, bag_size: 221
batch 359, loss: 0.9787, instance_loss: 0.6157, weighted_loss: 0.8698, label: 4, bag_size: 886
batch 379, loss: 0.0021, instance_loss: 0.1443, weighted_loss: 0.0448, label: 0, bag_size: 138
batch 399, loss: 0.5266, instance_loss: 0.4501, weighted_loss: 0.5036, label: 1, bag_size: 925
batch 419, loss: 1.0226, instance_loss: 0.4995, weighted_loss: 0.8657, label: 3, bag_size: 451
batch 439, loss: 0.2008, instance_loss: 0.4405, weighted_loss: 0.2727, label: 1, bag_size: 509
batch 459, loss: 0.5354, instance_loss: 0.4507, weighted_loss: 0.5099, label: 4, bag_size: 356
batch 479, loss: 1.8988, instance_loss: 0.6944, weighted_loss: 1.5374, label: 1, bag_size: 697
batch 499, loss: 0.5764, instance_loss: 0.4455, weighted_loss: 0.5371, label: 2, bag_size: 549
batch 519, loss: 1.3428, instance_loss: 0.4692, weighted_loss: 1.0807, label: 0, bag_size: 230
batch 539, loss: 1.5979, instance_loss: 0.5459, weighted_loss: 1.2823, label: 2, bag_size: 318
batch 559, loss: 1.1647, instance_loss: 0.5044, weighted_loss: 0.9666, label: 3, bag_size: 154
batch 579, loss: 0.9097, instance_loss: 0.4794, weighted_loss: 0.7806, label: 1, bag_size: 618


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.0867003367003367: correct 412/4752
Epoch: 39, train_loss: 1.0639, train_clustering_loss:  0.4689, train_error: 0.4562
class 0: acc 0.7698412698412699, correct 97/126
class 1: acc 0.4491525423728814, correct 53/118
class 2: acc 0.46511627906976744, correct 60/129
class 3: acc 0.5447154471544715, correct 67/123
class 4: acc 0.46938775510204084, correct 46/98

Val Set, val_loss: 1.3370, val_error: 0.5135, auc: 0.8031
class 0 clustering acc 0.9942567567567567: correct 2943/2960
class 1 clustering acc 0.16554054054054054: correct 98/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0276, instance_loss: 0.1265, weighted_loss: 0.0573, label: 0, bag_size: 51
batch 39, loss: 2.0877, instance_loss: 0.6001, weighted_loss: 1.6414, label: 2, bag_size: 208
batch 59, loss: 1.1406, instance_loss: 0.4696, weighted_loss: 0.9393, label: 3, bag_size: 476
batch 79, loss: 1.2104, instance_loss: 0.5266, weighted_loss: 1.0053, label: 2, bag_size: 288
batch 99, loss: 1.8066, instance_loss: 0.5637, weighted_loss: 1.4337, label: 2, bag_size: 754
batch 119, loss: 1.2434, instance_loss: 0.4986, weighted_loss: 1.0200, label: 1, bag_size: 960
batch 139, loss: 0.5550, instance_loss: 0.5306, weighted_loss: 0.5477, label: 2, bag_size: 176
batch 159, loss: 0.3401, instance_loss: 0.3411, weighted_loss: 0.3404, label: 4, bag_size: 773
batch 179, loss: 0.2589, instance_loss: 0.2757, weighted_loss: 0.2639, label: 0, bag_size: 351
batch 199, loss: 1.2543, instance_loss: 0.4937, weighted_loss: 1.0261, label: 2, bag_size: 337
batch 219, loss: 1.4647, instance_loss: 0.5169, weighted_loss: 1.1803, label: 3, bag_size: 1232
batch 239, loss: 1.1798, instance_loss: 0.4998, weighted_loss: 0.9758, label: 2, bag_size: 339
batch 259, loss: 1.1220, instance_loss: 0.4751, weighted_loss: 0.9279, label: 3, bag_size: 779
batch 279, loss: 0.0116, instance_loss: 0.1268, weighted_loss: 0.0462, label: 0, bag_size: 706
batch 299, loss: 0.8617, instance_loss: 0.4849, weighted_loss: 0.7486, label: 3, bag_size: 300
batch 319, loss: 0.8893, instance_loss: 0.4773, weighted_loss: 0.7657, label: 1, bag_size: 381
batch 339, loss: 0.8327, instance_loss: 0.4532, weighted_loss: 0.7188, label: 4, bag_size: 660
batch 359, loss: 1.0100, instance_loss: 0.4516, weighted_loss: 0.8425, label: 3, bag_size: 312
batch 379, loss: 1.2127, instance_loss: 0.5983, weighted_loss: 1.0284, label: 1, bag_size: 159
batch 399, loss: 0.6752, instance_loss: 0.3935, weighted_loss: 0.5907, label: 2, bag_size: 779
batch 419, loss: 0.7267, instance_loss: 0.4232, weighted_loss: 0.6356, label: 2, bag_size: 470
batch 439, loss: 5.5866, instance_loss: 0.5442, weighted_loss: 4.0739, label: 4, bag_size: 530
batch 459, loss: 0.9653, instance_loss: 0.5030, weighted_loss: 0.8266, label: 3, bag_size: 364
batch 479, loss: 3.2278, instance_loss: 0.5678, weighted_loss: 2.4298, label: 2, bag_size: 563
batch 499, loss: 0.0016, instance_loss: 0.2588, weighted_loss: 0.0787, label: 4, bag_size: 769
batch 519, loss: 0.5420, instance_loss: 0.4033, weighted_loss: 0.5004, label: 4, bag_size: 685
batch 539, loss: 0.0062, instance_loss: 0.1168, weighted_loss: 0.0394, label: 0, bag_size: 488
batch 559, loss: 0.4369, instance_loss: 0.3659, weighted_loss: 0.4156, label: 2, bag_size: 1066
batch 579, loss: 0.0344, instance_loss: 0.2661, weighted_loss: 0.1039, label: 0, bag_size: 523


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.08143939393939394: correct 387/4752
Epoch: 40, train_loss: 1.0950, train_clustering_loss:  0.4677, train_error: 0.4899
class 0: acc 0.7619047619047619, correct 96/126
class 1: acc 0.3113207547169811, correct 33/106
class 2: acc 0.45161290322580644, correct 56/124
class 3: acc 0.448, correct 56/125
class 4: acc 0.5486725663716814, correct 62/113

Val Set, val_loss: 1.1584, val_error: 0.4730, auc: 0.8342
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0625: correct 37/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.2818, instance_loss: 0.4631, weighted_loss: 1.0362, label: 2, bag_size: 498
batch 39, loss: 0.1512, instance_loss: 0.2670, weighted_loss: 0.1859, label: 0, bag_size: 159
batch 59, loss: 0.6429, instance_loss: 0.4890, weighted_loss: 0.5967, label: 4, bag_size: 742
batch 79, loss: 1.2674, instance_loss: 0.5767, weighted_loss: 1.0602, label: 2, bag_size: 392
batch 99, loss: 1.1103, instance_loss: 0.4533, weighted_loss: 0.9132, label: 4, bag_size: 310
batch 119, loss: 0.0613, instance_loss: 0.2242, weighted_loss: 0.1102, label: 0, bag_size: 188
batch 139, loss: 1.3137, instance_loss: 0.5278, weighted_loss: 1.0779, label: 1, bag_size: 697
batch 159, loss: 0.2019, instance_loss: 0.1887, weighted_loss: 0.1980, label: 0, bag_size: 295
batch 179, loss: 0.0290, instance_loss: 0.2034, weighted_loss: 0.0813, label: 0, bag_size: 397
batch 199, loss: 0.2753, instance_loss: 0.3589, weighted_loss: 0.3004, label: 2, bag_size: 402
batch 219, loss: 1.9184, instance_loss: 0.5553, weighted_loss: 1.5095, label: 1, bag_size: 695
batch 239, loss: 0.8418, instance_loss: 0.4346, weighted_loss: 0.7196, label: 1, bag_size: 960
batch 259, loss: 1.0329, instance_loss: 0.4598, weighted_loss: 0.8609, label: 1, bag_size: 874
batch 279, loss: 1.6669, instance_loss: 0.4691, weighted_loss: 1.3076, label: 1, bag_size: 823
batch 299, loss: 1.2713, instance_loss: 0.5079, weighted_loss: 1.0423, label: 2, bag_size: 697
batch 319, loss: 0.5099, instance_loss: 0.4566, weighted_loss: 0.4939, label: 2, bag_size: 348
batch 339, loss: 2.5606, instance_loss: 0.5859, weighted_loss: 1.9682, label: 0, bag_size: 745
batch 359, loss: 2.3693, instance_loss: 0.6063, weighted_loss: 1.8404, label: 3, bag_size: 1186
batch 379, loss: 0.4688, instance_loss: 0.3502, weighted_loss: 0.4332, label: 2, bag_size: 779
batch 399, loss: 0.8964, instance_loss: 0.3969, weighted_loss: 0.7465, label: 2, bag_size: 998
batch 419, loss: 0.3606, instance_loss: 0.4791, weighted_loss: 0.3962, label: 4, bag_size: 824
batch 439, loss: 1.7431, instance_loss: 0.5355, weighted_loss: 1.3808, label: 0, bag_size: 745
batch 459, loss: 1.8633, instance_loss: 0.5782, weighted_loss: 1.4777, label: 0, bag_size: 1073
batch 479, loss: 0.8099, instance_loss: 0.4723, weighted_loss: 0.7086, label: 3, bag_size: 282
batch 499, loss: 1.3188, instance_loss: 0.5002, weighted_loss: 1.0732, label: 1, bag_size: 1009
batch 519, loss: 0.8403, instance_loss: 0.4126, weighted_loss: 0.7120, label: 4, bag_size: 333
batch 539, loss: 0.8515, instance_loss: 0.4697, weighted_loss: 0.7369, label: 4, bag_size: 740
batch 559, loss: 0.7985, instance_loss: 0.4944, weighted_loss: 0.7073, label: 4, bag_size: 1297
batch 579, loss: 1.0441, instance_loss: 0.5696, weighted_loss: 0.9017, label: 1, bag_size: 814


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.07196969696969698: correct 342/4752
Epoch: 41, train_loss: 1.0760, train_clustering_loss:  0.4703, train_error: 0.4512
class 0: acc 0.7586206896551724, correct 88/116
class 1: acc 0.3474576271186441, correct 41/118
class 2: acc 0.59375, correct 76/128
class 3: acc 0.3153153153153153, correct 35/111
class 4: acc 0.7107438016528925, correct 86/121

Val Set, val_loss: 1.1896, val_error: 0.5405, auc: 0.8122
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.13006756756756757: correct 77/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.2936, instance_loss: 0.4038, weighted_loss: 1.0267, label: 0, bag_size: 888
batch 39, loss: 0.9590, instance_loss: 0.4760, weighted_loss: 0.8141, label: 3, bag_size: 944
batch 59, loss: 0.9603, instance_loss: 0.4917, weighted_loss: 0.8197, label: 3, bag_size: 423
batch 79, loss: 0.3546, instance_loss: 0.4397, weighted_loss: 0.3802, label: 2, bag_size: 315
batch 99, loss: 1.1030, instance_loss: 0.4841, weighted_loss: 0.9174, label: 1, bag_size: 328
batch 119, loss: 1.4848, instance_loss: 0.5361, weighted_loss: 1.2002, label: 4, bag_size: 176
batch 139, loss: 0.5686, instance_loss: 0.5948, weighted_loss: 0.5764, label: 0, bag_size: 283
batch 159, loss: 0.5526, instance_loss: 0.4068, weighted_loss: 0.5089, label: 4, bag_size: 498
batch 179, loss: 1.9786, instance_loss: 0.5243, weighted_loss: 1.5423, label: 2, bag_size: 713
batch 199, loss: 0.0733, instance_loss: 0.2177, weighted_loss: 0.1166, label: 0, bag_size: 192
batch 219, loss: 0.9796, instance_loss: 0.4553, weighted_loss: 0.8223, label: 2, bag_size: 318
batch 239, loss: 1.0203, instance_loss: 0.3981, weighted_loss: 0.8336, label: 0, bag_size: 277
batch 259, loss: 0.9064, instance_loss: 0.5157, weighted_loss: 0.7892, label: 1, bag_size: 544
batch 279, loss: 1.2193, instance_loss: 0.5695, weighted_loss: 1.0244, label: 4, bag_size: 1064
batch 299, loss: 1.1021, instance_loss: 0.4096, weighted_loss: 0.8943, label: 2, bag_size: 543
batch 319, loss: 0.1501, instance_loss: 0.3009, weighted_loss: 0.1954, label: 4, bag_size: 409
batch 339, loss: 0.3872, instance_loss: 0.3338, weighted_loss: 0.3712, label: 4, bag_size: 775
batch 359, loss: 1.7100, instance_loss: 0.5925, weighted_loss: 1.3747, label: 3, bag_size: 533
batch 379, loss: 1.2539, instance_loss: 0.5390, weighted_loss: 1.0394, label: 3, bag_size: 681
batch 399, loss: 1.2627, instance_loss: 0.4909, weighted_loss: 1.0312, label: 4, bag_size: 853
batch 419, loss: 0.7179, instance_loss: 0.3417, weighted_loss: 0.6051, label: 0, bag_size: 581
batch 439, loss: 0.3183, instance_loss: 0.3549, weighted_loss: 0.3293, label: 4, bag_size: 824
batch 459, loss: 2.1470, instance_loss: 0.5200, weighted_loss: 1.6589, label: 3, bag_size: 598
batch 479, loss: 0.7129, instance_loss: 0.4276, weighted_loss: 0.6273, label: 2, bag_size: 177
batch 499, loss: 1.1953, instance_loss: 0.5279, weighted_loss: 0.9951, label: 1, bag_size: 106
batch 519, loss: 0.0865, instance_loss: 0.2513, weighted_loss: 0.1360, label: 0, bag_size: 188
batch 539, loss: 1.3185, instance_loss: 0.4894, weighted_loss: 1.0697, label: 1, bag_size: 311
batch 559, loss: 1.3391, instance_loss: 0.6138, weighted_loss: 1.1215, label: 1, bag_size: 697
batch 579, loss: 1.0193, instance_loss: 0.4979, weighted_loss: 0.8629, label: 4, bag_size: 703


class 0 clustering acc 0.9952861952861953: correct 23648/23760
class 1 clustering acc 0.07744107744107744: correct 368/4752
Epoch: 42, train_loss: 1.0828, train_clustering_loss:  0.4688, train_error: 0.4613
class 0: acc 0.7982456140350878, correct 91/114
class 1: acc 0.32, correct 32/100
class 2: acc 0.5524475524475524, correct 79/143
class 3: acc 0.4017857142857143, correct 45/112
class 4: acc 0.584, correct 73/125

Val Set, val_loss: 1.1876, val_error: 0.5541, auc: 0.8021
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0039, instance_loss: 0.0974, weighted_loss: 0.0320, label: 0, bag_size: 51
batch 39, loss: 1.2036, instance_loss: 0.5010, weighted_loss: 0.9929, label: 2, bag_size: 744
batch 59, loss: 0.0291, instance_loss: 0.1178, weighted_loss: 0.0557, label: 0, bag_size: 221
batch 79, loss: 0.2692, instance_loss: 0.4933, weighted_loss: 0.3364, label: 4, bag_size: 769
batch 99, loss: 0.5820, instance_loss: 0.4448, weighted_loss: 0.5408, label: 1, bag_size: 321
batch 119, loss: 2.1065, instance_loss: 0.6967, weighted_loss: 1.6836, label: 2, bag_size: 208
batch 139, loss: 1.2549, instance_loss: 0.5177, weighted_loss: 1.0337, label: 0, bag_size: 615
batch 159, loss: 3.5373, instance_loss: 0.7980, weighted_loss: 2.7155, label: 4, bag_size: 310
batch 179, loss: 1.6104, instance_loss: 0.5284, weighted_loss: 1.2858, label: 1, bag_size: 972
batch 199, loss: 0.0263, instance_loss: 0.1198, weighted_loss: 0.0543, label: 0, bag_size: 488
batch 219, loss: 0.0389, instance_loss: 0.1833, weighted_loss: 0.0822, label: 0, bag_size: 383
batch 239, loss: 0.8018, instance_loss: 0.4322, weighted_loss: 0.6910, label: 2, bag_size: 659
batch 259, loss: 0.6479, instance_loss: 0.4387, weighted_loss: 0.5851, label: 3, bag_size: 344
batch 279, loss: 0.6696, instance_loss: 0.4347, weighted_loss: 0.5991, label: 0, bag_size: 143
batch 299, loss: 1.7538, instance_loss: 0.5243, weighted_loss: 1.3850, label: 3, bag_size: 500
batch 319, loss: 0.6748, instance_loss: 0.4828, weighted_loss: 0.6172, label: 0, bag_size: 269
batch 339, loss: 0.5637, instance_loss: 0.4187, weighted_loss: 0.5202, label: 4, bag_size: 895
batch 359, loss: 0.8409, instance_loss: 0.5486, weighted_loss: 0.7532, label: 3, bag_size: 398
batch 379, loss: 0.0965, instance_loss: 0.1644, weighted_loss: 0.1169, label: 2, bag_size: 340
batch 399, loss: 2.0768, instance_loss: 0.6142, weighted_loss: 1.6380, label: 0, bag_size: 305
batch 419, loss: 1.0983, instance_loss: 0.5494, weighted_loss: 0.9336, label: 3, bag_size: 317
batch 439, loss: 2.7184, instance_loss: 0.5258, weighted_loss: 2.0606, label: 1, bag_size: 875
batch 459, loss: 0.0577, instance_loss: 0.2484, weighted_loss: 0.1150, label: 0, bag_size: 103
batch 479, loss: 0.8800, instance_loss: 0.4628, weighted_loss: 0.7549, label: 2, bag_size: 290
batch 499, loss: 0.1780, instance_loss: 0.4906, weighted_loss: 0.2718, label: 0, bag_size: 283
batch 519, loss: 0.3582, instance_loss: 0.4135, weighted_loss: 0.3748, label: 1, bag_size: 672
batch 539, loss: 1.6620, instance_loss: 0.6093, weighted_loss: 1.3462, label: 2, bag_size: 96
batch 559, loss: 0.1076, instance_loss: 0.3958, weighted_loss: 0.1941, label: 2, bag_size: 1975
batch 579, loss: 1.3189, instance_loss: 0.5147, weighted_loss: 1.0776, label: 4, bag_size: 395


class 0 clustering acc 0.9957070707070707: correct 23658/23760
class 1 clustering acc 0.08817340067340067: correct 419/4752
Epoch: 43, train_loss: 1.0157, train_clustering_loss:  0.4667, train_error: 0.4444
class 0: acc 0.7719298245614035, correct 88/114
class 1: acc 0.4857142857142857, correct 68/140
class 2: acc 0.4380165289256198, correct 53/121
class 3: acc 0.4672897196261682, correct 50/107
class 4: acc 0.6339285714285714, correct 71/112

Val Set, val_loss: 1.2011, val_error: 0.4865, auc: 0.8250
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.12162162162162163: correct 72/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0113, instance_loss: 0.0928, weighted_loss: 0.0358, label: 0, bag_size: 74
batch 39, loss: 1.3545, instance_loss: 0.4809, weighted_loss: 1.0924, label: 1, bag_size: 695
batch 59, loss: 1.1088, instance_loss: 0.5101, weighted_loss: 0.9292, label: 2, bag_size: 315
batch 79, loss: 0.4774, instance_loss: 0.3988, weighted_loss: 0.4538, label: 4, bag_size: 53
batch 99, loss: 0.1013, instance_loss: 0.2827, weighted_loss: 0.1557, label: 0, bag_size: 428
batch 119, loss: 1.0511, instance_loss: 0.4870, weighted_loss: 0.8819, label: 3, bag_size: 1078
batch 139, loss: 0.9798, instance_loss: 0.3857, weighted_loss: 0.8016, label: 0, bag_size: 352
batch 159, loss: 0.6700, instance_loss: 0.4614, weighted_loss: 0.6075, label: 1, bag_size: 840
batch 179, loss: 0.7847, instance_loss: 0.4807, weighted_loss: 0.6935, label: 3, bag_size: 603
batch 199, loss: 1.2424, instance_loss: 0.8048, weighted_loss: 1.1112, label: 1, bag_size: 355
batch 219, loss: 0.7242, instance_loss: 0.5221, weighted_loss: 0.6636, label: 3, bag_size: 98
batch 239, loss: 0.6637, instance_loss: 0.4229, weighted_loss: 0.5915, label: 3, bag_size: 510
batch 259, loss: 0.8404, instance_loss: 0.4307, weighted_loss: 0.7175, label: 4, bag_size: 356
batch 279, loss: 0.8997, instance_loss: 0.4589, weighted_loss: 0.7675, label: 4, bag_size: 755
batch 299, loss: 0.2514, instance_loss: 0.5023, weighted_loss: 0.3267, label: 4, bag_size: 683
batch 319, loss: 1.0131, instance_loss: 0.5112, weighted_loss: 0.8625, label: 0, bag_size: 478
batch 339, loss: 1.0565, instance_loss: 0.5753, weighted_loss: 0.9121, label: 0, bag_size: 1414
batch 359, loss: 0.7314, instance_loss: 0.5223, weighted_loss: 0.6687, label: 1, bag_size: 483
batch 379, loss: 1.6554, instance_loss: 0.6721, weighted_loss: 1.3604, label: 4, bag_size: 359
batch 399, loss: 0.7667, instance_loss: 0.5107, weighted_loss: 0.6899, label: 1, bag_size: 184
batch 419, loss: 1.5484, instance_loss: 0.4531, weighted_loss: 1.2198, label: 4, bag_size: 176
batch 439, loss: 0.8464, instance_loss: 0.4507, weighted_loss: 0.7277, label: 3, bag_size: 1078
batch 459, loss: 0.2976, instance_loss: 0.4268, weighted_loss: 0.3364, label: 0, bag_size: 404
batch 479, loss: 1.9908, instance_loss: 0.5753, weighted_loss: 1.5661, label: 2, bag_size: 852
batch 499, loss: 0.7045, instance_loss: 0.4023, weighted_loss: 0.6138, label: 3, bag_size: 603
batch 519, loss: 0.1742, instance_loss: 0.3357, weighted_loss: 0.2227, label: 1, bag_size: 886
batch 539, loss: 0.6349, instance_loss: 0.4263, weighted_loss: 0.5723, label: 4, bag_size: 853
batch 559, loss: 4.1391, instance_loss: 0.7949, weighted_loss: 3.1358, label: 0, bag_size: 1039
batch 579, loss: 1.0420, instance_loss: 0.5305, weighted_loss: 0.8885, label: 2, bag_size: 258


class 0 clustering acc 0.99503367003367: correct 23642/23760
class 1 clustering acc 0.09974747474747475: correct 474/4752
Epoch: 44, train_loss: 1.0534, train_clustering_loss:  0.4618, train_error: 0.4108
class 0: acc 0.8333333333333334, correct 115/138
class 1: acc 0.5955882352941176, correct 81/136
class 2: acc 0.3333333333333333, correct 34/102
class 3: acc 0.5714285714285714, correct 60/105
class 4: acc 0.5309734513274337, correct 60/113

Val Set, val_loss: 1.0794, val_error: 0.5000, auc: 0.8425
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.100015 --> 1.079373).  Saving model ...


batch 19, loss: 0.7165, instance_loss: 0.4641, weighted_loss: 0.6408, label: 1, bag_size: 886
batch 39, loss: 2.0801, instance_loss: 0.5957, weighted_loss: 1.6348, label: 4, bag_size: 312
batch 59, loss: 1.2574, instance_loss: 0.5474, weighted_loss: 1.0444, label: 3, bag_size: 488
batch 79, loss: 2.4243, instance_loss: 0.5776, weighted_loss: 1.8703, label: 0, bag_size: 1073
batch 99, loss: 1.0250, instance_loss: 0.5070, weighted_loss: 0.8696, label: 3, bag_size: 369
batch 119, loss: 0.0000, instance_loss: 0.4675, weighted_loss: 0.1402, label: 1, bag_size: 669
batch 139, loss: 0.5113, instance_loss: 0.4381, weighted_loss: 0.4893, label: 4, bag_size: 129
batch 159, loss: 2.8090, instance_loss: 0.6245, weighted_loss: 2.1536, label: 1, bag_size: 875
batch 179, loss: 1.0625, instance_loss: 0.4263, weighted_loss: 0.8716, label: 4, bag_size: 333
batch 199, loss: 1.0002, instance_loss: 0.4851, weighted_loss: 0.8457, label: 2, bag_size: 607
batch 219, loss: 0.0120, instance_loss: 0.3478, weighted_loss: 0.1127, label: 0, bag_size: 706
batch 239, loss: 1.0088, instance_loss: 0.5450, weighted_loss: 0.8697, label: 0, bag_size: 230
batch 259, loss: 1.0465, instance_loss: 0.5253, weighted_loss: 0.8901, label: 1, bag_size: 328
batch 279, loss: 1.4152, instance_loss: 0.4461, weighted_loss: 1.1244, label: 2, bag_size: 941
batch 299, loss: 2.1998, instance_loss: 0.5736, weighted_loss: 1.7120, label: 4, bag_size: 270
batch 319, loss: 0.5133, instance_loss: 0.3976, weighted_loss: 0.4786, label: 2, bag_size: 557
batch 339, loss: 1.1229, instance_loss: 0.5647, weighted_loss: 0.9554, label: 4, bag_size: 356
batch 359, loss: 1.0592, instance_loss: 0.5143, weighted_loss: 0.8957, label: 1, bag_size: 1019
batch 379, loss: 1.2110, instance_loss: 0.5223, weighted_loss: 1.0044, label: 4, bag_size: 683
batch 399, loss: 1.5625, instance_loss: 0.5006, weighted_loss: 1.2439, label: 2, bag_size: 318
batch 419, loss: 1.8506, instance_loss: 0.5513, weighted_loss: 1.4608, label: 1, bag_size: 1091
batch 439, loss: 1.3896, instance_loss: 0.5913, weighted_loss: 1.1502, label: 4, bag_size: 589
batch 459, loss: 0.7012, instance_loss: 0.5167, weighted_loss: 0.6459, label: 0, bag_size: 62
batch 479, loss: 1.3796, instance_loss: 0.4743, weighted_loss: 1.1080, label: 1, bag_size: 874
batch 499, loss: 0.0152, instance_loss: 0.0789, weighted_loss: 0.0343, label: 0, bag_size: 425
batch 519, loss: 0.0460, instance_loss: 0.2314, weighted_loss: 0.1016, label: 0, bag_size: 159
batch 539, loss: 1.3896, instance_loss: 0.5315, weighted_loss: 1.1321, label: 4, bag_size: 238
batch 559, loss: 0.4616, instance_loss: 0.4056, weighted_loss: 0.4448, label: 2, bag_size: 754
batch 579, loss: 1.4199, instance_loss: 0.4711, weighted_loss: 1.1353, label: 2, bag_size: 390


class 0 clustering acc 0.9957070707070707: correct 23658/23760
class 1 clustering acc 0.07112794612794612: correct 338/4752
Epoch: 45, train_loss: 1.0566, train_clustering_loss:  0.4654, train_error: 0.4360
class 0: acc 0.8153846153846154, correct 106/130
class 1: acc 0.4074074074074074, correct 44/108
class 2: acc 0.5625, correct 72/128
class 3: acc 0.4649122807017544, correct 53/114
class 4: acc 0.5263157894736842, correct 60/114

Val Set, val_loss: 1.1089, val_error: 0.4595, auc: 0.8461
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.07094594594594594: correct 42/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.7484, instance_loss: 0.5755, weighted_loss: 2.0965, label: 3, bag_size: 323
batch 39, loss: 0.7624, instance_loss: 0.5255, weighted_loss: 0.6913, label: 3, bag_size: 737
batch 59, loss: 0.9632, instance_loss: 0.4929, weighted_loss: 0.8221, label: 1, bag_size: 960
batch 79, loss: 0.3597, instance_loss: 0.2994, weighted_loss: 0.3416, label: 0, bag_size: 277
batch 99, loss: 1.5024, instance_loss: 0.4490, weighted_loss: 1.1863, label: 2, bag_size: 713
batch 119, loss: 1.0003, instance_loss: 0.5042, weighted_loss: 0.8515, label: 1, bag_size: 949
batch 139, loss: 2.9625, instance_loss: 0.7375, weighted_loss: 2.2950, label: 0, bag_size: 492
batch 159, loss: 3.3507, instance_loss: 0.6052, weighted_loss: 2.5270, label: 0, bag_size: 273
batch 179, loss: 2.5931, instance_loss: 0.5535, weighted_loss: 1.9813, label: 0, bag_size: 273
batch 199, loss: 0.2201, instance_loss: 0.4307, weighted_loss: 0.2833, label: 4, bag_size: 773
batch 219, loss: 0.8484, instance_loss: 0.4969, weighted_loss: 0.7430, label: 1, bag_size: 865
batch 239, loss: 4.4135, instance_loss: 0.7119, weighted_loss: 3.3031, label: 4, bag_size: 685
batch 259, loss: 0.7888, instance_loss: 0.5074, weighted_loss: 0.7043, label: 4, bag_size: 689
batch 279, loss: 0.6301, instance_loss: 0.4681, weighted_loss: 0.5815, label: 2, bag_size: 135
batch 299, loss: 0.6377, instance_loss: 0.4199, weighted_loss: 0.5724, label: 2, bag_size: 290
batch 319, loss: 0.6850, instance_loss: 0.4275, weighted_loss: 0.6077, label: 2, bag_size: 290
batch 339, loss: 0.4775, instance_loss: 0.3824, weighted_loss: 0.4490, label: 2, bag_size: 779
batch 359, loss: 1.4784, instance_loss: 0.5829, weighted_loss: 1.2098, label: 2, bag_size: 96
batch 379, loss: 1.2858, instance_loss: 0.4939, weighted_loss: 1.0482, label: 3, bag_size: 423
batch 399, loss: 1.5009, instance_loss: 0.5540, weighted_loss: 1.2168, label: 1, bag_size: 981
batch 419, loss: 0.8015, instance_loss: 0.5013, weighted_loss: 0.7114, label: 3, bag_size: 498
batch 439, loss: 1.8861, instance_loss: 0.5122, weighted_loss: 1.4739, label: 1, bag_size: 159
batch 459, loss: 0.5305, instance_loss: 0.4385, weighted_loss: 0.5029, label: 1, bag_size: 972
batch 479, loss: 0.1025, instance_loss: 0.3569, weighted_loss: 0.1788, label: 0, bag_size: 73
batch 499, loss: 0.7591, instance_loss: 0.4940, weighted_loss: 0.6796, label: 2, bag_size: 633
batch 519, loss: 0.3592, instance_loss: 0.6757, weighted_loss: 0.4541, label: 1, bag_size: 1497
batch 539, loss: 2.6961, instance_loss: 0.5922, weighted_loss: 2.0649, label: 2, bag_size: 713
batch 559, loss: 1.3041, instance_loss: 0.5015, weighted_loss: 1.0633, label: 3, bag_size: 779
batch 579, loss: 0.7783, instance_loss: 0.4174, weighted_loss: 0.6700, label: 0, bag_size: 455


class 0 clustering acc 0.9951599326599326: correct 23645/23760
class 1 clustering acc 0.07512626262626262: correct 357/4752
Epoch: 46, train_loss: 1.0162, train_clustering_loss:  0.4713, train_error: 0.4040
class 0: acc 0.8017241379310345, correct 93/116
class 1: acc 0.5128205128205128, correct 60/117
class 2: acc 0.5538461538461539, correct 72/130
class 3: acc 0.4636363636363636, correct 51/110
class 4: acc 0.6446280991735537, correct 78/121

Val Set, val_loss: 1.1788, val_error: 0.5135, auc: 0.8246
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.10472972972972973: correct 62/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5145, instance_loss: 0.5015, weighted_loss: 0.5106, label: 1, bag_size: 1091
batch 39, loss: 0.9488, instance_loss: 0.4992, weighted_loss: 0.8139, label: 2, bag_size: 299
batch 59, loss: 0.8150, instance_loss: 0.5069, weighted_loss: 0.7226, label: 3, bag_size: 631
batch 79, loss: 0.5569, instance_loss: 0.3163, weighted_loss: 0.4847, label: 4, bag_size: 854
batch 99, loss: 0.0237, instance_loss: 0.1978, weighted_loss: 0.0759, label: 0, bag_size: 69
batch 119, loss: 0.9179, instance_loss: 0.5092, weighted_loss: 0.7953, label: 2, bag_size: 837
batch 139, loss: 0.5189, instance_loss: 0.4190, weighted_loss: 0.4889, label: 2, bag_size: 558
batch 159, loss: 0.7568, instance_loss: 0.4388, weighted_loss: 0.6614, label: 3, bag_size: 944
batch 179, loss: 0.5895, instance_loss: 0.5474, weighted_loss: 0.5769, label: 2, bag_size: 410
batch 199, loss: 0.2012, instance_loss: 0.4083, weighted_loss: 0.2633, label: 2, bag_size: 553
batch 219, loss: 0.7737, instance_loss: 0.4309, weighted_loss: 0.6708, label: 4, bag_size: 685
batch 239, loss: 2.1428, instance_loss: 0.6471, weighted_loss: 1.6941, label: 3, bag_size: 638
batch 259, loss: 1.0546, instance_loss: 0.4955, weighted_loss: 0.8869, label: 2, bag_size: 702
batch 279, loss: 1.2908, instance_loss: 0.4997, weighted_loss: 1.0534, label: 3, bag_size: 499
batch 299, loss: 0.6217, instance_loss: 0.4373, weighted_loss: 0.5664, label: 4, bag_size: 639
batch 319, loss: 3.3622, instance_loss: 0.6182, weighted_loss: 2.5390, label: 2, bag_size: 629
batch 339, loss: 1.1536, instance_loss: 0.5014, weighted_loss: 0.9579, label: 3, bag_size: 789
batch 359, loss: 0.7123, instance_loss: 0.4368, weighted_loss: 0.6296, label: 3, bag_size: 496
batch 379, loss: 0.6122, instance_loss: 0.5289, weighted_loss: 0.5872, label: 2, bag_size: 25
batch 399, loss: 1.2327, instance_loss: 0.5429, weighted_loss: 1.0257, label: 3, bag_size: 681
batch 419, loss: 0.0097, instance_loss: 0.1894, weighted_loss: 0.0636, label: 0, bag_size: 285
batch 439, loss: 0.8520, instance_loss: 0.5101, weighted_loss: 0.7494, label: 2, bag_size: 303
batch 459, loss: 0.3535, instance_loss: 0.2380, weighted_loss: 0.3189, label: 0, bag_size: 366
batch 479, loss: 0.1546, instance_loss: 0.2154, weighted_loss: 0.1728, label: 0, bag_size: 97
batch 499, loss: 0.2719, instance_loss: 0.2733, weighted_loss: 0.2723, label: 0, bag_size: 345
batch 519, loss: 1.3615, instance_loss: 0.7075, weighted_loss: 1.1653, label: 3, bag_size: 31
batch 539, loss: 0.7154, instance_loss: 0.4598, weighted_loss: 0.6388, label: 3, bag_size: 97
batch 559, loss: 0.1427, instance_loss: 0.3311, weighted_loss: 0.1992, label: 0, bag_size: 97
batch 579, loss: 0.8843, instance_loss: 0.5258, weighted_loss: 0.7768, label: 3, bag_size: 423


class 0 clustering acc 0.9959175084175084: correct 23663/23760
class 1 clustering acc 0.10143097643097643: correct 482/4752
Epoch: 47, train_loss: 1.0418, train_clustering_loss:  0.4635, train_error: 0.4343
class 0: acc 0.8368794326241135, correct 118/141
class 1: acc 0.4482758620689655, correct 52/116
class 2: acc 0.38738738738738737, correct 43/111
class 3: acc 0.5564516129032258, correct 69/124
class 4: acc 0.5294117647058824, correct 54/102

Val Set, val_loss: 1.0313, val_error: 0.4459, auc: 0.8594
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.079373 --> 1.031284).  Saving model ...


batch 19, loss: 0.2810, instance_loss: 0.4005, weighted_loss: 0.3168, label: 1, bag_size: 141
batch 39, loss: 0.1435, instance_loss: 0.4764, weighted_loss: 0.2434, label: 1, bag_size: 371
batch 59, loss: 0.1086, instance_loss: 0.4398, weighted_loss: 0.2079, label: 0, bag_size: 416
batch 79, loss: 2.6026, instance_loss: 0.5033, weighted_loss: 1.9728, label: 3, bag_size: 899
batch 99, loss: 0.6175, instance_loss: 0.3658, weighted_loss: 0.5420, label: 3, bag_size: 625
batch 119, loss: 3.8728, instance_loss: 0.6492, weighted_loss: 2.9057, label: 2, bag_size: 1308
batch 139, loss: 0.7519, instance_loss: 0.4925, weighted_loss: 0.6741, label: 1, bag_size: 865
batch 159, loss: 1.6185, instance_loss: 0.6456, weighted_loss: 1.3267, label: 4, bag_size: 730
batch 179, loss: 0.2421, instance_loss: 0.3854, weighted_loss: 0.2851, label: 2, bag_size: 936
batch 199, loss: 0.0129, instance_loss: 0.0671, weighted_loss: 0.0291, label: 0, bag_size: 350
batch 219, loss: 1.7638, instance_loss: 0.5253, weighted_loss: 1.3922, label: 3, bag_size: 154
batch 239, loss: 1.7720, instance_loss: 0.5509, weighted_loss: 1.4057, label: 1, bag_size: 618
batch 259, loss: 0.5449, instance_loss: 0.3686, weighted_loss: 0.4920, label: 0, bag_size: 367
batch 279, loss: 1.2253, instance_loss: 0.4851, weighted_loss: 1.0033, label: 1, bag_size: 481
batch 299, loss: 0.7693, instance_loss: 0.4260, weighted_loss: 0.6663, label: 2, bag_size: 315
batch 319, loss: 1.3385, instance_loss: 0.5250, weighted_loss: 1.0944, label: 3, bag_size: 822
batch 339, loss: 0.0077, instance_loss: 0.1079, weighted_loss: 0.0378, label: 0, bag_size: 51
batch 359, loss: 1.3234, instance_loss: 0.5432, weighted_loss: 1.0894, label: 3, bag_size: 598
batch 379, loss: 0.1114, instance_loss: 0.2150, weighted_loss: 0.1425, label: 0, bag_size: 188
batch 399, loss: 0.0928, instance_loss: 0.2656, weighted_loss: 0.1446, label: 0, bag_size: 282
batch 419, loss: 1.3090, instance_loss: 0.4154, weighted_loss: 1.0409, label: 2, bag_size: 1003
batch 439, loss: 0.9211, instance_loss: 0.4369, weighted_loss: 0.7759, label: 4, bag_size: 476
batch 459, loss: 0.4708, instance_loss: 0.5043, weighted_loss: 0.4809, label: 0, bag_size: 400
batch 479, loss: 0.4665, instance_loss: 0.5517, weighted_loss: 0.4921, label: 1, bag_size: 544
batch 499, loss: 0.4992, instance_loss: 0.3766, weighted_loss: 0.4624, label: 0, bag_size: 352
batch 519, loss: 0.0004, instance_loss: 0.1018, weighted_loss: 0.0308, label: 0, bag_size: 428
batch 539, loss: 1.5896, instance_loss: 0.5541, weighted_loss: 1.2789, label: 2, bag_size: 554
batch 559, loss: 0.0240, instance_loss: 0.1573, weighted_loss: 0.0640, label: 0, bag_size: 79
batch 579, loss: 0.4211, instance_loss: 0.4390, weighted_loss: 0.4265, label: 2, bag_size: 684


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.09553872053872053: correct 454/4752
Epoch: 48, train_loss: 0.9794, train_clustering_loss:  0.4587, train_error: 0.4125
class 0: acc 0.852112676056338, correct 121/142
class 1: acc 0.4051724137931034, correct 47/116
class 2: acc 0.46956521739130436, correct 54/115
class 3: acc 0.5826086956521739, correct 67/115
class 4: acc 0.5660377358490566, correct 60/106

Val Set, val_loss: 1.0926, val_error: 0.4459, auc: 0.8427
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2827, instance_loss: 0.6325, weighted_loss: 1.7876, label: 1, bag_size: 397
batch 39, loss: 0.6837, instance_loss: 0.5003, weighted_loss: 0.6287, label: 1, bag_size: 1103
batch 59, loss: 3.5414, instance_loss: 0.6258, weighted_loss: 2.6668, label: 2, bag_size: 1308
batch 79, loss: 0.6994, instance_loss: 0.4185, weighted_loss: 0.6152, label: 2, bag_size: 1013
batch 99, loss: 0.2432, instance_loss: 0.4372, weighted_loss: 0.3014, label: 4, bag_size: 520
batch 119, loss: 0.4719, instance_loss: 0.4415, weighted_loss: 0.4628, label: 4, bag_size: 875
batch 139, loss: 0.9031, instance_loss: 0.4713, weighted_loss: 0.7736, label: 1, bag_size: 398
batch 159, loss: 1.3982, instance_loss: 0.4732, weighted_loss: 1.1207, label: 1, bag_size: 184
batch 179, loss: 0.5835, instance_loss: 0.4330, weighted_loss: 0.5384, label: 0, bag_size: 97
batch 199, loss: 1.7703, instance_loss: 0.4575, weighted_loss: 1.3765, label: 1, bag_size: 908
batch 219, loss: 2.0961, instance_loss: 0.5726, weighted_loss: 1.6390, label: 2, bag_size: 717
batch 239, loss: 1.4421, instance_loss: 0.5379, weighted_loss: 1.1709, label: 3, bag_size: 523
batch 259, loss: 0.0926, instance_loss: 0.1984, weighted_loss: 0.1243, label: 0, bag_size: 493
batch 279, loss: 0.0254, instance_loss: 0.2051, weighted_loss: 0.0793, label: 0, bag_size: 142
batch 299, loss: 0.0671, instance_loss: 0.2241, weighted_loss: 0.1142, label: 0, bag_size: 297
batch 319, loss: 0.6378, instance_loss: 0.4781, weighted_loss: 0.5899, label: 3, bag_size: 737
batch 339, loss: 1.1890, instance_loss: 0.5449, weighted_loss: 0.9957, label: 1, bag_size: 988
batch 359, loss: 1.2610, instance_loss: 0.5680, weighted_loss: 1.0531, label: 4, bag_size: 797
batch 379, loss: 0.5169, instance_loss: 0.4719, weighted_loss: 0.5034, label: 1, bag_size: 271
batch 399, loss: 2.3164, instance_loss: 0.5174, weighted_loss: 1.7767, label: 4, bag_size: 824
batch 419, loss: 0.1301, instance_loss: 0.4036, weighted_loss: 0.2121, label: 1, bag_size: 522
batch 439, loss: 0.0258, instance_loss: 0.0877, weighted_loss: 0.0444, label: 0, bag_size: 523
batch 459, loss: 0.1261, instance_loss: 0.1437, weighted_loss: 0.1313, label: 0, bag_size: 221
batch 479, loss: 1.0899, instance_loss: 0.4203, weighted_loss: 0.8891, label: 4, bag_size: 731
batch 499, loss: 0.5616, instance_loss: 0.3930, weighted_loss: 0.5110, label: 4, bag_size: 895
batch 519, loss: 1.0521, instance_loss: 0.5049, weighted_loss: 0.8879, label: 4, bag_size: 176
batch 539, loss: 0.7009, instance_loss: 0.4390, weighted_loss: 0.6224, label: 1, bag_size: 1103
batch 559, loss: 0.0511, instance_loss: 0.1803, weighted_loss: 0.0899, label: 0, bag_size: 49
batch 579, loss: 0.8059, instance_loss: 0.4297, weighted_loss: 0.6930, label: 3, bag_size: 1076


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.09701178451178451: correct 461/4752
Epoch: 49, train_loss: 1.0676, train_clustering_loss:  0.4635, train_error: 0.4512
class 0: acc 0.8181818181818182, correct 99/121
class 1: acc 0.5503875968992248, correct 71/129
class 2: acc 0.35964912280701755, correct 41/114
class 3: acc 0.4297520661157025, correct 52/121
class 4: acc 0.5779816513761468, correct 63/109

Val Set, val_loss: 1.1510, val_error: 0.4595, auc: 0.8357
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.09121621621621621: correct 54/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.4619, instance_loss: 0.5576, weighted_loss: 1.8906, label: 2, bag_size: 629
batch 39, loss: 1.0059, instance_loss: 0.5093, weighted_loss: 0.8569, label: 3, bag_size: 781
batch 59, loss: 0.8148, instance_loss: 0.4404, weighted_loss: 0.7025, label: 3, bag_size: 364
batch 79, loss: 0.4109, instance_loss: 0.4250, weighted_loss: 0.4152, label: 4, bag_size: 652
batch 99, loss: 0.0492, instance_loss: 0.1047, weighted_loss: 0.0658, label: 0, bag_size: 513
batch 119, loss: 2.3587, instance_loss: 0.5886, weighted_loss: 1.8277, label: 2, bag_size: 713
batch 139, loss: 1.6917, instance_loss: 0.6396, weighted_loss: 1.3761, label: 4, bag_size: 395
batch 159, loss: 0.2359, instance_loss: 0.3256, weighted_loss: 0.2628, label: 4, bag_size: 652
batch 179, loss: 3.8797, instance_loss: 0.9550, weighted_loss: 3.0023, label: 1, bag_size: 45
batch 199, loss: 3.6224, instance_loss: 0.7581, weighted_loss: 2.7631, label: 2, bag_size: 219
batch 219, loss: 0.5788, instance_loss: 0.4680, weighted_loss: 0.5455, label: 1, bag_size: 509
batch 239, loss: 0.8088, instance_loss: 0.4680, weighted_loss: 0.7066, label: 3, bag_size: 453
batch 259, loss: 2.0372, instance_loss: 0.5745, weighted_loss: 1.5984, label: 2, bag_size: 1071
batch 279, loss: 0.7143, instance_loss: 0.4200, weighted_loss: 0.6260, label: 3, bag_size: 476
batch 299, loss: 1.1198, instance_loss: 0.4660, weighted_loss: 0.9236, label: 3, bag_size: 393
batch 319, loss: 0.3652, instance_loss: 0.3749, weighted_loss: 0.3681, label: 2, bag_size: 886
batch 339, loss: 2.1621, instance_loss: 0.5819, weighted_loss: 1.6880, label: 4, bag_size: 771
batch 359, loss: 0.0204, instance_loss: 0.1031, weighted_loss: 0.0452, label: 0, bag_size: 295
batch 379, loss: 0.8340, instance_loss: 0.4658, weighted_loss: 0.7235, label: 1, bag_size: 695
batch 399, loss: 1.1550, instance_loss: 0.4507, weighted_loss: 0.9437, label: 2, bag_size: 337
batch 419, loss: 0.3829, instance_loss: 0.4544, weighted_loss: 0.4043, label: 3, bag_size: 272
batch 439, loss: 0.3891, instance_loss: 0.4472, weighted_loss: 0.4065, label: 4, bag_size: 1113
batch 459, loss: 0.0109, instance_loss: 0.1538, weighted_loss: 0.0538, label: 0, bag_size: 706
batch 479, loss: 0.8486, instance_loss: 0.4612, weighted_loss: 0.7324, label: 2, bag_size: 512
batch 499, loss: 0.8914, instance_loss: 0.4778, weighted_loss: 0.7673, label: 4, bag_size: 944
batch 519, loss: 0.5074, instance_loss: 0.3937, weighted_loss: 0.4733, label: 2, bag_size: 535
batch 539, loss: 1.7331, instance_loss: 0.6297, weighted_loss: 1.4021, label: 3, bag_size: 486
batch 559, loss: 1.7603, instance_loss: 0.5849, weighted_loss: 1.4077, label: 4, bag_size: 589
batch 579, loss: 0.5904, instance_loss: 0.4469, weighted_loss: 0.5474, label: 4, bag_size: 729


class 0 clustering acc 0.9944023569023569: correct 23627/23760
class 1 clustering acc 0.11005892255892256: correct 523/4752
Epoch: 50, train_loss: 1.0236, train_clustering_loss:  0.4574, train_error: 0.4242
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.38392857142857145, correct 43/112
class 2: acc 0.456, correct 57/125
class 3: acc 0.5714285714285714, correct 64/112
class 4: acc 0.6386554621848739, correct 76/119

Val Set, val_loss: 1.1432, val_error: 0.5405, auc: 0.8235
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1037, instance_loss: 0.2830, weighted_loss: 0.1575, label: 0, bag_size: 416
batch 39, loss: 3.6562, instance_loss: 0.7499, weighted_loss: 2.7843, label: 0, bag_size: 608
batch 59, loss: 0.1226, instance_loss: 0.2803, weighted_loss: 0.1699, label: 0, bag_size: 71
batch 79, loss: 0.7130, instance_loss: 0.4774, weighted_loss: 0.6423, label: 3, bag_size: 500
batch 99, loss: 0.1395, instance_loss: 0.3147, weighted_loss: 0.1921, label: 0, bag_size: 74
batch 119, loss: 1.0045, instance_loss: 0.5071, weighted_loss: 0.8553, label: 3, bag_size: 492
batch 139, loss: 1.1381, instance_loss: 0.5104, weighted_loss: 0.9497, label: 3, bag_size: 500
batch 159, loss: 0.5180, instance_loss: 0.4013, weighted_loss: 0.4830, label: 4, bag_size: 685
batch 179, loss: 0.0268, instance_loss: 0.1721, weighted_loss: 0.0704, label: 0, bag_size: 397
batch 199, loss: 1.6148, instance_loss: 0.5190, weighted_loss: 1.2860, label: 3, bag_size: 230
batch 219, loss: 0.0066, instance_loss: 0.0378, weighted_loss: 0.0160, label: 0, bag_size: 350
batch 239, loss: 0.6083, instance_loss: 0.4124, weighted_loss: 0.5496, label: 4, bag_size: 520
batch 259, loss: 0.8697, instance_loss: 0.4668, weighted_loss: 0.7488, label: 4, bag_size: 547
batch 279, loss: 0.8264, instance_loss: 0.4808, weighted_loss: 0.7227, label: 3, bag_size: 192
batch 299, loss: 1.6579, instance_loss: 0.5084, weighted_loss: 1.3131, label: 4, bag_size: 196
batch 319, loss: 2.8885, instance_loss: 0.5323, weighted_loss: 2.1816, label: 4, bag_size: 1064
batch 339, loss: 1.8691, instance_loss: 0.5520, weighted_loss: 1.4740, label: 3, bag_size: 797
batch 359, loss: 0.5409, instance_loss: 0.4877, weighted_loss: 0.5249, label: 2, bag_size: 410
batch 379, loss: 2.5764, instance_loss: 0.5412, weighted_loss: 1.9658, label: 2, bag_size: 606
batch 399, loss: 0.5382, instance_loss: 0.4611, weighted_loss: 0.5151, label: 1, bag_size: 460
batch 419, loss: 1.6475, instance_loss: 0.5130, weighted_loss: 1.3071, label: 0, bag_size: 642
batch 439, loss: 0.9886, instance_loss: 0.4807, weighted_loss: 0.8362, label: 1, bag_size: 702
batch 459, loss: 2.2058, instance_loss: 0.5268, weighted_loss: 1.7021, label: 2, bag_size: 1071
batch 479, loss: 0.3707, instance_loss: 0.3784, weighted_loss: 0.3730, label: 4, bag_size: 886
batch 499, loss: 1.3678, instance_loss: 0.4821, weighted_loss: 1.1021, label: 4, bag_size: 572
batch 519, loss: 1.0601, instance_loss: 0.4651, weighted_loss: 0.8816, label: 4, bag_size: 868
batch 539, loss: 0.7941, instance_loss: 0.4576, weighted_loss: 0.6932, label: 3, bag_size: 625
batch 559, loss: 0.0045, instance_loss: 0.1290, weighted_loss: 0.0418, label: 0, bag_size: 51
batch 579, loss: 0.0004, instance_loss: 0.0717, weighted_loss: 0.0218, label: 0, bag_size: 428


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.09259259259259259: correct 440/4752
Epoch: 51, train_loss: 1.0142, train_clustering_loss:  0.4629, train_error: 0.4259
class 0: acc 0.8173076923076923, correct 85/104
class 1: acc 0.49122807017543857, correct 56/114
class 2: acc 0.4298245614035088, correct 49/114
class 3: acc 0.5338345864661654, correct 71/133
class 4: acc 0.6201550387596899, correct 80/129

Val Set, val_loss: 1.1682, val_error: 0.5270, auc: 0.8333
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.13006756756756757: correct 77/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.1703, instance_loss: 0.4933, weighted_loss: 1.6672, label: 2, bag_size: 119
batch 39, loss: 1.7472, instance_loss: 0.5766, weighted_loss: 1.3960, label: 3, bag_size: 342
batch 59, loss: 1.6805, instance_loss: 0.5935, weighted_loss: 1.3544, label: 3, bag_size: 797
batch 79, loss: 0.1786, instance_loss: 0.3174, weighted_loss: 0.2202, label: 4, bag_size: 627
batch 99, loss: 2.0602, instance_loss: 0.6252, weighted_loss: 1.6297, label: 1, bag_size: 874
batch 119, loss: 0.3200, instance_loss: 0.5590, weighted_loss: 0.3917, label: 1, bag_size: 886
batch 139, loss: 0.0649, instance_loss: 0.4591, weighted_loss: 0.1832, label: 1, bag_size: 106
batch 159, loss: 0.4005, instance_loss: 0.3333, weighted_loss: 0.3803, label: 2, bag_size: 779
batch 179, loss: 0.6911, instance_loss: 0.4222, weighted_loss: 0.6105, label: 3, bag_size: 1060
batch 199, loss: 0.8543, instance_loss: 0.4839, weighted_loss: 0.7432, label: 1, bag_size: 620
batch 219, loss: 0.7254, instance_loss: 0.5538, weighted_loss: 0.6740, label: 2, bag_size: 861
batch 239, loss: 1.1484, instance_loss: 0.4535, weighted_loss: 0.9400, label: 1, bag_size: 389
batch 259, loss: 0.5798, instance_loss: 0.4530, weighted_loss: 0.5418, label: 1, bag_size: 410
batch 279, loss: 0.9946, instance_loss: 0.4074, weighted_loss: 0.8185, label: 2, bag_size: 421
batch 299, loss: 3.8479, instance_loss: 0.6042, weighted_loss: 2.8748, label: 3, bag_size: 342
batch 319, loss: 0.0301, instance_loss: 0.2123, weighted_loss: 0.0847, label: 0, bag_size: 397
batch 339, loss: 1.0231, instance_loss: 0.7846, weighted_loss: 0.9516, label: 2, bag_size: 168
batch 359, loss: 0.9207, instance_loss: 0.4401, weighted_loss: 0.7766, label: 3, bag_size: 492
batch 379, loss: 0.7555, instance_loss: 0.4908, weighted_loss: 0.6761, label: 1, bag_size: 764
batch 399, loss: 0.8799, instance_loss: 0.4576, weighted_loss: 0.7532, label: 3, bag_size: 641
batch 419, loss: 2.3596, instance_loss: 0.7968, weighted_loss: 1.8907, label: 0, bag_size: 311
batch 439, loss: 1.1862, instance_loss: 0.4771, weighted_loss: 0.9734, label: 4, bag_size: 53
batch 459, loss: 1.4021, instance_loss: 0.5073, weighted_loss: 1.1336, label: 1, bag_size: 1103
batch 479, loss: 0.3620, instance_loss: 0.3988, weighted_loss: 0.3730, label: 2, bag_size: 286
batch 499, loss: 0.0479, instance_loss: 0.2935, weighted_loss: 0.1216, label: 0, bag_size: 355
batch 519, loss: 0.0493, instance_loss: 0.2296, weighted_loss: 0.1034, label: 0, bag_size: 98
batch 539, loss: 1.6902, instance_loss: 0.5158, weighted_loss: 1.3379, label: 3, bag_size: 337
batch 559, loss: 1.1311, instance_loss: 0.5606, weighted_loss: 0.9599, label: 4, bag_size: 740
batch 579, loss: 1.1871, instance_loss: 0.4330, weighted_loss: 0.9609, label: 3, bag_size: 317


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.06944444444444445: correct 330/4752
Epoch: 52, train_loss: 1.0084, train_clustering_loss:  0.4605, train_error: 0.4175
class 0: acc 0.7941176470588235, correct 81/102
class 1: acc 0.38461538461538464, correct 40/104
class 2: acc 0.5379310344827586, correct 78/145
class 3: acc 0.5409836065573771, correct 66/122
class 4: acc 0.6694214876033058, correct 81/121

Val Set, val_loss: 1.0439, val_error: 0.4595, auc: 0.8570
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0903, instance_loss: 0.3130, weighted_loss: 0.1571, label: 0, bag_size: 188
batch 39, loss: 1.3480, instance_loss: 0.4714, weighted_loss: 1.0850, label: 3, bag_size: 499
batch 59, loss: 0.0080, instance_loss: 0.1531, weighted_loss: 0.0516, label: 0, bag_size: 51
batch 79, loss: 2.9877, instance_loss: 0.8490, weighted_loss: 2.3461, label: 1, bag_size: 153
batch 99, loss: 2.3522, instance_loss: 0.5574, weighted_loss: 1.8137, label: 2, bag_size: 288
batch 119, loss: 0.8442, instance_loss: 0.4350, weighted_loss: 0.7214, label: 3, bag_size: 1078
batch 139, loss: 1.2187, instance_loss: 0.4843, weighted_loss: 0.9984, label: 2, bag_size: 1074
batch 159, loss: 1.5787, instance_loss: 0.4924, weighted_loss: 1.2528, label: 3, bag_size: 476
batch 179, loss: 0.7896, instance_loss: 0.4626, weighted_loss: 0.6915, label: 4, bag_size: 204
batch 199, loss: 1.3191, instance_loss: 0.6180, weighted_loss: 1.1088, label: 2, bag_size: 371
batch 219, loss: 1.4011, instance_loss: 0.5038, weighted_loss: 1.1319, label: 1, bag_size: 620
batch 239, loss: 0.5289, instance_loss: 0.4202, weighted_loss: 0.4963, label: 2, bag_size: 317
batch 259, loss: 0.8995, instance_loss: 0.4955, weighted_loss: 0.7783, label: 1, bag_size: 481
batch 279, loss: 0.3893, instance_loss: 0.5025, weighted_loss: 0.4233, label: 2, bag_size: 176
batch 299, loss: 0.5012, instance_loss: 0.3539, weighted_loss: 0.4570, label: 2, bag_size: 633
batch 319, loss: 0.6060, instance_loss: 0.4203, weighted_loss: 0.5503, label: 2, bag_size: 684
batch 339, loss: 2.7654, instance_loss: 0.6118, weighted_loss: 2.1193, label: 1, bag_size: 617
batch 359, loss: 1.0483, instance_loss: 0.4412, weighted_loss: 0.8662, label: 3, bag_size: 476
batch 379, loss: 0.5417, instance_loss: 0.4382, weighted_loss: 0.5106, label: 2, bag_size: 448
batch 399, loss: 1.1546, instance_loss: 0.3707, weighted_loss: 0.9195, label: 0, bag_size: 517
batch 419, loss: 2.0421, instance_loss: 0.5878, weighted_loss: 1.6058, label: 4, bag_size: 246
batch 439, loss: 1.5113, instance_loss: 0.5314, weighted_loss: 1.2173, label: 1, bag_size: 381
batch 459, loss: 0.8362, instance_loss: 0.4952, weighted_loss: 0.7339, label: 1, bag_size: 389
batch 479, loss: 0.1596, instance_loss: 0.1385, weighted_loss: 0.1533, label: 0, bag_size: 399
batch 499, loss: 0.8729, instance_loss: 0.5228, weighted_loss: 0.7679, label: 3, bag_size: 492
batch 519, loss: 0.7539, instance_loss: 0.5113, weighted_loss: 0.6811, label: 1, bag_size: 972
batch 539, loss: 0.5985, instance_loss: 0.4248, weighted_loss: 0.5464, label: 3, bag_size: 872
batch 559, loss: 0.0433, instance_loss: 0.2502, weighted_loss: 0.1054, label: 0, bag_size: 524
batch 579, loss: 1.8557, instance_loss: 0.5203, weighted_loss: 1.4551, label: 2, bag_size: 185


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.06965488215488215: correct 331/4752
Epoch: 53, train_loss: 1.0959, train_clustering_loss:  0.4727, train_error: 0.4848
class 0: acc 0.7560975609756098, correct 93/123
class 1: acc 0.4297520661157025, correct 52/121
class 2: acc 0.40350877192982454, correct 46/114
class 3: acc 0.44642857142857145, correct 50/112
class 4: acc 0.5241935483870968, correct 65/124

Val Set, val_loss: 1.1629, val_error: 0.5405, auc: 0.8286
class 0 clustering acc 0.985472972972973: correct 2917/2960
class 1 clustering acc 0.1570945945945946: correct 93/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0911, instance_loss: 0.5444, weighted_loss: 0.9271, label: 0, bag_size: 710
batch 39, loss: 0.8236, instance_loss: 0.5032, weighted_loss: 0.7274, label: 3, bag_size: 364
batch 59, loss: 0.0049, instance_loss: 0.1977, weighted_loss: 0.0628, label: 0, bag_size: 706
batch 79, loss: 0.3932, instance_loss: 0.3736, weighted_loss: 0.3873, label: 4, bag_size: 293
batch 99, loss: 0.0617, instance_loss: 0.4062, weighted_loss: 0.1651, label: 1, bag_size: 1497
batch 119, loss: 0.3636, instance_loss: 0.3662, weighted_loss: 0.3644, label: 4, bag_size: 775
batch 139, loss: 1.3757, instance_loss: 0.5176, weighted_loss: 1.1183, label: 3, bag_size: 781
batch 159, loss: 0.3967, instance_loss: 0.4597, weighted_loss: 0.4156, label: 4, bag_size: 727
batch 179, loss: 0.0684, instance_loss: 0.1682, weighted_loss: 0.0983, label: 0, bag_size: 517
batch 199, loss: 1.1126, instance_loss: 0.5880, weighted_loss: 0.9552, label: 0, bag_size: 587
batch 219, loss: 1.2117, instance_loss: 0.4605, weighted_loss: 0.9863, label: 2, bag_size: 799
batch 239, loss: 0.5280, instance_loss: 0.4470, weighted_loss: 0.5037, label: 4, bag_size: 687
batch 259, loss: 0.7343, instance_loss: 0.3888, weighted_loss: 0.6307, label: 2, bag_size: 702
batch 279, loss: 2.8938, instance_loss: 0.5976, weighted_loss: 2.2049, label: 2, bag_size: 1122
batch 299, loss: 2.2671, instance_loss: 0.6268, weighted_loss: 1.7750, label: 3, bag_size: 492
batch 319, loss: 4.5107, instance_loss: 0.8498, weighted_loss: 3.4125, label: 0, bag_size: 608
batch 339, loss: 0.8931, instance_loss: 0.4568, weighted_loss: 0.7622, label: 1, bag_size: 271
batch 359, loss: 1.1730, instance_loss: 0.4943, weighted_loss: 0.9694, label: 1, bag_size: 311
batch 379, loss: 1.0677, instance_loss: 0.5660, weighted_loss: 0.9172, label: 3, bag_size: 97
batch 399, loss: 0.5873, instance_loss: 0.4361, weighted_loss: 0.5419, label: 4, bag_size: 563
batch 419, loss: 1.4233, instance_loss: 0.4783, weighted_loss: 1.1398, label: 4, bag_size: 757
batch 439, loss: 1.7239, instance_loss: 0.5526, weighted_loss: 1.3725, label: 1, bag_size: 355
batch 459, loss: 0.6850, instance_loss: 0.3904, weighted_loss: 0.5966, label: 2, bag_size: 867
batch 479, loss: 0.9164, instance_loss: 0.5586, weighted_loss: 0.8090, label: 0, bag_size: 311
batch 499, loss: 1.6463, instance_loss: 0.5451, weighted_loss: 1.3160, label: 2, bag_size: 96
batch 519, loss: 1.1521, instance_loss: 0.5318, weighted_loss: 0.9660, label: 4, bag_size: 113
batch 539, loss: 0.6897, instance_loss: 0.4538, weighted_loss: 0.6189, label: 4, bag_size: 604
batch 559, loss: 0.0534, instance_loss: 0.2540, weighted_loss: 0.1135, label: 0, bag_size: 49
batch 579, loss: 1.0160, instance_loss: 0.4500, weighted_loss: 0.8462, label: 2, bag_size: 554


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.06923400673400673: correct 329/4752
Epoch: 54, train_loss: 1.0110, train_clustering_loss:  0.4607, train_error: 0.4141
class 0: acc 0.7903225806451613, correct 98/124
class 1: acc 0.47368421052631576, correct 54/114
class 2: acc 0.5103448275862069, correct 74/145
class 3: acc 0.48936170212765956, correct 46/94
class 4: acc 0.6495726495726496, correct 76/117

Val Set, val_loss: 1.0536, val_error: 0.4324, auc: 0.8603
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.10810810810810811: correct 64/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0045, instance_loss: 0.2165, weighted_loss: 0.0681, label: 0, bag_size: 15
batch 39, loss: 1.6518, instance_loss: 0.6789, weighted_loss: 1.3600, label: 3, bag_size: 282
batch 59, loss: 1.1897, instance_loss: 0.4732, weighted_loss: 0.9747, label: 2, bag_size: 315
batch 79, loss: 1.1211, instance_loss: 0.5159, weighted_loss: 0.9396, label: 3, bag_size: 312
batch 99, loss: 0.4465, instance_loss: 0.4639, weighted_loss: 0.4517, label: 4, bag_size: 506
batch 119, loss: 0.1914, instance_loss: 0.3555, weighted_loss: 0.2406, label: 4, bag_size: 948
batch 139, loss: 0.3776, instance_loss: 0.4943, weighted_loss: 0.4126, label: 4, bag_size: 446
batch 159, loss: 1.8284, instance_loss: 0.4827, weighted_loss: 1.4247, label: 2, bag_size: 934
batch 179, loss: 1.8636, instance_loss: 0.6293, weighted_loss: 1.4933, label: 3, bag_size: 337
batch 199, loss: 1.3569, instance_loss: 0.4890, weighted_loss: 1.0965, label: 1, bag_size: 372
batch 219, loss: 0.8897, instance_loss: 0.4925, weighted_loss: 0.7705, label: 1, bag_size: 599
batch 239, loss: 0.1198, instance_loss: 0.5921, weighted_loss: 0.2615, label: 1, bag_size: 44
batch 259, loss: 0.3000, instance_loss: 0.3156, weighted_loss: 0.3047, label: 0, bag_size: 168
batch 279, loss: 0.5572, instance_loss: 0.3984, weighted_loss: 0.5096, label: 2, bag_size: 1079
batch 299, loss: 0.0046, instance_loss: 0.1519, weighted_loss: 0.0488, label: 0, bag_size: 236
batch 319, loss: 1.3783, instance_loss: 0.5321, weighted_loss: 1.1244, label: 3, bag_size: 996
batch 339, loss: 0.2897, instance_loss: 0.2799, weighted_loss: 0.2868, label: 0, bag_size: 397
batch 359, loss: 1.1539, instance_loss: 0.6366, weighted_loss: 0.9987, label: 4, bag_size: 198
batch 379, loss: 0.5377, instance_loss: 0.4033, weighted_loss: 0.4974, label: 2, bag_size: 598
batch 399, loss: 1.0141, instance_loss: 0.5206, weighted_loss: 0.8661, label: 3, bag_size: 97
batch 419, loss: 1.3381, instance_loss: 0.4499, weighted_loss: 1.0717, label: 2, bag_size: 953
batch 439, loss: 2.1849, instance_loss: 0.5584, weighted_loss: 1.6970, label: 1, bag_size: 272
batch 459, loss: 1.6792, instance_loss: 0.7265, weighted_loss: 1.3934, label: 3, bag_size: 282
batch 479, loss: 1.6499, instance_loss: 0.5061, weighted_loss: 1.3068, label: 1, bag_size: 525
batch 499, loss: 0.2126, instance_loss: 0.3740, weighted_loss: 0.2610, label: 1, bag_size: 106
batch 519, loss: 0.0769, instance_loss: 0.7038, weighted_loss: 0.2649, label: 1, bag_size: 44
batch 539, loss: 0.0597, instance_loss: 0.2171, weighted_loss: 0.1069, label: 0, bag_size: 210
batch 559, loss: 0.1305, instance_loss: 0.4398, weighted_loss: 0.2233, label: 1, bag_size: 1497
batch 579, loss: 0.2090, instance_loss: 0.4454, weighted_loss: 0.2799, label: 4, bag_size: 503


class 0 clustering acc 0.9957070707070707: correct 23658/23760
class 1 clustering acc 0.08564814814814815: correct 407/4752
Epoch: 55, train_loss: 1.0134, train_clustering_loss:  0.4578, train_error: 0.4360
class 0: acc 0.8373983739837398, correct 103/123
class 1: acc 0.46511627906976744, correct 60/129
class 2: acc 0.47619047619047616, correct 60/126
class 3: acc 0.39805825242718446, correct 41/103
class 4: acc 0.6283185840707964, correct 71/113

Val Set, val_loss: 1.0228, val_error: 0.4865, auc: 0.8614
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.08277027027027027: correct 49/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.031284 --> 1.022829).  Saving model ...


batch 19, loss: 0.4542, instance_loss: 0.3556, weighted_loss: 0.4247, label: 2, bag_size: 706
batch 39, loss: 0.6497, instance_loss: 0.4789, weighted_loss: 0.5984, label: 3, bag_size: 245
batch 59, loss: 1.3419, instance_loss: 0.5603, weighted_loss: 1.1074, label: 3, bag_size: 899
batch 79, loss: 0.7032, instance_loss: 0.4086, weighted_loss: 0.6148, label: 1, bag_size: 106
batch 99, loss: 0.8121, instance_loss: 0.3690, weighted_loss: 0.6792, label: 2, bag_size: 867
batch 119, loss: 0.5663, instance_loss: 0.3852, weighted_loss: 0.5119, label: 2, bag_size: 613
batch 139, loss: 0.4160, instance_loss: 0.4795, weighted_loss: 0.4351, label: 2, bag_size: 861
batch 159, loss: 1.3302, instance_loss: 0.6742, weighted_loss: 1.1334, label: 1, bag_size: 1091
batch 179, loss: 0.7592, instance_loss: 0.4526, weighted_loss: 0.6672, label: 2, bag_size: 530
batch 199, loss: 0.8170, instance_loss: 0.4380, weighted_loss: 0.7033, label: 3, bag_size: 272
batch 219, loss: 0.3588, instance_loss: 0.4078, weighted_loss: 0.3735, label: 4, bag_size: 520
batch 239, loss: 1.5495, instance_loss: 0.4797, weighted_loss: 1.2285, label: 0, bag_size: 305
batch 259, loss: 0.1087, instance_loss: 0.1918, weighted_loss: 0.1337, label: 0, bag_size: 98
batch 279, loss: 0.0679, instance_loss: 0.1796, weighted_loss: 0.1014, label: 0, bag_size: 188
batch 299, loss: 2.2659, instance_loss: 0.5217, weighted_loss: 1.7426, label: 1, bag_size: 702
batch 319, loss: 1.2380, instance_loss: 0.4895, weighted_loss: 1.0135, label: 3, bag_size: 423
batch 339, loss: 0.1784, instance_loss: 0.3241, weighted_loss: 0.2222, label: 4, bag_size: 409
batch 359, loss: 0.9761, instance_loss: 0.4423, weighted_loss: 0.8160, label: 4, bag_size: 712
batch 379, loss: 2.0957, instance_loss: 0.6237, weighted_loss: 1.6541, label: 4, bag_size: 101
batch 399, loss: 0.5974, instance_loss: 0.3760, weighted_loss: 0.5310, label: 4, bag_size: 744
batch 419, loss: 0.6515, instance_loss: 0.4144, weighted_loss: 0.5804, label: 2, bag_size: 522
batch 439, loss: 0.2061, instance_loss: 0.4297, weighted_loss: 0.2732, label: 2, bag_size: 614
batch 459, loss: 0.5279, instance_loss: 0.3800, weighted_loss: 0.4836, label: 1, bag_size: 840
batch 479, loss: 0.4920, instance_loss: 0.3524, weighted_loss: 0.4501, label: 4, bag_size: 730
batch 499, loss: 0.4096, instance_loss: 0.4274, weighted_loss: 0.4149, label: 4, bag_size: 53
batch 519, loss: 1.4910, instance_loss: 0.5661, weighted_loss: 1.2135, label: 3, bag_size: 489
batch 539, loss: 0.0318, instance_loss: 0.1610, weighted_loss: 0.0705, label: 0, bag_size: 285
batch 559, loss: 0.5648, instance_loss: 0.4176, weighted_loss: 0.5207, label: 3, bag_size: 274
batch 579, loss: 0.5690, instance_loss: 0.4725, weighted_loss: 0.5400, label: 2, bag_size: 258


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.08291245791245791: correct 394/4752
Epoch: 56, train_loss: 1.0091, train_clustering_loss:  0.4595, train_error: 0.4293
class 0: acc 0.8508771929824561, correct 97/114
class 1: acc 0.3949579831932773, correct 47/119
class 2: acc 0.4672131147540984, correct 57/122
class 3: acc 0.5371900826446281, correct 65/121
class 4: acc 0.6186440677966102, correct 73/118

Val Set, val_loss: 1.1306, val_error: 0.4865, auc: 0.8327
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1843, instance_loss: 0.2010, weighted_loss: 0.1893, label: 0, bag_size: 192
batch 39, loss: 0.6418, instance_loss: 0.5228, weighted_loss: 0.6061, label: 1, bag_size: 106
batch 59, loss: 0.9598, instance_loss: 0.5469, weighted_loss: 0.8360, label: 0, bag_size: 615
batch 79, loss: 0.1351, instance_loss: 0.1922, weighted_loss: 0.1522, label: 0, bag_size: 428
batch 99, loss: 2.0977, instance_loss: 0.5250, weighted_loss: 1.6259, label: 0, bag_size: 478
batch 119, loss: 0.3507, instance_loss: 0.3919, weighted_loss: 0.3631, label: 1, bag_size: 410
batch 139, loss: 0.5765, instance_loss: 0.4258, weighted_loss: 0.5313, label: 3, bag_size: 872
batch 159, loss: 0.2667, instance_loss: 0.6485, weighted_loss: 0.3813, label: 0, bag_size: 283
batch 179, loss: 0.6091, instance_loss: 0.5545, weighted_loss: 0.5927, label: 4, bag_size: 730
batch 199, loss: 1.5224, instance_loss: 0.5496, weighted_loss: 1.2306, label: 3, bag_size: 486
batch 219, loss: 0.3573, instance_loss: 0.4028, weighted_loss: 0.3710, label: 2, bag_size: 348
batch 239, loss: 0.8314, instance_loss: 0.4775, weighted_loss: 0.7252, label: 4, bag_size: 744
batch 259, loss: 1.1059, instance_loss: 0.3667, weighted_loss: 0.8841, label: 2, bag_size: 1003
batch 279, loss: 0.0042, instance_loss: 0.1070, weighted_loss: 0.0350, label: 0, bag_size: 51
batch 299, loss: 0.4810, instance_loss: 0.4067, weighted_loss: 0.4587, label: 0, bag_size: 524
batch 319, loss: 0.4010, instance_loss: 0.5038, weighted_loss: 0.4318, label: 1, bag_size: 1091
batch 339, loss: 1.2393, instance_loss: 0.4511, weighted_loss: 1.0028, label: 2, bag_size: 321
batch 359, loss: 1.3697, instance_loss: 0.5516, weighted_loss: 1.1243, label: 3, bag_size: 520
batch 379, loss: 0.9240, instance_loss: 0.4729, weighted_loss: 0.7887, label: 2, bag_size: 133
batch 399, loss: 1.7345, instance_loss: 0.5101, weighted_loss: 1.3672, label: 1, bag_size: 481
batch 419, loss: 0.8278, instance_loss: 0.4679, weighted_loss: 0.7198, label: 4, bag_size: 53
batch 439, loss: 1.3081, instance_loss: 0.4977, weighted_loss: 1.0649, label: 3, bag_size: 489
batch 459, loss: 0.3576, instance_loss: 0.4680, weighted_loss: 0.3907, label: 2, bag_size: 936
batch 479, loss: 0.4535, instance_loss: 0.4036, weighted_loss: 0.4386, label: 4, bag_size: 742
batch 499, loss: 0.9655, instance_loss: 0.4277, weighted_loss: 0.8041, label: 0, bag_size: 404
batch 519, loss: 0.1148, instance_loss: 0.3107, weighted_loss: 0.1736, label: 0, bag_size: 59
batch 539, loss: 0.6448, instance_loss: 0.3712, weighted_loss: 0.5627, label: 0, bag_size: 400
batch 559, loss: 2.2001, instance_loss: 0.5753, weighted_loss: 1.7126, label: 4, bag_size: 356
batch 579, loss: 1.1167, instance_loss: 0.5077, weighted_loss: 0.9340, label: 3, bag_size: 476


class 0 clustering acc 0.9955387205387205: correct 23654/23760
class 1 clustering acc 0.08901515151515152: correct 423/4752
Epoch: 57, train_loss: 1.0317, train_clustering_loss:  0.4680, train_error: 0.4226
class 0: acc 0.8103448275862069, correct 94/116
class 1: acc 0.5043478260869565, correct 58/115
class 2: acc 0.5126050420168067, correct 61/119
class 3: acc 0.39473684210526316, correct 45/114
class 4: acc 0.6538461538461539, correct 85/130

Val Set, val_loss: 1.0298, val_error: 0.4730, auc: 0.8546
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.10810810810810811: correct 64/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1890, instance_loss: 0.4725, weighted_loss: 0.2740, label: 2, bag_size: 348
batch 39, loss: 0.7673, instance_loss: 0.4596, weighted_loss: 0.6750, label: 4, bag_size: 1041
batch 59, loss: 0.4929, instance_loss: 0.4929, weighted_loss: 0.4929, label: 2, bag_size: 571
batch 79, loss: 0.1073, instance_loss: 0.2079, weighted_loss: 0.1375, label: 0, bag_size: 282
batch 99, loss: 1.2891, instance_loss: 0.5401, weighted_loss: 1.0644, label: 0, bag_size: 343
batch 119, loss: 0.7841, instance_loss: 0.4648, weighted_loss: 0.6883, label: 4, bag_size: 113
batch 139, loss: 0.2348, instance_loss: 0.3910, weighted_loss: 0.2817, label: 4, bag_size: 377
batch 159, loss: 10.7386, instance_loss: 1.2733, weighted_loss: 7.8990, label: 2, bag_size: 809
batch 179, loss: 0.1553, instance_loss: 0.2607, weighted_loss: 0.1870, label: 0, bag_size: 210
batch 199, loss: 1.2306, instance_loss: 0.4729, weighted_loss: 1.0033, label: 2, bag_size: 934
batch 219, loss: 0.1446, instance_loss: 0.4553, weighted_loss: 0.2378, label: 1, bag_size: 371
batch 239, loss: 3.8815, instance_loss: 0.6498, weighted_loss: 2.9119, label: 2, bag_size: 519
batch 259, loss: 2.5780, instance_loss: 0.6014, weighted_loss: 1.9850, label: 0, bag_size: 964
batch 279, loss: 2.3681, instance_loss: 0.6679, weighted_loss: 1.8580, label: 3, bag_size: 520
batch 299, loss: 1.7335, instance_loss: 0.7101, weighted_loss: 1.4265, label: 4, bag_size: 1351
batch 319, loss: 0.4957, instance_loss: 0.4676, weighted_loss: 0.4873, label: 0, bag_size: 62
batch 339, loss: 0.5760, instance_loss: 0.4315, weighted_loss: 0.5326, label: 3, bag_size: 272
batch 359, loss: 0.3927, instance_loss: 0.4125, weighted_loss: 0.3987, label: 0, bag_size: 269
batch 379, loss: 0.8438, instance_loss: 0.5099, weighted_loss: 0.7436, label: 4, bag_size: 703
batch 399, loss: 0.8976, instance_loss: 0.5143, weighted_loss: 0.7826, label: 2, bag_size: 315
batch 419, loss: 0.9613, instance_loss: 0.4718, weighted_loss: 0.8144, label: 3, bag_size: 631
batch 439, loss: 0.5504, instance_loss: 0.4050, weighted_loss: 0.5068, label: 4, bag_size: 574
batch 459, loss: 3.6783, instance_loss: 0.6123, weighted_loss: 2.7585, label: 3, bag_size: 342
batch 479, loss: 2.7288, instance_loss: 0.7519, weighted_loss: 2.1358, label: 2, bag_size: 809
batch 499, loss: 0.2830, instance_loss: 0.8035, weighted_loss: 0.4392, label: 4, bag_size: 773
batch 519, loss: 1.0005, instance_loss: 0.5077, weighted_loss: 0.8526, label: 3, bag_size: 312
batch 539, loss: 0.9283, instance_loss: 0.4993, weighted_loss: 0.7996, label: 3, bag_size: 822
batch 559, loss: 1.8239, instance_loss: 0.5933, weighted_loss: 1.4547, label: 2, bag_size: 208
batch 579, loss: 0.7049, instance_loss: 0.4590, weighted_loss: 0.6311, label: 3, bag_size: 317


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.07218013468013468: correct 343/4752
Epoch: 58, train_loss: 1.0444, train_clustering_loss:  0.4727, train_error: 0.4461
class 0: acc 0.6923076923076923, correct 81/117
class 1: acc 0.5925925925925926, correct 80/135
class 2: acc 0.4715447154471545, correct 58/123
class 3: acc 0.4, correct 44/110
class 4: acc 0.6055045871559633, correct 66/109

Val Set, val_loss: 1.1117, val_error: 0.4189, auc: 0.8447
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6849, instance_loss: 0.4487, weighted_loss: 0.6140, label: 4, bag_size: 744
batch 39, loss: 1.0668, instance_loss: 0.6540, weighted_loss: 0.9429, label: 4, bag_size: 690
batch 59, loss: 0.0853, instance_loss: 0.2485, weighted_loss: 0.1343, label: 0, bag_size: 282
batch 79, loss: 1.8403, instance_loss: 0.6278, weighted_loss: 1.4766, label: 3, bag_size: 894
batch 99, loss: 0.8786, instance_loss: 0.5752, weighted_loss: 0.7876, label: 4, bag_size: 356
batch 119, loss: 1.0215, instance_loss: 0.5920, weighted_loss: 0.8926, label: 2, bag_size: 853
batch 139, loss: 1.3717, instance_loss: 0.4921, weighted_loss: 1.1078, label: 1, bag_size: 525
batch 159, loss: 0.9699, instance_loss: 0.4503, weighted_loss: 0.8140, label: 2, bag_size: 582
batch 179, loss: 0.6391, instance_loss: 0.5125, weighted_loss: 0.6011, label: 1, bag_size: 949
batch 199, loss: 0.3509, instance_loss: 0.4015, weighted_loss: 0.3661, label: 4, bag_size: 1113
batch 219, loss: 3.6311, instance_loss: 0.8200, weighted_loss: 2.7878, label: 2, bag_size: 258
batch 239, loss: 1.7034, instance_loss: 0.6000, weighted_loss: 1.3724, label: 1, bag_size: 490
batch 259, loss: 2.3381, instance_loss: 0.4584, weighted_loss: 1.7742, label: 2, bag_size: 606
batch 279, loss: 1.6669, instance_loss: 0.4901, weighted_loss: 1.3138, label: 2, bag_size: 258
batch 299, loss: 0.0302, instance_loss: 0.2072, weighted_loss: 0.0833, label: 0, bag_size: 142
batch 319, loss: 0.7919, instance_loss: 0.4320, weighted_loss: 0.6839, label: 1, bag_size: 1023
batch 339, loss: 0.0255, instance_loss: 0.3335, weighted_loss: 0.1179, label: 0, bag_size: 283
batch 359, loss: 1.2286, instance_loss: 0.5175, weighted_loss: 1.0152, label: 4, bag_size: 333
batch 379, loss: 0.8062, instance_loss: 0.4554, weighted_loss: 0.7010, label: 3, bag_size: 312
batch 399, loss: 1.4013, instance_loss: 0.5731, weighted_loss: 1.1528, label: 0, bag_size: 305
batch 419, loss: 0.3216, instance_loss: 0.4495, weighted_loss: 0.3600, label: 0, bag_size: 238
batch 439, loss: 0.4861, instance_loss: 0.4095, weighted_loss: 0.4631, label: 0, bag_size: 400
batch 459, loss: 1.2880, instance_loss: 0.4327, weighted_loss: 1.0314, label: 2, bag_size: 421
batch 479, loss: 1.5390, instance_loss: 0.6624, weighted_loss: 1.2761, label: 4, bag_size: 1297
batch 499, loss: 1.6323, instance_loss: 0.4660, weighted_loss: 1.2824, label: 1, bag_size: 413
batch 519, loss: 3.3696, instance_loss: 0.5334, weighted_loss: 2.5188, label: 4, bag_size: 699
batch 539, loss: 1.6461, instance_loss: 0.4952, weighted_loss: 1.3008, label: 2, bag_size: 746
batch 559, loss: 1.7498, instance_loss: 0.4825, weighted_loss: 1.3696, label: 4, bag_size: 356
batch 579, loss: 3.0268, instance_loss: 0.6027, weighted_loss: 2.2995, label: 2, bag_size: 829


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.0765993265993266: correct 364/4752
Epoch: 59, train_loss: 1.0239, train_clustering_loss:  0.4689, train_error: 0.4444
class 0: acc 0.7795275590551181, correct 99/127
class 1: acc 0.5441176470588235, correct 74/136
class 2: acc 0.391304347826087, correct 45/115
class 3: acc 0.5185185185185185, correct 56/108
class 4: acc 0.5185185185185185, correct 56/108

Val Set, val_loss: 1.0341, val_error: 0.4730, auc: 0.8477
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7332, instance_loss: 0.4757, weighted_loss: 0.6560, label: 1, bag_size: 1103
batch 39, loss: 3.8757, instance_loss: 0.7560, weighted_loss: 2.9397, label: 1, bag_size: 311
batch 59, loss: 1.5553, instance_loss: 0.4244, weighted_loss: 1.2160, label: 0, bag_size: 74
batch 79, loss: 1.6836, instance_loss: 0.5567, weighted_loss: 1.3455, label: 4, bag_size: 356
batch 99, loss: 1.3007, instance_loss: 0.4850, weighted_loss: 1.0560, label: 2, bag_size: 119
batch 119, loss: 3.0100, instance_loss: 0.7942, weighted_loss: 2.3452, label: 1, bag_size: 45
batch 139, loss: 1.4010, instance_loss: 0.4642, weighted_loss: 1.1200, label: 0, bag_size: 478
batch 159, loss: 0.2420, instance_loss: 0.3460, weighted_loss: 0.2732, label: 0, bag_size: 98
batch 179, loss: 1.2255, instance_loss: 0.5472, weighted_loss: 1.0220, label: 3, bag_size: 739
batch 199, loss: 1.3220, instance_loss: 0.5183, weighted_loss: 1.0809, label: 1, bag_size: 159
batch 219, loss: 0.9711, instance_loss: 0.4954, weighted_loss: 0.8284, label: 2, bag_size: 934
batch 239, loss: 0.9216, instance_loss: 0.4939, weighted_loss: 0.7933, label: 3, bag_size: 457
batch 259, loss: 0.8036, instance_loss: 0.4006, weighted_loss: 0.6827, label: 3, bag_size: 631
batch 279, loss: 0.5691, instance_loss: 0.4058, weighted_loss: 0.5201, label: 0, bag_size: 231
batch 299, loss: 0.8056, instance_loss: 0.4721, weighted_loss: 0.7056, label: 0, bag_size: 613
batch 319, loss: 1.7969, instance_loss: 0.4319, weighted_loss: 1.3874, label: 2, bag_size: 606
batch 339, loss: 0.7073, instance_loss: 0.5287, weighted_loss: 0.6537, label: 3, bag_size: 858
batch 359, loss: 0.5618, instance_loss: 0.4429, weighted_loss: 0.5261, label: 4, bag_size: 875
batch 379, loss: 2.7378, instance_loss: 0.5440, weighted_loss: 2.0796, label: 3, bag_size: 301
batch 399, loss: 1.1328, instance_loss: 0.4698, weighted_loss: 0.9339, label: 2, bag_size: 597
batch 419, loss: 0.3878, instance_loss: 0.4182, weighted_loss: 0.3969, label: 4, bag_size: 238
batch 439, loss: 1.2341, instance_loss: 0.5427, weighted_loss: 1.0267, label: 3, bag_size: 344
batch 459, loss: 0.3784, instance_loss: 0.4265, weighted_loss: 0.3928, label: 1, bag_size: 886
batch 479, loss: 1.1429, instance_loss: 0.4872, weighted_loss: 0.9462, label: 3, bag_size: 779
batch 499, loss: 0.0047, instance_loss: 0.2316, weighted_loss: 0.0728, label: 0, bag_size: 58
batch 519, loss: 2.0766, instance_loss: 0.5562, weighted_loss: 1.6205, label: 4, bag_size: 270
batch 539, loss: 0.1112, instance_loss: 0.2446, weighted_loss: 0.1512, label: 0, bag_size: 578
batch 559, loss: 1.3274, instance_loss: 0.4998, weighted_loss: 1.0791, label: 4, bag_size: 740
batch 579, loss: 1.1859, instance_loss: 0.5159, weighted_loss: 0.9849, label: 4, bag_size: 1104


class 0 clustering acc 0.9965488215488215: correct 23678/23760
class 1 clustering acc 0.05744949494949495: correct 273/4752
Epoch: 60, train_loss: 1.0117, train_clustering_loss:  0.4644, train_error: 0.4293
class 0: acc 0.7982456140350878, correct 91/114
class 1: acc 0.5084745762711864, correct 60/118
class 2: acc 0.49137931034482757, correct 57/116
class 3: acc 0.42857142857142855, correct 54/126
class 4: acc 0.6416666666666667, correct 77/120

Val Set, val_loss: 1.0422, val_error: 0.4730, auc: 0.8456
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.0472972972972973: correct 28/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3110, instance_loss: 0.2507, weighted_loss: 0.2929, label: 0, bag_size: 552
batch 39, loss: 1.6903, instance_loss: 0.5622, weighted_loss: 1.3518, label: 0, bag_size: 376
batch 59, loss: 0.2285, instance_loss: 0.3906, weighted_loss: 0.2771, label: 4, bag_size: 563
batch 79, loss: 1.8770, instance_loss: 0.5792, weighted_loss: 1.4877, label: 4, bag_size: 685
batch 99, loss: 1.0911, instance_loss: 0.5207, weighted_loss: 0.9200, label: 3, bag_size: 857
batch 119, loss: 0.9226, instance_loss: 0.4399, weighted_loss: 0.7778, label: 2, bag_size: 572
batch 139, loss: 2.2253, instance_loss: 0.5885, weighted_loss: 1.7342, label: 2, bag_size: 411
batch 159, loss: 0.0199, instance_loss: 0.4040, weighted_loss: 0.1351, label: 2, bag_size: 1608
batch 179, loss: 0.9436, instance_loss: 0.4372, weighted_loss: 0.7917, label: 1, bag_size: 591
batch 199, loss: 1.5641, instance_loss: 0.5268, weighted_loss: 1.2529, label: 1, bag_size: 1360
batch 219, loss: 1.4443, instance_loss: 0.5988, weighted_loss: 1.1907, label: 2, bag_size: 860
batch 239, loss: 0.9575, instance_loss: 0.4491, weighted_loss: 0.8050, label: 2, bag_size: 1066
batch 259, loss: 3.1530, instance_loss: 0.8999, weighted_loss: 2.4771, label: 2, bag_size: 258
batch 279, loss: 0.3341, instance_loss: 0.4737, weighted_loss: 0.3760, label: 1, bag_size: 544
batch 299, loss: 1.0604, instance_loss: 0.4709, weighted_loss: 0.8836, label: 4, bag_size: 1297
batch 319, loss: 1.3357, instance_loss: 0.4825, weighted_loss: 1.0797, label: 2, bag_size: 380
batch 339, loss: 0.7221, instance_loss: 0.4851, weighted_loss: 0.6510, label: 3, bag_size: 489
batch 359, loss: 4.5360, instance_loss: 0.9867, weighted_loss: 3.4712, label: 2, bag_size: 340
batch 379, loss: 2.9775, instance_loss: 0.5650, weighted_loss: 2.2538, label: 1, bag_size: 1019
batch 399, loss: 2.1317, instance_loss: 0.6246, weighted_loss: 1.6796, label: 4, bag_size: 685
batch 419, loss: 0.9759, instance_loss: 0.4362, weighted_loss: 0.8140, label: 2, bag_size: 941
batch 439, loss: 0.4028, instance_loss: 0.4308, weighted_loss: 0.4112, label: 0, bag_size: 367
batch 459, loss: 3.2203, instance_loss: 0.7488, weighted_loss: 2.4788, label: 3, bag_size: 337
batch 479, loss: 1.0606, instance_loss: 0.4354, weighted_loss: 0.8730, label: 3, bag_size: 457
batch 499, loss: 0.9490, instance_loss: 0.4729, weighted_loss: 0.8062, label: 3, bag_size: 472
batch 519, loss: 0.4121, instance_loss: 0.4133, weighted_loss: 0.4125, label: 2, bag_size: 754
batch 539, loss: 3.5728, instance_loss: 0.5132, weighted_loss: 2.6549, label: 3, bag_size: 533
batch 559, loss: 0.7782, instance_loss: 0.4577, weighted_loss: 0.6821, label: 2, bag_size: 317
batch 579, loss: 0.5759, instance_loss: 0.4061, weighted_loss: 0.5250, label: 3, bag_size: 272


class 0 clustering acc 0.994486531986532: correct 23629/23760
class 1 clustering acc 0.07954545454545454: correct 378/4752
Epoch: 61, train_loss: 1.0498, train_clustering_loss:  0.4725, train_error: 0.4175
class 0: acc 0.7863247863247863, correct 92/117
class 1: acc 0.44761904761904764, correct 47/105
class 2: acc 0.4745762711864407, correct 56/118
class 3: acc 0.5416666666666666, correct 65/120
class 4: acc 0.6417910447761194, correct 86/134

Val Set, val_loss: 1.0284, val_error: 0.4459, auc: 0.8575
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3545, instance_loss: 0.4996, weighted_loss: 1.0980, label: 2, bag_size: 1074
batch 39, loss: 2.0014, instance_loss: 0.6629, weighted_loss: 1.5998, label: 3, bag_size: 228
batch 59, loss: 0.8592, instance_loss: 0.4252, weighted_loss: 0.7290, label: 4, bag_size: 714
batch 79, loss: 0.7730, instance_loss: 0.5899, weighted_loss: 0.7181, label: 1, bag_size: 886
batch 99, loss: 1.1595, instance_loss: 0.4916, weighted_loss: 0.9591, label: 3, bag_size: 431
batch 119, loss: 0.0391, instance_loss: 0.1726, weighted_loss: 0.0791, label: 0, bag_size: 69
batch 139, loss: 0.0159, instance_loss: 0.5091, weighted_loss: 0.1639, label: 0, bag_size: 214
batch 159, loss: 0.5654, instance_loss: 0.3941, weighted_loss: 0.5140, label: 2, bag_size: 266
batch 179, loss: 0.3987, instance_loss: 0.3993, weighted_loss: 0.3989, label: 4, bag_size: 960
batch 199, loss: 1.4503, instance_loss: 0.5380, weighted_loss: 1.1766, label: 2, bag_size: 339
batch 219, loss: 0.4939, instance_loss: 0.5956, weighted_loss: 0.5244, label: 4, bag_size: 250
batch 239, loss: 0.6195, instance_loss: 0.4280, weighted_loss: 0.5621, label: 1, bag_size: 460
batch 259, loss: 1.8082, instance_loss: 0.4972, weighted_loss: 1.4149, label: 2, bag_size: 331
batch 279, loss: 0.4878, instance_loss: 0.3150, weighted_loss: 0.4360, label: 0, bag_size: 428
batch 299, loss: 0.0251, instance_loss: 0.2083, weighted_loss: 0.0800, label: 0, bag_size: 268
batch 319, loss: 0.7837, instance_loss: 0.4292, weighted_loss: 0.6773, label: 2, bag_size: 317
batch 339, loss: 0.5950, instance_loss: 0.4231, weighted_loss: 0.5435, label: 4, bag_size: 875
batch 359, loss: 3.5565, instance_loss: 0.6273, weighted_loss: 2.6778, label: 2, bag_size: 1319
batch 379, loss: 0.0650, instance_loss: 0.1720, weighted_loss: 0.0971, label: 0, bag_size: 351
batch 399, loss: 0.0869, instance_loss: 0.3187, weighted_loss: 0.1565, label: 0, bag_size: 49
batch 419, loss: 0.5514, instance_loss: 0.4308, weighted_loss: 0.5152, label: 2, bag_size: 350
batch 439, loss: 0.8144, instance_loss: 0.5457, weighted_loss: 0.7338, label: 0, bag_size: 317
batch 459, loss: 1.2448, instance_loss: 0.5139, weighted_loss: 1.0256, label: 3, bag_size: 437
batch 479, loss: 1.7694, instance_loss: 0.5632, weighted_loss: 1.4075, label: 4, bag_size: 498
batch 499, loss: 0.1865, instance_loss: 0.1743, weighted_loss: 0.1828, label: 0, bag_size: 366
batch 519, loss: 0.9297, instance_loss: 0.4167, weighted_loss: 0.7758, label: 2, bag_size: 941
batch 539, loss: 1.6505, instance_loss: 1.1057, weighted_loss: 1.4870, label: 4, bag_size: 530
batch 559, loss: 0.6069, instance_loss: 0.3747, weighted_loss: 0.5373, label: 0, bag_size: 306
batch 579, loss: 0.7998, instance_loss: 0.3468, weighted_loss: 0.6639, label: 0, bag_size: 319


class 0 clustering acc 0.9952020202020202: correct 23646/23760
class 1 clustering acc 0.09217171717171717: correct 438/4752
Epoch: 62, train_loss: 0.9471, train_clustering_loss:  0.4574, train_error: 0.3923
class 0: acc 0.8455284552845529, correct 104/123
class 1: acc 0.5462184873949579, correct 65/119
class 2: acc 0.48872180451127817, correct 65/133
class 3: acc 0.4444444444444444, correct 44/99
class 4: acc 0.6916666666666667, correct 83/120

Val Set, val_loss: 1.2660, val_error: 0.5405, auc: 0.8264
class 0 clustering acc 0.9939189189189189: correct 2942/2960
class 1 clustering acc 0.14527027027027026: correct 86/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.6108, instance_loss: 0.4076, weighted_loss: 0.5499, label: 2, bag_size: 543
batch 39, loss: 0.7716, instance_loss: 0.4188, weighted_loss: 0.6657, label: 2, bag_size: 769
batch 59, loss: 0.2201, instance_loss: 0.4622, weighted_loss: 0.2927, label: 3, bag_size: 428
batch 79, loss: 0.4093, instance_loss: 0.5001, weighted_loss: 0.4365, label: 2, bag_size: 512
batch 99, loss: 0.8923, instance_loss: 0.4848, weighted_loss: 0.7700, label: 1, bag_size: 391
batch 119, loss: 0.2386, instance_loss: 0.4950, weighted_loss: 0.3155, label: 1, bag_size: 886
batch 139, loss: 0.5347, instance_loss: 0.4163, weighted_loss: 0.4991, label: 4, bag_size: 520
batch 159, loss: 1.0140, instance_loss: 0.5945, weighted_loss: 0.8882, label: 2, bag_size: 208
batch 179, loss: 0.4444, instance_loss: 0.4124, weighted_loss: 0.4348, label: 3, bag_size: 245
batch 199, loss: 1.1649, instance_loss: 0.5849, weighted_loss: 0.9909, label: 4, bag_size: 574
batch 219, loss: 1.8835, instance_loss: 0.4833, weighted_loss: 1.4634, label: 4, bag_size: 712
batch 239, loss: 0.2307, instance_loss: 0.3918, weighted_loss: 0.2790, label: 3, bag_size: 98
batch 259, loss: 0.0763, instance_loss: 0.3281, weighted_loss: 0.1518, label: 0, bag_size: 453
batch 279, loss: 0.4791, instance_loss: 0.3952, weighted_loss: 0.4540, label: 1, bag_size: 829
batch 299, loss: 0.8396, instance_loss: 0.4069, weighted_loss: 0.7098, label: 1, bag_size: 605
batch 319, loss: 0.4778, instance_loss: 0.4870, weighted_loss: 0.4806, label: 0, bag_size: 283
batch 339, loss: 1.0447, instance_loss: 0.5918, weighted_loss: 0.9088, label: 3, bag_size: 681
batch 359, loss: 1.1857, instance_loss: 0.4511, weighted_loss: 0.9654, label: 1, bag_size: 1043
batch 379, loss: 1.4630, instance_loss: 0.5293, weighted_loss: 1.1829, label: 0, bag_size: 143
batch 399, loss: 0.2136, instance_loss: 0.4424, weighted_loss: 0.2823, label: 0, bag_size: 367
batch 419, loss: 0.0203, instance_loss: 0.2005, weighted_loss: 0.0743, label: 0, bag_size: 69
batch 439, loss: 0.0000, instance_loss: 0.2911, weighted_loss: 0.0873, label: 4, bag_size: 359
batch 459, loss: 1.0095, instance_loss: 0.6510, weighted_loss: 0.9019, label: 2, bag_size: 288
batch 479, loss: 2.2234, instance_loss: 0.8432, weighted_loss: 1.8093, label: 2, bag_size: 754
batch 499, loss: 2.4559, instance_loss: 0.7991, weighted_loss: 1.9588, label: 2, bag_size: 168
batch 519, loss: 0.4874, instance_loss: 0.3972, weighted_loss: 0.4603, label: 4, bag_size: 744
batch 539, loss: 0.5356, instance_loss: 0.4641, weighted_loss: 0.5142, label: 4, bag_size: 450
batch 559, loss: 0.7949, instance_loss: 0.4778, weighted_loss: 0.6997, label: 4, bag_size: 574
batch 579, loss: 1.0336, instance_loss: 0.4336, weighted_loss: 0.8536, label: 1, bag_size: 981


class 0 clustering acc 0.9950757575757576: correct 23643/23760
class 1 clustering acc 0.06797138047138047: correct 323/4752
Epoch: 63, train_loss: 0.9811, train_clustering_loss:  0.4697, train_error: 0.4259
class 0: acc 0.8130841121495327, correct 87/107
class 1: acc 0.47107438016528924, correct 57/121
class 2: acc 0.4262295081967213, correct 52/122
class 3: acc 0.656934306569343, correct 90/137
class 4: acc 0.514018691588785, correct 55/107

Val Set, val_loss: 0.9982, val_error: 0.4595, auc: 0.8624
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.022829 --> 0.998231).  Saving model ...


batch 19, loss: 1.2559, instance_loss: 0.5983, weighted_loss: 1.0586, label: 0, bag_size: 428
batch 39, loss: 0.1159, instance_loss: 0.2257, weighted_loss: 0.1489, label: 0, bag_size: 159
batch 59, loss: 0.8252, instance_loss: 0.5552, weighted_loss: 0.7442, label: 3, bag_size: 608
batch 79, loss: 0.8797, instance_loss: 0.4173, weighted_loss: 0.7410, label: 2, bag_size: 697
batch 99, loss: 0.1053, instance_loss: 0.2966, weighted_loss: 0.1627, label: 0, bag_size: 351
batch 119, loss: 0.4493, instance_loss: 0.4066, weighted_loss: 0.4365, label: 4, bag_size: 293
batch 139, loss: 4.3542, instance_loss: 0.6550, weighted_loss: 3.2444, label: 2, bag_size: 1319
batch 159, loss: 0.9905, instance_loss: 0.5165, weighted_loss: 0.8483, label: 3, bag_size: 364
batch 179, loss: 1.0623, instance_loss: 0.4443, weighted_loss: 0.8769, label: 3, bag_size: 1022
batch 199, loss: 1.5075, instance_loss: 0.4792, weighted_loss: 1.1990, label: 2, bag_size: 371
batch 219, loss: 0.1473, instance_loss: 0.3011, weighted_loss: 0.1934, label: 4, bag_size: 886
batch 239, loss: 3.0200, instance_loss: 0.5791, weighted_loss: 2.2877, label: 2, bag_size: 394
batch 259, loss: 0.7759, instance_loss: 0.4252, weighted_loss: 0.6707, label: 3, bag_size: 300
batch 279, loss: 0.0273, instance_loss: 0.1568, weighted_loss: 0.0662, label: 0, bag_size: 218
batch 299, loss: 0.1502, instance_loss: 0.2590, weighted_loss: 0.1828, label: 0, bag_size: 97
batch 319, loss: 0.1151, instance_loss: 0.1741, weighted_loss: 0.1328, label: 0, bag_size: 192
batch 339, loss: 0.7796, instance_loss: 0.5356, weighted_loss: 0.7064, label: 3, bag_size: 428
batch 359, loss: 1.2580, instance_loss: 0.4838, weighted_loss: 1.0257, label: 1, bag_size: 413
batch 379, loss: 3.1230, instance_loss: 0.7770, weighted_loss: 2.4192, label: 3, bag_size: 856
batch 399, loss: 1.7008, instance_loss: 0.4617, weighted_loss: 1.3291, label: 2, bag_size: 769
batch 419, loss: 1.3849, instance_loss: 0.5291, weighted_loss: 1.1281, label: 3, bag_size: 822
batch 439, loss: 0.8614, instance_loss: 0.4823, weighted_loss: 0.7476, label: 3, bag_size: 496
batch 459, loss: 0.6644, instance_loss: 0.5066, weighted_loss: 0.6171, label: 0, bag_size: 1414
batch 479, loss: 1.1122, instance_loss: 0.5188, weighted_loss: 0.9342, label: 1, bag_size: 1023
batch 499, loss: 0.9576, instance_loss: 0.4169, weighted_loss: 0.7954, label: 2, bag_size: 607
batch 519, loss: 0.8814, instance_loss: 0.4703, weighted_loss: 0.7581, label: 2, bag_size: 337
batch 539, loss: 0.4113, instance_loss: 0.5153, weighted_loss: 0.4425, label: 4, bag_size: 530
batch 559, loss: 1.4004, instance_loss: 0.7446, weighted_loss: 1.2037, label: 3, bag_size: 301
batch 579, loss: 1.6323, instance_loss: 0.6356, weighted_loss: 1.3333, label: 0, bag_size: 178


class 0 clustering acc 0.9947811447811448: correct 23636/23760
class 1 clustering acc 0.07765151515151515: correct 369/4752
Epoch: 64, train_loss: 0.9724, train_clustering_loss:  0.4638, train_error: 0.4125
class 0: acc 0.8211382113821138, correct 101/123
class 1: acc 0.4661016949152542, correct 55/118
class 2: acc 0.4846153846153846, correct 63/130
class 3: acc 0.5769230769230769, correct 60/104
class 4: acc 0.5882352941176471, correct 70/119

Val Set, val_loss: 1.0935, val_error: 0.4595, auc: 0.8462
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.0777027027027027: correct 46/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5787, instance_loss: 0.4588, weighted_loss: 0.5427, label: 1, bag_size: 1009
batch 39, loss: 0.0109, instance_loss: 0.5592, weighted_loss: 0.1754, label: 1, bag_size: 44
batch 59, loss: 0.0756, instance_loss: 0.2435, weighted_loss: 0.1260, label: 0, bag_size: 142
batch 79, loss: 1.1595, instance_loss: 0.4683, weighted_loss: 0.9521, label: 1, bag_size: 981
batch 99, loss: 3.8121, instance_loss: 0.8466, weighted_loss: 2.9224, label: 0, bag_size: 492
batch 119, loss: 0.1360, instance_loss: 0.3678, weighted_loss: 0.2055, label: 3, bag_size: 428
batch 139, loss: 0.9900, instance_loss: 0.4619, weighted_loss: 0.8316, label: 4, bag_size: 660
batch 159, loss: 1.2669, instance_loss: 0.6483, weighted_loss: 1.0813, label: 0, bag_size: 311
batch 179, loss: 4.2513, instance_loss: 0.9031, weighted_loss: 3.2469, label: 2, bag_size: 340
batch 199, loss: 2.6764, instance_loss: 0.4998, weighted_loss: 2.0235, label: 2, bag_size: 351
batch 219, loss: 0.0701, instance_loss: 0.1675, weighted_loss: 0.0993, label: 0, bag_size: 513
batch 239, loss: 0.5429, instance_loss: 0.4127, weighted_loss: 0.5038, label: 1, bag_size: 766
batch 259, loss: 0.9449, instance_loss: 0.4601, weighted_loss: 0.7995, label: 3, bag_size: 944
batch 279, loss: 3.2964, instance_loss: 0.7500, weighted_loss: 2.5325, label: 0, bag_size: 745
batch 299, loss: 1.2849, instance_loss: 0.6135, weighted_loss: 1.0835, label: 2, bag_size: 96
batch 319, loss: 0.3953, instance_loss: 0.3833, weighted_loss: 0.3917, label: 0, bag_size: 428
batch 339, loss: 1.4202, instance_loss: 0.5376, weighted_loss: 1.1554, label: 2, bag_size: 371
batch 359, loss: 2.2131, instance_loss: 0.4817, weighted_loss: 1.6937, label: 2, bag_size: 629
batch 379, loss: 0.7760, instance_loss: 0.4206, weighted_loss: 0.6694, label: 3, bag_size: 566
batch 399, loss: 0.4860, instance_loss: 0.4905, weighted_loss: 0.4873, label: 1, bag_size: 925
batch 419, loss: 1.6719, instance_loss: 0.5750, weighted_loss: 1.3429, label: 4, bag_size: 196
batch 439, loss: 0.2401, instance_loss: 0.4168, weighted_loss: 0.2931, label: 0, bag_size: 400
batch 459, loss: 0.7682, instance_loss: 0.5353, weighted_loss: 0.6983, label: 4, bag_size: 683
batch 479, loss: 1.6885, instance_loss: 0.5175, weighted_loss: 1.3372, label: 0, bag_size: 888
batch 499, loss: 0.6389, instance_loss: 0.4979, weighted_loss: 0.5966, label: 4, bag_size: 476
batch 519, loss: 1.1219, instance_loss: 0.4888, weighted_loss: 0.9320, label: 3, bag_size: 1007
batch 539, loss: 1.2239, instance_loss: 0.5146, weighted_loss: 1.0111, label: 0, bag_size: 888
batch 559, loss: 0.9820, instance_loss: 0.5880, weighted_loss: 0.8638, label: 3, bag_size: 1078
batch 579, loss: 1.4080, instance_loss: 0.5069, weighted_loss: 1.1377, label: 1, bag_size: 159


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.07386363636363637: correct 351/4752
Epoch: 65, train_loss: 0.9832, train_clustering_loss:  0.4676, train_error: 0.3906
class 0: acc 0.7711864406779662, correct 91/118
class 1: acc 0.5833333333333334, correct 70/120
class 2: acc 0.4576271186440678, correct 54/118
class 3: acc 0.5905511811023622, correct 75/127
class 4: acc 0.6486486486486487, correct 72/111

Val Set, val_loss: 1.0609, val_error: 0.4459, auc: 0.8533
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5696, instance_loss: 0.4293, weighted_loss: 0.5275, label: 4, bag_size: 468
batch 39, loss: 0.0220, instance_loss: 0.1981, weighted_loss: 0.0748, label: 0, bag_size: 103
batch 59, loss: 0.0474, instance_loss: 0.1829, weighted_loss: 0.0881, label: 0, bag_size: 188
batch 79, loss: 1.3047, instance_loss: 0.5284, weighted_loss: 1.0718, label: 3, bag_size: 681
batch 99, loss: 2.3980, instance_loss: 0.4526, weighted_loss: 1.8144, label: 4, bag_size: 446
batch 119, loss: 0.6694, instance_loss: 0.4916, weighted_loss: 0.6161, label: 2, bag_size: 285
batch 139, loss: 0.9772, instance_loss: 0.7330, weighted_loss: 0.9039, label: 0, bag_size: 1085
batch 159, loss: 2.1645, instance_loss: 0.6307, weighted_loss: 1.7044, label: 2, bag_size: 717
batch 179, loss: 0.0107, instance_loss: 0.1186, weighted_loss: 0.0431, label: 0, bag_size: 142
batch 199, loss: 0.0290, instance_loss: 0.1707, weighted_loss: 0.0715, label: 0, bag_size: 453
batch 219, loss: 2.0113, instance_loss: 0.5263, weighted_loss: 1.5658, label: 3, bag_size: 488
batch 239, loss: 3.3839, instance_loss: 0.5295, weighted_loss: 2.5276, label: 3, bag_size: 301
batch 259, loss: 0.0652, instance_loss: 0.5543, weighted_loss: 0.2119, label: 1, bag_size: 1497
batch 279, loss: 1.2109, instance_loss: 0.4627, weighted_loss: 0.9864, label: 3, bag_size: 154
batch 299, loss: 0.4565, instance_loss: 0.6497, weighted_loss: 0.5145, label: 1, bag_size: 44
batch 319, loss: 1.3405, instance_loss: 0.4538, weighted_loss: 1.0745, label: 1, bag_size: 617
batch 339, loss: 0.2310, instance_loss: 0.4347, weighted_loss: 0.2921, label: 1, bag_size: 509
batch 359, loss: 0.1072, instance_loss: 0.3362, weighted_loss: 0.1759, label: 0, bag_size: 297
batch 379, loss: 1.7832, instance_loss: 0.5297, weighted_loss: 1.4072, label: 1, bag_size: 742
batch 399, loss: 1.2966, instance_loss: 0.4940, weighted_loss: 1.0558, label: 3, bag_size: 608
batch 419, loss: 1.0716, instance_loss: 0.4703, weighted_loss: 0.8912, label: 3, bag_size: 423
batch 439, loss: 2.3222, instance_loss: 0.5941, weighted_loss: 1.8038, label: 1, bag_size: 616
batch 459, loss: 0.0429, instance_loss: 0.2304, weighted_loss: 0.0992, label: 0, bag_size: 69
batch 479, loss: 0.4978, instance_loss: 0.4207, weighted_loss: 0.4746, label: 4, bag_size: 687
batch 499, loss: 2.1222, instance_loss: 0.6756, weighted_loss: 1.6882, label: 0, bag_size: 115
batch 519, loss: 2.1874, instance_loss: 0.5900, weighted_loss: 1.7082, label: 4, bag_size: 590
batch 539, loss: 0.5663, instance_loss: 0.4607, weighted_loss: 0.5346, label: 1, bag_size: 766
batch 559, loss: 1.2663, instance_loss: 0.5103, weighted_loss: 1.0395, label: 3, bag_size: 796
batch 579, loss: 0.0048, instance_loss: 0.0728, weighted_loss: 0.0252, label: 0, bag_size: 268


class 0 clustering acc 0.995496632996633: correct 23653/23760
class 1 clustering acc 0.08712121212121213: correct 414/4752
Epoch: 66, train_loss: 0.9615, train_clustering_loss:  0.4656, train_error: 0.4057
class 0: acc 0.7910447761194029, correct 106/134
class 1: acc 0.48214285714285715, correct 54/112
class 2: acc 0.42857142857142855, correct 45/105
class 3: acc 0.6147540983606558, correct 75/122
class 4: acc 0.6033057851239669, correct 73/121

Val Set, val_loss: 1.1461, val_error: 0.5135, auc: 0.8456
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.12162162162162163: correct 72/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5220, instance_loss: 0.4266, weighted_loss: 0.4934, label: 1, bag_size: 460
batch 39, loss: 1.2857, instance_loss: 0.5506, weighted_loss: 1.0652, label: 2, bag_size: 288
batch 59, loss: 0.4320, instance_loss: 0.4363, weighted_loss: 0.4333, label: 2, bag_size: 684
batch 79, loss: 2.2790, instance_loss: 0.5294, weighted_loss: 1.7541, label: 3, bag_size: 432
batch 99, loss: 0.4317, instance_loss: 0.4714, weighted_loss: 0.4436, label: 3, bag_size: 872
batch 119, loss: 0.9627, instance_loss: 0.4528, weighted_loss: 0.8097, label: 2, bag_size: 421
batch 139, loss: 0.8405, instance_loss: 0.4709, weighted_loss: 0.7296, label: 4, bag_size: 310
batch 159, loss: 1.2474, instance_loss: 0.4576, weighted_loss: 1.0105, label: 1, bag_size: 960
batch 179, loss: 0.0457, instance_loss: 0.2679, weighted_loss: 0.1124, label: 0, bag_size: 69
batch 199, loss: 0.7123, instance_loss: 0.4485, weighted_loss: 0.6332, label: 3, bag_size: 309
batch 219, loss: 1.0203, instance_loss: 0.4255, weighted_loss: 0.8418, label: 1, bag_size: 389
batch 239, loss: 0.0345, instance_loss: 0.1350, weighted_loss: 0.0646, label: 0, bag_size: 523
batch 259, loss: 0.6744, instance_loss: 0.4796, weighted_loss: 0.6160, label: 3, bag_size: 598
batch 279, loss: 0.6281, instance_loss: 0.6378, weighted_loss: 0.6310, label: 0, bag_size: 305
batch 299, loss: 0.6607, instance_loss: 0.4500, weighted_loss: 0.5975, label: 3, bag_size: 781
batch 319, loss: 0.0040, instance_loss: 0.0902, weighted_loss: 0.0299, label: 0, bag_size: 255
batch 339, loss: 1.0369, instance_loss: 0.6036, weighted_loss: 0.9069, label: 4, bag_size: 727
batch 359, loss: 0.5540, instance_loss: 0.4505, weighted_loss: 0.5229, label: 2, bag_size: 392
batch 379, loss: 0.2731, instance_loss: 0.3996, weighted_loss: 0.3111, label: 3, bag_size: 228
batch 399, loss: 1.3788, instance_loss: 0.5569, weighted_loss: 1.1322, label: 4, bag_size: 244
batch 419, loss: 1.0544, instance_loss: 0.6167, weighted_loss: 0.9231, label: 2, bag_size: 404
batch 439, loss: 0.6719, instance_loss: 0.5234, weighted_loss: 0.6273, label: 3, bag_size: 858
batch 459, loss: 1.7612, instance_loss: 0.6155, weighted_loss: 1.4175, label: 1, bag_size: 272
batch 479, loss: 0.2116, instance_loss: 0.2634, weighted_loss: 0.2272, label: 0, bag_size: 223
batch 499, loss: 2.9185, instance_loss: 0.5635, weighted_loss: 2.2120, label: 2, bag_size: 394
batch 519, loss: 1.7228, instance_loss: 0.5173, weighted_loss: 1.3612, label: 4, bag_size: 176
batch 539, loss: 0.6232, instance_loss: 0.4536, weighted_loss: 0.5723, label: 4, bag_size: 476
batch 559, loss: 2.4294, instance_loss: 0.6303, weighted_loss: 1.8897, label: 2, bag_size: 331
batch 579, loss: 4.3952, instance_loss: 0.7991, weighted_loss: 3.3164, label: 0, bag_size: 273


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.08564814814814815: correct 407/4752
Epoch: 67, train_loss: 0.9515, train_clustering_loss:  0.4620, train_error: 0.4040
class 0: acc 0.8434782608695652, correct 97/115
class 1: acc 0.48695652173913045, correct 56/115
class 2: acc 0.4482758620689655, correct 52/116
class 3: acc 0.6788321167883211, correct 93/137
class 4: acc 0.5045045045045045, correct 56/111

Val Set, val_loss: 1.3620, val_error: 0.5135, auc: 0.8122
class 0 clustering acc 0.9922297297297298: correct 2937/2960
class 1 clustering acc 0.13513513513513514: correct 80/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5752, instance_loss: 0.5151, weighted_loss: 0.5572, label: 3, bag_size: 1186
batch 39, loss: 0.0135, instance_loss: 0.1985, weighted_loss: 0.0690, label: 0, bag_size: 103
batch 59, loss: 0.3924, instance_loss: 0.5121, weighted_loss: 0.4283, label: 3, bag_size: 737
batch 79, loss: 0.0089, instance_loss: 0.1184, weighted_loss: 0.0417, label: 0, bag_size: 192
batch 99, loss: 0.8001, instance_loss: 0.4867, weighted_loss: 0.7061, label: 4, bag_size: 714
batch 119, loss: 1.0522, instance_loss: 0.4865, weighted_loss: 0.8825, label: 1, bag_size: 829
batch 139, loss: 2.8211, instance_loss: 0.5843, weighted_loss: 2.1501, label: 1, bag_size: 875
batch 159, loss: 0.0308, instance_loss: 0.1718, weighted_loss: 0.0731, label: 0, bag_size: 74
batch 179, loss: 0.2019, instance_loss: 0.2611, weighted_loss: 0.2197, label: 0, bag_size: 517
batch 199, loss: 0.5475, instance_loss: 0.5122, weighted_loss: 0.5369, label: 4, bag_size: 547
batch 219, loss: 1.8653, instance_loss: 0.5073, weighted_loss: 1.4579, label: 1, bag_size: 419
batch 239, loss: 0.2303, instance_loss: 0.4199, weighted_loss: 0.2872, label: 1, bag_size: 391
batch 259, loss: 0.0100, instance_loss: 0.1969, weighted_loss: 0.0661, label: 0, bag_size: 268
batch 279, loss: 3.3515, instance_loss: 0.5085, weighted_loss: 2.4986, label: 2, bag_size: 1319
batch 299, loss: 0.4070, instance_loss: 0.5897, weighted_loss: 0.4618, label: 2, bag_size: 754
batch 319, loss: 1.2383, instance_loss: 0.5993, weighted_loss: 1.0466, label: 4, bag_size: 824
batch 339, loss: 1.0073, instance_loss: 0.5984, weighted_loss: 0.8846, label: 4, bag_size: 689
batch 359, loss: 2.2722, instance_loss: 0.5373, weighted_loss: 1.7517, label: 2, bag_size: 331
batch 379, loss: 0.8194, instance_loss: 0.4444, weighted_loss: 0.7069, label: 3, bag_size: 1078
batch 399, loss: 1.7414, instance_loss: 0.5851, weighted_loss: 1.3945, label: 1, bag_size: 988
batch 419, loss: 0.4203, instance_loss: 0.4383, weighted_loss: 0.4257, label: 1, bag_size: 391
batch 439, loss: 3.6685, instance_loss: 0.5747, weighted_loss: 2.7404, label: 2, bag_size: 1319
batch 459, loss: 0.6893, instance_loss: 0.4779, weighted_loss: 0.6258, label: 1, bag_size: 1121
batch 479, loss: 0.2958, instance_loss: 0.7999, weighted_loss: 0.4471, label: 2, bag_size: 1975
batch 499, loss: 0.8349, instance_loss: 0.4649, weighted_loss: 0.7239, label: 2, bag_size: 1003
batch 519, loss: 0.5472, instance_loss: 0.4750, weighted_loss: 0.5255, label: 2, bag_size: 135
batch 539, loss: 1.2910, instance_loss: 0.5174, weighted_loss: 1.0589, label: 2, bag_size: 582
batch 559, loss: 1.8341, instance_loss: 0.5127, weighted_loss: 1.4377, label: 1, bag_size: 618
batch 579, loss: 0.7625, instance_loss: 0.4332, weighted_loss: 0.6637, label: 2, bag_size: 337


class 0 clustering acc 0.9946127946127946: correct 23632/23760
class 1 clustering acc 0.06797138047138047: correct 323/4752
Epoch: 68, train_loss: 1.0438, train_clustering_loss:  0.4749, train_error: 0.4293
class 0: acc 0.7889908256880734, correct 86/109
class 1: acc 0.47058823529411764, correct 56/119
class 2: acc 0.46564885496183206, correct 61/131
class 3: acc 0.55, correct 66/120
class 4: acc 0.6086956521739131, correct 70/115

Val Set, val_loss: 1.3508, val_error: 0.4459, auc: 0.8245
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8100, instance_loss: 0.4809, weighted_loss: 0.7113, label: 4, bag_size: 574
batch 39, loss: 0.6658, instance_loss: 0.4382, weighted_loss: 0.5975, label: 2, bag_size: 392
batch 59, loss: 0.2813, instance_loss: 0.4179, weighted_loss: 0.3223, label: 3, bag_size: 737
batch 79, loss: 0.0623, instance_loss: 0.3856, weighted_loss: 0.1593, label: 1, bag_size: 886
batch 99, loss: 0.8910, instance_loss: 0.4639, weighted_loss: 0.7628, label: 3, bag_size: 739
batch 119, loss: 1.9601, instance_loss: 0.8208, weighted_loss: 1.6183, label: 1, bag_size: 153
batch 139, loss: 0.5406, instance_loss: 0.4821, weighted_loss: 0.5230, label: 0, bag_size: 524
batch 159, loss: 1.1637, instance_loss: 0.5210, weighted_loss: 0.9709, label: 1, bag_size: 372
batch 179, loss: 0.9046, instance_loss: 0.4673, weighted_loss: 0.7734, label: 1, bag_size: 390
batch 199, loss: 0.5539, instance_loss: 0.3593, weighted_loss: 0.4955, label: 0, bag_size: 566
batch 219, loss: 0.0018, instance_loss: 0.1371, weighted_loss: 0.0424, label: 0, bag_size: 133
batch 239, loss: 0.0700, instance_loss: 0.2204, weighted_loss: 0.1151, label: 0, bag_size: 122
batch 259, loss: 0.0810, instance_loss: 0.4444, weighted_loss: 0.1900, label: 3, bag_size: 228
batch 279, loss: 0.6972, instance_loss: 0.5436, weighted_loss: 0.6511, label: 2, bag_size: 404
batch 299, loss: 0.7583, instance_loss: 0.4236, weighted_loss: 0.6579, label: 3, bag_size: 309
batch 319, loss: 0.7692, instance_loss: 0.5810, weighted_loss: 0.7128, label: 0, bag_size: 317
batch 339, loss: 0.0298, instance_loss: 0.2436, weighted_loss: 0.0939, label: 4, bag_size: 746
batch 359, loss: 0.3496, instance_loss: 0.3409, weighted_loss: 0.3470, label: 4, bag_size: 293
batch 379, loss: 1.1641, instance_loss: 0.4647, weighted_loss: 0.9542, label: 2, bag_size: 851
batch 399, loss: 0.0144, instance_loss: 0.3820, weighted_loss: 0.1247, label: 0, bag_size: 103
batch 419, loss: 2.0806, instance_loss: 0.5932, weighted_loss: 1.6344, label: 0, bag_size: 888
batch 439, loss: 0.7682, instance_loss: 0.4612, weighted_loss: 0.6761, label: 3, bag_size: 457
batch 459, loss: 0.4595, instance_loss: 0.4097, weighted_loss: 0.4446, label: 4, bag_size: 395
batch 479, loss: 2.8283, instance_loss: 0.6794, weighted_loss: 2.1836, label: 1, bag_size: 397
batch 499, loss: 1.1892, instance_loss: 0.6608, weighted_loss: 1.0307, label: 2, bag_size: 363
batch 519, loss: 0.4146, instance_loss: 0.5093, weighted_loss: 0.4430, label: 1, bag_size: 766
batch 539, loss: 1.5338, instance_loss: 0.4351, weighted_loss: 1.2042, label: 3, bag_size: 154
batch 559, loss: 0.7226, instance_loss: 0.4323, weighted_loss: 0.6355, label: 3, bag_size: 431
batch 579, loss: 0.2519, instance_loss: 0.3932, weighted_loss: 0.2943, label: 4, bag_size: 683


class 0 clustering acc 0.9959175084175084: correct 23663/23760
class 1 clustering acc 0.0707070707070707: correct 336/4752
Epoch: 69, train_loss: 0.9455, train_clustering_loss:  0.4639, train_error: 0.3956
class 0: acc 0.8153846153846154, correct 106/130
class 1: acc 0.3854166666666667, correct 37/96
class 2: acc 0.4336283185840708, correct 49/113
class 3: acc 0.6268656716417911, correct 84/134
class 4: acc 0.6859504132231405, correct 83/121

Val Set, val_loss: 1.2274, val_error: 0.4595, auc: 0.8360
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.8790, instance_loss: 0.7832, weighted_loss: 1.5503, label: 2, bag_size: 554
batch 39, loss: 1.8936, instance_loss: 0.5175, weighted_loss: 1.4808, label: 3, bag_size: 453
batch 59, loss: 1.7676, instance_loss: 0.5155, weighted_loss: 1.3920, label: 2, bag_size: 584
batch 79, loss: 1.1494, instance_loss: 0.4460, weighted_loss: 0.9384, label: 3, bag_size: 822
batch 99, loss: 1.5010, instance_loss: 0.5578, weighted_loss: 1.2181, label: 1, bag_size: 534
batch 119, loss: 0.0563, instance_loss: 0.1655, weighted_loss: 0.0891, label: 0, bag_size: 493
batch 139, loss: 1.0922, instance_loss: 0.4342, weighted_loss: 0.8948, label: 1, bag_size: 823
batch 159, loss: 1.2797, instance_loss: 0.5248, weighted_loss: 1.0532, label: 2, bag_size: 852
batch 179, loss: 0.8517, instance_loss: 0.4384, weighted_loss: 0.7277, label: 0, bag_size: 613
batch 199, loss: 1.1592, instance_loss: 0.5969, weighted_loss: 0.9905, label: 0, bag_size: 305
batch 219, loss: 1.9415, instance_loss: 0.5547, weighted_loss: 1.5254, label: 1, bag_size: 372
batch 239, loss: 0.4594, instance_loss: 0.4405, weighted_loss: 0.4537, label: 2, bag_size: 177
batch 259, loss: 1.7052, instance_loss: 0.6392, weighted_loss: 1.3854, label: 2, bag_size: 640
batch 279, loss: 0.0444, instance_loss: 0.1608, weighted_loss: 0.0793, label: 0, bag_size: 97
batch 299, loss: 0.6590, instance_loss: 0.4840, weighted_loss: 0.6065, label: 1, bag_size: 865
batch 319, loss: 0.4276, instance_loss: 0.4692, weighted_loss: 0.4401, label: 1, bag_size: 544
batch 339, loss: 0.7672, instance_loss: 0.4420, weighted_loss: 0.6697, label: 3, bag_size: 858
batch 359, loss: 0.0081, instance_loss: 0.1871, weighted_loss: 0.0618, label: 0, bag_size: 74
batch 379, loss: 0.9613, instance_loss: 0.5141, weighted_loss: 0.8271, label: 3, bag_size: 781
batch 399, loss: 0.0190, instance_loss: 0.0953, weighted_loss: 0.0419, label: 0, bag_size: 192
batch 419, loss: 0.2258, instance_loss: 0.3224, weighted_loss: 0.2548, label: 0, bag_size: 33
batch 439, loss: 1.1023, instance_loss: 0.5149, weighted_loss: 0.9261, label: 4, bag_size: 176
batch 459, loss: 0.9831, instance_loss: 0.5411, weighted_loss: 0.8505, label: 2, bag_size: 290
batch 479, loss: 0.0000, instance_loss: 1.5734, weighted_loss: 0.4720, label: 0, bag_size: 1570
batch 499, loss: 0.0700, instance_loss: 0.4876, weighted_loss: 0.1953, label: 1, bag_size: 490
batch 519, loss: 0.2137, instance_loss: 0.3908, weighted_loss: 0.2669, label: 2, bag_size: 340
batch 539, loss: 0.6095, instance_loss: 0.4724, weighted_loss: 0.5683, label: 3, bag_size: 533
batch 559, loss: 4.6716, instance_loss: 0.8230, weighted_loss: 3.5170, label: 4, bag_size: 854
batch 579, loss: 2.7093, instance_loss: 0.6444, weighted_loss: 2.0898, label: 0, bag_size: 745


class 0 clustering acc 0.9942340067340067: correct 23623/23760
class 1 clustering acc 0.09595959595959595: correct 456/4752
Epoch: 70, train_loss: 0.9034, train_clustering_loss:  0.4571, train_error: 0.3788
class 0: acc 0.8695652173913043, correct 120/138
class 1: acc 0.504950495049505, correct 51/101
class 2: acc 0.4434782608695652, correct 51/115
class 3: acc 0.5213675213675214, correct 61/117
class 4: acc 0.6991869918699187, correct 86/123

Val Set, val_loss: 1.3765, val_error: 0.5270, auc: 0.8023
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.03209459459459459: correct 19/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.6978, instance_loss: 0.4622, weighted_loss: 0.6271, label: 4, bag_size: 775
batch 39, loss: 0.8763, instance_loss: 0.4597, weighted_loss: 0.7513, label: 2, bag_size: 941
batch 59, loss: 0.3984, instance_loss: 0.4003, weighted_loss: 0.3990, label: 3, bag_size: 245
batch 79, loss: 1.2221, instance_loss: 0.4696, weighted_loss: 0.9963, label: 2, bag_size: 837
batch 99, loss: 0.8560, instance_loss: 0.4519, weighted_loss: 0.7348, label: 1, bag_size: 500
batch 119, loss: 0.2821, instance_loss: 0.4931, weighted_loss: 0.3454, label: 1, bag_size: 1360
batch 139, loss: 1.1704, instance_loss: 0.4159, weighted_loss: 0.9441, label: 1, bag_size: 1104
batch 159, loss: 1.0114, instance_loss: 0.4520, weighted_loss: 0.8436, label: 2, bag_size: 799
batch 179, loss: 1.0440, instance_loss: 0.5284, weighted_loss: 0.8893, label: 4, bag_size: 498
batch 199, loss: 1.4836, instance_loss: 0.5390, weighted_loss: 1.2002, label: 2, bag_size: 208
batch 219, loss: 0.7307, instance_loss: 0.4385, weighted_loss: 0.6431, label: 1, bag_size: 702
batch 239, loss: 1.0339, instance_loss: 0.5642, weighted_loss: 0.8930, label: 2, bag_size: 105
batch 259, loss: 0.4982, instance_loss: 0.4031, weighted_loss: 0.4696, label: 2, bag_size: 613
batch 279, loss: 0.9064, instance_loss: 0.4740, weighted_loss: 0.7767, label: 0, bag_size: 566
batch 299, loss: 0.8509, instance_loss: 0.5121, weighted_loss: 0.7492, label: 2, bag_size: 290
batch 319, loss: 0.3924, instance_loss: 0.4237, weighted_loss: 0.4018, label: 3, bag_size: 789
batch 339, loss: 0.6163, instance_loss: 0.4163, weighted_loss: 0.5563, label: 4, bag_size: 755
batch 359, loss: 1.0286, instance_loss: 0.4922, weighted_loss: 0.8677, label: 2, bag_size: 697
batch 379, loss: 0.3966, instance_loss: 0.5461, weighted_loss: 0.4415, label: 0, bag_size: 416
batch 399, loss: 2.3746, instance_loss: 0.6224, weighted_loss: 1.8489, label: 3, bag_size: 520
batch 419, loss: 0.0090, instance_loss: 0.2161, weighted_loss: 0.0711, label: 0, bag_size: 88
batch 439, loss: 0.4882, instance_loss: 0.5193, weighted_loss: 0.4975, label: 3, bag_size: 496
batch 459, loss: 0.2465, instance_loss: 0.3996, weighted_loss: 0.2924, label: 1, bag_size: 672
batch 479, loss: 0.7883, instance_loss: 0.5799, weighted_loss: 0.7258, label: 2, bag_size: 25
batch 499, loss: 2.0300, instance_loss: 0.7518, weighted_loss: 1.6466, label: 4, bag_size: 854
batch 519, loss: 3.4511, instance_loss: 0.6765, weighted_loss: 2.6187, label: 0, bag_size: 178
batch 539, loss: 0.6761, instance_loss: 0.4158, weighted_loss: 0.5980, label: 4, bag_size: 1077
batch 559, loss: 1.0240, instance_loss: 0.5170, weighted_loss: 0.8719, label: 2, bag_size: 512
batch 579, loss: 0.8023, instance_loss: 0.4286, weighted_loss: 0.6902, label: 3, bag_size: 663


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.06691919191919192: correct 318/4752
Epoch: 71, train_loss: 0.9555, train_clustering_loss:  0.4608, train_error: 0.3822
class 0: acc 0.8407079646017699, correct 95/113
class 1: acc 0.5447761194029851, correct 73/134
class 2: acc 0.512, correct 64/125
class 3: acc 0.5701754385964912, correct 65/114
class 4: acc 0.6481481481481481, correct 70/108

Val Set, val_loss: 1.1564, val_error: 0.4730, auc: 0.8437
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.09121621621621621: correct 54/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6940, instance_loss: 0.4860, weighted_loss: 0.6316, label: 3, bag_size: 457
batch 39, loss: 1.7073, instance_loss: 0.5516, weighted_loss: 1.3606, label: 2, bag_size: 640
batch 59, loss: 1.2873, instance_loss: 0.4595, weighted_loss: 1.0390, label: 1, bag_size: 697
batch 79, loss: 0.4535, instance_loss: 0.4499, weighted_loss: 0.4524, label: 4, bag_size: 520
batch 99, loss: 0.3212, instance_loss: 0.3179, weighted_loss: 0.3202, label: 0, bag_size: 122
batch 119, loss: 1.0923, instance_loss: 0.5194, weighted_loss: 0.9204, label: 4, bag_size: 277
batch 139, loss: 0.8289, instance_loss: 0.4817, weighted_loss: 0.7247, label: 1, bag_size: 960
batch 159, loss: 1.4418, instance_loss: 0.5348, weighted_loss: 1.1697, label: 3, bag_size: 337
batch 179, loss: 0.7687, instance_loss: 0.4406, weighted_loss: 0.6702, label: 4, bag_size: 1064
batch 199, loss: 0.4672, instance_loss: 0.4117, weighted_loss: 0.4505, label: 4, bag_size: 627
batch 219, loss: 0.1772, instance_loss: 0.3515, weighted_loss: 0.2295, label: 4, bag_size: 409
batch 239, loss: 0.1447, instance_loss: 0.6478, weighted_loss: 0.2956, label: 3, bag_size: 674
batch 259, loss: 0.6906, instance_loss: 0.4377, weighted_loss: 0.6147, label: 4, bag_size: 742
batch 279, loss: 0.0859, instance_loss: 0.2630, weighted_loss: 0.1390, label: 0, bag_size: 142
batch 299, loss: 0.1401, instance_loss: 0.1729, weighted_loss: 0.1500, label: 0, bag_size: 453
batch 319, loss: 0.9303, instance_loss: 0.4944, weighted_loss: 0.7995, label: 1, bag_size: 829
batch 339, loss: 0.5798, instance_loss: 0.5527, weighted_loss: 0.5717, label: 1, bag_size: 766
batch 359, loss: 0.7096, instance_loss: 0.4930, weighted_loss: 0.6447, label: 1, bag_size: 460
batch 379, loss: 4.1637, instance_loss: 0.8223, weighted_loss: 3.1613, label: 0, bag_size: 608
batch 399, loss: 0.5207, instance_loss: 0.5394, weighted_loss: 0.5263, label: 3, bag_size: 489
batch 419, loss: 0.3523, instance_loss: 0.6028, weighted_loss: 0.4274, label: 1, bag_size: 460
batch 439, loss: 0.4604, instance_loss: 0.4357, weighted_loss: 0.4530, label: 4, bag_size: 960
batch 459, loss: 0.8958, instance_loss: 0.4726, weighted_loss: 0.7689, label: 4, bag_size: 639
batch 479, loss: 0.8694, instance_loss: 0.5092, weighted_loss: 0.7613, label: 0, bag_size: 238
batch 499, loss: 0.7896, instance_loss: 0.4011, weighted_loss: 0.6730, label: 1, bag_size: 389
batch 519, loss: 1.2947, instance_loss: 0.6491, weighted_loss: 1.1010, label: 3, bag_size: 543
batch 539, loss: 1.0094, instance_loss: 0.4820, weighted_loss: 0.8511, label: 1, bag_size: 396
batch 559, loss: 0.8189, instance_loss: 0.5285, weighted_loss: 0.7318, label: 4, bag_size: 198
batch 579, loss: 1.4869, instance_loss: 0.4689, weighted_loss: 1.1815, label: 2, bag_size: 706


class 0 clustering acc 0.9943181818181818: correct 23625/23760
class 1 clustering acc 0.0723905723905724: correct 344/4752
Epoch: 72, train_loss: 0.9981, train_clustering_loss:  0.4699, train_error: 0.4007
class 0: acc 0.7663551401869159, correct 82/107
class 1: acc 0.6190476190476191, correct 78/126
class 2: acc 0.31313131313131315, correct 31/99
class 3: acc 0.6029411764705882, correct 82/136
class 4: acc 0.6587301587301587, correct 83/126

Val Set, val_loss: 1.2888, val_error: 0.5270, auc: 0.8358
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.037162162162162164: correct 22/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.9568, instance_loss: 0.4106, weighted_loss: 0.7929, label: 4, bag_size: 740
batch 39, loss: 0.8267, instance_loss: 0.3752, weighted_loss: 0.6913, label: 0, bag_size: 404
batch 59, loss: 1.1642, instance_loss: 0.7224, weighted_loss: 1.0317, label: 3, bag_size: 897
batch 79, loss: 0.8797, instance_loss: 0.5512, weighted_loss: 0.7811, label: 3, bag_size: 872
batch 99, loss: 0.8608, instance_loss: 0.5107, weighted_loss: 0.7558, label: 4, bag_size: 176
batch 119, loss: 0.0059, instance_loss: 0.2066, weighted_loss: 0.0662, label: 0, bag_size: 258
batch 139, loss: 0.0095, instance_loss: 0.2450, weighted_loss: 0.0802, label: 4, bag_size: 1113
batch 159, loss: 0.8020, instance_loss: 0.4367, weighted_loss: 0.6924, label: 4, bag_size: 875
batch 179, loss: 0.5300, instance_loss: 0.5005, weighted_loss: 0.5211, label: 4, bag_size: 685
batch 199, loss: 0.7035, instance_loss: 0.4787, weighted_loss: 0.6360, label: 4, bag_size: 703
batch 219, loss: 0.5912, instance_loss: 0.4302, weighted_loss: 0.5429, label: 0, bag_size: 493
batch 239, loss: 1.8636, instance_loss: 0.5497, weighted_loss: 1.4695, label: 2, bag_size: 543
batch 259, loss: 0.5277, instance_loss: 0.4984, weighted_loss: 0.5189, label: 1, bag_size: 328
batch 279, loss: 1.2458, instance_loss: 0.4634, weighted_loss: 1.0111, label: 3, bag_size: 149
batch 299, loss: 0.3867, instance_loss: 0.3855, weighted_loss: 0.3864, label: 1, bag_size: 422
batch 319, loss: 0.4110, instance_loss: 0.4233, weighted_loss: 0.4147, label: 3, bag_size: 97
batch 339, loss: 0.6961, instance_loss: 0.3941, weighted_loss: 0.6055, label: 3, bag_size: 944
batch 359, loss: 1.8193, instance_loss: 0.5645, weighted_loss: 1.4429, label: 4, bag_size: 363
batch 379, loss: 2.1654, instance_loss: 0.5449, weighted_loss: 1.6793, label: 3, bag_size: 323
batch 399, loss: 1.4531, instance_loss: 0.4560, weighted_loss: 1.1540, label: 1, bag_size: 396
batch 419, loss: 0.5791, instance_loss: 0.4765, weighted_loss: 0.5483, label: 4, bag_size: 886
batch 439, loss: 0.2604, instance_loss: 0.5204, weighted_loss: 0.3384, label: 0, bag_size: 316
batch 459, loss: 0.2597, instance_loss: 0.3520, weighted_loss: 0.2874, label: 4, bag_size: 986
batch 479, loss: 0.8547, instance_loss: 0.5384, weighted_loss: 0.7598, label: 1, bag_size: 159
batch 499, loss: 0.4875, instance_loss: 0.3612, weighted_loss: 0.4496, label: 0, bag_size: 578
batch 519, loss: 0.7118, instance_loss: 0.6310, weighted_loss: 0.6876, label: 3, bag_size: 228
batch 539, loss: 0.0238, instance_loss: 0.2011, weighted_loss: 0.0770, label: 0, bag_size: 366
batch 559, loss: 0.8198, instance_loss: 0.4532, weighted_loss: 0.7098, label: 4, bag_size: 233
batch 579, loss: 1.3744, instance_loss: 0.5542, weighted_loss: 1.1283, label: 3, bag_size: 431


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.06818181818181818: correct 324/4752
Epoch: 73, train_loss: 0.9249, train_clustering_loss:  0.4615, train_error: 0.3906
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.664, correct 83/125
class 2: acc 0.35714285714285715, correct 35/98
class 3: acc 0.49586776859504134, correct 60/121
class 4: acc 0.6511627906976745, correct 84/129

Val Set, val_loss: 1.5960, val_error: 0.5135, auc: 0.7901
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.4759, instance_loss: 0.5315, weighted_loss: 1.1926, label: 3, bag_size: 996
batch 39, loss: 0.6817, instance_loss: 0.4559, weighted_loss: 0.6140, label: 3, bag_size: 369
batch 59, loss: 0.3667, instance_loss: 0.4451, weighted_loss: 0.3902, label: 1, bag_size: 522
batch 79, loss: 0.7562, instance_loss: 0.4290, weighted_loss: 0.6580, label: 4, bag_size: 729
batch 99, loss: 1.1221, instance_loss: 0.4507, weighted_loss: 0.9207, label: 1, bag_size: 408
batch 119, loss: 0.5713, instance_loss: 0.4319, weighted_loss: 0.5295, label: 4, bag_size: 639
batch 139, loss: 2.4412, instance_loss: 0.5996, weighted_loss: 1.8887, label: 1, bag_size: 949
batch 159, loss: 0.7147, instance_loss: 0.4553, weighted_loss: 0.6369, label: 3, bag_size: 727
batch 179, loss: 1.7838, instance_loss: 0.4630, weighted_loss: 1.3876, label: 3, bag_size: 459
batch 199, loss: 0.2054, instance_loss: 0.3514, weighted_loss: 0.2492, label: 0, bag_size: 282
batch 219, loss: 0.9544, instance_loss: 0.4118, weighted_loss: 0.7916, label: 1, bag_size: 660
batch 239, loss: 0.2093, instance_loss: 0.4884, weighted_loss: 0.2930, label: 2, bag_size: 684
batch 259, loss: 0.8453, instance_loss: 0.4455, weighted_loss: 0.7253, label: 3, bag_size: 459
batch 279, loss: 1.3458, instance_loss: 0.5908, weighted_loss: 1.1193, label: 0, bag_size: 710
batch 299, loss: 1.7049, instance_loss: 0.5951, weighted_loss: 1.3719, label: 2, bag_size: 390
batch 319, loss: 1.7059, instance_loss: 0.4721, weighted_loss: 1.3358, label: 1, bag_size: 525
batch 339, loss: 0.2865, instance_loss: 0.3977, weighted_loss: 0.3199, label: 4, bag_size: 652
batch 359, loss: 0.5890, instance_loss: 0.4218, weighted_loss: 0.5389, label: 1, bag_size: 766
batch 379, loss: 0.0066, instance_loss: 0.2343, weighted_loss: 0.0749, label: 0, bag_size: 351
batch 399, loss: 0.1777, instance_loss: 0.5069, weighted_loss: 0.2765, label: 1, bag_size: 1497
batch 419, loss: 0.7841, instance_loss: 0.4175, weighted_loss: 0.6741, label: 3, bag_size: 423
batch 439, loss: 3.1428, instance_loss: 0.4790, weighted_loss: 2.3437, label: 3, bag_size: 533
batch 459, loss: 0.8909, instance_loss: 0.4759, weighted_loss: 0.7664, label: 3, bag_size: 97
batch 479, loss: 0.4457, instance_loss: 0.4313, weighted_loss: 0.4414, label: 3, bag_size: 451
batch 499, loss: 0.4455, instance_loss: 0.4258, weighted_loss: 0.4396, label: 3, bag_size: 272
batch 519, loss: 0.8866, instance_loss: 0.4292, weighted_loss: 0.7494, label: 1, bag_size: 419
batch 539, loss: 1.2032, instance_loss: 0.4272, weighted_loss: 0.9704, label: 3, bag_size: 488
batch 559, loss: 0.3723, instance_loss: 0.4348, weighted_loss: 0.3911, label: 2, bag_size: 176
batch 579, loss: 1.1361, instance_loss: 0.5048, weighted_loss: 0.9467, label: 3, bag_size: 1022


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.06586700336700337: correct 313/4752
Epoch: 74, train_loss: 0.9381, train_clustering_loss:  0.4587, train_error: 0.3822
class 0: acc 0.7766990291262136, correct 80/103
class 1: acc 0.5873015873015873, correct 74/126
class 2: acc 0.5357142857142857, correct 60/112
class 3: acc 0.5539568345323741, correct 77/139
class 4: acc 0.6666666666666666, correct 76/114

Val Set, val_loss: 1.2438, val_error: 0.4865, auc: 0.8426
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.1861, instance_loss: 0.4948, weighted_loss: 0.9787, label: 3, bag_size: 342
batch 39, loss: 0.0631, instance_loss: 0.2333, weighted_loss: 0.1142, label: 0, bag_size: 212
batch 59, loss: 1.1456, instance_loss: 0.4713, weighted_loss: 0.9433, label: 3, bag_size: 663
batch 79, loss: 1.5543, instance_loss: 0.5461, weighted_loss: 1.2519, label: 1, bag_size: 419
batch 99, loss: 1.2200, instance_loss: 0.4331, weighted_loss: 0.9839, label: 3, bag_size: 488
batch 119, loss: 0.9938, instance_loss: 0.5455, weighted_loss: 0.8593, label: 4, bag_size: 1041
batch 139, loss: 0.0100, instance_loss: 0.2797, weighted_loss: 0.0909, label: 0, bag_size: 88
batch 159, loss: 0.4867, instance_loss: 0.4487, weighted_loss: 0.4753, label: 1, bag_size: 766
batch 179, loss: 0.6101, instance_loss: 0.6379, weighted_loss: 0.6184, label: 4, bag_size: 854
batch 199, loss: 0.5182, instance_loss: 0.4955, weighted_loss: 0.5114, label: 4, bag_size: 520
batch 219, loss: 0.8631, instance_loss: 0.4782, weighted_loss: 0.7476, label: 2, bag_size: 522
batch 239, loss: 1.6395, instance_loss: 0.5794, weighted_loss: 1.3214, label: 4, bag_size: 1351
batch 259, loss: 3.8148, instance_loss: 0.6579, weighted_loss: 2.8677, label: 2, bag_size: 738
batch 279, loss: 0.2685, instance_loss: 0.3773, weighted_loss: 0.3012, label: 0, bag_size: 33
batch 299, loss: 1.3770, instance_loss: 0.5332, weighted_loss: 1.1238, label: 4, bag_size: 757
batch 319, loss: 2.8978, instance_loss: 0.6390, weighted_loss: 2.2201, label: 2, bag_size: 1071
batch 339, loss: 0.9394, instance_loss: 0.5953, weighted_loss: 0.8361, label: 2, bag_size: 288
batch 359, loss: 2.5478, instance_loss: 0.5856, weighted_loss: 1.9592, label: 1, bag_size: 875
batch 379, loss: 1.1342, instance_loss: 0.4345, weighted_loss: 0.9243, label: 2, bag_size: 592
batch 399, loss: 0.8008, instance_loss: 0.4721, weighted_loss: 0.7022, label: 3, bag_size: 312
batch 419, loss: 1.5553, instance_loss: 0.5823, weighted_loss: 1.2634, label: 3, bag_size: 638
batch 439, loss: 1.3500, instance_loss: 0.4599, weighted_loss: 1.0830, label: 3, bag_size: 149
batch 459, loss: 0.9933, instance_loss: 0.4800, weighted_loss: 0.8393, label: 3, bag_size: 497
batch 479, loss: 0.2755, instance_loss: 0.2444, weighted_loss: 0.2662, label: 0, bag_size: 552
batch 499, loss: 0.8938, instance_loss: 0.5265, weighted_loss: 0.7836, label: 0, bag_size: 888
batch 519, loss: 0.0912, instance_loss: 0.4310, weighted_loss: 0.1931, label: 1, bag_size: 231
batch 539, loss: 1.7423, instance_loss: 0.5384, weighted_loss: 1.3812, label: 3, bag_size: 344
batch 559, loss: 0.5756, instance_loss: 0.4294, weighted_loss: 0.5317, label: 3, bag_size: 369
batch 579, loss: 0.0103, instance_loss: 0.4038, weighted_loss: 0.1283, label: 1, bag_size: 371


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.07323232323232323: correct 348/4752
Epoch: 75, train_loss: 0.9001, train_clustering_loss:  0.4608, train_error: 0.3771
class 0: acc 0.8648648648648649, correct 96/111
class 1: acc 0.5772357723577236, correct 71/123
class 2: acc 0.4, correct 42/105
class 3: acc 0.616, correct 77/125
class 4: acc 0.6461538461538462, correct 84/130

Val Set, val_loss: 1.4478, val_error: 0.4865, auc: 0.8100
class 0 clustering acc 0.9912162162162163: correct 2934/2960
class 1 clustering acc 0.11148648648648649: correct 66/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.9534, instance_loss: 0.5368, weighted_loss: 1.5284, label: 4, bag_size: 318
batch 39, loss: 0.0000, instance_loss: 0.4719, weighted_loss: 0.1416, label: 2, bag_size: 553
batch 59, loss: 0.2347, instance_loss: 0.4196, weighted_loss: 0.2902, label: 2, bag_size: 549
batch 79, loss: 0.6385, instance_loss: 0.3976, weighted_loss: 0.5662, label: 0, bag_size: 230
batch 99, loss: 0.2297, instance_loss: 0.5176, weighted_loss: 0.3160, label: 1, bag_size: 695
batch 119, loss: 0.9089, instance_loss: 0.4729, weighted_loss: 0.7781, label: 4, bag_size: 1064
batch 139, loss: 3.0899, instance_loss: 0.5533, weighted_loss: 2.3289, label: 2, bag_size: 394
batch 159, loss: 0.6829, instance_loss: 0.4006, weighted_loss: 0.5982, label: 4, bag_size: 755
batch 179, loss: 0.6539, instance_loss: 0.6063, weighted_loss: 0.6397, label: 1, bag_size: 321
batch 199, loss: 1.1327, instance_loss: 0.5415, weighted_loss: 0.9554, label: 1, bag_size: 410
batch 219, loss: 1.2724, instance_loss: 0.5426, weighted_loss: 1.0534, label: 1, bag_size: 617
batch 239, loss: 0.4307, instance_loss: 0.4745, weighted_loss: 0.4438, label: 1, bag_size: 509
batch 259, loss: 1.0693, instance_loss: 0.4638, weighted_loss: 0.8876, label: 3, bag_size: 663
batch 279, loss: 0.6439, instance_loss: 0.4676, weighted_loss: 0.5910, label: 3, bag_size: 631
batch 299, loss: 0.6476, instance_loss: 0.4113, weighted_loss: 0.5767, label: 3, bag_size: 369
batch 319, loss: 1.8148, instance_loss: 0.5025, weighted_loss: 1.4211, label: 4, bag_size: 250
batch 339, loss: 2.5449, instance_loss: 0.6435, weighted_loss: 1.9744, label: 1, bag_size: 398
batch 359, loss: 0.7550, instance_loss: 0.4099, weighted_loss: 0.6515, label: 3, bag_size: 510
batch 379, loss: 1.4386, instance_loss: 0.5150, weighted_loss: 1.1615, label: 4, bag_size: 547
batch 399, loss: 0.7419, instance_loss: 0.5413, weighted_loss: 0.6817, label: 3, bag_size: 872
batch 419, loss: 1.1421, instance_loss: 0.6821, weighted_loss: 1.0041, label: 2, bag_size: 105
batch 439, loss: 2.1347, instance_loss: 0.5783, weighted_loss: 1.6678, label: 1, bag_size: 419
batch 459, loss: 0.1281, instance_loss: 0.5428, weighted_loss: 0.2525, label: 1, bag_size: 381
batch 479, loss: 0.5625, instance_loss: 0.4524, weighted_loss: 0.5295, label: 1, bag_size: 271
batch 499, loss: 0.6256, instance_loss: 0.4239, weighted_loss: 0.5651, label: 3, bag_size: 364
batch 519, loss: 0.7208, instance_loss: 0.4805, weighted_loss: 0.6487, label: 1, bag_size: 1360
batch 539, loss: 3.6214, instance_loss: 0.6434, weighted_loss: 2.7280, label: 4, bag_size: 1104
batch 559, loss: 1.8342, instance_loss: 0.4789, weighted_loss: 1.4276, label: 3, bag_size: 149
batch 579, loss: 0.7229, instance_loss: 0.4103, weighted_loss: 0.6292, label: 3, bag_size: 1131


class 0 clustering acc 0.9944023569023569: correct 23627/23760
class 1 clustering acc 0.09701178451178451: correct 461/4752
Epoch: 76, train_loss: 0.9490, train_clustering_loss:  0.4572, train_error: 0.3788
class 0: acc 0.8294573643410853, correct 107/129
class 1: acc 0.5486725663716814, correct 62/113
class 2: acc 0.49586776859504134, correct 60/121
class 3: acc 0.6229508196721312, correct 76/122
class 4: acc 0.5871559633027523, correct 64/109

Val Set, val_loss: 1.0476, val_error: 0.3919, auc: 0.8568
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.7908, instance_loss: 0.5316, weighted_loss: 0.7131, label: 3, bag_size: 899
batch 39, loss: 0.5322, instance_loss: 0.3695, weighted_loss: 0.4834, label: 0, bag_size: 269
batch 59, loss: 0.3834, instance_loss: 0.4242, weighted_loss: 0.3957, label: 0, bag_size: 416
batch 79, loss: 0.0635, instance_loss: 0.3791, weighted_loss: 0.1582, label: 4, bag_size: 266
batch 99, loss: 0.6047, instance_loss: 0.4379, weighted_loss: 0.5547, label: 3, bag_size: 818
batch 119, loss: 2.0413, instance_loss: 0.5579, weighted_loss: 1.5963, label: 1, bag_size: 599
batch 139, loss: 0.0849, instance_loss: 0.4715, weighted_loss: 0.2009, label: 1, bag_size: 311
batch 159, loss: 0.4605, instance_loss: 0.4318, weighted_loss: 0.4519, label: 1, bag_size: 766
batch 179, loss: 0.5420, instance_loss: 0.6824, weighted_loss: 0.5841, label: 2, bag_size: 754
batch 199, loss: 1.3724, instance_loss: 0.5185, weighted_loss: 1.1162, label: 1, bag_size: 422
batch 219, loss: 1.1228, instance_loss: 0.4721, weighted_loss: 0.9276, label: 3, bag_size: 423
batch 239, loss: 0.2139, instance_loss: 0.3660, weighted_loss: 0.2595, label: 4, bag_size: 948
batch 259, loss: 0.4051, instance_loss: 0.4781, weighted_loss: 0.4270, label: 2, bag_size: 350
batch 279, loss: 2.6655, instance_loss: 0.6062, weighted_loss: 2.0477, label: 0, bag_size: 1073
batch 299, loss: 0.2930, instance_loss: 0.4166, weighted_loss: 0.3301, label: 1, bag_size: 271
batch 319, loss: 1.6650, instance_loss: 0.5627, weighted_loss: 1.3343, label: 2, bag_size: 998
batch 339, loss: 0.0295, instance_loss: 0.4087, weighted_loss: 0.1433, label: 4, bag_size: 124
batch 359, loss: 1.0226, instance_loss: 0.4153, weighted_loss: 0.8404, label: 1, bag_size: 422
batch 379, loss: 1.3667, instance_loss: 0.4454, weighted_loss: 1.0903, label: 3, bag_size: 301
batch 399, loss: 0.9510, instance_loss: 0.4072, weighted_loss: 0.7879, label: 1, bag_size: 591
batch 419, loss: 0.0848, instance_loss: 0.2701, weighted_loss: 0.1404, label: 0, bag_size: 159
batch 439, loss: 0.6455, instance_loss: 0.5008, weighted_loss: 0.6021, label: 2, bag_size: 286
batch 459, loss: 2.4906, instance_loss: 0.6077, weighted_loss: 1.9257, label: 0, bag_size: 247
batch 479, loss: 1.4309, instance_loss: 0.4939, weighted_loss: 1.1498, label: 3, bag_size: 323
batch 499, loss: 2.6778, instance_loss: 0.6779, weighted_loss: 2.0778, label: 0, bag_size: 376
batch 519, loss: 1.2897, instance_loss: 0.4333, weighted_loss: 1.0328, label: 2, bag_size: 998
batch 539, loss: 0.8359, instance_loss: 0.4386, weighted_loss: 0.7167, label: 3, bag_size: 476
batch 559, loss: 3.6376, instance_loss: 0.5942, weighted_loss: 2.7246, label: 2, bag_size: 519
batch 579, loss: 1.7908, instance_loss: 0.4498, weighted_loss: 1.3885, label: 1, bag_size: 525


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.061237373737373736: correct 291/4752
Epoch: 77, train_loss: 0.9699, train_clustering_loss:  0.4674, train_error: 0.3939
class 0: acc 0.7835051546391752, correct 76/97
class 1: acc 0.5934959349593496, correct 73/123
class 2: acc 0.4838709677419355, correct 60/124
class 3: acc 0.6328125, correct 81/128
class 4: acc 0.5737704918032787, correct 70/122

Val Set, val_loss: 1.0508, val_error: 0.3919, auc: 0.8636
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.09797297297297297: correct 58/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1784, instance_loss: 0.4157, weighted_loss: 0.2496, label: 2, bag_size: 176
batch 39, loss: 0.1526, instance_loss: 0.5206, weighted_loss: 0.2630, label: 0, bag_size: 76
batch 59, loss: 0.1370, instance_loss: 0.5519, weighted_loss: 0.2615, label: 2, bag_size: 376
batch 79, loss: 0.0606, instance_loss: 0.4042, weighted_loss: 0.1637, label: 4, bag_size: 266
batch 99, loss: 0.5361, instance_loss: 0.3919, weighted_loss: 0.4928, label: 2, bag_size: 337
batch 119, loss: 0.3237, instance_loss: 0.3659, weighted_loss: 0.3363, label: 2, bag_size: 317
batch 139, loss: 1.2846, instance_loss: 0.4737, weighted_loss: 1.0413, label: 1, bag_size: 960
batch 159, loss: 0.7768, instance_loss: 0.3789, weighted_loss: 0.6574, label: 2, bag_size: 592
batch 179, loss: 0.3171, instance_loss: 0.3910, weighted_loss: 0.3392, label: 4, bag_size: 409
batch 199, loss: 0.9864, instance_loss: 0.4543, weighted_loss: 0.8268, label: 3, bag_size: 488
batch 219, loss: 0.1981, instance_loss: 0.6126, weighted_loss: 0.3225, label: 4, bag_size: 886
batch 239, loss: 2.3494, instance_loss: 0.5766, weighted_loss: 1.8176, label: 1, bag_size: 272
batch 259, loss: 0.5099, instance_loss: 0.2526, weighted_loss: 0.4327, label: 0, bag_size: 74
batch 279, loss: 1.4519, instance_loss: 0.4925, weighted_loss: 1.1641, label: 3, bag_size: 1057
batch 299, loss: 1.7732, instance_loss: 0.5541, weighted_loss: 1.4075, label: 1, bag_size: 272
batch 319, loss: 2.4625, instance_loss: 0.5690, weighted_loss: 1.8945, label: 2, bag_size: 799
batch 339, loss: 1.9958, instance_loss: 0.7294, weighted_loss: 1.6159, label: 1, bag_size: 184
batch 359, loss: 1.1914, instance_loss: 0.5857, weighted_loss: 1.0097, label: 3, bag_size: 638
batch 379, loss: 0.9818, instance_loss: 0.4482, weighted_loss: 0.8217, label: 3, bag_size: 474
batch 399, loss: 0.7117, instance_loss: 0.5441, weighted_loss: 0.6614, label: 3, bag_size: 1131
batch 419, loss: 1.1761, instance_loss: 0.4533, weighted_loss: 0.9593, label: 2, bag_size: 554
batch 439, loss: 0.2865, instance_loss: 0.4252, weighted_loss: 0.3281, label: 1, bag_size: 748
batch 459, loss: 0.0773, instance_loss: 0.2030, weighted_loss: 0.1150, label: 0, bag_size: 212
batch 479, loss: 0.4574, instance_loss: 0.4086, weighted_loss: 0.4427, label: 1, bag_size: 460
batch 499, loss: 0.9898, instance_loss: 0.4391, weighted_loss: 0.8246, label: 0, bag_size: 587
batch 519, loss: 0.0449, instance_loss: 0.1343, weighted_loss: 0.0717, label: 0, bag_size: 210
batch 539, loss: 0.2954, instance_loss: 0.4454, weighted_loss: 0.3404, label: 4, bag_size: 1041
batch 559, loss: 0.8517, instance_loss: 0.5259, weighted_loss: 0.7539, label: 4, bag_size: 377
batch 579, loss: 1.2204, instance_loss: 0.4136, weighted_loss: 0.9784, label: 0, bag_size: 238


class 0 clustering acc 0.9950757575757576: correct 23643/23760
class 1 clustering acc 0.09154040404040405: correct 435/4752
Epoch: 78, train_loss: 0.9268, train_clustering_loss:  0.4585, train_error: 0.3737
class 0: acc 0.8384615384615385, correct 109/130
class 1: acc 0.5703703703703704, correct 77/135
class 2: acc 0.5267857142857143, correct 59/112
class 3: acc 0.5462962962962963, correct 59/108
class 4: acc 0.6238532110091743, correct 68/109

Val Set, val_loss: 1.2188, val_error: 0.4730, auc: 0.8414
class 0 clustering acc 0.9881756756756757: correct 2925/2960
class 1 clustering acc 0.12162162162162163: correct 72/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0090, instance_loss: 0.1053, weighted_loss: 0.0379, label: 0, bag_size: 190
batch 39, loss: 0.7978, instance_loss: 0.5257, weighted_loss: 0.7162, label: 4, bag_size: 574
batch 59, loss: 0.9032, instance_loss: 0.4904, weighted_loss: 0.7794, label: 1, bag_size: 311
batch 79, loss: 0.0132, instance_loss: 0.2594, weighted_loss: 0.0871, label: 3, bag_size: 674
batch 99, loss: 1.4550, instance_loss: 0.5955, weighted_loss: 1.1972, label: 4, bag_size: 712
batch 119, loss: 1.2081, instance_loss: 0.4631, weighted_loss: 0.9846, label: 1, bag_size: 620
batch 139, loss: 5.0630, instance_loss: 0.8122, weighted_loss: 3.7878, label: 0, bag_size: 492
batch 159, loss: 0.2349, instance_loss: 0.3715, weighted_loss: 0.2759, label: 4, bag_size: 773
batch 179, loss: 1.3896, instance_loss: 0.5162, weighted_loss: 1.1276, label: 3, bag_size: 1021
batch 199, loss: 0.3035, instance_loss: 0.4104, weighted_loss: 0.3356, label: 1, bag_size: 972
batch 219, loss: 0.5601, instance_loss: 0.4958, weighted_loss: 0.5408, label: 3, bag_size: 818
batch 239, loss: 0.0129, instance_loss: 0.2411, weighted_loss: 0.0813, label: 0, bag_size: 138
batch 259, loss: 2.1800, instance_loss: 0.6706, weighted_loss: 1.7272, label: 0, bag_size: 115
batch 279, loss: 0.1143, instance_loss: 0.3626, weighted_loss: 0.1888, label: 0, bag_size: 455
batch 299, loss: 0.0096, instance_loss: 0.1583, weighted_loss: 0.0542, label: 0, bag_size: 350
batch 319, loss: 2.1026, instance_loss: 0.5544, weighted_loss: 1.6381, label: 2, bag_size: 607
batch 339, loss: 1.9571, instance_loss: 0.5225, weighted_loss: 1.5267, label: 3, bag_size: 149
batch 359, loss: 1.5374, instance_loss: 0.5637, weighted_loss: 1.2453, label: 4, bag_size: 198
batch 379, loss: 1.0542, instance_loss: 0.5338, weighted_loss: 0.8981, label: 2, bag_size: 713
batch 399, loss: 0.2559, instance_loss: 0.4527, weighted_loss: 0.3149, label: 4, bag_size: 204
batch 419, loss: 1.1935, instance_loss: 0.5031, weighted_loss: 0.9864, label: 1, bag_size: 389
batch 439, loss: 0.1471, instance_loss: 0.3585, weighted_loss: 0.2105, label: 0, bag_size: 58
batch 459, loss: 2.0817, instance_loss: 0.6184, weighted_loss: 1.6427, label: 0, bag_size: 311
batch 479, loss: 0.0117, instance_loss: 0.1315, weighted_loss: 0.0477, label: 0, bag_size: 285
batch 499, loss: 0.8187, instance_loss: 0.4644, weighted_loss: 0.7124, label: 1, bag_size: 1103
batch 519, loss: 0.4561, instance_loss: 0.4495, weighted_loss: 0.4542, label: 4, bag_size: 520
batch 539, loss: 0.0497, instance_loss: 0.1718, weighted_loss: 0.0863, label: 0, bag_size: 350
batch 559, loss: 0.8320, instance_loss: 0.5011, weighted_loss: 0.7327, label: 4, bag_size: 1297
batch 579, loss: 0.7780, instance_loss: 0.5018, weighted_loss: 0.6952, label: 3, bag_size: 739


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.07112794612794612: correct 338/4752
Epoch: 79, train_loss: 0.9151, train_clustering_loss:  0.4599, train_error: 0.3956
class 0: acc 0.8359375, correct 107/128
class 1: acc 0.5772357723577236, correct 71/123
class 2: acc 0.4326923076923077, correct 45/104
class 3: acc 0.4959349593495935, correct 61/123
class 4: acc 0.646551724137931, correct 75/116

Val Set, val_loss: 1.0295, val_error: 0.4324, auc: 0.8687
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.06925675675675676: correct 41/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.8818, instance_loss: 0.4760, weighted_loss: 0.7601, label: 2, bag_size: 746
batch 39, loss: 0.4817, instance_loss: 0.4625, weighted_loss: 0.4760, label: 3, bag_size: 737
batch 59, loss: 0.0068, instance_loss: 0.2474, weighted_loss: 0.0790, label: 0, bag_size: 366
batch 79, loss: 0.2040, instance_loss: 0.3326, weighted_loss: 0.2426, label: 4, bag_size: 886
batch 99, loss: 1.7698, instance_loss: 0.6108, weighted_loss: 1.4221, label: 1, bag_size: 697
batch 119, loss: 2.8317, instance_loss: 0.5258, weighted_loss: 2.1399, label: 2, bag_size: 519
batch 139, loss: 0.9978, instance_loss: 0.4831, weighted_loss: 0.8434, label: 2, bag_size: 554
batch 159, loss: 1.1980, instance_loss: 0.4587, weighted_loss: 0.9762, label: 2, bag_size: 584
batch 179, loss: 0.0253, instance_loss: 0.6770, weighted_loss: 0.2208, label: 0, bag_size: 1085
batch 199, loss: 0.3201, instance_loss: 0.2818, weighted_loss: 0.3087, label: 0, bag_size: 122
batch 219, loss: 1.0085, instance_loss: 0.5273, weighted_loss: 0.8641, label: 3, bag_size: 858
batch 239, loss: 0.0769, instance_loss: 0.3433, weighted_loss: 0.1568, label: 4, bag_size: 266
batch 259, loss: 1.0812, instance_loss: 0.4744, weighted_loss: 0.8991, label: 4, bag_size: 318
batch 279, loss: 0.1879, instance_loss: 0.3946, weighted_loss: 0.2499, label: 4, bag_size: 960
batch 299, loss: 0.2819, instance_loss: 0.3376, weighted_loss: 0.2986, label: 0, bag_size: 143
batch 319, loss: 1.3276, instance_loss: 0.7184, weighted_loss: 1.1448, label: 2, bag_size: 290
batch 339, loss: 0.4730, instance_loss: 0.4407, weighted_loss: 0.4633, label: 4, bag_size: 476
batch 359, loss: 0.0442, instance_loss: 0.2105, weighted_loss: 0.0941, label: 0, bag_size: 142
batch 379, loss: 0.3476, instance_loss: 0.3949, weighted_loss: 0.3618, label: 1, bag_size: 271
batch 399, loss: 2.6981, instance_loss: 0.5913, weighted_loss: 2.0660, label: 2, bag_size: 185
batch 419, loss: 0.3019, instance_loss: 0.4270, weighted_loss: 0.3394, label: 4, bag_size: 250
batch 439, loss: 0.9100, instance_loss: 0.4740, weighted_loss: 0.7792, label: 2, bag_size: 119
batch 459, loss: 0.3979, instance_loss: 0.6995, weighted_loss: 0.4883, label: 0, bag_size: 1085
batch 479, loss: 1.4481, instance_loss: 0.4613, weighted_loss: 1.1521, label: 2, bag_size: 659
batch 499, loss: 1.6340, instance_loss: 0.4875, weighted_loss: 1.2900, label: 1, bag_size: 408
batch 519, loss: 1.3424, instance_loss: 0.5241, weighted_loss: 1.0969, label: 2, bag_size: 837
batch 539, loss: 3.0164, instance_loss: 0.6094, weighted_loss: 2.2943, label: 2, bag_size: 185
batch 559, loss: 0.9645, instance_loss: 0.4030, weighted_loss: 0.7961, label: 4, bag_size: 263
batch 579, loss: 1.9198, instance_loss: 0.5392, weighted_loss: 1.5056, label: 2, bag_size: 361


class 0 clustering acc 0.9946969696969697: correct 23634/23760
class 1 clustering acc 0.09574915824915825: correct 455/4752
Epoch: 80, train_loss: 0.9342, train_clustering_loss:  0.4550, train_error: 0.3923
class 0: acc 0.8283582089552238, correct 111/134
class 1: acc 0.5765765765765766, correct 64/111
class 2: acc 0.4661016949152542, correct 55/118
class 3: acc 0.4077669902912621, correct 42/103
class 4: acc 0.6953125, correct 89/128

Val Set, val_loss: 1.2240, val_error: 0.4595, auc: 0.8523
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1891, instance_loss: 0.3394, weighted_loss: 0.2342, label: 4, bag_size: 948
batch 39, loss: 1.1175, instance_loss: 0.5417, weighted_loss: 0.9448, label: 3, bag_size: 364
batch 59, loss: 0.3731, instance_loss: 0.5205, weighted_loss: 0.4173, label: 4, bag_size: 446
batch 79, loss: 0.0008, instance_loss: 0.1363, weighted_loss: 0.0414, label: 0, bag_size: 428
batch 99, loss: 0.6009, instance_loss: 0.4750, weighted_loss: 0.5632, label: 1, bag_size: 1360
batch 119, loss: 1.4783, instance_loss: 0.5748, weighted_loss: 1.2073, label: 3, bag_size: 818
batch 139, loss: 1.4152, instance_loss: 0.5184, weighted_loss: 1.1462, label: 4, bag_size: 246
batch 159, loss: 0.0000, instance_loss: 0.4837, weighted_loss: 0.1451, label: 1, bag_size: 669
batch 179, loss: 0.0200, instance_loss: 0.1700, weighted_loss: 0.0650, label: 0, bag_size: 366
batch 199, loss: 0.6612, instance_loss: 0.6469, weighted_loss: 0.6570, label: 1, bag_size: 481
batch 219, loss: 0.6302, instance_loss: 0.4441, weighted_loss: 0.5744, label: 2, bag_size: 558
batch 239, loss: 0.0086, instance_loss: 0.1098, weighted_loss: 0.0389, label: 0, bag_size: 425
batch 259, loss: 0.0173, instance_loss: 0.2516, weighted_loss: 0.0876, label: 0, bag_size: 613
batch 279, loss: 2.6301, instance_loss: 0.6146, weighted_loss: 2.0254, label: 4, bag_size: 264
batch 299, loss: 0.6434, instance_loss: 0.4544, weighted_loss: 0.5867, label: 1, bag_size: 874
batch 319, loss: 0.1103, instance_loss: 0.2824, weighted_loss: 0.1619, label: 0, bag_size: 297
batch 339, loss: 4.2634, instance_loss: 0.6999, weighted_loss: 3.1943, label: 0, bag_size: 608
batch 359, loss: 0.1955, instance_loss: 0.4151, weighted_loss: 0.2614, label: 3, bag_size: 228
batch 379, loss: 1.1010, instance_loss: 0.4877, weighted_loss: 0.9170, label: 3, bag_size: 230
batch 399, loss: 1.6362, instance_loss: 0.7385, weighted_loss: 1.3669, label: 2, bag_size: 105
batch 419, loss: 0.0328, instance_loss: 0.3307, weighted_loss: 0.1222, label: 1, bag_size: 106
batch 439, loss: 0.9616, instance_loss: 0.4320, weighted_loss: 0.8027, label: 3, bag_size: 432
batch 459, loss: 0.7573, instance_loss: 0.4225, weighted_loss: 0.6568, label: 1, bag_size: 481
batch 479, loss: 1.1823, instance_loss: 0.4574, weighted_loss: 0.9648, label: 1, bag_size: 159
batch 499, loss: 0.0123, instance_loss: 0.2435, weighted_loss: 0.0817, label: 0, bag_size: 142
batch 519, loss: 2.1802, instance_loss: 0.6432, weighted_loss: 1.7191, label: 2, bag_size: 318
batch 539, loss: 2.3874, instance_loss: 0.6099, weighted_loss: 1.8542, label: 1, bag_size: 875
batch 559, loss: 1.2647, instance_loss: 0.5647, weighted_loss: 1.0547, label: 3, bag_size: 615
batch 579, loss: 0.0192, instance_loss: 0.1950, weighted_loss: 0.0719, label: 0, bag_size: 74


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.0906986531986532: correct 431/4752
Epoch: 81, train_loss: 0.8833, train_clustering_loss:  0.4541, train_error: 0.3636
class 0: acc 0.832, correct 104/125
class 1: acc 0.5833333333333334, correct 70/120
class 2: acc 0.42857142857142855, correct 42/98
class 3: acc 0.6124031007751938, correct 79/129
class 4: acc 0.680327868852459, correct 83/122

Val Set, val_loss: 1.0743, val_error: 0.5000, auc: 0.8424
class 0 clustering acc 0.9871621621621621: correct 2922/2960
class 1 clustering acc 0.13175675675675674: correct 78/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0387, instance_loss: 0.1236, weighted_loss: 0.0642, label: 0, bag_size: 351
batch 39, loss: 1.0194, instance_loss: 0.6009, weighted_loss: 0.8939, label: 0, bag_size: 587
batch 59, loss: 1.1861, instance_loss: 0.4715, weighted_loss: 0.9717, label: 1, bag_size: 617
batch 79, loss: 0.0047, instance_loss: 0.2034, weighted_loss: 0.0643, label: 0, bag_size: 138
batch 99, loss: 0.6110, instance_loss: 0.5192, weighted_loss: 0.5835, label: 1, bag_size: 605
batch 119, loss: 1.4777, instance_loss: 0.5992, weighted_loss: 1.2141, label: 1, bag_size: 1013
batch 139, loss: 0.1194, instance_loss: 0.3282, weighted_loss: 0.1820, label: 0, bag_size: 188
batch 159, loss: 0.3308, instance_loss: 0.3812, weighted_loss: 0.3459, label: 1, bag_size: 1104
batch 179, loss: 0.4603, instance_loss: 0.3939, weighted_loss: 0.4404, label: 1, bag_size: 500
batch 199, loss: 2.8837, instance_loss: 0.8239, weighted_loss: 2.2658, label: 0, bag_size: 370
batch 219, loss: 0.3793, instance_loss: 0.3390, weighted_loss: 0.3672, label: 4, bag_size: 948
batch 239, loss: 0.4474, instance_loss: 0.4717, weighted_loss: 0.4547, label: 4, bag_size: 503
batch 259, loss: 0.3283, instance_loss: 0.4602, weighted_loss: 0.3679, label: 4, bag_size: 730
batch 279, loss: 0.7261, instance_loss: 0.4897, weighted_loss: 0.6552, label: 2, bag_size: 1013
batch 299, loss: 2.0343, instance_loss: 0.5290, weighted_loss: 1.5827, label: 3, bag_size: 856
batch 319, loss: 0.9230, instance_loss: 0.4670, weighted_loss: 0.7862, label: 4, bag_size: 868
batch 339, loss: 0.7246, instance_loss: 0.8345, weighted_loss: 0.7576, label: 4, bag_size: 530
batch 359, loss: 0.5826, instance_loss: 0.4554, weighted_loss: 0.5445, label: 3, bag_size: 451
batch 379, loss: 1.7088, instance_loss: 0.4643, weighted_loss: 1.3354, label: 3, bag_size: 615
batch 399, loss: 1.6382, instance_loss: 0.5405, weighted_loss: 1.3089, label: 2, bag_size: 553
batch 419, loss: 0.7115, instance_loss: 0.4047, weighted_loss: 0.6194, label: 3, bag_size: 459
batch 439, loss: 0.3631, instance_loss: 0.3821, weighted_loss: 0.3688, label: 4, bag_size: 948
batch 459, loss: 1.2283, instance_loss: 0.5386, weighted_loss: 1.0214, label: 2, bag_size: 783
batch 479, loss: 1.0982, instance_loss: 0.4115, weighted_loss: 0.8922, label: 3, bag_size: 663
batch 499, loss: 2.9375, instance_loss: 0.6436, weighted_loss: 2.2494, label: 2, bag_size: 1122
batch 519, loss: 1.7238, instance_loss: 0.7719, weighted_loss: 1.4382, label: 1, bag_size: 413
batch 539, loss: 0.0871, instance_loss: 0.2395, weighted_loss: 0.1329, label: 0, bag_size: 221
batch 559, loss: 0.9144, instance_loss: 0.5059, weighted_loss: 0.7919, label: 1, bag_size: 398
batch 579, loss: 1.1716, instance_loss: 0.5151, weighted_loss: 0.9746, label: 1, bag_size: 1043


class 0 clustering acc 0.9936026936026936: correct 23608/23760
class 1 clustering acc 0.09154040404040405: correct 435/4752
Epoch: 82, train_loss: 0.9042, train_clustering_loss:  0.4635, train_error: 0.3872
class 0: acc 0.8524590163934426, correct 104/122
class 1: acc 0.5446428571428571, correct 61/112
class 2: acc 0.48717948717948717, correct 57/117
class 3: acc 0.5289256198347108, correct 64/121
class 4: acc 0.639344262295082, correct 78/122

Val Set, val_loss: 1.3356, val_error: 0.4730, auc: 0.8261
class 0 clustering acc 0.9915540540540541: correct 2935/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.7492, instance_loss: 0.6679, weighted_loss: 1.4248, label: 1, bag_size: 355
batch 39, loss: 0.4050, instance_loss: 0.3684, weighted_loss: 0.3940, label: 0, bag_size: 613
batch 59, loss: 0.0397, instance_loss: 0.1956, weighted_loss: 0.0865, label: 0, bag_size: 573
batch 79, loss: 0.7274, instance_loss: 0.3874, weighted_loss: 0.6254, label: 0, bag_size: 416
batch 99, loss: 2.7774, instance_loss: 0.7048, weighted_loss: 2.1556, label: 0, bag_size: 370
batch 119, loss: 0.0054, instance_loss: 0.3129, weighted_loss: 0.0976, label: 2, bag_size: 614
batch 139, loss: 0.0455, instance_loss: 0.4664, weighted_loss: 0.1718, label: 2, bag_size: 702
batch 159, loss: 0.4133, instance_loss: 0.4451, weighted_loss: 0.4229, label: 1, bag_size: 410
batch 179, loss: 1.8731, instance_loss: 0.5852, weighted_loss: 1.4867, label: 4, bag_size: 1104
batch 199, loss: 0.3015, instance_loss: 0.3652, weighted_loss: 0.3206, label: 3, bag_size: 684
batch 219, loss: 0.0000, instance_loss: 1.1168, weighted_loss: 0.3350, label: 0, bag_size: 1570
batch 239, loss: 0.6259, instance_loss: 0.3979, weighted_loss: 0.5575, label: 3, bag_size: 309
batch 259, loss: 1.9331, instance_loss: 0.6919, weighted_loss: 1.5608, label: 4, bag_size: 1031
batch 279, loss: 0.6217, instance_loss: 0.5271, weighted_loss: 0.5933, label: 4, bag_size: 264
batch 299, loss: 1.3359, instance_loss: 0.4928, weighted_loss: 1.0830, label: 1, bag_size: 593
batch 319, loss: 0.7500, instance_loss: 0.4835, weighted_loss: 0.6700, label: 3, bag_size: 486
batch 339, loss: 0.5792, instance_loss: 0.5111, weighted_loss: 0.5588, label: 4, bag_size: 129
batch 359, loss: 0.9533, instance_loss: 0.5047, weighted_loss: 0.8187, label: 2, bag_size: 861
batch 379, loss: 0.4603, instance_loss: 0.4472, weighted_loss: 0.4564, label: 2, bag_size: 171
batch 399, loss: 0.7273, instance_loss: 0.4353, weighted_loss: 0.6397, label: 3, bag_size: 982
batch 419, loss: 1.2512, instance_loss: 0.4651, weighted_loss: 1.0154, label: 3, bag_size: 423
batch 439, loss: 0.0026, instance_loss: 0.1286, weighted_loss: 0.0404, label: 0, bag_size: 133
batch 459, loss: 1.2825, instance_loss: 0.5224, weighted_loss: 1.0545, label: 1, bag_size: 381
batch 479, loss: 1.5480, instance_loss: 0.5088, weighted_loss: 1.2363, label: 2, bag_size: 321
batch 499, loss: 1.2471, instance_loss: 0.4581, weighted_loss: 1.0104, label: 1, bag_size: 1013
batch 519, loss: 1.0032, instance_loss: 0.4787, weighted_loss: 0.8459, label: 4, bag_size: 1041
batch 539, loss: 0.8961, instance_loss: 0.4734, weighted_loss: 0.7693, label: 2, bag_size: 286
batch 559, loss: 0.6231, instance_loss: 0.3635, weighted_loss: 0.5452, label: 0, bag_size: 319
batch 579, loss: 0.0088, instance_loss: 0.1621, weighted_loss: 0.0548, label: 0, bag_size: 255


class 0 clustering acc 0.9952020202020202: correct 23646/23760
class 1 clustering acc 0.06986531986531987: correct 332/4752
Epoch: 83, train_loss: 0.9817, train_clustering_loss:  0.4677, train_error: 0.4293
class 0: acc 0.7777777777777778, correct 98/126
class 1: acc 0.448, correct 56/125
class 2: acc 0.4672131147540984, correct 57/122
class 3: acc 0.5431034482758621, correct 63/116
class 4: acc 0.6190476190476191, correct 65/105

Val Set, val_loss: 1.4144, val_error: 0.4595, auc: 0.8311
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.037162162162162164: correct 22/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.4595, ROC AUC: 0.8624
Test error: 0.5946, ROC AUC: 0.7205
class 0: acc 0.75, correct 12/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0987, instance_loss: 0.6466, weighted_loss: 1.6631, label: 1, bag_size: 829
batch 39, loss: 2.5416, instance_loss: 0.5599, weighted_loss: 1.9471, label: 2, bag_size: 582
batch 59, loss: 1.6645, instance_loss: 0.5456, weighted_loss: 1.3288, label: 3, bag_size: 301
batch 79, loss: 1.0859, instance_loss: 0.5536, weighted_loss: 0.9262, label: 1, bag_size: 669
batch 99, loss: 2.5680, instance_loss: 0.5295, weighted_loss: 1.9565, label: 2, bag_size: 363
batch 119, loss: 0.4631, instance_loss: 0.4407, weighted_loss: 0.4564, label: 3, bag_size: 344
batch 139, loss: 1.1398, instance_loss: 0.5223, weighted_loss: 0.9545, label: 2, bag_size: 1975
batch 159, loss: 1.8859, instance_loss: 0.5402, weighted_loss: 1.4822, label: 2, bag_size: 369
batch 179, loss: 1.1920, instance_loss: 0.5552, weighted_loss: 1.0010, label: 3, bag_size: 473
batch 199, loss: 2.3882, instance_loss: 0.5401, weighted_loss: 1.8338, label: 2, bag_size: 448
batch 219, loss: 0.8992, instance_loss: 0.4997, weighted_loss: 0.7794, label: 0, bag_size: 581
batch 239, loss: 1.5484, instance_loss: 0.5266, weighted_loss: 1.2419, label: 4, bag_size: 490
batch 259, loss: 2.3980, instance_loss: 0.6207, weighted_loss: 1.8648, label: 0, bag_size: 581
batch 279, loss: 1.4675, instance_loss: 0.4892, weighted_loss: 1.1740, label: 4, bag_size: 703
batch 299, loss: 4.9214, instance_loss: 0.6377, weighted_loss: 3.6363, label: 0, bag_size: 732
batch 319, loss: 1.4635, instance_loss: 0.5594, weighted_loss: 1.1923, label: 3, bag_size: 587
batch 339, loss: 1.6724, instance_loss: 0.4242, weighted_loss: 1.2979, label: 1, bag_size: 855
batch 359, loss: 1.5048, instance_loss: 0.5067, weighted_loss: 1.2054, label: 4, bag_size: 72
batch 379, loss: 1.5674, instance_loss: 0.5483, weighted_loss: 1.2617, label: 2, bag_size: 407
batch 399, loss: 0.2424, instance_loss: 0.4247, weighted_loss: 0.2971, label: 0, bag_size: 280
batch 419, loss: 2.0982, instance_loss: 0.5791, weighted_loss: 1.6425, label: 1, bag_size: 697
batch 439, loss: 0.7388, instance_loss: 0.4467, weighted_loss: 0.6511, label: 0, bag_size: 615
batch 459, loss: 1.1430, instance_loss: 0.4642, weighted_loss: 0.9394, label: 1, bag_size: 960
batch 479, loss: 2.1465, instance_loss: 0.4385, weighted_loss: 1.6341, label: 0, bag_size: 62
batch 499, loss: 1.9064, instance_loss: 0.5239, weighted_loss: 1.4917, label: 3, bag_size: 746
batch 519, loss: 1.0321, instance_loss: 0.4241, weighted_loss: 0.8497, label: 1, bag_size: 1497
batch 539, loss: 1.0696, instance_loss: 0.5236, weighted_loss: 0.9058, label: 3, bag_size: 631
batch 559, loss: 1.6708, instance_loss: 0.5442, weighted_loss: 1.3328, label: 4, bag_size: 690
batch 579, loss: 1.2795, instance_loss: 0.5345, weighted_loss: 1.0560, label: 2, bag_size: 315


class 0 clustering acc 0.9984006734006734: correct 23722/23760
class 1 clustering acc 0.0023148148148148147: correct 11/4752
Epoch: 0, train_loss: 1.5270, train_clustering_loss:  0.5232, train_error: 0.6902
class 0: acc 0.6052631578947368, correct 69/114
class 1: acc 0.36923076923076925, correct 48/130
class 2: acc 0.11965811965811966, correct 14/117
class 3: acc 0.24786324786324787, correct 29/117
class 4: acc 0.20689655172413793, correct 24/116

Val Set, val_loss: 1.4956, val_error: 0.6486, auc: 0.6548
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.495604).  Saving model ...


batch 19, loss: 1.9448, instance_loss: 0.5371, weighted_loss: 1.5225, label: 3, bag_size: 97
batch 39, loss: 1.9373, instance_loss: 0.5409, weighted_loss: 1.5184, label: 0, bag_size: 178
batch 59, loss: 0.6069, instance_loss: 0.4466, weighted_loss: 0.5588, label: 0, bag_size: 428
batch 79, loss: 1.3838, instance_loss: 0.4890, weighted_loss: 1.1153, label: 2, bag_size: 746
batch 99, loss: 1.0750, instance_loss: 0.4801, weighted_loss: 0.8965, label: 2, bag_size: 530
batch 119, loss: 1.1145, instance_loss: 0.4374, weighted_loss: 0.9114, label: 1, bag_size: 398
batch 139, loss: 0.9668, instance_loss: 0.4693, weighted_loss: 0.8176, label: 1, bag_size: 381
batch 159, loss: 1.8668, instance_loss: 0.6053, weighted_loss: 1.4883, label: 4, bag_size: 267
batch 179, loss: 0.1218, instance_loss: 0.3724, weighted_loss: 0.1970, label: 0, bag_size: 98
batch 199, loss: 1.0435, instance_loss: 0.4515, weighted_loss: 0.8659, label: 0, bag_size: 73
batch 219, loss: 0.5752, instance_loss: 0.4197, weighted_loss: 0.5286, label: 0, bag_size: 79
batch 239, loss: 2.3118, instance_loss: 0.6515, weighted_loss: 1.8137, label: 2, bag_size: 554
batch 259, loss: 1.2868, instance_loss: 0.4401, weighted_loss: 1.0328, label: 1, bag_size: 1009
batch 279, loss: 0.1632, instance_loss: 0.3867, weighted_loss: 0.2302, label: 0, bag_size: 230
batch 299, loss: 1.3416, instance_loss: 0.5088, weighted_loss: 1.0918, label: 3, bag_size: 746
batch 319, loss: 0.2080, instance_loss: 0.3951, weighted_loss: 0.2642, label: 0, bag_size: 268
batch 339, loss: 0.5833, instance_loss: 0.3688, weighted_loss: 0.5189, label: 0, bag_size: 175
batch 359, loss: 1.1171, instance_loss: 0.4765, weighted_loss: 0.9249, label: 4, bag_size: 503
batch 379, loss: 1.2202, instance_loss: 0.4314, weighted_loss: 0.9836, label: 3, bag_size: 235
batch 399, loss: 1.3493, instance_loss: 0.5398, weighted_loss: 1.1065, label: 4, bag_size: 409
batch 419, loss: 1.2199, instance_loss: 0.4637, weighted_loss: 0.9931, label: 1, bag_size: 311
batch 439, loss: 1.2817, instance_loss: 0.5348, weighted_loss: 1.0576, label: 4, bag_size: 329
batch 459, loss: 3.5689, instance_loss: 0.5735, weighted_loss: 2.6703, label: 0, bag_size: 62
batch 479, loss: 1.7860, instance_loss: 0.5265, weighted_loss: 1.4081, label: 4, bag_size: 377
batch 499, loss: 0.3743, instance_loss: 0.4105, weighted_loss: 0.3852, label: 0, bag_size: 79
batch 519, loss: 1.0140, instance_loss: 0.4707, weighted_loss: 0.8510, label: 2, bag_size: 613
batch 539, loss: 0.2186, instance_loss: 0.3536, weighted_loss: 0.2591, label: 0, bag_size: 354
batch 559, loss: 3.9314, instance_loss: 0.7132, weighted_loss: 2.9660, label: 3, bag_size: 638
batch 579, loss: 1.8309, instance_loss: 0.6179, weighted_loss: 1.4670, label: 2, bag_size: 851


class 0 clustering acc 1.0: correct 23760/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 1, train_loss: 1.4187, train_clustering_loss:  0.5003, train_error: 0.6481
class 0: acc 0.7310924369747899, correct 87/119
class 1: acc 0.17829457364341086, correct 23/129
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.30158730158730157, correct 38/126
class 4: acc 0.28703703703703703, correct 31/108

Val Set, val_loss: 1.5398, val_error: 0.6757, auc: 0.6479
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1131, instance_loss: 0.4407, weighted_loss: 0.9114, label: 3, bag_size: 432
batch 39, loss: 1.7709, instance_loss: 0.5820, weighted_loss: 1.4142, label: 1, bag_size: 875
batch 59, loss: 1.8016, instance_loss: 0.5727, weighted_loss: 1.4329, label: 2, bag_size: 557
batch 79, loss: 0.2172, instance_loss: 0.3548, weighted_loss: 0.2585, label: 0, bag_size: 59
batch 99, loss: 0.8554, instance_loss: 0.4901, weighted_loss: 0.7458, label: 4, bag_size: 824
batch 119, loss: 2.4323, instance_loss: 0.5850, weighted_loss: 1.8781, label: 1, bag_size: 697
batch 139, loss: 1.3819, instance_loss: 0.4417, weighted_loss: 1.0998, label: 3, bag_size: 1060
batch 159, loss: 2.0862, instance_loss: 0.5403, weighted_loss: 1.6225, label: 4, bag_size: 438
batch 179, loss: 1.9404, instance_loss: 0.5410, weighted_loss: 1.5206, label: 1, bag_size: 1091
batch 199, loss: 1.7370, instance_loss: 0.6075, weighted_loss: 1.3981, label: 1, bag_size: 361
batch 219, loss: 2.6129, instance_loss: 0.7384, weighted_loss: 2.0506, label: 0, bag_size: 1073
batch 239, loss: 0.8801, instance_loss: 0.4295, weighted_loss: 0.7449, label: 4, bag_size: 318
batch 259, loss: 1.6187, instance_loss: 0.5488, weighted_loss: 1.2977, label: 3, bag_size: 587
batch 279, loss: 1.7372, instance_loss: 0.4792, weighted_loss: 1.3598, label: 1, bag_size: 410
batch 299, loss: 2.7058, instance_loss: 0.6906, weighted_loss: 2.1012, label: 0, bag_size: 492
batch 319, loss: 1.5733, instance_loss: 0.4424, weighted_loss: 1.2340, label: 3, bag_size: 520
batch 339, loss: 5.1806, instance_loss: 0.7398, weighted_loss: 3.8484, label: 4, bag_size: 293
batch 359, loss: 1.1317, instance_loss: 0.4653, weighted_loss: 0.9318, label: 1, bag_size: 271
batch 379, loss: 1.2831, instance_loss: 0.4433, weighted_loss: 1.0312, label: 3, bag_size: 830
batch 399, loss: 1.1136, instance_loss: 0.4706, weighted_loss: 0.9207, label: 2, bag_size: 1608
batch 419, loss: 1.9280, instance_loss: 0.6799, weighted_loss: 1.5536, label: 4, bag_size: 627
batch 439, loss: 0.1872, instance_loss: 0.3298, weighted_loss: 0.2300, label: 0, bag_size: 366
batch 459, loss: 1.4456, instance_loss: 0.5075, weighted_loss: 1.1642, label: 2, bag_size: 844
batch 479, loss: 1.2533, instance_loss: 0.5410, weighted_loss: 1.0396, label: 4, bag_size: 797
batch 499, loss: 1.0641, instance_loss: 0.6136, weighted_loss: 0.9289, label: 4, bag_size: 813
batch 519, loss: 0.1424, instance_loss: 0.2941, weighted_loss: 0.1879, label: 0, bag_size: 190
batch 539, loss: 1.5327, instance_loss: 0.4770, weighted_loss: 1.2160, label: 3, bag_size: 1186
batch 559, loss: 1.7935, instance_loss: 0.5428, weighted_loss: 1.4183, label: 2, bag_size: 407
batch 579, loss: 0.4758, instance_loss: 0.4558, weighted_loss: 0.4698, label: 0, bag_size: 159


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.00042087542087542086: correct 2/4752
Epoch: 2, train_loss: 1.3769, train_clustering_loss:  0.4974, train_error: 0.6162
class 0: acc 0.768595041322314, correct 93/121
class 1: acc 0.21774193548387097, correct 27/124
class 2: acc 0.13636363636363635, correct 15/110
class 3: acc 0.3305785123966942, correct 40/121
class 4: acc 0.4491525423728814, correct 53/118

Val Set, val_loss: 1.5362, val_error: 0.7027, auc: 0.6536
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6004, instance_loss: 0.5476, weighted_loss: 1.2845, label: 2, bag_size: 535
batch 39, loss: 0.9909, instance_loss: 0.5077, weighted_loss: 0.8459, label: 2, bag_size: 119
batch 59, loss: 2.9648, instance_loss: 0.5931, weighted_loss: 2.2533, label: 0, bag_size: 732
batch 79, loss: 1.6331, instance_loss: 0.5461, weighted_loss: 1.3070, label: 3, bag_size: 1154
batch 99, loss: 1.7023, instance_loss: 0.5364, weighted_loss: 1.3525, label: 1, bag_size: 855
batch 119, loss: 2.0087, instance_loss: 0.5914, weighted_loss: 1.5835, label: 3, bag_size: 533
batch 139, loss: 1.0530, instance_loss: 0.4293, weighted_loss: 0.8659, label: 2, bag_size: 1230
batch 159, loss: 1.4464, instance_loss: 0.5008, weighted_loss: 1.1627, label: 4, bag_size: 113
batch 179, loss: 1.0640, instance_loss: 0.4348, weighted_loss: 0.8753, label: 3, bag_size: 631
batch 199, loss: 0.9485, instance_loss: 0.4664, weighted_loss: 0.8038, label: 3, bag_size: 746
batch 219, loss: 1.5626, instance_loss: 0.5753, weighted_loss: 1.2664, label: 4, bag_size: 744
batch 239, loss: 1.3335, instance_loss: 0.4788, weighted_loss: 1.0771, label: 1, bag_size: 500
batch 259, loss: 2.7766, instance_loss: 0.6133, weighted_loss: 2.1276, label: 3, bag_size: 638
batch 279, loss: 0.9601, instance_loss: 0.4724, weighted_loss: 0.8138, label: 3, bag_size: 393
batch 299, loss: 0.8995, instance_loss: 0.4451, weighted_loss: 0.7631, label: 3, bag_size: 727
batch 319, loss: 1.7750, instance_loss: 0.5364, weighted_loss: 1.4034, label: 1, bag_size: 221
batch 339, loss: 0.5755, instance_loss: 0.3842, weighted_loss: 0.5181, label: 0, bag_size: 79
batch 359, loss: 2.0428, instance_loss: 0.5801, weighted_loss: 1.6040, label: 4, bag_size: 960
batch 379, loss: 1.5796, instance_loss: 0.5218, weighted_loss: 1.2622, label: 1, bag_size: 764
batch 399, loss: 1.3899, instance_loss: 0.5297, weighted_loss: 1.1318, label: 1, bag_size: 886
batch 419, loss: 1.4571, instance_loss: 0.5623, weighted_loss: 1.1887, label: 3, bag_size: 274
batch 439, loss: 1.8531, instance_loss: 0.5577, weighted_loss: 1.4645, label: 0, bag_size: 492
batch 459, loss: 2.2728, instance_loss: 0.5839, weighted_loss: 1.7661, label: 3, bag_size: 166
batch 479, loss: 1.5461, instance_loss: 0.5771, weighted_loss: 1.2554, label: 0, bag_size: 277
batch 499, loss: 1.0585, instance_loss: 0.4393, weighted_loss: 0.8727, label: 3, bag_size: 473
batch 519, loss: 2.0433, instance_loss: 0.6283, weighted_loss: 1.6188, label: 2, bag_size: 769
batch 539, loss: 1.5740, instance_loss: 0.5354, weighted_loss: 1.2624, label: 1, bag_size: 764
batch 559, loss: 2.0363, instance_loss: 0.5712, weighted_loss: 1.5967, label: 3, bag_size: 476
batch 579, loss: 0.6652, instance_loss: 0.4592, weighted_loss: 0.6034, label: 4, bag_size: 520


class 0 clustering acc 0.999452861952862: correct 23747/23760
class 1 clustering acc 0.007575757575757576: correct 36/4752
Epoch: 3, train_loss: 1.3856, train_clustering_loss:  0.4986, train_error: 0.6212
class 0: acc 0.7165354330708661, correct 91/127
class 1: acc 0.2033898305084746, correct 24/118
class 2: acc 0.3464566929133858, correct 44/127
class 3: acc 0.24778761061946902, correct 28/113
class 4: acc 0.3486238532110092, correct 38/109

Val Set, val_loss: 1.6320, val_error: 0.6892, auc: 0.6459
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4461, instance_loss: 0.5837, weighted_loss: 1.1873, label: 4, bag_size: 986
batch 39, loss: 0.9241, instance_loss: 0.4281, weighted_loss: 0.7753, label: 0, bag_size: 316
batch 59, loss: 1.9540, instance_loss: 0.5891, weighted_loss: 1.5445, label: 1, bag_size: 1023
batch 79, loss: 1.6266, instance_loss: 0.5515, weighted_loss: 1.3041, label: 1, bag_size: 509
batch 99, loss: 3.6703, instance_loss: 0.7071, weighted_loss: 2.7814, label: 4, bag_size: 359
batch 119, loss: 2.9265, instance_loss: 0.6882, weighted_loss: 2.2550, label: 0, bag_size: 732
batch 139, loss: 1.1870, instance_loss: 0.5102, weighted_loss: 0.9840, label: 4, bag_size: 547
batch 159, loss: 1.2648, instance_loss: 0.4838, weighted_loss: 1.0305, label: 4, bag_size: 377
batch 179, loss: 0.2961, instance_loss: 0.3484, weighted_loss: 0.3118, label: 0, bag_size: 70
batch 199, loss: 0.7048, instance_loss: 0.4593, weighted_loss: 0.6312, label: 1, bag_size: 748
batch 219, loss: 0.9649, instance_loss: 0.4610, weighted_loss: 0.8137, label: 4, bag_size: 409
batch 239, loss: 0.6150, instance_loss: 0.4277, weighted_loss: 0.5588, label: 2, bag_size: 596
batch 259, loss: 1.4307, instance_loss: 0.4838, weighted_loss: 1.1467, label: 1, bag_size: 766
batch 279, loss: 0.0131, instance_loss: 0.3528, weighted_loss: 0.1150, label: 0, bag_size: 230
batch 299, loss: 1.4505, instance_loss: 0.5318, weighted_loss: 1.1749, label: 1, bag_size: 823
batch 319, loss: 2.0063, instance_loss: 0.6664, weighted_loss: 1.6043, label: 3, bag_size: 956
batch 339, loss: 1.8917, instance_loss: 0.5579, weighted_loss: 1.4915, label: 4, bag_size: 771
batch 359, loss: 1.3256, instance_loss: 0.4729, weighted_loss: 1.0698, label: 2, bag_size: 1010
batch 379, loss: 1.3181, instance_loss: 0.5484, weighted_loss: 1.0872, label: 4, bag_size: 689
batch 399, loss: 4.7139, instance_loss: 0.7471, weighted_loss: 3.5239, label: 4, bag_size: 293
batch 419, loss: 1.5141, instance_loss: 0.4932, weighted_loss: 1.2078, label: 2, bag_size: 96
batch 439, loss: 1.9109, instance_loss: 0.5181, weighted_loss: 1.4931, label: 4, bag_size: 690
batch 459, loss: 1.3337, instance_loss: 0.5451, weighted_loss: 1.0971, label: 4, bag_size: 755
batch 479, loss: 1.2077, instance_loss: 0.5606, weighted_loss: 1.0135, label: 4, bag_size: 744
batch 499, loss: 1.4974, instance_loss: 0.5015, weighted_loss: 1.1986, label: 3, bag_size: 194
batch 519, loss: 1.8187, instance_loss: 0.5977, weighted_loss: 1.4524, label: 1, bag_size: 272
batch 539, loss: 1.5728, instance_loss: 0.4877, weighted_loss: 1.2472, label: 3, bag_size: 149
batch 559, loss: 1.3301, instance_loss: 0.4424, weighted_loss: 1.0638, label: 3, bag_size: 804
batch 579, loss: 1.6795, instance_loss: 0.6270, weighted_loss: 1.3637, label: 4, bag_size: 1351


class 0 clustering acc 0.9995791245791246: correct 23750/23760
class 1 clustering acc 0.015151515151515152: correct 72/4752
Epoch: 4, train_loss: 1.3594, train_clustering_loss:  0.4927, train_error: 0.6162
class 0: acc 0.7416666666666667, correct 89/120
class 1: acc 0.10185185185185185, correct 11/108
class 2: acc 0.39705882352941174, correct 54/136
class 3: acc 0.19811320754716982, correct 21/106
class 4: acc 0.4274193548387097, correct 53/124

Val Set, val_loss: 1.4833, val_error: 0.5811, auc: 0.6723
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.495604 --> 1.483318).  Saving model ...


batch 19, loss: 3.1942, instance_loss: 0.6626, weighted_loss: 2.4347, label: 0, bag_size: 214
batch 39, loss: 0.9725, instance_loss: 0.4317, weighted_loss: 0.8102, label: 2, bag_size: 783
batch 59, loss: 0.1124, instance_loss: 0.2962, weighted_loss: 0.1676, label: 0, bag_size: 190
batch 79, loss: 1.4132, instance_loss: 0.5158, weighted_loss: 1.1440, label: 3, bag_size: 192
batch 99, loss: 1.5123, instance_loss: 0.4397, weighted_loss: 1.1905, label: 2, bag_size: 557
batch 119, loss: 0.7647, instance_loss: 0.4412, weighted_loss: 0.6676, label: 3, bag_size: 102
batch 139, loss: 1.0635, instance_loss: 0.4510, weighted_loss: 0.8798, label: 1, bag_size: 1082
batch 159, loss: 0.9458, instance_loss: 0.4703, weighted_loss: 0.8031, label: 3, bag_size: 818
batch 179, loss: 1.3664, instance_loss: 0.4946, weighted_loss: 1.1049, label: 1, bag_size: 460
batch 199, loss: 1.6010, instance_loss: 0.4990, weighted_loss: 1.2704, label: 2, bag_size: 407
batch 219, loss: 1.7755, instance_loss: 0.6199, weighted_loss: 1.4288, label: 2, bag_size: 321
batch 239, loss: 1.3975, instance_loss: 0.4603, weighted_loss: 1.1163, label: 2, bag_size: 598
batch 259, loss: 1.6901, instance_loss: 0.5807, weighted_loss: 1.3573, label: 1, bag_size: 272
batch 279, loss: 1.3151, instance_loss: 0.4964, weighted_loss: 1.0695, label: 1, bag_size: 1273
batch 299, loss: 1.4882, instance_loss: 0.5263, weighted_loss: 1.1996, label: 2, bag_size: 860
batch 319, loss: 0.3792, instance_loss: 0.2348, weighted_loss: 0.3359, label: 0, bag_size: 281
batch 339, loss: 1.9252, instance_loss: 0.6808, weighted_loss: 1.5519, label: 2, bag_size: 208
batch 359, loss: 1.2674, instance_loss: 0.4808, weighted_loss: 1.0314, label: 2, bag_size: 799
batch 379, loss: 1.8784, instance_loss: 0.5754, weighted_loss: 1.4875, label: 3, bag_size: 598
batch 399, loss: 1.8816, instance_loss: 0.5552, weighted_loss: 1.4837, label: 4, bag_size: 695
batch 419, loss: 0.0728, instance_loss: 0.2276, weighted_loss: 0.1192, label: 0, bag_size: 383
batch 439, loss: 1.6138, instance_loss: 0.6537, weighted_loss: 1.3258, label: 4, bag_size: 1113
batch 459, loss: 1.0801, instance_loss: 0.5039, weighted_loss: 0.9072, label: 4, bag_size: 712
batch 479, loss: 1.4993, instance_loss: 0.5546, weighted_loss: 1.2159, label: 2, bag_size: 299
batch 499, loss: 2.3745, instance_loss: 0.7610, weighted_loss: 1.8904, label: 1, bag_size: 361
batch 519, loss: 1.4151, instance_loss: 0.5203, weighted_loss: 1.1466, label: 1, bag_size: 764
batch 539, loss: 3.3853, instance_loss: 0.8098, weighted_loss: 2.6126, label: 4, bag_size: 264
batch 559, loss: 0.2218, instance_loss: 0.3210, weighted_loss: 0.2516, label: 2, bag_size: 1975
batch 579, loss: 0.9415, instance_loss: 0.4453, weighted_loss: 0.7927, label: 0, bag_size: 230


class 0 clustering acc 0.9975589225589225: correct 23702/23760
class 1 clustering acc 0.06965488215488215: correct 331/4752
Epoch: 5, train_loss: 1.3166, train_clustering_loss:  0.4808, train_error: 0.5892
class 0: acc 0.784, correct 98/125
class 1: acc 0.2, correct 24/120
class 2: acc 0.3709677419354839, correct 46/124
class 3: acc 0.3333333333333333, correct 40/120
class 4: acc 0.34285714285714286, correct 36/105

Val Set, val_loss: 1.5093, val_error: 0.6757, auc: 0.6676
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9694, instance_loss: 0.5877, weighted_loss: 1.5549, label: 1, bag_size: 599
batch 39, loss: 0.4089, instance_loss: 0.2701, weighted_loss: 0.3672, label: 0, bag_size: 297
batch 59, loss: 2.1108, instance_loss: 0.5976, weighted_loss: 1.6569, label: 2, bag_size: 185
batch 79, loss: 0.9312, instance_loss: 0.4153, weighted_loss: 0.7764, label: 3, bag_size: 684
batch 99, loss: 1.1248, instance_loss: 0.5644, weighted_loss: 0.9567, label: 4, bag_size: 683
batch 119, loss: 0.6296, instance_loss: 0.3596, weighted_loss: 0.5486, label: 1, bag_size: 544
batch 139, loss: 0.7872, instance_loss: 0.4204, weighted_loss: 0.6772, label: 0, bag_size: 306
batch 159, loss: 1.6169, instance_loss: 0.5687, weighted_loss: 1.3024, label: 2, bag_size: 558
batch 179, loss: 1.5582, instance_loss: 0.5285, weighted_loss: 1.2493, label: 3, bag_size: 804
batch 199, loss: 1.2886, instance_loss: 0.4713, weighted_loss: 1.0434, label: 2, bag_size: 402
batch 219, loss: 0.3656, instance_loss: 0.2912, weighted_loss: 0.3433, label: 0, bag_size: 122
batch 239, loss: 1.2978, instance_loss: 0.5224, weighted_loss: 1.0651, label: 1, bag_size: 886
batch 259, loss: 0.3034, instance_loss: 0.2164, weighted_loss: 0.2773, label: 0, bag_size: 399
batch 279, loss: 1.3755, instance_loss: 0.5193, weighted_loss: 1.1186, label: 4, bag_size: 266
batch 299, loss: 1.0417, instance_loss: 0.4555, weighted_loss: 0.8659, label: 4, bag_size: 699
batch 319, loss: 0.9323, instance_loss: 0.4124, weighted_loss: 0.7763, label: 1, bag_size: 1103
batch 339, loss: 2.1701, instance_loss: 0.6046, weighted_loss: 1.7004, label: 0, bag_size: 367
batch 359, loss: 1.0513, instance_loss: 0.4181, weighted_loss: 0.8613, label: 0, bag_size: 73
batch 379, loss: 1.1870, instance_loss: 0.4350, weighted_loss: 0.9614, label: 1, bag_size: 311
batch 399, loss: 2.3014, instance_loss: 0.6412, weighted_loss: 1.8034, label: 3, bag_size: 337
batch 419, loss: 1.5967, instance_loss: 0.6110, weighted_loss: 1.3010, label: 3, bag_size: 98
batch 439, loss: 1.3938, instance_loss: 0.5375, weighted_loss: 1.1369, label: 4, bag_size: 740
batch 459, loss: 1.3355, instance_loss: 0.5270, weighted_loss: 1.0930, label: 2, bag_size: 96
batch 479, loss: 1.2936, instance_loss: 0.4934, weighted_loss: 1.0536, label: 2, bag_size: 597
batch 499, loss: 2.2475, instance_loss: 0.5785, weighted_loss: 1.7468, label: 1, bag_size: 483
batch 519, loss: 1.7922, instance_loss: 0.5567, weighted_loss: 1.4215, label: 2, bag_size: 606
batch 539, loss: 1.3778, instance_loss: 0.5243, weighted_loss: 1.1217, label: 4, bag_size: 618
batch 559, loss: 1.4243, instance_loss: 0.5970, weighted_loss: 1.1761, label: 3, bag_size: 533
batch 579, loss: 1.0280, instance_loss: 0.3752, weighted_loss: 0.8322, label: 3, bag_size: 727


class 0 clustering acc 0.9949074074074075: correct 23639/23760
class 1 clustering acc 0.08396464646464646: correct 399/4752
Epoch: 6, train_loss: 1.3256, train_clustering_loss:  0.4805, train_error: 0.5774
class 0: acc 0.7698412698412699, correct 97/126
class 1: acc 0.3275862068965517, correct 38/116
class 2: acc 0.20535714285714285, correct 23/112
class 3: acc 0.3949579831932773, correct 47/119
class 4: acc 0.38016528925619836, correct 46/121

Val Set, val_loss: 1.5319, val_error: 0.6081, auc: 0.6524
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3546, instance_loss: 0.3383, weighted_loss: 0.3497, label: 0, bag_size: 366
batch 39, loss: 0.8577, instance_loss: 0.3981, weighted_loss: 0.7199, label: 3, bag_size: 631
batch 59, loss: 1.5591, instance_loss: 0.5346, weighted_loss: 1.2518, label: 3, bag_size: 500
batch 79, loss: 0.1410, instance_loss: 0.2882, weighted_loss: 0.1852, label: 0, bag_size: 357
batch 99, loss: 1.2454, instance_loss: 0.4943, weighted_loss: 1.0200, label: 4, bag_size: 574
batch 119, loss: 0.5292, instance_loss: 0.5222, weighted_loss: 0.5271, label: 1, bag_size: 141
batch 139, loss: 1.4352, instance_loss: 0.5422, weighted_loss: 1.1673, label: 0, bag_size: 615
batch 159, loss: 2.0353, instance_loss: 0.6643, weighted_loss: 1.6240, label: 1, bag_size: 949
batch 179, loss: 1.2323, instance_loss: 0.5244, weighted_loss: 1.0199, label: 2, bag_size: 783
batch 199, loss: 1.4109, instance_loss: 0.4761, weighted_loss: 1.1305, label: 2, bag_size: 754
batch 219, loss: 1.5042, instance_loss: 0.4408, weighted_loss: 1.1852, label: 3, bag_size: 272
batch 239, loss: 0.0927, instance_loss: 0.2257, weighted_loss: 0.1326, label: 0, bag_size: 573
batch 259, loss: 0.8523, instance_loss: 0.4437, weighted_loss: 0.7297, label: 3, bag_size: 194
batch 279, loss: 2.1799, instance_loss: 0.5816, weighted_loss: 1.7004, label: 4, bag_size: 482
batch 299, loss: 1.5656, instance_loss: 0.5327, weighted_loss: 1.2557, label: 2, bag_size: 754
batch 319, loss: 0.8162, instance_loss: 0.4412, weighted_loss: 0.7037, label: 1, bag_size: 766
batch 339, loss: 0.3209, instance_loss: 0.2797, weighted_loss: 0.3086, label: 0, bag_size: 133
batch 359, loss: 1.1460, instance_loss: 0.5406, weighted_loss: 0.9644, label: 2, bag_size: 659
batch 379, loss: 1.0348, instance_loss: 0.4646, weighted_loss: 0.8637, label: 4, bag_size: 1041
batch 399, loss: 1.3259, instance_loss: 0.5109, weighted_loss: 1.0814, label: 4, bag_size: 218
batch 419, loss: 1.3510, instance_loss: 0.4673, weighted_loss: 1.0859, label: 2, bag_size: 867
batch 439, loss: 0.9855, instance_loss: 0.4249, weighted_loss: 0.8173, label: 2, bag_size: 410
batch 459, loss: 1.3863, instance_loss: 0.5384, weighted_loss: 1.1319, label: 3, bag_size: 428
batch 479, loss: 2.1240, instance_loss: 0.5710, weighted_loss: 1.6581, label: 1, bag_size: 949
batch 499, loss: 4.8750, instance_loss: 1.0811, weighted_loss: 3.7368, label: 0, bag_size: 421
batch 519, loss: 1.6609, instance_loss: 0.5057, weighted_loss: 1.3143, label: 1, bag_size: 1104
batch 539, loss: 0.9911, instance_loss: 0.4544, weighted_loss: 0.8301, label: 2, bag_size: 266
batch 559, loss: 1.6173, instance_loss: 0.5348, weighted_loss: 1.2926, label: 4, bag_size: 407
batch 579, loss: 2.0046, instance_loss: 0.5652, weighted_loss: 1.5728, label: 2, bag_size: 1066


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.050294612794612795: correct 239/4752
Epoch: 7, train_loss: 1.3666, train_clustering_loss:  0.4946, train_error: 0.5774
class 0: acc 0.7029702970297029, correct 71/101
class 1: acc 0.2072072072072072, correct 23/111
class 2: acc 0.45112781954887216, correct 60/133
class 3: acc 0.34108527131782945, correct 44/129
class 4: acc 0.44166666666666665, correct 53/120

Val Set, val_loss: 1.5068, val_error: 0.6757, auc: 0.6534
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4840, instance_loss: 0.4851, weighted_loss: 1.1844, label: 4, bag_size: 740
batch 39, loss: 0.2943, instance_loss: 0.3474, weighted_loss: 0.3103, label: 0, bag_size: 425
batch 59, loss: 1.3322, instance_loss: 0.4531, weighted_loss: 1.0685, label: 4, bag_size: 714
batch 79, loss: 0.1470, instance_loss: 0.2015, weighted_loss: 0.1634, label: 0, bag_size: 517
batch 99, loss: 1.6814, instance_loss: 0.5506, weighted_loss: 1.3421, label: 1, bag_size: 697
batch 119, loss: 3.2401, instance_loss: 0.8086, weighted_loss: 2.5106, label: 3, bag_size: 638
batch 139, loss: 0.9157, instance_loss: 0.4538, weighted_loss: 0.7772, label: 4, bag_size: 266
batch 159, loss: 2.4902, instance_loss: 0.6048, weighted_loss: 1.9246, label: 2, bag_size: 421
batch 179, loss: 1.7254, instance_loss: 0.5008, weighted_loss: 1.3580, label: 2, bag_size: 697
batch 199, loss: 1.3138, instance_loss: 0.4984, weighted_loss: 1.0692, label: 1, bag_size: 460
batch 219, loss: 1.0244, instance_loss: 0.4432, weighted_loss: 0.8500, label: 1, bag_size: 599
batch 239, loss: 0.9185, instance_loss: 0.4934, weighted_loss: 0.7910, label: 4, bag_size: 960
batch 259, loss: 0.1722, instance_loss: 0.2934, weighted_loss: 0.2085, label: 0, bag_size: 642
batch 279, loss: 1.1322, instance_loss: 0.4065, weighted_loss: 0.9145, label: 3, bag_size: 781
batch 299, loss: 0.7572, instance_loss: 0.3849, weighted_loss: 0.6455, label: 3, bag_size: 344
batch 319, loss: 0.9662, instance_loss: 0.5185, weighted_loss: 0.8319, label: 4, bag_size: 627
batch 339, loss: 1.3338, instance_loss: 0.4928, weighted_loss: 1.0815, label: 1, bag_size: 925
batch 359, loss: 0.1233, instance_loss: 0.1746, weighted_loss: 0.1387, label: 0, bag_size: 231
batch 379, loss: 1.4116, instance_loss: 0.5298, weighted_loss: 1.1471, label: 4, bag_size: 418
batch 399, loss: 1.0779, instance_loss: 0.4681, weighted_loss: 0.8950, label: 3, bag_size: 697
batch 419, loss: 0.6174, instance_loss: 0.3234, weighted_loss: 0.5292, label: 0, bag_size: 370
batch 439, loss: 1.5112, instance_loss: 0.5578, weighted_loss: 1.2252, label: 4, bag_size: 618
batch 459, loss: 1.3432, instance_loss: 0.6282, weighted_loss: 1.1287, label: 2, bag_size: 410
batch 479, loss: 2.3013, instance_loss: 0.5958, weighted_loss: 1.7897, label: 2, bag_size: 185
batch 499, loss: 5.2546, instance_loss: 0.9029, weighted_loss: 3.9491, label: 0, bag_size: 421
batch 519, loss: 1.7005, instance_loss: 0.4533, weighted_loss: 1.3263, label: 3, bag_size: 817
batch 539, loss: 1.4363, instance_loss: 0.6885, weighted_loss: 1.2119, label: 0, bag_size: 243
batch 559, loss: 1.5912, instance_loss: 0.5728, weighted_loss: 1.2857, label: 4, bag_size: 250
batch 579, loss: 1.5085, instance_loss: 0.5204, weighted_loss: 1.2121, label: 2, bag_size: 844


class 0 clustering acc 0.9935185185185185: correct 23606/23760
class 1 clustering acc 0.12584175084175084: correct 598/4752
Epoch: 8, train_loss: 1.2836, train_clustering_loss:  0.4697, train_error: 0.5606
class 0: acc 0.8159509202453987, correct 133/163
class 1: acc 0.30833333333333335, correct 37/120
class 2: acc 0.20430107526881722, correct 19/93
class 3: acc 0.2982456140350877, correct 34/114
class 4: acc 0.36538461538461536, correct 38/104

Val Set, val_loss: 1.4529, val_error: 0.6351, auc: 0.6825
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.09121621621621621: correct 54/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (1.483318 --> 1.452871).  Saving model ...


batch 19, loss: 1.3065, instance_loss: 0.4979, weighted_loss: 1.0639, label: 2, bag_size: 549
batch 39, loss: 1.4860, instance_loss: 0.4982, weighted_loss: 1.1896, label: 1, bag_size: 960
batch 59, loss: 0.0893, instance_loss: 0.2283, weighted_loss: 0.1310, label: 0, bag_size: 164
batch 79, loss: 1.6787, instance_loss: 0.5126, weighted_loss: 1.3289, label: 2, bag_size: 744
batch 99, loss: 0.1362, instance_loss: 0.1906, weighted_loss: 0.1525, label: 0, bag_size: 268
batch 119, loss: 0.6117, instance_loss: 0.4211, weighted_loss: 0.5545, label: 1, bag_size: 544
batch 139, loss: 0.6585, instance_loss: 0.4492, weighted_loss: 0.5957, label: 4, bag_size: 773
batch 159, loss: 0.0913, instance_loss: 0.1753, weighted_loss: 0.1165, label: 0, bag_size: 354
batch 179, loss: 2.0374, instance_loss: 0.5945, weighted_loss: 1.6045, label: 4, bag_size: 267
batch 199, loss: 4.6191, instance_loss: 0.7636, weighted_loss: 3.4625, label: 0, bag_size: 421
batch 219, loss: 1.3344, instance_loss: 0.4697, weighted_loss: 1.0750, label: 4, bag_size: 176
batch 239, loss: 1.6420, instance_loss: 0.5541, weighted_loss: 1.3156, label: 2, bag_size: 351
batch 259, loss: 0.1259, instance_loss: 0.1544, weighted_loss: 0.1344, label: 0, bag_size: 397
batch 279, loss: 1.5789, instance_loss: 0.4526, weighted_loss: 1.2410, label: 4, bag_size: 233
batch 299, loss: 1.0055, instance_loss: 0.4884, weighted_loss: 0.8504, label: 2, bag_size: 684
batch 319, loss: 1.6048, instance_loss: 0.5467, weighted_loss: 1.2874, label: 4, bag_size: 1077
batch 339, loss: 0.3782, instance_loss: 0.5197, weighted_loss: 0.4206, label: 4, bag_size: 746
batch 359, loss: 1.8972, instance_loss: 0.6457, weighted_loss: 1.5218, label: 2, bag_size: 554
batch 379, loss: 0.0956, instance_loss: 0.1545, weighted_loss: 0.1133, label: 0, bag_size: 212
batch 399, loss: 1.1052, instance_loss: 0.4329, weighted_loss: 0.9035, label: 3, bag_size: 102
batch 419, loss: 2.0224, instance_loss: 0.5282, weighted_loss: 1.5741, label: 4, bag_size: 113
batch 439, loss: 0.1060, instance_loss: 0.2442, weighted_loss: 0.1474, label: 0, bag_size: 74
batch 459, loss: 1.2800, instance_loss: 0.4663, weighted_loss: 1.0359, label: 2, bag_size: 616
batch 479, loss: 0.7769, instance_loss: 0.4841, weighted_loss: 0.6891, label: 4, bag_size: 875
batch 499, loss: 0.6675, instance_loss: 0.3919, weighted_loss: 0.5848, label: 1, bag_size: 981
batch 519, loss: 1.5534, instance_loss: 0.4978, weighted_loss: 1.2367, label: 4, bag_size: 244
batch 539, loss: 0.7165, instance_loss: 0.4068, weighted_loss: 0.6236, label: 0, bag_size: 552
batch 559, loss: 1.2893, instance_loss: 0.4873, weighted_loss: 1.0487, label: 3, bag_size: 428
batch 579, loss: 1.8594, instance_loss: 0.5204, weighted_loss: 1.4577, label: 4, bag_size: 312


class 0 clustering acc 0.9954124579124579: correct 23651/23760
class 1 clustering acc 0.11026936026936027: correct 524/4752
Epoch: 9, train_loss: 1.2673, train_clustering_loss:  0.4687, train_error: 0.5724
class 0: acc 0.7596899224806202, correct 98/129
class 1: acc 0.35454545454545455, correct 39/110
class 2: acc 0.31451612903225806, correct 39/124
class 3: acc 0.16666666666666666, correct 17/102
class 4: acc 0.4728682170542636, correct 61/129

Val Set, val_loss: 1.4359, val_error: 0.6351, auc: 0.6943
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.452871 --> 1.435937).  Saving model ...


batch 19, loss: 1.5527, instance_loss: 0.4701, weighted_loss: 1.2279, label: 1, bag_size: 972
batch 39, loss: 1.1710, instance_loss: 0.4289, weighted_loss: 0.9484, label: 3, bag_size: 746
batch 59, loss: 1.8107, instance_loss: 0.4849, weighted_loss: 1.4129, label: 3, bag_size: 451
batch 79, loss: 1.9233, instance_loss: 0.5002, weighted_loss: 1.4963, label: 3, bag_size: 230
batch 99, loss: 0.3079, instance_loss: 0.2993, weighted_loss: 0.3053, label: 0, bag_size: 74
batch 119, loss: 2.4800, instance_loss: 0.7072, weighted_loss: 1.9482, label: 2, bag_size: 470
batch 139, loss: 0.6458, instance_loss: 0.4483, weighted_loss: 0.5866, label: 3, bag_size: 473
batch 159, loss: 1.0964, instance_loss: 0.4841, weighted_loss: 0.9127, label: 2, bag_size: 535
batch 179, loss: 0.8106, instance_loss: 0.5307, weighted_loss: 0.7267, label: 4, bag_size: 727
batch 199, loss: 1.0725, instance_loss: 0.4380, weighted_loss: 0.8821, label: 2, bag_size: 640
batch 219, loss: 0.4506, instance_loss: 0.5220, weighted_loss: 0.4720, label: 4, bag_size: 773
batch 239, loss: 2.3923, instance_loss: 0.5882, weighted_loss: 1.8511, label: 4, bag_size: 333
batch 259, loss: 1.6633, instance_loss: 0.4823, weighted_loss: 1.3090, label: 1, bag_size: 397
batch 279, loss: 0.4672, instance_loss: 0.2460, weighted_loss: 0.4008, label: 0, bag_size: 370
batch 299, loss: 1.1612, instance_loss: 0.5246, weighted_loss: 0.9702, label: 2, bag_size: 645
batch 319, loss: 1.8742, instance_loss: 0.5180, weighted_loss: 1.4673, label: 1, bag_size: 875
batch 339, loss: 1.4423, instance_loss: 0.4635, weighted_loss: 1.1487, label: 4, bag_size: 333
batch 359, loss: 1.7467, instance_loss: 0.5181, weighted_loss: 1.3781, label: 1, bag_size: 829
batch 379, loss: 0.4217, instance_loss: 0.4047, weighted_loss: 0.4166, label: 4, bag_size: 923
batch 399, loss: 0.9282, instance_loss: 0.4847, weighted_loss: 0.7952, label: 4, bag_size: 797
batch 419, loss: 0.1223, instance_loss: 0.5861, weighted_loss: 0.2614, label: 0, bag_size: 1570
batch 439, loss: 1.2986, instance_loss: 0.4800, weighted_loss: 1.0530, label: 4, bag_size: 714
batch 459, loss: 1.6065, instance_loss: 0.5060, weighted_loss: 1.2764, label: 4, bag_size: 176
batch 479, loss: 1.0394, instance_loss: 0.4834, weighted_loss: 0.8726, label: 4, bag_size: 755
batch 499, loss: 1.6346, instance_loss: 0.5033, weighted_loss: 1.2952, label: 2, bag_size: 821
batch 519, loss: 1.8132, instance_loss: 0.5904, weighted_loss: 1.4463, label: 1, bag_size: 113
batch 539, loss: 0.1988, instance_loss: 0.2579, weighted_loss: 0.2165, label: 0, bag_size: 355
batch 559, loss: 1.3852, instance_loss: 0.4788, weighted_loss: 1.1133, label: 2, bag_size: 860
batch 579, loss: 1.7444, instance_loss: 0.5568, weighted_loss: 1.3881, label: 4, bag_size: 1104


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.09574915824915825: correct 455/4752
Epoch: 10, train_loss: 1.2582, train_clustering_loss:  0.4775, train_error: 0.5505
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.42063492063492064, correct 53/126
class 2: acc 0.2644628099173554, correct 32/121
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.4827586206896552, correct 56/116

Val Set, val_loss: 1.3909, val_error: 0.6757, auc: 0.6962
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.435937 --> 1.390892).  Saving model ...


batch 19, loss: 1.0812, instance_loss: 0.5173, weighted_loss: 0.9120, label: 2, bag_size: 445
batch 39, loss: 0.0604, instance_loss: 0.1850, weighted_loss: 0.0978, label: 0, bag_size: 159
batch 59, loss: 0.7274, instance_loss: 0.4698, weighted_loss: 0.6501, label: 4, bag_size: 520
batch 79, loss: 1.6177, instance_loss: 0.4515, weighted_loss: 1.2678, label: 3, bag_size: 608
batch 99, loss: 0.4681, instance_loss: 0.4319, weighted_loss: 0.4572, label: 0, bag_size: 351
batch 119, loss: 1.0974, instance_loss: 0.6161, weighted_loss: 0.9530, label: 4, bag_size: 960
batch 139, loss: 0.1025, instance_loss: 0.2416, weighted_loss: 0.1442, label: 0, bag_size: 122
batch 159, loss: 1.4418, instance_loss: 0.5158, weighted_loss: 1.1640, label: 4, bag_size: 1104
batch 179, loss: 1.4464, instance_loss: 0.5776, weighted_loss: 1.1858, label: 2, bag_size: 321
batch 199, loss: 1.1577, instance_loss: 0.5350, weighted_loss: 0.9709, label: 2, bag_size: 754
batch 219, loss: 1.2112, instance_loss: 0.5000, weighted_loss: 0.9978, label: 4, bag_size: 986
batch 239, loss: 1.3877, instance_loss: 0.4764, weighted_loss: 1.1143, label: 3, bag_size: 804
batch 259, loss: 0.2233, instance_loss: 0.3429, weighted_loss: 0.2592, label: 1, bag_size: 1497
batch 279, loss: 1.0858, instance_loss: 0.4822, weighted_loss: 0.9047, label: 4, bag_size: 604
batch 299, loss: 0.7786, instance_loss: 0.4555, weighted_loss: 0.6816, label: 4, bag_size: 986
batch 319, loss: 0.8668, instance_loss: 0.4307, weighted_loss: 0.7360, label: 1, bag_size: 605
batch 339, loss: 1.1676, instance_loss: 0.4543, weighted_loss: 0.9536, label: 3, bag_size: 431
batch 359, loss: 2.1265, instance_loss: 0.5690, weighted_loss: 1.6592, label: 2, bag_size: 821
batch 379, loss: 0.0426, instance_loss: 0.1571, weighted_loss: 0.0769, label: 0, bag_size: 523
batch 399, loss: 1.3546, instance_loss: 0.5375, weighted_loss: 1.1094, label: 1, bag_size: 321
batch 419, loss: 2.9825, instance_loss: 0.6295, weighted_loss: 2.2766, label: 2, bag_size: 1074
batch 439, loss: 1.9478, instance_loss: 0.5327, weighted_loss: 1.5232, label: 1, bag_size: 311
batch 459, loss: 0.1554, instance_loss: 0.4347, weighted_loss: 0.2392, label: 4, bag_size: 813
batch 479, loss: 0.7157, instance_loss: 0.4009, weighted_loss: 0.6212, label: 4, bag_size: 729
batch 499, loss: 0.7600, instance_loss: 0.4229, weighted_loss: 0.6589, label: 2, bag_size: 348
batch 519, loss: 0.0382, instance_loss: 0.1505, weighted_loss: 0.0719, label: 0, bag_size: 190
batch 539, loss: 1.3426, instance_loss: 0.4710, weighted_loss: 1.0811, label: 3, bag_size: 818
batch 559, loss: 0.6071, instance_loss: 0.4092, weighted_loss: 0.5477, label: 3, bag_size: 817
batch 579, loss: 1.0227, instance_loss: 0.4263, weighted_loss: 0.8438, label: 1, bag_size: 1009


class 0 clustering acc 0.9961700336700336: correct 23669/23760
class 1 clustering acc 0.06186868686868687: correct 294/4752
Epoch: 11, train_loss: 1.2874, train_clustering_loss:  0.4841, train_error: 0.5455
class 0: acc 0.7647058823529411, correct 78/102
class 1: acc 0.3474576271186441, correct 41/118
class 2: acc 0.29464285714285715, correct 33/112
class 3: acc 0.41605839416058393, correct 57/137
class 4: acc 0.488, correct 61/125

Val Set, val_loss: 1.6548, val_error: 0.6892, auc: 0.6464
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2969, instance_loss: 0.6486, weighted_loss: 1.8024, label: 1, bag_size: 1023
batch 39, loss: 0.9604, instance_loss: 0.4871, weighted_loss: 0.8184, label: 2, bag_size: 799
batch 59, loss: 1.4700, instance_loss: 0.5290, weighted_loss: 1.1877, label: 4, bag_size: 231
batch 79, loss: 6.5388, instance_loss: 1.1132, weighted_loss: 4.9111, label: 4, bag_size: 293
batch 99, loss: 0.9696, instance_loss: 0.4606, weighted_loss: 0.8169, label: 3, bag_size: 351
batch 119, loss: 1.2548, instance_loss: 0.5432, weighted_loss: 1.0413, label: 2, bag_size: 337
batch 139, loss: 1.3848, instance_loss: 0.4879, weighted_loss: 1.1157, label: 3, bag_size: 149
batch 159, loss: 1.2073, instance_loss: 0.4268, weighted_loss: 0.9732, label: 3, bag_size: 956
batch 179, loss: 1.2348, instance_loss: 0.5436, weighted_loss: 1.0275, label: 2, bag_size: 783
batch 199, loss: 0.9475, instance_loss: 0.4959, weighted_loss: 0.8120, label: 1, bag_size: 892
batch 219, loss: 1.1042, instance_loss: 0.4162, weighted_loss: 0.8978, label: 2, bag_size: 543
batch 239, loss: 0.9050, instance_loss: 0.4355, weighted_loss: 0.7641, label: 1, bag_size: 593
batch 259, loss: 0.0614, instance_loss: 0.2661, weighted_loss: 0.1228, label: 4, bag_size: 813
batch 279, loss: 3.1901, instance_loss: 0.6122, weighted_loss: 2.4167, label: 4, bag_size: 886
batch 299, loss: 0.4255, instance_loss: 0.2603, weighted_loss: 0.3760, label: 0, bag_size: 493
batch 319, loss: 0.8550, instance_loss: 0.4546, weighted_loss: 0.7349, label: 3, bag_size: 230
batch 339, loss: 1.3797, instance_loss: 0.4901, weighted_loss: 1.1128, label: 3, bag_size: 533
batch 359, loss: 0.7729, instance_loss: 0.4036, weighted_loss: 0.6621, label: 3, bag_size: 1007
batch 379, loss: 1.7152, instance_loss: 0.5432, weighted_loss: 1.3636, label: 4, bag_size: 862
batch 399, loss: 1.6482, instance_loss: 0.5291, weighted_loss: 1.3125, label: 1, bag_size: 764
batch 419, loss: 0.2921, instance_loss: 0.4099, weighted_loss: 0.3275, label: 4, bag_size: 1018
batch 439, loss: 3.1518, instance_loss: 0.6101, weighted_loss: 2.3893, label: 4, bag_size: 438
batch 459, loss: 0.0145, instance_loss: 0.4714, weighted_loss: 0.1516, label: 2, bag_size: 1608
batch 479, loss: 0.8956, instance_loss: 0.4473, weighted_loss: 0.7611, label: 2, bag_size: 598
batch 499, loss: 0.2805, instance_loss: 0.4487, weighted_loss: 0.3310, label: 4, bag_size: 746
batch 519, loss: 1.2323, instance_loss: 0.4576, weighted_loss: 0.9999, label: 3, bag_size: 472
batch 539, loss: 1.5439, instance_loss: 0.4596, weighted_loss: 1.2186, label: 1, bag_size: 591
batch 559, loss: 0.9125, instance_loss: 0.4434, weighted_loss: 0.7718, label: 2, bag_size: 402
batch 579, loss: 0.2997, instance_loss: 0.2849, weighted_loss: 0.2952, label: 0, bag_size: 281


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.06965488215488215: correct 331/4752
Epoch: 12, train_loss: 1.2918, train_clustering_loss:  0.4850, train_error: 0.5202
class 0: acc 0.7019230769230769, correct 73/104
class 1: acc 0.35384615384615387, correct 46/130
class 2: acc 0.5, correct 64/128
class 3: acc 0.48854961832061067, correct 64/131
class 4: acc 0.37623762376237624, correct 38/101

Val Set, val_loss: 1.5082, val_error: 0.6486, auc: 0.6854
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0725, instance_loss: 0.5059, weighted_loss: 0.9025, label: 2, bag_size: 375
batch 39, loss: 1.2171, instance_loss: 0.4906, weighted_loss: 0.9992, label: 1, bag_size: 981
batch 59, loss: 1.2061, instance_loss: 0.4143, weighted_loss: 0.9686, label: 3, bag_size: 476
batch 79, loss: 0.1497, instance_loss: 0.2289, weighted_loss: 0.1735, label: 0, bag_size: 258
batch 99, loss: 1.5029, instance_loss: 0.6577, weighted_loss: 1.2493, label: 2, bag_size: 321
batch 119, loss: 0.9548, instance_loss: 0.4526, weighted_loss: 0.8042, label: 1, bag_size: 1103
batch 139, loss: 1.0104, instance_loss: 0.4077, weighted_loss: 0.8296, label: 3, bag_size: 453
batch 159, loss: 0.7911, instance_loss: 0.5432, weighted_loss: 0.7167, label: 0, bag_size: 317
batch 179, loss: 0.3037, instance_loss: 0.3283, weighted_loss: 0.3111, label: 0, bag_size: 393
batch 199, loss: 1.8004, instance_loss: 0.4949, weighted_loss: 1.4088, label: 4, bag_size: 98
batch 219, loss: 1.1810, instance_loss: 0.4865, weighted_loss: 0.9726, label: 2, bag_size: 286
batch 239, loss: 0.0459, instance_loss: 0.3487, weighted_loss: 0.1367, label: 4, bag_size: 813
batch 259, loss: 1.8078, instance_loss: 0.5787, weighted_loss: 1.4391, label: 1, bag_size: 381
batch 279, loss: 0.9543, instance_loss: 0.4417, weighted_loss: 0.8006, label: 0, bag_size: 613
batch 299, loss: 2.1096, instance_loss: 0.5331, weighted_loss: 1.6366, label: 1, bag_size: 742
batch 319, loss: 0.5434, instance_loss: 0.4027, weighted_loss: 0.5012, label: 4, bag_size: 875
batch 339, loss: 1.0479, instance_loss: 0.5012, weighted_loss: 0.8839, label: 2, bag_size: 498
batch 359, loss: 0.7720, instance_loss: 0.4321, weighted_loss: 0.6700, label: 4, bag_size: 685
batch 379, loss: 0.7448, instance_loss: 0.4738, weighted_loss: 0.6635, label: 4, bag_size: 418
batch 399, loss: 0.8153, instance_loss: 0.4583, weighted_loss: 0.7082, label: 2, bag_size: 427
batch 419, loss: 1.1594, instance_loss: 0.4500, weighted_loss: 0.9466, label: 2, bag_size: 339
batch 439, loss: 1.2611, instance_loss: 0.5170, weighted_loss: 1.0379, label: 3, bag_size: 192
batch 459, loss: 4.0279, instance_loss: 0.8617, weighted_loss: 3.0781, label: 0, bag_size: 1039
batch 479, loss: 1.7631, instance_loss: 0.4597, weighted_loss: 1.3720, label: 4, bag_size: 246
batch 499, loss: 0.7276, instance_loss: 0.3563, weighted_loss: 0.6163, label: 4, bag_size: 729
batch 519, loss: 1.7775, instance_loss: 0.6308, weighted_loss: 1.4335, label: 2, bag_size: 445
batch 539, loss: 0.8779, instance_loss: 0.4508, weighted_loss: 0.7498, label: 0, bag_size: 351
batch 559, loss: 0.8493, instance_loss: 0.3753, weighted_loss: 0.7071, label: 3, bag_size: 817
batch 579, loss: 0.8244, instance_loss: 0.4440, weighted_loss: 0.7103, label: 4, bag_size: 101


class 0 clustering acc 0.9967171717171717: correct 23682/23760
class 1 clustering acc 0.041245791245791245: correct 196/4752
Epoch: 13, train_loss: 1.2772, train_clustering_loss:  0.4847, train_error: 0.5522
class 0: acc 0.7706422018348624, correct 84/109
class 1: acc 0.2, correct 20/100
class 2: acc 0.37404580152671757, correct 49/131
class 3: acc 0.4330708661417323, correct 55/127
class 4: acc 0.4566929133858268, correct 58/127

Val Set, val_loss: 1.4796, val_error: 0.6351, auc: 0.6924
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6400, instance_loss: 0.4383, weighted_loss: 0.5795, label: 1, bag_size: 1497
batch 39, loss: 0.5337, instance_loss: 0.4144, weighted_loss: 0.4979, label: 4, bag_size: 409
batch 59, loss: 0.0825, instance_loss: 0.2038, weighted_loss: 0.1189, label: 0, bag_size: 255
batch 79, loss: 1.1122, instance_loss: 0.5055, weighted_loss: 0.9301, label: 1, bag_size: 840
batch 99, loss: 0.1073, instance_loss: 0.1880, weighted_loss: 0.1315, label: 0, bag_size: 212
batch 119, loss: 2.7906, instance_loss: 0.7458, weighted_loss: 2.1772, label: 0, bag_size: 478
batch 139, loss: 0.9527, instance_loss: 0.4647, weighted_loss: 0.8063, label: 3, bag_size: 194
batch 159, loss: 1.1679, instance_loss: 0.4351, weighted_loss: 0.9481, label: 3, bag_size: 566
batch 179, loss: 3.2318, instance_loss: 0.7492, weighted_loss: 2.4870, label: 0, bag_size: 608
batch 199, loss: 1.1329, instance_loss: 0.4323, weighted_loss: 0.9227, label: 3, bag_size: 476
batch 219, loss: 1.7118, instance_loss: 0.5972, weighted_loss: 1.3774, label: 3, bag_size: 107
batch 239, loss: 0.8605, instance_loss: 0.4045, weighted_loss: 0.7237, label: 3, bag_size: 476
batch 259, loss: 0.8179, instance_loss: 0.5075, weighted_loss: 0.7248, label: 1, bag_size: 381
batch 279, loss: 2.5588, instance_loss: 0.6384, weighted_loss: 1.9827, label: 2, bag_size: 640
batch 299, loss: 1.5682, instance_loss: 0.5063, weighted_loss: 1.2497, label: 2, bag_size: 369
batch 319, loss: 0.8544, instance_loss: 0.5849, weighted_loss: 0.7736, label: 2, bag_size: 176
batch 339, loss: 0.4300, instance_loss: 0.4387, weighted_loss: 0.4326, label: 4, bag_size: 923
batch 359, loss: 2.8357, instance_loss: 0.6275, weighted_loss: 2.1733, label: 1, bag_size: 361
batch 379, loss: 1.9277, instance_loss: 0.5688, weighted_loss: 1.5200, label: 4, bag_size: 757
batch 399, loss: 2.0236, instance_loss: 0.6081, weighted_loss: 1.5989, label: 0, bag_size: 367
batch 419, loss: 1.3371, instance_loss: 0.4663, weighted_loss: 1.0758, label: 3, bag_size: 510
batch 439, loss: 0.2486, instance_loss: 0.3243, weighted_loss: 0.2713, label: 0, bag_size: 188
batch 459, loss: 1.9672, instance_loss: 0.5418, weighted_loss: 1.5396, label: 2, bag_size: 713
batch 479, loss: 2.4095, instance_loss: 0.6750, weighted_loss: 1.8891, label: 3, bag_size: 282
batch 499, loss: 0.4409, instance_loss: 0.4545, weighted_loss: 0.4450, label: 0, bag_size: 642
batch 519, loss: 1.0345, instance_loss: 0.4498, weighted_loss: 0.8591, label: 1, bag_size: 410
batch 539, loss: 3.6850, instance_loss: 0.8428, weighted_loss: 2.8324, label: 0, bag_size: 600
batch 559, loss: 1.6387, instance_loss: 0.5028, weighted_loss: 1.2979, label: 2, bag_size: 1003
batch 579, loss: 1.2523, instance_loss: 0.4858, weighted_loss: 1.0224, label: 3, bag_size: 235


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.0928030303030303: correct 441/4752
Epoch: 14, train_loss: 1.2431, train_clustering_loss:  0.4730, train_error: 0.5320
class 0: acc 0.7580645161290323, correct 94/124
class 1: acc 0.4728682170542636, correct 61/129
class 2: acc 0.3181818181818182, correct 35/110
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.47107438016528924, correct 57/121

Val Set, val_loss: 1.3766, val_error: 0.5676, auc: 0.7427
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
Validation loss decreased (1.390892 --> 1.376624).  Saving model ...


batch 19, loss: 1.5830, instance_loss: 0.5225, weighted_loss: 1.2648, label: 1, bag_size: 272
batch 39, loss: 1.3840, instance_loss: 0.4987, weighted_loss: 1.1184, label: 3, bag_size: 476
batch 59, loss: 0.1759, instance_loss: 0.2978, weighted_loss: 0.2125, label: 0, bag_size: 613
batch 79, loss: 2.4495, instance_loss: 0.5082, weighted_loss: 1.8671, label: 4, bag_size: 113
batch 99, loss: 1.5001, instance_loss: 0.5289, weighted_loss: 1.2087, label: 1, bag_size: 328
batch 119, loss: 0.9391, instance_loss: 0.4034, weighted_loss: 0.7784, label: 2, bag_size: 394
batch 139, loss: 1.9313, instance_loss: 0.5481, weighted_loss: 1.5163, label: 3, bag_size: 457
batch 159, loss: 1.6922, instance_loss: 0.5751, weighted_loss: 1.3571, label: 4, bag_size: 660
batch 179, loss: 0.5762, instance_loss: 0.3958, weighted_loss: 0.5221, label: 4, bag_size: 875
batch 199, loss: 2.6072, instance_loss: 0.7151, weighted_loss: 2.0396, label: 3, bag_size: 107
batch 219, loss: 1.5534, instance_loss: 0.5462, weighted_loss: 1.2513, label: 3, bag_size: 486
batch 239, loss: 0.0531, instance_loss: 0.2136, weighted_loss: 0.1013, label: 0, bag_size: 280
batch 259, loss: 1.2582, instance_loss: 0.4747, weighted_loss: 1.0232, label: 2, bag_size: 708
batch 279, loss: 1.4641, instance_loss: 0.5348, weighted_loss: 1.1853, label: 0, bag_size: 376
batch 299, loss: 2.3773, instance_loss: 0.6581, weighted_loss: 1.8615, label: 3, bag_size: 342
batch 319, loss: 0.0524, instance_loss: 0.2026, weighted_loss: 0.0975, label: 0, bag_size: 230
batch 339, loss: 0.9420, instance_loss: 0.4436, weighted_loss: 0.7925, label: 2, bag_size: 590
batch 359, loss: 0.5893, instance_loss: 0.3521, weighted_loss: 0.5181, label: 3, bag_size: 996
batch 379, loss: 1.8596, instance_loss: 0.5833, weighted_loss: 1.4767, label: 0, bag_size: 608
batch 399, loss: 0.9197, instance_loss: 0.3991, weighted_loss: 0.7636, label: 3, bag_size: 431
batch 419, loss: 3.5895, instance_loss: 0.8409, weighted_loss: 2.7649, label: 4, bag_size: 310
batch 439, loss: 2.3606, instance_loss: 0.5374, weighted_loss: 1.8137, label: 2, bag_size: 219
batch 459, loss: 1.4441, instance_loss: 0.4487, weighted_loss: 1.1455, label: 2, bag_size: 717
batch 479, loss: 0.2948, instance_loss: 0.2446, weighted_loss: 0.2798, label: 0, bag_size: 192
batch 499, loss: 0.7516, instance_loss: 0.3069, weighted_loss: 0.6182, label: 0, bag_size: 210
batch 519, loss: 0.6636, instance_loss: 0.4594, weighted_loss: 0.6024, label: 0, bag_size: 477
batch 539, loss: 0.8511, instance_loss: 0.5062, weighted_loss: 0.7476, label: 4, bag_size: 468
batch 559, loss: 1.6008, instance_loss: 0.5657, weighted_loss: 1.2903, label: 4, bag_size: 1104
batch 579, loss: 0.8092, instance_loss: 0.4372, weighted_loss: 0.6976, label: 1, bag_size: 1013


class 0 clustering acc 0.9954545454545455: correct 23652/23760
class 1 clustering acc 0.0747053872053872: correct 355/4752
Epoch: 15, train_loss: 1.2025, train_clustering_loss:  0.4779, train_error: 0.5084
class 0: acc 0.7633587786259542, correct 100/131
class 1: acc 0.35185185185185186, correct 38/108
class 2: acc 0.3984375, correct 51/128
class 3: acc 0.36936936936936937, correct 41/111
class 4: acc 0.5344827586206896, correct 62/116

Val Set, val_loss: 1.4780, val_error: 0.5946, auc: 0.6993
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6234, instance_loss: 0.5753, weighted_loss: 1.3090, label: 2, bag_size: 554
batch 39, loss: 1.0956, instance_loss: 0.5070, weighted_loss: 0.9190, label: 2, bag_size: 96
batch 59, loss: 0.1637, instance_loss: 0.3266, weighted_loss: 0.2125, label: 0, bag_size: 77
batch 79, loss: 0.7663, instance_loss: 0.4187, weighted_loss: 0.6620, label: 2, bag_size: 852
batch 99, loss: 1.2720, instance_loss: 0.4929, weighted_loss: 1.0383, label: 3, bag_size: 453
batch 119, loss: 1.1961, instance_loss: 0.5241, weighted_loss: 0.9945, label: 3, bag_size: 364
batch 139, loss: 1.6800, instance_loss: 0.5210, weighted_loss: 1.3323, label: 2, bag_size: 744
batch 159, loss: 0.8637, instance_loss: 0.4166, weighted_loss: 0.7296, label: 1, bag_size: 960
batch 179, loss: 3.1094, instance_loss: 0.6126, weighted_loss: 2.3604, label: 0, bag_size: 745
batch 199, loss: 0.7112, instance_loss: 0.4916, weighted_loss: 0.6453, label: 4, bag_size: 263
batch 219, loss: 1.2820, instance_loss: 0.5086, weighted_loss: 1.0500, label: 4, bag_size: 250
batch 239, loss: 1.2594, instance_loss: 0.5044, weighted_loss: 1.0329, label: 2, bag_size: 783
batch 259, loss: 0.0866, instance_loss: 0.2402, weighted_loss: 0.1327, label: 0, bag_size: 159
batch 279, loss: 0.8766, instance_loss: 0.3963, weighted_loss: 0.7325, label: 0, bag_size: 343
batch 299, loss: 0.7529, instance_loss: 0.3849, weighted_loss: 0.6425, label: 1, bag_size: 617
batch 319, loss: 0.0843, instance_loss: 0.3131, weighted_loss: 0.1529, label: 0, bag_size: 188
batch 339, loss: 0.7373, instance_loss: 0.4719, weighted_loss: 0.6577, label: 3, bag_size: 432
batch 359, loss: 0.3707, instance_loss: 0.4551, weighted_loss: 0.3960, label: 3, bag_size: 403
batch 379, loss: 1.2229, instance_loss: 0.4737, weighted_loss: 0.9981, label: 4, bag_size: 490
batch 399, loss: 0.4946, instance_loss: 0.4479, weighted_loss: 0.4806, label: 0, bag_size: 238
batch 419, loss: 0.0554, instance_loss: 0.2525, weighted_loss: 0.1145, label: 0, bag_size: 70
batch 439, loss: 0.9390, instance_loss: 0.4557, weighted_loss: 0.7940, label: 3, bag_size: 393
batch 459, loss: 0.7091, instance_loss: 0.3364, weighted_loss: 0.5973, label: 1, bag_size: 1091
batch 479, loss: 1.8861, instance_loss: 0.3516, weighted_loss: 1.4258, label: 0, bag_size: 62
batch 499, loss: 0.0960, instance_loss: 0.2779, weighted_loss: 0.1506, label: 0, bag_size: 49
batch 519, loss: 2.4393, instance_loss: 0.7568, weighted_loss: 1.9346, label: 2, bag_size: 934
batch 539, loss: 0.0670, instance_loss: 0.2851, weighted_loss: 0.1324, label: 0, bag_size: 268
batch 559, loss: 1.6536, instance_loss: 0.5321, weighted_loss: 1.3171, label: 2, bag_size: 582
batch 579, loss: 1.2334, instance_loss: 0.4896, weighted_loss: 1.0103, label: 2, bag_size: 592


class 0 clustering acc 0.9958333333333333: correct 23661/23760
class 1 clustering acc 0.08733164983164983: correct 415/4752
Epoch: 16, train_loss: 1.1716, train_clustering_loss:  0.4723, train_error: 0.4949
class 0: acc 0.7794117647058824, correct 106/136
class 1: acc 0.4666666666666667, correct 56/120
class 2: acc 0.3103448275862069, correct 36/116
class 3: acc 0.48695652173913045, correct 56/115
class 4: acc 0.42990654205607476, correct 46/107

Val Set, val_loss: 1.4451, val_error: 0.6351, auc: 0.7321
class 0 clustering acc 0.9939189189189189: correct 2942/2960
class 1 clustering acc 0.13344594594594594: correct 79/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 3.4894, instance_loss: 0.7461, weighted_loss: 2.6664, label: 0, bag_size: 600
batch 39, loss: 1.6887, instance_loss: 0.4915, weighted_loss: 1.3296, label: 3, bag_size: 899
batch 59, loss: 1.0763, instance_loss: 0.4880, weighted_loss: 0.8998, label: 3, bag_size: 818
batch 79, loss: 0.8616, instance_loss: 0.4685, weighted_loss: 0.7437, label: 3, bag_size: 423
batch 99, loss: 0.5706, instance_loss: 0.4345, weighted_loss: 0.5298, label: 2, bag_size: 266
batch 119, loss: 0.8137, instance_loss: 0.4352, weighted_loss: 0.7002, label: 1, bag_size: 544
batch 139, loss: 1.6612, instance_loss: 0.6059, weighted_loss: 1.3446, label: 2, bag_size: 582
batch 159, loss: 1.2891, instance_loss: 0.5469, weighted_loss: 1.0665, label: 2, bag_size: 614
batch 179, loss: 2.1342, instance_loss: 0.5805, weighted_loss: 1.6681, label: 1, bag_size: 742
batch 199, loss: 0.3767, instance_loss: 0.3484, weighted_loss: 0.3682, label: 4, bag_size: 744
batch 219, loss: 2.3047, instance_loss: 0.5491, weighted_loss: 1.7780, label: 0, bag_size: 964
batch 239, loss: 0.1443, instance_loss: 0.4032, weighted_loss: 0.2220, label: 4, bag_size: 746
batch 259, loss: 0.8147, instance_loss: 0.4086, weighted_loss: 0.6929, label: 1, bag_size: 702
batch 279, loss: 1.4366, instance_loss: 0.5304, weighted_loss: 1.1647, label: 2, bag_size: 592
batch 299, loss: 1.0307, instance_loss: 0.4329, weighted_loss: 0.8513, label: 2, bag_size: 1230
batch 319, loss: 2.5315, instance_loss: 0.6050, weighted_loss: 1.9535, label: 3, bag_size: 1057
batch 339, loss: 1.1155, instance_loss: 0.5391, weighted_loss: 0.9425, label: 3, bag_size: 1078
batch 359, loss: 1.1980, instance_loss: 0.5469, weighted_loss: 1.0027, label: 3, bag_size: 804
batch 379, loss: 1.4108, instance_loss: 0.4933, weighted_loss: 1.1356, label: 4, bag_size: 685
batch 399, loss: 1.1483, instance_loss: 0.4967, weighted_loss: 0.9529, label: 3, bag_size: 457
batch 419, loss: 1.1886, instance_loss: 0.7342, weighted_loss: 1.0523, label: 1, bag_size: 311
batch 439, loss: 1.5376, instance_loss: 0.5229, weighted_loss: 1.2332, label: 4, bag_size: 293
batch 459, loss: 0.9364, instance_loss: 0.3732, weighted_loss: 0.7675, label: 3, bag_size: 451
batch 479, loss: 1.4136, instance_loss: 0.5312, weighted_loss: 1.1488, label: 4, bag_size: 699
batch 499, loss: 2.1003, instance_loss: 0.6063, weighted_loss: 1.6521, label: 2, bag_size: 597
batch 519, loss: 0.6901, instance_loss: 0.5421, weighted_loss: 0.6457, label: 1, bag_size: 161
batch 539, loss: 0.6575, instance_loss: 0.5669, weighted_loss: 0.6303, label: 2, bag_size: 590
batch 559, loss: 0.7310, instance_loss: 0.4260, weighted_loss: 0.6395, label: 3, bag_size: 274
batch 579, loss: 1.9601, instance_loss: 0.6704, weighted_loss: 1.5732, label: 2, bag_size: 96


class 0 clustering acc 0.994486531986532: correct 23629/23760
class 1 clustering acc 0.07323232323232323: correct 348/4752
Epoch: 17, train_loss: 1.2123, train_clustering_loss:  0.4783, train_error: 0.5101
class 0: acc 0.717948717948718, correct 84/117
class 1: acc 0.37272727272727274, correct 41/110
class 2: acc 0.40458015267175573, correct 53/131
class 3: acc 0.5238095238095238, correct 66/126
class 4: acc 0.42727272727272725, correct 47/110

Val Set, val_loss: 1.3729, val_error: 0.5541, auc: 0.7602
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.08277027027027027: correct 49/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.376624 --> 1.372893).  Saving model ...


batch 19, loss: 2.3273, instance_loss: 0.5649, weighted_loss: 1.7986, label: 3, bag_size: 342
batch 39, loss: 0.8423, instance_loss: 0.4275, weighted_loss: 0.7178, label: 3, bag_size: 274
batch 59, loss: 1.0337, instance_loss: 0.5043, weighted_loss: 0.8749, label: 1, bag_size: 702
batch 79, loss: 2.3122, instance_loss: 0.6000, weighted_loss: 1.7986, label: 4, bag_size: 730
batch 99, loss: 1.6609, instance_loss: 0.5948, weighted_loss: 1.3410, label: 0, bag_size: 879
batch 119, loss: 0.1076, instance_loss: 0.1971, weighted_loss: 0.1344, label: 0, bag_size: 393
batch 139, loss: 0.7891, instance_loss: 0.4418, weighted_loss: 0.6849, label: 1, bag_size: 960
batch 159, loss: 1.2304, instance_loss: 0.5833, weighted_loss: 1.0363, label: 1, bag_size: 208
batch 179, loss: 1.0450, instance_loss: 0.4302, weighted_loss: 0.8606, label: 3, bag_size: 615
batch 199, loss: 0.6172, instance_loss: 0.4518, weighted_loss: 0.5676, label: 4, bag_size: 1041
batch 219, loss: 0.6957, instance_loss: 0.4470, weighted_loss: 0.6211, label: 0, bag_size: 122
batch 239, loss: 0.7623, instance_loss: 0.4333, weighted_loss: 0.6636, label: 1, bag_size: 1103
batch 259, loss: 1.4042, instance_loss: 0.5315, weighted_loss: 1.1424, label: 2, bag_size: 522
batch 279, loss: 1.1905, instance_loss: 0.4554, weighted_loss: 0.9700, label: 3, bag_size: 857
batch 299, loss: 1.5918, instance_loss: 0.6202, weighted_loss: 1.3003, label: 3, bag_size: 192
batch 319, loss: 1.8382, instance_loss: 0.5381, weighted_loss: 1.4482, label: 1, bag_size: 851
batch 339, loss: 1.2903, instance_loss: 0.4762, weighted_loss: 1.0461, label: 3, bag_size: 818
batch 359, loss: 1.5773, instance_loss: 0.5440, weighted_loss: 1.2673, label: 4, bag_size: 196
batch 379, loss: 0.8043, instance_loss: 0.3947, weighted_loss: 0.6815, label: 3, bag_size: 727
batch 399, loss: 1.0800, instance_loss: 0.4906, weighted_loss: 0.9032, label: 2, bag_size: 489
batch 419, loss: 2.0110, instance_loss: 0.4669, weighted_loss: 1.5478, label: 1, bag_size: 988
batch 439, loss: 0.6648, instance_loss: 0.4466, weighted_loss: 0.5994, label: 2, bag_size: 176
batch 459, loss: 1.7871, instance_loss: 0.5613, weighted_loss: 1.4194, label: 0, bag_size: 243
batch 479, loss: 1.3028, instance_loss: 0.4738, weighted_loss: 1.0541, label: 4, bag_size: 868
batch 499, loss: 1.1812, instance_loss: 0.4693, weighted_loss: 0.9676, label: 2, bag_size: 864
batch 519, loss: 1.0921, instance_loss: 0.4982, weighted_loss: 0.9139, label: 1, bag_size: 605
batch 539, loss: 1.9237, instance_loss: 0.5455, weighted_loss: 1.5102, label: 1, bag_size: 591
batch 559, loss: 1.0863, instance_loss: 0.4208, weighted_loss: 0.8866, label: 3, bag_size: 556
batch 579, loss: 1.8912, instance_loss: 0.5254, weighted_loss: 1.4815, label: 2, bag_size: 421


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.07386363636363637: correct 351/4752
Epoch: 18, train_loss: 1.1827, train_clustering_loss:  0.4734, train_error: 0.4899
class 0: acc 0.7419354838709677, correct 92/124
class 1: acc 0.5619834710743802, correct 68/121
class 2: acc 0.29245283018867924, correct 31/106
class 3: acc 0.42857142857142855, correct 54/126
class 4: acc 0.49572649572649574, correct 58/117

Val Set, val_loss: 1.3428, val_error: 0.5541, auc: 0.7491
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.08783783783783784: correct 52/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.372893 --> 1.342843).  Saving model ...


batch 19, loss: 1.0306, instance_loss: 0.6986, weighted_loss: 0.9310, label: 2, bag_size: 549
batch 39, loss: 1.0014, instance_loss: 0.5052, weighted_loss: 0.8525, label: 2, bag_size: 208
batch 59, loss: 0.0522, instance_loss: 0.4836, weighted_loss: 0.1816, label: 4, bag_size: 530
batch 79, loss: 2.4166, instance_loss: 0.6900, weighted_loss: 1.8986, label: 4, bag_size: 886
batch 99, loss: 0.2449, instance_loss: 0.3711, weighted_loss: 0.2828, label: 2, bag_size: 567
batch 119, loss: 1.1951, instance_loss: 0.5916, weighted_loss: 1.0140, label: 3, bag_size: 956
batch 139, loss: 0.1417, instance_loss: 0.2955, weighted_loss: 0.1879, label: 0, bag_size: 351
batch 159, loss: 0.9884, instance_loss: 0.6520, weighted_loss: 0.8875, label: 0, bag_size: 732
batch 179, loss: 1.0541, instance_loss: 0.6143, weighted_loss: 0.9222, label: 3, bag_size: 1001
batch 199, loss: 1.2966, instance_loss: 0.4572, weighted_loss: 1.0448, label: 1, bag_size: 949
batch 219, loss: 1.3850, instance_loss: 0.4950, weighted_loss: 1.1180, label: 2, bag_size: 576
batch 239, loss: 1.3954, instance_loss: 0.6530, weighted_loss: 1.1727, label: 2, bag_size: 96
batch 259, loss: 0.8737, instance_loss: 0.4820, weighted_loss: 0.7562, label: 1, bag_size: 106
batch 279, loss: 2.3823, instance_loss: 0.5997, weighted_loss: 1.8476, label: 0, bag_size: 367
batch 299, loss: 2.7948, instance_loss: 0.6626, weighted_loss: 2.1551, label: 0, bag_size: 243
batch 319, loss: 1.4157, instance_loss: 0.4881, weighted_loss: 1.1374, label: 2, bag_size: 614
batch 339, loss: 0.9698, instance_loss: 0.4887, weighted_loss: 0.8255, label: 2, bag_size: 754
batch 359, loss: 0.3431, instance_loss: 0.3475, weighted_loss: 0.3444, label: 3, bag_size: 344
batch 379, loss: 0.6821, instance_loss: 0.3666, weighted_loss: 0.5875, label: 3, bag_size: 996
batch 399, loss: 1.3206, instance_loss: 0.5154, weighted_loss: 1.0790, label: 2, bag_size: 549
batch 419, loss: 2.4360, instance_loss: 0.5883, weighted_loss: 1.8817, label: 1, bag_size: 764
batch 439, loss: 1.5427, instance_loss: 0.5218, weighted_loss: 1.2364, label: 1, bag_size: 311
batch 459, loss: 1.5026, instance_loss: 0.5238, weighted_loss: 1.2089, label: 2, bag_size: 522
batch 479, loss: 1.6648, instance_loss: 0.5322, weighted_loss: 1.3250, label: 4, bag_size: 506
batch 499, loss: 1.5128, instance_loss: 0.5099, weighted_loss: 1.2119, label: 3, bag_size: 1060
batch 519, loss: 3.1384, instance_loss: 0.6460, weighted_loss: 2.3907, label: 2, bag_size: 519
batch 539, loss: 2.9882, instance_loss: 0.5944, weighted_loss: 2.2701, label: 1, bag_size: 361
batch 559, loss: 0.5701, instance_loss: 0.4439, weighted_loss: 0.5322, label: 4, bag_size: 489
batch 579, loss: 2.1220, instance_loss: 0.5260, weighted_loss: 1.6432, label: 4, bag_size: 438


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.08712121212121213: correct 414/4752
Epoch: 19, train_loss: 1.1394, train_clustering_loss:  0.4712, train_error: 0.5017
class 0: acc 0.8, correct 88/110
class 1: acc 0.5793103448275863, correct 84/145
class 2: acc 0.26956521739130435, correct 31/115
class 3: acc 0.41379310344827586, correct 48/116
class 4: acc 0.4166666666666667, correct 45/108

Val Set, val_loss: 1.3639, val_error: 0.5541, auc: 0.7417
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1633, instance_loss: 0.2540, weighted_loss: 0.1905, label: 0, bag_size: 77
batch 39, loss: 1.4428, instance_loss: 0.6746, weighted_loss: 1.2124, label: 2, bag_size: 171
batch 59, loss: 0.0983, instance_loss: 0.1896, weighted_loss: 0.1257, label: 0, bag_size: 285
batch 79, loss: 0.3079, instance_loss: 0.3733, weighted_loss: 0.3275, label: 0, bag_size: 74
batch 99, loss: 0.3830, instance_loss: 0.3741, weighted_loss: 0.3804, label: 4, bag_size: 744
batch 119, loss: 1.4380, instance_loss: 0.5526, weighted_loss: 1.1724, label: 3, bag_size: 598
batch 139, loss: 0.0420, instance_loss: 0.1522, weighted_loss: 0.0751, label: 0, bag_size: 285
batch 159, loss: 0.6957, instance_loss: 0.3608, weighted_loss: 0.5953, label: 3, bag_size: 894
batch 179, loss: 1.4425, instance_loss: 0.5324, weighted_loss: 1.1695, label: 3, bag_size: 451
batch 199, loss: 0.0573, instance_loss: 0.2313, weighted_loss: 0.1095, label: 0, bag_size: 15
batch 219, loss: 2.9649, instance_loss: 0.9010, weighted_loss: 2.3457, label: 1, bag_size: 45
batch 239, loss: 1.0600, instance_loss: 0.4189, weighted_loss: 0.8677, label: 1, bag_size: 1009
batch 259, loss: 3.0263, instance_loss: 0.9139, weighted_loss: 2.3926, label: 2, bag_size: 258
batch 279, loss: 0.5386, instance_loss: 0.3907, weighted_loss: 0.4942, label: 3, bag_size: 272
batch 299, loss: 2.9774, instance_loss: 0.6953, weighted_loss: 2.2928, label: 2, bag_size: 394
batch 319, loss: 1.7583, instance_loss: 0.6239, weighted_loss: 1.4180, label: 1, bag_size: 272
batch 339, loss: 0.0892, instance_loss: 0.6389, weighted_loss: 0.2541, label: 4, bag_size: 541
batch 359, loss: 1.7879, instance_loss: 0.6078, weighted_loss: 1.4339, label: 2, bag_size: 582
batch 379, loss: 1.5995, instance_loss: 0.5523, weighted_loss: 1.2854, label: 1, bag_size: 321
batch 399, loss: 1.0262, instance_loss: 0.4676, weighted_loss: 0.8586, label: 3, bag_size: 472
batch 419, loss: 0.2265, instance_loss: 0.3708, weighted_loss: 0.2698, label: 0, bag_size: 351
batch 439, loss: 0.7033, instance_loss: 0.4077, weighted_loss: 0.6146, label: 4, bag_size: 773
batch 459, loss: 0.4877, instance_loss: 0.4736, weighted_loss: 0.4835, label: 0, bag_size: 317
batch 479, loss: 0.7800, instance_loss: 0.3801, weighted_loss: 0.6600, label: 3, bag_size: 472
batch 499, loss: 0.8301, instance_loss: 0.4143, weighted_loss: 0.7054, label: 4, bag_size: 1077
batch 519, loss: 1.6012, instance_loss: 0.5810, weighted_loss: 1.2952, label: 4, bag_size: 1104
batch 539, loss: 0.0039, instance_loss: 0.7453, weighted_loss: 0.2264, label: 2, bag_size: 596
batch 559, loss: 2.5717, instance_loss: 0.7234, weighted_loss: 2.0172, label: 1, bag_size: 272
batch 579, loss: 1.2203, instance_loss: 0.5496, weighted_loss: 1.0191, label: 1, bag_size: 410


class 0 clustering acc 0.9949074074074075: correct 23639/23760
class 1 clustering acc 0.1151094276094276: correct 547/4752
Epoch: 20, train_loss: 1.0934, train_clustering_loss:  0.4561, train_error: 0.4731
class 0: acc 0.8029197080291971, correct 110/137
class 1: acc 0.38181818181818183, correct 42/110
class 2: acc 0.3431372549019608, correct 35/102
class 3: acc 0.5572519083969466, correct 73/131
class 4: acc 0.4649122807017544, correct 53/114

Val Set, val_loss: 1.4240, val_error: 0.5541, auc: 0.7506
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.1097972972972973: correct 65/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0393, instance_loss: 0.4351, weighted_loss: 0.8581, label: 3, bag_size: 1154
batch 39, loss: 0.9269, instance_loss: 0.7053, weighted_loss: 0.8604, label: 2, bag_size: 286
batch 59, loss: 1.2168, instance_loss: 0.4904, weighted_loss: 0.9989, label: 4, bag_size: 685
batch 79, loss: 0.7792, instance_loss: 0.4450, weighted_loss: 0.6790, label: 3, bag_size: 858
batch 99, loss: 0.7036, instance_loss: 0.4000, weighted_loss: 0.6125, label: 1, bag_size: 766
batch 119, loss: 4.4648, instance_loss: 0.8957, weighted_loss: 3.3941, label: 0, bag_size: 370
batch 139, loss: 0.7889, instance_loss: 0.5535, weighted_loss: 0.7183, label: 2, bag_size: 1010
batch 159, loss: 0.4165, instance_loss: 0.4454, weighted_loss: 0.4252, label: 4, bag_size: 1158
batch 179, loss: 0.9598, instance_loss: 0.4910, weighted_loss: 0.8192, label: 3, bag_size: 1060
batch 199, loss: 1.0260, instance_loss: 0.4337, weighted_loss: 0.8484, label: 3, bag_size: 235
batch 219, loss: 0.8690, instance_loss: 0.4853, weighted_loss: 0.7539, label: 2, bag_size: 1066
batch 239, loss: 1.1056, instance_loss: 0.4382, weighted_loss: 0.9054, label: 2, bag_size: 659
batch 259, loss: 1.4120, instance_loss: 0.5263, weighted_loss: 1.1463, label: 4, bag_size: 318
batch 279, loss: 1.1535, instance_loss: 0.4907, weighted_loss: 0.9547, label: 3, bag_size: 192
batch 299, loss: 2.0577, instance_loss: 0.5165, weighted_loss: 1.5953, label: 4, bag_size: 318
batch 319, loss: 0.1139, instance_loss: 0.2444, weighted_loss: 0.1530, label: 0, bag_size: 573
batch 339, loss: 0.1185, instance_loss: 0.1530, weighted_loss: 0.1289, label: 0, bag_size: 513
batch 359, loss: 0.5278, instance_loss: 0.4198, weighted_loss: 0.4954, label: 0, bag_size: 404
batch 379, loss: 1.2267, instance_loss: 0.4785, weighted_loss: 1.0023, label: 3, bag_size: 663
batch 399, loss: 0.9961, instance_loss: 0.4696, weighted_loss: 0.8381, label: 3, bag_size: 97
batch 419, loss: 0.5239, instance_loss: 0.3991, weighted_loss: 0.4865, label: 4, bag_size: 1158
batch 439, loss: 0.6480, instance_loss: 0.4177, weighted_loss: 0.5789, label: 3, bag_size: 608
batch 459, loss: 0.2509, instance_loss: 0.2483, weighted_loss: 0.2501, label: 0, bag_size: 306
batch 479, loss: 1.0141, instance_loss: 0.4317, weighted_loss: 0.8394, label: 2, bag_size: 597
batch 499, loss: 1.1039, instance_loss: 0.5341, weighted_loss: 0.9329, label: 1, bag_size: 233
batch 519, loss: 1.1959, instance_loss: 0.4653, weighted_loss: 0.9767, label: 1, bag_size: 1019
batch 539, loss: 0.9808, instance_loss: 0.4535, weighted_loss: 0.8226, label: 1, bag_size: 960
batch 559, loss: 0.6071, instance_loss: 0.3690, weighted_loss: 0.5357, label: 1, bag_size: 1273
batch 579, loss: 0.7869, instance_loss: 0.4682, weighted_loss: 0.6913, label: 3, bag_size: 956


class 0 clustering acc 0.9936868686868687: correct 23610/23760
class 1 clustering acc 0.09553872053872053: correct 454/4752
Epoch: 21, train_loss: 1.1620, train_clustering_loss:  0.4736, train_error: 0.4899
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.41739130434782606, correct 48/115
class 2: acc 0.4375, correct 56/128
class 3: acc 0.47368421052631576, correct 54/114
class 4: acc 0.4224137931034483, correct 49/116

Val Set, val_loss: 1.4257, val_error: 0.5541, auc: 0.7333
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0516, instance_loss: 0.5667, weighted_loss: 0.9061, label: 3, bag_size: 393
batch 39, loss: 1.3312, instance_loss: 0.5282, weighted_loss: 1.0903, label: 1, bag_size: 928
batch 59, loss: 1.0140, instance_loss: 0.4603, weighted_loss: 0.8479, label: 1, bag_size: 949
batch 79, loss: 1.8309, instance_loss: 0.4559, weighted_loss: 1.4184, label: 2, bag_size: 367
batch 99, loss: 1.8823, instance_loss: 0.5095, weighted_loss: 1.4705, label: 3, bag_size: 149
batch 119, loss: 1.2454, instance_loss: 0.5289, weighted_loss: 1.0304, label: 3, bag_size: 804
batch 139, loss: 2.1758, instance_loss: 0.5579, weighted_loss: 1.6905, label: 1, bag_size: 616
batch 159, loss: 2.0743, instance_loss: 0.6062, weighted_loss: 1.6338, label: 1, bag_size: 1023
batch 179, loss: 1.9817, instance_loss: 0.6133, weighted_loss: 1.5712, label: 4, bag_size: 342
batch 199, loss: 0.0000, instance_loss: 0.5289, weighted_loss: 0.1587, label: 2, bag_size: 553
batch 219, loss: 0.2442, instance_loss: 0.4601, weighted_loss: 0.3090, label: 4, bag_size: 541
batch 239, loss: 0.4552, instance_loss: 0.3909, weighted_loss: 0.4359, label: 4, bag_size: 1018
batch 259, loss: 1.1926, instance_loss: 0.4541, weighted_loss: 0.9711, label: 2, bag_size: 616
batch 279, loss: 1.2743, instance_loss: 0.5439, weighted_loss: 1.0552, label: 3, bag_size: 459
batch 299, loss: 1.0947, instance_loss: 0.4923, weighted_loss: 0.9140, label: 3, bag_size: 1232
batch 319, loss: 0.9262, instance_loss: 0.4567, weighted_loss: 0.7853, label: 2, bag_size: 258
batch 339, loss: 1.1126, instance_loss: 0.4685, weighted_loss: 0.9193, label: 1, bag_size: 332
batch 359, loss: 1.0121, instance_loss: 0.5327, weighted_loss: 0.8683, label: 1, bag_size: 874
batch 379, loss: 1.7048, instance_loss: 0.5729, weighted_loss: 1.3652, label: 2, bag_size: 361
batch 399, loss: 0.8874, instance_loss: 0.4504, weighted_loss: 0.7563, label: 2, bag_size: 616
batch 419, loss: 1.4779, instance_loss: 0.5186, weighted_loss: 1.1901, label: 0, bag_size: 277
batch 439, loss: 0.9209, instance_loss: 0.5078, weighted_loss: 0.7970, label: 3, bag_size: 351
batch 459, loss: 0.8113, instance_loss: 0.4809, weighted_loss: 0.7122, label: 1, bag_size: 381
batch 479, loss: 0.4178, instance_loss: 0.3871, weighted_loss: 0.4086, label: 3, bag_size: 154
batch 499, loss: 3.9142, instance_loss: 0.8052, weighted_loss: 2.9815, label: 0, bag_size: 273
batch 519, loss: 0.0499, instance_loss: 0.4953, weighted_loss: 0.1835, label: 4, bag_size: 530
batch 539, loss: 1.0938, instance_loss: 0.4743, weighted_loss: 0.9080, label: 3, bag_size: 781
batch 559, loss: 1.9026, instance_loss: 0.4922, weighted_loss: 1.4795, label: 2, bag_size: 627
batch 579, loss: 2.0721, instance_loss: 0.5437, weighted_loss: 1.6136, label: 4, bag_size: 482


class 0 clustering acc 0.9955387205387205: correct 23654/23760
class 1 clustering acc 0.06313131313131314: correct 300/4752
Epoch: 22, train_loss: 1.1574, train_clustering_loss:  0.4762, train_error: 0.4848
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.5348837209302325, correct 69/129
class 2: acc 0.325, correct 39/120
class 3: acc 0.45689655172413796, correct 53/116
class 4: acc 0.4537037037037037, correct 49/108

Val Set, val_loss: 1.3841, val_error: 0.5811, auc: 0.7367
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.08783783783783784: correct 52/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1168, instance_loss: 0.5203, weighted_loss: 0.9378, label: 2, bag_size: 616
batch 39, loss: 0.4514, instance_loss: 0.3102, weighted_loss: 0.4091, label: 3, bag_size: 309
batch 59, loss: 1.0740, instance_loss: 0.4639, weighted_loss: 0.8910, label: 1, bag_size: 408
batch 79, loss: 3.1629, instance_loss: 0.6799, weighted_loss: 2.4180, label: 2, bag_size: 394
batch 99, loss: 1.9636, instance_loss: 0.5845, weighted_loss: 1.5499, label: 4, bag_size: 264
batch 119, loss: 0.0720, instance_loss: 0.2821, weighted_loss: 0.1351, label: 0, bag_size: 37
batch 139, loss: 2.5295, instance_loss: 0.5810, weighted_loss: 1.9450, label: 3, bag_size: 282
batch 159, loss: 1.4794, instance_loss: 0.4888, weighted_loss: 1.1822, label: 0, bag_size: 428
batch 179, loss: 2.5537, instance_loss: 0.6229, weighted_loss: 1.9745, label: 3, bag_size: 342
batch 199, loss: 1.9455, instance_loss: 0.5581, weighted_loss: 1.5293, label: 2, bag_size: 864
batch 219, loss: 0.1324, instance_loss: 0.2945, weighted_loss: 0.1810, label: 0, bag_size: 517
batch 239, loss: 1.5510, instance_loss: 0.4793, weighted_loss: 1.2295, label: 4, bag_size: 1104
batch 259, loss: 1.9448, instance_loss: 0.5701, weighted_loss: 1.5324, label: 2, bag_size: 627
batch 279, loss: 0.0000, instance_loss: 0.3427, weighted_loss: 0.1028, label: 2, bag_size: 553
batch 299, loss: 2.0451, instance_loss: 0.5890, weighted_loss: 1.6083, label: 1, bag_size: 350
batch 319, loss: 0.5275, instance_loss: 0.4063, weighted_loss: 0.4911, label: 4, bag_size: 744
batch 339, loss: 0.4024, instance_loss: 0.3438, weighted_loss: 0.3848, label: 4, bag_size: 1041
batch 359, loss: 0.6538, instance_loss: 0.4905, weighted_loss: 0.6048, label: 4, bag_size: 129
batch 379, loss: 0.3120, instance_loss: 0.2942, weighted_loss: 0.3066, label: 0, bag_size: 702
batch 399, loss: 1.9731, instance_loss: 0.4855, weighted_loss: 1.5268, label: 1, bag_size: 1023
batch 419, loss: 1.7484, instance_loss: 0.4180, weighted_loss: 1.3493, label: 3, bag_size: 556
batch 439, loss: 0.0028, instance_loss: 0.1263, weighted_loss: 0.0398, label: 0, bag_size: 706
batch 459, loss: 1.5328, instance_loss: 0.4939, weighted_loss: 1.2211, label: 2, bag_size: 717
batch 479, loss: 1.4835, instance_loss: 0.5157, weighted_loss: 1.1932, label: 1, bag_size: 1023
batch 499, loss: 1.0639, instance_loss: 0.4042, weighted_loss: 0.8660, label: 2, bag_size: 864
batch 519, loss: 0.9746, instance_loss: 0.4195, weighted_loss: 0.8081, label: 1, bag_size: 960
batch 539, loss: 0.0593, instance_loss: 0.3045, weighted_loss: 0.1329, label: 0, bag_size: 103
batch 559, loss: 0.9462, instance_loss: 0.5281, weighted_loss: 0.8208, label: 3, bag_size: 98
batch 579, loss: 1.1552, instance_loss: 0.4109, weighted_loss: 0.9319, label: 1, bag_size: 311


class 0 clustering acc 0.9954545454545455: correct 23652/23760
class 1 clustering acc 0.0683922558922559: correct 325/4752
Epoch: 23, train_loss: 1.1068, train_clustering_loss:  0.4672, train_error: 0.4276
class 0: acc 0.7807017543859649, correct 89/114
class 1: acc 0.5447154471544715, correct 67/123
class 2: acc 0.35, correct 42/120
class 3: acc 0.6641221374045801, correct 87/131
class 4: acc 0.5188679245283019, correct 55/106

Val Set, val_loss: 1.4235, val_error: 0.5946, auc: 0.7511
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.1097972972972973: correct 65/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0570, instance_loss: 0.5058, weighted_loss: 0.8916, label: 3, bag_size: 818
batch 39, loss: 0.6480, instance_loss: 0.4769, weighted_loss: 0.5967, label: 4, bag_size: 627
batch 59, loss: 0.3514, instance_loss: 0.3779, weighted_loss: 0.3593, label: 2, bag_size: 690
batch 79, loss: 0.7105, instance_loss: 0.5338, weighted_loss: 0.6575, label: 2, bag_size: 543
batch 99, loss: 1.0144, instance_loss: 0.4273, weighted_loss: 0.8383, label: 3, bag_size: 102
batch 119, loss: 1.1678, instance_loss: 0.4458, weighted_loss: 0.9512, label: 1, bag_size: 981
batch 139, loss: 0.6450, instance_loss: 0.4410, weighted_loss: 0.5838, label: 3, bag_size: 872
batch 159, loss: 1.6836, instance_loss: 0.6275, weighted_loss: 1.3667, label: 4, bag_size: 886
batch 179, loss: 1.1795, instance_loss: 0.4559, weighted_loss: 0.9624, label: 2, bag_size: 754
batch 199, loss: 1.7081, instance_loss: 0.5317, weighted_loss: 1.3552, label: 1, bag_size: 599
batch 219, loss: 1.0780, instance_loss: 0.4561, weighted_loss: 0.8914, label: 3, bag_size: 1021
batch 239, loss: 0.9841, instance_loss: 0.4455, weighted_loss: 0.8225, label: 2, bag_size: 119
batch 259, loss: 0.0822, instance_loss: 0.2452, weighted_loss: 0.1311, label: 0, bag_size: 74
batch 279, loss: 1.7017, instance_loss: 0.6810, weighted_loss: 1.3954, label: 3, bag_size: 505
batch 299, loss: 0.2028, instance_loss: 0.4183, weighted_loss: 0.2674, label: 0, bag_size: 642
batch 319, loss: 2.9411, instance_loss: 0.6260, weighted_loss: 2.2466, label: 4, bag_size: 264
batch 339, loss: 0.9707, instance_loss: 0.4816, weighted_loss: 0.8239, label: 1, bag_size: 949
batch 359, loss: 1.1767, instance_loss: 0.4268, weighted_loss: 0.9517, label: 3, bag_size: 615
batch 379, loss: 0.5802, instance_loss: 0.3937, weighted_loss: 0.5243, label: 3, bag_size: 459
batch 399, loss: 1.7347, instance_loss: 0.5107, weighted_loss: 1.3675, label: 4, bag_size: 685
batch 419, loss: 1.6305, instance_loss: 0.6153, weighted_loss: 1.3259, label: 2, bag_size: 860
batch 439, loss: 0.9816, instance_loss: 0.4605, weighted_loss: 0.8253, label: 1, bag_size: 389
batch 459, loss: 0.2718, instance_loss: 0.4102, weighted_loss: 0.3133, label: 4, bag_size: 773
batch 479, loss: 0.6009, instance_loss: 0.4115, weighted_loss: 0.5441, label: 1, bag_size: 161
batch 499, loss: 0.3750, instance_loss: 0.2711, weighted_loss: 0.3438, label: 4, bag_size: 266
batch 519, loss: 0.9687, instance_loss: 0.4523, weighted_loss: 0.8138, label: 3, bag_size: 337
batch 539, loss: 0.0620, instance_loss: 0.1551, weighted_loss: 0.0899, label: 0, bag_size: 212
batch 559, loss: 0.0837, instance_loss: 0.1625, weighted_loss: 0.1074, label: 0, bag_size: 188
batch 579, loss: 0.9173, instance_loss: 0.5006, weighted_loss: 0.7922, label: 2, bag_size: 375


class 0 clustering acc 0.9949915824915825: correct 23641/23760
class 1 clustering acc 0.10101010101010101: correct 480/4752
Epoch: 24, train_loss: 1.1265, train_clustering_loss:  0.4628, train_error: 0.4983
class 0: acc 0.8125, correct 104/128
class 1: acc 0.39316239316239315, correct 46/117
class 2: acc 0.3486238532110092, correct 38/109
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.48412698412698413, correct 61/126

Val Set, val_loss: 1.4301, val_error: 0.5676, auc: 0.7444
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.10641891891891891: correct 63/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0362, instance_loss: 0.1395, weighted_loss: 0.0671, label: 0, bag_size: 397
batch 39, loss: 0.9453, instance_loss: 0.4571, weighted_loss: 0.7988, label: 4, bag_size: 944
batch 59, loss: 1.7615, instance_loss: 0.4812, weighted_loss: 1.3774, label: 1, bag_size: 742
batch 79, loss: 0.7243, instance_loss: 0.4397, weighted_loss: 0.6389, label: 2, bag_size: 315
batch 99, loss: 0.5051, instance_loss: 0.4084, weighted_loss: 0.4761, label: 3, bag_size: 322
batch 119, loss: 0.4645, instance_loss: 0.3957, weighted_loss: 0.4438, label: 3, bag_size: 996
batch 139, loss: 0.0409, instance_loss: 0.2235, weighted_loss: 0.0957, label: 0, bag_size: 702
batch 159, loss: 0.5834, instance_loss: 0.3565, weighted_loss: 0.5154, label: 3, bag_size: 928
batch 179, loss: 1.3954, instance_loss: 0.6971, weighted_loss: 1.1859, label: 3, bag_size: 543
batch 199, loss: 0.1049, instance_loss: 0.2799, weighted_loss: 0.1574, label: 4, bag_size: 124
batch 219, loss: 1.9977, instance_loss: 0.6007, weighted_loss: 1.5786, label: 1, bag_size: 591
batch 239, loss: 1.8265, instance_loss: 0.5624, weighted_loss: 1.4472, label: 0, bag_size: 277
batch 259, loss: 0.0109, instance_loss: 0.1338, weighted_loss: 0.0478, label: 0, bag_size: 706
batch 279, loss: 0.6702, instance_loss: 0.4545, weighted_loss: 0.6055, label: 4, bag_size: 886
batch 299, loss: 0.8466, instance_loss: 0.4092, weighted_loss: 0.7154, label: 3, bag_size: 258
batch 319, loss: 2.7306, instance_loss: 0.7741, weighted_loss: 2.1436, label: 1, bag_size: 272
batch 339, loss: 1.3706, instance_loss: 0.5109, weighted_loss: 1.1127, label: 2, bag_size: 421
batch 359, loss: 1.5843, instance_loss: 0.5601, weighted_loss: 1.2770, label: 0, bag_size: 178
batch 379, loss: 1.9081, instance_loss: 0.5180, weighted_loss: 1.4911, label: 1, bag_size: 272
batch 399, loss: 0.9310, instance_loss: 0.4675, weighted_loss: 0.7919, label: 1, bag_size: 500
batch 419, loss: 0.1584, instance_loss: 0.3019, weighted_loss: 0.2014, label: 4, bag_size: 773
batch 439, loss: 1.0477, instance_loss: 0.3946, weighted_loss: 0.8518, label: 4, bag_size: 482
batch 459, loss: 0.5048, instance_loss: 0.3744, weighted_loss: 0.4657, label: 1, bag_size: 829
batch 479, loss: 2.4291, instance_loss: 0.5869, weighted_loss: 1.8764, label: 3, bag_size: 166
batch 499, loss: 1.5948, instance_loss: 0.5302, weighted_loss: 1.2754, label: 3, bag_size: 556
batch 519, loss: 0.7202, instance_loss: 0.4730, weighted_loss: 0.6461, label: 3, bag_size: 804
batch 539, loss: 0.2799, instance_loss: 0.2213, weighted_loss: 0.2623, label: 0, bag_size: 573
batch 559, loss: 1.1549, instance_loss: 0.5340, weighted_loss: 0.9687, label: 3, bag_size: 608
batch 579, loss: 0.5721, instance_loss: 0.4106, weighted_loss: 0.5237, label: 3, bag_size: 956


class 0 clustering acc 0.9929713804713804: correct 23593/23760
class 1 clustering acc 0.12815656565656566: correct 609/4752
Epoch: 25, train_loss: 1.1012, train_clustering_loss:  0.4563, train_error: 0.4478
class 0: acc 0.7829457364341085, correct 101/129
class 1: acc 0.4915254237288136, correct 58/118
class 2: acc 0.3865546218487395, correct 46/119
class 3: acc 0.5555555555555556, correct 65/117
class 4: acc 0.5225225225225225, correct 58/111

Val Set, val_loss: 1.3064, val_error: 0.5270, auc: 0.7806
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.08445945945945946: correct 50/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.342843 --> 1.306411).  Saving model ...


batch 19, loss: 0.2121, instance_loss: 0.3623, weighted_loss: 0.2572, label: 4, bag_size: 986
batch 39, loss: 3.3747, instance_loss: 0.8544, weighted_loss: 2.6186, label: 0, bag_size: 370
batch 59, loss: 0.2517, instance_loss: 0.2425, weighted_loss: 0.2489, label: 0, bag_size: 478
batch 79, loss: 0.9207, instance_loss: 0.6128, weighted_loss: 0.8283, label: 1, bag_size: 1082
batch 99, loss: 1.0806, instance_loss: 0.4513, weighted_loss: 0.8918, label: 1, bag_size: 855
batch 119, loss: 0.2004, instance_loss: 0.4460, weighted_loss: 0.2741, label: 1, bag_size: 371
batch 139, loss: 0.4917, instance_loss: 0.3948, weighted_loss: 0.4627, label: 1, bag_size: 271
batch 159, loss: 0.1444, instance_loss: 0.7438, weighted_loss: 0.3242, label: 4, bag_size: 530
batch 179, loss: 0.1936, instance_loss: 0.2482, weighted_loss: 0.2100, label: 0, bag_size: 210
batch 199, loss: 0.7201, instance_loss: 0.3575, weighted_loss: 0.6113, label: 4, bag_size: 755
batch 219, loss: 1.2500, instance_loss: 0.5432, weighted_loss: 1.0380, label: 3, bag_size: 457
batch 239, loss: 2.4583, instance_loss: 0.5731, weighted_loss: 1.8927, label: 2, bag_size: 1060
batch 259, loss: 0.9860, instance_loss: 0.4518, weighted_loss: 0.8258, label: 4, bag_size: 618
batch 279, loss: 0.0689, instance_loss: 0.3014, weighted_loss: 0.1386, label: 0, bag_size: 15
batch 299, loss: 0.5500, instance_loss: 0.4758, weighted_loss: 0.5278, label: 2, bag_size: 571
batch 319, loss: 0.5558, instance_loss: 0.4373, weighted_loss: 0.5202, label: 2, bag_size: 337
batch 339, loss: 2.2048, instance_loss: 0.6294, weighted_loss: 1.7322, label: 0, bag_size: 600
batch 359, loss: 1.7074, instance_loss: 0.5584, weighted_loss: 1.3627, label: 1, bag_size: 616
batch 379, loss: 1.0145, instance_loss: 0.4735, weighted_loss: 0.8522, label: 3, bag_size: 857
batch 399, loss: 0.7504, instance_loss: 0.4121, weighted_loss: 0.6489, label: 1, bag_size: 851
batch 419, loss: 1.1568, instance_loss: 0.4801, weighted_loss: 0.9538, label: 1, bag_size: 483
batch 439, loss: 4.0324, instance_loss: 0.7213, weighted_loss: 3.0391, label: 0, bag_size: 492
batch 459, loss: 0.6301, instance_loss: 0.3831, weighted_loss: 0.5560, label: 3, bag_size: 684
batch 479, loss: 1.0755, instance_loss: 0.4757, weighted_loss: 0.8955, label: 2, bag_size: 445
batch 499, loss: 2.9690, instance_loss: 0.6260, weighted_loss: 2.2661, label: 2, bag_size: 829
batch 519, loss: 3.7544, instance_loss: 0.7447, weighted_loss: 2.8515, label: 3, bag_size: 1057
batch 539, loss: 0.8142, instance_loss: 0.3849, weighted_loss: 0.6854, label: 1, bag_size: 544
batch 559, loss: 1.3523, instance_loss: 0.4582, weighted_loss: 1.0840, label: 0, bag_size: 879
batch 579, loss: 1.2930, instance_loss: 0.4636, weighted_loss: 1.0442, label: 1, bag_size: 634


class 0 clustering acc 0.9932239057239057: correct 23599/23760
class 1 clustering acc 0.0906986531986532: correct 431/4752
Epoch: 26, train_loss: 1.1415, train_clustering_loss:  0.4705, train_error: 0.4529
class 0: acc 0.744, correct 93/125
class 1: acc 0.5245901639344263, correct 64/122
class 2: acc 0.336283185840708, correct 38/113
class 3: acc 0.5528455284552846, correct 68/123
class 4: acc 0.5585585585585585, correct 62/111

Val Set, val_loss: 1.3621, val_error: 0.5541, auc: 0.7568
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2963, instance_loss: 0.4327, weighted_loss: 1.0372, label: 3, bag_size: 631
batch 39, loss: 0.5665, instance_loss: 0.3423, weighted_loss: 0.4992, label: 4, bag_size: 563
batch 59, loss: 0.3377, instance_loss: 0.4490, weighted_loss: 0.3711, label: 2, bag_size: 288
batch 79, loss: 1.0805, instance_loss: 0.6522, weighted_loss: 0.9520, label: 4, bag_size: 1113
batch 99, loss: 0.9235, instance_loss: 0.5264, weighted_loss: 0.8044, label: 1, bag_size: 381
batch 119, loss: 0.3694, instance_loss: 0.4049, weighted_loss: 0.3801, label: 4, bag_size: 773
batch 139, loss: 0.8382, instance_loss: 0.5109, weighted_loss: 0.7400, label: 0, bag_size: 404
batch 159, loss: 0.6339, instance_loss: 0.4919, weighted_loss: 0.5913, label: 0, bag_size: 183
batch 179, loss: 1.5885, instance_loss: 0.4573, weighted_loss: 1.2491, label: 4, bag_size: 714
batch 199, loss: 0.4690, instance_loss: 0.4998, weighted_loss: 0.4782, label: 0, bag_size: 416
batch 219, loss: 1.4769, instance_loss: 0.4910, weighted_loss: 1.1811, label: 2, bag_size: 445
batch 239, loss: 0.8307, instance_loss: 0.3871, weighted_loss: 0.6976, label: 3, bag_size: 871
batch 259, loss: 1.0147, instance_loss: 0.5188, weighted_loss: 0.8659, label: 3, bag_size: 804
batch 279, loss: 0.1766, instance_loss: 0.3208, weighted_loss: 0.2198, label: 4, bag_size: 409
batch 299, loss: 0.6131, instance_loss: 0.4382, weighted_loss: 0.5606, label: 4, bag_size: 725
batch 319, loss: 2.1502, instance_loss: 0.5329, weighted_loss: 1.6650, label: 4, bag_size: 264
batch 339, loss: 0.1618, instance_loss: 0.2849, weighted_loss: 0.1987, label: 0, bag_size: 393
batch 359, loss: 1.4123, instance_loss: 0.4440, weighted_loss: 1.1218, label: 1, bag_size: 634
batch 379, loss: 0.0434, instance_loss: 0.4093, weighted_loss: 0.1532, label: 0, bag_size: 103
batch 399, loss: 2.7480, instance_loss: 0.7066, weighted_loss: 2.1356, label: 0, bag_size: 600
batch 419, loss: 2.1500, instance_loss: 0.5886, weighted_loss: 1.6816, label: 2, bag_size: 367
batch 439, loss: 0.8114, instance_loss: 0.4356, weighted_loss: 0.6987, label: 3, bag_size: 603
batch 459, loss: 1.3566, instance_loss: 0.4916, weighted_loss: 1.0971, label: 1, bag_size: 823
batch 479, loss: 0.8003, instance_loss: 0.4787, weighted_loss: 0.7038, label: 1, bag_size: 522
batch 499, loss: 1.1458, instance_loss: 0.4769, weighted_loss: 0.9451, label: 3, bag_size: 309
batch 519, loss: 2.6127, instance_loss: 0.6524, weighted_loss: 2.0246, label: 0, bag_size: 964
batch 539, loss: 0.8309, instance_loss: 0.3951, weighted_loss: 0.7001, label: 3, bag_size: 344
batch 559, loss: 0.9439, instance_loss: 0.4780, weighted_loss: 0.8041, label: 1, bag_size: 972
batch 579, loss: 1.4606, instance_loss: 0.5057, weighted_loss: 1.1741, label: 3, bag_size: 97


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.06691919191919192: correct 318/4752
Epoch: 27, train_loss: 1.1174, train_clustering_loss:  0.4658, train_error: 0.4545
class 0: acc 0.7614678899082569, correct 83/109
class 1: acc 0.36893203883495146, correct 38/103
class 2: acc 0.5163934426229508, correct 63/122
class 3: acc 0.5813953488372093, correct 75/129
class 4: acc 0.4961832061068702, correct 65/131

Val Set, val_loss: 1.4620, val_error: 0.5270, auc: 0.7541
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8597, instance_loss: 0.4081, weighted_loss: 0.7242, label: 3, bag_size: 817
batch 39, loss: 1.2432, instance_loss: 0.4796, weighted_loss: 1.0141, label: 2, bag_size: 410
batch 59, loss: 0.5439, instance_loss: 0.3964, weighted_loss: 0.4996, label: 1, bag_size: 398
batch 79, loss: 1.5126, instance_loss: 0.4831, weighted_loss: 1.2038, label: 4, bag_size: 342
batch 99, loss: 0.7462, instance_loss: 0.4733, weighted_loss: 0.6644, label: 4, bag_size: 228
batch 119, loss: 2.2300, instance_loss: 0.5714, weighted_loss: 1.7324, label: 3, bag_size: 423
batch 139, loss: 1.3893, instance_loss: 0.7934, weighted_loss: 1.2105, label: 2, bag_size: 96
batch 159, loss: 1.0751, instance_loss: 0.4548, weighted_loss: 0.8890, label: 3, bag_size: 230
batch 179, loss: 0.4897, instance_loss: 0.4076, weighted_loss: 0.4651, label: 4, bag_size: 895
batch 199, loss: 1.4108, instance_loss: 0.4409, weighted_loss: 1.1198, label: 2, bag_size: 906
batch 219, loss: 2.9734, instance_loss: 0.5938, weighted_loss: 2.2596, label: 1, bag_size: 361
batch 239, loss: 0.9943, instance_loss: 0.4214, weighted_loss: 0.8224, label: 4, bag_size: 690
batch 259, loss: 1.0655, instance_loss: 0.4644, weighted_loss: 0.8851, label: 1, bag_size: 500
batch 279, loss: 2.3656, instance_loss: 0.4997, weighted_loss: 1.8058, label: 1, bag_size: 1082
batch 299, loss: 1.9759, instance_loss: 0.4896, weighted_loss: 1.5300, label: 2, bag_size: 597
batch 319, loss: 0.8015, instance_loss: 0.4194, weighted_loss: 0.6869, label: 1, bag_size: 928
batch 339, loss: 0.6788, instance_loss: 0.6219, weighted_loss: 0.6617, label: 2, bag_size: 590
batch 359, loss: 0.2428, instance_loss: 0.3188, weighted_loss: 0.2656, label: 4, bag_size: 266
batch 379, loss: 1.2395, instance_loss: 0.5138, weighted_loss: 1.0218, label: 2, bag_size: 299
batch 399, loss: 1.9641, instance_loss: 0.5904, weighted_loss: 1.5520, label: 0, bag_size: 343
batch 419, loss: 0.4620, instance_loss: 0.4140, weighted_loss: 0.4476, label: 4, bag_size: 266
batch 439, loss: 0.0436, instance_loss: 0.1434, weighted_loss: 0.0735, label: 0, bag_size: 133
batch 459, loss: 0.9797, instance_loss: 0.4418, weighted_loss: 0.8183, label: 1, bag_size: 697
batch 479, loss: 0.5440, instance_loss: 0.4505, weighted_loss: 0.5160, label: 1, bag_size: 522
batch 499, loss: 0.0376, instance_loss: 0.2450, weighted_loss: 0.0998, label: 0, bag_size: 103
batch 519, loss: 0.7499, instance_loss: 0.3194, weighted_loss: 0.6207, label: 0, bag_size: 62
batch 539, loss: 2.0348, instance_loss: 0.5915, weighted_loss: 1.6018, label: 1, bag_size: 697
batch 559, loss: 0.7054, instance_loss: 0.4751, weighted_loss: 0.6363, label: 2, bag_size: 617
batch 579, loss: 0.8610, instance_loss: 0.4803, weighted_loss: 0.7468, label: 1, bag_size: 1023


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.11889730639730639: correct 565/4752
Epoch: 28, train_loss: 1.0710, train_clustering_loss:  0.4509, train_error: 0.4764
class 0: acc 0.7674418604651163, correct 99/129
class 1: acc 0.53125, correct 68/128
class 2: acc 0.2807017543859649, correct 32/114
class 3: acc 0.43859649122807015, correct 50/114
class 4: acc 0.5688073394495413, correct 62/109

Val Set, val_loss: 1.3725, val_error: 0.5541, auc: 0.7629
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.10810810810810811: correct 64/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1816, instance_loss: 0.2510, weighted_loss: 0.2024, label: 0, bag_size: 59
batch 39, loss: 1.4081, instance_loss: 0.4731, weighted_loss: 1.1276, label: 0, bag_size: 879
batch 59, loss: 0.1076, instance_loss: 0.4306, weighted_loss: 0.2045, label: 4, bag_size: 541
batch 79, loss: 2.6664, instance_loss: 0.6578, weighted_loss: 2.0638, label: 2, bag_size: 394
batch 99, loss: 1.9583, instance_loss: 0.5556, weighted_loss: 1.5375, label: 3, bag_size: 166
batch 119, loss: 0.9127, instance_loss: 0.4414, weighted_loss: 0.7713, label: 3, bag_size: 192
batch 139, loss: 1.1687, instance_loss: 0.5299, weighted_loss: 0.9771, label: 4, bag_size: 563
batch 159, loss: 0.1724, instance_loss: 0.2534, weighted_loss: 0.1967, label: 4, bag_size: 948
batch 179, loss: 0.8716, instance_loss: 0.4163, weighted_loss: 0.7350, label: 1, bag_size: 389
batch 199, loss: 1.0562, instance_loss: 0.5549, weighted_loss: 0.9058, label: 3, bag_size: 403
batch 219, loss: 1.2642, instance_loss: 0.4430, weighted_loss: 1.0178, label: 3, bag_size: 1328
batch 239, loss: 0.9102, instance_loss: 0.4488, weighted_loss: 0.7718, label: 4, bag_size: 218
batch 259, loss: 0.7518, instance_loss: 0.5702, weighted_loss: 0.6973, label: 2, bag_size: 288
batch 279, loss: 0.8436, instance_loss: 0.3896, weighted_loss: 0.7074, label: 3, bag_size: 1154
batch 299, loss: 2.5120, instance_loss: 0.6704, weighted_loss: 1.9595, label: 3, bag_size: 282
batch 319, loss: 1.8370, instance_loss: 0.7451, weighted_loss: 1.5094, label: 2, bag_size: 549
batch 339, loss: 1.2898, instance_loss: 0.4903, weighted_loss: 1.0500, label: 1, bag_size: 321
batch 359, loss: 0.7858, instance_loss: 0.5261, weighted_loss: 0.7079, label: 2, bag_size: 253
batch 379, loss: 0.1183, instance_loss: 0.1564, weighted_loss: 0.1297, label: 0, bag_size: 201
batch 399, loss: 1.7821, instance_loss: 0.5314, weighted_loss: 1.4069, label: 3, bag_size: 282
batch 419, loss: 0.9971, instance_loss: 0.4121, weighted_loss: 0.8216, label: 4, bag_size: 703
batch 439, loss: 0.3057, instance_loss: 0.4313, weighted_loss: 0.3433, label: 2, bag_size: 617
batch 459, loss: 1.2149, instance_loss: 0.4314, weighted_loss: 0.9799, label: 2, bag_size: 998
batch 479, loss: 0.2820, instance_loss: 0.4836, weighted_loss: 0.3425, label: 2, bag_size: 1079
batch 499, loss: 0.3267, instance_loss: 0.3337, weighted_loss: 0.3288, label: 4, bag_size: 895
batch 519, loss: 2.7645, instance_loss: 0.6886, weighted_loss: 2.1417, label: 0, bag_size: 888
batch 539, loss: 2.9658, instance_loss: 0.6715, weighted_loss: 2.2775, label: 3, bag_size: 638
batch 559, loss: 0.4593, instance_loss: 0.3301, weighted_loss: 0.4205, label: 1, bag_size: 874
batch 579, loss: 1.0848, instance_loss: 0.4414, weighted_loss: 0.8918, label: 2, bag_size: 598


class 0 clustering acc 0.9938973063973064: correct 23615/23760
class 1 clustering acc 0.11069023569023569: correct 526/4752
Epoch: 29, train_loss: 1.0585, train_clustering_loss:  0.4551, train_error: 0.4293
class 0: acc 0.7874015748031497, correct 100/127
class 1: acc 0.49056603773584906, correct 52/106
class 2: acc 0.40540540540540543, correct 45/111
class 3: acc 0.5984848484848485, correct 79/132
class 4: acc 0.5338983050847458, correct 63/118

Val Set, val_loss: 1.4662, val_error: 0.5676, auc: 0.7545
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.9339, instance_loss: 0.4385, weighted_loss: 1.4853, label: 4, bag_size: 333
batch 39, loss: 0.4571, instance_loss: 0.2958, weighted_loss: 0.4087, label: 0, bag_size: 393
batch 59, loss: 1.5445, instance_loss: 0.4487, weighted_loss: 1.2158, label: 2, bag_size: 906
batch 79, loss: 0.4146, instance_loss: 0.4394, weighted_loss: 0.4220, label: 0, bag_size: 317
batch 99, loss: 0.4341, instance_loss: 0.5245, weighted_loss: 0.4613, label: 4, bag_size: 450
batch 119, loss: 1.6560, instance_loss: 0.6528, weighted_loss: 1.3551, label: 2, bag_size: 582
batch 139, loss: 2.2559, instance_loss: 0.6757, weighted_loss: 1.7819, label: 2, bag_size: 331
batch 159, loss: 0.3942, instance_loss: 0.3039, weighted_loss: 0.3671, label: 0, bag_size: 297
batch 179, loss: 1.2353, instance_loss: 0.4970, weighted_loss: 1.0138, label: 1, bag_size: 960
batch 199, loss: 1.5192, instance_loss: 0.5854, weighted_loss: 1.2391, label: 2, bag_size: 171
batch 219, loss: 0.1804, instance_loss: 0.2645, weighted_loss: 0.2056, label: 0, bag_size: 425
batch 239, loss: 0.3988, instance_loss: 0.4007, weighted_loss: 0.3994, label: 0, bag_size: 70
batch 259, loss: 0.8283, instance_loss: 0.4658, weighted_loss: 0.7195, label: 4, bag_size: 72
batch 279, loss: 1.3567, instance_loss: 0.4852, weighted_loss: 1.0952, label: 3, bag_size: 556
batch 299, loss: 0.8143, instance_loss: 0.4831, weighted_loss: 0.7150, label: 2, bag_size: 659
batch 319, loss: 0.6147, instance_loss: 0.4596, weighted_loss: 0.5682, label: 3, bag_size: 817
batch 339, loss: 0.6329, instance_loss: 0.4195, weighted_loss: 0.5689, label: 1, bag_size: 460
batch 359, loss: 0.5417, instance_loss: 0.4699, weighted_loss: 0.5201, label: 3, bag_size: 488
batch 379, loss: 0.0408, instance_loss: 0.2204, weighted_loss: 0.0947, label: 0, bag_size: 306
batch 399, loss: 0.1420, instance_loss: 0.2747, weighted_loss: 0.1818, label: 4, bag_size: 744
batch 419, loss: 2.7044, instance_loss: 0.6315, weighted_loss: 2.0825, label: 0, bag_size: 492
batch 439, loss: 0.5961, instance_loss: 0.4084, weighted_loss: 0.5398, label: 4, bag_size: 176
batch 459, loss: 1.4652, instance_loss: 0.5654, weighted_loss: 1.1952, label: 1, bag_size: 697
batch 479, loss: 0.8284, instance_loss: 0.5471, weighted_loss: 0.7440, label: 1, bag_size: 892
batch 499, loss: 0.4968, instance_loss: 0.3709, weighted_loss: 0.4590, label: 4, bag_size: 1077
batch 519, loss: 3.0458, instance_loss: 0.7018, weighted_loss: 2.3426, label: 2, bag_size: 367
batch 539, loss: 0.5922, instance_loss: 0.4418, weighted_loss: 0.5471, label: 3, bag_size: 510
batch 559, loss: 1.3711, instance_loss: 0.5009, weighted_loss: 1.1101, label: 1, bag_size: 332
batch 579, loss: 0.4856, instance_loss: 0.4652, weighted_loss: 0.4795, label: 1, bag_size: 311


class 0 clustering acc 0.9943181818181818: correct 23625/23760
class 1 clustering acc 0.08164983164983165: correct 388/4752
Epoch: 30, train_loss: 1.0650, train_clustering_loss:  0.4642, train_error: 0.4242
class 0: acc 0.7786885245901639, correct 95/122
class 1: acc 0.6293103448275862, correct 73/116
class 2: acc 0.25263157894736843, correct 24/95
class 3: acc 0.5634920634920635, correct 71/126
class 4: acc 0.5851851851851851, correct 79/135

Val Set, val_loss: 1.4835, val_error: 0.5541, auc: 0.7404
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7821, instance_loss: 0.5843, weighted_loss: 0.7227, label: 2, bag_size: 337
batch 39, loss: 0.8250, instance_loss: 0.3810, weighted_loss: 0.6918, label: 4, bag_size: 246
batch 59, loss: 4.3440, instance_loss: 0.8083, weighted_loss: 3.2833, label: 0, bag_size: 214
batch 79, loss: 5.0414, instance_loss: 0.8919, weighted_loss: 3.7965, label: 3, bag_size: 508
batch 99, loss: 2.8822, instance_loss: 0.6685, weighted_loss: 2.2181, label: 2, bag_size: 738
batch 119, loss: 1.4122, instance_loss: 0.5378, weighted_loss: 1.1499, label: 2, bag_size: 605
batch 139, loss: 0.3114, instance_loss: 0.3703, weighted_loss: 0.3291, label: 4, bag_size: 742
batch 159, loss: 0.4198, instance_loss: 0.3225, weighted_loss: 0.3906, label: 0, bag_size: 613
batch 179, loss: 0.0441, instance_loss: 0.2322, weighted_loss: 0.1005, label: 0, bag_size: 159
batch 199, loss: 0.8933, instance_loss: 0.4795, weighted_loss: 0.7692, label: 0, bag_size: 247
batch 219, loss: 0.4281, instance_loss: 0.3866, weighted_loss: 0.4156, label: 1, bag_size: 886
batch 239, loss: 0.5956, instance_loss: 0.4945, weighted_loss: 0.5653, label: 2, bag_size: 286
batch 259, loss: 0.8921, instance_loss: 0.4941, weighted_loss: 0.7727, label: 2, bag_size: 754
batch 279, loss: 1.0533, instance_loss: 0.5216, weighted_loss: 0.8938, label: 4, bag_size: 726
batch 299, loss: 2.2931, instance_loss: 0.6337, weighted_loss: 1.7953, label: 0, bag_size: 305
batch 319, loss: 1.2382, instance_loss: 0.4884, weighted_loss: 1.0132, label: 1, bag_size: 208
batch 339, loss: 1.4713, instance_loss: 0.6703, weighted_loss: 1.2310, label: 2, bag_size: 303
batch 359, loss: 0.5150, instance_loss: 0.3376, weighted_loss: 0.4618, label: 1, bag_size: 1104
batch 379, loss: 2.4102, instance_loss: 0.6212, weighted_loss: 1.8735, label: 2, bag_size: 852
batch 399, loss: 0.0822, instance_loss: 0.2578, weighted_loss: 0.1349, label: 0, bag_size: 159
batch 419, loss: 1.8948, instance_loss: 0.8122, weighted_loss: 1.5700, label: 2, bag_size: 171
batch 439, loss: 0.9223, instance_loss: 0.4468, weighted_loss: 0.7797, label: 1, bag_size: 960
batch 459, loss: 0.8378, instance_loss: 0.4355, weighted_loss: 0.7171, label: 1, bag_size: 972
batch 479, loss: 0.8865, instance_loss: 0.4077, weighted_loss: 0.7429, label: 4, bag_size: 356
batch 499, loss: 1.1518, instance_loss: 0.5256, weighted_loss: 0.9639, label: 3, bag_size: 192
batch 519, loss: 0.6725, instance_loss: 0.4295, weighted_loss: 0.5996, label: 3, bag_size: 344
batch 539, loss: 2.2064, instance_loss: 0.5802, weighted_loss: 1.7185, label: 2, bag_size: 851
batch 559, loss: 0.8564, instance_loss: 0.4474, weighted_loss: 0.7337, label: 1, bag_size: 233
batch 579, loss: 0.6901, instance_loss: 0.4670, weighted_loss: 0.6232, label: 2, bag_size: 883


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.08080808080808081: correct 384/4752
Epoch: 31, train_loss: 1.1010, train_clustering_loss:  0.4685, train_error: 0.4444
class 0: acc 0.7478260869565218, correct 86/115
class 1: acc 0.6304347826086957, correct 87/138
class 2: acc 0.2982456140350877, correct 34/114
class 3: acc 0.49056603773584906, correct 52/106
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.5066, val_error: 0.5135, auc: 0.7559
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0078, instance_loss: 0.1192, weighted_loss: 0.0412, label: 0, bag_size: 354
batch 39, loss: 1.0137, instance_loss: 0.4702, weighted_loss: 0.8507, label: 3, bag_size: 457
batch 59, loss: 0.0077, instance_loss: 0.2022, weighted_loss: 0.0661, label: 0, bag_size: 37
batch 79, loss: 1.5632, instance_loss: 0.5981, weighted_loss: 1.2737, label: 2, bag_size: 512
batch 99, loss: 0.8031, instance_loss: 0.5327, weighted_loss: 0.7220, label: 2, bag_size: 290
batch 119, loss: 1.2459, instance_loss: 0.5380, weighted_loss: 1.0335, label: 2, bag_size: 337
batch 139, loss: 0.3721, instance_loss: 0.3784, weighted_loss: 0.3740, label: 1, bag_size: 886
batch 159, loss: 0.9374, instance_loss: 0.4714, weighted_loss: 0.7976, label: 4, bag_size: 730
batch 179, loss: 1.5568, instance_loss: 0.5293, weighted_loss: 1.2486, label: 4, bag_size: 468
batch 199, loss: 0.0490, instance_loss: 0.2570, weighted_loss: 0.1114, label: 0, bag_size: 366
batch 219, loss: 2.0517, instance_loss: 0.6221, weighted_loss: 1.6228, label: 3, bag_size: 1186
batch 239, loss: 0.6469, instance_loss: 0.4135, weighted_loss: 0.5769, label: 1, bag_size: 1009
batch 259, loss: 0.8264, instance_loss: 0.4308, weighted_loss: 0.7078, label: 2, bag_size: 783
batch 279, loss: 1.0964, instance_loss: 0.5893, weighted_loss: 0.9443, label: 3, bag_size: 566
batch 299, loss: 1.8326, instance_loss: 0.5532, weighted_loss: 1.4488, label: 4, bag_size: 685
batch 319, loss: 0.0268, instance_loss: 0.1391, weighted_loss: 0.0605, label: 0, bag_size: 285
batch 339, loss: 0.3746, instance_loss: 0.3472, weighted_loss: 0.3664, label: 3, bag_size: 587
batch 359, loss: 0.5700, instance_loss: 0.4740, weighted_loss: 0.5412, label: 0, bag_size: 230
batch 379, loss: 0.4514, instance_loss: 0.3742, weighted_loss: 0.4282, label: 1, bag_size: 766
batch 399, loss: 1.2782, instance_loss: 0.4628, weighted_loss: 1.0336, label: 3, bag_size: 1078
batch 419, loss: 1.3308, instance_loss: 0.5471, weighted_loss: 1.0957, label: 2, bag_size: 427
batch 439, loss: 0.8419, instance_loss: 0.4171, weighted_loss: 0.7144, label: 3, bag_size: 625
batch 459, loss: 1.0974, instance_loss: 0.5242, weighted_loss: 0.9254, label: 2, bag_size: 853
batch 479, loss: 1.1646, instance_loss: 0.4600, weighted_loss: 0.9533, label: 2, bag_size: 941
batch 499, loss: 0.0324, instance_loss: 0.2469, weighted_loss: 0.0967, label: 0, bag_size: 251
batch 519, loss: 1.8006, instance_loss: 0.5374, weighted_loss: 1.4217, label: 3, bag_size: 818
batch 539, loss: 1.1076, instance_loss: 0.5212, weighted_loss: 0.9317, label: 3, bag_size: 818
batch 559, loss: 1.1153, instance_loss: 0.4038, weighted_loss: 0.9018, label: 4, bag_size: 690
batch 579, loss: 0.6057, instance_loss: 0.4288, weighted_loss: 0.5527, label: 4, bag_size: 886


class 0 clustering acc 0.9950757575757576: correct 23643/23760
class 1 clustering acc 0.08396464646464646: correct 399/4752
Epoch: 32, train_loss: 1.1072, train_clustering_loss:  0.4667, train_error: 0.4714
class 0: acc 0.7606837606837606, correct 89/117
class 1: acc 0.5491803278688525, correct 67/122
class 2: acc 0.33043478260869563, correct 38/115
class 3: acc 0.453781512605042, correct 54/119
class 4: acc 0.5454545454545454, correct 66/121

Val Set, val_loss: 1.4687, val_error: 0.5405, auc: 0.7759
class 0 clustering acc 0.9878378378378379: correct 2924/2960
class 1 clustering acc 0.08783783783783784: correct 52/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.9004, instance_loss: 0.5571, weighted_loss: 1.4974, label: 2, bag_size: 576
batch 39, loss: 1.1141, instance_loss: 0.5367, weighted_loss: 0.9408, label: 2, bag_size: 427
batch 59, loss: 1.6464, instance_loss: 0.4715, weighted_loss: 1.2939, label: 4, bag_size: 318
batch 79, loss: 0.8370, instance_loss: 0.5639, weighted_loss: 0.7551, label: 4, bag_size: 699
batch 99, loss: 1.0104, instance_loss: 0.4810, weighted_loss: 0.8516, label: 1, bag_size: 599
batch 119, loss: 0.2551, instance_loss: 0.2848, weighted_loss: 0.2640, label: 4, bag_size: 986
batch 139, loss: 1.1021, instance_loss: 0.5837, weighted_loss: 0.9466, label: 0, bag_size: 319
batch 159, loss: 0.0111, instance_loss: 0.1520, weighted_loss: 0.0534, label: 0, bag_size: 533
batch 179, loss: 0.9270, instance_loss: 0.4307, weighted_loss: 0.7781, label: 1, bag_size: 1043
batch 199, loss: 0.0219, instance_loss: 0.2034, weighted_loss: 0.0764, label: 0, bag_size: 210
batch 219, loss: 0.4400, instance_loss: 0.3779, weighted_loss: 0.4214, label: 3, bag_size: 625
batch 239, loss: 1.7510, instance_loss: 0.5229, weighted_loss: 1.3826, label: 3, bag_size: 166
batch 259, loss: 0.7297, instance_loss: 0.3918, weighted_loss: 0.6283, label: 3, bag_size: 488
batch 279, loss: 1.1739, instance_loss: 0.4982, weighted_loss: 0.9712, label: 1, bag_size: 697
batch 299, loss: 1.1287, instance_loss: 0.5376, weighted_loss: 0.9514, label: 3, bag_size: 476
batch 319, loss: 0.0282, instance_loss: 0.1947, weighted_loss: 0.0782, label: 0, bag_size: 533
batch 339, loss: 0.0343, instance_loss: 0.1837, weighted_loss: 0.0791, label: 0, bag_size: 280
batch 359, loss: 2.4002, instance_loss: 0.6496, weighted_loss: 1.8750, label: 3, bag_size: 107
batch 379, loss: 0.0188, instance_loss: 0.2223, weighted_loss: 0.0798, label: 0, bag_size: 230
batch 399, loss: 0.4378, instance_loss: 0.3073, weighted_loss: 0.3987, label: 4, bag_size: 780
batch 419, loss: 0.3908, instance_loss: 0.4716, weighted_loss: 0.4151, label: 1, bag_size: 522
batch 439, loss: 1.2049, instance_loss: 0.5209, weighted_loss: 0.9997, label: 3, bag_size: 192
batch 459, loss: 0.5812, instance_loss: 0.4888, weighted_loss: 0.5535, label: 1, bag_size: 141
batch 479, loss: 0.8371, instance_loss: 0.3887, weighted_loss: 0.7026, label: 3, bag_size: 309
batch 499, loss: 0.5074, instance_loss: 0.5867, weighted_loss: 0.5312, label: 2, bag_size: 571
batch 519, loss: 1.2694, instance_loss: 0.4480, weighted_loss: 1.0230, label: 4, bag_size: 703
batch 539, loss: 1.4823, instance_loss: 0.5624, weighted_loss: 1.2063, label: 3, bag_size: 344
batch 559, loss: 0.0015, instance_loss: 0.1794, weighted_loss: 0.0549, label: 0, bag_size: 706
batch 579, loss: 0.5873, instance_loss: 0.4578, weighted_loss: 0.5484, label: 2, bag_size: 567


class 0 clustering acc 0.994486531986532: correct 23629/23760
class 1 clustering acc 0.11553030303030302: correct 549/4752
Epoch: 33, train_loss: 0.9963, train_clustering_loss:  0.4519, train_error: 0.4377
class 0: acc 0.84251968503937, correct 107/127
class 1: acc 0.6229508196721312, correct 76/122
class 2: acc 0.3853211009174312, correct 42/109
class 3: acc 0.5081967213114754, correct 62/122
class 4: acc 0.41228070175438597, correct 47/114

Val Set, val_loss: 1.4204, val_error: 0.5946, auc: 0.7584
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5520, instance_loss: 0.3986, weighted_loss: 0.5060, label: 3, bag_size: 431
batch 39, loss: 0.4334, instance_loss: 0.4871, weighted_loss: 0.4495, label: 2, bag_size: 617
batch 59, loss: 0.0560, instance_loss: 0.1381, weighted_loss: 0.0807, label: 1, bag_size: 1091
batch 79, loss: 1.1085, instance_loss: 0.4997, weighted_loss: 0.9259, label: 4, bag_size: 1104
batch 99, loss: 0.0138, instance_loss: 0.2291, weighted_loss: 0.0784, label: 0, bag_size: 227
batch 119, loss: 0.4945, instance_loss: 0.4306, weighted_loss: 0.4753, label: 1, bag_size: 141
batch 139, loss: 0.3492, instance_loss: 0.3228, weighted_loss: 0.3413, label: 0, bag_size: 343
batch 159, loss: 0.4786, instance_loss: 0.3929, weighted_loss: 0.4529, label: 1, bag_size: 605
batch 179, loss: 1.4371, instance_loss: 0.4376, weighted_loss: 1.1372, label: 3, bag_size: 109
batch 199, loss: 0.3762, instance_loss: 0.3587, weighted_loss: 0.3709, label: 4, bag_size: 695
batch 219, loss: 1.2190, instance_loss: 0.4145, weighted_loss: 0.9776, label: 1, bag_size: 1023
batch 239, loss: 0.9689, instance_loss: 0.4954, weighted_loss: 0.8269, label: 3, bag_size: 631
batch 259, loss: 0.6405, instance_loss: 0.3883, weighted_loss: 0.5649, label: 4, bag_size: 228
batch 279, loss: 2.9967, instance_loss: 0.6273, weighted_loss: 2.2859, label: 2, bag_size: 185
batch 299, loss: 2.1189, instance_loss: 0.5968, weighted_loss: 1.6623, label: 2, bag_size: 1074
batch 319, loss: 1.9587, instance_loss: 0.5740, weighted_loss: 1.5433, label: 3, bag_size: 505
batch 339, loss: 0.0622, instance_loss: 0.2203, weighted_loss: 0.1096, label: 0, bag_size: 212
batch 359, loss: 3.3124, instance_loss: 0.7068, weighted_loss: 2.5307, label: 0, bag_size: 492
batch 379, loss: 2.0952, instance_loss: 0.5803, weighted_loss: 1.6407, label: 2, bag_size: 348
batch 399, loss: 1.6532, instance_loss: 0.5406, weighted_loss: 1.3194, label: 2, bag_size: 576
batch 419, loss: 1.0709, instance_loss: 0.4981, weighted_loss: 0.8991, label: 0, bag_size: 416
batch 439, loss: 0.5710, instance_loss: 0.3600, weighted_loss: 0.5077, label: 1, bag_size: 855
batch 459, loss: 0.9041, instance_loss: 0.4605, weighted_loss: 0.7710, label: 3, bag_size: 817
batch 479, loss: 0.8538, instance_loss: 0.4300, weighted_loss: 0.7267, label: 3, bag_size: 245
batch 499, loss: 2.0031, instance_loss: 0.6555, weighted_loss: 1.5988, label: 0, bag_size: 587
batch 519, loss: 1.0167, instance_loss: 0.5004, weighted_loss: 0.8618, label: 4, bag_size: 506
batch 539, loss: 1.4997, instance_loss: 0.5464, weighted_loss: 1.2137, label: 0, bag_size: 416
batch 559, loss: 1.4667, instance_loss: 0.5889, weighted_loss: 1.2034, label: 2, bag_size: 576
batch 579, loss: 0.9139, instance_loss: 0.5237, weighted_loss: 0.7968, label: 4, bag_size: 489


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.10122053872053872: correct 481/4752
Epoch: 34, train_loss: 1.0826, train_clustering_loss:  0.4552, train_error: 0.4545
class 0: acc 0.7657657657657657, correct 85/111
class 1: acc 0.673469387755102, correct 99/147
class 2: acc 0.2616822429906542, correct 28/107
class 3: acc 0.5299145299145299, correct 62/117
class 4: acc 0.44642857142857145, correct 50/112

Val Set, val_loss: 1.3747, val_error: 0.5135, auc: 0.7748
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.08614864864864864: correct 51/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.2382, instance_loss: 0.4638, weighted_loss: 1.0059, label: 2, bag_size: 598
batch 39, loss: 0.0585, instance_loss: 0.2432, weighted_loss: 0.1139, label: 0, bag_size: 122
batch 59, loss: 0.4479, instance_loss: 0.5138, weighted_loss: 0.4677, label: 0, bag_size: 230
batch 79, loss: 0.8164, instance_loss: 0.4829, weighted_loss: 0.7164, label: 1, bag_size: 398
batch 99, loss: 1.3860, instance_loss: 0.5398, weighted_loss: 1.1321, label: 1, bag_size: 617
batch 119, loss: 2.3694, instance_loss: 0.5959, weighted_loss: 1.8374, label: 2, bag_size: 1071
batch 139, loss: 5.0901, instance_loss: 0.9654, weighted_loss: 3.8527, label: 2, bag_size: 244
batch 159, loss: 0.1852, instance_loss: 0.2687, weighted_loss: 0.2102, label: 0, bag_size: 73
batch 179, loss: 0.5125, instance_loss: 0.3201, weighted_loss: 0.4548, label: 4, bag_size: 1041
batch 199, loss: 0.7589, instance_loss: 0.3963, weighted_loss: 0.6501, label: 4, bag_size: 1064
batch 219, loss: 1.8925, instance_loss: 0.5724, weighted_loss: 1.4964, label: 3, bag_size: 109
batch 239, loss: 0.6651, instance_loss: 0.4582, weighted_loss: 0.6030, label: 4, bag_size: 574
batch 259, loss: 0.8793, instance_loss: 0.4202, weighted_loss: 0.7415, label: 1, bag_size: 381
batch 279, loss: 1.3154, instance_loss: 0.4648, weighted_loss: 1.0602, label: 1, bag_size: 106
batch 299, loss: 1.7163, instance_loss: 0.6040, weighted_loss: 1.3826, label: 2, bag_size: 799
batch 319, loss: 2.3064, instance_loss: 0.5910, weighted_loss: 1.7918, label: 3, bag_size: 520
batch 339, loss: 0.3987, instance_loss: 0.3435, weighted_loss: 0.3821, label: 4, bag_size: 875
batch 359, loss: 0.8130, instance_loss: 0.4633, weighted_loss: 0.7081, label: 3, bag_size: 351
batch 379, loss: 0.4022, instance_loss: 0.3467, weighted_loss: 0.3856, label: 4, bag_size: 293
batch 399, loss: 1.9247, instance_loss: 0.6071, weighted_loss: 1.5294, label: 2, bag_size: 339
batch 419, loss: 0.0604, instance_loss: 0.2221, weighted_loss: 0.1089, label: 0, bag_size: 156
batch 439, loss: 2.2075, instance_loss: 0.6235, weighted_loss: 1.7323, label: 2, bag_size: 851
batch 459, loss: 0.5064, instance_loss: 0.3794, weighted_loss: 0.4683, label: 1, bag_size: 620
batch 479, loss: 1.1031, instance_loss: 0.4941, weighted_loss: 0.9204, label: 0, bag_size: 178
batch 499, loss: 1.8269, instance_loss: 0.5775, weighted_loss: 1.4521, label: 4, bag_size: 853
batch 519, loss: 1.2400, instance_loss: 0.6108, weighted_loss: 1.0512, label: 2, bag_size: 557
batch 539, loss: 0.6585, instance_loss: 0.4795, weighted_loss: 0.6048, label: 3, bag_size: 818
batch 559, loss: 0.0612, instance_loss: 0.1717, weighted_loss: 0.0943, label: 0, bag_size: 133
batch 579, loss: 0.8198, instance_loss: 0.4975, weighted_loss: 0.7231, label: 3, bag_size: 282


class 0 clustering acc 0.9932659932659933: correct 23600/23760
class 1 clustering acc 0.10732323232323232: correct 510/4752
Epoch: 35, train_loss: 1.0790, train_clustering_loss:  0.4645, train_error: 0.4697
class 0: acc 0.8015873015873016, correct 101/126
class 1: acc 0.49166666666666664, correct 59/120
class 2: acc 0.24107142857142858, correct 27/112
class 3: acc 0.5462184873949579, correct 65/119
class 4: acc 0.5384615384615384, correct 63/117

Val Set, val_loss: 1.3046, val_error: 0.5676, auc: 0.7749
class 0 clustering acc 0.9831081081081081: correct 2910/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.306411 --> 1.304630).  Saving model ...


batch 19, loss: 2.1094, instance_loss: 0.6512, weighted_loss: 1.6720, label: 1, bag_size: 208
batch 39, loss: 1.1531, instance_loss: 0.4908, weighted_loss: 0.9544, label: 1, bag_size: 742
batch 59, loss: 1.1250, instance_loss: 0.5081, weighted_loss: 0.9399, label: 2, bag_size: 339
batch 79, loss: 2.0307, instance_loss: 0.5747, weighted_loss: 1.5939, label: 4, bag_size: 407
batch 99, loss: 1.9128, instance_loss: 0.5619, weighted_loss: 1.5075, label: 4, bag_size: 757
batch 119, loss: 1.2428, instance_loss: 0.5043, weighted_loss: 1.0212, label: 2, bag_size: 380
batch 139, loss: 0.0003, instance_loss: 0.4006, weighted_loss: 0.1204, label: 1, bag_size: 669
batch 159, loss: 0.7785, instance_loss: 0.4947, weighted_loss: 0.6933, label: 3, bag_size: 486
batch 179, loss: 0.0000, instance_loss: 0.3632, weighted_loss: 0.1090, label: 2, bag_size: 596
batch 199, loss: 0.6317, instance_loss: 0.4064, weighted_loss: 0.5641, label: 3, bag_size: 928
batch 219, loss: 0.6327, instance_loss: 0.4342, weighted_loss: 0.5732, label: 1, bag_size: 384
batch 239, loss: 0.8430, instance_loss: 0.4136, weighted_loss: 0.7142, label: 3, bag_size: 472
batch 259, loss: 1.2059, instance_loss: 0.4461, weighted_loss: 0.9780, label: 1, bag_size: 928
batch 279, loss: 0.0390, instance_loss: 0.1845, weighted_loss: 0.0826, label: 0, bag_size: 366
batch 299, loss: 0.7873, instance_loss: 0.4892, weighted_loss: 0.6979, label: 3, bag_size: 194
batch 319, loss: 0.6148, instance_loss: 0.5329, weighted_loss: 0.5902, label: 0, bag_size: 143
batch 339, loss: 1.2373, instance_loss: 0.5796, weighted_loss: 1.0400, label: 2, bag_size: 498
batch 359, loss: 1.8516, instance_loss: 0.4987, weighted_loss: 1.4457, label: 0, bag_size: 367
batch 379, loss: 1.6108, instance_loss: 0.4643, weighted_loss: 1.2668, label: 1, bag_size: 1019
batch 399, loss: 2.3673, instance_loss: 0.7062, weighted_loss: 1.8689, label: 1, bag_size: 45
batch 419, loss: 0.2167, instance_loss: 0.3546, weighted_loss: 0.2581, label: 4, bag_size: 683
batch 439, loss: 1.0469, instance_loss: 0.4748, weighted_loss: 0.8752, label: 2, bag_size: 708
batch 459, loss: 1.3130, instance_loss: 0.3492, weighted_loss: 1.0239, label: 4, bag_size: 618
batch 479, loss: 1.1637, instance_loss: 0.4333, weighted_loss: 0.9446, label: 2, bag_size: 337
batch 499, loss: 0.0404, instance_loss: 0.2258, weighted_loss: 0.0960, label: 0, bag_size: 297
batch 519, loss: 0.7647, instance_loss: 0.4394, weighted_loss: 0.6671, label: 2, bag_size: 337
batch 539, loss: 0.9207, instance_loss: 0.4884, weighted_loss: 0.7910, label: 1, bag_size: 509
batch 559, loss: 2.2243, instance_loss: 0.5251, weighted_loss: 1.7145, label: 4, bag_size: 685
batch 579, loss: 1.1353, instance_loss: 0.5397, weighted_loss: 0.9566, label: 1, bag_size: 483


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.08648989898989899: correct 411/4752
Epoch: 36, train_loss: 1.0199, train_clustering_loss:  0.4561, train_error: 0.4512
class 0: acc 0.7946428571428571, correct 89/112
class 1: acc 0.4921875, correct 63/128
class 2: acc 0.39849624060150374, correct 53/133
class 3: acc 0.5798319327731093, correct 69/119
class 4: acc 0.5098039215686274, correct 52/102

Val Set, val_loss: 1.4425, val_error: 0.5676, auc: 0.7562
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.09121621621621621: correct 54/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0404, instance_loss: 0.4983, weighted_loss: 0.8778, label: 1, bag_size: 271
batch 39, loss: 0.0000, instance_loss: 0.4012, weighted_loss: 0.1204, label: 2, bag_size: 553
batch 59, loss: 0.0989, instance_loss: 0.2437, weighted_loss: 0.1423, label: 0, bag_size: 70
batch 79, loss: 0.4934, instance_loss: 0.4024, weighted_loss: 0.4661, label: 1, bag_size: 829
batch 99, loss: 0.6018, instance_loss: 0.4056, weighted_loss: 0.5429, label: 1, bag_size: 1273
batch 119, loss: 0.3414, instance_loss: 0.3245, weighted_loss: 0.3364, label: 4, bag_size: 520
batch 139, loss: 1.7812, instance_loss: 0.5412, weighted_loss: 1.4092, label: 2, bag_size: 448
batch 159, loss: 0.0419, instance_loss: 0.1626, weighted_loss: 0.0781, label: 0, bag_size: 251
batch 179, loss: 1.7685, instance_loss: 0.5888, weighted_loss: 1.4146, label: 2, bag_size: 208
batch 199, loss: 1.1056, instance_loss: 0.4700, weighted_loss: 0.9149, label: 4, bag_size: 1104
batch 219, loss: 0.0252, instance_loss: 0.2741, weighted_loss: 0.0999, label: 0, bag_size: 88
batch 239, loss: 1.1158, instance_loss: 0.5234, weighted_loss: 0.9381, label: 1, bag_size: 384
batch 259, loss: 0.3289, instance_loss: 0.3770, weighted_loss: 0.3433, label: 0, bag_size: 357
batch 279, loss: 1.1263, instance_loss: 0.4191, weighted_loss: 0.9141, label: 3, bag_size: 587
batch 299, loss: 0.5738, instance_loss: 0.4271, weighted_loss: 0.5298, label: 3, bag_size: 369
batch 319, loss: 0.0033, instance_loss: 0.0796, weighted_loss: 0.0262, label: 0, bag_size: 190
batch 339, loss: 2.3800, instance_loss: 0.5791, weighted_loss: 1.8397, label: 4, bag_size: 726
batch 359, loss: 1.9920, instance_loss: 0.5852, weighted_loss: 1.5700, label: 4, bag_size: 196
batch 379, loss: 1.7551, instance_loss: 0.4503, weighted_loss: 1.3637, label: 0, bag_size: 370
batch 399, loss: 0.7145, instance_loss: 0.4545, weighted_loss: 0.6365, label: 3, bag_size: 431
batch 419, loss: 0.1510, instance_loss: 0.4536, weighted_loss: 0.2417, label: 0, bag_size: 141
batch 439, loss: 0.1109, instance_loss: 0.3996, weighted_loss: 0.1975, label: 1, bag_size: 371
batch 459, loss: 4.0305, instance_loss: 0.9566, weighted_loss: 3.1083, label: 1, bag_size: 397
batch 479, loss: 2.4003, instance_loss: 0.6402, weighted_loss: 1.8723, label: 1, bag_size: 113
batch 499, loss: 2.7745, instance_loss: 0.6823, weighted_loss: 2.1468, label: 1, bag_size: 350
batch 519, loss: 0.3672, instance_loss: 0.3782, weighted_loss: 0.3705, label: 3, bag_size: 369
batch 539, loss: 0.5969, instance_loss: 0.4368, weighted_loss: 0.5488, label: 1, bag_size: 1273
batch 559, loss: 0.1773, instance_loss: 0.2733, weighted_loss: 0.2061, label: 0, bag_size: 238
batch 579, loss: 0.0886, instance_loss: 0.2441, weighted_loss: 0.1352, label: 0, bag_size: 513


class 0 clustering acc 0.9936868686868687: correct 23610/23760
class 1 clustering acc 0.10332491582491582: correct 491/4752
Epoch: 37, train_loss: 1.0379, train_clustering_loss:  0.4591, train_error: 0.4327
class 0: acc 0.8032786885245902, correct 98/122
class 1: acc 0.5625, correct 63/112
class 2: acc 0.3492063492063492, correct 44/126
class 3: acc 0.6439393939393939, correct 85/132
class 4: acc 0.46078431372549017, correct 47/102

Val Set, val_loss: 1.4912, val_error: 0.5541, auc: 0.7548
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.09628378378378379: correct 57/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5569, instance_loss: 0.5089, weighted_loss: 0.5425, label: 4, bag_size: 960
batch 39, loss: 1.0770, instance_loss: 0.4557, weighted_loss: 0.8906, label: 3, bag_size: 344
batch 59, loss: 0.3491, instance_loss: 0.3662, weighted_loss: 0.3542, label: 0, bag_size: 282
batch 79, loss: 0.3277, instance_loss: 0.3014, weighted_loss: 0.3198, label: 3, bag_size: 344
batch 99, loss: 1.3871, instance_loss: 0.6142, weighted_loss: 1.1552, label: 4, bag_size: 780
batch 119, loss: 0.5831, instance_loss: 0.5283, weighted_loss: 0.5667, label: 4, bag_size: 744
batch 139, loss: 0.5216, instance_loss: 0.4663, weighted_loss: 0.5050, label: 4, bag_size: 1041
batch 159, loss: 1.2808, instance_loss: 0.4467, weighted_loss: 1.0305, label: 4, bag_size: 176
batch 179, loss: 0.7751, instance_loss: 0.3982, weighted_loss: 0.6620, label: 0, bag_size: 428
batch 199, loss: 0.0285, instance_loss: 0.2536, weighted_loss: 0.0961, label: 0, bag_size: 88
batch 219, loss: 1.3598, instance_loss: 0.5200, weighted_loss: 1.1079, label: 3, bag_size: 301
batch 239, loss: 2.0209, instance_loss: 0.6656, weighted_loss: 1.6143, label: 4, bag_size: 250
batch 259, loss: 1.2315, instance_loss: 0.4685, weighted_loss: 1.0026, label: 2, bag_size: 337
batch 279, loss: 0.0198, instance_loss: 0.1562, weighted_loss: 0.0607, label: 0, bag_size: 79
batch 299, loss: 0.3022, instance_loss: 0.3181, weighted_loss: 0.3070, label: 1, bag_size: 874
batch 319, loss: 0.0307, instance_loss: 0.2821, weighted_loss: 0.1061, label: 1, bag_size: 1497
batch 339, loss: 0.0170, instance_loss: 0.1890, weighted_loss: 0.0686, label: 0, bag_size: 190
batch 359, loss: 3.2220, instance_loss: 0.7704, weighted_loss: 2.4865, label: 3, bag_size: 533
batch 379, loss: 0.7535, instance_loss: 0.4047, weighted_loss: 0.6489, label: 2, bag_size: 1003
batch 399, loss: 1.4010, instance_loss: 0.4765, weighted_loss: 1.1237, label: 4, bag_size: 98
batch 419, loss: 0.5148, instance_loss: 0.4935, weighted_loss: 0.5084, label: 0, bag_size: 62
batch 439, loss: 0.8407, instance_loss: 0.4832, weighted_loss: 0.7334, label: 3, bag_size: 312
batch 459, loss: 0.8873, instance_loss: 0.5342, weighted_loss: 0.7814, label: 3, bag_size: 1021
batch 479, loss: 0.4195, instance_loss: 0.5595, weighted_loss: 0.4615, label: 2, bag_size: 883
batch 499, loss: 1.3644, instance_loss: 0.4113, weighted_loss: 1.0785, label: 4, bag_size: 438
batch 519, loss: 0.3879, instance_loss: 0.4785, weighted_loss: 0.4151, label: 0, bag_size: 760
batch 539, loss: 0.9879, instance_loss: 0.4332, weighted_loss: 0.8215, label: 1, bag_size: 695
batch 559, loss: 1.9660, instance_loss: 0.7357, weighted_loss: 1.5969, label: 2, bag_size: 860
batch 579, loss: 1.0573, instance_loss: 0.5144, weighted_loss: 0.8944, label: 3, bag_size: 1365


class 0 clustering acc 0.9936868686868687: correct 23610/23760
class 1 clustering acc 0.10479797979797979: correct 498/4752
Epoch: 38, train_loss: 1.0438, train_clustering_loss:  0.4632, train_error: 0.4461
class 0: acc 0.7603305785123967, correct 92/121
class 1: acc 0.5702479338842975, correct 69/121
class 2: acc 0.32710280373831774, correct 35/107
class 3: acc 0.5508474576271186, correct 65/118
class 4: acc 0.5354330708661418, correct 68/127

Val Set, val_loss: 1.3752, val_error: 0.5541, auc: 0.7678
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7821, instance_loss: 0.4797, weighted_loss: 0.6914, label: 1, bag_size: 1104
batch 39, loss: 1.0267, instance_loss: 0.4650, weighted_loss: 0.8582, label: 4, bag_size: 727
batch 59, loss: 1.0476, instance_loss: 0.4181, weighted_loss: 0.8588, label: 3, bag_size: 474
batch 79, loss: 0.1232, instance_loss: 0.2972, weighted_loss: 0.1754, label: 0, bag_size: 192
batch 99, loss: 2.9585, instance_loss: 0.6048, weighted_loss: 2.2524, label: 3, bag_size: 342
batch 119, loss: 0.0015, instance_loss: 0.3565, weighted_loss: 0.1080, label: 2, bag_size: 1975
batch 139, loss: 2.0005, instance_loss: 0.5268, weighted_loss: 1.5584, label: 2, bag_size: 852
batch 159, loss: 0.0637, instance_loss: 0.2739, weighted_loss: 0.1268, label: 4, bag_size: 409
batch 179, loss: 2.2356, instance_loss: 0.5461, weighted_loss: 1.7287, label: 4, bag_size: 407
batch 199, loss: 1.0528, instance_loss: 0.4810, weighted_loss: 0.8813, label: 3, bag_size: 746
batch 219, loss: 0.9827, instance_loss: 0.4707, weighted_loss: 0.8291, label: 4, bag_size: 780
batch 239, loss: 0.0033, instance_loss: 0.2165, weighted_loss: 0.0673, label: 0, bag_size: 37
batch 259, loss: 1.6623, instance_loss: 0.5379, weighted_loss: 1.3250, label: 3, bag_size: 98
batch 279, loss: 2.0199, instance_loss: 0.6067, weighted_loss: 1.5960, label: 2, bag_size: 1060
batch 299, loss: 1.3021, instance_loss: 0.5061, weighted_loss: 1.0633, label: 1, bag_size: 599
batch 319, loss: 0.2689, instance_loss: 0.3002, weighted_loss: 0.2783, label: 0, bag_size: 404
batch 339, loss: 0.0749, instance_loss: 0.3737, weighted_loss: 0.1645, label: 0, bag_size: 573
batch 359, loss: 1.2012, instance_loss: 0.5180, weighted_loss: 0.9962, label: 4, bag_size: 506
batch 379, loss: 0.2320, instance_loss: 0.4352, weighted_loss: 0.2930, label: 0, bag_size: 345
batch 399, loss: 0.9562, instance_loss: 0.4828, weighted_loss: 0.8142, label: 1, bag_size: 408
batch 419, loss: 1.0488, instance_loss: 0.4794, weighted_loss: 0.8780, label: 3, bag_size: 423
batch 439, loss: 2.6260, instance_loss: 0.5242, weighted_loss: 1.9955, label: 1, bag_size: 113
batch 459, loss: 1.0645, instance_loss: 0.4863, weighted_loss: 0.8910, label: 4, bag_size: 731
batch 479, loss: 1.4701, instance_loss: 0.5199, weighted_loss: 1.1850, label: 1, bag_size: 1009
batch 499, loss: 1.5400, instance_loss: 0.5214, weighted_loss: 1.2344, label: 2, bag_size: 361
batch 519, loss: 0.0255, instance_loss: 0.2744, weighted_loss: 0.1001, label: 0, bag_size: 71
batch 539, loss: 1.7255, instance_loss: 0.5403, weighted_loss: 1.3699, label: 2, bag_size: 380
batch 559, loss: 0.7600, instance_loss: 0.4015, weighted_loss: 0.6524, label: 3, bag_size: 1021
batch 579, loss: 1.6249, instance_loss: 0.5365, weighted_loss: 1.2984, label: 1, bag_size: 988


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.09490740740740741: correct 451/4752
Epoch: 39, train_loss: 1.0398, train_clustering_loss:  0.4552, train_error: 0.4428
class 0: acc 0.8253968253968254, correct 104/126
class 1: acc 0.5254237288135594, correct 62/118
class 2: acc 0.3488372093023256, correct 45/129
class 3: acc 0.6422764227642277, correct 79/123
class 4: acc 0.41836734693877553, correct 41/98

Val Set, val_loss: 1.7308, val_error: 0.5676, auc: 0.7378
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.15202702702702703: correct 90/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0320, instance_loss: 0.1831, weighted_loss: 0.0773, label: 0, bag_size: 351
batch 39, loss: 1.2146, instance_loss: 0.4623, weighted_loss: 0.9889, label: 2, bag_size: 119
batch 59, loss: 0.7525, instance_loss: 0.3901, weighted_loss: 0.6438, label: 3, bag_size: 510
batch 79, loss: 0.4138, instance_loss: 0.5237, weighted_loss: 0.4468, label: 2, bag_size: 288
batch 99, loss: 1.7718, instance_loss: 0.5584, weighted_loss: 1.4078, label: 2, bag_size: 754
batch 119, loss: 0.9857, instance_loss: 0.4522, weighted_loss: 0.8257, label: 1, bag_size: 960
batch 139, loss: 0.8450, instance_loss: 0.4449, weighted_loss: 0.7249, label: 2, bag_size: 697
batch 159, loss: 0.7858, instance_loss: 0.4717, weighted_loss: 0.6916, label: 4, bag_size: 520
batch 179, loss: 0.0935, instance_loss: 0.1845, weighted_loss: 0.1208, label: 0, bag_size: 282
batch 199, loss: 1.4419, instance_loss: 0.4292, weighted_loss: 1.1381, label: 2, bag_size: 1003
batch 219, loss: 1.4098, instance_loss: 0.5231, weighted_loss: 1.1438, label: 3, bag_size: 681
batch 239, loss: 0.4257, instance_loss: 0.4225, weighted_loss: 0.4248, label: 2, bag_size: 290
batch 259, loss: 1.4646, instance_loss: 0.5262, weighted_loss: 1.1831, label: 3, bag_size: 608
batch 279, loss: 0.4588, instance_loss: 0.3730, weighted_loss: 0.4331, label: 0, bag_size: 393
batch 299, loss: 2.1016, instance_loss: 0.5582, weighted_loss: 1.6386, label: 3, bag_size: 486
batch 319, loss: 0.7101, instance_loss: 0.5297, weighted_loss: 0.6560, label: 1, bag_size: 381
batch 339, loss: 1.0813, instance_loss: 0.4953, weighted_loss: 0.9055, label: 4, bag_size: 590
batch 359, loss: 0.4157, instance_loss: 0.5197, weighted_loss: 0.4469, label: 3, bag_size: 301
batch 379, loss: 1.3981, instance_loss: 0.5139, weighted_loss: 1.1328, label: 1, bag_size: 159
batch 399, loss: 1.2335, instance_loss: 0.4523, weighted_loss: 0.9991, label: 2, bag_size: 421
batch 419, loss: 0.7682, instance_loss: 0.4493, weighted_loss: 0.6726, label: 2, bag_size: 470
batch 439, loss: 0.0783, instance_loss: 0.5557, weighted_loss: 0.2215, label: 4, bag_size: 530
batch 459, loss: 2.5879, instance_loss: 0.5226, weighted_loss: 1.9683, label: 3, bag_size: 154
batch 479, loss: 0.4152, instance_loss: 0.4439, weighted_loss: 0.4238, label: 2, bag_size: 266
batch 499, loss: 1.1919, instance_loss: 0.3799, weighted_loss: 0.9483, label: 4, bag_size: 703
batch 519, loss: 1.9440, instance_loss: 0.5938, weighted_loss: 1.5389, label: 4, bag_size: 342
batch 539, loss: 0.0208, instance_loss: 0.1137, weighted_loss: 0.0487, label: 0, bag_size: 488
batch 559, loss: 0.5462, instance_loss: 0.4843, weighted_loss: 0.5277, label: 2, bag_size: 1066
batch 579, loss: 0.0669, instance_loss: 0.2431, weighted_loss: 0.1198, label: 0, bag_size: 523


class 0 clustering acc 0.9939393939393939: correct 23616/23760
class 1 clustering acc 0.1029040404040404: correct 489/4752
Epoch: 40, train_loss: 1.0310, train_clustering_loss:  0.4610, train_error: 0.4175
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.5754716981132075, correct 61/106
class 2: acc 0.4838709677419355, correct 60/124
class 3: acc 0.592, correct 74/125
class 4: acc 0.45132743362831856, correct 51/113

Val Set, val_loss: 1.4589, val_error: 0.6216, auc: 0.7566
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.07094594594594594: correct 42/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4832, instance_loss: 0.6034, weighted_loss: 1.2193, label: 2, bag_size: 498
batch 39, loss: 2.1598, instance_loss: 0.5984, weighted_loss: 1.6914, label: 0, bag_size: 964
batch 59, loss: 2.0138, instance_loss: 0.6276, weighted_loss: 1.5980, label: 4, bag_size: 399
batch 79, loss: 1.7360, instance_loss: 0.5702, weighted_loss: 1.3863, label: 2, bag_size: 754
batch 99, loss: 0.2731, instance_loss: 0.3863, weighted_loss: 0.3071, label: 4, bag_size: 895
batch 119, loss: 0.7386, instance_loss: 0.4694, weighted_loss: 0.6578, label: 0, bag_size: 367
batch 139, loss: 0.8274, instance_loss: 0.4432, weighted_loss: 0.7121, label: 1, bag_size: 742
batch 159, loss: 0.7910, instance_loss: 0.3734, weighted_loss: 0.6657, label: 0, bag_size: 277
batch 179, loss: 0.0005, instance_loss: 0.0996, weighted_loss: 0.0302, label: 0, bag_size: 706
batch 199, loss: 0.3043, instance_loss: 0.3446, weighted_loss: 0.3164, label: 2, bag_size: 607
batch 219, loss: 1.0266, instance_loss: 0.5471, weighted_loss: 0.8827, label: 1, bag_size: 384
batch 239, loss: 1.1699, instance_loss: 0.4872, weighted_loss: 0.9651, label: 1, bag_size: 960
batch 259, loss: 3.5379, instance_loss: 0.7862, weighted_loss: 2.7124, label: 1, bag_size: 1082
batch 279, loss: 0.9822, instance_loss: 0.5082, weighted_loss: 0.8400, label: 1, bag_size: 949
batch 299, loss: 0.9258, instance_loss: 0.4673, weighted_loss: 0.7882, label: 2, bag_size: 337
batch 319, loss: 0.7823, instance_loss: 0.6709, weighted_loss: 0.7488, label: 2, bag_size: 321
batch 339, loss: 3.8441, instance_loss: 0.7526, weighted_loss: 2.9167, label: 0, bag_size: 745
batch 359, loss: 0.4178, instance_loss: 0.4378, weighted_loss: 0.4238, label: 3, bag_size: 369
batch 379, loss: 1.3187, instance_loss: 0.4402, weighted_loss: 1.0552, label: 2, bag_size: 421
batch 399, loss: 0.5253, instance_loss: 0.3867, weighted_loss: 0.4837, label: 2, bag_size: 582
batch 419, loss: 0.6161, instance_loss: 0.4629, weighted_loss: 0.5701, label: 4, bag_size: 730
batch 439, loss: 2.4633, instance_loss: 0.6411, weighted_loss: 1.9167, label: 0, bag_size: 745
batch 459, loss: 2.1155, instance_loss: 0.4589, weighted_loss: 1.6186, label: 0, bag_size: 1073
batch 479, loss: 0.8604, instance_loss: 0.4977, weighted_loss: 0.7516, label: 3, bag_size: 344
batch 499, loss: 0.4664, instance_loss: 0.4026, weighted_loss: 0.4472, label: 1, bag_size: 766
batch 519, loss: 0.0318, instance_loss: 0.2778, weighted_loss: 0.1056, label: 4, bag_size: 124
batch 539, loss: 0.9799, instance_loss: 0.3674, weighted_loss: 0.7961, label: 4, bag_size: 438
batch 559, loss: 0.3638, instance_loss: 0.2748, weighted_loss: 0.3371, label: 4, bag_size: 418
batch 579, loss: 0.5165, instance_loss: 0.4558, weighted_loss: 0.4983, label: 1, bag_size: 972


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.09048821548821549: correct 430/4752
Epoch: 41, train_loss: 0.9990, train_clustering_loss:  0.4556, train_error: 0.4074
class 0: acc 0.7931034482758621, correct 92/116
class 1: acc 0.4915254237288136, correct 58/118
class 2: acc 0.578125, correct 74/128
class 3: acc 0.5495495495495496, correct 61/111
class 4: acc 0.5537190082644629, correct 67/121

Val Set, val_loss: 1.5479, val_error: 0.5946, auc: 0.7562
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0067, instance_loss: 0.0976, weighted_loss: 0.0340, label: 0, bag_size: 230
batch 39, loss: 0.7348, instance_loss: 0.4340, weighted_loss: 0.6446, label: 3, bag_size: 322
batch 59, loss: 0.5007, instance_loss: 0.4056, weighted_loss: 0.4722, label: 3, bag_size: 781
batch 79, loss: 2.7526, instance_loss: 0.6234, weighted_loss: 2.1138, label: 2, bag_size: 185
batch 99, loss: 1.2010, instance_loss: 0.4842, weighted_loss: 0.9859, label: 1, bag_size: 483
batch 119, loss: 0.6038, instance_loss: 0.4194, weighted_loss: 0.5485, label: 4, bag_size: 923
batch 139, loss: 0.0627, instance_loss: 0.2914, weighted_loss: 0.1313, label: 0, bag_size: 70
batch 159, loss: 0.5412, instance_loss: 0.4222, weighted_loss: 0.5055, label: 4, bag_size: 468
batch 179, loss: 1.4571, instance_loss: 0.5752, weighted_loss: 1.1926, label: 2, bag_size: 549
batch 199, loss: 0.0106, instance_loss: 0.1322, weighted_loss: 0.0471, label: 0, bag_size: 101
batch 219, loss: 0.9580, instance_loss: 0.3869, weighted_loss: 0.7867, label: 2, bag_size: 380
batch 239, loss: 0.0615, instance_loss: 0.2366, weighted_loss: 0.1141, label: 0, bag_size: 79
batch 259, loss: 0.1901, instance_loss: 0.3511, weighted_loss: 0.2384, label: 1, bag_size: 886
batch 279, loss: 1.8702, instance_loss: 0.5675, weighted_loss: 1.4794, label: 4, bag_size: 407
batch 299, loss: 1.4077, instance_loss: 0.4595, weighted_loss: 1.1232, label: 2, bag_size: 543
batch 319, loss: 0.5677, instance_loss: 0.3770, weighted_loss: 0.5105, label: 4, bag_size: 1041
batch 339, loss: 0.1789, instance_loss: 0.4076, weighted_loss: 0.2475, label: 4, bag_size: 725
batch 359, loss: 2.6859, instance_loss: 0.5830, weighted_loss: 2.0550, label: 3, bag_size: 533
batch 379, loss: 0.6945, instance_loss: 0.4253, weighted_loss: 0.6137, label: 3, bag_size: 496
batch 399, loss: 0.7670, instance_loss: 0.4798, weighted_loss: 0.6808, label: 4, bag_size: 267
batch 419, loss: 1.5154, instance_loss: 0.5307, weighted_loss: 1.2200, label: 0, bag_size: 581
batch 439, loss: 0.7703, instance_loss: 0.5187, weighted_loss: 0.6949, label: 4, bag_size: 730
batch 459, loss: 1.2477, instance_loss: 0.5588, weighted_loss: 1.0410, label: 3, bag_size: 598
batch 479, loss: 2.3366, instance_loss: 0.5650, weighted_loss: 1.8051, label: 2, bag_size: 1071
batch 499, loss: 0.5817, instance_loss: 0.4064, weighted_loss: 0.5291, label: 1, bag_size: 106
batch 519, loss: 0.9141, instance_loss: 0.5752, weighted_loss: 0.8124, label: 0, bag_size: 367
batch 539, loss: 0.8545, instance_loss: 0.5070, weighted_loss: 0.7503, label: 1, bag_size: 328
batch 559, loss: 0.6711, instance_loss: 0.4573, weighted_loss: 0.6069, label: 1, bag_size: 1009
batch 579, loss: 2.8985, instance_loss: 0.5776, weighted_loss: 2.2023, label: 4, bag_size: 853


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.08249158249158249: correct 392/4752
Epoch: 42, train_loss: 1.0471, train_clustering_loss:  0.4617, train_error: 0.4495
class 0: acc 0.7017543859649122, correct 80/114
class 1: acc 0.54, correct 54/100
class 2: acc 0.42657342657342656, correct 61/143
class 3: acc 0.5446428571428571, correct 61/112
class 4: acc 0.568, correct 71/125

Val Set, val_loss: 1.4982, val_error: 0.5676, auc: 0.7551
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0377, instance_loss: 0.1984, weighted_loss: 0.0859, label: 0, bag_size: 351
batch 39, loss: 1.9027, instance_loss: 0.5928, weighted_loss: 1.5097, label: 2, bag_size: 744
batch 59, loss: 0.1865, instance_loss: 0.3580, weighted_loss: 0.2379, label: 0, bag_size: 573
batch 79, loss: 0.6231, instance_loss: 0.4200, weighted_loss: 0.5622, label: 4, bag_size: 703
batch 99, loss: 0.7455, instance_loss: 0.5277, weighted_loss: 0.6801, label: 1, bag_size: 161
batch 119, loss: 1.1466, instance_loss: 0.4954, weighted_loss: 0.9512, label: 2, bag_size: 119
batch 139, loss: 1.3793, instance_loss: 0.4197, weighted_loss: 1.0914, label: 0, bag_size: 615
batch 159, loss: 0.5976, instance_loss: 0.3925, weighted_loss: 0.5361, label: 4, bag_size: 895
batch 179, loss: 1.0258, instance_loss: 0.5434, weighted_loss: 0.8810, label: 1, bag_size: 500
batch 199, loss: 0.0300, instance_loss: 0.1357, weighted_loss: 0.0617, label: 0, bag_size: 488
batch 219, loss: 0.2974, instance_loss: 0.3684, weighted_loss: 0.3187, label: 0, bag_size: 493
batch 239, loss: 2.1793, instance_loss: 0.6432, weighted_loss: 1.7185, label: 2, bag_size: 852
batch 259, loss: 0.6048, instance_loss: 0.3551, weighted_loss: 0.5299, label: 3, bag_size: 102
batch 279, loss: 1.6464, instance_loss: 0.6435, weighted_loss: 1.3455, label: 0, bag_size: 143
batch 299, loss: 0.9318, instance_loss: 0.4765, weighted_loss: 0.7952, label: 3, bag_size: 398
batch 319, loss: 1.8745, instance_loss: 0.5919, weighted_loss: 1.4897, label: 0, bag_size: 888
batch 339, loss: 0.6266, instance_loss: 0.4795, weighted_loss: 0.5825, label: 4, bag_size: 1064
batch 359, loss: 1.2106, instance_loss: 0.4381, weighted_loss: 0.9788, label: 3, bag_size: 615
batch 379, loss: 0.5909, instance_loss: 0.4591, weighted_loss: 0.5514, label: 2, bag_size: 410
batch 399, loss: 2.2672, instance_loss: 0.5901, weighted_loss: 1.7641, label: 0, bag_size: 305
batch 419, loss: 1.3643, instance_loss: 0.5637, weighted_loss: 1.1241, label: 3, bag_size: 1365
batch 439, loss: 0.8360, instance_loss: 0.3818, weighted_loss: 0.6998, label: 1, bag_size: 534
batch 459, loss: 0.0468, instance_loss: 0.2455, weighted_loss: 0.1064, label: 0, bag_size: 513
batch 479, loss: 0.9906, instance_loss: 0.5035, weighted_loss: 0.8445, label: 2, bag_size: 781
batch 499, loss: 0.0482, instance_loss: 0.2240, weighted_loss: 0.1009, label: 0, bag_size: 70
batch 519, loss: 0.6287, instance_loss: 0.3752, weighted_loss: 0.5526, label: 1, bag_size: 605
batch 539, loss: 1.7062, instance_loss: 0.7325, weighted_loss: 1.4141, label: 2, bag_size: 96
batch 559, loss: 6.9564, instance_loss: 1.3553, weighted_loss: 5.2761, label: 2, bag_size: 1975
batch 579, loss: 1.3840, instance_loss: 0.4434, weighted_loss: 1.1018, label: 4, bag_size: 356


class 0 clustering acc 0.9934343434343434: correct 23604/23760
class 1 clustering acc 0.07996632996632996: correct 380/4752
Epoch: 43, train_loss: 1.0579, train_clustering_loss:  0.4648, train_error: 0.4512
class 0: acc 0.7280701754385965, correct 83/114
class 1: acc 0.6, correct 84/140
class 2: acc 0.39669421487603307, correct 48/121
class 3: acc 0.4485981308411215, correct 48/107
class 4: acc 0.5625, correct 63/112

Val Set, val_loss: 1.5468, val_error: 0.5135, auc: 0.7650
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1532, instance_loss: 0.3707, weighted_loss: 0.2184, label: 0, bag_size: 288
batch 39, loss: 0.8128, instance_loss: 0.5430, weighted_loss: 0.7319, label: 1, bag_size: 384
batch 59, loss: 1.6637, instance_loss: 0.4531, weighted_loss: 1.3005, label: 2, bag_size: 851
batch 79, loss: 0.9139, instance_loss: 0.4280, weighted_loss: 0.7681, label: 4, bag_size: 53
batch 99, loss: 0.0277, instance_loss: 0.2540, weighted_loss: 0.0956, label: 0, bag_size: 306
batch 119, loss: 1.0579, instance_loss: 0.5582, weighted_loss: 0.9080, label: 3, bag_size: 1078
batch 139, loss: 3.0656, instance_loss: 0.8034, weighted_loss: 2.3870, label: 0, bag_size: 492
batch 159, loss: 0.9484, instance_loss: 0.3796, weighted_loss: 0.7778, label: 1, bag_size: 634
batch 179, loss: 1.0008, instance_loss: 0.4584, weighted_loss: 0.8380, label: 3, bag_size: 779
batch 199, loss: 0.9042, instance_loss: 0.3973, weighted_loss: 0.7521, label: 1, bag_size: 829
batch 219, loss: 0.7436, instance_loss: 0.4342, weighted_loss: 0.6508, label: 3, bag_size: 1154
batch 239, loss: 0.6672, instance_loss: 0.4426, weighted_loss: 0.5998, label: 3, bag_size: 245
batch 259, loss: 0.8197, instance_loss: 0.4176, weighted_loss: 0.6990, label: 4, bag_size: 356
batch 279, loss: 1.4334, instance_loss: 0.5255, weighted_loss: 1.1610, label: 4, bag_size: 757
batch 299, loss: 0.9650, instance_loss: 0.5099, weighted_loss: 0.8285, label: 4, bag_size: 683
batch 319, loss: 0.9500, instance_loss: 0.4984, weighted_loss: 0.8145, label: 0, bag_size: 478
batch 339, loss: 0.0746, instance_loss: 0.2498, weighted_loss: 0.1272, label: 0, bag_size: 212
batch 359, loss: 0.6695, instance_loss: 0.4506, weighted_loss: 0.6038, label: 1, bag_size: 851
batch 379, loss: 0.2242, instance_loss: 0.5777, weighted_loss: 0.3302, label: 4, bag_size: 359
batch 399, loss: 1.1364, instance_loss: 0.4265, weighted_loss: 0.9234, label: 1, bag_size: 389
batch 419, loss: 0.1333, instance_loss: 0.3007, weighted_loss: 0.1836, label: 4, bag_size: 923
batch 439, loss: 0.8065, instance_loss: 0.4821, weighted_loss: 0.7092, label: 3, bag_size: 1078
batch 459, loss: 0.0493, instance_loss: 0.2392, weighted_loss: 0.1062, label: 0, bag_size: 366
batch 479, loss: 0.4667, instance_loss: 0.5567, weighted_loss: 0.4937, label: 2, bag_size: 240
batch 499, loss: 0.8243, instance_loss: 0.4509, weighted_loss: 0.7122, label: 3, bag_size: 779
batch 519, loss: 0.5200, instance_loss: 0.3997, weighted_loss: 0.4839, label: 1, bag_size: 906
batch 539, loss: 0.7442, instance_loss: 0.5547, weighted_loss: 0.6874, label: 4, bag_size: 267
batch 559, loss: 0.0892, instance_loss: 0.2539, weighted_loss: 0.1386, label: 0, bag_size: 88
batch 579, loss: 2.1002, instance_loss: 0.9431, weighted_loss: 1.7531, label: 2, bag_size: 258


class 0 clustering acc 0.9952020202020202: correct 23646/23760
class 1 clustering acc 0.10521885521885523: correct 500/4752
Epoch: 44, train_loss: 1.0161, train_clustering_loss:  0.4555, train_error: 0.4192
class 0: acc 0.8043478260869565, correct 111/138
class 1: acc 0.7279411764705882, correct 99/136
class 2: acc 0.23529411764705882, correct 24/102
class 3: acc 0.49523809523809526, correct 52/105
class 4: acc 0.5221238938053098, correct 59/113

Val Set, val_loss: 1.6408, val_error: 0.5541, auc: 0.7426
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.0929054054054054: correct 55/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5718, instance_loss: 0.3924, weighted_loss: 0.5180, label: 1, bag_size: 906
batch 39, loss: 0.7926, instance_loss: 0.4734, weighted_loss: 0.6968, label: 4, bag_size: 695
batch 59, loss: 1.2520, instance_loss: 0.5491, weighted_loss: 1.0411, label: 3, bag_size: 432
batch 79, loss: 2.6998, instance_loss: 0.5663, weighted_loss: 2.0598, label: 0, bag_size: 1073
batch 99, loss: 1.0560, instance_loss: 0.4947, weighted_loss: 0.8876, label: 3, bag_size: 1060
batch 119, loss: 0.0153, instance_loss: 0.1149, weighted_loss: 0.0452, label: 1, bag_size: 874
batch 139, loss: 1.0942, instance_loss: 0.3740, weighted_loss: 0.8781, label: 4, bag_size: 604
batch 159, loss: 0.8321, instance_loss: 0.4322, weighted_loss: 0.7121, label: 1, bag_size: 534
batch 179, loss: 0.0216, instance_loss: 0.3030, weighted_loss: 0.1060, label: 4, bag_size: 124
batch 199, loss: 1.0036, instance_loss: 0.4855, weighted_loss: 0.8482, label: 2, bag_size: 554
batch 219, loss: 0.5726, instance_loss: 0.3755, weighted_loss: 0.5135, label: 0, bag_size: 393
batch 239, loss: 0.0135, instance_loss: 0.1314, weighted_loss: 0.0489, label: 0, bag_size: 71
batch 259, loss: 0.9282, instance_loss: 0.5604, weighted_loss: 0.8179, label: 1, bag_size: 483
batch 279, loss: 1.0128, instance_loss: 0.4110, weighted_loss: 0.8322, label: 2, bag_size: 941
batch 299, loss: 0.0032, instance_loss: 0.2051, weighted_loss: 0.0638, label: 4, bag_size: 813
batch 319, loss: 0.4953, instance_loss: 0.3641, weighted_loss: 0.4560, label: 2, bag_size: 348
batch 339, loss: 0.7176, instance_loss: 0.4870, weighted_loss: 0.6484, label: 4, bag_size: 731
batch 359, loss: 0.8769, instance_loss: 0.4736, weighted_loss: 0.7559, label: 1, bag_size: 695
batch 379, loss: 0.6939, instance_loss: 0.4876, weighted_loss: 0.6320, label: 4, bag_size: 683
batch 399, loss: 1.6470, instance_loss: 0.5241, weighted_loss: 1.3102, label: 2, bag_size: 380
batch 419, loss: 0.7377, instance_loss: 0.4992, weighted_loss: 0.6661, label: 1, bag_size: 381
batch 439, loss: 0.8398, instance_loss: 0.3992, weighted_loss: 0.7076, label: 4, bag_size: 960
batch 459, loss: 0.3648, instance_loss: 0.3823, weighted_loss: 0.3700, label: 0, bag_size: 62
batch 479, loss: 3.6007, instance_loss: 0.5406, weighted_loss: 2.6827, label: 1, bag_size: 1082
batch 499, loss: 0.0009, instance_loss: 0.4704, weighted_loss: 0.1417, label: 0, bag_size: 175
batch 519, loss: 2.7273, instance_loss: 0.7141, weighted_loss: 2.1234, label: 0, bag_size: 964
batch 539, loss: 0.6563, instance_loss: 0.4020, weighted_loss: 0.5800, label: 4, bag_size: 228
batch 559, loss: 2.3985, instance_loss: 0.5851, weighted_loss: 1.8545, label: 2, bag_size: 331
batch 579, loss: 2.7176, instance_loss: 0.6393, weighted_loss: 2.0941, label: 2, bag_size: 720


class 0 clustering acc 0.9953282828282828: correct 23649/23760
class 1 clustering acc 0.11868686868686869: correct 564/4752
Epoch: 45, train_loss: 0.9820, train_clustering_loss:  0.4524, train_error: 0.4024
class 0: acc 0.8461538461538461, correct 110/130
class 1: acc 0.5, correct 54/108
class 2: acc 0.421875, correct 54/128
class 3: acc 0.6228070175438597, correct 71/114
class 4: acc 0.5789473684210527, correct 66/114

Val Set, val_loss: 1.5265, val_error: 0.5541, auc: 0.7509
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 3.3764, instance_loss: 0.6189, weighted_loss: 2.5491, label: 3, bag_size: 508
batch 39, loss: 1.1703, instance_loss: 0.4535, weighted_loss: 0.9553, label: 3, bag_size: 351
batch 59, loss: 1.3186, instance_loss: 0.5636, weighted_loss: 1.0921, label: 1, bag_size: 960
batch 79, loss: 0.0422, instance_loss: 0.2555, weighted_loss: 0.1062, label: 0, bag_size: 79
batch 99, loss: 1.1038, instance_loss: 0.5562, weighted_loss: 0.9396, label: 2, bag_size: 549
batch 119, loss: 0.3014, instance_loss: 0.2876, weighted_loss: 0.2973, label: 1, bag_size: 748
batch 139, loss: 0.0613, instance_loss: 0.1800, weighted_loss: 0.0969, label: 0, bag_size: 98
batch 159, loss: 3.5941, instance_loss: 0.6120, weighted_loss: 2.6995, label: 0, bag_size: 273
batch 179, loss: 2.8066, instance_loss: 0.5555, weighted_loss: 2.1313, label: 0, bag_size: 273
batch 199, loss: 0.3032, instance_loss: 0.3885, weighted_loss: 0.3288, label: 4, bag_size: 520
batch 219, loss: 0.7326, instance_loss: 0.4405, weighted_loss: 0.6450, label: 1, bag_size: 1103
batch 239, loss: 1.2262, instance_loss: 0.4807, weighted_loss: 1.0025, label: 4, bag_size: 589
batch 259, loss: 0.8314, instance_loss: 0.4217, weighted_loss: 0.7085, label: 4, bag_size: 689
batch 279, loss: 0.7661, instance_loss: 0.4273, weighted_loss: 0.6644, label: 2, bag_size: 799
batch 299, loss: 0.7702, instance_loss: 0.4024, weighted_loss: 0.6598, label: 2, bag_size: 781
batch 319, loss: 1.1894, instance_loss: 0.5380, weighted_loss: 0.9940, label: 2, bag_size: 781
batch 339, loss: 1.2303, instance_loss: 0.4731, weighted_loss: 1.0032, label: 2, bag_size: 421
batch 359, loss: 0.8463, instance_loss: 0.6986, weighted_loss: 0.8020, label: 2, bag_size: 96
batch 379, loss: 0.9440, instance_loss: 0.4565, weighted_loss: 0.7977, label: 3, bag_size: 781
batch 399, loss: 1.4114, instance_loss: 0.4767, weighted_loss: 1.1310, label: 1, bag_size: 981
batch 419, loss: 3.8243, instance_loss: 0.6511, weighted_loss: 2.8724, label: 3, bag_size: 393
batch 439, loss: 1.1413, instance_loss: 0.6017, weighted_loss: 0.9794, label: 1, bag_size: 159
batch 459, loss: 0.5329, instance_loss: 0.4133, weighted_loss: 0.4970, label: 1, bag_size: 500
batch 479, loss: 0.3875, instance_loss: 0.3591, weighted_loss: 0.3790, label: 0, bag_size: 73
batch 499, loss: 1.8183, instance_loss: 0.5352, weighted_loss: 1.4333, label: 2, bag_size: 844
batch 519, loss: 1.1172, instance_loss: 0.4887, weighted_loss: 0.9287, label: 1, bag_size: 1043
batch 539, loss: 1.2655, instance_loss: 0.4914, weighted_loss: 1.0333, label: 2, bag_size: 549
batch 559, loss: 0.8924, instance_loss: 0.4693, weighted_loss: 0.7655, label: 3, bag_size: 608
batch 579, loss: 1.6396, instance_loss: 0.5989, weighted_loss: 1.3274, label: 0, bag_size: 247


class 0 clustering acc 0.9946127946127946: correct 23632/23760
class 1 clustering acc 0.0867003367003367: correct 412/4752
Epoch: 46, train_loss: 1.0152, train_clustering_loss:  0.4579, train_error: 0.4428
class 0: acc 0.7672413793103449, correct 89/116
class 1: acc 0.5726495726495726, correct 67/117
class 2: acc 0.4, correct 52/130
class 3: acc 0.509090909090909, correct 56/110
class 4: acc 0.5537190082644629, correct 67/121

Val Set, val_loss: 1.7386, val_error: 0.5811, auc: 0.7394
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7494, instance_loss: 0.4657, weighted_loss: 0.6643, label: 1, bag_size: 381
batch 39, loss: 1.6641, instance_loss: 0.6534, weighted_loss: 1.3608, label: 2, bag_size: 398
batch 59, loss: 2.7316, instance_loss: 0.5876, weighted_loss: 2.0884, label: 3, bag_size: 323
batch 79, loss: 0.8935, instance_loss: 0.6111, weighted_loss: 0.8087, label: 4, bag_size: 886
batch 99, loss: 0.1230, instance_loss: 0.2625, weighted_loss: 0.1648, label: 0, bag_size: 397
batch 119, loss: 0.9960, instance_loss: 0.6016, weighted_loss: 0.8777, label: 2, bag_size: 837
batch 139, loss: 1.4038, instance_loss: 0.5059, weighted_loss: 1.1344, label: 2, bag_size: 558
batch 159, loss: 0.3695, instance_loss: 0.3604, weighted_loss: 0.3668, label: 3, bag_size: 322
batch 179, loss: 1.6884, instance_loss: 0.6710, weighted_loss: 1.3832, label: 2, bag_size: 171
batch 199, loss: 1.4767, instance_loss: 0.4140, weighted_loss: 1.1579, label: 2, bag_size: 877
batch 219, loss: 1.9230, instance_loss: 0.5153, weighted_loss: 1.5007, label: 4, bag_size: 342
batch 239, loss: 0.3320, instance_loss: 0.3465, weighted_loss: 0.3364, label: 3, bag_size: 235
batch 259, loss: 0.6079, instance_loss: 0.6099, weighted_loss: 0.6085, label: 2, bag_size: 375
batch 279, loss: 1.4851, instance_loss: 0.6157, weighted_loss: 1.2243, label: 3, bag_size: 282
batch 299, loss: 2.0714, instance_loss: 0.4917, weighted_loss: 1.5975, label: 4, bag_size: 98
batch 319, loss: 0.0009, instance_loss: 0.3749, weighted_loss: 0.1131, label: 2, bag_size: 553
batch 339, loss: 1.7339, instance_loss: 0.8575, weighted_loss: 1.4709, label: 3, bag_size: 403
batch 359, loss: 1.6843, instance_loss: 0.6019, weighted_loss: 1.3596, label: 3, bag_size: 98
batch 379, loss: 0.6306, instance_loss: 0.6394, weighted_loss: 0.6333, label: 2, bag_size: 128
batch 399, loss: 0.7748, instance_loss: 0.3910, weighted_loss: 0.6596, label: 3, bag_size: 496
batch 419, loss: 0.0176, instance_loss: 0.2555, weighted_loss: 0.0889, label: 0, bag_size: 517
batch 439, loss: 1.0410, instance_loss: 0.6084, weighted_loss: 0.9112, label: 2, bag_size: 303
batch 459, loss: 0.0800, instance_loss: 0.1963, weighted_loss: 0.1149, label: 0, bag_size: 156
batch 479, loss: 2.4003, instance_loss: 0.6204, weighted_loss: 1.8663, label: 0, bag_size: 587
batch 499, loss: 0.1529, instance_loss: 0.2122, weighted_loss: 0.1707, label: 0, bag_size: 319
batch 519, loss: 0.6259, instance_loss: 0.3359, weighted_loss: 0.5389, label: 3, bag_size: 309
batch 539, loss: 0.5505, instance_loss: 0.3795, weighted_loss: 0.4992, label: 3, bag_size: 495
batch 559, loss: 0.0078, instance_loss: 0.1919, weighted_loss: 0.0630, label: 0, bag_size: 37
batch 579, loss: 0.7688, instance_loss: 0.3922, weighted_loss: 0.6558, label: 3, bag_size: 781


class 0 clustering acc 0.9946548821548822: correct 23633/23760
class 1 clustering acc 0.13215488215488216: correct 628/4752
Epoch: 47, train_loss: 0.9635, train_clustering_loss:  0.4469, train_error: 0.4024
class 0: acc 0.8297872340425532, correct 117/141
class 1: acc 0.646551724137931, correct 75/116
class 2: acc 0.3963963963963964, correct 44/111
class 3: acc 0.6451612903225806, correct 80/124
class 4: acc 0.38235294117647056, correct 39/102

Val Set, val_loss: 1.7135, val_error: 0.5811, auc: 0.7578
class 0 clustering acc 0.9881756756756757: correct 2925/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8084, instance_loss: 0.4217, weighted_loss: 0.6924, label: 1, bag_size: 892
batch 39, loss: 1.0658, instance_loss: 0.4716, weighted_loss: 0.8875, label: 1, bag_size: 311
batch 59, loss: 3.9780, instance_loss: 0.7086, weighted_loss: 2.9972, label: 0, bag_size: 1039
batch 79, loss: 0.5851, instance_loss: 0.4816, weighted_loss: 0.5541, label: 3, bag_size: 899
batch 99, loss: 0.4451, instance_loss: 0.3460, weighted_loss: 0.4154, label: 3, bag_size: 625
batch 119, loss: 1.5222, instance_loss: 0.6544, weighted_loss: 1.2619, label: 2, bag_size: 549
batch 139, loss: 0.5391, instance_loss: 0.4239, weighted_loss: 0.5045, label: 1, bag_size: 1103
batch 159, loss: 1.6315, instance_loss: 0.6149, weighted_loss: 1.3266, label: 4, bag_size: 699
batch 179, loss: 1.2503, instance_loss: 0.4824, weighted_loss: 1.0199, label: 2, bag_size: 299
batch 199, loss: 0.0723, instance_loss: 0.2623, weighted_loss: 0.1293, label: 0, bag_size: 354
batch 219, loss: 0.5223, instance_loss: 0.4553, weighted_loss: 0.5022, label: 3, bag_size: 1021
batch 239, loss: 2.8751, instance_loss: 0.5328, weighted_loss: 2.1724, label: 1, bag_size: 988
batch 259, loss: 0.0790, instance_loss: 0.2547, weighted_loss: 0.1317, label: 0, bag_size: 357
batch 279, loss: 1.0868, instance_loss: 0.4604, weighted_loss: 0.8989, label: 1, bag_size: 490
batch 299, loss: 2.2473, instance_loss: 0.5690, weighted_loss: 1.7438, label: 2, bag_size: 185
batch 319, loss: 1.3635, instance_loss: 0.4772, weighted_loss: 1.0976, label: 3, bag_size: 364
batch 339, loss: 0.0270, instance_loss: 0.1724, weighted_loss: 0.0706, label: 0, bag_size: 351
batch 359, loss: 1.3463, instance_loss: 0.5426, weighted_loss: 1.1052, label: 3, bag_size: 598
batch 379, loss: 0.0281, instance_loss: 0.1886, weighted_loss: 0.0763, label: 0, bag_size: 188
batch 399, loss: 0.0062, instance_loss: 0.1494, weighted_loss: 0.0492, label: 0, bag_size: 190
batch 419, loss: 2.9233, instance_loss: 0.6150, weighted_loss: 2.2308, label: 2, bag_size: 244
batch 439, loss: 0.8038, instance_loss: 0.5054, weighted_loss: 0.7143, label: 4, bag_size: 1113
batch 459, loss: 0.0152, instance_loss: 0.7199, weighted_loss: 0.2266, label: 0, bag_size: 1570
batch 479, loss: 0.7753, instance_loss: 0.4043, weighted_loss: 0.6640, label: 1, bag_size: 886
batch 499, loss: 2.6206, instance_loss: 0.5582, weighted_loss: 2.0019, label: 0, bag_size: 492
batch 519, loss: 0.1659, instance_loss: 0.4360, weighted_loss: 0.2469, label: 0, bag_size: 224
batch 539, loss: 1.5855, instance_loss: 0.6417, weighted_loss: 1.3024, label: 2, bag_size: 860
batch 559, loss: 0.0894, instance_loss: 0.2966, weighted_loss: 0.1516, label: 0, bag_size: 59
batch 579, loss: 0.7659, instance_loss: 0.5796, weighted_loss: 0.7100, label: 2, bag_size: 684


class 0 clustering acc 0.9943602693602693: correct 23626/23760
class 1 clustering acc 0.10458754208754209: correct 497/4752
Epoch: 48, train_loss: 0.9114, train_clustering_loss:  0.4514, train_error: 0.3889
class 0: acc 0.823943661971831, correct 117/142
class 1: acc 0.6551724137931034, correct 76/116
class 2: acc 0.3217391304347826, correct 37/115
class 3: acc 0.6869565217391305, correct 79/115
class 4: acc 0.5094339622641509, correct 54/106

Val Set, val_loss: 1.6779, val_error: 0.5135, auc: 0.7510
class 0 clustering acc 0.9915540540540541: correct 2935/2960
class 1 clustering acc 0.037162162162162164: correct 22/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8418, instance_loss: 0.4096, weighted_loss: 0.7122, label: 1, bag_size: 855
batch 39, loss: 0.9286, instance_loss: 0.4694, weighted_loss: 0.7908, label: 1, bag_size: 141
batch 59, loss: 1.3060, instance_loss: 0.5477, weighted_loss: 1.0785, label: 2, bag_size: 549
batch 79, loss: 0.2210, instance_loss: 0.4317, weighted_loss: 0.2842, label: 2, bag_size: 614
batch 99, loss: 1.7870, instance_loss: 0.4585, weighted_loss: 1.3884, label: 4, bag_size: 438
batch 119, loss: 0.3874, instance_loss: 0.3353, weighted_loss: 0.3718, label: 4, bag_size: 875
batch 139, loss: 1.2182, instance_loss: 0.4925, weighted_loss: 1.0005, label: 1, bag_size: 398
batch 159, loss: 1.2666, instance_loss: 0.4530, weighted_loss: 1.0225, label: 1, bag_size: 389
batch 179, loss: 0.0125, instance_loss: 0.2480, weighted_loss: 0.0832, label: 0, bag_size: 37
batch 199, loss: 0.5728, instance_loss: 0.4028, weighted_loss: 0.5218, label: 1, bag_size: 444
batch 219, loss: 2.1884, instance_loss: 0.5595, weighted_loss: 1.6997, label: 2, bag_size: 717
batch 239, loss: 0.6346, instance_loss: 0.4004, weighted_loss: 0.5644, label: 3, bag_size: 488
batch 259, loss: 1.9916, instance_loss: 0.5002, weighted_loss: 1.5441, label: 0, bag_size: 243
batch 279, loss: 0.0234, instance_loss: 0.2525, weighted_loss: 0.0922, label: 0, bag_size: 350
batch 299, loss: 0.6451, instance_loss: 0.3314, weighted_loss: 0.5510, label: 0, bag_size: 192
batch 319, loss: 0.8335, instance_loss: 0.4525, weighted_loss: 0.7192, label: 3, bag_size: 351
batch 339, loss: 0.7086, instance_loss: 0.4682, weighted_loss: 0.6365, label: 1, bag_size: 702
batch 359, loss: 0.3385, instance_loss: 0.4888, weighted_loss: 0.3836, label: 4, bag_size: 854
batch 379, loss: 1.0111, instance_loss: 0.4502, weighted_loss: 0.8429, label: 1, bag_size: 925
batch 399, loss: 0.8723, instance_loss: 0.4851, weighted_loss: 0.7561, label: 4, bag_size: 730
batch 419, loss: 0.9039, instance_loss: 0.5234, weighted_loss: 0.7898, label: 1, bag_size: 271
batch 439, loss: 0.0947, instance_loss: 0.3165, weighted_loss: 0.1612, label: 0, bag_size: 523
batch 459, loss: 0.2052, instance_loss: 0.3890, weighted_loss: 0.2603, label: 0, bag_size: 573
batch 479, loss: 0.3121, instance_loss: 0.4119, weighted_loss: 0.3421, label: 4, bag_size: 218
batch 499, loss: 1.6232, instance_loss: 0.5788, weighted_loss: 1.3099, label: 4, bag_size: 1064
batch 519, loss: 0.1048, instance_loss: 0.5418, weighted_loss: 0.2359, label: 4, bag_size: 923
batch 539, loss: 0.5940, instance_loss: 0.5556, weighted_loss: 0.5825, label: 1, bag_size: 141
batch 559, loss: 0.2100, instance_loss: 0.3194, weighted_loss: 0.2429, label: 0, bag_size: 49
batch 579, loss: 1.1878, instance_loss: 0.5219, weighted_loss: 0.9880, label: 3, bag_size: 390


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.07680976430976431: correct 365/4752
Epoch: 49, train_loss: 1.0125, train_clustering_loss:  0.4583, train_error: 0.3906
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.6589147286821705, correct 85/129
class 2: acc 0.40350877192982454, correct 46/114
class 3: acc 0.6446280991735537, correct 78/121
class 4: acc 0.5137614678899083, correct 56/109

Val Set, val_loss: 1.6210, val_error: 0.5000, auc: 0.7563
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.060810810810810814: correct 36/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0000, instance_loss: 0.5388, weighted_loss: 0.1616, label: 2, bag_size: 553
batch 39, loss: 1.0853, instance_loss: 0.4587, weighted_loss: 0.8973, label: 3, bag_size: 120
batch 59, loss: 1.4079, instance_loss: 0.4283, weighted_loss: 1.1140, label: 3, bag_size: 154
batch 79, loss: 1.7839, instance_loss: 0.6214, weighted_loss: 1.4352, label: 4, bag_size: 1104
batch 99, loss: 0.6289, instance_loss: 0.3738, weighted_loss: 0.5524, label: 0, bag_size: 343
batch 119, loss: 1.6233, instance_loss: 0.5615, weighted_loss: 1.3048, label: 2, bag_size: 549
batch 139, loss: 1.7611, instance_loss: 0.4773, weighted_loss: 1.3760, label: 4, bag_size: 356
batch 159, loss: 0.9717, instance_loss: 0.5287, weighted_loss: 0.8388, label: 4, bag_size: 1104
batch 179, loss: 0.5322, instance_loss: 0.4750, weighted_loss: 0.5150, label: 1, bag_size: 311
batch 199, loss: 1.4390, instance_loss: 0.5466, weighted_loss: 1.1713, label: 2, bag_size: 582
batch 219, loss: 1.2507, instance_loss: 0.5060, weighted_loss: 1.0273, label: 1, bag_size: 113
batch 239, loss: 1.8826, instance_loss: 0.5434, weighted_loss: 1.4809, label: 3, bag_size: 1186
batch 259, loss: 1.4604, instance_loss: 0.5240, weighted_loss: 1.1795, label: 2, bag_size: 651
batch 279, loss: 0.5716, instance_loss: 0.3632, weighted_loss: 0.5090, label: 3, bag_size: 510
batch 299, loss: 0.5211, instance_loss: 0.3807, weighted_loss: 0.4790, label: 3, bag_size: 587
batch 319, loss: 0.3829, instance_loss: 0.3599, weighted_loss: 0.3760, label: 2, bag_size: 886
batch 339, loss: 0.3923, instance_loss: 0.4266, weighted_loss: 0.4026, label: 4, bag_size: 574
batch 359, loss: 1.0477, instance_loss: 0.4787, weighted_loss: 0.8770, label: 0, bag_size: 277
batch 379, loss: 0.4423, instance_loss: 0.4390, weighted_loss: 0.4413, label: 1, bag_size: 384
batch 399, loss: 2.5635, instance_loss: 0.5812, weighted_loss: 1.9688, label: 2, bag_size: 738
batch 419, loss: 1.4262, instance_loss: 0.4756, weighted_loss: 1.1410, label: 3, bag_size: 473
batch 439, loss: 0.4339, instance_loss: 0.3496, weighted_loss: 0.4086, label: 4, bag_size: 780
batch 459, loss: 0.4275, instance_loss: 0.4231, weighted_loss: 0.4262, label: 0, bag_size: 393
batch 479, loss: 0.9838, instance_loss: 0.4587, weighted_loss: 0.8262, label: 2, bag_size: 512
batch 499, loss: 1.2022, instance_loss: 0.4733, weighted_loss: 0.9835, label: 4, bag_size: 113
batch 519, loss: 0.9122, instance_loss: 0.5124, weighted_loss: 0.7923, label: 2, bag_size: 489
batch 539, loss: 1.5133, instance_loss: 0.4746, weighted_loss: 1.2017, label: 3, bag_size: 1001
batch 559, loss: 0.6273, instance_loss: 0.5103, weighted_loss: 0.5922, label: 4, bag_size: 960
batch 579, loss: 1.6265, instance_loss: 0.4877, weighted_loss: 1.2848, label: 4, bag_size: 618


class 0 clustering acc 0.9949915824915825: correct 23641/23760
class 1 clustering acc 0.1026936026936027: correct 488/4752
Epoch: 50, train_loss: 1.0070, train_clustering_loss:  0.4588, train_error: 0.4125
class 0: acc 0.7380952380952381, correct 93/126
class 1: acc 0.5892857142857143, correct 66/112
class 2: acc 0.456, correct 57/125
class 3: acc 0.5803571428571429, correct 65/112
class 4: acc 0.5714285714285714, correct 68/119

Val Set, val_loss: 1.6675, val_error: 0.5270, auc: 0.7352
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 4.4441, instance_loss: 0.7362, weighted_loss: 3.3317, label: 0, bag_size: 1039
batch 39, loss: 0.0275, instance_loss: 0.1895, weighted_loss: 0.0761, label: 0, bag_size: 227
batch 59, loss: 1.7159, instance_loss: 0.6840, weighted_loss: 1.4063, label: 0, bag_size: 600
batch 79, loss: 0.6127, instance_loss: 0.4773, weighted_loss: 0.5721, label: 3, bag_size: 398
batch 99, loss: 0.3070, instance_loss: 0.2885, weighted_loss: 0.3014, label: 0, bag_size: 397
batch 119, loss: 3.2720, instance_loss: 0.6447, weighted_loss: 2.4838, label: 3, bag_size: 107
batch 139, loss: 0.7485, instance_loss: 0.4815, weighted_loss: 0.6684, label: 3, bag_size: 398
batch 159, loss: 1.5706, instance_loss: 0.5463, weighted_loss: 1.2633, label: 4, bag_size: 342
batch 179, loss: 0.0344, instance_loss: 0.2259, weighted_loss: 0.0918, label: 0, bag_size: 49
batch 199, loss: 1.1620, instance_loss: 0.4727, weighted_loss: 0.9552, label: 3, bag_size: 194
batch 219, loss: 0.0123, instance_loss: 0.2762, weighted_loss: 0.0915, label: 0, bag_size: 354
batch 239, loss: 1.4747, instance_loss: 0.4672, weighted_loss: 1.1725, label: 4, bag_size: 438
batch 259, loss: 1.2450, instance_loss: 0.6373, weighted_loss: 1.0627, label: 4, bag_size: 862
batch 279, loss: 0.5677, instance_loss: 0.3659, weighted_loss: 0.5071, label: 3, bag_size: 274
batch 299, loss: 1.1836, instance_loss: 0.4938, weighted_loss: 0.9767, label: 4, bag_size: 196
batch 319, loss: 1.2596, instance_loss: 0.4984, weighted_loss: 1.0312, label: 4, bag_size: 407
batch 339, loss: 0.6078, instance_loss: 0.3880, weighted_loss: 0.5419, label: 3, bag_size: 684
batch 359, loss: 1.3683, instance_loss: 0.6484, weighted_loss: 1.1523, label: 2, bag_size: 171
batch 379, loss: 2.5502, instance_loss: 0.7359, weighted_loss: 2.0059, label: 2, bag_size: 640
batch 399, loss: 0.3589, instance_loss: 0.4479, weighted_loss: 0.3856, label: 1, bag_size: 460
batch 419, loss: 0.0979, instance_loss: 0.2269, weighted_loss: 0.1366, label: 0, bag_size: 69
batch 439, loss: 0.7703, instance_loss: 0.4607, weighted_loss: 0.6774, label: 1, bag_size: 461
batch 459, loss: 0.7699, instance_loss: 0.4742, weighted_loss: 0.6812, label: 2, bag_size: 651
batch 479, loss: 0.3290, instance_loss: 0.5098, weighted_loss: 0.3832, label: 4, bag_size: 506
batch 499, loss: 0.9648, instance_loss: 0.4744, weighted_loss: 0.8177, label: 4, bag_size: 740
batch 519, loss: 0.2340, instance_loss: 0.4551, weighted_loss: 0.3004, label: 4, bag_size: 1018
batch 539, loss: 1.2125, instance_loss: 0.4188, weighted_loss: 0.9744, label: 3, bag_size: 625
batch 559, loss: 0.0187, instance_loss: 0.1973, weighted_loss: 0.0723, label: 0, bag_size: 351
batch 579, loss: 0.3839, instance_loss: 0.6130, weighted_loss: 0.4526, label: 0, bag_size: 224


class 0 clustering acc 0.9938131313131313: correct 23613/23760
class 1 clustering acc 0.08627946127946128: correct 410/4752
Epoch: 51, train_loss: 0.9873, train_clustering_loss:  0.4641, train_error: 0.4007
class 0: acc 0.7403846153846154, correct 77/104
class 1: acc 0.6578947368421053, correct 75/114
class 2: acc 0.38596491228070173, correct 44/114
class 3: acc 0.6616541353383458, correct 88/133
class 4: acc 0.5581395348837209, correct 72/129

Val Set, val_loss: 1.7582, val_error: 0.5541, auc: 0.7482
class 0 clustering acc 0.9841216216216216: correct 2913/2960
class 1 clustering acc 0.0625: correct 37/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.6151, instance_loss: 0.5282, weighted_loss: 0.5891, label: 2, bag_size: 708
batch 39, loss: 0.9558, instance_loss: 0.4937, weighted_loss: 0.8172, label: 3, bag_size: 453
batch 59, loss: 1.3105, instance_loss: 0.4424, weighted_loss: 1.0501, label: 3, bag_size: 684
batch 79, loss: 0.8553, instance_loss: 0.3857, weighted_loss: 0.7145, label: 4, bag_size: 489
batch 99, loss: 1.7668, instance_loss: 0.5863, weighted_loss: 1.4126, label: 1, bag_size: 1082
batch 119, loss: 0.3161, instance_loss: 0.4009, weighted_loss: 0.3415, label: 1, bag_size: 906
batch 139, loss: 1.0857, instance_loss: 0.5982, weighted_loss: 0.9394, label: 1, bag_size: 106
batch 159, loss: 1.1967, instance_loss: 0.4322, weighted_loss: 0.9674, label: 2, bag_size: 421
batch 179, loss: 1.7828, instance_loss: 0.6234, weighted_loss: 1.4350, label: 3, bag_size: 638
batch 199, loss: 0.7874, instance_loss: 0.4862, weighted_loss: 0.6970, label: 1, bag_size: 620
batch 219, loss: 0.5728, instance_loss: 0.4114, weighted_loss: 0.5244, label: 2, bag_size: 861
batch 239, loss: 0.0620, instance_loss: 0.3914, weighted_loss: 0.1608, label: 1, bag_size: 1091
batch 259, loss: 3.3254, instance_loss: 0.7886, weighted_loss: 2.5643, label: 1, bag_size: 875
batch 279, loss: 1.0697, instance_loss: 0.4024, weighted_loss: 0.8695, label: 2, bag_size: 864
batch 299, loss: 0.5444, instance_loss: 0.3954, weighted_loss: 0.4997, label: 3, bag_size: 453
batch 319, loss: 0.2217, instance_loss: 0.2791, weighted_loss: 0.2389, label: 0, bag_size: 49
batch 339, loss: 1.1582, instance_loss: 0.6987, weighted_loss: 1.0203, label: 2, bag_size: 168
batch 359, loss: 1.1072, instance_loss: 0.5652, weighted_loss: 0.9446, label: 3, bag_size: 107
batch 379, loss: 3.7350, instance_loss: 0.6740, weighted_loss: 2.8167, label: 1, bag_size: 397
batch 399, loss: 0.6753, instance_loss: 0.4197, weighted_loss: 0.5987, label: 3, bag_size: 566
batch 419, loss: 2.8146, instance_loss: 0.6504, weighted_loss: 2.1653, label: 0, bag_size: 115
batch 439, loss: 2.2433, instance_loss: 0.4727, weighted_loss: 1.7121, label: 4, bag_size: 53
batch 459, loss: 1.2845, instance_loss: 0.5265, weighted_loss: 1.0571, label: 1, bag_size: 141
batch 479, loss: 0.2388, instance_loss: 0.4099, weighted_loss: 0.2901, label: 2, bag_size: 286
batch 499, loss: 0.0804, instance_loss: 0.2667, weighted_loss: 0.1363, label: 0, bag_size: 370
batch 519, loss: 0.0238, instance_loss: 0.2275, weighted_loss: 0.0849, label: 0, bag_size: 355
batch 539, loss: 1.2716, instance_loss: 0.4993, weighted_loss: 1.0399, label: 3, bag_size: 457
batch 559, loss: 1.4162, instance_loss: 0.5341, weighted_loss: 1.1516, label: 4, bag_size: 438
batch 579, loss: 2.5310, instance_loss: 0.6772, weighted_loss: 1.9749, label: 3, bag_size: 1365


class 0 clustering acc 0.9934343434343434: correct 23604/23760
class 1 clustering acc 0.07386363636363637: correct 351/4752
Epoch: 52, train_loss: 0.9831, train_clustering_loss:  0.4622, train_error: 0.4175
class 0: acc 0.7549019607843137, correct 77/102
class 1: acc 0.5192307692307693, correct 54/104
class 2: acc 0.4827586206896552, correct 70/145
class 3: acc 0.5901639344262295, correct 72/122
class 4: acc 0.6033057851239669, correct 73/121

Val Set, val_loss: 1.4987, val_error: 0.5946, auc: 0.7569
class 0 clustering acc 0.9929054054054054: correct 2939/2960
class 1 clustering acc 0.1097972972972973: correct 65/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.1656, instance_loss: 0.5097, weighted_loss: 0.9688, label: 0, bag_size: 367
batch 39, loss: 1.0713, instance_loss: 0.5044, weighted_loss: 0.9012, label: 3, bag_size: 282
batch 59, loss: 0.0106, instance_loss: 0.2224, weighted_loss: 0.0742, label: 0, bag_size: 351
batch 79, loss: 0.7763, instance_loss: 0.3671, weighted_loss: 0.6536, label: 1, bag_size: 908
batch 99, loss: 1.3400, instance_loss: 0.5878, weighted_loss: 1.1143, label: 2, bag_size: 288
batch 119, loss: 1.8119, instance_loss: 0.5156, weighted_loss: 1.4230, label: 3, bag_size: 1078
batch 139, loss: 1.4800, instance_loss: 0.4876, weighted_loss: 1.1823, label: 2, bag_size: 1074
batch 159, loss: 1.2274, instance_loss: 0.4501, weighted_loss: 0.9942, label: 3, bag_size: 166
batch 179, loss: 0.0147, instance_loss: 0.6507, weighted_loss: 0.2055, label: 4, bag_size: 541
batch 199, loss: 1.1286, instance_loss: 0.4542, weighted_loss: 0.9263, label: 2, bag_size: 1077
batch 219, loss: 0.8229, instance_loss: 0.4709, weighted_loss: 0.7173, label: 1, bag_size: 620
batch 239, loss: 3.0193, instance_loss: 0.6139, weighted_loss: 2.2976, label: 2, bag_size: 557
batch 259, loss: 0.7072, instance_loss: 0.5314, weighted_loss: 0.6544, label: 1, bag_size: 490
batch 279, loss: 1.0271, instance_loss: 0.4204, weighted_loss: 0.8451, label: 2, bag_size: 697
batch 299, loss: 1.5018, instance_loss: 0.4012, weighted_loss: 1.1716, label: 2, bag_size: 844
batch 319, loss: 0.2005, instance_loss: 0.5695, weighted_loss: 0.3112, label: 2, bag_size: 684
batch 339, loss: 0.4953, instance_loss: 0.3736, weighted_loss: 0.4588, label: 1, bag_size: 522
batch 359, loss: 1.8665, instance_loss: 0.5358, weighted_loss: 1.4673, label: 3, bag_size: 166
batch 379, loss: 0.6920, instance_loss: 0.4835, weighted_loss: 0.6294, label: 2, bag_size: 567
batch 399, loss: 0.0446, instance_loss: 0.2557, weighted_loss: 0.1079, label: 0, bag_size: 188
batch 419, loss: 0.4742, instance_loss: 0.3681, weighted_loss: 0.4423, label: 4, bag_size: 563
batch 439, loss: 0.6902, instance_loss: 0.4739, weighted_loss: 0.6253, label: 1, bag_size: 616
batch 459, loss: 0.0602, instance_loss: 0.3278, weighted_loss: 0.1405, label: 1, bag_size: 1091
batch 479, loss: 0.0327, instance_loss: 0.1641, weighted_loss: 0.0721, label: 0, bag_size: 297
batch 499, loss: 1.5050, instance_loss: 0.5601, weighted_loss: 1.2215, label: 3, bag_size: 107
batch 519, loss: 0.6960, instance_loss: 0.4770, weighted_loss: 0.6303, label: 1, bag_size: 500
batch 539, loss: 0.6780, instance_loss: 0.4637, weighted_loss: 0.6137, label: 3, bag_size: 97
batch 559, loss: 0.0658, instance_loss: 0.2051, weighted_loss: 0.1076, label: 0, bag_size: 258
batch 579, loss: 1.5304, instance_loss: 0.6796, weighted_loss: 1.2752, label: 2, bag_size: 404


class 0 clustering acc 0.9936868686868687: correct 23610/23760
class 1 clustering acc 0.09406565656565656: correct 447/4752
Epoch: 53, train_loss: 0.9807, train_clustering_loss:  0.4564, train_error: 0.4226
class 0: acc 0.7560975609756098, correct 93/123
class 1: acc 0.6115702479338843, correct 74/121
class 2: acc 0.30701754385964913, correct 35/114
class 3: acc 0.5625, correct 63/112
class 4: acc 0.6290322580645161, correct 78/124

Val Set, val_loss: 1.6453, val_error: 0.5270, auc: 0.7642
class 0 clustering acc 0.9939189189189189: correct 2942/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.9204, instance_loss: 0.4211, weighted_loss: 0.7706, label: 0, bag_size: 710
batch 39, loss: 1.9618, instance_loss: 0.5470, weighted_loss: 1.5374, label: 3, bag_size: 154
batch 59, loss: 0.2944, instance_loss: 0.2994, weighted_loss: 0.2959, label: 0, bag_size: 393
batch 79, loss: 0.5202, instance_loss: 0.3824, weighted_loss: 0.4789, label: 4, bag_size: 727
batch 99, loss: 0.9027, instance_loss: 0.4658, weighted_loss: 0.7717, label: 1, bag_size: 1043
batch 119, loss: 0.0299, instance_loss: 0.3700, weighted_loss: 0.1319, label: 4, bag_size: 725
batch 139, loss: 1.0969, instance_loss: 0.4771, weighted_loss: 0.9110, label: 3, bag_size: 120
batch 159, loss: 0.6849, instance_loss: 0.3465, weighted_loss: 0.5834, label: 4, bag_size: 333
batch 179, loss: 0.0500, instance_loss: 0.3652, weighted_loss: 0.1446, label: 0, bag_size: 188
batch 199, loss: 0.2394, instance_loss: 0.4581, weighted_loss: 0.3050, label: 0, bag_size: 159
batch 219, loss: 0.8832, instance_loss: 0.4379, weighted_loss: 0.7496, label: 2, bag_size: 1010
batch 239, loss: 0.2873, instance_loss: 0.3436, weighted_loss: 0.3042, label: 4, bag_size: 377
batch 259, loss: 0.8991, instance_loss: 0.4662, weighted_loss: 0.7692, label: 2, bag_size: 375
batch 279, loss: 2.4637, instance_loss: 0.6809, weighted_loss: 1.9289, label: 2, bag_size: 713
batch 299, loss: 1.0610, instance_loss: 0.5215, weighted_loss: 0.8991, label: 3, bag_size: 107
batch 319, loss: 0.1705, instance_loss: 0.3531, weighted_loss: 0.2253, label: 0, bag_size: 227
batch 339, loss: 0.6581, instance_loss: 0.4825, weighted_loss: 0.6054, label: 1, bag_size: 925
batch 359, loss: 0.3124, instance_loss: 0.4418, weighted_loss: 0.3513, label: 1, bag_size: 328
batch 379, loss: 1.2424, instance_loss: 0.4833, weighted_loss: 1.0147, label: 3, bag_size: 495
batch 399, loss: 1.3480, instance_loss: 0.4899, weighted_loss: 1.0906, label: 4, bag_size: 72
batch 419, loss: 1.2709, instance_loss: 0.5050, weighted_loss: 1.0411, label: 4, bag_size: 726
batch 439, loss: 0.5214, instance_loss: 0.4576, weighted_loss: 0.5022, label: 1, bag_size: 829
batch 459, loss: 1.7975, instance_loss: 0.5452, weighted_loss: 1.4218, label: 2, bag_size: 645
batch 479, loss: 1.5895, instance_loss: 0.5255, weighted_loss: 1.2703, label: 0, bag_size: 115
batch 499, loss: 0.6241, instance_loss: 0.6370, weighted_loss: 0.6280, label: 2, bag_size: 96
batch 519, loss: 1.6082, instance_loss: 0.5428, weighted_loss: 1.2886, label: 4, bag_size: 771
batch 539, loss: 0.2989, instance_loss: 0.3305, weighted_loss: 0.3084, label: 4, bag_size: 329
batch 559, loss: 0.2115, instance_loss: 0.3092, weighted_loss: 0.2408, label: 0, bag_size: 49
batch 579, loss: 1.3347, instance_loss: 0.5573, weighted_loss: 1.1015, label: 2, bag_size: 860


class 0 clustering acc 0.9953282828282828: correct 23649/23760
class 1 clustering acc 0.07386363636363637: correct 351/4752
Epoch: 54, train_loss: 1.0247, train_clustering_loss:  0.4627, train_error: 0.4495
class 0: acc 0.7016129032258065, correct 87/124
class 1: acc 0.5175438596491229, correct 59/114
class 2: acc 0.4482758620689655, correct 65/145
class 3: acc 0.5531914893617021, correct 52/94
class 4: acc 0.5470085470085471, correct 64/117

Val Set, val_loss: 1.6231, val_error: 0.5270, auc: 0.7597
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0134, instance_loss: 0.1977, weighted_loss: 0.0687, label: 0, bag_size: 15
batch 39, loss: 1.1047, instance_loss: 0.4816, weighted_loss: 0.9177, label: 3, bag_size: 746
batch 59, loss: 1.9264, instance_loss: 0.5420, weighted_loss: 1.5111, label: 2, bag_size: 185
batch 79, loss: 1.3994, instance_loss: 0.5231, weighted_loss: 1.1365, label: 3, bag_size: 301
batch 99, loss: 1.4084, instance_loss: 0.4919, weighted_loss: 1.1335, label: 4, bag_size: 250
batch 119, loss: 0.1400, instance_loss: 0.2565, weighted_loss: 0.1749, label: 4, bag_size: 948
batch 139, loss: 0.1532, instance_loss: 0.3157, weighted_loss: 0.2020, label: 4, bag_size: 1041
batch 159, loss: 0.8692, instance_loss: 0.5818, weighted_loss: 0.7830, label: 2, bag_size: 290
batch 179, loss: 1.1287, instance_loss: 0.5220, weighted_loss: 0.9467, label: 3, bag_size: 457
batch 199, loss: 0.8183, instance_loss: 0.4821, weighted_loss: 0.7175, label: 1, bag_size: 617
batch 219, loss: 1.0879, instance_loss: 0.4677, weighted_loss: 0.9018, label: 1, bag_size: 1023
batch 239, loss: 0.8608, instance_loss: 0.4423, weighted_loss: 0.7352, label: 1, bag_size: 928
batch 259, loss: 0.0713, instance_loss: 0.2861, weighted_loss: 0.1357, label: 0, bag_size: 164
batch 279, loss: 0.5250, instance_loss: 0.4430, weighted_loss: 0.5004, label: 2, bag_size: 1079
batch 299, loss: 0.5519, instance_loss: 0.4225, weighted_loss: 0.5131, label: 0, bag_size: 416
batch 319, loss: 0.4185, instance_loss: 0.4730, weighted_loss: 0.4349, label: 3, bag_size: 674
batch 339, loss: 0.1327, instance_loss: 0.3386, weighted_loss: 0.1945, label: 0, bag_size: 49
batch 359, loss: 2.8504, instance_loss: 0.5623, weighted_loss: 2.1639, label: 4, bag_size: 101
batch 379, loss: 0.2588, instance_loss: 0.4178, weighted_loss: 0.3065, label: 2, bag_size: 590
batch 399, loss: 1.3651, instance_loss: 0.4457, weighted_loss: 1.0892, label: 3, bag_size: 495
batch 419, loss: 1.6217, instance_loss: 0.5564, weighted_loss: 1.3021, label: 2, bag_size: 407
batch 439, loss: 1.6084, instance_loss: 0.5936, weighted_loss: 1.3039, label: 1, bag_size: 272
batch 459, loss: 0.7562, instance_loss: 0.5042, weighted_loss: 0.6806, label: 3, bag_size: 746
batch 479, loss: 0.8899, instance_loss: 0.4125, weighted_loss: 0.7467, label: 1, bag_size: 823
batch 499, loss: 0.4501, instance_loss: 0.5043, weighted_loss: 0.4664, label: 1, bag_size: 106
batch 519, loss: 0.8502, instance_loss: 0.4731, weighted_loss: 0.7371, label: 1, bag_size: 928
batch 539, loss: 0.0909, instance_loss: 0.2950, weighted_loss: 0.1521, label: 0, bag_size: 201
batch 559, loss: 0.7128, instance_loss: 0.4389, weighted_loss: 0.6306, label: 1, bag_size: 1043
batch 579, loss: 0.0763, instance_loss: 0.5041, weighted_loss: 0.2046, label: 4, bag_size: 503


class 0 clustering acc 0.9958754208754209: correct 23662/23760
class 1 clustering acc 0.09974747474747475: correct 474/4752
Epoch: 55, train_loss: 0.9792, train_clustering_loss:  0.4563, train_error: 0.4007
class 0: acc 0.8048780487804879, correct 99/123
class 1: acc 0.7054263565891473, correct 91/129
class 2: acc 0.4126984126984127, correct 52/126
class 3: acc 0.49514563106796117, correct 51/103
class 4: acc 0.5575221238938053, correct 63/113

Val Set, val_loss: 1.7747, val_error: 0.5405, auc: 0.7520
class 0 clustering acc 0.9929054054054054: correct 2939/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5676, ROC AUC: 0.7749
Test error: 0.5000, ROC AUC: 0.8064
class 0: acc 0.9375, correct 15/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9521, instance_loss: 0.6628, weighted_loss: 1.5653, label: 1, bag_size: 355
batch 39, loss: 2.5236, instance_loss: 0.5611, weighted_loss: 1.9348, label: 2, bag_size: 582
batch 59, loss: 1.8782, instance_loss: 0.5238, weighted_loss: 1.4719, label: 3, bag_size: 312
batch 79, loss: 1.0949, instance_loss: 0.5477, weighted_loss: 0.9308, label: 1, bag_size: 855
batch 99, loss: 2.5478, instance_loss: 0.5293, weighted_loss: 1.9423, label: 2, bag_size: 631
batch 119, loss: 0.5584, instance_loss: 0.4585, weighted_loss: 0.5285, label: 3, bag_size: 344
batch 139, loss: 1.1694, instance_loss: 0.5140, weighted_loss: 0.9728, label: 2, bag_size: 998
batch 159, loss: 2.0715, instance_loss: 0.5515, weighted_loss: 1.6155, label: 2, bag_size: 331
batch 179, loss: 1.4776, instance_loss: 0.5394, weighted_loss: 1.1961, label: 3, bag_size: 615
batch 199, loss: 1.9459, instance_loss: 0.5338, weighted_loss: 1.5223, label: 2, bag_size: 549
batch 219, loss: 0.6941, instance_loss: 0.4660, weighted_loss: 0.6256, label: 0, bag_size: 295
batch 239, loss: 1.3983, instance_loss: 0.4765, weighted_loss: 1.1218, label: 4, bag_size: 699
batch 259, loss: 0.8825, instance_loss: 0.5331, weighted_loss: 0.7777, label: 0, bag_size: 295
batch 279, loss: 1.8180, instance_loss: 0.4682, weighted_loss: 1.4131, label: 4, bag_size: 769
batch 299, loss: 0.4778, instance_loss: 0.4557, weighted_loss: 0.4711, label: 0, bag_size: 63
batch 319, loss: 1.5782, instance_loss: 0.5507, weighted_loss: 1.2700, label: 3, bag_size: 492
batch 339, loss: 1.7832, instance_loss: 0.4496, weighted_loss: 1.3831, label: 1, bag_size: 397
batch 359, loss: 1.5906, instance_loss: 0.4828, weighted_loss: 1.2583, label: 4, bag_size: 72
batch 379, loss: 1.4834, instance_loss: 0.4893, weighted_loss: 1.1852, label: 2, bag_size: 407
batch 399, loss: 2.3738, instance_loss: 0.5422, weighted_loss: 1.8243, label: 0, bag_size: 400
batch 419, loss: 2.3611, instance_loss: 0.5938, weighted_loss: 1.8309, label: 1, bag_size: 607
batch 439, loss: 0.1292, instance_loss: 0.4038, weighted_loss: 0.2116, label: 0, bag_size: 80
batch 459, loss: 0.9703, instance_loss: 0.5340, weighted_loss: 0.8394, label: 1, bag_size: 593
batch 479, loss: 2.8640, instance_loss: 0.4635, weighted_loss: 2.1439, label: 0, bag_size: 62
batch 499, loss: 1.9436, instance_loss: 0.6590, weighted_loss: 1.5582, label: 3, bag_size: 796
batch 519, loss: 1.0748, instance_loss: 0.4987, weighted_loss: 0.9020, label: 1, bag_size: 1497
batch 539, loss: 1.5050, instance_loss: 0.5240, weighted_loss: 1.2107, label: 3, bag_size: 631
batch 559, loss: 1.3152, instance_loss: 0.4658, weighted_loss: 1.0604, label: 4, bag_size: 218
batch 579, loss: 1.3857, instance_loss: 0.5270, weighted_loss: 1.1280, label: 2, bag_size: 128


class 0 clustering acc 0.9983164983164983: correct 23720/23760
class 1 clustering acc 0.0021043771043771043: correct 10/4752
Epoch: 0, train_loss: 1.5351, train_clustering_loss:  0.5255, train_error: 0.6633
class 0: acc 0.6578947368421053, correct 75/114
class 1: acc 0.3923076923076923, correct 51/130
class 2: acc 0.1452991452991453, correct 17/117
class 3: acc 0.1794871794871795, correct 21/117
class 4: acc 0.3103448275862069, correct 36/116

Val Set, val_loss: 1.4202, val_error: 0.6216, auc: 0.7061
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.420188).  Saving model ...


batch 19, loss: 1.7437, instance_loss: 0.5564, weighted_loss: 1.3875, label: 3, bag_size: 97
batch 39, loss: 1.9838, instance_loss: 0.5558, weighted_loss: 1.5554, label: 0, bag_size: 352
batch 59, loss: 0.8706, instance_loss: 0.4279, weighted_loss: 0.7378, label: 0, bag_size: 230
batch 79, loss: 1.4713, instance_loss: 0.4947, weighted_loss: 1.1783, label: 2, bag_size: 318
batch 99, loss: 1.0182, instance_loss: 0.4764, weighted_loss: 0.8557, label: 2, bag_size: 530
batch 119, loss: 1.0656, instance_loss: 0.4940, weighted_loss: 0.8941, label: 1, bag_size: 339
batch 139, loss: 0.9945, instance_loss: 0.3943, weighted_loss: 0.8145, label: 1, bag_size: 461
batch 159, loss: 1.7178, instance_loss: 0.5446, weighted_loss: 1.3658, label: 4, bag_size: 267
batch 179, loss: 0.2042, instance_loss: 0.4261, weighted_loss: 0.2707, label: 0, bag_size: 706
batch 199, loss: 0.1581, instance_loss: 0.4260, weighted_loss: 0.2385, label: 0, bag_size: 524
batch 219, loss: 0.1019, instance_loss: 0.3571, weighted_loss: 0.1784, label: 0, bag_size: 59
batch 239, loss: 2.7831, instance_loss: 0.8003, weighted_loss: 2.1882, label: 2, bag_size: 607
batch 259, loss: 1.6959, instance_loss: 0.5055, weighted_loss: 1.3388, label: 1, bag_size: 697
batch 279, loss: 1.5271, instance_loss: 0.5648, weighted_loss: 1.2384, label: 0, bag_size: 404
batch 299, loss: 1.3008, instance_loss: 0.5461, weighted_loss: 1.0744, label: 3, bag_size: 796
batch 319, loss: 0.1763, instance_loss: 0.4034, weighted_loss: 0.2444, label: 0, bag_size: 142
batch 339, loss: 3.6058, instance_loss: 0.7626, weighted_loss: 2.7529, label: 0, bag_size: 169
batch 359, loss: 1.1326, instance_loss: 0.4938, weighted_loss: 0.9410, label: 4, bag_size: 503
batch 379, loss: 2.0091, instance_loss: 0.4483, weighted_loss: 1.5409, label: 3, bag_size: 638
batch 399, loss: 1.6236, instance_loss: 0.4204, weighted_loss: 1.2627, label: 4, bag_size: 530
batch 419, loss: 1.4222, instance_loss: 0.5503, weighted_loss: 1.1607, label: 1, bag_size: 141
batch 439, loss: 1.1981, instance_loss: 0.5223, weighted_loss: 0.9954, label: 4, bag_size: 730
batch 459, loss: 2.5693, instance_loss: 0.5501, weighted_loss: 1.9636, label: 0, bag_size: 62
batch 479, loss: 1.5671, instance_loss: 0.5904, weighted_loss: 1.2741, label: 4, bag_size: 755
batch 499, loss: 3.4606, instance_loss: 0.7322, weighted_loss: 2.6421, label: 0, bag_size: 421
batch 519, loss: 0.9862, instance_loss: 0.4397, weighted_loss: 0.8223, label: 2, bag_size: 1308
batch 539, loss: 0.1483, instance_loss: 0.4018, weighted_loss: 0.2243, label: 0, bag_size: 340
batch 559, loss: 1.7518, instance_loss: 0.5778, weighted_loss: 1.3996, label: 3, bag_size: 1060
batch 579, loss: 1.6793, instance_loss: 0.5148, weighted_loss: 1.3299, label: 2, bag_size: 1092


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.00042087542087542086: correct 2/4752
Epoch: 1, train_loss: 1.4495, train_clustering_loss:  0.5112, train_error: 0.6582
class 0: acc 0.7310924369747899, correct 87/119
class 1: acc 0.13953488372093023, correct 18/129
class 2: acc 0.29464285714285715, correct 33/112
class 3: acc 0.30952380952380953, correct 39/126
class 4: acc 0.24074074074074073, correct 26/108

Val Set, val_loss: 1.3751, val_error: 0.6351, auc: 0.7127
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.07142857142857142, correct 1/14
Validation loss decreased (1.420188 --> 1.375102).  Saving model ...


batch 19, loss: 1.0219, instance_loss: 0.4430, weighted_loss: 0.8482, label: 3, bag_size: 109
batch 39, loss: 2.5447, instance_loss: 0.5611, weighted_loss: 1.9496, label: 1, bag_size: 875
batch 59, loss: 2.0657, instance_loss: 0.5860, weighted_loss: 1.6218, label: 2, bag_size: 244
batch 79, loss: 1.8503, instance_loss: 0.6196, weighted_loss: 1.4811, label: 0, bag_size: 879
batch 99, loss: 1.0208, instance_loss: 0.5109, weighted_loss: 0.8679, label: 4, bag_size: 618
batch 119, loss: 1.7044, instance_loss: 0.5571, weighted_loss: 1.3602, label: 1, bag_size: 607
batch 139, loss: 1.2042, instance_loss: 0.4994, weighted_loss: 0.9928, label: 3, bag_size: 369
batch 159, loss: 2.0080, instance_loss: 0.5416, weighted_loss: 1.5680, label: 4, bag_size: 438
batch 179, loss: 1.7222, instance_loss: 0.6044, weighted_loss: 1.3868, label: 1, bag_size: 660
batch 199, loss: 1.6498, instance_loss: 0.4802, weighted_loss: 1.2989, label: 1, bag_size: 1121
batch 219, loss: 2.1823, instance_loss: 0.6099, weighted_loss: 1.7106, label: 0, bag_size: 745
batch 239, loss: 1.0042, instance_loss: 0.4556, weighted_loss: 0.8396, label: 4, bag_size: 233
batch 259, loss: 1.4696, instance_loss: 0.5493, weighted_loss: 1.1935, label: 3, bag_size: 492
batch 279, loss: 1.6402, instance_loss: 0.5127, weighted_loss: 1.3020, label: 1, bag_size: 410
batch 299, loss: 0.2825, instance_loss: 0.4158, weighted_loss: 0.3225, label: 0, bag_size: 397
batch 319, loss: 1.4446, instance_loss: 0.4798, weighted_loss: 1.1552, label: 3, bag_size: 428
batch 339, loss: 1.9157, instance_loss: 0.6128, weighted_loss: 1.5248, label: 4, bag_size: 574
batch 359, loss: 0.9010, instance_loss: 0.3973, weighted_loss: 0.7499, label: 1, bag_size: 617
batch 379, loss: 1.2977, instance_loss: 0.5787, weighted_loss: 1.0820, label: 3, bag_size: 496
batch 399, loss: 1.5321, instance_loss: 0.5058, weighted_loss: 1.2242, label: 2, bag_size: 567
batch 419, loss: 1.7616, instance_loss: 0.5561, weighted_loss: 1.3999, label: 4, bag_size: 797
batch 439, loss: 0.1393, instance_loss: 0.3880, weighted_loss: 0.2139, label: 0, bag_size: 74
batch 459, loss: 1.2110, instance_loss: 0.5205, weighted_loss: 1.0039, label: 2, bag_size: 633
batch 479, loss: 1.4131, instance_loss: 0.5188, weighted_loss: 1.1448, label: 4, bag_size: 468
batch 499, loss: 1.0804, instance_loss: 0.4895, weighted_loss: 0.9031, label: 4, bag_size: 489
batch 519, loss: 0.3336, instance_loss: 0.4129, weighted_loss: 0.3574, label: 0, bag_size: 79
batch 539, loss: 1.6236, instance_loss: 0.4971, weighted_loss: 1.2857, label: 3, bag_size: 1186
batch 559, loss: 1.6986, instance_loss: 0.5388, weighted_loss: 1.3507, label: 2, bag_size: 407
batch 579, loss: 0.6169, instance_loss: 0.4865, weighted_loss: 0.5778, label: 0, bag_size: 527


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.0010521885521885522: correct 5/4752
Epoch: 2, train_loss: 1.4000, train_clustering_loss:  0.5068, train_error: 0.6397
class 0: acc 0.743801652892562, correct 90/121
class 1: acc 0.22580645161290322, correct 28/124
class 2: acc 0.13636363636363635, correct 15/110
class 3: acc 0.2975206611570248, correct 36/121
class 4: acc 0.3813559322033898, correct 45/118

Val Set, val_loss: 1.3844, val_error: 0.6486, auc: 0.7187
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5833, instance_loss: 0.5472, weighted_loss: 1.2724, label: 2, bag_size: 535
batch 39, loss: 1.3633, instance_loss: 0.5424, weighted_loss: 1.1170, label: 2, bag_size: 119
batch 59, loss: 0.0904, instance_loss: 0.3597, weighted_loss: 0.1712, label: 0, bag_size: 63
batch 79, loss: 1.9141, instance_loss: 0.5141, weighted_loss: 1.4941, label: 3, bag_size: 272
batch 99, loss: 1.5969, instance_loss: 0.4941, weighted_loss: 1.2661, label: 1, bag_size: 397
batch 119, loss: 1.5922, instance_loss: 0.5841, weighted_loss: 1.2897, label: 3, bag_size: 897
batch 139, loss: 1.8506, instance_loss: 0.5297, weighted_loss: 1.4544, label: 2, bag_size: 1319
batch 159, loss: 1.5168, instance_loss: 0.5244, weighted_loss: 1.2191, label: 4, bag_size: 970
batch 179, loss: 0.9081, instance_loss: 0.4408, weighted_loss: 0.7679, label: 3, bag_size: 631
batch 199, loss: 1.1623, instance_loss: 0.4598, weighted_loss: 0.9515, label: 3, bag_size: 796
batch 219, loss: 1.5691, instance_loss: 0.5442, weighted_loss: 1.2617, label: 4, bag_size: 744
batch 239, loss: 1.3588, instance_loss: 0.4369, weighted_loss: 1.0822, label: 1, bag_size: 500
batch 259, loss: 1.6053, instance_loss: 0.5007, weighted_loss: 1.2739, label: 3, bag_size: 1060
batch 279, loss: 1.0801, instance_loss: 0.4600, weighted_loss: 0.8940, label: 3, bag_size: 323
batch 299, loss: 1.4226, instance_loss: 0.5234, weighted_loss: 1.1528, label: 3, bag_size: 149
batch 319, loss: 2.3570, instance_loss: 0.6204, weighted_loss: 1.8360, label: 1, bag_size: 272
batch 339, loss: 4.4979, instance_loss: 0.7437, weighted_loss: 3.3716, label: 0, bag_size: 421
batch 359, loss: 1.6594, instance_loss: 0.5726, weighted_loss: 1.3334, label: 4, bag_size: 589
batch 379, loss: 1.2156, instance_loss: 0.5061, weighted_loss: 1.0028, label: 1, bag_size: 371
batch 399, loss: 1.3484, instance_loss: 0.4685, weighted_loss: 1.0844, label: 1, bag_size: 361
batch 419, loss: 1.5917, instance_loss: 0.5520, weighted_loss: 1.2798, label: 3, bag_size: 102
batch 439, loss: 0.1560, instance_loss: 0.3075, weighted_loss: 0.2015, label: 0, bag_size: 397
batch 459, loss: 1.7506, instance_loss: 0.5738, weighted_loss: 1.3976, label: 3, bag_size: 1147
batch 479, loss: 0.1623, instance_loss: 0.3785, weighted_loss: 0.2272, label: 0, bag_size: 33
batch 499, loss: 1.1345, instance_loss: 0.4494, weighted_loss: 0.9289, label: 3, bag_size: 615
batch 519, loss: 1.7877, instance_loss: 0.4989, weighted_loss: 1.4010, label: 2, bag_size: 769
batch 539, loss: 1.2935, instance_loss: 0.4830, weighted_loss: 1.0503, label: 1, bag_size: 371
batch 559, loss: 1.9828, instance_loss: 0.6021, weighted_loss: 1.5686, label: 3, bag_size: 1284
batch 579, loss: 0.8100, instance_loss: 0.4964, weighted_loss: 0.7159, label: 4, bag_size: 520


class 0 clustering acc 0.9997474747474747: correct 23754/23760
class 1 clustering acc 0.0008417508417508417: correct 4/4752
Epoch: 3, train_loss: 1.3153, train_clustering_loss:  0.4986, train_error: 0.5909
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.2457627118644068, correct 29/118
class 2: acc 0.3464566929133858, correct 44/127
class 3: acc 0.2920353982300885, correct 33/113
class 4: acc 0.3302752293577982, correct 36/109

Val Set, val_loss: 1.3490, val_error: 0.5811, auc: 0.7344
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.375102 --> 1.349039).  Saving model ...


batch 19, loss: 1.0070, instance_loss: 0.4778, weighted_loss: 0.8482, label: 4, bag_size: 660
batch 39, loss: 0.8665, instance_loss: 0.4536, weighted_loss: 0.7426, label: 0, bag_size: 316
batch 59, loss: 1.7132, instance_loss: 0.5040, weighted_loss: 1.3504, label: 1, bag_size: 419
batch 79, loss: 1.6280, instance_loss: 0.5483, weighted_loss: 1.3041, label: 1, bag_size: 522
batch 99, loss: 2.3068, instance_loss: 0.5784, weighted_loss: 1.7882, label: 4, bag_size: 366
batch 119, loss: 0.1443, instance_loss: 0.3621, weighted_loss: 0.2097, label: 0, bag_size: 63
batch 139, loss: 1.1921, instance_loss: 0.4525, weighted_loss: 0.9702, label: 4, bag_size: 244
batch 159, loss: 1.2397, instance_loss: 0.4481, weighted_loss: 1.0022, label: 4, bag_size: 755
batch 179, loss: 0.2995, instance_loss: 0.4337, weighted_loss: 0.3398, label: 0, bag_size: 552
batch 199, loss: 1.4281, instance_loss: 0.5005, weighted_loss: 1.1498, label: 1, bag_size: 865
batch 219, loss: 1.1179, instance_loss: 0.4211, weighted_loss: 0.9088, label: 4, bag_size: 530
batch 239, loss: 1.2245, instance_loss: 0.4870, weighted_loss: 1.0032, label: 2, bag_size: 783
batch 259, loss: 1.4528, instance_loss: 0.5733, weighted_loss: 1.1890, label: 1, bag_size: 1009
batch 279, loss: 0.1162, instance_loss: 0.2842, weighted_loss: 0.1666, label: 0, bag_size: 404
batch 299, loss: 1.2641, instance_loss: 0.5292, weighted_loss: 1.0436, label: 1, bag_size: 391
batch 319, loss: 1.8501, instance_loss: 0.5577, weighted_loss: 1.4623, label: 3, bag_size: 498
batch 339, loss: 1.4124, instance_loss: 0.5525, weighted_loss: 1.1544, label: 4, bag_size: 399
batch 359, loss: 2.1986, instance_loss: 0.5654, weighted_loss: 1.7086, label: 2, bag_size: 563
batch 379, loss: 1.4104, instance_loss: 0.4874, weighted_loss: 1.1335, label: 4, bag_size: 689
batch 399, loss: 1.2082, instance_loss: 0.4768, weighted_loss: 0.9887, label: 4, bag_size: 574
batch 419, loss: 1.7839, instance_loss: 0.4635, weighted_loss: 1.3877, label: 2, bag_size: 844
batch 439, loss: 1.2836, instance_loss: 0.5278, weighted_loss: 1.0569, label: 4, bag_size: 218
batch 459, loss: 1.1016, instance_loss: 0.4747, weighted_loss: 0.9135, label: 4, bag_size: 639
batch 479, loss: 1.2701, instance_loss: 0.5336, weighted_loss: 1.0491, label: 4, bag_size: 418
batch 499, loss: 1.3508, instance_loss: 0.4783, weighted_loss: 1.0890, label: 3, bag_size: 194
batch 519, loss: 1.5689, instance_loss: 0.5395, weighted_loss: 1.2601, label: 1, bag_size: 231
batch 539, loss: 1.2333, instance_loss: 0.4789, weighted_loss: 1.0070, label: 3, bag_size: 830
batch 559, loss: 1.4816, instance_loss: 0.5050, weighted_loss: 1.1886, label: 3, bag_size: 301
batch 579, loss: 1.8535, instance_loss: 0.5420, weighted_loss: 1.4600, label: 4, bag_size: 1351


class 0 clustering acc 0.999537037037037: correct 23749/23760
class 1 clustering acc 0.0025252525252525255: correct 12/4752
Epoch: 4, train_loss: 1.3683, train_clustering_loss:  0.5004, train_error: 0.5976
class 0: acc 0.725, correct 87/120
class 1: acc 0.1388888888888889, correct 15/108
class 2: acc 0.4632352941176471, correct 63/136
class 3: acc 0.1509433962264151, correct 16/106
class 4: acc 0.46774193548387094, correct 58/124

Val Set, val_loss: 1.3385, val_error: 0.5811, auc: 0.7566
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
Validation loss decreased (1.349039 --> 1.338520).  Saving model ...


batch 19, loss: 0.0116, instance_loss: 0.3517, weighted_loss: 0.1136, label: 0, bag_size: 428
batch 39, loss: 1.1942, instance_loss: 0.5263, weighted_loss: 0.9938, label: 2, bag_size: 1066
batch 59, loss: 0.1719, instance_loss: 0.2936, weighted_loss: 0.2084, label: 0, bag_size: 79
batch 79, loss: 1.0817, instance_loss: 0.3877, weighted_loss: 0.8735, label: 3, bag_size: 344
batch 99, loss: 2.2651, instance_loss: 0.6874, weighted_loss: 1.7918, label: 2, bag_size: 244
batch 119, loss: 1.0984, instance_loss: 0.4508, weighted_loss: 0.9041, label: 3, bag_size: 282
batch 139, loss: 1.9325, instance_loss: 0.5380, weighted_loss: 1.5141, label: 1, bag_size: 201
batch 159, loss: 1.0690, instance_loss: 0.4466, weighted_loss: 0.8823, label: 3, bag_size: 309
batch 179, loss: 2.6994, instance_loss: 0.6533, weighted_loss: 2.0856, label: 1, bag_size: 184
batch 199, loss: 1.4921, instance_loss: 0.5275, weighted_loss: 1.2027, label: 2, bag_size: 407
batch 219, loss: 1.8282, instance_loss: 0.5118, weighted_loss: 1.4333, label: 2, bag_size: 877
batch 239, loss: 1.6870, instance_loss: 0.5952, weighted_loss: 1.3595, label: 2, bag_size: 598
batch 259, loss: 1.3167, instance_loss: 0.5524, weighted_loss: 1.0874, label: 1, bag_size: 231
batch 279, loss: 1.5691, instance_loss: 0.4993, weighted_loss: 1.2482, label: 1, bag_size: 390
batch 299, loss: 1.5009, instance_loss: 0.4571, weighted_loss: 1.1877, label: 2, bag_size: 799
batch 319, loss: 0.5523, instance_loss: 0.4235, weighted_loss: 0.5136, label: 0, bag_size: 281
batch 339, loss: 1.2014, instance_loss: 0.5007, weighted_loss: 0.9912, label: 2, bag_size: 208
batch 359, loss: 1.3855, instance_loss: 0.5047, weighted_loss: 1.1213, label: 2, bag_size: 135
batch 379, loss: 1.4382, instance_loss: 0.4717, weighted_loss: 1.1482, label: 3, bag_size: 899
batch 399, loss: 1.5792, instance_loss: 0.5681, weighted_loss: 1.2759, label: 4, bag_size: 450
batch 419, loss: 2.2331, instance_loss: 0.6408, weighted_loss: 1.7554, label: 0, bag_size: 243
batch 439, loss: 2.4392, instance_loss: 0.6229, weighted_loss: 1.8943, label: 4, bag_size: 160
batch 459, loss: 1.1469, instance_loss: 0.5199, weighted_loss: 0.9588, label: 4, bag_size: 277
batch 479, loss: 1.5302, instance_loss: 0.5363, weighted_loss: 1.2321, label: 2, bag_size: 299
batch 499, loss: 1.5092, instance_loss: 0.5042, weighted_loss: 1.2077, label: 1, bag_size: 1121
batch 519, loss: 1.1294, instance_loss: 0.4720, weighted_loss: 0.9322, label: 1, bag_size: 371
batch 539, loss: 1.6373, instance_loss: 0.5486, weighted_loss: 1.3107, label: 4, bag_size: 419
batch 559, loss: 1.3990, instance_loss: 0.5096, weighted_loss: 1.1322, label: 2, bag_size: 998
batch 579, loss: 0.5275, instance_loss: 0.3748, weighted_loss: 0.4816, label: 0, bag_size: 133


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.0025252525252525255: correct 12/4752
Epoch: 5, train_loss: 1.3528, train_clustering_loss:  0.5089, train_error: 0.5943
class 0: acc 0.784, correct 98/125
class 1: acc 0.21666666666666667, correct 26/120
class 2: acc 0.3064516129032258, correct 38/124
class 3: acc 0.375, correct 45/120
class 4: acc 0.3238095238095238, correct 34/105

Val Set, val_loss: 1.3088, val_error: 0.6081, auc: 0.7436
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.338520 --> 1.308763).  Saving model ...


batch 19, loss: 2.0346, instance_loss: 0.5239, weighted_loss: 1.5814, label: 1, bag_size: 1023
batch 39, loss: 0.2092, instance_loss: 0.4051, weighted_loss: 0.2679, label: 0, bag_size: 297
batch 59, loss: 1.3365, instance_loss: 0.4858, weighted_loss: 1.0813, label: 2, bag_size: 315
batch 79, loss: 1.9341, instance_loss: 0.5086, weighted_loss: 1.5064, label: 3, bag_size: 166
batch 99, loss: 1.7321, instance_loss: 0.5299, weighted_loss: 1.3715, label: 4, bag_size: 110
batch 119, loss: 1.0754, instance_loss: 0.4672, weighted_loss: 0.8930, label: 1, bag_size: 332
batch 139, loss: 2.8383, instance_loss: 0.7502, weighted_loss: 2.2119, label: 0, bag_size: 273
batch 159, loss: 1.4148, instance_loss: 0.5733, weighted_loss: 1.1624, label: 2, bag_size: 616
batch 179, loss: 1.5438, instance_loss: 0.5429, weighted_loss: 1.2435, label: 3, bag_size: 301
batch 199, loss: 1.1384, instance_loss: 0.4489, weighted_loss: 0.9316, label: 2, bag_size: 812
batch 219, loss: 1.4493, instance_loss: 0.4971, weighted_loss: 1.1636, label: 0, bag_size: 1414
batch 239, loss: 2.0717, instance_loss: 0.5069, weighted_loss: 1.6022, label: 1, bag_size: 361
batch 259, loss: 0.1630, instance_loss: 0.3363, weighted_loss: 0.2150, label: 0, bag_size: 397
batch 279, loss: 1.1586, instance_loss: 0.4654, weighted_loss: 0.9507, label: 4, bag_size: 875
batch 299, loss: 1.1190, instance_loss: 0.4590, weighted_loss: 0.9210, label: 4, bag_size: 498
batch 319, loss: 1.3443, instance_loss: 0.5320, weighted_loss: 1.1006, label: 1, bag_size: 328
batch 339, loss: 0.2670, instance_loss: 0.3971, weighted_loss: 0.3060, label: 0, bag_size: 188
batch 359, loss: 1.1745, instance_loss: 0.5645, weighted_loss: 0.9915, label: 0, bag_size: 524
batch 379, loss: 1.4304, instance_loss: 0.4854, weighted_loss: 1.1469, label: 1, bag_size: 141
batch 399, loss: 2.2046, instance_loss: 0.6609, weighted_loss: 1.7415, label: 3, bag_size: 457
batch 419, loss: 1.5753, instance_loss: 0.6071, weighted_loss: 1.2848, label: 3, bag_size: 500
batch 439, loss: 1.4294, instance_loss: 0.5500, weighted_loss: 1.1656, label: 4, bag_size: 740
batch 459, loss: 1.6069, instance_loss: 0.4689, weighted_loss: 1.2655, label: 2, bag_size: 844
batch 479, loss: 1.2365, instance_loss: 0.4936, weighted_loss: 1.0136, label: 2, bag_size: 597
batch 499, loss: 1.9189, instance_loss: 0.4911, weighted_loss: 1.4905, label: 1, bag_size: 823
batch 519, loss: 1.3452, instance_loss: 0.4903, weighted_loss: 1.0887, label: 2, bag_size: 543
batch 539, loss: 3.1750, instance_loss: 0.5289, weighted_loss: 2.3812, label: 4, bag_size: 198
batch 559, loss: 1.1999, instance_loss: 0.5148, weighted_loss: 0.9944, label: 3, bag_size: 897
batch 579, loss: 1.5466, instance_loss: 0.5316, weighted_loss: 1.2421, label: 3, bag_size: 149


class 0 clustering acc 0.9998316498316498: correct 23756/23760
class 1 clustering acc 0.002946127946127946: correct 14/4752
Epoch: 6, train_loss: 1.3570, train_clustering_loss:  0.5029, train_error: 0.5808
class 0: acc 0.7380952380952381, correct 93/126
class 1: acc 0.25, correct 29/116
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.31092436974789917, correct 37/119
class 4: acc 0.49586776859504134, correct 60/121

Val Set, val_loss: 1.2640, val_error: 0.5270, auc: 0.7652
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.308763 --> 1.264000).  Saving model ...


batch 19, loss: 0.1701, instance_loss: 0.3493, weighted_loss: 0.2239, label: 0, bag_size: 74
batch 39, loss: 0.9231, instance_loss: 0.4371, weighted_loss: 0.7773, label: 3, bag_size: 631
batch 59, loss: 1.2393, instance_loss: 0.4897, weighted_loss: 1.0144, label: 3, bag_size: 1021
batch 79, loss: 2.1306, instance_loss: 0.6512, weighted_loss: 1.6868, label: 0, bag_size: 367
batch 99, loss: 1.5428, instance_loss: 0.5757, weighted_loss: 1.2527, label: 4, bag_size: 1297
batch 119, loss: 0.9395, instance_loss: 0.4958, weighted_loss: 0.8064, label: 1, bag_size: 1103
batch 139, loss: 0.0349, instance_loss: 0.3747, weighted_loss: 0.1369, label: 0, bag_size: 80
batch 159, loss: 1.5422, instance_loss: 0.4787, weighted_loss: 1.2232, label: 1, bag_size: 525
batch 179, loss: 1.2768, instance_loss: 0.4694, weighted_loss: 1.0346, label: 2, bag_size: 1066
batch 199, loss: 1.4470, instance_loss: 0.5131, weighted_loss: 1.1669, label: 2, bag_size: 337
batch 219, loss: 1.5446, instance_loss: 0.4780, weighted_loss: 1.2247, label: 3, bag_size: 398
batch 239, loss: 0.6535, instance_loss: 0.5114, weighted_loss: 0.6109, label: 0, bag_size: 269
batch 259, loss: 1.3201, instance_loss: 0.4947, weighted_loss: 1.0725, label: 3, bag_size: 194
batch 279, loss: 1.2415, instance_loss: 0.4906, weighted_loss: 1.0162, label: 4, bag_size: 363
batch 299, loss: 1.7372, instance_loss: 0.5804, weighted_loss: 1.3902, label: 2, bag_size: 337
batch 319, loss: 1.4550, instance_loss: 0.4894, weighted_loss: 1.1653, label: 1, bag_size: 1009
batch 339, loss: 3.7406, instance_loss: 0.6914, weighted_loss: 2.8259, label: 0, bag_size: 492
batch 359, loss: 1.1544, instance_loss: 0.4943, weighted_loss: 0.9564, label: 2, bag_size: 1197
batch 379, loss: 0.8492, instance_loss: 0.4527, weighted_loss: 0.7303, label: 4, bag_size: 204
batch 399, loss: 1.5142, instance_loss: 0.5225, weighted_loss: 1.2167, label: 4, bag_size: 731
batch 419, loss: 0.8819, instance_loss: 0.4850, weighted_loss: 0.7628, label: 2, bag_size: 567
batch 439, loss: 0.9419, instance_loss: 0.4957, weighted_loss: 0.8080, label: 2, bag_size: 171
batch 459, loss: 0.6951, instance_loss: 0.4385, weighted_loss: 0.6181, label: 3, bag_size: 737
batch 479, loss: 2.1813, instance_loss: 0.6645, weighted_loss: 1.7263, label: 1, bag_size: 525
batch 499, loss: 0.0497, instance_loss: 0.2759, weighted_loss: 0.1176, label: 0, bag_size: 97
batch 519, loss: 1.7230, instance_loss: 0.5257, weighted_loss: 1.3638, label: 1, bag_size: 381
batch 539, loss: 3.8958, instance_loss: 0.6746, weighted_loss: 2.9295, label: 2, bag_size: 488
batch 559, loss: 1.2045, instance_loss: 0.5522, weighted_loss: 1.0088, label: 4, bag_size: 1064
batch 579, loss: 0.8822, instance_loss: 0.4579, weighted_loss: 0.7549, label: 2, bag_size: 702


class 0 clustering acc 0.9996632996632997: correct 23752/23760
class 1 clustering acc 0.008627946127946129: correct 41/4752
Epoch: 7, train_loss: 1.3274, train_clustering_loss:  0.5006, train_error: 0.5758
class 0: acc 0.7821782178217822, correct 79/101
class 1: acc 0.10810810810810811, correct 12/111
class 2: acc 0.42105263157894735, correct 56/133
class 3: acc 0.4418604651162791, correct 57/129
class 4: acc 0.4, correct 48/120

Val Set, val_loss: 1.3290, val_error: 0.6216, auc: 0.7697
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.9285714285714286, correct 13/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1559, instance_loss: 0.5151, weighted_loss: 0.9637, label: 4, bag_size: 740
batch 39, loss: 0.1099, instance_loss: 0.3746, weighted_loss: 0.1893, label: 0, bag_size: 234
batch 59, loss: 1.6430, instance_loss: 0.5314, weighted_loss: 1.3095, label: 4, bag_size: 714
batch 79, loss: 0.1983, instance_loss: 0.3083, weighted_loss: 0.2313, label: 0, bag_size: 223
batch 99, loss: 1.5569, instance_loss: 0.5148, weighted_loss: 1.2442, label: 1, bag_size: 697
batch 119, loss: 1.3120, instance_loss: 0.4182, weighted_loss: 1.0438, label: 3, bag_size: 1060
batch 139, loss: 0.8311, instance_loss: 0.5123, weighted_loss: 0.7355, label: 4, bag_size: 875
batch 159, loss: 1.9575, instance_loss: 0.5944, weighted_loss: 1.5486, label: 2, bag_size: 779
batch 179, loss: 1.9600, instance_loss: 0.5583, weighted_loss: 1.5395, label: 2, bag_size: 176
batch 199, loss: 1.9125, instance_loss: 0.7023, weighted_loss: 1.5495, label: 1, bag_size: 184
batch 219, loss: 1.3747, instance_loss: 0.4826, weighted_loss: 1.1070, label: 1, bag_size: 1023
batch 239, loss: 1.2860, instance_loss: 0.5023, weighted_loss: 1.0509, label: 4, bag_size: 589
batch 259, loss: 0.0108, instance_loss: 0.1467, weighted_loss: 0.0516, label: 0, bag_size: 425
batch 279, loss: 1.2198, instance_loss: 0.5154, weighted_loss: 1.0084, label: 3, bag_size: 795
batch 299, loss: 0.9404, instance_loss: 0.3931, weighted_loss: 0.7763, label: 3, bag_size: 697
batch 319, loss: 1.3134, instance_loss: 0.5495, weighted_loss: 1.0842, label: 4, bag_size: 797
batch 339, loss: 1.5732, instance_loss: 0.5409, weighted_loss: 1.2635, label: 1, bag_size: 161
batch 359, loss: 0.4749, instance_loss: 0.4199, weighted_loss: 0.4584, label: 0, bag_size: 258
batch 379, loss: 1.7490, instance_loss: 0.6988, weighted_loss: 1.4339, label: 4, bag_size: 238
batch 399, loss: 0.8259, instance_loss: 0.4055, weighted_loss: 0.6998, label: 3, bag_size: 1007
batch 419, loss: 0.6817, instance_loss: 0.3537, weighted_loss: 0.5833, label: 0, bag_size: 613
batch 439, loss: 3.2294, instance_loss: 0.5536, weighted_loss: 2.4267, label: 4, bag_size: 198
batch 459, loss: 1.3903, instance_loss: 0.5343, weighted_loss: 1.1335, label: 2, bag_size: 171
batch 479, loss: 0.9722, instance_loss: 0.5358, weighted_loss: 0.8413, label: 2, bag_size: 315
batch 499, loss: 0.0775, instance_loss: 0.2937, weighted_loss: 0.1424, label: 0, bag_size: 97
batch 519, loss: 1.0446, instance_loss: 0.3963, weighted_loss: 0.8501, label: 3, bag_size: 1154
batch 539, loss: 3.3294, instance_loss: 0.5982, weighted_loss: 2.5100, label: 0, bag_size: 888
batch 559, loss: 0.8261, instance_loss: 0.4962, weighted_loss: 0.7271, label: 4, bag_size: 506
batch 579, loss: 1.0060, instance_loss: 0.5407, weighted_loss: 0.8664, label: 2, bag_size: 633


class 0 clustering acc 0.9949915824915825: correct 23641/23760
class 1 clustering acc 0.09427609427609428: correct 448/4752
Epoch: 8, train_loss: 1.1939, train_clustering_loss:  0.4753, train_error: 0.5185
class 0: acc 0.8282208588957055, correct 135/163
class 1: acc 0.225, correct 27/120
class 2: acc 0.15053763440860216, correct 14/93
class 3: acc 0.4824561403508772, correct 55/114
class 4: acc 0.5288461538461539, correct 55/104

Val Set, val_loss: 1.2761, val_error: 0.5405, auc: 0.7680
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.08445945945945946: correct 50/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0315, instance_loss: 0.4876, weighted_loss: 0.8684, label: 2, bag_size: 549
batch 39, loss: 1.3327, instance_loss: 0.4972, weighted_loss: 1.0821, label: 1, bag_size: 593
batch 59, loss: 0.6702, instance_loss: 0.5238, weighted_loss: 0.6263, label: 0, bag_size: 345
batch 79, loss: 1.7949, instance_loss: 0.4773, weighted_loss: 1.3996, label: 2, bag_size: 445
batch 99, loss: 0.1438, instance_loss: 0.3532, weighted_loss: 0.2066, label: 0, bag_size: 142
batch 119, loss: 0.9757, instance_loss: 0.5001, weighted_loss: 0.8330, label: 1, bag_size: 332
batch 139, loss: 0.5307, instance_loss: 0.5812, weighted_loss: 0.5459, label: 4, bag_size: 773
batch 159, loss: 0.0088, instance_loss: 0.2855, weighted_loss: 0.0918, label: 0, bag_size: 340
batch 179, loss: 2.3459, instance_loss: 0.5552, weighted_loss: 1.8087, label: 4, bag_size: 267
batch 199, loss: 0.0711, instance_loss: 0.3063, weighted_loss: 0.1416, label: 0, bag_size: 97
batch 219, loss: 1.6048, instance_loss: 0.5040, weighted_loss: 1.2746, label: 4, bag_size: 176
batch 239, loss: 2.0801, instance_loss: 0.7976, weighted_loss: 1.6954, label: 2, bag_size: 133
batch 259, loss: 0.0930, instance_loss: 0.2985, weighted_loss: 0.1547, label: 0, bag_size: 49
batch 279, loss: 2.1974, instance_loss: 0.5849, weighted_loss: 1.7137, label: 4, bag_size: 592
batch 299, loss: 1.2683, instance_loss: 0.4507, weighted_loss: 1.0230, label: 2, bag_size: 285
batch 319, loss: 1.0372, instance_loss: 0.5105, weighted_loss: 0.8792, label: 4, bag_size: 1077
batch 339, loss: 0.8824, instance_loss: 0.4546, weighted_loss: 0.7541, label: 4, bag_size: 687
batch 359, loss: 1.2391, instance_loss: 0.5031, weighted_loss: 1.0183, label: 2, bag_size: 607
batch 379, loss: 0.1293, instance_loss: 0.3265, weighted_loss: 0.1885, label: 0, bag_size: 141
batch 399, loss: 0.9856, instance_loss: 0.4209, weighted_loss: 0.8162, label: 3, bag_size: 282
batch 419, loss: 1.3777, instance_loss: 0.5365, weighted_loss: 1.1254, label: 4, bag_size: 970
batch 439, loss: 0.1574, instance_loss: 0.2875, weighted_loss: 0.1964, label: 0, bag_size: 76
batch 459, loss: 1.3811, instance_loss: 0.4850, weighted_loss: 1.1123, label: 2, bag_size: 427
batch 479, loss: 1.6032, instance_loss: 0.4954, weighted_loss: 1.2709, label: 4, bag_size: 407
batch 499, loss: 0.9126, instance_loss: 0.4757, weighted_loss: 0.7815, label: 1, bag_size: 981
batch 519, loss: 2.0859, instance_loss: 0.5808, weighted_loss: 1.6343, label: 4, bag_size: 250
batch 539, loss: 0.7993, instance_loss: 0.5493, weighted_loss: 0.7243, label: 0, bag_size: 383
batch 559, loss: 0.7783, instance_loss: 0.4270, weighted_loss: 0.6729, label: 3, bag_size: 737
batch 579, loss: 1.5033, instance_loss: 0.5378, weighted_loss: 1.2136, label: 4, bag_size: 1104


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.0683922558922559: correct 325/4752
Epoch: 9, train_loss: 1.2801, train_clustering_loss:  0.4917, train_error: 0.5707
class 0: acc 0.7674418604651163, correct 99/129
class 1: acc 0.23636363636363636, correct 26/110
class 2: acc 0.3870967741935484, correct 48/124
class 3: acc 0.24509803921568626, correct 25/102
class 4: acc 0.4418604651162791, correct 57/129

Val Set, val_loss: 1.2002, val_error: 0.5405, auc: 0.7920
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.264000 --> 1.200165).  Saving model ...


batch 19, loss: 1.4183, instance_loss: 0.5133, weighted_loss: 1.1468, label: 1, bag_size: 972
batch 39, loss: 1.6975, instance_loss: 0.5481, weighted_loss: 1.3526, label: 3, bag_size: 796
batch 59, loss: 1.1468, instance_loss: 0.4648, weighted_loss: 0.9422, label: 3, bag_size: 663
batch 79, loss: 1.0673, instance_loss: 0.4715, weighted_loss: 0.8886, label: 3, bag_size: 739
batch 99, loss: 0.9395, instance_loss: 0.5049, weighted_loss: 0.8091, label: 0, bag_size: 143
batch 119, loss: 1.2169, instance_loss: 0.4537, weighted_loss: 0.9880, label: 2, bag_size: 886
batch 139, loss: 0.6830, instance_loss: 0.3744, weighted_loss: 0.5904, label: 3, bag_size: 615
batch 159, loss: 1.0685, instance_loss: 0.4874, weighted_loss: 0.8941, label: 2, bag_size: 535
batch 179, loss: 0.8686, instance_loss: 0.5451, weighted_loss: 0.7715, label: 4, bag_size: 574
batch 199, loss: 1.4503, instance_loss: 0.4720, weighted_loss: 1.1568, label: 2, bag_size: 369
batch 219, loss: 0.7594, instance_loss: 0.5094, weighted_loss: 0.6844, label: 4, bag_size: 773
batch 239, loss: 0.8822, instance_loss: 0.5566, weighted_loss: 0.7845, label: 4, bag_size: 744
batch 259, loss: 1.1711, instance_loss: 0.4946, weighted_loss: 0.9681, label: 1, bag_size: 328
batch 279, loss: 0.8503, instance_loss: 0.4132, weighted_loss: 0.7191, label: 0, bag_size: 613
batch 299, loss: 1.2433, instance_loss: 0.5013, weighted_loss: 1.0207, label: 2, bag_size: 645
batch 319, loss: 1.9455, instance_loss: 0.5192, weighted_loss: 1.5176, label: 1, bag_size: 875
batch 339, loss: 0.7054, instance_loss: 0.4463, weighted_loss: 0.6277, label: 4, bag_size: 329
batch 359, loss: 1.4049, instance_loss: 0.5063, weighted_loss: 1.1353, label: 1, bag_size: 355
batch 379, loss: 0.5422, instance_loss: 0.4965, weighted_loss: 0.5285, label: 4, bag_size: 923
batch 399, loss: 1.4459, instance_loss: 0.5366, weighted_loss: 1.1731, label: 4, bag_size: 468
batch 419, loss: 0.0774, instance_loss: 0.2390, weighted_loss: 0.1259, label: 0, bag_size: 201
batch 439, loss: 0.9630, instance_loss: 0.5019, weighted_loss: 0.8246, label: 4, bag_size: 714
batch 459, loss: 1.3275, instance_loss: 0.5126, weighted_loss: 1.0830, label: 4, bag_size: 176
batch 479, loss: 0.9048, instance_loss: 0.4960, weighted_loss: 0.7822, label: 4, bag_size: 639
batch 499, loss: 1.8285, instance_loss: 0.6397, weighted_loss: 1.4719, label: 2, bag_size: 340
batch 519, loss: 1.3325, instance_loss: 0.5602, weighted_loss: 1.1008, label: 1, bag_size: 177
batch 539, loss: 0.5936, instance_loss: 0.4013, weighted_loss: 0.5359, label: 0, bag_size: 393
batch 559, loss: 1.3631, instance_loss: 0.5208, weighted_loss: 1.1104, label: 2, bag_size: 799
batch 579, loss: 1.5459, instance_loss: 0.5320, weighted_loss: 1.2417, label: 4, bag_size: 729


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.049663299663299666: correct 236/4752
Epoch: 10, train_loss: 1.3377, train_clustering_loss:  0.5005, train_error: 0.6128
class 0: acc 0.7024793388429752, correct 85/121
class 1: acc 0.24603174603174602, correct 31/126
class 2: acc 0.2727272727272727, correct 33/121
class 3: acc 0.2545454545454545, correct 28/110
class 4: acc 0.45689655172413796, correct 53/116

Val Set, val_loss: 1.2692, val_error: 0.5405, auc: 0.7539
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2089, instance_loss: 0.5805, weighted_loss: 1.7204, label: 2, bag_size: 809
batch 39, loss: 0.0926, instance_loss: 0.2979, weighted_loss: 0.1542, label: 0, bag_size: 527
batch 59, loss: 1.0014, instance_loss: 0.5042, weighted_loss: 0.8522, label: 4, bag_size: 520
batch 79, loss: 1.3216, instance_loss: 0.5224, weighted_loss: 1.0818, label: 3, bag_size: 684
batch 99, loss: 0.1585, instance_loss: 0.3050, weighted_loss: 0.2024, label: 0, bag_size: 282
batch 119, loss: 1.1063, instance_loss: 0.4829, weighted_loss: 0.9193, label: 4, bag_size: 589
batch 139, loss: 1.0311, instance_loss: 0.4686, weighted_loss: 0.8624, label: 0, bag_size: 1414
batch 159, loss: 1.3848, instance_loss: 0.5027, weighted_loss: 1.1201, label: 4, bag_size: 729
batch 179, loss: 2.1218, instance_loss: 0.5761, weighted_loss: 1.6581, label: 2, bag_size: 877
batch 199, loss: 1.5245, instance_loss: 0.5596, weighted_loss: 1.2350, label: 2, bag_size: 337
batch 219, loss: 1.2764, instance_loss: 0.5132, weighted_loss: 1.0475, label: 4, bag_size: 660
batch 239, loss: 1.3335, instance_loss: 0.4414, weighted_loss: 1.0658, label: 3, bag_size: 301
batch 259, loss: 0.9063, instance_loss: 0.5002, weighted_loss: 0.7845, label: 1, bag_size: 1497
batch 279, loss: 1.2195, instance_loss: 0.5004, weighted_loss: 1.0038, label: 4, bag_size: 824
batch 299, loss: 0.9847, instance_loss: 0.5681, weighted_loss: 0.8598, label: 4, bag_size: 660
batch 319, loss: 1.2307, instance_loss: 0.5198, weighted_loss: 1.0174, label: 1, bag_size: 605
batch 339, loss: 1.0563, instance_loss: 0.4487, weighted_loss: 0.8740, label: 3, bag_size: 780
batch 359, loss: 2.3009, instance_loss: 0.5287, weighted_loss: 1.7692, label: 2, bag_size: 340
batch 379, loss: 0.8672, instance_loss: 0.5984, weighted_loss: 0.7865, label: 0, bag_size: 317
batch 399, loss: 1.1829, instance_loss: 0.5619, weighted_loss: 0.9966, label: 1, bag_size: 766
batch 419, loss: 2.6460, instance_loss: 0.6937, weighted_loss: 2.0603, label: 2, bag_size: 1074
batch 439, loss: 1.7244, instance_loss: 0.5912, weighted_loss: 1.3844, label: 1, bag_size: 141
batch 459, loss: 1.1007, instance_loss: 0.4974, weighted_loss: 0.9197, label: 4, bag_size: 489
batch 479, loss: 1.1796, instance_loss: 0.4871, weighted_loss: 0.9719, label: 4, bag_size: 293
batch 499, loss: 1.1381, instance_loss: 0.4998, weighted_loss: 0.9466, label: 2, bag_size: 348
batch 519, loss: 0.5711, instance_loss: 0.5526, weighted_loss: 0.5655, label: 0, bag_size: 79
batch 539, loss: 1.1008, instance_loss: 0.4380, weighted_loss: 0.9019, label: 3, bag_size: 309
batch 559, loss: 0.9754, instance_loss: 0.4135, weighted_loss: 0.8068, label: 3, bag_size: 1154
batch 579, loss: 1.4892, instance_loss: 0.4917, weighted_loss: 1.1899, label: 1, bag_size: 697


class 0 clustering acc 0.9983164983164983: correct 23720/23760
class 1 clustering acc 0.032196969696969696: correct 153/4752
Epoch: 11, train_loss: 1.2853, train_clustering_loss:  0.4955, train_error: 0.5909
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.1271186440677966, correct 15/118
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.3722627737226277, correct 51/137
class 4: acc 0.528, correct 66/125

Val Set, val_loss: 1.2765, val_error: 0.5946, auc: 0.7909
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7996, instance_loss: 0.5546, weighted_loss: 1.4261, label: 1, bag_size: 419
batch 39, loss: 1.0287, instance_loss: 0.4812, weighted_loss: 0.8644, label: 2, bag_size: 135
batch 59, loss: 1.5269, instance_loss: 0.5146, weighted_loss: 1.2232, label: 4, bag_size: 771
batch 79, loss: 0.8621, instance_loss: 0.5122, weighted_loss: 0.7571, label: 4, bag_size: 574
batch 99, loss: 1.2456, instance_loss: 0.4440, weighted_loss: 1.0052, label: 3, bag_size: 317
batch 119, loss: 1.3470, instance_loss: 0.5159, weighted_loss: 1.0976, label: 2, bag_size: 697
batch 139, loss: 1.1113, instance_loss: 0.4383, weighted_loss: 0.9094, label: 3, bag_size: 830
batch 159, loss: 0.9512, instance_loss: 0.3604, weighted_loss: 0.7740, label: 3, bag_size: 498
batch 179, loss: 1.5987, instance_loss: 0.5158, weighted_loss: 1.2738, label: 2, bag_size: 1066
batch 199, loss: 1.4580, instance_loss: 0.4624, weighted_loss: 1.1593, label: 1, bag_size: 851
batch 219, loss: 1.7793, instance_loss: 0.5531, weighted_loss: 1.4114, label: 2, bag_size: 470
batch 239, loss: 1.4651, instance_loss: 0.5068, weighted_loss: 1.1776, label: 1, bag_size: 422
batch 259, loss: 0.9526, instance_loss: 0.5004, weighted_loss: 0.8169, label: 4, bag_size: 489
batch 279, loss: 1.6853, instance_loss: 0.5980, weighted_loss: 1.3591, label: 4, bag_size: 854
batch 299, loss: 0.8792, instance_loss: 0.4218, weighted_loss: 0.7420, label: 0, bag_size: 351
batch 319, loss: 0.7572, instance_loss: 0.4355, weighted_loss: 0.6607, label: 3, bag_size: 739
batch 339, loss: 0.8849, instance_loss: 0.4719, weighted_loss: 0.7610, label: 3, bag_size: 897
batch 359, loss: 0.9791, instance_loss: 0.4267, weighted_loss: 0.8133, label: 3, bag_size: 804
batch 379, loss: 2.3944, instance_loss: 0.6706, weighted_loss: 1.8773, label: 4, bag_size: 547
batch 399, loss: 0.0220, instance_loss: 0.3186, weighted_loss: 0.1110, label: 1, bag_size: 371
batch 419, loss: 0.5029, instance_loss: 0.3580, weighted_loss: 0.4594, label: 4, bag_size: 868
batch 439, loss: 2.6101, instance_loss: 0.6656, weighted_loss: 2.0267, label: 4, bag_size: 438
batch 459, loss: 1.2942, instance_loss: 0.5467, weighted_loss: 1.0699, label: 2, bag_size: 567
batch 479, loss: 1.0482, instance_loss: 0.4495, weighted_loss: 0.8686, label: 2, bag_size: 598
batch 499, loss: 1.0313, instance_loss: 0.4363, weighted_loss: 0.8528, label: 4, bag_size: 687
batch 519, loss: 1.1425, instance_loss: 0.4829, weighted_loss: 0.9447, label: 3, bag_size: 472
batch 539, loss: 1.6461, instance_loss: 0.5264, weighted_loss: 1.3102, label: 1, bag_size: 591
batch 559, loss: 1.0287, instance_loss: 0.4543, weighted_loss: 0.8564, label: 2, bag_size: 812
batch 579, loss: 0.2512, instance_loss: 0.3265, weighted_loss: 0.2738, label: 0, bag_size: 281


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.046296296296296294: correct 220/4752
Epoch: 12, train_loss: 1.2884, train_clustering_loss:  0.4896, train_error: 0.5741
class 0: acc 0.7788461538461539, correct 81/104
class 1: acc 0.2692307692307692, correct 35/130
class 2: acc 0.34375, correct 44/128
class 3: acc 0.5343511450381679, correct 70/131
class 4: acc 0.22772277227722773, correct 23/101

Val Set, val_loss: 1.2357, val_error: 0.5541, auc: 0.7903
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1703, instance_loss: 0.4105, weighted_loss: 0.9423, label: 2, bag_size: 717
batch 39, loss: 0.9449, instance_loss: 0.4815, weighted_loss: 0.8059, label: 1, bag_size: 981
batch 59, loss: 1.4769, instance_loss: 0.5394, weighted_loss: 1.1956, label: 3, bag_size: 423
batch 79, loss: 0.0577, instance_loss: 0.2227, weighted_loss: 0.1072, label: 0, bag_size: 573
batch 99, loss: 1.3312, instance_loss: 0.4703, weighted_loss: 1.0729, label: 2, bag_size: 877
batch 119, loss: 1.3189, instance_loss: 0.4999, weighted_loss: 1.0732, label: 1, bag_size: 328
batch 139, loss: 1.0563, instance_loss: 0.4229, weighted_loss: 0.8662, label: 3, bag_size: 453
batch 159, loss: 0.0887, instance_loss: 0.1930, weighted_loss: 0.1200, label: 0, bag_size: 488
batch 179, loss: 0.7519, instance_loss: 0.4619, weighted_loss: 0.6649, label: 0, bag_size: 642
batch 199, loss: 0.2800, instance_loss: 0.3763, weighted_loss: 0.3089, label: 4, bag_size: 665
batch 219, loss: 0.9431, instance_loss: 0.5703, weighted_loss: 0.8313, label: 2, bag_size: 1079
batch 239, loss: 0.8681, instance_loss: 0.4817, weighted_loss: 0.7521, label: 4, bag_size: 489
batch 259, loss: 1.4321, instance_loss: 0.5406, weighted_loss: 1.1647, label: 1, bag_size: 381
batch 279, loss: 0.7325, instance_loss: 0.4531, weighted_loss: 0.6487, label: 0, bag_size: 231
batch 299, loss: 1.8249, instance_loss: 0.5171, weighted_loss: 1.4326, label: 1, bag_size: 384
batch 319, loss: 1.1980, instance_loss: 0.4837, weighted_loss: 0.9837, label: 4, bag_size: 407
batch 339, loss: 1.0720, instance_loss: 0.5220, weighted_loss: 0.9070, label: 2, bag_size: 769
batch 359, loss: 1.1475, instance_loss: 0.5085, weighted_loss: 0.9558, label: 4, bag_size: 1113
batch 379, loss: 1.3536, instance_loss: 0.4988, weighted_loss: 1.0971, label: 4, bag_size: 238
batch 399, loss: 1.0685, instance_loss: 0.4306, weighted_loss: 0.8771, label: 2, bag_size: 385
batch 419, loss: 1.1454, instance_loss: 0.4443, weighted_loss: 0.9351, label: 2, bag_size: 339
batch 439, loss: 1.0842, instance_loss: 0.4418, weighted_loss: 0.8915, label: 3, bag_size: 344
batch 459, loss: 2.2887, instance_loss: 0.6306, weighted_loss: 1.7913, label: 0, bag_size: 376
batch 479, loss: 3.7265, instance_loss: 0.5672, weighted_loss: 2.7787, label: 4, bag_size: 960
batch 499, loss: 0.9416, instance_loss: 0.4545, weighted_loss: 0.7955, label: 4, bag_size: 293
batch 519, loss: 3.0402, instance_loss: 0.5807, weighted_loss: 2.3024, label: 2, bag_size: 809
batch 539, loss: 0.5197, instance_loss: 0.3871, weighted_loss: 0.4800, label: 0, bag_size: 282
batch 559, loss: 1.0858, instance_loss: 0.4576, weighted_loss: 0.8973, label: 3, bag_size: 1154
batch 579, loss: 0.5962, instance_loss: 0.3744, weighted_loss: 0.5297, label: 4, bag_size: 727


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.03935185185185185: correct 187/4752
Epoch: 13, train_loss: 1.2838, train_clustering_loss:  0.4884, train_error: 0.5623
class 0: acc 0.7522935779816514, correct 82/109
class 1: acc 0.11, correct 11/100
class 2: acc 0.40458015267175573, correct 53/131
class 3: acc 0.4330708661417323, correct 55/127
class 4: acc 0.4645669291338583, correct 59/127

Val Set, val_loss: 1.2584, val_error: 0.5676, auc: 0.7824
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7713, instance_loss: 0.3691, weighted_loss: 0.6506, label: 1, bag_size: 1497
batch 39, loss: 0.4894, instance_loss: 0.4596, weighted_loss: 0.4804, label: 4, bag_size: 530
batch 59, loss: 0.3914, instance_loss: 0.5257, weighted_loss: 0.4317, label: 0, bag_size: 566
batch 79, loss: 1.4729, instance_loss: 0.5232, weighted_loss: 1.1880, label: 1, bag_size: 634
batch 99, loss: 0.1164, instance_loss: 0.3155, weighted_loss: 0.1761, label: 0, bag_size: 141
batch 119, loss: 0.2293, instance_loss: 0.3398, weighted_loss: 0.2625, label: 0, bag_size: 188
batch 139, loss: 1.0252, instance_loss: 0.4858, weighted_loss: 0.8634, label: 3, bag_size: 194
batch 159, loss: 1.2326, instance_loss: 0.5542, weighted_loss: 1.0291, label: 3, bag_size: 1232
batch 179, loss: 2.8480, instance_loss: 0.6236, weighted_loss: 2.1807, label: 0, bag_size: 608
batch 199, loss: 1.1242, instance_loss: 0.4600, weighted_loss: 0.9249, label: 3, bag_size: 1284
batch 219, loss: 1.2638, instance_loss: 0.4870, weighted_loss: 1.0307, label: 3, bag_size: 797
batch 239, loss: 1.2963, instance_loss: 0.4991, weighted_loss: 1.0571, label: 3, bag_size: 423
batch 259, loss: 1.2517, instance_loss: 0.5907, weighted_loss: 1.0534, label: 1, bag_size: 381
batch 279, loss: 1.8088, instance_loss: 0.5649, weighted_loss: 1.4357, label: 2, bag_size: 369
batch 299, loss: 1.8666, instance_loss: 0.6254, weighted_loss: 1.4942, label: 2, bag_size: 331
batch 319, loss: 1.0470, instance_loss: 0.5147, weighted_loss: 0.8873, label: 2, bag_size: 350
batch 339, loss: 0.3159, instance_loss: 0.4799, weighted_loss: 0.3651, label: 4, bag_size: 923
batch 359, loss: 1.2365, instance_loss: 0.5386, weighted_loss: 1.0271, label: 1, bag_size: 1121
batch 379, loss: 1.3681, instance_loss: 0.4792, weighted_loss: 1.1015, label: 4, bag_size: 944
batch 399, loss: 0.3731, instance_loss: 0.3285, weighted_loss: 0.3597, label: 0, bag_size: 188
batch 419, loss: 1.2888, instance_loss: 0.4743, weighted_loss: 1.0444, label: 3, bag_size: 476
batch 439, loss: 0.4756, instance_loss: 0.4761, weighted_loss: 0.4758, label: 0, bag_size: 79
batch 459, loss: 1.9405, instance_loss: 0.5335, weighted_loss: 1.5184, label: 2, bag_size: 713
batch 479, loss: 1.3339, instance_loss: 0.4695, weighted_loss: 1.0746, label: 3, bag_size: 499
batch 499, loss: 0.1305, instance_loss: 0.3602, weighted_loss: 0.1994, label: 0, bag_size: 425
batch 519, loss: 1.1071, instance_loss: 0.5381, weighted_loss: 0.9364, label: 1, bag_size: 410
batch 539, loss: 0.2518, instance_loss: 0.6174, weighted_loss: 0.3615, label: 0, bag_size: 435
batch 559, loss: 1.3502, instance_loss: 0.5169, weighted_loss: 1.1002, label: 2, bag_size: 290
batch 579, loss: 6.0970, instance_loss: 0.8661, weighted_loss: 4.5277, label: 3, bag_size: 638


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.05303030303030303: correct 252/4752
Epoch: 14, train_loss: 1.2521, train_clustering_loss:  0.4885, train_error: 0.5471
class 0: acc 0.8387096774193549, correct 104/124
class 1: acc 0.2713178294573643, correct 35/129
class 2: acc 0.3090909090909091, correct 34/110
class 3: acc 0.24545454545454545, correct 27/110
class 4: acc 0.5702479338842975, correct 69/121

Val Set, val_loss: 1.1903, val_error: 0.5270, auc: 0.8130
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.200165 --> 1.190343).  Saving model ...


batch 19, loss: 1.7501, instance_loss: 0.5831, weighted_loss: 1.4000, label: 1, bag_size: 231
batch 39, loss: 1.4899, instance_loss: 0.5298, weighted_loss: 1.2019, label: 3, bag_size: 1284
batch 59, loss: 0.7714, instance_loss: 0.3655, weighted_loss: 0.6496, label: 0, bag_size: 231
batch 79, loss: 1.5391, instance_loss: 0.5101, weighted_loss: 1.2304, label: 4, bag_size: 970
batch 99, loss: 1.2769, instance_loss: 0.4894, weighted_loss: 1.0407, label: 1, bag_size: 892
batch 119, loss: 1.3382, instance_loss: 0.4658, weighted_loss: 1.0765, label: 2, bag_size: 606
batch 139, loss: 1.2565, instance_loss: 0.5402, weighted_loss: 1.0416, label: 3, bag_size: 928
batch 159, loss: 2.3409, instance_loss: 0.5574, weighted_loss: 1.8058, label: 4, bag_size: 937
batch 179, loss: 1.6906, instance_loss: 0.5240, weighted_loss: 1.3406, label: 4, bag_size: 407
batch 199, loss: 1.2688, instance_loss: 0.4971, weighted_loss: 1.0373, label: 3, bag_size: 797
batch 219, loss: 1.2018, instance_loss: 0.5073, weighted_loss: 0.9935, label: 3, bag_size: 1328
batch 239, loss: 1.3497, instance_loss: 0.5547, weighted_loss: 1.1112, label: 0, bag_size: 400
batch 259, loss: 1.2261, instance_loss: 0.5380, weighted_loss: 1.0196, label: 2, bag_size: 584
batch 279, loss: 1.7523, instance_loss: 0.4499, weighted_loss: 1.3616, label: 0, bag_size: 1045
batch 299, loss: 1.7132, instance_loss: 0.5334, weighted_loss: 1.3592, label: 3, bag_size: 342
batch 319, loss: 0.8580, instance_loss: 0.4589, weighted_loss: 0.7383, label: 0, bag_size: 404
batch 339, loss: 1.0463, instance_loss: 0.5261, weighted_loss: 0.8902, label: 2, bag_size: 590
batch 359, loss: 1.0075, instance_loss: 0.4528, weighted_loss: 0.8411, label: 3, bag_size: 822
batch 379, loss: 2.8059, instance_loss: 0.6505, weighted_loss: 2.1593, label: 0, bag_size: 608
batch 399, loss: 0.8651, instance_loss: 0.3921, weighted_loss: 0.7232, label: 3, bag_size: 780
batch 419, loss: 0.0007, instance_loss: 0.2365, weighted_loss: 0.0715, label: 4, bag_size: 813
batch 439, loss: 1.0999, instance_loss: 0.4650, weighted_loss: 0.9094, label: 2, bag_size: 288
batch 459, loss: 0.7688, instance_loss: 0.4356, weighted_loss: 0.6688, label: 2, bag_size: 684
batch 479, loss: 0.1792, instance_loss: 0.2406, weighted_loss: 0.1976, label: 0, bag_size: 192
batch 499, loss: 0.0232, instance_loss: 0.3299, weighted_loss: 0.1152, label: 0, bag_size: 280
batch 519, loss: 0.8165, instance_loss: 0.6040, weighted_loss: 0.7527, label: 0, bag_size: 477
batch 539, loss: 1.2110, instance_loss: 0.4881, weighted_loss: 0.9941, label: 4, bag_size: 333
batch 559, loss: 1.3473, instance_loss: 0.5104, weighted_loss: 1.0962, label: 4, bag_size: 729
batch 579, loss: 1.2342, instance_loss: 0.5117, weighted_loss: 1.0174, label: 1, bag_size: 1013


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.039141414141414144: correct 186/4752
Epoch: 15, train_loss: 1.2693, train_clustering_loss:  0.4916, train_error: 0.5589
class 0: acc 0.7709923664122137, correct 101/131
class 1: acc 0.14814814814814814, correct 16/108
class 2: acc 0.4765625, correct 61/128
class 3: acc 0.2882882882882883, correct 32/111
class 4: acc 0.4482758620689655, correct 52/116

Val Set, val_loss: 1.2039, val_error: 0.5270, auc: 0.8055
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9556, instance_loss: 0.4501, weighted_loss: 0.8039, label: 2, bag_size: 607
batch 39, loss: 1.2657, instance_loss: 0.4384, weighted_loss: 1.0175, label: 2, bag_size: 844
batch 59, loss: 0.0261, instance_loss: 0.2470, weighted_loss: 0.0924, label: 0, bag_size: 210
batch 79, loss: 1.2505, instance_loss: 0.4232, weighted_loss: 1.0023, label: 2, bag_size: 852
batch 99, loss: 1.0552, instance_loss: 0.4559, weighted_loss: 0.8754, label: 3, bag_size: 453
batch 119, loss: 1.6379, instance_loss: 0.4733, weighted_loss: 1.2885, label: 3, bag_size: 996
batch 139, loss: 1.4102, instance_loss: 0.4924, weighted_loss: 1.1349, label: 2, bag_size: 445
batch 159, loss: 0.7418, instance_loss: 0.4021, weighted_loss: 0.6399, label: 1, bag_size: 593
batch 179, loss: 0.5677, instance_loss: 0.3498, weighted_loss: 0.5023, label: 0, bag_size: 493
batch 199, loss: 1.2549, instance_loss: 0.4933, weighted_loss: 1.0264, label: 4, bag_size: 263
batch 219, loss: 0.5907, instance_loss: 0.3819, weighted_loss: 0.5280, label: 4, bag_size: 506
batch 239, loss: 1.5295, instance_loss: 0.5116, weighted_loss: 1.2242, label: 2, bag_size: 1066
batch 259, loss: 0.0987, instance_loss: 0.2458, weighted_loss: 0.1428, label: 0, bag_size: 527
batch 279, loss: 3.1211, instance_loss: 0.8497, weighted_loss: 2.4397, label: 0, bag_size: 214
batch 299, loss: 1.1074, instance_loss: 0.5005, weighted_loss: 0.9253, label: 1, bag_size: 444
batch 319, loss: 0.0797, instance_loss: 0.2728, weighted_loss: 0.1376, label: 0, bag_size: 285
batch 339, loss: 1.1146, instance_loss: 0.4836, weighted_loss: 0.9253, label: 3, bag_size: 109
batch 359, loss: 1.5042, instance_loss: 0.5581, weighted_loss: 1.2204, label: 3, bag_size: 300
batch 379, loss: 1.1654, instance_loss: 0.4545, weighted_loss: 0.9522, label: 4, bag_size: 699
batch 399, loss: 2.4120, instance_loss: 0.4910, weighted_loss: 1.8357, label: 0, bag_size: 1073
batch 419, loss: 0.1443, instance_loss: 0.2706, weighted_loss: 0.1822, label: 0, bag_size: 552
batch 439, loss: 1.5782, instance_loss: 0.5105, weighted_loss: 1.2579, label: 3, bag_size: 323
batch 459, loss: 1.1393, instance_loss: 0.4959, weighted_loss: 0.9463, label: 1, bag_size: 660
batch 479, loss: 0.2729, instance_loss: 0.3904, weighted_loss: 0.3081, label: 0, bag_size: 62
batch 499, loss: 0.0305, instance_loss: 0.2163, weighted_loss: 0.0862, label: 0, bag_size: 70
batch 519, loss: 1.4559, instance_loss: 0.5413, weighted_loss: 1.1815, label: 2, bag_size: 350
batch 539, loss: 0.0996, instance_loss: 0.2913, weighted_loss: 0.1571, label: 0, bag_size: 142
batch 559, loss: 1.5410, instance_loss: 0.5257, weighted_loss: 1.2364, label: 2, bag_size: 576
batch 579, loss: 1.3556, instance_loss: 0.5192, weighted_loss: 1.1047, label: 2, bag_size: 821


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.050715488215488214: correct 241/4752
Epoch: 16, train_loss: 1.2565, train_clustering_loss:  0.4900, train_error: 0.5471
class 0: acc 0.7941176470588235, correct 108/136
class 1: acc 0.35833333333333334, correct 43/120
class 2: acc 0.3017241379310345, correct 35/116
class 3: acc 0.40869565217391307, correct 47/115
class 4: acc 0.3364485981308411, correct 36/107

Val Set, val_loss: 1.2231, val_error: 0.6216, auc: 0.8084
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1464, instance_loss: 0.6070, weighted_loss: 0.2845, label: 0, bag_size: 435
batch 39, loss: 1.5442, instance_loss: 0.4850, weighted_loss: 1.2264, label: 3, bag_size: 337
batch 59, loss: 1.0590, instance_loss: 0.4672, weighted_loss: 0.8815, label: 3, bag_size: 309
batch 79, loss: 0.8678, instance_loss: 0.4132, weighted_loss: 0.7314, label: 3, bag_size: 603
batch 99, loss: 1.9639, instance_loss: 0.5576, weighted_loss: 1.5420, label: 2, bag_size: 488
batch 119, loss: 1.1179, instance_loss: 0.5597, weighted_loss: 0.9504, label: 1, bag_size: 332
batch 139, loss: 2.1043, instance_loss: 0.6475, weighted_loss: 1.6673, label: 2, bag_size: 582
batch 159, loss: 1.2081, instance_loss: 0.4972, weighted_loss: 0.9948, label: 2, bag_size: 1013
batch 179, loss: 1.5539, instance_loss: 0.6067, weighted_loss: 1.2698, label: 1, bag_size: 384
batch 199, loss: 0.5423, instance_loss: 0.3677, weighted_loss: 0.4899, label: 4, bag_size: 744
batch 219, loss: 0.4135, instance_loss: 0.2616, weighted_loss: 0.3679, label: 0, bag_size: 428
batch 239, loss: 0.6380, instance_loss: 0.3687, weighted_loss: 0.5572, label: 4, bag_size: 687
batch 259, loss: 1.6866, instance_loss: 0.5499, weighted_loss: 1.3456, label: 1, bag_size: 408
batch 279, loss: 1.2001, instance_loss: 0.4528, weighted_loss: 0.9759, label: 2, bag_size: 821
batch 299, loss: 2.9566, instance_loss: 0.5648, weighted_loss: 2.2390, label: 2, bag_size: 1319
batch 319, loss: 1.1146, instance_loss: 0.4665, weighted_loss: 0.9202, label: 3, bag_size: 858
batch 339, loss: 1.1875, instance_loss: 0.4586, weighted_loss: 0.9688, label: 3, bag_size: 1078
batch 359, loss: 2.1733, instance_loss: 0.5288, weighted_loss: 1.6800, label: 3, bag_size: 301
batch 379, loss: 1.5851, instance_loss: 0.5382, weighted_loss: 1.2710, label: 4, bag_size: 1113
batch 399, loss: 0.8283, instance_loss: 0.3548, weighted_loss: 0.6863, label: 3, bag_size: 928
batch 419, loss: 1.7927, instance_loss: 0.5636, weighted_loss: 1.4240, label: 1, bag_size: 840
batch 439, loss: 5.0360, instance_loss: 0.7478, weighted_loss: 3.7495, label: 4, bag_size: 264
batch 459, loss: 0.9830, instance_loss: 0.3850, weighted_loss: 0.8036, label: 3, bag_size: 663
batch 479, loss: 1.4356, instance_loss: 0.5164, weighted_loss: 1.1598, label: 4, bag_size: 498
batch 499, loss: 1.4165, instance_loss: 0.5078, weighted_loss: 1.1439, label: 2, bag_size: 597
batch 519, loss: 1.1134, instance_loss: 0.5169, weighted_loss: 0.9344, label: 1, bag_size: 372
batch 539, loss: 0.9639, instance_loss: 0.5167, weighted_loss: 0.8297, label: 2, bag_size: 590
batch 559, loss: 1.1932, instance_loss: 0.4873, weighted_loss: 0.9814, label: 3, bag_size: 102
batch 579, loss: 1.5277, instance_loss: 0.5301, weighted_loss: 1.2284, label: 2, bag_size: 844


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.02462121212121212: correct 117/4752
Epoch: 17, train_loss: 1.2707, train_clustering_loss:  0.5006, train_error: 0.5404
class 0: acc 0.7606837606837606, correct 89/117
class 1: acc 0.3090909090909091, correct 34/110
class 2: acc 0.3969465648854962, correct 52/131
class 3: acc 0.4365079365079365, correct 55/126
class 4: acc 0.39090909090909093, correct 43/110

Val Set, val_loss: 1.1705, val_error: 0.5270, auc: 0.8182
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.190343 --> 1.170493).  Saving model ...


batch 19, loss: 2.2303, instance_loss: 0.5956, weighted_loss: 1.7399, label: 3, bag_size: 342
batch 39, loss: 0.9312, instance_loss: 0.3964, weighted_loss: 0.7708, label: 3, bag_size: 102
batch 59, loss: 2.0467, instance_loss: 0.5059, weighted_loss: 1.5845, label: 1, bag_size: 408
batch 79, loss: 2.4217, instance_loss: 0.5502, weighted_loss: 1.8603, label: 4, bag_size: 312
batch 99, loss: 0.1540, instance_loss: 0.3751, weighted_loss: 0.2203, label: 0, bag_size: 324
batch 119, loss: 1.2236, instance_loss: 0.5106, weighted_loss: 1.0097, label: 0, bag_size: 642
batch 139, loss: 0.7662, instance_loss: 0.4900, weighted_loss: 0.6833, label: 1, bag_size: 593
batch 159, loss: 1.0835, instance_loss: 0.4975, weighted_loss: 0.9077, label: 1, bag_size: 208
batch 179, loss: 0.7215, instance_loss: 0.3277, weighted_loss: 0.6034, label: 3, bag_size: 817
batch 199, loss: 1.0757, instance_loss: 0.5178, weighted_loss: 0.9084, label: 4, bag_size: 204
batch 219, loss: 1.6332, instance_loss: 0.5771, weighted_loss: 1.3164, label: 0, bag_size: 1414
batch 239, loss: 0.9680, instance_loss: 0.5302, weighted_loss: 0.8367, label: 1, bag_size: 328
batch 259, loss: 2.2696, instance_loss: 0.6447, weighted_loss: 1.7821, label: 2, bag_size: 512
batch 279, loss: 1.2082, instance_loss: 0.4583, weighted_loss: 0.9832, label: 3, bag_size: 961
batch 299, loss: 0.7028, instance_loss: 0.3761, weighted_loss: 0.6048, label: 3, bag_size: 344
batch 319, loss: 1.4626, instance_loss: 0.5219, weighted_loss: 1.1804, label: 1, bag_size: 949
batch 339, loss: 1.0308, instance_loss: 0.4286, weighted_loss: 0.8502, label: 3, bag_size: 309
batch 359, loss: 1.0096, instance_loss: 0.4279, weighted_loss: 0.8350, label: 4, bag_size: 266
batch 379, loss: 1.7442, instance_loss: 0.5287, weighted_loss: 1.3796, label: 3, bag_size: 149
batch 399, loss: 1.8237, instance_loss: 0.4987, weighted_loss: 1.4262, label: 2, bag_size: 489
batch 419, loss: 0.9867, instance_loss: 0.4478, weighted_loss: 0.8250, label: 1, bag_size: 509
batch 439, loss: 0.8197, instance_loss: 0.4645, weighted_loss: 0.7131, label: 2, bag_size: 350
batch 459, loss: 2.9674, instance_loss: 0.6789, weighted_loss: 2.2809, label: 0, bag_size: 888
batch 479, loss: 0.6920, instance_loss: 0.4855, weighted_loss: 0.6300, label: 4, bag_size: 409
batch 499, loss: 0.5616, instance_loss: 0.4226, weighted_loss: 0.5199, label: 2, bag_size: 572
batch 519, loss: 1.1776, instance_loss: 0.5553, weighted_loss: 0.9909, label: 1, bag_size: 605
batch 539, loss: 1.9340, instance_loss: 0.5675, weighted_loss: 1.5240, label: 1, bag_size: 591
batch 559, loss: 2.0298, instance_loss: 0.7685, weighted_loss: 1.6514, label: 3, bag_size: 31
batch 579, loss: 1.2391, instance_loss: 0.5074, weighted_loss: 1.0196, label: 2, bag_size: 779


class 0 clustering acc 0.9988636363636364: correct 23733/23760
class 1 clustering acc 0.026304713804713806: correct 125/4752
Epoch: 18, train_loss: 1.1966, train_clustering_loss:  0.4896, train_error: 0.5185
class 0: acc 0.7741935483870968, correct 96/124
class 1: acc 0.35537190082644626, correct 43/121
class 2: acc 0.3867924528301887, correct 41/106
class 3: acc 0.5079365079365079, correct 64/126
class 4: acc 0.358974358974359, correct 42/117

Val Set, val_loss: 1.6363, val_error: 0.6486, auc: 0.7560
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4256, instance_loss: 0.4873, weighted_loss: 1.1441, label: 2, bag_size: 640
batch 39, loss: 1.2230, instance_loss: 0.4748, weighted_loss: 0.9986, label: 2, bag_size: 208
batch 59, loss: 2.3156, instance_loss: 0.5783, weighted_loss: 1.7944, label: 4, bag_size: 690
batch 79, loss: 1.7896, instance_loss: 0.7248, weighted_loss: 1.4701, label: 4, bag_size: 854
batch 99, loss: 0.5345, instance_loss: 0.4174, weighted_loss: 0.4994, label: 2, bag_size: 315
batch 119, loss: 0.9102, instance_loss: 0.4537, weighted_loss: 0.7733, label: 3, bag_size: 498
batch 139, loss: 0.1499, instance_loss: 0.3826, weighted_loss: 0.2197, label: 0, bag_size: 282
batch 159, loss: 0.0537, instance_loss: 0.2987, weighted_loss: 0.1272, label: 0, bag_size: 63
batch 179, loss: 1.0647, instance_loss: 0.4981, weighted_loss: 0.8947, label: 3, bag_size: 982
batch 199, loss: 1.1618, instance_loss: 0.4392, weighted_loss: 0.9450, label: 1, bag_size: 525
batch 219, loss: 1.2174, instance_loss: 0.4469, weighted_loss: 0.9862, label: 2, bag_size: 404
batch 239, loss: 1.3384, instance_loss: 0.4634, weighted_loss: 1.0759, label: 2, bag_size: 844
batch 259, loss: 1.0244, instance_loss: 0.4970, weighted_loss: 0.8662, label: 1, bag_size: 618
batch 279, loss: 0.1915, instance_loss: 0.3985, weighted_loss: 0.2536, label: 0, bag_size: 188
batch 299, loss: 1.8898, instance_loss: 0.7226, weighted_loss: 1.5397, label: 0, bag_size: 888
batch 319, loss: 0.9269, instance_loss: 0.4573, weighted_loss: 0.7860, label: 2, bag_size: 1013
batch 339, loss: 1.2783, instance_loss: 0.5319, weighted_loss: 1.0544, label: 2, bag_size: 337
batch 359, loss: 0.8756, instance_loss: 0.4636, weighted_loss: 0.7520, label: 3, bag_size: 697
batch 379, loss: 1.0656, instance_loss: 0.4530, weighted_loss: 0.8818, label: 3, bag_size: 822
batch 399, loss: 1.4870, instance_loss: 0.5515, weighted_loss: 1.2064, label: 2, bag_size: 549
batch 419, loss: 0.8758, instance_loss: 0.3829, weighted_loss: 0.7280, label: 1, bag_size: 371
batch 439, loss: 0.9255, instance_loss: 0.4906, weighted_loss: 0.7951, label: 1, bag_size: 141
batch 459, loss: 1.4750, instance_loss: 0.4988, weighted_loss: 1.1822, label: 2, bag_size: 512
batch 479, loss: 1.7871, instance_loss: 0.6013, weighted_loss: 1.4313, label: 4, bag_size: 886
batch 499, loss: 1.0436, instance_loss: 0.5010, weighted_loss: 0.8808, label: 3, bag_size: 369
batch 519, loss: 1.3243, instance_loss: 0.5171, weighted_loss: 1.0822, label: 2, bag_size: 266
batch 539, loss: 1.1077, instance_loss: 0.4672, weighted_loss: 0.9156, label: 1, bag_size: 1121
batch 559, loss: 2.3811, instance_loss: 0.6607, weighted_loss: 1.8650, label: 4, bag_size: 854
batch 579, loss: 1.3840, instance_loss: 0.4849, weighted_loss: 1.1143, label: 4, bag_size: 438


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.036616161616161616: correct 174/4752
Epoch: 19, train_loss: 1.1924, train_clustering_loss:  0.4909, train_error: 0.5253
class 0: acc 0.7636363636363637, correct 84/110
class 1: acc 0.5172413793103449, correct 75/145
class 2: acc 0.28695652173913044, correct 33/115
class 3: acc 0.41379310344827586, correct 48/116
class 4: acc 0.3888888888888889, correct 42/108

Val Set, val_loss: 1.3658, val_error: 0.5135, auc: 0.8054
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2535, instance_loss: 0.3675, weighted_loss: 0.2877, label: 0, bag_size: 210
batch 39, loss: 1.1332, instance_loss: 0.5256, weighted_loss: 0.9509, label: 2, bag_size: 498
batch 59, loss: 2.7772, instance_loss: 0.6380, weighted_loss: 2.1354, label: 0, bag_size: 587
batch 79, loss: 1.7425, instance_loss: 0.6357, weighted_loss: 1.4105, label: 0, bag_size: 143
batch 99, loss: 0.5642, instance_loss: 0.3247, weighted_loss: 0.4924, label: 4, bag_size: 418
batch 119, loss: 1.4597, instance_loss: 0.5462, weighted_loss: 1.1856, label: 3, bag_size: 899
batch 139, loss: 0.2947, instance_loss: 0.2762, weighted_loss: 0.2891, label: 0, bag_size: 587
batch 159, loss: 0.5904, instance_loss: 0.4705, weighted_loss: 0.5545, label: 3, bag_size: 473
batch 179, loss: 0.6692, instance_loss: 0.3764, weighted_loss: 0.5814, label: 3, bag_size: 663
batch 199, loss: 0.7218, instance_loss: 0.4175, weighted_loss: 0.6305, label: 0, bag_size: 277
batch 219, loss: 0.9464, instance_loss: 0.4954, weighted_loss: 0.8111, label: 1, bag_size: 311
batch 239, loss: 1.3139, instance_loss: 0.5066, weighted_loss: 1.0717, label: 1, bag_size: 697
batch 259, loss: 3.2610, instance_loss: 0.7804, weighted_loss: 2.5168, label: 2, bag_size: 1122
batch 279, loss: 0.5351, instance_loss: 0.3547, weighted_loss: 0.4810, label: 3, bag_size: 398
batch 299, loss: 3.0490, instance_loss: 0.6805, weighted_loss: 2.3385, label: 2, bag_size: 606
batch 319, loss: 0.7750, instance_loss: 0.4919, weighted_loss: 0.6900, label: 1, bag_size: 231
batch 339, loss: 0.8146, instance_loss: 0.4678, weighted_loss: 0.7106, label: 4, bag_size: 394
batch 359, loss: 1.8266, instance_loss: 0.5658, weighted_loss: 1.4484, label: 2, bag_size: 582
batch 379, loss: 0.8262, instance_loss: 0.4475, weighted_loss: 0.7126, label: 1, bag_size: 766
batch 399, loss: 2.1577, instance_loss: 0.5101, weighted_loss: 1.6635, label: 3, bag_size: 472
batch 419, loss: 0.0182, instance_loss: 0.2158, weighted_loss: 0.0775, label: 0, bag_size: 282
batch 439, loss: 0.3392, instance_loss: 0.3722, weighted_loss: 0.3491, label: 4, bag_size: 773
batch 459, loss: 0.0412, instance_loss: 0.2075, weighted_loss: 0.0911, label: 0, bag_size: 488
batch 479, loss: 0.8871, instance_loss: 0.3831, weighted_loss: 0.7359, label: 3, bag_size: 472
batch 499, loss: 1.0549, instance_loss: 0.5187, weighted_loss: 0.8940, label: 4, bag_size: 1077
batch 519, loss: 1.2156, instance_loss: 0.5159, weighted_loss: 1.0057, label: 4, bag_size: 729
batch 539, loss: 1.1494, instance_loss: 0.5313, weighted_loss: 0.9640, label: 2, bag_size: 783
batch 559, loss: 1.1678, instance_loss: 0.5232, weighted_loss: 0.9744, label: 1, bag_size: 231
batch 579, loss: 1.2286, instance_loss: 0.5728, weighted_loss: 1.0319, label: 1, bag_size: 410


class 0 clustering acc 0.9961700336700336: correct 23669/23760
class 1 clustering acc 0.0664983164983165: correct 316/4752
Epoch: 20, train_loss: 1.1611, train_clustering_loss:  0.4790, train_error: 0.4764
class 0: acc 0.8175182481751825, correct 112/137
class 1: acc 0.4, correct 44/110
class 2: acc 0.29411764705882354, correct 30/102
class 3: acc 0.5572519083969466, correct 73/131
class 4: acc 0.45614035087719296, correct 52/114

Val Set, val_loss: 1.2039, val_error: 0.5405, auc: 0.8338
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5657, instance_loss: 0.4465, weighted_loss: 0.5299, label: 3, bag_size: 272
batch 39, loss: 1.0002, instance_loss: 0.4999, weighted_loss: 0.8501, label: 2, bag_size: 1079
batch 59, loss: 0.4920, instance_loss: 0.4676, weighted_loss: 0.4847, label: 4, bag_size: 1113
batch 79, loss: 2.1146, instance_loss: 0.5153, weighted_loss: 1.6348, label: 3, bag_size: 154
batch 99, loss: 1.3379, instance_loss: 0.5183, weighted_loss: 1.0920, label: 1, bag_size: 1009
batch 119, loss: 2.1368, instance_loss: 0.6594, weighted_loss: 1.6936, label: 0, bag_size: 370
batch 139, loss: 3.5957, instance_loss: 0.5566, weighted_loss: 2.6840, label: 2, bag_size: 563
batch 159, loss: 1.0058, instance_loss: 0.5050, weighted_loss: 0.8555, label: 4, bag_size: 541
batch 179, loss: 0.8686, instance_loss: 0.4643, weighted_loss: 0.7473, label: 3, bag_size: 369
batch 199, loss: 3.9521, instance_loss: 0.6409, weighted_loss: 2.9587, label: 3, bag_size: 638
batch 219, loss: 0.9091, instance_loss: 0.5583, weighted_loss: 0.8038, label: 2, bag_size: 702
batch 239, loss: 1.7318, instance_loss: 0.5333, weighted_loss: 1.3723, label: 2, bag_size: 1197
batch 259, loss: 1.0234, instance_loss: 0.4883, weighted_loss: 0.8629, label: 4, bag_size: 233
batch 279, loss: 1.0794, instance_loss: 0.4368, weighted_loss: 0.8866, label: 3, bag_size: 344
batch 299, loss: 1.2007, instance_loss: 0.4682, weighted_loss: 0.9809, label: 4, bag_size: 233
batch 319, loss: 0.4757, instance_loss: 0.3867, weighted_loss: 0.4490, label: 0, bag_size: 269
batch 339, loss: 0.0495, instance_loss: 0.2062, weighted_loss: 0.0965, label: 0, bag_size: 513
batch 359, loss: 0.0185, instance_loss: 0.2777, weighted_loss: 0.0963, label: 0, bag_size: 366
batch 379, loss: 2.7370, instance_loss: 0.6585, weighted_loss: 2.1134, label: 3, bag_size: 228
batch 399, loss: 1.1857, instance_loss: 0.4733, weighted_loss: 0.9720, label: 3, bag_size: 97
batch 419, loss: 0.2951, instance_loss: 0.3858, weighted_loss: 0.3223, label: 4, bag_size: 541
batch 439, loss: 0.6172, instance_loss: 0.3905, weighted_loss: 0.5492, label: 3, bag_size: 684
batch 459, loss: 3.1847, instance_loss: 0.6626, weighted_loss: 2.4281, label: 0, bag_size: 273
batch 479, loss: 1.4625, instance_loss: 0.5064, weighted_loss: 1.1757, label: 2, bag_size: 597
batch 499, loss: 1.0049, instance_loss: 0.4345, weighted_loss: 0.8338, label: 1, bag_size: 233
batch 519, loss: 0.5529, instance_loss: 0.4451, weighted_loss: 0.5206, label: 1, bag_size: 1019
batch 539, loss: 0.8706, instance_loss: 0.5556, weighted_loss: 0.7761, label: 1, bag_size: 593
batch 559, loss: 1.0281, instance_loss: 0.4117, weighted_loss: 0.8431, label: 1, bag_size: 390
batch 579, loss: 0.7845, instance_loss: 0.4781, weighted_loss: 0.6926, label: 3, bag_size: 498


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.04461279461279461: correct 212/4752
Epoch: 21, train_loss: 1.1819, train_clustering_loss:  0.4855, train_error: 0.5067
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.28695652173913044, correct 33/115
class 2: acc 0.4453125, correct 57/128
class 3: acc 0.42105263157894735, correct 48/114
class 4: acc 0.5172413793103449, correct 60/116

Val Set, val_loss: 1.2541, val_error: 0.5541, auc: 0.7942
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2652, instance_loss: 0.5493, weighted_loss: 1.0505, label: 3, bag_size: 323
batch 39, loss: 3.6732, instance_loss: 0.8305, weighted_loss: 2.8204, label: 1, bag_size: 44
batch 59, loss: 1.3073, instance_loss: 0.4424, weighted_loss: 1.0478, label: 1, bag_size: 525
batch 79, loss: 1.7994, instance_loss: 0.5627, weighted_loss: 1.4284, label: 2, bag_size: 627
batch 99, loss: 1.1872, instance_loss: 0.5312, weighted_loss: 0.9904, label: 3, bag_size: 830
batch 119, loss: 1.2771, instance_loss: 0.5269, weighted_loss: 1.0520, label: 3, bag_size: 301
batch 139, loss: 2.0274, instance_loss: 0.5509, weighted_loss: 1.5844, label: 1, bag_size: 221
batch 159, loss: 1.2437, instance_loss: 0.4901, weighted_loss: 1.0177, label: 1, bag_size: 419
batch 179, loss: 1.7069, instance_loss: 0.6125, weighted_loss: 1.3785, label: 4, bag_size: 685
batch 199, loss: 1.6506, instance_loss: 0.5929, weighted_loss: 1.3333, label: 2, bag_size: 321
batch 219, loss: 0.7490, instance_loss: 0.4994, weighted_loss: 0.6741, label: 4, bag_size: 394
batch 239, loss: 0.9051, instance_loss: 0.4555, weighted_loss: 0.7703, label: 4, bag_size: 868
batch 259, loss: 1.1689, instance_loss: 0.5209, weighted_loss: 0.9745, label: 2, bag_size: 427
batch 279, loss: 0.7821, instance_loss: 0.4746, weighted_loss: 0.6899, label: 3, bag_size: 459
batch 299, loss: 1.0987, instance_loss: 0.4228, weighted_loss: 0.8959, label: 3, bag_size: 641
batch 319, loss: 2.9080, instance_loss: 0.6902, weighted_loss: 2.2427, label: 2, bag_size: 1122
batch 339, loss: 1.4283, instance_loss: 0.4957, weighted_loss: 1.1485, label: 1, bag_size: 829
batch 359, loss: 0.0000, instance_loss: 0.6326, weighted_loss: 0.1898, label: 1, bag_size: 669
batch 379, loss: 1.4830, instance_loss: 0.5162, weighted_loss: 1.1930, label: 2, bag_size: 361
batch 399, loss: 0.9677, instance_loss: 0.4183, weighted_loss: 0.8029, label: 2, bag_size: 427
batch 419, loss: 0.3239, instance_loss: 0.4522, weighted_loss: 0.3624, label: 0, bag_size: 33
batch 439, loss: 0.7273, instance_loss: 0.4680, weighted_loss: 0.6495, label: 3, bag_size: 317
batch 459, loss: 1.1493, instance_loss: 0.5071, weighted_loss: 0.9566, label: 1, bag_size: 381
batch 479, loss: 1.0009, instance_loss: 0.4539, weighted_loss: 0.8368, label: 3, bag_size: 681
batch 499, loss: 0.0868, instance_loss: 0.3422, weighted_loss: 0.1634, label: 0, bag_size: 370
batch 519, loss: 1.7424, instance_loss: 0.6014, weighted_loss: 1.4001, label: 4, bag_size: 690
batch 539, loss: 3.5897, instance_loss: 0.7528, weighted_loss: 2.7386, label: 3, bag_size: 795
batch 559, loss: 1.1644, instance_loss: 0.5286, weighted_loss: 0.9736, label: 2, bag_size: 410
batch 579, loss: 1.5969, instance_loss: 0.5665, weighted_loss: 1.2878, label: 4, bag_size: 363


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.04776936026936027: correct 227/4752
Epoch: 22, train_loss: 1.2105, train_clustering_loss:  0.4884, train_error: 0.4966
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.3953488372093023, correct 51/129
class 2: acc 0.36666666666666664, correct 44/120
class 3: acc 0.5775862068965517, correct 67/116
class 4: acc 0.3888888888888889, correct 42/108

Val Set, val_loss: 1.1465, val_error: 0.4730, auc: 0.8372
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.170493 --> 1.146488).  Saving model ...


batch 19, loss: 1.3006, instance_loss: 0.4974, weighted_loss: 1.0596, label: 2, bag_size: 427
batch 39, loss: 0.7636, instance_loss: 0.3761, weighted_loss: 0.6474, label: 3, bag_size: 505
batch 59, loss: 1.1131, instance_loss: 0.5410, weighted_loss: 0.9415, label: 1, bag_size: 271
batch 79, loss: 2.8951, instance_loss: 0.7143, weighted_loss: 2.2409, label: 2, bag_size: 606
batch 99, loss: 1.0978, instance_loss: 0.4696, weighted_loss: 0.9093, label: 4, bag_size: 419
batch 119, loss: 0.6056, instance_loss: 0.5078, weighted_loss: 0.5762, label: 0, bag_size: 732
batch 139, loss: 1.2298, instance_loss: 0.5060, weighted_loss: 1.0127, label: 3, bag_size: 499
batch 159, loss: 0.4219, instance_loss: 0.4853, weighted_loss: 0.4409, label: 0, bag_size: 230
batch 179, loss: 2.1327, instance_loss: 0.5828, weighted_loss: 1.6677, label: 3, bag_size: 342
batch 199, loss: 0.9104, instance_loss: 0.4414, weighted_loss: 0.7697, label: 2, bag_size: 572
batch 219, loss: 0.9659, instance_loss: 0.4333, weighted_loss: 0.8061, label: 0, bag_size: 223
batch 239, loss: 0.5868, instance_loss: 0.4643, weighted_loss: 0.5501, label: 4, bag_size: 729
batch 259, loss: 0.8417, instance_loss: 0.4550, weighted_loss: 0.7257, label: 2, bag_size: 410
batch 279, loss: 1.7578, instance_loss: 0.6052, weighted_loss: 1.4120, label: 2, bag_size: 321
batch 299, loss: 1.3054, instance_loss: 0.4697, weighted_loss: 1.0546, label: 1, bag_size: 614
batch 319, loss: 0.8919, instance_loss: 0.4702, weighted_loss: 0.7654, label: 4, bag_size: 744
batch 339, loss: 0.8620, instance_loss: 0.5060, weighted_loss: 0.7552, label: 4, bag_size: 204
batch 359, loss: 2.0272, instance_loss: 0.5411, weighted_loss: 1.5814, label: 4, bag_size: 333
batch 379, loss: 0.0548, instance_loss: 0.1877, weighted_loss: 0.0947, label: 0, bag_size: 101
batch 399, loss: 1.0898, instance_loss: 0.4485, weighted_loss: 0.8974, label: 1, bag_size: 419
batch 419, loss: 2.9139, instance_loss: 0.8289, weighted_loss: 2.2884, label: 3, bag_size: 31
batch 439, loss: 1.3584, instance_loss: 0.4973, weighted_loss: 1.1000, label: 0, bag_size: 710
batch 459, loss: 0.6264, instance_loss: 0.5432, weighted_loss: 0.6014, label: 2, bag_size: 684
batch 479, loss: 1.2386, instance_loss: 0.5327, weighted_loss: 1.0269, label: 1, bag_size: 419
batch 499, loss: 0.4553, instance_loss: 0.4023, weighted_loss: 0.4394, label: 2, bag_size: 572
batch 519, loss: 0.7171, instance_loss: 0.4206, weighted_loss: 0.6282, label: 1, bag_size: 593
batch 539, loss: 0.0121, instance_loss: 0.2192, weighted_loss: 0.0742, label: 0, bag_size: 103
batch 559, loss: 0.9718, instance_loss: 0.4278, weighted_loss: 0.8086, label: 3, bag_size: 500
batch 579, loss: 0.9126, instance_loss: 0.5044, weighted_loss: 0.7902, label: 1, bag_size: 141


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.0723905723905724: correct 344/4752
Epoch: 23, train_loss: 1.1483, train_clustering_loss:  0.4786, train_error: 0.5000
class 0: acc 0.7894736842105263, correct 90/114
class 1: acc 0.44715447154471544, correct 55/123
class 2: acc 0.36666666666666664, correct 44/120
class 3: acc 0.5648854961832062, correct 74/131
class 4: acc 0.32075471698113206, correct 34/106

Val Set, val_loss: 1.2004, val_error: 0.4865, auc: 0.8034
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.12162162162162163: correct 72/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0474, instance_loss: 0.4053, weighted_loss: 0.8548, label: 3, bag_size: 309
batch 39, loss: 1.2704, instance_loss: 0.5721, weighted_loss: 1.0609, label: 4, bag_size: 797
batch 59, loss: 1.2076, instance_loss: 0.5636, weighted_loss: 1.0144, label: 2, bag_size: 96
batch 79, loss: 0.8726, instance_loss: 0.4619, weighted_loss: 0.7494, label: 2, bag_size: 470
batch 99, loss: 1.0191, instance_loss: 0.4500, weighted_loss: 0.8484, label: 3, bag_size: 282
batch 119, loss: 0.8874, instance_loss: 0.5152, weighted_loss: 0.7757, label: 1, bag_size: 981
batch 139, loss: 0.9439, instance_loss: 0.4244, weighted_loss: 0.7881, label: 3, bag_size: 245
batch 159, loss: 0.7656, instance_loss: 0.6076, weighted_loss: 0.7182, label: 4, bag_size: 854
batch 179, loss: 1.0774, instance_loss: 0.4956, weighted_loss: 0.9029, label: 2, bag_size: 337
batch 199, loss: 1.4509, instance_loss: 0.5233, weighted_loss: 1.1727, label: 1, bag_size: 1023
batch 219, loss: 3.7062, instance_loss: 0.8064, weighted_loss: 2.8362, label: 3, bag_size: 1057
batch 239, loss: 1.1978, instance_loss: 0.5736, weighted_loss: 1.0105, label: 2, bag_size: 119
batch 259, loss: 1.1994, instance_loss: 0.6958, weighted_loss: 1.0483, label: 0, bag_size: 143
batch 279, loss: 1.1736, instance_loss: 0.4531, weighted_loss: 0.9575, label: 3, bag_size: 894
batch 299, loss: 0.0075, instance_loss: 0.1462, weighted_loss: 0.0491, label: 0, bag_size: 425
batch 319, loss: 1.2470, instance_loss: 0.5925, weighted_loss: 1.0507, label: 4, bag_size: 419
batch 339, loss: 1.1034, instance_loss: 0.4325, weighted_loss: 0.9021, label: 1, bag_size: 525
batch 359, loss: 0.9688, instance_loss: 0.4518, weighted_loss: 0.8137, label: 3, bag_size: 817
batch 379, loss: 0.6014, instance_loss: 0.4091, weighted_loss: 0.5437, label: 3, bag_size: 459
batch 399, loss: 0.5636, instance_loss: 0.4494, weighted_loss: 0.5293, label: 4, bag_size: 1113
batch 419, loss: 1.3199, instance_loss: 0.4919, weighted_loss: 1.0715, label: 2, bag_size: 799
batch 439, loss: 0.8525, instance_loss: 0.4596, weighted_loss: 0.7347, label: 1, bag_size: 389
batch 459, loss: 0.3533, instance_loss: 0.4430, weighted_loss: 0.3802, label: 4, bag_size: 773
batch 479, loss: 1.0768, instance_loss: 0.4463, weighted_loss: 0.8877, label: 1, bag_size: 372
batch 499, loss: 0.8746, instance_loss: 0.4346, weighted_loss: 0.7426, label: 4, bag_size: 875
batch 519, loss: 1.1112, instance_loss: 0.5609, weighted_loss: 0.9461, label: 3, bag_size: 457
batch 539, loss: 0.0672, instance_loss: 0.3162, weighted_loss: 0.1419, label: 0, bag_size: 141
batch 559, loss: 0.1964, instance_loss: 0.3505, weighted_loss: 0.2427, label: 0, bag_size: 79
batch 579, loss: 1.2231, instance_loss: 0.4904, weighted_loss: 1.0033, label: 2, bag_size: 717


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.058712121212121215: correct 279/4752
Epoch: 24, train_loss: 1.1160, train_clustering_loss:  0.4848, train_error: 0.4714
class 0: acc 0.859375, correct 110/128
class 1: acc 0.4188034188034188, correct 49/117
class 2: acc 0.3853211009174312, correct 42/109
class 3: acc 0.39473684210526316, correct 45/114
class 4: acc 0.5396825396825397, correct 68/126

Val Set, val_loss: 1.1529, val_error: 0.4189, auc: 0.8284
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.10472972972972973: correct 62/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0264, instance_loss: 0.2962, weighted_loss: 0.1074, label: 0, bag_size: 49
batch 39, loss: 2.3901, instance_loss: 0.6184, weighted_loss: 1.8586, label: 4, bag_size: 377
batch 59, loss: 1.0234, instance_loss: 0.5125, weighted_loss: 0.8701, label: 1, bag_size: 384
batch 79, loss: 2.6658, instance_loss: 0.6585, weighted_loss: 2.0636, label: 2, bag_size: 128
batch 99, loss: 0.5889, instance_loss: 0.4064, weighted_loss: 0.5342, label: 3, bag_size: 309
batch 119, loss: 0.6948, instance_loss: 0.3785, weighted_loss: 0.5999, label: 3, bag_size: 822
batch 139, loss: 0.0576, instance_loss: 0.2127, weighted_loss: 0.1041, label: 0, bag_size: 101
batch 159, loss: 0.6960, instance_loss: 0.3770, weighted_loss: 0.6003, label: 3, bag_size: 230
batch 179, loss: 1.3518, instance_loss: 0.5305, weighted_loss: 1.1054, label: 3, bag_size: 1365
batch 199, loss: 1.2495, instance_loss: 0.5362, weighted_loss: 1.0355, label: 4, bag_size: 652
batch 219, loss: 2.5114, instance_loss: 0.6580, weighted_loss: 1.9554, label: 1, bag_size: 591
batch 239, loss: 0.3845, instance_loss: 0.4034, weighted_loss: 0.3902, label: 0, bag_size: 33
batch 259, loss: 1.1509, instance_loss: 0.3177, weighted_loss: 0.9009, label: 0, bag_size: 710
batch 279, loss: 0.6659, instance_loss: 0.5582, weighted_loss: 0.6336, label: 4, bag_size: 854
batch 299, loss: 1.2162, instance_loss: 0.4395, weighted_loss: 0.9832, label: 3, bag_size: 120
batch 319, loss: 0.8932, instance_loss: 0.5306, weighted_loss: 0.7845, label: 1, bag_size: 231
batch 339, loss: 0.9396, instance_loss: 0.5964, weighted_loss: 0.8367, label: 2, bag_size: 779
batch 359, loss: 2.3766, instance_loss: 0.5337, weighted_loss: 1.8238, label: 0, bag_size: 352
batch 379, loss: 1.0250, instance_loss: 0.5354, weighted_loss: 0.8782, label: 1, bag_size: 231
batch 399, loss: 1.5659, instance_loss: 0.4770, weighted_loss: 1.2392, label: 1, bag_size: 350
batch 419, loss: 0.2840, instance_loss: 0.3483, weighted_loss: 0.3033, label: 4, bag_size: 773
batch 439, loss: 1.9046, instance_loss: 0.5225, weighted_loss: 1.4900, label: 4, bag_size: 363
batch 459, loss: 1.4159, instance_loss: 0.4858, weighted_loss: 1.1368, label: 1, bag_size: 355
batch 479, loss: 2.2049, instance_loss: 0.6135, weighted_loss: 1.7275, label: 3, bag_size: 1147
batch 499, loss: 1.1046, instance_loss: 0.9138, weighted_loss: 1.0474, label: 3, bag_size: 31
batch 519, loss: 1.4793, instance_loss: 0.4627, weighted_loss: 1.1743, label: 3, bag_size: 301
batch 539, loss: 0.2621, instance_loss: 0.4052, weighted_loss: 0.3051, label: 0, bag_size: 269
batch 559, loss: 0.1706, instance_loss: 0.3361, weighted_loss: 0.2202, label: 3, bag_size: 684
batch 579, loss: 1.4675, instance_loss: 0.5596, weighted_loss: 1.1951, label: 3, bag_size: 498


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.07596801346801346: correct 361/4752
Epoch: 25, train_loss: 1.1067, train_clustering_loss:  0.4796, train_error: 0.4731
class 0: acc 0.8372093023255814, correct 108/129
class 1: acc 0.4152542372881356, correct 49/118
class 2: acc 0.4117647058823529, correct 49/119
class 3: acc 0.5470085470085471, correct 64/117
class 4: acc 0.38738738738738737, correct 43/111

Val Set, val_loss: 1.1720, val_error: 0.5405, auc: 0.8131
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8785, instance_loss: 0.4354, weighted_loss: 0.7456, label: 4, bag_size: 660
batch 39, loss: 2.5327, instance_loss: 0.5985, weighted_loss: 1.9525, label: 0, bag_size: 370
batch 59, loss: 0.0344, instance_loss: 0.2912, weighted_loss: 0.1114, label: 0, bag_size: 188
batch 79, loss: 1.3992, instance_loss: 0.5735, weighted_loss: 1.1515, label: 1, bag_size: 201
batch 99, loss: 2.4799, instance_loss: 0.6105, weighted_loss: 1.9191, label: 1, bag_size: 397
batch 119, loss: 0.1897, instance_loss: 0.4704, weighted_loss: 0.2739, label: 1, bag_size: 748
batch 139, loss: 0.2447, instance_loss: 0.3740, weighted_loss: 0.2835, label: 1, bag_size: 617
batch 159, loss: 2.2478, instance_loss: 0.5614, weighted_loss: 1.7419, label: 4, bag_size: 690
batch 179, loss: 0.0141, instance_loss: 0.2358, weighted_loss: 0.0806, label: 0, bag_size: 280
batch 199, loss: 0.9750, instance_loss: 0.4870, weighted_loss: 0.8286, label: 4, bag_size: 639
batch 219, loss: 0.6330, instance_loss: 0.4251, weighted_loss: 0.5707, label: 3, bag_size: 928
batch 239, loss: 1.0505, instance_loss: 0.5253, weighted_loss: 0.8929, label: 2, bag_size: 240
batch 259, loss: 1.9821, instance_loss: 0.5926, weighted_loss: 1.5652, label: 4, bag_size: 198
batch 279, loss: 0.8615, instance_loss: 0.5652, weighted_loss: 0.7726, label: 0, bag_size: 277
batch 299, loss: 0.5059, instance_loss: 0.5204, weighted_loss: 0.5102, label: 2, bag_size: 690
batch 319, loss: 0.7063, instance_loss: 0.4203, weighted_loss: 0.6205, label: 2, bag_size: 290
batch 339, loss: 0.0235, instance_loss: 0.4555, weighted_loss: 0.1531, label: 0, bag_size: 435
batch 359, loss: 1.5984, instance_loss: 0.5377, weighted_loss: 1.2802, label: 1, bag_size: 221
batch 379, loss: 0.7677, instance_loss: 0.4974, weighted_loss: 0.6866, label: 3, bag_size: 961
batch 399, loss: 1.4913, instance_loss: 0.5228, weighted_loss: 1.2008, label: 1, bag_size: 949
batch 419, loss: 1.4224, instance_loss: 0.4649, weighted_loss: 1.1352, label: 1, bag_size: 823
batch 439, loss: 0.0559, instance_loss: 0.2923, weighted_loss: 0.1268, label: 0, bag_size: 397
batch 459, loss: 2.7231, instance_loss: 0.5948, weighted_loss: 2.0846, label: 3, bag_size: 166
batch 479, loss: 2.2454, instance_loss: 0.4711, weighted_loss: 1.7132, label: 2, bag_size: 809
batch 499, loss: 1.1210, instance_loss: 0.4803, weighted_loss: 0.9288, label: 2, bag_size: 592
batch 519, loss: 0.9978, instance_loss: 0.4974, weighted_loss: 0.8476, label: 3, bag_size: 858
batch 539, loss: 1.2999, instance_loss: 0.4900, weighted_loss: 1.0569, label: 1, bag_size: 332
batch 559, loss: 0.3846, instance_loss: 0.3588, weighted_loss: 0.3769, label: 0, bag_size: 324
batch 579, loss: 0.6810, instance_loss: 0.4607, weighted_loss: 0.6149, label: 1, bag_size: 886


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.04924242424242424: correct 234/4752
Epoch: 26, train_loss: 1.1155, train_clustering_loss:  0.4846, train_error: 0.4747
class 0: acc 0.84, correct 105/125
class 1: acc 0.3442622950819672, correct 42/122
class 2: acc 0.49557522123893805, correct 56/113
class 3: acc 0.44715447154471544, correct 55/123
class 4: acc 0.4864864864864865, correct 54/111

Val Set, val_loss: 1.4296, val_error: 0.5541, auc: 0.8185
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.03209459459459459: correct 19/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8606, instance_loss: 0.3492, weighted_loss: 0.7072, label: 3, bag_size: 631
batch 39, loss: 1.4552, instance_loss: 0.4796, weighted_loss: 1.1625, label: 4, bag_size: 246
batch 59, loss: 1.0839, instance_loss: 0.4710, weighted_loss: 0.9000, label: 2, bag_size: 941
batch 79, loss: 3.9488, instance_loss: 0.5217, weighted_loss: 2.9206, label: 4, bag_size: 160
batch 99, loss: 1.1206, instance_loss: 0.5213, weighted_loss: 0.9408, label: 1, bag_size: 461
batch 119, loss: 0.5027, instance_loss: 0.4105, weighted_loss: 0.4750, label: 4, bag_size: 773
batch 139, loss: 0.0618, instance_loss: 0.4329, weighted_loss: 0.1732, label: 0, bag_size: 366
batch 159, loss: 2.3570, instance_loss: 0.5317, weighted_loss: 1.8094, label: 0, bag_size: 600
batch 179, loss: 2.2291, instance_loss: 0.5341, weighted_loss: 1.7206, label: 4, bag_size: 714
batch 199, loss: 0.5114, instance_loss: 0.4378, weighted_loss: 0.4893, label: 0, bag_size: 227
batch 219, loss: 1.8192, instance_loss: 0.5416, weighted_loss: 1.4359, label: 2, bag_size: 297
batch 239, loss: 1.0222, instance_loss: 0.4283, weighted_loss: 0.8440, label: 3, bag_size: 746
batch 259, loss: 1.1497, instance_loss: 0.5085, weighted_loss: 0.9573, label: 3, bag_size: 301
batch 279, loss: 0.0000, instance_loss: 0.4550, weighted_loss: 0.1365, label: 4, bag_size: 530
batch 299, loss: 0.8645, instance_loss: 0.4602, weighted_loss: 0.7432, label: 4, bag_size: 775
batch 319, loss: 0.9654, instance_loss: 0.4785, weighted_loss: 0.8194, label: 4, bag_size: 419
batch 339, loss: 0.9778, instance_loss: 0.4650, weighted_loss: 0.8239, label: 0, bag_size: 642
batch 359, loss: 1.7591, instance_loss: 0.4641, weighted_loss: 1.3706, label: 1, bag_size: 886
batch 379, loss: 0.2764, instance_loss: 0.4439, weighted_loss: 0.3267, label: 0, bag_size: 103
batch 399, loss: 0.0432, instance_loss: 0.1525, weighted_loss: 0.0760, label: 0, bag_size: 435
batch 419, loss: 1.7819, instance_loss: 0.5148, weighted_loss: 1.4018, label: 2, bag_size: 627
batch 439, loss: 1.1151, instance_loss: 0.4249, weighted_loss: 0.9081, label: 3, bag_size: 497
batch 459, loss: 1.0125, instance_loss: 0.4926, weighted_loss: 0.8565, label: 1, bag_size: 391
batch 479, loss: 1.1232, instance_loss: 0.5741, weighted_loss: 0.9584, label: 1, bag_size: 321
batch 499, loss: 0.9154, instance_loss: 0.3978, weighted_loss: 0.7601, label: 3, bag_size: 309
batch 519, loss: 1.2882, instance_loss: 0.5183, weighted_loss: 1.0573, label: 0, bag_size: 428
batch 539, loss: 0.9016, instance_loss: 0.4398, weighted_loss: 0.7631, label: 3, bag_size: 697
batch 559, loss: 0.9423, instance_loss: 0.5376, weighted_loss: 0.8209, label: 1, bag_size: 972
batch 579, loss: 0.8963, instance_loss: 0.5313, weighted_loss: 0.7868, label: 3, bag_size: 97


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.05723905723905724: correct 272/4752
Epoch: 27, train_loss: 1.1917, train_clustering_loss:  0.4865, train_error: 0.5051
class 0: acc 0.7889908256880734, correct 86/109
class 1: acc 0.22330097087378642, correct 23/103
class 2: acc 0.4344262295081967, correct 53/122
class 3: acc 0.49612403100775193, correct 64/129
class 4: acc 0.5190839694656488, correct 68/131

Val Set, val_loss: 1.1496, val_error: 0.4865, auc: 0.8353
class 0 clustering acc 0.9925675675675676: correct 2938/2960
class 1 clustering acc 0.10304054054054054: correct 61/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9699, instance_loss: 0.5133, weighted_loss: 0.8330, label: 3, bag_size: 1154
batch 39, loss: 1.1561, instance_loss: 0.5134, weighted_loss: 0.9633, label: 2, bag_size: 171
batch 59, loss: 1.3412, instance_loss: 0.5272, weighted_loss: 1.0970, label: 1, bag_size: 339
batch 79, loss: 0.4365, instance_loss: 0.4584, weighted_loss: 0.4430, label: 4, bag_size: 685
batch 99, loss: 0.5185, instance_loss: 0.5001, weighted_loss: 0.5130, label: 4, bag_size: 776
batch 119, loss: 1.1748, instance_loss: 0.4738, weighted_loss: 0.9645, label: 3, bag_size: 603
batch 139, loss: 1.2332, instance_loss: 0.4742, weighted_loss: 1.0055, label: 2, bag_size: 844
batch 159, loss: 0.9100, instance_loss: 0.4705, weighted_loss: 0.7782, label: 3, bag_size: 739
batch 179, loss: 4.1109, instance_loss: 0.7300, weighted_loss: 3.0967, label: 4, bag_size: 310
batch 199, loss: 0.9192, instance_loss: 0.4756, weighted_loss: 0.7861, label: 2, bag_size: 558
batch 219, loss: 0.9901, instance_loss: 0.5073, weighted_loss: 0.8452, label: 1, bag_size: 1121
batch 239, loss: 0.7574, instance_loss: 0.4671, weighted_loss: 0.6703, label: 4, bag_size: 218
batch 259, loss: 1.0264, instance_loss: 0.4559, weighted_loss: 0.8552, label: 1, bag_size: 500
batch 279, loss: 1.1248, instance_loss: 0.4268, weighted_loss: 0.9154, label: 1, bag_size: 201
batch 299, loss: 1.4230, instance_loss: 0.4966, weighted_loss: 1.1451, label: 2, bag_size: 597
batch 319, loss: 1.4565, instance_loss: 0.5875, weighted_loss: 1.1958, label: 1, bag_size: 44
batch 339, loss: 0.8527, instance_loss: 0.5871, weighted_loss: 0.7731, label: 2, bag_size: 590
batch 359, loss: 0.5561, instance_loss: 0.4215, weighted_loss: 0.5157, label: 4, bag_size: 875
batch 379, loss: 1.1606, instance_loss: 0.4891, weighted_loss: 0.9591, label: 2, bag_size: 299
batch 399, loss: 4.7305, instance_loss: 0.9369, weighted_loss: 3.5924, label: 0, bag_size: 214
batch 419, loss: 0.7262, instance_loss: 0.4499, weighted_loss: 0.6433, label: 4, bag_size: 875
batch 439, loss: 3.4255, instance_loss: 0.6702, weighted_loss: 2.5989, label: 0, bag_size: 492
batch 459, loss: 0.9244, instance_loss: 0.4349, weighted_loss: 0.7775, label: 1, bag_size: 697
batch 479, loss: 0.7531, instance_loss: 0.4706, weighted_loss: 0.6683, label: 1, bag_size: 321
batch 499, loss: 0.0115, instance_loss: 0.2299, weighted_loss: 0.0770, label: 0, bag_size: 103
batch 519, loss: 1.3083, instance_loss: 0.5770, weighted_loss: 1.0890, label: 0, bag_size: 62
batch 539, loss: 1.1927, instance_loss: 0.4746, weighted_loss: 0.9773, label: 1, bag_size: 607
batch 559, loss: 1.2645, instance_loss: 0.5871, weighted_loss: 1.0613, label: 2, bag_size: 614
batch 579, loss: 1.1842, instance_loss: 0.5142, weighted_loss: 0.9832, label: 1, bag_size: 419


class 0 clustering acc 0.9960016835016835: correct 23665/23760
class 1 clustering acc 0.070496632996633: correct 335/4752
Epoch: 28, train_loss: 1.1063, train_clustering_loss:  0.4840, train_error: 0.5000
class 0: acc 0.7906976744186046, correct 102/129
class 1: acc 0.5078125, correct 65/128
class 2: acc 0.18421052631578946, correct 21/114
class 3: acc 0.4473684210526316, correct 51/114
class 4: acc 0.5321100917431193, correct 58/109

Val Set, val_loss: 1.0945, val_error: 0.4189, auc: 0.8336
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.146488 --> 1.094459).  Saving model ...


batch 19, loss: 1.3855, instance_loss: 0.4313, weighted_loss: 1.0992, label: 0, bag_size: 879
batch 39, loss: 0.0096, instance_loss: 0.2120, weighted_loss: 0.0703, label: 0, bag_size: 324
batch 59, loss: 0.3533, instance_loss: 0.2710, weighted_loss: 0.3286, label: 4, bag_size: 394
batch 79, loss: 2.3854, instance_loss: 0.6660, weighted_loss: 1.8696, label: 2, bag_size: 606
batch 99, loss: 1.0499, instance_loss: 0.4839, weighted_loss: 0.8801, label: 3, bag_size: 1147
batch 119, loss: 0.8037, instance_loss: 0.4305, weighted_loss: 0.6918, label: 3, bag_size: 344
batch 139, loss: 1.7792, instance_loss: 0.5397, weighted_loss: 1.4074, label: 4, bag_size: 246
batch 159, loss: 1.1067, instance_loss: 0.4795, weighted_loss: 0.9186, label: 4, bag_size: 196
batch 179, loss: 0.7807, instance_loss: 0.4702, weighted_loss: 0.6875, label: 1, bag_size: 389
batch 199, loss: 1.2539, instance_loss: 0.4879, weighted_loss: 1.0241, label: 3, bag_size: 300
batch 219, loss: 1.3282, instance_loss: 0.5339, weighted_loss: 1.0899, label: 3, bag_size: 489
batch 239, loss: 1.1560, instance_loss: 0.4731, weighted_loss: 0.9511, label: 4, bag_size: 731
batch 259, loss: 1.3599, instance_loss: 0.5118, weighted_loss: 1.1055, label: 2, bag_size: 941
batch 279, loss: 0.8733, instance_loss: 0.4653, weighted_loss: 0.7509, label: 3, bag_size: 272
batch 299, loss: 1.0305, instance_loss: 0.4748, weighted_loss: 0.8638, label: 3, bag_size: 499
batch 319, loss: 1.6793, instance_loss: 0.5002, weighted_loss: 1.3256, label: 2, bag_size: 640
batch 339, loss: 0.8217, instance_loss: 0.4934, weighted_loss: 0.7232, label: 1, bag_size: 766
batch 359, loss: 1.9219, instance_loss: 0.5553, weighted_loss: 1.5119, label: 2, bag_size: 394
batch 379, loss: 0.1582, instance_loss: 0.2915, weighted_loss: 0.1982, label: 0, bag_size: 453
batch 399, loss: 0.7781, instance_loss: 0.4257, weighted_loss: 0.6724, label: 3, bag_size: 499
batch 419, loss: 0.0004, instance_loss: 0.3609, weighted_loss: 0.1085, label: 4, bag_size: 769
batch 439, loss: 0.9867, instance_loss: 0.4871, weighted_loss: 0.8368, label: 2, bag_size: 614
batch 459, loss: 1.3423, instance_loss: 0.5060, weighted_loss: 1.0914, label: 2, bag_size: 1016
batch 479, loss: 0.7929, instance_loss: 0.4095, weighted_loss: 0.6779, label: 2, bag_size: 576
batch 499, loss: 3.0531, instance_loss: 0.6422, weighted_loss: 2.3298, label: 4, bag_size: 310
batch 519, loss: 0.0257, instance_loss: 0.4171, weighted_loss: 0.1431, label: 0, bag_size: 230
batch 539, loss: 1.1616, instance_loss: 0.4853, weighted_loss: 0.9587, label: 3, bag_size: 1060
batch 559, loss: 0.0005, instance_loss: 0.5757, weighted_loss: 0.1731, label: 1, bag_size: 669
batch 579, loss: 0.7661, instance_loss: 0.4067, weighted_loss: 0.6583, label: 2, bag_size: 598


class 0 clustering acc 0.9956228956228956: correct 23656/23760
class 1 clustering acc 0.06060606060606061: correct 288/4752
Epoch: 29, train_loss: 1.1371, train_clustering_loss:  0.4822, train_error: 0.5000
class 0: acc 0.7795275590551181, correct 99/127
class 1: acc 0.32075471698113206, correct 34/106
class 2: acc 0.3783783783783784, correct 42/111
class 3: acc 0.5454545454545454, correct 72/132
class 4: acc 0.423728813559322, correct 50/118

Val Set, val_loss: 1.2334, val_error: 0.4865, auc: 0.8321
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9410, instance_loss: 0.4441, weighted_loss: 0.7919, label: 4, bag_size: 329
batch 39, loss: 2.2313, instance_loss: 0.5742, weighted_loss: 1.7341, label: 0, bag_size: 642
batch 59, loss: 0.9687, instance_loss: 0.5273, weighted_loss: 0.8362, label: 2, bag_size: 558
batch 79, loss: 0.0139, instance_loss: 0.2011, weighted_loss: 0.0701, label: 0, bag_size: 488
batch 99, loss: 0.5506, instance_loss: 0.4777, weighted_loss: 0.5287, label: 4, bag_size: 129
batch 119, loss: 2.0992, instance_loss: 0.6384, weighted_loss: 1.6610, label: 2, bag_size: 582
batch 139, loss: 0.7940, instance_loss: 0.4191, weighted_loss: 0.6815, label: 2, bag_size: 754
batch 159, loss: 0.2509, instance_loss: 0.3789, weighted_loss: 0.2893, label: 0, bag_size: 297
batch 179, loss: 0.7591, instance_loss: 0.4101, weighted_loss: 0.6544, label: 1, bag_size: 593
batch 199, loss: 1.7721, instance_loss: 0.5524, weighted_loss: 1.4062, label: 2, bag_size: 498
batch 219, loss: 0.0569, instance_loss: 0.2707, weighted_loss: 0.1210, label: 0, bag_size: 234
batch 239, loss: 0.1616, instance_loss: 0.3342, weighted_loss: 0.2134, label: 0, bag_size: 552
batch 259, loss: 1.0165, instance_loss: 0.4670, weighted_loss: 0.8517, label: 4, bag_size: 72
batch 279, loss: 1.4575, instance_loss: 0.8992, weighted_loss: 1.2900, label: 3, bag_size: 31
batch 299, loss: 1.1285, instance_loss: 0.4646, weighted_loss: 0.9293, label: 2, bag_size: 1197
batch 319, loss: 1.2843, instance_loss: 0.5035, weighted_loss: 1.0501, label: 3, bag_size: 1154
batch 339, loss: 0.9902, instance_loss: 0.6705, weighted_loss: 0.8943, label: 1, bag_size: 184
batch 359, loss: 2.1996, instance_loss: 0.5155, weighted_loss: 1.6943, label: 3, bag_size: 474
batch 379, loss: 0.0210, instance_loss: 0.1876, weighted_loss: 0.0710, label: 0, bag_size: 428
batch 399, loss: 0.2984, instance_loss: 0.3109, weighted_loss: 0.3022, label: 4, bag_size: 744
batch 419, loss: 0.1711, instance_loss: 0.3995, weighted_loss: 0.2396, label: 0, bag_size: 397
batch 439, loss: 1.9147, instance_loss: 0.4592, weighted_loss: 1.4780, label: 4, bag_size: 176
batch 459, loss: 1.2901, instance_loss: 0.5389, weighted_loss: 1.0648, label: 1, bag_size: 607
batch 479, loss: 1.2583, instance_loss: 0.5343, weighted_loss: 1.0411, label: 1, bag_size: 851
batch 499, loss: 0.7308, instance_loss: 0.4341, weighted_loss: 0.6418, label: 4, bag_size: 1077
batch 519, loss: 2.3499, instance_loss: 0.6580, weighted_loss: 1.8423, label: 2, bag_size: 627
batch 539, loss: 1.3608, instance_loss: 0.5545, weighted_loss: 1.1189, label: 3, bag_size: 476
batch 559, loss: 1.0713, instance_loss: 0.4525, weighted_loss: 0.8857, label: 1, bag_size: 829
batch 579, loss: 1.9767, instance_loss: 0.4508, weighted_loss: 1.5189, label: 1, bag_size: 840


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.07512626262626262: correct 357/4752
Epoch: 30, train_loss: 1.1263, train_clustering_loss:  0.4790, train_error: 0.4882
class 0: acc 0.8114754098360656, correct 99/122
class 1: acc 0.4051724137931034, correct 47/116
class 2: acc 0.21052631578947367, correct 20/95
class 3: acc 0.36507936507936506, correct 46/126
class 4: acc 0.6814814814814815, correct 92/135

Val Set, val_loss: 1.6820, val_error: 0.4730, auc: 0.8230
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.10304054054054054: correct 61/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1579, instance_loss: 0.4860, weighted_loss: 0.9564, label: 2, bag_size: 290
batch 39, loss: 0.2850, instance_loss: 0.3631, weighted_loss: 0.3084, label: 4, bag_size: 960
batch 59, loss: 0.0020, instance_loss: 0.3549, weighted_loss: 0.1079, label: 0, bag_size: 428
batch 79, loss: 1.0632, instance_loss: 0.4543, weighted_loss: 0.8805, label: 3, bag_size: 1358
batch 99, loss: 1.0247, instance_loss: 0.5162, weighted_loss: 0.8721, label: 2, bag_size: 754
batch 119, loss: 1.1886, instance_loss: 0.5955, weighted_loss: 1.0107, label: 2, bag_size: 390
batch 139, loss: 1.5564, instance_loss: 0.5398, weighted_loss: 1.2514, label: 4, bag_size: 757
batch 159, loss: 0.4517, instance_loss: 0.3889, weighted_loss: 0.4328, label: 0, bag_size: 231
batch 179, loss: 0.0465, instance_loss: 0.2502, weighted_loss: 0.1076, label: 0, bag_size: 527
batch 199, loss: 0.7350, instance_loss: 0.4496, weighted_loss: 0.6494, label: 0, bag_size: 455
batch 219, loss: 2.8044, instance_loss: 0.5831, weighted_loss: 2.1380, label: 1, bag_size: 361
batch 239, loss: 0.9021, instance_loss: 0.4910, weighted_loss: 0.7788, label: 2, bag_size: 1079
batch 259, loss: 1.4494, instance_loss: 0.5083, weighted_loss: 1.1671, label: 2, bag_size: 337
batch 279, loss: 2.2086, instance_loss: 0.6805, weighted_loss: 1.7501, label: 4, bag_size: 113
batch 299, loss: 0.1578, instance_loss: 0.2998, weighted_loss: 0.2004, label: 0, bag_size: 57
batch 319, loss: 0.9856, instance_loss: 0.4381, weighted_loss: 0.8214, label: 1, bag_size: 208
batch 339, loss: 1.9719, instance_loss: 0.5930, weighted_loss: 1.5583, label: 2, bag_size: 303
batch 359, loss: 1.7321, instance_loss: 0.5238, weighted_loss: 1.3696, label: 1, bag_size: 381
batch 379, loss: 2.0304, instance_loss: 0.5547, weighted_loss: 1.5877, label: 2, bag_size: 852
batch 399, loss: 0.0371, instance_loss: 0.2609, weighted_loss: 0.1042, label: 0, bag_size: 527
batch 419, loss: 1.4593, instance_loss: 0.5959, weighted_loss: 1.2003, label: 2, bag_size: 498
batch 439, loss: 0.7723, instance_loss: 0.4218, weighted_loss: 0.6671, label: 1, bag_size: 593
batch 459, loss: 1.1665, instance_loss: 0.5534, weighted_loss: 0.9826, label: 1, bag_size: 972
batch 479, loss: 1.3004, instance_loss: 0.5712, weighted_loss: 1.0816, label: 4, bag_size: 395
batch 499, loss: 1.1316, instance_loss: 0.3611, weighted_loss: 0.9004, label: 3, bag_size: 344
batch 519, loss: 1.1322, instance_loss: 0.5237, weighted_loss: 0.9497, label: 3, bag_size: 697
batch 539, loss: 2.3656, instance_loss: 0.4851, weighted_loss: 1.8014, label: 2, bag_size: 1092
batch 559, loss: 1.0903, instance_loss: 0.4522, weighted_loss: 0.8989, label: 1, bag_size: 233
batch 579, loss: 2.1857, instance_loss: 0.6562, weighted_loss: 1.7268, label: 2, bag_size: 168


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.04208754208754209: correct 200/4752
Epoch: 31, train_loss: 1.1474, train_clustering_loss:  0.4858, train_error: 0.4832
class 0: acc 0.7739130434782608, correct 89/115
class 1: acc 0.5652173913043478, correct 78/138
class 2: acc 0.3157894736842105, correct 36/114
class 3: acc 0.32075471698113206, correct 34/106
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.5709, val_error: 0.5270, auc: 0.8113
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.060810810810810814: correct 36/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0009, instance_loss: 0.3788, weighted_loss: 0.1143, label: 0, bag_size: 340
batch 39, loss: 1.1067, instance_loss: 0.4464, weighted_loss: 0.9086, label: 3, bag_size: 928
batch 59, loss: 0.6879, instance_loss: 0.6317, weighted_loss: 0.6710, label: 0, bag_size: 732
batch 79, loss: 5.9203, instance_loss: 0.5511, weighted_loss: 4.3095, label: 2, bag_size: 596
batch 99, loss: 1.4677, instance_loss: 0.6572, weighted_loss: 1.2246, label: 2, bag_size: 934
batch 119, loss: 0.8713, instance_loss: 0.4746, weighted_loss: 0.7523, label: 2, bag_size: 290
batch 139, loss: 2.2787, instance_loss: 0.5600, weighted_loss: 1.7631, label: 1, bag_size: 361
batch 159, loss: 1.1934, instance_loss: 0.4701, weighted_loss: 0.9764, label: 4, bag_size: 312
batch 179, loss: 1.8804, instance_loss: 0.5383, weighted_loss: 1.4778, label: 4, bag_size: 333
batch 199, loss: 0.4150, instance_loss: 0.3826, weighted_loss: 0.4053, label: 0, bag_size: 122
batch 219, loss: 1.6614, instance_loss: 0.6211, weighted_loss: 1.3493, label: 3, bag_size: 1186
batch 239, loss: 1.2337, instance_loss: 0.4809, weighted_loss: 1.0079, label: 1, bag_size: 697
batch 259, loss: 0.6113, instance_loss: 0.5130, weighted_loss: 0.5818, label: 2, bag_size: 1066
batch 279, loss: 1.0484, instance_loss: 0.4370, weighted_loss: 0.8649, label: 3, bag_size: 1232
batch 299, loss: 1.2567, instance_loss: 0.5766, weighted_loss: 1.0527, label: 4, bag_size: 1113
batch 319, loss: 2.0149, instance_loss: 0.5827, weighted_loss: 1.5853, label: 0, bag_size: 587
batch 339, loss: 1.4835, instance_loss: 0.5057, weighted_loss: 1.1901, label: 3, bag_size: 492
batch 359, loss: 0.0261, instance_loss: 0.1848, weighted_loss: 0.0737, label: 0, bag_size: 133
batch 379, loss: 1.2700, instance_loss: 0.4866, weighted_loss: 1.0350, label: 1, bag_size: 1009
batch 399, loss: 1.3012, instance_loss: 0.5583, weighted_loss: 1.0783, label: 3, bag_size: 1078
batch 419, loss: 1.0430, instance_loss: 0.4953, weighted_loss: 0.8787, label: 2, bag_size: 385
batch 439, loss: 2.1982, instance_loss: 0.5703, weighted_loss: 1.7099, label: 3, bag_size: 533
batch 459, loss: 2.6536, instance_loss: 0.6561, weighted_loss: 2.0544, label: 2, bag_size: 1060
batch 479, loss: 1.8266, instance_loss: 0.5219, weighted_loss: 1.4352, label: 2, bag_size: 522
batch 499, loss: 0.8058, instance_loss: 0.5207, weighted_loss: 0.7203, label: 0, bag_size: 615
batch 519, loss: 1.2263, instance_loss: 0.5388, weighted_loss: 1.0200, label: 3, bag_size: 309
batch 539, loss: 1.1705, instance_loss: 0.5224, weighted_loss: 0.9761, label: 3, bag_size: 309
batch 559, loss: 0.9815, instance_loss: 0.4689, weighted_loss: 0.8277, label: 4, bag_size: 218
batch 579, loss: 1.1983, instance_loss: 0.4861, weighted_loss: 0.9846, label: 4, bag_size: 854


class 0 clustering acc 0.9959175084175084: correct 23663/23760
class 1 clustering acc 0.046085858585858584: correct 219/4752
Epoch: 32, train_loss: 1.1801, train_clustering_loss:  0.4906, train_error: 0.5168
class 0: acc 0.7521367521367521, correct 88/117
class 1: acc 0.4672131147540984, correct 57/122
class 2: acc 0.2608695652173913, correct 30/115
class 3: acc 0.3949579831932773, correct 47/119
class 4: acc 0.5371900826446281, correct 65/121

Val Set, val_loss: 1.6656, val_error: 0.4730, auc: 0.8145
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.037162162162162164: correct 22/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8968, instance_loss: 0.5344, weighted_loss: 0.7881, label: 2, bag_size: 404
batch 39, loss: 0.8171, instance_loss: 0.4459, weighted_loss: 0.7058, label: 2, bag_size: 385
batch 59, loss: 1.4516, instance_loss: 0.5613, weighted_loss: 1.1845, label: 4, bag_size: 233
batch 79, loss: 1.1885, instance_loss: 0.4294, weighted_loss: 0.9608, label: 4, bag_size: 498
batch 99, loss: 1.5958, instance_loss: 0.5309, weighted_loss: 1.2764, label: 1, bag_size: 1023
batch 119, loss: 0.9904, instance_loss: 0.4379, weighted_loss: 0.8247, label: 4, bag_size: 660
batch 139, loss: 0.0594, instance_loss: 0.2978, weighted_loss: 0.1309, label: 0, bag_size: 164
batch 159, loss: 0.0668, instance_loss: 0.3772, weighted_loss: 0.1599, label: 0, bag_size: 218
batch 179, loss: 0.7660, instance_loss: 0.3883, weighted_loss: 0.6527, label: 1, bag_size: 329
batch 199, loss: 0.0090, instance_loss: 0.3438, weighted_loss: 0.1094, label: 0, bag_size: 280
batch 219, loss: 3.0817, instance_loss: 0.5465, weighted_loss: 2.3212, label: 3, bag_size: 533
batch 239, loss: 0.9194, instance_loss: 0.4786, weighted_loss: 0.7872, label: 3, bag_size: 1147
batch 259, loss: 0.9906, instance_loss: 0.4787, weighted_loss: 0.8370, label: 3, bag_size: 474
batch 279, loss: 1.2023, instance_loss: 0.4801, weighted_loss: 0.9856, label: 1, bag_size: 697
batch 299, loss: 0.7296, instance_loss: 0.5044, weighted_loss: 0.6620, label: 3, bag_size: 1284
batch 319, loss: 0.0870, instance_loss: 0.4719, weighted_loss: 0.2025, label: 0, bag_size: 218
batch 339, loss: 1.2077, instance_loss: 0.6442, weighted_loss: 1.0386, label: 0, bag_size: 400
batch 359, loss: 2.2772, instance_loss: 0.5906, weighted_loss: 1.7713, label: 3, bag_size: 797
batch 379, loss: 0.4772, instance_loss: 0.4413, weighted_loss: 0.4664, label: 0, bag_size: 404
batch 399, loss: 1.2096, instance_loss: 0.4491, weighted_loss: 0.9814, label: 4, bag_size: 476
batch 419, loss: 2.6915, instance_loss: 0.7186, weighted_loss: 2.0996, label: 1, bag_size: 321
batch 439, loss: 1.3833, instance_loss: 0.5460, weighted_loss: 1.1321, label: 3, bag_size: 344
batch 459, loss: 0.6939, instance_loss: 0.4682, weighted_loss: 0.6262, label: 1, bag_size: 1103
batch 479, loss: 1.0915, instance_loss: 0.4996, weighted_loss: 0.9140, label: 3, bag_size: 505
batch 499, loss: 0.4538, instance_loss: 0.4651, weighted_loss: 0.4572, label: 2, bag_size: 690
batch 519, loss: 0.0826, instance_loss: 0.3933, weighted_loss: 0.1758, label: 4, bag_size: 769
batch 539, loss: 1.2300, instance_loss: 0.5424, weighted_loss: 1.0237, label: 3, bag_size: 344
batch 559, loss: 2.6144, instance_loss: 0.7304, weighted_loss: 2.0492, label: 0, bag_size: 710
batch 579, loss: 0.6354, instance_loss: 0.4595, weighted_loss: 0.5826, label: 2, bag_size: 315


class 0 clustering acc 0.9958754208754209: correct 23662/23760
class 1 clustering acc 0.07744107744107744: correct 368/4752
Epoch: 33, train_loss: 1.0578, train_clustering_loss:  0.4745, train_error: 0.4242
class 0: acc 0.8740157480314961, correct 111/127
class 1: acc 0.4918032786885246, correct 60/122
class 2: acc 0.3486238532110092, correct 38/109
class 3: acc 0.5491803278688525, correct 67/122
class 4: acc 0.5789473684210527, correct 66/114

Val Set, val_loss: 1.5562, val_error: 0.5000, auc: 0.8206
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6620, instance_loss: 0.4157, weighted_loss: 0.5881, label: 3, bag_size: 780
batch 39, loss: 1.7014, instance_loss: 0.6387, weighted_loss: 1.3826, label: 2, bag_size: 614
batch 59, loss: 1.0509, instance_loss: 0.4369, weighted_loss: 0.8667, label: 1, bag_size: 660
batch 79, loss: 0.8500, instance_loss: 0.5433, weighted_loss: 0.7580, label: 4, bag_size: 729
batch 99, loss: 0.0124, instance_loss: 0.3141, weighted_loss: 0.1029, label: 0, bag_size: 533
batch 119, loss: 0.5337, instance_loss: 0.5296, weighted_loss: 0.5325, label: 1, bag_size: 1103
batch 139, loss: 1.7035, instance_loss: 0.4588, weighted_loss: 1.3301, label: 0, bag_size: 214
batch 159, loss: 0.8398, instance_loss: 0.4387, weighted_loss: 0.7195, label: 1, bag_size: 605
batch 179, loss: 1.3620, instance_loss: 0.4891, weighted_loss: 1.1001, label: 3, bag_size: 322
batch 199, loss: 0.6011, instance_loss: 0.4343, weighted_loss: 0.5510, label: 4, bag_size: 450
batch 219, loss: 1.1513, instance_loss: 0.4954, weighted_loss: 0.9545, label: 1, bag_size: 419
batch 239, loss: 1.2459, instance_loss: 0.5169, weighted_loss: 1.0272, label: 3, bag_size: 631
batch 259, loss: 0.5191, instance_loss: 0.4332, weighted_loss: 0.4933, label: 4, bag_size: 776
batch 279, loss: 1.5771, instance_loss: 0.6009, weighted_loss: 1.2842, label: 2, bag_size: 315
batch 299, loss: 2.3700, instance_loss: 0.5946, weighted_loss: 1.8374, label: 2, bag_size: 1074
batch 319, loss: 0.5778, instance_loss: 0.4775, weighted_loss: 0.5477, label: 3, bag_size: 894
batch 339, loss: 0.2907, instance_loss: 0.4011, weighted_loss: 0.3238, label: 0, bag_size: 141
batch 359, loss: 0.2685, instance_loss: 0.3817, weighted_loss: 0.3024, label: 0, bag_size: 397
batch 379, loss: 1.5415, instance_loss: 0.5418, weighted_loss: 1.2416, label: 2, bag_size: 348
batch 399, loss: 2.6586, instance_loss: 0.6344, weighted_loss: 2.0513, label: 2, bag_size: 754
batch 419, loss: 1.2474, instance_loss: 0.4762, weighted_loss: 1.0160, label: 0, bag_size: 416
batch 439, loss: 2.1480, instance_loss: 0.4974, weighted_loss: 1.6528, label: 1, bag_size: 397
batch 459, loss: 1.2047, instance_loss: 0.5435, weighted_loss: 1.0063, label: 3, bag_size: 1154
batch 479, loss: 1.3062, instance_loss: 0.5120, weighted_loss: 1.0679, label: 3, bag_size: 510
batch 499, loss: 3.0363, instance_loss: 0.5511, weighted_loss: 2.2907, label: 0, bag_size: 964
batch 519, loss: 0.7337, instance_loss: 0.5139, weighted_loss: 0.6678, label: 4, bag_size: 886
batch 539, loss: 0.6424, instance_loss: 0.4548, weighted_loss: 0.5861, label: 0, bag_size: 416
batch 559, loss: 2.3296, instance_loss: 0.5723, weighted_loss: 1.8024, label: 2, bag_size: 754
batch 579, loss: 1.7748, instance_loss: 0.8725, weighted_loss: 1.5041, label: 4, bag_size: 854


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.039141414141414144: correct 186/4752
Epoch: 34, train_loss: 1.0992, train_clustering_loss:  0.4886, train_error: 0.4747
class 0: acc 0.7477477477477478, correct 83/111
class 1: acc 0.673469387755102, correct 99/147
class 2: acc 0.2523364485981308, correct 27/107
class 3: acc 0.358974358974359, correct 42/117
class 4: acc 0.5446428571428571, correct 61/112

Val Set, val_loss: 1.4296, val_error: 0.5541, auc: 0.8193
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1530, instance_loss: 0.4731, weighted_loss: 0.9491, label: 2, bag_size: 598
batch 39, loss: 1.6339, instance_loss: 0.5866, weighted_loss: 1.3197, label: 0, bag_size: 1414
batch 59, loss: 0.0265, instance_loss: 0.2708, weighted_loss: 0.0998, label: 0, bag_size: 133
batch 79, loss: 2.2233, instance_loss: 0.5932, weighted_loss: 1.7343, label: 1, bag_size: 339
batch 99, loss: 0.9237, instance_loss: 0.4654, weighted_loss: 0.7862, label: 1, bag_size: 444
batch 119, loss: 0.9884, instance_loss: 0.5216, weighted_loss: 0.8484, label: 2, bag_size: 369
batch 139, loss: 1.1692, instance_loss: 0.4655, weighted_loss: 0.9581, label: 2, bag_size: 781
batch 159, loss: 0.0364, instance_loss: 0.2484, weighted_loss: 0.1000, label: 0, bag_size: 524
batch 179, loss: 0.9072, instance_loss: 0.4646, weighted_loss: 0.7744, label: 4, bag_size: 1031
batch 199, loss: 0.4351, instance_loss: 0.3855, weighted_loss: 0.4202, label: 4, bag_size: 895
batch 219, loss: 1.5255, instance_loss: 0.5341, weighted_loss: 1.2281, label: 3, bag_size: 322
batch 239, loss: 1.0220, instance_loss: 0.5618, weighted_loss: 0.8840, label: 4, bag_size: 1297
batch 259, loss: 0.5419, instance_loss: 0.4249, weighted_loss: 0.5068, label: 1, bag_size: 381
batch 279, loss: 1.0689, instance_loss: 0.5417, weighted_loss: 0.9108, label: 1, bag_size: 618
batch 299, loss: 1.0589, instance_loss: 0.6465, weighted_loss: 0.9352, label: 2, bag_size: 135
batch 319, loss: 0.5382, instance_loss: 0.5021, weighted_loss: 0.5274, label: 3, bag_size: 428
batch 339, loss: 1.2835, instance_loss: 0.4956, weighted_loss: 1.0472, label: 4, bag_size: 407
batch 359, loss: 1.4055, instance_loss: 0.5562, weighted_loss: 1.1507, label: 3, bag_size: 317
batch 379, loss: 1.7644, instance_loss: 0.5331, weighted_loss: 1.3950, label: 4, bag_size: 264
batch 399, loss: 1.4074, instance_loss: 0.6066, weighted_loss: 1.1672, label: 2, bag_size: 339
batch 419, loss: 1.3263, instance_loss: 0.4122, weighted_loss: 1.0521, label: 0, bag_size: 478
batch 439, loss: 1.5390, instance_loss: 0.4646, weighted_loss: 1.2167, label: 2, bag_size: 1092
batch 459, loss: 0.4524, instance_loss: 0.6898, weighted_loss: 0.5236, label: 1, bag_size: 106
batch 479, loss: 1.2108, instance_loss: 0.5370, weighted_loss: 1.0087, label: 0, bag_size: 352
batch 499, loss: 0.8449, instance_loss: 0.5386, weighted_loss: 0.7530, label: 4, bag_size: 703
batch 519, loss: 2.1698, instance_loss: 0.6989, weighted_loss: 1.7286, label: 2, bag_size: 244
batch 539, loss: 0.5330, instance_loss: 0.4188, weighted_loss: 0.4987, label: 3, bag_size: 309
batch 559, loss: 3.6854, instance_loss: 0.6922, weighted_loss: 2.7874, label: 0, bag_size: 492
batch 579, loss: 0.6527, instance_loss: 0.4391, weighted_loss: 0.5886, label: 3, bag_size: 871


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.05976430976430976: correct 284/4752
Epoch: 35, train_loss: 1.0477, train_clustering_loss:  0.4818, train_error: 0.4562
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.4666666666666667, correct 56/120
class 2: acc 0.33035714285714285, correct 37/112
class 3: acc 0.5294117647058824, correct 63/119
class 4: acc 0.5726495726495726, correct 67/117

Val Set, val_loss: 1.5150, val_error: 0.4595, auc: 0.8074
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3138, instance_loss: 0.4324, weighted_loss: 1.0494, label: 1, bag_size: 208
batch 39, loss: 0.9691, instance_loss: 0.5239, weighted_loss: 0.8355, label: 1, bag_size: 384
batch 59, loss: 1.6087, instance_loss: 0.5401, weighted_loss: 1.2881, label: 2, bag_size: 339
batch 79, loss: 0.6691, instance_loss: 0.4702, weighted_loss: 0.6094, label: 4, bag_size: 1064
batch 99, loss: 1.0305, instance_loss: 0.5256, weighted_loss: 0.8790, label: 4, bag_size: 944
batch 119, loss: 1.5048, instance_loss: 0.5026, weighted_loss: 1.2042, label: 2, bag_size: 376
batch 139, loss: 0.6936, instance_loss: 0.4396, weighted_loss: 0.6174, label: 1, bag_size: 855
batch 159, loss: 1.1262, instance_loss: 0.5218, weighted_loss: 0.9448, label: 3, bag_size: 1328
batch 179, loss: 0.7969, instance_loss: 0.5752, weighted_loss: 0.7304, label: 2, bag_size: 783
batch 199, loss: 1.1388, instance_loss: 0.5789, weighted_loss: 0.9708, label: 3, bag_size: 230
batch 219, loss: 2.1779, instance_loss: 0.6106, weighted_loss: 1.7077, label: 1, bag_size: 45
batch 239, loss: 1.1090, instance_loss: 0.4610, weighted_loss: 0.9146, label: 3, bag_size: 472
batch 259, loss: 0.1762, instance_loss: 0.5918, weighted_loss: 0.3009, label: 1, bag_size: 44
batch 279, loss: 0.0348, instance_loss: 0.2156, weighted_loss: 0.0890, label: 0, bag_size: 74
batch 299, loss: 0.8692, instance_loss: 0.4523, weighted_loss: 0.7441, label: 3, bag_size: 194
batch 319, loss: 0.0886, instance_loss: 0.3653, weighted_loss: 0.1716, label: 0, bag_size: 73
batch 339, loss: 0.7128, instance_loss: 0.4943, weighted_loss: 0.6473, label: 2, bag_size: 769
batch 359, loss: 0.1395, instance_loss: 0.2905, weighted_loss: 0.1848, label: 0, bag_size: 188
batch 379, loss: 2.4865, instance_loss: 0.5732, weighted_loss: 1.9125, label: 1, bag_size: 1019
batch 399, loss: 0.1457, instance_loss: 0.4298, weighted_loss: 0.2310, label: 1, bag_size: 311
batch 419, loss: 0.7186, instance_loss: 0.4707, weighted_loss: 0.6442, label: 4, bag_size: 110
batch 439, loss: 1.9714, instance_loss: 0.5583, weighted_loss: 1.5475, label: 2, bag_size: 584
batch 459, loss: 0.9768, instance_loss: 0.3956, weighted_loss: 0.8024, label: 4, bag_size: 198
batch 479, loss: 0.8853, instance_loss: 0.4226, weighted_loss: 0.7465, label: 2, bag_size: 697
batch 499, loss: 0.4124, instance_loss: 0.3496, weighted_loss: 0.3936, label: 0, bag_size: 297
batch 519, loss: 0.8748, instance_loss: 0.4223, weighted_loss: 0.7390, label: 2, bag_size: 697
batch 539, loss: 0.6923, instance_loss: 0.6018, weighted_loss: 0.6651, label: 1, bag_size: 522
batch 559, loss: 0.3547, instance_loss: 0.5691, weighted_loss: 0.4190, label: 4, bag_size: 1113
batch 579, loss: 1.3995, instance_loss: 0.4411, weighted_loss: 1.1120, label: 1, bag_size: 823


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.05197811447811448: correct 247/4752
Epoch: 36, train_loss: 1.0925, train_clustering_loss:  0.4817, train_error: 0.4798
class 0: acc 0.8035714285714286, correct 90/112
class 1: acc 0.4296875, correct 55/128
class 2: acc 0.39097744360902253, correct 52/133
class 3: acc 0.4789915966386555, correct 57/119
class 4: acc 0.5392156862745098, correct 55/102

Val Set, val_loss: 1.4938, val_error: 0.4459, auc: 0.8153
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.5552, instance_loss: 0.8195, weighted_loss: 1.3345, label: 1, bag_size: 617
batch 39, loss: 1.5553, instance_loss: 0.5766, weighted_loss: 1.2617, label: 2, bag_size: 321
batch 59, loss: 0.2516, instance_loss: 0.3296, weighted_loss: 0.2750, label: 0, bag_size: 552
batch 79, loss: 2.0697, instance_loss: 0.6006, weighted_loss: 1.6290, label: 1, bag_size: 355
batch 99, loss: 0.9942, instance_loss: 0.4986, weighted_loss: 0.8456, label: 1, bag_size: 390
batch 119, loss: 1.0594, instance_loss: 0.4923, weighted_loss: 0.8893, label: 4, bag_size: 520
batch 139, loss: 3.3366, instance_loss: 0.6184, weighted_loss: 2.5212, label: 2, bag_size: 549
batch 159, loss: 1.2662, instance_loss: 0.6591, weighted_loss: 1.0841, label: 0, bag_size: 615
batch 179, loss: 1.7313, instance_loss: 0.5260, weighted_loss: 1.3697, label: 2, bag_size: 208
batch 199, loss: 0.9808, instance_loss: 0.4235, weighted_loss: 0.8136, label: 4, bag_size: 729
batch 219, loss: 0.0188, instance_loss: 0.2074, weighted_loss: 0.0754, label: 0, bag_size: 255
batch 239, loss: 3.1389, instance_loss: 0.6200, weighted_loss: 2.3832, label: 1, bag_size: 45
batch 259, loss: 1.2282, instance_loss: 0.6177, weighted_loss: 1.0450, label: 0, bag_size: 367
batch 279, loss: 1.2766, instance_loss: 0.5142, weighted_loss: 1.0479, label: 3, bag_size: 492
batch 299, loss: 1.1740, instance_loss: 0.7383, weighted_loss: 1.0433, label: 3, bag_size: 794
batch 319, loss: 0.0676, instance_loss: 0.2918, weighted_loss: 0.1348, label: 0, bag_size: 79
batch 339, loss: 0.9093, instance_loss: 0.4782, weighted_loss: 0.7799, label: 4, bag_size: 113
batch 359, loss: 0.4402, instance_loss: 0.4316, weighted_loss: 0.4376, label: 4, bag_size: 266
batch 379, loss: 2.0355, instance_loss: 0.5971, weighted_loss: 1.6040, label: 0, bag_size: 370
batch 399, loss: 0.6877, instance_loss: 0.4567, weighted_loss: 0.6184, label: 3, bag_size: 780
batch 419, loss: 0.2926, instance_loss: 0.4092, weighted_loss: 0.3276, label: 0, bag_size: 642
batch 439, loss: 0.1551, instance_loss: 0.5207, weighted_loss: 0.2647, label: 1, bag_size: 748
batch 459, loss: 1.0510, instance_loss: 0.5029, weighted_loss: 0.8865, label: 1, bag_size: 328
batch 479, loss: 1.4895, instance_loss: 0.5151, weighted_loss: 1.1971, label: 1, bag_size: 177
batch 499, loss: 0.9781, instance_loss: 0.4633, weighted_loss: 0.8237, label: 1, bag_size: 614
batch 519, loss: 0.3172, instance_loss: 0.4893, weighted_loss: 0.3688, label: 3, bag_size: 794
batch 539, loss: 0.8411, instance_loss: 0.5088, weighted_loss: 0.7414, label: 1, bag_size: 390
batch 559, loss: 2.0187, instance_loss: 0.5594, weighted_loss: 1.5809, label: 0, bag_size: 1073
batch 579, loss: 0.0694, instance_loss: 0.2456, weighted_loss: 0.1223, label: 0, bag_size: 513


class 0 clustering acc 0.9949494949494949: correct 23640/23760
class 1 clustering acc 0.046085858585858584: correct 219/4752
Epoch: 37, train_loss: 1.0952, train_clustering_loss:  0.4923, train_error: 0.4714
class 0: acc 0.7622950819672131, correct 93/122
class 1: acc 0.4017857142857143, correct 45/112
class 2: acc 0.3968253968253968, correct 50/126
class 3: acc 0.5757575757575758, correct 76/132
class 4: acc 0.49019607843137253, correct 50/102

Val Set, val_loss: 1.4964, val_error: 0.5000, auc: 0.8020
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.2148, instance_loss: 0.5606, weighted_loss: 1.0185, label: 4, bag_size: 589
batch 39, loss: 0.7747, instance_loss: 0.4252, weighted_loss: 0.6698, label: 3, bag_size: 344
batch 59, loss: 0.0183, instance_loss: 0.2520, weighted_loss: 0.0884, label: 0, bag_size: 190
batch 79, loss: 1.1198, instance_loss: 0.4518, weighted_loss: 0.9194, label: 3, bag_size: 697
batch 99, loss: 1.9034, instance_loss: 0.5884, weighted_loss: 1.5089, label: 4, bag_size: 476
batch 119, loss: 0.6403, instance_loss: 0.4094, weighted_loss: 0.5710, label: 4, bag_size: 418
batch 139, loss: 1.1293, instance_loss: 0.4631, weighted_loss: 0.9295, label: 4, bag_size: 1031
batch 159, loss: 2.3652, instance_loss: 0.5279, weighted_loss: 1.8140, label: 4, bag_size: 176
batch 179, loss: 0.3514, instance_loss: 0.4655, weighted_loss: 0.3856, label: 0, bag_size: 230
batch 199, loss: 0.0333, instance_loss: 0.1944, weighted_loss: 0.0816, label: 0, bag_size: 255
batch 219, loss: 1.3058, instance_loss: 0.5311, weighted_loss: 1.0734, label: 3, bag_size: 312
batch 239, loss: 0.7802, instance_loss: 0.4791, weighted_loss: 0.6899, label: 4, bag_size: 506
batch 259, loss: 1.0817, instance_loss: 0.4881, weighted_loss: 0.9036, label: 2, bag_size: 697
batch 279, loss: 0.2565, instance_loss: 0.5961, weighted_loss: 0.3583, label: 0, bag_size: 421
batch 299, loss: 0.0000, instance_loss: 0.5924, weighted_loss: 0.1777, label: 1, bag_size: 669
batch 319, loss: 0.0341, instance_loss: 0.1411, weighted_loss: 0.0662, label: 1, bag_size: 1497
batch 339, loss: 0.1658, instance_loss: 0.3760, weighted_loss: 0.2288, label: 0, bag_size: 79
batch 359, loss: 1.6442, instance_loss: 0.5803, weighted_loss: 1.3250, label: 3, bag_size: 897
batch 379, loss: 0.6639, instance_loss: 0.4324, weighted_loss: 0.5945, label: 2, bag_size: 290
batch 399, loss: 0.3793, instance_loss: 0.4398, weighted_loss: 0.3975, label: 4, bag_size: 665
batch 419, loss: 0.9159, instance_loss: 0.5679, weighted_loss: 0.8115, label: 0, bag_size: 62
batch 439, loss: 1.5169, instance_loss: 0.5405, weighted_loss: 1.2240, label: 3, bag_size: 390
batch 459, loss: 0.9025, instance_loss: 0.5603, weighted_loss: 0.7999, label: 3, bag_size: 1057
batch 479, loss: 1.1105, instance_loss: 0.6451, weighted_loss: 0.9709, label: 2, bag_size: 168
batch 499, loss: 0.5281, instance_loss: 0.4394, weighted_loss: 0.5015, label: 4, bag_size: 432
batch 519, loss: 0.4740, instance_loss: 0.4027, weighted_loss: 0.4526, label: 0, bag_size: 760
batch 539, loss: 0.9445, instance_loss: 0.4677, weighted_loss: 0.8015, label: 1, bag_size: 742
batch 559, loss: 0.8851, instance_loss: 0.5649, weighted_loss: 0.7890, label: 2, bag_size: 799
batch 579, loss: 0.7422, instance_loss: 0.5444, weighted_loss: 0.6829, label: 3, bag_size: 192


class 0 clustering acc 0.9968013468013468: correct 23684/23760
class 1 clustering acc 0.05976430976430976: correct 284/4752
Epoch: 38, train_loss: 1.0422, train_clustering_loss:  0.4744, train_error: 0.4209
class 0: acc 0.8429752066115702, correct 102/121
class 1: acc 0.47107438016528924, correct 57/121
class 2: acc 0.38317757009345793, correct 41/107
class 3: acc 0.5169491525423728, correct 61/118
class 4: acc 0.6535433070866141, correct 83/127

Val Set, val_loss: 1.3953, val_error: 0.5000, auc: 0.8324
class 0 clustering acc 0.9942567567567567: correct 2943/2960
class 1 clustering acc 0.06925675675675676: correct 41/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 2.1825, instance_loss: 0.5364, weighted_loss: 1.6887, label: 1, bag_size: 381
batch 39, loss: 1.0324, instance_loss: 0.4753, weighted_loss: 0.8653, label: 4, bag_size: 574
batch 59, loss: 0.8943, instance_loss: 0.4729, weighted_loss: 0.7679, label: 3, bag_size: 944
batch 79, loss: 0.1568, instance_loss: 0.2443, weighted_loss: 0.1830, label: 0, bag_size: 192
batch 99, loss: 3.0650, instance_loss: 0.6385, weighted_loss: 2.3370, label: 3, bag_size: 342
batch 119, loss: 1.8839, instance_loss: 0.5322, weighted_loss: 1.4784, label: 2, bag_size: 998
batch 139, loss: 2.0249, instance_loss: 0.6122, weighted_loss: 1.6011, label: 2, bag_size: 852
batch 159, loss: 0.0000, instance_loss: 0.3357, weighted_loss: 0.1007, label: 4, bag_size: 530
batch 179, loss: 2.2237, instance_loss: 0.5025, weighted_loss: 1.7073, label: 4, bag_size: 1064
batch 199, loss: 0.9965, instance_loss: 0.4502, weighted_loss: 0.8326, label: 3, bag_size: 796
batch 219, loss: 1.4982, instance_loss: 0.5091, weighted_loss: 1.2014, label: 4, bag_size: 476
batch 239, loss: 0.8732, instance_loss: 0.4959, weighted_loss: 0.7600, label: 0, bag_size: 732
batch 259, loss: 0.9646, instance_loss: 0.4670, weighted_loss: 0.8154, label: 3, bag_size: 500
batch 279, loss: 0.9422, instance_loss: 0.5048, weighted_loss: 0.8110, label: 2, bag_size: 240
batch 299, loss: 1.5491, instance_loss: 0.5098, weighted_loss: 1.2373, label: 1, bag_size: 1023
batch 319, loss: 0.0313, instance_loss: 0.3502, weighted_loss: 0.1270, label: 0, bag_size: 366
batch 339, loss: 0.2313, instance_loss: 0.3835, weighted_loss: 0.2769, label: 0, bag_size: 269
batch 359, loss: 1.1832, instance_loss: 0.5833, weighted_loss: 1.0032, label: 4, bag_size: 886
batch 379, loss: 0.2489, instance_loss: 0.4297, weighted_loss: 0.3032, label: 0, bag_size: 520
batch 399, loss: 1.1092, instance_loss: 0.4958, weighted_loss: 0.9252, label: 1, bag_size: 271
batch 419, loss: 1.2141, instance_loss: 0.5132, weighted_loss: 1.0038, label: 3, bag_size: 603
batch 439, loss: 1.3859, instance_loss: 0.5053, weighted_loss: 1.1217, label: 1, bag_size: 177
batch 459, loss: 1.8684, instance_loss: 0.5728, weighted_loss: 1.4797, label: 4, bag_size: 356
batch 479, loss: 1.8160, instance_loss: 0.5568, weighted_loss: 1.4383, label: 1, bag_size: 697
batch 499, loss: 1.8192, instance_loss: 0.5425, weighted_loss: 1.4362, label: 2, bag_size: 361
batch 519, loss: 0.1680, instance_loss: 0.2737, weighted_loss: 0.1997, label: 0, bag_size: 251
batch 539, loss: 1.2416, instance_loss: 0.4633, weighted_loss: 1.0081, label: 2, bag_size: 376
batch 559, loss: 1.0644, instance_loss: 0.5300, weighted_loss: 0.9041, label: 3, bag_size: 1057
batch 579, loss: 0.3980, instance_loss: 0.5307, weighted_loss: 0.4378, label: 1, bag_size: 509


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.07723063973063973: correct 367/4752
Epoch: 39, train_loss: 1.0335, train_clustering_loss:  0.4722, train_error: 0.4579
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.4322033898305085, correct 51/118
class 2: acc 0.3875968992248062, correct 50/129
class 3: acc 0.5691056910569106, correct 70/123
class 4: acc 0.5, correct 49/98

Val Set, val_loss: 1.3538, val_error: 0.5000, auc: 0.8358
class 0 clustering acc 0.9942567567567567: correct 2943/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0540, instance_loss: 0.2769, weighted_loss: 0.1209, label: 0, bag_size: 282
batch 39, loss: 0.8521, instance_loss: 0.4458, weighted_loss: 0.7302, label: 2, bag_size: 119
batch 59, loss: 1.2733, instance_loss: 0.5613, weighted_loss: 1.0597, label: 3, bag_size: 476
batch 79, loss: 1.0317, instance_loss: 0.4342, weighted_loss: 0.8524, label: 2, bag_size: 941
batch 99, loss: 0.8086, instance_loss: 0.4489, weighted_loss: 0.7007, label: 2, bag_size: 883
batch 119, loss: 0.8624, instance_loss: 0.4195, weighted_loss: 0.7295, label: 1, bag_size: 593
batch 139, loss: 1.4713, instance_loss: 0.4838, weighted_loss: 1.1750, label: 2, bag_size: 176
batch 159, loss: 0.7837, instance_loss: 0.4729, weighted_loss: 0.6905, label: 4, bag_size: 520
batch 179, loss: 0.0176, instance_loss: 0.2421, weighted_loss: 0.0849, label: 0, bag_size: 190
batch 199, loss: 1.0755, instance_loss: 0.4644, weighted_loss: 0.8921, label: 2, bag_size: 290
batch 219, loss: 0.2042, instance_loss: 0.5421, weighted_loss: 0.3055, label: 3, bag_size: 674
batch 239, loss: 0.5931, instance_loss: 0.4108, weighted_loss: 0.5384, label: 2, bag_size: 557
batch 259, loss: 0.6914, instance_loss: 0.4139, weighted_loss: 0.6082, label: 3, bag_size: 684
batch 279, loss: 2.4250, instance_loss: 0.6088, weighted_loss: 1.8801, label: 0, bag_size: 642
batch 299, loss: 1.1406, instance_loss: 0.4464, weighted_loss: 0.9323, label: 3, bag_size: 1328
batch 319, loss: 1.3223, instance_loss: 0.6061, weighted_loss: 1.1075, label: 1, bag_size: 461
batch 339, loss: 0.4783, instance_loss: 0.2824, weighted_loss: 0.4196, label: 4, bag_size: 986
batch 359, loss: 0.9255, instance_loss: 0.4723, weighted_loss: 0.7896, label: 3, bag_size: 312
batch 379, loss: 0.9363, instance_loss: 0.4622, weighted_loss: 0.7941, label: 1, bag_size: 398
batch 399, loss: 0.4728, instance_loss: 0.4588, weighted_loss: 0.4686, label: 2, bag_size: 779
batch 419, loss: 0.4205, instance_loss: 0.4168, weighted_loss: 0.4194, label: 2, bag_size: 886
batch 439, loss: 1.6195, instance_loss: 0.5226, weighted_loss: 1.2905, label: 4, bag_size: 690
batch 459, loss: 1.2929, instance_loss: 0.5352, weighted_loss: 1.0656, label: 3, bag_size: 681
batch 479, loss: 1.7597, instance_loss: 0.5064, weighted_loss: 1.3837, label: 2, bag_size: 488
batch 499, loss: 0.0000, instance_loss: 0.4792, weighted_loss: 0.1438, label: 4, bag_size: 769
batch 519, loss: 0.4900, instance_loss: 0.4644, weighted_loss: 0.4823, label: 4, bag_size: 685
batch 539, loss: 1.4205, instance_loss: 0.4650, weighted_loss: 1.1338, label: 0, bag_size: 305
batch 559, loss: 0.1681, instance_loss: 0.4155, weighted_loss: 0.2423, label: 2, bag_size: 702
batch 579, loss: 2.1787, instance_loss: 0.6820, weighted_loss: 1.7297, label: 0, bag_size: 317


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.05281986531986532: correct 251/4752
Epoch: 40, train_loss: 1.0501, train_clustering_loss:  0.4779, train_error: 0.4360
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.4716981132075472, correct 50/106
class 2: acc 0.4112903225806452, correct 51/124
class 3: acc 0.528, correct 66/125
class 4: acc 0.6106194690265486, correct 69/113

Val Set, val_loss: 1.5047, val_error: 0.5811, auc: 0.8027
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.7074, instance_loss: 0.4200, weighted_loss: 0.6212, label: 2, bag_size: 769
batch 39, loss: 0.7178, instance_loss: 0.3806, weighted_loss: 0.6167, label: 0, bag_size: 428
batch 59, loss: 1.7542, instance_loss: 0.5665, weighted_loss: 1.3979, label: 4, bag_size: 726
batch 79, loss: 0.8600, instance_loss: 0.4471, weighted_loss: 0.7361, label: 2, bag_size: 392
batch 99, loss: 2.2228, instance_loss: 0.5400, weighted_loss: 1.7180, label: 4, bag_size: 310
batch 119, loss: 0.1114, instance_loss: 0.2197, weighted_loss: 0.1439, label: 0, bag_size: 188
batch 139, loss: 1.2641, instance_loss: 0.5560, weighted_loss: 1.0516, label: 1, bag_size: 384
batch 159, loss: 0.3701, instance_loss: 0.3709, weighted_loss: 0.3703, label: 0, bag_size: 33
batch 179, loss: 1.3442, instance_loss: 0.6004, weighted_loss: 1.1211, label: 0, bag_size: 710
batch 199, loss: 0.5115, instance_loss: 0.3613, weighted_loss: 0.4664, label: 2, bag_size: 402
batch 219, loss: 3.5438, instance_loss: 0.8484, weighted_loss: 2.7352, label: 1, bag_size: 45
batch 239, loss: 0.6956, instance_loss: 0.4256, weighted_loss: 0.6146, label: 1, bag_size: 593
batch 259, loss: 0.9536, instance_loss: 0.4308, weighted_loss: 0.7968, label: 1, bag_size: 201
batch 279, loss: 1.2831, instance_loss: 0.4778, weighted_loss: 1.0415, label: 1, bag_size: 525
batch 299, loss: 1.2970, instance_loss: 0.4388, weighted_loss: 1.0396, label: 2, bag_size: 697
batch 319, loss: 0.8487, instance_loss: 0.4753, weighted_loss: 0.7367, label: 2, bag_size: 877
batch 339, loss: 0.2648, instance_loss: 0.3498, weighted_loss: 0.2903, label: 0, bag_size: 493
batch 359, loss: 0.2693, instance_loss: 0.5460, weighted_loss: 0.3523, label: 3, bag_size: 794
batch 379, loss: 0.4475, instance_loss: 0.4290, weighted_loss: 0.4420, label: 2, bag_size: 779
batch 399, loss: 1.4200, instance_loss: 0.4820, weighted_loss: 1.1386, label: 2, bag_size: 367
batch 419, loss: 2.1132, instance_loss: 0.6372, weighted_loss: 1.6704, label: 4, bag_size: 312
batch 439, loss: 0.3569, instance_loss: 0.4095, weighted_loss: 0.3727, label: 0, bag_size: 493
batch 459, loss: 2.5958, instance_loss: 0.5978, weighted_loss: 1.9964, label: 0, bag_size: 745
batch 479, loss: 1.0650, instance_loss: 0.5259, weighted_loss: 0.9032, label: 3, bag_size: 697
batch 499, loss: 1.2030, instance_loss: 0.5043, weighted_loss: 0.9933, label: 1, bag_size: 1009
batch 519, loss: 0.5823, instance_loss: 0.4992, weighted_loss: 0.5574, label: 4, bag_size: 652
batch 539, loss: 1.5882, instance_loss: 0.5228, weighted_loss: 1.2686, label: 4, bag_size: 432
batch 559, loss: 0.4887, instance_loss: 0.4601, weighted_loss: 0.4801, label: 4, bag_size: 238
batch 579, loss: 1.2918, instance_loss: 0.5793, weighted_loss: 1.0781, label: 1, bag_size: 972


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.07028619528619529: correct 334/4752
Epoch: 41, train_loss: 1.0930, train_clustering_loss:  0.4773, train_error: 0.4596
class 0: acc 0.7931034482758621, correct 92/116
class 1: acc 0.3389830508474576, correct 40/118
class 2: acc 0.5078125, correct 65/128
class 3: acc 0.43243243243243246, correct 48/111
class 4: acc 0.628099173553719, correct 76/121

Val Set, val_loss: 1.6102, val_error: 0.4595, auc: 0.8356
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5146, instance_loss: 0.4860, weighted_loss: 0.5060, label: 0, bag_size: 404
batch 39, loss: 0.7895, instance_loss: 0.4559, weighted_loss: 0.6894, label: 3, bag_size: 309
batch 59, loss: 4.1778, instance_loss: 0.7406, weighted_loss: 3.1466, label: 3, bag_size: 795
batch 79, loss: 1.6258, instance_loss: 0.6446, weighted_loss: 1.3315, label: 2, bag_size: 315
batch 99, loss: 1.6761, instance_loss: 0.5197, weighted_loss: 1.3292, label: 1, bag_size: 823
batch 119, loss: 0.4055, instance_loss: 0.4616, weighted_loss: 0.4223, label: 4, bag_size: 923
batch 139, loss: 0.1803, instance_loss: 0.2811, weighted_loss: 0.2106, label: 0, bag_size: 552
batch 159, loss: 1.5175, instance_loss: 0.4903, weighted_loss: 1.2093, label: 4, bag_size: 333
batch 179, loss: 0.6909, instance_loss: 0.4453, weighted_loss: 0.6172, label: 2, bag_size: 549
batch 199, loss: 0.3660, instance_loss: 0.3850, weighted_loss: 0.3717, label: 0, bag_size: 77
batch 219, loss: 0.6886, instance_loss: 0.4382, weighted_loss: 0.6135, label: 2, bag_size: 376
batch 239, loss: 1.7313, instance_loss: 0.6588, weighted_loss: 1.4095, label: 0, bag_size: 421
batch 259, loss: 1.9588, instance_loss: 0.6308, weighted_loss: 1.5604, label: 1, bag_size: 361
batch 279, loss: 1.3110, instance_loss: 0.4591, weighted_loss: 1.0554, label: 4, bag_size: 1064
batch 299, loss: 0.6149, instance_loss: 0.4211, weighted_loss: 0.5568, label: 2, bag_size: 470
batch 319, loss: 0.5574, instance_loss: 0.3025, weighted_loss: 0.4810, label: 4, bag_size: 1031
batch 339, loss: 0.4902, instance_loss: 0.3297, weighted_loss: 0.4421, label: 4, bag_size: 775
batch 359, loss: 1.7130, instance_loss: 0.5884, weighted_loss: 1.3757, label: 3, bag_size: 897
batch 379, loss: 2.0311, instance_loss: 0.7196, weighted_loss: 1.6376, label: 3, bag_size: 156
batch 399, loss: 1.6440, instance_loss: 0.6431, weighted_loss: 1.3437, label: 4, bag_size: 267
batch 419, loss: 0.0435, instance_loss: 0.3841, weighted_loss: 0.1457, label: 0, bag_size: 295
batch 439, loss: 1.9555, instance_loss: 0.5905, weighted_loss: 1.5460, label: 4, bag_size: 312
batch 459, loss: 2.5327, instance_loss: 0.5836, weighted_loss: 1.9480, label: 3, bag_size: 899
batch 479, loss: 0.6768, instance_loss: 0.3940, weighted_loss: 0.5919, label: 2, bag_size: 369
batch 499, loss: 0.6194, instance_loss: 0.5156, weighted_loss: 0.5883, label: 1, bag_size: 618
batch 519, loss: 0.0941, instance_loss: 0.2964, weighted_loss: 0.1548, label: 0, bag_size: 188
batch 539, loss: 0.4749, instance_loss: 0.4781, weighted_loss: 0.4758, label: 1, bag_size: 892
batch 559, loss: 1.3471, instance_loss: 0.4711, weighted_loss: 1.0843, label: 1, bag_size: 697
batch 579, loss: 0.9864, instance_loss: 0.4943, weighted_loss: 0.8388, label: 4, bag_size: 703


class 0 clustering acc 0.9968013468013468: correct 23684/23760
class 1 clustering acc 0.05555555555555555: correct 264/4752
Epoch: 42, train_loss: 1.0951, train_clustering_loss:  0.4800, train_error: 0.4882
class 0: acc 0.7017543859649122, correct 80/114
class 1: acc 0.26, correct 26/100
class 2: acc 0.5174825174825175, correct 74/143
class 3: acc 0.41964285714285715, correct 47/112
class 4: acc 0.616, correct 77/125

Val Set, val_loss: 1.5529, val_error: 0.5405, auc: 0.8337
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0465, instance_loss: 0.2271, weighted_loss: 0.1007, label: 0, bag_size: 282
batch 39, loss: 1.0935, instance_loss: 0.4870, weighted_loss: 0.9116, label: 2, bag_size: 445
batch 59, loss: 0.1222, instance_loss: 0.2814, weighted_loss: 0.1700, label: 0, bag_size: 269
batch 79, loss: 0.0086, instance_loss: 0.6743, weighted_loss: 0.2083, label: 4, bag_size: 769
batch 99, loss: 0.9339, instance_loss: 0.4450, weighted_loss: 0.7873, label: 1, bag_size: 372
batch 119, loss: 0.7926, instance_loss: 0.5093, weighted_loss: 0.7076, label: 2, bag_size: 119
batch 139, loss: 0.0112, instance_loss: 0.2176, weighted_loss: 0.0731, label: 0, bag_size: 80
batch 159, loss: 4.7211, instance_loss: 0.8062, weighted_loss: 3.5467, label: 4, bag_size: 310
batch 179, loss: 2.7219, instance_loss: 0.5276, weighted_loss: 2.0636, label: 1, bag_size: 350
batch 199, loss: 1.0674, instance_loss: 0.4744, weighted_loss: 0.8895, label: 0, bag_size: 305
batch 219, loss: 0.4040, instance_loss: 0.3090, weighted_loss: 0.3755, label: 0, bag_size: 351
batch 239, loss: 1.5483, instance_loss: 0.5825, weighted_loss: 1.2586, label: 2, bag_size: 852
batch 259, loss: 0.6871, instance_loss: 0.4359, weighted_loss: 0.6118, label: 3, bag_size: 282
batch 279, loss: 0.2882, instance_loss: 0.4455, weighted_loss: 0.3354, label: 0, bag_size: 73
batch 299, loss: 0.3830, instance_loss: 0.6757, weighted_loss: 0.4708, label: 3, bag_size: 98
batch 319, loss: 0.0061, instance_loss: 0.1835, weighted_loss: 0.0593, label: 0, bag_size: 230
batch 339, loss: 0.3324, instance_loss: 0.3442, weighted_loss: 0.3360, label: 4, bag_size: 895
batch 359, loss: 1.0185, instance_loss: 0.4787, weighted_loss: 0.8565, label: 3, bag_size: 817
batch 379, loss: 0.9856, instance_loss: 0.5091, weighted_loss: 0.8427, label: 2, bag_size: 171
batch 399, loss: 0.1376, instance_loss: 0.3531, weighted_loss: 0.2023, label: 0, bag_size: 57
batch 419, loss: 1.2963, instance_loss: 0.4782, weighted_loss: 1.0509, label: 3, bag_size: 192
batch 439, loss: 1.0291, instance_loss: 0.4039, weighted_loss: 0.8416, label: 1, bag_size: 413
batch 459, loss: 0.0368, instance_loss: 0.2070, weighted_loss: 0.0878, label: 0, bag_size: 513
batch 479, loss: 2.7269, instance_loss: 0.6487, weighted_loss: 2.1034, label: 2, bag_size: 629
batch 499, loss: 0.1538, instance_loss: 0.4081, weighted_loss: 0.2301, label: 0, bag_size: 552
batch 519, loss: 0.5473, instance_loss: 0.4286, weighted_loss: 0.5117, label: 1, bag_size: 605
batch 539, loss: 1.4633, instance_loss: 0.4740, weighted_loss: 1.1665, label: 2, bag_size: 844
batch 559, loss: 2.3127, instance_loss: 0.6087, weighted_loss: 1.8015, label: 2, bag_size: 998
batch 579, loss: 1.0165, instance_loss: 0.5508, weighted_loss: 0.8768, label: 4, bag_size: 395


class 0 clustering acc 0.9967171717171717: correct 23682/23760
class 1 clustering acc 0.06544612794612795: correct 311/4752
Epoch: 43, train_loss: 1.0297, train_clustering_loss:  0.4687, train_error: 0.4512
class 0: acc 0.8245614035087719, correct 94/114
class 1: acc 0.5, correct 70/140
class 2: acc 0.34710743801652894, correct 42/121
class 3: acc 0.5233644859813084, correct 56/107
class 4: acc 0.5714285714285714, correct 64/112

Val Set, val_loss: 1.6272, val_error: 0.4730, auc: 0.8354
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.0777027027027027: correct 46/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0391, instance_loss: 0.2771, weighted_loss: 0.1105, label: 0, bag_size: 15
batch 39, loss: 2.3433, instance_loss: 0.5671, weighted_loss: 1.8104, label: 1, bag_size: 45
batch 59, loss: 2.0806, instance_loss: 0.5323, weighted_loss: 1.6161, label: 2, bag_size: 1092
batch 79, loss: 1.2681, instance_loss: 0.5239, weighted_loss: 1.0448, label: 4, bag_size: 53
batch 99, loss: 0.1104, instance_loss: 0.3404, weighted_loss: 0.1794, label: 0, bag_size: 428
batch 119, loss: 1.2636, instance_loss: 0.4775, weighted_loss: 1.0278, label: 3, bag_size: 1078
batch 139, loss: 0.0666, instance_loss: 0.2951, weighted_loss: 0.1352, label: 0, bag_size: 397
batch 159, loss: 0.9011, instance_loss: 0.4310, weighted_loss: 0.7600, label: 1, bag_size: 886
batch 179, loss: 1.1954, instance_loss: 0.5161, weighted_loss: 0.9916, label: 3, bag_size: 779
batch 199, loss: 1.2081, instance_loss: 0.5710, weighted_loss: 1.0170, label: 1, bag_size: 355
batch 219, loss: 0.5061, instance_loss: 0.4005, weighted_loss: 0.4744, label: 3, bag_size: 272
batch 239, loss: 0.7158, instance_loss: 0.4505, weighted_loss: 0.6362, label: 3, bag_size: 510
batch 259, loss: 0.0005, instance_loss: 0.3563, weighted_loss: 0.1073, label: 4, bag_size: 359
batch 279, loss: 0.7613, instance_loss: 0.4304, weighted_loss: 0.6620, label: 4, bag_size: 944
batch 299, loss: 1.0296, instance_loss: 0.4721, weighted_loss: 0.8623, label: 4, bag_size: 110
batch 319, loss: 0.2152, instance_loss: 0.3690, weighted_loss: 0.2614, label: 0, bag_size: 188
batch 339, loss: 0.1845, instance_loss: 0.3866, weighted_loss: 0.2451, label: 0, bag_size: 141
batch 359, loss: 1.0431, instance_loss: 0.4547, weighted_loss: 0.8666, label: 1, bag_size: 949
batch 379, loss: 1.0881, instance_loss: 0.4603, weighted_loss: 0.8997, label: 4, bag_size: 366
batch 399, loss: 0.7308, instance_loss: 0.5425, weighted_loss: 0.6743, label: 1, bag_size: 389
batch 419, loss: 0.5636, instance_loss: 0.4921, weighted_loss: 0.5422, label: 4, bag_size: 923
batch 439, loss: 1.0828, instance_loss: 0.4587, weighted_loss: 0.8955, label: 3, bag_size: 1078
batch 459, loss: 0.3046, instance_loss: 0.4467, weighted_loss: 0.3472, label: 0, bag_size: 122
batch 479, loss: 0.7274, instance_loss: 0.4379, weighted_loss: 0.6405, label: 2, bag_size: 1230
batch 499, loss: 1.0626, instance_loss: 0.4752, weighted_loss: 0.8864, label: 3, bag_size: 779
batch 519, loss: 0.4284, instance_loss: 0.5607, weighted_loss: 0.4680, label: 1, bag_size: 874
batch 539, loss: 0.9916, instance_loss: 0.6088, weighted_loss: 0.8768, label: 4, bag_size: 267
batch 559, loss: 0.0328, instance_loss: 0.1243, weighted_loss: 0.0603, label: 0, bag_size: 255
batch 579, loss: 2.3027, instance_loss: 0.5863, weighted_loss: 1.7878, label: 2, bag_size: 1122


class 0 clustering acc 0.9957070707070707: correct 23658/23760
class 1 clustering acc 0.06986531986531987: correct 332/4752
Epoch: 44, train_loss: 1.0614, train_clustering_loss:  0.4804, train_error: 0.4276
class 0: acc 0.8260869565217391, correct 114/138
class 1: acc 0.6323529411764706, correct 86/136
class 2: acc 0.24509803921568626, correct 25/102
class 3: acc 0.41904761904761906, correct 44/105
class 4: acc 0.6283185840707964, correct 71/113

Val Set, val_loss: 1.7247, val_error: 0.5946, auc: 0.7962
class 0 clustering acc 0.9902027027027027: correct 2931/2960
class 1 clustering acc 0.13344594594594594: correct 79/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.2107, instance_loss: 0.5124, weighted_loss: 1.0012, label: 1, bag_size: 874
batch 39, loss: 0.8130, instance_loss: 0.4814, weighted_loss: 0.7135, label: 4, bag_size: 450
batch 59, loss: 1.1232, instance_loss: 0.5750, weighted_loss: 0.9587, label: 3, bag_size: 109
batch 79, loss: 3.2975, instance_loss: 0.6794, weighted_loss: 2.5121, label: 0, bag_size: 745
batch 99, loss: 1.2917, instance_loss: 0.5336, weighted_loss: 1.0643, label: 3, bag_size: 369
batch 119, loss: 0.0000, instance_loss: 0.5702, weighted_loss: 0.1711, label: 1, bag_size: 669
batch 139, loss: 0.4593, instance_loss: 0.4160, weighted_loss: 0.4463, label: 4, bag_size: 824
batch 159, loss: 2.0502, instance_loss: 0.5475, weighted_loss: 1.5994, label: 1, bag_size: 413
batch 179, loss: 0.8857, instance_loss: 0.4338, weighted_loss: 0.7501, label: 4, bag_size: 652
batch 199, loss: 0.8958, instance_loss: 0.5294, weighted_loss: 0.7859, label: 2, bag_size: 607
batch 219, loss: 1.3256, instance_loss: 0.4160, weighted_loss: 1.0528, label: 0, bag_size: 642
batch 239, loss: 0.0378, instance_loss: 0.2020, weighted_loss: 0.0871, label: 0, bag_size: 251
batch 259, loss: 1.2217, instance_loss: 0.4646, weighted_loss: 0.9946, label: 1, bag_size: 823
batch 279, loss: 0.7225, instance_loss: 0.3769, weighted_loss: 0.6188, label: 2, bag_size: 522
batch 299, loss: 0.7360, instance_loss: 0.4414, weighted_loss: 0.6476, label: 4, bag_size: 489
batch 319, loss: 0.8768, instance_loss: 0.4471, weighted_loss: 0.7479, label: 2, bag_size: 348
batch 339, loss: 1.1173, instance_loss: 0.5026, weighted_loss: 0.9329, label: 4, bag_size: 356
batch 359, loss: 1.8167, instance_loss: 0.5820, weighted_loss: 1.4463, label: 1, bag_size: 742
batch 379, loss: 1.0071, instance_loss: 0.4957, weighted_loss: 0.8536, label: 4, bag_size: 110
batch 399, loss: 1.4769, instance_loss: 0.5020, weighted_loss: 1.1844, label: 2, bag_size: 376
batch 419, loss: 0.8548, instance_loss: 0.4983, weighted_loss: 0.7479, label: 1, bag_size: 381
batch 439, loss: 1.4043, instance_loss: 0.5643, weighted_loss: 1.1523, label: 4, bag_size: 589
batch 459, loss: 1.0732, instance_loss: 0.5159, weighted_loss: 0.9060, label: 0, bag_size: 62
batch 479, loss: 1.2685, instance_loss: 0.4446, weighted_loss: 1.0214, label: 1, bag_size: 201
batch 499, loss: 0.9644, instance_loss: 0.4578, weighted_loss: 0.8124, label: 0, bag_size: 169
batch 519, loss: 0.5422, instance_loss: 0.3794, weighted_loss: 0.4934, label: 0, bag_size: 428
batch 539, loss: 0.7510, instance_loss: 0.4677, weighted_loss: 0.6660, label: 4, bag_size: 776
batch 559, loss: 0.4168, instance_loss: 0.4917, weighted_loss: 0.4393, label: 2, bag_size: 754
batch 579, loss: 2.4668, instance_loss: 0.5844, weighted_loss: 1.9021, label: 2, bag_size: 720


class 0 clustering acc 0.995496632996633: correct 23653/23760
class 1 clustering acc 0.07596801346801346: correct 361/4752
Epoch: 45, train_loss: 1.0884, train_clustering_loss:  0.4726, train_error: 0.4478
class 0: acc 0.8, correct 104/130
class 1: acc 0.4074074074074074, correct 44/108
class 2: acc 0.4609375, correct 59/128
class 3: acc 0.49122807017543857, correct 56/114
class 4: acc 0.5701754385964912, correct 65/114

Val Set, val_loss: 1.4689, val_error: 0.5946, auc: 0.8324
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.4592, instance_loss: 0.4314, weighted_loss: 0.4509, label: 3, bag_size: 1358
batch 39, loss: 1.2317, instance_loss: 0.5278, weighted_loss: 1.0205, label: 3, bag_size: 317
batch 59, loss: 0.8825, instance_loss: 0.5166, weighted_loss: 0.7727, label: 1, bag_size: 593
batch 79, loss: 0.3442, instance_loss: 0.6355, weighted_loss: 0.4316, label: 0, bag_size: 421
batch 99, loss: 1.7172, instance_loss: 0.4713, weighted_loss: 1.3435, label: 2, bag_size: 549
batch 119, loss: 0.8628, instance_loss: 0.5043, weighted_loss: 0.7553, label: 1, bag_size: 865
batch 139, loss: 0.0003, instance_loss: 0.0653, weighted_loss: 0.0198, label: 0, bag_size: 706
batch 159, loss: 0.0512, instance_loss: 0.2679, weighted_loss: 0.1162, label: 0, bag_size: 370
batch 179, loss: 0.0069, instance_loss: 0.2328, weighted_loss: 0.0747, label: 0, bag_size: 370
batch 199, loss: 0.5173, instance_loss: 0.3979, weighted_loss: 0.4815, label: 4, bag_size: 520
batch 219, loss: 1.0004, instance_loss: 0.4987, weighted_loss: 0.8499, label: 1, bag_size: 328
batch 239, loss: 1.7762, instance_loss: 0.5616, weighted_loss: 1.4118, label: 4, bag_size: 685
batch 259, loss: 1.2176, instance_loss: 0.5419, weighted_loss: 1.0149, label: 4, bag_size: 689
batch 279, loss: 0.6483, instance_loss: 0.5034, weighted_loss: 0.6048, label: 2, bag_size: 135
batch 299, loss: 2.2081, instance_loss: 0.6007, weighted_loss: 1.7259, label: 2, bag_size: 629
batch 319, loss: 2.2706, instance_loss: 0.6151, weighted_loss: 1.7740, label: 2, bag_size: 629
batch 339, loss: 0.1799, instance_loss: 0.5366, weighted_loss: 0.2869, label: 2, bag_size: 779
batch 359, loss: 0.7483, instance_loss: 0.4058, weighted_loss: 0.6455, label: 2, bag_size: 844
batch 379, loss: 2.4400, instance_loss: 0.7765, weighted_loss: 1.9410, label: 3, bag_size: 795
batch 399, loss: 1.5265, instance_loss: 0.5761, weighted_loss: 1.2414, label: 1, bag_size: 981
batch 419, loss: 1.4863, instance_loss: 0.5096, weighted_loss: 1.1933, label: 3, bag_size: 323
batch 439, loss: 1.0746, instance_loss: 0.5283, weighted_loss: 0.9107, label: 1, bag_size: 398
batch 459, loss: 1.9852, instance_loss: 0.5107, weighted_loss: 1.5429, label: 1, bag_size: 350
batch 479, loss: 0.0273, instance_loss: 0.4443, weighted_loss: 0.1524, label: 0, bag_size: 524
batch 499, loss: 0.9531, instance_loss: 0.4457, weighted_loss: 0.8009, label: 2, bag_size: 633
batch 519, loss: 0.8102, instance_loss: 0.4785, weighted_loss: 0.7107, label: 1, bag_size: 329
batch 539, loss: 0.9226, instance_loss: 0.4151, weighted_loss: 0.7703, label: 2, bag_size: 549
batch 559, loss: 0.6299, instance_loss: 0.3748, weighted_loss: 0.5534, label: 3, bag_size: 684
batch 579, loss: 1.1453, instance_loss: 0.5197, weighted_loss: 0.9576, label: 0, bag_size: 455


class 0 clustering acc 0.9953282828282828: correct 23649/23760
class 1 clustering acc 0.07891414141414141: correct 375/4752
Epoch: 46, train_loss: 1.0234, train_clustering_loss:  0.4751, train_error: 0.4377
class 0: acc 0.7586206896551724, correct 88/116
class 1: acc 0.4188034188034188, correct 49/117
class 2: acc 0.5384615384615384, correct 70/130
class 3: acc 0.4727272727272727, correct 52/110
class 4: acc 0.6198347107438017, correct 75/121

Val Set, val_loss: 1.4500, val_error: 0.4595, auc: 0.8320
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.11317567567567567: correct 67/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.8872, instance_loss: 0.4501, weighted_loss: 0.7560, label: 1, bag_size: 381
batch 39, loss: 1.4528, instance_loss: 0.6029, weighted_loss: 1.1978, label: 2, bag_size: 398
batch 59, loss: 1.0298, instance_loss: 0.4579, weighted_loss: 0.8582, label: 3, bag_size: 486
batch 79, loss: 0.5803, instance_loss: 0.4876, weighted_loss: 0.5525, label: 4, bag_size: 854
batch 99, loss: 0.0016, instance_loss: 0.2514, weighted_loss: 0.0765, label: 0, bag_size: 175
batch 119, loss: 2.4809, instance_loss: 0.6319, weighted_loss: 1.9262, label: 2, bag_size: 829
batch 139, loss: 0.8573, instance_loss: 0.4247, weighted_loss: 0.7275, label: 2, bag_size: 616
batch 159, loss: 0.7211, instance_loss: 0.4435, weighted_loss: 0.6378, label: 3, bag_size: 309
batch 179, loss: 2.4405, instance_loss: 0.5781, weighted_loss: 1.8818, label: 2, bag_size: 498
batch 199, loss: 1.3144, instance_loss: 0.5021, weighted_loss: 1.0707, label: 2, bag_size: 363
batch 219, loss: 0.9385, instance_loss: 0.4309, weighted_loss: 0.7862, label: 4, bag_size: 685
batch 239, loss: 3.2451, instance_loss: 0.7515, weighted_loss: 2.4970, label: 3, bag_size: 638
batch 259, loss: 2.6590, instance_loss: 0.6749, weighted_loss: 2.0638, label: 2, bag_size: 717
batch 279, loss: 0.8560, instance_loss: 0.4778, weighted_loss: 0.7425, label: 3, bag_size: 499
batch 299, loss: 0.2546, instance_loss: 0.3178, weighted_loss: 0.2735, label: 4, bag_size: 665
batch 319, loss: 1.9899, instance_loss: 0.6131, weighted_loss: 1.5769, label: 2, bag_size: 321
batch 339, loss: 1.1268, instance_loss: 0.4549, weighted_loss: 0.9252, label: 3, bag_size: 300
batch 359, loss: 1.9721, instance_loss: 0.5697, weighted_loss: 1.5514, label: 3, bag_size: 500
batch 379, loss: 2.7430, instance_loss: 0.6353, weighted_loss: 2.1107, label: 2, bag_size: 519
batch 399, loss: 2.1271, instance_loss: 0.7912, weighted_loss: 1.7263, label: 3, bag_size: 156
batch 419, loss: 0.4899, instance_loss: 0.3897, weighted_loss: 0.4598, label: 0, bag_size: 223
batch 439, loss: 1.1268, instance_loss: 0.5795, weighted_loss: 0.9626, label: 2, bag_size: 303
batch 459, loss: 1.4960, instance_loss: 0.5411, weighted_loss: 1.2096, label: 0, bag_size: 478
batch 479, loss: 2.3354, instance_loss: 0.6960, weighted_loss: 1.8436, label: 0, bag_size: 964
batch 499, loss: 0.0086, instance_loss: 0.1225, weighted_loss: 0.0428, label: 0, bag_size: 164
batch 519, loss: 0.8496, instance_loss: 0.4147, weighted_loss: 0.7191, label: 3, bag_size: 625
batch 539, loss: 0.5366, instance_loss: 0.3925, weighted_loss: 0.4934, label: 3, bag_size: 495
batch 559, loss: 0.0160, instance_loss: 0.4755, weighted_loss: 0.1539, label: 0, bag_size: 732
batch 579, loss: 1.0095, instance_loss: 0.5524, weighted_loss: 0.8724, label: 3, bag_size: 795


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.09111952861952861: correct 433/4752
Epoch: 47, train_loss: 1.0111, train_clustering_loss:  0.4690, train_error: 0.4242
class 0: acc 0.8014184397163121, correct 113/141
class 1: acc 0.4827586206896552, correct 56/116
class 2: acc 0.35135135135135137, correct 39/111
class 3: acc 0.6048387096774194, correct 75/124
class 4: acc 0.5784313725490197, correct 59/102

Val Set, val_loss: 1.5123, val_error: 0.5135, auc: 0.8029
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.8205, instance_loss: 0.4551, weighted_loss: 0.7109, label: 1, bag_size: 851
batch 39, loss: 0.5280, instance_loss: 0.5206, weighted_loss: 0.5258, label: 1, bag_size: 141
batch 59, loss: 1.7289, instance_loss: 0.6941, weighted_loss: 1.4185, label: 0, bag_size: 376
batch 79, loss: 0.8845, instance_loss: 0.4368, weighted_loss: 0.7502, label: 3, bag_size: 337
batch 99, loss: 5.7151, instance_loss: 0.5768, weighted_loss: 4.1736, label: 3, bag_size: 533
batch 119, loss: 1.6247, instance_loss: 0.5730, weighted_loss: 1.3092, label: 2, bag_size: 640
batch 139, loss: 0.9593, instance_loss: 0.4662, weighted_loss: 0.8114, label: 1, bag_size: 328
batch 159, loss: 1.7131, instance_loss: 0.5345, weighted_loss: 1.3595, label: 4, bag_size: 498
batch 179, loss: 0.9086, instance_loss: 0.4893, weighted_loss: 0.7828, label: 2, bag_size: 299
batch 199, loss: 0.0050, instance_loss: 0.2540, weighted_loss: 0.0797, label: 0, bag_size: 340
batch 219, loss: 1.0017, instance_loss: 0.6396, weighted_loss: 0.8930, label: 3, bag_size: 1057
batch 239, loss: 0.7296, instance_loss: 0.4500, weighted_loss: 0.6457, label: 1, bag_size: 509
batch 259, loss: 1.1375, instance_loss: 0.4359, weighted_loss: 0.9270, label: 0, bag_size: 367
batch 279, loss: 1.1226, instance_loss: 0.4639, weighted_loss: 0.9250, label: 1, bag_size: 481
batch 299, loss: 0.8744, instance_loss: 0.5552, weighted_loss: 0.7787, label: 2, bag_size: 315
batch 319, loss: 1.2254, instance_loss: 0.4123, weighted_loss: 0.9815, label: 3, bag_size: 996
batch 339, loss: 0.0897, instance_loss: 0.3015, weighted_loss: 0.1533, label: 0, bag_size: 282
batch 359, loss: 2.4003, instance_loss: 0.6325, weighted_loss: 1.8700, label: 3, bag_size: 899
batch 379, loss: 0.0671, instance_loss: 0.2107, weighted_loss: 0.1102, label: 0, bag_size: 79
batch 399, loss: 0.1482, instance_loss: 0.2988, weighted_loss: 0.1934, label: 0, bag_size: 79
batch 419, loss: 1.1390, instance_loss: 0.4952, weighted_loss: 0.9458, label: 2, bag_size: 781
batch 439, loss: 0.4643, instance_loss: 0.4869, weighted_loss: 0.4711, label: 4, bag_size: 160
batch 459, loss: 0.1119, instance_loss: 0.2962, weighted_loss: 0.1672, label: 0, bag_size: 201
batch 479, loss: 2.1426, instance_loss: 0.5869, weighted_loss: 1.6759, label: 1, bag_size: 361
batch 499, loss: 0.0180, instance_loss: 0.1842, weighted_loss: 0.0678, label: 0, bag_size: 397
batch 519, loss: 1.5267, instance_loss: 0.6670, weighted_loss: 1.2688, label: 0, bag_size: 343
batch 539, loss: 0.9346, instance_loss: 0.4922, weighted_loss: 0.8019, label: 2, bag_size: 799
batch 559, loss: 0.4118, instance_loss: 0.1784, weighted_loss: 0.3418, label: 0, bag_size: 879
batch 579, loss: 0.6755, instance_loss: 0.4744, weighted_loss: 0.6152, label: 2, bag_size: 285


class 0 clustering acc 0.994023569023569: correct 23618/23760
class 1 clustering acc 0.08817340067340067: correct 419/4752
Epoch: 48, train_loss: 0.9742, train_clustering_loss:  0.4694, train_error: 0.4007
class 0: acc 0.8802816901408451, correct 125/142
class 1: acc 0.46551724137931033, correct 54/116
class 2: acc 0.34782608695652173, correct 40/115
class 3: acc 0.6260869565217392, correct 72/115
class 4: acc 0.6132075471698113, correct 65/106

Val Set, val_loss: 1.4533, val_error: 0.4459, auc: 0.8227
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 20 out of 20


batch 19, loss: 2.4000, instance_loss: 0.5705, weighted_loss: 1.8511, label: 1, bag_size: 397
batch 39, loss: 0.7113, instance_loss: 0.4640, weighted_loss: 0.6371, label: 1, bag_size: 1103
batch 59, loss: 1.1467, instance_loss: 0.6057, weighted_loss: 0.9844, label: 2, bag_size: 640
batch 79, loss: 0.3321, instance_loss: 0.3885, weighted_loss: 0.3490, label: 2, bag_size: 1013
batch 99, loss: 1.2054, instance_loss: 0.5825, weighted_loss: 1.0186, label: 4, bag_size: 438
batch 119, loss: 2.3971, instance_loss: 0.5381, weighted_loss: 1.8394, label: 4, bag_size: 407
batch 139, loss: 1.5423, instance_loss: 0.5628, weighted_loss: 1.2484, label: 1, bag_size: 339
batch 159, loss: 0.6523, instance_loss: 0.4247, weighted_loss: 0.5840, label: 1, bag_size: 389
batch 179, loss: 0.0718, instance_loss: 0.6510, weighted_loss: 0.2456, label: 0, bag_size: 732
batch 199, loss: 1.7632, instance_loss: 0.4756, weighted_loss: 1.3769, label: 1, bag_size: 928
batch 219, loss: 0.5452, instance_loss: 0.4101, weighted_loss: 0.5047, label: 2, bag_size: 684
batch 239, loss: 1.1144, instance_loss: 0.4889, weighted_loss: 0.9267, label: 3, bag_size: 474
batch 259, loss: 1.6431, instance_loss: 0.5919, weighted_loss: 1.3277, label: 0, bag_size: 888
batch 279, loss: 0.0141, instance_loss: 0.2064, weighted_loss: 0.0718, label: 0, bag_size: 354
batch 299, loss: 0.0191, instance_loss: 0.1610, weighted_loss: 0.0616, label: 0, bag_size: 192
batch 319, loss: 1.3149, instance_loss: 0.5173, weighted_loss: 1.0756, label: 3, bag_size: 317
batch 339, loss: 0.8557, instance_loss: 0.4514, weighted_loss: 0.7344, label: 1, bag_size: 408
batch 359, loss: 0.1721, instance_loss: 0.5176, weighted_loss: 0.2758, label: 4, bag_size: 627
batch 379, loss: 0.6297, instance_loss: 0.5470, weighted_loss: 0.6049, label: 1, bag_size: 161
batch 399, loss: 1.5768, instance_loss: 0.4595, weighted_loss: 1.2416, label: 4, bag_size: 312
batch 419, loss: 2.8872, instance_loss: 0.8571, weighted_loss: 2.2782, label: 1, bag_size: 617
batch 439, loss: 0.4760, instance_loss: 0.6581, weighted_loss: 0.5306, label: 0, bag_size: 317
batch 459, loss: 0.4838, instance_loss: 0.5018, weighted_loss: 0.4892, label: 0, bag_size: 269
batch 479, loss: 0.5817, instance_loss: 0.4503, weighted_loss: 0.5423, label: 4, bag_size: 731
batch 499, loss: 0.6786, instance_loss: 0.4151, weighted_loss: 0.5995, label: 4, bag_size: 895
batch 519, loss: 0.5667, instance_loss: 0.5479, weighted_loss: 0.5611, label: 4, bag_size: 923
batch 539, loss: 0.6331, instance_loss: 0.4536, weighted_loss: 0.5793, label: 1, bag_size: 1103
batch 559, loss: 0.0937, instance_loss: 0.2537, weighted_loss: 0.1417, label: 0, bag_size: 70
batch 579, loss: 1.2906, instance_loss: 0.4357, weighted_loss: 1.0341, label: 3, bag_size: 1076


class 0 clustering acc 0.9948653198653199: correct 23638/23760
class 1 clustering acc 0.05955387205387205: correct 283/4752
Epoch: 49, train_loss: 1.0235, train_clustering_loss:  0.4835, train_error: 0.4125
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.5968992248062015, correct 77/129
class 2: acc 0.3684210526315789, correct 42/114
class 3: acc 0.4380165289256198, correct 53/121
class 4: acc 0.7064220183486238, correct 77/109

Val Set, val_loss: 1.4104, val_error: 0.5000, auc: 0.8389
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.0472972972972973: correct 28/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.6869, instance_loss: 0.5047, weighted_loss: 1.3322, label: 2, bag_size: 321
batch 39, loss: 1.1572, instance_loss: 0.8854, weighted_loss: 1.0757, label: 3, bag_size: 608
batch 59, loss: 1.3814, instance_loss: 0.6244, weighted_loss: 1.1543, label: 3, bag_size: 681
batch 79, loss: 0.9649, instance_loss: 0.4871, weighted_loss: 0.8216, label: 4, bag_size: 729
batch 99, loss: 2.6422, instance_loss: 0.4409, weighted_loss: 1.9818, label: 0, bag_size: 214
batch 119, loss: 1.1856, instance_loss: 0.4927, weighted_loss: 0.9778, label: 2, bag_size: 549
batch 139, loss: 0.8430, instance_loss: 0.5828, weighted_loss: 0.7649, label: 4, bag_size: 395
batch 159, loss: 0.3980, instance_loss: 0.4190, weighted_loss: 0.4043, label: 4, bag_size: 729
batch 179, loss: 1.3814, instance_loss: 0.4936, weighted_loss: 1.1151, label: 1, bag_size: 840
batch 199, loss: 1.9221, instance_loss: 0.6408, weighted_loss: 1.5377, label: 2, bag_size: 582
batch 219, loss: 1.4685, instance_loss: 0.5418, weighted_loss: 1.1905, label: 1, bag_size: 177
batch 239, loss: 1.0669, instance_loss: 0.5203, weighted_loss: 0.9029, label: 3, bag_size: 1186
batch 259, loss: 0.6954, instance_loss: 0.4582, weighted_loss: 0.6242, label: 2, bag_size: 177
batch 279, loss: 0.8751, instance_loss: 0.4627, weighted_loss: 0.7513, label: 3, bag_size: 476
batch 299, loss: 1.9780, instance_loss: 0.6041, weighted_loss: 1.5658, label: 3, bag_size: 492
batch 319, loss: 1.6052, instance_loss: 0.4875, weighted_loss: 1.2699, label: 2, bag_size: 1071
batch 339, loss: 0.4946, instance_loss: 0.4062, weighted_loss: 0.4681, label: 4, bag_size: 231
batch 359, loss: 0.1609, instance_loss: 0.3890, weighted_loss: 0.2293, label: 0, bag_size: 33
batch 379, loss: 3.6077, instance_loss: 0.6740, weighted_loss: 2.7276, label: 1, bag_size: 45
batch 399, loss: 0.4708, instance_loss: 0.3967, weighted_loss: 0.4486, label: 2, bag_size: 754
batch 419, loss: 1.3333, instance_loss: 0.5446, weighted_loss: 1.0967, label: 3, bag_size: 615
batch 439, loss: 2.2953, instance_loss: 0.5626, weighted_loss: 1.7755, label: 4, bag_size: 476
batch 459, loss: 1.4106, instance_loss: 0.5095, weighted_loss: 1.1403, label: 0, bag_size: 642
batch 479, loss: 0.0000, instance_loss: 0.5440, weighted_loss: 0.1632, label: 2, bag_size: 596
batch 499, loss: 0.8187, instance_loss: 0.4571, weighted_loss: 0.7102, label: 4, bag_size: 970
batch 519, loss: 2.5584, instance_loss: 0.5339, weighted_loss: 1.9510, label: 2, bag_size: 489
batch 539, loss: 0.9503, instance_loss: 0.5013, weighted_loss: 0.8156, label: 3, bag_size: 982
batch 559, loss: 0.9285, instance_loss: 0.5295, weighted_loss: 0.8088, label: 4, bag_size: 589
batch 579, loss: 0.9687, instance_loss: 0.5189, weighted_loss: 0.8337, label: 4, bag_size: 198


class 0 clustering acc 0.9944444444444445: correct 23628/23760
class 1 clustering acc 0.06860269360269361: correct 326/4752
Epoch: 50, train_loss: 1.0119, train_clustering_loss:  0.4800, train_error: 0.4394
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.44642857142857145, correct 50/112
class 2: acc 0.416, correct 52/125
class 3: acc 0.48214285714285715, correct 54/112
class 4: acc 0.6554621848739496, correct 78/119

Val Set, val_loss: 1.3806, val_error: 0.4730, auc: 0.8367
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 22 out of 20


batch 19, loss: 2.6223, instance_loss: 0.6878, weighted_loss: 2.0419, label: 0, bag_size: 376
batch 39, loss: 0.0272, instance_loss: 0.1698, weighted_loss: 0.0700, label: 0, bag_size: 533
batch 59, loss: 0.0060, instance_loss: 0.1551, weighted_loss: 0.0507, label: 0, bag_size: 435
batch 79, loss: 0.0622, instance_loss: 0.4754, weighted_loss: 0.1861, label: 3, bag_size: 98
batch 99, loss: 0.3778, instance_loss: 0.4204, weighted_loss: 0.3906, label: 0, bag_size: 49
batch 119, loss: 1.3135, instance_loss: 0.5052, weighted_loss: 1.0710, label: 3, bag_size: 797
batch 139, loss: 0.1905, instance_loss: 0.5422, weighted_loss: 0.2960, label: 3, bag_size: 98
batch 159, loss: 0.3676, instance_loss: 0.3625, weighted_loss: 0.3661, label: 4, bag_size: 685
batch 179, loss: 0.0247, instance_loss: 0.2743, weighted_loss: 0.0996, label: 0, bag_size: 49
batch 199, loss: 0.8446, instance_loss: 0.4169, weighted_loss: 0.7163, label: 3, bag_size: 194
batch 219, loss: 0.0247, instance_loss: 0.1716, weighted_loss: 0.0688, label: 0, bag_size: 340
batch 239, loss: 1.2386, instance_loss: 0.5678, weighted_loss: 1.0373, label: 4, bag_size: 438
batch 259, loss: 0.5324, instance_loss: 0.3908, weighted_loss: 0.4899, label: 4, bag_size: 547
batch 279, loss: 0.9470, instance_loss: 0.4373, weighted_loss: 0.7941, label: 3, bag_size: 102
batch 299, loss: 0.4547, instance_loss: 0.3263, weighted_loss: 0.4161, label: 4, bag_size: 266
batch 319, loss: 5.3907, instance_loss: 0.5057, weighted_loss: 3.9252, label: 4, bag_size: 1064
batch 339, loss: 1.1345, instance_loss: 0.4840, weighted_loss: 0.9393, label: 3, bag_size: 166
batch 359, loss: 1.5273, instance_loss: 0.4830, weighted_loss: 1.2140, label: 2, bag_size: 498
batch 379, loss: 0.9004, instance_loss: 0.4207, weighted_loss: 0.7565, label: 2, bag_size: 369
batch 399, loss: 1.7156, instance_loss: 0.6200, weighted_loss: 1.3869, label: 1, bag_size: 184
batch 419, loss: 0.1789, instance_loss: 0.4001, weighted_loss: 0.2452, label: 0, bag_size: 69
batch 439, loss: 1.1547, instance_loss: 0.6205, weighted_loss: 0.9944, label: 1, bag_size: 113
batch 459, loss: 0.4113, instance_loss: 0.3995, weighted_loss: 0.4077, label: 2, bag_size: 177
batch 479, loss: 0.6003, instance_loss: 0.4273, weighted_loss: 0.5484, label: 4, bag_size: 886
batch 499, loss: 0.7987, instance_loss: 0.4268, weighted_loss: 0.6872, label: 4, bag_size: 740
batch 519, loss: 0.5863, instance_loss: 0.4206, weighted_loss: 0.5366, label: 4, bag_size: 868
batch 539, loss: 1.8771, instance_loss: 0.5131, weighted_loss: 1.4679, label: 3, bag_size: 533
batch 559, loss: 0.2322, instance_loss: 0.2819, weighted_loss: 0.2471, label: 0, bag_size: 282
batch 579, loss: 1.0527, instance_loss: 0.4418, weighted_loss: 0.8695, label: 0, bag_size: 343


class 0 clustering acc 0.9944023569023569: correct 23627/23760
class 1 clustering acc 0.05765993265993266: correct 274/4752
Epoch: 51, train_loss: 1.0018, train_clustering_loss:  0.4814, train_error: 0.4024
class 0: acc 0.8173076923076923, correct 85/104
class 1: acc 0.45614035087719296, correct 52/114
class 2: acc 0.4473684210526316, correct 51/114
class 3: acc 0.5939849624060151, correct 79/133
class 4: acc 0.6821705426356589, correct 88/129

Val Set, val_loss: 1.4612, val_error: 0.4865, auc: 0.8394
class 0 clustering acc 0.9942567567567567: correct 2943/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 23 out of 20
Early stopping
Val error: 0.4189, ROC AUC: 0.8336
Test error: 0.5270, ROC AUC: 0.7928
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.1045, instance_loss: 0.6335, weighted_loss: 1.6632, label: 1, bag_size: 355
batch 39, loss: 2.4030, instance_loss: 0.5767, weighted_loss: 1.8551, label: 2, bag_size: 219
batch 59, loss: 1.9266, instance_loss: 0.5346, weighted_loss: 1.5090, label: 3, bag_size: 312
batch 79, loss: 1.1257, instance_loss: 0.5315, weighted_loss: 0.9474, label: 1, bag_size: 829
batch 99, loss: 2.4726, instance_loss: 0.5403, weighted_loss: 1.8929, label: 2, bag_size: 631
batch 119, loss: 0.9079, instance_loss: 0.4524, weighted_loss: 0.7713, label: 3, bag_size: 459
batch 139, loss: 1.2469, instance_loss: 0.4988, weighted_loss: 1.0224, label: 2, bag_size: 998
batch 159, loss: 1.9068, instance_loss: 0.5236, weighted_loss: 1.4918, label: 2, bag_size: 331
batch 179, loss: 1.3835, instance_loss: 0.4966, weighted_loss: 1.1175, label: 3, bag_size: 473
batch 199, loss: 2.2617, instance_loss: 0.5803, weighted_loss: 1.7572, label: 2, bag_size: 549
batch 219, loss: 1.2907, instance_loss: 0.5279, weighted_loss: 1.0619, label: 0, bag_size: 277
batch 239, loss: 1.3668, instance_loss: 0.5362, weighted_loss: 1.1176, label: 4, bag_size: 498
batch 259, loss: 1.8771, instance_loss: 0.5963, weighted_loss: 1.4929, label: 0, bag_size: 277
batch 279, loss: 1.6398, instance_loss: 0.4812, weighted_loss: 1.2922, label: 4, bag_size: 853
batch 299, loss: 0.4324, instance_loss: 0.4128, weighted_loss: 0.4265, label: 0, bag_size: 63
batch 319, loss: 1.4222, instance_loss: 0.5051, weighted_loss: 1.1471, label: 3, bag_size: 780
batch 339, loss: 1.6450, instance_loss: 0.4338, weighted_loss: 1.2817, label: 1, bag_size: 328
batch 359, loss: 1.4560, instance_loss: 0.5445, weighted_loss: 1.1825, label: 4, bag_size: 572
batch 379, loss: 1.6389, instance_loss: 0.4951, weighted_loss: 1.2957, label: 2, bag_size: 953
batch 399, loss: 0.2749, instance_loss: 0.3859, weighted_loss: 0.3082, label: 0, bag_size: 236
batch 419, loss: 2.0888, instance_loss: 0.5755, weighted_loss: 1.6348, label: 1, bag_size: 607
batch 439, loss: 1.6754, instance_loss: 0.5642, weighted_loss: 1.3421, label: 0, bag_size: 492
batch 459, loss: 1.1576, instance_loss: 0.4811, weighted_loss: 0.9547, label: 1, bag_size: 960
batch 479, loss: 2.8830, instance_loss: 0.4454, weighted_loss: 2.1517, label: 0, bag_size: 62
batch 499, loss: 1.9195, instance_loss: 0.5970, weighted_loss: 1.5227, label: 3, bag_size: 796
batch 519, loss: 1.0643, instance_loss: 0.4281, weighted_loss: 0.8734, label: 1, bag_size: 605
batch 539, loss: 1.0722, instance_loss: 0.5016, weighted_loss: 0.9010, label: 3, bag_size: 631
batch 559, loss: 1.6166, instance_loss: 0.5730, weighted_loss: 1.3035, label: 4, bag_size: 1031
batch 579, loss: 1.3575, instance_loss: 0.4935, weighted_loss: 1.0983, label: 2, bag_size: 746


class 0 clustering acc 0.9984006734006734: correct 23722/23760
class 1 clustering acc 0.001893939393939394: correct 9/4752
Epoch: 0, train_loss: 1.5490, train_clustering_loss:  0.5210, train_error: 0.6852
class 0: acc 0.6666666666666666, correct 76/114
class 1: acc 0.36153846153846153, correct 47/130
class 2: acc 0.13675213675213677, correct 16/117
class 3: acc 0.24786324786324787, correct 29/117
class 4: acc 0.16379310344827586, correct 19/116

Val Set, val_loss: 1.4434, val_error: 0.5946, auc: 0.6983
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.443432).  Saving model ...


batch 19, loss: 1.9405, instance_loss: 0.5804, weighted_loss: 1.5325, label: 3, bag_size: 97
batch 39, loss: 2.0116, instance_loss: 0.5647, weighted_loss: 1.5775, label: 0, bag_size: 1085
batch 59, loss: 2.4050, instance_loss: 0.5879, weighted_loss: 1.8599, label: 0, bag_size: 435
batch 79, loss: 1.1217, instance_loss: 0.4617, weighted_loss: 0.9237, label: 2, bag_size: 376
batch 99, loss: 1.2700, instance_loss: 0.4709, weighted_loss: 1.0303, label: 2, bag_size: 530
batch 119, loss: 2.1784, instance_loss: 0.5287, weighted_loss: 1.6835, label: 1, bag_size: 272
batch 139, loss: 0.9988, instance_loss: 0.4526, weighted_loss: 0.8349, label: 1, bag_size: 381
batch 159, loss: 1.4711, instance_loss: 0.5450, weighted_loss: 1.1933, label: 4, bag_size: 1041
batch 179, loss: 2.6399, instance_loss: 0.5160, weighted_loss: 2.0028, label: 0, bag_size: 370
batch 199, loss: 0.3500, instance_loss: 0.3926, weighted_loss: 0.3628, label: 0, bag_size: 552
batch 219, loss: 0.7895, instance_loss: 0.4287, weighted_loss: 0.6812, label: 0, bag_size: 324
batch 239, loss: 3.0621, instance_loss: 0.7115, weighted_loss: 2.3569, label: 2, bag_size: 554
batch 259, loss: 1.4349, instance_loss: 0.4899, weighted_loss: 1.1514, label: 1, bag_size: 697
batch 279, loss: 0.9390, instance_loss: 0.4333, weighted_loss: 0.7873, label: 0, bag_size: 122
batch 299, loss: 1.3118, instance_loss: 0.4633, weighted_loss: 1.0572, label: 3, bag_size: 796
batch 319, loss: 0.4122, instance_loss: 0.3939, weighted_loss: 0.4067, label: 0, bag_size: 142
batch 339, loss: 0.6445, instance_loss: 0.4209, weighted_loss: 0.5774, label: 0, bag_size: 297
batch 359, loss: 0.8185, instance_loss: 0.5074, weighted_loss: 0.7252, label: 4, bag_size: 503
batch 379, loss: 1.3889, instance_loss: 0.5162, weighted_loss: 1.1271, label: 3, bag_size: 235
batch 399, loss: 1.5985, instance_loss: 0.5113, weighted_loss: 1.2724, label: 4, bag_size: 342
batch 419, loss: 1.1452, instance_loss: 0.4705, weighted_loss: 0.9428, label: 1, bag_size: 371
batch 439, loss: 1.1166, instance_loss: 0.5903, weighted_loss: 0.9587, label: 4, bag_size: 730
batch 459, loss: 4.0757, instance_loss: 0.5612, weighted_loss: 3.0214, label: 0, bag_size: 62
batch 479, loss: 1.2169, instance_loss: 0.5360, weighted_loss: 1.0126, label: 4, bag_size: 665
batch 499, loss: 0.4517, instance_loss: 0.4263, weighted_loss: 0.4441, label: 0, bag_size: 97
batch 519, loss: 1.1802, instance_loss: 0.5587, weighted_loss: 0.9937, label: 2, bag_size: 1308
batch 539, loss: 0.2571, instance_loss: 0.4250, weighted_loss: 0.3075, label: 0, bag_size: 340
batch 559, loss: 3.0654, instance_loss: 0.6080, weighted_loss: 2.3282, label: 3, bag_size: 638
batch 579, loss: 1.5693, instance_loss: 0.5406, weighted_loss: 1.2607, label: 2, bag_size: 934


class 0 clustering acc 0.9995791245791246: correct 23750/23760
class 1 clustering acc 0.0010521885521885522: correct 5/4752
Epoch: 1, train_loss: 1.4725, train_clustering_loss:  0.5064, train_error: 0.6566
class 0: acc 0.7226890756302521, correct 86/119
class 1: acc 0.17054263565891473, correct 22/129
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.31746031746031744, correct 40/126
class 4: acc 0.23148148148148148, correct 25/108

Val Set, val_loss: 1.3726, val_error: 0.6486, auc: 0.7416
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.07142857142857142, correct 1/14
Validation loss decreased (1.443432 --> 1.372561).  Saving model ...


batch 19, loss: 1.1262, instance_loss: 0.4560, weighted_loss: 0.9252, label: 3, bag_size: 488
batch 39, loss: 0.8659, instance_loss: 0.6198, weighted_loss: 0.7920, label: 1, bag_size: 410
batch 59, loss: 1.8082, instance_loss: 0.6182, weighted_loss: 1.4512, label: 2, bag_size: 290
batch 79, loss: 0.2803, instance_loss: 0.3760, weighted_loss: 0.3090, label: 0, bag_size: 141
batch 99, loss: 0.7963, instance_loss: 0.4871, weighted_loss: 0.7036, label: 4, bag_size: 618
batch 119, loss: 1.6275, instance_loss: 0.5004, weighted_loss: 1.2894, label: 1, bag_size: 607
batch 139, loss: 1.1841, instance_loss: 0.4490, weighted_loss: 0.9636, label: 3, bag_size: 1060
batch 159, loss: 1.9447, instance_loss: 0.5496, weighted_loss: 1.5262, label: 4, bag_size: 438
batch 179, loss: 1.8366, instance_loss: 0.4859, weighted_loss: 1.4314, label: 1, bag_size: 660
batch 199, loss: 2.1575, instance_loss: 0.5808, weighted_loss: 1.6845, label: 1, bag_size: 669
batch 219, loss: 0.1837, instance_loss: 0.3256, weighted_loss: 0.2263, label: 0, bag_size: 221
batch 239, loss: 0.6376, instance_loss: 0.4204, weighted_loss: 0.5724, label: 4, bag_size: 1018
batch 259, loss: 1.5210, instance_loss: 0.4991, weighted_loss: 1.2144, label: 3, bag_size: 780
batch 279, loss: 1.4542, instance_loss: 0.5471, weighted_loss: 1.1821, label: 1, bag_size: 490
batch 299, loss: 0.1486, instance_loss: 0.3356, weighted_loss: 0.2047, label: 0, bag_size: 98
batch 319, loss: 1.2664, instance_loss: 0.5593, weighted_loss: 1.0543, label: 3, bag_size: 961
batch 339, loss: 5.1596, instance_loss: 0.7091, weighted_loss: 3.8245, label: 4, bag_size: 293
batch 359, loss: 1.2446, instance_loss: 0.4921, weighted_loss: 1.0189, label: 1, bag_size: 161
batch 379, loss: 2.3684, instance_loss: 0.5825, weighted_loss: 1.8326, label: 3, bag_size: 156
batch 399, loss: 1.6871, instance_loss: 0.4906, weighted_loss: 1.3282, label: 2, bag_size: 567
batch 419, loss: 2.0835, instance_loss: 0.5730, weighted_loss: 1.6304, label: 4, bag_size: 468
batch 439, loss: 0.1101, instance_loss: 0.3428, weighted_loss: 0.1799, label: 0, bag_size: 74
batch 459, loss: 1.4502, instance_loss: 0.5140, weighted_loss: 1.1693, label: 2, bag_size: 571
batch 479, loss: 1.3710, instance_loss: 0.5609, weighted_loss: 1.1280, label: 4, bag_size: 490
batch 499, loss: 3.0072, instance_loss: 0.6062, weighted_loss: 2.2869, label: 4, bag_size: 270
batch 519, loss: 2.0815, instance_loss: 0.5503, weighted_loss: 1.6222, label: 0, bag_size: 879
batch 539, loss: 1.7053, instance_loss: 0.5407, weighted_loss: 1.3559, label: 3, bag_size: 794
batch 559, loss: 2.0698, instance_loss: 0.5478, weighted_loss: 1.6132, label: 2, bag_size: 953
batch 579, loss: 1.7655, instance_loss: 0.5735, weighted_loss: 1.4079, label: 0, bag_size: 428


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.0006313131313131314: correct 3/4752
Epoch: 2, train_loss: 1.3950, train_clustering_loss:  0.5037, train_error: 0.6212
class 0: acc 0.8099173553719008, correct 98/121
class 1: acc 0.18548387096774194, correct 23/124
class 2: acc 0.17272727272727273, correct 19/110
class 3: acc 0.2892561983471074, correct 35/121
class 4: acc 0.423728813559322, correct 50/118

Val Set, val_loss: 1.4321, val_error: 0.6622, auc: 0.7228
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9530, instance_loss: 0.5688, weighted_loss: 1.5378, label: 2, bag_size: 812
batch 39, loss: 1.3029, instance_loss: 0.5079, weighted_loss: 1.0644, label: 2, bag_size: 119
batch 59, loss: 0.2053, instance_loss: 0.3675, weighted_loss: 0.2539, label: 0, bag_size: 63
batch 79, loss: 1.6191, instance_loss: 0.5730, weighted_loss: 1.3053, label: 3, bag_size: 1154
batch 99, loss: 1.5617, instance_loss: 0.5157, weighted_loss: 1.2479, label: 1, bag_size: 328
batch 119, loss: 1.5173, instance_loss: 0.5013, weighted_loss: 1.2125, label: 3, bag_size: 625
batch 139, loss: 1.2568, instance_loss: 0.4496, weighted_loss: 1.0146, label: 2, bag_size: 240
batch 159, loss: 1.5975, instance_loss: 0.4942, weighted_loss: 1.2665, label: 4, bag_size: 113
batch 179, loss: 1.2661, instance_loss: 0.4825, weighted_loss: 1.0310, label: 3, bag_size: 631
batch 199, loss: 1.1662, instance_loss: 0.5146, weighted_loss: 0.9707, label: 3, bag_size: 796
batch 219, loss: 2.8453, instance_loss: 0.6562, weighted_loss: 2.1886, label: 4, bag_size: 476
batch 239, loss: 1.3592, instance_loss: 0.4843, weighted_loss: 1.0968, label: 1, bag_size: 233
batch 259, loss: 3.0848, instance_loss: 0.5808, weighted_loss: 2.3336, label: 3, bag_size: 638
batch 279, loss: 1.0456, instance_loss: 0.4488, weighted_loss: 0.8666, label: 3, bag_size: 393
batch 299, loss: 1.2513, instance_loss: 0.5087, weighted_loss: 1.0285, label: 3, bag_size: 149
batch 319, loss: 1.4308, instance_loss: 0.4999, weighted_loss: 1.1515, label: 1, bag_size: 616
batch 339, loss: 0.1853, instance_loss: 0.3477, weighted_loss: 0.2340, label: 0, bag_size: 97
batch 359, loss: 1.7193, instance_loss: 0.5252, weighted_loss: 1.3611, label: 4, bag_size: 72
batch 379, loss: 1.3380, instance_loss: 0.4501, weighted_loss: 1.0716, label: 1, bag_size: 892
batch 399, loss: 1.1994, instance_loss: 0.4948, weighted_loss: 0.9880, label: 1, bag_size: 886
batch 419, loss: 1.8881, instance_loss: 0.5464, weighted_loss: 1.4856, label: 3, bag_size: 737
batch 439, loss: 0.0919, instance_loss: 0.3338, weighted_loss: 0.1645, label: 0, bag_size: 98
batch 459, loss: 1.8092, instance_loss: 0.5806, weighted_loss: 1.4406, label: 3, bag_size: 166
batch 479, loss: 0.4284, instance_loss: 0.3778, weighted_loss: 0.4132, label: 0, bag_size: 33
batch 499, loss: 1.2626, instance_loss: 0.5120, weighted_loss: 1.0374, label: 3, bag_size: 473
batch 519, loss: 1.3784, instance_loss: 0.4744, weighted_loss: 1.1072, label: 2, bag_size: 489
batch 539, loss: 1.2200, instance_loss: 0.4642, weighted_loss: 0.9933, label: 1, bag_size: 892
batch 559, loss: 1.9299, instance_loss: 0.5612, weighted_loss: 1.5193, label: 3, bag_size: 857
batch 579, loss: 0.8777, instance_loss: 0.5045, weighted_loss: 0.7657, label: 4, bag_size: 520


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.002735690235690236: correct 13/4752
Epoch: 3, train_loss: 1.3698, train_clustering_loss:  0.4997, train_error: 0.6145
class 0: acc 0.7795275590551181, correct 99/127
class 1: acc 0.19491525423728814, correct 23/118
class 2: acc 0.4015748031496063, correct 51/127
class 3: acc 0.18584070796460178, correct 21/113
class 4: acc 0.3211009174311927, correct 35/109

Val Set, val_loss: 1.3491, val_error: 0.5946, auc: 0.7100
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.372561 --> 1.349090).  Saving model ...


batch 19, loss: 1.9424, instance_loss: 0.5131, weighted_loss: 1.5136, label: 4, bag_size: 590
batch 39, loss: 0.2276, instance_loss: 0.3624, weighted_loss: 0.2681, label: 0, bag_size: 210
batch 59, loss: 1.8038, instance_loss: 0.5282, weighted_loss: 1.4212, label: 1, bag_size: 231
batch 79, loss: 1.7284, instance_loss: 0.5339, weighted_loss: 1.3701, label: 1, bag_size: 271
batch 99, loss: 3.0818, instance_loss: 0.6569, weighted_loss: 2.3544, label: 4, bag_size: 359
batch 119, loss: 0.3094, instance_loss: 0.4025, weighted_loss: 0.3373, label: 0, bag_size: 63
batch 139, loss: 1.3193, instance_loss: 0.4736, weighted_loss: 1.0656, label: 4, bag_size: 547
batch 159, loss: 0.8015, instance_loss: 0.4536, weighted_loss: 0.6971, label: 4, bag_size: 665
batch 179, loss: 1.6582, instance_loss: 0.5446, weighted_loss: 1.3241, label: 0, bag_size: 745
batch 199, loss: 1.7111, instance_loss: 0.5570, weighted_loss: 1.3649, label: 1, bag_size: 949
batch 219, loss: 1.3520, instance_loss: 0.4419, weighted_loss: 1.0790, label: 4, bag_size: 342
batch 239, loss: 1.6804, instance_loss: 0.5525, weighted_loss: 1.3420, label: 2, bag_size: 512
batch 259, loss: 1.4992, instance_loss: 0.4816, weighted_loss: 1.1939, label: 1, bag_size: 1009
batch 279, loss: 0.2975, instance_loss: 0.3890, weighted_loss: 0.3250, label: 0, bag_size: 122
batch 299, loss: 1.3389, instance_loss: 0.5093, weighted_loss: 1.0901, label: 1, bag_size: 391
batch 319, loss: 1.9704, instance_loss: 0.4959, weighted_loss: 1.5281, label: 3, bag_size: 498
batch 339, loss: 1.7973, instance_loss: 0.5490, weighted_loss: 1.4228, label: 4, bag_size: 771
batch 359, loss: 2.0575, instance_loss: 0.4774, weighted_loss: 1.5835, label: 2, bag_size: 563
batch 379, loss: 1.4549, instance_loss: 0.5049, weighted_loss: 1.1699, label: 4, bag_size: 740
batch 399, loss: 4.2904, instance_loss: 0.6719, weighted_loss: 3.2048, label: 4, bag_size: 293
batch 419, loss: 1.5613, instance_loss: 0.5291, weighted_loss: 1.2517, label: 2, bag_size: 105
batch 439, loss: 1.9962, instance_loss: 0.6161, weighted_loss: 1.5822, label: 4, bag_size: 1031
batch 459, loss: 1.5086, instance_loss: 0.5662, weighted_loss: 1.2259, label: 4, bag_size: 377
batch 479, loss: 2.3088, instance_loss: 0.6974, weighted_loss: 1.8254, label: 4, bag_size: 264
batch 499, loss: 1.5054, instance_loss: 0.5486, weighted_loss: 1.2184, label: 3, bag_size: 457
batch 519, loss: 1.9475, instance_loss: 0.5257, weighted_loss: 1.5210, label: 1, bag_size: 159
batch 539, loss: 1.2587, instance_loss: 0.4727, weighted_loss: 1.0229, label: 3, bag_size: 830
batch 559, loss: 1.6968, instance_loss: 0.5335, weighted_loss: 1.3478, label: 3, bag_size: 282
batch 579, loss: 2.2152, instance_loss: 0.6311, weighted_loss: 1.7400, label: 4, bag_size: 1351


class 0 clustering acc 0.9994107744107744: correct 23746/23760
class 1 clustering acc 0.005471380471380472: correct 26/4752
Epoch: 4, train_loss: 1.4031, train_clustering_loss:  0.5033, train_error: 0.6380
class 0: acc 0.75, correct 90/120
class 1: acc 0.12962962962962962, correct 14/108
class 2: acc 0.3235294117647059, correct 44/136
class 3: acc 0.16981132075471697, correct 18/106
class 4: acc 0.3951612903225806, correct 49/124

Val Set, val_loss: 1.3020, val_error: 0.6216, auc: 0.7465
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.349090 --> 1.302021).  Saving model ...


batch 19, loss: 0.1055, instance_loss: 0.4042, weighted_loss: 0.1951, label: 0, bag_size: 76
batch 39, loss: 0.4055, instance_loss: 0.4502, weighted_loss: 0.4189, label: 2, bag_size: 596
batch 59, loss: 1.5074, instance_loss: 0.5876, weighted_loss: 1.2314, label: 0, bag_size: 879
batch 79, loss: 1.2501, instance_loss: 0.5733, weighted_loss: 1.0471, label: 3, bag_size: 192
batch 99, loss: 2.0594, instance_loss: 0.6066, weighted_loss: 1.6236, label: 2, bag_size: 290
batch 119, loss: 0.8835, instance_loss: 0.4856, weighted_loss: 0.7641, label: 3, bag_size: 102
batch 139, loss: 1.3085, instance_loss: 0.5509, weighted_loss: 1.0812, label: 1, bag_size: 1082
batch 159, loss: 1.2832, instance_loss: 0.5384, weighted_loss: 1.0597, label: 3, bag_size: 344
batch 179, loss: 1.3752, instance_loss: 0.5294, weighted_loss: 1.1215, label: 1, bag_size: 460
batch 199, loss: 1.3866, instance_loss: 0.4491, weighted_loss: 1.1054, label: 2, bag_size: 953
batch 219, loss: 2.2388, instance_loss: 0.5675, weighted_loss: 1.7374, label: 2, bag_size: 321
batch 239, loss: 1.4499, instance_loss: 0.4338, weighted_loss: 1.1451, label: 2, bag_size: 361
batch 259, loss: 1.6095, instance_loss: 0.5687, weighted_loss: 1.2973, label: 1, bag_size: 159
batch 279, loss: 1.6913, instance_loss: 0.4936, weighted_loss: 1.3320, label: 1, bag_size: 599
batch 299, loss: 1.4367, instance_loss: 0.5346, weighted_loss: 1.1661, label: 2, bag_size: 860
batch 319, loss: 0.5429, instance_loss: 0.4129, weighted_loss: 0.5039, label: 0, bag_size: 281
batch 339, loss: 1.2947, instance_loss: 0.5250, weighted_loss: 1.0638, label: 2, bag_size: 208
batch 359, loss: 1.4142, instance_loss: 0.4968, weighted_loss: 1.1390, label: 2, bag_size: 799
batch 379, loss: 1.6004, instance_loss: 0.4643, weighted_loss: 1.2595, label: 3, bag_size: 309
batch 399, loss: 1.5427, instance_loss: 0.5566, weighted_loss: 1.2469, label: 4, bag_size: 450
batch 419, loss: 0.2898, instance_loss: 0.5091, weighted_loss: 0.3556, label: 0, bag_size: 269
batch 439, loss: 1.5669, instance_loss: 0.5047, weighted_loss: 1.2482, label: 4, bag_size: 685
batch 459, loss: 1.2240, instance_loss: 0.4222, weighted_loss: 0.9835, label: 4, bag_size: 277
batch 479, loss: 0.5894, instance_loss: 0.4844, weighted_loss: 0.5579, label: 2, bag_size: 936
batch 499, loss: 5.3525, instance_loss: 0.5808, weighted_loss: 3.9210, label: 1, bag_size: 669
batch 519, loss: 0.8204, instance_loss: 0.4276, weighted_loss: 0.7026, label: 1, bag_size: 892
batch 539, loss: 1.7607, instance_loss: 0.4890, weighted_loss: 1.3792, label: 4, bag_size: 419
batch 559, loss: 1.5048, instance_loss: 0.4952, weighted_loss: 1.2019, label: 2, bag_size: 998
batch 579, loss: 2.2724, instance_loss: 0.7732, weighted_loss: 1.8226, label: 0, bag_size: 178


class 0 clustering acc 0.9998737373737374: correct 23757/23760
class 1 clustering acc 0.0021043771043771043: correct 10/4752
Epoch: 5, train_loss: 1.3096, train_clustering_loss:  0.4978, train_error: 0.5909
class 0: acc 0.832, correct 104/125
class 1: acc 0.2916666666666667, correct 35/120
class 2: acc 0.25, correct 31/124
class 3: acc 0.325, correct 39/120
class 4: acc 0.3238095238095238, correct 34/105

Val Set, val_loss: 1.3804, val_error: 0.5811, auc: 0.6861
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2289, instance_loss: 0.6486, weighted_loss: 1.7548, label: 1, bag_size: 398
batch 39, loss: 0.1714, instance_loss: 0.2742, weighted_loss: 0.2022, label: 0, bag_size: 77
batch 59, loss: 1.6958, instance_loss: 0.5554, weighted_loss: 1.3537, label: 2, bag_size: 185
batch 79, loss: 0.9054, instance_loss: 0.4839, weighted_loss: 0.7789, label: 3, bag_size: 684
batch 99, loss: 0.8692, instance_loss: 0.5428, weighted_loss: 0.7713, label: 4, bag_size: 683
batch 119, loss: 0.8241, instance_loss: 0.3821, weighted_loss: 0.6915, label: 1, bag_size: 544
batch 139, loss: 1.0610, instance_loss: 0.6267, weighted_loss: 0.9307, label: 0, bag_size: 578
batch 159, loss: 1.3257, instance_loss: 0.5330, weighted_loss: 1.0879, label: 2, bag_size: 410
batch 179, loss: 2.6902, instance_loss: 0.5800, weighted_loss: 2.0571, label: 3, bag_size: 282
batch 199, loss: 1.1346, instance_loss: 0.5031, weighted_loss: 0.9451, label: 2, bag_size: 607
batch 219, loss: 0.8073, instance_loss: 0.4879, weighted_loss: 0.7115, label: 0, bag_size: 642
batch 239, loss: 1.1369, instance_loss: 0.4875, weighted_loss: 0.9421, label: 1, bag_size: 886
batch 259, loss: 0.2955, instance_loss: 0.3555, weighted_loss: 0.3135, label: 0, bag_size: 192
batch 279, loss: 1.1687, instance_loss: 0.4936, weighted_loss: 0.9662, label: 4, bag_size: 875
batch 299, loss: 1.2138, instance_loss: 0.4501, weighted_loss: 0.9847, label: 4, bag_size: 695
batch 319, loss: 1.6424, instance_loss: 0.5024, weighted_loss: 1.3004, label: 1, bag_size: 865
batch 339, loss: 0.1750, instance_loss: 0.3609, weighted_loss: 0.2307, label: 0, bag_size: 188
batch 359, loss: 1.0566, instance_loss: 0.5787, weighted_loss: 0.9132, label: 0, bag_size: 552
batch 379, loss: 1.0747, instance_loss: 0.4481, weighted_loss: 0.8867, label: 1, bag_size: 371
batch 399, loss: 2.6375, instance_loss: 0.5833, weighted_loss: 2.0212, label: 3, bag_size: 533
batch 419, loss: 1.6122, instance_loss: 0.5622, weighted_loss: 1.2972, label: 3, bag_size: 500
batch 439, loss: 2.2084, instance_loss: 0.6304, weighted_loss: 1.7350, label: 4, bag_size: 937
batch 459, loss: 1.3046, instance_loss: 0.4657, weighted_loss: 1.0529, label: 2, bag_size: 105
batch 479, loss: 1.5491, instance_loss: 0.4593, weighted_loss: 1.2222, label: 2, bag_size: 861
batch 499, loss: 2.0427, instance_loss: 0.6228, weighted_loss: 1.6167, label: 1, bag_size: 823
batch 519, loss: 2.5402, instance_loss: 0.5308, weighted_loss: 1.9374, label: 2, bag_size: 380
batch 539, loss: 1.1532, instance_loss: 0.4957, weighted_loss: 0.9560, label: 4, bag_size: 729
batch 559, loss: 0.9746, instance_loss: 0.4965, weighted_loss: 0.8312, label: 3, bag_size: 625
batch 579, loss: 1.2392, instance_loss: 0.5368, weighted_loss: 1.0285, label: 3, bag_size: 149


class 0 clustering acc 0.9994949494949495: correct 23748/23760
class 1 clustering acc 0.007575757575757576: correct 36/4752
Epoch: 6, train_loss: 1.3620, train_clustering_loss:  0.5067, train_error: 0.5791
class 0: acc 0.7380952380952381, correct 93/126
class 1: acc 0.3275862068965517, correct 38/116
class 2: acc 0.16964285714285715, correct 19/112
class 3: acc 0.35294117647058826, correct 42/119
class 4: acc 0.4793388429752066, correct 58/121

Val Set, val_loss: 1.2535, val_error: 0.5811, auc: 0.7662
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.302021 --> 1.253540).  Saving model ...


batch 19, loss: 0.1047, instance_loss: 0.3433, weighted_loss: 0.1763, label: 0, bag_size: 74
batch 39, loss: 0.8760, instance_loss: 0.4393, weighted_loss: 0.7450, label: 3, bag_size: 631
batch 59, loss: 1.7333, instance_loss: 0.5502, weighted_loss: 1.3783, label: 3, bag_size: 1057
batch 79, loss: 2.1827, instance_loss: 0.7187, weighted_loss: 1.7435, label: 0, bag_size: 367
batch 99, loss: 1.6408, instance_loss: 0.5092, weighted_loss: 1.3013, label: 4, bag_size: 228
batch 119, loss: 0.8940, instance_loss: 0.4104, weighted_loss: 0.7490, label: 1, bag_size: 1103
batch 139, loss: 2.5641, instance_loss: 0.5919, weighted_loss: 1.9724, label: 0, bag_size: 492
batch 159, loss: 1.6618, instance_loss: 0.5476, weighted_loss: 1.3275, label: 1, bag_size: 525
batch 179, loss: 1.0812, instance_loss: 0.4761, weighted_loss: 0.8997, label: 2, bag_size: 596
batch 199, loss: 1.0526, instance_loss: 0.4372, weighted_loss: 0.8680, label: 2, bag_size: 1608
batch 219, loss: 1.4569, instance_loss: 0.5405, weighted_loss: 1.1819, label: 3, bag_size: 272
batch 239, loss: 0.1046, instance_loss: 0.2982, weighted_loss: 0.1627, label: 0, bag_size: 51
batch 259, loss: 1.3741, instance_loss: 0.4973, weighted_loss: 1.1111, label: 3, bag_size: 457
batch 279, loss: 1.6501, instance_loss: 0.5098, weighted_loss: 1.3080, label: 4, bag_size: 482
batch 299, loss: 0.0080, instance_loss: 0.3493, weighted_loss: 0.1104, label: 2, bag_size: 1608
batch 319, loss: 1.2788, instance_loss: 0.4559, weighted_loss: 1.0319, label: 1, bag_size: 1009
batch 339, loss: 2.1203, instance_loss: 0.6515, weighted_loss: 1.6797, label: 0, bag_size: 273
batch 359, loss: 1.4844, instance_loss: 0.4455, weighted_loss: 1.1728, label: 2, bag_size: 720
batch 379, loss: 0.7961, instance_loss: 0.4541, weighted_loss: 0.6935, label: 4, bag_size: 204
batch 399, loss: 1.0007, instance_loss: 0.4924, weighted_loss: 0.8482, label: 4, bag_size: 530
batch 419, loss: 1.3194, instance_loss: 0.4703, weighted_loss: 1.0647, label: 2, bag_size: 851
batch 439, loss: 1.3616, instance_loss: 0.4983, weighted_loss: 1.1026, label: 2, bag_size: 367
batch 459, loss: 1.3117, instance_loss: 0.4983, weighted_loss: 1.0677, label: 3, bag_size: 1365
batch 479, loss: 2.0543, instance_loss: 0.5830, weighted_loss: 1.6129, label: 1, bag_size: 525
batch 499, loss: 0.1200, instance_loss: 0.3861, weighted_loss: 0.1999, label: 0, bag_size: 37
batch 519, loss: 1.6329, instance_loss: 0.5216, weighted_loss: 1.2995, label: 1, bag_size: 1104
batch 539, loss: 2.5866, instance_loss: 0.6493, weighted_loss: 2.0054, label: 2, bag_size: 488
batch 559, loss: 2.3804, instance_loss: 0.6287, weighted_loss: 1.8549, label: 4, bag_size: 310
batch 579, loss: 1.4036, instance_loss: 0.4766, weighted_loss: 1.1255, label: 2, bag_size: 783


class 0 clustering acc 0.9996632996632997: correct 23752/23760
class 1 clustering acc 0.007365319865319866: correct 35/4752
Epoch: 7, train_loss: 1.3837, train_clustering_loss:  0.5069, train_error: 0.6246
class 0: acc 0.7128712871287128, correct 72/101
class 1: acc 0.09009009009009009, correct 10/111
class 2: acc 0.3233082706766917, correct 43/133
class 3: acc 0.29457364341085274, correct 38/129
class 4: acc 0.5, correct 60/120

Val Set, val_loss: 1.2395, val_error: 0.5676, auc: 0.7639
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.253540 --> 1.239529).  Saving model ...


batch 19, loss: 2.3094, instance_loss: 0.6498, weighted_loss: 1.8115, label: 4, bag_size: 937
batch 39, loss: 0.6406, instance_loss: 0.4648, weighted_loss: 0.5879, label: 0, bag_size: 399
batch 59, loss: 1.1860, instance_loss: 0.4968, weighted_loss: 0.9792, label: 4, bag_size: 712
batch 79, loss: 0.3011, instance_loss: 0.3732, weighted_loss: 0.3228, label: 0, bag_size: 223
batch 99, loss: 1.9566, instance_loss: 0.5628, weighted_loss: 1.5385, label: 1, bag_size: 413
batch 119, loss: 3.0910, instance_loss: 0.6800, weighted_loss: 2.3677, label: 3, bag_size: 638
batch 139, loss: 0.7526, instance_loss: 0.4537, weighted_loss: 0.6630, label: 4, bag_size: 875
batch 159, loss: 1.8242, instance_loss: 0.5247, weighted_loss: 1.4344, label: 2, bag_size: 769
batch 179, loss: 2.8242, instance_loss: 0.6368, weighted_loss: 2.1680, label: 2, bag_size: 176
batch 199, loss: 1.3722, instance_loss: 0.4834, weighted_loss: 1.1056, label: 1, bag_size: 460
batch 219, loss: 1.3710, instance_loss: 0.5001, weighted_loss: 1.1097, label: 1, bag_size: 398
batch 239, loss: 1.3056, instance_loss: 0.4788, weighted_loss: 1.0575, label: 4, bag_size: 72
batch 259, loss: 0.1017, instance_loss: 0.2672, weighted_loss: 0.1513, label: 0, bag_size: 397
batch 279, loss: 1.1632, instance_loss: 0.4264, weighted_loss: 0.9422, label: 3, bag_size: 781
batch 299, loss: 0.7414, instance_loss: 0.4860, weighted_loss: 0.6648, label: 3, bag_size: 344
batch 319, loss: 1.1461, instance_loss: 0.4620, weighted_loss: 0.9409, label: 4, bag_size: 468
batch 339, loss: 2.0877, instance_loss: 0.6195, weighted_loss: 1.6472, label: 1, bag_size: 522
batch 359, loss: 0.4626, instance_loss: 0.4287, weighted_loss: 0.4525, label: 0, bag_size: 258
batch 379, loss: 1.7348, instance_loss: 0.5762, weighted_loss: 1.3872, label: 4, bag_size: 238
batch 399, loss: 0.7862, instance_loss: 0.4587, weighted_loss: 0.6879, label: 3, bag_size: 871
batch 419, loss: 0.1493, instance_loss: 0.2878, weighted_loss: 0.1909, label: 0, bag_size: 706
batch 439, loss: 1.5778, instance_loss: 0.5927, weighted_loss: 1.2823, label: 4, bag_size: 729
batch 459, loss: 1.5243, instance_loss: 0.5518, weighted_loss: 1.2325, label: 2, bag_size: 367
batch 479, loss: 1.4530, instance_loss: 0.5569, weighted_loss: 1.1842, label: 2, bag_size: 185
batch 499, loss: 0.0665, instance_loss: 0.3197, weighted_loss: 0.1425, label: 0, bag_size: 37
batch 519, loss: 1.1331, instance_loss: 0.4921, weighted_loss: 0.9408, label: 3, bag_size: 817
batch 539, loss: 0.4938, instance_loss: 0.5287, weighted_loss: 0.5043, label: 0, bag_size: 351
batch 559, loss: 1.6926, instance_loss: 0.5459, weighted_loss: 1.3486, label: 4, bag_size: 250
batch 579, loss: 1.1748, instance_loss: 0.4922, weighted_loss: 0.9700, label: 2, bag_size: 571


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.023989898989898988: correct 114/4752
Epoch: 8, train_loss: 1.2693, train_clustering_loss:  0.4980, train_error: 0.5556
class 0: acc 0.8466257668711656, correct 138/163
class 1: acc 0.2916666666666667, correct 35/120
class 2: acc 0.10752688172043011, correct 10/93
class 3: acc 0.3508771929824561, correct 40/114
class 4: acc 0.3942307692307692, correct 41/104

Val Set, val_loss: 1.2511, val_error: 0.6081, auc: 0.7452
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3211, instance_loss: 0.5007, weighted_loss: 1.0749, label: 2, bag_size: 713
batch 39, loss: 1.4222, instance_loss: 0.4714, weighted_loss: 1.1369, label: 1, bag_size: 960
batch 59, loss: 0.7063, instance_loss: 0.5448, weighted_loss: 0.6579, label: 0, bag_size: 416
batch 79, loss: 1.3885, instance_loss: 0.4774, weighted_loss: 1.1151, label: 2, bag_size: 744
batch 99, loss: 0.0284, instance_loss: 0.2976, weighted_loss: 0.1091, label: 0, bag_size: 142
batch 119, loss: 0.7463, instance_loss: 0.4272, weighted_loss: 0.6506, label: 1, bag_size: 544
batch 139, loss: 0.6074, instance_loss: 0.4944, weighted_loss: 0.5735, label: 4, bag_size: 773
batch 159, loss: 0.0325, instance_loss: 0.3017, weighted_loss: 0.1133, label: 0, bag_size: 340
batch 179, loss: 0.9712, instance_loss: 0.4846, weighted_loss: 0.8252, label: 4, bag_size: 1041
batch 199, loss: 0.0775, instance_loss: 0.3405, weighted_loss: 0.1564, label: 0, bag_size: 37
batch 219, loss: 1.3446, instance_loss: 0.4725, weighted_loss: 1.0830, label: 4, bag_size: 176
batch 239, loss: 2.0686, instance_loss: 0.6282, weighted_loss: 1.6365, label: 2, bag_size: 411
batch 259, loss: 0.2390, instance_loss: 0.3247, weighted_loss: 0.2647, label: 0, bag_size: 613
batch 279, loss: 1.1273, instance_loss: 0.5508, weighted_loss: 0.9543, label: 4, bag_size: 1041
batch 299, loss: 1.3418, instance_loss: 0.4759, weighted_loss: 1.0821, label: 2, bag_size: 285
batch 319, loss: 1.1678, instance_loss: 0.5140, weighted_loss: 0.9716, label: 4, bag_size: 1077
batch 339, loss: 0.7784, instance_loss: 0.4673, weighted_loss: 0.6851, label: 4, bag_size: 639
batch 359, loss: 1.2573, instance_loss: 0.5078, weighted_loss: 1.0325, label: 2, bag_size: 554
batch 379, loss: 4.8648, instance_loss: 0.9072, weighted_loss: 3.6775, label: 0, bag_size: 169
batch 399, loss: 0.8261, instance_loss: 0.4574, weighted_loss: 0.7155, label: 3, bag_size: 102
batch 419, loss: 2.1702, instance_loss: 0.5188, weighted_loss: 1.6748, label: 4, bag_size: 113
batch 439, loss: 0.0436, instance_loss: 0.5422, weighted_loss: 0.1932, label: 0, bag_size: 138
batch 459, loss: 1.7503, instance_loss: 0.5319, weighted_loss: 1.3848, label: 2, bag_size: 906
batch 479, loss: 1.0631, instance_loss: 0.5569, weighted_loss: 0.9113, label: 4, bag_size: 1064
batch 499, loss: 1.0486, instance_loss: 0.4247, weighted_loss: 0.8614, label: 1, bag_size: 981
batch 519, loss: 1.5139, instance_loss: 0.5296, weighted_loss: 1.2186, label: 4, bag_size: 244
batch 539, loss: 1.0118, instance_loss: 0.4328, weighted_loss: 0.8381, label: 0, bag_size: 383
batch 559, loss: 1.5811, instance_loss: 0.5831, weighted_loss: 1.2817, label: 3, bag_size: 1365
batch 579, loss: 1.6103, instance_loss: 0.5059, weighted_loss: 1.2790, label: 4, bag_size: 1104


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.061658249158249155: correct 293/4752
Epoch: 9, train_loss: 1.2462, train_clustering_loss:  0.4866, train_error: 0.5354
class 0: acc 0.8217054263565892, correct 106/129
class 1: acc 0.33636363636363636, correct 37/110
class 2: acc 0.4032258064516129, correct 50/124
class 3: acc 0.21568627450980393, correct 22/102
class 4: acc 0.4728682170542636, correct 61/129

Val Set, val_loss: 1.2725, val_error: 0.6216, auc: 0.7423
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7735, instance_loss: 0.5850, weighted_loss: 1.4170, label: 1, bag_size: 339
batch 39, loss: 3.2176, instance_loss: 0.5838, weighted_loss: 2.4275, label: 3, bag_size: 796
batch 59, loss: 1.2042, instance_loss: 0.4825, weighted_loss: 0.9877, label: 3, bag_size: 982
batch 79, loss: 2.0361, instance_loss: 0.5640, weighted_loss: 1.5944, label: 3, bag_size: 337
batch 99, loss: 0.1611, instance_loss: 0.2902, weighted_loss: 0.1998, label: 0, bag_size: 393
batch 119, loss: 1.2374, instance_loss: 0.5144, weighted_loss: 1.0205, label: 2, bag_size: 886
batch 139, loss: 0.6160, instance_loss: 0.4892, weighted_loss: 0.5780, label: 3, bag_size: 473
batch 159, loss: 1.2409, instance_loss: 0.5161, weighted_loss: 1.0234, label: 2, bag_size: 812
batch 179, loss: 0.9450, instance_loss: 0.5537, weighted_loss: 0.8276, label: 4, bag_size: 418
batch 199, loss: 1.0133, instance_loss: 0.5739, weighted_loss: 0.8815, label: 2, bag_size: 543
batch 219, loss: 0.2462, instance_loss: 0.6676, weighted_loss: 0.3726, label: 4, bag_size: 773
batch 239, loss: 1.5417, instance_loss: 0.5627, weighted_loss: 1.2480, label: 4, bag_size: 293
batch 259, loss: 1.3062, instance_loss: 0.4649, weighted_loss: 1.0538, label: 1, bag_size: 764
batch 279, loss: 0.0568, instance_loss: 0.3605, weighted_loss: 0.1479, label: 0, bag_size: 706
batch 299, loss: 1.6320, instance_loss: 0.5145, weighted_loss: 1.2968, label: 2, bag_size: 339
batch 319, loss: 1.0897, instance_loss: 0.4263, weighted_loss: 0.8907, label: 1, bag_size: 410
batch 339, loss: 0.6007, instance_loss: 0.5570, weighted_loss: 0.5876, label: 4, bag_size: 730
batch 359, loss: 1.2602, instance_loss: 0.5029, weighted_loss: 1.0330, label: 1, bag_size: 355
batch 379, loss: 0.5094, instance_loss: 0.4720, weighted_loss: 0.4982, label: 4, bag_size: 923
batch 399, loss: 1.5822, instance_loss: 0.5535, weighted_loss: 1.2736, label: 4, bag_size: 490
batch 419, loss: 1.5974, instance_loss: 0.5603, weighted_loss: 1.2863, label: 0, bag_size: 370
batch 439, loss: 0.9925, instance_loss: 0.4820, weighted_loss: 0.8394, label: 4, bag_size: 712
batch 459, loss: 1.6247, instance_loss: 0.4815, weighted_loss: 1.2817, label: 4, bag_size: 176
batch 479, loss: 1.9811, instance_loss: 0.5568, weighted_loss: 1.5538, label: 4, bag_size: 377
batch 499, loss: 1.2907, instance_loss: 0.4578, weighted_loss: 1.0408, label: 2, bag_size: 592
batch 519, loss: 1.4182, instance_loss: 0.4605, weighted_loss: 1.1309, label: 1, bag_size: 925
batch 539, loss: 0.1853, instance_loss: 0.4582, weighted_loss: 0.2672, label: 0, bag_size: 397
batch 559, loss: 1.5637, instance_loss: 0.4880, weighted_loss: 1.2410, label: 2, bag_size: 860
batch 579, loss: 1.4274, instance_loss: 0.5282, weighted_loss: 1.1576, label: 4, bag_size: 652


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.03787878787878788: correct 180/4752
Epoch: 10, train_loss: 1.3040, train_clustering_loss:  0.4991, train_error: 0.5606
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.3968253968253968, correct 50/126
class 2: acc 0.2727272727272727, correct 33/121
class 3: acc 0.3, correct 33/110
class 4: acc 0.43103448275862066, correct 50/116

Val Set, val_loss: 1.2375, val_error: 0.5946, auc: 0.7563
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.04054054054054054: correct 24/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.239529 --> 1.237480).  Saving model ...


batch 19, loss: 0.9666, instance_loss: 0.4287, weighted_loss: 0.8052, label: 2, bag_size: 350
batch 39, loss: 0.3959, instance_loss: 0.3127, weighted_loss: 0.3709, label: 0, bag_size: 428
batch 59, loss: 0.9226, instance_loss: 0.4985, weighted_loss: 0.7954, label: 4, bag_size: 520
batch 79, loss: 1.6694, instance_loss: 0.4188, weighted_loss: 1.2942, label: 3, bag_size: 608
batch 99, loss: 2.9428, instance_loss: 0.5843, weighted_loss: 2.2353, label: 0, bag_size: 888
batch 119, loss: 1.1781, instance_loss: 0.4787, weighted_loss: 0.9683, label: 4, bag_size: 72
batch 139, loss: 1.2679, instance_loss: 0.6011, weighted_loss: 1.0679, label: 0, bag_size: 642
batch 159, loss: 1.7648, instance_loss: 0.5735, weighted_loss: 1.4074, label: 4, bag_size: 652
batch 179, loss: 2.1886, instance_loss: 0.6185, weighted_loss: 1.7176, label: 2, bag_size: 321
batch 199, loss: 0.1372, instance_loss: 0.5529, weighted_loss: 0.2619, label: 2, bag_size: 1608
batch 219, loss: 1.3760, instance_loss: 0.5083, weighted_loss: 1.1157, label: 4, bag_size: 590
batch 239, loss: 2.0111, instance_loss: 0.5758, weighted_loss: 1.5805, label: 3, bag_size: 282
batch 259, loss: 1.3147, instance_loss: 0.5432, weighted_loss: 1.0832, label: 1, bag_size: 605
batch 279, loss: 0.9593, instance_loss: 0.4977, weighted_loss: 0.8208, label: 4, bag_size: 824
batch 299, loss: 1.6205, instance_loss: 0.5288, weighted_loss: 1.2930, label: 4, bag_size: 590
batch 319, loss: 1.2144, instance_loss: 0.4860, weighted_loss: 0.9959, label: 1, bag_size: 672
batch 339, loss: 4.0417, instance_loss: 0.6271, weighted_loss: 3.0173, label: 3, bag_size: 107
batch 359, loss: 1.3636, instance_loss: 0.5241, weighted_loss: 1.1117, label: 2, bag_size: 592
batch 379, loss: 0.0461, instance_loss: 0.2539, weighted_loss: 0.1084, label: 0, bag_size: 306
batch 399, loss: 1.3647, instance_loss: 0.5289, weighted_loss: 1.1139, label: 1, bag_size: 766
batch 419, loss: 1.0689, instance_loss: 0.4645, weighted_loss: 0.8876, label: 2, bag_size: 617
batch 439, loss: 1.2464, instance_loss: 0.5086, weighted_loss: 1.0250, label: 1, bag_size: 371
batch 459, loss: 3.6587, instance_loss: 0.6909, weighted_loss: 2.7683, label: 4, bag_size: 270
batch 479, loss: 0.3398, instance_loss: 0.4503, weighted_loss: 0.3730, label: 4, bag_size: 574
batch 499, loss: 1.7898, instance_loss: 0.4857, weighted_loss: 1.3986, label: 2, bag_size: 629
batch 519, loss: 3.0740, instance_loss: 0.7236, weighted_loss: 2.3689, label: 0, bag_size: 879
batch 539, loss: 1.0591, instance_loss: 0.4952, weighted_loss: 0.8899, label: 3, bag_size: 344
batch 559, loss: 0.7930, instance_loss: 0.4153, weighted_loss: 0.6797, label: 3, bag_size: 817
batch 579, loss: 1.2505, instance_loss: 0.5010, weighted_loss: 1.0256, label: 1, bag_size: 697


class 0 clustering acc 0.998989898989899: correct 23736/23760
class 1 clustering acc 0.014730639730639731: correct 70/4752
Epoch: 11, train_loss: 1.2781, train_clustering_loss:  0.4953, train_error: 0.5556
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.2627118644067797, correct 31/118
class 2: acc 0.2857142857142857, correct 32/112
class 3: acc 0.38686131386861317, correct 53/137
class 4: acc 0.544, correct 68/125

Val Set, val_loss: 1.3138, val_error: 0.5676, auc: 0.7556
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.4632, instance_loss: 0.5601, weighted_loss: 1.8923, label: 1, bag_size: 231
batch 39, loss: 1.2501, instance_loss: 0.4918, weighted_loss: 1.0226, label: 2, bag_size: 799
batch 59, loss: 0.9185, instance_loss: 0.4584, weighted_loss: 0.7804, label: 4, bag_size: 231
batch 79, loss: 4.4311, instance_loss: 0.7002, weighted_loss: 3.3118, label: 4, bag_size: 293
batch 99, loss: 1.1521, instance_loss: 0.4441, weighted_loss: 0.9397, label: 3, bag_size: 443
batch 119, loss: 1.1080, instance_loss: 0.5000, weighted_loss: 0.9256, label: 2, bag_size: 697
batch 139, loss: 1.2673, instance_loss: 0.4780, weighted_loss: 1.0306, label: 3, bag_size: 830
batch 159, loss: 1.0758, instance_loss: 0.4775, weighted_loss: 0.8963, label: 3, bag_size: 498
batch 179, loss: 0.0420, instance_loss: 0.4573, weighted_loss: 0.1666, label: 2, bag_size: 596
batch 199, loss: 1.0236, instance_loss: 0.4730, weighted_loss: 0.8584, label: 1, bag_size: 141
batch 219, loss: 1.4157, instance_loss: 0.4689, weighted_loss: 1.1317, label: 2, bag_size: 470
batch 239, loss: 0.6027, instance_loss: 0.4297, weighted_loss: 0.5508, label: 1, bag_size: 593
batch 259, loss: 2.6302, instance_loss: 0.5468, weighted_loss: 2.0052, label: 4, bag_size: 270
batch 279, loss: 2.4653, instance_loss: 0.6362, weighted_loss: 1.9166, label: 4, bag_size: 886
batch 299, loss: 2.6999, instance_loss: 0.5942, weighted_loss: 2.0682, label: 0, bag_size: 243
batch 319, loss: 1.9241, instance_loss: 0.5342, weighted_loss: 1.5071, label: 3, bag_size: 337
batch 339, loss: 0.8973, instance_loss: 0.4274, weighted_loss: 0.7563, label: 3, bag_size: 625
batch 359, loss: 0.8322, instance_loss: 0.4066, weighted_loss: 0.7045, label: 3, bag_size: 804
batch 379, loss: 0.4052, instance_loss: 0.6132, weighted_loss: 0.4676, label: 4, bag_size: 769
batch 399, loss: 1.0729, instance_loss: 0.4850, weighted_loss: 0.8965, label: 1, bag_size: 892
batch 419, loss: 0.7062, instance_loss: 0.4207, weighted_loss: 0.6206, label: 4, bag_size: 775
batch 439, loss: 2.1069, instance_loss: 0.5540, weighted_loss: 1.6410, label: 4, bag_size: 438
batch 459, loss: 1.2838, instance_loss: 0.5066, weighted_loss: 1.0507, label: 2, bag_size: 567
batch 479, loss: 1.2807, instance_loss: 0.4977, weighted_loss: 1.0458, label: 2, bag_size: 361
batch 499, loss: 0.9473, instance_loss: 0.5017, weighted_loss: 0.8136, label: 4, bag_size: 639
batch 519, loss: 1.3891, instance_loss: 0.4520, weighted_loss: 1.1080, label: 3, bag_size: 1076
batch 539, loss: 1.3155, instance_loss: 0.4824, weighted_loss: 1.0656, label: 1, bag_size: 614
batch 559, loss: 0.9402, instance_loss: 0.4905, weighted_loss: 0.8053, label: 2, bag_size: 607
batch 579, loss: 0.3472, instance_loss: 0.4227, weighted_loss: 0.3698, label: 0, bag_size: 281


class 0 clustering acc 0.9988215488215488: correct 23732/23760
class 1 clustering acc 0.023148148148148147: correct 110/4752
Epoch: 12, train_loss: 1.2716, train_clustering_loss:  0.4927, train_error: 0.5825
class 0: acc 0.75, correct 78/104
class 1: acc 0.33076923076923076, correct 43/130
class 2: acc 0.2265625, correct 29/128
class 3: acc 0.5343511450381679, correct 70/131
class 4: acc 0.27722772277227725, correct 28/101

Val Set, val_loss: 1.2540, val_error: 0.5000, auc: 0.7686
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3934, instance_loss: 0.4222, weighted_loss: 1.1020, label: 2, bag_size: 1066
batch 39, loss: 0.9352, instance_loss: 0.4211, weighted_loss: 0.7810, label: 1, bag_size: 981
batch 59, loss: 1.7038, instance_loss: 0.5007, weighted_loss: 1.3429, label: 3, bag_size: 797
batch 79, loss: 0.0739, instance_loss: 0.2651, weighted_loss: 0.1312, label: 0, bag_size: 573
batch 99, loss: 1.6034, instance_loss: 0.5764, weighted_loss: 1.2953, label: 2, bag_size: 321
batch 119, loss: 1.6582, instance_loss: 0.4709, weighted_loss: 1.3020, label: 1, bag_size: 865
batch 139, loss: 1.0969, instance_loss: 0.5062, weighted_loss: 0.9197, label: 3, bag_size: 453
batch 159, loss: 1.2419, instance_loss: 0.4771, weighted_loss: 1.0125, label: 0, bag_size: 247
batch 179, loss: 0.0846, instance_loss: 0.3429, weighted_loss: 0.1621, label: 0, bag_size: 49
batch 199, loss: 2.1110, instance_loss: 0.5550, weighted_loss: 1.6442, label: 4, bag_size: 98
batch 219, loss: 1.5083, instance_loss: 0.4487, weighted_loss: 1.1904, label: 2, bag_size: 286
batch 239, loss: 2.9246, instance_loss: 0.5589, weighted_loss: 2.2149, label: 4, bag_size: 270
batch 259, loss: 1.8902, instance_loss: 0.5134, weighted_loss: 1.4771, label: 1, bag_size: 1013
batch 279, loss: 0.3339, instance_loss: 0.4548, weighted_loss: 0.3702, label: 0, bag_size: 238
batch 299, loss: 1.6735, instance_loss: 0.5931, weighted_loss: 1.3494, label: 1, bag_size: 695
batch 319, loss: 1.0511, instance_loss: 0.4971, weighted_loss: 0.8849, label: 4, bag_size: 1064
batch 339, loss: 1.7314, instance_loss: 0.4996, weighted_loss: 1.3618, label: 2, bag_size: 340
batch 359, loss: 1.4540, instance_loss: 0.4638, weighted_loss: 1.1569, label: 4, bag_size: 960
batch 379, loss: 1.3356, instance_loss: 0.4805, weighted_loss: 1.0791, label: 4, bag_size: 238
batch 399, loss: 1.1400, instance_loss: 0.5063, weighted_loss: 0.9499, label: 2, bag_size: 558
batch 419, loss: 1.0293, instance_loss: 0.4520, weighted_loss: 0.8561, label: 2, bag_size: 867
batch 439, loss: 1.7029, instance_loss: 0.5160, weighted_loss: 1.3468, label: 3, bag_size: 192
batch 459, loss: 0.2931, instance_loss: 0.4911, weighted_loss: 0.3525, label: 0, bag_size: 218
batch 479, loss: 1.0589, instance_loss: 0.5224, weighted_loss: 0.8980, label: 4, bag_size: 689
batch 499, loss: 0.5456, instance_loss: 0.5165, weighted_loss: 0.5369, label: 4, bag_size: 574
batch 519, loss: 1.3698, instance_loss: 0.5143, weighted_loss: 1.1132, label: 2, bag_size: 350
batch 539, loss: 2.3208, instance_loss: 0.5718, weighted_loss: 1.7961, label: 0, bag_size: 888
batch 559, loss: 0.9813, instance_loss: 0.4670, weighted_loss: 0.8270, label: 3, bag_size: 817
batch 579, loss: 1.3305, instance_loss: 0.4562, weighted_loss: 1.0682, label: 4, bag_size: 198


class 0 clustering acc 0.9986531986531987: correct 23728/23760
class 1 clustering acc 0.017255892255892257: correct 82/4752
Epoch: 13, train_loss: 1.2873, train_clustering_loss:  0.4972, train_error: 0.5505
class 0: acc 0.8165137614678899, correct 89/109
class 1: acc 0.17, correct 17/100
class 2: acc 0.42748091603053434, correct 56/131
class 3: acc 0.4409448818897638, correct 56/127
class 4: acc 0.3858267716535433, correct 49/127

Val Set, val_loss: 1.2439, val_error: 0.4459, auc: 0.7682
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2275, instance_loss: 0.6218, weighted_loss: 1.0458, label: 1, bag_size: 605
batch 39, loss: 1.7122, instance_loss: 0.5282, weighted_loss: 1.3570, label: 4, bag_size: 342
batch 59, loss: 0.1396, instance_loss: 0.3523, weighted_loss: 0.2034, label: 0, bag_size: 156
batch 79, loss: 1.7171, instance_loss: 0.5269, weighted_loss: 1.3600, label: 1, bag_size: 840
batch 99, loss: 3.8608, instance_loss: 0.7726, weighted_loss: 2.9344, label: 0, bag_size: 169
batch 119, loss: 0.8669, instance_loss: 0.5897, weighted_loss: 0.7838, label: 0, bag_size: 295
batch 139, loss: 1.4171, instance_loss: 0.5159, weighted_loss: 1.1468, label: 3, bag_size: 457
batch 159, loss: 1.1094, instance_loss: 0.4625, weighted_loss: 0.9153, label: 3, bag_size: 996
batch 179, loss: 3.4412, instance_loss: 0.7719, weighted_loss: 2.6404, label: 0, bag_size: 1039
batch 199, loss: 1.1399, instance_loss: 0.4477, weighted_loss: 0.9323, label: 3, bag_size: 857
batch 219, loss: 1.3344, instance_loss: 0.4566, weighted_loss: 1.0711, label: 3, bag_size: 779
batch 239, loss: 1.2092, instance_loss: 0.4244, weighted_loss: 0.9738, label: 3, bag_size: 797
batch 259, loss: 1.0620, instance_loss: 0.4263, weighted_loss: 0.8713, label: 1, bag_size: 1013
batch 279, loss: 1.5564, instance_loss: 0.4719, weighted_loss: 1.2311, label: 2, bag_size: 543
batch 299, loss: 1.4945, instance_loss: 0.4880, weighted_loss: 1.1926, label: 2, bag_size: 331
batch 319, loss: 1.0304, instance_loss: 0.4930, weighted_loss: 0.8692, label: 2, bag_size: 613
batch 339, loss: 0.1588, instance_loss: 0.4841, weighted_loss: 0.2564, label: 4, bag_size: 923
batch 359, loss: 0.0000, instance_loss: 0.4311, weighted_loss: 0.1293, label: 1, bag_size: 669
batch 379, loss: 1.9326, instance_loss: 0.5660, weighted_loss: 1.5227, label: 4, bag_size: 757
batch 399, loss: 0.3993, instance_loss: 0.4106, weighted_loss: 0.4027, label: 0, bag_size: 188
batch 419, loss: 1.2084, instance_loss: 0.5115, weighted_loss: 0.9994, label: 3, bag_size: 1284
batch 439, loss: 0.2578, instance_loss: 0.4267, weighted_loss: 0.3085, label: 0, bag_size: 79
batch 459, loss: 2.5337, instance_loss: 0.5350, weighted_loss: 1.9341, label: 2, bag_size: 1122
batch 479, loss: 1.2632, instance_loss: 0.4612, weighted_loss: 1.0226, label: 3, bag_size: 499
batch 499, loss: 0.3012, instance_loss: 0.4991, weighted_loss: 0.3606, label: 0, bag_size: 397
batch 519, loss: 0.9064, instance_loss: 0.4950, weighted_loss: 0.7830, label: 1, bag_size: 490
batch 539, loss: 1.0765, instance_loss: 0.6174, weighted_loss: 0.9388, label: 0, bag_size: 306
batch 559, loss: 1.3630, instance_loss: 0.5148, weighted_loss: 1.1086, label: 2, bag_size: 317
batch 579, loss: 1.7053, instance_loss: 0.5820, weighted_loss: 1.3683, label: 3, bag_size: 235


class 0 clustering acc 0.9989057239057239: correct 23734/23760
class 1 clustering acc 0.023148148148148147: correct 110/4752
Epoch: 14, train_loss: 1.2306, train_clustering_loss:  0.4948, train_error: 0.5168
class 0: acc 0.8225806451612904, correct 102/124
class 1: acc 0.4496124031007752, correct 58/129
class 2: acc 0.2545454545454545, correct 28/110
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.5619834710743802, correct 68/121

Val Set, val_loss: 1.2258, val_error: 0.5270, auc: 0.7865
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.237480 --> 1.225760).  Saving model ...


batch 19, loss: 1.5038, instance_loss: 0.5824, weighted_loss: 1.2274, label: 1, bag_size: 159
batch 39, loss: 1.0959, instance_loss: 0.4715, weighted_loss: 0.9086, label: 3, bag_size: 857
batch 59, loss: 0.2982, instance_loss: 0.4339, weighted_loss: 0.3389, label: 0, bag_size: 238
batch 79, loss: 2.3575, instance_loss: 0.5154, weighted_loss: 1.8049, label: 4, bag_size: 113
batch 99, loss: 1.4026, instance_loss: 0.4954, weighted_loss: 1.1304, label: 1, bag_size: 311
batch 119, loss: 0.2262, instance_loss: 0.3642, weighted_loss: 0.2676, label: 2, bag_size: 1975
batch 139, loss: 1.4885, instance_loss: 0.4943, weighted_loss: 1.1903, label: 3, bag_size: 899
batch 159, loss: 1.4180, instance_loss: 0.5146, weighted_loss: 1.1470, label: 4, bag_size: 986
batch 179, loss: 1.2698, instance_loss: 0.5531, weighted_loss: 1.0547, label: 4, bag_size: 1064
batch 199, loss: 1.2832, instance_loss: 0.5011, weighted_loss: 1.0486, label: 3, bag_size: 779
batch 219, loss: 1.5190, instance_loss: 0.5032, weighted_loss: 1.2142, label: 3, bag_size: 486
batch 239, loss: 0.0330, instance_loss: 0.3798, weighted_loss: 0.1371, label: 0, bag_size: 236
batch 259, loss: 1.1655, instance_loss: 0.4871, weighted_loss: 0.9619, label: 2, bag_size: 708
batch 279, loss: 0.4037, instance_loss: 0.4399, weighted_loss: 0.4146, label: 0, bag_size: 366
batch 299, loss: 2.0551, instance_loss: 0.5174, weighted_loss: 1.5938, label: 3, bag_size: 342
batch 319, loss: 0.4776, instance_loss: 0.5059, weighted_loss: 0.4861, label: 0, bag_size: 122
batch 339, loss: 1.2436, instance_loss: 0.4850, weighted_loss: 1.0160, label: 2, bag_size: 598
batch 359, loss: 0.8697, instance_loss: 0.4693, weighted_loss: 0.7496, label: 3, bag_size: 928
batch 379, loss: 3.1508, instance_loss: 0.6645, weighted_loss: 2.4049, label: 0, bag_size: 1039
batch 399, loss: 1.7760, instance_loss: 0.5451, weighted_loss: 1.4068, label: 3, bag_size: 107
batch 419, loss: 2.5405, instance_loss: 0.6253, weighted_loss: 1.9660, label: 4, bag_size: 854
batch 439, loss: 2.0998, instance_loss: 0.4949, weighted_loss: 1.6184, label: 2, bag_size: 219
batch 459, loss: 1.1452, instance_loss: 0.4372, weighted_loss: 0.9328, label: 2, bag_size: 375
batch 479, loss: 0.1751, instance_loss: 0.3496, weighted_loss: 0.2275, label: 0, bag_size: 280
batch 499, loss: 0.1524, instance_loss: 0.3790, weighted_loss: 0.2204, label: 0, bag_size: 58
batch 519, loss: 0.0401, instance_loss: 0.2833, weighted_loss: 0.1130, label: 0, bag_size: 258
batch 539, loss: 1.7732, instance_loss: 0.4963, weighted_loss: 1.3902, label: 4, bag_size: 699
batch 559, loss: 1.5051, instance_loss: 0.5462, weighted_loss: 1.2175, label: 4, bag_size: 652
batch 579, loss: 1.0344, instance_loss: 0.4585, weighted_loss: 0.8616, label: 1, bag_size: 1091


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.02925084175084175: correct 139/4752
Epoch: 15, train_loss: 1.2307, train_clustering_loss:  0.4918, train_error: 0.5269
class 0: acc 0.8473282442748091, correct 111/131
class 1: acc 0.2037037037037037, correct 22/108
class 2: acc 0.453125, correct 58/128
class 3: acc 0.3063063063063063, correct 34/111
class 4: acc 0.4827586206896552, correct 56/116

Val Set, val_loss: 1.1989, val_error: 0.5405, auc: 0.7911
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.225760 --> 1.198861).  Saving model ...


batch 19, loss: 1.8148, instance_loss: 0.6426, weighted_loss: 1.4631, label: 2, bag_size: 554
batch 39, loss: 1.4729, instance_loss: 0.5639, weighted_loss: 1.2002, label: 2, bag_size: 105
batch 59, loss: 0.7183, instance_loss: 0.5493, weighted_loss: 0.6676, label: 0, bag_size: 760
batch 79, loss: 1.5850, instance_loss: 0.4862, weighted_loss: 1.2554, label: 2, bag_size: 1319
batch 99, loss: 0.9847, instance_loss: 0.4831, weighted_loss: 0.8342, label: 3, bag_size: 453
batch 119, loss: 1.0119, instance_loss: 0.5401, weighted_loss: 0.8704, label: 3, bag_size: 641
batch 139, loss: 1.7594, instance_loss: 0.5216, weighted_loss: 1.3880, label: 2, bag_size: 744
batch 159, loss: 1.2075, instance_loss: 0.4564, weighted_loss: 0.9822, label: 1, bag_size: 960
batch 179, loss: 0.5042, instance_loss: 0.3781, weighted_loss: 0.4664, label: 0, bag_size: 493
batch 199, loss: 0.7867, instance_loss: 0.5087, weighted_loss: 0.7033, label: 4, bag_size: 432
batch 219, loss: 1.4392, instance_loss: 0.5244, weighted_loss: 1.1648, label: 4, bag_size: 250
batch 239, loss: 0.5425, instance_loss: 0.5158, weighted_loss: 0.5345, label: 2, bag_size: 596
batch 259, loss: 0.6789, instance_loss: 0.3450, weighted_loss: 0.5788, label: 0, bag_size: 428
batch 279, loss: 0.2911, instance_loss: 0.4519, weighted_loss: 0.3393, label: 0, bag_size: 224
batch 299, loss: 1.1186, instance_loss: 0.4492, weighted_loss: 0.9178, label: 1, bag_size: 444
batch 319, loss: 0.0989, instance_loss: 0.3857, weighted_loss: 0.1850, label: 0, bag_size: 517
batch 339, loss: 0.8406, instance_loss: 0.4412, weighted_loss: 0.7208, label: 3, bag_size: 488
batch 359, loss: 1.7876, instance_loss: 0.5543, weighted_loss: 1.4176, label: 3, bag_size: 300
batch 379, loss: 0.4130, instance_loss: 0.4423, weighted_loss: 0.4218, label: 4, bag_size: 498
batch 399, loss: 2.6083, instance_loss: 0.5991, weighted_loss: 2.0055, label: 0, bag_size: 1073
batch 419, loss: 1.8199, instance_loss: 0.4952, weighted_loss: 1.4225, label: 0, bag_size: 745
batch 439, loss: 1.2387, instance_loss: 0.5633, weighted_loss: 1.0361, label: 3, bag_size: 393
batch 459, loss: 1.0102, instance_loss: 0.4822, weighted_loss: 0.8518, label: 1, bag_size: 660
batch 479, loss: 0.5150, instance_loss: 0.4431, weighted_loss: 0.4934, label: 0, bag_size: 62
batch 499, loss: 0.2094, instance_loss: 0.3728, weighted_loss: 0.2584, label: 0, bag_size: 70
batch 519, loss: 1.4417, instance_loss: 0.5492, weighted_loss: 1.1739, label: 2, bag_size: 315
batch 539, loss: 0.2114, instance_loss: 0.3256, weighted_loss: 0.2456, label: 0, bag_size: 142
batch 559, loss: 2.0973, instance_loss: 0.5657, weighted_loss: 1.6378, label: 2, bag_size: 582
batch 579, loss: 1.0921, instance_loss: 0.4829, weighted_loss: 0.9093, label: 2, bag_size: 582


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.022937710437710437: correct 109/4752
Epoch: 16, train_loss: 1.1974, train_clustering_loss:  0.4902, train_error: 0.5135
class 0: acc 0.8308823529411765, correct 113/136
class 1: acc 0.3416666666666667, correct 41/120
class 2: acc 0.28448275862068967, correct 33/116
class 3: acc 0.48695652173913045, correct 56/115
class 4: acc 0.42990654205607476, correct 46/107

Val Set, val_loss: 1.3359, val_error: 0.5405, auc: 0.7454
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7728, instance_loss: 0.4525, weighted_loss: 0.6768, label: 0, bag_size: 306
batch 39, loss: 1.6536, instance_loss: 0.5362, weighted_loss: 1.3184, label: 3, bag_size: 598
batch 59, loss: 0.5248, instance_loss: 0.4557, weighted_loss: 0.5041, label: 3, bag_size: 344
batch 79, loss: 0.5261, instance_loss: 0.3594, weighted_loss: 0.4761, label: 3, bag_size: 476
batch 99, loss: 1.3767, instance_loss: 0.5085, weighted_loss: 1.1162, label: 2, bag_size: 488
batch 119, loss: 1.1431, instance_loss: 0.4245, weighted_loss: 0.9275, label: 1, bag_size: 544
batch 139, loss: 2.8211, instance_loss: 0.5222, weighted_loss: 2.1315, label: 2, bag_size: 219
batch 159, loss: 0.9877, instance_loss: 0.5048, weighted_loss: 0.8429, label: 2, bag_size: 779
batch 179, loss: 1.4037, instance_loss: 0.4918, weighted_loss: 1.1301, label: 1, bag_size: 695
batch 199, loss: 2.2585, instance_loss: 0.6247, weighted_loss: 1.7684, label: 4, bag_size: 476
batch 219, loss: 2.9681, instance_loss: 0.6609, weighted_loss: 2.2759, label: 0, bag_size: 600
batch 239, loss: 0.6380, instance_loss: 0.4605, weighted_loss: 0.5847, label: 4, bag_size: 639
batch 259, loss: 2.1799, instance_loss: 0.5247, weighted_loss: 1.6833, label: 1, bag_size: 988
batch 279, loss: 0.8819, instance_loss: 0.4605, weighted_loss: 0.7555, label: 2, bag_size: 582
batch 299, loss: 0.9123, instance_loss: 0.4529, weighted_loss: 0.7745, label: 2, bag_size: 240
batch 319, loss: 1.2853, instance_loss: 0.5049, weighted_loss: 1.0512, label: 3, bag_size: 681
batch 339, loss: 0.9944, instance_loss: 0.5158, weighted_loss: 0.8508, label: 3, bag_size: 1078
batch 359, loss: 2.8867, instance_loss: 0.5485, weighted_loss: 2.1852, label: 3, bag_size: 282
batch 379, loss: 1.0734, instance_loss: 0.4240, weighted_loss: 0.8786, label: 4, bag_size: 960
batch 399, loss: 0.8678, instance_loss: 0.4290, weighted_loss: 0.7362, label: 3, bag_size: 899
batch 419, loss: 1.1756, instance_loss: 0.5400, weighted_loss: 0.9849, label: 1, bag_size: 311
batch 439, loss: 2.1143, instance_loss: 0.5879, weighted_loss: 1.6564, label: 4, bag_size: 1297
batch 459, loss: 0.9711, instance_loss: 0.4330, weighted_loss: 0.8096, label: 3, bag_size: 982
batch 479, loss: 1.3728, instance_loss: 0.5121, weighted_loss: 1.1146, label: 4, bag_size: 695
batch 499, loss: 2.5937, instance_loss: 0.5646, weighted_loss: 1.9850, label: 2, bag_size: 861
batch 519, loss: 1.2757, instance_loss: 0.4909, weighted_loss: 1.0403, label: 1, bag_size: 372
batch 539, loss: 0.9338, instance_loss: 0.4768, weighted_loss: 0.7967, label: 2, bag_size: 598
batch 559, loss: 1.0838, instance_loss: 0.4064, weighted_loss: 0.8806, label: 3, bag_size: 737
batch 579, loss: 1.6049, instance_loss: 0.5111, weighted_loss: 1.2768, label: 2, bag_size: 105


class 0 clustering acc 0.9991161616161616: correct 23739/23760
class 1 clustering acc 0.016203703703703703: correct 77/4752
Epoch: 17, train_loss: 1.2250, train_clustering_loss:  0.4890, train_error: 0.5202
class 0: acc 0.8632478632478633, correct 101/117
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.4198473282442748, correct 55/131
class 3: acc 0.5, correct 63/126
class 4: acc 0.38181818181818183, correct 42/110

Val Set, val_loss: 1.2100, val_error: 0.5676, auc: 0.7733
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.3037, instance_loss: 0.5824, weighted_loss: 1.7873, label: 3, bag_size: 342
batch 39, loss: 0.7577, instance_loss: 0.3594, weighted_loss: 0.6382, label: 3, bag_size: 737
batch 59, loss: 2.7090, instance_loss: 0.5736, weighted_loss: 2.0684, label: 1, bag_size: 988
batch 79, loss: 2.2988, instance_loss: 0.6028, weighted_loss: 1.7900, label: 4, bag_size: 312
batch 99, loss: 0.3836, instance_loss: 0.3704, weighted_loss: 0.3797, label: 0, bag_size: 234
batch 119, loss: 0.3118, instance_loss: 0.4375, weighted_loss: 0.3495, label: 0, bag_size: 49
batch 139, loss: 1.0189, instance_loss: 0.4693, weighted_loss: 0.8540, label: 1, bag_size: 960
batch 159, loss: 1.0100, instance_loss: 0.4353, weighted_loss: 0.8376, label: 1, bag_size: 500
batch 179, loss: 1.0543, instance_loss: 0.3885, weighted_loss: 0.8546, label: 3, bag_size: 615
batch 199, loss: 0.8386, instance_loss: 0.4809, weighted_loss: 0.7313, label: 4, bag_size: 204
batch 219, loss: 0.4667, instance_loss: 0.4242, weighted_loss: 0.4539, label: 0, bag_size: 642
batch 239, loss: 1.0773, instance_loss: 0.4663, weighted_loss: 0.8940, label: 1, bag_size: 865
batch 259, loss: 2.4705, instance_loss: 0.6392, weighted_loss: 1.9211, label: 2, bag_size: 941
batch 279, loss: 2.7621, instance_loss: 0.5261, weighted_loss: 2.0913, label: 3, bag_size: 543
batch 299, loss: 1.3924, instance_loss: 0.5209, weighted_loss: 1.1310, label: 3, bag_size: 192
batch 319, loss: 1.4835, instance_loss: 0.5324, weighted_loss: 1.1982, label: 1, bag_size: 483
batch 339, loss: 0.8812, instance_loss: 0.4304, weighted_loss: 0.7460, label: 3, bag_size: 344
batch 359, loss: 0.7941, instance_loss: 0.3891, weighted_loss: 0.6726, label: 4, bag_size: 266
batch 379, loss: 1.3623, instance_loss: 0.5164, weighted_loss: 1.1086, label: 3, bag_size: 149
batch 399, loss: 0.8809, instance_loss: 0.5002, weighted_loss: 0.7667, label: 2, bag_size: 402
batch 419, loss: 1.5618, instance_loss: 0.4924, weighted_loss: 1.2409, label: 1, bag_size: 618
batch 439, loss: 1.0564, instance_loss: 0.4727, weighted_loss: 0.8813, label: 2, bag_size: 613
batch 459, loss: 0.3473, instance_loss: 0.4122, weighted_loss: 0.3667, label: 0, bag_size: 351
batch 479, loss: 0.6237, instance_loss: 0.4581, weighted_loss: 0.5741, label: 4, bag_size: 744
batch 499, loss: 0.8659, instance_loss: 0.4568, weighted_loss: 0.7431, label: 2, bag_size: 535
batch 519, loss: 1.1482, instance_loss: 0.4415, weighted_loss: 0.9362, label: 1, bag_size: 672
batch 539, loss: 1.5645, instance_loss: 0.5185, weighted_loss: 1.2507, label: 1, bag_size: 614
batch 559, loss: 1.2536, instance_loss: 0.5052, weighted_loss: 1.0291, label: 3, bag_size: 556
batch 579, loss: 1.1519, instance_loss: 0.4942, weighted_loss: 0.9546, label: 2, bag_size: 769


class 0 clustering acc 0.9987794612794613: correct 23731/23760
class 1 clustering acc 0.013257575757575758: correct 63/4752
Epoch: 18, train_loss: 1.2616, train_clustering_loss:  0.4943, train_error: 0.5488
class 0: acc 0.782258064516129, correct 97/124
class 1: acc 0.371900826446281, correct 45/121
class 2: acc 0.29245283018867924, correct 31/106
class 3: acc 0.3492063492063492, correct 44/126
class 4: acc 0.4358974358974359, correct 51/117

Val Set, val_loss: 1.2591, val_error: 0.5676, auc: 0.7669
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0449, instance_loss: 0.4708, weighted_loss: 0.8727, label: 2, bag_size: 369
batch 39, loss: 1.1757, instance_loss: 0.5124, weighted_loss: 0.9767, label: 2, bag_size: 208
batch 59, loss: 0.9586, instance_loss: 0.4909, weighted_loss: 0.8183, label: 4, bag_size: 868
batch 79, loss: 1.6422, instance_loss: 0.5889, weighted_loss: 1.3262, label: 4, bag_size: 886
batch 99, loss: 1.4048, instance_loss: 0.4235, weighted_loss: 1.1104, label: 2, bag_size: 1092
batch 119, loss: 0.9602, instance_loss: 0.5089, weighted_loss: 0.8248, label: 3, bag_size: 498
batch 139, loss: 2.5300, instance_loss: 0.6502, weighted_loss: 1.9660, label: 0, bag_size: 888
batch 159, loss: 0.1652, instance_loss: 0.2970, weighted_loss: 0.2048, label: 0, bag_size: 63
batch 179, loss: 1.4902, instance_loss: 0.5300, weighted_loss: 1.2021, label: 3, bag_size: 1358
batch 199, loss: 1.4319, instance_loss: 0.4831, weighted_loss: 1.1472, label: 1, bag_size: 525
batch 219, loss: 1.9818, instance_loss: 0.5666, weighted_loss: 1.5573, label: 2, bag_size: 576
batch 239, loss: 1.3495, instance_loss: 0.4591, weighted_loss: 1.0824, label: 2, bag_size: 105
batch 259, loss: 1.3904, instance_loss: 0.4386, weighted_loss: 1.1049, label: 1, bag_size: 461
batch 279, loss: 0.2478, instance_loss: 0.3874, weighted_loss: 0.2897, label: 0, bag_size: 188
batch 299, loss: 0.1870, instance_loss: 0.3786, weighted_loss: 0.2445, label: 0, bag_size: 351
batch 319, loss: 0.8978, instance_loss: 0.4661, weighted_loss: 0.7683, label: 2, bag_size: 779
batch 339, loss: 0.0004, instance_loss: 0.3834, weighted_loss: 0.1153, label: 2, bag_size: 1608
batch 359, loss: 0.6924, instance_loss: 0.4364, weighted_loss: 0.6156, label: 3, bag_size: 344
batch 379, loss: 0.7022, instance_loss: 0.5667, weighted_loss: 0.6615, label: 3, bag_size: 928
batch 399, loss: 2.4272, instance_loss: 0.7778, weighted_loss: 1.9324, label: 2, bag_size: 713
batch 419, loss: 1.0021, instance_loss: 0.4812, weighted_loss: 0.8459, label: 1, bag_size: 892
batch 439, loss: 1.0731, instance_loss: 0.4886, weighted_loss: 0.8977, label: 1, bag_size: 371
batch 459, loss: 1.4323, instance_loss: 0.4802, weighted_loss: 1.1467, label: 2, bag_size: 941
batch 479, loss: 1.0635, instance_loss: 0.5020, weighted_loss: 0.8951, label: 4, bag_size: 506
batch 499, loss: 0.9376, instance_loss: 0.4904, weighted_loss: 0.8035, label: 3, bag_size: 1060
batch 519, loss: 1.0994, instance_loss: 0.5191, weighted_loss: 0.9253, label: 2, bag_size: 266
batch 539, loss: 0.0001, instance_loss: 0.3671, weighted_loss: 0.1102, label: 1, bag_size: 669
batch 559, loss: 0.5370, instance_loss: 0.4216, weighted_loss: 0.5024, label: 4, bag_size: 627
batch 579, loss: 1.4396, instance_loss: 0.5428, weighted_loss: 1.1705, label: 4, bag_size: 438


class 0 clustering acc 0.9990740740740741: correct 23738/23760
class 1 clustering acc 0.012415824915824917: correct 59/4752
Epoch: 19, train_loss: 1.1985, train_clustering_loss:  0.4910, train_error: 0.5185
class 0: acc 0.7636363636363637, correct 84/110
class 1: acc 0.5379310344827586, correct 78/145
class 2: acc 0.2956521739130435, correct 34/115
class 3: acc 0.33620689655172414, correct 39/116
class 4: acc 0.4722222222222222, correct 51/108

Val Set, val_loss: 1.2979, val_error: 0.5405, auc: 0.7553
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6445, instance_loss: 0.4549, weighted_loss: 0.5876, label: 0, bag_size: 760
batch 39, loss: 1.0746, instance_loss: 0.5410, weighted_loss: 0.9146, label: 2, bag_size: 821
batch 59, loss: 0.4404, instance_loss: 0.4604, weighted_loss: 0.4464, label: 0, bag_size: 159
batch 79, loss: 0.4541, instance_loss: 0.4868, weighted_loss: 0.4639, label: 0, bag_size: 393
batch 99, loss: 1.8101, instance_loss: 0.5122, weighted_loss: 1.4208, label: 4, bag_size: 264
batch 119, loss: 1.3525, instance_loss: 0.5274, weighted_loss: 1.1050, label: 3, bag_size: 309
batch 139, loss: 0.2921, instance_loss: 0.4116, weighted_loss: 0.3279, label: 0, bag_size: 159
batch 159, loss: 1.9311, instance_loss: 0.5175, weighted_loss: 1.5070, label: 3, bag_size: 856
batch 179, loss: 1.0389, instance_loss: 0.5226, weighted_loss: 0.8840, label: 3, bag_size: 982
batch 199, loss: 0.6417, instance_loss: 0.3929, weighted_loss: 0.5671, label: 0, bag_size: 81
batch 219, loss: 3.5331, instance_loss: 0.7174, weighted_loss: 2.6884, label: 1, bag_size: 45
batch 239, loss: 1.4035, instance_loss: 0.4710, weighted_loss: 1.1237, label: 1, bag_size: 697
batch 259, loss: 2.0315, instance_loss: 0.5572, weighted_loss: 1.5892, label: 2, bag_size: 258
batch 279, loss: 0.4761, instance_loss: 0.3797, weighted_loss: 0.4472, label: 3, bag_size: 272
batch 299, loss: 0.3392, instance_loss: 0.5091, weighted_loss: 0.3901, label: 2, bag_size: 1975
batch 319, loss: 1.2584, instance_loss: 0.5263, weighted_loss: 1.0387, label: 1, bag_size: 159
batch 339, loss: 0.8842, instance_loss: 0.4973, weighted_loss: 0.7681, label: 4, bag_size: 714
batch 359, loss: 2.6636, instance_loss: 0.5966, weighted_loss: 2.0435, label: 2, bag_size: 219
batch 379, loss: 0.6479, instance_loss: 0.3700, weighted_loss: 0.5645, label: 1, bag_size: 766
batch 399, loss: 1.3899, instance_loss: 0.4453, weighted_loss: 1.1065, label: 3, bag_size: 1076
batch 419, loss: 2.4169, instance_loss: 0.7304, weighted_loss: 1.9110, label: 0, bag_size: 888
batch 439, loss: 0.4239, instance_loss: 0.4021, weighted_loss: 0.4173, label: 4, bag_size: 773
batch 459, loss: 1.1206, instance_loss: 0.5280, weighted_loss: 0.9428, label: 0, bag_size: 247
batch 479, loss: 1.5465, instance_loss: 0.4719, weighted_loss: 1.2241, label: 3, bag_size: 1076
batch 499, loss: 1.1632, instance_loss: 0.5094, weighted_loss: 0.9671, label: 4, bag_size: 1077
batch 519, loss: 1.4702, instance_loss: 0.5619, weighted_loss: 1.1977, label: 4, bag_size: 652
batch 539, loss: 1.7123, instance_loss: 0.6046, weighted_loss: 1.3800, label: 2, bag_size: 512
batch 559, loss: 1.6011, instance_loss: 0.5972, weighted_loss: 1.3000, label: 1, bag_size: 159
batch 579, loss: 1.2479, instance_loss: 0.5843, weighted_loss: 1.0488, label: 1, bag_size: 490


class 0 clustering acc 0.9986531986531987: correct 23728/23760
class 1 clustering acc 0.015572390572390573: correct 74/4752
Epoch: 20, train_loss: 1.1758, train_clustering_loss:  0.4851, train_error: 0.4933
class 0: acc 0.8248175182481752, correct 113/137
class 1: acc 0.44545454545454544, correct 49/110
class 2: acc 0.29411764705882354, correct 30/102
class 3: acc 0.40458015267175573, correct 53/131
class 4: acc 0.49122807017543857, correct 56/114

Val Set, val_loss: 1.2984, val_error: 0.5946, auc: 0.7560
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1050, instance_loss: 0.4909, weighted_loss: 0.9208, label: 3, bag_size: 1154
batch 39, loss: 0.9839, instance_loss: 0.5991, weighted_loss: 0.8685, label: 2, bag_size: 286
batch 59, loss: 1.0104, instance_loss: 0.4957, weighted_loss: 0.8560, label: 4, bag_size: 960
batch 79, loss: 0.6029, instance_loss: 0.4471, weighted_loss: 0.5561, label: 3, bag_size: 674
batch 99, loss: 1.1621, instance_loss: 0.4556, weighted_loss: 0.9502, label: 1, bag_size: 1009
batch 119, loss: 1.3873, instance_loss: 0.6723, weighted_loss: 1.1728, label: 0, bag_size: 317
batch 139, loss: 2.6271, instance_loss: 0.6220, weighted_loss: 2.0256, label: 2, bag_size: 563
batch 159, loss: 0.7879, instance_loss: 0.4717, weighted_loss: 0.6931, label: 4, bag_size: 394
batch 179, loss: 0.8563, instance_loss: 0.4284, weighted_loss: 0.7279, label: 3, bag_size: 1060
batch 199, loss: 0.9097, instance_loss: 0.4528, weighted_loss: 0.7726, label: 3, bag_size: 235
batch 219, loss: 1.1768, instance_loss: 0.4725, weighted_loss: 0.9655, label: 2, bag_size: 783
batch 239, loss: 1.9514, instance_loss: 0.4913, weighted_loss: 1.5134, label: 2, bag_size: 720
batch 259, loss: 0.4104, instance_loss: 0.4041, weighted_loss: 0.4085, label: 4, bag_size: 1018
batch 279, loss: 1.1822, instance_loss: 0.4695, weighted_loss: 0.9684, label: 3, bag_size: 192
batch 299, loss: 0.5866, instance_loss: 0.4389, weighted_loss: 0.5423, label: 4, bag_size: 1018
batch 319, loss: 0.0260, instance_loss: 0.3041, weighted_loss: 0.1094, label: 0, bag_size: 51
batch 339, loss: 0.4143, instance_loss: 0.4297, weighted_loss: 0.4189, label: 0, bag_size: 343
batch 359, loss: 1.3756, instance_loss: 0.5579, weighted_loss: 1.1303, label: 0, bag_size: 1414
batch 379, loss: 1.2564, instance_loss: 0.5240, weighted_loss: 1.0367, label: 3, bag_size: 663
batch 399, loss: 1.2072, instance_loss: 0.5274, weighted_loss: 1.0033, label: 3, bag_size: 97
batch 419, loss: 0.6991, instance_loss: 0.4006, weighted_loss: 0.6096, label: 4, bag_size: 394
batch 439, loss: 1.1417, instance_loss: 0.4139, weighted_loss: 0.9234, label: 3, bag_size: 608
batch 459, loss: 0.2922, instance_loss: 0.4419, weighted_loss: 0.3371, label: 0, bag_size: 578
batch 479, loss: 1.9600, instance_loss: 0.4482, weighted_loss: 1.5065, label: 2, bag_size: 861
batch 499, loss: 1.6537, instance_loss: 0.5648, weighted_loss: 1.3270, label: 1, bag_size: 350
batch 519, loss: 0.9884, instance_loss: 0.4408, weighted_loss: 0.8241, label: 1, bag_size: 534
batch 539, loss: 1.1209, instance_loss: 0.4499, weighted_loss: 0.9196, label: 1, bag_size: 960
batch 559, loss: 0.9246, instance_loss: 0.4085, weighted_loss: 0.7698, label: 1, bag_size: 599
batch 579, loss: 0.7062, instance_loss: 0.4765, weighted_loss: 0.6373, label: 3, bag_size: 498


class 0 clustering acc 0.9982323232323232: correct 23718/23760
class 1 clustering acc 0.03009259259259259: correct 143/4752
Epoch: 21, train_loss: 1.1835, train_clustering_loss:  0.4835, train_error: 0.5236
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.33043478260869563, correct 38/115
class 2: acc 0.359375, correct 46/128
class 3: acc 0.38596491228070173, correct 44/114
class 4: acc 0.5, correct 58/116

Val Set, val_loss: 1.3008, val_error: 0.5811, auc: 0.7610
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.5989, instance_loss: 0.6183, weighted_loss: 1.3048, label: 3, bag_size: 393
batch 39, loss: 1.2783, instance_loss: 0.6473, weighted_loss: 1.0890, label: 1, bag_size: 44
batch 59, loss: 1.1858, instance_loss: 0.4534, weighted_loss: 0.9661, label: 1, bag_size: 525
batch 79, loss: 1.0761, instance_loss: 0.5170, weighted_loss: 0.9084, label: 2, bag_size: 998
batch 99, loss: 0.8056, instance_loss: 0.4470, weighted_loss: 0.6980, label: 3, bag_size: 830
batch 119, loss: 2.3796, instance_loss: 0.5516, weighted_loss: 1.8312, label: 3, bag_size: 282
batch 139, loss: 1.6099, instance_loss: 0.5586, weighted_loss: 1.2945, label: 1, bag_size: 658
batch 159, loss: 2.0653, instance_loss: 0.5632, weighted_loss: 1.6147, label: 1, bag_size: 231
batch 179, loss: 2.9637, instance_loss: 0.6141, weighted_loss: 2.2588, label: 4, bag_size: 160
batch 199, loss: 0.0093, instance_loss: 0.5211, weighted_loss: 0.1628, label: 2, bag_size: 553
batch 219, loss: 1.1677, instance_loss: 0.5526, weighted_loss: 0.9831, label: 4, bag_size: 714
batch 239, loss: 0.6852, instance_loss: 0.4483, weighted_loss: 0.6142, label: 4, bag_size: 775
batch 259, loss: 1.0409, instance_loss: 0.5020, weighted_loss: 0.8792, label: 2, bag_size: 906
batch 279, loss: 3.3266, instance_loss: 0.6340, weighted_loss: 2.5188, label: 3, bag_size: 403
batch 299, loss: 1.1104, instance_loss: 0.4945, weighted_loss: 0.9257, label: 3, bag_size: 194
batch 319, loss: 1.3735, instance_loss: 0.4661, weighted_loss: 1.1013, label: 2, bag_size: 258
batch 339, loss: 1.1873, instance_loss: 0.4271, weighted_loss: 0.9592, label: 1, bag_size: 1121
batch 359, loss: 1.2005, instance_loss: 0.5108, weighted_loss: 0.9936, label: 1, bag_size: 201
batch 379, loss: 1.8409, instance_loss: 0.5131, weighted_loss: 1.4426, label: 2, bag_size: 549
batch 399, loss: 0.9854, instance_loss: 0.4337, weighted_loss: 0.8199, label: 2, bag_size: 906
batch 419, loss: 0.4272, instance_loss: 0.4215, weighted_loss: 0.4255, label: 0, bag_size: 33
batch 439, loss: 0.8375, instance_loss: 0.4012, weighted_loss: 0.7066, label: 3, bag_size: 443
batch 459, loss: 1.1016, instance_loss: 0.4372, weighted_loss: 0.9023, label: 1, bag_size: 1013
batch 479, loss: 0.7276, instance_loss: 0.4667, weighted_loss: 0.6493, label: 3, bag_size: 566
batch 499, loss: 3.2317, instance_loss: 0.7362, weighted_loss: 2.4831, label: 0, bag_size: 352
batch 519, loss: 1.0696, instance_loss: 0.4978, weighted_loss: 0.8981, label: 4, bag_size: 868
batch 539, loss: 1.7625, instance_loss: 0.5275, weighted_loss: 1.3920, label: 3, bag_size: 781
batch 559, loss: 0.9848, instance_loss: 0.4864, weighted_loss: 0.8353, label: 2, bag_size: 706
batch 579, loss: 1.9647, instance_loss: 0.5057, weighted_loss: 1.5270, label: 4, bag_size: 482


class 0 clustering acc 0.9981902356902357: correct 23717/23760
class 1 clustering acc 0.0281986531986532: correct 134/4752
Epoch: 22, train_loss: 1.2242, train_clustering_loss:  0.4897, train_error: 0.5219
class 0: acc 0.7768595041322314, correct 94/121
class 1: acc 0.4186046511627907, correct 54/129
class 2: acc 0.275, correct 33/120
class 3: acc 0.4482758620689655, correct 52/116
class 4: acc 0.4722222222222222, correct 51/108

Val Set, val_loss: 1.2121, val_error: 0.5676, auc: 0.7862
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0538, instance_loss: 0.5114, weighted_loss: 0.8911, label: 2, bag_size: 906
batch 39, loss: 0.4471, instance_loss: 0.4669, weighted_loss: 0.4530, label: 3, bag_size: 818
batch 59, loss: 1.2353, instance_loss: 0.4879, weighted_loss: 1.0111, label: 1, bag_size: 177
batch 79, loss: 0.2460, instance_loss: 0.3882, weighted_loss: 0.2886, label: 2, bag_size: 1975
batch 99, loss: 0.9051, instance_loss: 0.4265, weighted_loss: 0.7615, label: 4, bag_size: 419
batch 119, loss: 0.8368, instance_loss: 0.4466, weighted_loss: 0.7197, label: 0, bag_size: 732
batch 139, loss: 1.3912, instance_loss: 0.5071, weighted_loss: 1.1260, label: 3, bag_size: 499
batch 159, loss: 0.5805, instance_loss: 0.5916, weighted_loss: 0.5838, label: 0, bag_size: 435
batch 179, loss: 2.3958, instance_loss: 0.5513, weighted_loss: 1.8424, label: 3, bag_size: 342
batch 199, loss: 1.3811, instance_loss: 0.5334, weighted_loss: 1.1268, label: 2, bag_size: 535
batch 219, loss: 0.5102, instance_loss: 0.5319, weighted_loss: 0.5167, label: 0, bag_size: 223
batch 239, loss: 1.1437, instance_loss: 0.4829, weighted_loss: 0.9454, label: 4, bag_size: 652
batch 259, loss: 0.9082, instance_loss: 0.4235, weighted_loss: 0.7628, label: 2, bag_size: 706
batch 279, loss: 0.0001, instance_loss: 0.3443, weighted_loss: 0.1033, label: 2, bag_size: 553
batch 299, loss: 1.3027, instance_loss: 0.4937, weighted_loss: 1.0600, label: 1, bag_size: 526
batch 319, loss: 1.3125, instance_loss: 0.5327, weighted_loss: 1.0786, label: 4, bag_size: 476
batch 339, loss: 0.6621, instance_loss: 0.4843, weighted_loss: 0.6088, label: 4, bag_size: 204
batch 359, loss: 2.6536, instance_loss: 0.5734, weighted_loss: 2.0295, label: 4, bag_size: 101
batch 379, loss: 0.1337, instance_loss: 0.3699, weighted_loss: 0.2045, label: 0, bag_size: 453
batch 399, loss: 1.2314, instance_loss: 0.4792, weighted_loss: 1.0058, label: 1, bag_size: 231
batch 419, loss: 0.8637, instance_loss: 0.4589, weighted_loss: 0.7422, label: 3, bag_size: 556
batch 439, loss: 1.4579, instance_loss: 0.6109, weighted_loss: 1.2038, label: 0, bag_size: 143
batch 459, loss: 1.0441, instance_loss: 0.4812, weighted_loss: 0.8752, label: 2, bag_size: 375
batch 479, loss: 1.4729, instance_loss: 0.4529, weighted_loss: 1.1669, label: 1, bag_size: 231
batch 499, loss: 0.7778, instance_loss: 0.4913, weighted_loss: 0.6919, label: 2, bag_size: 535
batch 519, loss: 0.9274, instance_loss: 0.4464, weighted_loss: 0.7831, label: 1, bag_size: 960
batch 539, loss: 0.0051, instance_loss: 0.2451, weighted_loss: 0.0771, label: 0, bag_size: 428
batch 559, loss: 0.8045, instance_loss: 0.4827, weighted_loss: 0.7080, label: 3, bag_size: 500
batch 579, loss: 0.7921, instance_loss: 0.5466, weighted_loss: 0.7184, label: 1, bag_size: 371


class 0 clustering acc 0.9986952861952862: correct 23729/23760
class 1 clustering acc 0.015151515151515152: correct 72/4752
Epoch: 23, train_loss: 1.2224, train_clustering_loss:  0.4938, train_error: 0.5286
class 0: acc 0.7368421052631579, correct 84/114
class 1: acc 0.4146341463414634, correct 51/123
class 2: acc 0.26666666666666666, correct 32/120
class 3: acc 0.5267175572519084, correct 69/131
class 4: acc 0.41509433962264153, correct 44/106

Val Set, val_loss: 1.1699, val_error: 0.5405, auc: 0.7916
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.198861 --> 1.169934).  Saving model ...


batch 19, loss: 1.0289, instance_loss: 0.5012, weighted_loss: 0.8706, label: 3, bag_size: 344
batch 39, loss: 1.0001, instance_loss: 0.4934, weighted_loss: 0.8481, label: 4, bag_size: 468
batch 59, loss: 0.0215, instance_loss: 0.5417, weighted_loss: 0.1776, label: 2, bag_size: 953
batch 79, loss: 1.2222, instance_loss: 0.4966, weighted_loss: 1.0045, label: 2, bag_size: 470
batch 99, loss: 1.1463, instance_loss: 0.4961, weighted_loss: 0.9512, label: 3, bag_size: 102
batch 119, loss: 0.8595, instance_loss: 0.4714, weighted_loss: 0.7431, label: 1, bag_size: 981
batch 139, loss: 1.2173, instance_loss: 0.5054, weighted_loss: 1.0038, label: 3, bag_size: 510
batch 159, loss: 1.5850, instance_loss: 0.6489, weighted_loss: 1.3042, label: 4, bag_size: 886
batch 179, loss: 0.0001, instance_loss: 0.1503, weighted_loss: 0.0452, label: 2, bag_size: 1608
batch 199, loss: 1.7302, instance_loss: 0.5499, weighted_loss: 1.3761, label: 1, bag_size: 398
batch 219, loss: 1.4001, instance_loss: 0.5326, weighted_loss: 1.1399, label: 3, bag_size: 858
batch 239, loss: 1.0711, instance_loss: 0.4845, weighted_loss: 0.8951, label: 2, bag_size: 119
batch 259, loss: 0.1918, instance_loss: 0.3247, weighted_loss: 0.2317, label: 0, bag_size: 393
batch 279, loss: 0.9428, instance_loss: 0.4491, weighted_loss: 0.7946, label: 3, bag_size: 309
batch 299, loss: 0.2442, instance_loss: 0.3816, weighted_loss: 0.2854, label: 0, bag_size: 397
batch 319, loss: 1.0200, instance_loss: 0.4421, weighted_loss: 0.8466, label: 4, bag_size: 419
batch 339, loss: 1.0335, instance_loss: 0.4358, weighted_loss: 0.8542, label: 1, bag_size: 525
batch 359, loss: 0.8994, instance_loss: 0.4410, weighted_loss: 0.7619, label: 3, bag_size: 615
batch 379, loss: 0.4746, instance_loss: 0.3888, weighted_loss: 0.4489, label: 3, bag_size: 403
batch 399, loss: 0.8762, instance_loss: 0.4588, weighted_loss: 0.7510, label: 4, bag_size: 960
batch 419, loss: 1.6865, instance_loss: 0.6123, weighted_loss: 1.3643, label: 2, bag_size: 860
batch 439, loss: 2.7912, instance_loss: 0.5326, weighted_loss: 2.1136, label: 1, bag_size: 184
batch 459, loss: 0.4345, instance_loss: 0.4740, weighted_loss: 0.4463, label: 4, bag_size: 773
batch 479, loss: 1.0539, instance_loss: 0.4072, weighted_loss: 0.8599, label: 1, bag_size: 372
batch 499, loss: 0.5051, instance_loss: 0.3814, weighted_loss: 0.4680, label: 4, bag_size: 875
batch 519, loss: 1.3416, instance_loss: 0.4956, weighted_loss: 1.0878, label: 3, bag_size: 533
batch 539, loss: 1.7747, instance_loss: 0.5688, weighted_loss: 1.4129, label: 0, bag_size: 169
batch 559, loss: 0.0399, instance_loss: 0.1923, weighted_loss: 0.0857, label: 0, bag_size: 79
batch 579, loss: 1.1422, instance_loss: 0.5510, weighted_loss: 0.9648, label: 2, bag_size: 1066


class 0 clustering acc 0.9984848484848485: correct 23724/23760
class 1 clustering acc 0.01914983164983165: correct 91/4752
Epoch: 24, train_loss: 1.1924, train_clustering_loss:  0.4913, train_error: 0.5067
class 0: acc 0.8203125, correct 105/128
class 1: acc 0.42735042735042733, correct 50/117
class 2: acc 0.3302752293577982, correct 36/109
class 3: acc 0.30701754385964913, correct 35/114
class 4: acc 0.5317460317460317, correct 67/126

Val Set, val_loss: 1.3777, val_error: 0.6081, auc: 0.7493
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.9285714285714286, correct 13/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8138, instance_loss: 0.4801, weighted_loss: 0.7137, label: 0, bag_size: 613
batch 39, loss: 1.5130, instance_loss: 0.5587, weighted_loss: 1.2267, label: 4, bag_size: 944
batch 59, loss: 1.1022, instance_loss: 0.4328, weighted_loss: 0.9014, label: 1, bag_size: 695
batch 79, loss: 1.1633, instance_loss: 0.4805, weighted_loss: 0.9585, label: 2, bag_size: 746
batch 99, loss: 0.8093, instance_loss: 0.4724, weighted_loss: 0.7082, label: 3, bag_size: 944
batch 119, loss: 0.5811, instance_loss: 0.4304, weighted_loss: 0.5359, label: 3, bag_size: 928
batch 139, loss: 0.1285, instance_loss: 0.2741, weighted_loss: 0.1722, label: 0, bag_size: 453
batch 159, loss: 0.7368, instance_loss: 0.4766, weighted_loss: 0.6588, label: 3, bag_size: 897
batch 179, loss: 1.6696, instance_loss: 0.4798, weighted_loss: 1.3127, label: 3, bag_size: 428
batch 199, loss: 2.3111, instance_loss: 0.6003, weighted_loss: 1.7978, label: 4, bag_size: 333
batch 219, loss: 1.7070, instance_loss: 0.5222, weighted_loss: 1.3516, label: 1, bag_size: 614
batch 239, loss: 0.1149, instance_loss: 0.3818, weighted_loss: 0.1950, label: 0, bag_size: 33
batch 259, loss: 1.0676, instance_loss: 0.5676, weighted_loss: 0.9176, label: 0, bag_size: 143
batch 279, loss: 1.0489, instance_loss: 0.4902, weighted_loss: 0.8813, label: 4, bag_size: 886
batch 299, loss: 0.8091, instance_loss: 0.4672, weighted_loss: 0.7065, label: 3, bag_size: 258
batch 319, loss: 1.6966, instance_loss: 0.6601, weighted_loss: 1.3856, label: 1, bag_size: 159
batch 339, loss: 1.0157, instance_loss: 0.4995, weighted_loss: 0.8608, label: 2, bag_size: 769
batch 359, loss: 2.6481, instance_loss: 0.5473, weighted_loss: 2.0179, label: 0, bag_size: 1085
batch 379, loss: 1.4820, instance_loss: 0.6169, weighted_loss: 1.2225, label: 1, bag_size: 159
batch 399, loss: 0.9220, instance_loss: 0.5216, weighted_loss: 0.8019, label: 1, bag_size: 419
batch 419, loss: 0.2856, instance_loss: 0.4448, weighted_loss: 0.3333, label: 4, bag_size: 773
batch 439, loss: 0.6848, instance_loss: 0.3441, weighted_loss: 0.5826, label: 4, bag_size: 482
batch 459, loss: 0.7614, instance_loss: 0.4664, weighted_loss: 0.6729, label: 1, bag_size: 355
batch 479, loss: 2.2520, instance_loss: 0.5961, weighted_loss: 1.7552, label: 3, bag_size: 166
batch 499, loss: 0.9391, instance_loss: 0.4797, weighted_loss: 0.8013, label: 3, bag_size: 556
batch 519, loss: 0.9588, instance_loss: 0.5434, weighted_loss: 0.8342, label: 3, bag_size: 282
batch 539, loss: 0.0152, instance_loss: 0.2440, weighted_loss: 0.0839, label: 0, bag_size: 51
batch 559, loss: 1.0360, instance_loss: 0.4463, weighted_loss: 0.8591, label: 3, bag_size: 608
batch 579, loss: 0.8412, instance_loss: 0.4738, weighted_loss: 0.7310, label: 3, bag_size: 498


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.04861111111111111: correct 231/4752
Epoch: 25, train_loss: 1.1792, train_clustering_loss:  0.4867, train_error: 0.5337
class 0: acc 0.8372093023255814, correct 108/129
class 1: acc 0.3728813559322034, correct 44/118
class 2: acc 0.2605042016806723, correct 31/119
class 3: acc 0.3333333333333333, correct 39/117
class 4: acc 0.4954954954954955, correct 55/111

Val Set, val_loss: 1.2102, val_error: 0.5405, auc: 0.7884
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.03209459459459459: correct 19/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0415, instance_loss: 0.4961, weighted_loss: 0.8779, label: 4, bag_size: 590
batch 39, loss: 1.2560, instance_loss: 0.4723, weighted_loss: 1.0209, label: 0, bag_size: 317
batch 59, loss: 0.2780, instance_loss: 0.4041, weighted_loss: 0.3158, label: 0, bag_size: 295
batch 79, loss: 1.3062, instance_loss: 0.5318, weighted_loss: 1.0739, label: 1, bag_size: 1082
batch 99, loss: 1.1748, instance_loss: 0.4451, weighted_loss: 0.9559, label: 1, bag_size: 328
batch 119, loss: 0.5528, instance_loss: 0.3759, weighted_loss: 0.4997, label: 1, bag_size: 748
batch 139, loss: 1.4659, instance_loss: 0.6137, weighted_loss: 1.2102, label: 1, bag_size: 161
batch 159, loss: 1.2808, instance_loss: 0.5025, weighted_loss: 1.0473, label: 4, bag_size: 868
batch 179, loss: 0.0307, instance_loss: 0.2841, weighted_loss: 0.1068, label: 0, bag_size: 58
batch 199, loss: 1.4450, instance_loss: 0.4917, weighted_loss: 1.1590, label: 4, bag_size: 377
batch 219, loss: 1.5705, instance_loss: 0.4372, weighted_loss: 1.2305, label: 3, bag_size: 899
batch 239, loss: 1.2252, instance_loss: 0.5122, weighted_loss: 1.0113, label: 2, bag_size: 633
batch 259, loss: 1.3762, instance_loss: 0.5416, weighted_loss: 1.1258, label: 4, bag_size: 729
batch 279, loss: 1.9942, instance_loss: 0.6191, weighted_loss: 1.5817, label: 0, bag_size: 81
batch 299, loss: 0.9441, instance_loss: 0.5432, weighted_loss: 0.8238, label: 2, bag_size: 385
batch 319, loss: 0.7322, instance_loss: 0.3789, weighted_loss: 0.6262, label: 2, bag_size: 290
batch 339, loss: 0.2665, instance_loss: 0.3600, weighted_loss: 0.2946, label: 0, bag_size: 306
batch 359, loss: 1.5469, instance_loss: 0.5163, weighted_loss: 1.2377, label: 1, bag_size: 658
batch 379, loss: 2.6203, instance_loss: 0.5472, weighted_loss: 1.9984, label: 3, bag_size: 543
batch 399, loss: 0.9950, instance_loss: 0.4317, weighted_loss: 0.8260, label: 1, bag_size: 483
batch 419, loss: 1.6121, instance_loss: 0.5205, weighted_loss: 1.2846, label: 1, bag_size: 823
batch 439, loss: 0.0566, instance_loss: 0.2769, weighted_loss: 0.1227, label: 0, bag_size: 98
batch 459, loss: 0.8597, instance_loss: 0.5459, weighted_loss: 0.7656, label: 3, bag_size: 684
batch 479, loss: 0.9066, instance_loss: 0.4735, weighted_loss: 0.7767, label: 2, bag_size: 350
batch 499, loss: 2.1614, instance_loss: 0.5621, weighted_loss: 1.6816, label: 2, bag_size: 837
batch 519, loss: 1.1875, instance_loss: 0.4615, weighted_loss: 0.9697, label: 3, bag_size: 681
batch 539, loss: 1.2463, instance_loss: 0.4678, weighted_loss: 1.0127, label: 1, bag_size: 544
batch 559, loss: 0.0584, instance_loss: 0.3643, weighted_loss: 0.1501, label: 0, bag_size: 234
batch 579, loss: 1.2828, instance_loss: 0.4634, weighted_loss: 1.0370, label: 1, bag_size: 634


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.02861952861952862: correct 136/4752
Epoch: 26, train_loss: 1.1456, train_clustering_loss:  0.4878, train_error: 0.4916
class 0: acc 0.792, correct 99/125
class 1: acc 0.3524590163934426, correct 43/122
class 2: acc 0.4247787610619469, correct 48/113
class 3: acc 0.4715447154471545, correct 58/123
class 4: acc 0.4864864864864865, correct 54/111

Val Set, val_loss: 1.2262, val_error: 0.5405, auc: 0.7818
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4003, instance_loss: 0.5347, weighted_loss: 1.1406, label: 3, bag_size: 631
batch 39, loss: 0.9311, instance_loss: 0.5063, weighted_loss: 0.8036, label: 4, bag_size: 263
batch 59, loss: 1.0454, instance_loss: 0.4944, weighted_loss: 0.8801, label: 2, bag_size: 288
batch 79, loss: 1.9638, instance_loss: 0.5314, weighted_loss: 1.5341, label: 4, bag_size: 685
batch 99, loss: 1.5524, instance_loss: 0.5797, weighted_loss: 1.2606, label: 1, bag_size: 381
batch 119, loss: 0.2045, instance_loss: 0.3225, weighted_loss: 0.2399, label: 4, bag_size: 773
batch 139, loss: 2.7478, instance_loss: 0.7466, weighted_loss: 2.1474, label: 0, bag_size: 1414
batch 159, loss: 0.1278, instance_loss: 0.3477, weighted_loss: 0.1938, label: 0, bag_size: 71
batch 179, loss: 0.9714, instance_loss: 0.4612, weighted_loss: 0.8184, label: 4, bag_size: 712
batch 199, loss: 0.0412, instance_loss: 0.4066, weighted_loss: 0.1508, label: 0, bag_size: 533
batch 219, loss: 0.6814, instance_loss: 0.4103, weighted_loss: 0.6001, label: 2, bag_size: 445
batch 239, loss: 1.0222, instance_loss: 0.5206, weighted_loss: 0.8717, label: 3, bag_size: 1007
batch 259, loss: 1.4925, instance_loss: 0.5419, weighted_loss: 1.2073, label: 3, bag_size: 282
batch 279, loss: 1.0687, instance_loss: 0.5208, weighted_loss: 0.9043, label: 4, bag_size: 342
batch 299, loss: 0.9524, instance_loss: 0.3367, weighted_loss: 0.7677, label: 4, bag_size: 780
batch 319, loss: 1.1207, instance_loss: 0.5270, weighted_loss: 0.9426, label: 4, bag_size: 419
batch 339, loss: 0.0860, instance_loss: 0.3282, weighted_loss: 0.1587, label: 0, bag_size: 49
batch 359, loss: 1.6097, instance_loss: 0.6204, weighted_loss: 1.3129, label: 1, bag_size: 634
batch 379, loss: 0.0208, instance_loss: 0.3000, weighted_loss: 0.1045, label: 0, bag_size: 428
batch 399, loss: 0.8347, instance_loss: 0.4819, weighted_loss: 0.7289, label: 0, bag_size: 306
batch 419, loss: 0.7466, instance_loss: 0.4970, weighted_loss: 0.6717, label: 2, bag_size: 998
batch 439, loss: 3.2435, instance_loss: 0.5661, weighted_loss: 2.4403, label: 3, bag_size: 508
batch 459, loss: 1.4064, instance_loss: 0.5105, weighted_loss: 1.1376, label: 1, bag_size: 391
batch 479, loss: 1.2642, instance_loss: 0.4659, weighted_loss: 1.0247, label: 1, bag_size: 617
batch 499, loss: 0.9333, instance_loss: 0.4604, weighted_loss: 0.7915, label: 3, bag_size: 309
batch 519, loss: 2.9451, instance_loss: 0.7089, weighted_loss: 2.2742, label: 0, bag_size: 600
batch 539, loss: 1.1405, instance_loss: 0.4733, weighted_loss: 0.9403, label: 3, bag_size: 344
batch 559, loss: 1.5148, instance_loss: 0.4610, weighted_loss: 1.1987, label: 1, bag_size: 339
batch 579, loss: 1.0561, instance_loss: 0.5104, weighted_loss: 0.8924, label: 3, bag_size: 97


class 0 clustering acc 0.9984848484848485: correct 23724/23760
class 1 clustering acc 0.027567340067340067: correct 131/4752
Epoch: 27, train_loss: 1.1670, train_clustering_loss:  0.4911, train_error: 0.5202
class 0: acc 0.7798165137614679, correct 85/109
class 1: acc 0.23300970873786409, correct 24/103
class 2: acc 0.45081967213114754, correct 55/122
class 3: acc 0.3875968992248062, correct 50/129
class 4: acc 0.5419847328244275, correct 71/131

Val Set, val_loss: 1.1834, val_error: 0.5135, auc: 0.7890
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8329, instance_loss: 0.4513, weighted_loss: 0.7184, label: 3, bag_size: 817
batch 39, loss: 1.1994, instance_loss: 0.4492, weighted_loss: 0.9744, label: 2, bag_size: 367
batch 59, loss: 1.1041, instance_loss: 0.4081, weighted_loss: 0.8953, label: 1, bag_size: 272
batch 79, loss: 1.9096, instance_loss: 0.5179, weighted_loss: 1.4921, label: 4, bag_size: 160
batch 99, loss: 0.7075, instance_loss: 0.4841, weighted_loss: 0.6404, label: 4, bag_size: 776
batch 119, loss: 0.8256, instance_loss: 0.4280, weighted_loss: 0.7063, label: 3, bag_size: 476
batch 139, loss: 1.4459, instance_loss: 0.5183, weighted_loss: 1.1676, label: 2, bag_size: 105
batch 159, loss: 1.3919, instance_loss: 0.4687, weighted_loss: 1.1150, label: 3, bag_size: 337
batch 179, loss: 0.7646, instance_loss: 0.4557, weighted_loss: 0.6719, label: 4, bag_size: 489
batch 199, loss: 1.3986, instance_loss: 0.4709, weighted_loss: 1.1203, label: 2, bag_size: 627
batch 219, loss: 0.0000, instance_loss: 0.3511, weighted_loss: 0.1053, label: 1, bag_size: 669
batch 239, loss: 1.5934, instance_loss: 0.6160, weighted_loss: 1.3002, label: 4, bag_size: 1031
batch 259, loss: 1.2115, instance_loss: 0.4574, weighted_loss: 0.9853, label: 1, bag_size: 233
batch 279, loss: 0.7975, instance_loss: 0.5283, weighted_loss: 0.7167, label: 1, bag_size: 1082
batch 299, loss: 1.9632, instance_loss: 0.5869, weighted_loss: 1.5503, label: 2, bag_size: 861
batch 319, loss: 3.7336, instance_loss: 0.7081, weighted_loss: 2.8260, label: 1, bag_size: 44
batch 339, loss: 1.0526, instance_loss: 0.4843, weighted_loss: 0.8821, label: 2, bag_size: 598
batch 359, loss: 0.5088, instance_loss: 0.3916, weighted_loss: 0.4736, label: 4, bag_size: 875
batch 379, loss: 0.0000, instance_loss: 0.4740, weighted_loss: 0.1422, label: 2, bag_size: 936
batch 399, loss: 1.3167, instance_loss: 0.5375, weighted_loss: 1.0829, label: 0, bag_size: 224
batch 419, loss: 0.7059, instance_loss: 0.3349, weighted_loss: 0.5946, label: 4, bag_size: 875
batch 439, loss: 4.5594, instance_loss: 0.7370, weighted_loss: 3.4126, label: 0, bag_size: 273
batch 459, loss: 0.8204, instance_loss: 0.3891, weighted_loss: 0.6910, label: 1, bag_size: 413
batch 479, loss: 0.9309, instance_loss: 0.4580, weighted_loss: 0.7890, label: 1, bag_size: 617
batch 499, loss: 0.0002, instance_loss: 0.2858, weighted_loss: 0.0859, label: 0, bag_size: 428
batch 519, loss: 0.9940, instance_loss: 0.5660, weighted_loss: 0.8656, label: 0, bag_size: 62
batch 539, loss: 1.7505, instance_loss: 0.5074, weighted_loss: 1.3776, label: 1, bag_size: 607
batch 559, loss: 0.6165, instance_loss: 0.4993, weighted_loss: 0.5814, label: 2, bag_size: 421
batch 579, loss: 1.1406, instance_loss: 0.4394, weighted_loss: 0.9303, label: 1, bag_size: 231


class 0 clustering acc 0.998442760942761: correct 23723/23760
class 1 clustering acc 0.0484006734006734: correct 230/4752
Epoch: 28, train_loss: 1.0852, train_clustering_loss:  0.4720, train_error: 0.4646
class 0: acc 0.8449612403100775, correct 109/129
class 1: acc 0.5703125, correct 73/128
class 2: acc 0.23684210526315788, correct 27/114
class 3: acc 0.38596491228070173, correct 44/114
class 4: acc 0.5963302752293578, correct 65/109

Val Set, val_loss: 1.1656, val_error: 0.4865, auc: 0.7885
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.169934 --> 1.165551).  Saving model ...


batch 19, loss: 0.3943, instance_loss: 0.4094, weighted_loss: 0.3988, label: 0, bag_size: 141
batch 39, loss: 0.0298, instance_loss: 0.3444, weighted_loss: 0.1242, label: 0, bag_size: 234
batch 59, loss: 0.9659, instance_loss: 0.4377, weighted_loss: 0.8074, label: 4, bag_size: 714
batch 79, loss: 0.4046, instance_loss: 0.3106, weighted_loss: 0.3764, label: 2, bag_size: 1975
batch 99, loss: 2.2821, instance_loss: 0.5507, weighted_loss: 1.7627, label: 3, bag_size: 166
batch 119, loss: 0.9610, instance_loss: 0.4477, weighted_loss: 0.8070, label: 3, bag_size: 192
batch 139, loss: 1.2888, instance_loss: 0.5041, weighted_loss: 1.0534, label: 4, bag_size: 263
batch 159, loss: 0.6690, instance_loss: 0.3671, weighted_loss: 0.5784, label: 4, bag_size: 948
batch 179, loss: 1.7481, instance_loss: 0.4901, weighted_loss: 1.3707, label: 1, bag_size: 184
batch 199, loss: 1.2341, instance_loss: 0.5473, weighted_loss: 1.0280, label: 3, bag_size: 300
batch 219, loss: 1.3401, instance_loss: 0.4558, weighted_loss: 1.0748, label: 3, bag_size: 1328
batch 239, loss: 0.0133, instance_loss: 0.4537, weighted_loss: 0.1454, label: 4, bag_size: 530
batch 259, loss: 1.2674, instance_loss: 0.5867, weighted_loss: 1.0632, label: 2, bag_size: 288
batch 279, loss: 1.1467, instance_loss: 0.4609, weighted_loss: 0.9410, label: 3, bag_size: 1154
batch 299, loss: 1.1395, instance_loss: 0.4145, weighted_loss: 0.9220, label: 3, bag_size: 499
batch 319, loss: 1.0198, instance_loss: 0.4244, weighted_loss: 0.8411, label: 2, bag_size: 369
batch 339, loss: 0.9082, instance_loss: 0.4758, weighted_loss: 0.7785, label: 1, bag_size: 766
batch 359, loss: 1.9247, instance_loss: 0.4627, weighted_loss: 1.4861, label: 2, bag_size: 394
batch 379, loss: 0.7936, instance_loss: 0.6063, weighted_loss: 0.7374, label: 0, bag_size: 416
batch 399, loss: 0.9687, instance_loss: 0.4143, weighted_loss: 0.8024, label: 3, bag_size: 499
batch 419, loss: 1.0839, instance_loss: 0.4721, weighted_loss: 0.9004, label: 4, bag_size: 853
batch 439, loss: 1.6017, instance_loss: 0.5068, weighted_loss: 1.2733, label: 2, bag_size: 421
batch 459, loss: 0.5305, instance_loss: 0.4893, weighted_loss: 0.5181, label: 2, bag_size: 1016
batch 479, loss: 0.5805, instance_loss: 0.4400, weighted_loss: 0.5384, label: 2, bag_size: 1079
batch 499, loss: 0.8042, instance_loss: 0.4832, weighted_loss: 0.7079, label: 4, bag_size: 489
batch 519, loss: 0.0081, instance_loss: 0.2213, weighted_loss: 0.0721, label: 0, bag_size: 230
batch 539, loss: 3.0501, instance_loss: 0.6913, weighted_loss: 2.3425, label: 3, bag_size: 638
batch 559, loss: 1.5350, instance_loss: 0.5199, weighted_loss: 1.2305, label: 1, bag_size: 201
batch 579, loss: 1.6125, instance_loss: 0.5069, weighted_loss: 1.2808, label: 2, bag_size: 361


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.04713804713804714: correct 224/4752
Epoch: 29, train_loss: 1.1453, train_clustering_loss:  0.4872, train_error: 0.4882
class 0: acc 0.7874015748031497, correct 100/127
class 1: acc 0.41509433962264153, correct 44/106
class 2: acc 0.3783783783783784, correct 42/111
class 3: acc 0.553030303030303, correct 73/132
class 4: acc 0.3813559322033898, correct 45/118

Val Set, val_loss: 1.1850, val_error: 0.5270, auc: 0.7986
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6574, instance_loss: 0.5476, weighted_loss: 0.6245, label: 4, bag_size: 730
batch 39, loss: 0.2905, instance_loss: 0.4569, weighted_loss: 0.3404, label: 0, bag_size: 49
batch 59, loss: 1.5283, instance_loss: 0.5380, weighted_loss: 1.2312, label: 2, bag_size: 627
batch 79, loss: 1.2903, instance_loss: 0.5485, weighted_loss: 1.0678, label: 0, bag_size: 247
batch 99, loss: 0.5376, instance_loss: 0.5294, weighted_loss: 0.5351, label: 4, bag_size: 129
batch 119, loss: 3.8716, instance_loss: 0.7147, weighted_loss: 2.9245, label: 2, bag_size: 219
batch 139, loss: 2.0917, instance_loss: 0.5764, weighted_loss: 1.6371, label: 2, bag_size: 754
batch 159, loss: 1.7184, instance_loss: 0.5814, weighted_loss: 1.3773, label: 0, bag_size: 77
batch 179, loss: 1.3420, instance_loss: 0.4435, weighted_loss: 1.0725, label: 1, bag_size: 960
batch 199, loss: 1.0024, instance_loss: 0.5572, weighted_loss: 0.8688, label: 2, bag_size: 821
batch 219, loss: 0.1333, instance_loss: 0.3057, weighted_loss: 0.1850, label: 0, bag_size: 399
batch 239, loss: 2.0483, instance_loss: 0.4835, weighted_loss: 1.5789, label: 0, bag_size: 745
batch 259, loss: 1.2833, instance_loss: 0.4572, weighted_loss: 1.0355, label: 4, bag_size: 572
batch 279, loss: 2.1309, instance_loss: 0.5858, weighted_loss: 1.6674, label: 3, bag_size: 556
batch 299, loss: 3.0819, instance_loss: 0.6422, weighted_loss: 2.3500, label: 2, bag_size: 720
batch 319, loss: 0.8911, instance_loss: 0.5122, weighted_loss: 0.7775, label: 3, bag_size: 817
batch 339, loss: 0.4350, instance_loss: 0.4535, weighted_loss: 0.4406, label: 1, bag_size: 460
batch 359, loss: 1.3402, instance_loss: 0.5342, weighted_loss: 1.0984, label: 3, bag_size: 523
batch 379, loss: 2.8110, instance_loss: 0.6569, weighted_loss: 2.1648, label: 0, bag_size: 115
batch 399, loss: 1.0954, instance_loss: 0.4321, weighted_loss: 0.8964, label: 4, bag_size: 476
batch 419, loss: 0.0848, instance_loss: 0.3348, weighted_loss: 0.1598, label: 0, bag_size: 98
batch 439, loss: 1.4273, instance_loss: 0.4421, weighted_loss: 1.1317, label: 4, bag_size: 176
batch 459, loss: 1.7265, instance_loss: 0.5099, weighted_loss: 1.3615, label: 1, bag_size: 607
batch 479, loss: 0.7756, instance_loss: 0.4668, weighted_loss: 0.6830, label: 1, bag_size: 141
batch 499, loss: 0.8139, instance_loss: 0.4063, weighted_loss: 0.6916, label: 4, bag_size: 1077
batch 519, loss: 2.0088, instance_loss: 0.5962, weighted_loss: 1.5851, label: 2, bag_size: 998
batch 539, loss: 1.5251, instance_loss: 0.5542, weighted_loss: 1.2338, label: 3, bag_size: 1284
batch 559, loss: 1.4839, instance_loss: 0.4503, weighted_loss: 1.1738, label: 1, bag_size: 1121
batch 579, loss: 0.8796, instance_loss: 0.4549, weighted_loss: 0.7522, label: 1, bag_size: 311


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.027777777777777776: correct 132/4752
Epoch: 30, train_loss: 1.1399, train_clustering_loss:  0.4874, train_error: 0.4966
class 0: acc 0.7868852459016393, correct 96/122
class 1: acc 0.4827586206896552, correct 56/116
class 2: acc 0.21052631578947367, correct 20/95
class 3: acc 0.38095238095238093, correct 48/126
class 4: acc 0.5851851851851851, correct 79/135

Val Set, val_loss: 1.1826, val_error: 0.5270, auc: 0.8015
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 1.0, correct 16/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2597, instance_loss: 0.4750, weighted_loss: 1.0243, label: 2, bag_size: 290
batch 39, loss: 0.6286, instance_loss: 0.4791, weighted_loss: 0.5838, label: 4, bag_size: 689
batch 59, loss: 0.5617, instance_loss: 0.4402, weighted_loss: 0.5253, label: 0, bag_size: 76
batch 79, loss: 2.3223, instance_loss: 0.5869, weighted_loss: 1.8017, label: 3, bag_size: 492
batch 99, loss: 1.0194, instance_loss: 0.4648, weighted_loss: 0.8530, label: 2, bag_size: 754
batch 119, loss: 1.6688, instance_loss: 0.5459, weighted_loss: 1.3319, label: 2, bag_size: 390
batch 139, loss: 0.5140, instance_loss: 0.5000, weighted_loss: 0.5098, label: 4, bag_size: 742
batch 159, loss: 0.1847, instance_loss: 0.3752, weighted_loss: 0.2419, label: 0, bag_size: 238
batch 179, loss: 0.5491, instance_loss: 0.3920, weighted_loss: 0.5020, label: 0, bag_size: 428
batch 199, loss: 1.7007, instance_loss: 0.5862, weighted_loss: 1.3663, label: 0, bag_size: 311
batch 219, loss: 0.8184, instance_loss: 0.4386, weighted_loss: 0.7045, label: 1, bag_size: 886
batch 239, loss: 1.0208, instance_loss: 0.5229, weighted_loss: 0.8714, label: 2, bag_size: 286
batch 259, loss: 0.0940, instance_loss: 0.2959, weighted_loss: 0.1546, label: 2, bag_size: 1608
batch 279, loss: 1.0533, instance_loss: 0.4775, weighted_loss: 0.8806, label: 4, bag_size: 726
batch 299, loss: 0.7748, instance_loss: 0.5838, weighted_loss: 0.7175, label: 0, bag_size: 455
batch 319, loss: 0.8703, instance_loss: 0.4165, weighted_loss: 0.7342, label: 1, bag_size: 500
batch 339, loss: 1.3694, instance_loss: 0.5750, weighted_loss: 1.1311, label: 2, bag_size: 303
batch 359, loss: 0.6635, instance_loss: 0.3808, weighted_loss: 0.5787, label: 1, bag_size: 1104
batch 379, loss: 1.8423, instance_loss: 0.5952, weighted_loss: 1.4682, label: 2, bag_size: 1319
batch 399, loss: 1.4042, instance_loss: 0.5630, weighted_loss: 1.1518, label: 0, bag_size: 428
batch 419, loss: 1.4711, instance_loss: 0.5116, weighted_loss: 1.1833, label: 2, bag_size: 821
batch 439, loss: 0.7734, instance_loss: 0.4450, weighted_loss: 0.6749, label: 1, bag_size: 960
batch 459, loss: 1.9679, instance_loss: 0.4910, weighted_loss: 1.5248, label: 1, bag_size: 339
batch 479, loss: 0.6258, instance_loss: 0.3883, weighted_loss: 0.5546, label: 4, bag_size: 218
batch 499, loss: 1.0040, instance_loss: 0.5279, weighted_loss: 0.8611, label: 3, bag_size: 192
batch 519, loss: 1.2317, instance_loss: 0.4640, weighted_loss: 1.0014, label: 3, bag_size: 344
batch 539, loss: 1.4892, instance_loss: 0.5256, weighted_loss: 1.2001, label: 2, bag_size: 934
batch 559, loss: 1.8043, instance_loss: 0.5462, weighted_loss: 1.4269, label: 1, bag_size: 350
batch 579, loss: 0.8965, instance_loss: 0.4949, weighted_loss: 0.7760, label: 2, bag_size: 371


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.02798821548821549: correct 133/4752
Epoch: 31, train_loss: 1.1264, train_clustering_loss:  0.4871, train_error: 0.4933
class 0: acc 0.7739130434782608, correct 89/115
class 1: acc 0.5507246376811594, correct 76/138
class 2: acc 0.24561403508771928, correct 28/114
class 3: acc 0.37735849056603776, correct 40/106
class 4: acc 0.5619834710743802, correct 68/121

Val Set, val_loss: 1.1885, val_error: 0.5135, auc: 0.7918
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.060810810810810814: correct 36/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0039, instance_loss: 0.2280, weighted_loss: 0.0711, label: 0, bag_size: 340
batch 39, loss: 1.6581, instance_loss: 0.4880, weighted_loss: 1.3070, label: 3, bag_size: 899
batch 59, loss: 0.1943, instance_loss: 0.5170, weighted_loss: 0.2911, label: 0, bag_size: 732
batch 79, loss: 1.1580, instance_loss: 0.4454, weighted_loss: 0.9442, label: 2, bag_size: 522
batch 99, loss: 0.8727, instance_loss: 0.4803, weighted_loss: 0.7550, label: 2, bag_size: 567
batch 119, loss: 1.0282, instance_loss: 0.4433, weighted_loss: 0.8527, label: 2, bag_size: 290
batch 139, loss: 0.6084, instance_loss: 0.3691, weighted_loss: 0.5366, label: 1, bag_size: 886
batch 159, loss: 1.3143, instance_loss: 0.4579, weighted_loss: 1.0574, label: 4, bag_size: 312
batch 179, loss: 2.8111, instance_loss: 0.5504, weighted_loss: 2.1329, label: 4, bag_size: 699
batch 199, loss: 0.0361, instance_loss: 0.2660, weighted_loss: 0.1051, label: 0, bag_size: 212
batch 219, loss: 1.0371, instance_loss: 0.7629, weighted_loss: 0.9548, label: 3, bag_size: 794
batch 239, loss: 1.0452, instance_loss: 0.4622, weighted_loss: 0.8703, label: 1, bag_size: 697
batch 259, loss: 0.0002, instance_loss: 0.2900, weighted_loss: 0.0871, label: 2, bag_size: 596
batch 279, loss: 1.3991, instance_loss: 0.4653, weighted_loss: 1.1189, label: 3, bag_size: 996
batch 299, loss: 0.6008, instance_loss: 0.4927, weighted_loss: 0.5684, label: 4, bag_size: 960
batch 319, loss: 0.1824, instance_loss: 0.4348, weighted_loss: 0.2581, label: 0, bag_size: 159
batch 339, loss: 0.3810, instance_loss: 0.3765, weighted_loss: 0.3797, label: 3, bag_size: 780
batch 359, loss: 1.1116, instance_loss: 0.5449, weighted_loss: 0.9416, label: 0, bag_size: 178
batch 379, loss: 1.1460, instance_loss: 0.3890, weighted_loss: 0.9189, label: 1, bag_size: 1009
batch 399, loss: 0.7466, instance_loss: 0.5145, weighted_loss: 0.6770, label: 3, bag_size: 1078
batch 419, loss: 1.1092, instance_loss: 0.5259, weighted_loss: 0.9342, label: 2, bag_size: 558
batch 439, loss: 0.7457, instance_loss: 0.4618, weighted_loss: 0.6605, label: 3, bag_size: 322
batch 459, loss: 1.3063, instance_loss: 0.7284, weighted_loss: 1.1329, label: 2, bag_size: 96
batch 479, loss: 2.2553, instance_loss: 0.6909, weighted_loss: 1.7860, label: 2, bag_size: 297
batch 499, loss: 0.0868, instance_loss: 0.3360, weighted_loss: 0.1615, label: 0, bag_size: 133
batch 519, loss: 1.6422, instance_loss: 0.5275, weighted_loss: 1.3078, label: 3, bag_size: 344
batch 539, loss: 0.9971, instance_loss: 0.5477, weighted_loss: 0.8623, label: 3, bag_size: 344
batch 559, loss: 1.7520, instance_loss: 0.6299, weighted_loss: 1.4153, label: 4, bag_size: 1031
batch 579, loss: 0.8267, instance_loss: 0.5313, weighted_loss: 0.7381, label: 4, bag_size: 886


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.02988215488215488: correct 142/4752
Epoch: 32, train_loss: 1.1298, train_clustering_loss:  0.4877, train_error: 0.4798
class 0: acc 0.8205128205128205, correct 96/117
class 1: acc 0.5409836065573771, correct 66/122
class 2: acc 0.2782608695652174, correct 32/115
class 3: acc 0.40336134453781514, correct 48/119
class 4: acc 0.5537190082644629, correct 67/121

Val Set, val_loss: 1.2152, val_error: 0.5270, auc: 0.7846
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.2441, instance_loss: 0.6811, weighted_loss: 1.7752, label: 2, bag_size: 576
batch 39, loss: 0.7206, instance_loss: 0.4561, weighted_loss: 0.6412, label: 2, bag_size: 558
batch 59, loss: 0.7529, instance_loss: 0.5735, weighted_loss: 0.6991, label: 4, bag_size: 1018
batch 79, loss: 1.0397, instance_loss: 0.4420, weighted_loss: 0.8604, label: 4, bag_size: 695
batch 99, loss: 1.3472, instance_loss: 0.5034, weighted_loss: 1.0941, label: 1, bag_size: 398
batch 119, loss: 1.2268, instance_loss: 0.5134, weighted_loss: 1.0128, label: 4, bag_size: 590
batch 139, loss: 0.3002, instance_loss: 0.4474, weighted_loss: 0.3444, label: 0, bag_size: 227
batch 159, loss: 0.0332, instance_loss: 0.2619, weighted_loss: 0.1018, label: 0, bag_size: 255
batch 179, loss: 1.2977, instance_loss: 0.4571, weighted_loss: 1.0455, label: 1, bag_size: 208
batch 199, loss: 0.0281, instance_loss: 0.3781, weighted_loss: 0.1331, label: 0, bag_size: 58
batch 219, loss: 0.5409, instance_loss: 0.3985, weighted_loss: 0.4982, label: 3, bag_size: 322
batch 239, loss: 2.0855, instance_loss: 0.5147, weighted_loss: 1.6143, label: 3, bag_size: 166
batch 259, loss: 1.0908, instance_loss: 0.4845, weighted_loss: 0.9089, label: 3, bag_size: 523
batch 279, loss: 0.9980, instance_loss: 0.4544, weighted_loss: 0.8349, label: 1, bag_size: 413
batch 299, loss: 1.2240, instance_loss: 0.5073, weighted_loss: 1.0090, label: 3, bag_size: 857
batch 319, loss: 0.0109, instance_loss: 0.1748, weighted_loss: 0.0601, label: 0, bag_size: 255
batch 339, loss: 0.0019, instance_loss: 0.1730, weighted_loss: 0.0532, label: 0, bag_size: 236
batch 359, loss: 1.5913, instance_loss: 0.5166, weighted_loss: 1.2689, label: 3, bag_size: 779
batch 379, loss: 0.6250, instance_loss: 0.5218, weighted_loss: 0.5940, label: 0, bag_size: 122
batch 399, loss: 1.3374, instance_loss: 0.4702, weighted_loss: 1.0772, label: 4, bag_size: 589
batch 419, loss: 0.7571, instance_loss: 0.4371, weighted_loss: 0.6611, label: 1, bag_size: 617
batch 439, loss: 1.2963, instance_loss: 0.5071, weighted_loss: 1.0595, label: 3, bag_size: 192
batch 459, loss: 0.4909, instance_loss: 0.4692, weighted_loss: 0.4844, label: 1, bag_size: 1103
batch 479, loss: 0.6281, instance_loss: 0.4705, weighted_loss: 0.5808, label: 3, bag_size: 818
batch 499, loss: 0.8574, instance_loss: 0.5798, weighted_loss: 0.7741, label: 2, bag_size: 385
batch 519, loss: 0.5209, instance_loss: 0.5352, weighted_loss: 0.5252, label: 4, bag_size: 853
batch 539, loss: 0.9277, instance_loss: 0.5115, weighted_loss: 0.8029, label: 3, bag_size: 459
batch 559, loss: 1.7329, instance_loss: 0.6350, weighted_loss: 1.4036, label: 0, bag_size: 143
batch 579, loss: 2.0439, instance_loss: 0.5506, weighted_loss: 1.5959, label: 2, bag_size: 1092


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.036616161616161616: correct 174/4752
Epoch: 33, train_loss: 1.1127, train_clustering_loss:  0.4835, train_error: 0.5034
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.47540983606557374, correct 58/122
class 2: acc 0.2018348623853211, correct 22/109
class 3: acc 0.45081967213114754, correct 55/122
class 4: acc 0.5175438596491229, correct 59/114

Val Set, val_loss: 1.1965, val_error: 0.5541, auc: 0.7852
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7557, instance_loss: 0.6112, weighted_loss: 0.7124, label: 3, bag_size: 107
batch 39, loss: 1.2541, instance_loss: 0.4964, weighted_loss: 1.0268, label: 2, bag_size: 421
batch 59, loss: 1.1886, instance_loss: 0.4581, weighted_loss: 0.9694, label: 1, bag_size: 660
batch 79, loss: 0.6234, instance_loss: 0.3412, weighted_loss: 0.5388, label: 4, bag_size: 652
batch 99, loss: 2.0176, instance_loss: 0.5944, weighted_loss: 1.5906, label: 0, bag_size: 376
batch 119, loss: 0.4775, instance_loss: 0.4417, weighted_loss: 0.4668, label: 1, bag_size: 1103
batch 139, loss: 0.1090, instance_loss: 0.4325, weighted_loss: 0.2060, label: 0, bag_size: 224
batch 159, loss: 0.7737, instance_loss: 0.4419, weighted_loss: 0.6742, label: 1, bag_size: 672
batch 179, loss: 1.0553, instance_loss: 0.6040, weighted_loss: 0.9199, label: 3, bag_size: 109
batch 199, loss: 0.5206, instance_loss: 0.3984, weighted_loss: 0.4839, label: 4, bag_size: 450
batch 219, loss: 0.7302, instance_loss: 0.4445, weighted_loss: 0.6445, label: 1, bag_size: 231
batch 239, loss: 1.3746, instance_loss: 0.5962, weighted_loss: 1.1411, label: 3, bag_size: 631
batch 259, loss: 0.5942, instance_loss: 0.3816, weighted_loss: 0.5304, label: 4, bag_size: 776
batch 279, loss: 1.8156, instance_loss: 0.6174, weighted_loss: 1.4561, label: 2, bag_size: 185
batch 299, loss: 1.0243, instance_loss: 0.5292, weighted_loss: 0.8758, label: 2, bag_size: 617
batch 319, loss: 1.0832, instance_loss: 0.4905, weighted_loss: 0.9054, label: 3, bag_size: 309
batch 339, loss: 2.9233, instance_loss: 0.4592, weighted_loss: 2.1841, label: 0, bag_size: 169
batch 359, loss: 0.3406, instance_loss: 0.4037, weighted_loss: 0.3595, label: 0, bag_size: 98
batch 379, loss: 2.9702, instance_loss: 0.5867, weighted_loss: 2.2552, label: 2, bag_size: 629
batch 399, loss: 1.4407, instance_loss: 0.6458, weighted_loss: 1.2022, label: 2, bag_size: 883
batch 419, loss: 0.0991, instance_loss: 0.3189, weighted_loss: 0.1650, label: 0, bag_size: 488
batch 439, loss: 0.5067, instance_loss: 0.3703, weighted_loss: 0.4658, label: 1, bag_size: 328
batch 459, loss: 0.8531, instance_loss: 0.4578, weighted_loss: 0.7345, label: 3, bag_size: 817
batch 479, loss: 0.8347, instance_loss: 0.4972, weighted_loss: 0.7335, label: 3, bag_size: 476
batch 499, loss: 0.9935, instance_loss: 0.6049, weighted_loss: 0.8769, label: 0, bag_size: 183
batch 519, loss: 0.9573, instance_loss: 0.5153, weighted_loss: 0.8247, label: 4, bag_size: 506
batch 539, loss: 0.0366, instance_loss: 0.3608, weighted_loss: 0.1339, label: 0, bag_size: 488
batch 559, loss: 0.7689, instance_loss: 0.4593, weighted_loss: 0.6760, label: 2, bag_size: 883
batch 579, loss: 0.0079, instance_loss: 0.3276, weighted_loss: 0.1038, label: 4, bag_size: 627


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.025252525252525252: correct 120/4752
Epoch: 34, train_loss: 1.1284, train_clustering_loss:  0.4855, train_error: 0.4613
class 0: acc 0.7747747747747747, correct 86/111
class 1: acc 0.7142857142857143, correct 105/147
class 2: acc 0.21495327102803738, correct 23/107
class 3: acc 0.452991452991453, correct 53/117
class 4: acc 0.4732142857142857, correct 53/112

Val Set, val_loss: 1.1477, val_error: 0.5135, auc: 0.7956
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.165551 --> 1.147747).  Saving model ...


batch 19, loss: 1.9757, instance_loss: 0.6348, weighted_loss: 1.5734, label: 2, bag_size: 361
batch 39, loss: 0.2297, instance_loss: 0.4324, weighted_loss: 0.2905, label: 0, bag_size: 642
batch 59, loss: 1.1608, instance_loss: 0.5671, weighted_loss: 0.9827, label: 0, bag_size: 178
batch 79, loss: 1.5866, instance_loss: 0.5163, weighted_loss: 1.2655, label: 1, bag_size: 272
batch 99, loss: 0.9781, instance_loss: 0.4832, weighted_loss: 0.8297, label: 1, bag_size: 444
batch 119, loss: 1.1001, instance_loss: 0.4947, weighted_loss: 0.9185, label: 2, bag_size: 369
batch 139, loss: 1.2477, instance_loss: 0.5003, weighted_loss: 1.0235, label: 2, bag_size: 557
batch 159, loss: 0.2968, instance_loss: 0.4260, weighted_loss: 0.3356, label: 0, bag_size: 552
batch 179, loss: 0.5717, instance_loss: 0.4040, weighted_loss: 0.5214, label: 4, bag_size: 685
batch 199, loss: 0.0000, instance_loss: 0.0153, weighted_loss: 0.0046, label: 4, bag_size: 813
batch 219, loss: 1.3114, instance_loss: 0.6000, weighted_loss: 1.0979, label: 3, bag_size: 109
batch 239, loss: 1.1971, instance_loss: 0.4628, weighted_loss: 0.9768, label: 4, bag_size: 228
batch 259, loss: 1.5379, instance_loss: 0.4652, weighted_loss: 1.2161, label: 1, bag_size: 1013
batch 279, loss: 1.0903, instance_loss: 0.4065, weighted_loss: 0.8851, label: 1, bag_size: 461
batch 299, loss: 1.3608, instance_loss: 0.5521, weighted_loss: 1.1182, label: 2, bag_size: 799
batch 319, loss: 1.2139, instance_loss: 0.5949, weighted_loss: 1.0282, label: 3, bag_size: 961
batch 339, loss: 1.1510, instance_loss: 0.6146, weighted_loss: 0.9901, label: 4, bag_size: 1064
batch 359, loss: 1.1116, instance_loss: 0.5405, weighted_loss: 0.9403, label: 3, bag_size: 443
batch 379, loss: 1.4906, instance_loss: 0.5298, weighted_loss: 1.2023, label: 4, bag_size: 1297
batch 399, loss: 1.0631, instance_loss: 0.4915, weighted_loss: 0.8917, label: 2, bag_size: 867
batch 419, loss: 0.6403, instance_loss: 0.4201, weighted_loss: 0.5742, label: 0, bag_size: 581
batch 439, loss: 1.0537, instance_loss: 0.5789, weighted_loss: 0.9113, label: 2, bag_size: 934
batch 459, loss: 1.0891, instance_loss: 0.4329, weighted_loss: 0.8922, label: 1, bag_size: 620
batch 479, loss: 0.6780, instance_loss: 0.5164, weighted_loss: 0.6295, label: 0, bag_size: 1085
batch 499, loss: 2.0935, instance_loss: 0.6908, weighted_loss: 1.6727, label: 4, bag_size: 267
batch 519, loss: 0.9604, instance_loss: 0.4536, weighted_loss: 0.8084, label: 2, bag_size: 290
batch 539, loss: 0.7007, instance_loss: 0.5127, weighted_loss: 0.6443, label: 3, bag_size: 344
batch 559, loss: 3.1512, instance_loss: 0.5382, weighted_loss: 2.3673, label: 0, bag_size: 273
batch 579, loss: 0.5867, instance_loss: 0.4532, weighted_loss: 0.5466, label: 3, bag_size: 282


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.03556397306397306: correct 169/4752
Epoch: 35, train_loss: 1.1291, train_clustering_loss:  0.4868, train_error: 0.5135
class 0: acc 0.8015873015873016, correct 101/126
class 1: acc 0.4166666666666667, correct 50/120
class 2: acc 0.25892857142857145, correct 29/112
class 3: acc 0.4957983193277311, correct 59/119
class 4: acc 0.42735042735042733, correct 50/117

Val Set, val_loss: 1.1590, val_error: 0.5541, auc: 0.7937
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3298, instance_loss: 0.4724, weighted_loss: 1.0726, label: 1, bag_size: 500
batch 39, loss: 1.2530, instance_loss: 0.4855, weighted_loss: 1.0227, label: 1, bag_size: 695
batch 59, loss: 0.7547, instance_loss: 0.4673, weighted_loss: 0.6685, label: 2, bag_size: 867
batch 79, loss: 1.8845, instance_loss: 0.5376, weighted_loss: 1.4804, label: 4, bag_size: 310
batch 99, loss: 1.6850, instance_loss: 0.5790, weighted_loss: 1.3532, label: 4, bag_size: 757
batch 119, loss: 2.5344, instance_loss: 0.5379, weighted_loss: 1.9354, label: 2, bag_size: 128
batch 139, loss: 0.5304, instance_loss: 0.3563, weighted_loss: 0.4782, label: 1, bag_size: 829
batch 159, loss: 0.8276, instance_loss: 0.4898, weighted_loss: 0.7263, label: 3, bag_size: 486
batch 179, loss: 1.7275, instance_loss: 0.4608, weighted_loss: 1.3475, label: 2, bag_size: 512
batch 199, loss: 1.8351, instance_loss: 0.6185, weighted_loss: 1.4701, label: 3, bag_size: 897
batch 219, loss: 0.9781, instance_loss: 0.3918, weighted_loss: 0.8022, label: 1, bag_size: 742
batch 239, loss: 0.9641, instance_loss: 0.4491, weighted_loss: 0.8096, label: 3, bag_size: 1076
batch 259, loss: 0.6286, instance_loss: 0.7855, weighted_loss: 0.6757, label: 1, bag_size: 44
batch 279, loss: 0.0233, instance_loss: 0.2740, weighted_loss: 0.0985, label: 0, bag_size: 74
batch 299, loss: 1.0929, instance_loss: 0.4739, weighted_loss: 0.9072, label: 3, bag_size: 457
batch 319, loss: 0.2590, instance_loss: 0.4478, weighted_loss: 0.3157, label: 0, bag_size: 231
batch 339, loss: 2.3742, instance_loss: 0.6403, weighted_loss: 1.8540, label: 2, bag_size: 340
batch 359, loss: 0.0373, instance_loss: 0.2762, weighted_loss: 0.1090, label: 0, bag_size: 188
batch 379, loss: 1.5771, instance_loss: 0.4795, weighted_loss: 1.2478, label: 1, bag_size: 534
batch 399, loss: 3.3217, instance_loss: 0.6291, weighted_loss: 2.5139, label: 1, bag_size: 45
batch 419, loss: 0.3408, instance_loss: 0.4339, weighted_loss: 0.3687, label: 4, bag_size: 683
batch 439, loss: 0.9771, instance_loss: 0.4227, weighted_loss: 0.8108, label: 2, bag_size: 708
batch 459, loss: 0.5340, instance_loss: 0.3642, weighted_loss: 0.4830, label: 4, bag_size: 729
batch 479, loss: 0.9444, instance_loss: 0.4403, weighted_loss: 0.7932, label: 2, bag_size: 697
batch 499, loss: 0.4291, instance_loss: 0.4255, weighted_loss: 0.4280, label: 0, bag_size: 77
batch 519, loss: 0.8277, instance_loss: 0.4135, weighted_loss: 0.7035, label: 2, bag_size: 697
batch 539, loss: 1.1335, instance_loss: 0.4611, weighted_loss: 0.9317, label: 1, bag_size: 271
batch 559, loss: 0.5551, instance_loss: 0.3687, weighted_loss: 0.4992, label: 4, bag_size: 960
batch 579, loss: 1.1867, instance_loss: 0.4150, weighted_loss: 0.9552, label: 1, bag_size: 823


class 0 clustering acc 0.9985690235690236: correct 23726/23760
class 1 clustering acc 0.026936026936026935: correct 128/4752
Epoch: 36, train_loss: 1.0860, train_clustering_loss:  0.4790, train_error: 0.4562
class 0: acc 0.8214285714285714, correct 92/112
class 1: acc 0.515625, correct 66/128
class 2: acc 0.40601503759398494, correct 54/133
class 3: acc 0.453781512605042, correct 54/119
class 4: acc 0.5588235294117647, correct 57/102

Val Set, val_loss: 1.2597, val_error: 0.5676, auc: 0.8051
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.08614864864864864: correct 51/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3416, instance_loss: 0.4910, weighted_loss: 1.0864, label: 1, bag_size: 161
batch 39, loss: 0.0006, instance_loss: 0.4376, weighted_loss: 0.1317, label: 2, bag_size: 553
batch 59, loss: 2.8331, instance_loss: 0.5762, weighted_loss: 2.1560, label: 0, bag_size: 745
batch 79, loss: 1.3479, instance_loss: 0.5013, weighted_loss: 1.0939, label: 1, bag_size: 355
batch 99, loss: 1.2399, instance_loss: 0.5317, weighted_loss: 1.0275, label: 1, bag_size: 599
batch 119, loss: 0.6196, instance_loss: 0.4070, weighted_loss: 0.5558, label: 4, bag_size: 520
batch 139, loss: 2.0450, instance_loss: 0.5304, weighted_loss: 1.5906, label: 2, bag_size: 549
batch 159, loss: 0.0379, instance_loss: 0.2454, weighted_loss: 0.1002, label: 0, bag_size: 133
batch 179, loss: 1.4260, instance_loss: 0.5127, weighted_loss: 1.1520, label: 2, bag_size: 208
batch 199, loss: 0.6913, instance_loss: 0.3240, weighted_loss: 0.5811, label: 4, bag_size: 652
batch 219, loss: 2.2332, instance_loss: 0.6068, weighted_loss: 1.7453, label: 0, bag_size: 1045
batch 239, loss: 2.3055, instance_loss: 0.4541, weighted_loss: 1.7501, label: 1, bag_size: 742
batch 259, loss: 1.1620, instance_loss: 0.4969, weighted_loss: 0.9625, label: 0, bag_size: 367
batch 279, loss: 1.4168, instance_loss: 0.6520, weighted_loss: 1.1874, label: 3, bag_size: 780
batch 299, loss: 0.7963, instance_loss: 0.4772, weighted_loss: 0.7005, label: 3, bag_size: 369
batch 319, loss: 1.4424, instance_loss: 0.4510, weighted_loss: 1.1449, label: 0, bag_size: 879
batch 339, loss: 1.5276, instance_loss: 0.5477, weighted_loss: 1.2337, label: 4, bag_size: 726
batch 359, loss: 0.2379, instance_loss: 0.3544, weighted_loss: 0.2728, label: 4, bag_size: 266
batch 379, loss: 0.4575, instance_loss: 0.4076, weighted_loss: 0.4425, label: 0, bag_size: 317
batch 399, loss: 1.2761, instance_loss: 0.5976, weighted_loss: 1.0725, label: 3, bag_size: 107
batch 419, loss: 0.0012, instance_loss: 0.2110, weighted_loss: 0.0641, label: 0, bag_size: 175
batch 439, loss: 0.2417, instance_loss: 0.3899, weighted_loss: 0.2862, label: 1, bag_size: 748
batch 459, loss: 2.0792, instance_loss: 0.5387, weighted_loss: 1.6171, label: 1, bag_size: 764
batch 479, loss: 1.1514, instance_loss: 0.4959, weighted_loss: 0.9548, label: 1, bag_size: 925
batch 499, loss: 0.9746, instance_loss: 0.4919, weighted_loss: 0.8298, label: 1, bag_size: 526
batch 519, loss: 0.6547, instance_loss: 0.4052, weighted_loss: 0.5798, label: 3, bag_size: 369
batch 539, loss: 0.7075, instance_loss: 0.4888, weighted_loss: 0.6419, label: 1, bag_size: 599
batch 559, loss: 2.2445, instance_loss: 0.5904, weighted_loss: 1.7483, label: 0, bag_size: 1073
batch 579, loss: 0.7880, instance_loss: 0.5778, weighted_loss: 0.7250, label: 0, bag_size: 343


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.041245791245791245: correct 196/4752
Epoch: 37, train_loss: 1.1253, train_clustering_loss:  0.4820, train_error: 0.4747
class 0: acc 0.7950819672131147, correct 97/122
class 1: acc 0.4375, correct 49/112
class 2: acc 0.3333333333333333, correct 42/126
class 3: acc 0.5227272727272727, correct 69/132
class 4: acc 0.5392156862745098, correct 55/102

Val Set, val_loss: 1.1783, val_error: 0.5541, auc: 0.8027
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.08277027027027027: correct 49/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6311, instance_loss: 0.5151, weighted_loss: 1.2963, label: 4, bag_size: 72
batch 39, loss: 0.9349, instance_loss: 0.4775, weighted_loss: 0.7976, label: 3, bag_size: 459
batch 59, loss: 1.1898, instance_loss: 0.5625, weighted_loss: 1.0016, label: 0, bag_size: 404
batch 79, loss: 0.5223, instance_loss: 0.3941, weighted_loss: 0.4839, label: 3, bag_size: 344
batch 99, loss: 2.5423, instance_loss: 0.6339, weighted_loss: 1.9697, label: 4, bag_size: 589
batch 119, loss: 2.2892, instance_loss: 0.5753, weighted_loss: 1.7750, label: 4, bag_size: 264
batch 139, loss: 0.5424, instance_loss: 0.4638, weighted_loss: 0.5189, label: 4, bag_size: 685
batch 159, loss: 2.0792, instance_loss: 0.4917, weighted_loss: 1.6029, label: 4, bag_size: 176
batch 179, loss: 0.4716, instance_loss: 0.6115, weighted_loss: 0.5136, label: 0, bag_size: 435
batch 199, loss: 1.1350, instance_loss: 0.6059, weighted_loss: 0.9763, label: 0, bag_size: 1045
batch 219, loss: 0.9833, instance_loss: 0.5007, weighted_loss: 0.8385, label: 3, bag_size: 312
batch 239, loss: 2.3606, instance_loss: 0.7096, weighted_loss: 1.8653, label: 4, bag_size: 250
batch 259, loss: 1.5397, instance_loss: 0.5273, weighted_loss: 1.2360, label: 2, bag_size: 697
batch 279, loss: 0.3674, instance_loss: 0.4585, weighted_loss: 0.3947, label: 0, bag_size: 97
batch 299, loss: 1.5372, instance_loss: 0.5910, weighted_loss: 1.2534, label: 1, bag_size: 201
batch 319, loss: 0.9069, instance_loss: 0.4580, weighted_loss: 0.7722, label: 1, bag_size: 605
batch 339, loss: 1.3873, instance_loss: 0.5533, weighted_loss: 1.1371, label: 0, bag_size: 879
batch 359, loss: 1.4877, instance_loss: 0.4831, weighted_loss: 1.1863, label: 3, bag_size: 625
batch 379, loss: 1.2226, instance_loss: 0.4351, weighted_loss: 0.9863, label: 2, bag_size: 317
batch 399, loss: 1.7207, instance_loss: 0.4650, weighted_loss: 1.3440, label: 4, bag_size: 98
batch 419, loss: 0.6147, instance_loss: 0.5923, weighted_loss: 0.6080, label: 0, bag_size: 62
batch 439, loss: 1.7668, instance_loss: 0.5558, weighted_loss: 1.4035, label: 3, bag_size: 1022
batch 459, loss: 0.8361, instance_loss: 0.5005, weighted_loss: 0.7354, label: 3, bag_size: 858
batch 479, loss: 0.7250, instance_loss: 0.4747, weighted_loss: 0.6500, label: 2, bag_size: 371
batch 499, loss: 0.5752, instance_loss: 0.3834, weighted_loss: 0.5177, label: 4, bag_size: 660
batch 519, loss: 0.1937, instance_loss: 0.3859, weighted_loss: 0.2513, label: 0, bag_size: 122
batch 539, loss: 0.6722, instance_loss: 0.4047, weighted_loss: 0.5919, label: 1, bag_size: 697
batch 559, loss: 2.1327, instance_loss: 0.6369, weighted_loss: 1.6840, label: 2, bag_size: 860
batch 579, loss: 0.4871, instance_loss: 0.4827, weighted_loss: 0.4858, label: 3, bag_size: 274


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.04650673400673401: correct 221/4752
Epoch: 38, train_loss: 1.0785, train_clustering_loss:  0.4829, train_error: 0.4394
class 0: acc 0.768595041322314, correct 93/121
class 1: acc 0.4793388429752066, correct 58/121
class 2: acc 0.3364485981308411, correct 36/107
class 3: acc 0.5169491525423728, correct 61/118
class 4: acc 0.6692913385826772, correct 85/127

Val Set, val_loss: 1.2197, val_error: 0.5270, auc: 0.7944
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7394, instance_loss: 0.4493, weighted_loss: 0.6524, label: 1, bag_size: 1104
batch 39, loss: 0.6432, instance_loss: 0.3263, weighted_loss: 0.5481, label: 4, bag_size: 418
batch 59, loss: 0.8255, instance_loss: 0.4773, weighted_loss: 0.7210, label: 3, bag_size: 432
batch 79, loss: 0.0461, instance_loss: 0.2769, weighted_loss: 0.1154, label: 0, bag_size: 280
batch 99, loss: 2.6069, instance_loss: 0.5214, weighted_loss: 1.9813, label: 3, bag_size: 342
batch 119, loss: 1.1975, instance_loss: 0.4695, weighted_loss: 0.9791, label: 2, bag_size: 998
batch 139, loss: 1.3440, instance_loss: 0.6338, weighted_loss: 1.1309, label: 2, bag_size: 1319
batch 159, loss: 0.8413, instance_loss: 0.4969, weighted_loss: 0.7380, label: 4, bag_size: 342
batch 179, loss: 1.4800, instance_loss: 0.4582, weighted_loss: 1.1735, label: 4, bag_size: 310
batch 199, loss: 1.8501, instance_loss: 0.4829, weighted_loss: 1.4400, label: 3, bag_size: 796
batch 219, loss: 2.5731, instance_loss: 0.5659, weighted_loss: 1.9709, label: 4, bag_size: 589
batch 239, loss: 0.1993, instance_loss: 0.4652, weighted_loss: 0.2791, label: 0, bag_size: 732
batch 259, loss: 0.6799, instance_loss: 0.4269, weighted_loss: 0.6040, label: 3, bag_size: 500
batch 279, loss: 1.3224, instance_loss: 0.5566, weighted_loss: 1.0926, label: 2, bag_size: 633
batch 299, loss: 2.0097, instance_loss: 0.5286, weighted_loss: 1.5653, label: 1, bag_size: 398
batch 319, loss: 1.5438, instance_loss: 0.6913, weighted_loss: 1.2880, label: 0, bag_size: 1414
batch 339, loss: 0.0096, instance_loss: 0.1825, weighted_loss: 0.0615, label: 0, bag_size: 51
batch 359, loss: 0.4761, instance_loss: 0.4568, weighted_loss: 0.4703, label: 4, bag_size: 506
batch 379, loss: 4.8711, instance_loss: 0.6898, weighted_loss: 3.6167, label: 0, bag_size: 608
batch 399, loss: 1.3614, instance_loss: 0.5436, weighted_loss: 1.1161, label: 1, bag_size: 177
batch 419, loss: 0.7546, instance_loss: 0.5238, weighted_loss: 0.6854, label: 3, bag_size: 476
batch 439, loss: 0.8350, instance_loss: 0.5305, weighted_loss: 0.7437, label: 1, bag_size: 925
batch 459, loss: 1.0214, instance_loss: 0.3914, weighted_loss: 0.8324, label: 4, bag_size: 690
batch 479, loss: 1.6225, instance_loss: 0.4653, weighted_loss: 1.2754, label: 1, bag_size: 697
batch 499, loss: 1.3271, instance_loss: 0.5298, weighted_loss: 1.0879, label: 2, bag_size: 549
batch 519, loss: 0.0639, instance_loss: 0.3389, weighted_loss: 0.1464, label: 0, bag_size: 251
batch 539, loss: 1.3480, instance_loss: 0.5164, weighted_loss: 1.0985, label: 2, bag_size: 128
batch 559, loss: 0.7329, instance_loss: 0.4533, weighted_loss: 0.6490, label: 3, bag_size: 858
batch 579, loss: 1.2689, instance_loss: 0.4916, weighted_loss: 1.0357, label: 1, bag_size: 618


class 0 clustering acc 0.9965488215488215: correct 23678/23760
class 1 clustering acc 0.059343434343434344: correct 282/4752
Epoch: 39, train_loss: 1.0984, train_clustering_loss:  0.4818, train_error: 0.4747
class 0: acc 0.8015873015873016, correct 101/126
class 1: acc 0.4067796610169492, correct 48/118
class 2: acc 0.3333333333333333, correct 43/129
class 3: acc 0.5609756097560976, correct 69/123
class 4: acc 0.5204081632653061, correct 51/98

Val Set, val_loss: 1.1793, val_error: 0.5270, auc: 0.7961
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.08783783783783784: correct 52/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.1361, instance_loss: 0.6087, weighted_loss: 1.6779, label: 0, bag_size: 888
batch 39, loss: 0.9612, instance_loss: 0.4675, weighted_loss: 0.8131, label: 2, bag_size: 119
batch 59, loss: 0.5151, instance_loss: 0.5264, weighted_loss: 0.5185, label: 3, bag_size: 1284
batch 79, loss: 0.9534, instance_loss: 0.4998, weighted_loss: 0.8173, label: 2, bag_size: 288
batch 99, loss: 0.6651, instance_loss: 0.4834, weighted_loss: 0.6106, label: 2, bag_size: 168
batch 119, loss: 1.0183, instance_loss: 0.4329, weighted_loss: 0.8427, label: 1, bag_size: 960
batch 139, loss: 0.8808, instance_loss: 0.4307, weighted_loss: 0.7458, label: 2, bag_size: 176
batch 159, loss: 1.0393, instance_loss: 0.4142, weighted_loss: 0.8518, label: 4, bag_size: 520
batch 179, loss: 0.8128, instance_loss: 0.4360, weighted_loss: 0.6998, label: 0, bag_size: 404
batch 199, loss: 1.0565, instance_loss: 0.4662, weighted_loss: 0.8794, label: 2, bag_size: 317
batch 219, loss: 1.4331, instance_loss: 0.5219, weighted_loss: 1.1597, label: 3, bag_size: 364
batch 239, loss: 0.7199, instance_loss: 0.4177, weighted_loss: 0.6293, label: 2, bag_size: 645
batch 259, loss: 1.2585, instance_loss: 0.6545, weighted_loss: 1.0773, label: 3, bag_size: 608
batch 279, loss: 0.2293, instance_loss: 0.3426, weighted_loss: 0.2633, label: 0, bag_size: 49
batch 299, loss: 1.0317, instance_loss: 0.4846, weighted_loss: 0.8676, label: 3, bag_size: 486
batch 319, loss: 1.7374, instance_loss: 0.5487, weighted_loss: 1.3808, label: 1, bag_size: 381
batch 339, loss: 0.7862, instance_loss: 0.3750, weighted_loss: 0.6629, label: 4, bag_size: 687
batch 359, loss: 0.7680, instance_loss: 0.4780, weighted_loss: 0.6810, label: 3, bag_size: 312
batch 379, loss: 0.8779, instance_loss: 0.4442, weighted_loss: 0.7478, label: 1, bag_size: 221
batch 399, loss: 0.8114, instance_loss: 0.4795, weighted_loss: 0.7118, label: 2, bag_size: 769
batch 419, loss: 0.8881, instance_loss: 0.4579, weighted_loss: 0.7590, label: 2, bag_size: 886
batch 439, loss: 1.7105, instance_loss: 0.5672, weighted_loss: 1.3675, label: 4, bag_size: 868
batch 459, loss: 0.7378, instance_loss: 0.5098, weighted_loss: 0.6694, label: 3, bag_size: 566
batch 479, loss: 2.3149, instance_loss: 0.6050, weighted_loss: 1.8019, label: 2, bag_size: 488
batch 499, loss: 0.3335, instance_loss: 0.4367, weighted_loss: 0.3645, label: 4, bag_size: 853
batch 519, loss: 1.0666, instance_loss: 0.4329, weighted_loss: 0.8765, label: 4, bag_size: 160
batch 539, loss: 0.2086, instance_loss: 0.5394, weighted_loss: 0.3078, label: 0, bag_size: 428
batch 559, loss: 0.8201, instance_loss: 0.4166, weighted_loss: 0.6990, label: 2, bag_size: 783
batch 579, loss: 0.0434, instance_loss: 0.2959, weighted_loss: 0.1191, label: 0, bag_size: 306


class 0 clustering acc 0.997895622895623: correct 23710/23760
class 1 clustering acc 0.05092592592592592: correct 242/4752
Epoch: 40, train_loss: 1.0560, train_clustering_loss:  0.4802, train_error: 0.4613
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.36792452830188677, correct 39/106
class 2: acc 0.3790322580645161, correct 47/124
class 3: acc 0.584, correct 73/125
class 4: acc 0.5486725663716814, correct 62/113

Val Set, val_loss: 1.1611, val_error: 0.5405, auc: 0.7889
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 2.6695, instance_loss: 0.6202, weighted_loss: 2.0547, label: 2, bag_size: 340
batch 39, loss: 1.4713, instance_loss: 0.5136, weighted_loss: 1.1840, label: 0, bag_size: 600
batch 59, loss: 3.8321, instance_loss: 0.7289, weighted_loss: 2.9011, label: 4, bag_size: 399
batch 79, loss: 1.3313, instance_loss: 0.4921, weighted_loss: 1.0795, label: 2, bag_size: 392
batch 99, loss: 0.4892, instance_loss: 0.4226, weighted_loss: 0.4692, label: 4, bag_size: 489
batch 119, loss: 0.1584, instance_loss: 0.3624, weighted_loss: 0.2196, label: 0, bag_size: 188
batch 139, loss: 1.4183, instance_loss: 0.4902, weighted_loss: 1.1398, label: 1, bag_size: 695
batch 159, loss: 0.3608, instance_loss: 0.4497, weighted_loss: 0.3875, label: 0, bag_size: 33
batch 179, loss: 1.1924, instance_loss: 0.5115, weighted_loss: 0.9882, label: 0, bag_size: 143
batch 199, loss: 1.0464, instance_loss: 0.4786, weighted_loss: 0.8761, label: 2, bag_size: 135
batch 219, loss: 0.8952, instance_loss: 0.5023, weighted_loss: 0.7773, label: 1, bag_size: 742
batch 239, loss: 0.8560, instance_loss: 0.4569, weighted_loss: 0.7363, label: 1, bag_size: 960
batch 259, loss: 0.8101, instance_loss: 0.4404, weighted_loss: 0.6992, label: 1, bag_size: 1082
batch 279, loss: 1.3087, instance_loss: 0.4427, weighted_loss: 1.0489, label: 1, bag_size: 525
batch 299, loss: 0.7726, instance_loss: 0.4910, weighted_loss: 0.6881, label: 2, bag_size: 697
batch 319, loss: 1.5345, instance_loss: 0.5238, weighted_loss: 1.2313, label: 2, bag_size: 321
batch 339, loss: 0.1594, instance_loss: 0.2913, weighted_loss: 0.1990, label: 0, bag_size: 493
batch 359, loss: 0.7699, instance_loss: 0.4913, weighted_loss: 0.6863, label: 3, bag_size: 369
batch 379, loss: 0.5607, instance_loss: 0.4279, weighted_loss: 0.5208, label: 2, bag_size: 769
batch 399, loss: 2.1968, instance_loss: 0.4774, weighted_loss: 1.6810, label: 2, bag_size: 829
batch 419, loss: 2.5873, instance_loss: 0.6239, weighted_loss: 1.9983, label: 4, bag_size: 312
batch 439, loss: 0.3789, instance_loss: 0.3091, weighted_loss: 0.3579, label: 0, bag_size: 493
batch 459, loss: 0.0306, instance_loss: 0.2127, weighted_loss: 0.0853, label: 0, bag_size: 221
batch 479, loss: 0.7153, instance_loss: 0.4743, weighted_loss: 0.6430, label: 3, bag_size: 344
batch 499, loss: 1.5892, instance_loss: 0.4545, weighted_loss: 1.2488, label: 1, bag_size: 1009
batch 519, loss: 1.1848, instance_loss: 0.3998, weighted_loss: 0.9493, label: 4, bag_size: 333
batch 539, loss: 0.7721, instance_loss: 0.4348, weighted_loss: 0.6709, label: 4, bag_size: 660
batch 559, loss: 1.3486, instance_loss: 0.5005, weighted_loss: 1.0941, label: 4, bag_size: 238
batch 579, loss: 1.9640, instance_loss: 0.7872, weighted_loss: 1.6110, label: 1, bag_size: 339


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.050505050505050504: correct 240/4752
Epoch: 41, train_loss: 1.1274, train_clustering_loss:  0.4828, train_error: 0.4815
class 0: acc 0.8103448275862069, correct 94/116
class 1: acc 0.3389830508474576, correct 40/118
class 2: acc 0.4375, correct 56/128
class 3: acc 0.43243243243243246, correct 48/111
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.1585, val_error: 0.5270, auc: 0.7945
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2628, instance_loss: 0.4221, weighted_loss: 0.3106, label: 0, bag_size: 122
batch 39, loss: 0.7592, instance_loss: 0.4237, weighted_loss: 0.6585, label: 3, bag_size: 944
batch 59, loss: 0.7933, instance_loss: 0.4261, weighted_loss: 0.6831, label: 3, bag_size: 781
batch 79, loss: 2.4842, instance_loss: 0.5365, weighted_loss: 1.8999, label: 2, bag_size: 185
batch 99, loss: 0.9800, instance_loss: 0.4736, weighted_loss: 0.8281, label: 1, bag_size: 823
batch 119, loss: 0.6184, instance_loss: 0.4303, weighted_loss: 0.5620, label: 4, bag_size: 923
batch 139, loss: 2.0659, instance_loss: 0.6293, weighted_loss: 1.6349, label: 0, bag_size: 745
batch 159, loss: 0.9367, instance_loss: 0.4367, weighted_loss: 0.7867, label: 4, bag_size: 699
batch 179, loss: 0.6194, instance_loss: 0.5002, weighted_loss: 0.5837, label: 2, bag_size: 713
batch 199, loss: 0.0000, instance_loss: 0.1239, weighted_loss: 0.0372, label: 0, bag_size: 1570
batch 219, loss: 2.0432, instance_loss: 0.5245, weighted_loss: 1.5876, label: 2, bag_size: 128
batch 239, loss: 0.2259, instance_loss: 0.4781, weighted_loss: 0.3015, label: 0, bag_size: 97
batch 259, loss: 0.9195, instance_loss: 0.5423, weighted_loss: 0.8064, label: 1, bag_size: 886
batch 279, loss: 3.1210, instance_loss: 0.5406, weighted_loss: 2.3469, label: 4, bag_size: 310
batch 299, loss: 1.4370, instance_loss: 0.4535, weighted_loss: 1.1420, label: 2, bag_size: 470
batch 319, loss: 0.2579, instance_loss: 0.3861, weighted_loss: 0.2964, label: 4, bag_size: 685
batch 339, loss: 0.5629, instance_loss: 0.4022, weighted_loss: 0.5147, label: 4, bag_size: 780
batch 359, loss: 1.0063, instance_loss: 0.4626, weighted_loss: 0.8431, label: 3, bag_size: 625
batch 379, loss: 1.8827, instance_loss: 0.5581, weighted_loss: 1.4853, label: 3, bag_size: 154
batch 399, loss: 0.1746, instance_loss: 0.2796, weighted_loss: 0.2061, label: 4, bag_size: 1041
batch 419, loss: 1.0221, instance_loss: 0.5061, weighted_loss: 0.8673, label: 0, bag_size: 277
batch 439, loss: 1.4812, instance_loss: 0.4552, weighted_loss: 1.1734, label: 4, bag_size: 312
batch 459, loss: 0.8115, instance_loss: 0.5800, weighted_loss: 0.7420, label: 3, bag_size: 309
batch 479, loss: 0.9601, instance_loss: 0.3682, weighted_loss: 0.7826, label: 2, bag_size: 369
batch 499, loss: 1.5294, instance_loss: 0.5118, weighted_loss: 1.2241, label: 1, bag_size: 461
batch 519, loss: 0.1975, instance_loss: 0.3433, weighted_loss: 0.2412, label: 0, bag_size: 188
batch 539, loss: 1.2511, instance_loss: 0.5060, weighted_loss: 1.0276, label: 1, bag_size: 311
batch 559, loss: 1.2089, instance_loss: 0.4454, weighted_loss: 0.9799, label: 1, bag_size: 697
batch 579, loss: 1.7089, instance_loss: 0.5181, weighted_loss: 1.3517, label: 4, bag_size: 267


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.02882996632996633: correct 137/4752
Epoch: 42, train_loss: 1.0857, train_clustering_loss:  0.4831, train_error: 0.4781
class 0: acc 0.7017543859649122, correct 80/114
class 1: acc 0.3, correct 30/100
class 2: acc 0.5104895104895105, correct 73/143
class 3: acc 0.4732142857142857, correct 53/112
class 4: acc 0.592, correct 74/125

Val Set, val_loss: 1.2329, val_error: 0.5135, auc: 0.7930
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.9063, instance_loss: 0.6914, weighted_loss: 1.5418, label: 0, bag_size: 888
batch 39, loss: 1.5304, instance_loss: 0.5039, weighted_loss: 1.2225, label: 2, bag_size: 744
batch 59, loss: 0.0154, instance_loss: 0.2728, weighted_loss: 0.0926, label: 0, bag_size: 51
batch 79, loss: 2.1829, instance_loss: 0.5887, weighted_loss: 1.7046, label: 4, bag_size: 853
batch 99, loss: 1.2947, instance_loss: 0.4596, weighted_loss: 1.0441, label: 1, bag_size: 372
batch 119, loss: 1.2353, instance_loss: 0.4876, weighted_loss: 1.0109, label: 2, bag_size: 119
batch 139, loss: 3.6733, instance_loss: 0.6582, weighted_loss: 2.7688, label: 0, bag_size: 492
batch 159, loss: 0.7965, instance_loss: 0.4787, weighted_loss: 0.7011, label: 4, bag_size: 489
batch 179, loss: 1.2173, instance_loss: 0.4745, weighted_loss: 0.9945, label: 1, bag_size: 419
batch 199, loss: 0.0562, instance_loss: 0.3729, weighted_loss: 0.1512, label: 0, bag_size: 428
batch 219, loss: 1.3245, instance_loss: 0.5185, weighted_loss: 1.0827, label: 0, bag_size: 243
batch 239, loss: 0.9762, instance_loss: 0.5803, weighted_loss: 0.8574, label: 2, bag_size: 1319
batch 259, loss: 0.6583, instance_loss: 0.4087, weighted_loss: 0.5834, label: 3, bag_size: 102
batch 279, loss: 0.4155, instance_loss: 0.4726, weighted_loss: 0.4326, label: 0, bag_size: 231
batch 299, loss: 1.2391, instance_loss: 0.6780, weighted_loss: 1.0708, label: 3, bag_size: 98
batch 319, loss: 0.0107, instance_loss: 0.3947, weighted_loss: 0.1259, label: 0, bag_size: 230
batch 339, loss: 0.0000, instance_loss: 0.0487, weighted_loss: 0.0146, label: 4, bag_size: 813
batch 359, loss: 1.4185, instance_loss: 0.4779, weighted_loss: 1.1363, label: 3, bag_size: 615
batch 379, loss: 1.6029, instance_loss: 0.5324, weighted_loss: 1.2818, label: 2, bag_size: 367
batch 399, loss: 1.0122, instance_loss: 0.5916, weighted_loss: 0.8861, label: 0, bag_size: 455
batch 419, loss: 0.4895, instance_loss: 0.4148, weighted_loss: 0.4671, label: 3, bag_size: 274
batch 439, loss: 2.0217, instance_loss: 0.5585, weighted_loss: 1.5828, label: 1, bag_size: 875
batch 459, loss: 1.5159, instance_loss: 0.5298, weighted_loss: 1.2201, label: 0, bag_size: 343
batch 479, loss: 1.1924, instance_loss: 0.4448, weighted_loss: 0.9681, label: 2, bag_size: 244
batch 499, loss: 2.3954, instance_loss: 0.6517, weighted_loss: 1.8723, label: 0, bag_size: 745
batch 519, loss: 0.6600, instance_loss: 0.4381, weighted_loss: 0.5935, label: 1, bag_size: 672
batch 539, loss: 1.5397, instance_loss: 0.5916, weighted_loss: 1.2553, label: 2, bag_size: 105
batch 559, loss: 1.5696, instance_loss: 0.5517, weighted_loss: 1.2643, label: 2, bag_size: 998
batch 579, loss: 1.0133, instance_loss: 0.4511, weighted_loss: 0.8446, label: 4, bag_size: 218


class 0 clustering acc 0.9981481481481481: correct 23716/23760
class 1 clustering acc 0.027567340067340067: correct 131/4752
Epoch: 43, train_loss: 1.1462, train_clustering_loss:  0.4888, train_error: 0.5219
class 0: acc 0.7456140350877193, correct 85/114
class 1: acc 0.5571428571428572, correct 78/140
class 2: acc 0.12396694214876033, correct 15/121
class 3: acc 0.37383177570093457, correct 40/107
class 4: acc 0.5892857142857143, correct 66/112

Val Set, val_loss: 1.1761, val_error: 0.5541, auc: 0.7852
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1120, instance_loss: 0.2971, weighted_loss: 0.1675, label: 0, bag_size: 188
batch 39, loss: 1.6736, instance_loss: 0.4494, weighted_loss: 1.3064, label: 1, bag_size: 742
batch 59, loss: 1.6073, instance_loss: 0.5819, weighted_loss: 1.2997, label: 2, bag_size: 934
batch 79, loss: 0.8010, instance_loss: 0.3664, weighted_loss: 0.6706, label: 4, bag_size: 53
batch 99, loss: 2.4701, instance_loss: 0.6094, weighted_loss: 1.9119, label: 0, bag_size: 115
batch 119, loss: 1.0956, instance_loss: 0.5658, weighted_loss: 0.9367, label: 3, bag_size: 1078
batch 139, loss: 0.1498, instance_loss: 0.3624, weighted_loss: 0.2135, label: 0, bag_size: 98
batch 159, loss: 0.8700, instance_loss: 0.4007, weighted_loss: 0.7292, label: 1, bag_size: 634
batch 179, loss: 0.4037, instance_loss: 0.4862, weighted_loss: 0.4284, label: 3, bag_size: 795
batch 199, loss: 1.5215, instance_loss: 0.4911, weighted_loss: 1.2124, label: 1, bag_size: 355
batch 219, loss: 0.9257, instance_loss: 0.4633, weighted_loss: 0.7870, label: 3, bag_size: 1154
batch 239, loss: 1.6491, instance_loss: 0.5505, weighted_loss: 1.3196, label: 3, bag_size: 476
batch 259, loss: 0.8483, instance_loss: 0.5335, weighted_loss: 0.7539, label: 4, bag_size: 356
batch 279, loss: 1.3282, instance_loss: 0.5231, weighted_loss: 1.0867, label: 4, bag_size: 757
batch 299, loss: 0.2796, instance_loss: 0.4773, weighted_loss: 0.3389, label: 4, bag_size: 683
batch 319, loss: 0.1493, instance_loss: 0.4426, weighted_loss: 0.2373, label: 0, bag_size: 295
batch 339, loss: 2.0131, instance_loss: 0.4337, weighted_loss: 1.5393, label: 0, bag_size: 169
batch 359, loss: 0.6025, instance_loss: 0.4046, weighted_loss: 0.5431, label: 1, bag_size: 483
batch 379, loss: 0.4313, instance_loss: 0.8415, weighted_loss: 0.5544, label: 4, bag_size: 359
batch 399, loss: 3.4251, instance_loss: 0.7631, weighted_loss: 2.6265, label: 1, bag_size: 184
batch 419, loss: 0.3804, instance_loss: 0.4713, weighted_loss: 0.4077, label: 4, bag_size: 923
batch 439, loss: 0.7517, instance_loss: 0.4641, weighted_loss: 0.6654, label: 3, bag_size: 1078
batch 459, loss: 0.0251, instance_loss: 0.2735, weighted_loss: 0.0996, label: 0, bag_size: 212
batch 479, loss: 1.3887, instance_loss: 0.5502, weighted_loss: 1.1372, label: 2, bag_size: 1060
batch 499, loss: 1.4804, instance_loss: 0.5345, weighted_loss: 1.1966, label: 3, bag_size: 795
batch 519, loss: 1.9430, instance_loss: 0.5044, weighted_loss: 1.5115, label: 1, bag_size: 906
batch 539, loss: 0.2286, instance_loss: 0.3139, weighted_loss: 0.2542, label: 4, bag_size: 1041
batch 559, loss: 0.7709, instance_loss: 0.3870, weighted_loss: 0.6557, label: 0, bag_size: 1045
batch 579, loss: 1.6661, instance_loss: 0.6989, weighted_loss: 1.3759, label: 2, bag_size: 258


class 0 clustering acc 0.9981902356902357: correct 23717/23760
class 1 clustering acc 0.045875420875420875: correct 218/4752
Epoch: 44, train_loss: 1.0437, train_clustering_loss:  0.4760, train_error: 0.4529
class 0: acc 0.7971014492753623, correct 110/138
class 1: acc 0.5882352941176471, correct 80/136
class 2: acc 0.14705882352941177, correct 15/102
class 3: acc 0.41904761904761906, correct 44/105
class 4: acc 0.672566371681416, correct 76/113

Val Set, val_loss: 1.1747, val_error: 0.5405, auc: 0.7996
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.5829, instance_loss: 0.5038, weighted_loss: 0.5592, label: 1, bag_size: 906
batch 39, loss: 0.0978, instance_loss: 0.4405, weighted_loss: 0.2006, label: 4, bag_size: 450
batch 59, loss: 0.9817, instance_loss: 0.3809, weighted_loss: 0.8015, label: 3, bag_size: 488
batch 79, loss: 0.0115, instance_loss: 0.3500, weighted_loss: 0.1130, label: 0, bag_size: 221
batch 99, loss: 1.2617, instance_loss: 0.5242, weighted_loss: 1.0404, label: 3, bag_size: 1060
batch 119, loss: 1.1629, instance_loss: 0.5183, weighted_loss: 0.9696, label: 1, bag_size: 201
batch 139, loss: 0.5633, instance_loss: 0.3763, weighted_loss: 0.5072, label: 4, bag_size: 824
batch 159, loss: 2.4008, instance_loss: 0.6118, weighted_loss: 1.8641, label: 1, bag_size: 875
batch 179, loss: 0.9721, instance_loss: 0.3938, weighted_loss: 0.7986, label: 4, bag_size: 333
batch 199, loss: 1.4413, instance_loss: 0.6102, weighted_loss: 1.1920, label: 2, bag_size: 554
batch 219, loss: 0.1586, instance_loss: 0.3535, weighted_loss: 0.2170, label: 0, bag_size: 49
batch 239, loss: 0.0382, instance_loss: 0.3477, weighted_loss: 0.1311, label: 0, bag_size: 251
batch 259, loss: 0.8965, instance_loss: 0.4195, weighted_loss: 0.7534, label: 1, bag_size: 823
batch 279, loss: 2.0702, instance_loss: 0.6338, weighted_loss: 1.6393, label: 2, bag_size: 297
batch 299, loss: 1.9098, instance_loss: 0.5438, weighted_loss: 1.5000, label: 4, bag_size: 270
batch 319, loss: 2.6887, instance_loss: 0.5415, weighted_loss: 2.0446, label: 2, bag_size: 629
batch 339, loss: 0.7068, instance_loss: 0.4630, weighted_loss: 0.6337, label: 4, bag_size: 690
batch 359, loss: 0.9879, instance_loss: 0.4592, weighted_loss: 0.8293, label: 1, bag_size: 697
batch 379, loss: 0.3775, instance_loss: 0.3973, weighted_loss: 0.3834, label: 4, bag_size: 683
batch 399, loss: 1.9658, instance_loss: 0.5315, weighted_loss: 1.5355, label: 2, bag_size: 128
batch 419, loss: 0.8350, instance_loss: 0.4443, weighted_loss: 0.7178, label: 1, bag_size: 1013
batch 439, loss: 1.7929, instance_loss: 0.5620, weighted_loss: 1.4236, label: 4, bag_size: 72
batch 459, loss: 0.4084, instance_loss: 0.4262, weighted_loss: 0.4137, label: 0, bag_size: 62
batch 479, loss: 1.1048, instance_loss: 0.5017, weighted_loss: 0.9239, label: 1, bag_size: 1082
batch 499, loss: 0.2548, instance_loss: 0.4857, weighted_loss: 0.3240, label: 0, bag_size: 297
batch 519, loss: 3.0586, instance_loss: 0.6631, weighted_loss: 2.3400, label: 0, bag_size: 600
batch 539, loss: 0.6990, instance_loss: 0.4326, weighted_loss: 0.6191, label: 4, bag_size: 776
batch 559, loss: 0.8520, instance_loss: 0.4181, weighted_loss: 0.7218, label: 2, bag_size: 754
batch 579, loss: 1.9455, instance_loss: 0.4725, weighted_loss: 1.5036, label: 2, bag_size: 852


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.029461279461279462: correct 140/4752
Epoch: 45, train_loss: 1.0397, train_clustering_loss:  0.4826, train_error: 0.4495
class 0: acc 0.8615384615384616, correct 112/130
class 1: acc 0.4166666666666667, correct 45/108
class 2: acc 0.40625, correct 52/128
class 3: acc 0.4824561403508772, correct 55/114
class 4: acc 0.5526315789473685, correct 63/114

Val Set, val_loss: 1.2483, val_error: 0.5405, auc: 0.7762
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 2.0730, instance_loss: 0.5535, weighted_loss: 1.6172, label: 3, bag_size: 492
batch 39, loss: 1.4993, instance_loss: 0.5686, weighted_loss: 1.2201, label: 3, bag_size: 443
batch 59, loss: 1.5566, instance_loss: 0.5394, weighted_loss: 1.2515, label: 1, bag_size: 960
batch 79, loss: 0.0672, instance_loss: 0.3668, weighted_loss: 0.1571, label: 0, bag_size: 97
batch 99, loss: 0.7324, instance_loss: 0.6378, weighted_loss: 0.7040, label: 2, bag_size: 713
batch 119, loss: 1.9218, instance_loss: 0.4757, weighted_loss: 1.4880, label: 1, bag_size: 949
batch 139, loss: 0.0297, instance_loss: 0.3208, weighted_loss: 0.1170, label: 0, bag_size: 370
batch 159, loss: 1.1519, instance_loss: 0.6242, weighted_loss: 0.9936, label: 0, bag_size: 352
batch 179, loss: 1.5048, instance_loss: 0.6247, weighted_loss: 1.2408, label: 0, bag_size: 352
batch 199, loss: 0.6195, instance_loss: 0.4490, weighted_loss: 0.5683, label: 4, bag_size: 520
batch 219, loss: 0.8607, instance_loss: 0.4550, weighted_loss: 0.7390, label: 1, bag_size: 865
batch 239, loss: 0.5305, instance_loss: 0.3793, weighted_loss: 0.4852, label: 4, bag_size: 563
batch 259, loss: 1.0593, instance_loss: 0.4067, weighted_loss: 0.8635, label: 4, bag_size: 740
batch 279, loss: 0.5073, instance_loss: 0.3900, weighted_loss: 0.4721, label: 2, bag_size: 799
batch 299, loss: 0.8234, instance_loss: 0.4177, weighted_loss: 0.7017, label: 2, bag_size: 244
batch 319, loss: 0.7773, instance_loss: 0.4502, weighted_loss: 0.6792, label: 2, bag_size: 244
batch 339, loss: 0.6136, instance_loss: 0.4552, weighted_loss: 0.5661, label: 2, bag_size: 769
batch 359, loss: 0.9440, instance_loss: 0.4738, weighted_loss: 0.8030, label: 2, bag_size: 105
batch 379, loss: 1.3407, instance_loss: 0.5171, weighted_loss: 1.0936, label: 3, bag_size: 781
batch 399, loss: 1.3533, instance_loss: 0.4944, weighted_loss: 1.0957, label: 1, bag_size: 981
batch 419, loss: 1.1914, instance_loss: 0.5065, weighted_loss: 0.9859, label: 3, bag_size: 393
batch 439, loss: 0.7588, instance_loss: 0.4384, weighted_loss: 0.6626, label: 1, bag_size: 221
batch 459, loss: 1.1073, instance_loss: 0.4829, weighted_loss: 0.9200, label: 1, bag_size: 419
batch 479, loss: 0.3142, instance_loss: 0.4256, weighted_loss: 0.3476, label: 0, bag_size: 552
batch 499, loss: 0.8156, instance_loss: 0.4953, weighted_loss: 0.7195, label: 2, bag_size: 571
batch 519, loss: 2.4111, instance_loss: 0.5935, weighted_loss: 1.8658, label: 1, bag_size: 208
batch 539, loss: 1.6008, instance_loss: 0.4755, weighted_loss: 1.2632, label: 2, bag_size: 713
batch 559, loss: 1.8724, instance_loss: 0.8668, weighted_loss: 1.5707, label: 3, bag_size: 608
batch 579, loss: 2.1507, instance_loss: 0.6190, weighted_loss: 1.6912, label: 0, bag_size: 311


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.030513468013468013: correct 145/4752
Epoch: 46, train_loss: 1.0837, train_clustering_loss:  0.4857, train_error: 0.4882
class 0: acc 0.75, correct 87/116
class 1: acc 0.42735042735042733, correct 50/117
class 2: acc 0.4307692307692308, correct 56/130
class 3: acc 0.35454545454545455, correct 39/110
class 4: acc 0.5950413223140496, correct 72/121

Val Set, val_loss: 1.1283, val_error: 0.5405, auc: 0.7985
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.147747 --> 1.128263).  Saving model ...


batch 19, loss: 0.7535, instance_loss: 0.4039, weighted_loss: 0.6486, label: 1, bag_size: 1013
batch 39, loss: 1.4667, instance_loss: 0.5712, weighted_loss: 1.1981, label: 2, bag_size: 398
batch 59, loss: 1.2409, instance_loss: 0.5389, weighted_loss: 1.0303, label: 3, bag_size: 323
batch 79, loss: 1.0337, instance_loss: 0.4203, weighted_loss: 0.8497, label: 4, bag_size: 886
batch 99, loss: 0.2860, instance_loss: 0.5149, weighted_loss: 0.3547, label: 0, bag_size: 316
batch 119, loss: 1.9673, instance_loss: 0.6528, weighted_loss: 1.5730, label: 2, bag_size: 553
batch 139, loss: 1.0566, instance_loss: 0.4484, weighted_loss: 0.8742, label: 2, bag_size: 410
batch 159, loss: 1.0873, instance_loss: 0.4625, weighted_loss: 0.8999, label: 3, bag_size: 944
batch 179, loss: 1.2617, instance_loss: 0.4696, weighted_loss: 1.0241, label: 2, bag_size: 821
batch 199, loss: 0.7848, instance_loss: 0.5005, weighted_loss: 0.6995, label: 2, bag_size: 363
batch 219, loss: 1.1509, instance_loss: 0.4089, weighted_loss: 0.9283, label: 4, bag_size: 160
batch 239, loss: 1.6830, instance_loss: 0.4441, weighted_loss: 1.3113, label: 3, bag_size: 235
batch 259, loss: 1.3324, instance_loss: 0.5065, weighted_loss: 1.0846, label: 2, bag_size: 1066
batch 279, loss: 1.2175, instance_loss: 0.4800, weighted_loss: 0.9962, label: 3, bag_size: 499
batch 299, loss: 1.7042, instance_loss: 0.4788, weighted_loss: 1.3365, label: 4, bag_size: 98
batch 319, loss: 0.0002, instance_loss: 0.4158, weighted_loss: 0.1249, label: 2, bag_size: 553
batch 339, loss: 1.4546, instance_loss: 0.5130, weighted_loss: 1.1722, label: 3, bag_size: 300
batch 359, loss: 1.1226, instance_loss: 0.5565, weighted_loss: 0.9528, label: 3, bag_size: 500
batch 379, loss: 1.1510, instance_loss: 0.5188, weighted_loss: 0.9613, label: 2, bag_size: 318
batch 399, loss: 1.7896, instance_loss: 0.4513, weighted_loss: 1.3881, label: 3, bag_size: 154
batch 419, loss: 0.2328, instance_loss: 0.4137, weighted_loss: 0.2871, label: 0, bag_size: 223
batch 439, loss: 0.7330, instance_loss: 0.5487, weighted_loss: 0.6777, label: 2, bag_size: 303
batch 459, loss: 1.0321, instance_loss: 0.3957, weighted_loss: 0.8412, label: 0, bag_size: 581
batch 479, loss: 0.6522, instance_loss: 0.6310, weighted_loss: 0.6458, label: 0, bag_size: 183
batch 499, loss: 0.1058, instance_loss: 0.3621, weighted_loss: 0.1827, label: 0, bag_size: 227
batch 519, loss: 1.3908, instance_loss: 0.7149, weighted_loss: 1.1880, label: 3, bag_size: 31
batch 539, loss: 0.8859, instance_loss: 0.4456, weighted_loss: 0.7538, label: 3, bag_size: 495
batch 559, loss: 0.1094, instance_loss: 0.4898, weighted_loss: 0.2235, label: 0, bag_size: 732
batch 579, loss: 0.6854, instance_loss: 0.5042, weighted_loss: 0.6310, label: 3, bag_size: 781


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.029671717171717172: correct 141/4752
Epoch: 47, train_loss: 1.0680, train_clustering_loss:  0.4846, train_error: 0.4731
class 0: acc 0.7943262411347518, correct 112/141
class 1: acc 0.5, correct 58/116
class 2: acc 0.3153153153153153, correct 35/111
class 3: acc 0.532258064516129, correct 66/124
class 4: acc 0.4117647058823529, correct 42/102

Val Set, val_loss: 1.2919, val_error: 0.5000, auc: 0.7683
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3362, instance_loss: 0.4657, weighted_loss: 0.3750, label: 1, bag_size: 141
batch 39, loss: 0.0083, instance_loss: 0.3205, weighted_loss: 0.1019, label: 1, bag_size: 371
batch 59, loss: 0.0666, instance_loss: 0.3686, weighted_loss: 0.1572, label: 0, bag_size: 218
batch 79, loss: 0.9139, instance_loss: 0.5331, weighted_loss: 0.7996, label: 3, bag_size: 598
batch 99, loss: 0.3292, instance_loss: 0.5071, weighted_loss: 0.3826, label: 3, bag_size: 322
batch 119, loss: 0.7641, instance_loss: 0.5338, weighted_loss: 0.6950, label: 2, bag_size: 369
batch 139, loss: 0.7941, instance_loss: 0.4131, weighted_loss: 0.6798, label: 1, bag_size: 865
batch 159, loss: 0.7885, instance_loss: 0.4812, weighted_loss: 0.6963, label: 4, bag_size: 695
batch 179, loss: 0.0001, instance_loss: 0.6275, weighted_loss: 0.1883, label: 2, bag_size: 936
batch 199, loss: 0.0218, instance_loss: 0.4190, weighted_loss: 0.1409, label: 0, bag_size: 340
batch 219, loss: 1.1524, instance_loss: 0.5078, weighted_loss: 0.9590, label: 3, bag_size: 858
batch 239, loss: 1.3444, instance_loss: 0.4964, weighted_loss: 1.0900, label: 1, bag_size: 618
batch 259, loss: 1.4003, instance_loss: 0.5009, weighted_loss: 1.1305, label: 0, bag_size: 367
batch 279, loss: 1.2515, instance_loss: 0.4835, weighted_loss: 1.0211, label: 1, bag_size: 481
batch 299, loss: 0.4616, instance_loss: 0.5559, weighted_loss: 0.4899, label: 2, bag_size: 185
batch 319, loss: 1.2054, instance_loss: 0.5033, weighted_loss: 0.9948, label: 3, bag_size: 641
batch 339, loss: 2.3595, instance_loss: 0.7873, weighted_loss: 1.8878, label: 0, bag_size: 888
batch 359, loss: 0.7881, instance_loss: 0.4713, weighted_loss: 0.6930, label: 3, bag_size: 309
batch 379, loss: 0.2220, instance_loss: 0.3482, weighted_loss: 0.2599, label: 0, bag_size: 79
batch 399, loss: 1.4228, instance_loss: 0.3803, weighted_loss: 1.1101, label: 0, bag_size: 879
batch 419, loss: 1.4514, instance_loss: 0.5074, weighted_loss: 1.1682, label: 2, bag_size: 557
batch 439, loss: 2.1375, instance_loss: 0.6291, weighted_loss: 1.6850, label: 4, bag_size: 685
batch 459, loss: 2.1034, instance_loss: 0.7718, weighted_loss: 1.7039, label: 0, bag_size: 370
batch 479, loss: 0.6545, instance_loss: 0.4800, weighted_loss: 0.6021, label: 1, bag_size: 886
batch 499, loss: 0.0365, instance_loss: 0.2771, weighted_loss: 0.1087, label: 0, bag_size: 98
batch 519, loss: 0.0954, instance_loss: 0.3314, weighted_loss: 0.1662, label: 0, bag_size: 74
batch 539, loss: 1.7627, instance_loss: 0.6213, weighted_loss: 1.4203, label: 2, bag_size: 860
batch 559, loss: 0.1806, instance_loss: 0.3427, weighted_loss: 0.2292, label: 0, bag_size: 141
batch 579, loss: 1.0364, instance_loss: 0.4582, weighted_loss: 0.8630, label: 2, bag_size: 285


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.037247474747474744: correct 177/4752
Epoch: 48, train_loss: 1.0278, train_clustering_loss:  0.4831, train_error: 0.4478
class 0: acc 0.8380281690140845, correct 119/142
class 1: acc 0.5431034482758621, correct 63/116
class 2: acc 0.3130434782608696, correct 36/115
class 3: acc 0.5391304347826087, correct 62/115
class 4: acc 0.4528301886792453, correct 48/106

Val Set, val_loss: 1.3428, val_error: 0.6081, auc: 0.7448
class 0 clustering acc 0.9925675675675676: correct 2938/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7553, instance_loss: 0.4560, weighted_loss: 0.6655, label: 1, bag_size: 328
batch 39, loss: 0.6073, instance_loss: 0.5110, weighted_loss: 0.5784, label: 1, bag_size: 1103
batch 59, loss: 0.7429, instance_loss: 0.3803, weighted_loss: 0.6341, label: 2, bag_size: 369
batch 79, loss: 0.7534, instance_loss: 0.4634, weighted_loss: 0.6664, label: 2, bag_size: 779
batch 99, loss: 1.5569, instance_loss: 0.5022, weighted_loss: 1.2405, label: 4, bag_size: 438
batch 119, loss: 1.0433, instance_loss: 0.5343, weighted_loss: 0.8906, label: 4, bag_size: 1064
batch 139, loss: 0.9588, instance_loss: 0.4695, weighted_loss: 0.8120, label: 1, bag_size: 272
batch 159, loss: 1.5078, instance_loss: 0.5650, weighted_loss: 1.2250, label: 1, bag_size: 184
batch 179, loss: 0.1099, instance_loss: 0.6828, weighted_loss: 0.2818, label: 0, bag_size: 732
batch 199, loss: 0.9486, instance_loss: 0.4164, weighted_loss: 0.7889, label: 1, bag_size: 928
batch 219, loss: 1.1790, instance_loss: 0.5605, weighted_loss: 0.9935, label: 2, bag_size: 375
batch 239, loss: 1.1608, instance_loss: 0.5733, weighted_loss: 0.9845, label: 3, bag_size: 523
batch 259, loss: 0.0240, instance_loss: 0.3154, weighted_loss: 0.1114, label: 0, bag_size: 351
batch 279, loss: 0.1104, instance_loss: 0.3275, weighted_loss: 0.1755, label: 0, bag_size: 354
batch 299, loss: 0.0655, instance_loss: 0.2817, weighted_loss: 0.1303, label: 0, bag_size: 280
batch 319, loss: 1.1356, instance_loss: 0.4494, weighted_loss: 0.9297, label: 3, bag_size: 443
batch 339, loss: 1.6977, instance_loss: 0.4780, weighted_loss: 1.3318, label: 1, bag_size: 988
batch 359, loss: 1.2993, instance_loss: 0.5107, weighted_loss: 1.0627, label: 4, bag_size: 797
batch 379, loss: 0.3912, instance_loss: 0.5380, weighted_loss: 0.4352, label: 1, bag_size: 522
batch 399, loss: 1.5035, instance_loss: 0.6199, weighted_loss: 1.2384, label: 4, bag_size: 312
batch 419, loss: 0.9440, instance_loss: 0.5220, weighted_loss: 0.8174, label: 1, bag_size: 161
batch 439, loss: 0.0430, instance_loss: 0.2018, weighted_loss: 0.0906, label: 0, bag_size: 306
batch 459, loss: 0.0173, instance_loss: 0.2196, weighted_loss: 0.0780, label: 0, bag_size: 51
batch 479, loss: 0.0121, instance_loss: 0.4708, weighted_loss: 0.1497, label: 4, bag_size: 530
batch 499, loss: 0.0000, instance_loss: 0.0377, weighted_loss: 0.0113, label: 4, bag_size: 813
batch 519, loss: 0.2235, instance_loss: 0.4443, weighted_loss: 0.2898, label: 4, bag_size: 923
batch 539, loss: 0.5303, instance_loss: 0.4426, weighted_loss: 0.5040, label: 1, bag_size: 1103
batch 559, loss: 0.0953, instance_loss: 0.2834, weighted_loss: 0.1517, label: 0, bag_size: 70
batch 579, loss: 1.1028, instance_loss: 0.5339, weighted_loss: 0.9321, label: 3, bag_size: 390


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.041666666666666664: correct 198/4752
Epoch: 49, train_loss: 1.0374, train_clustering_loss:  0.4789, train_error: 0.4630
class 0: acc 0.8429752066115702, correct 102/121
class 1: acc 0.6124031007751938, correct 79/129
class 2: acc 0.24561403508771928, correct 28/114
class 3: acc 0.47107438016528924, correct 57/121
class 4: acc 0.48623853211009177, correct 53/109

Val Set, val_loss: 1.2236, val_error: 0.5135, auc: 0.7791
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0005, instance_loss: 0.4435, weighted_loss: 0.1334, label: 2, bag_size: 553
batch 39, loss: 1.5563, instance_loss: 0.5242, weighted_loss: 1.2467, label: 3, bag_size: 120
batch 59, loss: 0.3858, instance_loss: 0.4268, weighted_loss: 0.3981, label: 3, bag_size: 566
batch 79, loss: 1.2616, instance_loss: 0.5326, weighted_loss: 1.0429, label: 4, bag_size: 652
batch 99, loss: 0.1787, instance_loss: 0.3614, weighted_loss: 0.2335, label: 0, bag_size: 224
batch 119, loss: 1.0812, instance_loss: 0.6794, weighted_loss: 0.9607, label: 2, bag_size: 713
batch 139, loss: 0.9843, instance_loss: 0.4790, weighted_loss: 0.8327, label: 4, bag_size: 218
batch 159, loss: 0.8534, instance_loss: 0.4710, weighted_loss: 0.7387, label: 4, bag_size: 652
batch 179, loss: 0.4484, instance_loss: 0.4416, weighted_loss: 0.4463, label: 1, bag_size: 311
batch 199, loss: 2.7204, instance_loss: 0.6716, weighted_loss: 2.1057, label: 2, bag_size: 219
batch 219, loss: 1.4012, instance_loss: 0.5628, weighted_loss: 1.1497, label: 1, bag_size: 925
batch 239, loss: 0.0453, instance_loss: 1.0482, weighted_loss: 0.3462, label: 3, bag_size: 794
batch 259, loss: 1.1149, instance_loss: 0.5144, weighted_loss: 0.9348, label: 2, bag_size: 177
batch 279, loss: 0.2038, instance_loss: 0.4662, weighted_loss: 0.2825, label: 3, bag_size: 1284
batch 299, loss: 0.3416, instance_loss: 0.5589, weighted_loss: 0.4068, label: 3, bag_size: 780
batch 319, loss: 2.5949, instance_loss: 0.4893, weighted_loss: 1.9632, label: 2, bag_size: 1071
batch 339, loss: 1.3308, instance_loss: 0.5344, weighted_loss: 1.0918, label: 4, bag_size: 363
batch 359, loss: 0.3105, instance_loss: 0.4362, weighted_loss: 0.3482, label: 0, bag_size: 33
batch 379, loss: 1.5114, instance_loss: 0.4077, weighted_loss: 1.1803, label: 1, bag_size: 742
batch 399, loss: 1.1744, instance_loss: 0.4888, weighted_loss: 0.9687, label: 2, bag_size: 754
batch 419, loss: 1.1435, instance_loss: 0.4608, weighted_loss: 0.9387, label: 3, bag_size: 473
batch 439, loss: 1.4385, instance_loss: 0.5350, weighted_loss: 1.1674, label: 4, bag_size: 589
batch 459, loss: 0.4236, instance_loss: 0.3831, weighted_loss: 0.4114, label: 0, bag_size: 49
batch 479, loss: 1.3354, instance_loss: 0.5648, weighted_loss: 1.1042, label: 2, bag_size: 522
batch 499, loss: 0.5984, instance_loss: 0.3944, weighted_loss: 0.5372, label: 4, bag_size: 113
batch 519, loss: 0.9748, instance_loss: 0.5076, weighted_loss: 0.8346, label: 2, bag_size: 402
batch 539, loss: 0.4657, instance_loss: 0.4565, weighted_loss: 0.4629, label: 3, bag_size: 1358
batch 559, loss: 0.8185, instance_loss: 0.4162, weighted_loss: 0.6978, label: 4, bag_size: 72
batch 579, loss: 0.7765, instance_loss: 0.4816, weighted_loss: 0.6880, label: 4, bag_size: 729


class 0 clustering acc 0.9960016835016835: correct 23665/23760
class 1 clustering acc 0.027356902356902357: correct 130/4752
Epoch: 50, train_loss: 1.0453, train_clustering_loss:  0.4886, train_error: 0.4512
class 0: acc 0.7698412698412699, correct 97/126
class 1: acc 0.375, correct 42/112
class 2: acc 0.416, correct 52/125
class 3: acc 0.5267857142857143, correct 59/112
class 4: acc 0.6386554621848739, correct 76/119

Val Set, val_loss: 1.3259, val_error: 0.5946, auc: 0.7640
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1706, instance_loss: 0.3675, weighted_loss: 0.2297, label: 0, bag_size: 218
batch 39, loss: 2.9127, instance_loss: 0.7032, weighted_loss: 2.2498, label: 0, bag_size: 376
batch 59, loss: 0.3739, instance_loss: 0.4758, weighted_loss: 0.4044, label: 0, bag_size: 306
batch 79, loss: 0.4057, instance_loss: 0.6477, weighted_loss: 0.4783, label: 3, bag_size: 98
batch 99, loss: 0.4396, instance_loss: 0.5615, weighted_loss: 0.4762, label: 0, bag_size: 613
batch 119, loss: 1.3788, instance_loss: 0.4552, weighted_loss: 1.1017, label: 3, bag_size: 779
batch 139, loss: 0.2617, instance_loss: 0.4845, weighted_loss: 0.3285, label: 3, bag_size: 98
batch 159, loss: 0.3517, instance_loss: 0.3642, weighted_loss: 0.3554, label: 4, bag_size: 160
batch 179, loss: 0.0110, instance_loss: 0.3288, weighted_loss: 0.1063, label: 0, bag_size: 702
batch 199, loss: 0.9101, instance_loss: 0.4570, weighted_loss: 0.7741, label: 3, bag_size: 457
batch 219, loss: 0.0369, instance_loss: 0.4046, weighted_loss: 0.1472, label: 0, bag_size: 340
batch 239, loss: 1.9658, instance_loss: 0.5449, weighted_loss: 1.5396, label: 4, bag_size: 438
batch 259, loss: 0.0024, instance_loss: 0.3925, weighted_loss: 0.1194, label: 4, bag_size: 769
batch 279, loss: 0.5349, instance_loss: 0.4284, weighted_loss: 0.5029, label: 3, bag_size: 737
batch 299, loss: 0.2507, instance_loss: 0.3548, weighted_loss: 0.2819, label: 4, bag_size: 266
batch 319, loss: 1.9576, instance_loss: 0.5222, weighted_loss: 1.5270, label: 4, bag_size: 310
batch 339, loss: 0.9074, instance_loss: 0.4528, weighted_loss: 0.7710, label: 3, bag_size: 684
batch 359, loss: 0.9683, instance_loss: 0.4559, weighted_loss: 0.8146, label: 2, bag_size: 821
batch 379, loss: 1.0064, instance_loss: 0.4495, weighted_loss: 0.8393, label: 2, bag_size: 543
batch 399, loss: 0.5307, instance_loss: 0.4446, weighted_loss: 0.5048, label: 1, bag_size: 460
batch 419, loss: 0.1447, instance_loss: 0.5136, weighted_loss: 0.2553, label: 0, bag_size: 49
batch 439, loss: 1.4724, instance_loss: 0.4441, weighted_loss: 1.1639, label: 1, bag_size: 702
batch 459, loss: 0.6074, instance_loss: 0.4495, weighted_loss: 0.5600, label: 2, bag_size: 177
batch 479, loss: 0.4738, instance_loss: 0.4841, weighted_loss: 0.4769, label: 4, bag_size: 506
batch 499, loss: 0.7770, instance_loss: 0.5511, weighted_loss: 0.7092, label: 4, bag_size: 937
batch 519, loss: 0.3666, instance_loss: 0.3549, weighted_loss: 0.3631, label: 4, bag_size: 775
batch 539, loss: 0.8105, instance_loss: 0.5117, weighted_loss: 0.7209, label: 3, bag_size: 322
batch 559, loss: 2.2248, instance_loss: 0.7066, weighted_loss: 1.7693, label: 0, bag_size: 888
batch 579, loss: 0.1596, instance_loss: 0.3245, weighted_loss: 0.2091, label: 0, bag_size: 74


class 0 clustering acc 0.9985690235690236: correct 23726/23760
class 1 clustering acc 0.01872895622895623: correct 89/4752
Epoch: 51, train_loss: 1.0234, train_clustering_loss:  0.4811, train_error: 0.4529
class 0: acc 0.8173076923076923, correct 85/104
class 1: acc 0.543859649122807, correct 62/114
class 2: acc 0.39473684210526316, correct 45/114
class 3: acc 0.5112781954887218, correct 68/133
class 4: acc 0.5038759689922481, correct 65/129

Val Set, val_loss: 1.1954, val_error: 0.5541, auc: 0.7887
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7642, instance_loss: 0.4601, weighted_loss: 0.6730, label: 2, bag_size: 708
batch 39, loss: 1.3190, instance_loss: 0.5392, weighted_loss: 1.0850, label: 3, bag_size: 453
batch 59, loss: 0.6456, instance_loss: 0.6213, weighted_loss: 0.6383, label: 3, bag_size: 684
batch 79, loss: 0.1490, instance_loss: 0.4787, weighted_loss: 0.2479, label: 4, bag_size: 627
batch 99, loss: 1.4996, instance_loss: 0.6668, weighted_loss: 1.2498, label: 1, bag_size: 1082
batch 119, loss: 0.8147, instance_loss: 0.5318, weighted_loss: 0.7298, label: 1, bag_size: 906
batch 139, loss: 0.8799, instance_loss: 0.4433, weighted_loss: 0.7489, label: 1, bag_size: 461
batch 159, loss: 0.5062, instance_loss: 0.4371, weighted_loss: 0.4855, label: 2, bag_size: 769
batch 179, loss: 1.7850, instance_loss: 0.5005, weighted_loss: 1.3997, label: 3, bag_size: 638
batch 199, loss: 0.8758, instance_loss: 0.4779, weighted_loss: 0.7564, label: 1, bag_size: 620
batch 219, loss: 1.0494, instance_loss: 0.5359, weighted_loss: 0.8954, label: 2, bag_size: 572
batch 239, loss: 0.9401, instance_loss: 0.4336, weighted_loss: 0.7882, label: 1, bag_size: 660
batch 259, loss: 0.6218, instance_loss: 0.4067, weighted_loss: 0.5573, label: 1, bag_size: 410
batch 279, loss: 0.7197, instance_loss: 0.5187, weighted_loss: 0.6594, label: 2, bag_size: 535
batch 299, loss: 1.6416, instance_loss: 0.5089, weighted_loss: 1.3018, label: 3, bag_size: 453
batch 319, loss: 0.0459, instance_loss: 0.4385, weighted_loss: 0.1637, label: 0, bag_size: 702
batch 339, loss: 2.0081, instance_loss: 0.7706, weighted_loss: 1.6368, label: 2, bag_size: 1074
batch 359, loss: 1.1812, instance_loss: 0.4986, weighted_loss: 0.9764, label: 3, bag_size: 779
batch 379, loss: 0.8959, instance_loss: 0.4755, weighted_loss: 0.7698, label: 1, bag_size: 764
batch 399, loss: 0.2810, instance_loss: 0.4769, weighted_loss: 0.3398, label: 3, bag_size: 996
batch 419, loss: 2.5225, instance_loss: 0.6410, weighted_loss: 1.9581, label: 0, bag_size: 214
batch 439, loss: 1.4826, instance_loss: 0.4987, weighted_loss: 1.1874, label: 4, bag_size: 53
batch 459, loss: 0.6328, instance_loss: 0.4948, weighted_loss: 0.5914, label: 1, bag_size: 1103
batch 479, loss: 0.5842, instance_loss: 0.4404, weighted_loss: 0.5410, label: 2, bag_size: 286
batch 499, loss: 0.0062, instance_loss: 0.4104, weighted_loss: 0.1275, label: 0, bag_size: 706
batch 519, loss: 0.0440, instance_loss: 0.3906, weighted_loss: 0.1480, label: 0, bag_size: 397
batch 539, loss: 0.9278, instance_loss: 0.5838, weighted_loss: 0.8246, label: 3, bag_size: 899
batch 559, loss: 0.9626, instance_loss: 0.5039, weighted_loss: 0.8250, label: 4, bag_size: 660
batch 579, loss: 0.6740, instance_loss: 0.5267, weighted_loss: 0.6298, label: 3, bag_size: 274


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.018308080808080808: correct 87/4752
Epoch: 52, train_loss: 1.0988, train_clustering_loss:  0.4902, train_error: 0.4697
class 0: acc 0.7254901960784313, correct 74/102
class 1: acc 0.375, correct 39/104
class 2: acc 0.5103448275862069, correct 74/145
class 3: acc 0.47540983606557374, correct 58/122
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.1609, val_error: 0.5676, auc: 0.7938
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1838, instance_loss: 0.4500, weighted_loss: 0.2637, label: 0, bag_size: 188
batch 39, loss: 1.2177, instance_loss: 0.4528, weighted_loss: 0.9883, label: 3, bag_size: 499
batch 59, loss: 2.0239, instance_loss: 0.7690, weighted_loss: 1.6475, label: 0, bag_size: 888
batch 79, loss: 1.8780, instance_loss: 0.6287, weighted_loss: 1.5032, label: 1, bag_size: 153
batch 99, loss: 1.4956, instance_loss: 0.5243, weighted_loss: 1.2042, label: 2, bag_size: 288
batch 119, loss: 1.0257, instance_loss: 0.4080, weighted_loss: 0.8404, label: 3, bag_size: 1078
batch 139, loss: 0.7180, instance_loss: 0.4516, weighted_loss: 0.6381, label: 2, bag_size: 617
batch 159, loss: 2.2993, instance_loss: 0.5627, weighted_loss: 1.7783, label: 3, bag_size: 166
batch 179, loss: 0.9855, instance_loss: 0.4499, weighted_loss: 0.8248, label: 4, bag_size: 714
batch 199, loss: 1.3435, instance_loss: 0.4584, weighted_loss: 1.0780, label: 2, bag_size: 597
batch 219, loss: 1.3113, instance_loss: 0.5062, weighted_loss: 1.0698, label: 1, bag_size: 620
batch 239, loss: 0.8686, instance_loss: 0.4694, weighted_loss: 0.7489, label: 2, bag_size: 290
batch 259, loss: 1.2308, instance_loss: 0.5694, weighted_loss: 1.0324, label: 1, bag_size: 481
batch 279, loss: 0.4183, instance_loss: 0.3790, weighted_loss: 0.4065, label: 2, bag_size: 176
batch 299, loss: 0.8812, instance_loss: 0.4618, weighted_loss: 0.7554, label: 2, bag_size: 571
batch 319, loss: 1.0174, instance_loss: 0.4271, weighted_loss: 0.8404, label: 2, bag_size: 285
batch 339, loss: 0.5494, instance_loss: 0.4624, weighted_loss: 0.5233, label: 1, bag_size: 617
batch 359, loss: 0.8944, instance_loss: 0.5456, weighted_loss: 0.7897, label: 3, bag_size: 166
batch 379, loss: 2.0506, instance_loss: 0.4510, weighted_loss: 1.5707, label: 2, bag_size: 809
batch 399, loss: 0.2369, instance_loss: 0.3865, weighted_loss: 0.2818, label: 0, bag_size: 517
batch 419, loss: 0.4651, instance_loss: 0.4153, weighted_loss: 0.4501, label: 4, bag_size: 263
batch 439, loss: 0.9106, instance_loss: 0.4433, weighted_loss: 0.7704, label: 1, bag_size: 658
batch 459, loss: 0.8050, instance_loss: 0.4401, weighted_loss: 0.6956, label: 1, bag_size: 660
batch 479, loss: 0.5024, instance_loss: 0.4184, weighted_loss: 0.4772, label: 0, bag_size: 77
batch 499, loss: 1.6932, instance_loss: 0.5615, weighted_loss: 1.3537, label: 3, bag_size: 779
batch 519, loss: 1.7688, instance_loss: 0.6224, weighted_loss: 1.4249, label: 1, bag_size: 419
batch 539, loss: 0.7231, instance_loss: 0.5148, weighted_loss: 0.6606, label: 3, bag_size: 97
batch 559, loss: 0.1434, instance_loss: 0.3604, weighted_loss: 0.2085, label: 0, bag_size: 573
batch 579, loss: 1.3360, instance_loss: 0.5478, weighted_loss: 1.0995, label: 2, bag_size: 404


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.0361952861952862: correct 172/4752
Epoch: 53, train_loss: 1.0037, train_clustering_loss:  0.4750, train_error: 0.4108
class 0: acc 0.8130081300813008, correct 100/123
class 1: acc 0.5289256198347108, correct 64/121
class 2: acc 0.4298245614035088, correct 49/114
class 3: acc 0.5178571428571429, correct 58/112
class 4: acc 0.6370967741935484, correct 79/124

Val Set, val_loss: 1.1529, val_error: 0.5541, auc: 0.7913
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3946, instance_loss: 0.5007, weighted_loss: 0.4264, label: 0, bag_size: 283
batch 39, loss: 1.4955, instance_loss: 0.5671, weighted_loss: 1.2170, label: 3, bag_size: 566
batch 59, loss: 0.2570, instance_loss: 0.3247, weighted_loss: 0.2773, label: 0, bag_size: 49
batch 79, loss: 0.5192, instance_loss: 0.3662, weighted_loss: 0.4733, label: 4, bag_size: 418
batch 99, loss: 1.1073, instance_loss: 0.4693, weighted_loss: 0.9159, label: 1, bag_size: 208
batch 119, loss: 0.3985, instance_loss: 0.3586, weighted_loss: 0.3865, label: 4, bag_size: 780
batch 139, loss: 1.3453, instance_loss: 0.5392, weighted_loss: 1.1035, label: 3, bag_size: 120
batch 159, loss: 0.5521, instance_loss: 0.3307, weighted_loss: 0.4856, label: 4, bag_size: 293
batch 179, loss: 0.2222, instance_loss: 0.4225, weighted_loss: 0.2823, label: 0, bag_size: 517
batch 199, loss: 0.7019, instance_loss: 0.4798, weighted_loss: 0.6353, label: 0, bag_size: 428
batch 219, loss: 1.7901, instance_loss: 0.6413, weighted_loss: 1.4455, label: 2, bag_size: 563
batch 239, loss: 0.4390, instance_loss: 0.4211, weighted_loss: 0.4336, label: 4, bag_size: 665
batch 259, loss: 1.6491, instance_loss: 0.5720, weighted_loss: 1.3260, label: 2, bag_size: 1066
batch 279, loss: 1.4313, instance_loss: 0.6061, weighted_loss: 1.1837, label: 2, bag_size: 1122
batch 299, loss: 2.2027, instance_loss: 0.5886, weighted_loss: 1.7185, label: 3, bag_size: 779
batch 319, loss: 2.8806, instance_loss: 0.6724, weighted_loss: 2.2181, label: 0, bag_size: 376
batch 339, loss: 0.5107, instance_loss: 0.5340, weighted_loss: 0.5177, label: 1, bag_size: 522
batch 359, loss: 1.0618, instance_loss: 0.4988, weighted_loss: 0.8929, label: 1, bag_size: 311
batch 379, loss: 1.3290, instance_loss: 0.5284, weighted_loss: 1.0888, label: 3, bag_size: 495
batch 399, loss: 1.4014, instance_loss: 0.4531, weighted_loss: 1.1169, label: 4, bag_size: 572
batch 419, loss: 1.0831, instance_loss: 0.4401, weighted_loss: 0.8902, label: 4, bag_size: 726
batch 439, loss: 1.6792, instance_loss: 0.6423, weighted_loss: 1.3681, label: 1, bag_size: 355
batch 459, loss: 1.3719, instance_loss: 0.5174, weighted_loss: 1.1155, label: 2, bag_size: 339
batch 479, loss: 1.0231, instance_loss: 0.4537, weighted_loss: 0.8523, label: 0, bag_size: 214
batch 499, loss: 2.0689, instance_loss: 0.4688, weighted_loss: 1.5889, label: 2, bag_size: 105
batch 519, loss: 1.5441, instance_loss: 0.4850, weighted_loss: 1.2264, label: 4, bag_size: 771
batch 539, loss: 0.6733, instance_loss: 0.4261, weighted_loss: 0.5991, label: 4, bag_size: 730
batch 559, loss: 0.1197, instance_loss: 0.3332, weighted_loss: 0.1837, label: 0, bag_size: 70
batch 579, loss: 1.3509, instance_loss: 0.5480, weighted_loss: 1.1100, label: 2, bag_size: 860


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.02925084175084175: correct 139/4752
Epoch: 54, train_loss: 1.0245, train_clustering_loss:  0.4883, train_error: 0.4394
class 0: acc 0.7903225806451613, correct 98/124
class 1: acc 0.5263157894736842, correct 60/114
class 2: acc 0.4, correct 58/145
class 3: acc 0.425531914893617, correct 40/94
class 4: acc 0.6581196581196581, correct 77/117

Val Set, val_loss: 1.1325, val_error: 0.5405, auc: 0.7947
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9985, instance_loss: 0.5416, weighted_loss: 0.8614, label: 0, bag_size: 81
batch 39, loss: 1.4614, instance_loss: 0.4664, weighted_loss: 1.1629, label: 3, bag_size: 796
batch 59, loss: 1.3227, instance_loss: 0.6231, weighted_loss: 1.1128, label: 2, bag_size: 185
batch 79, loss: 1.2256, instance_loss: 0.5559, weighted_loss: 1.0247, label: 3, bag_size: 312
batch 99, loss: 2.4924, instance_loss: 0.5674, weighted_loss: 1.9149, label: 4, bag_size: 250
batch 119, loss: 0.5259, instance_loss: 0.4098, weighted_loss: 0.4911, label: 4, bag_size: 948
batch 139, loss: 0.9308, instance_loss: 0.4447, weighted_loss: 0.7850, label: 4, bag_size: 204
batch 159, loss: 1.0416, instance_loss: 0.6336, weighted_loss: 0.9192, label: 2, bag_size: 567
batch 179, loss: 1.0044, instance_loss: 0.5492, weighted_loss: 0.8678, label: 3, bag_size: 899
batch 199, loss: 0.8647, instance_loss: 0.4371, weighted_loss: 0.7364, label: 1, bag_size: 444
batch 219, loss: 0.5394, instance_loss: 0.4153, weighted_loss: 0.5022, label: 1, bag_size: 231
batch 239, loss: 0.3190, instance_loss: 0.6844, weighted_loss: 0.4286, label: 1, bag_size: 44
batch 259, loss: 0.3683, instance_loss: 0.4984, weighted_loss: 0.4073, label: 0, bag_size: 416
batch 279, loss: 0.8487, instance_loss: 0.4501, weighted_loss: 0.7292, label: 2, bag_size: 1079
batch 299, loss: 0.1161, instance_loss: 0.3853, weighted_loss: 0.1969, label: 0, bag_size: 488
batch 319, loss: 1.3191, instance_loss: 0.6752, weighted_loss: 1.1259, label: 3, bag_size: 1232
batch 339, loss: 0.2041, instance_loss: 0.4562, weighted_loss: 0.2797, label: 0, bag_size: 702
batch 359, loss: 0.8944, instance_loss: 0.4194, weighted_loss: 0.7519, label: 4, bag_size: 198
batch 379, loss: 1.0598, instance_loss: 0.4673, weighted_loss: 0.8821, label: 2, bag_size: 598
batch 399, loss: 1.0590, instance_loss: 0.5203, weighted_loss: 0.8974, label: 3, bag_size: 495
batch 419, loss: 0.9716, instance_loss: 0.4870, weighted_loss: 0.8262, label: 2, bag_size: 953
batch 439, loss: 0.6840, instance_loss: 0.5840, weighted_loss: 0.6540, label: 1, bag_size: 159
batch 459, loss: 1.3940, instance_loss: 0.5266, weighted_loss: 1.1338, label: 3, bag_size: 796
batch 479, loss: 0.8215, instance_loss: 0.4332, weighted_loss: 0.7050, label: 1, bag_size: 391
batch 499, loss: 0.3096, instance_loss: 0.4585, weighted_loss: 0.3542, label: 1, bag_size: 461
batch 519, loss: 0.6116, instance_loss: 0.5857, weighted_loss: 0.6038, label: 1, bag_size: 44
batch 539, loss: 0.7005, instance_loss: 0.4587, weighted_loss: 0.6280, label: 0, bag_size: 416
batch 559, loss: 1.2325, instance_loss: 0.4734, weighted_loss: 1.0048, label: 1, bag_size: 208
batch 579, loss: 0.0720, instance_loss: 0.4256, weighted_loss: 0.1781, label: 4, bag_size: 503


class 0 clustering acc 0.9977693602693603: correct 23707/23760
class 1 clustering acc 0.026725589225589225: correct 127/4752
Epoch: 55, train_loss: 1.0234, train_clustering_loss:  0.4797, train_error: 0.4596
class 0: acc 0.8292682926829268, correct 102/123
class 1: acc 0.5581395348837209, correct 72/129
class 2: acc 0.3253968253968254, correct 41/126
class 3: acc 0.4174757281553398, correct 43/103
class 4: acc 0.5575221238938053, correct 63/113

Val Set, val_loss: 1.2187, val_error: 0.5405, auc: 0.7829
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.9285714285714286, correct 13/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.6538, instance_loss: 0.4115, weighted_loss: 0.5812, label: 2, bag_size: 998
batch 39, loss: 0.4187, instance_loss: 0.5059, weighted_loss: 0.4449, label: 3, bag_size: 510
batch 59, loss: 1.3374, instance_loss: 0.5575, weighted_loss: 1.1035, label: 3, bag_size: 598
batch 79, loss: 0.5554, instance_loss: 0.4830, weighted_loss: 0.5337, label: 1, bag_size: 461
batch 99, loss: 2.0402, instance_loss: 0.5134, weighted_loss: 1.5822, label: 2, bag_size: 339
batch 119, loss: 1.5257, instance_loss: 0.5017, weighted_loss: 1.2185, label: 2, bag_size: 906
batch 139, loss: 0.6039, instance_loss: 0.4038, weighted_loss: 0.5439, label: 2, bag_size: 572
batch 159, loss: 1.2817, instance_loss: 0.5024, weighted_loss: 1.0479, label: 1, bag_size: 1013
batch 179, loss: 0.7855, instance_loss: 0.4114, weighted_loss: 0.6732, label: 2, bag_size: 266
batch 199, loss: 0.9629, instance_loss: 0.4773, weighted_loss: 0.8172, label: 3, bag_size: 473
batch 219, loss: 1.8902, instance_loss: 0.5180, weighted_loss: 1.4785, label: 4, bag_size: 438
batch 239, loss: 0.5136, instance_loss: 0.5574, weighted_loss: 0.5268, label: 0, bag_size: 455
batch 259, loss: 0.0521, instance_loss: 0.4168, weighted_loss: 0.1615, label: 0, bag_size: 397
batch 279, loss: 0.1075, instance_loss: 0.4248, weighted_loss: 0.2027, label: 0, bag_size: 188
batch 299, loss: 1.8006, instance_loss: 0.4929, weighted_loss: 1.4083, label: 1, bag_size: 702
batch 319, loss: 1.5633, instance_loss: 0.5574, weighted_loss: 1.2615, label: 3, bag_size: 781
batch 339, loss: 0.7432, instance_loss: 0.4686, weighted_loss: 0.6608, label: 4, bag_size: 685
batch 359, loss: 0.7155, instance_loss: 0.4581, weighted_loss: 0.6383, label: 4, bag_size: 277
batch 379, loss: 5.3179, instance_loss: 0.6840, weighted_loss: 3.9277, label: 4, bag_size: 101
batch 399, loss: 0.4781, instance_loss: 0.3958, weighted_loss: 0.4534, label: 4, bag_size: 574
batch 419, loss: 1.8541, instance_loss: 0.5060, weighted_loss: 1.4497, label: 2, bag_size: 941
batch 439, loss: 1.5516, instance_loss: 0.5172, weighted_loss: 1.2413, label: 2, bag_size: 421
batch 459, loss: 0.7092, instance_loss: 0.4549, weighted_loss: 0.6329, label: 1, bag_size: 634
batch 479, loss: 0.3210, instance_loss: 0.3488, weighted_loss: 0.3293, label: 4, bag_size: 695
batch 499, loss: 0.8109, instance_loss: 0.3978, weighted_loss: 0.6869, label: 4, bag_size: 53
batch 519, loss: 1.1500, instance_loss: 0.5127, weighted_loss: 0.9588, label: 3, bag_size: 663
batch 539, loss: 0.4358, instance_loss: 0.5094, weighted_loss: 0.4579, label: 0, bag_size: 223
batch 559, loss: 0.5424, instance_loss: 0.5629, weighted_loss: 0.5486, label: 3, bag_size: 1365
batch 579, loss: 1.0935, instance_loss: 0.4246, weighted_loss: 0.8928, label: 2, bag_size: 258


class 0 clustering acc 0.9977693602693603: correct 23707/23760
class 1 clustering acc 0.015993265993265993: correct 76/4752
Epoch: 56, train_loss: 1.0111, train_clustering_loss:  0.4881, train_error: 0.4175
class 0: acc 0.8157894736842105, correct 93/114
class 1: acc 0.5798319327731093, correct 69/119
class 2: acc 0.4262295081967213, correct 52/122
class 3: acc 0.48760330578512395, correct 59/121
class 4: acc 0.6186440677966102, correct 73/118

Val Set, val_loss: 1.2756, val_error: 0.5270, auc: 0.7723
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0024, instance_loss: 0.6315, weighted_loss: 0.1911, label: 0, bag_size: 1570
batch 39, loss: 0.8548, instance_loss: 0.4422, weighted_loss: 0.7310, label: 1, bag_size: 461
batch 59, loss: 2.7494, instance_loss: 0.8230, weighted_loss: 2.1715, label: 0, bag_size: 492
batch 79, loss: 2.3351, instance_loss: 0.5942, weighted_loss: 1.8129, label: 0, bag_size: 115
batch 99, loss: 0.1744, instance_loss: 0.4573, weighted_loss: 0.2593, label: 0, bag_size: 295
batch 119, loss: 0.1771, instance_loss: 0.4622, weighted_loss: 0.2626, label: 1, bag_size: 410
batch 139, loss: 0.6556, instance_loss: 0.5095, weighted_loss: 0.6118, label: 3, bag_size: 97
batch 159, loss: 1.7920, instance_loss: 0.5578, weighted_loss: 1.4218, label: 0, bag_size: 745
batch 179, loss: 0.9113, instance_loss: 0.4663, weighted_loss: 0.7778, label: 4, bag_size: 498
batch 199, loss: 1.1072, instance_loss: 0.5683, weighted_loss: 0.9455, label: 3, bag_size: 1358
batch 219, loss: 0.9680, instance_loss: 0.4456, weighted_loss: 0.8113, label: 2, bag_size: 321
batch 239, loss: 0.4223, instance_loss: 0.4313, weighted_loss: 0.4250, label: 4, bag_size: 574
batch 259, loss: 0.5534, instance_loss: 0.3905, weighted_loss: 0.5045, label: 2, bag_size: 557
batch 279, loss: 1.6597, instance_loss: 0.6063, weighted_loss: 1.3437, label: 0, bag_size: 888
batch 299, loss: 0.1504, instance_loss: 0.4991, weighted_loss: 0.2550, label: 0, bag_size: 573
batch 319, loss: 1.0075, instance_loss: 0.4083, weighted_loss: 0.8277, label: 1, bag_size: 1013
batch 339, loss: 1.7258, instance_loss: 0.5036, weighted_loss: 1.3591, label: 2, bag_size: 390
batch 359, loss: 0.9011, instance_loss: 0.5728, weighted_loss: 0.8026, label: 3, bag_size: 543
batch 379, loss: 2.4820, instance_loss: 0.6510, weighted_loss: 1.9327, label: 2, bag_size: 411
batch 399, loss: 2.1860, instance_loss: 0.6404, weighted_loss: 1.7224, label: 1, bag_size: 481
batch 419, loss: 1.0987, instance_loss: 0.4694, weighted_loss: 0.9099, label: 4, bag_size: 53
batch 439, loss: 2.3244, instance_loss: 0.5683, weighted_loss: 1.7976, label: 3, bag_size: 663
batch 459, loss: 0.0000, instance_loss: 0.4064, weighted_loss: 0.1219, label: 2, bag_size: 936
batch 479, loss: 3.0131, instance_loss: 0.7213, weighted_loss: 2.3256, label: 4, bag_size: 399
batch 499, loss: 0.1735, instance_loss: 0.3690, weighted_loss: 0.2322, label: 0, bag_size: 212
batch 519, loss: 0.3097, instance_loss: 0.3910, weighted_loss: 0.3341, label: 0, bag_size: 234
batch 539, loss: 1.0508, instance_loss: 0.5322, weighted_loss: 0.8952, label: 0, bag_size: 370
batch 559, loss: 2.3615, instance_loss: 0.6277, weighted_loss: 1.8413, label: 4, bag_size: 356
batch 579, loss: 0.5106, instance_loss: 0.5266, weighted_loss: 0.5154, label: 3, bag_size: 1284


class 0 clustering acc 0.9992003367003367: correct 23741/23760
class 1 clustering acc 0.008207070707070708: correct 39/4752
Epoch: 57, train_loss: 1.1152, train_clustering_loss:  0.4975, train_error: 0.4579
class 0: acc 0.75, correct 87/116
class 1: acc 0.4782608695652174, correct 55/115
class 2: acc 0.31932773109243695, correct 38/119
class 3: acc 0.5175438596491229, correct 59/114
class 4: acc 0.6384615384615384, correct 83/130

Val Set, val_loss: 1.2681, val_error: 0.5811, auc: 0.8010
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.4978, instance_loss: 0.5654, weighted_loss: 1.2181, label: 2, bag_size: 321
batch 39, loss: 0.7016, instance_loss: 0.4110, weighted_loss: 0.6144, label: 4, bag_size: 744
batch 59, loss: 0.6846, instance_loss: 0.4527, weighted_loss: 0.6150, label: 2, bag_size: 385
batch 79, loss: 1.4216, instance_loss: 0.4146, weighted_loss: 1.1195, label: 0, bag_size: 879
batch 99, loss: 0.0212, instance_loss: 0.3134, weighted_loss: 0.1088, label: 0, bag_size: 520
batch 119, loss: 0.6483, instance_loss: 0.3552, weighted_loss: 0.5604, label: 4, bag_size: 771
batch 139, loss: 1.0742, instance_loss: 0.4933, weighted_loss: 0.8999, label: 4, bag_size: 970
batch 159, loss: 1.1717, instance_loss: 0.4129, weighted_loss: 0.9440, label: 2, bag_size: 613
batch 179, loss: 0.1275, instance_loss: 0.4569, weighted_loss: 0.2263, label: 0, bag_size: 416
batch 199, loss: 0.8747, instance_loss: 0.5628, weighted_loss: 0.7811, label: 2, bag_size: 567
batch 219, loss: 0.0107, instance_loss: 0.3988, weighted_loss: 0.1271, label: 1, bag_size: 371
batch 239, loss: 1.4796, instance_loss: 0.4852, weighted_loss: 1.1813, label: 2, bag_size: 376
batch 259, loss: 0.0692, instance_loss: 0.3357, weighted_loss: 0.1491, label: 0, bag_size: 71
batch 279, loss: 1.3465, instance_loss: 0.6414, weighted_loss: 1.1350, label: 3, bag_size: 543
batch 299, loss: 0.0154, instance_loss: 0.1760, weighted_loss: 0.0636, label: 4, bag_size: 773
batch 319, loss: 0.5001, instance_loss: 0.4448, weighted_loss: 0.4835, label: 0, bag_size: 62
batch 339, loss: 0.4660, instance_loss: 0.4764, weighted_loss: 0.4691, label: 3, bag_size: 473
batch 359, loss: 0.0051, instance_loss: 0.3819, weighted_loss: 0.1181, label: 0, bag_size: 230
batch 379, loss: 1.6608, instance_loss: 0.6160, weighted_loss: 1.3473, label: 4, bag_size: 267
batch 399, loss: 0.9263, instance_loss: 0.5698, weighted_loss: 0.8193, label: 2, bag_size: 934
batch 419, loss: 3.5237, instance_loss: 0.6003, weighted_loss: 2.6467, label: 3, bag_size: 323
batch 439, loss: 0.4338, instance_loss: 0.4029, weighted_loss: 0.4246, label: 4, bag_size: 854
batch 459, loss: 2.0851, instance_loss: 0.5314, weighted_loss: 1.6190, label: 3, bag_size: 453
batch 479, loss: 1.2407, instance_loss: 0.5120, weighted_loss: 1.0221, label: 2, bag_size: 613
batch 499, loss: 0.8446, instance_loss: 0.4860, weighted_loss: 0.7370, label: 4, bag_size: 520
batch 519, loss: 0.9246, instance_loss: 0.5006, weighted_loss: 0.7974, label: 3, bag_size: 312
batch 539, loss: 0.7069, instance_loss: 0.4907, weighted_loss: 0.6420, label: 3, bag_size: 641
batch 559, loss: 0.8221, instance_loss: 0.5380, weighted_loss: 0.7369, label: 2, bag_size: 119
batch 579, loss: 0.7272, instance_loss: 0.4734, weighted_loss: 0.6510, label: 3, bag_size: 274


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.030723905723905723: correct 146/4752
Epoch: 58, train_loss: 1.0399, train_clustering_loss:  0.4866, train_error: 0.4394
class 0: acc 0.8034188034188035, correct 94/117
class 1: acc 0.6074074074074074, correct 82/135
class 2: acc 0.2682926829268293, correct 33/123
class 3: acc 0.5909090909090909, correct 65/110
class 4: acc 0.5412844036697247, correct 59/109

Val Set, val_loss: 1.2459, val_error: 0.5405, auc: 0.7924
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 2.1322, instance_loss: 0.6559, weighted_loss: 1.6893, label: 4, bag_size: 476
batch 39, loss: 2.4857, instance_loss: 0.6546, weighted_loss: 1.9364, label: 4, bag_size: 1031
batch 59, loss: 0.8472, instance_loss: 0.4270, weighted_loss: 0.7211, label: 0, bag_size: 879
batch 79, loss: 0.8593, instance_loss: 0.5312, weighted_loss: 0.7609, label: 3, bag_size: 459
batch 99, loss: 1.2471, instance_loss: 0.6964, weighted_loss: 1.0819, label: 4, bag_size: 356
batch 119, loss: 1.4695, instance_loss: 0.6352, weighted_loss: 1.2192, label: 2, bag_size: 690
batch 139, loss: 0.7773, instance_loss: 0.4198, weighted_loss: 0.6701, label: 1, bag_size: 391
batch 159, loss: 0.8240, instance_loss: 0.5181, weighted_loss: 0.7322, label: 2, bag_size: 582
batch 179, loss: 1.7720, instance_loss: 0.4911, weighted_loss: 1.3877, label: 1, bag_size: 949
batch 199, loss: 0.9265, instance_loss: 0.5301, weighted_loss: 0.8076, label: 4, bag_size: 589
batch 219, loss: 1.4768, instance_loss: 0.4791, weighted_loss: 1.1775, label: 2, bag_size: 258
batch 239, loss: 0.4090, instance_loss: 0.5151, weighted_loss: 0.4408, label: 1, bag_size: 490
batch 259, loss: 1.8001, instance_loss: 0.5205, weighted_loss: 1.4162, label: 2, bag_size: 543
batch 279, loss: 1.3050, instance_loss: 0.4745, weighted_loss: 1.0559, label: 2, bag_size: 258
batch 299, loss: 0.0864, instance_loss: 0.3771, weighted_loss: 0.1736, label: 0, bag_size: 354
batch 319, loss: 1.2636, instance_loss: 0.4914, weighted_loss: 1.0320, label: 1, bag_size: 599
batch 339, loss: 2.6277, instance_loss: 0.7154, weighted_loss: 2.0540, label: 0, bag_size: 745
batch 359, loss: 1.2099, instance_loss: 0.4740, weighted_loss: 0.9891, label: 4, bag_size: 333
batch 379, loss: 0.6733, instance_loss: 0.4505, weighted_loss: 0.6065, label: 3, bag_size: 312
batch 399, loss: 0.6007, instance_loss: 0.5010, weighted_loss: 0.5708, label: 0, bag_size: 455
batch 419, loss: 1.6879, instance_loss: 0.5560, weighted_loss: 1.3484, label: 0, bag_size: 1073
batch 439, loss: 1.2641, instance_loss: 0.6032, weighted_loss: 1.0659, label: 0, bag_size: 370
batch 459, loss: 0.9550, instance_loss: 0.5434, weighted_loss: 0.8315, label: 2, bag_size: 535
batch 479, loss: 0.7490, instance_loss: 0.5169, weighted_loss: 0.6794, label: 4, bag_size: 238
batch 499, loss: 0.8306, instance_loss: 0.4751, weighted_loss: 0.7240, label: 1, bag_size: 413
batch 519, loss: 1.6878, instance_loss: 0.7298, weighted_loss: 1.4004, label: 4, bag_size: 490
batch 539, loss: 2.1443, instance_loss: 0.4739, weighted_loss: 1.6431, label: 2, bag_size: 350
batch 559, loss: 1.6442, instance_loss: 0.5417, weighted_loss: 1.3134, label: 4, bag_size: 690
batch 579, loss: 1.3699, instance_loss: 0.5902, weighted_loss: 1.1360, label: 2, bag_size: 837


class 0 clustering acc 0.9981060606060606: correct 23715/23760
class 1 clustering acc 0.020202020202020204: correct 96/4752
Epoch: 59, train_loss: 1.0067, train_clustering_loss:  0.4909, train_error: 0.4529
class 0: acc 0.7716535433070866, correct 98/127
class 1: acc 0.6544117647058824, correct 89/136
class 2: acc 0.20869565217391303, correct 24/115
class 3: acc 0.5, correct 54/108
class 4: acc 0.5555555555555556, correct 60/108

Val Set, val_loss: 1.2207, val_error: 0.5270, auc: 0.7761
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5686, instance_loss: 0.4027, weighted_loss: 0.5188, label: 1, bag_size: 1103
batch 39, loss: 2.0905, instance_loss: 0.4312, weighted_loss: 1.5927, label: 1, bag_size: 840
batch 59, loss: 0.6994, instance_loss: 0.5716, weighted_loss: 0.6611, label: 0, bag_size: 613
batch 79, loss: 0.7519, instance_loss: 0.5506, weighted_loss: 0.6915, label: 4, bag_size: 356
batch 99, loss: 0.7675, instance_loss: 0.4312, weighted_loss: 0.6666, label: 2, bag_size: 708
batch 119, loss: 0.2539, instance_loss: 0.3831, weighted_loss: 0.2927, label: 1, bag_size: 311
batch 139, loss: 0.2353, instance_loss: 0.4739, weighted_loss: 0.3069, label: 0, bag_size: 295
batch 159, loss: 0.2208, instance_loss: 0.4238, weighted_loss: 0.2817, label: 0, bag_size: 397
batch 179, loss: 0.4057, instance_loss: 0.4776, weighted_loss: 0.4273, label: 3, bag_size: 928
batch 199, loss: 1.1007, instance_loss: 0.4674, weighted_loss: 0.9107, label: 1, bag_size: 221
batch 219, loss: 0.8959, instance_loss: 0.4844, weighted_loss: 0.7725, label: 2, bag_size: 567
batch 239, loss: 1.9062, instance_loss: 0.5501, weighted_loss: 1.4994, label: 3, bag_size: 897
batch 259, loss: 1.2203, instance_loss: 0.5075, weighted_loss: 1.0065, label: 3, bag_size: 323
batch 279, loss: 0.6967, instance_loss: 0.5652, weighted_loss: 0.6572, label: 0, bag_size: 258
batch 299, loss: 0.4875, instance_loss: 0.4818, weighted_loss: 0.4858, label: 0, bag_size: 238
batch 319, loss: 1.1438, instance_loss: 0.4876, weighted_loss: 0.9470, label: 2, bag_size: 543
batch 339, loss: 1.6798, instance_loss: 0.6256, weighted_loss: 1.3635, label: 3, bag_size: 156
batch 359, loss: 1.3864, instance_loss: 0.4891, weighted_loss: 1.1172, label: 4, bag_size: 1064
batch 379, loss: 1.9867, instance_loss: 0.5976, weighted_loss: 1.5699, label: 3, bag_size: 282
batch 399, loss: 0.6982, instance_loss: 0.4534, weighted_loss: 0.6248, label: 2, bag_size: 861
batch 419, loss: 0.3066, instance_loss: 0.3391, weighted_loss: 0.3163, label: 4, bag_size: 776
batch 439, loss: 0.9810, instance_loss: 0.4895, weighted_loss: 0.8335, label: 3, bag_size: 102
batch 459, loss: 1.0606, instance_loss: 0.4986, weighted_loss: 0.8920, label: 1, bag_size: 906
batch 479, loss: 0.9752, instance_loss: 0.5770, weighted_loss: 0.8557, label: 3, bag_size: 608
batch 499, loss: 1.7731, instance_loss: 0.5267, weighted_loss: 1.3992, label: 0, bag_size: 305
batch 519, loss: 1.6064, instance_loss: 0.3903, weighted_loss: 1.2416, label: 4, bag_size: 270
batch 539, loss: 0.1307, instance_loss: 0.5717, weighted_loss: 0.2630, label: 0, bag_size: 1085
batch 559, loss: 0.9543, instance_loss: 0.4778, weighted_loss: 0.8114, label: 4, bag_size: 660
batch 579, loss: 2.0529, instance_loss: 0.5639, weighted_loss: 1.6062, label: 4, bag_size: 1104


class 0 clustering acc 0.9976430976430977: correct 23704/23760
class 1 clustering acc 0.025883838383838384: correct 123/4752
Epoch: 60, train_loss: 1.0462, train_clustering_loss:  0.4886, train_error: 0.4377
class 0: acc 0.7631578947368421, correct 87/114
class 1: acc 0.5932203389830508, correct 70/118
class 2: acc 0.3275862068965517, correct 38/116
class 3: acc 0.5396825396825397, correct 68/126
class 4: acc 0.5916666666666667, correct 71/120

Val Set, val_loss: 1.2299, val_error: 0.5135, auc: 0.7911
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2676, instance_loss: 0.3715, weighted_loss: 0.2988, label: 0, bag_size: 383
batch 39, loss: 0.0298, instance_loss: 0.2022, weighted_loss: 0.0815, label: 0, bag_size: 156
batch 59, loss: 1.5397, instance_loss: 0.5922, weighted_loss: 1.2554, label: 4, bag_size: 572
batch 79, loss: 0.5312, instance_loss: 0.3814, weighted_loss: 0.4863, label: 4, bag_size: 563
batch 99, loss: 0.7524, instance_loss: 0.5426, weighted_loss: 0.6895, label: 3, bag_size: 857
batch 119, loss: 1.3079, instance_loss: 0.5073, weighted_loss: 1.0677, label: 2, bag_size: 489
batch 139, loss: 1.1762, instance_loss: 0.5179, weighted_loss: 0.9787, label: 2, bag_size: 590
batch 159, loss: 0.8757, instance_loss: 0.4861, weighted_loss: 0.7588, label: 2, bag_size: 1608
batch 179, loss: 0.9212, instance_loss: 0.4791, weighted_loss: 0.7885, label: 1, bag_size: 233
batch 199, loss: 1.6238, instance_loss: 0.5397, weighted_loss: 1.2985, label: 1, bag_size: 1360
batch 219, loss: 2.4841, instance_loss: 0.6222, weighted_loss: 1.9255, label: 2, bag_size: 530
batch 239, loss: 1.3309, instance_loss: 0.5960, weighted_loss: 1.1104, label: 2, bag_size: 783
batch 259, loss: 1.7122, instance_loss: 0.5347, weighted_loss: 1.3589, label: 2, bag_size: 258
batch 279, loss: 0.8846, instance_loss: 0.4530, weighted_loss: 0.7551, label: 1, bag_size: 886
batch 299, loss: 0.9155, instance_loss: 0.4570, weighted_loss: 0.7779, label: 4, bag_size: 238
batch 319, loss: 2.2122, instance_loss: 0.5755, weighted_loss: 1.7212, label: 2, bag_size: 1092
batch 339, loss: 0.5236, instance_loss: 0.4486, weighted_loss: 0.5011, label: 3, bag_size: 663
batch 359, loss: 2.0216, instance_loss: 0.6917, weighted_loss: 1.6226, label: 2, bag_size: 367
batch 379, loss: 1.1496, instance_loss: 0.5025, weighted_loss: 0.9554, label: 1, bag_size: 697
batch 399, loss: 0.3061, instance_loss: 0.3737, weighted_loss: 0.3264, label: 4, bag_size: 563
batch 419, loss: 2.0708, instance_loss: 0.8037, weighted_loss: 1.6907, label: 2, bag_size: 297
batch 439, loss: 0.8415, instance_loss: 0.4552, weighted_loss: 0.7256, label: 0, bag_size: 367
batch 459, loss: 1.6837, instance_loss: 0.5428, weighted_loss: 1.3414, label: 3, bag_size: 899
batch 479, loss: 1.1639, instance_loss: 0.6149, weighted_loss: 0.9992, label: 3, bag_size: 897
batch 499, loss: 0.7745, instance_loss: 0.4445, weighted_loss: 0.6755, label: 3, bag_size: 1076
batch 519, loss: 1.3738, instance_loss: 0.5775, weighted_loss: 1.1349, label: 2, bag_size: 909
batch 539, loss: 1.0140, instance_loss: 0.4579, weighted_loss: 0.8472, label: 3, bag_size: 625
batch 559, loss: 1.6988, instance_loss: 0.5491, weighted_loss: 1.3539, label: 2, bag_size: 290
batch 579, loss: 1.2183, instance_loss: 0.5628, weighted_loss: 1.0217, label: 3, bag_size: 473


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.03535353535353535: correct 168/4752
Epoch: 61, train_loss: 1.0287, train_clustering_loss:  0.4803, train_error: 0.4478
class 0: acc 0.8205128205128205, correct 96/117
class 1: acc 0.5047619047619047, correct 53/105
class 2: acc 0.2966101694915254, correct 35/118
class 3: acc 0.5166666666666667, correct 62/120
class 4: acc 0.6119402985074627, correct 82/134

Val Set, val_loss: 1.1828, val_error: 0.5270, auc: 0.7853
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.8668, instance_loss: 0.4484, weighted_loss: 0.7413, label: 2, bag_size: 617
batch 39, loss: 3.4742, instance_loss: 0.6689, weighted_loss: 2.6326, label: 3, bag_size: 508
batch 59, loss: 1.4214, instance_loss: 0.4399, weighted_loss: 1.1270, label: 4, bag_size: 712
batch 79, loss: 0.7982, instance_loss: 0.5186, weighted_loss: 0.7143, label: 1, bag_size: 906
batch 99, loss: 0.7193, instance_loss: 0.4943, weighted_loss: 0.6518, label: 3, bag_size: 1147
batch 119, loss: 1.0886, instance_loss: 0.5877, weighted_loss: 0.9384, label: 0, bag_size: 316
batch 139, loss: 0.0011, instance_loss: 0.3326, weighted_loss: 0.1005, label: 0, bag_size: 138
batch 159, loss: 0.4867, instance_loss: 0.5096, weighted_loss: 0.4936, label: 2, bag_size: 25
batch 179, loss: 0.8833, instance_loss: 0.4674, weighted_loss: 0.7585, label: 4, bag_size: 689
batch 199, loss: 0.9617, instance_loss: 0.5088, weighted_loss: 0.8259, label: 2, bag_size: 645
batch 219, loss: 0.8904, instance_loss: 0.3810, weighted_loss: 0.7376, label: 4, bag_size: 244
batch 239, loss: 0.5040, instance_loss: 0.4382, weighted_loss: 0.4842, label: 1, bag_size: 460
batch 259, loss: 0.5710, instance_loss: 0.3462, weighted_loss: 0.5036, label: 2, bag_size: 631
batch 279, loss: 0.5559, instance_loss: 0.5224, weighted_loss: 0.5458, label: 0, bag_size: 435
batch 299, loss: 0.0347, instance_loss: 0.3151, weighted_loss: 0.1188, label: 0, bag_size: 350
batch 319, loss: 1.2329, instance_loss: 0.4976, weighted_loss: 1.0123, label: 2, bag_size: 290
batch 339, loss: 1.0932, instance_loss: 0.5030, weighted_loss: 0.9162, label: 4, bag_size: 1064
batch 359, loss: 1.1546, instance_loss: 0.4993, weighted_loss: 0.9580, label: 2, bag_size: 633
batch 379, loss: 0.4797, instance_loss: 0.4969, weighted_loss: 0.4849, label: 0, bag_size: 404
batch 399, loss: 0.0411, instance_loss: 0.3307, weighted_loss: 0.1280, label: 0, bag_size: 210
batch 419, loss: 0.4048, instance_loss: 0.4210, weighted_loss: 0.4097, label: 2, bag_size: 315
batch 439, loss: 1.3616, instance_loss: 0.5578, weighted_loss: 1.1205, label: 0, bag_size: 247
batch 459, loss: 0.9396, instance_loss: 0.4908, weighted_loss: 0.8049, label: 3, bag_size: 472
batch 479, loss: 2.0205, instance_loss: 0.6416, weighted_loss: 1.6068, label: 4, bag_size: 699
batch 499, loss: 0.6597, instance_loss: 0.3973, weighted_loss: 0.5810, label: 0, bag_size: 581
batch 519, loss: 1.6919, instance_loss: 0.7670, weighted_loss: 1.4145, label: 2, bag_size: 297
batch 539, loss: 0.9453, instance_loss: 0.4304, weighted_loss: 0.7908, label: 4, bag_size: 868
batch 559, loss: 0.1768, instance_loss: 0.3947, weighted_loss: 0.2422, label: 0, bag_size: 578
batch 579, loss: 4.2796, instance_loss: 0.7700, weighted_loss: 3.2267, label: 0, bag_size: 1039


class 0 clustering acc 0.9975589225589225: correct 23702/23760
class 1 clustering acc 0.01999158249158249: correct 95/4752
Epoch: 62, train_loss: 1.0605, train_clustering_loss:  0.4872, train_error: 0.4630
class 0: acc 0.7560975609756098, correct 93/123
class 1: acc 0.5042016806722689, correct 60/119
class 2: acc 0.40601503759398494, correct 54/133
class 3: acc 0.42424242424242425, correct 42/99
class 4: acc 0.5833333333333334, correct 70/120

Val Set, val_loss: 1.2423, val_error: 0.5135, auc: 0.7778
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.3845, instance_loss: 0.4531, weighted_loss: 1.1051, label: 2, bag_size: 470
batch 39, loss: 0.6195, instance_loss: 0.4592, weighted_loss: 0.5714, label: 2, bag_size: 558
batch 59, loss: 0.6984, instance_loss: 0.4605, weighted_loss: 0.6270, label: 3, bag_size: 428
batch 79, loss: 1.1420, instance_loss: 0.4362, weighted_loss: 0.9302, label: 2, bag_size: 522
batch 99, loss: 0.4784, instance_loss: 0.4896, weighted_loss: 0.4818, label: 1, bag_size: 607
batch 119, loss: 0.5397, instance_loss: 0.4557, weighted_loss: 0.5145, label: 1, bag_size: 906
batch 139, loss: 1.8093, instance_loss: 0.5078, weighted_loss: 1.4188, label: 4, bag_size: 438
batch 159, loss: 0.7701, instance_loss: 0.4821, weighted_loss: 0.6837, label: 2, bag_size: 119
batch 179, loss: 0.6950, instance_loss: 0.4221, weighted_loss: 0.6131, label: 3, bag_size: 510
batch 199, loss: 1.2439, instance_loss: 0.5064, weighted_loss: 1.0226, label: 4, bag_size: 854
batch 219, loss: 1.2088, instance_loss: 0.5507, weighted_loss: 1.0114, label: 4, bag_size: 277
batch 239, loss: 1.2973, instance_loss: 0.4504, weighted_loss: 1.0432, label: 3, bag_size: 1154
batch 259, loss: 0.2650, instance_loss: 0.4023, weighted_loss: 0.3062, label: 0, bag_size: 122
batch 279, loss: 0.3649, instance_loss: 0.3928, weighted_loss: 0.3733, label: 1, bag_size: 1121
batch 299, loss: 1.2406, instance_loss: 0.4643, weighted_loss: 1.0077, label: 1, bag_size: 605
batch 319, loss: 2.2580, instance_loss: 0.7228, weighted_loss: 1.7975, label: 0, bag_size: 745
batch 339, loss: 0.8752, instance_loss: 0.4798, weighted_loss: 0.7566, label: 3, bag_size: 154
batch 359, loss: 0.6869, instance_loss: 0.3960, weighted_loss: 0.5996, label: 1, bag_size: 1043
batch 379, loss: 0.4695, instance_loss: 0.3941, weighted_loss: 0.4469, label: 0, bag_size: 231
batch 399, loss: 1.4051, instance_loss: 0.5210, weighted_loss: 1.1398, label: 0, bag_size: 367
batch 419, loss: 0.2137, instance_loss: 0.4330, weighted_loss: 0.2795, label: 0, bag_size: 316
batch 439, loss: 0.0000, instance_loss: 0.6707, weighted_loss: 0.2012, label: 4, bag_size: 359
batch 459, loss: 1.6062, instance_loss: 0.5930, weighted_loss: 1.3022, label: 2, bag_size: 288
batch 479, loss: 1.6886, instance_loss: 0.5626, weighted_loss: 1.3508, label: 2, bag_size: 754
batch 499, loss: 0.8862, instance_loss: 0.6497, weighted_loss: 0.8152, label: 2, bag_size: 1074
batch 519, loss: 0.8889, instance_loss: 0.5133, weighted_loss: 0.7762, label: 4, bag_size: 476
batch 539, loss: 0.7055, instance_loss: 0.3864, weighted_loss: 0.6097, label: 4, bag_size: 604
batch 559, loss: 2.4814, instance_loss: 0.5772, weighted_loss: 1.9102, label: 4, bag_size: 264
batch 579, loss: 1.8891, instance_loss: 0.5767, weighted_loss: 1.4954, label: 1, bag_size: 981


class 0 clustering acc 0.9984848484848485: correct 23724/23760
class 1 clustering acc 0.013888888888888888: correct 66/4752
Epoch: 63, train_loss: 0.9789, train_clustering_loss:  0.4856, train_error: 0.3973
class 0: acc 0.8317757009345794, correct 89/107
class 1: acc 0.6446280991735537, correct 78/121
class 2: acc 0.36885245901639346, correct 45/122
class 3: acc 0.6934306569343066, correct 95/137
class 4: acc 0.4766355140186916, correct 51/107

Val Set, val_loss: 1.2563, val_error: 0.5676, auc: 0.7743
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0767, instance_loss: 0.3107, weighted_loss: 0.1469, label: 0, bag_size: 435
batch 39, loss: 2.7897, instance_loss: 0.8702, weighted_loss: 2.2138, label: 0, bag_size: 600
batch 59, loss: 1.6350, instance_loss: 0.4913, weighted_loss: 1.2919, label: 3, bag_size: 342
batch 79, loss: 0.7199, instance_loss: 0.4695, weighted_loss: 0.6448, label: 2, bag_size: 697
batch 99, loss: 0.4924, instance_loss: 0.4585, weighted_loss: 0.4823, label: 0, bag_size: 404
batch 119, loss: 0.4409, instance_loss: 0.3830, weighted_loss: 0.4235, label: 4, bag_size: 418
batch 139, loss: 1.4975, instance_loss: 0.4767, weighted_loss: 1.1913, label: 2, bag_size: 633
batch 159, loss: 0.9496, instance_loss: 0.4890, weighted_loss: 0.8114, label: 3, bag_size: 566
batch 179, loss: 1.1087, instance_loss: 0.4293, weighted_loss: 0.9049, label: 3, bag_size: 1022
batch 199, loss: 1.3869, instance_loss: 0.4398, weighted_loss: 1.1028, label: 2, bag_size: 597
batch 219, loss: 0.3424, instance_loss: 0.5354, weighted_loss: 0.4003, label: 4, bag_size: 506
batch 239, loss: 3.1945, instance_loss: 0.6793, weighted_loss: 2.4399, label: 2, bag_size: 1308
batch 259, loss: 0.6893, instance_loss: 0.4694, weighted_loss: 0.6234, label: 3, bag_size: 486
batch 279, loss: 0.8395, instance_loss: 0.4392, weighted_loss: 0.7194, label: 0, bag_size: 566
batch 299, loss: 1.0803, instance_loss: 0.5700, weighted_loss: 0.9272, label: 0, bag_size: 183
batch 319, loss: 1.4874, instance_loss: 0.6370, weighted_loss: 1.2323, label: 0, bag_size: 1570
batch 339, loss: 0.4732, instance_loss: 0.5043, weighted_loss: 0.4825, label: 3, bag_size: 428
batch 359, loss: 0.6696, instance_loss: 0.4453, weighted_loss: 0.6023, label: 1, bag_size: 413
batch 379, loss: 0.0133, instance_loss: 0.4772, weighted_loss: 0.1525, label: 3, bag_size: 403
batch 399, loss: 0.9569, instance_loss: 0.4308, weighted_loss: 0.7991, label: 2, bag_size: 558
batch 419, loss: 1.6275, instance_loss: 0.4967, weighted_loss: 1.2883, label: 3, bag_size: 641
batch 439, loss: 1.3268, instance_loss: 0.5507, weighted_loss: 1.0940, label: 3, bag_size: 500
batch 459, loss: 1.1652, instance_loss: 0.4828, weighted_loss: 0.9605, label: 0, bag_size: 169
batch 479, loss: 0.7487, instance_loss: 0.4548, weighted_loss: 0.6605, label: 1, bag_size: 599
batch 499, loss: 1.4369, instance_loss: 0.4997, weighted_loss: 1.1557, label: 2, bag_size: 554
batch 519, loss: 0.4612, instance_loss: 0.4091, weighted_loss: 0.4456, label: 2, bag_size: 754
batch 539, loss: 1.7040, instance_loss: 0.4619, weighted_loss: 1.3314, label: 4, bag_size: 868
batch 559, loss: 1.6828, instance_loss: 0.5778, weighted_loss: 1.3513, label: 3, bag_size: 282
batch 579, loss: 0.0877, instance_loss: 0.4032, weighted_loss: 0.1824, label: 0, bag_size: 133


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.022095959595959596: correct 105/4752
Epoch: 64, train_loss: 0.9272, train_clustering_loss:  0.4800, train_error: 0.3855
class 0: acc 0.8211382113821138, correct 101/123
class 1: acc 0.635593220338983, correct 75/118
class 2: acc 0.38461538461538464, correct 50/130
class 3: acc 0.6153846153846154, correct 64/104
class 4: acc 0.6302521008403361, correct 75/119

Val Set, val_loss: 1.1946, val_error: 0.5270, auc: 0.7724
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.6145, instance_loss: 0.5068, weighted_loss: 0.5822, label: 1, bag_size: 1009
batch 39, loss: 0.1838, instance_loss: 0.5418, weighted_loss: 0.2912, label: 1, bag_size: 44
batch 59, loss: 0.0826, instance_loss: 0.3341, weighted_loss: 0.1581, label: 0, bag_size: 354
batch 79, loss: 0.9473, instance_loss: 0.4593, weighted_loss: 0.8009, label: 1, bag_size: 981
batch 99, loss: 0.0454, instance_loss: 0.3767, weighted_loss: 0.1448, label: 0, bag_size: 370
batch 119, loss: 0.5973, instance_loss: 0.4709, weighted_loss: 0.5594, label: 3, bag_size: 428
batch 139, loss: 1.1580, instance_loss: 0.5020, weighted_loss: 0.9612, label: 4, bag_size: 687
batch 159, loss: 1.9834, instance_loss: 0.4948, weighted_loss: 1.5368, label: 0, bag_size: 214
batch 179, loss: 1.6733, instance_loss: 0.5944, weighted_loss: 1.3496, label: 2, bag_size: 367
batch 199, loss: 1.4756, instance_loss: 0.5533, weighted_loss: 1.1989, label: 2, bag_size: 133
batch 219, loss: 0.4024, instance_loss: 0.5306, weighted_loss: 0.4409, label: 0, bag_size: 224
batch 239, loss: 0.4557, instance_loss: 0.4282, weighted_loss: 0.4475, label: 1, bag_size: 766
batch 259, loss: 0.9604, instance_loss: 0.4404, weighted_loss: 0.8044, label: 3, bag_size: 944
batch 279, loss: 0.5682, instance_loss: 0.4749, weighted_loss: 0.5402, label: 0, bag_size: 493
batch 299, loss: 1.1699, instance_loss: 0.4678, weighted_loss: 0.9593, label: 2, bag_size: 105
batch 319, loss: 0.0764, instance_loss: 0.3499, weighted_loss: 0.1584, label: 0, bag_size: 435
batch 339, loss: 1.2608, instance_loss: 0.4662, weighted_loss: 1.0224, label: 2, bag_size: 597
batch 359, loss: 0.0000, instance_loss: 0.4677, weighted_loss: 0.1403, label: 2, bag_size: 553
batch 379, loss: 0.4433, instance_loss: 0.7475, weighted_loss: 0.5345, label: 3, bag_size: 674
batch 399, loss: 1.3333, instance_loss: 0.4817, weighted_loss: 1.0778, label: 1, bag_size: 177
batch 419, loss: 0.1751, instance_loss: 0.3527, weighted_loss: 0.2283, label: 4, bag_size: 266
batch 439, loss: 2.3450, instance_loss: 0.6938, weighted_loss: 1.8496, label: 0, bag_size: 370
batch 459, loss: 0.0905, instance_loss: 0.4735, weighted_loss: 0.2054, label: 4, bag_size: 683
batch 479, loss: 0.7398, instance_loss: 0.4487, weighted_loss: 0.6525, label: 0, bag_size: 122
batch 499, loss: 1.5309, instance_loss: 0.4818, weighted_loss: 1.2162, label: 4, bag_size: 685
batch 519, loss: 1.1083, instance_loss: 0.5417, weighted_loss: 0.9383, label: 3, bag_size: 282
batch 539, loss: 0.7410, instance_loss: 0.4058, weighted_loss: 0.6404, label: 0, bag_size: 122
batch 559, loss: 0.6903, instance_loss: 0.4982, weighted_loss: 0.6327, label: 3, bag_size: 1078
batch 579, loss: 0.8735, instance_loss: 0.5319, weighted_loss: 0.7710, label: 1, bag_size: 221


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.01999158249158249: correct 95/4752
Epoch: 65, train_loss: 0.9830, train_clustering_loss:  0.4841, train_error: 0.4175
class 0: acc 0.8050847457627118, correct 95/118
class 1: acc 0.5833333333333334, correct 70/120
class 2: acc 0.3135593220338983, correct 37/118
class 3: acc 0.6456692913385826, correct 82/127
class 4: acc 0.5585585585585585, correct 62/111

Val Set, val_loss: 1.2111, val_error: 0.5541, auc: 0.7872
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.3915, instance_loss: 0.4464, weighted_loss: 1.1080, label: 4, bag_size: 468
batch 39, loss: 0.7594, instance_loss: 0.3675, weighted_loss: 0.6418, label: 0, bag_size: 343
batch 59, loss: 0.2343, instance_loss: 0.3450, weighted_loss: 0.2675, label: 0, bag_size: 79
batch 79, loss: 1.2121, instance_loss: 0.4906, weighted_loss: 0.9957, label: 3, bag_size: 154
batch 99, loss: 0.5745, instance_loss: 0.4048, weighted_loss: 0.5236, label: 4, bag_size: 204
batch 119, loss: 2.3091, instance_loss: 0.4894, weighted_loss: 1.7632, label: 2, bag_size: 208
batch 139, loss: 0.7814, instance_loss: 0.4632, weighted_loss: 0.6859, label: 0, bag_size: 615
batch 159, loss: 1.2500, instance_loss: 0.5003, weighted_loss: 1.0251, label: 2, bag_size: 375
batch 179, loss: 0.1679, instance_loss: 0.4169, weighted_loss: 0.2426, label: 0, bag_size: 354
batch 199, loss: 0.1325, instance_loss: 0.3835, weighted_loss: 0.2078, label: 0, bag_size: 122
batch 219, loss: 1.6155, instance_loss: 0.4889, weighted_loss: 1.2775, label: 3, bag_size: 488
batch 239, loss: 1.4219, instance_loss: 0.5401, weighted_loss: 1.1573, label: 3, bag_size: 282
batch 259, loss: 1.4070, instance_loss: 0.4922, weighted_loss: 1.1326, label: 1, bag_size: 208
batch 279, loss: 0.5808, instance_loss: 0.4807, weighted_loss: 0.5508, label: 3, bag_size: 858
batch 299, loss: 0.1728, instance_loss: 0.6650, weighted_loss: 0.3205, label: 1, bag_size: 44
batch 319, loss: 0.5392, instance_loss: 0.4402, weighted_loss: 0.5095, label: 1, bag_size: 617
batch 339, loss: 1.0654, instance_loss: 0.4484, weighted_loss: 0.8803, label: 1, bag_size: 925
batch 359, loss: 0.0073, instance_loss: 0.2693, weighted_loss: 0.0859, label: 0, bag_size: 280
batch 379, loss: 2.1950, instance_loss: 0.6281, weighted_loss: 1.7249, label: 1, bag_size: 45
batch 399, loss: 0.9850, instance_loss: 0.4008, weighted_loss: 0.8098, label: 3, bag_size: 342
batch 419, loss: 0.9909, instance_loss: 0.4683, weighted_loss: 0.8341, label: 3, bag_size: 781
batch 439, loss: 1.9017, instance_loss: 0.4713, weighted_loss: 1.4726, label: 1, bag_size: 616
batch 459, loss: 0.2367, instance_loss: 0.4068, weighted_loss: 0.2878, label: 0, bag_size: 316
batch 479, loss: 0.3178, instance_loss: 0.4081, weighted_loss: 0.3449, label: 4, bag_size: 665
batch 499, loss: 0.0778, instance_loss: 0.4483, weighted_loss: 0.1890, label: 0, bag_size: 76
batch 519, loss: 0.7138, instance_loss: 0.4977, weighted_loss: 0.6490, label: 4, bag_size: 377
batch 539, loss: 0.7059, instance_loss: 0.4373, weighted_loss: 0.6253, label: 1, bag_size: 766
batch 559, loss: 0.7273, instance_loss: 0.5093, weighted_loss: 0.6619, label: 3, bag_size: 804
batch 579, loss: 0.0520, instance_loss: 0.2857, weighted_loss: 0.1221, label: 0, bag_size: 350


class 0 clustering acc 0.9984006734006734: correct 23722/23760
class 1 clustering acc 0.021043771043771045: correct 100/4752
Epoch: 66, train_loss: 0.9256, train_clustering_loss:  0.4778, train_error: 0.4141
class 0: acc 0.8656716417910447, correct 116/134
class 1: acc 0.49107142857142855, correct 55/112
class 2: acc 0.3142857142857143, correct 33/105
class 3: acc 0.6229508196721312, correct 76/122
class 4: acc 0.5619834710743802, correct 68/121

Val Set, val_loss: 1.2071, val_error: 0.5676, auc: 0.7914
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5405, ROC AUC: 0.7985
Test error: 0.5000, ROC AUC: 0.8289
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9759, instance_loss: 0.5887, weighted_loss: 1.5597, label: 1, bag_size: 1121
batch 39, loss: 2.5405, instance_loss: 0.4901, weighted_loss: 1.9254, label: 2, bag_size: 953
batch 59, loss: 2.1072, instance_loss: 0.4963, weighted_loss: 1.6239, label: 3, bag_size: 1022
batch 79, loss: 1.1004, instance_loss: 0.5658, weighted_loss: 0.9400, label: 1, bag_size: 669
batch 99, loss: 2.3559, instance_loss: 0.5255, weighted_loss: 1.8068, label: 2, bag_size: 369
batch 119, loss: 0.9997, instance_loss: 0.4558, weighted_loss: 0.8365, label: 3, bag_size: 459
batch 139, loss: 1.2608, instance_loss: 0.4709, weighted_loss: 1.0238, label: 2, bag_size: 606
batch 159, loss: 2.0023, instance_loss: 0.5449, weighted_loss: 1.5651, label: 2, bag_size: 177
batch 179, loss: 1.8181, instance_loss: 0.5385, weighted_loss: 1.4342, label: 3, bag_size: 856
batch 199, loss: 2.3010, instance_loss: 0.5195, weighted_loss: 1.7666, label: 2, bag_size: 448
batch 219, loss: 0.7030, instance_loss: 0.5033, weighted_loss: 0.6431, label: 0, bag_size: 295
batch 239, loss: 2.7019, instance_loss: 0.5886, weighted_loss: 2.0679, label: 4, bag_size: 333
batch 259, loss: 1.7349, instance_loss: 0.5755, weighted_loss: 1.3871, label: 0, bag_size: 295
batch 279, loss: 1.7206, instance_loss: 0.5234, weighted_loss: 1.3614, label: 4, bag_size: 853
batch 299, loss: 3.5240, instance_loss: 0.6646, weighted_loss: 2.6662, label: 0, bag_size: 732
batch 319, loss: 1.5231, instance_loss: 0.5443, weighted_loss: 1.2295, label: 3, bag_size: 492
batch 339, loss: 1.7261, instance_loss: 0.4320, weighted_loss: 1.3379, label: 1, bag_size: 855
batch 359, loss: 2.1174, instance_loss: 0.5526, weighted_loss: 1.6480, label: 4, bag_size: 960
batch 379, loss: 1.5343, instance_loss: 0.5657, weighted_loss: 1.2437, label: 2, bag_size: 936
batch 399, loss: 0.2818, instance_loss: 0.4000, weighted_loss: 0.3172, label: 0, bag_size: 280
batch 419, loss: 2.3910, instance_loss: 0.5736, weighted_loss: 1.8458, label: 1, bag_size: 391
batch 439, loss: 2.1869, instance_loss: 0.6327, weighted_loss: 1.7206, label: 0, bag_size: 1085
batch 459, loss: 0.8789, instance_loss: 0.4391, weighted_loss: 0.7470, label: 1, bag_size: 1043
batch 479, loss: 2.0923, instance_loss: 0.4681, weighted_loss: 1.6050, label: 0, bag_size: 62
batch 499, loss: 3.2543, instance_loss: 0.6215, weighted_loss: 2.4645, label: 3, bag_size: 282
batch 519, loss: 1.5886, instance_loss: 0.4790, weighted_loss: 1.2557, label: 1, bag_size: 208
batch 539, loss: 1.2274, instance_loss: 0.5566, weighted_loss: 1.0261, label: 3, bag_size: 631
batch 559, loss: 1.8898, instance_loss: 0.5426, weighted_loss: 1.4856, label: 4, bag_size: 592
batch 579, loss: 1.6031, instance_loss: 0.5166, weighted_loss: 1.2771, label: 2, bag_size: 318


class 0 clustering acc 0.9982323232323232: correct 23718/23760
class 1 clustering acc 0.001893939393939394: correct 9/4752
Epoch: 0, train_loss: 1.5640, train_clustering_loss:  0.5234, train_error: 0.6902
class 0: acc 0.6403508771929824, correct 73/114
class 1: acc 0.3076923076923077, correct 40/130
class 2: acc 0.15384615384615385, correct 18/117
class 3: acc 0.19658119658119658, correct 23/117
class 4: acc 0.25862068965517243, correct 30/116

Val Set, val_loss: 1.5425, val_error: 0.6081, auc: 0.6813
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.542452).  Saving model ...


batch 19, loss: 1.8903, instance_loss: 0.5082, weighted_loss: 1.4757, label: 3, bag_size: 97
batch 39, loss: 0.1942, instance_loss: 0.4087, weighted_loss: 0.2585, label: 0, bag_size: 251
batch 59, loss: 2.3527, instance_loss: 0.6790, weighted_loss: 1.8506, label: 0, bag_size: 964
batch 79, loss: 1.3197, instance_loss: 0.5386, weighted_loss: 1.0853, label: 2, bag_size: 25
batch 99, loss: 1.6253, instance_loss: 0.4674, weighted_loss: 1.2779, label: 2, bag_size: 563
batch 119, loss: 1.0393, instance_loss: 0.4404, weighted_loss: 0.8596, label: 1, bag_size: 398
batch 139, loss: 1.1929, instance_loss: 0.4454, weighted_loss: 0.9687, label: 1, bag_size: 593
batch 159, loss: 1.0947, instance_loss: 0.4896, weighted_loss: 0.9132, label: 4, bag_size: 446
batch 179, loss: 3.4743, instance_loss: 0.7756, weighted_loss: 2.6647, label: 0, bag_size: 352
batch 199, loss: 0.4657, instance_loss: 0.3556, weighted_loss: 0.4327, label: 0, bag_size: 231
batch 219, loss: 0.2092, instance_loss: 0.3492, weighted_loss: 0.2512, label: 0, bag_size: 190
batch 239, loss: 2.5921, instance_loss: 0.5979, weighted_loss: 1.9938, label: 2, bag_size: 607
batch 259, loss: 1.3275, instance_loss: 0.5048, weighted_loss: 1.0807, label: 1, bag_size: 1009
batch 279, loss: 2.5089, instance_loss: 0.6730, weighted_loss: 1.9581, label: 0, bag_size: 888
batch 299, loss: 2.0324, instance_loss: 0.6104, weighted_loss: 1.6058, label: 3, bag_size: 282
batch 319, loss: 0.1245, instance_loss: 0.3517, weighted_loss: 0.1927, label: 0, bag_size: 268
batch 339, loss: 1.1662, instance_loss: 0.4965, weighted_loss: 0.9653, label: 0, bag_size: 642
batch 359, loss: 1.2774, instance_loss: 0.5262, weighted_loss: 1.0521, label: 4, bag_size: 503
batch 379, loss: 1.2315, instance_loss: 0.4589, weighted_loss: 0.9997, label: 3, bag_size: 235
batch 399, loss: 1.6951, instance_loss: 0.5380, weighted_loss: 1.3479, label: 4, bag_size: 1031
batch 419, loss: 1.3191, instance_loss: 0.4589, weighted_loss: 1.0611, label: 1, bag_size: 311
batch 439, loss: 1.1032, instance_loss: 0.4813, weighted_loss: 0.9166, label: 4, bag_size: 730
batch 459, loss: 3.0675, instance_loss: 0.5272, weighted_loss: 2.3054, label: 0, bag_size: 62
batch 479, loss: 1.8084, instance_loss: 0.5689, weighted_loss: 1.4366, label: 4, bag_size: 986
batch 499, loss: 3.8269, instance_loss: 0.8017, weighted_loss: 2.9194, label: 0, bag_size: 421
batch 519, loss: 1.8099, instance_loss: 0.5449, weighted_loss: 1.4304, label: 2, bag_size: 809
batch 539, loss: 0.3678, instance_loss: 0.3561, weighted_loss: 0.3643, label: 0, bag_size: 354
batch 559, loss: 3.2625, instance_loss: 0.6499, weighted_loss: 2.4787, label: 3, bag_size: 638
batch 579, loss: 1.2830, instance_loss: 0.5139, weighted_loss: 1.0523, label: 2, bag_size: 380


class 0 clustering acc 0.9997474747474747: correct 23754/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 1, train_loss: 1.4238, train_clustering_loss:  0.5015, train_error: 0.6549
class 0: acc 0.7226890756302521, correct 86/119
class 1: acc 0.21705426356589147, correct 28/129
class 2: acc 0.2857142857142857, correct 32/112
class 3: acc 0.30952380952380953, correct 39/126
class 4: acc 0.18518518518518517, correct 20/108

Val Set, val_loss: 1.5524, val_error: 0.6757, auc: 0.6336
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9158, instance_loss: 0.3919, weighted_loss: 0.7586, label: 3, bag_size: 488
batch 39, loss: 2.2701, instance_loss: 0.5453, weighted_loss: 1.7527, label: 1, bag_size: 875
batch 59, loss: 1.9199, instance_loss: 0.6610, weighted_loss: 1.5423, label: 2, bag_size: 339
batch 79, loss: 1.0676, instance_loss: 0.4443, weighted_loss: 0.8806, label: 0, bag_size: 79
batch 99, loss: 1.2519, instance_loss: 0.5296, weighted_loss: 1.0352, label: 4, bag_size: 1104
batch 119, loss: 1.7626, instance_loss: 0.5196, weighted_loss: 1.3897, label: 1, bag_size: 391
batch 139, loss: 1.5604, instance_loss: 0.5456, weighted_loss: 1.2560, label: 3, bag_size: 1060
batch 159, loss: 1.3838, instance_loss: 0.5029, weighted_loss: 1.1195, label: 4, bag_size: 520
batch 179, loss: 1.7671, instance_loss: 0.4754, weighted_loss: 1.3796, label: 1, bag_size: 389
batch 199, loss: 1.3918, instance_loss: 0.5612, weighted_loss: 1.1426, label: 1, bag_size: 201
batch 219, loss: 2.1252, instance_loss: 0.5713, weighted_loss: 1.6590, label: 0, bag_size: 1073
batch 239, loss: 1.1605, instance_loss: 0.4886, weighted_loss: 0.9589, label: 4, bag_size: 318
batch 259, loss: 1.4368, instance_loss: 0.5335, weighted_loss: 1.1658, label: 3, bag_size: 492
batch 279, loss: 1.8874, instance_loss: 0.5041, weighted_loss: 1.4724, label: 1, bag_size: 410
batch 299, loss: 0.7802, instance_loss: 0.4419, weighted_loss: 0.6787, label: 0, bag_size: 615
batch 319, loss: 0.9590, instance_loss: 0.5382, weighted_loss: 0.8328, label: 3, bag_size: 961
batch 339, loss: 3.4849, instance_loss: 0.6639, weighted_loss: 2.6386, label: 4, bag_size: 482
batch 359, loss: 1.1390, instance_loss: 0.4839, weighted_loss: 0.9425, label: 1, bag_size: 271
batch 379, loss: 1.1576, instance_loss: 0.4563, weighted_loss: 0.9472, label: 3, bag_size: 1057
batch 399, loss: 0.2625, instance_loss: 0.4142, weighted_loss: 0.3080, label: 2, bag_size: 1608
batch 419, loss: 1.9248, instance_loss: 0.5347, weighted_loss: 1.5077, label: 4, bag_size: 797
batch 439, loss: 1.5121, instance_loss: 0.5012, weighted_loss: 1.2088, label: 0, bag_size: 566
batch 459, loss: 1.5052, instance_loss: 0.4692, weighted_loss: 1.1944, label: 2, bag_size: 1060
batch 479, loss: 1.2631, instance_loss: 0.5358, weighted_loss: 1.0450, label: 4, bag_size: 468
batch 499, loss: 1.1950, instance_loss: 0.4966, weighted_loss: 0.9855, label: 4, bag_size: 854
batch 519, loss: 0.2118, instance_loss: 0.3901, weighted_loss: 0.2653, label: 0, bag_size: 282
batch 539, loss: 1.5891, instance_loss: 0.5671, weighted_loss: 1.2825, label: 3, bag_size: 1186
batch 559, loss: 0.3180, instance_loss: 0.4870, weighted_loss: 0.3687, label: 2, bag_size: 936
batch 579, loss: 0.1946, instance_loss: 0.4197, weighted_loss: 0.2621, label: 0, bag_size: 97


class 0 clustering acc 1.0: correct 23760/23760
class 1 clustering acc 0.00021043771043771043: correct 1/4752
Epoch: 2, train_loss: 1.4088, train_clustering_loss:  0.5062, train_error: 0.6616
class 0: acc 0.6942148760330579, correct 84/121
class 1: acc 0.1693548387096774, correct 21/124
class 2: acc 0.12727272727272726, correct 14/110
class 3: acc 0.2892561983471074, correct 35/121
class 4: acc 0.3983050847457627, correct 47/118

Val Set, val_loss: 1.6576, val_error: 0.7297, auc: 0.6259
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.9113, instance_loss: 0.6084, weighted_loss: 1.5205, label: 2, bag_size: 535
batch 39, loss: 1.4020, instance_loss: 0.5187, weighted_loss: 1.1370, label: 2, bag_size: 119
batch 59, loss: 1.9103, instance_loss: 0.5025, weighted_loss: 1.4880, label: 0, bag_size: 732
batch 79, loss: 1.5996, instance_loss: 0.6896, weighted_loss: 1.3266, label: 3, bag_size: 1154
batch 99, loss: 1.7686, instance_loss: 0.5696, weighted_loss: 1.4089, label: 1, bag_size: 855
batch 119, loss: 1.2323, instance_loss: 0.5019, weighted_loss: 1.0132, label: 3, bag_size: 899
batch 139, loss: 1.0635, instance_loss: 0.5003, weighted_loss: 0.8945, label: 2, bag_size: 659
batch 159, loss: 1.7271, instance_loss: 0.5100, weighted_loss: 1.3620, label: 4, bag_size: 944
batch 179, loss: 1.0842, instance_loss: 0.4666, weighted_loss: 0.8989, label: 3, bag_size: 631
batch 199, loss: 2.4890, instance_loss: 0.6159, weighted_loss: 1.9271, label: 3, bag_size: 282
batch 219, loss: 2.2230, instance_loss: 0.5715, weighted_loss: 1.7275, label: 4, bag_size: 342
batch 239, loss: 1.3299, instance_loss: 0.5470, weighted_loss: 1.0950, label: 1, bag_size: 605
batch 259, loss: 3.3190, instance_loss: 0.5981, weighted_loss: 2.5028, label: 3, bag_size: 638
batch 279, loss: 1.1407, instance_loss: 0.4649, weighted_loss: 0.9379, label: 3, bag_size: 663
batch 299, loss: 1.1168, instance_loss: 0.4938, weighted_loss: 0.9299, label: 3, bag_size: 500
batch 319, loss: 1.6681, instance_loss: 0.5504, weighted_loss: 1.3328, label: 1, bag_size: 221
batch 339, loss: 1.8283, instance_loss: 0.7175, weighted_loss: 1.4951, label: 0, bag_size: 421
batch 359, loss: 0.9072, instance_loss: 0.5134, weighted_loss: 0.7891, label: 4, bag_size: 1113
batch 379, loss: 1.3942, instance_loss: 0.5124, weighted_loss: 1.1297, label: 1, bag_size: 328
batch 399, loss: 1.3924, instance_loss: 0.5080, weighted_loss: 1.1271, label: 1, bag_size: 1082
batch 419, loss: 1.7132, instance_loss: 0.5115, weighted_loss: 1.3527, label: 3, bag_size: 192
batch 439, loss: 0.1501, instance_loss: 0.4177, weighted_loss: 0.2304, label: 0, bag_size: 615
batch 459, loss: 1.6873, instance_loss: 0.5107, weighted_loss: 1.3343, label: 3, bag_size: 781
batch 479, loss: 0.1495, instance_loss: 0.3189, weighted_loss: 0.2003, label: 0, bag_size: 33
batch 499, loss: 1.5133, instance_loss: 0.5510, weighted_loss: 1.2246, label: 3, bag_size: 856
batch 519, loss: 1.9196, instance_loss: 0.5100, weighted_loss: 1.4967, label: 2, bag_size: 769
batch 539, loss: 1.3739, instance_loss: 0.4784, weighted_loss: 1.1053, label: 1, bag_size: 328
batch 559, loss: 1.8123, instance_loss: 0.5476, weighted_loss: 1.4329, label: 3, bag_size: 857
batch 579, loss: 0.5183, instance_loss: 0.3989, weighted_loss: 0.4825, label: 4, bag_size: 773


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.002946127946127946: correct 14/4752
Epoch: 3, train_loss: 1.3651, train_clustering_loss:  0.4998, train_error: 0.6094
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.2288135593220339, correct 27/118
class 2: acc 0.30708661417322836, correct 39/127
class 3: acc 0.24778761061946902, correct 28/113
class 4: acc 0.3394495412844037, correct 37/109

Val Set, val_loss: 1.4704, val_error: 0.5676, auc: 0.6604
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.542452 --> 1.470380).  Saving model ...


batch 19, loss: 1.5242, instance_loss: 0.5309, weighted_loss: 1.2262, label: 4, bag_size: 740
batch 39, loss: 0.0293, instance_loss: 0.3606, weighted_loss: 0.1287, label: 0, bag_size: 175
batch 59, loss: 1.7738, instance_loss: 0.5383, weighted_loss: 1.4031, label: 1, bag_size: 814
batch 79, loss: 1.6644, instance_loss: 0.5512, weighted_loss: 1.3304, label: 1, bag_size: 925
batch 99, loss: 1.7404, instance_loss: 0.5175, weighted_loss: 1.3735, label: 4, bag_size: 366
batch 119, loss: 2.2426, instance_loss: 0.5553, weighted_loss: 1.7364, label: 0, bag_size: 732
batch 139, loss: 1.6153, instance_loss: 0.5041, weighted_loss: 1.2819, label: 4, bag_size: 862
batch 159, loss: 1.5426, instance_loss: 0.5076, weighted_loss: 1.2321, label: 4, bag_size: 986
batch 179, loss: 0.2417, instance_loss: 0.3313, weighted_loss: 0.2686, label: 0, bag_size: 73
batch 199, loss: 1.3470, instance_loss: 0.4130, weighted_loss: 1.0668, label: 1, bag_size: 1103
batch 219, loss: 1.4583, instance_loss: 0.4738, weighted_loss: 1.1630, label: 4, bag_size: 1031
batch 239, loss: 0.7926, instance_loss: 0.5473, weighted_loss: 0.7190, label: 2, bag_size: 596
batch 259, loss: 1.8812, instance_loss: 0.6074, weighted_loss: 1.4990, label: 1, bag_size: 1360
batch 279, loss: 1.3107, instance_loss: 0.4709, weighted_loss: 1.0587, label: 0, bag_size: 888
batch 299, loss: 1.2699, instance_loss: 0.4891, weighted_loss: 1.0357, label: 1, bag_size: 823
batch 319, loss: 2.0378, instance_loss: 0.6102, weighted_loss: 1.6095, label: 3, bag_size: 956
batch 339, loss: 1.5137, instance_loss: 0.4693, weighted_loss: 1.2004, label: 4, bag_size: 399
batch 359, loss: 1.3810, instance_loss: 0.4937, weighted_loss: 1.1148, label: 2, bag_size: 860
batch 379, loss: 1.8351, instance_loss: 0.5687, weighted_loss: 1.4552, label: 4, bag_size: 246
batch 399, loss: 2.4157, instance_loss: 0.6262, weighted_loss: 1.8788, label: 4, bag_size: 482
batch 419, loss: 1.2176, instance_loss: 0.4615, weighted_loss: 0.9908, label: 2, bag_size: 853
batch 439, loss: 2.3253, instance_loss: 0.6457, weighted_loss: 1.8214, label: 4, bag_size: 592
batch 459, loss: 1.3817, instance_loss: 0.5098, weighted_loss: 1.1201, label: 4, bag_size: 660
batch 479, loss: 1.2462, instance_loss: 0.4351, weighted_loss: 1.0029, label: 4, bag_size: 574
batch 499, loss: 1.2689, instance_loss: 0.4782, weighted_loss: 1.0317, label: 3, bag_size: 739
batch 519, loss: 2.2999, instance_loss: 0.5758, weighted_loss: 1.7826, label: 1, bag_size: 272
batch 539, loss: 1.3569, instance_loss: 0.4745, weighted_loss: 1.0922, label: 3, bag_size: 1021
batch 559, loss: 1.5186, instance_loss: 0.5540, weighted_loss: 1.2292, label: 3, bag_size: 301
batch 579, loss: 1.8633, instance_loss: 0.6068, weighted_loss: 1.4864, label: 4, bag_size: 277


class 0 clustering acc 0.9991582491582491: correct 23740/23760
class 1 clustering acc 0.012836700336700337: correct 61/4752
Epoch: 4, train_loss: 1.3604, train_clustering_loss:  0.4975, train_error: 0.6010
class 0: acc 0.8166666666666667, correct 98/120
class 1: acc 0.09259259259259259, correct 10/108
class 2: acc 0.4485294117647059, correct 61/136
class 3: acc 0.16981132075471697, correct 18/106
class 4: acc 0.4032258064516129, correct 50/124

Val Set, val_loss: 1.6364, val_error: 0.6351, auc: 0.6705
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5, correct 8/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0803, instance_loss: 0.3665, weighted_loss: 0.1662, label: 0, bag_size: 76
batch 39, loss: 0.9715, instance_loss: 0.4383, weighted_loss: 0.8115, label: 2, bag_size: 783
batch 59, loss: 0.0587, instance_loss: 0.2727, weighted_loss: 0.1229, label: 0, bag_size: 282
batch 79, loss: 1.3295, instance_loss: 0.4905, weighted_loss: 1.0778, label: 3, bag_size: 102
batch 99, loss: 1.7134, instance_loss: 0.5483, weighted_loss: 1.3639, label: 2, bag_size: 339
batch 119, loss: 0.8403, instance_loss: 0.4540, weighted_loss: 0.7244, label: 3, bag_size: 344
batch 139, loss: 1.6090, instance_loss: 0.5105, weighted_loss: 1.2794, label: 1, bag_size: 544
batch 159, loss: 1.0859, instance_loss: 0.4011, weighted_loss: 0.8805, label: 3, bag_size: 344
batch 179, loss: 1.4596, instance_loss: 0.5315, weighted_loss: 1.1812, label: 1, bag_size: 460
batch 199, loss: 0.3753, instance_loss: 0.4640, weighted_loss: 0.4019, label: 2, bag_size: 936
batch 219, loss: 1.5633, instance_loss: 0.4608, weighted_loss: 1.2326, label: 2, bag_size: 781
batch 239, loss: 1.2879, instance_loss: 0.4879, weighted_loss: 1.0479, label: 2, bag_size: 590
batch 259, loss: 2.0848, instance_loss: 0.5485, weighted_loss: 1.6239, label: 1, bag_size: 272
batch 279, loss: 1.5552, instance_loss: 0.5235, weighted_loss: 1.2457, label: 1, bag_size: 526
batch 299, loss: 1.4612, instance_loss: 0.5078, weighted_loss: 1.1752, label: 2, bag_size: 799
batch 319, loss: 0.0196, instance_loss: 0.2517, weighted_loss: 0.0892, label: 0, bag_size: 340
batch 339, loss: 1.0455, instance_loss: 0.5515, weighted_loss: 0.8973, label: 2, bag_size: 285
batch 359, loss: 1.6434, instance_loss: 0.5418, weighted_loss: 1.3129, label: 2, bag_size: 554
batch 379, loss: 2.4702, instance_loss: 0.6953, weighted_loss: 1.9377, label: 3, bag_size: 533
batch 399, loss: 1.4712, instance_loss: 0.5444, weighted_loss: 1.1932, label: 4, bag_size: 604
batch 419, loss: 0.0981, instance_loss: 0.2608, weighted_loss: 0.1469, label: 0, bag_size: 383
batch 439, loss: 1.0455, instance_loss: 0.5057, weighted_loss: 0.8835, label: 4, bag_size: 744
batch 459, loss: 1.2905, instance_loss: 0.5502, weighted_loss: 1.0684, label: 4, bag_size: 712
batch 479, loss: 1.5874, instance_loss: 0.5386, weighted_loss: 1.2727, label: 2, bag_size: 398
batch 499, loss: 1.3161, instance_loss: 0.5034, weighted_loss: 1.0723, label: 1, bag_size: 201
batch 519, loss: 1.0411, instance_loss: 0.4653, weighted_loss: 0.8683, label: 1, bag_size: 328
batch 539, loss: 1.5985, instance_loss: 0.4847, weighted_loss: 1.2643, label: 4, bag_size: 419
batch 559, loss: 1.7871, instance_loss: 0.5344, weighted_loss: 1.4113, label: 2, bag_size: 606
batch 579, loss: 4.1567, instance_loss: 0.8854, weighted_loss: 3.1753, label: 0, bag_size: 600


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.03177609427609428: correct 151/4752
Epoch: 5, train_loss: 1.2995, train_clustering_loss:  0.4967, train_error: 0.5926
class 0: acc 0.832, correct 104/125
class 1: acc 0.25833333333333336, correct 31/120
class 2: acc 0.28225806451612906, correct 35/124
class 3: acc 0.31666666666666665, correct 38/120
class 4: acc 0.3238095238095238, correct 34/105

Val Set, val_loss: 1.4523, val_error: 0.5676, auc: 0.6888
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.470380 --> 1.452349).  Saving model ...


batch 19, loss: 1.8244, instance_loss: 0.5382, weighted_loss: 1.4386, label: 1, bag_size: 599
batch 39, loss: 4.2156, instance_loss: 0.8502, weighted_loss: 3.2060, label: 0, bag_size: 169
batch 59, loss: 1.5913, instance_loss: 0.6288, weighted_loss: 1.3025, label: 2, bag_size: 315
batch 79, loss: 1.7145, instance_loss: 0.5754, weighted_loss: 1.3728, label: 3, bag_size: 166
batch 99, loss: 0.9585, instance_loss: 0.5345, weighted_loss: 0.8313, label: 4, bag_size: 683
batch 119, loss: 1.0335, instance_loss: 0.4034, weighted_loss: 0.8444, label: 1, bag_size: 874
batch 139, loss: 0.2581, instance_loss: 0.4189, weighted_loss: 0.3063, label: 0, bag_size: 71
batch 159, loss: 1.3653, instance_loss: 0.5528, weighted_loss: 1.1215, label: 2, bag_size: 616
batch 179, loss: 1.4702, instance_loss: 0.5638, weighted_loss: 1.1983, label: 3, bag_size: 301
batch 199, loss: 1.2506, instance_loss: 0.4928, weighted_loss: 1.0233, label: 2, bag_size: 812
batch 219, loss: 0.0386, instance_loss: 0.4512, weighted_loss: 0.1624, label: 0, bag_size: 366
batch 239, loss: 1.4261, instance_loss: 0.5524, weighted_loss: 1.1640, label: 1, bag_size: 1082
batch 259, loss: 0.1033, instance_loss: 0.3090, weighted_loss: 0.1650, label: 0, bag_size: 234
batch 279, loss: 1.7498, instance_loss: 0.4675, weighted_loss: 1.3651, label: 4, bag_size: 266
batch 299, loss: 1.1344, instance_loss: 0.4679, weighted_loss: 0.9345, label: 4, bag_size: 329
batch 319, loss: 1.5672, instance_loss: 0.5169, weighted_loss: 1.2521, label: 1, bag_size: 949
batch 339, loss: 1.3143, instance_loss: 0.4662, weighted_loss: 1.0598, label: 0, bag_size: 367
batch 359, loss: 0.4780, instance_loss: 0.4457, weighted_loss: 0.4683, label: 0, bag_size: 231
batch 379, loss: 1.2997, instance_loss: 0.4626, weighted_loss: 1.0486, label: 1, bag_size: 311
batch 399, loss: 2.6912, instance_loss: 0.6249, weighted_loss: 2.0713, label: 3, bag_size: 337
batch 419, loss: 1.5637, instance_loss: 0.5300, weighted_loss: 1.2536, label: 3, bag_size: 830
batch 439, loss: 1.4424, instance_loss: 0.5126, weighted_loss: 1.1635, label: 4, bag_size: 689
batch 459, loss: 1.0325, instance_loss: 0.4962, weighted_loss: 0.8716, label: 2, bag_size: 853
batch 479, loss: 1.0366, instance_loss: 0.5730, weighted_loss: 0.8975, label: 2, bag_size: 614
batch 499, loss: 1.7178, instance_loss: 0.5218, weighted_loss: 1.3590, label: 1, bag_size: 865
batch 519, loss: 0.9519, instance_loss: 0.5014, weighted_loss: 0.8167, label: 2, bag_size: 640
batch 539, loss: 1.3970, instance_loss: 0.5197, weighted_loss: 1.1338, label: 4, bag_size: 652
batch 559, loss: 1.1831, instance_loss: 0.4508, weighted_loss: 0.9634, label: 3, bag_size: 899
batch 579, loss: 1.3029, instance_loss: 0.5258, weighted_loss: 1.0698, label: 3, bag_size: 500


class 0 clustering acc 0.9992003367003367: correct 23741/23760
class 1 clustering acc 0.007786195286195286: correct 37/4752
Epoch: 6, train_loss: 1.3330, train_clustering_loss:  0.5082, train_error: 0.5774
class 0: acc 0.7698412698412699, correct 97/126
class 1: acc 0.2672413793103448, correct 31/116
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.31932773109243695, correct 38/119
class 4: acc 0.45454545454545453, correct 55/121

Val Set, val_loss: 1.4173, val_error: 0.5676, auc: 0.7007
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.07142857142857142, correct 1/14
Validation loss decreased (1.452349 --> 1.417263).  Saving model ...


batch 19, loss: 1.9090, instance_loss: 0.5003, weighted_loss: 1.4864, label: 0, bag_size: 566
batch 39, loss: 0.9704, instance_loss: 0.4445, weighted_loss: 0.8126, label: 3, bag_size: 631
batch 59, loss: 1.3186, instance_loss: 0.4805, weighted_loss: 1.0672, label: 3, bag_size: 496
batch 79, loss: 0.2930, instance_loss: 0.4976, weighted_loss: 0.3544, label: 0, bag_size: 357
batch 99, loss: 1.4732, instance_loss: 0.4803, weighted_loss: 1.1754, label: 4, bag_size: 228
batch 119, loss: 1.1449, instance_loss: 0.4726, weighted_loss: 0.9432, label: 1, bag_size: 141
batch 139, loss: 2.9974, instance_loss: 0.6236, weighted_loss: 2.2853, label: 0, bag_size: 1085
batch 159, loss: 1.4017, instance_loss: 0.5069, weighted_loss: 1.1333, label: 1, bag_size: 328
batch 179, loss: 1.4534, instance_loss: 0.4333, weighted_loss: 1.1473, label: 2, bag_size: 783
batch 199, loss: 2.7405, instance_loss: 0.5707, weighted_loss: 2.0895, label: 2, bag_size: 754
batch 219, loss: 1.5141, instance_loss: 0.5088, weighted_loss: 1.2125, label: 3, bag_size: 398
batch 239, loss: 0.1156, instance_loss: 0.3379, weighted_loss: 0.1823, label: 0, bag_size: 573
batch 259, loss: 1.0147, instance_loss: 0.4252, weighted_loss: 0.8379, label: 3, bag_size: 739
batch 279, loss: 1.0613, instance_loss: 0.4586, weighted_loss: 0.8805, label: 4, bag_size: 574
batch 299, loss: 1.5017, instance_loss: 0.5387, weighted_loss: 1.2128, label: 2, bag_size: 754
batch 319, loss: 1.6336, instance_loss: 0.5280, weighted_loss: 1.3019, label: 1, bag_size: 1360
batch 339, loss: 1.6274, instance_loss: 0.6015, weighted_loss: 1.3196, label: 0, bag_size: 178
batch 359, loss: 1.4798, instance_loss: 0.4744, weighted_loss: 1.1782, label: 2, bag_size: 877
batch 379, loss: 0.8198, instance_loss: 0.4298, weighted_loss: 0.7028, label: 4, bag_size: 1158
batch 399, loss: 1.1066, instance_loss: 0.4577, weighted_loss: 0.9119, label: 4, bag_size: 218
batch 419, loss: 1.4717, instance_loss: 0.4732, weighted_loss: 1.1721, label: 2, bag_size: 725
batch 439, loss: 1.3720, instance_loss: 0.4716, weighted_loss: 1.1018, label: 2, bag_size: 906
batch 459, loss: 1.1700, instance_loss: 0.4854, weighted_loss: 0.9646, label: 3, bag_size: 1365
batch 479, loss: 1.9372, instance_loss: 0.5601, weighted_loss: 1.5241, label: 1, bag_size: 328
batch 499, loss: 0.0942, instance_loss: 0.3110, weighted_loss: 0.1592, label: 0, bag_size: 97
batch 519, loss: 1.6555, instance_loss: 0.6246, weighted_loss: 1.3462, label: 1, bag_size: 329
batch 539, loss: 1.3106, instance_loss: 0.5180, weighted_loss: 1.0728, label: 2, bag_size: 1010
batch 559, loss: 1.1762, instance_loss: 0.5586, weighted_loss: 0.9909, label: 4, bag_size: 1064
batch 579, loss: 1.9254, instance_loss: 0.4993, weighted_loss: 1.4976, label: 2, bag_size: 1066


class 0 clustering acc 0.9992845117845118: correct 23743/23760
class 1 clustering acc 0.007996632996632997: correct 38/4752
Epoch: 7, train_loss: 1.3588, train_clustering_loss:  0.5056, train_error: 0.5993
class 0: acc 0.7524752475247525, correct 76/101
class 1: acc 0.10810810810810811, correct 12/111
class 2: acc 0.43609022556390975, correct 58/133
class 3: acc 0.3488372093023256, correct 45/129
class 4: acc 0.39166666666666666, correct 47/120

Val Set, val_loss: 1.4403, val_error: 0.5676, auc: 0.6716
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2120, instance_loss: 0.4962, weighted_loss: 0.9972, label: 4, bag_size: 689
batch 39, loss: 0.3197, instance_loss: 0.4393, weighted_loss: 0.3556, label: 0, bag_size: 212
batch 59, loss: 1.3729, instance_loss: 0.4831, weighted_loss: 1.1060, label: 4, bag_size: 714
batch 79, loss: 0.0747, instance_loss: 0.3082, weighted_loss: 0.1448, label: 0, bag_size: 517
batch 99, loss: 1.4955, instance_loss: 0.5103, weighted_loss: 1.1999, label: 1, bag_size: 1019
batch 119, loss: 2.8608, instance_loss: 0.7620, weighted_loss: 2.2312, label: 3, bag_size: 638
batch 139, loss: 0.8669, instance_loss: 0.4418, weighted_loss: 0.7394, label: 4, bag_size: 266
batch 159, loss: 2.4739, instance_loss: 0.6319, weighted_loss: 1.9213, label: 2, bag_size: 421
batch 179, loss: 1.7178, instance_loss: 0.5386, weighted_loss: 1.3641, label: 2, bag_size: 697
batch 199, loss: 1.3359, instance_loss: 0.5071, weighted_loss: 1.0873, label: 1, bag_size: 460
batch 219, loss: 1.1310, instance_loss: 0.4460, weighted_loss: 0.9255, label: 1, bag_size: 599
batch 239, loss: 1.1421, instance_loss: 0.5449, weighted_loss: 0.9629, label: 4, bag_size: 1113
batch 259, loss: 0.1097, instance_loss: 0.2412, weighted_loss: 0.1492, label: 0, bag_size: 324
batch 279, loss: 1.2284, instance_loss: 0.3953, weighted_loss: 0.9785, label: 3, bag_size: 779
batch 299, loss: 1.3968, instance_loss: 0.5037, weighted_loss: 1.1288, label: 3, bag_size: 282
batch 319, loss: 1.2870, instance_loss: 0.5257, weighted_loss: 1.0586, label: 4, bag_size: 797
batch 339, loss: 1.3560, instance_loss: 0.5364, weighted_loss: 1.1101, label: 1, bag_size: 177
batch 359, loss: 0.1066, instance_loss: 0.3209, weighted_loss: 0.1709, label: 0, bag_size: 238
batch 379, loss: 2.2761, instance_loss: 0.6268, weighted_loss: 1.7813, label: 4, bag_size: 238
batch 399, loss: 0.9948, instance_loss: 0.4315, weighted_loss: 0.8258, label: 3, bag_size: 871
batch 419, loss: 0.0293, instance_loss: 0.2470, weighted_loss: 0.0946, label: 0, bag_size: 98
batch 439, loss: 1.8309, instance_loss: 0.5541, weighted_loss: 1.4479, label: 4, bag_size: 652
batch 459, loss: 1.6697, instance_loss: 0.4705, weighted_loss: 1.3100, label: 2, bag_size: 906
batch 479, loss: 1.0580, instance_loss: 0.4996, weighted_loss: 0.8905, label: 2, bag_size: 315
batch 499, loss: 0.0192, instance_loss: 0.2476, weighted_loss: 0.0877, label: 0, bag_size: 97
batch 519, loss: 1.2848, instance_loss: 0.4043, weighted_loss: 1.0206, label: 3, bag_size: 817
batch 539, loss: 0.0220, instance_loss: 0.3187, weighted_loss: 0.1110, label: 0, bag_size: 51
batch 559, loss: 1.8394, instance_loss: 0.5755, weighted_loss: 1.4603, label: 4, bag_size: 250
batch 579, loss: 1.6709, instance_loss: 0.4873, weighted_loss: 1.3158, label: 2, bag_size: 1060


class 0 clustering acc 0.9968013468013468: correct 23684/23760
class 1 clustering acc 0.05366161616161616: correct 255/4752
Epoch: 8, train_loss: 1.2231, train_clustering_loss:  0.4821, train_error: 0.5320
class 0: acc 0.8650306748466258, correct 141/163
class 1: acc 0.31666666666666665, correct 38/120
class 2: acc 0.11827956989247312, correct 11/93
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.375, correct 39/104

Val Set, val_loss: 1.4891, val_error: 0.6351, auc: 0.6973
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0380, instance_loss: 0.4568, weighted_loss: 0.8636, label: 2, bag_size: 549
batch 39, loss: 1.4946, instance_loss: 0.5113, weighted_loss: 1.1996, label: 1, bag_size: 1043
batch 59, loss: 4.0101, instance_loss: 0.7730, weighted_loss: 3.0390, label: 0, bag_size: 608
batch 79, loss: 1.5445, instance_loss: 0.5189, weighted_loss: 1.2368, label: 2, bag_size: 744
batch 99, loss: 0.0063, instance_loss: 0.2646, weighted_loss: 0.0838, label: 0, bag_size: 268
batch 119, loss: 0.4957, instance_loss: 0.4177, weighted_loss: 0.4723, label: 1, bag_size: 874
batch 139, loss: 1.2123, instance_loss: 0.6235, weighted_loss: 1.0357, label: 4, bag_size: 1351
batch 159, loss: 0.0744, instance_loss: 0.3384, weighted_loss: 0.1536, label: 0, bag_size: 354
batch 179, loss: 1.1226, instance_loss: 0.4896, weighted_loss: 0.9327, label: 4, bag_size: 446
batch 199, loss: 0.0219, instance_loss: 0.2697, weighted_loss: 0.0962, label: 0, bag_size: 97
batch 219, loss: 1.4186, instance_loss: 0.5301, weighted_loss: 1.1520, label: 4, bag_size: 110
batch 239, loss: 1.4521, instance_loss: 0.5778, weighted_loss: 1.1899, label: 2, bag_size: 392
batch 259, loss: 0.2047, instance_loss: 0.3365, weighted_loss: 0.2442, label: 0, bag_size: 370
batch 279, loss: 2.1540, instance_loss: 0.5459, weighted_loss: 1.6715, label: 4, bag_size: 690
batch 299, loss: 1.3181, instance_loss: 0.4948, weighted_loss: 1.0711, label: 2, bag_size: 684
batch 319, loss: 1.4308, instance_loss: 0.4699, weighted_loss: 1.1425, label: 4, bag_size: 356
batch 339, loss: 2.3145, instance_loss: 0.6567, weighted_loss: 1.8172, label: 4, bag_size: 937
batch 359, loss: 1.0212, instance_loss: 0.5175, weighted_loss: 0.8701, label: 2, bag_size: 607
batch 379, loss: 1.8455, instance_loss: 0.5552, weighted_loss: 1.4584, label: 0, bag_size: 879
batch 399, loss: 1.0616, instance_loss: 0.4584, weighted_loss: 0.8806, label: 3, bag_size: 344
batch 419, loss: 1.6877, instance_loss: 0.5155, weighted_loss: 1.3360, label: 4, bag_size: 944
batch 439, loss: 0.0111, instance_loss: 0.2851, weighted_loss: 0.0933, label: 0, bag_size: 138
batch 459, loss: 1.2720, instance_loss: 0.5318, weighted_loss: 1.0500, label: 2, bag_size: 427
batch 479, loss: 1.3090, instance_loss: 0.5059, weighted_loss: 1.0681, label: 4, bag_size: 407
batch 499, loss: 0.6928, instance_loss: 0.3698, weighted_loss: 0.5959, label: 1, bag_size: 981
batch 519, loss: 1.5764, instance_loss: 0.5051, weighted_loss: 1.2551, label: 4, bag_size: 244
batch 539, loss: 1.3106, instance_loss: 0.5727, weighted_loss: 1.0892, label: 0, bag_size: 524
batch 559, loss: 1.1941, instance_loss: 0.5481, weighted_loss: 1.0003, label: 3, bag_size: 1365
batch 579, loss: 0.9905, instance_loss: 0.4394, weighted_loss: 0.8252, label: 4, bag_size: 124


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.05744949494949495: correct 273/4752
Epoch: 9, train_loss: 1.2513, train_clustering_loss:  0.4892, train_error: 0.5774
class 0: acc 0.7829457364341085, correct 101/129
class 1: acc 0.3181818181818182, correct 35/110
class 2: acc 0.25806451612903225, correct 32/124
class 3: acc 0.12745098039215685, correct 13/102
class 4: acc 0.5426356589147286, correct 70/129

Val Set, val_loss: 1.4284, val_error: 0.6216, auc: 0.6746
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.03209459459459459: correct 19/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3223, instance_loss: 0.4967, weighted_loss: 1.0746, label: 1, bag_size: 1023
batch 39, loss: 3.5706, instance_loss: 0.7896, weighted_loss: 2.7363, label: 3, bag_size: 282
batch 59, loss: 1.2941, instance_loss: 0.4486, weighted_loss: 1.0404, label: 3, bag_size: 982
batch 79, loss: 1.1054, instance_loss: 0.4893, weighted_loss: 0.9206, label: 3, bag_size: 230
batch 99, loss: 0.0293, instance_loss: 0.2098, weighted_loss: 0.0835, label: 0, bag_size: 355
batch 119, loss: 2.1337, instance_loss: 0.6861, weighted_loss: 1.6994, label: 2, bag_size: 380
batch 139, loss: 1.1886, instance_loss: 0.5714, weighted_loss: 1.0035, label: 3, bag_size: 856
batch 159, loss: 1.3575, instance_loss: 0.5506, weighted_loss: 1.1154, label: 2, bag_size: 535
batch 179, loss: 1.3741, instance_loss: 0.5311, weighted_loss: 1.1212, label: 4, bag_size: 293
batch 199, loss: 1.2679, instance_loss: 0.5062, weighted_loss: 1.0394, label: 2, bag_size: 1308
batch 219, loss: 1.7383, instance_loss: 0.6447, weighted_loss: 1.4102, label: 4, bag_size: 1351
batch 239, loss: 0.7682, instance_loss: 0.4856, weighted_loss: 0.6835, label: 4, bag_size: 727
batch 259, loss: 1.1446, instance_loss: 0.4743, weighted_loss: 0.9435, label: 1, bag_size: 355
batch 279, loss: 0.0870, instance_loss: 0.2879, weighted_loss: 0.1472, label: 0, bag_size: 98
batch 299, loss: 1.7935, instance_loss: 0.4688, weighted_loss: 1.3961, label: 2, bag_size: 851
batch 319, loss: 2.1595, instance_loss: 0.5378, weighted_loss: 1.6730, label: 1, bag_size: 875
batch 339, loss: 0.9767, instance_loss: 0.4750, weighted_loss: 0.8262, label: 4, bag_size: 699
batch 359, loss: 1.5855, instance_loss: 0.4964, weighted_loss: 1.2588, label: 1, bag_size: 1121
batch 379, loss: 1.7216, instance_loss: 0.4805, weighted_loss: 1.3493, label: 4, bag_size: 176
batch 399, loss: 1.4363, instance_loss: 0.5116, weighted_loss: 1.1589, label: 4, bag_size: 468
batch 419, loss: 0.0547, instance_loss: 0.1647, weighted_loss: 0.0877, label: 0, bag_size: 453
batch 439, loss: 1.3263, instance_loss: 0.4609, weighted_loss: 1.0667, label: 4, bag_size: 714
batch 459, loss: 1.6047, instance_loss: 0.4999, weighted_loss: 1.2733, label: 4, bag_size: 110
batch 479, loss: 0.8104, instance_loss: 0.4353, weighted_loss: 0.6978, label: 4, bag_size: 660
batch 499, loss: 1.5610, instance_loss: 0.6076, weighted_loss: 1.2750, label: 2, bag_size: 627
batch 519, loss: 1.9922, instance_loss: 0.5236, weighted_loss: 1.5516, label: 1, bag_size: 113
batch 539, loss: 3.1868, instance_loss: 0.7111, weighted_loss: 2.4441, label: 0, bag_size: 492
batch 559, loss: 1.0916, instance_loss: 0.4652, weighted_loss: 0.9037, label: 2, bag_size: 799
batch 579, loss: 2.3318, instance_loss: 0.6582, weighted_loss: 1.8297, label: 4, bag_size: 333


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.07175925925925926: correct 341/4752
Epoch: 10, train_loss: 1.2515, train_clustering_loss:  0.4857, train_error: 0.5236
class 0: acc 0.8347107438016529, correct 101/121
class 1: acc 0.48412698412698413, correct 61/126
class 2: acc 0.256198347107438, correct 31/121
class 3: acc 0.3181818181818182, correct 35/110
class 4: acc 0.47413793103448276, correct 55/116

Val Set, val_loss: 1.3668, val_error: 0.5811, auc: 0.7097
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.417263 --> 1.366757).  Saving model ...


batch 19, loss: 0.9987, instance_loss: 0.5872, weighted_loss: 0.8752, label: 2, bag_size: 445
batch 39, loss: 0.0623, instance_loss: 0.1924, weighted_loss: 0.1013, label: 0, bag_size: 97
batch 59, loss: 0.9069, instance_loss: 0.4482, weighted_loss: 0.7693, label: 4, bag_size: 773
batch 79, loss: 1.3708, instance_loss: 0.5390, weighted_loss: 1.1212, label: 3, bag_size: 684
batch 99, loss: 0.7121, instance_loss: 0.4752, weighted_loss: 0.6410, label: 0, bag_size: 269
batch 119, loss: 1.2062, instance_loss: 0.4457, weighted_loss: 0.9780, label: 4, bag_size: 1113
batch 139, loss: 0.0129, instance_loss: 0.1982, weighted_loss: 0.0685, label: 0, bag_size: 366
batch 159, loss: 2.4902, instance_loss: 0.5808, weighted_loss: 1.9174, label: 4, bag_size: 333
batch 179, loss: 1.4522, instance_loss: 0.5500, weighted_loss: 1.1815, label: 2, bag_size: 781
batch 199, loss: 0.9311, instance_loss: 0.5100, weighted_loss: 0.8048, label: 2, bag_size: 754
batch 219, loss: 2.5140, instance_loss: 0.5823, weighted_loss: 1.9345, label: 4, bag_size: 740
batch 239, loss: 1.1960, instance_loss: 0.4629, weighted_loss: 0.9761, label: 3, bag_size: 301
batch 259, loss: 1.8142, instance_loss: 0.5788, weighted_loss: 1.4436, label: 1, bag_size: 208
batch 279, loss: 1.5762, instance_loss: 0.5295, weighted_loss: 1.2622, label: 4, bag_size: 312
batch 299, loss: 2.0393, instance_loss: 0.5411, weighted_loss: 1.5899, label: 4, bag_size: 740
batch 319, loss: 1.1712, instance_loss: 0.4827, weighted_loss: 0.9646, label: 1, bag_size: 500
batch 339, loss: 0.9019, instance_loss: 0.3603, weighted_loss: 0.7394, label: 3, bag_size: 587
batch 359, loss: 1.6501, instance_loss: 0.5382, weighted_loss: 1.3165, label: 2, bag_size: 627
batch 379, loss: 0.0099, instance_loss: 0.1598, weighted_loss: 0.0549, label: 0, bag_size: 306
batch 399, loss: 1.1044, instance_loss: 0.4676, weighted_loss: 0.9134, label: 1, bag_size: 372
batch 419, loss: 1.9833, instance_loss: 0.5986, weighted_loss: 1.5679, label: 2, bag_size: 1013
batch 439, loss: 2.1033, instance_loss: 0.5816, weighted_loss: 1.6468, label: 1, bag_size: 311
batch 459, loss: 2.0360, instance_loss: 0.5064, weighted_loss: 1.5771, label: 4, bag_size: 854
batch 479, loss: 0.7309, instance_loss: 0.4347, weighted_loss: 0.6421, label: 4, bag_size: 744
batch 499, loss: 1.1335, instance_loss: 0.4680, weighted_loss: 0.9338, label: 2, bag_size: 290
batch 519, loss: 0.1307, instance_loss: 0.4144, weighted_loss: 0.2158, label: 0, bag_size: 282
batch 539, loss: 1.7836, instance_loss: 0.5318, weighted_loss: 1.4080, label: 3, bag_size: 344
batch 559, loss: 0.8636, instance_loss: 0.3993, weighted_loss: 0.7243, label: 3, bag_size: 817
batch 579, loss: 1.4245, instance_loss: 0.4579, weighted_loss: 1.1345, label: 1, bag_size: 1009


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.0563973063973064: correct 268/4752
Epoch: 11, train_loss: 1.2587, train_clustering_loss:  0.4858, train_error: 0.5758
class 0: acc 0.7941176470588235, correct 81/102
class 1: acc 0.2966101694915254, correct 35/118
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.35766423357664234, correct 49/137
class 4: acc 0.456, correct 57/125

Val Set, val_loss: 1.5311, val_error: 0.6216, auc: 0.6824
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6779, instance_loss: 0.5170, weighted_loss: 1.3296, label: 1, bag_size: 814
batch 39, loss: 1.4361, instance_loss: 0.5369, weighted_loss: 1.1663, label: 2, bag_size: 554
batch 59, loss: 1.6597, instance_loss: 0.5275, weighted_loss: 1.3201, label: 4, bag_size: 771
batch 79, loss: 1.6155, instance_loss: 0.5071, weighted_loss: 1.2830, label: 4, bag_size: 482
batch 99, loss: 1.6164, instance_loss: 0.5675, weighted_loss: 1.3017, label: 3, bag_size: 443
batch 119, loss: 2.0351, instance_loss: 0.6549, weighted_loss: 1.6210, label: 2, bag_size: 337
batch 139, loss: 1.1976, instance_loss: 0.4260, weighted_loss: 0.9661, label: 3, bag_size: 1021
batch 159, loss: 1.1214, instance_loss: 0.4348, weighted_loss: 0.9154, label: 3, bag_size: 956
batch 179, loss: 1.3800, instance_loss: 0.6400, weighted_loss: 1.1580, label: 2, bag_size: 783
batch 199, loss: 0.9963, instance_loss: 0.4832, weighted_loss: 0.8423, label: 1, bag_size: 892
batch 219, loss: 0.3894, instance_loss: 0.4984, weighted_loss: 0.4221, label: 2, bag_size: 1975
batch 239, loss: 0.9278, instance_loss: 0.4432, weighted_loss: 0.7824, label: 1, bag_size: 960
batch 259, loss: 2.2110, instance_loss: 0.5973, weighted_loss: 1.7269, label: 4, bag_size: 854
batch 279, loss: 1.4986, instance_loss: 0.5684, weighted_loss: 1.2195, label: 4, bag_size: 854
batch 299, loss: 0.2384, instance_loss: 0.2382, weighted_loss: 0.2383, label: 0, bag_size: 493
batch 319, loss: 0.9969, instance_loss: 0.4392, weighted_loss: 0.8296, label: 3, bag_size: 230
batch 339, loss: 0.9352, instance_loss: 0.3806, weighted_loss: 0.7688, label: 3, bag_size: 899
batch 359, loss: 1.0310, instance_loss: 0.4046, weighted_loss: 0.8431, label: 3, bag_size: 746
batch 379, loss: 2.4182, instance_loss: 0.7699, weighted_loss: 1.9237, label: 4, bag_size: 769
batch 399, loss: 1.3692, instance_loss: 0.5195, weighted_loss: 1.1143, label: 1, bag_size: 328
batch 419, loss: 1.1186, instance_loss: 0.4897, weighted_loss: 0.9300, label: 4, bag_size: 868
batch 439, loss: 1.1060, instance_loss: 0.5272, weighted_loss: 0.9324, label: 4, bag_size: 520
batch 459, loss: 0.5850, instance_loss: 0.4996, weighted_loss: 0.5594, label: 2, bag_size: 1608
batch 479, loss: 1.1303, instance_loss: 0.5259, weighted_loss: 0.9490, label: 2, bag_size: 590
batch 499, loss: 2.4539, instance_loss: 0.7471, weighted_loss: 1.9419, label: 4, bag_size: 937
batch 519, loss: 1.1669, instance_loss: 0.5042, weighted_loss: 0.9681, label: 3, bag_size: 472
batch 539, loss: 1.2299, instance_loss: 0.4680, weighted_loss: 1.0013, label: 1, bag_size: 614
batch 559, loss: 1.5775, instance_loss: 0.6666, weighted_loss: 1.3042, label: 2, bag_size: 812
batch 579, loss: 0.0108, instance_loss: 0.2461, weighted_loss: 0.0814, label: 0, bag_size: 340


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.06334175084175084: correct 301/4752
Epoch: 12, train_loss: 1.2882, train_clustering_loss:  0.4881, train_error: 0.5556
class 0: acc 0.8076923076923077, correct 84/104
class 1: acc 0.4153846153846154, correct 54/130
class 2: acc 0.3125, correct 40/128
class 3: acc 0.48091603053435117, correct 63/131
class 4: acc 0.22772277227722773, correct 23/101

Val Set, val_loss: 1.3843, val_error: 0.5541, auc: 0.7159
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0906, instance_loss: 0.5125, weighted_loss: 0.9172, label: 2, bag_size: 375
batch 39, loss: 0.8524, instance_loss: 0.3895, weighted_loss: 0.7136, label: 1, bag_size: 981
batch 59, loss: 1.1367, instance_loss: 0.4834, weighted_loss: 0.9407, label: 3, bag_size: 780
batch 79, loss: 0.0701, instance_loss: 0.2447, weighted_loss: 0.1225, label: 0, bag_size: 258
batch 99, loss: 1.3527, instance_loss: 0.6641, weighted_loss: 1.1461, label: 2, bag_size: 781
batch 119, loss: 1.4884, instance_loss: 0.4936, weighted_loss: 1.1900, label: 1, bag_size: 949
batch 139, loss: 0.7739, instance_loss: 0.3936, weighted_loss: 0.6598, label: 3, bag_size: 453
batch 159, loss: 1.3958, instance_loss: 0.5287, weighted_loss: 1.1356, label: 0, bag_size: 247
batch 179, loss: 0.6531, instance_loss: 0.4008, weighted_loss: 0.5774, label: 0, bag_size: 74
batch 199, loss: 0.9159, instance_loss: 0.4693, weighted_loss: 0.7819, label: 4, bag_size: 687
batch 219, loss: 1.5973, instance_loss: 0.5125, weighted_loss: 1.2719, label: 2, bag_size: 286
batch 239, loss: 1.5293, instance_loss: 0.5355, weighted_loss: 1.2312, label: 4, bag_size: 854
batch 259, loss: 1.2415, instance_loss: 0.4605, weighted_loss: 1.0072, label: 1, bag_size: 1091
batch 279, loss: 0.1663, instance_loss: 0.4167, weighted_loss: 0.2414, label: 0, bag_size: 397
batch 299, loss: 1.8623, instance_loss: 0.5345, weighted_loss: 1.4640, label: 1, bag_size: 695
batch 319, loss: 1.6901, instance_loss: 0.5324, weighted_loss: 1.3428, label: 4, bag_size: 407
batch 339, loss: 1.4942, instance_loss: 0.5754, weighted_loss: 1.2186, label: 2, bag_size: 769
batch 359, loss: 2.1281, instance_loss: 0.5498, weighted_loss: 1.6546, label: 4, bag_size: 476
batch 379, loss: 1.3031, instance_loss: 0.4864, weighted_loss: 1.0581, label: 4, bag_size: 238
batch 399, loss: 1.2385, instance_loss: 0.5409, weighted_loss: 1.0292, label: 2, bag_size: 385
batch 419, loss: 1.0992, instance_loss: 0.5138, weighted_loss: 0.9236, label: 2, bag_size: 567
batch 439, loss: 1.1265, instance_loss: 0.4737, weighted_loss: 0.9307, label: 3, bag_size: 102
batch 459, loss: 0.2885, instance_loss: 0.3231, weighted_loss: 0.2988, label: 0, bag_size: 88
batch 479, loss: 0.9113, instance_loss: 0.4900, weighted_loss: 0.7849, label: 4, bag_size: 780
batch 499, loss: 0.6513, instance_loss: 0.4787, weighted_loss: 0.5995, label: 4, bag_size: 744
batch 519, loss: 1.2527, instance_loss: 0.5624, weighted_loss: 1.0456, label: 2, bag_size: 445
batch 539, loss: 1.2458, instance_loss: 0.5596, weighted_loss: 1.0399, label: 0, bag_size: 269
batch 559, loss: 0.9794, instance_loss: 0.4203, weighted_loss: 0.8116, label: 3, bag_size: 817
batch 579, loss: 1.0067, instance_loss: 0.4072, weighted_loss: 0.8268, label: 4, bag_size: 198


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.047979797979797977: correct 228/4752
Epoch: 13, train_loss: 1.2517, train_clustering_loss:  0.4846, train_error: 0.5690
class 0: acc 0.7706422018348624, correct 84/109
class 1: acc 0.3, correct 30/100
class 2: acc 0.2900763358778626, correct 38/131
class 3: acc 0.4015748031496063, correct 51/127
class 4: acc 0.41732283464566927, correct 53/127

Val Set, val_loss: 1.4082, val_error: 0.6486, auc: 0.6965
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 2.1538, instance_loss: 0.6243, weighted_loss: 1.6949, label: 1, bag_size: 208
batch 39, loss: 2.3066, instance_loss: 0.5758, weighted_loss: 1.7874, label: 4, bag_size: 1031
batch 59, loss: 2.8272, instance_loss: 0.6369, weighted_loss: 2.1701, label: 0, bag_size: 1045
batch 79, loss: 2.0057, instance_loss: 0.5225, weighted_loss: 1.5607, label: 1, bag_size: 840
batch 99, loss: 2.0937, instance_loss: 0.5288, weighted_loss: 1.6243, label: 0, bag_size: 879
batch 119, loss: 0.2640, instance_loss: 0.3595, weighted_loss: 0.2926, label: 0, bag_size: 188
batch 139, loss: 1.0661, instance_loss: 0.4089, weighted_loss: 0.8690, label: 3, bag_size: 739
batch 159, loss: 2.1504, instance_loss: 0.6386, weighted_loss: 1.6968, label: 3, bag_size: 1232
batch 179, loss: 1.1608, instance_loss: 0.4715, weighted_loss: 0.9540, label: 0, bag_size: 227
batch 199, loss: 1.1108, instance_loss: 0.4272, weighted_loss: 0.9057, label: 3, bag_size: 857
batch 219, loss: 0.7598, instance_loss: 0.3862, weighted_loss: 0.6477, label: 3, bag_size: 476
batch 239, loss: 0.9794, instance_loss: 0.4220, weighted_loss: 0.8122, label: 3, bag_size: 780
batch 259, loss: 0.8750, instance_loss: 0.3871, weighted_loss: 0.7286, label: 1, bag_size: 1091
batch 279, loss: 2.5960, instance_loss: 0.7699, weighted_loss: 2.0482, label: 2, bag_size: 1308
batch 299, loss: 1.3355, instance_loss: 0.5567, weighted_loss: 1.1018, label: 2, bag_size: 177
batch 319, loss: 1.7702, instance_loss: 0.6298, weighted_loss: 1.4281, label: 2, bag_size: 176
batch 339, loss: 1.7441, instance_loss: 0.5276, weighted_loss: 1.3791, label: 4, bag_size: 176
batch 359, loss: 1.4632, instance_loss: 0.4989, weighted_loss: 1.1739, label: 1, bag_size: 201
batch 379, loss: 0.3391, instance_loss: 0.3885, weighted_loss: 0.3539, label: 4, bag_size: 746
batch 399, loss: 2.6544, instance_loss: 0.6485, weighted_loss: 2.0526, label: 0, bag_size: 367
batch 419, loss: 1.1487, instance_loss: 0.4727, weighted_loss: 0.9459, label: 3, bag_size: 1284
batch 439, loss: 0.3088, instance_loss: 0.3516, weighted_loss: 0.3216, label: 0, bag_size: 79
batch 459, loss: 1.8664, instance_loss: 0.6034, weighted_loss: 1.4875, label: 2, bag_size: 713
batch 479, loss: 1.1410, instance_loss: 0.4605, weighted_loss: 0.9369, label: 3, bag_size: 499
batch 499, loss: 0.4332, instance_loss: 0.3838, weighted_loss: 0.4184, label: 0, bag_size: 324
batch 519, loss: 1.1990, instance_loss: 0.4655, weighted_loss: 0.9789, label: 1, bag_size: 410
batch 539, loss: 0.4759, instance_loss: 0.4235, weighted_loss: 0.4602, label: 0, bag_size: 527
batch 559, loss: 1.0605, instance_loss: 0.5131, weighted_loss: 0.8963, label: 2, bag_size: 290
batch 579, loss: 2.3892, instance_loss: 0.5230, weighted_loss: 1.8293, label: 3, bag_size: 235


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.059132996632996634: correct 281/4752
Epoch: 14, train_loss: 1.2890, train_clustering_loss:  0.4870, train_error: 0.5589
class 0: acc 0.7903225806451613, correct 98/124
class 1: acc 0.3953488372093023, correct 51/129
class 2: acc 0.2, correct 22/110
class 3: acc 0.36363636363636365, correct 40/110
class 4: acc 0.4214876033057851, correct 51/121

Val Set, val_loss: 1.4730, val_error: 0.5946, auc: 0.7253
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.0323, instance_loss: 0.6100, weighted_loss: 1.6056, label: 1, bag_size: 272
batch 39, loss: 1.0748, instance_loss: 0.4494, weighted_loss: 0.8872, label: 3, bag_size: 857
batch 59, loss: 0.0203, instance_loss: 0.2484, weighted_loss: 0.0887, label: 0, bag_size: 397
batch 79, loss: 1.1951, instance_loss: 0.4720, weighted_loss: 0.9782, label: 4, bag_size: 944
batch 99, loss: 1.9629, instance_loss: 0.5958, weighted_loss: 1.5527, label: 1, bag_size: 397
batch 119, loss: 1.1620, instance_loss: 0.4678, weighted_loss: 0.9538, label: 2, bag_size: 394
batch 139, loss: 2.2850, instance_loss: 0.6075, weighted_loss: 1.7818, label: 3, bag_size: 457
batch 159, loss: 2.0905, instance_loss: 0.6379, weighted_loss: 1.6547, label: 4, bag_size: 572
batch 179, loss: 1.6188, instance_loss: 0.5032, weighted_loss: 1.2842, label: 4, bag_size: 407
batch 199, loss: 1.0200, instance_loss: 0.4005, weighted_loss: 0.8341, label: 3, bag_size: 476
batch 219, loss: 3.2045, instance_loss: 0.8195, weighted_loss: 2.4890, label: 3, bag_size: 228
batch 239, loss: 0.1512, instance_loss: 0.3975, weighted_loss: 0.2251, label: 0, bag_size: 280
batch 259, loss: 1.0810, instance_loss: 0.5215, weighted_loss: 0.9132, label: 2, bag_size: 708
batch 279, loss: 0.0489, instance_loss: 0.1815, weighted_loss: 0.0887, label: 0, bag_size: 255
batch 299, loss: 2.1625, instance_loss: 0.5800, weighted_loss: 1.6878, label: 3, bag_size: 342
batch 319, loss: 2.2405, instance_loss: 0.6098, weighted_loss: 1.7513, label: 0, bag_size: 888
batch 339, loss: 1.5127, instance_loss: 0.5216, weighted_loss: 1.2154, label: 2, bag_size: 411
batch 359, loss: 0.8832, instance_loss: 0.4200, weighted_loss: 0.7442, label: 3, bag_size: 822
batch 379, loss: 0.0502, instance_loss: 0.2577, weighted_loss: 0.1124, label: 0, bag_size: 227
batch 399, loss: 0.8093, instance_loss: 0.3955, weighted_loss: 0.6852, label: 3, bag_size: 587
batch 419, loss: 1.0266, instance_loss: 0.4751, weighted_loss: 0.8612, label: 4, bag_size: 489
batch 439, loss: 2.1645, instance_loss: 0.5411, weighted_loss: 1.6775, label: 2, bag_size: 219
batch 459, loss: 0.5529, instance_loss: 0.4427, weighted_loss: 0.5198, label: 2, bag_size: 702
batch 479, loss: 0.4056, instance_loss: 0.3187, weighted_loss: 0.3796, label: 0, bag_size: 397
batch 499, loss: 0.2063, instance_loss: 0.3313, weighted_loss: 0.2438, label: 0, bag_size: 210
batch 519, loss: 0.6061, instance_loss: 0.4788, weighted_loss: 0.5679, label: 0, bag_size: 477
batch 539, loss: 0.7937, instance_loss: 0.3931, weighted_loss: 0.6735, label: 4, bag_size: 490
batch 559, loss: 2.3535, instance_loss: 0.5691, weighted_loss: 1.8182, label: 4, bag_size: 333
batch 579, loss: 1.1172, instance_loss: 0.4561, weighted_loss: 0.9188, label: 1, bag_size: 660


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.059132996632996634: correct 281/4752
Epoch: 15, train_loss: 1.2560, train_clustering_loss:  0.4842, train_error: 0.5455
class 0: acc 0.7709923664122137, correct 101/131
class 1: acc 0.3055555555555556, correct 33/108
class 2: acc 0.3359375, correct 43/128
class 3: acc 0.3333333333333333, correct 37/111
class 4: acc 0.4827586206896552, correct 56/116

Val Set, val_loss: 1.3670, val_error: 0.5946, auc: 0.7357
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7548, instance_loss: 0.4631, weighted_loss: 0.6673, label: 2, bag_size: 607
batch 39, loss: 0.7711, instance_loss: 0.4302, weighted_loss: 0.6688, label: 2, bag_size: 853
batch 59, loss: 0.0864, instance_loss: 0.2359, weighted_loss: 0.1312, label: 0, bag_size: 192
batch 79, loss: 0.8948, instance_loss: 0.4330, weighted_loss: 0.7563, label: 2, bag_size: 390
batch 99, loss: 0.9517, instance_loss: 0.4451, weighted_loss: 0.7997, label: 3, bag_size: 453
batch 119, loss: 1.2293, instance_loss: 0.4449, weighted_loss: 0.9940, label: 3, bag_size: 996
batch 139, loss: 1.4603, instance_loss: 0.4890, weighted_loss: 1.1689, label: 2, bag_size: 744
batch 159, loss: 1.0290, instance_loss: 0.5014, weighted_loss: 0.8707, label: 1, bag_size: 1043
batch 179, loss: 2.6864, instance_loss: 0.5954, weighted_loss: 2.0591, label: 0, bag_size: 745
batch 199, loss: 1.2546, instance_loss: 0.5207, weighted_loss: 1.0345, label: 4, bag_size: 72
batch 219, loss: 1.2852, instance_loss: 0.5188, weighted_loss: 1.0553, label: 4, bag_size: 250
batch 239, loss: 1.3204, instance_loss: 0.5416, weighted_loss: 1.0867, label: 2, bag_size: 783
batch 259, loss: 0.0369, instance_loss: 0.1892, weighted_loss: 0.0826, label: 0, bag_size: 97
batch 279, loss: 0.2762, instance_loss: 0.4433, weighted_loss: 0.3264, label: 0, bag_size: 224
batch 299, loss: 1.0136, instance_loss: 0.4598, weighted_loss: 0.8475, label: 1, bag_size: 617
batch 319, loss: 0.0756, instance_loss: 0.2819, weighted_loss: 0.1375, label: 0, bag_size: 188
batch 339, loss: 0.9235, instance_loss: 0.4410, weighted_loss: 0.7788, label: 3, bag_size: 488
batch 359, loss: 1.8234, instance_loss: 0.5550, weighted_loss: 1.4429, label: 3, bag_size: 300
batch 379, loss: 1.5386, instance_loss: 0.5457, weighted_loss: 1.2407, label: 4, bag_size: 333
batch 399, loss: 2.2254, instance_loss: 0.5310, weighted_loss: 1.7171, label: 0, bag_size: 710
batch 419, loss: 0.4977, instance_loss: 0.3387, weighted_loss: 0.4500, label: 0, bag_size: 73
batch 439, loss: 1.3114, instance_loss: 0.4588, weighted_loss: 1.0556, label: 3, bag_size: 663
batch 459, loss: 1.1236, instance_loss: 0.4270, weighted_loss: 0.9146, label: 1, bag_size: 389
batch 479, loss: 0.9456, instance_loss: 0.4962, weighted_loss: 0.8108, label: 0, bag_size: 62
batch 499, loss: 0.2634, instance_loss: 0.3718, weighted_loss: 0.2959, label: 0, bag_size: 613
batch 519, loss: 2.2274, instance_loss: 0.5847, weighted_loss: 1.7346, label: 2, bag_size: 128
batch 539, loss: 0.0491, instance_loss: 0.2231, weighted_loss: 0.1013, label: 0, bag_size: 268
batch 559, loss: 1.5995, instance_loss: 0.4659, weighted_loss: 1.2594, label: 2, bag_size: 576
batch 579, loss: 1.6337, instance_loss: 0.5588, weighted_loss: 1.3112, label: 2, bag_size: 998


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.06228956228956229: correct 296/4752
Epoch: 16, train_loss: 1.2214, train_clustering_loss:  0.4796, train_error: 0.5370
class 0: acc 0.7941176470588235, correct 108/136
class 1: acc 0.49166666666666664, correct 59/120
class 2: acc 0.25, correct 29/116
class 3: acc 0.4434782608695652, correct 51/115
class 4: acc 0.2616822429906542, correct 28/107

Val Set, val_loss: 1.3879, val_error: 0.6622, auc: 0.7307
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1043, instance_loss: 0.2062, weighted_loss: 0.1349, label: 0, bag_size: 527
batch 39, loss: 2.3263, instance_loss: 0.6067, weighted_loss: 1.8104, label: 3, bag_size: 897
batch 59, loss: 1.3808, instance_loss: 0.5699, weighted_loss: 1.1375, label: 3, bag_size: 344
batch 79, loss: 0.9138, instance_loss: 0.5080, weighted_loss: 0.7921, label: 3, bag_size: 603
batch 99, loss: 1.1408, instance_loss: 0.4533, weighted_loss: 0.9346, label: 2, bag_size: 1010
batch 119, loss: 0.7937, instance_loss: 0.5319, weighted_loss: 0.7152, label: 1, bag_size: 874
batch 139, loss: 1.4599, instance_loss: 0.4669, weighted_loss: 1.1620, label: 2, bag_size: 953
batch 159, loss: 1.1944, instance_loss: 0.4585, weighted_loss: 0.9736, label: 2, bag_size: 617
batch 179, loss: 1.9198, instance_loss: 0.5895, weighted_loss: 1.5207, label: 1, bag_size: 695
batch 199, loss: 1.9734, instance_loss: 0.5234, weighted_loss: 1.5384, label: 4, bag_size: 342
batch 219, loss: 2.3921, instance_loss: 0.6366, weighted_loss: 1.8654, label: 0, bag_size: 587
batch 239, loss: 1.0960, instance_loss: 0.5642, weighted_loss: 0.9364, label: 4, bag_size: 937
batch 259, loss: 1.6532, instance_loss: 0.4963, weighted_loss: 1.3061, label: 1, bag_size: 461
batch 279, loss: 1.6337, instance_loss: 0.4714, weighted_loss: 1.2850, label: 2, bag_size: 998
batch 299, loss: 1.4224, instance_loss: 0.4687, weighted_loss: 1.1363, label: 2, bag_size: 659
batch 319, loss: 1.4274, instance_loss: 0.4583, weighted_loss: 1.1367, label: 3, bag_size: 154
batch 339, loss: 1.6662, instance_loss: 0.5576, weighted_loss: 1.3336, label: 3, bag_size: 1078
batch 359, loss: 1.1145, instance_loss: 0.4387, weighted_loss: 0.9117, label: 3, bag_size: 301
batch 379, loss: 2.2251, instance_loss: 0.6352, weighted_loss: 1.7481, label: 4, bag_size: 476
batch 399, loss: 1.3709, instance_loss: 0.5018, weighted_loss: 1.1102, label: 3, bag_size: 457
batch 419, loss: 1.0189, instance_loss: 0.4972, weighted_loss: 0.8624, label: 1, bag_size: 311
batch 439, loss: 1.2430, instance_loss: 0.5331, weighted_loss: 1.0301, label: 4, bag_size: 418
batch 459, loss: 0.9967, instance_loss: 0.3785, weighted_loss: 0.8113, label: 3, bag_size: 982
batch 479, loss: 1.0803, instance_loss: 0.5158, weighted_loss: 0.9110, label: 4, bag_size: 329
batch 499, loss: 1.2604, instance_loss: 0.4617, weighted_loss: 1.0208, label: 2, bag_size: 614
batch 519, loss: 1.1110, instance_loss: 0.4944, weighted_loss: 0.9260, label: 1, bag_size: 161
batch 539, loss: 1.6744, instance_loss: 0.6014, weighted_loss: 1.3525, label: 2, bag_size: 411
batch 559, loss: 1.2622, instance_loss: 0.5159, weighted_loss: 1.0383, label: 3, bag_size: 192
batch 579, loss: 1.2124, instance_loss: 0.4783, weighted_loss: 0.9922, label: 2, bag_size: 853


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.058922558922558925: correct 280/4752
Epoch: 17, train_loss: 1.2344, train_clustering_loss:  0.4818, train_error: 0.5438
class 0: acc 0.8376068376068376, correct 98/117
class 1: acc 0.33636363636363636, correct 37/110
class 2: acc 0.32061068702290074, correct 42/131
class 3: acc 0.46825396825396826, correct 59/126
class 4: acc 0.3181818181818182, correct 35/110

Val Set, val_loss: 1.3760, val_error: 0.6081, auc: 0.7406
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.8592, instance_loss: 0.6554, weighted_loss: 2.1981, label: 3, bag_size: 342
batch 39, loss: 1.2117, instance_loss: 0.5038, weighted_loss: 0.9993, label: 3, bag_size: 192
batch 59, loss: 1.6887, instance_loss: 0.5788, weighted_loss: 1.3557, label: 1, bag_size: 461
batch 79, loss: 1.4160, instance_loss: 0.5402, weighted_loss: 1.1532, label: 4, bag_size: 450
batch 99, loss: 0.1889, instance_loss: 0.3339, weighted_loss: 0.2324, label: 0, bag_size: 59
batch 119, loss: 0.2398, instance_loss: 0.3631, weighted_loss: 0.2768, label: 0, bag_size: 74
batch 139, loss: 1.0184, instance_loss: 0.5085, weighted_loss: 0.8654, label: 1, bag_size: 1043
batch 159, loss: 0.8487, instance_loss: 0.4755, weighted_loss: 0.7367, label: 1, bag_size: 233
batch 179, loss: 1.0864, instance_loss: 0.4190, weighted_loss: 0.8862, label: 3, bag_size: 473
batch 199, loss: 0.6241, instance_loss: 0.5010, weighted_loss: 0.5872, label: 4, bag_size: 1158
batch 219, loss: 0.0233, instance_loss: 0.1981, weighted_loss: 0.0757, label: 0, bag_size: 366
batch 239, loss: 1.2442, instance_loss: 0.5016, weighted_loss: 1.0214, label: 1, bag_size: 949
batch 259, loss: 1.4164, instance_loss: 0.5112, weighted_loss: 1.1449, label: 2, bag_size: 941
batch 279, loss: 2.0975, instance_loss: 0.5281, weighted_loss: 1.6267, label: 3, bag_size: 520
batch 299, loss: 1.1400, instance_loss: 0.3828, weighted_loss: 0.9128, label: 3, bag_size: 102
batch 319, loss: 1.3146, instance_loss: 0.5469, weighted_loss: 1.0843, label: 1, bag_size: 748
batch 339, loss: 1.2586, instance_loss: 0.5806, weighted_loss: 1.0552, label: 3, bag_size: 344
batch 359, loss: 0.4752, instance_loss: 0.4147, weighted_loss: 0.4570, label: 4, bag_size: 948
batch 379, loss: 1.1394, instance_loss: 0.4901, weighted_loss: 0.9446, label: 3, bag_size: 500
batch 399, loss: 2.1818, instance_loss: 0.7606, weighted_loss: 1.7554, label: 2, bag_size: 489
batch 419, loss: 0.8634, instance_loss: 0.3954, weighted_loss: 0.7230, label: 1, bag_size: 702
batch 439, loss: 0.9156, instance_loss: 0.4543, weighted_loss: 0.7772, label: 2, bag_size: 176
batch 459, loss: 0.0212, instance_loss: 0.2235, weighted_loss: 0.0819, label: 0, bag_size: 51
batch 479, loss: 0.8885, instance_loss: 0.4924, weighted_loss: 0.7697, label: 4, bag_size: 1041
batch 499, loss: 1.4755, instance_loss: 0.4752, weighted_loss: 1.1754, label: 2, bag_size: 864
batch 519, loss: 1.1517, instance_loss: 0.5114, weighted_loss: 0.9596, label: 1, bag_size: 500
batch 539, loss: 1.7948, instance_loss: 0.5922, weighted_loss: 1.4340, label: 1, bag_size: 614
batch 559, loss: 1.2061, instance_loss: 0.4119, weighted_loss: 0.9679, label: 3, bag_size: 109
batch 579, loss: 1.8135, instance_loss: 0.6281, weighted_loss: 1.4578, label: 2, bag_size: 421


class 0 clustering acc 0.9958333333333333: correct 23661/23760
class 1 clustering acc 0.0747053872053872: correct 355/4752
Epoch: 18, train_loss: 1.2186, train_clustering_loss:  0.4795, train_error: 0.5185
class 0: acc 0.7580645161290323, correct 94/124
class 1: acc 0.5537190082644629, correct 67/121
class 2: acc 0.18867924528301888, correct 20/106
class 3: acc 0.4126984126984127, correct 52/126
class 4: acc 0.452991452991453, correct 53/117

Val Set, val_loss: 1.3350, val_error: 0.6486, auc: 0.7592
class 0 clustering acc 0.9935810810810811: correct 2941/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.366757 --> 1.334977).  Saving model ...


batch 19, loss: 1.2749, instance_loss: 0.5784, weighted_loss: 1.0659, label: 2, bag_size: 350
batch 39, loss: 1.1382, instance_loss: 0.4948, weighted_loss: 0.9452, label: 2, bag_size: 285
batch 59, loss: 0.5451, instance_loss: 0.4988, weighted_loss: 0.5312, label: 4, bag_size: 530
batch 79, loss: 1.0713, instance_loss: 0.5745, weighted_loss: 0.9222, label: 4, bag_size: 854
batch 99, loss: 0.7198, instance_loss: 0.4239, weighted_loss: 0.6310, label: 2, bag_size: 350
batch 119, loss: 0.7583, instance_loss: 0.5773, weighted_loss: 0.7040, label: 3, bag_size: 956
batch 139, loss: 0.8576, instance_loss: 0.4034, weighted_loss: 0.7213, label: 0, bag_size: 269
batch 159, loss: 1.2287, instance_loss: 0.5916, weighted_loss: 1.0376, label: 0, bag_size: 732
batch 179, loss: 1.0256, instance_loss: 0.5858, weighted_loss: 0.8937, label: 3, bag_size: 1358
batch 199, loss: 0.8710, instance_loss: 0.4470, weighted_loss: 0.7438, label: 1, bag_size: 328
batch 219, loss: 1.4809, instance_loss: 0.5834, weighted_loss: 1.2117, label: 2, bag_size: 404
batch 239, loss: 1.1849, instance_loss: 0.4900, weighted_loss: 0.9764, label: 2, bag_size: 853
batch 259, loss: 0.6241, instance_loss: 0.4400, weighted_loss: 0.5689, label: 1, bag_size: 381
batch 279, loss: 2.0492, instance_loss: 0.5895, weighted_loss: 1.6113, label: 0, bag_size: 367
batch 299, loss: 0.0264, instance_loss: 0.2542, weighted_loss: 0.0948, label: 0, bag_size: 51
batch 319, loss: 1.0805, instance_loss: 0.4694, weighted_loss: 0.8972, label: 2, bag_size: 617
batch 339, loss: 1.0929, instance_loss: 0.5005, weighted_loss: 0.9152, label: 2, bag_size: 754
batch 359, loss: 0.8489, instance_loss: 0.4072, weighted_loss: 0.7164, label: 3, bag_size: 282
batch 379, loss: 1.0322, instance_loss: 0.4265, weighted_loss: 0.8505, label: 3, bag_size: 822
batch 399, loss: 2.0723, instance_loss: 0.6125, weighted_loss: 1.6343, label: 2, bag_size: 549
batch 419, loss: 2.3975, instance_loss: 0.6169, weighted_loss: 1.8633, label: 1, bag_size: 328
batch 439, loss: 1.3527, instance_loss: 0.5047, weighted_loss: 1.0983, label: 1, bag_size: 311
batch 459, loss: 1.8118, instance_loss: 0.5614, weighted_loss: 1.4367, label: 2, bag_size: 941
batch 479, loss: 2.4938, instance_loss: 0.6516, weighted_loss: 1.9412, label: 4, bag_size: 886
batch 499, loss: 1.1850, instance_loss: 0.5280, weighted_loss: 0.9879, label: 3, bag_size: 1060
batch 519, loss: 1.1828, instance_loss: 0.5508, weighted_loss: 0.9932, label: 2, bag_size: 530
batch 539, loss: 1.5110, instance_loss: 0.4981, weighted_loss: 1.2071, label: 1, bag_size: 201
batch 559, loss: 2.6306, instance_loss: 0.4953, weighted_loss: 1.9900, label: 4, bag_size: 270
batch 579, loss: 0.5700, instance_loss: 0.4460, weighted_loss: 0.5328, label: 4, bag_size: 520


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.05197811447811448: correct 247/4752
Epoch: 19, train_loss: 1.1638, train_clustering_loss:  0.4794, train_error: 0.4848
class 0: acc 0.8090909090909091, correct 89/110
class 1: acc 0.6, correct 87/145
class 2: acc 0.21739130434782608, correct 25/115
class 3: acc 0.4482758620689655, correct 52/116
class 4: acc 0.49074074074074076, correct 53/108

Val Set, val_loss: 1.3066, val_error: 0.6081, auc: 0.7729
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.334977 --> 1.306551).  Saving model ...


batch 19, loss: 0.2455, instance_loss: 0.1985, weighted_loss: 0.2314, label: 0, bag_size: 192
batch 39, loss: 1.1883, instance_loss: 0.5246, weighted_loss: 0.9892, label: 2, bag_size: 498
batch 59, loss: 0.4711, instance_loss: 0.3943, weighted_loss: 0.4481, label: 0, bag_size: 285
batch 79, loss: 0.4810, instance_loss: 0.4236, weighted_loss: 0.4638, label: 0, bag_size: 355
batch 99, loss: 0.4816, instance_loss: 0.4053, weighted_loss: 0.4587, label: 4, bag_size: 574
batch 119, loss: 2.5947, instance_loss: 0.6192, weighted_loss: 2.0021, label: 3, bag_size: 533
batch 139, loss: 0.0321, instance_loss: 0.2631, weighted_loss: 0.1014, label: 0, bag_size: 285
batch 159, loss: 1.1234, instance_loss: 0.4913, weighted_loss: 0.9338, label: 3, bag_size: 789
batch 179, loss: 1.2189, instance_loss: 0.5037, weighted_loss: 1.0043, label: 3, bag_size: 982
batch 199, loss: 0.6174, instance_loss: 0.4081, weighted_loss: 0.5546, label: 0, bag_size: 277
batch 219, loss: 1.4940, instance_loss: 0.5118, weighted_loss: 1.1994, label: 1, bag_size: 384
batch 239, loss: 1.2438, instance_loss: 0.4392, weighted_loss: 1.0024, label: 1, bag_size: 1009
batch 259, loss: 2.2690, instance_loss: 0.6075, weighted_loss: 1.7706, label: 2, bag_size: 1122
batch 279, loss: 0.7638, instance_loss: 0.3982, weighted_loss: 0.6541, label: 3, bag_size: 398
batch 299, loss: 1.8768, instance_loss: 0.6152, weighted_loss: 1.4983, label: 2, bag_size: 394
batch 319, loss: 1.2552, instance_loss: 0.5223, weighted_loss: 1.0353, label: 1, bag_size: 272
batch 339, loss: 0.2809, instance_loss: 0.3671, weighted_loss: 0.3068, label: 4, bag_size: 394
batch 359, loss: 1.5944, instance_loss: 0.5266, weighted_loss: 1.2740, label: 2, bag_size: 953
batch 379, loss: 1.0310, instance_loss: 0.4435, weighted_loss: 0.8548, label: 1, bag_size: 372
batch 399, loss: 1.3677, instance_loss: 0.4632, weighted_loss: 1.0964, label: 3, bag_size: 472
batch 419, loss: 0.9583, instance_loss: 0.3358, weighted_loss: 0.7716, label: 0, bag_size: 269
batch 439, loss: 2.0559, instance_loss: 0.7137, weighted_loss: 1.6532, label: 4, bag_size: 1351
batch 459, loss: 1.1563, instance_loss: 0.3675, weighted_loss: 0.9197, label: 0, bag_size: 247
batch 479, loss: 1.1252, instance_loss: 0.3928, weighted_loss: 0.9055, label: 3, bag_size: 472
batch 499, loss: 1.3305, instance_loss: 0.5105, weighted_loss: 1.0845, label: 4, bag_size: 356
batch 519, loss: 2.2093, instance_loss: 0.5881, weighted_loss: 1.7230, label: 4, bag_size: 333
batch 539, loss: 0.6128, instance_loss: 0.6229, weighted_loss: 0.6159, label: 2, bag_size: 596
batch 559, loss: 2.3242, instance_loss: 0.5413, weighted_loss: 1.7893, label: 1, bag_size: 272
batch 579, loss: 1.9741, instance_loss: 0.6382, weighted_loss: 1.5733, label: 1, bag_size: 410


class 0 clustering acc 0.9965909090909091: correct 23679/23760
class 1 clustering acc 0.07786195286195287: correct 370/4752
Epoch: 20, train_loss: 1.1578, train_clustering_loss:  0.4736, train_error: 0.5152
class 0: acc 0.8394160583941606, correct 115/137
class 1: acc 0.4909090909090909, correct 54/110
class 2: acc 0.1568627450980392, correct 16/102
class 3: acc 0.40458015267175573, correct 53/131
class 4: acc 0.43859649122807015, correct 50/114

Val Set, val_loss: 1.3553, val_error: 0.6486, auc: 0.7494
class 0 clustering acc 0.9925675675675676: correct 2938/2960
class 1 clustering acc 0.08277027027027027: correct 49/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8510, instance_loss: 0.4068, weighted_loss: 0.7178, label: 3, bag_size: 1154
batch 39, loss: 0.9728, instance_loss: 0.6083, weighted_loss: 0.8634, label: 2, bag_size: 286
batch 59, loss: 2.3358, instance_loss: 0.6407, weighted_loss: 1.8273, label: 4, bag_size: 476
batch 79, loss: 1.3857, instance_loss: 0.5126, weighted_loss: 1.1238, label: 3, bag_size: 681
batch 99, loss: 0.5655, instance_loss: 0.3595, weighted_loss: 0.5037, label: 1, bag_size: 1360
batch 119, loss: 1.6457, instance_loss: 0.5899, weighted_loss: 1.3289, label: 0, bag_size: 305
batch 139, loss: 1.7256, instance_loss: 0.5546, weighted_loss: 1.3743, label: 2, bag_size: 860
batch 159, loss: 1.1461, instance_loss: 0.4666, weighted_loss: 0.9422, label: 4, bag_size: 204
batch 179, loss: 1.0362, instance_loss: 0.4330, weighted_loss: 0.8553, label: 3, bag_size: 1060
batch 199, loss: 0.9959, instance_loss: 0.4424, weighted_loss: 0.8298, label: 3, bag_size: 235
batch 219, loss: 1.8257, instance_loss: 0.6173, weighted_loss: 1.4632, label: 2, bag_size: 1066
batch 239, loss: 1.1486, instance_loss: 0.4524, weighted_loss: 0.9397, label: 2, bag_size: 877
batch 259, loss: 1.2965, instance_loss: 0.4964, weighted_loss: 1.0564, label: 4, bag_size: 318
batch 279, loss: 0.9325, instance_loss: 0.4665, weighted_loss: 0.7927, label: 3, bag_size: 102
batch 299, loss: 1.2340, instance_loss: 0.5663, weighted_loss: 1.0337, label: 4, bag_size: 318
batch 319, loss: 0.1555, instance_loss: 0.2954, weighted_loss: 0.1974, label: 0, bag_size: 573
batch 339, loss: 1.1468, instance_loss: 0.5501, weighted_loss: 0.9678, label: 0, bag_size: 343
batch 359, loss: 0.0015, instance_loss: 0.2049, weighted_loss: 0.0625, label: 0, bag_size: 230
batch 379, loss: 1.8671, instance_loss: 0.5860, weighted_loss: 1.4828, label: 3, bag_size: 451
batch 399, loss: 1.2811, instance_loss: 0.4675, weighted_loss: 1.0370, label: 3, bag_size: 97
batch 419, loss: 0.9241, instance_loss: 0.5072, weighted_loss: 0.7990, label: 4, bag_size: 204
batch 439, loss: 0.5585, instance_loss: 0.3197, weighted_loss: 0.4869, label: 3, bag_size: 684
batch 459, loss: 0.0068, instance_loss: 0.3133, weighted_loss: 0.0987, label: 0, bag_size: 71
batch 479, loss: 1.0040, instance_loss: 0.5747, weighted_loss: 0.8752, label: 2, bag_size: 614
batch 499, loss: 1.1656, instance_loss: 0.4453, weighted_loss: 0.9495, label: 1, bag_size: 672
batch 519, loss: 1.1331, instance_loss: 0.4519, weighted_loss: 0.9287, label: 1, bag_size: 413
batch 539, loss: 0.9442, instance_loss: 0.4776, weighted_loss: 0.8042, label: 1, bag_size: 1043
batch 559, loss: 1.0453, instance_loss: 0.4558, weighted_loss: 0.8684, label: 1, bag_size: 526
batch 579, loss: 1.0964, instance_loss: 0.4282, weighted_loss: 0.8959, label: 3, bag_size: 956


class 0 clustering acc 0.9961700336700336: correct 23669/23760
class 1 clustering acc 0.07617845117845118: correct 362/4752
Epoch: 21, train_loss: 1.1663, train_clustering_loss:  0.4758, train_error: 0.5253
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.43478260869565216, correct 50/115
class 2: acc 0.3125, correct 40/128
class 3: acc 0.42105263157894735, correct 48/114
class 4: acc 0.41379310344827586, correct 48/116

Val Set, val_loss: 1.3321, val_error: 0.5270, auc: 0.7625
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7486, instance_loss: 0.4263, weighted_loss: 0.6519, label: 3, bag_size: 663
batch 39, loss: 1.2763, instance_loss: 0.4727, weighted_loss: 1.0352, label: 1, bag_size: 928
batch 59, loss: 0.9450, instance_loss: 0.4569, weighted_loss: 0.7986, label: 1, bag_size: 328
batch 79, loss: 1.0452, instance_loss: 0.4283, weighted_loss: 0.8601, label: 2, bag_size: 592
batch 99, loss: 1.3362, instance_loss: 0.5184, weighted_loss: 1.0908, label: 3, bag_size: 1021
batch 119, loss: 1.2609, instance_loss: 0.4421, weighted_loss: 1.0153, label: 3, bag_size: 301
batch 139, loss: 1.6030, instance_loss: 0.5013, weighted_loss: 1.2725, label: 1, bag_size: 658
batch 159, loss: 1.6345, instance_loss: 0.4913, weighted_loss: 1.2916, label: 1, bag_size: 814
batch 179, loss: 0.7421, instance_loss: 0.5300, weighted_loss: 0.6785, label: 4, bag_size: 1018
batch 199, loss: 1.7581, instance_loss: 0.5214, weighted_loss: 1.3871, label: 2, bag_size: 244
batch 219, loss: 0.6766, instance_loss: 0.4653, weighted_loss: 0.6132, label: 4, bag_size: 394
batch 239, loss: 0.9036, instance_loss: 0.4484, weighted_loss: 0.7670, label: 4, bag_size: 868
batch 259, loss: 1.1275, instance_loss: 0.5715, weighted_loss: 0.9607, label: 2, bag_size: 427
batch 279, loss: 2.0890, instance_loss: 0.5831, weighted_loss: 1.6373, label: 3, bag_size: 403
batch 299, loss: 1.0778, instance_loss: 0.4638, weighted_loss: 0.8936, label: 3, bag_size: 641
batch 319, loss: 2.6790, instance_loss: 0.6404, weighted_loss: 2.0674, label: 2, bag_size: 1122
batch 339, loss: 0.9317, instance_loss: 0.4536, weighted_loss: 0.7883, label: 1, bag_size: 332
batch 359, loss: 2.9536, instance_loss: 0.6232, weighted_loss: 2.2545, label: 1, bag_size: 361
batch 379, loss: 0.9166, instance_loss: 0.4442, weighted_loss: 0.7749, label: 2, bag_size: 598
batch 399, loss: 0.7227, instance_loss: 0.4840, weighted_loss: 0.6511, label: 2, bag_size: 427
batch 419, loss: 0.3348, instance_loss: 0.3629, weighted_loss: 0.3432, label: 0, bag_size: 33
batch 439, loss: 1.0025, instance_loss: 0.4525, weighted_loss: 0.8375, label: 3, bag_size: 443
batch 459, loss: 1.0583, instance_loss: 0.4694, weighted_loss: 0.8816, label: 1, bag_size: 1091
batch 479, loss: 0.5056, instance_loss: 0.4244, weighted_loss: 0.4813, label: 3, bag_size: 674
batch 499, loss: 0.0361, instance_loss: 0.1719, weighted_loss: 0.0769, label: 0, bag_size: 133
batch 519, loss: 0.3433, instance_loss: 0.4343, weighted_loss: 0.3706, label: 4, bag_size: 530
batch 539, loss: 2.2366, instance_loss: 0.5027, weighted_loss: 1.7164, label: 3, bag_size: 779
batch 559, loss: 1.9228, instance_loss: 0.6135, weighted_loss: 1.5300, label: 2, bag_size: 340
batch 579, loss: 0.7576, instance_loss: 0.4037, weighted_loss: 0.6514, label: 4, bag_size: 574


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.0747053872053872: correct 355/4752
Epoch: 22, train_loss: 1.1521, train_clustering_loss:  0.4729, train_error: 0.4949
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.4418604651162791, correct 57/129
class 2: acc 0.36666666666666664, correct 44/120
class 3: acc 0.4482758620689655, correct 52/116
class 4: acc 0.4351851851851852, correct 47/108

Val Set, val_loss: 1.3730, val_error: 0.6081, auc: 0.7795
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.06925675675675676: correct 41/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4490, instance_loss: 0.4788, weighted_loss: 1.1580, label: 2, bag_size: 427
batch 39, loss: 0.6708, instance_loss: 0.4398, weighted_loss: 0.6015, label: 3, bag_size: 818
batch 59, loss: 1.5609, instance_loss: 0.5204, weighted_loss: 1.2487, label: 1, bag_size: 408
batch 79, loss: 2.3244, instance_loss: 0.5541, weighted_loss: 1.7933, label: 2, bag_size: 394
batch 99, loss: 1.1169, instance_loss: 0.4492, weighted_loss: 0.9166, label: 4, bag_size: 419
batch 119, loss: 0.0075, instance_loss: 0.2428, weighted_loss: 0.0781, label: 0, bag_size: 37
batch 139, loss: 0.9792, instance_loss: 0.4601, weighted_loss: 0.8235, label: 3, bag_size: 499
batch 159, loss: 3.1562, instance_loss: 0.6244, weighted_loss: 2.3967, label: 0, bag_size: 964
batch 179, loss: 3.3904, instance_loss: 0.7160, weighted_loss: 2.5881, label: 3, bag_size: 342
batch 199, loss: 2.0562, instance_loss: 0.7446, weighted_loss: 1.6627, label: 2, bag_size: 864
batch 219, loss: 0.1416, instance_loss: 0.3109, weighted_loss: 0.1923, label: 0, bag_size: 517
batch 239, loss: 1.5420, instance_loss: 0.5159, weighted_loss: 1.2342, label: 4, bag_size: 333
batch 259, loss: 1.2907, instance_loss: 0.5199, weighted_loss: 1.0594, label: 2, bag_size: 340
batch 279, loss: 0.9325, instance_loss: 0.5109, weighted_loss: 0.8060, label: 2, bag_size: 244
batch 299, loss: 1.2308, instance_loss: 0.4646, weighted_loss: 1.0010, label: 1, bag_size: 972
batch 319, loss: 1.4288, instance_loss: 0.4391, weighted_loss: 1.1319, label: 4, bag_size: 342
batch 339, loss: 0.6794, instance_loss: 0.4320, weighted_loss: 0.6052, label: 4, bag_size: 1158
batch 359, loss: 1.0375, instance_loss: 0.4923, weighted_loss: 0.8739, label: 4, bag_size: 618
batch 379, loss: 0.0844, instance_loss: 0.1409, weighted_loss: 0.1014, label: 0, bag_size: 399
batch 399, loss: 0.7357, instance_loss: 0.4818, weighted_loss: 0.6595, label: 1, bag_size: 814
batch 419, loss: 2.2021, instance_loss: 0.4247, weighted_loss: 1.6689, label: 3, bag_size: 109
batch 439, loss: 0.0454, instance_loss: 0.2176, weighted_loss: 0.0970, label: 0, bag_size: 80
batch 459, loss: 0.5495, instance_loss: 0.5457, weighted_loss: 0.5484, label: 2, bag_size: 702
batch 479, loss: 0.8317, instance_loss: 0.4367, weighted_loss: 0.7132, label: 1, bag_size: 814
batch 499, loss: 0.9993, instance_loss: 0.4620, weighted_loss: 0.8381, label: 2, bag_size: 864
batch 519, loss: 1.1418, instance_loss: 0.5580, weighted_loss: 0.9667, label: 1, bag_size: 1043
batch 539, loss: 0.1424, instance_loss: 0.2678, weighted_loss: 0.1800, label: 0, bag_size: 513
batch 559, loss: 1.2250, instance_loss: 0.4514, weighted_loss: 0.9929, label: 3, bag_size: 830
batch 579, loss: 1.1946, instance_loss: 0.4490, weighted_loss: 0.9710, label: 1, bag_size: 311


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.05955387205387205: correct 283/4752
Epoch: 23, train_loss: 1.2064, train_clustering_loss:  0.4797, train_error: 0.5438
class 0: acc 0.7368421052631579, correct 84/114
class 1: acc 0.5365853658536586, correct 66/123
class 2: acc 0.14166666666666666, correct 17/120
class 3: acc 0.5267175572519084, correct 69/131
class 4: acc 0.330188679245283, correct 35/106

Val Set, val_loss: 1.3990, val_error: 0.5541, auc: 0.7768
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.08614864864864864: correct 51/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7578, instance_loss: 0.4572, weighted_loss: 0.6676, label: 3, bag_size: 344
batch 39, loss: 1.0438, instance_loss: 0.5041, weighted_loss: 0.8819, label: 4, bag_size: 797
batch 59, loss: 0.8810, instance_loss: 0.5109, weighted_loss: 0.7700, label: 2, bag_size: 633
batch 79, loss: 0.2376, instance_loss: 0.3819, weighted_loss: 0.2809, label: 2, bag_size: 1975
batch 99, loss: 1.1156, instance_loss: 0.4315, weighted_loss: 0.9104, label: 3, bag_size: 344
batch 119, loss: 0.7661, instance_loss: 0.4055, weighted_loss: 0.6579, label: 1, bag_size: 981
batch 139, loss: 1.1709, instance_loss: 0.4828, weighted_loss: 0.9645, label: 3, bag_size: 872
batch 159, loss: 0.6226, instance_loss: 0.5236, weighted_loss: 0.5929, label: 4, bag_size: 854
batch 179, loss: 0.9587, instance_loss: 0.4910, weighted_loss: 0.8184, label: 2, bag_size: 754
batch 199, loss: 1.2155, instance_loss: 0.5518, weighted_loss: 1.0164, label: 1, bag_size: 599
batch 219, loss: 2.8052, instance_loss: 0.7415, weighted_loss: 2.1861, label: 3, bag_size: 156
batch 239, loss: 1.2244, instance_loss: 0.5104, weighted_loss: 1.0102, label: 2, bag_size: 119
batch 259, loss: 0.0072, instance_loss: 0.1845, weighted_loss: 0.0604, label: 0, bag_size: 355
batch 279, loss: 0.9455, instance_loss: 0.4476, weighted_loss: 0.7961, label: 3, bag_size: 309
batch 299, loss: 0.3673, instance_loss: 0.4382, weighted_loss: 0.3886, label: 0, bag_size: 324
batch 319, loss: 0.8808, instance_loss: 0.4613, weighted_loss: 0.7550, label: 4, bag_size: 419
batch 339, loss: 0.7185, instance_loss: 0.4010, weighted_loss: 0.6233, label: 1, bag_size: 328
batch 359, loss: 1.0697, instance_loss: 0.4548, weighted_loss: 0.8852, label: 3, bag_size: 473
batch 379, loss: 1.7760, instance_loss: 0.5524, weighted_loss: 1.4090, label: 3, bag_size: 403
batch 399, loss: 1.4468, instance_loss: 0.5127, weighted_loss: 1.1665, label: 4, bag_size: 476
batch 419, loss: 1.6127, instance_loss: 0.5864, weighted_loss: 1.3048, label: 2, bag_size: 799
batch 439, loss: 2.3978, instance_loss: 0.6610, weighted_loss: 1.8768, label: 1, bag_size: 184
batch 459, loss: 1.0724, instance_loss: 0.5901, weighted_loss: 0.9277, label: 4, bag_size: 1351
batch 479, loss: 1.3594, instance_loss: 0.5208, weighted_loss: 1.1078, label: 1, bag_size: 161
batch 499, loss: 0.2273, instance_loss: 0.3092, weighted_loss: 0.2518, label: 4, bag_size: 266
batch 519, loss: 0.9857, instance_loss: 0.5009, weighted_loss: 0.8402, label: 3, bag_size: 337
batch 539, loss: 1.7117, instance_loss: 0.5141, weighted_loss: 1.3524, label: 0, bag_size: 879
batch 559, loss: 0.0661, instance_loss: 0.2392, weighted_loss: 0.1180, label: 0, bag_size: 79
batch 579, loss: 1.5098, instance_loss: 0.4912, weighted_loss: 1.2042, label: 2, bag_size: 375


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.0585016835016835: correct 278/4752
Epoch: 24, train_loss: 1.1635, train_clustering_loss:  0.4812, train_error: 0.5084
class 0: acc 0.796875, correct 102/128
class 1: acc 0.5299145299145299, correct 62/117
class 2: acc 0.22018348623853212, correct 24/109
class 3: acc 0.2982456140350877, correct 34/114
class 4: acc 0.5555555555555556, correct 70/126

Val Set, val_loss: 1.2318, val_error: 0.5405, auc: 0.8017
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.306551 --> 1.231823).  Saving model ...


batch 19, loss: 0.0541, instance_loss: 0.3100, weighted_loss: 0.1309, label: 0, bag_size: 370
batch 39, loss: 2.3556, instance_loss: 0.5700, weighted_loss: 1.8199, label: 4, bag_size: 590
batch 59, loss: 1.1562, instance_loss: 0.4427, weighted_loss: 0.9421, label: 1, bag_size: 695
batch 79, loss: 2.3149, instance_loss: 0.6133, weighted_loss: 1.8044, label: 2, bag_size: 318
batch 99, loss: 2.1317, instance_loss: 0.7570, weighted_loss: 1.7193, label: 3, bag_size: 31
batch 119, loss: 0.8485, instance_loss: 0.4337, weighted_loss: 0.7241, label: 3, bag_size: 822
batch 139, loss: 0.2160, instance_loss: 0.2470, weighted_loss: 0.2253, label: 0, bag_size: 399
batch 159, loss: 0.4473, instance_loss: 0.3938, weighted_loss: 0.4313, label: 3, bag_size: 928
batch 179, loss: 0.7180, instance_loss: 0.3944, weighted_loss: 0.6209, label: 3, bag_size: 428
batch 199, loss: 3.6079, instance_loss: 0.7975, weighted_loss: 2.7648, label: 4, bag_size: 101
batch 219, loss: 1.7512, instance_loss: 0.5842, weighted_loss: 1.4011, label: 1, bag_size: 614
batch 239, loss: 0.2244, instance_loss: 0.4130, weighted_loss: 0.2810, label: 0, bag_size: 33
batch 259, loss: 0.0190, instance_loss: 0.1914, weighted_loss: 0.0707, label: 0, bag_size: 80
batch 279, loss: 0.5148, instance_loss: 0.4286, weighted_loss: 0.4889, label: 4, bag_size: 854
batch 299, loss: 1.2296, instance_loss: 0.4670, weighted_loss: 1.0008, label: 3, bag_size: 258
batch 319, loss: 1.8866, instance_loss: 0.5238, weighted_loss: 1.4778, label: 1, bag_size: 272
batch 339, loss: 1.4987, instance_loss: 0.5116, weighted_loss: 1.2026, label: 2, bag_size: 421
batch 359, loss: 0.0345, instance_loss: 0.1655, weighted_loss: 0.0738, label: 0, bag_size: 251
batch 379, loss: 1.6817, instance_loss: 0.5987, weighted_loss: 1.3568, label: 1, bag_size: 272
batch 399, loss: 0.8443, instance_loss: 0.5029, weighted_loss: 0.7418, label: 1, bag_size: 1273
batch 419, loss: 0.5688, instance_loss: 0.4741, weighted_loss: 0.5404, label: 4, bag_size: 1351
batch 439, loss: 0.1958, instance_loss: 0.2683, weighted_loss: 0.2175, label: 4, bag_size: 574
batch 459, loss: 0.9026, instance_loss: 0.4512, weighted_loss: 0.7672, label: 1, bag_size: 1121
batch 479, loss: 1.3124, instance_loss: 0.5814, weighted_loss: 1.0931, label: 3, bag_size: 781
batch 499, loss: 1.3298, instance_loss: 0.5102, weighted_loss: 1.0839, label: 3, bag_size: 109
batch 519, loss: 0.7729, instance_loss: 0.4288, weighted_loss: 0.6697, label: 3, bag_size: 301
batch 539, loss: 0.0600, instance_loss: 0.2424, weighted_loss: 0.1147, label: 0, bag_size: 573
batch 559, loss: 0.6130, instance_loss: 0.3562, weighted_loss: 0.5360, label: 3, bag_size: 684
batch 579, loss: 0.7913, instance_loss: 0.4321, weighted_loss: 0.6836, label: 3, bag_size: 956


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.070496632996633: correct 335/4752
Epoch: 25, train_loss: 1.1480, train_clustering_loss:  0.4783, train_error: 0.5034
class 0: acc 0.751937984496124, correct 97/129
class 1: acc 0.5254237288135594, correct 62/118
class 2: acc 0.2605042016806723, correct 31/119
class 3: acc 0.47863247863247865, correct 56/117
class 4: acc 0.44144144144144143, correct 49/111

Val Set, val_loss: 1.3347, val_error: 0.5676, auc: 0.7734
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.0625: correct 37/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9301, instance_loss: 0.4380, weighted_loss: 0.7825, label: 4, bag_size: 740
batch 39, loss: 1.9367, instance_loss: 0.5940, weighted_loss: 1.5339, label: 0, bag_size: 305
batch 59, loss: 0.0178, instance_loss: 0.1785, weighted_loss: 0.0660, label: 0, bag_size: 188
batch 79, loss: 0.4602, instance_loss: 0.4498, weighted_loss: 0.4571, label: 1, bag_size: 544
batch 99, loss: 1.3340, instance_loss: 0.4519, weighted_loss: 1.0694, label: 1, bag_size: 855
batch 119, loss: 0.1479, instance_loss: 0.4431, weighted_loss: 0.2365, label: 1, bag_size: 371
batch 139, loss: 0.7785, instance_loss: 0.4303, weighted_loss: 0.6741, label: 1, bag_size: 271
batch 159, loss: 0.2168, instance_loss: 0.4070, weighted_loss: 0.2739, label: 4, bag_size: 530
batch 179, loss: 0.0405, instance_loss: 0.2730, weighted_loss: 0.1102, label: 0, bag_size: 210
batch 199, loss: 0.9744, instance_loss: 0.4567, weighted_loss: 0.8191, label: 4, bag_size: 660
batch 219, loss: 1.5922, instance_loss: 0.5353, weighted_loss: 1.2751, label: 3, bag_size: 457
batch 239, loss: 2.3480, instance_loss: 0.6824, weighted_loss: 1.8483, label: 2, bag_size: 852
batch 259, loss: 1.6334, instance_loss: 0.6021, weighted_loss: 1.3240, label: 4, bag_size: 652
batch 279, loss: 1.1010, instance_loss: 0.5321, weighted_loss: 0.9303, label: 0, bag_size: 277
batch 299, loss: 0.7346, instance_loss: 0.5542, weighted_loss: 0.6805, label: 2, bag_size: 571
batch 319, loss: 2.2616, instance_loss: 0.6107, weighted_loss: 1.7663, label: 2, bag_size: 934
batch 339, loss: 0.0095, instance_loss: 0.1517, weighted_loss: 0.0521, label: 0, bag_size: 527
batch 359, loss: 1.1891, instance_loss: 0.4587, weighted_loss: 0.9700, label: 1, bag_size: 658
batch 379, loss: 1.4075, instance_loss: 0.4689, weighted_loss: 1.1259, label: 3, bag_size: 520
batch 399, loss: 0.9471, instance_loss: 0.4900, weighted_loss: 0.8100, label: 1, bag_size: 748
batch 419, loss: 0.9700, instance_loss: 0.5061, weighted_loss: 0.8309, label: 1, bag_size: 865
batch 439, loss: 0.9813, instance_loss: 0.4124, weighted_loss: 0.8107, label: 0, bag_size: 615
batch 459, loss: 3.0108, instance_loss: 0.6204, weighted_loss: 2.2937, label: 3, bag_size: 166
batch 479, loss: 1.1500, instance_loss: 0.4567, weighted_loss: 0.9420, label: 2, bag_size: 445
batch 499, loss: 2.2996, instance_loss: 0.6439, weighted_loss: 1.8029, label: 2, bag_size: 829
batch 519, loss: 1.8183, instance_loss: 0.5300, weighted_loss: 1.4318, label: 3, bag_size: 154
batch 539, loss: 0.6091, instance_loss: 0.5014, weighted_loss: 0.5768, label: 1, bag_size: 874
batch 559, loss: 0.1318, instance_loss: 0.3507, weighted_loss: 0.1975, label: 0, bag_size: 59
batch 579, loss: 1.1409, instance_loss: 0.5134, weighted_loss: 0.9526, label: 1, bag_size: 906


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.06628787878787878: correct 315/4752
Epoch: 26, train_loss: 1.1118, train_clustering_loss:  0.4735, train_error: 0.4630
class 0: acc 0.816, correct 102/125
class 1: acc 0.5655737704918032, correct 69/122
class 2: acc 0.3274336283185841, correct 37/113
class 3: acc 0.44715447154471544, correct 55/123
class 4: acc 0.5045045045045045, correct 56/111

Val Set, val_loss: 1.3331, val_error: 0.5541, auc: 0.7355
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0630, instance_loss: 0.4080, weighted_loss: 0.8665, label: 3, bag_size: 631
batch 39, loss: 1.2409, instance_loss: 0.4921, weighted_loss: 1.0163, label: 4, bag_size: 685
batch 59, loss: 1.3170, instance_loss: 0.5090, weighted_loss: 1.0746, label: 2, bag_size: 288
batch 79, loss: 0.6726, instance_loss: 0.3726, weighted_loss: 0.5826, label: 4, bag_size: 744
batch 99, loss: 1.0505, instance_loss: 0.4689, weighted_loss: 0.8760, label: 1, bag_size: 593
batch 119, loss: 0.8419, instance_loss: 0.6130, weighted_loss: 0.7732, label: 4, bag_size: 1351
batch 139, loss: 0.0049, instance_loss: 0.2760, weighted_loss: 0.0862, label: 0, bag_size: 230
batch 159, loss: 0.0392, instance_loss: 0.3507, weighted_loss: 0.1326, label: 0, bag_size: 159
batch 179, loss: 0.8439, instance_loss: 0.4503, weighted_loss: 0.7258, label: 4, bag_size: 714
batch 199, loss: 3.8186, instance_loss: 0.7591, weighted_loss: 2.9008, label: 0, bag_size: 1039
batch 219, loss: 1.1543, instance_loss: 0.4746, weighted_loss: 0.9504, label: 2, bag_size: 445
batch 239, loss: 0.9535, instance_loss: 0.4085, weighted_loss: 0.7900, label: 3, bag_size: 1007
batch 259, loss: 0.5970, instance_loss: 0.4571, weighted_loss: 0.5550, label: 3, bag_size: 301
batch 279, loss: 1.1448, instance_loss: 0.4737, weighted_loss: 0.9434, label: 4, bag_size: 1031
batch 299, loss: 0.8200, instance_loss: 0.4410, weighted_loss: 0.7063, label: 4, bag_size: 685
batch 319, loss: 0.9065, instance_loss: 0.4567, weighted_loss: 0.7716, label: 4, bag_size: 419
batch 339, loss: 0.5184, instance_loss: 0.4664, weighted_loss: 0.5028, label: 0, bag_size: 74
batch 359, loss: 1.7666, instance_loss: 0.5394, weighted_loss: 1.3984, label: 1, bag_size: 906
batch 379, loss: 0.1307, instance_loss: 0.2684, weighted_loss: 0.1720, label: 0, bag_size: 513
batch 399, loss: 0.0310, instance_loss: 0.2074, weighted_loss: 0.0839, label: 0, bag_size: 527
batch 419, loss: 0.8665, instance_loss: 0.4248, weighted_loss: 0.7340, label: 2, bag_size: 592
batch 439, loss: 0.5037, instance_loss: 0.4088, weighted_loss: 0.4753, label: 3, bag_size: 1001
batch 459, loss: 1.2842, instance_loss: 0.5123, weighted_loss: 1.0526, label: 1, bag_size: 823
batch 479, loss: 0.8576, instance_loss: 0.5206, weighted_loss: 0.7565, label: 1, bag_size: 522
batch 499, loss: 1.4340, instance_loss: 0.5482, weighted_loss: 1.1683, label: 3, bag_size: 309
batch 519, loss: 3.2242, instance_loss: 0.6910, weighted_loss: 2.4643, label: 0, bag_size: 587
batch 539, loss: 1.5398, instance_loss: 0.4992, weighted_loss: 1.2276, label: 3, bag_size: 282
batch 559, loss: 1.3217, instance_loss: 0.5087, weighted_loss: 1.0778, label: 1, bag_size: 1023
batch 579, loss: 1.1657, instance_loss: 0.4772, weighted_loss: 0.9592, label: 3, bag_size: 97


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.0625: correct 297/4752
Epoch: 27, train_loss: 1.1221, train_clustering_loss:  0.4740, train_error: 0.5101
class 0: acc 0.7889908256880734, correct 86/109
class 1: acc 0.36893203883495146, correct 38/103
class 2: acc 0.36065573770491804, correct 44/122
class 3: acc 0.4263565891472868, correct 55/129
class 4: acc 0.5190839694656488, correct 68/131

Val Set, val_loss: 1.2306, val_error: 0.5270, auc: 0.7948
class 0 clustering acc 0.9935810810810811: correct 2941/2960
class 1 clustering acc 0.10135135135135136: correct 60/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.231823 --> 1.230621).  Saving model ...


batch 19, loss: 0.9643, instance_loss: 0.4596, weighted_loss: 0.8129, label: 3, bag_size: 817
batch 39, loss: 1.5108, instance_loss: 0.4771, weighted_loss: 1.2007, label: 2, bag_size: 906
batch 59, loss: 0.8787, instance_loss: 0.4167, weighted_loss: 0.7401, label: 1, bag_size: 398
batch 79, loss: 0.5700, instance_loss: 0.3943, weighted_loss: 0.5173, label: 4, bag_size: 1018
batch 99, loss: 0.5932, instance_loss: 0.4446, weighted_loss: 0.5486, label: 4, bag_size: 776
batch 119, loss: 1.3076, instance_loss: 0.5505, weighted_loss: 1.0805, label: 3, bag_size: 603
batch 139, loss: 1.3267, instance_loss: 0.5222, weighted_loss: 1.0853, label: 2, bag_size: 853
batch 159, loss: 1.4623, instance_loss: 0.4477, weighted_loss: 1.1579, label: 3, bag_size: 230
batch 179, loss: 2.2781, instance_loss: 0.5241, weighted_loss: 1.7519, label: 4, bag_size: 310
batch 199, loss: 1.0538, instance_loss: 0.4523, weighted_loss: 0.8733, label: 2, bag_size: 613
batch 219, loss: 1.4471, instance_loss: 0.5047, weighted_loss: 1.1644, label: 1, bag_size: 201
batch 239, loss: 1.6189, instance_loss: 0.5891, weighted_loss: 1.3100, label: 4, bag_size: 592
batch 259, loss: 0.7932, instance_loss: 0.4143, weighted_loss: 0.6795, label: 1, bag_size: 605
batch 279, loss: 0.8975, instance_loss: 0.4595, weighted_loss: 0.7661, label: 1, bag_size: 544
batch 299, loss: 1.2799, instance_loss: 0.5343, weighted_loss: 1.0562, label: 2, bag_size: 614
batch 319, loss: 0.7939, instance_loss: 0.4367, weighted_loss: 0.6868, label: 1, bag_size: 928
batch 339, loss: 2.1518, instance_loss: 0.6965, weighted_loss: 1.7152, label: 2, bag_size: 411
batch 359, loss: 0.3141, instance_loss: 0.3216, weighted_loss: 0.3164, label: 4, bag_size: 266
batch 379, loss: 1.7316, instance_loss: 0.6290, weighted_loss: 1.4008, label: 2, bag_size: 398
batch 399, loss: 0.6416, instance_loss: 0.5268, weighted_loss: 0.6072, label: 0, bag_size: 224
batch 419, loss: 0.3645, instance_loss: 0.3346, weighted_loss: 0.3555, label: 4, bag_size: 266
batch 439, loss: 0.8995, instance_loss: 0.5236, weighted_loss: 0.7867, label: 0, bag_size: 178
batch 459, loss: 1.0611, instance_loss: 0.4249, weighted_loss: 0.8702, label: 1, bag_size: 1019
batch 479, loss: 0.8265, instance_loss: 0.4645, weighted_loss: 0.7179, label: 1, bag_size: 522
batch 499, loss: 0.0335, instance_loss: 0.2269, weighted_loss: 0.0915, label: 0, bag_size: 513
batch 519, loss: 0.5349, instance_loss: 0.3864, weighted_loss: 0.4903, label: 0, bag_size: 62
batch 539, loss: 1.7138, instance_loss: 0.6113, weighted_loss: 1.3830, label: 1, bag_size: 391
batch 559, loss: 1.1352, instance_loss: 0.4446, weighted_loss: 0.9280, label: 2, bag_size: 861
batch 579, loss: 0.5470, instance_loss: 0.4971, weighted_loss: 0.5320, label: 1, bag_size: 814


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.07617845117845118: correct 362/4752
Epoch: 28, train_loss: 1.1330, train_clustering_loss:  0.4761, train_error: 0.4781
class 0: acc 0.7829457364341085, correct 101/129
class 1: acc 0.671875, correct 86/128
class 2: acc 0.16666666666666666, correct 19/114
class 3: acc 0.42105263157894735, correct 48/114
class 4: acc 0.5137614678899083, correct 56/109

Val Set, val_loss: 1.4328, val_error: 0.5811, auc: 0.7759
class 0 clustering acc 0.9885135135135135: correct 2926/2960
class 1 clustering acc 0.11148648648648649: correct 66/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1129, instance_loss: 0.2854, weighted_loss: 0.1647, label: 0, bag_size: 79
batch 39, loss: 0.1620, instance_loss: 0.3533, weighted_loss: 0.2194, label: 0, bag_size: 59
batch 59, loss: 0.4580, instance_loss: 0.4423, weighted_loss: 0.4533, label: 4, bag_size: 394
batch 79, loss: 2.5021, instance_loss: 0.6443, weighted_loss: 1.9448, label: 2, bag_size: 394
batch 99, loss: 0.8695, instance_loss: 0.4042, weighted_loss: 0.7299, label: 3, bag_size: 781
batch 119, loss: 0.7970, instance_loss: 0.4148, weighted_loss: 0.6823, label: 3, bag_size: 102
batch 139, loss: 1.9734, instance_loss: 0.6356, weighted_loss: 1.5721, label: 4, bag_size: 685
batch 159, loss: 0.8768, instance_loss: 0.4265, weighted_loss: 0.7417, label: 4, bag_size: 53
batch 179, loss: 2.9143, instance_loss: 0.6106, weighted_loss: 2.2232, label: 1, bag_size: 184
batch 199, loss: 1.2190, instance_loss: 0.4484, weighted_loss: 0.9878, label: 3, bag_size: 300
batch 219, loss: 1.5045, instance_loss: 0.5262, weighted_loss: 1.2110, label: 3, bag_size: 323
batch 239, loss: 1.0466, instance_loss: 0.4888, weighted_loss: 0.8792, label: 4, bag_size: 218
batch 259, loss: 1.6170, instance_loss: 0.6003, weighted_loss: 1.3120, label: 2, bag_size: 288
batch 279, loss: 1.0814, instance_loss: 0.4988, weighted_loss: 0.9066, label: 3, bag_size: 1154
batch 299, loss: 1.1585, instance_loss: 0.4304, weighted_loss: 0.9401, label: 3, bag_size: 499
batch 319, loss: 0.8541, instance_loss: 0.4691, weighted_loss: 0.7386, label: 2, bag_size: 350
batch 339, loss: 1.1402, instance_loss: 0.4796, weighted_loss: 0.9420, label: 1, bag_size: 372
batch 359, loss: 0.6763, instance_loss: 0.4557, weighted_loss: 0.6101, label: 2, bag_size: 253
batch 379, loss: 0.4023, instance_loss: 0.3900, weighted_loss: 0.3986, label: 0, bag_size: 400
batch 399, loss: 0.9314, instance_loss: 0.4459, weighted_loss: 0.7858, label: 3, bag_size: 499
batch 419, loss: 1.3041, instance_loss: 0.6203, weighted_loss: 1.0989, label: 4, bag_size: 853
batch 439, loss: 2.4201, instance_loss: 0.6061, weighted_loss: 1.8759, label: 2, bag_size: 861
batch 459, loss: 0.8390, instance_loss: 0.4276, weighted_loss: 0.7156, label: 2, bag_size: 543
batch 479, loss: 0.5358, instance_loss: 0.3944, weighted_loss: 0.4934, label: 2, bag_size: 1079
batch 499, loss: 4.0453, instance_loss: 0.6761, weighted_loss: 3.0346, label: 4, bag_size: 310
batch 519, loss: 2.4678, instance_loss: 0.6352, weighted_loss: 1.9180, label: 0, bag_size: 243
batch 539, loss: 2.5832, instance_loss: 0.6084, weighted_loss: 1.9908, label: 3, bag_size: 638
batch 559, loss: 3.4534, instance_loss: 0.7217, weighted_loss: 2.6339, label: 1, bag_size: 361
batch 579, loss: 1.4710, instance_loss: 0.5316, weighted_loss: 1.1892, label: 2, bag_size: 590


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.06102693602693603: correct 290/4752
Epoch: 29, train_loss: 1.1256, train_clustering_loss:  0.4785, train_error: 0.4680
class 0: acc 0.7165354330708661, correct 91/127
class 1: acc 0.46226415094339623, correct 49/106
class 2: acc 0.36936936936936937, correct 41/111
class 3: acc 0.5075757575757576, correct 67/132
class 4: acc 0.576271186440678, correct 68/118

Val Set, val_loss: 1.4767, val_error: 0.5541, auc: 0.7766
class 0 clustering acc 0.9929054054054054: correct 2939/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8952, instance_loss: 0.4829, weighted_loss: 0.7715, label: 4, bag_size: 699
batch 39, loss: 0.4837, instance_loss: 0.4086, weighted_loss: 0.4612, label: 0, bag_size: 74
batch 59, loss: 0.9726, instance_loss: 0.4172, weighted_loss: 0.8060, label: 2, bag_size: 613
batch 79, loss: 0.7474, instance_loss: 0.4802, weighted_loss: 0.6673, label: 0, bag_size: 247
batch 99, loss: 0.3395, instance_loss: 0.3609, weighted_loss: 0.3459, label: 4, bag_size: 824
batch 119, loss: 1.3141, instance_loss: 0.4471, weighted_loss: 1.0540, label: 2, bag_size: 953
batch 139, loss: 1.8253, instance_loss: 0.5537, weighted_loss: 1.4438, label: 2, bag_size: 331
batch 159, loss: 3.8272, instance_loss: 0.6503, weighted_loss: 2.8741, label: 0, bag_size: 169
batch 179, loss: 1.1582, instance_loss: 0.5616, weighted_loss: 0.9792, label: 1, bag_size: 1043
batch 199, loss: 1.8967, instance_loss: 0.6410, weighted_loss: 1.5200, label: 2, bag_size: 498
batch 219, loss: 0.0659, instance_loss: 0.2484, weighted_loss: 0.1206, label: 0, bag_size: 212
batch 239, loss: 0.4186, instance_loss: 0.4149, weighted_loss: 0.4175, label: 0, bag_size: 73
batch 259, loss: 0.3984, instance_loss: 0.3622, weighted_loss: 0.3875, label: 4, bag_size: 960
batch 279, loss: 2.2386, instance_loss: 0.6251, weighted_loss: 1.7545, label: 3, bag_size: 109
batch 299, loss: 1.1199, instance_loss: 0.5813, weighted_loss: 0.9583, label: 2, bag_size: 877
batch 319, loss: 0.9926, instance_loss: 0.4943, weighted_loss: 0.8431, label: 3, bag_size: 817
batch 339, loss: 0.5896, instance_loss: 0.4395, weighted_loss: 0.5446, label: 1, bag_size: 460
batch 359, loss: 1.4948, instance_loss: 0.5536, weighted_loss: 1.2125, label: 3, bag_size: 523
batch 379, loss: 0.0394, instance_loss: 0.3107, weighted_loss: 0.1208, label: 0, bag_size: 103
batch 399, loss: 1.1279, instance_loss: 0.5286, weighted_loss: 0.9481, label: 4, bag_size: 342
batch 419, loss: 1.0216, instance_loss: 0.5580, weighted_loss: 0.8825, label: 0, bag_size: 615
batch 439, loss: 1.0243, instance_loss: 0.3858, weighted_loss: 0.8327, label: 4, bag_size: 110
batch 459, loss: 2.1244, instance_loss: 0.5693, weighted_loss: 1.6578, label: 1, bag_size: 391
batch 479, loss: 0.6244, instance_loss: 0.4468, weighted_loss: 0.5711, label: 1, bag_size: 892
batch 499, loss: 0.4376, instance_loss: 0.3924, weighted_loss: 0.4241, label: 4, bag_size: 356
batch 519, loss: 1.4798, instance_loss: 0.5555, weighted_loss: 1.2025, label: 2, bag_size: 592
batch 539, loss: 3.0482, instance_loss: 0.8454, weighted_loss: 2.3874, label: 3, bag_size: 1284
batch 559, loss: 1.5455, instance_loss: 0.4449, weighted_loss: 1.2153, label: 1, bag_size: 332
batch 579, loss: 1.3022, instance_loss: 0.4381, weighted_loss: 1.0430, label: 1, bag_size: 311


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.043560606060606064: correct 207/4752
Epoch: 30, train_loss: 1.1522, train_clustering_loss:  0.4832, train_error: 0.4916
class 0: acc 0.7868852459016393, correct 96/122
class 1: acc 0.5517241379310345, correct 64/116
class 2: acc 0.09473684210526316, correct 9/95
class 3: acc 0.3333333333333333, correct 42/126
class 4: acc 0.674074074074074, correct 91/135

Val Set, val_loss: 1.2841, val_error: 0.4730, auc: 0.8058
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 2.0060, instance_loss: 0.6765, weighted_loss: 1.6071, label: 2, bag_size: 934
batch 39, loss: 0.3433, instance_loss: 0.3364, weighted_loss: 0.3413, label: 4, bag_size: 780
batch 59, loss: 0.0671, instance_loss: 0.3427, weighted_loss: 0.1498, label: 0, bag_size: 76
batch 79, loss: 1.8968, instance_loss: 0.5403, weighted_loss: 1.4899, label: 3, bag_size: 497
batch 99, loss: 2.0368, instance_loss: 0.6839, weighted_loss: 1.6309, label: 2, bag_size: 909
batch 119, loss: 1.3599, instance_loss: 0.5367, weighted_loss: 1.1129, label: 2, bag_size: 348
batch 139, loss: 0.5983, instance_loss: 0.4679, weighted_loss: 0.5592, label: 4, bag_size: 665
batch 159, loss: 0.0108, instance_loss: 0.3020, weighted_loss: 0.0982, label: 0, bag_size: 397
batch 179, loss: 0.0580, instance_loss: 0.2459, weighted_loss: 0.1144, label: 0, bag_size: 97
batch 199, loss: 1.1850, instance_loss: 0.5261, weighted_loss: 0.9873, label: 0, bag_size: 311
batch 219, loss: 1.2784, instance_loss: 0.4765, weighted_loss: 1.0378, label: 1, bag_size: 1082
batch 239, loss: 1.1467, instance_loss: 0.5361, weighted_loss: 0.9635, label: 2, bag_size: 286
batch 259, loss: 0.8373, instance_loss: 0.4583, weighted_loss: 0.7236, label: 2, bag_size: 754
batch 279, loss: 1.7311, instance_loss: 0.5681, weighted_loss: 1.3822, label: 4, bag_size: 970
batch 299, loss: 0.0724, instance_loss: 0.2812, weighted_loss: 0.1351, label: 0, bag_size: 523
batch 319, loss: 0.6954, instance_loss: 0.4179, weighted_loss: 0.6121, label: 1, bag_size: 233
batch 339, loss: 1.9169, instance_loss: 0.6254, weighted_loss: 1.5295, label: 2, bag_size: 303
batch 359, loss: 0.8917, instance_loss: 0.4110, weighted_loss: 0.7475, label: 1, bag_size: 329
batch 379, loss: 1.8211, instance_loss: 0.5898, weighted_loss: 1.4517, label: 2, bag_size: 390
batch 399, loss: 0.0445, instance_loss: 0.2615, weighted_loss: 0.1096, label: 0, bag_size: 97
batch 419, loss: 1.5379, instance_loss: 0.5839, weighted_loss: 1.2517, label: 2, bag_size: 498
batch 439, loss: 0.9778, instance_loss: 0.4553, weighted_loss: 0.8210, label: 1, bag_size: 1043
batch 459, loss: 1.5541, instance_loss: 0.5312, weighted_loss: 1.2472, label: 1, bag_size: 1023
batch 479, loss: 0.5180, instance_loss: 0.3638, weighted_loss: 0.4718, label: 4, bag_size: 395
batch 499, loss: 0.7145, instance_loss: 0.4397, weighted_loss: 0.6321, label: 3, bag_size: 102
batch 519, loss: 0.8009, instance_loss: 0.3888, weighted_loss: 0.6773, label: 3, bag_size: 282
batch 539, loss: 1.8253, instance_loss: 0.5803, weighted_loss: 1.4518, label: 2, bag_size: 380
batch 559, loss: 0.7195, instance_loss: 0.4293, weighted_loss: 0.6325, label: 1, bag_size: 672
batch 579, loss: 1.7478, instance_loss: 0.4936, weighted_loss: 1.3716, label: 2, bag_size: 1077


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.06523569023569023: correct 310/4752
Epoch: 31, train_loss: 1.0795, train_clustering_loss:  0.4686, train_error: 0.4714
class 0: acc 0.7478260869565218, correct 86/115
class 1: acc 0.6594202898550725, correct 91/138
class 2: acc 0.24561403508771928, correct 28/114
class 3: acc 0.39622641509433965, correct 42/106
class 4: acc 0.5537190082644629, correct 67/121

Val Set, val_loss: 1.3257, val_error: 0.5811, auc: 0.8049
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.07094594594594594: correct 42/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0133, instance_loss: 0.3442, weighted_loss: 0.1126, label: 0, bag_size: 354
batch 39, loss: 1.0334, instance_loss: 0.5045, weighted_loss: 0.8747, label: 3, bag_size: 457
batch 59, loss: 0.0158, instance_loss: 0.2516, weighted_loss: 0.0865, label: 0, bag_size: 37
batch 79, loss: 1.0071, instance_loss: 0.4737, weighted_loss: 0.8471, label: 2, bag_size: 522
batch 99, loss: 0.6504, instance_loss: 0.4808, weighted_loss: 0.5996, label: 2, bag_size: 315
batch 119, loss: 1.9688, instance_loss: 0.6161, weighted_loss: 1.5630, label: 2, bag_size: 934
batch 139, loss: 0.6309, instance_loss: 0.3391, weighted_loss: 0.5433, label: 1, bag_size: 1082
batch 159, loss: 0.6778, instance_loss: 0.3977, weighted_loss: 0.5938, label: 4, bag_size: 450
batch 179, loss: 0.7114, instance_loss: 0.4023, weighted_loss: 0.6187, label: 4, bag_size: 490
batch 199, loss: 0.4275, instance_loss: 0.3919, weighted_loss: 0.4168, label: 0, bag_size: 404
batch 219, loss: 1.9040, instance_loss: 0.5412, weighted_loss: 1.4951, label: 3, bag_size: 1186
batch 239, loss: 0.6008, instance_loss: 0.4579, weighted_loss: 0.5579, label: 1, bag_size: 1009
batch 259, loss: 0.7022, instance_loss: 0.4283, weighted_loss: 0.6200, label: 2, bag_size: 783
batch 279, loss: 1.7018, instance_loss: 0.4758, weighted_loss: 1.3340, label: 3, bag_size: 1232
batch 299, loss: 2.0419, instance_loss: 0.5501, weighted_loss: 1.5943, label: 4, bag_size: 476
batch 319, loss: 0.0618, instance_loss: 0.2622, weighted_loss: 0.1219, label: 0, bag_size: 285
batch 339, loss: 0.6421, instance_loss: 0.3807, weighted_loss: 0.5637, label: 3, bag_size: 492
batch 359, loss: 2.5978, instance_loss: 0.5914, weighted_loss: 1.9959, label: 0, bag_size: 600
batch 379, loss: 0.7606, instance_loss: 0.4209, weighted_loss: 0.6587, label: 1, bag_size: 1360
batch 399, loss: 1.0467, instance_loss: 0.5265, weighted_loss: 0.8907, label: 3, bag_size: 1078
batch 419, loss: 1.2168, instance_loss: 0.4725, weighted_loss: 0.9935, label: 2, bag_size: 385
batch 439, loss: 1.0169, instance_loss: 0.4545, weighted_loss: 0.8482, label: 3, bag_size: 598
batch 459, loss: 1.0596, instance_loss: 0.4860, weighted_loss: 0.8875, label: 2, bag_size: 1230
batch 479, loss: 2.2204, instance_loss: 0.6182, weighted_loss: 1.7397, label: 2, bag_size: 297
batch 499, loss: 0.4861, instance_loss: 0.3866, weighted_loss: 0.4563, label: 0, bag_size: 306
batch 519, loss: 1.5404, instance_loss: 0.5477, weighted_loss: 1.2426, label: 3, bag_size: 344
batch 539, loss: 1.4003, instance_loss: 0.4879, weighted_loss: 1.1266, label: 3, bag_size: 344
batch 559, loss: 1.1200, instance_loss: 0.4674, weighted_loss: 0.9242, label: 4, bag_size: 592
batch 579, loss: 0.4030, instance_loss: 0.4484, weighted_loss: 0.4166, label: 4, bag_size: 854


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.04650673400673401: correct 221/4752
Epoch: 32, train_loss: 1.1660, train_clustering_loss:  0.4769, train_error: 0.4966
class 0: acc 0.7264957264957265, correct 85/117
class 1: acc 0.5245901639344263, correct 64/122
class 2: acc 0.23478260869565218, correct 27/115
class 3: acc 0.4369747899159664, correct 52/119
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.2572, val_error: 0.5135, auc: 0.7874
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8147, instance_loss: 0.4520, weighted_loss: 0.7059, label: 2, bag_size: 404
batch 39, loss: 0.8331, instance_loss: 0.4630, weighted_loss: 0.7221, label: 2, bag_size: 385
batch 59, loss: 1.6071, instance_loss: 0.5003, weighted_loss: 1.2751, label: 4, bag_size: 318
batch 79, loss: 0.6518, instance_loss: 0.4106, weighted_loss: 0.5794, label: 4, bag_size: 329
batch 99, loss: 1.1946, instance_loss: 0.4942, weighted_loss: 0.9845, label: 1, bag_size: 599
batch 119, loss: 1.6418, instance_loss: 0.5473, weighted_loss: 1.3134, label: 4, bag_size: 740
batch 139, loss: 0.3812, instance_loss: 0.4867, weighted_loss: 0.4128, label: 0, bag_size: 416
batch 159, loss: 1.5321, instance_loss: 0.6013, weighted_loss: 1.2529, label: 0, bag_size: 376
batch 179, loss: 0.9120, instance_loss: 0.5337, weighted_loss: 0.7985, label: 1, bag_size: 500
batch 199, loss: 0.0651, instance_loss: 0.3378, weighted_loss: 0.1469, label: 0, bag_size: 210
batch 219, loss: 1.3014, instance_loss: 0.4928, weighted_loss: 1.0588, label: 3, bag_size: 598
batch 239, loss: 0.8050, instance_loss: 0.3938, weighted_loss: 0.6816, label: 3, bag_size: 781
batch 259, loss: 1.1036, instance_loss: 0.4538, weighted_loss: 0.9087, label: 3, bag_size: 523
batch 279, loss: 1.7639, instance_loss: 0.6410, weighted_loss: 1.4271, label: 1, bag_size: 1019
batch 299, loss: 1.4442, instance_loss: 0.4639, weighted_loss: 1.1501, label: 3, bag_size: 857
batch 319, loss: 1.5962, instance_loss: 0.6754, weighted_loss: 1.3200, label: 0, bag_size: 376
batch 339, loss: 0.0229, instance_loss: 0.3237, weighted_loss: 0.1132, label: 0, bag_size: 280
batch 359, loss: 2.2272, instance_loss: 0.6600, weighted_loss: 1.7570, label: 3, bag_size: 476
batch 379, loss: 2.4106, instance_loss: 0.5744, weighted_loss: 1.8597, label: 0, bag_size: 888
batch 399, loss: 0.7326, instance_loss: 0.4598, weighted_loss: 0.6508, label: 4, bag_size: 160
batch 419, loss: 1.2177, instance_loss: 0.5118, weighted_loss: 1.0059, label: 1, bag_size: 522
batch 439, loss: 1.4215, instance_loss: 0.4729, weighted_loss: 1.1369, label: 3, bag_size: 102
batch 459, loss: 1.4555, instance_loss: 0.5594, weighted_loss: 1.1867, label: 1, bag_size: 141
batch 479, loss: 1.0404, instance_loss: 0.5476, weighted_loss: 0.8925, label: 3, bag_size: 818
batch 499, loss: 0.9745, instance_loss: 0.5503, weighted_loss: 0.8472, label: 2, bag_size: 571
batch 519, loss: 1.3032, instance_loss: 0.4942, weighted_loss: 1.0605, label: 4, bag_size: 853
batch 539, loss: 1.3434, instance_loss: 0.5581, weighted_loss: 1.1078, label: 3, bag_size: 459
batch 559, loss: 0.0017, instance_loss: 0.1620, weighted_loss: 0.0498, label: 0, bag_size: 80
batch 579, loss: 0.9558, instance_loss: 0.5363, weighted_loss: 0.8299, label: 2, bag_size: 350


class 0 clustering acc 0.9949494949494949: correct 23640/23760
class 1 clustering acc 0.08522727272727272: correct 405/4752
Epoch: 33, train_loss: 1.0811, train_clustering_loss:  0.4693, train_error: 0.4512
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.5409836065573771, correct 66/122
class 2: acc 0.30275229357798167, correct 33/109
class 3: acc 0.5163934426229508, correct 63/122
class 4: acc 0.5526315789473685, correct 63/114

Val Set, val_loss: 1.3187, val_error: 0.4730, auc: 0.7956
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8466, instance_loss: 0.3803, weighted_loss: 0.7067, label: 3, bag_size: 587
batch 39, loss: 0.9443, instance_loss: 0.5400, weighted_loss: 0.8230, label: 2, bag_size: 861
batch 59, loss: 0.8953, instance_loss: 0.4275, weighted_loss: 0.7550, label: 1, bag_size: 389
batch 79, loss: 0.9554, instance_loss: 0.4260, weighted_loss: 0.7966, label: 4, bag_size: 333
batch 99, loss: 0.0033, instance_loss: 0.2411, weighted_loss: 0.0746, label: 0, bag_size: 533
batch 119, loss: 1.4226, instance_loss: 0.5283, weighted_loss: 1.1543, label: 1, bag_size: 141
batch 139, loss: 0.3289, instance_loss: 0.4622, weighted_loss: 0.3689, label: 0, bag_size: 224
batch 159, loss: 1.0673, instance_loss: 0.4702, weighted_loss: 0.8882, label: 1, bag_size: 500
batch 179, loss: 0.9330, instance_loss: 0.4831, weighted_loss: 0.7980, label: 3, bag_size: 944
batch 199, loss: 0.6885, instance_loss: 0.3563, weighted_loss: 0.5888, label: 4, bag_size: 604
batch 219, loss: 0.4914, instance_loss: 0.4448, weighted_loss: 0.4774, label: 1, bag_size: 814
batch 239, loss: 1.1039, instance_loss: 0.5348, weighted_loss: 0.9332, label: 3, bag_size: 631
batch 259, loss: 0.4859, instance_loss: 0.3971, weighted_loss: 0.4593, label: 4, bag_size: 776
batch 279, loss: 1.1480, instance_loss: 0.5751, weighted_loss: 0.9762, label: 2, bag_size: 315
batch 299, loss: 1.1735, instance_loss: 0.4955, weighted_loss: 0.9701, label: 2, bag_size: 1013
batch 319, loss: 0.7888, instance_loss: 0.4869, weighted_loss: 0.6982, label: 3, bag_size: 309
batch 339, loss: 0.9441, instance_loss: 0.6134, weighted_loss: 0.8449, label: 0, bag_size: 879
batch 359, loss: 1.2963, instance_loss: 0.6036, weighted_loss: 1.0885, label: 0, bag_size: 615
batch 379, loss: 1.6671, instance_loss: 0.6218, weighted_loss: 1.3535, label: 2, bag_size: 290
batch 399, loss: 2.2263, instance_loss: 0.6260, weighted_loss: 1.7462, label: 2, bag_size: 754
batch 419, loss: 0.0942, instance_loss: 0.3101, weighted_loss: 0.1589, label: 0, bag_size: 57
batch 439, loss: 0.7266, instance_loss: 0.4866, weighted_loss: 0.6546, label: 1, bag_size: 855
batch 459, loss: 0.8972, instance_loss: 0.4872, weighted_loss: 0.7742, label: 3, bag_size: 817
batch 479, loss: 0.6887, instance_loss: 0.4223, weighted_loss: 0.6088, label: 3, bag_size: 245
batch 499, loss: 1.2955, instance_loss: 0.5881, weighted_loss: 1.0833, label: 0, bag_size: 223
batch 519, loss: 1.4684, instance_loss: 0.6254, weighted_loss: 1.2155, label: 4, bag_size: 886
batch 539, loss: 0.1320, instance_loss: 0.3682, weighted_loss: 0.2028, label: 0, bag_size: 57
batch 559, loss: 2.0335, instance_loss: 0.5846, weighted_loss: 1.5988, label: 2, bag_size: 754
batch 579, loss: 2.5194, instance_loss: 0.6075, weighted_loss: 1.9458, label: 4, bag_size: 270


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.04819023569023569: correct 229/4752
Epoch: 34, train_loss: 1.1157, train_clustering_loss:  0.4750, train_error: 0.4680
class 0: acc 0.7207207207207207, correct 80/111
class 1: acc 0.7482993197278912, correct 110/147
class 2: acc 0.14953271028037382, correct 16/107
class 3: acc 0.4700854700854701, correct 55/117
class 4: acc 0.49107142857142855, correct 55/112

Val Set, val_loss: 1.2401, val_error: 0.5270, auc: 0.7951
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.05067567567567568: correct 30/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0672, instance_loss: 0.4875, weighted_loss: 0.8933, label: 2, bag_size: 590
batch 39, loss: 0.0111, instance_loss: 0.3053, weighted_loss: 0.0993, label: 0, bag_size: 366
batch 59, loss: 3.1983, instance_loss: 0.6579, weighted_loss: 2.4362, label: 0, bag_size: 600
batch 79, loss: 0.9627, instance_loss: 0.4953, weighted_loss: 0.8225, label: 1, bag_size: 398
batch 99, loss: 0.7557, instance_loss: 0.5251, weighted_loss: 0.6865, label: 1, bag_size: 617
batch 119, loss: 1.4202, instance_loss: 0.5316, weighted_loss: 1.1536, label: 2, bag_size: 651
batch 139, loss: 2.0215, instance_loss: 0.6102, weighted_loss: 1.5981, label: 2, bag_size: 645
batch 159, loss: 0.2370, instance_loss: 0.3909, weighted_loss: 0.2832, label: 0, bag_size: 231
batch 179, loss: 2.6344, instance_loss: 0.4787, weighted_loss: 1.9877, label: 4, bag_size: 409
batch 199, loss: 0.2818, instance_loss: 0.3460, weighted_loss: 0.3010, label: 4, bag_size: 895
batch 219, loss: 1.1510, instance_loss: 0.4135, weighted_loss: 0.9297, label: 3, bag_size: 944
batch 239, loss: 0.8253, instance_loss: 0.4163, weighted_loss: 0.7026, label: 4, bag_size: 228
batch 259, loss: 0.5287, instance_loss: 0.3462, weighted_loss: 0.4739, label: 1, bag_size: 1091
batch 279, loss: 1.0255, instance_loss: 0.4407, weighted_loss: 0.8500, label: 1, bag_size: 381
batch 299, loss: 1.3162, instance_loss: 0.6176, weighted_loss: 1.1067, label: 2, bag_size: 554
batch 319, loss: 2.0727, instance_loss: 0.5667, weighted_loss: 1.6209, label: 3, bag_size: 961
batch 339, loss: 1.8451, instance_loss: 0.4623, weighted_loss: 1.4303, label: 4, bag_size: 407
batch 359, loss: 1.4167, instance_loss: 0.4483, weighted_loss: 1.1262, label: 3, bag_size: 443
batch 379, loss: 0.4299, instance_loss: 0.2954, weighted_loss: 0.3895, label: 4, bag_size: 418
batch 399, loss: 1.1700, instance_loss: 0.6375, weighted_loss: 1.0103, label: 2, bag_size: 567
batch 419, loss: 0.4060, instance_loss: 0.4310, weighted_loss: 0.4135, label: 0, bag_size: 288
batch 439, loss: 1.5797, instance_loss: 0.5844, weighted_loss: 1.2811, label: 2, bag_size: 380
batch 459, loss: 0.5372, instance_loss: 0.3587, weighted_loss: 0.4837, label: 1, bag_size: 1104
batch 479, loss: 0.0304, instance_loss: 0.2239, weighted_loss: 0.0884, label: 0, bag_size: 251
batch 499, loss: 1.8421, instance_loss: 0.5650, weighted_loss: 1.4590, label: 4, bag_size: 267
batch 519, loss: 1.5214, instance_loss: 0.6118, weighted_loss: 1.2485, label: 2, bag_size: 339
batch 539, loss: 1.6544, instance_loss: 0.5994, weighted_loss: 1.3379, label: 3, bag_size: 344
batch 559, loss: 0.4451, instance_loss: 0.5931, weighted_loss: 0.4895, label: 0, bag_size: 178
batch 579, loss: 0.8242, instance_loss: 0.4563, weighted_loss: 0.7138, label: 3, bag_size: 697


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.07428451178451179: correct 353/4752
Epoch: 35, train_loss: 1.0765, train_clustering_loss:  0.4672, train_error: 0.4545
class 0: acc 0.7619047619047619, correct 96/126
class 1: acc 0.5666666666666667, correct 68/120
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.5462184873949579, correct 65/119
class 4: acc 0.5555555555555556, correct 65/117

Val Set, val_loss: 1.2336, val_error: 0.5811, auc: 0.8043
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.06756756756756757: correct 40/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8644, instance_loss: 0.4617, weighted_loss: 0.7436, label: 1, bag_size: 233
batch 39, loss: 1.0057, instance_loss: 0.4278, weighted_loss: 0.8323, label: 1, bag_size: 695
batch 59, loss: 0.8416, instance_loss: 0.4583, weighted_loss: 0.7266, label: 2, bag_size: 567
batch 79, loss: 2.0523, instance_loss: 0.5734, weighted_loss: 1.6087, label: 4, bag_size: 1064
batch 99, loss: 0.4229, instance_loss: 0.4705, weighted_loss: 0.4372, label: 4, bag_size: 746
batch 119, loss: 2.8706, instance_loss: 0.7169, weighted_loss: 2.2245, label: 2, bag_size: 519
batch 139, loss: 0.0000, instance_loss: 0.4048, weighted_loss: 0.1214, label: 1, bag_size: 669
batch 159, loss: 1.2573, instance_loss: 0.5865, weighted_loss: 1.0560, label: 3, bag_size: 228
batch 179, loss: 0.1867, instance_loss: 0.4055, weighted_loss: 0.2523, label: 2, bag_size: 596
batch 199, loss: 1.1796, instance_loss: 0.5537, weighted_loss: 0.9918, label: 3, bag_size: 928
batch 219, loss: 1.3090, instance_loss: 0.4277, weighted_loss: 1.0446, label: 1, bag_size: 742
batch 239, loss: 0.8666, instance_loss: 0.4361, weighted_loss: 0.7374, label: 3, bag_size: 472
batch 259, loss: 0.8685, instance_loss: 0.3987, weighted_loss: 0.7276, label: 1, bag_size: 928
batch 279, loss: 0.2196, instance_loss: 0.3620, weighted_loss: 0.2623, label: 0, bag_size: 566
batch 299, loss: 1.1076, instance_loss: 0.4476, weighted_loss: 0.9096, label: 3, bag_size: 739
batch 319, loss: 0.0335, instance_loss: 0.1523, weighted_loss: 0.0691, label: 0, bag_size: 393
batch 339, loss: 1.3031, instance_loss: 0.4930, weighted_loss: 1.0600, label: 2, bag_size: 769
batch 359, loss: 2.2358, instance_loss: 0.5828, weighted_loss: 1.7399, label: 0, bag_size: 367
batch 379, loss: 1.7280, instance_loss: 0.5206, weighted_loss: 1.3658, label: 1, bag_size: 413
batch 399, loss: 1.1411, instance_loss: 0.4898, weighted_loss: 0.9457, label: 1, bag_size: 384
batch 419, loss: 0.3671, instance_loss: 0.4306, weighted_loss: 0.3861, label: 4, bag_size: 683
batch 439, loss: 1.0169, instance_loss: 0.4258, weighted_loss: 0.8396, label: 2, bag_size: 708
batch 459, loss: 0.5417, instance_loss: 0.3245, weighted_loss: 0.4765, label: 4, bag_size: 652
batch 479, loss: 1.1859, instance_loss: 0.5335, weighted_loss: 0.9902, label: 2, bag_size: 337
batch 499, loss: 2.4508, instance_loss: 0.4853, weighted_loss: 1.8611, label: 0, bag_size: 169
batch 519, loss: 1.1143, instance_loss: 0.5037, weighted_loss: 0.9311, label: 2, bag_size: 337
batch 539, loss: 1.5287, instance_loss: 0.5785, weighted_loss: 1.2436, label: 1, bag_size: 925
batch 559, loss: 1.5768, instance_loss: 0.6082, weighted_loss: 1.2863, label: 4, bag_size: 476
batch 579, loss: 0.8119, instance_loss: 0.4363, weighted_loss: 0.6992, label: 1, bag_size: 865


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.07596801346801346: correct 361/4752
Epoch: 36, train_loss: 1.0846, train_clustering_loss:  0.4707, train_error: 0.4916
class 0: acc 0.7946428571428571, correct 89/112
class 1: acc 0.46875, correct 60/128
class 2: acc 0.3609022556390977, correct 48/133
class 3: acc 0.46218487394957986, correct 55/119
class 4: acc 0.49019607843137253, correct 50/102

Val Set, val_loss: 1.2284, val_error: 0.4730, auc: 0.8201
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.230621 --> 1.228431).  Saving model ...


batch 19, loss: 1.3463, instance_loss: 0.4592, weighted_loss: 1.0802, label: 1, bag_size: 271
batch 39, loss: 1.1598, instance_loss: 0.5209, weighted_loss: 0.9681, label: 2, bag_size: 244
batch 59, loss: 0.1668, instance_loss: 0.3826, weighted_loss: 0.2315, label: 0, bag_size: 73
batch 79, loss: 0.7372, instance_loss: 0.4476, weighted_loss: 0.6503, label: 1, bag_size: 1121
batch 99, loss: 1.2738, instance_loss: 0.4864, weighted_loss: 1.0376, label: 1, bag_size: 526
batch 119, loss: 0.3350, instance_loss: 0.3736, weighted_loss: 0.3466, label: 4, bag_size: 773
batch 139, loss: 1.5428, instance_loss: 0.5398, weighted_loss: 1.2419, label: 2, bag_size: 448
batch 159, loss: 1.0563, instance_loss: 0.4585, weighted_loss: 0.8769, label: 0, bag_size: 306
batch 179, loss: 0.8517, instance_loss: 0.3988, weighted_loss: 0.7158, label: 2, bag_size: 285
batch 199, loss: 1.4512, instance_loss: 0.6141, weighted_loss: 1.2001, label: 4, bag_size: 333
batch 219, loss: 0.0647, instance_loss: 0.2815, weighted_loss: 0.1298, label: 0, bag_size: 218
batch 239, loss: 3.1908, instance_loss: 0.6151, weighted_loss: 2.4181, label: 1, bag_size: 742
batch 259, loss: 0.0197, instance_loss: 0.2656, weighted_loss: 0.0935, label: 0, bag_size: 357
batch 279, loss: 2.1005, instance_loss: 0.5738, weighted_loss: 1.6425, label: 3, bag_size: 492
batch 299, loss: 0.7309, instance_loss: 0.4346, weighted_loss: 0.6420, label: 3, bag_size: 369
batch 319, loss: 0.0645, instance_loss: 0.2218, weighted_loss: 0.1117, label: 0, bag_size: 282
batch 339, loss: 1.2490, instance_loss: 0.4876, weighted_loss: 1.0206, label: 4, bag_size: 970
batch 359, loss: 0.1881, instance_loss: 0.3567, weighted_loss: 0.2387, label: 4, bag_size: 948
batch 379, loss: 0.6360, instance_loss: 0.3564, weighted_loss: 0.5521, label: 0, bag_size: 305
batch 399, loss: 0.4476, instance_loss: 0.3558, weighted_loss: 0.4200, label: 3, bag_size: 587
batch 419, loss: 2.9897, instance_loss: 0.7126, weighted_loss: 2.3066, label: 0, bag_size: 1414
batch 439, loss: 0.1416, instance_loss: 0.3153, weighted_loss: 0.1937, label: 1, bag_size: 371
batch 459, loss: 1.3111, instance_loss: 0.5478, weighted_loss: 1.0821, label: 1, bag_size: 355
batch 479, loss: 2.3274, instance_loss: 0.6994, weighted_loss: 1.8390, label: 1, bag_size: 113
batch 499, loss: 0.8623, instance_loss: 0.4432, weighted_loss: 0.7365, label: 1, bag_size: 972
batch 519, loss: 0.6043, instance_loss: 0.3857, weighted_loss: 0.5387, label: 3, bag_size: 369
batch 539, loss: 0.8196, instance_loss: 0.4441, weighted_loss: 0.7070, label: 1, bag_size: 526
batch 559, loss: 0.7122, instance_loss: 0.4109, weighted_loss: 0.6218, label: 0, bag_size: 710
batch 579, loss: 0.9362, instance_loss: 0.3839, weighted_loss: 0.7705, label: 0, bag_size: 343


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.0664983164983165: correct 316/4752
Epoch: 37, train_loss: 1.1066, train_clustering_loss:  0.4742, train_error: 0.4512
class 0: acc 0.7622950819672131, correct 93/122
class 1: acc 0.5892857142857143, correct 66/112
class 2: acc 0.35714285714285715, correct 45/126
class 3: acc 0.5303030303030303, correct 70/132
class 4: acc 0.5098039215686274, correct 52/102

Val Set, val_loss: 1.2799, val_error: 0.4730, auc: 0.8160
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.1097972972972973: correct 65/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 3.6449, instance_loss: 0.7574, weighted_loss: 2.7787, label: 4, bag_size: 1113
batch 39, loss: 0.6505, instance_loss: 0.4146, weighted_loss: 0.5797, label: 3, bag_size: 459
batch 59, loss: 0.0627, instance_loss: 0.2598, weighted_loss: 0.1219, label: 0, bag_size: 351
batch 79, loss: 0.9173, instance_loss: 0.4004, weighted_loss: 0.7622, label: 3, bag_size: 282
batch 99, loss: 1.1107, instance_loss: 0.5668, weighted_loss: 0.9476, label: 4, bag_size: 160
batch 119, loss: 0.8007, instance_loss: 0.4642, weighted_loss: 0.6997, label: 4, bag_size: 574
batch 139, loss: 0.1960, instance_loss: 0.3790, weighted_loss: 0.2509, label: 4, bag_size: 409
batch 159, loss: 1.0266, instance_loss: 0.4419, weighted_loss: 0.8512, label: 4, bag_size: 110
batch 179, loss: 2.8113, instance_loss: 0.6466, weighted_loss: 2.1619, label: 0, bag_size: 964
batch 199, loss: 0.0974, instance_loss: 0.2758, weighted_loss: 0.1509, label: 0, bag_size: 218
batch 219, loss: 1.4240, instance_loss: 0.5379, weighted_loss: 1.1582, label: 3, bag_size: 1022
batch 239, loss: 2.4443, instance_loss: 0.5927, weighted_loss: 1.8888, label: 4, bag_size: 250
batch 259, loss: 1.2664, instance_loss: 0.5186, weighted_loss: 1.0421, label: 2, bag_size: 337
batch 279, loss: 2.2879, instance_loss: 0.7047, weighted_loss: 1.8129, label: 0, bag_size: 421
batch 299, loss: 2.9742, instance_loss: 0.6931, weighted_loss: 2.2899, label: 1, bag_size: 361
batch 319, loss: 1.6338, instance_loss: 0.5133, weighted_loss: 1.2976, label: 1, bag_size: 208
batch 339, loss: 0.0692, instance_loss: 0.2059, weighted_loss: 0.1102, label: 0, bag_size: 282
batch 359, loss: 1.9765, instance_loss: 0.5826, weighted_loss: 1.5584, label: 3, bag_size: 899
batch 379, loss: 0.7905, instance_loss: 0.4985, weighted_loss: 0.7029, label: 2, bag_size: 290
batch 399, loss: 0.6221, instance_loss: 0.3292, weighted_loss: 0.5343, label: 4, bag_size: 687
batch 419, loss: 0.6691, instance_loss: 0.5105, weighted_loss: 0.6215, label: 0, bag_size: 62
batch 439, loss: 1.7866, instance_loss: 0.5821, weighted_loss: 1.4253, label: 3, bag_size: 390
batch 459, loss: 2.7974, instance_loss: 0.6606, weighted_loss: 2.1564, label: 3, bag_size: 156
batch 479, loss: 1.3569, instance_loss: 0.4897, weighted_loss: 1.0968, label: 2, bag_size: 1077
batch 499, loss: 1.6511, instance_loss: 0.4438, weighted_loss: 1.2889, label: 4, bag_size: 263
batch 519, loss: 0.0507, instance_loss: 0.3070, weighted_loss: 0.1276, label: 0, bag_size: 1570
batch 539, loss: 0.7969, instance_loss: 0.4293, weighted_loss: 0.6866, label: 1, bag_size: 697
batch 559, loss: 1.2244, instance_loss: 0.5293, weighted_loss: 1.0159, label: 2, bag_size: 799
batch 579, loss: 0.4814, instance_loss: 0.4213, weighted_loss: 0.4634, label: 3, bag_size: 737


class 0 clustering acc 0.9956228956228956: correct 23656/23760
class 1 clustering acc 0.07828282828282829: correct 372/4752
Epoch: 38, train_loss: 1.0506, train_clustering_loss:  0.4676, train_error: 0.4428
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.49586776859504134, correct 60/121
class 2: acc 0.308411214953271, correct 33/107
class 3: acc 0.5169491525423728, correct 61/118
class 4: acc 0.6377952755905512, correct 81/127

Val Set, val_loss: 1.2669, val_error: 0.5000, auc: 0.8096
class 0 clustering acc 0.9939189189189189: correct 2942/2960
class 1 clustering acc 0.0929054054054054: correct 55/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6370, instance_loss: 0.5073, weighted_loss: 0.5981, label: 1, bag_size: 329
batch 39, loss: 0.5948, instance_loss: 0.4077, weighted_loss: 0.5387, label: 4, bag_size: 293
batch 59, loss: 1.0979, instance_loss: 0.5144, weighted_loss: 0.9229, label: 3, bag_size: 432
batch 79, loss: 0.5037, instance_loss: 0.3853, weighted_loss: 0.4682, label: 0, bag_size: 397
batch 99, loss: 3.2921, instance_loss: 0.6246, weighted_loss: 2.4918, label: 3, bag_size: 342
batch 119, loss: 2.3288, instance_loss: 0.6366, weighted_loss: 1.8211, label: 2, bag_size: 606
batch 139, loss: 1.4679, instance_loss: 0.5592, weighted_loss: 1.1953, label: 2, bag_size: 390
batch 159, loss: 0.9382, instance_loss: 0.3819, weighted_loss: 0.7713, label: 4, bag_size: 1031
batch 179, loss: 2.1238, instance_loss: 0.5869, weighted_loss: 1.6627, label: 4, bag_size: 1064
batch 199, loss: 0.8586, instance_loss: 0.4667, weighted_loss: 0.7411, label: 3, bag_size: 282
batch 219, loss: 0.9641, instance_loss: 0.5587, weighted_loss: 0.8425, label: 4, bag_size: 160
batch 239, loss: 0.0126, instance_loss: 0.3239, weighted_loss: 0.1060, label: 0, bag_size: 37
batch 259, loss: 0.6846, instance_loss: 0.4560, weighted_loss: 0.6160, label: 3, bag_size: 830
batch 279, loss: 3.0556, instance_loss: 0.7284, weighted_loss: 2.3575, label: 2, bag_size: 852
batch 299, loss: 1.7837, instance_loss: 0.6020, weighted_loss: 1.4292, label: 1, bag_size: 599
batch 319, loss: 0.0024, instance_loss: 0.1611, weighted_loss: 0.0500, label: 0, bag_size: 230
batch 339, loss: 0.0355, instance_loss: 0.1931, weighted_loss: 0.0828, label: 0, bag_size: 573
batch 359, loss: 1.2277, instance_loss: 0.6033, weighted_loss: 1.0404, label: 4, bag_size: 886
batch 379, loss: 0.0029, instance_loss: 0.1179, weighted_loss: 0.0374, label: 0, bag_size: 341
batch 399, loss: 1.0062, instance_loss: 0.5124, weighted_loss: 0.8580, label: 1, bag_size: 408
batch 419, loss: 0.8555, instance_loss: 0.4524, weighted_loss: 0.7346, label: 3, bag_size: 603
batch 439, loss: 1.7846, instance_loss: 0.5127, weighted_loss: 1.4030, label: 1, bag_size: 113
batch 459, loss: 1.3142, instance_loss: 0.4499, weighted_loss: 1.0549, label: 4, bag_size: 356
batch 479, loss: 0.9760, instance_loss: 0.5649, weighted_loss: 0.8527, label: 1, bag_size: 1009
batch 499, loss: 0.9889, instance_loss: 0.4489, weighted_loss: 0.8269, label: 2, bag_size: 598
batch 519, loss: 0.7962, instance_loss: 0.5105, weighted_loss: 0.7105, label: 0, bag_size: 428
batch 539, loss: 3.6568, instance_loss: 0.6993, weighted_loss: 2.7696, label: 2, bag_size: 519
batch 559, loss: 2.6532, instance_loss: 0.6104, weighted_loss: 2.0403, label: 3, bag_size: 156
batch 579, loss: 1.1083, instance_loss: 0.5359, weighted_loss: 0.9366, label: 1, bag_size: 702


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.08101851851851852: correct 385/4752
Epoch: 39, train_loss: 1.0739, train_clustering_loss:  0.4747, train_error: 0.4764
class 0: acc 0.7777777777777778, correct 98/126
class 1: acc 0.4576271186440678, correct 54/118
class 2: acc 0.32558139534883723, correct 42/129
class 3: acc 0.5691056910569106, correct 70/123
class 4: acc 0.47959183673469385, correct 47/98

Val Set, val_loss: 1.2766, val_error: 0.4459, auc: 0.8089
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2374, instance_loss: 0.3572, weighted_loss: 0.2733, label: 0, bag_size: 269
batch 39, loss: 0.8468, instance_loss: 0.4840, weighted_loss: 0.7379, label: 2, bag_size: 119
batch 59, loss: 1.1048, instance_loss: 0.5365, weighted_loss: 0.9343, label: 3, bag_size: 1284
batch 79, loss: 1.2066, instance_loss: 0.5194, weighted_loss: 1.0004, label: 2, bag_size: 288
batch 99, loss: 0.6896, instance_loss: 0.4758, weighted_loss: 0.6255, label: 2, bag_size: 883
batch 119, loss: 2.0091, instance_loss: 0.6107, weighted_loss: 1.5896, label: 1, bag_size: 1043
batch 139, loss: 1.1107, instance_loss: 0.5337, weighted_loss: 0.9376, label: 2, bag_size: 697
batch 159, loss: 0.2356, instance_loss: 0.5691, weighted_loss: 0.3357, label: 4, bag_size: 773
batch 179, loss: 0.1504, instance_loss: 0.3560, weighted_loss: 0.2121, label: 0, bag_size: 351
batch 199, loss: 1.1191, instance_loss: 0.4721, weighted_loss: 0.9250, label: 2, bag_size: 290
batch 219, loss: 0.7023, instance_loss: 0.4123, weighted_loss: 0.6153, label: 3, bag_size: 566
batch 239, loss: 1.7166, instance_loss: 0.6619, weighted_loss: 1.4002, label: 2, bag_size: 337
batch 259, loss: 0.3722, instance_loss: 0.3797, weighted_loss: 0.3744, label: 3, bag_size: 684
batch 279, loss: 0.5949, instance_loss: 0.4336, weighted_loss: 0.5465, label: 0, bag_size: 74
batch 299, loss: 1.4901, instance_loss: 0.5436, weighted_loss: 1.2061, label: 3, bag_size: 228
batch 319, loss: 0.5382, instance_loss: 0.4743, weighted_loss: 0.5191, label: 1, bag_size: 593
batch 339, loss: 1.4007, instance_loss: 0.4027, weighted_loss: 1.1013, label: 4, bag_size: 438
batch 359, loss: 1.2265, instance_loss: 0.4804, weighted_loss: 1.0027, label: 3, bag_size: 1022
batch 379, loss: 1.3103, instance_loss: 0.4849, weighted_loss: 1.0627, label: 1, bag_size: 159
batch 399, loss: 1.2354, instance_loss: 0.4715, weighted_loss: 1.0062, label: 2, bag_size: 421
batch 419, loss: 1.1644, instance_loss: 0.5604, weighted_loss: 0.9832, label: 2, bag_size: 380
batch 439, loss: 0.2881, instance_loss: 0.4580, weighted_loss: 0.3390, label: 4, bag_size: 530
batch 459, loss: 0.5343, instance_loss: 0.5106, weighted_loss: 0.5272, label: 3, bag_size: 674
batch 479, loss: 2.7609, instance_loss: 0.6161, weighted_loss: 2.1175, label: 2, bag_size: 1010
batch 499, loss: 0.6096, instance_loss: 0.4789, weighted_loss: 0.5704, label: 4, bag_size: 853
batch 519, loss: 0.3978, instance_loss: 0.4583, weighted_loss: 0.4160, label: 4, bag_size: 1018
batch 539, loss: 0.3322, instance_loss: 0.3519, weighted_loss: 0.3381, label: 0, bag_size: 455
batch 559, loss: 0.4559, instance_loss: 0.4065, weighted_loss: 0.4411, label: 2, bag_size: 1066
batch 579, loss: 0.0500, instance_loss: 0.2264, weighted_loss: 0.1029, label: 0, bag_size: 306


class 0 clustering acc 0.9954124579124579: correct 23651/23760
class 1 clustering acc 0.07007575757575757: correct 333/4752
Epoch: 40, train_loss: 1.0752, train_clustering_loss:  0.4762, train_error: 0.4630
class 0: acc 0.7619047619047619, correct 96/126
class 1: acc 0.5566037735849056, correct 59/106
class 2: acc 0.31451612903225806, correct 39/124
class 3: acc 0.48, correct 60/125
class 4: acc 0.5752212389380531, correct 65/113

Val Set, val_loss: 1.3009, val_error: 0.5405, auc: 0.7869
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8756, instance_loss: 0.4945, weighted_loss: 0.7612, label: 2, bag_size: 769
batch 39, loss: 0.8489, instance_loss: 0.4602, weighted_loss: 0.7323, label: 0, bag_size: 587
batch 59, loss: 1.6198, instance_loss: 0.4186, weighted_loss: 1.2595, label: 4, bag_size: 726
batch 79, loss: 1.3809, instance_loss: 0.4504, weighted_loss: 1.1017, label: 2, bag_size: 631
batch 99, loss: 1.4090, instance_loss: 0.5839, weighted_loss: 1.1614, label: 4, bag_size: 310
batch 119, loss: 1.4542, instance_loss: 0.5840, weighted_loss: 1.1931, label: 0, bag_size: 367
batch 139, loss: 1.4476, instance_loss: 0.4919, weighted_loss: 1.1609, label: 1, bag_size: 695
batch 159, loss: 0.3347, instance_loss: 0.4155, weighted_loss: 0.3589, label: 0, bag_size: 33
batch 179, loss: 0.0087, instance_loss: 0.2122, weighted_loss: 0.0697, label: 0, bag_size: 80
batch 199, loss: 0.7222, instance_loss: 0.4271, weighted_loss: 0.6336, label: 2, bag_size: 402
batch 219, loss: 0.8750, instance_loss: 0.4430, weighted_loss: 0.7454, label: 1, bag_size: 742
batch 239, loss: 0.8262, instance_loss: 0.4309, weighted_loss: 0.7076, label: 1, bag_size: 1043
batch 259, loss: 0.1006, instance_loss: 0.4488, weighted_loss: 0.2051, label: 1, bag_size: 544
batch 279, loss: 0.6392, instance_loss: 0.4451, weighted_loss: 0.5810, label: 1, bag_size: 328
batch 299, loss: 0.7889, instance_loss: 0.4589, weighted_loss: 0.6899, label: 2, bag_size: 337
batch 319, loss: 0.8467, instance_loss: 0.4162, weighted_loss: 0.7175, label: 2, bag_size: 781
batch 339, loss: 3.2083, instance_loss: 0.6274, weighted_loss: 2.4340, label: 0, bag_size: 745
batch 359, loss: 0.7349, instance_loss: 0.4261, weighted_loss: 0.6423, label: 3, bag_size: 369
batch 379, loss: 1.3219, instance_loss: 0.4988, weighted_loss: 1.0750, label: 2, bag_size: 421
batch 399, loss: 0.4211, instance_loss: 0.4044, weighted_loss: 0.4161, label: 2, bag_size: 582
batch 419, loss: 0.4250, instance_loss: 0.4256, weighted_loss: 0.4252, label: 4, bag_size: 450
batch 439, loss: 2.7188, instance_loss: 0.5939, weighted_loss: 2.0813, label: 0, bag_size: 745
batch 459, loss: 2.4083, instance_loss: 0.5681, weighted_loss: 1.8562, label: 0, bag_size: 1073
batch 479, loss: 0.7414, instance_loss: 0.4566, weighted_loss: 0.6560, label: 3, bag_size: 282
batch 499, loss: 0.5501, instance_loss: 0.4061, weighted_loss: 0.5069, label: 1, bag_size: 1360
batch 519, loss: 0.0825, instance_loss: 0.6086, weighted_loss: 0.2403, label: 4, bag_size: 101
batch 539, loss: 0.2914, instance_loss: 0.4148, weighted_loss: 0.3285, label: 4, bag_size: 263
batch 559, loss: 0.7485, instance_loss: 0.5116, weighted_loss: 0.6775, label: 4, bag_size: 238
batch 579, loss: 1.1195, instance_loss: 0.6189, weighted_loss: 0.9693, label: 1, bag_size: 1023


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.04819023569023569: correct 229/4752
Epoch: 41, train_loss: 1.0250, train_clustering_loss:  0.4711, train_error: 0.4411
class 0: acc 0.75, correct 87/116
class 1: acc 0.4830508474576271, correct 57/118
class 2: acc 0.390625, correct 50/128
class 3: acc 0.4774774774774775, correct 53/111
class 4: acc 0.7024793388429752, correct 85/121

Val Set, val_loss: 1.1758, val_error: 0.5676, auc: 0.8173
class 0 clustering acc 0.9952702702702703: correct 2946/2960
class 1 clustering acc 0.06756756756756757: correct 40/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.228431 --> 1.175831).  Saving model ...


batch 19, loss: 1.9209, instance_loss: 0.5551, weighted_loss: 1.5112, label: 0, bag_size: 888
batch 39, loss: 1.4937, instance_loss: 0.7759, weighted_loss: 1.2784, label: 3, bag_size: 31
batch 59, loss: 1.2331, instance_loss: 0.3836, weighted_loss: 0.9783, label: 3, bag_size: 779
batch 79, loss: 1.6077, instance_loss: 0.5691, weighted_loss: 1.2962, label: 2, bag_size: 315
batch 99, loss: 0.5418, instance_loss: 0.4301, weighted_loss: 0.5083, label: 1, bag_size: 865
batch 119, loss: 2.0617, instance_loss: 0.4691, weighted_loss: 1.5839, label: 4, bag_size: 176
batch 139, loss: 0.0779, instance_loss: 0.4407, weighted_loss: 0.1867, label: 0, bag_size: 73
batch 159, loss: 0.6781, instance_loss: 0.4590, weighted_loss: 0.6124, label: 4, bag_size: 490
batch 179, loss: 1.2546, instance_loss: 0.4591, weighted_loss: 1.0160, label: 2, bag_size: 549
batch 199, loss: 0.0544, instance_loss: 0.3361, weighted_loss: 0.1389, label: 0, bag_size: 49
batch 219, loss: 1.4785, instance_loss: 0.4972, weighted_loss: 1.1841, label: 2, bag_size: 519
batch 239, loss: 2.9428, instance_loss: 0.8085, weighted_loss: 2.3025, label: 0, bag_size: 421
batch 259, loss: 0.6845, instance_loss: 0.7187, weighted_loss: 0.6947, label: 1, bag_size: 1082
batch 279, loss: 2.2016, instance_loss: 0.6152, weighted_loss: 1.7256, label: 4, bag_size: 1064
batch 299, loss: 0.0902, instance_loss: 0.3238, weighted_loss: 0.1603, label: 2, bag_size: 1975
batch 319, loss: 0.0972, instance_loss: 0.3360, weighted_loss: 0.1688, label: 4, bag_size: 409
batch 339, loss: 0.2742, instance_loss: 0.4127, weighted_loss: 0.3158, label: 4, bag_size: 685
batch 359, loss: 0.7337, instance_loss: 0.5539, weighted_loss: 0.6798, label: 3, bag_size: 899
batch 379, loss: 0.5060, instance_loss: 0.4652, weighted_loss: 0.4938, label: 3, bag_size: 858
batch 399, loss: 0.6686, instance_loss: 0.5214, weighted_loss: 0.6245, label: 4, bag_size: 446
batch 419, loss: 0.0685, instance_loss: 0.4454, weighted_loss: 0.1816, label: 0, bag_size: 295
batch 439, loss: 0.3588, instance_loss: 0.4321, weighted_loss: 0.3808, label: 4, bag_size: 450
batch 459, loss: 2.7886, instance_loss: 0.6374, weighted_loss: 2.1433, label: 3, bag_size: 533
batch 479, loss: 1.3672, instance_loss: 0.5623, weighted_loss: 1.1257, label: 2, bag_size: 651
batch 499, loss: 1.1923, instance_loss: 0.5199, weighted_loss: 0.9906, label: 1, bag_size: 381
batch 519, loss: 1.9440, instance_loss: 0.5746, weighted_loss: 1.5332, label: 0, bag_size: 367
batch 539, loss: 2.7948, instance_loss: 0.6292, weighted_loss: 2.1451, label: 1, bag_size: 397
batch 559, loss: 0.4812, instance_loss: 0.4825, weighted_loss: 0.4816, label: 1, bag_size: 1009
batch 579, loss: 1.1434, instance_loss: 0.4802, weighted_loss: 0.9445, label: 4, bag_size: 267


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.046296296296296294: correct 220/4752
Epoch: 42, train_loss: 1.0245, train_clustering_loss:  0.4774, train_error: 0.4478
class 0: acc 0.7894736842105263, correct 90/114
class 1: acc 0.43, correct 43/100
class 2: acc 0.4755244755244755, correct 68/143
class 3: acc 0.4375, correct 49/112
class 4: acc 0.624, correct 78/125

Val Set, val_loss: 1.2837, val_error: 0.5000, auc: 0.7953
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8121, instance_loss: 0.4672, weighted_loss: 0.7086, label: 0, bag_size: 269
batch 39, loss: 1.1979, instance_loss: 0.4965, weighted_loss: 0.9875, label: 2, bag_size: 744
batch 59, loss: 0.0584, instance_loss: 0.4232, weighted_loss: 0.1678, label: 0, bag_size: 573
batch 79, loss: 0.6866, instance_loss: 0.5012, weighted_loss: 0.6309, label: 4, bag_size: 853
batch 99, loss: 1.3170, instance_loss: 0.5427, weighted_loss: 1.0847, label: 1, bag_size: 161
batch 119, loss: 1.3796, instance_loss: 0.5600, weighted_loss: 1.1337, label: 2, bag_size: 119
batch 139, loss: 2.6140, instance_loss: 0.5715, weighted_loss: 2.0013, label: 0, bag_size: 1085
batch 159, loss: 2.6237, instance_loss: 0.5168, weighted_loss: 1.9916, label: 4, bag_size: 310
batch 179, loss: 1.4992, instance_loss: 0.4106, weighted_loss: 1.1726, label: 1, bag_size: 1273
batch 199, loss: 0.2830, instance_loss: 0.4003, weighted_loss: 0.3182, label: 0, bag_size: 455
batch 219, loss: 0.1222, instance_loss: 0.3382, weighted_loss: 0.1870, label: 0, bag_size: 493
batch 239, loss: 1.5153, instance_loss: 0.5122, weighted_loss: 1.2144, label: 2, bag_size: 390
batch 259, loss: 0.6980, instance_loss: 0.4388, weighted_loss: 0.6202, label: 3, bag_size: 344
batch 279, loss: 0.6744, instance_loss: 0.4600, weighted_loss: 0.6100, label: 0, bag_size: 393
batch 299, loss: 0.8414, instance_loss: 0.4343, weighted_loss: 0.7193, label: 3, bag_size: 98
batch 319, loss: 4.1851, instance_loss: 0.7418, weighted_loss: 3.1521, label: 0, bag_size: 243
batch 339, loss: 0.2887, instance_loss: 0.4070, weighted_loss: 0.3242, label: 4, bag_size: 895
batch 359, loss: 0.8768, instance_loss: 0.5073, weighted_loss: 0.7660, label: 3, bag_size: 473
batch 379, loss: 1.6149, instance_loss: 0.5117, weighted_loss: 1.2840, label: 2, bag_size: 906
batch 399, loss: 0.0226, instance_loss: 0.4231, weighted_loss: 0.1428, label: 0, bag_size: 523
batch 419, loss: 0.4662, instance_loss: 0.4427, weighted_loss: 0.4591, label: 3, bag_size: 737
batch 439, loss: 0.7477, instance_loss: 0.4081, weighted_loss: 0.6458, label: 1, bag_size: 534
batch 459, loss: 1.4545, instance_loss: 0.6541, weighted_loss: 1.2144, label: 0, bag_size: 343
batch 479, loss: 1.7439, instance_loss: 0.4920, weighted_loss: 1.3683, label: 2, bag_size: 1003
batch 499, loss: 0.1281, instance_loss: 0.3045, weighted_loss: 0.1810, label: 0, bag_size: 73
batch 519, loss: 0.7903, instance_loss: 0.3865, weighted_loss: 0.6692, label: 1, bag_size: 500
batch 539, loss: 1.4648, instance_loss: 0.5453, weighted_loss: 1.1890, label: 2, bag_size: 853
batch 559, loss: 2.5395, instance_loss: 0.6325, weighted_loss: 1.9674, label: 2, bag_size: 606
batch 579, loss: 1.3514, instance_loss: 0.5231, weighted_loss: 1.1029, label: 4, bag_size: 395


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.05324074074074074: correct 253/4752
Epoch: 43, train_loss: 1.0758, train_clustering_loss:  0.4718, train_error: 0.4613
class 0: acc 0.7105263157894737, correct 81/114
class 1: acc 0.5785714285714286, correct 81/140
class 2: acc 0.33884297520661155, correct 41/121
class 3: acc 0.42990654205607476, correct 46/107
class 4: acc 0.6339285714285714, correct 71/112

Val Set, val_loss: 1.1530, val_error: 0.4054, auc: 0.8133
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.175831 --> 1.152994).  Saving model ...


batch 19, loss: 0.0182, instance_loss: 0.2926, weighted_loss: 0.1005, label: 0, bag_size: 15
batch 39, loss: 2.0277, instance_loss: 0.5482, weighted_loss: 1.5838, label: 1, bag_size: 742
batch 59, loss: 1.6184, instance_loss: 0.6004, weighted_loss: 1.3130, label: 2, bag_size: 380
batch 79, loss: 0.6921, instance_loss: 0.4160, weighted_loss: 0.6093, label: 4, bag_size: 1077
batch 99, loss: 0.3638, instance_loss: 0.3009, weighted_loss: 0.3450, label: 0, bag_size: 103
batch 119, loss: 1.0799, instance_loss: 0.4651, weighted_loss: 0.8954, label: 3, bag_size: 1078
batch 139, loss: 1.4371, instance_loss: 0.6656, weighted_loss: 1.2056, label: 0, bag_size: 615
batch 159, loss: 0.9053, instance_loss: 0.4046, weighted_loss: 0.7551, label: 1, bag_size: 906
batch 179, loss: 1.1455, instance_loss: 0.4973, weighted_loss: 0.9510, label: 3, bag_size: 797
batch 199, loss: 0.9772, instance_loss: 0.4021, weighted_loss: 0.8047, label: 1, bag_size: 1121
batch 219, loss: 1.3815, instance_loss: 0.5058, weighted_loss: 1.1188, label: 3, bag_size: 1154
batch 239, loss: 0.6020, instance_loss: 0.4504, weighted_loss: 0.5565, label: 3, bag_size: 245
batch 259, loss: 0.2165, instance_loss: 0.4923, weighted_loss: 0.2992, label: 4, bag_size: 359
batch 279, loss: 0.1430, instance_loss: 0.3283, weighted_loss: 0.1986, label: 4, bag_size: 746
batch 299, loss: 0.9217, instance_loss: 0.4839, weighted_loss: 0.7903, label: 4, bag_size: 683
batch 319, loss: 0.0356, instance_loss: 0.3048, weighted_loss: 0.1164, label: 0, bag_size: 188
batch 339, loss: 0.8928, instance_loss: 0.4288, weighted_loss: 0.7536, label: 0, bag_size: 879
batch 359, loss: 0.1309, instance_loss: 0.3521, weighted_loss: 0.1973, label: 1, bag_size: 748
batch 379, loss: 0.8508, instance_loss: 0.3867, weighted_loss: 0.7116, label: 4, bag_size: 366
batch 399, loss: 3.0251, instance_loss: 0.5657, weighted_loss: 2.2873, label: 1, bag_size: 184
batch 419, loss: 0.6438, instance_loss: 0.3691, weighted_loss: 0.5614, label: 4, bag_size: 176
batch 439, loss: 1.3402, instance_loss: 0.5488, weighted_loss: 1.1028, label: 3, bag_size: 1078
batch 459, loss: 0.8332, instance_loss: 0.5067, weighted_loss: 0.7352, label: 0, bag_size: 404
batch 479, loss: 2.0836, instance_loss: 0.5719, weighted_loss: 1.6301, label: 2, bag_size: 720
batch 499, loss: 1.1209, instance_loss: 0.5043, weighted_loss: 0.9359, label: 3, bag_size: 797
batch 519, loss: 0.6055, instance_loss: 0.3174, weighted_loss: 0.5191, label: 1, bag_size: 886
batch 539, loss: 0.4658, instance_loss: 0.4260, weighted_loss: 0.4539, label: 4, bag_size: 446
batch 559, loss: 0.0235, instance_loss: 0.2604, weighted_loss: 0.0945, label: 0, bag_size: 218
batch 579, loss: 2.7483, instance_loss: 0.7168, weighted_loss: 2.1389, label: 2, bag_size: 1122


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.07028619528619529: correct 334/4752
Epoch: 44, train_loss: 1.0638, train_clustering_loss:  0.4719, train_error: 0.4074
class 0: acc 0.8115942028985508, correct 112/138
class 1: acc 0.7352941176470589, correct 100/136
class 2: acc 0.16666666666666666, correct 17/102
class 3: acc 0.4666666666666667, correct 49/105
class 4: acc 0.6548672566371682, correct 74/113

Val Set, val_loss: 1.2118, val_error: 0.5135, auc: 0.8143
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1094, instance_loss: 0.3049, weighted_loss: 0.1681, label: 1, bag_size: 886
batch 39, loss: 0.8088, instance_loss: 0.3841, weighted_loss: 0.6814, label: 4, bag_size: 604
batch 59, loss: 1.1956, instance_loss: 0.4487, weighted_loss: 0.9715, label: 3, bag_size: 488
batch 79, loss: 2.0682, instance_loss: 0.4793, weighted_loss: 1.5915, label: 0, bag_size: 1073
batch 99, loss: 1.1784, instance_loss: 0.5402, weighted_loss: 0.9870, label: 3, bag_size: 1060
batch 119, loss: 3.3640, instance_loss: 0.6853, weighted_loss: 2.5604, label: 1, bag_size: 361
batch 139, loss: 1.9603, instance_loss: 0.4662, weighted_loss: 1.5120, label: 4, bag_size: 312
batch 159, loss: 0.9834, instance_loss: 0.5230, weighted_loss: 0.8452, label: 1, bag_size: 534
batch 179, loss: 1.0387, instance_loss: 0.5673, weighted_loss: 0.8973, label: 4, bag_size: 101
batch 199, loss: 1.8211, instance_loss: 0.5231, weighted_loss: 1.4317, label: 2, bag_size: 607
batch 219, loss: 0.1790, instance_loss: 0.3545, weighted_loss: 0.2317, label: 0, bag_size: 74
batch 239, loss: 1.0217, instance_loss: 0.4682, weighted_loss: 0.8556, label: 0, bag_size: 428
batch 259, loss: 0.6197, instance_loss: 0.4460, weighted_loss: 0.5676, label: 1, bag_size: 865
batch 279, loss: 1.7060, instance_loss: 0.5020, weighted_loss: 1.3448, label: 2, bag_size: 297
batch 299, loss: 0.2868, instance_loss: 0.4663, weighted_loss: 0.3407, label: 4, bag_size: 854
batch 319, loss: 0.6382, instance_loss: 0.4422, weighted_loss: 0.5794, label: 2, bag_size: 290
batch 339, loss: 1.1372, instance_loss: 0.5279, weighted_loss: 0.9544, label: 4, bag_size: 356
batch 359, loss: 1.1884, instance_loss: 0.4806, weighted_loss: 0.9761, label: 1, bag_size: 697
batch 379, loss: 0.7165, instance_loss: 0.5201, weighted_loss: 0.6576, label: 4, bag_size: 683
batch 399, loss: 2.5549, instance_loss: 0.5838, weighted_loss: 1.9636, label: 2, bag_size: 519
batch 419, loss: 0.3171, instance_loss: 0.4194, weighted_loss: 0.3478, label: 1, bag_size: 1091
batch 439, loss: 2.9934, instance_loss: 0.7524, weighted_loss: 2.3211, label: 4, bag_size: 1113
batch 459, loss: 0.2878, instance_loss: 0.3911, weighted_loss: 0.3188, label: 0, bag_size: 62
batch 479, loss: 0.0780, instance_loss: 0.4447, weighted_loss: 0.1880, label: 1, bag_size: 544
batch 499, loss: 0.3799, instance_loss: 0.5434, weighted_loss: 0.4289, label: 0, bag_size: 642
batch 519, loss: 1.9868, instance_loss: 0.6922, weighted_loss: 1.5984, label: 0, bag_size: 587
batch 539, loss: 1.1359, instance_loss: 0.5198, weighted_loss: 0.9510, label: 4, bag_size: 776
batch 559, loss: 1.6835, instance_loss: 0.5076, weighted_loss: 1.3307, label: 2, bag_size: 331
batch 579, loss: 1.3113, instance_loss: 0.4888, weighted_loss: 1.0646, label: 2, bag_size: 363


class 0 clustering acc 0.9965909090909091: correct 23679/23760
class 1 clustering acc 0.07891414141414141: correct 375/4752
Epoch: 45, train_loss: 1.0377, train_clustering_loss:  0.4717, train_error: 0.4411
class 0: acc 0.8076923076923077, correct 105/130
class 1: acc 0.5648148148148148, correct 61/108
class 2: acc 0.3515625, correct 45/128
class 3: acc 0.4824561403508772, correct 55/114
class 4: acc 0.5789473684210527, correct 66/114

Val Set, val_loss: 1.2250, val_error: 0.4189, auc: 0.8006
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4270, instance_loss: 0.5064, weighted_loss: 1.1508, label: 3, bag_size: 497
batch 39, loss: 1.4425, instance_loss: 0.5288, weighted_loss: 1.1684, label: 3, bag_size: 443
batch 59, loss: 1.1481, instance_loss: 0.4985, weighted_loss: 0.9533, label: 1, bag_size: 1043
batch 79, loss: 1.4970, instance_loss: 0.6478, weighted_loss: 1.2422, label: 0, bag_size: 421
batch 99, loss: 1.4861, instance_loss: 0.4910, weighted_loss: 1.1875, label: 2, bag_size: 549
batch 119, loss: 0.1880, instance_loss: 0.2690, weighted_loss: 0.2123, label: 1, bag_size: 1103
batch 139, loss: 0.8615, instance_loss: 0.5353, weighted_loss: 0.7636, label: 0, bag_size: 352
batch 159, loss: 0.0033, instance_loss: 0.1492, weighted_loss: 0.0471, label: 0, bag_size: 133
batch 179, loss: 0.0040, instance_loss: 0.1793, weighted_loss: 0.0566, label: 0, bag_size: 133
batch 199, loss: 0.3218, instance_loss: 0.3981, weighted_loss: 0.3447, label: 4, bag_size: 773
batch 219, loss: 2.1305, instance_loss: 0.5714, weighted_loss: 1.6627, label: 1, bag_size: 949
batch 239, loss: 0.1695, instance_loss: 0.3847, weighted_loss: 0.2340, label: 4, bag_size: 725
batch 259, loss: 1.1524, instance_loss: 0.4614, weighted_loss: 0.9451, label: 4, bag_size: 246
batch 279, loss: 0.7365, instance_loss: 0.4011, weighted_loss: 0.6359, label: 2, bag_size: 554
batch 299, loss: 1.0931, instance_loss: 0.3816, weighted_loss: 0.8797, label: 2, bag_size: 1003
batch 319, loss: 1.5362, instance_loss: 0.4977, weighted_loss: 1.2247, label: 2, bag_size: 1003
batch 339, loss: 0.9905, instance_loss: 0.5327, weighted_loss: 0.8532, label: 2, bag_size: 421
batch 359, loss: 0.7939, instance_loss: 0.4492, weighted_loss: 0.6905, label: 2, bag_size: 853
batch 379, loss: 1.3488, instance_loss: 0.4531, weighted_loss: 1.0801, label: 3, bag_size: 779
batch 399, loss: 0.8282, instance_loss: 0.4408, weighted_loss: 0.7120, label: 1, bag_size: 981
batch 419, loss: 1.2110, instance_loss: 0.4414, weighted_loss: 0.9801, label: 3, bag_size: 663
batch 439, loss: 1.0510, instance_loss: 0.5077, weighted_loss: 0.8880, label: 1, bag_size: 159
batch 459, loss: 0.7156, instance_loss: 0.4006, weighted_loss: 0.6211, label: 1, bag_size: 1273
batch 479, loss: 0.8532, instance_loss: 0.5052, weighted_loss: 0.7488, label: 0, bag_size: 231
batch 499, loss: 1.9465, instance_loss: 0.5159, weighted_loss: 1.5173, label: 2, bag_size: 1060
batch 519, loss: 0.8454, instance_loss: 0.4506, weighted_loss: 0.7270, label: 1, bag_size: 500
batch 539, loss: 1.2024, instance_loss: 0.5083, weighted_loss: 0.9942, label: 2, bag_size: 549
batch 559, loss: 0.8810, instance_loss: 0.4494, weighted_loss: 0.7515, label: 3, bag_size: 684
batch 579, loss: 1.3762, instance_loss: 0.6393, weighted_loss: 1.1551, label: 0, bag_size: 311


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.07617845117845118: correct 362/4752
Epoch: 46, train_loss: 1.0043, train_clustering_loss:  0.4624, train_error: 0.4529
class 0: acc 0.8189655172413793, correct 95/116
class 1: acc 0.5213675213675214, correct 61/117
class 2: acc 0.4, correct 52/130
class 3: acc 0.3090909090909091, correct 34/110
class 4: acc 0.6859504132231405, correct 83/121

Val Set, val_loss: 1.3214, val_error: 0.5541, auc: 0.8045
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.11148648648648649: correct 66/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4130, instance_loss: 0.4555, weighted_loss: 0.4258, label: 1, bag_size: 1091
batch 39, loss: 1.5515, instance_loss: 0.5778, weighted_loss: 1.2594, label: 2, bag_size: 582
batch 59, loss: 1.3204, instance_loss: 0.5285, weighted_loss: 1.0829, label: 3, bag_size: 393
batch 79, loss: 0.6474, instance_loss: 0.3969, weighted_loss: 0.5723, label: 4, bag_size: 854
batch 99, loss: 0.0114, instance_loss: 0.1143, weighted_loss: 0.0423, label: 0, bag_size: 425
batch 119, loss: 1.2262, instance_loss: 0.5439, weighted_loss: 1.0215, label: 2, bag_size: 837
batch 139, loss: 0.9009, instance_loss: 0.4424, weighted_loss: 0.7633, label: 2, bag_size: 616
batch 159, loss: 0.8308, instance_loss: 0.7793, weighted_loss: 0.8154, label: 3, bag_size: 31
batch 179, loss: 1.7357, instance_loss: 0.5573, weighted_loss: 1.3822, label: 2, bag_size: 498
batch 199, loss: 1.9728, instance_loss: 0.6253, weighted_loss: 1.5686, label: 2, bag_size: 629
batch 219, loss: 1.0216, instance_loss: 0.5124, weighted_loss: 0.8688, label: 4, bag_size: 1018
batch 239, loss: 0.6652, instance_loss: 0.4839, weighted_loss: 0.6108, label: 3, bag_size: 235
batch 259, loss: 1.3601, instance_loss: 0.5744, weighted_loss: 1.1244, label: 2, bag_size: 375
batch 279, loss: 0.9248, instance_loss: 0.4013, weighted_loss: 0.7678, label: 3, bag_size: 499
batch 299, loss: 0.6030, instance_loss: 0.3569, weighted_loss: 0.5292, label: 4, bag_size: 687
batch 319, loss: 2.6105, instance_loss: 0.5972, weighted_loss: 2.0065, label: 2, bag_size: 244
batch 339, loss: 2.2301, instance_loss: 0.5908, weighted_loss: 1.7383, label: 3, bag_size: 300
batch 359, loss: 1.3383, instance_loss: 0.5220, weighted_loss: 1.0934, label: 3, bag_size: 830
batch 379, loss: 0.6305, instance_loss: 0.3811, weighted_loss: 0.5557, label: 2, bag_size: 266
batch 399, loss: 0.9163, instance_loss: 0.4875, weighted_loss: 0.7877, label: 3, bag_size: 858
batch 419, loss: 0.0209, instance_loss: 0.2413, weighted_loss: 0.0870, label: 0, bag_size: 517
batch 439, loss: 1.1218, instance_loss: 0.6094, weighted_loss: 0.9681, label: 2, bag_size: 303
batch 459, loss: 0.2390, instance_loss: 0.3880, weighted_loss: 0.2837, label: 0, bag_size: 288
batch 479, loss: 0.4546, instance_loss: 0.4738, weighted_loss: 0.4604, label: 0, bag_size: 223
batch 499, loss: 0.0665, instance_loss: 0.3704, weighted_loss: 0.1577, label: 0, bag_size: 416
batch 519, loss: 0.6261, instance_loss: 0.4308, weighted_loss: 0.5675, label: 3, bag_size: 322
batch 539, loss: 0.8525, instance_loss: 0.4254, weighted_loss: 0.7244, label: 3, bag_size: 495
batch 559, loss: 0.0011, instance_loss: 0.1705, weighted_loss: 0.0519, label: 0, bag_size: 37
batch 579, loss: 1.0669, instance_loss: 0.3804, weighted_loss: 0.8610, label: 3, bag_size: 779


class 0 clustering acc 0.9951178451178451: correct 23644/23760
class 1 clustering acc 0.10795454545454546: correct 513/4752
Epoch: 47, train_loss: 0.9784, train_clustering_loss:  0.4594, train_error: 0.4310
class 0: acc 0.851063829787234, correct 120/141
class 1: acc 0.6120689655172413, correct 71/116
class 2: acc 0.26126126126126126, correct 29/111
class 3: acc 0.47580645161290325, correct 59/124
class 4: acc 0.5784313725490197, correct 59/102

Val Set, val_loss: 1.3074, val_error: 0.5270, auc: 0.8109
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3782, instance_loss: 0.4213, weighted_loss: 0.3911, label: 1, bag_size: 892
batch 39, loss: 0.7974, instance_loss: 0.3916, weighted_loss: 0.6757, label: 1, bag_size: 311
batch 59, loss: 0.0352, instance_loss: 0.2479, weighted_loss: 0.0990, label: 0, bag_size: 88
batch 79, loss: 0.7996, instance_loss: 0.4520, weighted_loss: 0.6953, label: 3, bag_size: 897
batch 99, loss: 0.6679, instance_loss: 0.3975, weighted_loss: 0.5867, label: 3, bag_size: 598
batch 119, loss: 1.2863, instance_loss: 0.5475, weighted_loss: 1.0646, label: 2, bag_size: 350
batch 139, loss: 1.0891, instance_loss: 0.5743, weighted_loss: 0.9347, label: 1, bag_size: 949
batch 159, loss: 1.5311, instance_loss: 0.5783, weighted_loss: 1.2453, label: 4, bag_size: 329
batch 179, loss: 0.7971, instance_loss: 0.5392, weighted_loss: 0.7197, label: 2, bag_size: 398
batch 199, loss: 0.0265, instance_loss: 0.1739, weighted_loss: 0.0707, label: 0, bag_size: 354
batch 219, loss: 1.4755, instance_loss: 0.5887, weighted_loss: 1.2095, label: 3, bag_size: 156
batch 239, loss: 0.5777, instance_loss: 0.4410, weighted_loss: 0.5367, label: 1, bag_size: 702
batch 259, loss: 0.0472, instance_loss: 0.2668, weighted_loss: 0.1131, label: 0, bag_size: 357
batch 279, loss: 0.7708, instance_loss: 0.4160, weighted_loss: 0.6644, label: 1, bag_size: 490
batch 299, loss: 0.8394, instance_loss: 0.5449, weighted_loss: 0.7510, label: 2, bag_size: 315
batch 319, loss: 1.6813, instance_loss: 0.4872, weighted_loss: 1.3231, label: 3, bag_size: 996
batch 339, loss: 0.9967, instance_loss: 0.4684, weighted_loss: 0.8382, label: 0, bag_size: 269
batch 359, loss: 2.3525, instance_loss: 0.5815, weighted_loss: 1.8212, label: 3, bag_size: 533
batch 379, loss: 0.0910, instance_loss: 0.2628, weighted_loss: 0.1425, label: 0, bag_size: 79
batch 399, loss: 0.1106, instance_loss: 0.3401, weighted_loss: 0.1794, label: 0, bag_size: 282
batch 419, loss: 2.2044, instance_loss: 0.7460, weighted_loss: 1.7669, label: 2, bag_size: 645
batch 439, loss: 0.5233, instance_loss: 0.4450, weighted_loss: 0.4998, label: 4, bag_size: 744
batch 459, loss: 0.0338, instance_loss: 0.1908, weighted_loss: 0.0809, label: 0, bag_size: 453
batch 479, loss: 1.1845, instance_loss: 0.4909, weighted_loss: 0.9764, label: 1, bag_size: 1082
batch 499, loss: 0.3517, instance_loss: 0.3908, weighted_loss: 0.3634, label: 0, bag_size: 615
batch 519, loss: 0.0104, instance_loss: 0.2848, weighted_loss: 0.0927, label: 0, bag_size: 74
batch 539, loss: 1.4661, instance_loss: 0.6140, weighted_loss: 1.2105, label: 2, bag_size: 799
batch 559, loss: 0.0276, instance_loss: 0.2698, weighted_loss: 0.1002, label: 0, bag_size: 79
batch 579, loss: 0.1748, instance_loss: 0.4111, weighted_loss: 0.2456, label: 2, bag_size: 684


class 0 clustering acc 0.9954545454545455: correct 23652/23760
class 1 clustering acc 0.09048821548821549: correct 430/4752
Epoch: 48, train_loss: 1.0538, train_clustering_loss:  0.4716, train_error: 0.4444
class 0: acc 0.8028169014084507, correct 114/142
class 1: acc 0.6293103448275862, correct 73/116
class 2: acc 0.28695652173913044, correct 33/115
class 3: acc 0.48695652173913045, correct 56/115
class 4: acc 0.5094339622641509, correct 54/106

Val Set, val_loss: 1.2784, val_error: 0.4730, auc: 0.8080
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1673, instance_loss: 0.5206, weighted_loss: 0.9733, label: 1, bag_size: 855
batch 39, loss: 1.7408, instance_loss: 0.5642, weighted_loss: 1.3878, label: 1, bag_size: 141
batch 59, loss: 0.7063, instance_loss: 0.4297, weighted_loss: 0.6233, label: 2, bag_size: 350
batch 79, loss: 0.7149, instance_loss: 0.4067, weighted_loss: 0.6224, label: 2, bag_size: 617
batch 99, loss: 0.3609, instance_loss: 0.3980, weighted_loss: 0.3720, label: 4, bag_size: 520
batch 119, loss: 1.8451, instance_loss: 0.5764, weighted_loss: 1.4645, label: 4, bag_size: 407
batch 139, loss: 1.0607, instance_loss: 0.4772, weighted_loss: 0.8856, label: 1, bag_size: 398
batch 159, loss: 3.4047, instance_loss: 0.6691, weighted_loss: 2.5840, label: 1, bag_size: 184
batch 179, loss: 0.0139, instance_loss: 0.2334, weighted_loss: 0.0798, label: 0, bag_size: 37
batch 199, loss: 0.5797, instance_loss: 0.3885, weighted_loss: 0.5223, label: 1, bag_size: 766
batch 219, loss: 0.7034, instance_loss: 0.4953, weighted_loss: 0.6410, label: 2, bag_size: 702
batch 239, loss: 2.0205, instance_loss: 0.5403, weighted_loss: 1.5765, label: 3, bag_size: 523
batch 259, loss: 0.0004, instance_loss: 0.1595, weighted_loss: 0.0481, label: 0, bag_size: 51
batch 279, loss: 0.0096, instance_loss: 0.1996, weighted_loss: 0.0666, label: 0, bag_size: 350
batch 299, loss: 0.1080, instance_loss: 0.3440, weighted_loss: 0.1788, label: 0, bag_size: 397
batch 319, loss: 0.7497, instance_loss: 0.4166, weighted_loss: 0.6497, label: 3, bag_size: 443
batch 339, loss: 0.5762, instance_loss: 0.4705, weighted_loss: 0.5445, label: 1, bag_size: 461
batch 359, loss: 0.2742, instance_loss: 0.5169, weighted_loss: 0.3470, label: 4, bag_size: 260
batch 379, loss: 0.7406, instance_loss: 0.3977, weighted_loss: 0.6377, label: 1, bag_size: 177
batch 399, loss: 0.4099, instance_loss: 0.4456, weighted_loss: 0.4206, label: 4, bag_size: 450
batch 419, loss: 0.4663, instance_loss: 0.3645, weighted_loss: 0.4358, label: 1, bag_size: 271
batch 439, loss: 0.0069, instance_loss: 0.1496, weighted_loss: 0.0497, label: 0, bag_size: 306
batch 459, loss: 0.1260, instance_loss: 0.3926, weighted_loss: 0.2060, label: 0, bag_size: 573
batch 479, loss: 0.6979, instance_loss: 0.4267, weighted_loss: 0.6165, label: 4, bag_size: 218
batch 499, loss: 0.4323, instance_loss: 0.4610, weighted_loss: 0.4409, label: 4, bag_size: 895
batch 519, loss: 1.2025, instance_loss: 0.4735, weighted_loss: 0.9838, label: 4, bag_size: 176
batch 539, loss: 0.5727, instance_loss: 0.4946, weighted_loss: 0.5493, label: 1, bag_size: 141
batch 559, loss: 0.9744, instance_loss: 0.3884, weighted_loss: 0.7986, label: 0, bag_size: 613
batch 579, loss: 0.5719, instance_loss: 0.3864, weighted_loss: 0.5162, label: 3, bag_size: 1076


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.08712121212121213: correct 414/4752
Epoch: 49, train_loss: 0.9717, train_clustering_loss:  0.4640, train_error: 0.4209
class 0: acc 0.8099173553719008, correct 98/121
class 1: acc 0.6511627906976745, correct 84/129
class 2: acc 0.2982456140350877, correct 34/114
class 3: acc 0.5785123966942148, correct 70/121
class 4: acc 0.5321100917431193, correct 58/109

Val Set, val_loss: 1.2877, val_error: 0.5135, auc: 0.8103
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3908, instance_loss: 0.4482, weighted_loss: 1.1080, label: 2, bag_size: 244
batch 39, loss: 1.3759, instance_loss: 0.4609, weighted_loss: 1.1014, label: 3, bag_size: 608
batch 59, loss: 0.3504, instance_loss: 0.5498, weighted_loss: 0.4102, label: 3, bag_size: 674
batch 79, loss: 1.2856, instance_loss: 0.4786, weighted_loss: 1.0435, label: 4, bag_size: 333
batch 99, loss: 0.1005, instance_loss: 0.4814, weighted_loss: 0.2148, label: 0, bag_size: 224
batch 119, loss: 1.6997, instance_loss: 0.6413, weighted_loss: 1.3822, label: 2, bag_size: 549
batch 139, loss: 1.2686, instance_loss: 0.5815, weighted_loss: 1.0624, label: 4, bag_size: 395
batch 159, loss: 0.9853, instance_loss: 0.4553, weighted_loss: 0.8263, label: 4, bag_size: 333
batch 179, loss: 0.8012, instance_loss: 0.5337, weighted_loss: 0.7209, label: 1, bag_size: 311
batch 199, loss: 1.3665, instance_loss: 0.4707, weighted_loss: 1.0977, label: 2, bag_size: 953
batch 219, loss: 1.1731, instance_loss: 0.5875, weighted_loss: 0.9974, label: 1, bag_size: 113
batch 239, loss: 1.9314, instance_loss: 0.7063, weighted_loss: 1.5639, label: 3, bag_size: 1186
batch 259, loss: 0.5793, instance_loss: 0.4030, weighted_loss: 0.5264, label: 2, bag_size: 886
batch 279, loss: 0.9855, instance_loss: 0.4690, weighted_loss: 0.8305, label: 3, bag_size: 1284
batch 299, loss: 1.8046, instance_loss: 0.5371, weighted_loss: 1.4243, label: 3, bag_size: 492
batch 319, loss: 1.4923, instance_loss: 0.4828, weighted_loss: 1.1894, label: 2, bag_size: 1016
batch 339, loss: 0.3948, instance_loss: 0.3585, weighted_loss: 0.3840, label: 4, bag_size: 231
batch 359, loss: 0.1909, instance_loss: 0.4590, weighted_loss: 0.2713, label: 0, bag_size: 33
batch 379, loss: 1.9554, instance_loss: 0.5419, weighted_loss: 1.5313, label: 1, bag_size: 742
batch 399, loss: 2.0274, instance_loss: 0.5402, weighted_loss: 1.5812, label: 2, bag_size: 909
batch 419, loss: 1.4597, instance_loss: 0.4936, weighted_loss: 1.1698, label: 3, bag_size: 856
batch 439, loss: 0.1918, instance_loss: 0.4057, weighted_loss: 0.2560, label: 4, bag_size: 160
batch 459, loss: 0.0828, instance_loss: 0.2753, weighted_loss: 0.1406, label: 0, bag_size: 74
batch 479, loss: 1.1980, instance_loss: 0.5303, weighted_loss: 0.9977, label: 2, bag_size: 522
batch 499, loss: 0.6228, instance_loss: 0.4303, weighted_loss: 0.5650, label: 4, bag_size: 944
batch 519, loss: 1.6296, instance_loss: 0.5776, weighted_loss: 1.3140, label: 2, bag_size: 489
batch 539, loss: 0.7469, instance_loss: 0.5445, weighted_loss: 0.6862, label: 3, bag_size: 1358
batch 559, loss: 3.3813, instance_loss: 0.7734, weighted_loss: 2.5989, label: 4, bag_size: 1113
batch 579, loss: 0.5040, instance_loss: 0.4787, weighted_loss: 0.4964, label: 4, bag_size: 652


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.07091750841750842: correct 337/4752
Epoch: 50, train_loss: 0.9755, train_clustering_loss:  0.4662, train_error: 0.4394
class 0: acc 0.7777777777777778, correct 98/126
class 1: acc 0.5892857142857143, correct 66/112
class 2: acc 0.392, correct 49/125
class 3: acc 0.4732142857142857, correct 53/112
class 4: acc 0.5630252100840336, correct 67/119

Val Set, val_loss: 1.2820, val_error: 0.5270, auc: 0.8099
class 0 clustering acc 0.9902027027027027: correct 2931/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0134, instance_loss: 0.2831, weighted_loss: 0.0943, label: 0, bag_size: 88
batch 39, loss: 0.0009, instance_loss: 0.1187, weighted_loss: 0.0363, label: 0, bag_size: 533
batch 59, loss: 0.0038, instance_loss: 0.1842, weighted_loss: 0.0579, label: 0, bag_size: 527
batch 79, loss: 0.3314, instance_loss: 0.5842, weighted_loss: 0.4073, label: 3, bag_size: 98
batch 99, loss: 0.0028, instance_loss: 0.2870, weighted_loss: 0.0881, label: 0, bag_size: 370
batch 119, loss: 0.2577, instance_loss: 0.3686, weighted_loss: 0.2910, label: 3, bag_size: 476
batch 139, loss: 0.2155, instance_loss: 0.5870, weighted_loss: 0.3269, label: 3, bag_size: 98
batch 159, loss: 0.6498, instance_loss: 0.5236, weighted_loss: 0.6120, label: 4, bag_size: 1018
batch 179, loss: 0.0024, instance_loss: 0.1394, weighted_loss: 0.0435, label: 0, bag_size: 69
batch 199, loss: 1.1090, instance_loss: 0.5122, weighted_loss: 0.9300, label: 3, bag_size: 739
batch 219, loss: 0.0016, instance_loss: 0.1427, weighted_loss: 0.0439, label: 0, bag_size: 354
batch 239, loss: 0.4067, instance_loss: 0.4220, weighted_loss: 0.4113, label: 4, bag_size: 520
batch 259, loss: 0.2803, instance_loss: 0.6205, weighted_loss: 0.3823, label: 4, bag_size: 769
batch 279, loss: 0.9096, instance_loss: 0.4359, weighted_loss: 0.7675, label: 3, bag_size: 192
batch 299, loss: 0.2631, instance_loss: 0.3404, weighted_loss: 0.2863, label: 4, bag_size: 948
batch 319, loss: 2.8827, instance_loss: 0.5583, weighted_loss: 2.1854, label: 4, bag_size: 1064
batch 339, loss: 1.3697, instance_loss: 0.4849, weighted_loss: 1.1043, label: 3, bag_size: 166
batch 359, loss: 1.2191, instance_loss: 0.5035, weighted_loss: 1.0044, label: 2, bag_size: 498
batch 379, loss: 2.2377, instance_loss: 0.6146, weighted_loss: 1.7507, label: 2, bag_size: 1308
batch 399, loss: 0.5919, instance_loss: 0.4046, weighted_loss: 0.5357, label: 1, bag_size: 460
batch 419, loss: 1.1813, instance_loss: 0.5502, weighted_loss: 0.9919, label: 0, bag_size: 141
batch 439, loss: 1.5025, instance_loss: 0.7103, weighted_loss: 1.2649, label: 1, bag_size: 106
batch 459, loss: 0.6318, instance_loss: 0.3998, weighted_loss: 0.5622, label: 2, bag_size: 886
batch 479, loss: 0.7666, instance_loss: 0.5094, weighted_loss: 0.6894, label: 4, bag_size: 886
batch 499, loss: 1.0268, instance_loss: 0.5245, weighted_loss: 0.8761, label: 4, bag_size: 689
batch 519, loss: 1.0292, instance_loss: 0.4579, weighted_loss: 0.8578, label: 4, bag_size: 868
batch 539, loss: 1.5925, instance_loss: 0.4999, weighted_loss: 1.2647, label: 3, bag_size: 598
batch 559, loss: 0.2370, instance_loss: 0.3803, weighted_loss: 0.2800, label: 0, bag_size: 269
batch 579, loss: 0.0213, instance_loss: 0.2980, weighted_loss: 0.1043, label: 0, bag_size: 74


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.0683922558922559: correct 325/4752
Epoch: 51, train_loss: 1.0018, train_clustering_loss:  0.4715, train_error: 0.4327
class 0: acc 0.7884615384615384, correct 82/104
class 1: acc 0.5964912280701754, correct 68/114
class 2: acc 0.32456140350877194, correct 37/114
class 3: acc 0.5263157894736842, correct 70/133
class 4: acc 0.6201550387596899, correct 80/129

Val Set, val_loss: 1.4075, val_error: 0.5676, auc: 0.8142
class 0 clustering acc 0.9898648648648649: correct 2930/2960
class 1 clustering acc 0.09628378378378379: correct 57/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9320, instance_loss: 0.5179, weighted_loss: 0.8077, label: 2, bag_size: 708
batch 39, loss: 0.9385, instance_loss: 0.5011, weighted_loss: 0.8073, label: 3, bag_size: 453
batch 59, loss: 1.3727, instance_loss: 0.5084, weighted_loss: 1.1134, label: 3, bag_size: 166
batch 79, loss: 2.3610, instance_loss: 0.4995, weighted_loss: 1.8026, label: 4, bag_size: 270
batch 99, loss: 0.0704, instance_loss: 0.3860, weighted_loss: 0.1651, label: 1, bag_size: 544
batch 119, loss: 0.2750, instance_loss: 0.3965, weighted_loss: 0.3114, label: 1, bag_size: 886
batch 139, loss: 1.4216, instance_loss: 0.5684, weighted_loss: 1.1657, label: 1, bag_size: 381
batch 159, loss: 1.3314, instance_loss: 0.4825, weighted_loss: 1.0767, label: 2, bag_size: 421
batch 179, loss: 2.0327, instance_loss: 0.5471, weighted_loss: 1.5870, label: 3, bag_size: 638
batch 199, loss: 0.5890, instance_loss: 0.5011, weighted_loss: 0.5627, label: 1, bag_size: 1104
batch 219, loss: 0.7485, instance_loss: 0.4349, weighted_loss: 0.6545, label: 2, bag_size: 779
batch 239, loss: 1.0305, instance_loss: 0.4734, weighted_loss: 0.8634, label: 1, bag_size: 389
batch 259, loss: 3.4351, instance_loss: 0.7632, weighted_loss: 2.6336, label: 1, bag_size: 875
batch 279, loss: 0.0987, instance_loss: 0.3257, weighted_loss: 0.1668, label: 2, bag_size: 864
batch 299, loss: 1.4475, instance_loss: 0.4589, weighted_loss: 1.1509, label: 3, bag_size: 453
batch 319, loss: 0.0060, instance_loss: 0.2033, weighted_loss: 0.0652, label: 0, bag_size: 69
batch 339, loss: 1.6698, instance_loss: 0.5849, weighted_loss: 1.3444, label: 2, bag_size: 371
batch 359, loss: 0.9906, instance_loss: 0.4999, weighted_loss: 0.8434, label: 3, bag_size: 476
batch 379, loss: 1.3076, instance_loss: 0.5122, weighted_loss: 1.0690, label: 1, bag_size: 355
batch 399, loss: 0.9231, instance_loss: 0.4703, weighted_loss: 0.7873, label: 3, bag_size: 1232
batch 419, loss: 0.9028, instance_loss: 0.4413, weighted_loss: 0.7644, label: 0, bag_size: 214
batch 439, loss: 1.6486, instance_loss: 0.4857, weighted_loss: 1.2998, label: 4, bag_size: 1077
batch 459, loss: 1.2060, instance_loss: 0.4886, weighted_loss: 0.9908, label: 1, bag_size: 141
batch 479, loss: 1.6073, instance_loss: 0.6267, weighted_loss: 1.3131, label: 2, bag_size: 286
batch 499, loss: 0.0506, instance_loss: 0.2848, weighted_loss: 0.1209, label: 0, bag_size: 98
batch 519, loss: 3.0689, instance_loss: 0.7295, weighted_loss: 2.3671, label: 0, bag_size: 492
batch 539, loss: 0.8030, instance_loss: 0.4252, weighted_loss: 0.6897, label: 3, bag_size: 457
batch 559, loss: 1.3688, instance_loss: 0.4498, weighted_loss: 1.0931, label: 4, bag_size: 263
batch 579, loss: 0.4679, instance_loss: 0.4131, weighted_loss: 0.4515, label: 3, bag_size: 737


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.06018518518518518: correct 286/4752
Epoch: 52, train_loss: 1.0418, train_clustering_loss:  0.4732, train_error: 0.4596
class 0: acc 0.7254901960784313, correct 74/102
class 1: acc 0.3942307692307692, correct 41/104
class 2: acc 0.4413793103448276, correct 64/145
class 3: acc 0.5409836065573771, correct 66/122
class 4: acc 0.628099173553719, correct 76/121

Val Set, val_loss: 1.4330, val_error: 0.4865, auc: 0.8064
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.7083, instance_loss: 0.5785, weighted_loss: 1.3694, label: 0, bag_size: 367
batch 39, loss: 0.8504, instance_loss: 0.3857, weighted_loss: 0.7110, label: 3, bag_size: 499
batch 59, loss: 0.9279, instance_loss: 0.5525, weighted_loss: 0.8152, label: 0, bag_size: 269
batch 79, loss: 0.6752, instance_loss: 0.3905, weighted_loss: 0.5898, label: 1, bag_size: 908
batch 99, loss: 2.1857, instance_loss: 0.6244, weighted_loss: 1.7173, label: 2, bag_size: 288
batch 119, loss: 2.5851, instance_loss: 0.6633, weighted_loss: 2.0086, label: 3, bag_size: 1078
batch 139, loss: 0.8511, instance_loss: 0.5408, weighted_loss: 0.7580, label: 2, bag_size: 1013
batch 159, loss: 2.7362, instance_loss: 0.6851, weighted_loss: 2.1209, label: 3, bag_size: 781
batch 179, loss: 0.3100, instance_loss: 0.3632, weighted_loss: 0.3260, label: 4, bag_size: 394
batch 199, loss: 1.3067, instance_loss: 0.5319, weighted_loss: 1.0742, label: 2, bag_size: 597
batch 219, loss: 0.7485, instance_loss: 0.4510, weighted_loss: 0.6593, label: 1, bag_size: 1104
batch 239, loss: 1.2436, instance_loss: 0.6678, weighted_loss: 1.0709, label: 2, bag_size: 339
batch 259, loss: 0.8669, instance_loss: 0.5100, weighted_loss: 0.7599, label: 1, bag_size: 490
batch 279, loss: 0.8465, instance_loss: 0.4020, weighted_loss: 0.7132, label: 2, bag_size: 697
batch 299, loss: 1.3897, instance_loss: 0.5757, weighted_loss: 1.1455, label: 2, bag_size: 1060
batch 319, loss: 0.2380, instance_loss: 0.3857, weighted_loss: 0.2823, label: 2, bag_size: 684
batch 339, loss: 0.0764, instance_loss: 0.6178, weighted_loss: 0.2388, label: 1, bag_size: 522
batch 359, loss: 1.1699, instance_loss: 0.4593, weighted_loss: 0.9567, label: 3, bag_size: 781
batch 379, loss: 0.6516, instance_loss: 0.5963, weighted_loss: 0.6350, label: 2, bag_size: 567
batch 399, loss: 0.0558, instance_loss: 0.3223, weighted_loss: 0.1357, label: 0, bag_size: 188
batch 419, loss: 1.7614, instance_loss: 0.5647, weighted_loss: 1.4024, label: 4, bag_size: 685
batch 439, loss: 0.9026, instance_loss: 0.5078, weighted_loss: 0.7842, label: 1, bag_size: 658
batch 459, loss: 0.8212, instance_loss: 0.4534, weighted_loss: 0.7108, label: 1, bag_size: 389
batch 479, loss: 1.4985, instance_loss: 0.5276, weighted_loss: 1.2072, label: 0, bag_size: 169
batch 499, loss: 0.7044, instance_loss: 0.4601, weighted_loss: 0.6311, label: 3, bag_size: 476
batch 519, loss: 0.6822, instance_loss: 0.4980, weighted_loss: 0.6270, label: 1, bag_size: 1273
batch 539, loss: 1.1213, instance_loss: 0.4989, weighted_loss: 0.9345, label: 3, bag_size: 97
batch 559, loss: 0.0904, instance_loss: 0.2837, weighted_loss: 0.1484, label: 0, bag_size: 258
batch 579, loss: 2.6229, instance_loss: 0.6439, weighted_loss: 2.0292, label: 2, bag_size: 185


class 0 clustering acc 0.9952441077441078: correct 23647/23760
class 1 clustering acc 0.07680976430976431: correct 365/4752
Epoch: 53, train_loss: 1.0483, train_clustering_loss:  0.4753, train_error: 0.4764
class 0: acc 0.7723577235772358, correct 95/123
class 1: acc 0.5950413223140496, correct 72/121
class 2: acc 0.30701754385964913, correct 35/114
class 3: acc 0.38392857142857145, correct 43/112
class 4: acc 0.532258064516129, correct 66/124

Val Set, val_loss: 1.2246, val_error: 0.4324, auc: 0.8182
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2035, instance_loss: 0.3637, weighted_loss: 0.2515, label: 0, bag_size: 49
batch 39, loss: 0.7369, instance_loss: 0.5779, weighted_loss: 0.6892, label: 3, bag_size: 674
batch 59, loss: 0.3432, instance_loss: 0.3282, weighted_loss: 0.3387, label: 0, bag_size: 74
batch 79, loss: 0.5932, instance_loss: 0.3741, weighted_loss: 0.5275, label: 4, bag_size: 293
batch 99, loss: 0.7350, instance_loss: 0.4288, weighted_loss: 0.6431, label: 1, bag_size: 500
batch 119, loss: 0.4702, instance_loss: 0.4690, weighted_loss: 0.4698, label: 4, bag_size: 685
batch 139, loss: 0.9155, instance_loss: 0.4599, weighted_loss: 0.7788, label: 3, bag_size: 608
batch 159, loss: 0.7458, instance_loss: 0.4455, weighted_loss: 0.6557, label: 4, bag_size: 727
batch 179, loss: 0.0103, instance_loss: 0.2541, weighted_loss: 0.0835, label: 0, bag_size: 188
batch 199, loss: 0.0362, instance_loss: 0.3037, weighted_loss: 0.1164, label: 0, bag_size: 97
batch 219, loss: 1.9734, instance_loss: 0.7014, weighted_loss: 1.5918, label: 2, bag_size: 860
batch 239, loss: 0.4396, instance_loss: 0.3365, weighted_loss: 0.4086, label: 4, bag_size: 986
batch 259, loss: 0.9324, instance_loss: 0.4718, weighted_loss: 0.7942, label: 2, bag_size: 375
batch 279, loss: 1.7124, instance_loss: 0.5662, weighted_loss: 1.3685, label: 2, bag_size: 713
batch 299, loss: 0.5286, instance_loss: 0.4424, weighted_loss: 0.5027, label: 3, bag_size: 476
batch 319, loss: 0.0005, instance_loss: 0.2115, weighted_loss: 0.0638, label: 0, bag_size: 533
batch 339, loss: 1.0734, instance_loss: 0.4062, weighted_loss: 0.8733, label: 1, bag_size: 177
batch 359, loss: 2.3343, instance_loss: 0.5458, weighted_loss: 1.7977, label: 1, bag_size: 397
batch 379, loss: 0.6043, instance_loss: 0.4545, weighted_loss: 0.5593, label: 3, bag_size: 495
batch 399, loss: 0.4391, instance_loss: 0.3492, weighted_loss: 0.4121, label: 4, bag_size: 960
batch 419, loss: 0.7940, instance_loss: 0.4596, weighted_loss: 0.6937, label: 4, bag_size: 970
batch 439, loss: 1.0084, instance_loss: 0.4769, weighted_loss: 0.8490, label: 1, bag_size: 1121
batch 459, loss: 0.6986, instance_loss: 0.4579, weighted_loss: 0.6264, label: 2, bag_size: 851
batch 479, loss: 0.9614, instance_loss: 0.4612, weighted_loss: 0.8113, label: 0, bag_size: 214
batch 499, loss: 1.0337, instance_loss: 0.4618, weighted_loss: 0.8621, label: 2, bag_size: 853
batch 519, loss: 1.8505, instance_loss: 0.7155, weighted_loss: 1.5100, label: 4, bag_size: 399
batch 539, loss: 0.1836, instance_loss: 0.3296, weighted_loss: 0.2274, label: 4, bag_size: 730
batch 559, loss: 0.7279, instance_loss: 0.6391, weighted_loss: 0.7012, label: 0, bag_size: 613
batch 579, loss: 0.7444, instance_loss: 0.4473, weighted_loss: 0.6553, label: 2, bag_size: 799


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.059343434343434344: correct 282/4752
Epoch: 54, train_loss: 1.0296, train_clustering_loss:  0.4740, train_error: 0.4680
class 0: acc 0.717741935483871, correct 89/124
class 1: acc 0.42105263157894735, correct 48/114
class 2: acc 0.47586206896551725, correct 69/145
class 3: acc 0.4148936170212766, correct 39/94
class 4: acc 0.6068376068376068, correct 71/117

Val Set, val_loss: 1.3784, val_error: 0.4595, auc: 0.7973
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.2736, instance_loss: 0.6033, weighted_loss: 1.0725, label: 0, bag_size: 277
batch 39, loss: 1.6515, instance_loss: 0.5292, weighted_loss: 1.3148, label: 3, bag_size: 282
batch 59, loss: 1.2825, instance_loss: 0.6581, weighted_loss: 1.0952, label: 2, bag_size: 315
batch 79, loss: 1.3511, instance_loss: 0.5529, weighted_loss: 1.1117, label: 3, bag_size: 1022
batch 99, loss: 1.8127, instance_loss: 0.4935, weighted_loss: 1.4169, label: 4, bag_size: 250
batch 119, loss: 1.4862, instance_loss: 0.4401, weighted_loss: 1.1723, label: 4, bag_size: 53
batch 139, loss: 0.2225, instance_loss: 0.4186, weighted_loss: 0.2813, label: 4, bag_size: 1158
batch 159, loss: 0.8802, instance_loss: 0.4753, weighted_loss: 0.7587, label: 2, bag_size: 315
batch 179, loss: 1.7316, instance_loss: 0.5609, weighted_loss: 1.3804, label: 3, bag_size: 457
batch 199, loss: 1.3017, instance_loss: 0.3616, weighted_loss: 1.0197, label: 1, bag_size: 617
batch 219, loss: 0.5174, instance_loss: 0.3942, weighted_loss: 0.4804, label: 1, bag_size: 814
batch 239, loss: 1.0503, instance_loss: 0.4160, weighted_loss: 0.8600, label: 1, bag_size: 928
batch 259, loss: 3.1190, instance_loss: 0.6373, weighted_loss: 2.3745, label: 0, bag_size: 608
batch 279, loss: 1.5917, instance_loss: 0.5845, weighted_loss: 1.2895, label: 2, bag_size: 1079
batch 299, loss: 0.2005, instance_loss: 0.3536, weighted_loss: 0.2464, label: 0, bag_size: 57
batch 319, loss: 1.0829, instance_loss: 0.4329, weighted_loss: 0.8879, label: 3, bag_size: 364
batch 339, loss: 0.0258, instance_loss: 0.2490, weighted_loss: 0.0928, label: 0, bag_size: 69
batch 359, loss: 0.9657, instance_loss: 0.4381, weighted_loss: 0.8074, label: 4, bag_size: 198
batch 379, loss: 2.1972, instance_loss: 0.6020, weighted_loss: 1.7187, label: 2, bag_size: 411
batch 399, loss: 0.6376, instance_loss: 0.4865, weighted_loss: 0.5922, label: 3, bag_size: 495
batch 419, loss: 0.0000, instance_loss: 0.5744, weighted_loss: 0.1723, label: 2, bag_size: 936
batch 439, loss: 1.6965, instance_loss: 0.5545, weighted_loss: 1.3539, label: 1, bag_size: 272
batch 459, loss: 1.5913, instance_loss: 0.5759, weighted_loss: 1.2866, label: 3, bag_size: 282
batch 479, loss: 0.6002, instance_loss: 0.4217, weighted_loss: 0.5467, label: 1, bag_size: 823
batch 499, loss: 1.3391, instance_loss: 0.4973, weighted_loss: 1.0866, label: 1, bag_size: 381
batch 519, loss: 0.8472, instance_loss: 0.4542, weighted_loss: 0.7293, label: 1, bag_size: 928
batch 539, loss: 0.8494, instance_loss: 0.4975, weighted_loss: 0.7438, label: 0, bag_size: 400
batch 559, loss: 0.6600, instance_loss: 0.4009, weighted_loss: 0.5823, label: 1, bag_size: 500
batch 579, loss: 0.3230, instance_loss: 0.4678, weighted_loss: 0.3664, label: 4, bag_size: 503


class 0 clustering acc 0.9959595959595959: correct 23664/23760
class 1 clustering acc 0.07575757575757576: correct 360/4752
Epoch: 55, train_loss: 1.0094, train_clustering_loss:  0.4693, train_error: 0.4428
class 0: acc 0.7886178861788617, correct 97/123
class 1: acc 0.6511627906976745, correct 84/129
class 2: acc 0.3253968253968254, correct 41/126
class 3: acc 0.34951456310679613, correct 36/103
class 4: acc 0.6460176991150443, correct 73/113

Val Set, val_loss: 1.3156, val_error: 0.4595, auc: 0.8178
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.0777027027027027: correct 46/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8452, instance_loss: 0.4094, weighted_loss: 0.7144, label: 2, bag_size: 592
batch 39, loss: 0.8577, instance_loss: 0.4924, weighted_loss: 0.7481, label: 3, bag_size: 872
batch 59, loss: 1.8644, instance_loss: 0.7020, weighted_loss: 1.5157, label: 3, bag_size: 897
batch 79, loss: 0.9725, instance_loss: 0.4434, weighted_loss: 0.8138, label: 1, bag_size: 381
batch 99, loss: 0.6068, instance_loss: 0.4976, weighted_loss: 0.5741, label: 2, bag_size: 851
batch 119, loss: 0.8572, instance_loss: 0.5212, weighted_loss: 0.7564, label: 2, bag_size: 427
batch 139, loss: 0.6826, instance_loss: 0.4765, weighted_loss: 0.6208, label: 2, bag_size: 779
batch 159, loss: 1.5026, instance_loss: 0.3557, weighted_loss: 1.1585, label: 1, bag_size: 1091
batch 179, loss: 0.9158, instance_loss: 0.5114, weighted_loss: 0.7945, label: 2, bag_size: 530
batch 199, loss: 1.6937, instance_loss: 0.5194, weighted_loss: 1.3414, label: 3, bag_size: 856
batch 219, loss: 0.3399, instance_loss: 0.3380, weighted_loss: 0.3393, label: 4, bag_size: 520
batch 239, loss: 0.0030, instance_loss: 0.3565, weighted_loss: 0.1091, label: 0, bag_size: 523
batch 259, loss: 2.7080, instance_loss: 0.7539, weighted_loss: 2.1218, label: 0, bag_size: 492
batch 279, loss: 1.0989, instance_loss: 0.5591, weighted_loss: 0.9370, label: 0, bag_size: 367
batch 299, loss: 0.7007, instance_loss: 0.5529, weighted_loss: 0.6563, label: 1, bag_size: 106
batch 319, loss: 1.5239, instance_loss: 0.4587, weighted_loss: 1.2044, label: 3, bag_size: 779
batch 339, loss: 0.6035, instance_loss: 0.4064, weighted_loss: 0.5443, label: 4, bag_size: 409
batch 359, loss: 1.0392, instance_loss: 0.4916, weighted_loss: 0.8749, label: 4, bag_size: 712
batch 379, loss: 2.9187, instance_loss: 0.6068, weighted_loss: 2.2251, label: 4, bag_size: 618
batch 399, loss: 0.7143, instance_loss: 0.4827, weighted_loss: 0.6448, label: 4, bag_size: 744
batch 419, loss: 1.4847, instance_loss: 0.5060, weighted_loss: 1.1911, label: 2, bag_size: 941
batch 439, loss: 0.9205, instance_loss: 0.5223, weighted_loss: 0.8010, label: 2, bag_size: 861
batch 459, loss: 0.3526, instance_loss: 0.4867, weighted_loss: 0.3929, label: 1, bag_size: 906
batch 479, loss: 0.3579, instance_loss: 0.3607, weighted_loss: 0.3587, label: 4, bag_size: 329
batch 499, loss: 0.4725, instance_loss: 0.4146, weighted_loss: 0.4551, label: 4, bag_size: 1077
batch 519, loss: 1.8301, instance_loss: 0.5359, weighted_loss: 1.4419, label: 3, bag_size: 451
batch 539, loss: 0.1541, instance_loss: 0.4805, weighted_loss: 0.2520, label: 0, bag_size: 517
batch 559, loss: 0.5375, instance_loss: 0.5939, weighted_loss: 0.5544, label: 3, bag_size: 1365
batch 579, loss: 2.7827, instance_loss: 0.6344, weighted_loss: 2.1382, label: 2, bag_size: 1122


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.08417508417508418: correct 400/4752
Epoch: 56, train_loss: 0.8963, train_clustering_loss:  0.4597, train_error: 0.3906
class 0: acc 0.8157894736842105, correct 93/114
class 1: acc 0.6386554621848739, correct 76/119
class 2: acc 0.45901639344262296, correct 56/122
class 3: acc 0.48760330578512395, correct 59/121
class 4: acc 0.6610169491525424, correct 78/118

Val Set, val_loss: 1.4427, val_error: 0.4324, auc: 0.8031
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0268, instance_loss: 0.2826, weighted_loss: 0.1035, label: 0, bag_size: 49
batch 39, loss: 0.8487, instance_loss: 0.4058, weighted_loss: 0.7158, label: 1, bag_size: 381
batch 59, loss: 1.9149, instance_loss: 0.6239, weighted_loss: 1.5276, label: 0, bag_size: 1085
batch 79, loss: 0.0348, instance_loss: 0.3808, weighted_loss: 0.1386, label: 0, bag_size: 103
batch 99, loss: 0.0121, instance_loss: 0.2225, weighted_loss: 0.0752, label: 0, bag_size: 188
batch 119, loss: 3.2905, instance_loss: 0.6540, weighted_loss: 2.4996, label: 1, bag_size: 875
batch 139, loss: 0.9398, instance_loss: 0.4633, weighted_loss: 0.7968, label: 3, bag_size: 97
batch 159, loss: 0.0168, instance_loss: 0.2972, weighted_loss: 0.1009, label: 0, bag_size: 73
batch 179, loss: 2.0264, instance_loss: 0.5556, weighted_loss: 1.5851, label: 4, bag_size: 333
batch 199, loss: 2.3485, instance_loss: 0.7100, weighted_loss: 1.8570, label: 3, bag_size: 1358
batch 219, loss: 0.8763, instance_loss: 0.4213, weighted_loss: 0.7398, label: 2, bag_size: 781
batch 239, loss: 0.3206, instance_loss: 0.3593, weighted_loss: 0.3322, label: 4, bag_size: 744
batch 259, loss: 0.7044, instance_loss: 0.4325, weighted_loss: 0.6228, label: 2, bag_size: 645
batch 279, loss: 1.1651, instance_loss: 0.5754, weighted_loss: 0.9882, label: 0, bag_size: 269
batch 299, loss: 0.4599, instance_loss: 0.4805, weighted_loss: 0.4661, label: 0, bag_size: 258
batch 319, loss: 0.2274, instance_loss: 0.3027, weighted_loss: 0.2500, label: 1, bag_size: 1091
batch 339, loss: 0.6709, instance_loss: 0.5044, weighted_loss: 0.6210, label: 2, bag_size: 348
batch 359, loss: 1.1322, instance_loss: 0.4861, weighted_loss: 0.9384, label: 3, bag_size: 520
batch 379, loss: 0.7889, instance_loss: 0.4779, weighted_loss: 0.6956, label: 2, bag_size: 392
batch 399, loss: 0.7088, instance_loss: 0.4690, weighted_loss: 0.6368, label: 1, bag_size: 490
batch 419, loss: 0.7520, instance_loss: 0.3395, weighted_loss: 0.6283, label: 4, bag_size: 1077
batch 439, loss: 1.2293, instance_loss: 0.4909, weighted_loss: 1.0078, label: 3, bag_size: 451
batch 459, loss: 1.8314, instance_loss: 0.6321, weighted_loss: 1.4716, label: 2, bag_size: 398
batch 479, loss: 1.5563, instance_loss: 0.5693, weighted_loss: 1.2602, label: 4, bag_size: 726
batch 499, loss: 0.8660, instance_loss: 0.4892, weighted_loss: 0.7530, label: 0, bag_size: 404
batch 519, loss: 0.0843, instance_loss: 0.3957, weighted_loss: 0.1777, label: 0, bag_size: 59
batch 539, loss: 0.0232, instance_loss: 0.1899, weighted_loss: 0.0732, label: 0, bag_size: 453
batch 559, loss: 0.3100, instance_loss: 0.5110, weighted_loss: 0.3703, label: 4, bag_size: 359
batch 579, loss: 1.1957, instance_loss: 0.4938, weighted_loss: 0.9851, label: 3, bag_size: 1284


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.070496632996633: correct 335/4752
Epoch: 57, train_loss: 1.0062, train_clustering_loss:  0.4673, train_error: 0.4495
class 0: acc 0.7844827586206896, correct 91/116
class 1: acc 0.6260869565217392, correct 72/115
class 2: acc 0.31932773109243695, correct 38/119
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.5923076923076923, correct 77/130

Val Set, val_loss: 1.3801, val_error: 0.5270, auc: 0.8158
class 0 clustering acc 0.9908783783783783: correct 2933/2960
class 1 clustering acc 0.10135135135135136: correct 60/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.2799, instance_loss: 0.5150, weighted_loss: 1.0504, label: 2, bag_size: 781
batch 39, loss: 0.6923, instance_loss: 0.4394, weighted_loss: 0.6164, label: 4, bag_size: 1041
batch 59, loss: 0.6872, instance_loss: 0.5936, weighted_loss: 0.6591, label: 2, bag_size: 571
batch 79, loss: 0.0309, instance_loss: 0.1481, weighted_loss: 0.0661, label: 0, bag_size: 282
batch 99, loss: 1.3071, instance_loss: 0.5725, weighted_loss: 1.0867, label: 0, bag_size: 168
batch 119, loss: 2.5912, instance_loss: 0.6907, weighted_loss: 2.0211, label: 4, bag_size: 399
batch 139, loss: 1.7739, instance_loss: 0.3873, weighted_loss: 1.3579, label: 4, bag_size: 377
batch 159, loss: 1.5298, instance_loss: 0.5163, weighted_loss: 1.2258, label: 2, bag_size: 176
batch 179, loss: 0.4083, instance_loss: 0.4544, weighted_loss: 0.4221, label: 0, bag_size: 400
batch 199, loss: 0.8063, instance_loss: 0.4391, weighted_loss: 0.6961, label: 2, bag_size: 315
batch 219, loss: 0.8438, instance_loss: 0.4687, weighted_loss: 0.7313, label: 1, bag_size: 311
batch 239, loss: 0.5906, instance_loss: 0.6370, weighted_loss: 0.6045, label: 2, bag_size: 25
batch 259, loss: 0.0081, instance_loss: 0.2833, weighted_loss: 0.0907, label: 0, bag_size: 159
batch 279, loss: 1.1791, instance_loss: 0.5219, weighted_loss: 0.9819, label: 3, bag_size: 520
batch 299, loss: 0.1677, instance_loss: 0.4733, weighted_loss: 0.2594, label: 4, bag_size: 1351
batch 319, loss: 0.4374, instance_loss: 0.4585, weighted_loss: 0.4437, label: 0, bag_size: 62
batch 339, loss: 1.6764, instance_loss: 0.5930, weighted_loss: 1.3514, label: 3, bag_size: 856
batch 359, loss: 2.0530, instance_loss: 0.6251, weighted_loss: 1.6246, label: 0, bag_size: 243
batch 379, loss: 1.7909, instance_loss: 0.6827, weighted_loss: 1.4585, label: 4, bag_size: 267
batch 399, loss: 1.5272, instance_loss: 0.5634, weighted_loss: 1.2380, label: 2, bag_size: 380
batch 419, loss: 2.0460, instance_loss: 0.5483, weighted_loss: 1.5967, label: 3, bag_size: 393
batch 439, loss: 0.1838, instance_loss: 0.4644, weighted_loss: 0.2680, label: 4, bag_size: 293
batch 459, loss: 1.2874, instance_loss: 0.4885, weighted_loss: 1.0477, label: 3, bag_size: 453
batch 479, loss: 1.5456, instance_loss: 0.6142, weighted_loss: 1.2662, label: 2, bag_size: 176
batch 499, loss: 0.2763, instance_loss: 0.4418, weighted_loss: 0.3259, label: 4, bag_size: 773
batch 519, loss: 1.3506, instance_loss: 0.5841, weighted_loss: 1.1207, label: 3, bag_size: 1022
batch 539, loss: 0.4458, instance_loss: 0.3972, weighted_loss: 0.4312, label: 3, bag_size: 996
batch 559, loss: 0.5831, instance_loss: 0.6395, weighted_loss: 0.6000, label: 2, bag_size: 119
batch 579, loss: 0.5913, instance_loss: 0.4501, weighted_loss: 0.5489, label: 3, bag_size: 737


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.058922558922558925: correct 280/4752
Epoch: 58, train_loss: 1.0641, train_clustering_loss:  0.4760, train_error: 0.4865
class 0: acc 0.7521367521367521, correct 88/117
class 1: acc 0.6, correct 81/135
class 2: acc 0.2601626016260163, correct 32/123
class 3: acc 0.35454545454545455, correct 39/110
class 4: acc 0.5963302752293578, correct 65/109

Val Set, val_loss: 1.4041, val_error: 0.5270, auc: 0.7945
class 0 clustering acc 0.9891891891891892: correct 2928/2960
class 1 clustering acc 0.08614864864864864: correct 51/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.8347, instance_loss: 0.5749, weighted_loss: 1.4568, label: 4, bag_size: 342
batch 39, loss: 1.4833, instance_loss: 0.5112, weighted_loss: 1.1917, label: 4, bag_size: 592
batch 59, loss: 0.1154, instance_loss: 0.3529, weighted_loss: 0.1867, label: 0, bag_size: 282
batch 79, loss: 0.7351, instance_loss: 0.4642, weighted_loss: 0.6538, label: 3, bag_size: 459
batch 99, loss: 0.5891, instance_loss: 0.6351, weighted_loss: 0.6029, label: 4, bag_size: 359
batch 119, loss: 0.8527, instance_loss: 0.6043, weighted_loss: 0.7782, label: 2, bag_size: 240
batch 139, loss: 1.2813, instance_loss: 0.4761, weighted_loss: 1.0398, label: 1, bag_size: 823
batch 159, loss: 1.6637, instance_loss: 0.5535, weighted_loss: 1.3307, label: 2, bag_size: 407
batch 179, loss: 0.5489, instance_loss: 0.4266, weighted_loss: 0.5122, label: 1, bag_size: 1103
batch 199, loss: 0.1153, instance_loss: 0.4497, weighted_loss: 0.2156, label: 4, bag_size: 160
batch 219, loss: 1.9668, instance_loss: 0.5029, weighted_loss: 1.5277, label: 2, bag_size: 1122
batch 239, loss: 0.5559, instance_loss: 0.3950, weighted_loss: 0.5076, label: 1, bag_size: 410
batch 259, loss: 2.9734, instance_loss: 0.7118, weighted_loss: 2.2950, label: 2, bag_size: 1308
batch 279, loss: 2.1485, instance_loss: 0.6014, weighted_loss: 1.6843, label: 2, bag_size: 1122
batch 299, loss: 0.0033, instance_loss: 0.1633, weighted_loss: 0.0513, label: 0, bag_size: 350
batch 319, loss: 0.7211, instance_loss: 0.4075, weighted_loss: 0.6270, label: 1, bag_size: 526
batch 339, loss: 0.0059, instance_loss: 0.3007, weighted_loss: 0.0943, label: 0, bag_size: 73
batch 359, loss: 1.2504, instance_loss: 0.7111, weighted_loss: 1.0886, label: 4, bag_size: 101
batch 379, loss: 0.9260, instance_loss: 0.3923, weighted_loss: 0.7659, label: 3, bag_size: 1022
batch 399, loss: 0.0197, instance_loss: 0.2439, weighted_loss: 0.0869, label: 0, bag_size: 523
batch 419, loss: 2.1205, instance_loss: 0.5957, weighted_loss: 1.6630, label: 0, bag_size: 710
batch 439, loss: 0.2540, instance_loss: 0.3636, weighted_loss: 0.2869, label: 0, bag_size: 453
batch 459, loss: 0.9778, instance_loss: 0.4998, weighted_loss: 0.8344, label: 2, bag_size: 864
batch 479, loss: 1.4313, instance_loss: 0.4881, weighted_loss: 1.1483, label: 4, bag_size: 238
batch 499, loss: 0.8648, instance_loss: 0.3907, weighted_loss: 0.7226, label: 1, bag_size: 1019
batch 519, loss: 1.1352, instance_loss: 0.5774, weighted_loss: 0.9679, label: 4, bag_size: 468
batch 539, loss: 1.0200, instance_loss: 0.4534, weighted_loss: 0.8500, label: 2, bag_size: 376
batch 559, loss: 2.4572, instance_loss: 0.5723, weighted_loss: 1.8917, label: 4, bag_size: 356
batch 579, loss: 1.9209, instance_loss: 0.5520, weighted_loss: 1.5102, label: 2, bag_size: 829


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.07975589225589226: correct 379/4752
Epoch: 59, train_loss: 0.9690, train_clustering_loss:  0.4664, train_error: 0.3956
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.75, correct 102/136
class 2: acc 0.30434782608695654, correct 35/115
class 3: acc 0.5740740740740741, correct 62/108
class 4: acc 0.5462962962962963, correct 59/108

Val Set, val_loss: 1.3816, val_error: 0.5000, auc: 0.7935
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.6883, instance_loss: 0.5139, weighted_loss: 1.3360, label: 1, bag_size: 141
batch 39, loss: 1.9863, instance_loss: 0.5179, weighted_loss: 1.5458, label: 1, bag_size: 840
batch 59, loss: 0.0350, instance_loss: 0.3906, weighted_loss: 0.1417, label: 0, bag_size: 370
batch 79, loss: 0.2484, instance_loss: 0.5532, weighted_loss: 0.3399, label: 4, bag_size: 359
batch 99, loss: 0.7374, instance_loss: 0.4474, weighted_loss: 0.6504, label: 2, bag_size: 708
batch 119, loss: 0.8943, instance_loss: 0.3443, weighted_loss: 0.7293, label: 1, bag_size: 311
batch 139, loss: 0.0298, instance_loss: 0.2941, weighted_loss: 0.1090, label: 0, bag_size: 188
batch 159, loss: 3.0013, instance_loss: 0.8037, weighted_loss: 2.3420, label: 0, bag_size: 492
batch 179, loss: 1.1541, instance_loss: 0.4550, weighted_loss: 0.9444, label: 3, bag_size: 822
batch 199, loss: 1.3664, instance_loss: 0.4814, weighted_loss: 1.1009, label: 1, bag_size: 159
batch 219, loss: 1.0474, instance_loss: 0.6369, weighted_loss: 0.9243, label: 2, bag_size: 315
batch 239, loss: 0.5997, instance_loss: 0.4352, weighted_loss: 0.5503, label: 3, bag_size: 928
batch 259, loss: 1.2520, instance_loss: 0.4566, weighted_loss: 1.0134, label: 3, bag_size: 393
batch 279, loss: 1.2264, instance_loss: 0.6271, weighted_loss: 1.0466, label: 0, bag_size: 238
batch 299, loss: 0.0468, instance_loss: 0.2697, weighted_loss: 0.1136, label: 0, bag_size: 397
batch 319, loss: 1.9292, instance_loss: 0.5420, weighted_loss: 1.5131, label: 2, bag_size: 1308
batch 339, loss: 1.5079, instance_loss: 0.5838, weighted_loss: 1.2307, label: 3, bag_size: 1057
batch 359, loss: 1.4852, instance_loss: 0.5494, weighted_loss: 1.2044, label: 4, bag_size: 407
batch 379, loss: 0.4919, instance_loss: 0.4957, weighted_loss: 0.4930, label: 3, bag_size: 301
batch 399, loss: 0.4388, instance_loss: 0.4283, weighted_loss: 0.4357, label: 2, bag_size: 614
batch 419, loss: 0.3159, instance_loss: 0.3373, weighted_loss: 0.3223, label: 4, bag_size: 776
batch 439, loss: 0.8925, instance_loss: 0.4770, weighted_loss: 0.7678, label: 3, bag_size: 344
batch 459, loss: 0.3779, instance_loss: 0.4131, weighted_loss: 0.3884, label: 1, bag_size: 886
batch 479, loss: 0.3109, instance_loss: 0.3699, weighted_loss: 0.3286, label: 3, bag_size: 684
batch 499, loss: 0.0001, instance_loss: 0.1553, weighted_loss: 0.0467, label: 0, bag_size: 236
batch 519, loss: 0.2686, instance_loss: 0.3902, weighted_loss: 0.3051, label: 4, bag_size: 854
batch 539, loss: 0.0052, instance_loss: 0.2099, weighted_loss: 0.0666, label: 0, bag_size: 251
batch 559, loss: 0.5417, instance_loss: 0.4240, weighted_loss: 0.5064, label: 4, bag_size: 263
batch 579, loss: 0.3326, instance_loss: 0.3991, weighted_loss: 0.3525, label: 4, bag_size: 124


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.04945286195286195: correct 235/4752
Epoch: 60, train_loss: 1.0456, train_clustering_loss:  0.4788, train_error: 0.4663
class 0: acc 0.7368421052631579, correct 84/114
class 1: acc 0.652542372881356, correct 77/118
class 2: acc 0.35344827586206895, correct 41/116
class 3: acc 0.3968253968253968, correct 50/126
class 4: acc 0.5416666666666666, correct 65/120

Val Set, val_loss: 1.2715, val_error: 0.5270, auc: 0.8165
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.0411, instance_loss: 0.4182, weighted_loss: 0.8542, label: 0, bag_size: 524
batch 39, loss: 2.5276, instance_loss: 0.5923, weighted_loss: 1.9470, label: 0, bag_size: 1045
batch 59, loss: 0.6650, instance_loss: 0.4676, weighted_loss: 0.6058, label: 4, bag_size: 960
batch 79, loss: 0.1114, instance_loss: 0.4197, weighted_loss: 0.2039, label: 4, bag_size: 725
batch 99, loss: 0.9684, instance_loss: 0.4720, weighted_loss: 0.8195, label: 3, bag_size: 857
batch 119, loss: 1.1162, instance_loss: 0.5374, weighted_loss: 0.9426, label: 2, bag_size: 769
batch 139, loss: 3.0362, instance_loss: 0.6429, weighted_loss: 2.3182, label: 2, bag_size: 351
batch 159, loss: 0.5945, instance_loss: 0.4453, weighted_loss: 0.5497, label: 2, bag_size: 754
batch 179, loss: 0.7294, instance_loss: 0.4458, weighted_loss: 0.6443, label: 1, bag_size: 605
batch 199, loss: 0.7693, instance_loss: 0.4849, weighted_loss: 0.6840, label: 1, bag_size: 444
batch 219, loss: 4.1680, instance_loss: 0.6628, weighted_loss: 3.1164, label: 2, bag_size: 563
batch 239, loss: 1.2468, instance_loss: 0.5933, weighted_loss: 1.0507, label: 2, bag_size: 1066
batch 259, loss: 2.2805, instance_loss: 0.6248, weighted_loss: 1.7838, label: 2, bag_size: 1122
batch 279, loss: 1.2685, instance_loss: 0.3056, weighted_loss: 0.9796, label: 1, bag_size: 1082
batch 299, loss: 1.2889, instance_loss: 0.4542, weighted_loss: 1.0385, label: 4, bag_size: 238
batch 319, loss: 1.0509, instance_loss: 0.5003, weighted_loss: 0.8857, label: 2, bag_size: 350
batch 339, loss: 1.1207, instance_loss: 0.5014, weighted_loss: 0.9349, label: 3, bag_size: 451
batch 359, loss: 1.5236, instance_loss: 0.4895, weighted_loss: 1.2134, label: 2, bag_size: 906
batch 379, loss: 1.8016, instance_loss: 0.4996, weighted_loss: 1.4110, label: 1, bag_size: 697
batch 399, loss: 0.3271, instance_loss: 0.4109, weighted_loss: 0.3522, label: 4, bag_size: 725
batch 419, loss: 1.8953, instance_loss: 0.5815, weighted_loss: 1.5012, label: 2, bag_size: 297
batch 439, loss: 0.0487, instance_loss: 0.2320, weighted_loss: 0.1037, label: 0, bag_size: 357
batch 459, loss: 0.9399, instance_loss: 0.4510, weighted_loss: 0.7933, label: 3, bag_size: 457
batch 479, loss: 0.5371, instance_loss: 0.4107, weighted_loss: 0.4992, label: 3, bag_size: 928
batch 499, loss: 0.9627, instance_loss: 0.4316, weighted_loss: 0.8034, label: 3, bag_size: 472
batch 519, loss: 1.6078, instance_loss: 0.5360, weighted_loss: 1.2863, label: 2, bag_size: 731
batch 539, loss: 1.4882, instance_loss: 0.5223, weighted_loss: 1.1984, label: 3, bag_size: 899
batch 559, loss: 1.9687, instance_loss: 0.6106, weighted_loss: 1.5613, label: 2, bag_size: 339
batch 579, loss: 1.5809, instance_loss: 0.5697, weighted_loss: 1.2775, label: 3, bag_size: 856


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.052398989898989896: correct 249/4752
Epoch: 61, train_loss: 0.9761, train_clustering_loss:  0.4669, train_error: 0.4209
class 0: acc 0.7948717948717948, correct 93/117
class 1: acc 0.6761904761904762, correct 71/105
class 2: acc 0.3389830508474576, correct 40/118
class 3: acc 0.44166666666666665, correct 53/120
class 4: acc 0.6492537313432836, correct 87/134

Val Set, val_loss: 1.3361, val_error: 0.4730, auc: 0.8223
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.03885135135135135: correct 23/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4513, instance_loss: 0.4744, weighted_loss: 0.4582, label: 2, bag_size: 1013
batch 39, loss: 0.4234, instance_loss: 0.4488, weighted_loss: 0.4311, label: 3, bag_size: 1001
batch 59, loss: 0.8006, instance_loss: 0.4455, weighted_loss: 0.6941, label: 4, bag_size: 714
batch 79, loss: 0.9891, instance_loss: 0.4579, weighted_loss: 0.8298, label: 1, bag_size: 886
batch 99, loss: 1.1331, instance_loss: 0.4435, weighted_loss: 0.9262, label: 3, bag_size: 795
batch 119, loss: 0.0244, instance_loss: 0.2716, weighted_loss: 0.0985, label: 0, bag_size: 425
batch 139, loss: 0.0005, instance_loss: 0.1767, weighted_loss: 0.0533, label: 0, bag_size: 138
batch 159, loss: 1.4292, instance_loss: 0.5210, weighted_loss: 1.1568, label: 2, bag_size: 488
batch 179, loss: 0.3270, instance_loss: 0.3539, weighted_loss: 0.3350, label: 4, bag_size: 780
batch 199, loss: 2.4019, instance_loss: 0.6840, weighted_loss: 1.8865, label: 2, bag_size: 337
batch 219, loss: 0.7194, instance_loss: 0.3513, weighted_loss: 0.6089, label: 4, bag_size: 244
batch 239, loss: 0.3893, instance_loss: 0.4093, weighted_loss: 0.3953, label: 1, bag_size: 460
batch 259, loss: 0.6696, instance_loss: 0.4851, weighted_loss: 0.6142, label: 2, bag_size: 369
batch 279, loss: 1.8122, instance_loss: 0.4852, weighted_loss: 1.4141, label: 0, bag_size: 964
batch 299, loss: 0.0721, instance_loss: 0.3278, weighted_loss: 0.1488, label: 0, bag_size: 63
batch 319, loss: 1.5483, instance_loss: 0.5380, weighted_loss: 1.2452, label: 2, bag_size: 339
batch 339, loss: 2.9650, instance_loss: 0.5070, weighted_loss: 2.2276, label: 4, bag_size: 407
batch 359, loss: 2.9023, instance_loss: 0.6234, weighted_loss: 2.2186, label: 2, bag_size: 852
batch 379, loss: 0.0995, instance_loss: 0.3318, weighted_loss: 0.1692, label: 0, bag_size: 351
batch 399, loss: 0.0210, instance_loss: 0.3094, weighted_loss: 0.1075, label: 0, bag_size: 175
batch 419, loss: 1.5909, instance_loss: 0.5829, weighted_loss: 1.2885, label: 2, bag_size: 128
batch 439, loss: 1.5787, instance_loss: 0.6283, weighted_loss: 1.2936, label: 0, bag_size: 247
batch 459, loss: 0.9037, instance_loss: 0.4190, weighted_loss: 0.7583, label: 3, bag_size: 437
batch 479, loss: 1.0112, instance_loss: 0.4200, weighted_loss: 0.8338, label: 4, bag_size: 490
batch 499, loss: 0.1872, instance_loss: 0.3958, weighted_loss: 0.2498, label: 0, bag_size: 288
batch 519, loss: 1.7534, instance_loss: 0.5507, weighted_loss: 1.3925, label: 2, bag_size: 297
batch 539, loss: 0.3139, instance_loss: 0.3772, weighted_loss: 0.3329, label: 4, bag_size: 530
batch 559, loss: 0.0022, instance_loss: 0.3170, weighted_loss: 0.0967, label: 0, bag_size: 71
batch 579, loss: 0.1242, instance_loss: 0.3824, weighted_loss: 0.2017, label: 0, bag_size: 227


class 0 clustering acc 0.9954124579124579: correct 23651/23760
class 1 clustering acc 0.05976430976430976: correct 284/4752
Epoch: 62, train_loss: 0.9921, train_clustering_loss:  0.4699, train_error: 0.4428
class 0: acc 0.7317073170731707, correct 90/123
class 1: acc 0.6722689075630253, correct 80/119
class 2: acc 0.3684210526315789, correct 49/133
class 3: acc 0.32323232323232326, correct 32/99
class 4: acc 0.6666666666666666, correct 80/120

Val Set, val_loss: 1.3856, val_error: 0.4730, auc: 0.8131
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.07094594594594594: correct 42/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0824, instance_loss: 0.5430, weighted_loss: 0.2206, label: 2, bag_size: 1975
batch 39, loss: 0.4563, instance_loss: 0.4597, weighted_loss: 0.4574, label: 2, bag_size: 385
batch 59, loss: 0.6566, instance_loss: 0.4920, weighted_loss: 0.6072, label: 3, bag_size: 428
batch 79, loss: 0.9119, instance_loss: 0.4422, weighted_loss: 0.7710, label: 2, bag_size: 522
batch 99, loss: 0.8713, instance_loss: 0.4851, weighted_loss: 0.7555, label: 1, bag_size: 391
batch 119, loss: 0.1597, instance_loss: 0.3724, weighted_loss: 0.2235, label: 1, bag_size: 886
batch 139, loss: 0.4443, instance_loss: 0.4485, weighted_loss: 0.4456, label: 4, bag_size: 520
batch 159, loss: 0.3979, instance_loss: 0.4700, weighted_loss: 0.4195, label: 2, bag_size: 119
batch 179, loss: 0.6634, instance_loss: 0.4886, weighted_loss: 0.6109, label: 3, bag_size: 872
batch 199, loss: 1.1627, instance_loss: 0.5980, weighted_loss: 0.9933, label: 4, bag_size: 293
batch 219, loss: 1.3192, instance_loss: 0.4656, weighted_loss: 1.0631, label: 4, bag_size: 712
batch 239, loss: 0.6692, instance_loss: 0.4026, weighted_loss: 0.5892, label: 3, bag_size: 1154
batch 259, loss: 1.1036, instance_loss: 0.6822, weighted_loss: 0.9772, label: 0, bag_size: 1570
batch 279, loss: 0.6671, instance_loss: 0.4591, weighted_loss: 0.6047, label: 1, bag_size: 332
batch 299, loss: 1.3289, instance_loss: 0.4657, weighted_loss: 1.0699, label: 1, bag_size: 208
batch 319, loss: 0.0388, instance_loss: 0.3281, weighted_loss: 0.1256, label: 0, bag_size: 73
batch 339, loss: 0.7140, instance_loss: 0.4725, weighted_loss: 0.6416, label: 3, bag_size: 858
batch 359, loss: 0.0636, instance_loss: 0.4981, weighted_loss: 0.1940, label: 1, bag_size: 1497
batch 379, loss: 0.3178, instance_loss: 0.4834, weighted_loss: 0.3675, label: 0, bag_size: 393
batch 399, loss: 0.4183, instance_loss: 0.3809, weighted_loss: 0.4071, label: 0, bag_size: 357
batch 419, loss: 0.0536, instance_loss: 0.2834, weighted_loss: 0.1226, label: 0, bag_size: 425
batch 439, loss: 1.1795, instance_loss: 0.4115, weighted_loss: 0.9491, label: 4, bag_size: 366
batch 459, loss: 1.0454, instance_loss: 0.5339, weighted_loss: 0.8920, label: 2, bag_size: 288
batch 479, loss: 2.4959, instance_loss: 0.6536, weighted_loss: 1.9432, label: 2, bag_size: 331
batch 499, loss: 1.3268, instance_loss: 0.6367, weighted_loss: 1.1198, label: 2, bag_size: 371
batch 519, loss: 2.4234, instance_loss: 0.6168, weighted_loss: 1.8814, label: 4, bag_size: 342
batch 539, loss: 0.6047, instance_loss: 0.4821, weighted_loss: 0.5679, label: 4, bag_size: 695
batch 559, loss: 0.7195, instance_loss: 0.4438, weighted_loss: 0.6367, label: 4, bag_size: 574
batch 579, loss: 1.0841, instance_loss: 0.4313, weighted_loss: 0.8883, label: 1, bag_size: 981


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.05324074074074074: correct 253/4752
Epoch: 63, train_loss: 0.9754, train_clustering_loss:  0.4660, train_error: 0.4108
class 0: acc 0.7663551401869159, correct 82/107
class 1: acc 0.6776859504132231, correct 82/121
class 2: acc 0.3360655737704918, correct 41/122
class 3: acc 0.5693430656934306, correct 78/137
class 4: acc 0.6261682242990654, correct 67/107

Val Set, val_loss: 1.3037, val_error: 0.4730, auc: 0.8108
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.06418918918918919: correct 38/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.9285714285714286, correct 13/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.4054, ROC AUC: 0.8133
Test error: 0.5000, ROC AUC: 0.8360
class 0: acc 0.9375, correct 15/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9804, instance_loss: 0.6671, weighted_loss: 1.5864, label: 1, bag_size: 764
batch 39, loss: 2.5305, instance_loss: 0.5229, weighted_loss: 1.9282, label: 2, bag_size: 407
batch 59, loss: 1.4155, instance_loss: 0.5015, weighted_loss: 1.1413, label: 3, bag_size: 301
batch 79, loss: 0.9845, instance_loss: 0.5444, weighted_loss: 0.8525, label: 1, bag_size: 328
batch 99, loss: 2.4321, instance_loss: 0.5502, weighted_loss: 1.8675, label: 2, bag_size: 363
batch 119, loss: 0.5228, instance_loss: 0.4087, weighted_loss: 0.4885, label: 3, bag_size: 459
batch 139, loss: 1.1224, instance_loss: 0.5069, weighted_loss: 0.9377, label: 2, bag_size: 1308
batch 159, loss: 2.1543, instance_loss: 0.5902, weighted_loss: 1.6850, label: 2, bag_size: 177
batch 179, loss: 1.7819, instance_loss: 0.5147, weighted_loss: 1.4017, label: 3, bag_size: 856
batch 199, loss: 1.6588, instance_loss: 0.5351, weighted_loss: 1.3217, label: 2, bag_size: 176
batch 219, loss: 1.4392, instance_loss: 0.5376, weighted_loss: 1.1687, label: 0, bag_size: 277
batch 239, loss: 1.2751, instance_loss: 0.4953, weighted_loss: 1.0412, label: 4, bag_size: 797
batch 259, loss: 2.7670, instance_loss: 0.6250, weighted_loss: 2.1244, label: 0, bag_size: 277
batch 279, loss: 1.6826, instance_loss: 0.5480, weighted_loss: 1.3423, label: 4, bag_size: 769
batch 299, loss: 0.2383, instance_loss: 0.4110, weighted_loss: 0.2901, label: 0, bag_size: 268
batch 319, loss: 1.6403, instance_loss: 0.5159, weighted_loss: 1.3030, label: 3, bag_size: 497
batch 339, loss: 1.4951, instance_loss: 0.4634, weighted_loss: 1.1856, label: 1, bag_size: 311
batch 359, loss: 1.5340, instance_loss: 0.5296, weighted_loss: 1.2327, label: 4, bag_size: 246
batch 379, loss: 1.2956, instance_loss: 0.5162, weighted_loss: 1.0618, label: 2, bag_size: 299
batch 399, loss: 0.2963, instance_loss: 0.3925, weighted_loss: 0.3251, label: 0, bag_size: 280
batch 419, loss: 2.8049, instance_loss: 0.6284, weighted_loss: 2.1519, label: 1, bag_size: 44
batch 439, loss: 0.2748, instance_loss: 0.4024, weighted_loss: 0.3131, label: 0, bag_size: 98
batch 459, loss: 1.0900, instance_loss: 0.4674, weighted_loss: 0.9032, label: 1, bag_size: 500
batch 479, loss: 0.1776, instance_loss: 0.3765, weighted_loss: 0.2373, label: 0, bag_size: 357
batch 499, loss: 2.0143, instance_loss: 0.5768, weighted_loss: 1.5831, label: 3, bag_size: 804
batch 519, loss: 1.3072, instance_loss: 0.4784, weighted_loss: 1.0586, label: 1, bag_size: 233
batch 539, loss: 1.3731, instance_loss: 0.5353, weighted_loss: 1.1217, label: 3, bag_size: 631
batch 559, loss: 1.3991, instance_loss: 0.5212, weighted_loss: 1.1357, label: 4, bag_size: 731
batch 579, loss: 1.0499, instance_loss: 0.5141, weighted_loss: 0.8891, label: 2, bag_size: 350


class 0 clustering acc 0.9982744107744108: correct 23719/23760
class 1 clustering acc 0.001893939393939394: correct 9/4752
Epoch: 0, train_loss: 1.5002, train_clustering_loss:  0.5213, train_error: 0.6481
class 0: acc 0.6929824561403509, correct 79/114
class 1: acc 0.3769230769230769, correct 49/130
class 2: acc 0.1623931623931624, correct 19/117
class 3: acc 0.21367521367521367, correct 25/117
class 4: acc 0.31896551724137934, correct 37/116

Val Set, val_loss: 1.5311, val_error: 0.6892, auc: 0.6425
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.531104).  Saving model ...


batch 19, loss: 1.9229, instance_loss: 0.5683, weighted_loss: 1.5166, label: 3, bag_size: 97
batch 39, loss: 2.5760, instance_loss: 0.6435, weighted_loss: 1.9962, label: 0, bag_size: 1085
batch 59, loss: 2.2900, instance_loss: 0.5389, weighted_loss: 1.7647, label: 0, bag_size: 435
batch 79, loss: 1.5714, instance_loss: 0.4946, weighted_loss: 1.2483, label: 2, bag_size: 318
batch 99, loss: 1.6344, instance_loss: 0.4506, weighted_loss: 1.2793, label: 2, bag_size: 563
batch 119, loss: 1.3590, instance_loss: 0.5083, weighted_loss: 1.1038, label: 1, bag_size: 272
batch 139, loss: 1.0247, instance_loss: 0.4096, weighted_loss: 0.8402, label: 1, bag_size: 1104
batch 159, loss: 1.4598, instance_loss: 0.4960, weighted_loss: 1.1707, label: 4, bag_size: 853
batch 179, loss: 2.4072, instance_loss: 0.4919, weighted_loss: 1.8326, label: 0, bag_size: 370
batch 199, loss: 0.5002, instance_loss: 0.3435, weighted_loss: 0.4532, label: 0, bag_size: 258
batch 219, loss: 0.1592, instance_loss: 0.3324, weighted_loss: 0.2112, label: 0, bag_size: 59
batch 239, loss: 2.8303, instance_loss: 0.6613, weighted_loss: 2.1796, label: 2, bag_size: 135
batch 259, loss: 1.3356, instance_loss: 0.4738, weighted_loss: 1.0770, label: 1, bag_size: 1009
batch 279, loss: 1.0768, instance_loss: 0.4961, weighted_loss: 0.9026, label: 0, bag_size: 404
batch 299, loss: 1.2857, instance_loss: 0.4976, weighted_loss: 1.0493, label: 3, bag_size: 804
batch 319, loss: 0.1180, instance_loss: 0.3180, weighted_loss: 0.1780, label: 0, bag_size: 63
batch 339, loss: 0.0967, instance_loss: 0.3015, weighted_loss: 0.1582, label: 0, bag_size: 175
batch 359, loss: 1.1009, instance_loss: 0.4660, weighted_loss: 0.9104, label: 4, bag_size: 503
batch 379, loss: 1.4373, instance_loss: 0.4733, weighted_loss: 1.1481, label: 3, bag_size: 235
batch 399, loss: 1.6626, instance_loss: 0.4920, weighted_loss: 1.3115, label: 4, bag_size: 318
batch 419, loss: 1.1043, instance_loss: 0.4637, weighted_loss: 0.9121, label: 1, bag_size: 1103
batch 439, loss: 1.7828, instance_loss: 0.5480, weighted_loss: 1.4124, label: 4, bag_size: 333
batch 459, loss: 0.1090, instance_loss: 0.3222, weighted_loss: 0.1730, label: 0, bag_size: 357
batch 479, loss: 1.5136, instance_loss: 0.4469, weighted_loss: 1.1936, label: 4, bag_size: 639
batch 499, loss: 5.3979, instance_loss: 0.8188, weighted_loss: 4.0242, label: 0, bag_size: 421
batch 519, loss: 1.2155, instance_loss: 0.5347, weighted_loss: 1.0113, label: 2, bag_size: 809
batch 539, loss: 0.1001, instance_loss: 0.3169, weighted_loss: 0.1651, label: 0, bag_size: 340
batch 559, loss: 1.2196, instance_loss: 0.4101, weighted_loss: 0.9768, label: 3, bag_size: 369
batch 579, loss: 1.1984, instance_loss: 0.4728, weighted_loss: 0.9807, label: 2, bag_size: 567


class 0 clustering acc 0.9993265993265993: correct 23744/23760
class 1 clustering acc 0.012626262626262626: correct 60/4752
Epoch: 1, train_loss: 1.3776, train_clustering_loss:  0.4946, train_error: 0.6162
class 0: acc 0.7563025210084033, correct 90/119
class 1: acc 0.1937984496124031, correct 25/129
class 2: acc 0.32142857142857145, correct 36/112
class 3: acc 0.3492063492063492, correct 44/126
class 4: acc 0.3055555555555556, correct 33/108

Val Set, val_loss: 1.5929, val_error: 0.7027, auc: 0.6445
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9118, instance_loss: 0.4246, weighted_loss: 0.7656, label: 3, bag_size: 556
batch 39, loss: 1.1539, instance_loss: 0.4350, weighted_loss: 0.9383, label: 1, bag_size: 410
batch 59, loss: 2.3294, instance_loss: 0.5880, weighted_loss: 1.8070, label: 2, bag_size: 244
batch 79, loss: 2.6723, instance_loss: 0.6703, weighted_loss: 2.0717, label: 0, bag_size: 879
batch 99, loss: 0.5619, instance_loss: 0.4863, weighted_loss: 0.5393, label: 4, bag_size: 129
batch 119, loss: 3.2792, instance_loss: 0.6716, weighted_loss: 2.4969, label: 1, bag_size: 44
batch 139, loss: 1.3164, instance_loss: 0.5967, weighted_loss: 1.1005, label: 3, bag_size: 794
batch 159, loss: 0.9497, instance_loss: 0.5436, weighted_loss: 0.8278, label: 4, bag_size: 773
batch 179, loss: 1.9655, instance_loss: 0.5205, weighted_loss: 1.5320, label: 1, bag_size: 389
batch 199, loss: 1.5682, instance_loss: 0.5713, weighted_loss: 1.2691, label: 1, bag_size: 355
batch 219, loss: 2.1231, instance_loss: 0.5792, weighted_loss: 1.6599, label: 0, bag_size: 745
batch 239, loss: 0.8143, instance_loss: 0.4452, weighted_loss: 0.7036, label: 4, bag_size: 530
batch 259, loss: 1.6706, instance_loss: 0.5037, weighted_loss: 1.3205, label: 3, bag_size: 497
batch 279, loss: 1.4223, instance_loss: 0.5172, weighted_loss: 1.1507, label: 1, bag_size: 490
batch 299, loss: 0.2558, instance_loss: 0.3829, weighted_loss: 0.2939, label: 0, bag_size: 355
batch 319, loss: 1.6471, instance_loss: 0.5909, weighted_loss: 1.3302, label: 3, bag_size: 543
batch 339, loss: 2.6655, instance_loss: 0.5441, weighted_loss: 2.0291, label: 4, bag_size: 363
batch 359, loss: 1.2475, instance_loss: 0.4348, weighted_loss: 1.0037, label: 1, bag_size: 925
batch 379, loss: 1.4226, instance_loss: 0.4963, weighted_loss: 1.1447, label: 3, bag_size: 1021
batch 399, loss: 1.6522, instance_loss: 0.5098, weighted_loss: 1.3095, label: 2, bag_size: 909
batch 419, loss: 2.9519, instance_loss: 0.6237, weighted_loss: 2.2534, label: 4, bag_size: 854
batch 439, loss: 0.0563, instance_loss: 0.2643, weighted_loss: 0.1187, label: 0, bag_size: 74
batch 459, loss: 0.9238, instance_loss: 0.4481, weighted_loss: 0.7811, label: 2, bag_size: 853
batch 479, loss: 2.6914, instance_loss: 0.6371, weighted_loss: 2.0751, label: 4, bag_size: 270
batch 499, loss: 0.5622, instance_loss: 0.4759, weighted_loss: 0.5363, label: 4, bag_size: 895
batch 519, loss: 0.1990, instance_loss: 0.3392, weighted_loss: 0.2411, label: 0, bag_size: 79
batch 539, loss: 1.4934, instance_loss: 0.5511, weighted_loss: 1.2107, label: 3, bag_size: 453
batch 559, loss: 1.5521, instance_loss: 0.5038, weighted_loss: 1.2376, label: 2, bag_size: 299
batch 579, loss: 3.9019, instance_loss: 0.7126, weighted_loss: 2.9451, label: 0, bag_size: 600


class 0 clustering acc 0.9971801346801347: correct 23693/23760
class 1 clustering acc 0.027356902356902357: correct 130/4752
Epoch: 2, train_loss: 1.3662, train_clustering_loss:  0.4952, train_error: 0.5724
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.23387096774193547, correct 29/124
class 2: acc 0.22727272727272727, correct 25/110
class 3: acc 0.2975206611570248, correct 36/121
class 4: acc 0.576271186440678, correct 68/118

Val Set, val_loss: 1.4968, val_error: 0.6892, auc: 0.6897
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.531104 --> 1.496813).  Saving model ...


batch 19, loss: 1.6355, instance_loss: 0.5528, weighted_loss: 1.3107, label: 2, bag_size: 535
batch 39, loss: 1.5448, instance_loss: 0.5145, weighted_loss: 1.2357, label: 2, bag_size: 286
batch 59, loss: 0.0995, instance_loss: 0.2961, weighted_loss: 0.1585, label: 0, bag_size: 268
batch 79, loss: 1.8720, instance_loss: 0.6164, weighted_loss: 1.4953, label: 3, bag_size: 817
batch 99, loss: 1.7101, instance_loss: 0.5388, weighted_loss: 1.3587, label: 1, bag_size: 311
batch 119, loss: 2.1759, instance_loss: 0.6236, weighted_loss: 1.7102, label: 3, bag_size: 533
batch 139, loss: 1.6062, instance_loss: 0.5488, weighted_loss: 1.2890, label: 2, bag_size: 720
batch 159, loss: 1.4763, instance_loss: 0.5625, weighted_loss: 1.2021, label: 4, bag_size: 970
batch 179, loss: 1.1349, instance_loss: 0.4570, weighted_loss: 0.9315, label: 3, bag_size: 631
batch 199, loss: 0.9870, instance_loss: 0.4162, weighted_loss: 0.8158, label: 3, bag_size: 804
batch 219, loss: 1.0312, instance_loss: 0.5383, weighted_loss: 0.8833, label: 4, bag_size: 1018
batch 239, loss: 1.4348, instance_loss: 0.4721, weighted_loss: 1.1460, label: 1, bag_size: 591
batch 259, loss: 1.4984, instance_loss: 0.5133, weighted_loss: 1.2029, label: 3, bag_size: 369
batch 279, loss: 1.1643, instance_loss: 0.4829, weighted_loss: 0.9599, label: 3, bag_size: 323
batch 299, loss: 1.0896, instance_loss: 0.5080, weighted_loss: 0.9151, label: 3, bag_size: 398
batch 319, loss: 1.6202, instance_loss: 0.5081, weighted_loss: 1.2866, label: 1, bag_size: 616
batch 339, loss: 3.9197, instance_loss: 0.7826, weighted_loss: 2.9786, label: 0, bag_size: 421
batch 359, loss: 1.1996, instance_loss: 0.5786, weighted_loss: 1.0133, label: 4, bag_size: 780
batch 379, loss: 1.0149, instance_loss: 0.4600, weighted_loss: 0.8484, label: 1, bag_size: 748
batch 399, loss: 1.1157, instance_loss: 0.4723, weighted_loss: 0.9227, label: 1, bag_size: 332
batch 419, loss: 1.6499, instance_loss: 0.4898, weighted_loss: 1.3018, label: 3, bag_size: 274
batch 439, loss: 0.1108, instance_loss: 0.3031, weighted_loss: 0.1685, label: 0, bag_size: 355
batch 459, loss: 1.4665, instance_loss: 0.5771, weighted_loss: 1.1997, label: 3, bag_size: 795
batch 479, loss: 0.2889, instance_loss: 0.3405, weighted_loss: 0.3044, label: 0, bag_size: 33
batch 499, loss: 1.4410, instance_loss: 0.4814, weighted_loss: 1.1531, label: 3, bag_size: 856
batch 519, loss: 2.5545, instance_loss: 0.5567, weighted_loss: 1.9551, label: 2, bag_size: 864
batch 539, loss: 1.0871, instance_loss: 0.4731, weighted_loss: 0.9029, label: 1, bag_size: 748
batch 559, loss: 1.9216, instance_loss: 0.6088, weighted_loss: 1.5278, label: 3, bag_size: 1284
batch 579, loss: 1.0645, instance_loss: 0.5001, weighted_loss: 0.8952, label: 4, bag_size: 1351


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.05134680134680135: correct 244/4752
Epoch: 3, train_loss: 1.3411, train_clustering_loss:  0.4922, train_error: 0.6128
class 0: acc 0.7637795275590551, correct 97/127
class 1: acc 0.1864406779661017, correct 22/118
class 2: acc 0.23622047244094488, correct 30/127
class 3: acc 0.2920353982300885, correct 33/113
class 4: acc 0.44036697247706424, correct 48/109

Val Set, val_loss: 1.4635, val_error: 0.6216, auc: 0.6859
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.496813 --> 1.463500).  Saving model ...


batch 19, loss: 1.0157, instance_loss: 0.4471, weighted_loss: 0.8452, label: 4, bag_size: 438
batch 39, loss: 1.6616, instance_loss: 0.5123, weighted_loss: 1.3168, label: 0, bag_size: 316
batch 59, loss: 1.7985, instance_loss: 0.5407, weighted_loss: 1.4212, label: 1, bag_size: 599
batch 79, loss: 1.6262, instance_loss: 0.5768, weighted_loss: 1.3114, label: 1, bag_size: 408
batch 99, loss: 2.6748, instance_loss: 0.5500, weighted_loss: 2.0374, label: 4, bag_size: 438
batch 119, loss: 0.1232, instance_loss: 0.2255, weighted_loss: 0.1539, label: 0, bag_size: 268
batch 139, loss: 0.7194, instance_loss: 0.4428, weighted_loss: 0.6364, label: 4, bag_size: 506
batch 159, loss: 0.7051, instance_loss: 0.4064, weighted_loss: 0.6155, label: 4, bag_size: 639
batch 179, loss: 0.6593, instance_loss: 0.3962, weighted_loss: 0.5804, label: 0, bag_size: 552
batch 199, loss: 1.6068, instance_loss: 0.5397, weighted_loss: 1.2866, label: 1, bag_size: 525
batch 219, loss: 0.9089, instance_loss: 0.4244, weighted_loss: 0.7636, label: 4, bag_size: 318
batch 239, loss: 1.2738, instance_loss: 0.5050, weighted_loss: 1.0432, label: 2, bag_size: 375
batch 259, loss: 1.5307, instance_loss: 0.4764, weighted_loss: 1.2144, label: 1, bag_size: 1360
batch 279, loss: 0.2688, instance_loss: 0.2721, weighted_loss: 0.2698, label: 0, bag_size: 404
batch 299, loss: 1.4718, instance_loss: 0.5157, weighted_loss: 1.1850, label: 1, bag_size: 697
batch 319, loss: 2.0076, instance_loss: 0.5572, weighted_loss: 1.5725, label: 3, bag_size: 498
batch 339, loss: 1.3467, instance_loss: 0.5140, weighted_loss: 1.0969, label: 4, bag_size: 726
batch 359, loss: 1.5927, instance_loss: 0.5161, weighted_loss: 1.2697, label: 2, bag_size: 860
batch 379, loss: 1.9499, instance_loss: 0.5146, weighted_loss: 1.5193, label: 4, bag_size: 563
batch 399, loss: 1.4819, instance_loss: 0.5273, weighted_loss: 1.1955, label: 4, bag_size: 363
batch 419, loss: 1.2591, instance_loss: 0.4591, weighted_loss: 1.0191, label: 2, bag_size: 633
batch 439, loss: 1.4877, instance_loss: 0.5511, weighted_loss: 1.2067, label: 4, bag_size: 731
batch 459, loss: 0.7701, instance_loss: 0.4318, weighted_loss: 0.6686, label: 4, bag_size: 746
batch 479, loss: 1.2605, instance_loss: 0.5880, weighted_loss: 1.0587, label: 4, bag_size: 574
batch 499, loss: 1.1559, instance_loss: 0.4499, weighted_loss: 0.9441, label: 3, bag_size: 739
batch 519, loss: 1.8717, instance_loss: 0.5966, weighted_loss: 1.4891, label: 1, bag_size: 159
batch 539, loss: 1.3477, instance_loss: 0.4808, weighted_loss: 1.0877, label: 3, bag_size: 500
batch 559, loss: 1.3352, instance_loss: 0.5003, weighted_loss: 1.0848, label: 3, bag_size: 796
batch 579, loss: 1.8623, instance_loss: 0.5787, weighted_loss: 1.4772, label: 4, bag_size: 712


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.05787037037037037: correct 275/4752
Epoch: 4, train_loss: 1.3399, train_clustering_loss:  0.4908, train_error: 0.6010
class 0: acc 0.7583333333333333, correct 91/120
class 1: acc 0.05555555555555555, correct 6/108
class 2: acc 0.4485294117647059, correct 61/136
class 3: acc 0.1792452830188679, correct 19/106
class 4: acc 0.4838709677419355, correct 60/124

Val Set, val_loss: 1.5089, val_error: 0.5676, auc: 0.6853
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.1602, instance_loss: 0.7034, weighted_loss: 1.7232, label: 0, bag_size: 115
batch 39, loss: 0.9749, instance_loss: 0.4800, weighted_loss: 0.8265, label: 2, bag_size: 702
batch 59, loss: 0.2836, instance_loss: 0.4311, weighted_loss: 0.3278, label: 0, bag_size: 79
batch 79, loss: 1.3139, instance_loss: 0.4802, weighted_loss: 1.0638, label: 3, bag_size: 317
batch 99, loss: 1.8225, instance_loss: 0.6319, weighted_loss: 1.4653, label: 2, bag_size: 244
batch 119, loss: 1.1943, instance_loss: 0.4507, weighted_loss: 0.9712, label: 3, bag_size: 192
batch 139, loss: 1.7399, instance_loss: 0.5358, weighted_loss: 1.3787, label: 1, bag_size: 1121
batch 159, loss: 1.1088, instance_loss: 0.5216, weighted_loss: 0.9326, label: 3, bag_size: 344
batch 179, loss: 1.3339, instance_loss: 0.5139, weighted_loss: 1.0879, label: 1, bag_size: 460
batch 199, loss: 1.1535, instance_loss: 0.4815, weighted_loss: 0.9519, label: 2, bag_size: 299
batch 219, loss: 1.6708, instance_loss: 0.5417, weighted_loss: 1.3321, label: 2, bag_size: 321
batch 239, loss: 1.4880, instance_loss: 0.4827, weighted_loss: 1.1864, label: 2, bag_size: 598
batch 259, loss: 1.4104, instance_loss: 0.4993, weighted_loss: 1.1371, label: 1, bag_size: 159
batch 279, loss: 1.4964, instance_loss: 0.5349, weighted_loss: 1.2080, label: 1, bag_size: 526
batch 299, loss: 1.2839, instance_loss: 0.4477, weighted_loss: 1.0330, label: 2, bag_size: 799
batch 319, loss: 0.1474, instance_loss: 0.4092, weighted_loss: 0.2260, label: 0, bag_size: 281
batch 339, loss: 1.0414, instance_loss: 0.5050, weighted_loss: 0.8805, label: 2, bag_size: 708
batch 359, loss: 1.3174, instance_loss: 0.4757, weighted_loss: 1.0649, label: 2, bag_size: 554
batch 379, loss: 1.8732, instance_loss: 0.5656, weighted_loss: 1.4809, label: 3, bag_size: 598
batch 399, loss: 1.2783, instance_loss: 0.5918, weighted_loss: 1.0723, label: 4, bag_size: 730
batch 419, loss: 0.0541, instance_loss: 0.2784, weighted_loss: 0.1214, label: 0, bag_size: 51
batch 439, loss: 0.7691, instance_loss: 0.4710, weighted_loss: 0.6797, label: 4, bag_size: 744
batch 459, loss: 1.3367, instance_loss: 0.4946, weighted_loss: 1.0841, label: 4, bag_size: 714
batch 479, loss: 1.5911, instance_loss: 0.5163, weighted_loss: 1.2687, label: 2, bag_size: 582
batch 499, loss: 1.3035, instance_loss: 0.4704, weighted_loss: 1.0536, label: 1, bag_size: 355
batch 519, loss: 0.7106, instance_loss: 0.4329, weighted_loss: 0.6273, label: 1, bag_size: 748
batch 539, loss: 1.1073, instance_loss: 0.5200, weighted_loss: 0.9311, label: 4, bag_size: 238
batch 559, loss: 1.3648, instance_loss: 0.5295, weighted_loss: 1.1142, label: 2, bag_size: 1308
batch 579, loss: 1.8750, instance_loss: 0.5522, weighted_loss: 1.4782, label: 0, bag_size: 178


class 0 clustering acc 0.9971801346801347: correct 23693/23760
class 1 clustering acc 0.020202020202020204: correct 96/4752
Epoch: 5, train_loss: 1.3392, train_clustering_loss:  0.4999, train_error: 0.5943
class 0: acc 0.752, correct 94/125
class 1: acc 0.20833333333333334, correct 25/120
class 2: acc 0.3064516129032258, correct 38/124
class 3: acc 0.325, correct 39/120
class 4: acc 0.42857142857142855, correct 45/105

Val Set, val_loss: 1.4270, val_error: 0.6081, auc: 0.6915
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.463500 --> 1.427005).  Saving model ...


batch 19, loss: 1.9371, instance_loss: 0.5696, weighted_loss: 1.5268, label: 1, bag_size: 339
batch 39, loss: 0.4912, instance_loss: 0.4872, weighted_loss: 0.4900, label: 0, bag_size: 297
batch 59, loss: 1.4419, instance_loss: 0.5012, weighted_loss: 1.1597, label: 2, bag_size: 837
batch 79, loss: 1.3161, instance_loss: 0.5082, weighted_loss: 1.0738, label: 3, bag_size: 1147
batch 99, loss: 0.7913, instance_loss: 0.5675, weighted_loss: 0.7241, label: 4, bag_size: 683
batch 119, loss: 1.3983, instance_loss: 0.4615, weighted_loss: 1.1173, label: 1, bag_size: 829
batch 139, loss: 1.5246, instance_loss: 0.5805, weighted_loss: 1.2414, label: 0, bag_size: 578
batch 159, loss: 1.8207, instance_loss: 0.6265, weighted_loss: 1.4625, label: 2, bag_size: 769
batch 179, loss: 1.8420, instance_loss: 0.5766, weighted_loss: 1.4624, label: 3, bag_size: 796
batch 199, loss: 1.1233, instance_loss: 0.4701, weighted_loss: 0.9273, label: 2, bag_size: 812
batch 219, loss: 0.7969, instance_loss: 0.4412, weighted_loss: 0.6902, label: 0, bag_size: 1414
batch 239, loss: 1.2908, instance_loss: 0.4881, weighted_loss: 1.0500, label: 1, bag_size: 332
batch 259, loss: 0.2531, instance_loss: 0.4131, weighted_loss: 0.3011, label: 0, bag_size: 399
batch 279, loss: 2.1395, instance_loss: 0.6595, weighted_loss: 1.6955, label: 4, bag_size: 53
batch 299, loss: 1.5951, instance_loss: 0.6410, weighted_loss: 1.3088, label: 4, bag_size: 490
batch 319, loss: 1.7240, instance_loss: 0.4771, weighted_loss: 1.3499, label: 1, bag_size: 391
batch 339, loss: 0.2872, instance_loss: 0.3876, weighted_loss: 0.3173, label: 0, bag_size: 285
batch 359, loss: 0.7565, instance_loss: 0.4246, weighted_loss: 0.6570, label: 0, bag_size: 258
batch 379, loss: 1.0126, instance_loss: 0.4156, weighted_loss: 0.8335, label: 1, bag_size: 1103
batch 399, loss: 2.1024, instance_loss: 0.5933, weighted_loss: 1.6497, label: 3, bag_size: 897
batch 419, loss: 1.3232, instance_loss: 0.4957, weighted_loss: 1.0749, label: 3, bag_size: 727
batch 439, loss: 1.3148, instance_loss: 0.5208, weighted_loss: 1.0766, label: 4, bag_size: 689
batch 459, loss: 1.1037, instance_loss: 0.4887, weighted_loss: 0.9192, label: 2, bag_size: 633
batch 479, loss: 1.0083, instance_loss: 0.4852, weighted_loss: 0.8513, label: 2, bag_size: 614
batch 499, loss: 1.9066, instance_loss: 0.6153, weighted_loss: 1.5192, label: 1, bag_size: 607
batch 519, loss: 1.6907, instance_loss: 0.5667, weighted_loss: 1.3535, label: 2, bag_size: 394
batch 539, loss: 1.4084, instance_loss: 0.5207, weighted_loss: 1.1421, label: 4, bag_size: 652
batch 559, loss: 2.1224, instance_loss: 0.6280, weighted_loss: 1.6741, label: 3, bag_size: 533
batch 579, loss: 1.3595, instance_loss: 0.5002, weighted_loss: 1.1017, label: 3, bag_size: 398


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.01872895622895623: correct 89/4752
Epoch: 6, train_loss: 1.3110, train_clustering_loss:  0.4972, train_error: 0.5673
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.31896551724137934, correct 37/116
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.226890756302521, correct 27/119
class 4: acc 0.5206611570247934, correct 63/121

Val Set, val_loss: 1.4291, val_error: 0.6486, auc: 0.6950
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0537, instance_loss: 0.2830, weighted_loss: 0.1225, label: 0, bag_size: 74
batch 39, loss: 0.8257, instance_loss: 0.4271, weighted_loss: 0.7061, label: 3, bag_size: 631
batch 59, loss: 1.3279, instance_loss: 0.5288, weighted_loss: 1.0882, label: 3, bag_size: 830
batch 79, loss: 0.2900, instance_loss: 0.4497, weighted_loss: 0.3379, label: 0, bag_size: 517
batch 99, loss: 3.4729, instance_loss: 0.6247, weighted_loss: 2.6185, label: 4, bag_size: 264
batch 119, loss: 1.0188, instance_loss: 0.4618, weighted_loss: 0.8517, label: 1, bag_size: 328
batch 139, loss: 0.2678, instance_loss: 0.3659, weighted_loss: 0.2972, label: 0, bag_size: 98
batch 159, loss: 2.0433, instance_loss: 0.5232, weighted_loss: 1.5873, label: 1, bag_size: 564
batch 179, loss: 1.0871, instance_loss: 0.4663, weighted_loss: 0.9009, label: 2, bag_size: 702
batch 199, loss: 2.8669, instance_loss: 0.5832, weighted_loss: 2.1818, label: 2, bag_size: 219
batch 219, loss: 1.5473, instance_loss: 0.4522, weighted_loss: 1.2188, label: 3, bag_size: 1154
batch 239, loss: 0.3056, instance_loss: 0.3164, weighted_loss: 0.3088, label: 0, bag_size: 493
batch 259, loss: 0.9853, instance_loss: 0.4867, weighted_loss: 0.8357, label: 3, bag_size: 739
batch 279, loss: 1.0345, instance_loss: 0.4926, weighted_loss: 0.8719, label: 4, bag_size: 231
batch 299, loss: 2.7646, instance_loss: 0.6025, weighted_loss: 2.1159, label: 2, bag_size: 219
batch 319, loss: 1.0899, instance_loss: 0.4459, weighted_loss: 0.8967, label: 1, bag_size: 1360
batch 339, loss: 3.4151, instance_loss: 0.7950, weighted_loss: 2.6291, label: 0, bag_size: 273
batch 359, loss: 1.2255, instance_loss: 0.5298, weighted_loss: 1.0168, label: 2, bag_size: 390
batch 379, loss: 0.8639, instance_loss: 0.4918, weighted_loss: 0.7523, label: 4, bag_size: 446
batch 399, loss: 1.6710, instance_loss: 0.5263, weighted_loss: 1.3276, label: 4, bag_size: 356
batch 419, loss: 1.2164, instance_loss: 0.4628, weighted_loss: 0.9903, label: 2, bag_size: 867
batch 439, loss: 1.4406, instance_loss: 0.4690, weighted_loss: 1.1491, label: 2, bag_size: 906
batch 459, loss: 1.1416, instance_loss: 0.4352, weighted_loss: 0.9297, label: 3, bag_size: 351
batch 479, loss: 2.6902, instance_loss: 0.5997, weighted_loss: 2.0631, label: 1, bag_size: 564
batch 499, loss: 0.1156, instance_loss: 0.3458, weighted_loss: 0.1847, label: 0, bag_size: 97
batch 519, loss: 1.1350, instance_loss: 0.4913, weighted_loss: 0.9419, label: 1, bag_size: 1497
batch 539, loss: 1.0561, instance_loss: 0.4754, weighted_loss: 0.8819, label: 2, bag_size: 1010
batch 559, loss: 1.6551, instance_loss: 0.5921, weighted_loss: 1.3362, label: 4, bag_size: 196
batch 579, loss: 1.7340, instance_loss: 0.5124, weighted_loss: 1.3675, label: 2, bag_size: 717


class 0 clustering acc 0.998442760942761: correct 23723/23760
class 1 clustering acc 0.01872895622895623: correct 89/4752
Epoch: 7, train_loss: 1.3108, train_clustering_loss:  0.4924, train_error: 0.5623
class 0: acc 0.7821782178217822, correct 79/101
class 1: acc 0.12612612612612611, correct 14/111
class 2: acc 0.48120300751879697, correct 64/133
class 3: acc 0.40310077519379844, correct 52/129
class 4: acc 0.425, correct 51/120

Val Set, val_loss: 1.3715, val_error: 0.6351, auc: 0.7303
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.427005 --> 1.371504).  Saving model ...


batch 19, loss: 1.2209, instance_loss: 0.5092, weighted_loss: 1.0074, label: 4, bag_size: 689
batch 39, loss: 0.2660, instance_loss: 0.3243, weighted_loss: 0.2835, label: 0, bag_size: 69
batch 59, loss: 0.8316, instance_loss: 0.5635, weighted_loss: 0.7512, label: 4, bag_size: 541
batch 79, loss: 0.1202, instance_loss: 0.3265, weighted_loss: 0.1821, label: 0, bag_size: 159
batch 99, loss: 1.6039, instance_loss: 0.5097, weighted_loss: 1.2756, label: 1, bag_size: 413
batch 119, loss: 1.3074, instance_loss: 0.4359, weighted_loss: 1.0460, label: 3, bag_size: 369
batch 139, loss: 1.8078, instance_loss: 0.5589, weighted_loss: 1.4331, label: 4, bag_size: 53
batch 159, loss: 2.2615, instance_loss: 0.5362, weighted_loss: 1.7439, label: 2, bag_size: 421
batch 179, loss: 1.8137, instance_loss: 0.7642, weighted_loss: 1.4989, label: 2, bag_size: 337
batch 199, loss: 1.4682, instance_loss: 0.4606, weighted_loss: 1.1659, label: 1, bag_size: 460
batch 219, loss: 1.4478, instance_loss: 0.5393, weighted_loss: 1.1752, label: 1, bag_size: 339
batch 239, loss: 0.8857, instance_loss: 0.4716, weighted_loss: 0.7615, label: 4, bag_size: 780
batch 259, loss: 0.0324, instance_loss: 0.2411, weighted_loss: 0.0950, label: 0, bag_size: 234
batch 279, loss: 0.9926, instance_loss: 0.4310, weighted_loss: 0.8241, label: 3, bag_size: 797
batch 299, loss: 0.9711, instance_loss: 0.5035, weighted_loss: 0.8308, label: 3, bag_size: 102
batch 319, loss: 1.7013, instance_loss: 0.5141, weighted_loss: 1.3451, label: 4, bag_size: 854
batch 339, loss: 1.2765, instance_loss: 0.4997, weighted_loss: 1.0434, label: 1, bag_size: 509
batch 359, loss: 1.2033, instance_loss: 0.4412, weighted_loss: 0.9747, label: 0, bag_size: 283
batch 379, loss: 1.3414, instance_loss: 0.5558, weighted_loss: 1.1057, label: 4, bag_size: 1297
batch 399, loss: 1.0053, instance_loss: 0.4515, weighted_loss: 0.8391, label: 3, bag_size: 282
batch 419, loss: 0.6370, instance_loss: 0.4023, weighted_loss: 0.5666, label: 0, bag_size: 74
batch 439, loss: 1.7437, instance_loss: 0.5844, weighted_loss: 1.3959, label: 4, bag_size: 652
batch 459, loss: 1.6347, instance_loss: 0.5148, weighted_loss: 1.2987, label: 2, bag_size: 906
batch 479, loss: 0.9902, instance_loss: 0.4975, weighted_loss: 0.8424, label: 2, bag_size: 837
batch 499, loss: 0.0449, instance_loss: 0.2639, weighted_loss: 0.1106, label: 0, bag_size: 97
batch 519, loss: 1.1292, instance_loss: 0.4669, weighted_loss: 0.9305, label: 3, bag_size: 473
batch 539, loss: 2.6678, instance_loss: 0.6471, weighted_loss: 2.0616, label: 0, bag_size: 243
batch 559, loss: 1.5837, instance_loss: 0.5146, weighted_loss: 1.2630, label: 4, bag_size: 854
batch 579, loss: 1.1043, instance_loss: 0.4929, weighted_loss: 0.9209, label: 2, bag_size: 853


class 0 clustering acc 0.9943602693602693: correct 23626/23760
class 1 clustering acc 0.09301346801346802: correct 442/4752
Epoch: 8, train_loss: 1.2184, train_clustering_loss:  0.4722, train_error: 0.5488
class 0: acc 0.852760736196319, correct 139/163
class 1: acc 0.30833333333333335, correct 37/120
class 2: acc 0.1935483870967742, correct 18/93
class 3: acc 0.2982456140350877, correct 34/114
class 4: acc 0.38461538461538464, correct 40/104

Val Set, val_loss: 1.3615, val_error: 0.6081, auc: 0.7272
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.03885135135135135: correct 23/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.371504 --> 1.361546).  Saving model ...


batch 19, loss: 1.9696, instance_loss: 0.5408, weighted_loss: 1.5409, label: 2, bag_size: 713
batch 39, loss: 1.2605, instance_loss: 0.4846, weighted_loss: 1.0277, label: 1, bag_size: 500
batch 59, loss: 0.6094, instance_loss: 0.4915, weighted_loss: 0.5740, label: 0, bag_size: 416
batch 79, loss: 2.3256, instance_loss: 0.6489, weighted_loss: 1.8226, label: 2, bag_size: 219
batch 99, loss: 0.1385, instance_loss: 0.2675, weighted_loss: 0.1772, label: 0, bag_size: 63
batch 119, loss: 1.2765, instance_loss: 0.4224, weighted_loss: 1.0202, label: 1, bag_size: 829
batch 139, loss: 1.1863, instance_loss: 0.5056, weighted_loss: 0.9821, label: 4, bag_size: 277
batch 159, loss: 0.0330, instance_loss: 0.3873, weighted_loss: 0.1393, label: 0, bag_size: 340
batch 179, loss: 1.1472, instance_loss: 0.5203, weighted_loss: 0.9591, label: 4, bag_size: 853
batch 199, loss: 0.1625, instance_loss: 0.2341, weighted_loss: 0.1840, label: 0, bag_size: 97
batch 219, loss: 2.6269, instance_loss: 0.6582, weighted_loss: 2.0363, label: 4, bag_size: 110
batch 239, loss: 1.8853, instance_loss: 0.5170, weighted_loss: 1.4748, label: 2, bag_size: 351
batch 259, loss: 0.4666, instance_loss: 0.4459, weighted_loss: 0.4604, label: 0, bag_size: 613
batch 279, loss: 2.2067, instance_loss: 0.5778, weighted_loss: 1.7180, label: 4, bag_size: 592
batch 299, loss: 1.2743, instance_loss: 0.4966, weighted_loss: 1.0410, label: 2, bag_size: 119
batch 319, loss: 1.4248, instance_loss: 0.4834, weighted_loss: 1.1424, label: 4, bag_size: 366
batch 339, loss: 1.2630, instance_loss: 0.4938, weighted_loss: 1.0323, label: 4, bag_size: 986
batch 359, loss: 1.3947, instance_loss: 0.4990, weighted_loss: 1.1260, label: 2, bag_size: 135
batch 379, loss: 0.0983, instance_loss: 0.2719, weighted_loss: 0.1503, label: 0, bag_size: 141
batch 399, loss: 1.2680, instance_loss: 0.5170, weighted_loss: 1.0427, label: 3, bag_size: 192
batch 419, loss: 1.4194, instance_loss: 0.5235, weighted_loss: 1.1506, label: 4, bag_size: 970
batch 439, loss: 0.0682, instance_loss: 0.2401, weighted_loss: 0.1198, label: 0, bag_size: 74
batch 459, loss: 1.0420, instance_loss: 0.5546, weighted_loss: 0.8958, label: 2, bag_size: 616
batch 479, loss: 0.5483, instance_loss: 0.3892, weighted_loss: 0.5006, label: 4, bag_size: 948
batch 499, loss: 0.9305, instance_loss: 0.4289, weighted_loss: 0.7800, label: 1, bag_size: 981
batch 519, loss: 2.1171, instance_loss: 0.4900, weighted_loss: 1.6290, label: 4, bag_size: 886
batch 539, loss: 0.3304, instance_loss: 0.2976, weighted_loss: 0.3206, label: 0, bag_size: 573
batch 559, loss: 1.0548, instance_loss: 0.4621, weighted_loss: 0.8770, label: 3, bag_size: 351
batch 579, loss: 1.7342, instance_loss: 0.5638, weighted_loss: 1.3831, label: 4, bag_size: 312


class 0 clustering acc 0.9959175084175084: correct 23663/23760
class 1 clustering acc 0.061658249158249155: correct 293/4752
Epoch: 9, train_loss: 1.2785, train_clustering_loss:  0.4855, train_error: 0.5673
class 0: acc 0.7984496124031008, correct 103/129
class 1: acc 0.2909090909090909, correct 32/110
class 2: acc 0.3629032258064516, correct 45/124
class 3: acc 0.10784313725490197, correct 11/102
class 4: acc 0.5116279069767442, correct 66/129

Val Set, val_loss: 1.3601, val_error: 0.5405, auc: 0.7344
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.361546 --> 1.360124).  Saving model ...


batch 19, loss: 1.0764, instance_loss: 0.4512, weighted_loss: 0.8888, label: 1, bag_size: 814
batch 39, loss: 1.2965, instance_loss: 0.5377, weighted_loss: 1.0689, label: 3, bag_size: 804
batch 59, loss: 1.1049, instance_loss: 0.4477, weighted_loss: 0.9078, label: 3, bag_size: 393
batch 79, loss: 1.7345, instance_loss: 0.4809, weighted_loss: 1.3584, label: 3, bag_size: 230
batch 99, loss: 0.3048, instance_loss: 0.3213, weighted_loss: 0.3098, label: 0, bag_size: 397
batch 119, loss: 1.3880, instance_loss: 0.5294, weighted_loss: 1.1304, label: 2, bag_size: 543
batch 139, loss: 1.3451, instance_loss: 0.6852, weighted_loss: 1.1471, label: 3, bag_size: 856
batch 159, loss: 1.7182, instance_loss: 0.4694, weighted_loss: 1.3436, label: 2, bag_size: 535
batch 179, loss: 1.8218, instance_loss: 0.5892, weighted_loss: 1.4520, label: 4, bag_size: 293
batch 199, loss: 1.5244, instance_loss: 0.4581, weighted_loss: 1.2045, label: 2, bag_size: 549
batch 219, loss: 1.3450, instance_loss: 0.5053, weighted_loss: 1.0931, label: 4, bag_size: 277
batch 239, loss: 0.8141, instance_loss: 0.5135, weighted_loss: 0.7239, label: 4, bag_size: 727
batch 259, loss: 1.2132, instance_loss: 0.5255, weighted_loss: 1.0069, label: 1, bag_size: 371
batch 279, loss: 0.2484, instance_loss: 0.3654, weighted_loss: 0.2835, label: 0, bag_size: 74
batch 299, loss: 1.1712, instance_loss: 0.4981, weighted_loss: 0.9693, label: 2, bag_size: 317
batch 319, loss: 0.8222, instance_loss: 0.4267, weighted_loss: 0.7036, label: 1, bag_size: 410
batch 339, loss: 1.0508, instance_loss: 0.4899, weighted_loss: 0.8825, label: 4, bag_size: 468
batch 359, loss: 1.7161, instance_loss: 0.4849, weighted_loss: 1.3467, label: 1, bag_size: 764
batch 379, loss: 1.8188, instance_loss: 0.5011, weighted_loss: 1.4235, label: 4, bag_size: 176
batch 399, loss: 2.4484, instance_loss: 0.6300, weighted_loss: 1.9029, label: 4, bag_size: 270
batch 419, loss: 0.0708, instance_loss: 0.7280, weighted_loss: 0.2679, label: 0, bag_size: 1570
batch 439, loss: 1.1937, instance_loss: 0.5129, weighted_loss: 0.9895, label: 4, bag_size: 541
batch 459, loss: 1.9321, instance_loss: 0.5411, weighted_loss: 1.5148, label: 4, bag_size: 110
batch 479, loss: 0.3384, instance_loss: 0.4099, weighted_loss: 0.3599, label: 4, bag_size: 746
batch 499, loss: 0.9643, instance_loss: 0.4891, weighted_loss: 0.8217, label: 2, bag_size: 410
batch 519, loss: 1.2983, instance_loss: 0.4481, weighted_loss: 1.0432, label: 1, bag_size: 618
batch 539, loss: 0.0153, instance_loss: 0.1627, weighted_loss: 0.0595, label: 0, bag_size: 80
batch 559, loss: 1.1874, instance_loss: 0.4369, weighted_loss: 0.9622, label: 2, bag_size: 799
batch 579, loss: 3.0096, instance_loss: 0.6596, weighted_loss: 2.3046, label: 4, bag_size: 333


class 0 clustering acc 0.9951599326599326: correct 23645/23760
class 1 clustering acc 0.0763888888888889: correct 363/4752
Epoch: 10, train_loss: 1.2404, train_clustering_loss:  0.4842, train_error: 0.5471
class 0: acc 0.8181818181818182, correct 99/121
class 1: acc 0.42063492063492064, correct 53/126
class 2: acc 0.2892561983471074, correct 35/121
class 3: acc 0.3, correct 33/110
class 4: acc 0.4224137931034483, correct 49/116

Val Set, val_loss: 1.3514, val_error: 0.5946, auc: 0.7370
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.360124 --> 1.351441).  Saving model ...


batch 19, loss: 0.8106, instance_loss: 0.4465, weighted_loss: 0.7014, label: 2, bag_size: 567
batch 39, loss: 2.3387, instance_loss: 0.4976, weighted_loss: 1.7864, label: 0, bag_size: 600
batch 59, loss: 1.4647, instance_loss: 0.5438, weighted_loss: 1.1884, label: 4, bag_size: 1351
batch 79, loss: 2.5005, instance_loss: 0.5742, weighted_loss: 1.9226, label: 3, bag_size: 166
batch 99, loss: 2.7316, instance_loss: 0.6511, weighted_loss: 2.1075, label: 0, bag_size: 888
batch 119, loss: 0.7928, instance_loss: 0.4371, weighted_loss: 0.6861, label: 4, bag_size: 780
batch 139, loss: 1.1401, instance_loss: 0.4596, weighted_loss: 0.9360, label: 0, bag_size: 1414
batch 159, loss: 2.4813, instance_loss: 0.5629, weighted_loss: 1.9058, label: 4, bag_size: 333
batch 179, loss: 1.8534, instance_loss: 0.5901, weighted_loss: 1.4745, label: 2, bag_size: 321
batch 199, loss: 2.5019, instance_loss: 0.6986, weighted_loss: 1.9609, label: 2, bag_size: 219
batch 219, loss: 1.3427, instance_loss: 0.4990, weighted_loss: 1.0896, label: 4, bag_size: 438
batch 239, loss: 1.4813, instance_loss: 0.5424, weighted_loss: 1.1996, label: 3, bag_size: 796
batch 259, loss: 1.1367, instance_loss: 0.4587, weighted_loss: 0.9333, label: 1, bag_size: 233
batch 279, loss: 1.1615, instance_loss: 0.5241, weighted_loss: 0.9703, label: 4, bag_size: 604
batch 299, loss: 1.1908, instance_loss: 0.5517, weighted_loss: 0.9991, label: 4, bag_size: 438
batch 319, loss: 1.1947, instance_loss: 0.5095, weighted_loss: 0.9891, label: 1, bag_size: 672
batch 339, loss: 1.4077, instance_loss: 0.4733, weighted_loss: 1.1274, label: 3, bag_size: 423
batch 359, loss: 1.1173, instance_loss: 0.5398, weighted_loss: 0.9441, label: 2, bag_size: 410
batch 379, loss: 0.1235, instance_loss: 0.2912, weighted_loss: 0.1738, label: 0, bag_size: 523
batch 399, loss: 1.4976, instance_loss: 0.5300, weighted_loss: 1.2073, label: 1, bag_size: 372
batch 419, loss: 2.0227, instance_loss: 0.5952, weighted_loss: 1.5944, label: 2, bag_size: 1013
batch 439, loss: 0.9305, instance_loss: 0.4828, weighted_loss: 0.7962, label: 1, bag_size: 1103
batch 459, loss: 0.6901, instance_loss: 0.4617, weighted_loss: 0.6216, label: 4, bag_size: 895
batch 479, loss: 0.6377, instance_loss: 0.4244, weighted_loss: 0.5737, label: 4, bag_size: 744
batch 499, loss: 0.8584, instance_loss: 0.4664, weighted_loss: 0.7408, label: 2, bag_size: 348
batch 519, loss: 0.7648, instance_loss: 0.4575, weighted_loss: 0.6726, label: 0, bag_size: 79
batch 539, loss: 1.3234, instance_loss: 0.5271, weighted_loss: 1.0845, label: 3, bag_size: 344
batch 559, loss: 1.0417, instance_loss: 0.5152, weighted_loss: 0.8838, label: 3, bag_size: 473
batch 579, loss: 1.3741, instance_loss: 0.4407, weighted_loss: 1.0941, label: 1, bag_size: 1009


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.0242003367003367: correct 115/4752
Epoch: 11, train_loss: 1.2862, train_clustering_loss:  0.4939, train_error: 0.5657
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.2796610169491525, correct 33/118
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.44525547445255476, correct 61/137
class 4: acc 0.424, correct 53/125

Val Set, val_loss: 1.4093, val_error: 0.6486, auc: 0.7504
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9161, instance_loss: 0.5494, weighted_loss: 1.5061, label: 1, bag_size: 599
batch 39, loss: 0.8548, instance_loss: 0.4998, weighted_loss: 0.7483, label: 2, bag_size: 554
batch 59, loss: 2.6545, instance_loss: 0.5939, weighted_loss: 2.0363, label: 4, bag_size: 399
batch 79, loss: 1.4303, instance_loss: 0.5187, weighted_loss: 1.1568, label: 4, bag_size: 363
batch 99, loss: 1.1411, instance_loss: 0.4665, weighted_loss: 0.9387, label: 3, bag_size: 1365
batch 119, loss: 1.8152, instance_loss: 0.5061, weighted_loss: 1.4225, label: 2, bag_size: 738
batch 139, loss: 1.4052, instance_loss: 0.5557, weighted_loss: 1.1504, label: 3, bag_size: 500
batch 159, loss: 0.8526, instance_loss: 0.4390, weighted_loss: 0.7285, label: 3, bag_size: 498
batch 179, loss: 1.2000, instance_loss: 0.4854, weighted_loss: 0.9856, label: 2, bag_size: 702
batch 199, loss: 0.9391, instance_loss: 0.4374, weighted_loss: 0.7886, label: 1, bag_size: 483
batch 219, loss: 1.8057, instance_loss: 0.5288, weighted_loss: 1.4227, label: 2, bag_size: 606
batch 239, loss: 1.0212, instance_loss: 0.4591, weighted_loss: 0.8525, label: 1, bag_size: 329
batch 259, loss: 0.4815, instance_loss: 0.4754, weighted_loss: 0.4797, label: 4, bag_size: 895
batch 279, loss: 1.7569, instance_loss: 0.5806, weighted_loss: 1.4040, label: 4, bag_size: 482
batch 299, loss: 0.6830, instance_loss: 0.4391, weighted_loss: 0.6098, label: 0, bag_size: 269
batch 319, loss: 0.8152, instance_loss: 0.4593, weighted_loss: 0.7084, label: 3, bag_size: 230
batch 339, loss: 1.7768, instance_loss: 0.5639, weighted_loss: 1.4129, label: 3, bag_size: 533
batch 359, loss: 1.1010, instance_loss: 0.4183, weighted_loss: 0.8962, label: 3, bag_size: 746
batch 379, loss: 2.1451, instance_loss: 0.5812, weighted_loss: 1.6759, label: 4, bag_size: 547
batch 399, loss: 1.0603, instance_loss: 0.4470, weighted_loss: 0.8763, label: 1, bag_size: 748
batch 419, loss: 0.7983, instance_loss: 0.4826, weighted_loss: 0.7036, label: 4, bag_size: 1041
batch 439, loss: 0.4544, instance_loss: 0.4660, weighted_loss: 0.4579, label: 4, bag_size: 773
batch 459, loss: 1.9033, instance_loss: 0.5413, weighted_loss: 1.4947, label: 2, bag_size: 909
batch 479, loss: 0.9059, instance_loss: 0.4388, weighted_loss: 0.7658, label: 2, bag_size: 598
batch 499, loss: 1.4175, instance_loss: 0.5616, weighted_loss: 1.1607, label: 4, bag_size: 986
batch 519, loss: 1.3900, instance_loss: 0.4844, weighted_loss: 1.1183, label: 3, bag_size: 1076
batch 539, loss: 1.0796, instance_loss: 0.4443, weighted_loss: 0.8890, label: 1, bag_size: 1273
batch 559, loss: 1.0012, instance_loss: 0.4591, weighted_loss: 0.8385, label: 2, bag_size: 812
batch 579, loss: 0.4998, instance_loss: 0.3711, weighted_loss: 0.4612, label: 0, bag_size: 281


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.03851010101010101: correct 183/4752
Epoch: 12, train_loss: 1.2667, train_clustering_loss:  0.4863, train_error: 0.5825
class 0: acc 0.7403846153846154, correct 77/104
class 1: acc 0.2846153846153846, correct 37/130
class 2: acc 0.2890625, correct 37/128
class 3: acc 0.4961832061068702, correct 65/131
class 4: acc 0.31683168316831684, correct 32/101

Val Set, val_loss: 1.3855, val_error: 0.5541, auc: 0.7322
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8833, instance_loss: 0.4414, weighted_loss: 0.7508, label: 2, bag_size: 285
batch 39, loss: 0.9900, instance_loss: 0.4683, weighted_loss: 0.8335, label: 1, bag_size: 981
batch 59, loss: 1.4195, instance_loss: 0.5006, weighted_loss: 1.1438, label: 3, bag_size: 431
batch 79, loss: 0.0194, instance_loss: 0.1461, weighted_loss: 0.0574, label: 0, bag_size: 221
batch 99, loss: 1.5335, instance_loss: 0.5003, weighted_loss: 1.2236, label: 2, bag_size: 321
batch 119, loss: 1.9236, instance_loss: 0.4985, weighted_loss: 1.4961, label: 1, bag_size: 391
batch 139, loss: 0.9864, instance_loss: 0.4344, weighted_loss: 0.8208, label: 3, bag_size: 309
batch 159, loss: 0.7446, instance_loss: 0.6351, weighted_loss: 0.7117, label: 0, bag_size: 317
batch 179, loss: 0.0561, instance_loss: 0.2287, weighted_loss: 0.1079, label: 0, bag_size: 49
batch 199, loss: 0.3801, instance_loss: 0.4434, weighted_loss: 0.3991, label: 4, bag_size: 665
batch 219, loss: 1.4603, instance_loss: 0.4752, weighted_loss: 1.1648, label: 2, bag_size: 404
batch 239, loss: 0.4664, instance_loss: 0.4305, weighted_loss: 0.4556, label: 4, bag_size: 895
batch 259, loss: 1.2861, instance_loss: 0.4698, weighted_loss: 1.0412, label: 1, bag_size: 1013
batch 279, loss: 2.2070, instance_loss: 0.5924, weighted_loss: 1.7226, label: 0, bag_size: 710
batch 299, loss: 1.3464, instance_loss: 0.5068, weighted_loss: 1.0945, label: 1, bag_size: 697
batch 319, loss: 0.3706, instance_loss: 0.3863, weighted_loss: 0.3753, label: 4, bag_size: 948
batch 339, loss: 0.7088, instance_loss: 0.4362, weighted_loss: 0.6270, label: 2, bag_size: 613
batch 359, loss: 0.2238, instance_loss: 0.3770, weighted_loss: 0.2697, label: 4, bag_size: 725
batch 379, loss: 1.3804, instance_loss: 0.5135, weighted_loss: 1.1203, label: 4, bag_size: 1297
batch 399, loss: 1.1311, instance_loss: 0.6489, weighted_loss: 0.9864, label: 2, bag_size: 105
batch 419, loss: 1.1970, instance_loss: 0.4652, weighted_loss: 0.9774, label: 2, bag_size: 339
batch 439, loss: 1.1333, instance_loss: 0.4880, weighted_loss: 0.9397, label: 3, bag_size: 317
batch 459, loss: 0.8486, instance_loss: 0.4798, weighted_loss: 0.7380, label: 0, bag_size: 218
batch 479, loss: 1.3776, instance_loss: 0.5398, weighted_loss: 1.1263, label: 4, bag_size: 685
batch 499, loss: 0.6964, instance_loss: 0.4663, weighted_loss: 0.6274, label: 4, bag_size: 744
batch 519, loss: 0.9794, instance_loss: 0.4676, weighted_loss: 0.8259, label: 2, bag_size: 567
batch 539, loss: 3.2940, instance_loss: 0.6974, weighted_loss: 2.5150, label: 0, bag_size: 888
batch 559, loss: 0.9099, instance_loss: 0.4675, weighted_loss: 0.7772, label: 3, bag_size: 473
batch 579, loss: 0.8245, instance_loss: 0.4464, weighted_loss: 0.7111, label: 4, bag_size: 729


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.04398148148148148: correct 209/4752
Epoch: 13, train_loss: 1.2218, train_clustering_loss:  0.4826, train_error: 0.5370
class 0: acc 0.7798165137614679, correct 85/109
class 1: acc 0.17, correct 17/100
class 2: acc 0.44274809160305345, correct 58/131
class 3: acc 0.41732283464566927, correct 53/127
class 4: acc 0.4881889763779528, correct 62/127

Val Set, val_loss: 1.3848, val_error: 0.5676, auc: 0.7327
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5242, instance_loss: 0.5381, weighted_loss: 1.2284, label: 1, bag_size: 233
batch 39, loss: 1.8105, instance_loss: 0.5396, weighted_loss: 1.4292, label: 4, bag_size: 318
batch 59, loss: 0.1034, instance_loss: 0.2213, weighted_loss: 0.1387, label: 0, bag_size: 156
batch 79, loss: 0.9798, instance_loss: 0.4468, weighted_loss: 0.8199, label: 1, bag_size: 840
batch 99, loss: 0.3002, instance_loss: 0.3685, weighted_loss: 0.3207, label: 0, bag_size: 141
batch 119, loss: 0.8840, instance_loss: 0.4551, weighted_loss: 0.7554, label: 0, bag_size: 295
batch 139, loss: 0.8994, instance_loss: 0.4734, weighted_loss: 0.7716, label: 3, bag_size: 739
batch 159, loss: 1.6312, instance_loss: 0.5036, weighted_loss: 1.2930, label: 3, bag_size: 996
batch 179, loss: 0.0437, instance_loss: 0.2870, weighted_loss: 0.1167, label: 0, bag_size: 533
batch 199, loss: 1.0173, instance_loss: 0.5119, weighted_loss: 0.8657, label: 3, bag_size: 1284
batch 219, loss: 0.7043, instance_loss: 0.4844, weighted_loss: 0.6383, label: 3, bag_size: 476
batch 239, loss: 1.0702, instance_loss: 0.4889, weighted_loss: 0.8958, label: 3, bag_size: 431
batch 259, loss: 1.1285, instance_loss: 0.4147, weighted_loss: 0.9144, label: 1, bag_size: 1013
batch 279, loss: 2.5067, instance_loss: 0.7401, weighted_loss: 1.9767, label: 2, bag_size: 549
batch 299, loss: 1.7501, instance_loss: 0.5951, weighted_loss: 1.4036, label: 2, bag_size: 177
batch 319, loss: 1.3165, instance_loss: 0.5365, weighted_loss: 1.0825, label: 2, bag_size: 445
batch 339, loss: 1.6660, instance_loss: 0.5485, weighted_loss: 1.3307, label: 4, bag_size: 176
batch 359, loss: 1.1018, instance_loss: 0.4688, weighted_loss: 0.9119, label: 1, bag_size: 355
batch 379, loss: 1.4883, instance_loss: 0.5184, weighted_loss: 1.1973, label: 4, bag_size: 944
batch 399, loss: 0.0977, instance_loss: 0.3004, weighted_loss: 0.1585, label: 0, bag_size: 285
batch 419, loss: 0.8215, instance_loss: 0.4547, weighted_loss: 0.7115, label: 3, bag_size: 510
batch 439, loss: 0.1884, instance_loss: 0.2762, weighted_loss: 0.2148, label: 0, bag_size: 79
batch 459, loss: 2.3276, instance_loss: 0.5549, weighted_loss: 1.7958, label: 2, bag_size: 1122
batch 479, loss: 2.6536, instance_loss: 0.6557, weighted_loss: 2.0542, label: 3, bag_size: 282
batch 499, loss: 0.2117, instance_loss: 0.3005, weighted_loss: 0.2384, label: 0, bag_size: 234
batch 519, loss: 0.5850, instance_loss: 0.4121, weighted_loss: 0.5331, label: 1, bag_size: 490
batch 539, loss: 0.5914, instance_loss: 0.5302, weighted_loss: 0.5730, label: 0, bag_size: 306
batch 559, loss: 1.2632, instance_loss: 0.4816, weighted_loss: 1.0287, label: 2, bag_size: 645
batch 579, loss: 1.3595, instance_loss: 0.5591, weighted_loss: 1.1194, label: 3, bag_size: 235


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.06986531986531987: correct 332/4752
Epoch: 14, train_loss: 1.2243, train_clustering_loss:  0.4712, train_error: 0.5320
class 0: acc 0.8548387096774194, correct 106/124
class 1: acc 0.4573643410852713, correct 59/129
class 2: acc 0.21818181818181817, correct 24/110
class 3: acc 0.3090909090909091, correct 34/110
class 4: acc 0.45454545454545453, correct 55/121

Val Set, val_loss: 1.3760, val_error: 0.5811, auc: 0.7379
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.5731, instance_loss: 0.5206, weighted_loss: 1.2574, label: 1, bag_size: 159
batch 39, loss: 1.0499, instance_loss: 0.4787, weighted_loss: 0.8786, label: 3, bag_size: 1284
batch 59, loss: 0.9168, instance_loss: 0.4896, weighted_loss: 0.7887, label: 0, bag_size: 710
batch 79, loss: 1.4227, instance_loss: 0.5445, weighted_loss: 1.1592, label: 4, bag_size: 970
batch 99, loss: 1.3860, instance_loss: 0.4864, weighted_loss: 1.1161, label: 1, bag_size: 851
batch 119, loss: 0.7495, instance_loss: 0.4242, weighted_loss: 0.6519, label: 2, bag_size: 613
batch 139, loss: 1.7645, instance_loss: 0.5710, weighted_loss: 1.4064, label: 3, bag_size: 457
batch 159, loss: 1.7928, instance_loss: 0.5397, weighted_loss: 1.4169, label: 4, bag_size: 572
batch 179, loss: 0.5648, instance_loss: 0.4846, weighted_loss: 0.5407, label: 4, bag_size: 948
batch 199, loss: 1.0870, instance_loss: 0.5112, weighted_loss: 0.9142, label: 3, bag_size: 476
batch 219, loss: 1.3277, instance_loss: 0.4762, weighted_loss: 1.0722, label: 3, bag_size: 1328
batch 239, loss: 0.1901, instance_loss: 0.2896, weighted_loss: 0.2200, label: 0, bag_size: 280
batch 259, loss: 0.9531, instance_loss: 0.4470, weighted_loss: 0.8013, label: 2, bag_size: 1079
batch 279, loss: 0.2762, instance_loss: 0.2321, weighted_loss: 0.2630, label: 0, bag_size: 366
batch 299, loss: 1.0030, instance_loss: 0.4431, weighted_loss: 0.8350, label: 3, bag_size: 258
batch 319, loss: 0.3056, instance_loss: 0.3028, weighted_loss: 0.3048, label: 0, bag_size: 404
batch 339, loss: 1.0750, instance_loss: 0.4883, weighted_loss: 0.8990, label: 2, bag_size: 590
batch 359, loss: 2.6009, instance_loss: 0.4232, weighted_loss: 1.9476, label: 3, bag_size: 194
batch 379, loss: 0.0304, instance_loss: 0.2865, weighted_loss: 0.1072, label: 0, bag_size: 533
batch 399, loss: 1.2533, instance_loss: 0.4872, weighted_loss: 1.0234, label: 3, bag_size: 423
batch 419, loss: 2.2658, instance_loss: 0.5472, weighted_loss: 1.7502, label: 4, bag_size: 407
batch 439, loss: 1.0129, instance_loss: 0.4385, weighted_loss: 0.8406, label: 2, bag_size: 445
batch 459, loss: 0.6298, instance_loss: 0.4392, weighted_loss: 0.5726, label: 2, bag_size: 208
batch 479, loss: 0.1766, instance_loss: 0.2206, weighted_loss: 0.1898, label: 0, bag_size: 192
batch 499, loss: 0.3746, instance_loss: 0.3236, weighted_loss: 0.3593, label: 0, bag_size: 210
batch 519, loss: 0.6146, instance_loss: 0.4360, weighted_loss: 0.5610, label: 0, bag_size: 477
batch 539, loss: 0.5191, instance_loss: 0.4198, weighted_loss: 0.4893, label: 4, bag_size: 627
batch 559, loss: 2.1536, instance_loss: 0.6113, weighted_loss: 1.6909, label: 4, bag_size: 333
batch 579, loss: 1.0344, instance_loss: 0.4673, weighted_loss: 0.8643, label: 1, bag_size: 660


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.07133838383838384: correct 339/4752
Epoch: 15, train_loss: 1.1818, train_clustering_loss:  0.4730, train_error: 0.5135
class 0: acc 0.8396946564885496, correct 110/131
class 1: acc 0.23148148148148148, correct 25/108
class 2: acc 0.421875, correct 54/128
class 3: acc 0.3963963963963964, correct 44/111
class 4: acc 0.4827586206896552, correct 56/116

Val Set, val_loss: 1.3164, val_error: 0.5135, auc: 0.7559
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.351441 --> 1.316388).  Saving model ...


batch 19, loss: 1.1626, instance_loss: 0.4850, weighted_loss: 0.9594, label: 2, bag_size: 135
batch 39, loss: 0.6158, instance_loss: 0.4093, weighted_loss: 0.5538, label: 2, bag_size: 633
batch 59, loss: 0.3815, instance_loss: 0.3712, weighted_loss: 0.3784, label: 0, bag_size: 77
batch 79, loss: 0.8813, instance_loss: 0.4221, weighted_loss: 0.7435, label: 2, bag_size: 1197
batch 99, loss: 1.0172, instance_loss: 0.4475, weighted_loss: 0.8463, label: 3, bag_size: 309
batch 119, loss: 1.3548, instance_loss: 0.5781, weighted_loss: 1.1218, label: 3, bag_size: 641
batch 139, loss: 2.4811, instance_loss: 0.5752, weighted_loss: 1.9093, label: 2, bag_size: 219
batch 159, loss: 0.9639, instance_loss: 0.4241, weighted_loss: 0.8020, label: 1, bag_size: 500
batch 179, loss: 0.4623, instance_loss: 0.4340, weighted_loss: 0.4538, label: 0, bag_size: 383
batch 199, loss: 1.1732, instance_loss: 0.5009, weighted_loss: 0.9715, label: 4, bag_size: 72
batch 219, loss: 0.9586, instance_loss: 0.5525, weighted_loss: 0.8368, label: 4, bag_size: 854
batch 239, loss: 1.0663, instance_loss: 0.4771, weighted_loss: 0.8895, label: 2, bag_size: 702
batch 259, loss: 2.4226, instance_loss: 0.4857, weighted_loss: 1.8415, label: 0, bag_size: 600
batch 279, loss: 0.0607, instance_loss: 0.1575, weighted_loss: 0.0897, label: 0, bag_size: 513
batch 299, loss: 1.5720, instance_loss: 0.5473, weighted_loss: 1.2646, label: 1, bag_size: 321
batch 319, loss: 0.3810, instance_loss: 0.3482, weighted_loss: 0.3712, label: 0, bag_size: 223
batch 339, loss: 0.7277, instance_loss: 0.4069, weighted_loss: 0.6315, label: 3, bag_size: 556
batch 359, loss: 1.8121, instance_loss: 0.5023, weighted_loss: 1.4191, label: 3, bag_size: 300
batch 379, loss: 0.8442, instance_loss: 0.5196, weighted_loss: 0.7468, label: 4, bag_size: 797
batch 399, loss: 0.0505, instance_loss: 0.2324, weighted_loss: 0.1050, label: 0, bag_size: 70
batch 419, loss: 0.4437, instance_loss: 0.4003, weighted_loss: 0.4307, label: 0, bag_size: 552
batch 439, loss: 2.0633, instance_loss: 0.5487, weighted_loss: 1.6089, label: 3, bag_size: 323
batch 459, loss: 1.1476, instance_loss: 0.4743, weighted_loss: 0.9456, label: 1, bag_size: 389
batch 479, loss: 0.0537, instance_loss: 0.1960, weighted_loss: 0.0964, label: 0, bag_size: 357
batch 499, loss: 0.5856, instance_loss: 0.3483, weighted_loss: 0.5144, label: 0, bag_size: 231
batch 519, loss: 1.2714, instance_loss: 0.5939, weighted_loss: 1.0682, label: 2, bag_size: 315
batch 539, loss: 0.1814, instance_loss: 0.2989, weighted_loss: 0.2166, label: 0, bag_size: 63
batch 559, loss: 2.6833, instance_loss: 0.6530, weighted_loss: 2.0742, label: 2, bag_size: 754
batch 579, loss: 1.4274, instance_loss: 0.5063, weighted_loss: 1.1511, label: 2, bag_size: 627


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.0765993265993266: correct 364/4752
Epoch: 16, train_loss: 1.1717, train_clustering_loss:  0.4681, train_error: 0.4899
class 0: acc 0.8529411764705882, correct 116/136
class 1: acc 0.48333333333333334, correct 58/120
class 2: acc 0.27586206896551724, correct 32/116
class 3: acc 0.4, correct 46/115
class 4: acc 0.4766355140186916, correct 51/107

Val Set, val_loss: 1.4048, val_error: 0.6351, auc: 0.7278
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3708, instance_loss: 0.4002, weighted_loss: 0.3796, label: 0, bag_size: 306
batch 39, loss: 0.9821, instance_loss: 0.4770, weighted_loss: 0.8306, label: 3, bag_size: 899
batch 59, loss: 0.7044, instance_loss: 0.4927, weighted_loss: 0.6409, label: 3, bag_size: 344
batch 79, loss: 0.7994, instance_loss: 0.4756, weighted_loss: 0.7023, label: 3, bag_size: 603
batch 99, loss: 1.0844, instance_loss: 0.4417, weighted_loss: 0.8916, label: 2, bag_size: 1010
batch 119, loss: 1.3997, instance_loss: 0.4901, weighted_loss: 1.1268, label: 1, bag_size: 829
batch 139, loss: 2.0689, instance_loss: 0.5515, weighted_loss: 1.6137, label: 2, bag_size: 407
batch 159, loss: 1.0299, instance_loss: 0.4507, weighted_loss: 0.8561, label: 2, bag_size: 617
batch 179, loss: 1.2790, instance_loss: 0.5032, weighted_loss: 1.0463, label: 1, bag_size: 697
batch 199, loss: 0.3367, instance_loss: 0.3145, weighted_loss: 0.3300, label: 4, bag_size: 1018
batch 219, loss: 0.0492, instance_loss: 0.2163, weighted_loss: 0.0993, label: 0, bag_size: 71
batch 239, loss: 1.0104, instance_loss: 0.5057, weighted_loss: 0.8590, label: 4, bag_size: 986
batch 259, loss: 1.1165, instance_loss: 0.5207, weighted_loss: 0.9378, label: 1, bag_size: 461
batch 279, loss: 1.6238, instance_loss: 0.4782, weighted_loss: 1.2801, label: 2, bag_size: 627
batch 299, loss: 1.7580, instance_loss: 0.4552, weighted_loss: 1.3671, label: 2, bag_size: 720
batch 319, loss: 1.1518, instance_loss: 0.5224, weighted_loss: 0.9630, label: 3, bag_size: 154
batch 339, loss: 1.3668, instance_loss: 0.5149, weighted_loss: 1.1113, label: 3, bag_size: 1078
batch 359, loss: 1.8773, instance_loss: 0.5730, weighted_loss: 1.4860, label: 3, bag_size: 796
batch 379, loss: 0.4895, instance_loss: 0.4945, weighted_loss: 0.4910, label: 4, bag_size: 725
batch 399, loss: 1.2533, instance_loss: 0.5175, weighted_loss: 1.0326, label: 3, bag_size: 457
batch 419, loss: 3.5731, instance_loss: 0.9750, weighted_loss: 2.7936, label: 1, bag_size: 45
batch 439, loss: 1.0024, instance_loss: 0.4392, weighted_loss: 0.8334, label: 4, bag_size: 418
batch 459, loss: 0.9743, instance_loss: 0.4496, weighted_loss: 0.8169, label: 3, bag_size: 393
batch 479, loss: 2.0640, instance_loss: 0.6251, weighted_loss: 1.6323, label: 4, bag_size: 490
batch 499, loss: 1.1523, instance_loss: 0.5044, weighted_loss: 0.9579, label: 2, bag_size: 614
batch 519, loss: 1.1886, instance_loss: 0.6124, weighted_loss: 1.0158, label: 1, bag_size: 617
batch 539, loss: 0.9213, instance_loss: 0.4857, weighted_loss: 0.7907, label: 2, bag_size: 590
batch 559, loss: 0.8570, instance_loss: 0.4518, weighted_loss: 0.7354, label: 3, bag_size: 274
batch 579, loss: 0.9999, instance_loss: 0.5230, weighted_loss: 0.8568, label: 2, bag_size: 633


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.057028619528619526: correct 271/4752
Epoch: 17, train_loss: 1.1887, train_clustering_loss:  0.4804, train_error: 0.5118
class 0: acc 0.8376068376068376, correct 98/117
class 1: acc 0.3181818181818182, correct 35/110
class 2: acc 0.3816793893129771, correct 50/131
class 3: acc 0.4603174603174603, correct 58/126
class 4: acc 0.44545454545454544, correct 49/110

Val Set, val_loss: 1.4307, val_error: 0.5946, auc: 0.7161
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3186, instance_loss: 0.4790, weighted_loss: 1.0667, label: 3, bag_size: 258
batch 39, loss: 0.8012, instance_loss: 0.4189, weighted_loss: 0.6865, label: 3, bag_size: 274
batch 59, loss: 1.1009, instance_loss: 0.5028, weighted_loss: 0.9215, label: 1, bag_size: 461
batch 79, loss: 1.9432, instance_loss: 0.5606, weighted_loss: 1.5285, label: 4, bag_size: 730
batch 99, loss: 0.1628, instance_loss: 0.3302, weighted_loss: 0.2130, label: 0, bag_size: 324
batch 119, loss: 0.0263, instance_loss: 0.1989, weighted_loss: 0.0781, label: 0, bag_size: 49
batch 139, loss: 1.0309, instance_loss: 0.4810, weighted_loss: 0.8660, label: 1, bag_size: 500
batch 159, loss: 0.8826, instance_loss: 0.4411, weighted_loss: 0.7502, label: 1, bag_size: 500
batch 179, loss: 0.9342, instance_loss: 0.4484, weighted_loss: 0.7885, label: 3, bag_size: 894
batch 199, loss: 1.2123, instance_loss: 0.4932, weighted_loss: 0.9966, label: 4, bag_size: 446
batch 219, loss: 1.7976, instance_loss: 0.5542, weighted_loss: 1.4246, label: 0, bag_size: 1414
batch 239, loss: 0.8678, instance_loss: 0.5123, weighted_loss: 0.7611, label: 1, bag_size: 391
batch 259, loss: 0.4178, instance_loss: 0.5813, weighted_loss: 0.4669, label: 2, bag_size: 596
batch 279, loss: 1.9674, instance_loss: 0.5639, weighted_loss: 1.5463, label: 3, bag_size: 520
batch 299, loss: 0.8391, instance_loss: 0.4526, weighted_loss: 0.7232, label: 3, bag_size: 317
batch 319, loss: 1.5864, instance_loss: 0.4747, weighted_loss: 1.2529, label: 1, bag_size: 823
batch 339, loss: 0.8987, instance_loss: 0.4286, weighted_loss: 0.7577, label: 3, bag_size: 344
batch 359, loss: 0.7857, instance_loss: 0.4319, weighted_loss: 0.6796, label: 4, bag_size: 1077
batch 379, loss: 1.0214, instance_loss: 0.4862, weighted_loss: 0.8608, label: 3, bag_size: 398
batch 399, loss: 1.6572, instance_loss: 0.4755, weighted_loss: 1.3027, label: 2, bag_size: 489
batch 419, loss: 1.0411, instance_loss: 0.4085, weighted_loss: 0.8513, label: 1, bag_size: 702
batch 439, loss: 0.8431, instance_loss: 0.4132, weighted_loss: 0.7142, label: 2, bag_size: 445
batch 459, loss: 2.3908, instance_loss: 0.6691, weighted_loss: 1.8743, label: 0, bag_size: 243
batch 479, loss: 0.4985, instance_loss: 0.4380, weighted_loss: 0.4803, label: 4, bag_size: 409
batch 499, loss: 0.5742, instance_loss: 0.4579, weighted_loss: 0.5393, label: 2, bag_size: 572
batch 519, loss: 1.2143, instance_loss: 0.5350, weighted_loss: 1.0105, label: 1, bag_size: 672
batch 539, loss: 0.9688, instance_loss: 0.5313, weighted_loss: 0.8375, label: 1, bag_size: 1273
batch 559, loss: 1.0772, instance_loss: 0.4785, weighted_loss: 0.8976, label: 3, bag_size: 944
batch 579, loss: 1.8848, instance_loss: 0.5021, weighted_loss: 1.4700, label: 2, bag_size: 421


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.04377104377104377: correct 208/4752
Epoch: 18, train_loss: 1.1937, train_clustering_loss:  0.4861, train_error: 0.5135
class 0: acc 0.8306451612903226, correct 103/124
class 1: acc 0.4297520661157025, correct 52/121
class 2: acc 0.2830188679245283, correct 30/106
class 3: acc 0.42857142857142855, correct 54/126
class 4: acc 0.42735042735042733, correct 50/117

Val Set, val_loss: 1.3817, val_error: 0.5946, auc: 0.7366
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9201, instance_loss: 0.4678, weighted_loss: 0.7844, label: 2, bag_size: 350
batch 39, loss: 1.1164, instance_loss: 0.4930, weighted_loss: 0.9294, label: 2, bag_size: 708
batch 59, loss: 1.1586, instance_loss: 0.5379, weighted_loss: 0.9724, label: 4, bag_size: 233
batch 79, loss: 1.5008, instance_loss: 0.5552, weighted_loss: 1.2171, label: 4, bag_size: 482
batch 99, loss: 0.6956, instance_loss: 0.3925, weighted_loss: 0.6047, label: 2, bag_size: 725
batch 119, loss: 0.7092, instance_loss: 0.4370, weighted_loss: 0.6275, label: 3, bag_size: 498
batch 139, loss: 2.9415, instance_loss: 0.6772, weighted_loss: 2.2622, label: 0, bag_size: 888
batch 159, loss: 0.0156, instance_loss: 0.1920, weighted_loss: 0.0685, label: 0, bag_size: 268
batch 179, loss: 1.3111, instance_loss: 0.4757, weighted_loss: 1.0605, label: 3, bag_size: 663
batch 199, loss: 2.3541, instance_loss: 0.5704, weighted_loss: 1.8190, label: 1, bag_size: 564
batch 219, loss: 1.7082, instance_loss: 0.5623, weighted_loss: 1.3644, label: 2, bag_size: 315
batch 239, loss: 1.1232, instance_loss: 0.5645, weighted_loss: 0.9556, label: 2, bag_size: 633
batch 259, loss: 1.5011, instance_loss: 0.4642, weighted_loss: 1.1900, label: 1, bag_size: 620
batch 279, loss: 0.1173, instance_loss: 0.3240, weighted_loss: 0.1793, label: 0, bag_size: 285
batch 299, loss: 1.9708, instance_loss: 0.5887, weighted_loss: 1.5561, label: 0, bag_size: 243
batch 319, loss: 1.1076, instance_loss: 0.4850, weighted_loss: 0.9208, label: 2, bag_size: 617
batch 339, loss: 2.4783, instance_loss: 0.6126, weighted_loss: 1.9186, label: 2, bag_size: 219
batch 359, loss: 0.6780, instance_loss: 0.4483, weighted_loss: 0.6091, label: 3, bag_size: 102
batch 379, loss: 0.5248, instance_loss: 0.4126, weighted_loss: 0.4911, label: 3, bag_size: 194
batch 399, loss: 2.7555, instance_loss: 0.6554, weighted_loss: 2.1255, label: 2, bag_size: 713
batch 419, loss: 1.2025, instance_loss: 0.4759, weighted_loss: 0.9845, label: 1, bag_size: 748
batch 439, loss: 0.7737, instance_loss: 0.4202, weighted_loss: 0.6677, label: 1, bag_size: 1103
batch 459, loss: 0.1782, instance_loss: 0.4870, weighted_loss: 0.2708, label: 2, bag_size: 596
batch 479, loss: 3.8466, instance_loss: 0.6080, weighted_loss: 2.8750, label: 4, bag_size: 293
batch 499, loss: 1.6383, instance_loss: 0.4970, weighted_loss: 1.2959, label: 3, bag_size: 794
batch 519, loss: 1.7531, instance_loss: 0.5450, weighted_loss: 1.3907, label: 2, bag_size: 488
batch 539, loss: 0.8935, instance_loss: 0.3907, weighted_loss: 0.7427, label: 1, bag_size: 355
batch 559, loss: 0.0004, instance_loss: 0.0938, weighted_loss: 0.0284, label: 4, bag_size: 813
batch 579, loss: 0.3205, instance_loss: 0.4401, weighted_loss: 0.3564, label: 4, bag_size: 773


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.05408249158249158: correct 257/4752
Epoch: 19, train_loss: 1.1393, train_clustering_loss:  0.4765, train_error: 0.5000
class 0: acc 0.7909090909090909, correct 87/110
class 1: acc 0.503448275862069, correct 73/145
class 2: acc 0.24347826086956523, correct 28/115
class 3: acc 0.5172413793103449, correct 60/116
class 4: acc 0.4537037037037037, correct 49/108

Val Set, val_loss: 1.4417, val_error: 0.5405, auc: 0.7380
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0038, instance_loss: 0.3869, weighted_loss: 0.8187, label: 0, bag_size: 77
batch 39, loss: 1.0284, instance_loss: 0.5221, weighted_loss: 0.8765, label: 2, bag_size: 498
batch 59, loss: 0.0774, instance_loss: 0.2088, weighted_loss: 0.1168, label: 0, bag_size: 527
batch 79, loss: 0.2612, instance_loss: 0.3140, weighted_loss: 0.2771, label: 0, bag_size: 397
batch 99, loss: 0.5642, instance_loss: 0.4285, weighted_loss: 0.5235, label: 4, bag_size: 574
batch 119, loss: 1.8325, instance_loss: 0.4932, weighted_loss: 1.4307, label: 3, bag_size: 598
batch 139, loss: 0.0488, instance_loss: 0.1590, weighted_loss: 0.0818, label: 0, bag_size: 527
batch 159, loss: 1.2190, instance_loss: 0.3869, weighted_loss: 0.9694, label: 3, bag_size: 789
batch 179, loss: 0.7643, instance_loss: 0.4588, weighted_loss: 0.6727, label: 3, bag_size: 393
batch 199, loss: 0.6707, instance_loss: 0.3373, weighted_loss: 0.5706, label: 0, bag_size: 81
batch 219, loss: 1.1316, instance_loss: 0.5513, weighted_loss: 0.9575, label: 1, bag_size: 384
batch 239, loss: 1.5264, instance_loss: 0.5050, weighted_loss: 1.2199, label: 1, bag_size: 1009
batch 259, loss: 1.3715, instance_loss: 0.5163, weighted_loss: 1.1150, label: 2, bag_size: 258
batch 279, loss: 0.7678, instance_loss: 0.3994, weighted_loss: 0.6573, label: 3, bag_size: 1154
batch 299, loss: 0.8673, instance_loss: 0.4645, weighted_loss: 0.7465, label: 2, bag_size: 613
batch 319, loss: 1.1813, instance_loss: 0.5947, weighted_loss: 1.0053, label: 1, bag_size: 159
batch 339, loss: 1.5269, instance_loss: 0.4760, weighted_loss: 1.2116, label: 4, bag_size: 204
batch 359, loss: 2.4905, instance_loss: 0.6242, weighted_loss: 1.9307, label: 2, bag_size: 407
batch 379, loss: 1.1444, instance_loss: 0.5078, weighted_loss: 0.9534, label: 1, bag_size: 372
batch 399, loss: 1.1183, instance_loss: 0.5208, weighted_loss: 0.9390, label: 3, bag_size: 1076
batch 419, loss: 2.0889, instance_loss: 0.5806, weighted_loss: 1.6364, label: 0, bag_size: 888
batch 439, loss: 1.7099, instance_loss: 0.5146, weighted_loss: 1.3513, label: 4, bag_size: 277
batch 459, loss: 1.0620, instance_loss: 0.4979, weighted_loss: 0.8928, label: 0, bag_size: 317
batch 479, loss: 0.8610, instance_loss: 0.4462, weighted_loss: 0.7366, label: 3, bag_size: 1076
batch 499, loss: 1.1132, instance_loss: 0.4530, weighted_loss: 0.9152, label: 4, bag_size: 366
batch 519, loss: 1.8494, instance_loss: 0.5359, weighted_loss: 1.4553, label: 4, bag_size: 333
batch 539, loss: 1.2855, instance_loss: 0.5013, weighted_loss: 1.0502, label: 2, bag_size: 375
batch 559, loss: 1.8549, instance_loss: 0.5744, weighted_loss: 1.4708, label: 1, bag_size: 159
batch 579, loss: 1.3667, instance_loss: 0.6265, weighted_loss: 1.1446, label: 1, bag_size: 490


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.08943602693602694: correct 425/4752
Epoch: 20, train_loss: 1.1162, train_clustering_loss:  0.4637, train_error: 0.4949
class 0: acc 0.8467153284671532, correct 116/137
class 1: acc 0.39090909090909093, correct 43/110
class 2: acc 0.29411764705882354, correct 30/102
class 3: acc 0.4732824427480916, correct 62/131
class 4: acc 0.4298245614035088, correct 49/114

Val Set, val_loss: 1.3869, val_error: 0.5405, auc: 0.7597
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8480, instance_loss: 0.3907, weighted_loss: 0.7108, label: 3, bag_size: 817
batch 39, loss: 1.1464, instance_loss: 0.5668, weighted_loss: 0.9725, label: 2, bag_size: 404
batch 59, loss: 0.4231, instance_loss: 0.4199, weighted_loss: 0.4221, label: 4, bag_size: 725
batch 79, loss: 2.3308, instance_loss: 0.5027, weighted_loss: 1.7824, label: 3, bag_size: 681
batch 99, loss: 1.7765, instance_loss: 0.5482, weighted_loss: 1.4080, label: 1, bag_size: 1360
batch 119, loss: 0.1382, instance_loss: 0.4331, weighted_loss: 0.2266, label: 0, bag_size: 122
batch 139, loss: 1.0839, instance_loss: 0.4800, weighted_loss: 0.9027, label: 2, bag_size: 860
batch 159, loss: 0.9872, instance_loss: 0.4811, weighted_loss: 0.8353, label: 4, bag_size: 1041
batch 179, loss: 0.5670, instance_loss: 0.4876, weighted_loss: 0.5432, label: 3, bag_size: 794
batch 199, loss: 0.8222, instance_loss: 0.4424, weighted_loss: 0.7082, label: 3, bag_size: 235
batch 219, loss: 1.6188, instance_loss: 0.4900, weighted_loss: 1.2801, label: 2, bag_size: 717
batch 239, loss: 1.1230, instance_loss: 0.4906, weighted_loss: 0.9333, label: 2, bag_size: 390
batch 259, loss: 0.0004, instance_loss: 0.3345, weighted_loss: 0.1006, label: 4, bag_size: 530
batch 279, loss: 0.8624, instance_loss: 0.4250, weighted_loss: 0.7312, label: 3, bag_size: 317
batch 299, loss: 0.0796, instance_loss: 0.4271, weighted_loss: 0.1839, label: 4, bag_size: 530
batch 319, loss: 0.1134, instance_loss: 0.2982, weighted_loss: 0.1688, label: 0, bag_size: 493
batch 339, loss: 0.1049, instance_loss: 0.3512, weighted_loss: 0.1787, label: 0, bag_size: 103
batch 359, loss: 0.0668, instance_loss: 0.2798, weighted_loss: 0.1307, label: 0, bag_size: 366
batch 379, loss: 3.2139, instance_loss: 0.8015, weighted_loss: 2.4902, label: 3, bag_size: 228
batch 399, loss: 0.8892, instance_loss: 0.4855, weighted_loss: 0.7681, label: 3, bag_size: 97
batch 419, loss: 0.7254, instance_loss: 0.5007, weighted_loss: 0.6579, label: 4, bag_size: 1041
batch 439, loss: 1.8612, instance_loss: 0.5150, weighted_loss: 1.4573, label: 3, bag_size: 166
batch 459, loss: 0.4444, instance_loss: 0.5367, weighted_loss: 0.4721, label: 0, bag_size: 578
batch 479, loss: 0.6933, instance_loss: 0.4719, weighted_loss: 0.6269, label: 2, bag_size: 614
batch 499, loss: 1.2506, instance_loss: 0.4789, weighted_loss: 1.0191, label: 1, bag_size: 614
batch 519, loss: 0.7838, instance_loss: 0.4280, weighted_loss: 0.6771, label: 1, bag_size: 534
batch 539, loss: 1.0258, instance_loss: 0.4641, weighted_loss: 0.8573, label: 1, bag_size: 500
batch 559, loss: 0.9781, instance_loss: 0.4443, weighted_loss: 0.8180, label: 1, bag_size: 526
batch 579, loss: 1.0722, instance_loss: 0.5158, weighted_loss: 0.9053, label: 3, bag_size: 498


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.049873737373737376: correct 237/4752
Epoch: 21, train_loss: 1.1725, train_clustering_loss:  0.4869, train_error: 0.5185
class 0: acc 0.859504132231405, correct 104/121
class 1: acc 0.33043478260869563, correct 38/115
class 2: acc 0.3984375, correct 51/128
class 3: acc 0.2894736842105263, correct 33/114
class 4: acc 0.5172413793103449, correct 60/116

Val Set, val_loss: 1.3860, val_error: 0.5541, auc: 0.7435
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.2676, instance_loss: 0.5144, weighted_loss: 1.0417, label: 3, bag_size: 323
batch 39, loss: 1.3907, instance_loss: 0.4800, weighted_loss: 1.1175, label: 1, bag_size: 928
batch 59, loss: 2.4379, instance_loss: 0.6382, weighted_loss: 1.8980, label: 1, bag_size: 564
batch 79, loss: 2.0641, instance_loss: 0.4723, weighted_loss: 1.5866, label: 2, bag_size: 340
batch 99, loss: 1.0030, instance_loss: 0.4953, weighted_loss: 0.8507, label: 3, bag_size: 500
batch 119, loss: 1.9888, instance_loss: 0.5868, weighted_loss: 1.5682, label: 3, bag_size: 796
batch 139, loss: 1.2413, instance_loss: 0.4268, weighted_loss: 0.9969, label: 1, bag_size: 658
batch 159, loss: 1.5550, instance_loss: 0.4737, weighted_loss: 1.2306, label: 1, bag_size: 599
batch 179, loss: 1.5400, instance_loss: 0.5793, weighted_loss: 1.2518, label: 4, bag_size: 868
batch 199, loss: 3.1822, instance_loss: 0.6996, weighted_loss: 2.4374, label: 2, bag_size: 553
batch 219, loss: 0.7099, instance_loss: 0.4872, weighted_loss: 0.6431, label: 4, bag_size: 204
batch 239, loss: 0.6344, instance_loss: 0.4826, weighted_loss: 0.5889, label: 4, bag_size: 1041
batch 259, loss: 0.8712, instance_loss: 0.4779, weighted_loss: 0.7532, label: 2, bag_size: 616
batch 279, loss: 2.6531, instance_loss: 0.6481, weighted_loss: 2.0516, label: 3, bag_size: 403
batch 299, loss: 1.2352, instance_loss: 0.5639, weighted_loss: 1.0338, label: 3, bag_size: 822
batch 319, loss: 1.1358, instance_loss: 0.4392, weighted_loss: 0.9268, label: 2, bag_size: 258
batch 339, loss: 1.8654, instance_loss: 0.5817, weighted_loss: 1.4803, label: 1, bag_size: 397
batch 359, loss: 0.8555, instance_loss: 0.3705, weighted_loss: 0.7100, label: 1, bag_size: 855
batch 379, loss: 1.1953, instance_loss: 0.4781, weighted_loss: 0.9801, label: 2, bag_size: 549
batch 399, loss: 0.7204, instance_loss: 0.4092, weighted_loss: 0.6271, label: 2, bag_size: 616
batch 419, loss: 0.2472, instance_loss: 0.3464, weighted_loss: 0.2770, label: 0, bag_size: 33
batch 439, loss: 1.4623, instance_loss: 0.5225, weighted_loss: 1.1804, label: 3, bag_size: 1365
batch 459, loss: 1.1782, instance_loss: 0.4337, weighted_loss: 0.9549, label: 1, bag_size: 1013
batch 479, loss: 0.3696, instance_loss: 0.4109, weighted_loss: 0.3820, label: 3, bag_size: 674
batch 499, loss: 3.2825, instance_loss: 0.7020, weighted_loss: 2.5084, label: 0, bag_size: 492
batch 519, loss: 0.8686, instance_loss: 0.4819, weighted_loss: 0.7526, label: 4, bag_size: 233
batch 539, loss: 1.3441, instance_loss: 0.5744, weighted_loss: 1.1132, label: 3, bag_size: 797
batch 559, loss: 0.8488, instance_loss: 0.4778, weighted_loss: 0.7375, label: 2, bag_size: 171
batch 579, loss: 0.2675, instance_loss: 0.3914, weighted_loss: 0.3047, label: 4, bag_size: 231


class 0 clustering acc 0.9971801346801347: correct 23693/23760
class 1 clustering acc 0.05765993265993266: correct 274/4752
Epoch: 22, train_loss: 1.1843, train_clustering_loss:  0.4800, train_error: 0.5000
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.3798449612403101, correct 49/129
class 2: acc 0.4083333333333333, correct 49/120
class 3: acc 0.47413793103448276, correct 55/116
class 4: acc 0.4537037037037037, correct 49/108

Val Set, val_loss: 1.4822, val_error: 0.5405, auc: 0.7362
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.0472972972972973: correct 28/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9332, instance_loss: 0.5191, weighted_loss: 0.8090, label: 2, bag_size: 616
batch 39, loss: 0.6342, instance_loss: 0.3618, weighted_loss: 0.5525, label: 3, bag_size: 818
batch 59, loss: 2.2614, instance_loss: 0.6498, weighted_loss: 1.7779, label: 1, bag_size: 113
batch 79, loss: 1.0162, instance_loss: 0.4687, weighted_loss: 0.8520, label: 2, bag_size: 613
batch 99, loss: 0.8670, instance_loss: 0.4648, weighted_loss: 0.7463, label: 4, bag_size: 238
batch 119, loss: 0.0506, instance_loss: 0.2711, weighted_loss: 0.1168, label: 0, bag_size: 37
batch 139, loss: 2.0916, instance_loss: 0.5833, weighted_loss: 1.6391, label: 3, bag_size: 282
batch 159, loss: 1.1449, instance_loss: 0.7645, weighted_loss: 1.0308, label: 0, bag_size: 435
batch 179, loss: 1.0869, instance_loss: 0.4378, weighted_loss: 0.8922, label: 3, bag_size: 258
batch 199, loss: 0.8463, instance_loss: 0.4729, weighted_loss: 0.7343, label: 2, bag_size: 572
batch 219, loss: 0.2412, instance_loss: 0.3901, weighted_loss: 0.2859, label: 0, bag_size: 159
batch 239, loss: 2.0477, instance_loss: 0.5857, weighted_loss: 1.6091, label: 4, bag_size: 333
batch 259, loss: 0.6788, instance_loss: 0.4998, weighted_loss: 0.6251, label: 2, bag_size: 171
batch 279, loss: 0.3098, instance_loss: 0.4494, weighted_loss: 0.3516, label: 2, bag_size: 553
batch 299, loss: 0.8500, instance_loss: 0.4718, weighted_loss: 0.7366, label: 1, bag_size: 972
batch 319, loss: 0.5778, instance_loss: 0.4036, weighted_loss: 0.5256, label: 4, bag_size: 1018
batch 339, loss: 0.5141, instance_loss: 0.4197, weighted_loss: 0.4858, label: 4, bag_size: 446
batch 359, loss: 1.8348, instance_loss: 0.6146, weighted_loss: 1.4687, label: 4, bag_size: 1104
batch 379, loss: 0.2396, instance_loss: 0.3155, weighted_loss: 0.2624, label: 0, bag_size: 702
batch 399, loss: 1.2718, instance_loss: 0.5155, weighted_loss: 1.0449, label: 1, bag_size: 599
batch 419, loss: 1.1229, instance_loss: 0.4269, weighted_loss: 0.9141, label: 3, bag_size: 944
batch 439, loss: 1.3768, instance_loss: 0.5379, weighted_loss: 1.1252, label: 0, bag_size: 143
batch 459, loss: 1.0040, instance_loss: 0.5700, weighted_loss: 0.8738, label: 2, bag_size: 208
batch 479, loss: 0.9429, instance_loss: 0.4455, weighted_loss: 0.7937, label: 1, bag_size: 599
batch 499, loss: 0.7326, instance_loss: 0.4364, weighted_loss: 0.6437, label: 2, bag_size: 572
batch 519, loss: 0.9982, instance_loss: 0.4555, weighted_loss: 0.8354, label: 1, bag_size: 500
batch 539, loss: 0.0544, instance_loss: 0.1639, weighted_loss: 0.0873, label: 0, bag_size: 306
batch 559, loss: 0.8797, instance_loss: 0.4096, weighted_loss: 0.7387, label: 3, bag_size: 727
batch 579, loss: 0.9331, instance_loss: 0.4578, weighted_loss: 0.7905, label: 1, bag_size: 1103


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.0484006734006734: correct 230/4752
Epoch: 23, train_loss: 1.1590, train_clustering_loss:  0.4805, train_error: 0.4697
class 0: acc 0.868421052631579, correct 99/114
class 1: acc 0.44715447154471544, correct 55/123
class 2: acc 0.2916666666666667, correct 35/120
class 3: acc 0.5648854961832062, correct 74/131
class 4: acc 0.49056603773584906, correct 52/106

Val Set, val_loss: 1.3583, val_error: 0.6216, auc: 0.7635
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6160, instance_loss: 0.4571, weighted_loss: 0.5683, label: 3, bag_size: 344
batch 39, loss: 3.2588, instance_loss: 0.7109, weighted_loss: 2.4945, label: 4, bag_size: 854
batch 59, loss: 1.6356, instance_loss: 0.4646, weighted_loss: 1.2843, label: 2, bag_size: 844
batch 79, loss: 2.6899, instance_loss: 0.7596, weighted_loss: 2.1108, label: 2, bag_size: 606
batch 99, loss: 1.5044, instance_loss: 0.5771, weighted_loss: 1.2262, label: 3, bag_size: 192
batch 119, loss: 0.7723, instance_loss: 0.4270, weighted_loss: 0.6687, label: 1, bag_size: 981
batch 139, loss: 2.0912, instance_loss: 0.5672, weighted_loss: 1.6340, label: 3, bag_size: 872
batch 159, loss: 1.6484, instance_loss: 0.5589, weighted_loss: 1.3215, label: 4, bag_size: 482
batch 179, loss: 1.9803, instance_loss: 0.6894, weighted_loss: 1.5931, label: 2, bag_size: 219
batch 199, loss: 2.1188, instance_loss: 0.6816, weighted_loss: 1.6876, label: 1, bag_size: 339
batch 219, loss: 2.4812, instance_loss: 0.8734, weighted_loss: 1.9989, label: 3, bag_size: 156
batch 239, loss: 1.1055, instance_loss: 0.5209, weighted_loss: 0.9301, label: 2, bag_size: 286
batch 259, loss: 0.0477, instance_loss: 0.2544, weighted_loss: 0.1098, label: 0, bag_size: 397
batch 279, loss: 1.1206, instance_loss: 0.4412, weighted_loss: 0.9168, label: 3, bag_size: 309
batch 299, loss: 0.0625, instance_loss: 0.2384, weighted_loss: 0.1153, label: 0, bag_size: 234
batch 319, loss: 1.3077, instance_loss: 0.4431, weighted_loss: 1.0483, label: 4, bag_size: 238
batch 339, loss: 2.2809, instance_loss: 0.5661, weighted_loss: 1.7665, label: 1, bag_size: 564
batch 359, loss: 1.0429, instance_loss: 0.4163, weighted_loss: 0.8550, label: 3, bag_size: 894
batch 379, loss: 2.5385, instance_loss: 0.7152, weighted_loss: 1.9915, label: 3, bag_size: 403
batch 399, loss: 0.6528, instance_loss: 0.4640, weighted_loss: 0.5962, label: 4, bag_size: 725
batch 419, loss: 2.1107, instance_loss: 0.5395, weighted_loss: 1.6394, label: 2, bag_size: 799
batch 439, loss: 2.4494, instance_loss: 0.6127, weighted_loss: 1.8984, label: 1, bag_size: 184
batch 459, loss: 1.1580, instance_loss: 0.5530, weighted_loss: 0.9765, label: 4, bag_size: 277
batch 479, loss: 6.9473, instance_loss: 0.5473, weighted_loss: 5.0273, label: 1, bag_size: 617
batch 499, loss: 1.1522, instance_loss: 0.4835, weighted_loss: 0.9516, label: 4, bag_size: 53
batch 519, loss: 0.9940, instance_loss: 0.5001, weighted_loss: 0.8458, label: 3, bag_size: 897
batch 539, loss: 0.0830, instance_loss: 0.2321, weighted_loss: 0.1277, label: 0, bag_size: 141
batch 559, loss: 0.0784, instance_loss: 0.2557, weighted_loss: 0.1316, label: 0, bag_size: 79
batch 579, loss: 0.9309, instance_loss: 0.4414, weighted_loss: 0.7841, label: 2, bag_size: 285


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.06818181818181818: correct 324/4752
Epoch: 24, train_loss: 1.1270, train_clustering_loss:  0.4786, train_error: 0.4933
class 0: acc 0.8046875, correct 103/128
class 1: acc 0.48717948717948717, correct 57/117
class 2: acc 0.23853211009174313, correct 26/109
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.5238095238095238, correct 66/126

Val Set, val_loss: 1.3571, val_error: 0.5811, auc: 0.7467
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5169, instance_loss: 0.3419, weighted_loss: 0.4644, label: 0, bag_size: 613
batch 39, loss: 0.7528, instance_loss: 0.3639, weighted_loss: 0.6361, label: 4, bag_size: 755
batch 59, loss: 0.9343, instance_loss: 0.4497, weighted_loss: 0.7889, label: 1, bag_size: 697
batch 79, loss: 0.8461, instance_loss: 0.4372, weighted_loss: 0.7234, label: 2, bag_size: 350
batch 99, loss: 0.5848, instance_loss: 0.3922, weighted_loss: 0.5271, label: 3, bag_size: 322
batch 119, loss: 0.5619, instance_loss: 0.4107, weighted_loss: 0.5165, label: 3, bag_size: 194
batch 139, loss: 0.1723, instance_loss: 0.3189, weighted_loss: 0.2163, label: 0, bag_size: 702
batch 159, loss: 0.5832, instance_loss: 0.3269, weighted_loss: 0.5063, label: 3, bag_size: 928
batch 179, loss: 0.5678, instance_loss: 0.4752, weighted_loss: 0.5400, label: 3, bag_size: 961
batch 199, loss: 2.1123, instance_loss: 0.5829, weighted_loss: 1.6535, label: 4, bag_size: 101
batch 219, loss: 1.3548, instance_loss: 0.5630, weighted_loss: 1.1173, label: 1, bag_size: 1273
batch 239, loss: 0.0547, instance_loss: 0.2981, weighted_loss: 0.1277, label: 0, bag_size: 33
batch 259, loss: 0.9217, instance_loss: 0.5558, weighted_loss: 0.8119, label: 0, bag_size: 143
batch 279, loss: 1.1221, instance_loss: 0.4020, weighted_loss: 0.9061, label: 4, bag_size: 482
batch 299, loss: 0.7937, instance_loss: 0.5195, weighted_loss: 0.7115, label: 3, bag_size: 608
batch 319, loss: 2.1489, instance_loss: 0.5834, weighted_loss: 1.6792, label: 1, bag_size: 159
batch 339, loss: 1.0526, instance_loss: 0.4673, weighted_loss: 0.8770, label: 2, bag_size: 421
batch 359, loss: 3.1974, instance_loss: 0.5974, weighted_loss: 2.4174, label: 0, bag_size: 1085
batch 379, loss: 1.5123, instance_loss: 0.5460, weighted_loss: 1.2224, label: 1, bag_size: 159
batch 399, loss: 0.8921, instance_loss: 0.4169, weighted_loss: 0.7496, label: 1, bag_size: 390
batch 419, loss: 0.8633, instance_loss: 0.5198, weighted_loss: 0.7602, label: 4, bag_size: 277
batch 439, loss: 0.1116, instance_loss: 0.4098, weighted_loss: 0.2010, label: 4, bag_size: 231
batch 459, loss: 0.8554, instance_loss: 0.4257, weighted_loss: 0.7265, label: 1, bag_size: 764
batch 479, loss: 2.3997, instance_loss: 0.7823, weighted_loss: 1.9145, label: 3, bag_size: 795
batch 499, loss: 1.0321, instance_loss: 0.5289, weighted_loss: 0.8811, label: 3, bag_size: 944
batch 519, loss: 1.0127, instance_loss: 0.5205, weighted_loss: 0.8651, label: 3, bag_size: 796
batch 539, loss: 0.1271, instance_loss: 0.2589, weighted_loss: 0.1666, label: 0, bag_size: 493
batch 559, loss: 2.6181, instance_loss: 0.5630, weighted_loss: 2.0016, label: 3, bag_size: 166
batch 579, loss: 0.9278, instance_loss: 0.4897, weighted_loss: 0.7964, label: 3, bag_size: 498


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.08270202020202021: correct 393/4752
Epoch: 25, train_loss: 1.1184, train_clustering_loss:  0.4702, train_error: 0.4832
class 0: acc 0.8294573643410853, correct 107/129
class 1: acc 0.4067796610169492, correct 48/118
class 2: acc 0.31092436974789917, correct 37/119
class 3: acc 0.46153846153846156, correct 54/117
class 4: acc 0.5495495495495496, correct 61/111

Val Set, val_loss: 1.3538, val_error: 0.5811, auc: 0.7561
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.0990, instance_loss: 0.5349, weighted_loss: 0.9298, label: 4, bag_size: 438
batch 39, loss: 0.2760, instance_loss: 0.4538, weighted_loss: 0.3294, label: 0, bag_size: 122
batch 59, loss: 0.1272, instance_loss: 0.3168, weighted_loss: 0.1841, label: 0, bag_size: 295
batch 79, loss: 1.1891, instance_loss: 0.4512, weighted_loss: 0.9677, label: 1, bag_size: 1121
batch 99, loss: 1.3373, instance_loss: 0.4968, weighted_loss: 1.0851, label: 1, bag_size: 311
batch 119, loss: 1.0375, instance_loss: 0.4372, weighted_loss: 0.8574, label: 1, bag_size: 949
batch 139, loss: 0.9794, instance_loss: 0.4307, weighted_loss: 0.8148, label: 1, bag_size: 925
batch 159, loss: 0.8046, instance_loss: 0.5052, weighted_loss: 0.7148, label: 4, bag_size: 233
batch 179, loss: 0.1565, instance_loss: 0.2820, weighted_loss: 0.1941, label: 0, bag_size: 210
batch 199, loss: 0.3273, instance_loss: 0.4265, weighted_loss: 0.3571, label: 4, bag_size: 746
batch 219, loss: 2.0055, instance_loss: 0.5515, weighted_loss: 1.5693, label: 3, bag_size: 457
batch 239, loss: 2.6593, instance_loss: 0.6114, weighted_loss: 2.0450, label: 2, bag_size: 1319
batch 259, loss: 1.1770, instance_loss: 0.6406, weighted_loss: 1.0161, label: 4, bag_size: 652
batch 279, loss: 0.4369, instance_loss: 0.3781, weighted_loss: 0.4193, label: 0, bag_size: 81
batch 299, loss: 1.5305, instance_loss: 0.5940, weighted_loss: 1.2496, label: 2, bag_size: 96
batch 319, loss: 1.7077, instance_loss: 0.5969, weighted_loss: 1.3745, label: 2, bag_size: 337
batch 339, loss: 0.7004, instance_loss: 0.4639, weighted_loss: 0.6295, label: 0, bag_size: 306
batch 359, loss: 1.2079, instance_loss: 0.4238, weighted_loss: 0.9727, label: 1, bag_size: 658
batch 379, loss: 2.5614, instance_loss: 0.5520, weighted_loss: 1.9586, label: 3, bag_size: 520
batch 399, loss: 1.9522, instance_loss: 0.4746, weighted_loss: 1.5089, label: 1, bag_size: 823
batch 419, loss: 1.2678, instance_loss: 0.4379, weighted_loss: 1.0188, label: 1, bag_size: 607
batch 439, loss: 0.0305, instance_loss: 0.3092, weighted_loss: 0.1141, label: 0, bag_size: 355
batch 459, loss: 2.3777, instance_loss: 0.6182, weighted_loss: 1.8498, label: 3, bag_size: 1147
batch 479, loss: 0.6897, instance_loss: 0.4164, weighted_loss: 0.6077, label: 2, bag_size: 567
batch 499, loss: 2.0733, instance_loss: 0.5511, weighted_loss: 1.6167, label: 2, bag_size: 367
batch 519, loss: 0.9309, instance_loss: 0.4616, weighted_loss: 0.7901, label: 3, bag_size: 154
batch 539, loss: 1.5418, instance_loss: 0.5288, weighted_loss: 1.2379, label: 1, bag_size: 829
batch 559, loss: 0.7389, instance_loss: 0.4782, weighted_loss: 0.6607, label: 0, bag_size: 324
batch 579, loss: 0.5459, instance_loss: 0.5059, weighted_loss: 0.5339, label: 1, bag_size: 886


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.04861111111111111: correct 231/4752
Epoch: 26, train_loss: 1.0833, train_clustering_loss:  0.4843, train_error: 0.4394
class 0: acc 0.856, correct 107/125
class 1: acc 0.5081967213114754, correct 62/122
class 2: acc 0.36283185840707965, correct 41/113
class 3: acc 0.5365853658536586, correct 66/123
class 4: acc 0.5135135135135135, correct 57/111

Val Set, val_loss: 1.3387, val_error: 0.5405, auc: 0.7538
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.2809, instance_loss: 0.4474, weighted_loss: 1.0308, label: 3, bag_size: 631
batch 39, loss: 1.2901, instance_loss: 0.5705, weighted_loss: 1.0742, label: 4, bag_size: 589
batch 59, loss: 0.9193, instance_loss: 0.4695, weighted_loss: 0.7843, label: 2, bag_size: 522
batch 79, loss: 0.7600, instance_loss: 0.4539, weighted_loss: 0.6682, label: 4, bag_size: 744
batch 99, loss: 0.9031, instance_loss: 0.4813, weighted_loss: 0.7765, label: 1, bag_size: 1104
batch 119, loss: 0.6002, instance_loss: 0.4325, weighted_loss: 0.5499, label: 4, bag_size: 277
batch 139, loss: 0.0815, instance_loss: 0.3858, weighted_loss: 0.1728, label: 0, bag_size: 366
batch 159, loss: 0.6912, instance_loss: 0.5187, weighted_loss: 0.6395, label: 0, bag_size: 230
batch 179, loss: 0.0429, instance_loss: 0.6748, weighted_loss: 0.2325, label: 4, bag_size: 541
batch 199, loss: 0.0473, instance_loss: 0.3015, weighted_loss: 0.1236, label: 0, bag_size: 88
batch 219, loss: 1.1389, instance_loss: 0.4683, weighted_loss: 0.9377, label: 2, bag_size: 288
batch 239, loss: 1.0231, instance_loss: 0.4889, weighted_loss: 0.8628, label: 3, bag_size: 1007
batch 259, loss: 0.9030, instance_loss: 0.4944, weighted_loss: 0.7804, label: 3, bag_size: 796
batch 279, loss: 0.7245, instance_loss: 0.4533, weighted_loss: 0.6431, label: 4, bag_size: 318
batch 299, loss: 0.6153, instance_loss: 0.5222, weighted_loss: 0.5874, label: 4, bag_size: 685
batch 319, loss: 0.6658, instance_loss: 0.4110, weighted_loss: 0.5894, label: 4, bag_size: 238
batch 339, loss: 0.1235, instance_loss: 0.3536, weighted_loss: 0.1925, label: 0, bag_size: 49
batch 359, loss: 0.6593, instance_loss: 0.5777, weighted_loss: 0.6348, label: 1, bag_size: 886
batch 379, loss: 0.0670, instance_loss: 0.2516, weighted_loss: 0.1224, label: 0, bag_size: 306
batch 399, loss: 0.5164, instance_loss: 0.4570, weighted_loss: 0.4986, label: 0, bag_size: 306
batch 419, loss: 2.3706, instance_loss: 0.7014, weighted_loss: 1.8698, label: 2, bag_size: 340
batch 439, loss: 0.5926, instance_loss: 0.4012, weighted_loss: 0.5352, label: 3, bag_size: 1358
batch 459, loss: 1.1417, instance_loss: 0.4679, weighted_loss: 0.9396, label: 1, bag_size: 697
batch 479, loss: 1.2362, instance_loss: 0.5258, weighted_loss: 1.0230, label: 1, bag_size: 161
batch 499, loss: 2.4884, instance_loss: 0.5660, weighted_loss: 1.9117, label: 3, bag_size: 342
batch 519, loss: 0.0763, instance_loss: 0.3686, weighted_loss: 0.1640, label: 0, bag_size: 71
batch 539, loss: 1.1757, instance_loss: 0.4470, weighted_loss: 0.9571, label: 3, bag_size: 102
batch 559, loss: 0.6705, instance_loss: 0.4230, weighted_loss: 0.5963, label: 1, bag_size: 814
batch 579, loss: 1.3194, instance_loss: 0.5216, weighted_loss: 1.0800, label: 3, bag_size: 97


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.05134680134680135: correct 244/4752
Epoch: 27, train_loss: 1.1197, train_clustering_loss:  0.4812, train_error: 0.5185
class 0: acc 0.8440366972477065, correct 92/109
class 1: acc 0.23300970873786409, correct 24/103
class 2: acc 0.4344262295081967, correct 53/122
class 3: acc 0.34108527131782945, correct 44/129
class 4: acc 0.5572519083969466, correct 73/131

Val Set, val_loss: 1.3544, val_error: 0.5541, auc: 0.7540
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.2751, instance_loss: 0.5042, weighted_loss: 1.0438, label: 3, bag_size: 473
batch 39, loss: 1.1088, instance_loss: 0.4050, weighted_loss: 0.8977, label: 2, bag_size: 906
batch 59, loss: 1.1488, instance_loss: 0.4410, weighted_loss: 0.9365, label: 1, bag_size: 272
batch 79, loss: 0.7499, instance_loss: 0.4723, weighted_loss: 0.6666, label: 4, bag_size: 868
batch 99, loss: 0.6475, instance_loss: 0.4245, weighted_loss: 0.5806, label: 4, bag_size: 776
batch 119, loss: 0.9928, instance_loss: 0.4311, weighted_loss: 0.8243, label: 3, bag_size: 603
batch 139, loss: 0.8816, instance_loss: 0.5238, weighted_loss: 0.7742, label: 2, bag_size: 633
batch 159, loss: 0.7066, instance_loss: 0.4634, weighted_loss: 0.6336, label: 3, bag_size: 230
batch 179, loss: 1.0829, instance_loss: 0.5273, weighted_loss: 0.9162, label: 4, bag_size: 875
batch 199, loss: 0.8814, instance_loss: 0.4781, weighted_loss: 0.7604, label: 2, bag_size: 558
batch 219, loss: 0.9621, instance_loss: 0.4169, weighted_loss: 0.7985, label: 1, bag_size: 355
batch 239, loss: 1.0547, instance_loss: 0.4897, weighted_loss: 0.8852, label: 4, bag_size: 731
batch 259, loss: 0.7768, instance_loss: 0.4996, weighted_loss: 0.6936, label: 1, bag_size: 591
batch 279, loss: 0.9091, instance_loss: 0.4195, weighted_loss: 0.7622, label: 1, bag_size: 1121
batch 299, loss: 0.9726, instance_loss: 0.5046, weighted_loss: 0.8322, label: 2, bag_size: 614
batch 319, loss: 0.9520, instance_loss: 0.4266, weighted_loss: 0.7944, label: 1, bag_size: 928
batch 339, loss: 0.8910, instance_loss: 0.4554, weighted_loss: 0.7603, label: 2, bag_size: 590
batch 359, loss: 0.5635, instance_loss: 0.5176, weighted_loss: 0.5497, label: 4, bag_size: 53
batch 379, loss: 2.1655, instance_loss: 0.5794, weighted_loss: 1.6897, label: 2, bag_size: 582
batch 399, loss: 0.2105, instance_loss: 0.2291, weighted_loss: 0.2161, label: 0, bag_size: 513
batch 419, loss: 0.5850, instance_loss: 0.5955, weighted_loss: 0.5882, label: 4, bag_size: 53
batch 439, loss: 4.3541, instance_loss: 0.7356, weighted_loss: 3.2686, label: 0, bag_size: 273
batch 459, loss: 1.3658, instance_loss: 0.4445, weighted_loss: 1.0894, label: 1, bag_size: 413
batch 479, loss: 1.2376, instance_loss: 0.4678, weighted_loss: 1.0067, label: 1, bag_size: 161
batch 499, loss: 0.0165, instance_loss: 0.1933, weighted_loss: 0.0695, label: 0, bag_size: 306
batch 519, loss: 0.0274, instance_loss: 0.2142, weighted_loss: 0.0834, label: 0, bag_size: 357
batch 539, loss: 0.7862, instance_loss: 0.8349, weighted_loss: 0.8008, label: 1, bag_size: 44
batch 559, loss: 1.4624, instance_loss: 0.4823, weighted_loss: 1.1684, label: 2, bag_size: 861
batch 579, loss: 0.9583, instance_loss: 0.4400, weighted_loss: 0.8028, label: 1, bag_size: 599


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.08501683501683502: correct 404/4752
Epoch: 28, train_loss: 1.0524, train_clustering_loss:  0.4668, train_error: 0.4461
class 0: acc 0.8527131782945736, correct 110/129
class 1: acc 0.5703125, correct 73/128
class 2: acc 0.2543859649122807, correct 29/114
class 3: acc 0.43859649122807015, correct 50/114
class 4: acc 0.6146788990825688, correct 67/109

Val Set, val_loss: 1.3783, val_error: 0.5541, auc: 0.7591
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.7494, instance_loss: 0.4113, weighted_loss: 0.6480, label: 0, bag_size: 879
batch 39, loss: 0.0340, instance_loss: 0.2562, weighted_loss: 0.1006, label: 0, bag_size: 324
batch 59, loss: 0.6447, instance_loss: 0.4369, weighted_loss: 0.5824, label: 4, bag_size: 204
batch 79, loss: 0.8341, instance_loss: 0.5258, weighted_loss: 0.7416, label: 2, bag_size: 613
batch 99, loss: 0.8969, instance_loss: 0.4770, weighted_loss: 0.7709, label: 3, bag_size: 795
batch 119, loss: 1.1381, instance_loss: 0.4976, weighted_loss: 0.9460, label: 3, bag_size: 317
batch 139, loss: 1.5251, instance_loss: 0.5487, weighted_loss: 1.2322, label: 4, bag_size: 589
batch 159, loss: 0.9560, instance_loss: 0.4883, weighted_loss: 0.8157, label: 4, bag_size: 356
batch 179, loss: 2.1223, instance_loss: 0.5470, weighted_loss: 1.6497, label: 1, bag_size: 184
batch 199, loss: 1.3195, instance_loss: 0.4795, weighted_loss: 1.0675, label: 3, bag_size: 300
batch 219, loss: 1.1270, instance_loss: 0.4114, weighted_loss: 0.9123, label: 3, bag_size: 489
batch 239, loss: 1.2671, instance_loss: 0.4798, weighted_loss: 1.0309, label: 4, bag_size: 356
batch 259, loss: 1.6677, instance_loss: 0.4568, weighted_loss: 1.3044, label: 2, bag_size: 522
batch 279, loss: 1.2114, instance_loss: 0.5671, weighted_loss: 1.0181, label: 3, bag_size: 817
batch 299, loss: 1.9588, instance_loss: 0.5043, weighted_loss: 1.5225, label: 3, bag_size: 282
batch 319, loss: 0.8223, instance_loss: 0.4135, weighted_loss: 0.6997, label: 2, bag_size: 350
batch 339, loss: 1.3722, instance_loss: 0.5297, weighted_loss: 1.1194, label: 1, bag_size: 372
batch 359, loss: 0.9198, instance_loss: 0.4735, weighted_loss: 0.7859, label: 2, bag_size: 253
batch 379, loss: 0.2061, instance_loss: 0.2747, weighted_loss: 0.2267, label: 0, bag_size: 453
batch 399, loss: 1.4229, instance_loss: 0.5495, weighted_loss: 1.1609, label: 3, bag_size: 282
batch 419, loss: 0.0000, instance_loss: 0.2722, weighted_loss: 0.0817, label: 4, bag_size: 769
batch 439, loss: 1.8971, instance_loss: 0.5379, weighted_loss: 1.4893, label: 2, bag_size: 861
batch 459, loss: 0.2788, instance_loss: 1.5124, weighted_loss: 0.6489, label: 2, bag_size: 1975
batch 479, loss: 0.9484, instance_loss: 0.4683, weighted_loss: 0.8043, label: 2, bag_size: 185
batch 499, loss: 0.8781, instance_loss: 0.4410, weighted_loss: 0.7470, label: 4, bag_size: 875
batch 519, loss: 0.9692, instance_loss: 0.3988, weighted_loss: 0.7981, label: 0, bag_size: 282
batch 539, loss: 1.0339, instance_loss: 0.4466, weighted_loss: 0.8577, label: 3, bag_size: 369
batch 559, loss: 1.1036, instance_loss: 0.5676, weighted_loss: 0.9428, label: 1, bag_size: 855
batch 579, loss: 0.9509, instance_loss: 0.4043, weighted_loss: 0.7869, label: 2, bag_size: 598


class 0 clustering acc 0.9948232323232323: correct 23637/23760
class 1 clustering acc 0.054924242424242424: correct 261/4752
Epoch: 29, train_loss: 1.1570, train_clustering_loss:  0.4934, train_error: 0.4714
class 0: acc 0.7795275590551181, correct 99/127
class 1: acc 0.4056603773584906, correct 43/106
class 2: acc 0.3963963963963964, correct 44/111
class 3: acc 0.5151515151515151, correct 68/132
class 4: acc 0.5084745762711864, correct 60/118

Val Set, val_loss: 1.3881, val_error: 0.4730, auc: 0.7556
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.0255, instance_loss: 0.6032, weighted_loss: 0.8988, label: 4, bag_size: 468
batch 39, loss: 0.1730, instance_loss: 0.3176, weighted_loss: 0.2164, label: 0, bag_size: 49
batch 59, loss: 0.6481, instance_loss: 0.4629, weighted_loss: 0.5925, label: 2, bag_size: 558
batch 79, loss: 0.5742, instance_loss: 0.5490, weighted_loss: 0.5666, label: 0, bag_size: 317
batch 99, loss: 0.8911, instance_loss: 0.4757, weighted_loss: 0.7665, label: 4, bag_size: 450
batch 119, loss: 2.3348, instance_loss: 0.6193, weighted_loss: 1.8201, label: 2, bag_size: 407
batch 139, loss: 0.9879, instance_loss: 0.4197, weighted_loss: 0.8175, label: 2, bag_size: 331
batch 159, loss: 0.8747, instance_loss: 0.5608, weighted_loss: 0.7805, label: 0, bag_size: 297
batch 179, loss: 0.9498, instance_loss: 0.4858, weighted_loss: 0.8106, label: 1, bag_size: 500
batch 199, loss: 1.6540, instance_loss: 0.5262, weighted_loss: 1.3157, label: 2, bag_size: 498
batch 219, loss: 0.0577, instance_loss: 0.2399, weighted_loss: 0.1123, label: 0, bag_size: 69
batch 239, loss: 0.6778, instance_loss: 0.4692, weighted_loss: 0.6152, label: 0, bag_size: 552
batch 259, loss: 1.3364, instance_loss: 0.4742, weighted_loss: 1.0777, label: 4, bag_size: 246
batch 279, loss: 1.3088, instance_loss: 0.5120, weighted_loss: 1.0698, label: 3, bag_size: 944
batch 299, loss: 1.1241, instance_loss: 0.5033, weighted_loss: 0.9378, label: 2, bag_size: 390
batch 319, loss: 0.8165, instance_loss: 0.5194, weighted_loss: 0.7274, label: 3, bag_size: 473
batch 339, loss: 0.4798, instance_loss: 0.3482, weighted_loss: 0.4404, label: 1, bag_size: 460
batch 359, loss: 1.7003, instance_loss: 0.6028, weighted_loss: 1.3710, label: 3, bag_size: 474
batch 379, loss: 0.0414, instance_loss: 0.2615, weighted_loss: 0.1075, label: 0, bag_size: 428
batch 399, loss: 0.3471, instance_loss: 0.4521, weighted_loss: 0.3786, label: 4, bag_size: 1018
batch 419, loss: 0.0474, instance_loss: 0.3178, weighted_loss: 0.1285, label: 0, bag_size: 355
batch 439, loss: 1.0752, instance_loss: 0.4596, weighted_loss: 0.8905, label: 4, bag_size: 110
batch 459, loss: 0.4531, instance_loss: 0.8080, weighted_loss: 0.5595, label: 1, bag_size: 44
batch 479, loss: 0.6836, instance_loss: 0.4332, weighted_loss: 0.6085, label: 1, bag_size: 483
batch 499, loss: 0.5307, instance_loss: 0.5147, weighted_loss: 0.5259, label: 4, bag_size: 366
batch 519, loss: 3.3763, instance_loss: 0.7530, weighted_loss: 2.5893, label: 2, bag_size: 340
batch 539, loss: 0.7903, instance_loss: 0.4849, weighted_loss: 0.6987, label: 3, bag_size: 510
batch 559, loss: 2.1252, instance_loss: 0.5733, weighted_loss: 1.6596, label: 1, bag_size: 397
batch 579, loss: 3.0847, instance_loss: 0.5912, weighted_loss: 2.3367, label: 1, bag_size: 45


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.03851010101010101: correct 183/4752
Epoch: 30, train_loss: 1.1421, train_clustering_loss:  0.4934, train_error: 0.4781
class 0: acc 0.7786885245901639, correct 95/122
class 1: acc 0.4827586206896552, correct 56/116
class 2: acc 0.24210526315789474, correct 23/95
class 3: acc 0.4523809523809524, correct 57/126
class 4: acc 0.5851851851851851, correct 79/135

Val Set, val_loss: 1.3051, val_error: 0.5541, auc: 0.7713
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.316388 --> 1.305103).  Saving model ...


batch 19, loss: 2.2385, instance_loss: 0.6786, weighted_loss: 1.7706, label: 2, bag_size: 337
batch 39, loss: 1.0124, instance_loss: 0.5019, weighted_loss: 0.8593, label: 4, bag_size: 685
batch 59, loss: 3.1999, instance_loss: 0.5938, weighted_loss: 2.4181, label: 0, bag_size: 115
batch 79, loss: 1.3697, instance_loss: 0.5647, weighted_loss: 1.1282, label: 3, bag_size: 451
batch 99, loss: 2.1355, instance_loss: 0.5667, weighted_loss: 1.6649, label: 2, bag_size: 731
batch 119, loss: 1.5337, instance_loss: 0.5307, weighted_loss: 1.2328, label: 2, bag_size: 605
batch 139, loss: 1.5297, instance_loss: 0.6153, weighted_loss: 1.2554, label: 4, bag_size: 757
batch 159, loss: 1.3495, instance_loss: 0.4775, weighted_loss: 1.0879, label: 0, bag_size: 710
batch 179, loss: 2.0282, instance_loss: 0.5960, weighted_loss: 1.5985, label: 0, bag_size: 600
batch 199, loss: 0.7691, instance_loss: 0.4306, weighted_loss: 0.6676, label: 0, bag_size: 455
batch 219, loss: 0.5332, instance_loss: 0.4420, weighted_loss: 0.5059, label: 1, bag_size: 332
batch 239, loss: 1.4023, instance_loss: 0.5131, weighted_loss: 1.1355, label: 2, bag_size: 404
batch 259, loss: 2.4880, instance_loss: 0.6846, weighted_loss: 1.9470, label: 2, bag_size: 219
batch 279, loss: 0.6330, instance_loss: 0.5226, weighted_loss: 0.5998, label: 4, bag_size: 742
batch 299, loss: 1.5528, instance_loss: 0.5207, weighted_loss: 1.2431, label: 0, bag_size: 305
batch 319, loss: 0.6353, instance_loss: 0.4167, weighted_loss: 0.5697, label: 1, bag_size: 500
batch 339, loss: 1.5038, instance_loss: 0.5649, weighted_loss: 1.2221, label: 2, bag_size: 303
batch 359, loss: 0.6279, instance_loss: 0.7994, weighted_loss: 0.6793, label: 1, bag_size: 1497
batch 379, loss: 1.0920, instance_loss: 0.5443, weighted_loss: 0.9276, label: 2, bag_size: 1197
batch 399, loss: 1.1570, instance_loss: 0.4781, weighted_loss: 0.9533, label: 0, bag_size: 600
batch 419, loss: 1.2581, instance_loss: 0.5315, weighted_loss: 1.0401, label: 2, bag_size: 498
batch 439, loss: 0.9640, instance_loss: 0.4390, weighted_loss: 0.8065, label: 1, bag_size: 500
batch 459, loss: 0.9789, instance_loss: 0.4576, weighted_loss: 0.8225, label: 1, bag_size: 814
batch 479, loss: 0.0860, instance_loss: 0.3178, weighted_loss: 0.1555, label: 4, bag_size: 923
batch 499, loss: 1.6233, instance_loss: 0.6510, weighted_loss: 1.3316, label: 3, bag_size: 317
batch 519, loss: 1.0958, instance_loss: 0.5190, weighted_loss: 0.9227, label: 3, bag_size: 102
batch 539, loss: 1.0261, instance_loss: 0.4377, weighted_loss: 0.8496, label: 2, bag_size: 567
batch 559, loss: 1.0343, instance_loss: 0.4729, weighted_loss: 0.8659, label: 1, bag_size: 614
batch 579, loss: 1.1620, instance_loss: 0.5194, weighted_loss: 0.9693, label: 2, bag_size: 1077


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.030723905723905723: correct 146/4752
Epoch: 31, train_loss: 1.0936, train_clustering_loss:  0.4855, train_error: 0.4630
class 0: acc 0.808695652173913, correct 93/115
class 1: acc 0.5362318840579711, correct 74/138
class 2: acc 0.2543859649122807, correct 29/114
class 3: acc 0.46226415094339623, correct 49/106
class 4: acc 0.6115702479338843, correct 74/121

Val Set, val_loss: 1.2918, val_error: 0.4865, auc: 0.7816
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.305103 --> 1.291823).  Saving model ...


batch 19, loss: 0.0060, instance_loss: 0.2694, weighted_loss: 0.0850, label: 0, bag_size: 340
batch 39, loss: 0.9037, instance_loss: 0.4801, weighted_loss: 0.7766, label: 3, bag_size: 457
batch 59, loss: 0.0115, instance_loss: 0.2937, weighted_loss: 0.0962, label: 0, bag_size: 37
batch 79, loss: 0.8536, instance_loss: 0.4752, weighted_loss: 0.7401, label: 2, bag_size: 783
batch 99, loss: 0.8394, instance_loss: 0.4713, weighted_loss: 0.7290, label: 2, bag_size: 290
batch 119, loss: 1.7869, instance_loss: 0.5908, weighted_loss: 1.4281, label: 2, bag_size: 337
batch 139, loss: 0.5383, instance_loss: 0.3917, weighted_loss: 0.4943, label: 1, bag_size: 332
batch 159, loss: 1.0218, instance_loss: 0.5112, weighted_loss: 0.8686, label: 4, bag_size: 730
batch 179, loss: 0.6579, instance_loss: 0.4094, weighted_loss: 0.5833, label: 4, bag_size: 627
batch 199, loss: 0.6978, instance_loss: 0.4493, weighted_loss: 0.6233, label: 0, bag_size: 122
batch 219, loss: 1.7070, instance_loss: 0.5556, weighted_loss: 1.3616, label: 3, bag_size: 453
batch 239, loss: 0.6029, instance_loss: 0.4377, weighted_loss: 0.5533, label: 1, bag_size: 1009
batch 259, loss: 0.2026, instance_loss: 0.4307, weighted_loss: 0.2710, label: 2, bag_size: 702
batch 279, loss: 1.4236, instance_loss: 0.5446, weighted_loss: 1.1599, label: 3, bag_size: 996
batch 299, loss: 0.3407, instance_loss: 0.4286, weighted_loss: 0.3670, label: 4, bag_size: 725
batch 319, loss: 0.0125, instance_loss: 0.2226, weighted_loss: 0.0756, label: 0, bag_size: 527
batch 339, loss: 1.0072, instance_loss: 0.4227, weighted_loss: 0.8318, label: 3, bag_size: 497
batch 359, loss: 2.7328, instance_loss: 0.7418, weighted_loss: 2.1355, label: 0, bag_size: 178
batch 379, loss: 1.2221, instance_loss: 0.4636, weighted_loss: 0.9945, label: 1, bag_size: 1360
batch 399, loss: 0.9474, instance_loss: 0.4015, weighted_loss: 0.7836, label: 3, bag_size: 1078
batch 419, loss: 0.9021, instance_loss: 0.5733, weighted_loss: 0.8034, label: 2, bag_size: 105
batch 439, loss: 1.0867, instance_loss: 0.4249, weighted_loss: 0.8882, label: 3, bag_size: 625
batch 459, loss: 0.7826, instance_loss: 0.4881, weighted_loss: 0.6942, label: 2, bag_size: 1230
batch 479, loss: 1.8182, instance_loss: 0.5487, weighted_loss: 1.4373, label: 2, bag_size: 512
batch 499, loss: 0.0386, instance_loss: 0.1753, weighted_loss: 0.0796, label: 0, bag_size: 133
batch 519, loss: 1.2604, instance_loss: 0.5398, weighted_loss: 1.0442, label: 3, bag_size: 344
batch 539, loss: 1.1549, instance_loss: 0.5753, weighted_loss: 0.9810, label: 3, bag_size: 344
batch 559, loss: 1.0110, instance_loss: 0.4901, weighted_loss: 0.8547, label: 4, bag_size: 731
batch 579, loss: 1.3162, instance_loss: 0.4416, weighted_loss: 1.0538, label: 4, bag_size: 482


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.047979797979797977: correct 228/4752
Epoch: 32, train_loss: 1.0775, train_clustering_loss:  0.4753, train_error: 0.4562
class 0: acc 0.8034188034188035, correct 94/117
class 1: acc 0.5245901639344263, correct 64/122
class 2: acc 0.3565217391304348, correct 41/115
class 3: acc 0.37815126050420167, correct 45/119
class 4: acc 0.6528925619834711, correct 79/121

Val Set, val_loss: 1.3209, val_error: 0.5000, auc: 0.7669
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2858, instance_loss: 0.5210, weighted_loss: 1.0563, label: 2, bag_size: 315
batch 39, loss: 1.0322, instance_loss: 0.5979, weighted_loss: 0.9019, label: 2, bag_size: 105
batch 59, loss: 0.0309, instance_loss: 0.6112, weighted_loss: 0.2050, label: 4, bag_size: 530
batch 79, loss: 0.9967, instance_loss: 0.4862, weighted_loss: 0.8436, label: 4, bag_size: 490
batch 99, loss: 1.7846, instance_loss: 0.4759, weighted_loss: 1.3919, label: 1, bag_size: 339
batch 119, loss: 1.2333, instance_loss: 0.4364, weighted_loss: 0.9942, label: 4, bag_size: 438
batch 139, loss: 0.2085, instance_loss: 0.3997, weighted_loss: 0.2658, label: 0, bag_size: 227
batch 159, loss: 0.0265, instance_loss: 0.2198, weighted_loss: 0.0845, label: 0, bag_size: 255
batch 179, loss: 0.4970, instance_loss: 0.4448, weighted_loss: 0.4814, label: 1, bag_size: 605
batch 199, loss: 0.0357, instance_loss: 0.3133, weighted_loss: 0.1190, label: 0, bag_size: 210
batch 219, loss: 0.8813, instance_loss: 0.4002, weighted_loss: 0.7370, label: 3, bag_size: 625
batch 239, loss: 0.9534, instance_loss: 0.5145, weighted_loss: 0.8217, label: 3, bag_size: 795
batch 259, loss: 1.5362, instance_loss: 0.4882, weighted_loss: 1.2218, label: 3, bag_size: 474
batch 279, loss: 1.3772, instance_loss: 0.5265, weighted_loss: 1.1220, label: 1, bag_size: 413
batch 299, loss: 0.6543, instance_loss: 0.4966, weighted_loss: 0.6070, label: 3, bag_size: 1284
batch 319, loss: 0.0046, instance_loss: 0.1260, weighted_loss: 0.0410, label: 0, bag_size: 255
batch 339, loss: 0.0063, instance_loss: 0.1620, weighted_loss: 0.0530, label: 0, bag_size: 280
batch 359, loss: 1.2434, instance_loss: 0.6299, weighted_loss: 1.0594, label: 3, bag_size: 476
batch 379, loss: 0.8526, instance_loss: 0.3870, weighted_loss: 0.7129, label: 0, bag_size: 404
batch 399, loss: 0.6411, instance_loss: 0.4596, weighted_loss: 0.5866, label: 4, bag_size: 775
batch 419, loss: 0.9248, instance_loss: 0.5296, weighted_loss: 0.8062, label: 1, bag_size: 161
batch 439, loss: 1.1492, instance_loss: 0.4457, weighted_loss: 0.9382, label: 3, bag_size: 317
batch 459, loss: 0.8045, instance_loss: 0.4713, weighted_loss: 0.7045, label: 1, bag_size: 328
batch 479, loss: 0.8123, instance_loss: 0.5670, weighted_loss: 0.7387, label: 3, bag_size: 818
batch 499, loss: 1.4724, instance_loss: 0.6300, weighted_loss: 1.2197, label: 2, bag_size: 96
batch 519, loss: 0.1182, instance_loss: 0.4042, weighted_loss: 0.2040, label: 4, bag_size: 769
batch 539, loss: 0.8406, instance_loss: 0.3996, weighted_loss: 0.7083, label: 3, bag_size: 459
batch 559, loss: 0.8313, instance_loss: 0.5440, weighted_loss: 0.7451, label: 0, bag_size: 143
batch 579, loss: 1.3420, instance_loss: 0.4839, weighted_loss: 1.0846, label: 2, bag_size: 725


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.06481481481481481: correct 308/4752
Epoch: 33, train_loss: 1.0337, train_clustering_loss:  0.4735, train_error: 0.4057
class 0: acc 0.8740157480314961, correct 111/127
class 1: acc 0.5163934426229508, correct 63/122
class 2: acc 0.3486238532110092, correct 38/109
class 3: acc 0.5819672131147541, correct 71/122
class 4: acc 0.6140350877192983, correct 70/114

Val Set, val_loss: 1.3259, val_error: 0.5405, auc: 0.7725
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7959, instance_loss: 0.4295, weighted_loss: 0.6860, label: 3, bag_size: 423
batch 39, loss: 2.0986, instance_loss: 0.5362, weighted_loss: 1.6299, label: 2, bag_size: 861
batch 59, loss: 0.8647, instance_loss: 0.4250, weighted_loss: 0.7328, label: 1, bag_size: 389
batch 79, loss: 1.2084, instance_loss: 0.5359, weighted_loss: 1.0066, label: 4, bag_size: 333
batch 99, loss: 1.9462, instance_loss: 0.5933, weighted_loss: 1.5403, label: 0, bag_size: 376
batch 119, loss: 0.8246, instance_loss: 0.4430, weighted_loss: 0.7101, label: 1, bag_size: 328
batch 139, loss: 0.0605, instance_loss: 0.1721, weighted_loss: 0.0940, label: 0, bag_size: 513
batch 159, loss: 0.9154, instance_loss: 0.4894, weighted_loss: 0.7876, label: 1, bag_size: 672
batch 179, loss: 1.7535, instance_loss: 0.9862, weighted_loss: 1.5233, label: 3, bag_size: 31
batch 199, loss: 0.2606, instance_loss: 0.2516, weighted_loss: 0.2579, label: 4, bag_size: 730
batch 219, loss: 0.5927, instance_loss: 0.3975, weighted_loss: 0.5342, label: 1, bag_size: 599
batch 239, loss: 1.4011, instance_loss: 0.5377, weighted_loss: 1.1421, label: 3, bag_size: 631
batch 259, loss: 0.7282, instance_loss: 0.4932, weighted_loss: 0.6577, label: 4, bag_size: 776
batch 279, loss: 1.5124, instance_loss: 0.5502, weighted_loss: 1.2238, label: 2, bag_size: 837
batch 299, loss: 1.3199, instance_loss: 0.5104, weighted_loss: 1.0771, label: 2, bag_size: 1013
batch 319, loss: 1.0295, instance_loss: 0.5057, weighted_loss: 0.8723, label: 3, bag_size: 309
batch 339, loss: 0.1009, instance_loss: 0.3384, weighted_loss: 0.1721, label: 0, bag_size: 141
batch 359, loss: 0.0651, instance_loss: 0.3275, weighted_loss: 0.1438, label: 0, bag_size: 355
batch 379, loss: 1.5242, instance_loss: 0.5079, weighted_loss: 1.2193, label: 2, bag_size: 348
batch 399, loss: 1.0911, instance_loss: 0.5114, weighted_loss: 0.9172, label: 2, bag_size: 883
batch 419, loss: 3.1579, instance_loss: 0.7159, weighted_loss: 2.4253, label: 0, bag_size: 370
batch 439, loss: 0.8182, instance_loss: 0.4067, weighted_loss: 0.6947, label: 1, bag_size: 311
batch 459, loss: 1.1602, instance_loss: 0.5488, weighted_loss: 0.9768, label: 3, bag_size: 473
batch 479, loss: 0.8515, instance_loss: 0.5096, weighted_loss: 0.7489, label: 3, bag_size: 245
batch 499, loss: 0.7583, instance_loss: 0.5309, weighted_loss: 0.6901, label: 0, bag_size: 183
batch 519, loss: 0.3585, instance_loss: 0.5353, weighted_loss: 0.4116, label: 4, bag_size: 293
batch 539, loss: 2.8737, instance_loss: 0.7450, weighted_loss: 2.2351, label: 0, bag_size: 370
batch 559, loss: 0.8991, instance_loss: 0.4610, weighted_loss: 0.7676, label: 2, bag_size: 883
batch 579, loss: 0.0000, instance_loss: 0.0339, weighted_loss: 0.0102, label: 4, bag_size: 813


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.04671717171717172: correct 222/4752
Epoch: 34, train_loss: 1.0908, train_clustering_loss:  0.4796, train_error: 0.4630
class 0: acc 0.8018018018018018, correct 89/111
class 1: acc 0.6530612244897959, correct 96/147
class 2: acc 0.22429906542056074, correct 24/107
class 3: acc 0.5042735042735043, correct 59/117
class 4: acc 0.45535714285714285, correct 51/112

Val Set, val_loss: 1.2914, val_error: 0.5135, auc: 0.7759
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.291823 --> 1.291428).  Saving model ...


batch 19, loss: 0.8061, instance_loss: 0.4596, weighted_loss: 0.7021, label: 2, bag_size: 598
batch 39, loss: 1.5485, instance_loss: 0.5151, weighted_loss: 1.2385, label: 0, bag_size: 1414
batch 59, loss: 1.7241, instance_loss: 0.6800, weighted_loss: 1.4109, label: 0, bag_size: 178
batch 79, loss: 1.3770, instance_loss: 0.4250, weighted_loss: 1.0914, label: 1, bag_size: 272
batch 99, loss: 1.2296, instance_loss: 0.5417, weighted_loss: 1.0232, label: 1, bag_size: 321
batch 119, loss: 0.9549, instance_loss: 0.4797, weighted_loss: 0.8123, label: 2, bag_size: 886
batch 139, loss: 1.0034, instance_loss: 0.4779, weighted_loss: 0.8458, label: 2, bag_size: 781
batch 159, loss: 0.4206, instance_loss: 0.4609, weighted_loss: 0.4326, label: 0, bag_size: 258
batch 179, loss: 1.7619, instance_loss: 0.6485, weighted_loss: 1.4279, label: 4, bag_size: 1031
batch 199, loss: 0.3124, instance_loss: 0.3457, weighted_loss: 0.3224, label: 4, bag_size: 266
batch 219, loss: 2.5725, instance_loss: 0.8997, weighted_loss: 2.0706, label: 3, bag_size: 31
batch 239, loss: 2.9946, instance_loss: 0.6911, weighted_loss: 2.3036, label: 4, bag_size: 264
batch 259, loss: 0.9525, instance_loss: 0.4535, weighted_loss: 0.8028, label: 1, bag_size: 1013
batch 279, loss: 0.5308, instance_loss: 0.4101, weighted_loss: 0.4946, label: 1, bag_size: 620
batch 299, loss: 1.1888, instance_loss: 0.5485, weighted_loss: 0.9967, label: 2, bag_size: 554
batch 319, loss: 0.9772, instance_loss: 0.6908, weighted_loss: 0.8913, label: 3, bag_size: 543
batch 339, loss: 0.3042, instance_loss: 0.3094, weighted_loss: 0.3058, label: 4, bag_size: 948
batch 359, loss: 2.4691, instance_loss: 0.5729, weighted_loss: 1.9003, label: 3, bag_size: 1365
batch 379, loss: 0.6591, instance_loss: 0.3979, weighted_loss: 0.5807, label: 4, bag_size: 418
batch 399, loss: 2.2062, instance_loss: 0.5484, weighted_loss: 1.7088, label: 2, bag_size: 339
batch 419, loss: 2.3416, instance_loss: 0.6672, weighted_loss: 1.8393, label: 0, bag_size: 478
batch 439, loss: 0.9022, instance_loss: 0.4933, weighted_loss: 0.7795, label: 2, bag_size: 567
batch 459, loss: 0.7662, instance_loss: 0.3854, weighted_loss: 0.6520, label: 1, bag_size: 960
batch 479, loss: 2.7722, instance_loss: 0.5885, weighted_loss: 2.1171, label: 0, bag_size: 1085
batch 499, loss: 0.5941, instance_loss: 0.4526, weighted_loss: 0.5517, label: 4, bag_size: 703
batch 519, loss: 1.1445, instance_loss: 0.5565, weighted_loss: 0.9681, label: 2, bag_size: 244
batch 539, loss: 0.7480, instance_loss: 0.4874, weighted_loss: 0.6698, label: 3, bag_size: 344
batch 559, loss: 2.7184, instance_loss: 0.7057, weighted_loss: 2.1146, label: 0, bag_size: 273
batch 579, loss: 0.6727, instance_loss: 0.4711, weighted_loss: 0.6123, label: 3, bag_size: 344


class 0 clustering acc 0.9981060606060606: correct 23715/23760
class 1 clustering acc 0.06081649831649832: correct 289/4752
Epoch: 35, train_loss: 1.0788, train_clustering_loss:  0.4785, train_error: 0.4562
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.475, correct 57/120
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.5714285714285714, correct 68/119
class 4: acc 0.5555555555555556, correct 65/117

Val Set, val_loss: 1.3480, val_error: 0.5676, auc: 0.7686
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3045, instance_loss: 0.5007, weighted_loss: 1.0633, label: 1, bag_size: 500
batch 39, loss: 1.0786, instance_loss: 0.4786, weighted_loss: 0.8986, label: 1, bag_size: 697
batch 59, loss: 1.1684, instance_loss: 0.4821, weighted_loss: 0.9625, label: 2, bag_size: 339
batch 79, loss: 1.2064, instance_loss: 0.5237, weighted_loss: 1.0016, label: 4, bag_size: 196
batch 99, loss: 1.2998, instance_loss: 0.6244, weighted_loss: 1.0972, label: 4, bag_size: 944
batch 119, loss: 1.1107, instance_loss: 0.4998, weighted_loss: 0.9274, label: 2, bag_size: 746
batch 139, loss: 0.7393, instance_loss: 0.4008, weighted_loss: 0.6377, label: 1, bag_size: 328
batch 159, loss: 0.9448, instance_loss: 0.4778, weighted_loss: 0.8047, label: 3, bag_size: 1328
batch 179, loss: 1.0832, instance_loss: 0.4343, weighted_loss: 0.8885, label: 2, bag_size: 375
batch 199, loss: 0.4712, instance_loss: 0.4433, weighted_loss: 0.4629, label: 3, bag_size: 928
batch 219, loss: 1.2349, instance_loss: 0.4399, weighted_loss: 0.9964, label: 1, bag_size: 742
batch 239, loss: 0.6960, instance_loss: 0.5390, weighted_loss: 0.6489, label: 3, bag_size: 1076
batch 259, loss: 0.8929, instance_loss: 0.4484, weighted_loss: 0.7595, label: 1, bag_size: 928
batch 279, loss: 0.0199, instance_loss: 0.2050, weighted_loss: 0.0755, label: 0, bag_size: 74
batch 299, loss: 0.9700, instance_loss: 0.4777, weighted_loss: 0.8223, label: 3, bag_size: 739
batch 319, loss: 1.3215, instance_loss: 0.4546, weighted_loss: 1.0614, label: 0, bag_size: 642
batch 339, loss: 0.7745, instance_loss: 0.4536, weighted_loss: 0.6782, label: 2, bag_size: 613
batch 359, loss: 0.1979, instance_loss: 0.3436, weighted_loss: 0.2416, label: 0, bag_size: 285
batch 379, loss: 1.2702, instance_loss: 0.4546, weighted_loss: 1.0255, label: 1, bag_size: 534
batch 399, loss: 1.0630, instance_loss: 0.4832, weighted_loss: 0.8891, label: 1, bag_size: 384
batch 419, loss: 0.1932, instance_loss: 0.3678, weighted_loss: 0.2456, label: 4, bag_size: 683
batch 439, loss: 0.6789, instance_loss: 0.4356, weighted_loss: 0.6059, label: 2, bag_size: 1079
batch 459, loss: 0.5185, instance_loss: 0.4834, weighted_loss: 0.5080, label: 4, bag_size: 652
batch 479, loss: 2.0885, instance_loss: 0.5582, weighted_loss: 1.6294, label: 2, bag_size: 738
batch 499, loss: 0.2440, instance_loss: 0.4405, weighted_loss: 0.3030, label: 0, bag_size: 297
batch 519, loss: 1.8026, instance_loss: 0.5349, weighted_loss: 1.4223, label: 2, bag_size: 738
batch 539, loss: 1.5723, instance_loss: 0.5220, weighted_loss: 1.2572, label: 1, bag_size: 408
batch 559, loss: 0.5854, instance_loss: 0.4581, weighted_loss: 0.5472, label: 4, bag_size: 725
batch 579, loss: 1.0446, instance_loss: 0.4541, weighted_loss: 0.8674, label: 1, bag_size: 607


class 0 clustering acc 0.9958754208754209: correct 23662/23760
class 1 clustering acc 0.0484006734006734: correct 230/4752
Epoch: 36, train_loss: 1.0776, train_clustering_loss:  0.4828, train_error: 0.4714
class 0: acc 0.7946428571428571, correct 89/112
class 1: acc 0.4296875, correct 55/128
class 2: acc 0.3458646616541353, correct 46/133
class 3: acc 0.5042016806722689, correct 60/119
class 4: acc 0.6274509803921569, correct 64/102

Val Set, val_loss: 1.4132, val_error: 0.5811, auc: 0.7389
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7704, instance_loss: 0.4474, weighted_loss: 0.6735, label: 1, bag_size: 925
batch 39, loss: 0.2561, instance_loss: 0.4694, weighted_loss: 0.3201, label: 2, bag_size: 553
batch 59, loss: 0.4496, instance_loss: 0.4984, weighted_loss: 0.4642, label: 0, bag_size: 552
batch 79, loss: 0.8130, instance_loss: 0.5021, weighted_loss: 0.7198, label: 1, bag_size: 764
batch 99, loss: 1.1602, instance_loss: 0.4833, weighted_loss: 0.9572, label: 1, bag_size: 526
batch 119, loss: 0.5139, instance_loss: 0.6277, weighted_loss: 0.5481, label: 4, bag_size: 1351
batch 139, loss: 0.7878, instance_loss: 0.4863, weighted_loss: 0.6974, label: 2, bag_size: 176
batch 159, loss: 0.0143, instance_loss: 0.2130, weighted_loss: 0.0739, label: 0, bag_size: 133
batch 179, loss: 0.8108, instance_loss: 0.4669, weighted_loss: 0.7076, label: 2, bag_size: 708
batch 199, loss: 1.3673, instance_loss: 0.5548, weighted_loss: 1.1235, label: 4, bag_size: 333
batch 219, loss: 3.3400, instance_loss: 0.7518, weighted_loss: 2.5635, label: 0, bag_size: 1045
batch 239, loss: 2.0188, instance_loss: 0.5302, weighted_loss: 1.5722, label: 1, bag_size: 742
batch 259, loss: 0.3840, instance_loss: 0.3654, weighted_loss: 0.3784, label: 0, bag_size: 517
batch 279, loss: 1.8041, instance_loss: 0.5475, weighted_loss: 1.4271, label: 3, bag_size: 497
batch 299, loss: 0.3743, instance_loss: 0.4633, weighted_loss: 0.4010, label: 3, bag_size: 1186
batch 319, loss: 0.0533, instance_loss: 0.3062, weighted_loss: 0.1291, label: 0, bag_size: 79
batch 339, loss: 0.6928, instance_loss: 0.4608, weighted_loss: 0.6232, label: 4, bag_size: 742
batch 359, loss: 0.9678, instance_loss: 0.4735, weighted_loss: 0.8195, label: 4, bag_size: 1077
batch 379, loss: 0.0805, instance_loss: 0.4443, weighted_loss: 0.1897, label: 0, bag_size: 122
batch 399, loss: 1.8598, instance_loss: 0.5003, weighted_loss: 1.4520, label: 3, bag_size: 423
batch 419, loss: 0.0416, instance_loss: 0.2866, weighted_loss: 0.1151, label: 0, bag_size: 425
batch 439, loss: 1.4229, instance_loss: 0.4518, weighted_loss: 1.1316, label: 1, bag_size: 949
batch 459, loss: 1.2862, instance_loss: 0.4521, weighted_loss: 1.0360, label: 1, bag_size: 371
batch 479, loss: 1.9002, instance_loss: 0.5977, weighted_loss: 1.5095, label: 1, bag_size: 618
batch 499, loss: 1.1933, instance_loss: 0.4229, weighted_loss: 0.9622, label: 1, bag_size: 972
batch 519, loss: 0.3486, instance_loss: 0.3764, weighted_loss: 0.3570, label: 3, bag_size: 1186
batch 539, loss: 1.0876, instance_loss: 0.4749, weighted_loss: 0.9038, label: 1, bag_size: 526
batch 559, loss: 0.0243, instance_loss: 0.2161, weighted_loss: 0.0818, label: 0, bag_size: 70
batch 579, loss: 0.0729, instance_loss: 0.2584, weighted_loss: 0.1285, label: 0, bag_size: 103


class 0 clustering acc 0.9967171717171717: correct 23682/23760
class 1 clustering acc 0.049663299663299666: correct 236/4752
Epoch: 37, train_loss: 1.0852, train_clustering_loss:  0.4850, train_error: 0.4848
class 0: acc 0.8032786885245902, correct 98/122
class 1: acc 0.375, correct 42/112
class 2: acc 0.3253968253968254, correct 41/126
class 3: acc 0.5606060606060606, correct 74/132
class 4: acc 0.5, correct 51/102

Val Set, val_loss: 1.3482, val_error: 0.5811, auc: 0.7629
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6321, instance_loss: 0.5648, weighted_loss: 1.3119, label: 4, bag_size: 780
batch 39, loss: 0.5640, instance_loss: 0.4062, weighted_loss: 0.5167, label: 3, bag_size: 459
batch 59, loss: 0.0129, instance_loss: 0.2074, weighted_loss: 0.0712, label: 0, bag_size: 230
batch 79, loss: 0.8289, instance_loss: 0.4090, weighted_loss: 0.7029, label: 3, bag_size: 102
batch 99, loss: 0.9650, instance_loss: 0.4938, weighted_loss: 0.8236, label: 4, bag_size: 775
batch 119, loss: 0.5390, instance_loss: 0.4895, weighted_loss: 0.5241, label: 4, bag_size: 574
batch 139, loss: 1.6822, instance_loss: 0.5803, weighted_loss: 1.3516, label: 4, bag_size: 1031
batch 159, loss: 0.9993, instance_loss: 0.4216, weighted_loss: 0.8260, label: 4, bag_size: 110
batch 179, loss: 0.0960, instance_loss: 0.7340, weighted_loss: 0.2874, label: 0, bag_size: 435
batch 199, loss: 2.5134, instance_loss: 0.6920, weighted_loss: 1.9670, label: 0, bag_size: 1045
batch 219, loss: 1.0155, instance_loss: 0.6315, weighted_loss: 0.9003, label: 3, bag_size: 301
batch 239, loss: 0.4751, instance_loss: 0.6316, weighted_loss: 0.5220, label: 4, bag_size: 854
batch 259, loss: 3.0959, instance_loss: 0.5364, weighted_loss: 2.3281, label: 2, bag_size: 738
batch 279, loss: 1.4281, instance_loss: 0.7384, weighted_loss: 1.2212, label: 0, bag_size: 421
batch 299, loss: 0.8328, instance_loss: 0.4273, weighted_loss: 0.7111, label: 1, bag_size: 855
batch 319, loss: 1.1897, instance_loss: 0.5066, weighted_loss: 0.9848, label: 1, bag_size: 233
batch 339, loss: 0.2665, instance_loss: 0.3427, weighted_loss: 0.2894, label: 0, bag_size: 79
batch 359, loss: 3.1830, instance_loss: 0.5875, weighted_loss: 2.4043, label: 3, bag_size: 533
batch 379, loss: 0.9045, instance_loss: 0.4397, weighted_loss: 0.7651, label: 2, bag_size: 645
batch 399, loss: 0.2798, instance_loss: 0.3569, weighted_loss: 0.3029, label: 4, bag_size: 665
batch 419, loss: 0.0580, instance_loss: 0.4049, weighted_loss: 0.1620, label: 0, bag_size: 357
batch 439, loss: 1.5856, instance_loss: 0.5116, weighted_loss: 1.2634, label: 3, bag_size: 1022
batch 459, loss: 2.7607, instance_loss: 0.7441, weighted_loss: 2.1557, label: 3, bag_size: 156
batch 479, loss: 1.0498, instance_loss: 0.4782, weighted_loss: 0.8784, label: 2, bag_size: 1077
batch 499, loss: 0.8808, instance_loss: 0.4866, weighted_loss: 0.7626, label: 4, bag_size: 263
batch 519, loss: 0.1787, instance_loss: 0.4556, weighted_loss: 0.2618, label: 0, bag_size: 760
batch 539, loss: 0.8923, instance_loss: 0.3995, weighted_loss: 0.7444, label: 1, bag_size: 1019
batch 559, loss: 1.3025, instance_loss: 0.5243, weighted_loss: 1.0690, label: 2, bag_size: 799
batch 579, loss: 0.7728, instance_loss: 0.5007, weighted_loss: 0.6912, label: 3, bag_size: 443


class 0 clustering acc 0.9976430976430977: correct 23704/23760
class 1 clustering acc 0.05787037037037037: correct 275/4752
Epoch: 38, train_loss: 1.0621, train_clustering_loss:  0.4810, train_error: 0.4293
class 0: acc 0.7520661157024794, correct 91/121
class 1: acc 0.45454545454545453, correct 55/121
class 2: acc 0.45794392523364486, correct 49/107
class 3: acc 0.5084745762711864, correct 60/118
class 4: acc 0.6614173228346457, correct 84/127

Val Set, val_loss: 1.2811, val_error: 0.5135, auc: 0.7916
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.0472972972972973: correct 28/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.291428 --> 1.281113).  Saving model ...


batch 19, loss: 1.1365, instance_loss: 0.5516, weighted_loss: 0.9610, label: 1, bag_size: 1497
batch 39, loss: 1.0306, instance_loss: 0.4140, weighted_loss: 0.8456, label: 4, bag_size: 293
batch 59, loss: 1.7646, instance_loss: 0.5916, weighted_loss: 1.4127, label: 3, bag_size: 109
batch 79, loss: 0.1170, instance_loss: 0.2564, weighted_loss: 0.1588, label: 0, bag_size: 192
batch 99, loss: 1.0338, instance_loss: 0.4718, weighted_loss: 0.8652, label: 3, bag_size: 258
batch 119, loss: 1.3351, instance_loss: 0.5327, weighted_loss: 1.0944, label: 2, bag_size: 1308
batch 139, loss: 0.9529, instance_loss: 0.4782, weighted_loss: 0.8105, label: 2, bag_size: 1197
batch 159, loss: 0.5843, instance_loss: 0.4722, weighted_loss: 0.5507, label: 4, bag_size: 318
batch 179, loss: 1.1309, instance_loss: 0.4693, weighted_loss: 0.9324, label: 4, bag_size: 196
batch 199, loss: 0.4632, instance_loss: 0.4818, weighted_loss: 0.4688, label: 3, bag_size: 804
batch 219, loss: 0.6254, instance_loss: 0.4107, weighted_loss: 0.5610, label: 4, bag_size: 775
batch 239, loss: 0.0260, instance_loss: 0.2688, weighted_loss: 0.0989, label: 0, bag_size: 37
batch 259, loss: 0.6116, instance_loss: 0.4196, weighted_loss: 0.5540, label: 3, bag_size: 727
batch 279, loss: 3.2982, instance_loss: 0.6589, weighted_loss: 2.5064, label: 2, bag_size: 1319
batch 299, loss: 1.8461, instance_loss: 0.5027, weighted_loss: 1.4431, label: 1, bag_size: 339
batch 319, loss: 0.0330, instance_loss: 0.2949, weighted_loss: 0.1116, label: 0, bag_size: 366
batch 339, loss: 0.1487, instance_loss: 0.3341, weighted_loss: 0.2043, label: 0, bag_size: 493
batch 359, loss: 0.2923, instance_loss: 0.5008, weighted_loss: 0.3549, label: 4, bag_size: 293
batch 379, loss: 5.0246, instance_loss: 0.7904, weighted_loss: 3.7543, label: 0, bag_size: 608
batch 399, loss: 2.2074, instance_loss: 0.6258, weighted_loss: 1.7329, label: 1, bag_size: 113
batch 419, loss: 0.8922, instance_loss: 0.4877, weighted_loss: 0.7709, label: 3, bag_size: 603
batch 439, loss: 1.3843, instance_loss: 0.5403, weighted_loss: 1.1311, label: 1, bag_size: 618
batch 459, loss: 1.1448, instance_loss: 0.5134, weighted_loss: 0.9554, label: 4, bag_size: 395
batch 479, loss: 1.9422, instance_loss: 0.4953, weighted_loss: 1.5082, label: 1, bag_size: 1009
batch 499, loss: 0.7745, instance_loss: 0.5051, weighted_loss: 0.6937, label: 2, bag_size: 549
batch 519, loss: 0.0569, instance_loss: 0.3112, weighted_loss: 0.1332, label: 0, bag_size: 251
batch 539, loss: 1.2892, instance_loss: 0.5229, weighted_loss: 1.0593, label: 2, bag_size: 746
batch 559, loss: 2.1725, instance_loss: 0.7176, weighted_loss: 1.7360, label: 3, bag_size: 156
batch 579, loss: 1.0617, instance_loss: 0.4575, weighted_loss: 0.8804, label: 1, bag_size: 702


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.041877104377104374: correct 199/4752
Epoch: 39, train_loss: 1.1112, train_clustering_loss:  0.4926, train_error: 0.4865
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.3305084745762712, correct 39/118
class 2: acc 0.35658914728682173, correct 46/129
class 3: acc 0.5934959349593496, correct 73/123
class 4: acc 0.45918367346938777, correct 45/98

Val Set, val_loss: 1.3066, val_error: 0.5405, auc: 0.7800
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2439, instance_loss: 0.5859, weighted_loss: 1.7465, label: 0, bag_size: 888
batch 39, loss: 1.1731, instance_loss: 0.4684, weighted_loss: 0.9617, label: 2, bag_size: 286
batch 59, loss: 0.6424, instance_loss: 0.4820, weighted_loss: 0.5943, label: 3, bag_size: 510
batch 79, loss: 0.9258, instance_loss: 0.4544, weighted_loss: 0.7844, label: 2, bag_size: 522
batch 99, loss: 1.0762, instance_loss: 0.4901, weighted_loss: 0.9004, label: 2, bag_size: 168
batch 119, loss: 1.2880, instance_loss: 0.4722, weighted_loss: 1.0432, label: 1, bag_size: 500
batch 139, loss: 0.7023, instance_loss: 0.4843, weighted_loss: 0.6369, label: 2, bag_size: 337
batch 159, loss: 1.3502, instance_loss: 0.6813, weighted_loss: 1.1496, label: 4, bag_size: 1351
batch 179, loss: 0.0228, instance_loss: 0.3300, weighted_loss: 0.1150, label: 0, bag_size: 230
batch 199, loss: 0.7538, instance_loss: 0.4486, weighted_loss: 0.6623, label: 2, bag_size: 645
batch 219, loss: 0.8431, instance_loss: 0.4633, weighted_loss: 0.7292, label: 3, bag_size: 566
batch 239, loss: 0.8658, instance_loss: 0.4364, weighted_loss: 0.7370, label: 2, bag_size: 1003
batch 259, loss: 2.0875, instance_loss: 0.5444, weighted_loss: 1.6246, label: 3, bag_size: 166
batch 279, loss: 0.0267, instance_loss: 0.2441, weighted_loss: 0.0919, label: 0, bag_size: 49
batch 299, loss: 0.9099, instance_loss: 0.4122, weighted_loss: 0.7606, label: 3, bag_size: 1328
batch 319, loss: 0.5185, instance_loss: 0.4625, weighted_loss: 0.5017, label: 1, bag_size: 1104
batch 339, loss: 0.6296, instance_loss: 0.3750, weighted_loss: 0.5532, label: 4, bag_size: 660
batch 359, loss: 0.3016, instance_loss: 0.5173, weighted_loss: 0.3663, label: 3, bag_size: 301
batch 379, loss: 0.8420, instance_loss: 0.4661, weighted_loss: 0.7292, label: 1, bag_size: 221
batch 399, loss: 1.4035, instance_loss: 0.4777, weighted_loss: 1.1257, label: 2, bag_size: 421
batch 419, loss: 0.6251, instance_loss: 0.3896, weighted_loss: 0.5544, label: 2, bag_size: 543
batch 439, loss: 0.8085, instance_loss: 0.5073, weighted_loss: 0.7181, label: 4, bag_size: 233
batch 459, loss: 0.1494, instance_loss: 0.4635, weighted_loss: 0.2436, label: 3, bag_size: 674
batch 479, loss: 0.4130, instance_loss: 0.4626, weighted_loss: 0.4278, label: 2, bag_size: 1010
batch 499, loss: 0.0010, instance_loss: 0.5418, weighted_loss: 0.1632, label: 4, bag_size: 769
batch 519, loss: 0.9139, instance_loss: 0.5070, weighted_loss: 0.7918, label: 4, bag_size: 868
batch 539, loss: 0.0109, instance_loss: 0.1783, weighted_loss: 0.0611, label: 0, bag_size: 488
batch 559, loss: 1.4600, instance_loss: 0.4353, weighted_loss: 1.1526, label: 2, bag_size: 717
batch 579, loss: 0.1069, instance_loss: 0.3793, weighted_loss: 0.1886, label: 0, bag_size: 523


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.06902356902356903: correct 328/4752
Epoch: 40, train_loss: 1.0102, train_clustering_loss:  0.4768, train_error: 0.4394
class 0: acc 0.8253968253968254, correct 104/126
class 1: acc 0.4056603773584906, correct 43/106
class 2: acc 0.4274193548387097, correct 53/124
class 3: acc 0.584, correct 73/125
class 4: acc 0.5309734513274337, correct 60/113

Val Set, val_loss: 1.4718, val_error: 0.5676, auc: 0.7566
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4052, instance_loss: 0.3538, weighted_loss: 0.3898, label: 2, bag_size: 613
batch 39, loss: 0.1465, instance_loss: 0.3521, weighted_loss: 0.2082, label: 0, bag_size: 71
batch 59, loss: 0.8378, instance_loss: 0.4090, weighted_loss: 0.7092, label: 4, bag_size: 113
batch 79, loss: 1.0595, instance_loss: 0.4557, weighted_loss: 0.8784, label: 2, bag_size: 631
batch 99, loss: 0.5727, instance_loss: 0.4021, weighted_loss: 0.5215, label: 4, bag_size: 875
batch 119, loss: 0.0287, instance_loss: 0.3545, weighted_loss: 0.1264, label: 0, bag_size: 285
batch 139, loss: 1.6043, instance_loss: 0.5638, weighted_loss: 1.2921, label: 1, bag_size: 697
batch 159, loss: 0.2882, instance_loss: 0.4393, weighted_loss: 0.3336, label: 0, bag_size: 33
batch 179, loss: 0.5323, instance_loss: 0.5460, weighted_loss: 0.5364, label: 0, bag_size: 143
batch 199, loss: 0.5411, instance_loss: 0.4332, weighted_loss: 0.5087, label: 2, bag_size: 402
batch 219, loss: 1.8888, instance_loss: 0.5584, weighted_loss: 1.4897, label: 1, bag_size: 742
batch 239, loss: 0.9604, instance_loss: 0.4424, weighted_loss: 0.8050, label: 1, bag_size: 500
batch 259, loss: 0.6073, instance_loss: 0.3824, weighted_loss: 0.5398, label: 1, bag_size: 1121
batch 279, loss: 1.9177, instance_loss: 0.5377, weighted_loss: 1.5037, label: 1, bag_size: 564
batch 299, loss: 2.3634, instance_loss: 0.5827, weighted_loss: 1.8292, label: 2, bag_size: 738
batch 319, loss: 1.6664, instance_loss: 0.5625, weighted_loss: 1.3352, label: 2, bag_size: 321
batch 339, loss: 0.1526, instance_loss: 0.4718, weighted_loss: 0.2484, label: 0, bag_size: 383
batch 359, loss: 0.6002, instance_loss: 0.4975, weighted_loss: 0.5694, label: 3, bag_size: 1186
batch 379, loss: 0.7919, instance_loss: 0.4290, weighted_loss: 0.6830, label: 2, bag_size: 421
batch 399, loss: 0.8942, instance_loss: 0.3953, weighted_loss: 0.7445, label: 2, bag_size: 821
batch 419, loss: 0.9638, instance_loss: 0.6138, weighted_loss: 0.8588, label: 4, bag_size: 730
batch 439, loss: 0.0054, instance_loss: 0.4539, weighted_loss: 0.1400, label: 0, bag_size: 383
batch 459, loss: 3.5372, instance_loss: 0.7072, weighted_loss: 2.6882, label: 0, bag_size: 745
batch 479, loss: 1.0497, instance_loss: 0.4983, weighted_loss: 0.8843, label: 3, bag_size: 102
batch 499, loss: 1.5128, instance_loss: 0.5216, weighted_loss: 1.2155, label: 1, bag_size: 1360
batch 519, loss: 3.6749, instance_loss: 0.5906, weighted_loss: 2.7496, label: 4, bag_size: 101
batch 539, loss: 0.3096, instance_loss: 0.3298, weighted_loss: 0.3156, label: 4, bag_size: 263
batch 559, loss: 0.7579, instance_loss: 0.4336, weighted_loss: 0.6606, label: 4, bag_size: 1297
batch 579, loss: 0.8363, instance_loss: 0.4995, weighted_loss: 0.7352, label: 1, bag_size: 814


class 0 clustering acc 0.9961279461279461: correct 23668/23760
class 1 clustering acc 0.055134680134680134: correct 262/4752
Epoch: 41, train_loss: 1.0547, train_clustering_loss:  0.4808, train_error: 0.4764
class 0: acc 0.7844827586206896, correct 91/116
class 1: acc 0.3559322033898305, correct 42/118
class 2: acc 0.3671875, correct 47/128
class 3: acc 0.43243243243243246, correct 48/111
class 4: acc 0.6859504132231405, correct 83/121

Val Set, val_loss: 1.3952, val_error: 0.5000, auc: 0.7661
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4519, instance_loss: 0.4954, weighted_loss: 0.4649, label: 0, bag_size: 404
batch 39, loss: 0.6190, instance_loss: 0.4369, weighted_loss: 0.5643, label: 3, bag_size: 322
batch 59, loss: 1.0121, instance_loss: 0.4689, weighted_loss: 0.8491, label: 3, bag_size: 797
batch 79, loss: 1.5287, instance_loss: 0.5946, weighted_loss: 1.2485, label: 2, bag_size: 837
batch 99, loss: 0.8901, instance_loss: 0.4900, weighted_loss: 0.7701, label: 1, bag_size: 607
batch 119, loss: 1.5202, instance_loss: 0.5105, weighted_loss: 1.2173, label: 4, bag_size: 176
batch 139, loss: 0.1003, instance_loss: 0.3132, weighted_loss: 0.1642, label: 0, bag_size: 552
batch 159, loss: 0.0513, instance_loss: 0.3235, weighted_loss: 0.1329, label: 4, bag_size: 627
batch 179, loss: 1.3536, instance_loss: 0.5975, weighted_loss: 1.1268, label: 2, bag_size: 713
batch 199, loss: 0.0175, instance_loss: 0.3402, weighted_loss: 0.1143, label: 0, bag_size: 101
batch 219, loss: 0.7498, instance_loss: 0.3423, weighted_loss: 0.6275, label: 2, bag_size: 746
batch 239, loss: 1.3215, instance_loss: 0.6723, weighted_loss: 1.1267, label: 0, bag_size: 421
batch 259, loss: 1.9982, instance_loss: 0.5089, weighted_loss: 1.5514, label: 1, bag_size: 332
batch 279, loss: 1.1454, instance_loss: 0.5101, weighted_loss: 0.9548, label: 4, bag_size: 196
batch 299, loss: 2.6580, instance_loss: 0.6050, weighted_loss: 2.0421, label: 2, bag_size: 606
batch 319, loss: 1.3193, instance_loss: 0.6642, weighted_loss: 1.1228, label: 4, bag_size: 1031
batch 339, loss: 0.2509, instance_loss: 0.3913, weighted_loss: 0.2930, label: 4, bag_size: 685
batch 359, loss: 1.1763, instance_loss: 0.5932, weighted_loss: 1.0014, label: 3, bag_size: 533
batch 379, loss: 0.9975, instance_loss: 0.4788, weighted_loss: 0.8419, label: 3, bag_size: 858
batch 399, loss: 0.8926, instance_loss: 0.4386, weighted_loss: 0.7564, label: 4, bag_size: 853
batch 419, loss: 0.4353, instance_loss: 0.5054, weighted_loss: 0.4563, label: 0, bag_size: 277
batch 439, loss: 0.6226, instance_loss: 0.3606, weighted_loss: 0.5440, label: 4, bag_size: 730
batch 459, loss: 1.9422, instance_loss: 0.5609, weighted_loss: 1.5278, label: 3, bag_size: 598
batch 479, loss: 0.6588, instance_loss: 0.3758, weighted_loss: 0.5739, label: 2, bag_size: 886
batch 499, loss: 1.1435, instance_loss: 0.4655, weighted_loss: 0.9401, label: 1, bag_size: 620
batch 519, loss: 0.0550, instance_loss: 0.3308, weighted_loss: 0.1378, label: 0, bag_size: 285
batch 539, loss: 0.9977, instance_loss: 0.4867, weighted_loss: 0.8444, label: 1, bag_size: 851
batch 559, loss: 0.7089, instance_loss: 0.4555, weighted_loss: 0.6329, label: 1, bag_size: 1009
batch 579, loss: 1.0355, instance_loss: 0.6126, weighted_loss: 0.9086, label: 4, bag_size: 703


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.03156565656565657: correct 150/4752
Epoch: 42, train_loss: 1.0877, train_clustering_loss:  0.4883, train_error: 0.4781
class 0: acc 0.7894736842105263, correct 90/114
class 1: acc 0.24, correct 24/100
class 2: acc 0.4965034965034965, correct 71/143
class 3: acc 0.42857142857142855, correct 48/112
class 4: acc 0.616, correct 77/125

Val Set, val_loss: 1.2564, val_error: 0.5000, auc: 0.7926
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.281113 --> 1.256396).  Saving model ...


batch 19, loss: 2.2410, instance_loss: 0.6139, weighted_loss: 1.7529, label: 0, bag_size: 888
batch 39, loss: 2.0316, instance_loss: 0.5761, weighted_loss: 1.5949, label: 2, bag_size: 219
batch 59, loss: 0.1353, instance_loss: 0.3412, weighted_loss: 0.1971, label: 0, bag_size: 493
batch 79, loss: 0.0070, instance_loss: 0.6705, weighted_loss: 0.2060, label: 4, bag_size: 769
batch 99, loss: 1.3368, instance_loss: 0.4733, weighted_loss: 1.0777, label: 1, bag_size: 617
batch 119, loss: 1.2544, instance_loss: 0.5489, weighted_loss: 1.0427, label: 2, bag_size: 286
batch 139, loss: 0.1287, instance_loss: 0.3166, weighted_loss: 0.1850, label: 0, bag_size: 98
batch 159, loss: 0.8552, instance_loss: 0.4884, weighted_loss: 0.7451, label: 4, bag_size: 875
batch 179, loss: 0.8122, instance_loss: 0.4737, weighted_loss: 0.7107, label: 1, bag_size: 390
batch 199, loss: 0.0116, instance_loss: 0.1765, weighted_loss: 0.0611, label: 0, bag_size: 488
batch 219, loss: 0.6445, instance_loss: 0.4681, weighted_loss: 0.5916, label: 0, bag_size: 269
batch 239, loss: 0.8663, instance_loss: 0.4237, weighted_loss: 0.7335, label: 2, bag_size: 1197
batch 259, loss: 0.7722, instance_loss: 0.4593, weighted_loss: 0.6784, label: 3, bag_size: 192
batch 279, loss: 1.8472, instance_loss: 0.4903, weighted_loss: 1.4401, label: 0, bag_size: 642
batch 299, loss: 0.7553, instance_loss: 0.4524, weighted_loss: 0.6644, label: 3, bag_size: 272
batch 319, loss: 0.2492, instance_loss: 0.3079, weighted_loss: 0.2668, label: 0, bag_size: 282
batch 339, loss: 0.4532, instance_loss: 0.5239, weighted_loss: 0.4744, label: 4, bag_size: 266
batch 359, loss: 1.2137, instance_loss: 0.5832, weighted_loss: 1.0246, label: 3, bag_size: 894
batch 379, loss: 0.8586, instance_loss: 0.3948, weighted_loss: 0.7194, label: 2, bag_size: 906
batch 399, loss: 1.4811, instance_loss: 0.5361, weighted_loss: 1.1976, label: 0, bag_size: 305
batch 419, loss: 1.3142, instance_loss: 0.5193, weighted_loss: 1.0758, label: 3, bag_size: 443
batch 439, loss: 2.5304, instance_loss: 0.5469, weighted_loss: 1.9354, label: 1, bag_size: 875
batch 459, loss: 0.5577, instance_loss: 0.3950, weighted_loss: 0.5089, label: 0, bag_size: 103
batch 479, loss: 2.3904, instance_loss: 0.5235, weighted_loss: 1.8303, label: 2, bag_size: 629
batch 499, loss: 0.2756, instance_loss: 0.3852, weighted_loss: 0.3085, label: 0, bag_size: 552
batch 519, loss: 1.3776, instance_loss: 0.4300, weighted_loss: 1.0933, label: 1, bag_size: 672
batch 539, loss: 1.0238, instance_loss: 0.4204, weighted_loss: 0.8428, label: 2, bag_size: 633
batch 559, loss: 1.8934, instance_loss: 0.4688, weighted_loss: 1.4660, label: 2, bag_size: 1308
batch 579, loss: 0.6807, instance_loss: 0.5010, weighted_loss: 0.6268, label: 4, bag_size: 923


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.045664983164983165: correct 217/4752
Epoch: 43, train_loss: 1.0543, train_clustering_loss:  0.4801, train_error: 0.4579
class 0: acc 0.8245614035087719, correct 94/114
class 1: acc 0.4928571428571429, correct 69/140
class 2: acc 0.2727272727272727, correct 33/121
class 3: acc 0.5700934579439252, correct 61/107
class 4: acc 0.5803571428571429, correct 65/112

Val Set, val_loss: 1.2704, val_error: 0.5000, auc: 0.7840
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0325, instance_loss: 0.4380, weighted_loss: 0.1541, label: 0, bag_size: 15
batch 39, loss: 1.4332, instance_loss: 0.4590, weighted_loss: 1.1409, label: 1, bag_size: 742
batch 59, loss: 0.8454, instance_loss: 0.4488, weighted_loss: 0.7264, label: 2, bag_size: 567
batch 79, loss: 0.0002, instance_loss: 0.6069, weighted_loss: 0.1822, label: 4, bag_size: 359
batch 99, loss: 0.0662, instance_loss: 0.3806, weighted_loss: 0.1605, label: 0, bag_size: 428
batch 119, loss: 1.0509, instance_loss: 0.4244, weighted_loss: 0.8630, label: 3, bag_size: 1078
batch 139, loss: 0.0765, instance_loss: 0.3412, weighted_loss: 0.1559, label: 0, bag_size: 355
batch 159, loss: 0.4799, instance_loss: 0.5180, weighted_loss: 0.4914, label: 1, bag_size: 886
batch 179, loss: 1.4303, instance_loss: 0.7411, weighted_loss: 1.2235, label: 3, bag_size: 107
batch 199, loss: 1.5037, instance_loss: 0.5448, weighted_loss: 1.2160, label: 1, bag_size: 764
batch 219, loss: 0.8269, instance_loss: 0.5135, weighted_loss: 0.7328, label: 3, bag_size: 817
batch 239, loss: 0.5769, instance_loss: 0.4391, weighted_loss: 0.5355, label: 3, bag_size: 245
batch 259, loss: 0.5384, instance_loss: 0.4326, weighted_loss: 0.5067, label: 4, bag_size: 46
batch 279, loss: 0.8023, instance_loss: 0.5283, weighted_loss: 0.7201, label: 4, bag_size: 944
batch 299, loss: 0.3894, instance_loss: 0.5125, weighted_loss: 0.4263, label: 4, bag_size: 683
batch 319, loss: 0.0998, instance_loss: 0.3344, weighted_loss: 0.1702, label: 0, bag_size: 295
batch 339, loss: 0.2560, instance_loss: 0.3776, weighted_loss: 0.2925, label: 0, bag_size: 141
batch 359, loss: 0.8550, instance_loss: 0.4130, weighted_loss: 0.7224, label: 1, bag_size: 823
batch 379, loss: 1.0487, instance_loss: 0.5250, weighted_loss: 0.8916, label: 4, bag_size: 438
batch 399, loss: 2.4096, instance_loss: 0.5784, weighted_loss: 1.8602, label: 1, bag_size: 184
batch 419, loss: 1.2523, instance_loss: 0.5358, weighted_loss: 1.0374, label: 4, bag_size: 176
batch 439, loss: 0.7699, instance_loss: 0.4499, weighted_loss: 0.6739, label: 3, bag_size: 1078
batch 459, loss: 0.3436, instance_loss: 0.4638, weighted_loss: 0.3796, label: 0, bag_size: 122
batch 479, loss: 1.1398, instance_loss: 0.5779, weighted_loss: 0.9713, label: 2, bag_size: 852
batch 499, loss: 1.9637, instance_loss: 0.6191, weighted_loss: 1.5603, label: 3, bag_size: 107
batch 519, loss: 2.3446, instance_loss: 0.5475, weighted_loss: 1.8055, label: 1, bag_size: 361
batch 539, loss: 1.3804, instance_loss: 0.5077, weighted_loss: 1.1186, label: 4, bag_size: 853
batch 559, loss: 2.4698, instance_loss: 0.5106, weighted_loss: 1.8820, label: 0, bag_size: 1045
batch 579, loss: 1.1293, instance_loss: 0.5180, weighted_loss: 0.9459, label: 2, bag_size: 258


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.058712121212121215: correct 279/4752
Epoch: 44, train_loss: 0.9966, train_clustering_loss:  0.4749, train_error: 0.4158
class 0: acc 0.8260869565217391, correct 114/138
class 1: acc 0.6838235294117647, correct 93/136
class 2: acc 0.12745098039215685, correct 13/102
class 3: acc 0.4857142857142857, correct 51/105
class 4: acc 0.672566371681416, correct 76/113

Val Set, val_loss: 1.3578, val_error: 0.4730, auc: 0.7746
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.6316, instance_loss: 0.6186, weighted_loss: 2.0277, label: 1, bag_size: 361
batch 39, loss: 0.6039, instance_loss: 0.5462, weighted_loss: 0.5866, label: 4, bag_size: 730
batch 59, loss: 1.4252, instance_loss: 0.4983, weighted_loss: 1.1472, label: 3, bag_size: 556
batch 79, loss: 2.7687, instance_loss: 0.5829, weighted_loss: 2.1129, label: 0, bag_size: 745
batch 99, loss: 0.6653, instance_loss: 0.5946, weighted_loss: 0.6441, label: 3, bag_size: 794
batch 119, loss: 0.7330, instance_loss: 0.3881, weighted_loss: 0.6295, label: 1, bag_size: 855
batch 139, loss: 1.0419, instance_loss: 0.5333, weighted_loss: 0.8893, label: 4, bag_size: 604
batch 159, loss: 2.6978, instance_loss: 0.5404, weighted_loss: 2.0506, label: 1, bag_size: 875
batch 179, loss: 3.7069, instance_loss: 0.5460, weighted_loss: 2.7586, label: 4, bag_size: 101
batch 199, loss: 1.3323, instance_loss: 0.6158, weighted_loss: 1.1174, label: 2, bag_size: 135
batch 219, loss: 0.2153, instance_loss: 0.3075, weighted_loss: 0.2429, label: 0, bag_size: 49
batch 239, loss: 0.0277, instance_loss: 0.2791, weighted_loss: 0.1031, label: 0, bag_size: 251
batch 259, loss: 0.5859, instance_loss: 0.4402, weighted_loss: 0.5422, label: 1, bag_size: 607
batch 279, loss: 1.3798, instance_loss: 0.4205, weighted_loss: 1.0920, label: 2, bag_size: 512
batch 299, loss: 0.3560, instance_loss: 0.4540, weighted_loss: 0.3854, label: 4, bag_size: 895
batch 319, loss: 0.8889, instance_loss: 0.4416, weighted_loss: 0.7547, label: 2, bag_size: 348
batch 339, loss: 1.9952, instance_loss: 0.6010, weighted_loss: 1.5769, label: 4, bag_size: 395
batch 359, loss: 1.0605, instance_loss: 0.4851, weighted_loss: 0.8879, label: 1, bag_size: 1019
batch 379, loss: 0.4970, instance_loss: 0.4626, weighted_loss: 0.4867, label: 4, bag_size: 683
batch 399, loss: 1.4873, instance_loss: 0.5154, weighted_loss: 1.1957, label: 2, bag_size: 746
batch 419, loss: 1.1112, instance_loss: 0.4588, weighted_loss: 0.9155, label: 1, bag_size: 1013
batch 439, loss: 0.5110, instance_loss: 0.4314, weighted_loss: 0.4871, label: 4, bag_size: 780
batch 459, loss: 0.3315, instance_loss: 0.3519, weighted_loss: 0.3376, label: 0, bag_size: 357
batch 479, loss: 0.7349, instance_loss: 0.4777, weighted_loss: 0.6578, label: 1, bag_size: 1121
batch 499, loss: 0.0196, instance_loss: 0.4594, weighted_loss: 0.1515, label: 0, bag_size: 175
batch 519, loss: 0.0919, instance_loss: 0.3546, weighted_loss: 0.1707, label: 0, bag_size: 71
batch 539, loss: 0.9950, instance_loss: 0.5809, weighted_loss: 0.8708, label: 4, bag_size: 776
batch 559, loss: 1.3240, instance_loss: 0.4680, weighted_loss: 1.0672, label: 2, bag_size: 331
batch 579, loss: 0.9168, instance_loss: 0.4309, weighted_loss: 0.7710, label: 2, bag_size: 659


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.059132996632996634: correct 281/4752
Epoch: 45, train_loss: 1.0780, train_clustering_loss:  0.4819, train_error: 0.4529
class 0: acc 0.8307692307692308, correct 108/130
class 1: acc 0.4537037037037037, correct 49/108
class 2: acc 0.390625, correct 50/128
class 3: acc 0.38596491228070173, correct 44/114
class 4: acc 0.6491228070175439, correct 74/114

Val Set, val_loss: 1.2981, val_error: 0.5135, auc: 0.7832
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3384, instance_loss: 0.5217, weighted_loss: 1.0934, label: 3, bag_size: 451
batch 39, loss: 1.5899, instance_loss: 0.5606, weighted_loss: 1.2811, label: 3, bag_size: 1365
batch 59, loss: 1.2327, instance_loss: 0.5182, weighted_loss: 1.0184, label: 1, bag_size: 500
batch 79, loss: 0.9770, instance_loss: 0.6130, weighted_loss: 0.8678, label: 0, bag_size: 421
batch 99, loss: 1.8735, instance_loss: 0.5623, weighted_loss: 1.4802, label: 2, bag_size: 713
batch 119, loss: 1.2788, instance_loss: 0.5059, weighted_loss: 1.0469, label: 1, bag_size: 525
batch 139, loss: 0.0220, instance_loss: 0.3598, weighted_loss: 0.1234, label: 0, bag_size: 370
batch 159, loss: 2.7564, instance_loss: 0.7318, weighted_loss: 2.1490, label: 0, bag_size: 492
batch 179, loss: 2.3832, instance_loss: 0.7111, weighted_loss: 1.8816, label: 0, bag_size: 492
batch 199, loss: 0.4540, instance_loss: 0.7847, weighted_loss: 0.5532, label: 4, bag_size: 1351
batch 219, loss: 0.9633, instance_loss: 0.5268, weighted_loss: 0.8323, label: 1, bag_size: 391
batch 239, loss: 0.2013, instance_loss: 0.4901, weighted_loss: 0.2879, label: 4, bag_size: 1113
batch 259, loss: 1.0510, instance_loss: 0.4764, weighted_loss: 0.8786, label: 4, bag_size: 563
batch 279, loss: 0.7678, instance_loss: 0.4178, weighted_loss: 0.6628, label: 2, bag_size: 554
batch 299, loss: 2.4851, instance_loss: 0.5182, weighted_loss: 1.8950, label: 2, bag_size: 629
batch 319, loss: 2.4095, instance_loss: 0.5324, weighted_loss: 1.8464, label: 2, bag_size: 629
batch 339, loss: 0.8361, instance_loss: 0.4830, weighted_loss: 0.7301, label: 2, bag_size: 421
batch 359, loss: 0.7848, instance_loss: 0.4427, weighted_loss: 0.6822, label: 2, bag_size: 633
batch 379, loss: 0.9845, instance_loss: 0.4647, weighted_loss: 0.8286, label: 3, bag_size: 797
batch 399, loss: 2.2722, instance_loss: 0.5025, weighted_loss: 1.7413, label: 1, bag_size: 981
batch 419, loss: 2.5166, instance_loss: 0.5221, weighted_loss: 1.9182, label: 3, bag_size: 323
batch 439, loss: 0.5499, instance_loss: 0.5024, weighted_loss: 0.5357, label: 1, bag_size: 221
batch 459, loss: 0.7027, instance_loss: 0.4392, weighted_loss: 0.6236, label: 1, bag_size: 390
batch 479, loss: 0.3285, instance_loss: 0.5068, weighted_loss: 0.3820, label: 0, bag_size: 258
batch 499, loss: 0.9505, instance_loss: 0.4494, weighted_loss: 0.8002, label: 2, bag_size: 853
batch 519, loss: 0.7871, instance_loss: 0.5939, weighted_loss: 0.7292, label: 1, bag_size: 605
batch 539, loss: 2.1185, instance_loss: 0.5204, weighted_loss: 1.6391, label: 2, bag_size: 713
batch 559, loss: 3.5091, instance_loss: 0.5550, weighted_loss: 2.6229, label: 3, bag_size: 166
batch 579, loss: 0.6929, instance_loss: 0.5141, weighted_loss: 0.6392, label: 0, bag_size: 455


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.029671717171717172: correct 141/4752
Epoch: 46, train_loss: 1.0931, train_clustering_loss:  0.4978, train_error: 0.4747
class 0: acc 0.7327586206896551, correct 85/116
class 1: acc 0.3504273504273504, correct 41/117
class 2: acc 0.4307692307692308, correct 56/130
class 3: acc 0.5363636363636364, correct 59/110
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.2858, val_error: 0.4730, auc: 0.7984
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9767, instance_loss: 0.4703, weighted_loss: 0.8248, label: 1, bag_size: 1013
batch 39, loss: 0.9973, instance_loss: 0.4708, weighted_loss: 0.8394, label: 2, bag_size: 576
batch 59, loss: 1.3415, instance_loss: 0.5621, weighted_loss: 1.1077, label: 3, bag_size: 486
batch 79, loss: 1.3522, instance_loss: 0.5470, weighted_loss: 1.1107, label: 4, bag_size: 482
batch 99, loss: 0.1859, instance_loss: 0.4593, weighted_loss: 0.2679, label: 0, bag_size: 397
batch 119, loss: 1.2868, instance_loss: 0.4755, weighted_loss: 1.0434, label: 2, bag_size: 706
batch 139, loss: 1.3411, instance_loss: 0.5582, weighted_loss: 1.1062, label: 2, bag_size: 769
batch 159, loss: 0.8713, instance_loss: 0.4174, weighted_loss: 0.7351, label: 3, bag_size: 322
batch 179, loss: 2.0252, instance_loss: 0.5810, weighted_loss: 1.5919, label: 2, bag_size: 498
batch 199, loss: 0.9058, instance_loss: 0.4848, weighted_loss: 0.7795, label: 2, bag_size: 877
batch 219, loss: 1.1913, instance_loss: 0.4898, weighted_loss: 0.9808, label: 4, bag_size: 868
batch 239, loss: 1.2202, instance_loss: 0.4868, weighted_loss: 1.0002, label: 3, bag_size: 235
batch 259, loss: 1.4458, instance_loss: 0.4817, weighted_loss: 1.1566, label: 2, bag_size: 285
batch 279, loss: 1.9742, instance_loss: 0.5748, weighted_loss: 1.5544, label: 3, bag_size: 282
batch 299, loss: 0.2781, instance_loss: 0.4028, weighted_loss: 0.3155, label: 4, bag_size: 665
batch 319, loss: 0.1566, instance_loss: 0.5654, weighted_loss: 0.2793, label: 2, bag_size: 553
batch 339, loss: 2.0339, instance_loss: 0.5695, weighted_loss: 1.5946, label: 3, bag_size: 300
batch 359, loss: 1.0502, instance_loss: 0.5212, weighted_loss: 0.8915, label: 3, bag_size: 727
batch 379, loss: 1.8130, instance_loss: 0.5349, weighted_loss: 1.4296, label: 2, bag_size: 519
batch 399, loss: 1.0223, instance_loss: 0.5467, weighted_loss: 0.8797, label: 3, bag_size: 858
batch 419, loss: 0.1450, instance_loss: 0.5468, weighted_loss: 0.2656, label: 0, bag_size: 159
batch 439, loss: 1.5712, instance_loss: 0.5636, weighted_loss: 1.2689, label: 2, bag_size: 303
batch 459, loss: 1.9253, instance_loss: 0.5411, weighted_loss: 1.5100, label: 0, bag_size: 478
batch 479, loss: 0.6824, instance_loss: 0.5219, weighted_loss: 0.6343, label: 0, bag_size: 183
batch 499, loss: 0.1138, instance_loss: 0.3601, weighted_loss: 0.1877, label: 0, bag_size: 227
batch 519, loss: 0.3912, instance_loss: 0.4475, weighted_loss: 0.4081, label: 3, bag_size: 309
batch 539, loss: 0.6670, instance_loss: 0.6282, weighted_loss: 0.6554, label: 3, bag_size: 495
batch 559, loss: 0.0123, instance_loss: 0.4050, weighted_loss: 0.1301, label: 0, bag_size: 37
batch 579, loss: 1.4851, instance_loss: 0.4660, weighted_loss: 1.1794, label: 3, bag_size: 797


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.04692760942760943: correct 223/4752
Epoch: 47, train_loss: 1.0122, train_clustering_loss:  0.4830, train_error: 0.4444
class 0: acc 0.8156028368794326, correct 115/141
class 1: acc 0.45689655172413796, correct 53/116
class 2: acc 0.27927927927927926, correct 31/111
class 3: acc 0.5967741935483871, correct 74/124
class 4: acc 0.5588235294117647, correct 57/102

Val Set, val_loss: 1.5195, val_error: 0.6081, auc: 0.7611
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6991, instance_loss: 0.4838, weighted_loss: 0.6345, label: 1, bag_size: 483
batch 39, loss: 0.9439, instance_loss: 0.4639, weighted_loss: 0.7999, label: 1, bag_size: 1103
batch 59, loss: 0.2547, instance_loss: 0.4527, weighted_loss: 0.3141, label: 0, bag_size: 218
batch 79, loss: 1.0616, instance_loss: 0.5285, weighted_loss: 0.9017, label: 3, bag_size: 899
batch 99, loss: 0.8052, instance_loss: 0.3742, weighted_loss: 0.6759, label: 3, bag_size: 625
batch 119, loss: 1.1688, instance_loss: 0.5355, weighted_loss: 0.9788, label: 2, bag_size: 350
batch 139, loss: 2.4433, instance_loss: 0.5508, weighted_loss: 1.8755, label: 1, bag_size: 391
batch 159, loss: 2.0449, instance_loss: 0.7558, weighted_loss: 1.6582, label: 4, bag_size: 490
batch 179, loss: 1.2621, instance_loss: 0.4879, weighted_loss: 1.0299, label: 2, bag_size: 582
batch 199, loss: 0.0022, instance_loss: 0.2133, weighted_loss: 0.0655, label: 0, bag_size: 340
batch 219, loss: 1.8301, instance_loss: 0.6032, weighted_loss: 1.4621, label: 3, bag_size: 156
batch 239, loss: 1.3772, instance_loss: 0.4460, weighted_loss: 1.0978, label: 1, bag_size: 702
batch 259, loss: 0.6031, instance_loss: 0.4198, weighted_loss: 0.5481, label: 0, bag_size: 517
batch 279, loss: 0.5329, instance_loss: 0.4720, weighted_loss: 0.5146, label: 1, bag_size: 481
batch 299, loss: 1.5117, instance_loss: 0.5610, weighted_loss: 1.2265, label: 2, bag_size: 837
batch 319, loss: 1.6359, instance_loss: 0.5724, weighted_loss: 1.3168, label: 3, bag_size: 641
batch 339, loss: 2.5845, instance_loss: 0.6759, weighted_loss: 2.0120, label: 0, bag_size: 888
batch 359, loss: 1.2240, instance_loss: 0.4655, weighted_loss: 0.9965, label: 3, bag_size: 598
batch 379, loss: 0.0180, instance_loss: 0.1589, weighted_loss: 0.0603, label: 0, bag_size: 79
batch 399, loss: 0.1005, instance_loss: 0.3174, weighted_loss: 0.1655, label: 0, bag_size: 79
batch 419, loss: 0.7937, instance_loss: 0.4037, weighted_loss: 0.6767, label: 2, bag_size: 781
batch 439, loss: 1.0229, instance_loss: 0.5118, weighted_loss: 0.8696, label: 4, bag_size: 744
batch 459, loss: 0.0156, instance_loss: 1.0561, weighted_loss: 0.3278, label: 0, bag_size: 1570
batch 479, loss: 0.5897, instance_loss: 0.4766, weighted_loss: 0.5558, label: 1, bag_size: 332
batch 499, loss: 0.0184, instance_loss: 0.3042, weighted_loss: 0.1041, label: 0, bag_size: 355
batch 519, loss: 0.1217, instance_loss: 0.3869, weighted_loss: 0.2013, label: 0, bag_size: 224
batch 539, loss: 1.2734, instance_loss: 0.5779, weighted_loss: 1.0648, label: 2, bag_size: 799
batch 559, loss: 0.9004, instance_loss: 0.3169, weighted_loss: 0.7254, label: 0, bag_size: 879
batch 579, loss: 0.5265, instance_loss: 0.5076, weighted_loss: 0.5208, label: 2, bag_size: 119


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.06565656565656566: correct 312/4752
Epoch: 48, train_loss: 1.0098, train_clustering_loss:  0.4775, train_error: 0.4512
class 0: acc 0.8450704225352113, correct 120/142
class 1: acc 0.4482758620689655, correct 52/116
class 2: acc 0.2956521739130435, correct 34/115
class 3: acc 0.5565217391304348, correct 64/115
class 4: acc 0.5283018867924528, correct 56/106

Val Set, val_loss: 1.2915, val_error: 0.5000, auc: 0.7815
class 0 clustering acc 0.9932432432432432: correct 2940/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.7604, instance_loss: 0.6149, weighted_loss: 1.4168, label: 1, bag_size: 311
batch 39, loss: 1.1504, instance_loss: 0.4804, weighted_loss: 0.9494, label: 1, bag_size: 328
batch 59, loss: 0.8156, instance_loss: 0.3772, weighted_loss: 0.6841, label: 2, bag_size: 350
batch 79, loss: 0.9532, instance_loss: 0.4680, weighted_loss: 0.8076, label: 2, bag_size: 617
batch 99, loss: 0.1745, instance_loss: 0.3276, weighted_loss: 0.2204, label: 4, bag_size: 773
batch 119, loss: 0.2792, instance_loss: 0.3263, weighted_loss: 0.2933, label: 4, bag_size: 948
batch 139, loss: 1.3749, instance_loss: 0.5117, weighted_loss: 1.1159, label: 1, bag_size: 272
batch 159, loss: 1.2711, instance_loss: 0.5869, weighted_loss: 1.0659, label: 1, bag_size: 184
batch 179, loss: 0.0073, instance_loss: 0.3183, weighted_loss: 0.1006, label: 0, bag_size: 37
batch 199, loss: 0.4179, instance_loss: 0.4459, weighted_loss: 0.4263, label: 1, bag_size: 766
batch 219, loss: 1.1368, instance_loss: 0.5457, weighted_loss: 0.9595, label: 2, bag_size: 208
batch 239, loss: 1.2053, instance_loss: 0.5956, weighted_loss: 1.0224, label: 3, bag_size: 474
batch 259, loss: 0.9714, instance_loss: 0.4258, weighted_loss: 0.8077, label: 0, bag_size: 243
batch 279, loss: 0.0527, instance_loss: 0.3359, weighted_loss: 0.1376, label: 0, bag_size: 354
batch 299, loss: 0.1165, instance_loss: 0.3174, weighted_loss: 0.1768, label: 0, bag_size: 192
batch 319, loss: 0.8646, instance_loss: 0.5808, weighted_loss: 0.7795, label: 3, bag_size: 1365
batch 339, loss: 0.8966, instance_loss: 0.5152, weighted_loss: 0.7822, label: 1, bag_size: 461
batch 359, loss: 0.7920, instance_loss: 0.4227, weighted_loss: 0.6812, label: 4, bag_size: 489
batch 379, loss: 0.4546, instance_loss: 0.4616, weighted_loss: 0.4567, label: 1, bag_size: 509
batch 399, loss: 1.3313, instance_loss: 0.4701, weighted_loss: 1.0730, label: 4, bag_size: 730
batch 419, loss: 0.8778, instance_loss: 0.5399, weighted_loss: 0.7765, label: 1, bag_size: 925
batch 439, loss: 0.0516, instance_loss: 0.2812, weighted_loss: 0.1205, label: 0, bag_size: 523
batch 459, loss: 0.2069, instance_loss: 0.3103, weighted_loss: 0.2379, label: 0, bag_size: 493
batch 479, loss: 1.2213, instance_loss: 0.5104, weighted_loss: 1.0080, label: 4, bag_size: 356
batch 499, loss: 0.2926, instance_loss: 0.3728, weighted_loss: 0.3166, label: 4, bag_size: 266
batch 519, loss: 1.2919, instance_loss: 0.5002, weighted_loss: 1.0544, label: 4, bag_size: 176
batch 539, loss: 0.5908, instance_loss: 0.4535, weighted_loss: 0.5496, label: 1, bag_size: 328
batch 559, loss: 0.6515, instance_loss: 0.4347, weighted_loss: 0.5865, label: 0, bag_size: 231
batch 579, loss: 1.5361, instance_loss: 0.5381, weighted_loss: 1.2367, label: 3, bag_size: 390


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.04061447811447812: correct 193/4752
Epoch: 49, train_loss: 1.0270, train_clustering_loss:  0.4841, train_error: 0.4630
class 0: acc 0.859504132231405, correct 104/121
class 1: acc 0.4496124031007752, correct 58/129
class 2: acc 0.3157894736842105, correct 36/114
class 3: acc 0.4462809917355372, correct 54/121
class 4: acc 0.6146788990825688, correct 67/109

Val Set, val_loss: 1.2902, val_error: 0.4459, auc: 0.7937
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0528, instance_loss: 0.3735, weighted_loss: 0.1490, label: 2, bag_size: 553
batch 39, loss: 0.7985, instance_loss: 0.6014, weighted_loss: 0.7394, label: 3, bag_size: 684
batch 59, loss: 0.4295, instance_loss: 0.4845, weighted_loss: 0.4460, label: 3, bag_size: 674
batch 79, loss: 1.1590, instance_loss: 0.4785, weighted_loss: 0.9548, label: 4, bag_size: 333
batch 99, loss: 0.0446, instance_loss: 0.3426, weighted_loss: 0.1340, label: 0, bag_size: 513
batch 119, loss: 1.7883, instance_loss: 0.5913, weighted_loss: 1.4292, label: 2, bag_size: 713
batch 139, loss: 0.7543, instance_loss: 0.5320, weighted_loss: 0.6876, label: 4, bag_size: 923
batch 159, loss: 0.6721, instance_loss: 0.4708, weighted_loss: 0.6117, label: 4, bag_size: 333
batch 179, loss: 4.2643, instance_loss: 0.6414, weighted_loss: 3.1774, label: 1, bag_size: 45
batch 199, loss: 1.9210, instance_loss: 0.6879, weighted_loss: 1.5511, label: 2, bag_size: 407
batch 219, loss: 1.2367, instance_loss: 0.4642, weighted_loss: 1.0049, label: 1, bag_size: 618
batch 239, loss: 1.3000, instance_loss: 0.5639, weighted_loss: 1.0792, label: 3, bag_size: 453
batch 259, loss: 1.4043, instance_loss: 0.6276, weighted_loss: 1.1713, label: 2, bag_size: 1016
batch 279, loss: 0.5278, instance_loss: 0.4866, weighted_loss: 0.5154, label: 3, bag_size: 510
batch 299, loss: 1.0476, instance_loss: 0.4334, weighted_loss: 0.8634, label: 3, bag_size: 497
batch 319, loss: 1.0819, instance_loss: 0.4438, weighted_loss: 0.8905, label: 2, bag_size: 998
batch 339, loss: 0.9318, instance_loss: 0.5795, weighted_loss: 0.8261, label: 4, bag_size: 771
batch 359, loss: 0.1906, instance_loss: 0.4385, weighted_loss: 0.2650, label: 0, bag_size: 33
batch 379, loss: 1.5272, instance_loss: 0.6114, weighted_loss: 1.2525, label: 1, bag_size: 742
batch 399, loss: 1.8284, instance_loss: 0.5692, weighted_loss: 1.4506, label: 2, bag_size: 731
batch 419, loss: 2.6871, instance_loss: 0.6016, weighted_loss: 2.0614, label: 3, bag_size: 856
batch 439, loss: 0.5427, instance_loss: 0.3811, weighted_loss: 0.4943, label: 4, bag_size: 775
batch 459, loss: 0.2473, instance_loss: 0.2866, weighted_loss: 0.2591, label: 0, bag_size: 49
batch 479, loss: 1.1320, instance_loss: 0.4847, weighted_loss: 0.9378, label: 2, bag_size: 783
batch 499, loss: 0.9417, instance_loss: 0.4990, weighted_loss: 0.8089, label: 4, bag_size: 970
batch 519, loss: 1.1909, instance_loss: 0.4543, weighted_loss: 0.9700, label: 2, bag_size: 489
batch 539, loss: 1.4942, instance_loss: 0.4856, weighted_loss: 1.1916, label: 3, bag_size: 663
batch 559, loss: 0.6174, instance_loss: 0.3988, weighted_loss: 0.5518, label: 4, bag_size: 780
batch 579, loss: 0.4704, instance_loss: 0.6827, weighted_loss: 0.5341, label: 4, bag_size: 652


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.04292929292929293: correct 204/4752
Epoch: 50, train_loss: 1.0169, train_clustering_loss:  0.4839, train_error: 0.4495
class 0: acc 0.8253968253968254, correct 104/126
class 1: acc 0.3392857142857143, correct 38/112
class 2: acc 0.392, correct 49/125
class 3: acc 0.5535714285714286, correct 62/112
class 4: acc 0.6218487394957983, correct 74/119

Val Set, val_loss: 1.2701, val_error: 0.4595, auc: 0.8003
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0892, instance_loss: 0.5320, weighted_loss: 0.2220, label: 0, bag_size: 218
batch 39, loss: 2.5688, instance_loss: 0.7607, weighted_loss: 2.0264, label: 0, bag_size: 376
batch 59, loss: 0.2035, instance_loss: 0.3309, weighted_loss: 0.2417, label: 0, bag_size: 306
batch 79, loss: 0.3595, instance_loss: 0.3692, weighted_loss: 0.3624, label: 3, bag_size: 272
batch 99, loss: 0.6808, instance_loss: 0.5084, weighted_loss: 0.6291, label: 0, bag_size: 613
batch 119, loss: 0.1925, instance_loss: 0.3366, weighted_loss: 0.2357, label: 3, bag_size: 476
batch 139, loss: 0.5387, instance_loss: 0.4029, weighted_loss: 0.4980, label: 3, bag_size: 272
batch 159, loss: 1.3153, instance_loss: 0.4831, weighted_loss: 1.0656, label: 4, bag_size: 868
batch 179, loss: 0.0154, instance_loss: 0.2240, weighted_loss: 0.0780, label: 0, bag_size: 49
batch 199, loss: 0.9563, instance_loss: 0.4237, weighted_loss: 0.7965, label: 3, bag_size: 739
batch 219, loss: 0.0051, instance_loss: 0.2892, weighted_loss: 0.0903, label: 0, bag_size: 340
batch 239, loss: 0.0981, instance_loss: 0.3068, weighted_loss: 0.1607, label: 4, bag_size: 773
batch 259, loss: 1.2064, instance_loss: 0.5190, weighted_loss: 1.0002, label: 4, bag_size: 547
batch 279, loss: 0.6441, instance_loss: 0.3925, weighted_loss: 0.5686, label: 3, bag_size: 274
batch 299, loss: 1.1361, instance_loss: 0.5297, weighted_loss: 0.9542, label: 4, bag_size: 1077
batch 319, loss: 0.8283, instance_loss: 0.4756, weighted_loss: 0.7225, label: 4, bag_size: 196
batch 339, loss: 0.9357, instance_loss: 0.5467, weighted_loss: 0.8190, label: 3, bag_size: 1147
batch 359, loss: 1.2299, instance_loss: 0.5712, weighted_loss: 1.0323, label: 2, bag_size: 498
batch 379, loss: 2.0235, instance_loss: 0.5714, weighted_loss: 1.5879, label: 2, bag_size: 549
batch 399, loss: 0.3687, instance_loss: 0.4267, weighted_loss: 0.3861, label: 1, bag_size: 460
batch 419, loss: 3.8183, instance_loss: 0.5718, weighted_loss: 2.8444, label: 0, bag_size: 169
batch 439, loss: 0.0931, instance_loss: 0.4416, weighted_loss: 0.1976, label: 1, bag_size: 106
batch 459, loss: 1.7348, instance_loss: 0.6656, weighted_loss: 1.4141, label: 2, bag_size: 1016
batch 479, loss: 0.9067, instance_loss: 0.5949, weighted_loss: 0.8132, label: 4, bag_size: 293
batch 499, loss: 0.6218, instance_loss: 0.5134, weighted_loss: 0.5893, label: 4, bag_size: 689
batch 519, loss: 0.3559, instance_loss: 0.4258, weighted_loss: 0.3769, label: 4, bag_size: 1041
batch 539, loss: 0.9563, instance_loss: 0.4415, weighted_loss: 0.8019, label: 3, bag_size: 625
batch 559, loss: 2.7368, instance_loss: 0.6713, weighted_loss: 2.1171, label: 0, bag_size: 888
batch 579, loss: 0.4515, instance_loss: 0.4209, weighted_loss: 0.4423, label: 0, bag_size: 224


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.05218855218855219: correct 248/4752
Epoch: 51, train_loss: 0.9466, train_clustering_loss:  0.4759, train_error: 0.3788
class 0: acc 0.8557692307692307, correct 89/104
class 1: acc 0.5, correct 57/114
class 2: acc 0.40350877192982454, correct 46/114
class 3: acc 0.706766917293233, correct 94/133
class 4: acc 0.6434108527131783, correct 83/129

Val Set, val_loss: 1.3379, val_error: 0.4865, auc: 0.7925
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.7084, instance_loss: 0.4308, weighted_loss: 0.6251, label: 2, bag_size: 1079
batch 39, loss: 0.6098, instance_loss: 0.4949, weighted_loss: 0.5754, label: 3, bag_size: 309
batch 59, loss: 2.2185, instance_loss: 0.6438, weighted_loss: 1.7461, label: 3, bag_size: 1147
batch 79, loss: 0.0000, instance_loss: 0.0679, weighted_loss: 0.0204, label: 4, bag_size: 813
batch 99, loss: 1.2776, instance_loss: 0.4596, weighted_loss: 1.0322, label: 1, bag_size: 1121
batch 119, loss: 3.1874, instance_loss: 0.6810, weighted_loss: 2.4355, label: 1, bag_size: 361
batch 139, loss: 0.6880, instance_loss: 0.4787, weighted_loss: 0.6252, label: 1, bag_size: 620
batch 159, loss: 1.3662, instance_loss: 0.4348, weighted_loss: 1.0868, label: 2, bag_size: 421
batch 179, loss: 0.5666, instance_loss: 0.4543, weighted_loss: 0.5329, label: 3, bag_size: 369
batch 199, loss: 1.0937, instance_loss: 0.4668, weighted_loss: 0.9056, label: 1, bag_size: 960
batch 219, loss: 0.6869, instance_loss: 0.4093, weighted_loss: 0.6036, label: 2, bag_size: 779
batch 239, loss: 1.1553, instance_loss: 0.4982, weighted_loss: 0.9582, label: 1, bag_size: 389
batch 259, loss: 1.0384, instance_loss: 0.5618, weighted_loss: 0.8954, label: 1, bag_size: 410
batch 279, loss: 0.7379, instance_loss: 0.4463, weighted_loss: 0.6504, label: 2, bag_size: 572
batch 299, loss: 0.6125, instance_loss: 0.4816, weighted_loss: 0.5732, label: 3, bag_size: 309
batch 319, loss: 0.0216, instance_loss: 0.2667, weighted_loss: 0.0951, label: 0, bag_size: 49
batch 339, loss: 1.6063, instance_loss: 0.6208, weighted_loss: 1.3106, label: 2, bag_size: 1074
batch 359, loss: 1.3734, instance_loss: 0.6283, weighted_loss: 1.1499, label: 3, bag_size: 476
batch 379, loss: 1.2647, instance_loss: 0.5911, weighted_loss: 1.0627, label: 1, bag_size: 371
batch 399, loss: 0.8443, instance_loss: 0.5015, weighted_loss: 0.7414, label: 3, bag_size: 996
batch 419, loss: 2.1622, instance_loss: 0.6513, weighted_loss: 1.7089, label: 0, bag_size: 311
batch 439, loss: 0.3232, instance_loss: 0.8987, weighted_loss: 0.4958, label: 4, bag_size: 359
batch 459, loss: 0.6909, instance_loss: 0.4886, weighted_loss: 0.6302, label: 1, bag_size: 328
batch 479, loss: 0.6516, instance_loss: 0.3658, weighted_loss: 0.5659, label: 2, bag_size: 404
batch 499, loss: 0.2496, instance_loss: 0.4346, weighted_loss: 0.3051, label: 0, bag_size: 74
batch 519, loss: 0.0030, instance_loss: 0.2117, weighted_loss: 0.0656, label: 0, bag_size: 80
batch 539, loss: 1.0638, instance_loss: 0.5152, weighted_loss: 0.8992, label: 3, bag_size: 457
batch 559, loss: 0.5649, instance_loss: 0.4584, weighted_loss: 0.5329, label: 4, bag_size: 263
batch 579, loss: 0.9745, instance_loss: 0.4575, weighted_loss: 0.8194, label: 3, bag_size: 443


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.04650673400673401: correct 221/4752
Epoch: 52, train_loss: 1.0536, train_clustering_loss:  0.4812, train_error: 0.4630
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.21153846153846154, correct 22/104
class 2: acc 0.5103448275862069, correct 74/145
class 3: acc 0.5409836065573771, correct 66/122
class 4: acc 0.6363636363636364, correct 77/121

Val Set, val_loss: 1.4510, val_error: 0.5946, auc: 0.7658
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0422, instance_loss: 0.4048, weighted_loss: 0.1510, label: 0, bag_size: 285
batch 39, loss: 1.0098, instance_loss: 0.4999, weighted_loss: 0.8568, label: 3, bag_size: 282
batch 59, loss: 3.0880, instance_loss: 0.6898, weighted_loss: 2.3686, label: 0, bag_size: 888
batch 79, loss: 1.0353, instance_loss: 0.4674, weighted_loss: 0.8649, label: 1, bag_size: 908
batch 99, loss: 1.3397, instance_loss: 0.4771, weighted_loss: 1.0810, label: 2, bag_size: 522
batch 119, loss: 0.8658, instance_loss: 0.4185, weighted_loss: 0.7316, label: 3, bag_size: 1078
batch 139, loss: 1.2323, instance_loss: 0.4890, weighted_loss: 1.0093, label: 2, bag_size: 1013
batch 159, loss: 2.1190, instance_loss: 0.5420, weighted_loss: 1.6459, label: 3, bag_size: 795
batch 179, loss: 0.4081, instance_loss: 0.4625, weighted_loss: 0.4244, label: 4, bag_size: 204
batch 199, loss: 0.8557, instance_loss: 0.4063, weighted_loss: 0.7209, label: 2, bag_size: 597
batch 219, loss: 1.0539, instance_loss: 0.5236, weighted_loss: 0.8948, label: 1, bag_size: 960
batch 239, loss: 1.3338, instance_loss: 0.4385, weighted_loss: 1.0652, label: 2, bag_size: 244
batch 259, loss: 1.1752, instance_loss: 0.4742, weighted_loss: 0.9649, label: 1, bag_size: 481
batch 279, loss: 0.8238, instance_loss: 0.4052, weighted_loss: 0.6982, label: 2, bag_size: 337
batch 299, loss: 0.7263, instance_loss: 0.3882, weighted_loss: 0.6249, label: 2, bag_size: 853
batch 319, loss: 0.7529, instance_loss: 0.4322, weighted_loss: 0.6567, label: 2, bag_size: 119
batch 339, loss: 0.8984, instance_loss: 0.5203, weighted_loss: 0.7850, label: 1, bag_size: 161
batch 359, loss: 0.8888, instance_loss: 0.5782, weighted_loss: 0.7956, label: 3, bag_size: 795
batch 379, loss: 0.6314, instance_loss: 0.3926, weighted_loss: 0.5598, label: 2, bag_size: 697
batch 399, loss: 0.8927, instance_loss: 0.3806, weighted_loss: 0.7391, label: 0, bag_size: 223
batch 419, loss: 0.7319, instance_loss: 0.5083, weighted_loss: 0.6649, label: 4, bag_size: 589
batch 439, loss: 1.2592, instance_loss: 0.4844, weighted_loss: 1.0267, label: 1, bag_size: 658
batch 459, loss: 0.7515, instance_loss: 0.4375, weighted_loss: 0.6573, label: 1, bag_size: 389
batch 479, loss: 0.1762, instance_loss: 0.4071, weighted_loss: 0.2455, label: 0, bag_size: 297
batch 499, loss: 0.7439, instance_loss: 0.4995, weighted_loss: 0.6706, label: 3, bag_size: 476
batch 519, loss: 0.4841, instance_loss: 0.4334, weighted_loss: 0.4689, label: 1, bag_size: 390
batch 539, loss: 1.0860, instance_loss: 0.4788, weighted_loss: 0.9038, label: 3, bag_size: 97
batch 559, loss: 0.0005, instance_loss: 0.1228, weighted_loss: 0.0372, label: 0, bag_size: 221
batch 579, loss: 2.3076, instance_loss: 0.5920, weighted_loss: 1.7929, label: 2, bag_size: 553


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.06418350168350169: correct 305/4752
Epoch: 53, train_loss: 0.9940, train_clustering_loss:  0.4707, train_error: 0.4343
class 0: acc 0.8048780487804879, correct 99/123
class 1: acc 0.47107438016528924, correct 57/121
class 2: acc 0.38596491228070173, correct 44/114
class 3: acc 0.5535714285714286, correct 62/112
class 4: acc 0.5967741935483871, correct 74/124

Val Set, val_loss: 1.2745, val_error: 0.5270, auc: 0.7947
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3071, instance_loss: 0.4319, weighted_loss: 0.3445, label: 0, bag_size: 73
batch 39, loss: 1.4998, instance_loss: 0.6813, weighted_loss: 1.2542, label: 3, bag_size: 674
batch 59, loss: 0.0564, instance_loss: 0.1567, weighted_loss: 0.0864, label: 0, bag_size: 49
batch 79, loss: 0.6782, instance_loss: 0.4609, weighted_loss: 0.6130, label: 4, bag_size: 293
batch 99, loss: 0.6028, instance_loss: 0.4496, weighted_loss: 0.5569, label: 1, bag_size: 605
batch 119, loss: 0.2114, instance_loss: 0.3965, weighted_loss: 0.2669, label: 4, bag_size: 685
batch 139, loss: 0.5759, instance_loss: 0.5518, weighted_loss: 0.5686, label: 3, bag_size: 684
batch 159, loss: 0.6171, instance_loss: 0.3797, weighted_loss: 0.5459, label: 4, bag_size: 727
batch 179, loss: 0.2896, instance_loss: 0.3759, weighted_loss: 0.3155, label: 0, bag_size: 223
batch 199, loss: 0.8409, instance_loss: 0.4880, weighted_loss: 0.7351, label: 0, bag_size: 600
batch 219, loss: 2.0063, instance_loss: 0.6044, weighted_loss: 1.5857, label: 2, bag_size: 860
batch 239, loss: 0.8409, instance_loss: 0.4547, weighted_loss: 0.7251, label: 4, bag_size: 639
batch 259, loss: 0.7954, instance_loss: 0.4344, weighted_loss: 0.6871, label: 2, bag_size: 285
batch 279, loss: 2.2732, instance_loss: 0.6075, weighted_loss: 1.7735, label: 2, bag_size: 1122
batch 299, loss: 0.5195, instance_loss: 0.5517, weighted_loss: 0.5292, label: 3, bag_size: 476
batch 319, loss: 1.9571, instance_loss: 0.5880, weighted_loss: 1.5464, label: 0, bag_size: 376
batch 339, loss: 0.4523, instance_loss: 0.4741, weighted_loss: 0.4589, label: 1, bag_size: 509
batch 359, loss: 0.6007, instance_loss: 0.4798, weighted_loss: 0.5645, label: 1, bag_size: 851
batch 379, loss: 0.2208, instance_loss: 0.6435, weighted_loss: 0.3476, label: 3, bag_size: 495
batch 399, loss: 1.2040, instance_loss: 0.5214, weighted_loss: 0.9992, label: 4, bag_size: 246
batch 419, loss: 0.5691, instance_loss: 0.4388, weighted_loss: 0.5300, label: 4, bag_size: 742
batch 439, loss: 1.4383, instance_loss: 0.4870, weighted_loss: 1.1529, label: 1, bag_size: 764
batch 459, loss: 0.6153, instance_loss: 0.3864, weighted_loss: 0.5467, label: 2, bag_size: 317
batch 479, loss: 1.2969, instance_loss: 0.6867, weighted_loss: 1.1138, label: 0, bag_size: 311
batch 499, loss: 0.5983, instance_loss: 0.3749, weighted_loss: 0.5313, label: 2, bag_size: 633
batch 519, loss: 1.6226, instance_loss: 0.5464, weighted_loss: 1.2997, label: 4, bag_size: 726
batch 539, loss: 1.6889, instance_loss: 0.6059, weighted_loss: 1.3640, label: 4, bag_size: 333
batch 559, loss: 0.8443, instance_loss: 0.5308, weighted_loss: 0.7502, label: 0, bag_size: 231
batch 579, loss: 0.8231, instance_loss: 0.4505, weighted_loss: 0.7113, label: 2, bag_size: 799


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.06439393939393939: correct 306/4752
Epoch: 54, train_loss: 1.0225, train_clustering_loss:  0.4772, train_error: 0.4545
class 0: acc 0.7661290322580645, correct 95/124
class 1: acc 0.2894736842105263, correct 33/114
class 2: acc 0.496551724137931, correct 72/145
class 3: acc 0.48936170212765956, correct 46/94
class 4: acc 0.6666666666666666, correct 78/117

Val Set, val_loss: 1.3307, val_error: 0.5270, auc: 0.7806
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3268, instance_loss: 0.4272, weighted_loss: 0.3569, label: 0, bag_size: 81
batch 39, loss: 0.9371, instance_loss: 0.4914, weighted_loss: 0.8034, label: 3, bag_size: 804
batch 59, loss: 1.1002, instance_loss: 0.5923, weighted_loss: 0.9478, label: 2, bag_size: 837
batch 79, loss: 1.0532, instance_loss: 0.5584, weighted_loss: 0.9048, label: 3, bag_size: 301
batch 99, loss: 1.0921, instance_loss: 0.5585, weighted_loss: 0.9320, label: 4, bag_size: 854
batch 119, loss: 0.8067, instance_loss: 0.4363, weighted_loss: 0.6956, label: 4, bag_size: 356
batch 139, loss: 0.2471, instance_loss: 0.3490, weighted_loss: 0.2777, label: 4, bag_size: 446
batch 159, loss: 0.8456, instance_loss: 0.4499, weighted_loss: 0.7269, label: 2, bag_size: 290
batch 179, loss: 1.0949, instance_loss: 0.5011, weighted_loss: 0.9168, label: 3, bag_size: 457
batch 199, loss: 1.2694, instance_loss: 0.5179, weighted_loss: 1.0440, label: 1, bag_size: 321
batch 219, loss: 0.5081, instance_loss: 0.3838, weighted_loss: 0.4708, label: 1, bag_size: 599
batch 239, loss: 0.8864, instance_loss: 0.4330, weighted_loss: 0.7504, label: 1, bag_size: 928
batch 259, loss: 1.2120, instance_loss: 0.7215, weighted_loss: 1.0648, label: 0, bag_size: 416
batch 279, loss: 2.2606, instance_loss: 0.5985, weighted_loss: 1.7620, label: 2, bag_size: 185
batch 299, loss: 3.4111, instance_loss: 0.8285, weighted_loss: 2.6363, label: 0, bag_size: 370
batch 319, loss: 1.1203, instance_loss: 0.4512, weighted_loss: 0.9196, label: 3, bag_size: 364
batch 339, loss: 0.3295, instance_loss: 0.4106, weighted_loss: 0.3538, label: 0, bag_size: 49
batch 359, loss: 0.8295, instance_loss: 0.4455, weighted_loss: 0.7143, label: 4, bag_size: 729
batch 379, loss: 0.9154, instance_loss: 0.5228, weighted_loss: 0.7976, label: 2, bag_size: 590
batch 399, loss: 0.3782, instance_loss: 0.5237, weighted_loss: 0.4219, label: 3, bag_size: 495
batch 419, loss: 0.9345, instance_loss: 0.4848, weighted_loss: 0.7996, label: 2, bag_size: 299
batch 439, loss: 1.8256, instance_loss: 0.5147, weighted_loss: 1.4324, label: 1, bag_size: 159
batch 459, loss: 1.2609, instance_loss: 0.4999, weighted_loss: 1.0326, label: 3, bag_size: 804
batch 479, loss: 1.0050, instance_loss: 0.4643, weighted_loss: 0.8428, label: 1, bag_size: 697
batch 499, loss: 0.9276, instance_loss: 0.4648, weighted_loss: 0.7888, label: 1, bag_size: 620
batch 519, loss: 0.9632, instance_loss: 0.4460, weighted_loss: 0.8080, label: 1, bag_size: 928
batch 539, loss: 0.0703, instance_loss: 0.3387, weighted_loss: 0.1508, label: 0, bag_size: 453
batch 559, loss: 0.6267, instance_loss: 0.4447, weighted_loss: 0.5721, label: 1, bag_size: 605
batch 579, loss: 0.1798, instance_loss: 0.4743, weighted_loss: 0.2681, label: 4, bag_size: 503


class 0 clustering acc 0.9965909090909091: correct 23679/23760
class 1 clustering acc 0.0664983164983165: correct 316/4752
Epoch: 55, train_loss: 1.0135, train_clustering_loss:  0.4756, train_error: 0.4512
class 0: acc 0.7967479674796748, correct 98/123
class 1: acc 0.5348837209302325, correct 69/129
class 2: acc 0.36507936507936506, correct 46/126
class 3: acc 0.4174757281553398, correct 43/103
class 4: acc 0.6194690265486725, correct 70/113

Val Set, val_loss: 1.3529, val_error: 0.5000, auc: 0.7735
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.03209459459459459: correct 19/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0261, instance_loss: 0.4413, weighted_loss: 0.1507, label: 2, bag_size: 340
batch 39, loss: 0.7694, instance_loss: 0.5544, weighted_loss: 0.7049, label: 3, bag_size: 872
batch 59, loss: 0.8899, instance_loss: 0.5163, weighted_loss: 0.7778, label: 3, bag_size: 899
batch 79, loss: 0.9087, instance_loss: 0.4898, weighted_loss: 0.7831, label: 1, bag_size: 620
batch 99, loss: 0.8804, instance_loss: 0.4377, weighted_loss: 0.7476, label: 2, bag_size: 317
batch 119, loss: 0.5082, instance_loss: 0.3845, weighted_loss: 0.4711, label: 2, bag_size: 616
batch 139, loss: 0.6556, instance_loss: 0.3503, weighted_loss: 0.5640, label: 2, bag_size: 779
batch 159, loss: 1.1860, instance_loss: 0.4726, weighted_loss: 0.9720, label: 1, bag_size: 1013
batch 179, loss: 1.8381, instance_loss: 0.7302, weighted_loss: 1.5057, label: 2, bag_size: 488
batch 199, loss: 1.0963, instance_loss: 0.5781, weighted_loss: 0.9408, label: 3, bag_size: 856
batch 219, loss: 0.0757, instance_loss: 0.3055, weighted_loss: 0.1447, label: 4, bag_size: 773
batch 239, loss: 1.7806, instance_loss: 0.5950, weighted_loss: 1.4249, label: 0, bag_size: 305
batch 259, loss: 0.0101, instance_loss: 0.1753, weighted_loss: 0.0597, label: 0, bag_size: 80
batch 279, loss: 0.0152, instance_loss: 0.2438, weighted_loss: 0.0838, label: 0, bag_size: 285
batch 299, loss: 0.9014, instance_loss: 0.5839, weighted_loss: 0.8061, label: 1, bag_size: 106
batch 319, loss: 1.2105, instance_loss: 0.5106, weighted_loss: 1.0005, label: 3, bag_size: 797
batch 339, loss: 1.1810, instance_loss: 0.5037, weighted_loss: 0.9778, label: 4, bag_size: 1031
batch 359, loss: 0.6182, instance_loss: 0.3557, weighted_loss: 0.5395, label: 4, bag_size: 714
batch 379, loss: 2.6266, instance_loss: 0.5946, weighted_loss: 2.0170, label: 4, bag_size: 1104
batch 399, loss: 0.5711, instance_loss: 0.5082, weighted_loss: 0.5522, label: 4, bag_size: 744
batch 419, loss: 0.0000, instance_loss: 0.3711, weighted_loss: 0.1113, label: 2, bag_size: 596
batch 439, loss: 2.2129, instance_loss: 0.4969, weighted_loss: 1.6981, label: 2, bag_size: 861
batch 459, loss: 0.0904, instance_loss: 0.3233, weighted_loss: 0.1603, label: 1, bag_size: 886
batch 479, loss: 0.7070, instance_loss: 0.3685, weighted_loss: 0.6054, label: 4, bag_size: 490
batch 499, loss: 0.0111, instance_loss: 0.4291, weighted_loss: 0.1365, label: 4, bag_size: 359
batch 519, loss: 2.5381, instance_loss: 0.6349, weighted_loss: 1.9671, label: 3, bag_size: 228
batch 539, loss: 0.6025, instance_loss: 0.4217, weighted_loss: 0.5483, label: 0, bag_size: 159
batch 559, loss: 0.3423, instance_loss: 0.4850, weighted_loss: 0.3851, label: 3, bag_size: 351
batch 579, loss: 0.8695, instance_loss: 0.5634, weighted_loss: 0.7777, label: 2, bag_size: 258


class 0 clustering acc 0.9957912457912458: correct 23660/23760
class 1 clustering acc 0.06186868686868687: correct 294/4752
Epoch: 56, train_loss: 0.9787, train_clustering_loss:  0.4743, train_error: 0.4276
class 0: acc 0.8508771929824561, correct 97/114
class 1: acc 0.4369747899159664, correct 52/119
class 2: acc 0.4344262295081967, correct 53/122
class 3: acc 0.47107438016528924, correct 57/121
class 4: acc 0.6864406779661016, correct 81/118

Val Set, val_loss: 1.4521, val_error: 0.5541, auc: 0.7630
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.4375, correct 7/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0030, instance_loss: 0.1211, weighted_loss: 0.0384, label: 0, bag_size: 101
batch 39, loss: 0.7165, instance_loss: 0.4547, weighted_loss: 0.6379, label: 1, bag_size: 620
batch 59, loss: 0.0277, instance_loss: 0.2002, weighted_loss: 0.0795, label: 0, bag_size: 98
batch 79, loss: 0.0232, instance_loss: 0.3119, weighted_loss: 0.1098, label: 0, bag_size: 428
batch 99, loss: 0.0469, instance_loss: 0.3045, weighted_loss: 0.1241, label: 0, bag_size: 295
batch 119, loss: 0.4727, instance_loss: 0.4520, weighted_loss: 0.4665, label: 1, bag_size: 410
batch 139, loss: 1.2804, instance_loss: 0.5580, weighted_loss: 1.0637, label: 3, bag_size: 97
batch 159, loss: 0.1522, instance_loss: 0.4196, weighted_loss: 0.2324, label: 0, bag_size: 552
batch 179, loss: 0.4415, instance_loss: 0.4271, weighted_loss: 0.4372, label: 4, bag_size: 797
batch 199, loss: 3.0364, instance_loss: 0.6684, weighted_loss: 2.3260, label: 3, bag_size: 663
batch 219, loss: 0.6410, instance_loss: 0.4360, weighted_loss: 0.5795, label: 2, bag_size: 321
batch 239, loss: 0.5293, instance_loss: 0.4291, weighted_loss: 0.4992, label: 4, bag_size: 744
batch 259, loss: 0.7499, instance_loss: 0.4076, weighted_loss: 0.6472, label: 2, bag_size: 781
batch 279, loss: 2.3496, instance_loss: 0.7152, weighted_loss: 1.8593, label: 0, bag_size: 888
batch 299, loss: 0.0040, instance_loss: 0.1232, weighted_loss: 0.0398, label: 0, bag_size: 221
batch 319, loss: 0.9634, instance_loss: 0.4703, weighted_loss: 0.8155, label: 1, bag_size: 1013
batch 339, loss: 1.7500, instance_loss: 0.5346, weighted_loss: 1.3854, label: 2, bag_size: 605
batch 359, loss: 1.1794, instance_loss: 0.4773, weighted_loss: 0.9688, label: 3, bag_size: 520
batch 379, loss: 3.5183, instance_loss: 0.6069, weighted_loss: 2.6449, label: 2, bag_size: 351
batch 399, loss: 0.8157, instance_loss: 0.4780, weighted_loss: 0.7144, label: 1, bag_size: 481
batch 419, loss: 0.0067, instance_loss: 0.5149, weighted_loss: 0.1591, label: 4, bag_size: 359
batch 439, loss: 1.3192, instance_loss: 0.5311, weighted_loss: 1.0828, label: 3, bag_size: 228
batch 459, loss: 2.1947, instance_loss: 0.6597, weighted_loss: 1.7342, label: 2, bag_size: 582
batch 479, loss: 0.8009, instance_loss: 0.4586, weighted_loss: 0.6982, label: 4, bag_size: 113
batch 499, loss: 0.3140, instance_loss: 0.4233, weighted_loss: 0.3468, label: 0, bag_size: 122
batch 519, loss: 0.2439, instance_loss: 0.3403, weighted_loss: 0.2728, label: 0, bag_size: 324
batch 539, loss: 0.0001, instance_loss: 0.3633, weighted_loss: 0.1091, label: 0, bag_size: 1570
batch 559, loss: 0.8469, instance_loss: 0.3769, weighted_loss: 0.7059, label: 4, bag_size: 46
batch 579, loss: 0.7524, instance_loss: 0.4487, weighted_loss: 0.6613, label: 3, bag_size: 510


class 0 clustering acc 0.9947811447811448: correct 23636/23760
class 1 clustering acc 0.07365319865319865: correct 350/4752
Epoch: 57, train_loss: 1.0362, train_clustering_loss:  0.4755, train_error: 0.4158
class 0: acc 0.7844827586206896, correct 91/116
class 1: acc 0.4608695652173913, correct 53/115
class 2: acc 0.4117647058823529, correct 49/119
class 3: acc 0.4824561403508772, correct 55/114
class 4: acc 0.7615384615384615, correct 99/130

Val Set, val_loss: 1.3126, val_error: 0.5270, auc: 0.7791
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.4035, instance_loss: 0.5635, weighted_loss: 1.1515, label: 2, bag_size: 321
batch 39, loss: 0.4510, instance_loss: 0.3588, weighted_loss: 0.4234, label: 4, bag_size: 409
batch 59, loss: 0.9212, instance_loss: 0.5805, weighted_loss: 0.8190, label: 2, bag_size: 96
batch 79, loss: 0.0566, instance_loss: 0.2443, weighted_loss: 0.1129, label: 0, bag_size: 79
batch 99, loss: 0.1555, instance_loss: 0.2703, weighted_loss: 0.1899, label: 0, bag_size: 138
batch 119, loss: 0.4682, instance_loss: 0.3914, weighted_loss: 0.4451, label: 4, bag_size: 726
batch 139, loss: 1.3051, instance_loss: 0.4550, weighted_loss: 1.0501, label: 4, bag_size: 98
batch 159, loss: 1.2932, instance_loss: 0.4815, weighted_loss: 1.0497, label: 2, bag_size: 445
batch 179, loss: 0.0349, instance_loss: 0.2060, weighted_loss: 0.0862, label: 0, bag_size: 453
batch 199, loss: 1.0581, instance_loss: 0.4382, weighted_loss: 0.8721, label: 2, bag_size: 290
batch 219, loss: 0.6706, instance_loss: 0.4474, weighted_loss: 0.6036, label: 1, bag_size: 1103
batch 239, loss: 1.3184, instance_loss: 0.5732, weighted_loss: 1.0948, label: 2, bag_size: 318
batch 259, loss: 0.5933, instance_loss: 0.4436, weighted_loss: 0.5483, label: 0, bag_size: 230
batch 279, loss: 0.8845, instance_loss: 0.5978, weighted_loss: 0.7985, label: 3, bag_size: 520
batch 299, loss: 0.7009, instance_loss: 0.4266, weighted_loss: 0.6186, label: 4, bag_size: 277
batch 319, loss: 0.1156, instance_loss: 0.3162, weighted_loss: 0.1758, label: 0, bag_size: 357
batch 339, loss: 1.4331, instance_loss: 0.5338, weighted_loss: 1.1633, label: 3, bag_size: 856
batch 359, loss: 0.1516, instance_loss: 0.4064, weighted_loss: 0.2281, label: 0, bag_size: 282
batch 379, loss: 1.0021, instance_loss: 0.5038, weighted_loss: 0.8526, label: 4, bag_size: 703
batch 399, loss: 0.7995, instance_loss: 0.4080, weighted_loss: 0.6821, label: 2, bag_size: 567
batch 419, loss: 1.3814, instance_loss: 0.6059, weighted_loss: 1.1488, label: 3, bag_size: 486
batch 439, loss: 0.4166, instance_loss: 0.4008, weighted_loss: 0.4118, label: 4, bag_size: 574
batch 459, loss: 0.9440, instance_loss: 0.4898, weighted_loss: 0.8078, label: 3, bag_size: 309
batch 479, loss: 1.0693, instance_loss: 0.4383, weighted_loss: 0.8800, label: 2, bag_size: 445
batch 499, loss: 0.0006, instance_loss: 0.7258, weighted_loss: 0.2182, label: 4, bag_size: 1351
batch 519, loss: 0.5267, instance_loss: 0.5803, weighted_loss: 0.5428, label: 3, bag_size: 301
batch 539, loss: 0.9970, instance_loss: 0.4884, weighted_loss: 0.8444, label: 3, bag_size: 641
batch 559, loss: 0.7474, instance_loss: 0.5137, weighted_loss: 0.6773, label: 2, bag_size: 286
batch 579, loss: 1.3027, instance_loss: 0.5758, weighted_loss: 1.0847, label: 3, bag_size: 443


class 0 clustering acc 0.995496632996633: correct 23653/23760
class 1 clustering acc 0.08333333333333333: correct 396/4752
Epoch: 58, train_loss: 0.9812, train_clustering_loss:  0.4710, train_error: 0.4259
class 0: acc 0.7948717948717948, correct 93/117
class 1: acc 0.6, correct 81/135
class 2: acc 0.3008130081300813, correct 37/123
class 3: acc 0.5363636363636364, correct 59/110
class 4: acc 0.6513761467889908, correct 71/109

Val Set, val_loss: 1.3068, val_error: 0.5135, auc: 0.7837
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.7206, instance_loss: 0.4394, weighted_loss: 0.6362, label: 4, bag_size: 1018
batch 39, loss: 0.7214, instance_loss: 0.5107, weighted_loss: 0.6582, label: 4, bag_size: 731
batch 59, loss: 0.0713, instance_loss: 0.2995, weighted_loss: 0.1398, label: 0, bag_size: 79
batch 79, loss: 0.8856, instance_loss: 0.4962, weighted_loss: 0.7687, label: 3, bag_size: 459
batch 99, loss: 0.7576, instance_loss: 0.4209, weighted_loss: 0.6566, label: 4, bag_size: 46
batch 119, loss: 1.0209, instance_loss: 0.5447, weighted_loss: 0.8780, label: 2, bag_size: 240
batch 139, loss: 1.1239, instance_loss: 0.4271, weighted_loss: 0.9149, label: 1, bag_size: 697
batch 159, loss: 0.0000, instance_loss: 0.4542, weighted_loss: 0.1363, label: 2, bag_size: 936
batch 179, loss: 1.1396, instance_loss: 0.4547, weighted_loss: 0.9341, label: 1, bag_size: 525
batch 199, loss: 0.7772, instance_loss: 0.4252, weighted_loss: 0.6716, label: 4, bag_size: 775
batch 219, loss: 2.2872, instance_loss: 0.7821, weighted_loss: 1.8356, label: 2, bag_size: 258
batch 239, loss: 0.5500, instance_loss: 0.4596, weighted_loss: 0.5229, label: 1, bag_size: 490
batch 259, loss: 2.4376, instance_loss: 0.6198, weighted_loss: 1.8923, label: 2, bag_size: 549
batch 279, loss: 0.7344, instance_loss: 0.4813, weighted_loss: 0.6585, label: 2, bag_size: 258
batch 299, loss: 0.2069, instance_loss: 0.3549, weighted_loss: 0.2513, label: 0, bag_size: 354
batch 319, loss: 0.5825, instance_loss: 0.4219, weighted_loss: 0.5343, label: 1, bag_size: 526
batch 339, loss: 0.0688, instance_loss: 0.4170, weighted_loss: 0.1732, label: 0, bag_size: 552
batch 359, loss: 4.2529, instance_loss: 0.5293, weighted_loss: 3.1358, label: 4, bag_size: 101
batch 379, loss: 0.1715, instance_loss: 0.5491, weighted_loss: 0.2848, label: 3, bag_size: 301
batch 399, loss: 1.1230, instance_loss: 0.4856, weighted_loss: 0.9318, label: 0, bag_size: 305
batch 419, loss: 0.0296, instance_loss: 0.2591, weighted_loss: 0.0985, label: 0, bag_size: 70
batch 439, loss: 0.0003, instance_loss: 0.5485, weighted_loss: 0.1647, label: 0, bag_size: 1570
batch 459, loss: 0.7982, instance_loss: 0.4567, weighted_loss: 0.6957, label: 2, bag_size: 572
batch 479, loss: 0.9302, instance_loss: 0.4830, weighted_loss: 0.7961, label: 4, bag_size: 1297
batch 499, loss: 1.2511, instance_loss: 0.4555, weighted_loss: 1.0124, label: 1, bag_size: 413
batch 519, loss: 3.4923, instance_loss: 0.7025, weighted_loss: 2.6554, label: 4, bag_size: 270
batch 539, loss: 2.3601, instance_loss: 0.5524, weighted_loss: 1.8178, label: 2, bag_size: 380
batch 559, loss: 1.6238, instance_loss: 0.5780, weighted_loss: 1.3100, label: 4, bag_size: 395
batch 579, loss: 0.9179, instance_loss: 0.5327, weighted_loss: 0.8023, label: 2, bag_size: 367


class 0 clustering acc 0.9952861952861953: correct 23648/23760
class 1 clustering acc 0.06186868686868687: correct 294/4752
Epoch: 59, train_loss: 1.0046, train_clustering_loss:  0.4784, train_error: 0.4360
class 0: acc 0.8188976377952756, correct 104/127
class 1: acc 0.5882352941176471, correct 80/136
class 2: acc 0.2608695652173913, correct 30/115
class 3: acc 0.5092592592592593, correct 55/108
class 4: acc 0.6111111111111112, correct 66/108

Val Set, val_loss: 1.2651, val_error: 0.4730, auc: 0.7874
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.8687, instance_loss: 0.4709, weighted_loss: 0.7493, label: 1, bag_size: 328
batch 39, loss: 1.8776, instance_loss: 0.4507, weighted_loss: 1.4496, label: 1, bag_size: 840
batch 59, loss: 0.7226, instance_loss: 0.4568, weighted_loss: 0.6428, label: 0, bag_size: 613
batch 79, loss: 1.0323, instance_loss: 0.4830, weighted_loss: 0.8675, label: 4, bag_size: 46
batch 99, loss: 0.5830, instance_loss: 0.4104, weighted_loss: 0.5312, label: 2, bag_size: 1079
batch 119, loss: 3.4051, instance_loss: 0.6722, weighted_loss: 2.5853, label: 1, bag_size: 45
batch 139, loss: 0.3694, instance_loss: 0.4062, weighted_loss: 0.3805, label: 0, bag_size: 295
batch 159, loss: 0.0141, instance_loss: 0.1847, weighted_loss: 0.0653, label: 0, bag_size: 80
batch 179, loss: 0.3355, instance_loss: 0.3915, weighted_loss: 0.3523, label: 3, bag_size: 194
batch 199, loss: 0.7272, instance_loss: 0.4384, weighted_loss: 0.6406, label: 1, bag_size: 221
batch 219, loss: 0.8358, instance_loss: 0.4121, weighted_loss: 0.7087, label: 2, bag_size: 290
batch 239, loss: 0.5355, instance_loss: 0.4768, weighted_loss: 0.5179, label: 3, bag_size: 928
batch 259, loss: 1.7668, instance_loss: 0.5208, weighted_loss: 1.3930, label: 3, bag_size: 486
batch 279, loss: 0.0000, instance_loss: 0.5270, weighted_loss: 0.1581, label: 0, bag_size: 283
batch 299, loss: 1.5693, instance_loss: 0.6217, weighted_loss: 1.2850, label: 0, bag_size: 710
batch 319, loss: 0.5466, instance_loss: 0.5738, weighted_loss: 0.5547, label: 2, bag_size: 549
batch 339, loss: 0.7588, instance_loss: 0.4859, weighted_loss: 0.6769, label: 3, bag_size: 1021
batch 359, loss: 0.2584, instance_loss: 0.3681, weighted_loss: 0.2914, label: 4, bag_size: 948
batch 379, loss: 1.0262, instance_loss: 0.4129, weighted_loss: 0.8422, label: 3, bag_size: 796
batch 399, loss: 0.3705, instance_loss: 0.3841, weighted_loss: 0.3746, label: 2, bag_size: 614
batch 419, loss: 0.2369, instance_loss: 0.3133, weighted_loss: 0.2598, label: 4, bag_size: 776
batch 439, loss: 1.2802, instance_loss: 0.4579, weighted_loss: 1.0335, label: 3, bag_size: 192
batch 459, loss: 3.1164, instance_loss: 0.7211, weighted_loss: 2.3978, label: 1, bag_size: 361
batch 479, loss: 2.0832, instance_loss: 0.4613, weighted_loss: 1.5966, label: 3, bag_size: 166
batch 499, loss: 0.3001, instance_loss: 0.5512, weighted_loss: 0.3754, label: 0, bag_size: 416
batch 519, loss: 0.3932, instance_loss: 0.3827, weighted_loss: 0.3900, label: 4, bag_size: 895
batch 539, loss: 1.1827, instance_loss: 0.5890, weighted_loss: 1.0046, label: 0, bag_size: 1085
batch 559, loss: 0.3830, instance_loss: 0.4131, weighted_loss: 0.3920, label: 4, bag_size: 263
batch 579, loss: 1.0071, instance_loss: 0.5867, weighted_loss: 0.8810, label: 4, bag_size: 312


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.050505050505050504: correct 240/4752
Epoch: 60, train_loss: 0.9350, train_clustering_loss:  0.4778, train_error: 0.4125
class 0: acc 0.8333333333333334, correct 95/114
class 1: acc 0.4661016949152542, correct 55/118
class 2: acc 0.43103448275862066, correct 50/116
class 3: acc 0.6190476190476191, correct 78/126
class 4: acc 0.5916666666666667, correct 71/120

Val Set, val_loss: 1.4099, val_error: 0.5405, auc: 0.7575
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1105, instance_loss: 0.2850, weighted_loss: 0.1628, label: 0, bag_size: 573
batch 39, loss: 0.0265, instance_loss: 0.2150, weighted_loss: 0.0830, label: 0, bag_size: 156
batch 59, loss: 0.7951, instance_loss: 0.4604, weighted_loss: 0.6947, label: 4, bag_size: 246
batch 79, loss: 0.2585, instance_loss: 0.4917, weighted_loss: 0.3285, label: 4, bag_size: 1113
batch 99, loss: 0.5307, instance_loss: 0.4895, weighted_loss: 0.5183, label: 3, bag_size: 1284
batch 119, loss: 0.4448, instance_loss: 0.6075, weighted_loss: 0.4936, label: 2, bag_size: 864
batch 139, loss: 0.8141, instance_loss: 0.6373, weighted_loss: 0.7611, label: 2, bag_size: 133
batch 159, loss: 2.1615, instance_loss: 0.5870, weighted_loss: 1.6891, label: 2, bag_size: 219
batch 179, loss: 0.8182, instance_loss: 0.4562, weighted_loss: 0.7096, label: 1, bag_size: 591
batch 199, loss: 0.5267, instance_loss: 0.4347, weighted_loss: 0.4991, label: 1, bag_size: 444
batch 219, loss: 3.4736, instance_loss: 0.6493, weighted_loss: 2.6263, label: 2, bag_size: 563
batch 239, loss: 1.7998, instance_loss: 0.5511, weighted_loss: 1.4252, label: 2, bag_size: 717
batch 259, loss: 0.9188, instance_loss: 0.4406, weighted_loss: 0.7753, label: 2, bag_size: 258
batch 279, loss: 0.6561, instance_loss: 0.4421, weighted_loss: 0.5919, label: 1, bag_size: 332
batch 299, loss: 0.8704, instance_loss: 0.5237, weighted_loss: 0.7664, label: 4, bag_size: 1297
batch 319, loss: 1.2430, instance_loss: 0.4692, weighted_loss: 1.0108, label: 2, bag_size: 725
batch 339, loss: 0.7657, instance_loss: 0.5875, weighted_loss: 0.7123, label: 3, bag_size: 228
batch 359, loss: 0.8436, instance_loss: 0.4002, weighted_loss: 0.7106, label: 2, bag_size: 906
batch 379, loss: 1.5373, instance_loss: 0.4966, weighted_loss: 1.2251, label: 1, bag_size: 1019
batch 399, loss: 0.0467, instance_loss: 0.4148, weighted_loss: 0.1571, label: 4, bag_size: 1113
batch 419, loss: 3.0220, instance_loss: 0.6139, weighted_loss: 2.2996, label: 2, bag_size: 512
batch 439, loss: 0.1174, instance_loss: 0.2749, weighted_loss: 0.1647, label: 0, bag_size: 517
batch 459, loss: 1.2395, instance_loss: 0.5579, weighted_loss: 1.0350, label: 3, bag_size: 457
batch 479, loss: 0.7627, instance_loss: 0.4910, weighted_loss: 0.6812, label: 3, bag_size: 928
batch 499, loss: 0.8320, instance_loss: 0.5133, weighted_loss: 0.7364, label: 3, bag_size: 1076
batch 519, loss: 2.1912, instance_loss: 0.6038, weighted_loss: 1.7150, label: 2, bag_size: 582
batch 539, loss: 0.9394, instance_loss: 0.4920, weighted_loss: 0.8052, label: 3, bag_size: 533
batch 559, loss: 0.6802, instance_loss: 0.4172, weighted_loss: 0.6013, label: 2, bag_size: 244
batch 579, loss: 1.4721, instance_loss: 0.5460, weighted_loss: 1.1943, label: 3, bag_size: 856


class 0 clustering acc 0.9983585858585858: correct 23721/23760
class 1 clustering acc 0.05576599326599327: correct 265/4752
Epoch: 61, train_loss: 1.0162, train_clustering_loss:  0.4773, train_error: 0.4125
class 0: acc 0.8632478632478633, correct 101/117
class 1: acc 0.45714285714285713, correct 48/105
class 2: acc 0.3898305084745763, correct 46/118
class 3: acc 0.44166666666666665, correct 53/120
class 4: acc 0.753731343283582, correct 101/134

Val Set, val_loss: 1.5639, val_error: 0.6216, auc: 0.7430
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.0852, instance_loss: 0.4616, weighted_loss: 0.8981, label: 2, bag_size: 1013
batch 39, loss: 1.0723, instance_loss: 0.4873, weighted_loss: 0.8968, label: 3, bag_size: 1358
batch 59, loss: 0.0001, instance_loss: 0.4231, weighted_loss: 0.1270, label: 4, bag_size: 541
batch 79, loss: 2.6619, instance_loss: 0.6705, weighted_loss: 2.0644, label: 1, bag_size: 361
batch 99, loss: 1.2880, instance_loss: 0.5021, weighted_loss: 1.0522, label: 3, bag_size: 779
batch 119, loss: 0.2970, instance_loss: 0.4530, weighted_loss: 0.3438, label: 0, bag_size: 397
batch 139, loss: 0.0193, instance_loss: 0.1937, weighted_loss: 0.0716, label: 0, bag_size: 74
batch 159, loss: 0.6843, instance_loss: 0.5404, weighted_loss: 0.6411, label: 2, bag_size: 25
batch 179, loss: 0.8896, instance_loss: 0.4924, weighted_loss: 0.7704, label: 4, bag_size: 685
batch 199, loss: 1.1872, instance_loss: 0.4516, weighted_loss: 0.9665, label: 2, bag_size: 1003
batch 219, loss: 0.4621, instance_loss: 0.4065, weighted_loss: 0.4454, label: 4, bag_size: 886
batch 239, loss: 0.6315, instance_loss: 0.4875, weighted_loss: 0.5883, label: 1, bag_size: 460
batch 259, loss: 0.3693, instance_loss: 0.3859, weighted_loss: 0.3743, label: 2, bag_size: 363
batch 279, loss: 0.0413, instance_loss: 0.3244, weighted_loss: 0.1262, label: 0, bag_size: 435
batch 299, loss: 0.0194, instance_loss: 0.1526, weighted_loss: 0.0594, label: 0, bag_size: 350
batch 319, loss: 0.4466, instance_loss: 0.4178, weighted_loss: 0.4380, label: 2, bag_size: 244
batch 339, loss: 0.1971, instance_loss: 0.2987, weighted_loss: 0.2276, label: 4, bag_size: 948
batch 359, loss: 2.4444, instance_loss: 0.6603, weighted_loss: 1.9091, label: 2, bag_size: 1319
batch 379, loss: 0.0013, instance_loss: 0.2482, weighted_loss: 0.0753, label: 0, bag_size: 230
batch 399, loss: 0.1252, instance_loss: 0.4382, weighted_loss: 0.2191, label: 0, bag_size: 316
batch 419, loss: 0.6724, instance_loss: 0.3964, weighted_loss: 0.5896, label: 2, bag_size: 315
batch 439, loss: 0.3256, instance_loss: 0.4546, weighted_loss: 0.3643, label: 0, bag_size: 317
batch 459, loss: 1.3044, instance_loss: 0.4514, weighted_loss: 1.0485, label: 3, bag_size: 472
batch 479, loss: 0.0591, instance_loss: 0.1885, weighted_loss: 0.0979, label: 4, bag_size: 627
batch 499, loss: 0.8416, instance_loss: 0.4455, weighted_loss: 0.7228, label: 0, bag_size: 478
batch 519, loss: 2.7722, instance_loss: 0.5715, weighted_loss: 2.1120, label: 2, bag_size: 512
batch 539, loss: 0.9023, instance_loss: 0.4399, weighted_loss: 0.7636, label: 4, bag_size: 233
batch 559, loss: 0.5487, instance_loss: 0.5275, weighted_loss: 0.5423, label: 0, bag_size: 578
batch 579, loss: 0.0174, instance_loss: 0.2924, weighted_loss: 0.0999, label: 0, bag_size: 533


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.06776094276094276: correct 322/4752
Epoch: 62, train_loss: 0.9851, train_clustering_loss:  0.4754, train_error: 0.4310
class 0: acc 0.7886178861788617, correct 97/123
class 1: acc 0.4117647058823529, correct 49/119
class 2: acc 0.48872180451127817, correct 65/133
class 3: acc 0.42424242424242425, correct 42/99
class 4: acc 0.7083333333333334, correct 85/120

Val Set, val_loss: 1.4210, val_error: 0.5270, auc: 0.7581
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5000, ROC AUC: 0.7926
Test error: 0.5541, ROC AUC: 0.7827
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.14285714285714285, correct 2/14

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9333, instance_loss: 0.6357, weighted_loss: 1.5440, label: 1, bag_size: 1121
batch 39, loss: 2.3609, instance_loss: 0.5526, weighted_loss: 1.8184, label: 2, bag_size: 299
batch 59, loss: 2.6512, instance_loss: 0.5381, weighted_loss: 2.0173, label: 3, bag_size: 1022
batch 79, loss: 1.0194, instance_loss: 0.5428, weighted_loss: 0.8764, label: 1, bag_size: 669
batch 99, loss: 2.3167, instance_loss: 0.5414, weighted_loss: 1.7841, label: 2, bag_size: 369
batch 119, loss: 0.6667, instance_loss: 0.4253, weighted_loss: 0.5943, label: 3, bag_size: 459
batch 139, loss: 1.3832, instance_loss: 0.4783, weighted_loss: 1.1117, label: 2, bag_size: 606
batch 159, loss: 1.9263, instance_loss: 0.5194, weighted_loss: 1.5042, label: 2, bag_size: 177
batch 179, loss: 2.3107, instance_loss: 0.5322, weighted_loss: 1.7772, label: 3, bag_size: 505
batch 199, loss: 1.9228, instance_loss: 0.5206, weighted_loss: 1.5021, label: 2, bag_size: 253
batch 219, loss: 1.6877, instance_loss: 0.5667, weighted_loss: 1.3514, label: 0, bag_size: 581
batch 239, loss: 2.2740, instance_loss: 0.5825, weighted_loss: 1.7666, label: 4, bag_size: 333
batch 259, loss: 1.8905, instance_loss: 0.6028, weighted_loss: 1.5042, label: 0, bag_size: 581
batch 279, loss: 1.3834, instance_loss: 0.5221, weighted_loss: 1.1250, label: 4, bag_size: 853
batch 299, loss: 0.9799, instance_loss: 0.5300, weighted_loss: 0.8449, label: 0, bag_size: 477
batch 319, loss: 1.4816, instance_loss: 0.5270, weighted_loss: 1.1952, label: 3, bag_size: 780
batch 339, loss: 1.8090, instance_loss: 0.4678, weighted_loss: 1.4067, label: 1, bag_size: 855
batch 359, loss: 1.5109, instance_loss: 0.5038, weighted_loss: 1.2088, label: 4, bag_size: 589
batch 379, loss: 1.5914, instance_loss: 0.5346, weighted_loss: 1.2744, label: 2, bag_size: 582
batch 399, loss: 0.4301, instance_loss: 0.4121, weighted_loss: 0.4247, label: 0, bag_size: 77
batch 419, loss: 2.3266, instance_loss: 0.5293, weighted_loss: 1.7874, label: 1, bag_size: 391
batch 439, loss: 2.2226, instance_loss: 0.5234, weighted_loss: 1.7128, label: 0, bag_size: 578
batch 459, loss: 0.8840, instance_loss: 0.4313, weighted_loss: 0.7482, label: 1, bag_size: 1104
batch 479, loss: 3.0597, instance_loss: 0.5102, weighted_loss: 2.2949, label: 0, bag_size: 62
batch 499, loss: 1.8602, instance_loss: 0.5370, weighted_loss: 1.4632, label: 3, bag_size: 301
batch 519, loss: 1.1293, instance_loss: 0.4312, weighted_loss: 0.9199, label: 1, bag_size: 1497
batch 539, loss: 1.2797, instance_loss: 0.5583, weighted_loss: 1.0633, label: 3, bag_size: 498
batch 559, loss: 1.3498, instance_loss: 0.4724, weighted_loss: 1.0866, label: 4, bag_size: 218
batch 579, loss: 1.5632, instance_loss: 0.4972, weighted_loss: 1.2434, label: 2, bag_size: 746


class 0 clustering acc 0.9984006734006734: correct 23722/23760
class 1 clustering acc 0.002946127946127946: correct 14/4752
Epoch: 0, train_loss: 1.5177, train_clustering_loss:  0.5234, train_error: 0.6465
class 0: acc 0.6754385964912281, correct 77/114
class 1: acc 0.3769230769230769, correct 49/130
class 2: acc 0.17094017094017094, correct 20/117
class 3: acc 0.2222222222222222, correct 26/117
class 4: acc 0.3275862068965517, correct 38/116

Val Set, val_loss: 1.4179, val_error: 0.5811, auc: 0.7414
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.07142857142857142, correct 1/14
Validation loss decreased (inf --> 1.417915).  Saving model ...


batch 19, loss: 1.9015, instance_loss: 0.5602, weighted_loss: 1.4991, label: 3, bag_size: 97
batch 39, loss: 0.9569, instance_loss: 0.5991, weighted_loss: 0.8496, label: 0, bag_size: 435
batch 59, loss: 2.1338, instance_loss: 0.5529, weighted_loss: 1.6596, label: 0, bag_size: 964
batch 79, loss: 0.9322, instance_loss: 0.4896, weighted_loss: 0.7994, label: 2, bag_size: 376
batch 99, loss: 0.9059, instance_loss: 0.5014, weighted_loss: 0.7845, label: 2, bag_size: 530
batch 119, loss: 1.0668, instance_loss: 0.4286, weighted_loss: 0.8754, label: 1, bag_size: 1023
batch 139, loss: 0.7903, instance_loss: 0.4051, weighted_loss: 0.6748, label: 1, bag_size: 106
batch 159, loss: 1.3444, instance_loss: 0.5465, weighted_loss: 1.1050, label: 4, bag_size: 446
batch 179, loss: 3.9634, instance_loss: 0.7275, weighted_loss: 2.9926, label: 0, bag_size: 1085
batch 199, loss: 1.9952, instance_loss: 0.5576, weighted_loss: 1.5639, label: 0, bag_size: 710
batch 219, loss: 0.9456, instance_loss: 0.4221, weighted_loss: 0.7885, label: 0, bag_size: 351
batch 239, loss: 2.8088, instance_loss: 0.6609, weighted_loss: 2.1644, label: 2, bag_size: 554
batch 259, loss: 1.7716, instance_loss: 0.4904, weighted_loss: 1.3872, label: 1, bag_size: 564
batch 279, loss: 0.7966, instance_loss: 0.4300, weighted_loss: 0.6866, label: 0, bag_size: 493
batch 299, loss: 1.2001, instance_loss: 0.5059, weighted_loss: 0.9918, label: 3, bag_size: 301
batch 319, loss: 0.1113, instance_loss: 0.3665, weighted_loss: 0.1879, label: 0, bag_size: 37
batch 339, loss: 0.2768, instance_loss: 0.3638, weighted_loss: 0.3029, label: 0, bag_size: 212
batch 359, loss: 0.7008, instance_loss: 0.4573, weighted_loss: 0.6278, label: 4, bag_size: 503
batch 379, loss: 1.0278, instance_loss: 0.4122, weighted_loss: 0.8432, label: 3, bag_size: 235
batch 399, loss: 1.6763, instance_loss: 0.4694, weighted_loss: 1.3142, label: 4, bag_size: 318
batch 419, loss: 1.4416, instance_loss: 0.4723, weighted_loss: 1.1508, label: 1, bag_size: 764
batch 439, loss: 1.7661, instance_loss: 0.4943, weighted_loss: 1.3846, label: 4, bag_size: 498
batch 459, loss: 2.7937, instance_loss: 0.5298, weighted_loss: 2.1145, label: 0, bag_size: 62
batch 479, loss: 1.8283, instance_loss: 0.5887, weighted_loss: 1.4564, label: 4, bag_size: 986
batch 499, loss: 0.7870, instance_loss: 0.4200, weighted_loss: 0.6769, label: 0, bag_size: 277
batch 519, loss: 0.9478, instance_loss: 0.4629, weighted_loss: 0.8024, label: 2, bag_size: 613
batch 539, loss: 0.2175, instance_loss: 0.4007, weighted_loss: 0.2725, label: 0, bag_size: 340
batch 559, loss: 3.2686, instance_loss: 0.6616, weighted_loss: 2.4865, label: 3, bag_size: 638
batch 579, loss: 1.3966, instance_loss: 0.4781, weighted_loss: 1.1211, label: 2, bag_size: 934


class 0 clustering acc 1.0: correct 23760/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 1, train_loss: 1.4180, train_clustering_loss:  0.5044, train_error: 0.6162
class 0: acc 0.773109243697479, correct 92/119
class 1: acc 0.2248062015503876, correct 29/129
class 2: acc 0.2767857142857143, correct 31/112
class 3: acc 0.373015873015873, correct 47/126
class 4: acc 0.26851851851851855, correct 29/108

Val Set, val_loss: 1.4678, val_error: 0.6622, auc: 0.6796
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9802, instance_loss: 0.4319, weighted_loss: 0.8157, label: 3, bag_size: 432
batch 39, loss: 1.3984, instance_loss: 0.5964, weighted_loss: 1.1578, label: 1, bag_size: 410
batch 59, loss: 2.2107, instance_loss: 0.5453, weighted_loss: 1.7111, label: 2, bag_size: 629
batch 79, loss: 0.3772, instance_loss: 0.3885, weighted_loss: 0.3806, label: 0, bag_size: 230
batch 99, loss: 0.4026, instance_loss: 0.4653, weighted_loss: 0.4214, label: 4, bag_size: 129
batch 119, loss: 1.5832, instance_loss: 0.5156, weighted_loss: 1.2629, label: 1, bag_size: 391
batch 139, loss: 1.2659, instance_loss: 0.5053, weighted_loss: 1.0377, label: 3, bag_size: 1060
batch 159, loss: 1.7328, instance_loss: 0.5242, weighted_loss: 1.3702, label: 4, bag_size: 438
batch 179, loss: 2.1832, instance_loss: 0.6028, weighted_loss: 1.7091, label: 1, bag_size: 381
batch 199, loss: 1.4111, instance_loss: 0.5586, weighted_loss: 1.1553, label: 1, bag_size: 201
batch 219, loss: 0.5433, instance_loss: 0.4141, weighted_loss: 0.5046, label: 0, bag_size: 231
batch 239, loss: 1.0801, instance_loss: 0.4463, weighted_loss: 0.8900, label: 4, bag_size: 530
batch 259, loss: 1.2235, instance_loss: 0.5718, weighted_loss: 1.0280, label: 3, bag_size: 780
batch 279, loss: 1.4730, instance_loss: 0.5209, weighted_loss: 1.1874, label: 1, bag_size: 490
batch 299, loss: 0.1707, instance_loss: 0.3538, weighted_loss: 0.2256, label: 0, bag_size: 133
batch 319, loss: 1.5007, instance_loss: 0.6087, weighted_loss: 1.2331, label: 3, bag_size: 520
batch 339, loss: 2.5121, instance_loss: 0.5804, weighted_loss: 1.9326, label: 4, bag_size: 399
batch 359, loss: 1.4049, instance_loss: 0.4942, weighted_loss: 1.1317, label: 1, bag_size: 372
batch 379, loss: 1.6033, instance_loss: 0.5411, weighted_loss: 1.2847, label: 3, bag_size: 149
batch 399, loss: 1.3808, instance_loss: 0.5168, weighted_loss: 1.1216, label: 2, bag_size: 754
batch 419, loss: 1.8158, instance_loss: 0.6135, weighted_loss: 1.4551, label: 4, bag_size: 797
batch 439, loss: 0.0995, instance_loss: 0.3722, weighted_loss: 0.1813, label: 0, bag_size: 156
batch 459, loss: 1.9225, instance_loss: 0.5334, weighted_loss: 1.5058, label: 2, bag_size: 105
batch 479, loss: 0.8679, instance_loss: 0.4609, weighted_loss: 0.7458, label: 4, bag_size: 468
batch 499, loss: 1.8004, instance_loss: 0.5492, weighted_loss: 1.4251, label: 4, bag_size: 854
batch 519, loss: 0.5730, instance_loss: 0.3940, weighted_loss: 0.5193, label: 0, bag_size: 269
batch 539, loss: 1.4032, instance_loss: 0.5152, weighted_loss: 1.1368, label: 3, bag_size: 794
batch 559, loss: 2.0880, instance_loss: 0.5583, weighted_loss: 1.6290, label: 2, bag_size: 582
batch 579, loss: 0.4011, instance_loss: 0.4159, weighted_loss: 0.4056, label: 0, bag_size: 97


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.00042087542087542086: correct 2/4752
Epoch: 2, train_loss: 1.3593, train_clustering_loss:  0.5030, train_error: 0.5993
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.1774193548387097, correct 22/124
class 2: acc 0.1, correct 11/110
class 3: acc 0.36363636363636365, correct 44/121
class 4: acc 0.5423728813559322, correct 64/118

Val Set, val_loss: 1.6015, val_error: 0.6486, auc: 0.6777
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.0128, instance_loss: 0.5235, weighted_loss: 1.5660, label: 2, bag_size: 489
batch 39, loss: 1.4454, instance_loss: 0.5300, weighted_loss: 1.1708, label: 2, bag_size: 208
batch 59, loss: 0.2595, instance_loss: 0.4109, weighted_loss: 0.3049, label: 0, bag_size: 477
batch 79, loss: 2.2016, instance_loss: 0.5021, weighted_loss: 1.6917, label: 3, bag_size: 473
batch 99, loss: 1.5569, instance_loss: 0.5270, weighted_loss: 1.2479, label: 1, bag_size: 855
batch 119, loss: 2.4233, instance_loss: 0.7069, weighted_loss: 1.9084, label: 3, bag_size: 337
batch 139, loss: 1.2743, instance_loss: 0.4987, weighted_loss: 1.0417, label: 2, bag_size: 633
batch 159, loss: 1.5822, instance_loss: 0.4993, weighted_loss: 1.2573, label: 4, bag_size: 944
batch 179, loss: 1.0430, instance_loss: 0.4426, weighted_loss: 0.8629, label: 3, bag_size: 498
batch 199, loss: 0.9176, instance_loss: 0.4646, weighted_loss: 0.7817, label: 3, bag_size: 301
batch 219, loss: 1.5370, instance_loss: 0.5918, weighted_loss: 1.2535, label: 4, bag_size: 1018
batch 239, loss: 1.3117, instance_loss: 0.4626, weighted_loss: 1.0570, label: 1, bag_size: 500
batch 259, loss: 3.4123, instance_loss: 0.6268, weighted_loss: 2.5767, label: 3, bag_size: 638
batch 279, loss: 1.0779, instance_loss: 0.5069, weighted_loss: 0.9066, label: 3, bag_size: 1358
batch 299, loss: 0.9166, instance_loss: 0.4313, weighted_loss: 0.7710, label: 3, bag_size: 1154
batch 319, loss: 1.4292, instance_loss: 0.5711, weighted_loss: 1.1717, label: 1, bag_size: 231
batch 339, loss: 1.9062, instance_loss: 0.5371, weighted_loss: 1.4955, label: 0, bag_size: 277
batch 359, loss: 2.3161, instance_loss: 0.6704, weighted_loss: 1.8224, label: 4, bag_size: 476
batch 379, loss: 1.2136, instance_loss: 0.4871, weighted_loss: 0.9956, label: 1, bag_size: 328
batch 399, loss: 1.2541, instance_loss: 0.4684, weighted_loss: 1.0184, label: 1, bag_size: 906
batch 419, loss: 2.0456, instance_loss: 0.6033, weighted_loss: 1.6129, label: 3, bag_size: 737
batch 439, loss: 0.0337, instance_loss: 0.2591, weighted_loss: 0.1014, label: 0, bag_size: 133
batch 459, loss: 2.8482, instance_loss: 0.5633, weighted_loss: 2.1627, label: 3, bag_size: 166
batch 479, loss: 0.3308, instance_loss: 0.3362, weighted_loss: 0.3325, label: 0, bag_size: 295
batch 499, loss: 1.6965, instance_loss: 0.5043, weighted_loss: 1.3388, label: 3, bag_size: 505
batch 519, loss: 1.6291, instance_loss: 0.5188, weighted_loss: 1.2960, label: 2, bag_size: 535
batch 539, loss: 1.3659, instance_loss: 0.5082, weighted_loss: 1.1085, label: 1, bag_size: 328
batch 559, loss: 1.6238, instance_loss: 0.4954, weighted_loss: 1.2853, label: 3, bag_size: 476
batch 579, loss: 0.7291, instance_loss: 0.4156, weighted_loss: 0.6351, label: 4, bag_size: 520


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.002735690235690236: correct 13/4752
Epoch: 3, train_loss: 1.3374, train_clustering_loss:  0.4940, train_error: 0.5909
class 0: acc 0.7637795275590551, correct 97/127
class 1: acc 0.22033898305084745, correct 26/118
class 2: acc 0.3543307086614173, correct 45/127
class 3: acc 0.36283185840707965, correct 41/113
class 4: acc 0.3119266055045872, correct 34/109

Val Set, val_loss: 1.5506, val_error: 0.5811, auc: 0.7147
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3450, instance_loss: 0.4182, weighted_loss: 0.3670, label: 4, bag_size: 432
batch 39, loss: 3.7364, instance_loss: 0.7315, weighted_loss: 2.8349, label: 0, bag_size: 169
batch 59, loss: 1.7298, instance_loss: 0.5649, weighted_loss: 1.3804, label: 1, bag_size: 390
batch 79, loss: 1.5926, instance_loss: 0.5202, weighted_loss: 1.2709, label: 1, bag_size: 161
batch 99, loss: 3.4462, instance_loss: 0.6544, weighted_loss: 2.6087, label: 4, bag_size: 359
batch 119, loss: 1.1103, instance_loss: 0.6439, weighted_loss: 0.9704, label: 0, bag_size: 477
batch 139, loss: 1.5881, instance_loss: 0.4619, weighted_loss: 1.2502, label: 4, bag_size: 250
batch 159, loss: 1.4168, instance_loss: 0.4639, weighted_loss: 1.1309, label: 4, bag_size: 986
batch 179, loss: 0.0753, instance_loss: 0.3510, weighted_loss: 0.1580, label: 0, bag_size: 238
batch 199, loss: 1.3821, instance_loss: 0.4437, weighted_loss: 1.1006, label: 1, bag_size: 851
batch 219, loss: 1.2990, instance_loss: 0.4766, weighted_loss: 1.0523, label: 4, bag_size: 318
batch 239, loss: 1.4526, instance_loss: 0.4811, weighted_loss: 1.1612, label: 2, bag_size: 783
batch 259, loss: 3.2941, instance_loss: 0.6884, weighted_loss: 2.5124, label: 1, bag_size: 153
batch 279, loss: 0.2435, instance_loss: 0.2984, weighted_loss: 0.2600, label: 0, bag_size: 493
batch 299, loss: 1.4210, instance_loss: 0.4948, weighted_loss: 1.1431, label: 1, bag_size: 525
batch 319, loss: 1.5606, instance_loss: 0.5941, weighted_loss: 1.2706, label: 3, bag_size: 956
batch 339, loss: 1.5414, instance_loss: 0.5049, weighted_loss: 1.2304, label: 4, bag_size: 970
batch 359, loss: 1.9730, instance_loss: 0.5447, weighted_loss: 1.5445, label: 2, bag_size: 563
batch 379, loss: 1.9093, instance_loss: 0.5031, weighted_loss: 1.4875, label: 4, bag_size: 960
batch 399, loss: 1.6373, instance_loss: 0.5063, weighted_loss: 1.2980, label: 4, bag_size: 399
batch 419, loss: 0.9869, instance_loss: 0.4623, weighted_loss: 0.8296, label: 2, bag_size: 953
batch 439, loss: 1.4302, instance_loss: 0.5049, weighted_loss: 1.1526, label: 4, bag_size: 218
batch 459, loss: 1.2293, instance_loss: 0.5007, weighted_loss: 1.0107, label: 4, bag_size: 660
batch 479, loss: 1.2179, instance_loss: 0.5155, weighted_loss: 1.0072, label: 4, bag_size: 418
batch 499, loss: 1.0964, instance_loss: 0.4472, weighted_loss: 0.9016, label: 3, bag_size: 996
batch 519, loss: 2.0237, instance_loss: 0.5357, weighted_loss: 1.5773, label: 1, bag_size: 814
batch 539, loss: 1.2208, instance_loss: 0.4910, weighted_loss: 1.0018, label: 3, bag_size: 398
batch 559, loss: 1.4787, instance_loss: 0.4935, weighted_loss: 1.1831, label: 3, bag_size: 499
batch 579, loss: 2.6378, instance_loss: 0.6773, weighted_loss: 2.0496, label: 4, bag_size: 1351


class 0 clustering acc 0.9997895622895623: correct 23755/23760
class 1 clustering acc 0.008207070707070708: correct 39/4752
Epoch: 4, train_loss: 1.3555, train_clustering_loss:  0.4949, train_error: 0.6010
class 0: acc 0.7833333333333333, correct 94/120
class 1: acc 0.07407407407407407, correct 8/108
class 2: acc 0.3897058823529412, correct 53/136
class 3: acc 0.2830188679245283, correct 30/106
class 4: acc 0.41935483870967744, correct 52/124

Val Set, val_loss: 1.5722, val_error: 0.5676, auc: 0.7122
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0394, instance_loss: 0.3532, weighted_loss: 0.1336, label: 0, bag_size: 428
batch 39, loss: 1.0365, instance_loss: 0.4606, weighted_loss: 0.8637, label: 2, bag_size: 1066
batch 59, loss: 0.5956, instance_loss: 0.3984, weighted_loss: 0.5364, label: 0, bag_size: 269
batch 79, loss: 1.3328, instance_loss: 0.4498, weighted_loss: 1.0679, label: 3, bag_size: 317
batch 99, loss: 2.1648, instance_loss: 0.5180, weighted_loss: 1.6707, label: 2, bag_size: 629
batch 119, loss: 1.6175, instance_loss: 0.6176, weighted_loss: 1.3175, label: 3, bag_size: 192
batch 139, loss: 1.3575, instance_loss: 0.4968, weighted_loss: 1.0993, label: 1, bag_size: 1082
batch 159, loss: 0.9002, instance_loss: 0.4936, weighted_loss: 0.7782, label: 3, bag_size: 344
batch 179, loss: 2.0135, instance_loss: 0.5992, weighted_loss: 1.5892, label: 1, bag_size: 184
batch 199, loss: 1.4357, instance_loss: 0.4736, weighted_loss: 1.1470, label: 2, bag_size: 582
batch 219, loss: 1.7396, instance_loss: 0.4795, weighted_loss: 1.3616, label: 2, bag_size: 390
batch 239, loss: 1.5491, instance_loss: 0.4977, weighted_loss: 1.2336, label: 2, bag_size: 361
batch 259, loss: 1.4446, instance_loss: 0.4871, weighted_loss: 1.1574, label: 1, bag_size: 814
batch 279, loss: 1.4845, instance_loss: 0.5049, weighted_loss: 1.1906, label: 1, bag_size: 614
batch 299, loss: 1.5229, instance_loss: 0.4779, weighted_loss: 1.2094, label: 2, bag_size: 860
batch 319, loss: 0.1534, instance_loss: 0.3295, weighted_loss: 0.2063, label: 0, bag_size: 281
batch 339, loss: 1.1461, instance_loss: 0.4650, weighted_loss: 0.9418, label: 2, bag_size: 285
batch 359, loss: 1.1816, instance_loss: 0.4531, weighted_loss: 0.9631, label: 2, bag_size: 799
batch 379, loss: 1.7918, instance_loss: 0.6614, weighted_loss: 1.4527, label: 3, bag_size: 897
batch 399, loss: 1.7952, instance_loss: 0.5040, weighted_loss: 1.4078, label: 4, bag_size: 695
batch 419, loss: 0.5655, instance_loss: 0.5392, weighted_loss: 0.5576, label: 0, bag_size: 524
batch 439, loss: 0.7843, instance_loss: 0.5084, weighted_loss: 0.7015, label: 4, bag_size: 685
batch 459, loss: 1.1851, instance_loss: 0.4306, weighted_loss: 0.9588, label: 4, bag_size: 277
batch 479, loss: 1.7114, instance_loss: 0.5319, weighted_loss: 1.3575, label: 2, bag_size: 754
batch 499, loss: 1.1934, instance_loss: 0.4989, weighted_loss: 0.9850, label: 1, bag_size: 201
batch 519, loss: 0.8548, instance_loss: 0.4973, weighted_loss: 0.7475, label: 1, bag_size: 328
batch 539, loss: 1.7579, instance_loss: 0.5411, weighted_loss: 1.3928, label: 4, bag_size: 419
batch 559, loss: 2.0288, instance_loss: 0.4978, weighted_loss: 1.5695, label: 2, bag_size: 606
batch 579, loss: 2.2913, instance_loss: 0.5341, weighted_loss: 1.7642, label: 0, bag_size: 428


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.0021043771043771043: correct 10/4752
Epoch: 5, train_loss: 1.3104, train_clustering_loss:  0.4984, train_error: 0.5976
class 0: acc 0.824, correct 103/125
class 1: acc 0.2833333333333333, correct 34/120
class 2: acc 0.24193548387096775, correct 30/124
class 3: acc 0.3, correct 36/120
class 4: acc 0.34285714285714286, correct 36/105

Val Set, val_loss: 1.5125, val_error: 0.5135, auc: 0.7178
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.6054, instance_loss: 0.5444, weighted_loss: 1.2871, label: 1, bag_size: 419
batch 39, loss: 0.0154, instance_loss: 0.2771, weighted_loss: 0.0939, label: 0, bag_size: 69
batch 59, loss: 1.7118, instance_loss: 0.5499, weighted_loss: 1.3632, label: 2, bag_size: 404
batch 79, loss: 0.6561, instance_loss: 0.3512, weighted_loss: 0.5646, label: 3, bag_size: 684
batch 99, loss: 0.9429, instance_loss: 0.6686, weighted_loss: 0.8606, label: 4, bag_size: 683
batch 119, loss: 1.2766, instance_loss: 0.4357, weighted_loss: 1.0243, label: 1, bag_size: 544
batch 139, loss: 4.2580, instance_loss: 0.8128, weighted_loss: 3.2245, label: 0, bag_size: 600
batch 159, loss: 1.7603, instance_loss: 0.5071, weighted_loss: 1.3843, label: 2, bag_size: 171
batch 179, loss: 1.1599, instance_loss: 0.4207, weighted_loss: 0.9381, label: 3, bag_size: 499
batch 199, loss: 1.3495, instance_loss: 0.4867, weighted_loss: 1.0907, label: 2, bag_size: 402
batch 219, loss: 0.1129, instance_loss: 0.3039, weighted_loss: 0.1702, label: 0, bag_size: 190
batch 239, loss: 1.7138, instance_loss: 0.5340, weighted_loss: 1.3599, label: 1, bag_size: 906
batch 259, loss: 0.0458, instance_loss: 0.2729, weighted_loss: 0.1139, label: 0, bag_size: 425
batch 279, loss: 1.2451, instance_loss: 0.4884, weighted_loss: 1.0181, label: 4, bag_size: 875
batch 299, loss: 1.0287, instance_loss: 0.4620, weighted_loss: 0.8587, label: 4, bag_size: 329
batch 319, loss: 0.8249, instance_loss: 0.5376, weighted_loss: 0.7387, label: 1, bag_size: 748
batch 339, loss: 1.5414, instance_loss: 0.5905, weighted_loss: 1.2561, label: 0, bag_size: 367
batch 359, loss: 2.3271, instance_loss: 0.5933, weighted_loss: 1.8070, label: 0, bag_size: 710
batch 379, loss: 1.5668, instance_loss: 0.4918, weighted_loss: 1.2443, label: 1, bag_size: 764
batch 399, loss: 1.6799, instance_loss: 0.5638, weighted_loss: 1.3451, label: 3, bag_size: 928
batch 419, loss: 1.1809, instance_loss: 0.4816, weighted_loss: 0.9711, label: 3, bag_size: 272
batch 439, loss: 1.3120, instance_loss: 0.5613, weighted_loss: 1.0868, label: 4, bag_size: 72
batch 459, loss: 1.1312, instance_loss: 0.4574, weighted_loss: 0.9291, label: 2, bag_size: 953
batch 479, loss: 0.8709, instance_loss: 0.4453, weighted_loss: 0.7432, label: 2, bag_size: 617
batch 499, loss: 1.4189, instance_loss: 0.4693, weighted_loss: 1.1341, label: 1, bag_size: 1103
batch 519, loss: 1.0059, instance_loss: 0.4794, weighted_loss: 0.8479, label: 2, bag_size: 640
batch 539, loss: 1.6930, instance_loss: 0.5913, weighted_loss: 1.3625, label: 4, bag_size: 333
batch 559, loss: 1.1938, instance_loss: 0.4304, weighted_loss: 0.9648, label: 3, bag_size: 337
batch 579, loss: 1.0911, instance_loss: 0.4377, weighted_loss: 0.8951, label: 3, bag_size: 1154


class 0 clustering acc 0.9996212121212121: correct 23751/23760
class 1 clustering acc 0.013257575757575758: correct 63/4752
Epoch: 6, train_loss: 1.2748, train_clustering_loss:  0.4915, train_error: 0.5623
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.3017241379310345, correct 35/116
class 2: acc 0.14285714285714285, correct 16/112
class 3: acc 0.453781512605042, correct 54/119
class 4: acc 0.4380165289256198, correct 53/121

Val Set, val_loss: 1.5533, val_error: 0.6081, auc: 0.7146
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0999, instance_loss: 0.2635, weighted_loss: 0.1490, label: 0, bag_size: 156
batch 39, loss: 0.8869, instance_loss: 0.4038, weighted_loss: 0.7420, label: 3, bag_size: 498
batch 59, loss: 1.2068, instance_loss: 0.4745, weighted_loss: 0.9872, label: 3, bag_size: 727
batch 79, loss: 0.1276, instance_loss: 0.3428, weighted_loss: 0.1922, label: 0, bag_size: 357
batch 99, loss: 1.6838, instance_loss: 0.5466, weighted_loss: 1.3427, label: 4, bag_size: 228
batch 119, loss: 1.1322, instance_loss: 0.4612, weighted_loss: 0.9309, label: 1, bag_size: 371
batch 139, loss: 0.3454, instance_loss: 0.5223, weighted_loss: 0.3985, label: 0, bag_size: 578
batch 159, loss: 1.4305, instance_loss: 0.4569, weighted_loss: 1.1385, label: 1, bag_size: 823
batch 179, loss: 1.2770, instance_loss: 0.6038, weighted_loss: 1.0750, label: 2, bag_size: 1066
batch 199, loss: 2.4698, instance_loss: 0.7226, weighted_loss: 1.9457, label: 2, bag_size: 582
batch 219, loss: 1.6925, instance_loss: 0.5114, weighted_loss: 1.3382, label: 3, bag_size: 615
batch 239, loss: 2.7468, instance_loss: 0.6731, weighted_loss: 2.1247, label: 0, bag_size: 1073
batch 259, loss: 0.6338, instance_loss: 0.4144, weighted_loss: 0.5680, label: 3, bag_size: 996
batch 279, loss: 1.6039, instance_loss: 0.5000, weighted_loss: 1.2728, label: 4, bag_size: 726
batch 299, loss: 1.6767, instance_loss: 0.5092, weighted_loss: 1.3265, label: 2, bag_size: 582
batch 319, loss: 3.6895, instance_loss: 0.6939, weighted_loss: 2.7908, label: 1, bag_size: 153
batch 339, loss: 1.2985, instance_loss: 0.5637, weighted_loss: 1.0780, label: 0, bag_size: 306
batch 359, loss: 1.8984, instance_loss: 0.5396, weighted_loss: 1.4908, label: 2, bag_size: 1319
batch 379, loss: 1.0317, instance_loss: 0.4317, weighted_loss: 0.8517, label: 4, bag_size: 204
batch 399, loss: 1.3204, instance_loss: 0.4832, weighted_loss: 1.0692, label: 4, bag_size: 731
batch 419, loss: 1.1377, instance_loss: 0.5264, weighted_loss: 0.9543, label: 2, bag_size: 290
batch 439, loss: 1.1940, instance_loss: 0.6234, weighted_loss: 1.0229, label: 2, bag_size: 821
batch 459, loss: 0.9353, instance_loss: 0.4696, weighted_loss: 0.7956, label: 3, bag_size: 351
batch 479, loss: 2.1621, instance_loss: 0.5381, weighted_loss: 1.6749, label: 1, bag_size: 823
batch 499, loss: 0.7526, instance_loss: 0.3713, weighted_loss: 0.6382, label: 0, bag_size: 81
batch 519, loss: 1.3441, instance_loss: 0.5180, weighted_loss: 1.0962, label: 1, bag_size: 593
batch 539, loss: 5.7097, instance_loss: 0.6951, weighted_loss: 4.2053, label: 2, bag_size: 488
batch 559, loss: 0.4305, instance_loss: 0.4773, weighted_loss: 0.4445, label: 4, bag_size: 895
batch 579, loss: 1.1181, instance_loss: 0.4431, weighted_loss: 0.9156, label: 2, bag_size: 375


class 0 clustering acc 0.9992845117845118: correct 23743/23760
class 1 clustering acc 0.003787878787878788: correct 18/4752
Epoch: 7, train_loss: 1.2907, train_clustering_loss:  0.4952, train_error: 0.5539
class 0: acc 0.7623762376237624, correct 77/101
class 1: acc 0.11711711711711711, correct 13/111
class 2: acc 0.48872180451127817, correct 65/133
class 3: acc 0.5193798449612403, correct 67/129
class 4: acc 0.35833333333333334, correct 43/120

Val Set, val_loss: 1.6068, val_error: 0.5541, auc: 0.7115
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3988, instance_loss: 0.4707, weighted_loss: 1.1203, label: 4, bag_size: 72
batch 39, loss: 2.1164, instance_loss: 0.6694, weighted_loss: 1.6823, label: 0, bag_size: 1414
batch 59, loss: 1.7015, instance_loss: 0.4865, weighted_loss: 1.3370, label: 4, bag_size: 714
batch 79, loss: 0.2636, instance_loss: 0.2731, weighted_loss: 0.2665, label: 0, bag_size: 517
batch 99, loss: 1.7224, instance_loss: 0.5482, weighted_loss: 1.3702, label: 1, bag_size: 413
batch 119, loss: 4.1124, instance_loss: 0.7681, weighted_loss: 3.1091, label: 3, bag_size: 638
batch 139, loss: 0.9833, instance_loss: 0.4957, weighted_loss: 0.8370, label: 4, bag_size: 875
batch 159, loss: 2.3410, instance_loss: 0.6228, weighted_loss: 1.8256, label: 2, bag_size: 864
batch 179, loss: 1.9341, instance_loss: 0.5911, weighted_loss: 1.5312, label: 2, bag_size: 337
batch 199, loss: 1.8746, instance_loss: 0.6100, weighted_loss: 1.4952, label: 1, bag_size: 184
batch 219, loss: 1.1021, instance_loss: 0.5066, weighted_loss: 0.9234, label: 1, bag_size: 419
batch 239, loss: 1.5976, instance_loss: 0.4979, weighted_loss: 1.2677, label: 4, bag_size: 476
batch 259, loss: 1.8223, instance_loss: 0.5840, weighted_loss: 1.4508, label: 0, bag_size: 879
batch 279, loss: 1.0496, instance_loss: 0.4738, weighted_loss: 0.8769, label: 3, bag_size: 781
batch 299, loss: 0.8547, instance_loss: 0.3914, weighted_loss: 0.7157, label: 3, bag_size: 102
batch 319, loss: 1.1747, instance_loss: 0.5073, weighted_loss: 0.9745, label: 4, bag_size: 797
batch 339, loss: 0.9455, instance_loss: 0.4407, weighted_loss: 0.7940, label: 1, bag_size: 617
batch 359, loss: 0.0276, instance_loss: 0.3034, weighted_loss: 0.1103, label: 0, bag_size: 49
batch 379, loss: 2.1016, instance_loss: 0.6123, weighted_loss: 1.6548, label: 4, bag_size: 238
batch 399, loss: 0.8616, instance_loss: 0.4305, weighted_loss: 0.7323, label: 3, bag_size: 1007
batch 419, loss: 0.5650, instance_loss: 0.4643, weighted_loss: 0.5348, label: 0, bag_size: 615
batch 439, loss: 2.3874, instance_loss: 0.6182, weighted_loss: 1.8567, label: 4, bag_size: 333
batch 459, loss: 1.5102, instance_loss: 0.5387, weighted_loss: 1.2188, label: 2, bag_size: 821
batch 479, loss: 1.1754, instance_loss: 0.5035, weighted_loss: 0.9738, label: 2, bag_size: 404
batch 499, loss: 0.3263, instance_loss: 0.3275, weighted_loss: 0.3266, label: 0, bag_size: 81
batch 519, loss: 1.0785, instance_loss: 0.4616, weighted_loss: 0.8934, label: 3, bag_size: 894
batch 539, loss: 3.1168, instance_loss: 0.6286, weighted_loss: 2.3704, label: 0, bag_size: 745
batch 559, loss: 1.1693, instance_loss: 0.4857, weighted_loss: 0.9643, label: 4, bag_size: 854
batch 579, loss: 1.8396, instance_loss: 0.4902, weighted_loss: 1.4347, label: 2, bag_size: 105


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.03367003367003367: correct 160/4752
Epoch: 8, train_loss: 1.2580, train_clustering_loss:  0.4872, train_error: 0.5488
class 0: acc 0.8098159509202454, correct 132/163
class 1: acc 0.44166666666666665, correct 53/120
class 2: acc 0.13978494623655913, correct 13/93
class 3: acc 0.30701754385964913, correct 35/114
class 4: acc 0.33653846153846156, correct 35/104

Val Set, val_loss: 1.5029, val_error: 0.5811, auc: 0.7414
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 2.3180, instance_loss: 0.5267, weighted_loss: 1.7806, label: 2, bag_size: 713
batch 39, loss: 1.4371, instance_loss: 0.5389, weighted_loss: 1.1677, label: 1, bag_size: 1104
batch 59, loss: 1.2118, instance_loss: 0.5527, weighted_loss: 1.0141, label: 0, bag_size: 345
batch 79, loss: 2.1145, instance_loss: 0.5375, weighted_loss: 1.6414, label: 2, bag_size: 744
batch 99, loss: 0.0828, instance_loss: 0.3354, weighted_loss: 0.1586, label: 0, bag_size: 37
batch 119, loss: 0.7263, instance_loss: 0.4087, weighted_loss: 0.6310, label: 1, bag_size: 544
batch 139, loss: 0.4227, instance_loss: 0.4778, weighted_loss: 0.4392, label: 4, bag_size: 773
batch 159, loss: 0.0321, instance_loss: 0.3697, weighted_loss: 0.1333, label: 0, bag_size: 340
batch 179, loss: 1.0283, instance_loss: 0.5246, weighted_loss: 0.8772, label: 4, bag_size: 446
batch 199, loss: 0.2432, instance_loss: 0.3155, weighted_loss: 0.2649, label: 0, bag_size: 81
batch 219, loss: 1.6790, instance_loss: 0.5199, weighted_loss: 1.3313, label: 4, bag_size: 176
batch 239, loss: 1.9180, instance_loss: 0.5397, weighted_loss: 1.5045, label: 2, bag_size: 133
batch 259, loss: 3.1139, instance_loss: 0.7234, weighted_loss: 2.3968, label: 0, bag_size: 492
batch 279, loss: 1.9658, instance_loss: 0.5549, weighted_loss: 1.5426, label: 4, bag_size: 592
batch 299, loss: 1.0750, instance_loss: 0.4582, weighted_loss: 0.8900, label: 2, bag_size: 684
batch 319, loss: 1.3124, instance_loss: 0.5234, weighted_loss: 1.0757, label: 4, bag_size: 1077
batch 339, loss: 1.5225, instance_loss: 0.5009, weighted_loss: 1.2160, label: 4, bag_size: 937
batch 359, loss: 1.1900, instance_loss: 0.4957, weighted_loss: 0.9817, label: 2, bag_size: 554
batch 379, loss: 0.7183, instance_loss: 0.4056, weighted_loss: 0.6245, label: 0, bag_size: 59
batch 399, loss: 1.4283, instance_loss: 0.5505, weighted_loss: 1.1650, label: 3, bag_size: 192
batch 419, loss: 1.6809, instance_loss: 0.5445, weighted_loss: 1.3400, label: 4, bag_size: 944
batch 439, loss: 0.2221, instance_loss: 0.3321, weighted_loss: 0.2551, label: 0, bag_size: 76
batch 459, loss: 1.9510, instance_loss: 0.4936, weighted_loss: 1.5138, label: 2, bag_size: 906
batch 479, loss: 1.5721, instance_loss: 0.5222, weighted_loss: 1.2571, label: 4, bag_size: 407
batch 499, loss: 0.9619, instance_loss: 0.4031, weighted_loss: 0.7943, label: 1, bag_size: 981
batch 519, loss: 1.6123, instance_loss: 0.4908, weighted_loss: 1.2759, label: 4, bag_size: 886
batch 539, loss: 0.3627, instance_loss: 0.2930, weighted_loss: 0.3418, label: 0, bag_size: 70
batch 559, loss: 0.6809, instance_loss: 0.3910, weighted_loss: 0.5939, label: 3, bag_size: 351
batch 579, loss: 0.9911, instance_loss: 0.4670, weighted_loss: 0.8339, label: 4, bag_size: 824


class 0 clustering acc 0.9988215488215488: correct 23732/23760
class 1 clustering acc 0.018518518518518517: correct 88/4752
Epoch: 9, train_loss: 1.2480, train_clustering_loss:  0.4866, train_error: 0.5657
class 0: acc 0.8062015503875969, correct 104/129
class 1: acc 0.22727272727272727, correct 25/110
class 2: acc 0.3709677419354839, correct 46/124
class 3: acc 0.3137254901960784, correct 32/102
class 4: acc 0.3953488372093023, correct 51/129

Val Set, val_loss: 1.5552, val_error: 0.5270, auc: 0.7466
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.1999, instance_loss: 0.4888, weighted_loss: 0.9866, label: 1, bag_size: 1273
batch 39, loss: 0.8180, instance_loss: 0.4389, weighted_loss: 0.7043, label: 3, bag_size: 301
batch 59, loss: 1.1269, instance_loss: 0.5974, weighted_loss: 0.9680, label: 3, bag_size: 1001
batch 79, loss: 0.9975, instance_loss: 0.4970, weighted_loss: 0.8473, label: 3, bag_size: 641
batch 99, loss: 4.1914, instance_loss: 0.7711, weighted_loss: 3.1653, label: 0, bag_size: 352
batch 119, loss: 2.0513, instance_loss: 0.5958, weighted_loss: 1.6147, label: 2, bag_size: 380
batch 139, loss: 1.8738, instance_loss: 0.4940, weighted_loss: 1.4599, label: 3, bag_size: 505
batch 159, loss: 1.8496, instance_loss: 0.5399, weighted_loss: 1.4567, label: 2, bag_size: 489
batch 179, loss: 0.7008, instance_loss: 0.5881, weighted_loss: 0.6670, label: 4, bag_size: 574
batch 199, loss: 1.6311, instance_loss: 0.5221, weighted_loss: 1.2984, label: 2, bag_size: 1308
batch 219, loss: 0.4612, instance_loss: 0.4920, weighted_loss: 0.4704, label: 4, bag_size: 773
batch 239, loss: 0.7426, instance_loss: 0.4768, weighted_loss: 0.6629, label: 4, bag_size: 727
batch 259, loss: 1.1752, instance_loss: 0.4725, weighted_loss: 0.9644, label: 1, bag_size: 355
batch 279, loss: 1.2736, instance_loss: 0.6688, weighted_loss: 1.0922, label: 0, bag_size: 615
batch 299, loss: 1.6223, instance_loss: 0.4629, weighted_loss: 1.2745, label: 2, bag_size: 1003
batch 319, loss: 0.9098, instance_loss: 0.4230, weighted_loss: 0.7637, label: 1, bag_size: 410
batch 339, loss: 0.9397, instance_loss: 0.4501, weighted_loss: 0.7928, label: 4, bag_size: 699
batch 359, loss: 1.4929, instance_loss: 0.4648, weighted_loss: 1.1845, label: 1, bag_size: 1121
batch 379, loss: 0.3577, instance_loss: 0.3937, weighted_loss: 0.3685, label: 4, bag_size: 923
batch 399, loss: 1.7513, instance_loss: 0.5051, weighted_loss: 1.3774, label: 4, bag_size: 468
batch 419, loss: 0.0575, instance_loss: 0.2245, weighted_loss: 0.1076, label: 0, bag_size: 280
batch 439, loss: 1.5086, instance_loss: 0.4962, weighted_loss: 1.2048, label: 4, bag_size: 714
batch 459, loss: 1.6909, instance_loss: 0.5666, weighted_loss: 1.3536, label: 4, bag_size: 176
batch 479, loss: 1.3667, instance_loss: 0.5526, weighted_loss: 1.1225, label: 4, bag_size: 660
batch 499, loss: 1.5886, instance_loss: 0.4652, weighted_loss: 1.2516, label: 2, bag_size: 998
batch 519, loss: 1.5079, instance_loss: 0.4422, weighted_loss: 1.1882, label: 1, bag_size: 925
batch 539, loss: 4.1525, instance_loss: 0.8611, weighted_loss: 3.1651, label: 0, bag_size: 273
batch 559, loss: 1.2959, instance_loss: 0.4786, weighted_loss: 1.0507, label: 2, bag_size: 860
batch 579, loss: 1.4017, instance_loss: 0.4979, weighted_loss: 1.1306, label: 4, bag_size: 618


class 0 clustering acc 0.99743265993266: correct 23699/23760
class 1 clustering acc 0.052398989898989896: correct 249/4752
Epoch: 10, train_loss: 1.2468, train_clustering_loss:  0.4848, train_error: 0.5152
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.38095238095238093, correct 48/126
class 2: acc 0.33884297520661155, correct 41/121
class 3: acc 0.41818181818181815, correct 46/110
class 4: acc 0.45689655172413796, correct 53/116

Val Set, val_loss: 1.5678, val_error: 0.5676, auc: 0.7258
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.0187, instance_loss: 0.4880, weighted_loss: 0.8595, label: 2, bag_size: 697
batch 39, loss: 0.1023, instance_loss: 0.2224, weighted_loss: 0.1383, label: 0, bag_size: 97
batch 59, loss: 0.9002, instance_loss: 0.5083, weighted_loss: 0.7826, label: 4, bag_size: 520
batch 79, loss: 2.1939, instance_loss: 0.6027, weighted_loss: 1.7165, label: 3, bag_size: 120
batch 99, loss: 0.1245, instance_loss: 0.2585, weighted_loss: 0.1647, label: 0, bag_size: 221
batch 119, loss: 1.9593, instance_loss: 0.5252, weighted_loss: 1.5291, label: 4, bag_size: 476
batch 139, loss: 0.0184, instance_loss: 0.2482, weighted_loss: 0.0873, label: 0, bag_size: 190
batch 159, loss: 2.0073, instance_loss: 0.5324, weighted_loss: 1.5649, label: 4, bag_size: 618
batch 179, loss: 1.7048, instance_loss: 0.5389, weighted_loss: 1.3550, label: 2, bag_size: 390
batch 199, loss: 1.5256, instance_loss: 0.5259, weighted_loss: 1.2257, label: 2, bag_size: 582
batch 219, loss: 2.2696, instance_loss: 0.5375, weighted_loss: 1.7500, label: 4, bag_size: 432
batch 239, loss: 1.0279, instance_loss: 0.4739, weighted_loss: 0.8617, label: 3, bag_size: 499
batch 259, loss: 0.7895, instance_loss: 0.5443, weighted_loss: 0.7159, label: 1, bag_size: 1497
batch 279, loss: 1.2301, instance_loss: 0.4829, weighted_loss: 1.0060, label: 4, bag_size: 604
batch 299, loss: 0.5760, instance_loss: 0.4749, weighted_loss: 0.5457, label: 4, bag_size: 432
batch 319, loss: 1.1177, instance_loss: 0.4800, weighted_loss: 0.9264, label: 1, bag_size: 605
batch 339, loss: 0.7456, instance_loss: 0.4901, weighted_loss: 0.6689, label: 3, bag_size: 476
batch 359, loss: 2.0119, instance_loss: 0.5359, weighted_loss: 1.5691, label: 2, bag_size: 998
batch 379, loss: 0.1405, instance_loss: 0.4057, weighted_loss: 0.2201, label: 0, bag_size: 428
batch 399, loss: 0.9968, instance_loss: 0.5138, weighted_loss: 0.8519, label: 1, bag_size: 1360
batch 419, loss: 1.1033, instance_loss: 0.5314, weighted_loss: 0.9317, label: 2, bag_size: 614
batch 439, loss: 2.1216, instance_loss: 0.5351, weighted_loss: 1.6456, label: 1, bag_size: 764
batch 459, loss: 2.7119, instance_loss: 0.5231, weighted_loss: 2.0553, label: 4, bag_size: 854
batch 479, loss: 0.5716, instance_loss: 0.3804, weighted_loss: 0.5142, label: 4, bag_size: 744
batch 499, loss: 1.1324, instance_loss: 0.4539, weighted_loss: 0.9289, label: 2, bag_size: 321
batch 519, loss: 1.3268, instance_loss: 0.6937, weighted_loss: 1.1369, label: 0, bag_size: 269
batch 539, loss: 1.1255, instance_loss: 0.4456, weighted_loss: 0.9216, label: 3, bag_size: 344
batch 559, loss: 0.7038, instance_loss: 0.4476, weighted_loss: 0.6269, label: 3, bag_size: 894
batch 579, loss: 2.1052, instance_loss: 0.5098, weighted_loss: 1.6266, label: 1, bag_size: 564


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.02462121212121212: correct 117/4752
Epoch: 11, train_loss: 1.2422, train_clustering_loss:  0.4921, train_error: 0.5505
class 0: acc 0.7941176470588235, correct 81/102
class 1: acc 0.17796610169491525, correct 21/118
class 2: acc 0.33035714285714285, correct 37/112
class 3: acc 0.48905109489051096, correct 67/137
class 4: acc 0.488, correct 61/125

Val Set, val_loss: 1.6263, val_error: 0.5946, auc: 0.7231
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.6011, instance_loss: 0.5276, weighted_loss: 1.2790, label: 1, bag_size: 390
batch 39, loss: 1.1336, instance_loss: 0.4977, weighted_loss: 0.9428, label: 2, bag_size: 799
batch 59, loss: 0.7156, instance_loss: 0.4663, weighted_loss: 0.6408, label: 4, bag_size: 742
batch 79, loss: 1.8244, instance_loss: 0.5502, weighted_loss: 1.4421, label: 4, bag_size: 399
batch 99, loss: 1.0835, instance_loss: 0.4231, weighted_loss: 0.8854, label: 3, bag_size: 1365
batch 119, loss: 3.2282, instance_loss: 0.7446, weighted_loss: 2.4831, label: 2, bag_size: 219
batch 139, loss: 0.9370, instance_loss: 0.4347, weighted_loss: 0.7863, label: 3, bag_size: 398
batch 159, loss: 0.7821, instance_loss: 0.4122, weighted_loss: 0.6711, label: 3, bag_size: 956
batch 179, loss: 1.1231, instance_loss: 0.4859, weighted_loss: 0.9320, label: 2, bag_size: 1066
batch 199, loss: 1.5517, instance_loss: 0.5253, weighted_loss: 1.2438, label: 1, bag_size: 311
batch 219, loss: 0.1507, instance_loss: 0.4186, weighted_loss: 0.2311, label: 2, bag_size: 1975
batch 239, loss: 1.3112, instance_loss: 0.4836, weighted_loss: 1.0629, label: 1, bag_size: 620
batch 259, loss: 1.9333, instance_loss: 0.5247, weighted_loss: 1.5107, label: 4, bag_size: 854
batch 279, loss: 1.6789, instance_loss: 0.5334, weighted_loss: 1.3353, label: 4, bag_size: 363
batch 299, loss: 0.3580, instance_loss: 0.3572, weighted_loss: 0.3578, label: 0, bag_size: 552
batch 319, loss: 0.8015, instance_loss: 0.4244, weighted_loss: 0.6884, label: 3, bag_size: 641
batch 339, loss: 1.3860, instance_loss: 0.4389, weighted_loss: 1.1018, label: 3, bag_size: 337
batch 359, loss: 1.1948, instance_loss: 0.4369, weighted_loss: 0.9674, label: 3, bag_size: 796
batch 379, loss: 2.6794, instance_loss: 0.6597, weighted_loss: 2.0735, label: 4, bag_size: 244
batch 399, loss: 1.3450, instance_loss: 0.4573, weighted_loss: 1.0787, label: 1, bag_size: 328
batch 419, loss: 0.5456, instance_loss: 0.4482, weighted_loss: 0.5164, label: 4, bag_size: 1041
batch 439, loss: 2.9402, instance_loss: 0.6228, weighted_loss: 2.2450, label: 4, bag_size: 438
batch 459, loss: 1.1531, instance_loss: 0.4824, weighted_loss: 0.9519, label: 2, bag_size: 754
batch 479, loss: 1.3302, instance_loss: 0.4862, weighted_loss: 1.0770, label: 2, bag_size: 361
batch 499, loss: 2.6115, instance_loss: 0.7620, weighted_loss: 2.0566, label: 4, bag_size: 937
batch 519, loss: 1.3569, instance_loss: 0.5404, weighted_loss: 1.1120, label: 3, bag_size: 437
batch 539, loss: 1.2462, instance_loss: 0.4558, weighted_loss: 1.0091, label: 1, bag_size: 591
batch 559, loss: 0.9352, instance_loss: 0.4141, weighted_loss: 0.7789, label: 2, bag_size: 402
batch 579, loss: 0.1568, instance_loss: 0.3244, weighted_loss: 0.2071, label: 0, bag_size: 281


class 0 clustering acc 0.9987373737373737: correct 23730/23760
class 1 clustering acc 0.022937710437710437: correct 109/4752
Epoch: 12, train_loss: 1.2601, train_clustering_loss:  0.4894, train_error: 0.5657
class 0: acc 0.8076923076923077, correct 84/104
class 1: acc 0.2692307692307692, correct 35/130
class 2: acc 0.2890625, correct 37/128
class 3: acc 0.549618320610687, correct 72/131
class 4: acc 0.297029702970297, correct 30/101

Val Set, val_loss: 1.6296, val_error: 0.5676, auc: 0.7477
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8987, instance_loss: 0.4318, weighted_loss: 0.7586, label: 2, bag_size: 702
batch 39, loss: 1.3082, instance_loss: 0.4939, weighted_loss: 1.0639, label: 1, bag_size: 981
batch 59, loss: 1.5751, instance_loss: 0.5204, weighted_loss: 1.2587, label: 3, bag_size: 797
batch 79, loss: 0.2671, instance_loss: 0.3778, weighted_loss: 0.3003, label: 0, bag_size: 73
batch 99, loss: 1.1139, instance_loss: 0.4514, weighted_loss: 0.9152, label: 2, bag_size: 390
batch 119, loss: 0.9144, instance_loss: 0.4952, weighted_loss: 0.7886, label: 1, bag_size: 748
batch 139, loss: 1.0300, instance_loss: 0.4895, weighted_loss: 0.8678, label: 3, bag_size: 1186
batch 159, loss: 0.4690, instance_loss: 0.4149, weighted_loss: 0.4528, label: 0, bag_size: 455
batch 179, loss: 0.0846, instance_loss: 0.3045, weighted_loss: 0.1506, label: 0, bag_size: 355
batch 199, loss: 0.1837, instance_loss: 0.4252, weighted_loss: 0.2561, label: 4, bag_size: 746
batch 219, loss: 1.2894, instance_loss: 0.4951, weighted_loss: 1.0511, label: 2, bag_size: 584
batch 239, loss: 1.5060, instance_loss: 0.4974, weighted_loss: 1.2034, label: 4, bag_size: 854
batch 259, loss: 1.4864, instance_loss: 0.5107, weighted_loss: 1.1937, label: 1, bag_size: 221
batch 279, loss: 0.1019, instance_loss: 0.3411, weighted_loss: 0.1737, label: 0, bag_size: 370
batch 299, loss: 1.7182, instance_loss: 0.5466, weighted_loss: 1.3667, label: 1, bag_size: 695
batch 319, loss: 1.2666, instance_loss: 0.4870, weighted_loss: 1.0327, label: 4, bag_size: 407
batch 339, loss: 0.9370, instance_loss: 0.4859, weighted_loss: 0.8017, label: 2, bag_size: 410
batch 359, loss: 0.4951, instance_loss: 0.3824, weighted_loss: 0.4613, label: 4, bag_size: 775
batch 379, loss: 1.1141, instance_loss: 0.4656, weighted_loss: 0.9196, label: 4, bag_size: 238
batch 399, loss: 1.1643, instance_loss: 0.5164, weighted_loss: 0.9699, label: 2, bag_size: 498
batch 419, loss: 1.0021, instance_loss: 0.4914, weighted_loss: 0.8489, label: 2, bag_size: 339
batch 439, loss: 1.0951, instance_loss: 0.4955, weighted_loss: 0.9152, label: 3, bag_size: 317
batch 459, loss: 0.0828, instance_loss: 0.2957, weighted_loss: 0.1467, label: 0, bag_size: 533
batch 479, loss: 0.8980, instance_loss: 0.4640, weighted_loss: 0.7678, label: 4, bag_size: 780
batch 499, loss: 0.6581, instance_loss: 0.4451, weighted_loss: 0.5942, label: 4, bag_size: 744
batch 519, loss: 1.1660, instance_loss: 0.6449, weighted_loss: 1.0097, label: 2, bag_size: 697
batch 539, loss: 0.0636, instance_loss: 0.2547, weighted_loss: 0.1209, label: 0, bag_size: 221
batch 559, loss: 1.0001, instance_loss: 0.3782, weighted_loss: 0.8136, label: 3, bag_size: 894
batch 579, loss: 0.7202, instance_loss: 0.4020, weighted_loss: 0.6248, label: 4, bag_size: 198


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.03324915824915825: correct 158/4752
Epoch: 13, train_loss: 1.2568, train_clustering_loss:  0.4897, train_error: 0.5438
class 0: acc 0.7614678899082569, correct 83/109
class 1: acc 0.17, correct 17/100
class 2: acc 0.4732824427480916, correct 62/131
class 3: acc 0.44881889763779526, correct 57/127
class 4: acc 0.4094488188976378, correct 52/127

Val Set, val_loss: 1.5896, val_error: 0.5270, auc: 0.7570
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.7115, instance_loss: 0.4990, weighted_loss: 0.6477, label: 1, bag_size: 1497
batch 39, loss: 1.3995, instance_loss: 0.5602, weighted_loss: 1.1477, label: 4, bag_size: 318
batch 59, loss: 2.7590, instance_loss: 0.6047, weighted_loss: 2.1127, label: 0, bag_size: 1045
batch 79, loss: 0.8889, instance_loss: 0.5378, weighted_loss: 0.7835, label: 1, bag_size: 311
batch 99, loss: 0.1505, instance_loss: 0.2794, weighted_loss: 0.1892, label: 0, bag_size: 59
batch 119, loss: 2.2423, instance_loss: 0.6871, weighted_loss: 1.7757, label: 0, bag_size: 478
batch 139, loss: 1.1949, instance_loss: 0.4633, weighted_loss: 0.9754, label: 3, bag_size: 996
batch 159, loss: 1.2832, instance_loss: 0.5627, weighted_loss: 1.0670, label: 3, bag_size: 674
batch 179, loss: 1.0701, instance_loss: 0.5019, weighted_loss: 0.8996, label: 0, bag_size: 319
batch 199, loss: 1.2442, instance_loss: 0.5013, weighted_loss: 1.0214, label: 3, bag_size: 476
batch 219, loss: 1.1375, instance_loss: 0.4717, weighted_loss: 0.9378, label: 3, bag_size: 779
batch 239, loss: 1.6381, instance_loss: 0.4883, weighted_loss: 1.2931, label: 3, bag_size: 797
batch 259, loss: 1.0479, instance_loss: 0.4452, weighted_loss: 0.8671, label: 1, bag_size: 221
batch 279, loss: 2.6967, instance_loss: 0.6213, weighted_loss: 2.0741, label: 2, bag_size: 1308
batch 299, loss: 1.7613, instance_loss: 0.6156, weighted_loss: 1.4176, label: 2, bag_size: 177
batch 319, loss: 1.5542, instance_loss: 0.5936, weighted_loss: 1.2660, label: 2, bag_size: 445
batch 339, loss: 0.4108, instance_loss: 0.5219, weighted_loss: 0.4441, label: 4, bag_size: 923
batch 359, loss: 1.2661, instance_loss: 0.4843, weighted_loss: 1.0316, label: 1, bag_size: 201
batch 379, loss: 0.9050, instance_loss: 0.4927, weighted_loss: 0.7813, label: 4, bag_size: 639
batch 399, loss: 1.5375, instance_loss: 0.5777, weighted_loss: 1.2496, label: 0, bag_size: 367
batch 419, loss: 1.0591, instance_loss: 0.4851, weighted_loss: 0.8869, label: 3, bag_size: 510
batch 439, loss: 0.1477, instance_loss: 0.3139, weighted_loss: 0.1976, label: 0, bag_size: 188
batch 459, loss: 1.9195, instance_loss: 0.4956, weighted_loss: 1.4923, label: 2, bag_size: 1122
batch 479, loss: 1.1579, instance_loss: 0.5403, weighted_loss: 0.9726, label: 3, bag_size: 312
batch 499, loss: 1.0048, instance_loss: 0.4474, weighted_loss: 0.8376, label: 0, bag_size: 879
batch 519, loss: 0.9501, instance_loss: 0.4587, weighted_loss: 0.8027, label: 1, bag_size: 490
batch 539, loss: 0.0580, instance_loss: 0.2951, weighted_loss: 0.1291, label: 0, bag_size: 527
batch 559, loss: 1.5772, instance_loss: 0.4908, weighted_loss: 1.2513, label: 2, bag_size: 290
batch 579, loss: 1.8807, instance_loss: 0.5887, weighted_loss: 1.4931, label: 3, bag_size: 235


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.026515151515151516: correct 126/4752
Epoch: 14, train_loss: 1.2503, train_clustering_loss:  0.4901, train_error: 0.5370
class 0: acc 0.7741935483870968, correct 96/124
class 1: acc 0.4418604651162791, correct 57/129
class 2: acc 0.19090909090909092, correct 21/110
class 3: acc 0.36363636363636365, correct 40/110
class 4: acc 0.5041322314049587, correct 61/121

Val Set, val_loss: 1.5758, val_error: 0.5405, auc: 0.7749
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.7557, instance_loss: 0.4797, weighted_loss: 1.3729, label: 1, bag_size: 814
batch 39, loss: 1.2071, instance_loss: 0.5213, weighted_loss: 1.0013, label: 3, bag_size: 476
batch 59, loss: 0.1344, instance_loss: 0.3758, weighted_loss: 0.2068, label: 0, bag_size: 370
batch 79, loss: 0.9485, instance_loss: 0.4448, weighted_loss: 0.7974, label: 4, bag_size: 944
batch 99, loss: 2.3477, instance_loss: 0.5742, weighted_loss: 1.8157, label: 1, bag_size: 397
batch 119, loss: 0.8696, instance_loss: 0.4209, weighted_loss: 0.7350, label: 2, bag_size: 394
batch 139, loss: 0.8216, instance_loss: 0.4997, weighted_loss: 0.7250, label: 3, bag_size: 194
batch 159, loss: 1.9469, instance_loss: 0.6572, weighted_loss: 1.5600, label: 4, bag_size: 572
batch 179, loss: 1.7981, instance_loss: 0.5906, weighted_loss: 1.4358, label: 4, bag_size: 407
batch 199, loss: 1.5310, instance_loss: 0.5110, weighted_loss: 1.2250, label: 3, bag_size: 779
batch 219, loss: 1.4179, instance_loss: 0.4603, weighted_loss: 1.1306, label: 3, bag_size: 663
batch 239, loss: 0.5860, instance_loss: 0.4553, weighted_loss: 0.5468, label: 0, bag_size: 77
batch 259, loss: 1.1973, instance_loss: 0.4836, weighted_loss: 0.9832, label: 2, bag_size: 119
batch 279, loss: 0.1040, instance_loss: 0.2296, weighted_loss: 0.1417, label: 0, bag_size: 255
batch 299, loss: 1.0577, instance_loss: 0.4664, weighted_loss: 0.8804, label: 3, bag_size: 309
batch 319, loss: 0.2430, instance_loss: 0.2736, weighted_loss: 0.2522, label: 0, bag_size: 493
batch 339, loss: 0.9692, instance_loss: 0.4639, weighted_loss: 0.8176, label: 2, bag_size: 598
batch 359, loss: 0.7986, instance_loss: 0.3899, weighted_loss: 0.6760, label: 3, bag_size: 1232
batch 379, loss: 0.4616, instance_loss: 0.4644, weighted_loss: 0.4625, label: 0, bag_size: 319
batch 399, loss: 0.8111, instance_loss: 0.5040, weighted_loss: 0.7190, label: 3, bag_size: 476
batch 419, loss: 0.9169, instance_loss: 0.5316, weighted_loss: 0.8013, label: 4, bag_size: 489
batch 439, loss: 2.4997, instance_loss: 0.4956, weighted_loss: 1.8985, label: 2, bag_size: 219
batch 459, loss: 1.0070, instance_loss: 0.4375, weighted_loss: 0.8362, label: 2, bag_size: 717
batch 479, loss: 0.0001, instance_loss: 0.2793, weighted_loss: 0.0839, label: 0, bag_size: 175
batch 499, loss: 0.0308, instance_loss: 0.2221, weighted_loss: 0.0882, label: 0, bag_size: 101
batch 519, loss: 0.1168, instance_loss: 0.3452, weighted_loss: 0.1853, label: 0, bag_size: 79
batch 539, loss: 0.7665, instance_loss: 0.5000, weighted_loss: 0.6866, label: 4, bag_size: 490
batch 559, loss: 0.9071, instance_loss: 0.4692, weighted_loss: 0.7757, label: 4, bag_size: 618
batch 579, loss: 1.1252, instance_loss: 0.4983, weighted_loss: 0.9371, label: 1, bag_size: 658


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.041666666666666664: correct 198/4752
Epoch: 15, train_loss: 1.1843, train_clustering_loss:  0.4850, train_error: 0.5000
class 0: acc 0.8625954198473282, correct 113/131
class 1: acc 0.16666666666666666, correct 18/108
class 2: acc 0.4609375, correct 59/128
class 3: acc 0.40540540540540543, correct 45/111
class 4: acc 0.5344827586206896, correct 62/116

Val Set, val_loss: 1.5526, val_error: 0.5270, auc: 0.7772
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.7981, instance_loss: 0.4673, weighted_loss: 1.3989, label: 2, bag_size: 554
batch 39, loss: 0.1333, instance_loss: 0.5014, weighted_loss: 0.2438, label: 2, bag_size: 953
batch 59, loss: 0.1540, instance_loss: 0.3377, weighted_loss: 0.2091, label: 0, bag_size: 702
batch 79, loss: 1.9195, instance_loss: 0.4693, weighted_loss: 1.4844, label: 2, bag_size: 1060
batch 99, loss: 1.5709, instance_loss: 0.5748, weighted_loss: 1.2720, label: 3, bag_size: 1186
batch 119, loss: 1.4151, instance_loss: 0.5435, weighted_loss: 1.1536, label: 3, bag_size: 566
batch 139, loss: 2.4606, instance_loss: 0.5159, weighted_loss: 1.8772, label: 2, bag_size: 744
batch 159, loss: 1.1637, instance_loss: 0.4318, weighted_loss: 0.9442, label: 1, bag_size: 1104
batch 179, loss: 3.0117, instance_loss: 0.6813, weighted_loss: 2.3126, label: 0, bag_size: 283
batch 199, loss: 1.0594, instance_loss: 0.5442, weighted_loss: 0.9048, label: 4, bag_size: 563
batch 219, loss: 0.5863, instance_loss: 0.5846, weighted_loss: 0.5858, label: 4, bag_size: 854
batch 239, loss: 0.8380, instance_loss: 0.5073, weighted_loss: 0.7388, label: 2, bag_size: 1066
batch 259, loss: 0.0334, instance_loss: 0.2735, weighted_loss: 0.1054, label: 0, bag_size: 97
batch 279, loss: 4.2548, instance_loss: 0.7823, weighted_loss: 3.2130, label: 0, bag_size: 214
batch 299, loss: 1.2617, instance_loss: 0.5707, weighted_loss: 1.0544, label: 1, bag_size: 388
batch 319, loss: 0.1542, instance_loss: 0.3223, weighted_loss: 0.2046, label: 0, bag_size: 188
batch 339, loss: 1.0463, instance_loss: 0.5222, weighted_loss: 0.8891, label: 3, bag_size: 432
batch 359, loss: 0.6753, instance_loss: 0.4566, weighted_loss: 0.6097, label: 3, bag_size: 631
batch 379, loss: 1.5565, instance_loss: 0.5612, weighted_loss: 1.2579, label: 4, bag_size: 333
batch 399, loss: 1.4911, instance_loss: 0.6213, weighted_loss: 1.2302, label: 0, bag_size: 143
batch 419, loss: 0.0877, instance_loss: 0.4107, weighted_loss: 0.1846, label: 0, bag_size: 238
batch 439, loss: 1.8117, instance_loss: 0.4699, weighted_loss: 1.4091, label: 3, bag_size: 1358
batch 459, loss: 1.2621, instance_loss: 0.4652, weighted_loss: 1.0230, label: 1, bag_size: 381
batch 479, loss: 0.5625, instance_loss: 0.5222, weighted_loss: 0.5504, label: 0, bag_size: 62
batch 499, loss: 0.0027, instance_loss: 0.3353, weighted_loss: 0.1025, label: 0, bag_size: 706
batch 519, loss: 1.2163, instance_loss: 0.4814, weighted_loss: 0.9958, label: 2, bag_size: 315
batch 539, loss: 0.1045, instance_loss: 0.3150, weighted_loss: 0.1676, label: 0, bag_size: 37
batch 559, loss: 0.8603, instance_loss: 0.5215, weighted_loss: 0.7587, label: 2, bag_size: 168
batch 579, loss: 2.1153, instance_loss: 0.5753, weighted_loss: 1.6533, label: 2, bag_size: 829


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.04713804713804714: correct 224/4752
Epoch: 16, train_loss: 1.2052, train_clustering_loss:  0.4857, train_error: 0.5185
class 0: acc 0.8455882352941176, correct 115/136
class 1: acc 0.3, correct 36/120
class 2: acc 0.4051724137931034, correct 47/116
class 3: acc 0.4782608695652174, correct 55/115
class 4: acc 0.308411214953271, correct 33/107

Val Set, val_loss: 1.4617, val_error: 0.5405, auc: 0.7860
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0525, instance_loss: 0.3107, weighted_loss: 0.1300, label: 0, bag_size: 527
batch 39, loss: 2.4820, instance_loss: 0.5447, weighted_loss: 1.9008, label: 3, bag_size: 457
batch 59, loss: 0.4496, instance_loss: 0.4475, weighted_loss: 0.4490, label: 3, bag_size: 344
batch 79, loss: 0.7584, instance_loss: 0.4419, weighted_loss: 0.6634, label: 3, bag_size: 431
batch 99, loss: 1.2685, instance_loss: 0.4861, weighted_loss: 1.0338, label: 2, bag_size: 488
batch 119, loss: 1.2780, instance_loss: 0.5203, weighted_loss: 1.0507, label: 1, bag_size: 544
batch 139, loss: 0.9638, instance_loss: 0.4541, weighted_loss: 0.8109, label: 2, bag_size: 299
batch 159, loss: 1.9990, instance_loss: 0.5807, weighted_loss: 1.5735, label: 2, bag_size: 861
batch 179, loss: 1.5839, instance_loss: 0.5053, weighted_loss: 1.2603, label: 1, bag_size: 695
batch 199, loss: 0.5922, instance_loss: 0.4875, weighted_loss: 0.5608, label: 4, bag_size: 1018
batch 219, loss: 1.3719, instance_loss: 0.4425, weighted_loss: 1.0930, label: 0, bag_size: 587
batch 239, loss: 1.1746, instance_loss: 0.5179, weighted_loss: 0.9776, label: 4, bag_size: 937
batch 259, loss: 2.0389, instance_loss: 0.6315, weighted_loss: 1.6167, label: 1, bag_size: 113
batch 279, loss: 2.2194, instance_loss: 0.5459, weighted_loss: 1.7174, label: 2, bag_size: 829
batch 299, loss: 0.9362, instance_loss: 0.4609, weighted_loss: 0.7936, label: 2, bag_size: 633
batch 319, loss: 0.9902, instance_loss: 0.4483, weighted_loss: 0.8277, label: 3, bag_size: 1021
batch 339, loss: 0.8977, instance_loss: 0.4489, weighted_loss: 0.7631, label: 3, bag_size: 1078
batch 359, loss: 0.9448, instance_loss: 0.4322, weighted_loss: 0.7910, label: 3, bag_size: 499
batch 379, loss: 0.7561, instance_loss: 0.4093, weighted_loss: 0.6520, label: 4, bag_size: 775
batch 399, loss: 0.7604, instance_loss: 0.4246, weighted_loss: 0.6596, label: 3, bag_size: 194
batch 419, loss: 3.9745, instance_loss: 0.7412, weighted_loss: 3.0045, label: 1, bag_size: 45
batch 439, loss: 2.5060, instance_loss: 0.6114, weighted_loss: 1.9376, label: 4, bag_size: 1297
batch 459, loss: 0.4627, instance_loss: 0.3409, weighted_loss: 0.4262, label: 3, bag_size: 1001
batch 479, loss: 0.9180, instance_loss: 0.4391, weighted_loss: 0.7743, label: 4, bag_size: 329
batch 499, loss: 0.9240, instance_loss: 0.4825, weighted_loss: 0.7916, label: 2, bag_size: 617
batch 519, loss: 0.8406, instance_loss: 0.4797, weighted_loss: 0.7323, label: 1, bag_size: 766
batch 539, loss: 1.0066, instance_loss: 0.4725, weighted_loss: 0.8464, label: 2, bag_size: 598
batch 559, loss: 0.6758, instance_loss: 0.4223, weighted_loss: 0.5997, label: 3, bag_size: 737
batch 579, loss: 0.1973, instance_loss: 0.4298, weighted_loss: 0.2671, label: 2, bag_size: 953


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.024831649831649833: correct 118/4752
Epoch: 17, train_loss: 1.2037, train_clustering_loss:  0.4922, train_error: 0.5017
class 0: acc 0.7863247863247863, correct 92/117
class 1: acc 0.24545454545454545, correct 27/110
class 2: acc 0.42748091603053434, correct 56/131
class 3: acc 0.5793650793650794, correct 73/126
class 4: acc 0.43636363636363634, correct 48/110

Val Set, val_loss: 1.4217, val_error: 0.4865, auc: 0.8019
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.9034, instance_loss: 0.4733, weighted_loss: 0.7744, label: 3, bag_size: 309
batch 39, loss: 0.7796, instance_loss: 0.4489, weighted_loss: 0.6804, label: 3, bag_size: 737
batch 59, loss: 2.4108, instance_loss: 0.6086, weighted_loss: 1.8702, label: 1, bag_size: 113
batch 79, loss: 2.0387, instance_loss: 0.5843, weighted_loss: 1.6023, label: 4, bag_size: 730
batch 99, loss: 0.4671, instance_loss: 0.4090, weighted_loss: 0.4497, label: 0, bag_size: 404
batch 119, loss: 0.0672, instance_loss: 0.2780, weighted_loss: 0.1305, label: 0, bag_size: 355
batch 139, loss: 0.7003, instance_loss: 0.4155, weighted_loss: 0.6148, label: 1, bag_size: 1104
batch 159, loss: 1.1290, instance_loss: 0.4492, weighted_loss: 0.9251, label: 1, bag_size: 208
batch 179, loss: 1.4531, instance_loss: 0.4866, weighted_loss: 1.1631, label: 3, bag_size: 856
batch 199, loss: 0.8277, instance_loss: 0.4842, weighted_loss: 0.7247, label: 4, bag_size: 204
batch 219, loss: 0.0434, instance_loss: 0.2698, weighted_loss: 0.1113, label: 0, bag_size: 190
batch 239, loss: 0.6811, instance_loss: 0.7600, weighted_loss: 0.7048, label: 1, bag_size: 748
batch 259, loss: 1.6940, instance_loss: 0.4693, weighted_loss: 1.3266, label: 2, bag_size: 522
batch 279, loss: 1.2160, instance_loss: 0.4902, weighted_loss: 0.9983, label: 3, bag_size: 857
batch 299, loss: 1.0441, instance_loss: 0.4457, weighted_loss: 0.8646, label: 3, bag_size: 317
batch 319, loss: 1.1569, instance_loss: 0.6953, weighted_loss: 1.0184, label: 1, bag_size: 141
batch 339, loss: 0.8857, instance_loss: 0.4559, weighted_loss: 0.7567, label: 3, bag_size: 344
batch 359, loss: 0.4711, instance_loss: 0.3848, weighted_loss: 0.4452, label: 4, bag_size: 266
batch 379, loss: 1.2015, instance_loss: 0.4442, weighted_loss: 0.9743, label: 3, bag_size: 1154
batch 399, loss: 0.8940, instance_loss: 0.4372, weighted_loss: 0.7569, label: 2, bag_size: 812
batch 419, loss: 1.3601, instance_loss: 0.4407, weighted_loss: 1.0843, label: 1, bag_size: 408
batch 439, loss: 0.9753, instance_loss: 0.4620, weighted_loss: 0.8213, label: 2, bag_size: 445
batch 459, loss: 3.0489, instance_loss: 0.6674, weighted_loss: 2.3344, label: 0, bag_size: 745
batch 479, loss: 0.3866, instance_loss: 0.4260, weighted_loss: 0.3984, label: 4, bag_size: 409
batch 499, loss: 0.5595, instance_loss: 0.4497, weighted_loss: 0.5266, label: 2, bag_size: 769
batch 519, loss: 1.0521, instance_loss: 0.4659, weighted_loss: 0.8762, label: 1, bag_size: 605
batch 539, loss: 2.2431, instance_loss: 0.5520, weighted_loss: 1.7358, label: 1, bag_size: 591
batch 559, loss: 0.9092, instance_loss: 0.4687, weighted_loss: 0.7770, label: 3, bag_size: 944
batch 579, loss: 1.3923, instance_loss: 0.5340, weighted_loss: 1.1348, label: 2, bag_size: 864


class 0 clustering acc 0.997895622895623: correct 23710/23760
class 1 clustering acc 0.03872053872053872: correct 184/4752
Epoch: 18, train_loss: 1.1496, train_clustering_loss:  0.4858, train_error: 0.4848
class 0: acc 0.8629032258064516, correct 107/124
class 1: acc 0.4462809917355372, correct 54/121
class 2: acc 0.3113207547169811, correct 33/106
class 3: acc 0.4365079365079365, correct 55/126
class 4: acc 0.48717948717948717, correct 57/117

Val Set, val_loss: 1.5488, val_error: 0.5541, auc: 0.7858
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.3022, instance_loss: 0.6294, weighted_loss: 1.1003, label: 2, bag_size: 549
batch 39, loss: 1.0649, instance_loss: 0.4782, weighted_loss: 0.8889, label: 2, bag_size: 285
batch 59, loss: 1.0803, instance_loss: 0.4833, weighted_loss: 0.9012, label: 4, bag_size: 690
batch 79, loss: 1.9124, instance_loss: 0.5024, weighted_loss: 1.4894, label: 4, bag_size: 363
batch 99, loss: 0.6737, instance_loss: 0.4077, weighted_loss: 0.5939, label: 2, bag_size: 725
batch 119, loss: 1.0073, instance_loss: 0.5196, weighted_loss: 0.8610, label: 3, bag_size: 956
batch 139, loss: 0.0477, instance_loss: 0.2575, weighted_loss: 0.1106, label: 0, bag_size: 221
batch 159, loss: 0.6501, instance_loss: 0.5881, weighted_loss: 0.6315, label: 0, bag_size: 477
batch 179, loss: 2.1843, instance_loss: 0.5713, weighted_loss: 1.7004, label: 3, bag_size: 492
batch 199, loss: 1.5713, instance_loss: 0.4235, weighted_loss: 1.2270, label: 1, bag_size: 823
batch 219, loss: 0.9435, instance_loss: 0.4765, weighted_loss: 0.8034, label: 2, bag_size: 1079
batch 239, loss: 0.0218, instance_loss: 0.4620, weighted_loss: 0.1539, label: 2, bag_size: 953
batch 259, loss: 1.8622, instance_loss: 0.5124, weighted_loss: 1.4573, label: 1, bag_size: 988
batch 279, loss: 3.0295, instance_loss: 0.7673, weighted_loss: 2.3508, label: 0, bag_size: 367
batch 299, loss: 2.5192, instance_loss: 0.6468, weighted_loss: 1.9574, label: 0, bag_size: 745
batch 319, loss: 2.0586, instance_loss: 0.4988, weighted_loss: 1.5906, label: 2, bag_size: 861
batch 339, loss: 1.9629, instance_loss: 0.4957, weighted_loss: 1.5228, label: 2, bag_size: 582
batch 359, loss: 0.8548, instance_loss: 0.4343, weighted_loss: 0.7287, label: 3, bag_size: 102
batch 379, loss: 0.6681, instance_loss: 0.3909, weighted_loss: 0.5850, label: 3, bag_size: 1232
batch 399, loss: 3.1894, instance_loss: 0.5352, weighted_loss: 2.3931, label: 2, bag_size: 713
batch 419, loss: 1.5526, instance_loss: 0.4856, weighted_loss: 1.2325, label: 1, bag_size: 328
batch 439, loss: 1.2136, instance_loss: 0.5063, weighted_loss: 1.0014, label: 1, bag_size: 764
batch 459, loss: 1.2347, instance_loss: 0.4838, weighted_loss: 1.0095, label: 2, bag_size: 522
batch 479, loss: 2.6998, instance_loss: 0.7500, weighted_loss: 2.1149, label: 4, bag_size: 293
batch 499, loss: 1.1458, instance_loss: 0.5068, weighted_loss: 0.9541, label: 3, bag_size: 1060
batch 519, loss: 1.1024, instance_loss: 0.5616, weighted_loss: 0.9401, label: 2, bag_size: 25
batch 539, loss: 1.0274, instance_loss: 0.4029, weighted_loss: 0.8400, label: 1, bag_size: 201
batch 559, loss: 1.4805, instance_loss: 0.5879, weighted_loss: 1.2127, label: 4, bag_size: 270
batch 579, loss: 1.3658, instance_loss: 0.5174, weighted_loss: 1.1113, label: 4, bag_size: 438


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.036616161616161616: correct 174/4752
Epoch: 19, train_loss: 1.1925, train_clustering_loss:  0.4898, train_error: 0.5017
class 0: acc 0.7727272727272727, correct 85/110
class 1: acc 0.496551724137931, correct 72/145
class 2: acc 0.3391304347826087, correct 39/115
class 3: acc 0.3879310344827586, correct 45/116
class 4: acc 0.5092592592592593, correct 55/108

Val Set, val_loss: 1.5278, val_error: 0.5405, auc: 0.7579
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.4243, instance_loss: 0.3683, weighted_loss: 0.4075, label: 0, bag_size: 702
batch 39, loss: 1.1347, instance_loss: 0.4981, weighted_loss: 0.9437, label: 2, bag_size: 627
batch 59, loss: 0.0882, instance_loss: 0.3256, weighted_loss: 0.1594, label: 0, bag_size: 285
batch 79, loss: 2.5522, instance_loss: 0.6144, weighted_loss: 1.9709, label: 0, bag_size: 352
batch 99, loss: 0.2579, instance_loss: 0.3326, weighted_loss: 0.2803, label: 4, bag_size: 418
batch 119, loss: 1.3011, instance_loss: 0.5568, weighted_loss: 1.0778, label: 3, bag_size: 897
batch 139, loss: 0.0536, instance_loss: 0.2282, weighted_loss: 0.1060, label: 0, bag_size: 285
batch 159, loss: 0.6168, instance_loss: 0.4639, weighted_loss: 0.5709, label: 3, bag_size: 789
batch 179, loss: 0.2192, instance_loss: 0.3662, weighted_loss: 0.2633, label: 3, bag_size: 1001
batch 199, loss: 0.0035, instance_loss: 0.3522, weighted_loss: 0.1081, label: 0, bag_size: 15
batch 219, loss: 1.0712, instance_loss: 0.5125, weighted_loss: 0.9036, label: 1, bag_size: 384
batch 239, loss: 2.5186, instance_loss: 0.5165, weighted_loss: 1.9180, label: 1, bag_size: 564
batch 259, loss: 2.7216, instance_loss: 0.5584, weighted_loss: 2.0727, label: 2, bag_size: 258
batch 279, loss: 1.5983, instance_loss: 0.4088, weighted_loss: 1.2414, label: 3, bag_size: 615
batch 299, loss: 2.1593, instance_loss: 0.5708, weighted_loss: 1.6827, label: 2, bag_size: 394
batch 319, loss: 0.7555, instance_loss: 0.4169, weighted_loss: 0.6539, label: 1, bag_size: 814
batch 339, loss: 0.6909, instance_loss: 0.5348, weighted_loss: 0.6441, label: 4, bag_size: 394
batch 359, loss: 0.9335, instance_loss: 0.4750, weighted_loss: 0.7959, label: 2, bag_size: 299
batch 379, loss: 0.7740, instance_loss: 0.4276, weighted_loss: 0.6701, label: 1, bag_size: 1360
batch 399, loss: 1.1739, instance_loss: 0.5504, weighted_loss: 0.9869, label: 3, bag_size: 437
batch 419, loss: 0.0725, instance_loss: 0.2456, weighted_loss: 0.1244, label: 0, bag_size: 221
batch 439, loss: 0.6250, instance_loss: 0.6408, weighted_loss: 0.6297, label: 4, bag_size: 773
batch 459, loss: 0.3692, instance_loss: 0.4464, weighted_loss: 0.3923, label: 0, bag_size: 455
batch 479, loss: 0.8025, instance_loss: 0.3989, weighted_loss: 0.6814, label: 3, bag_size: 437
batch 499, loss: 1.0034, instance_loss: 0.4604, weighted_loss: 0.8405, label: 4, bag_size: 1077
batch 519, loss: 1.0184, instance_loss: 0.5632, weighted_loss: 0.8818, label: 4, bag_size: 618
batch 539, loss: 1.0995, instance_loss: 0.4594, weighted_loss: 0.9075, label: 2, bag_size: 783
batch 559, loss: 0.7590, instance_loss: 0.5004, weighted_loss: 0.6814, label: 1, bag_size: 814
batch 579, loss: 1.6539, instance_loss: 0.5359, weighted_loss: 1.3185, label: 1, bag_size: 490


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.03388047138047138: correct 161/4752
Epoch: 20, train_loss: 1.1223, train_clustering_loss:  0.4832, train_error: 0.4663
class 0: acc 0.7883211678832117, correct 108/137
class 1: acc 0.42727272727272725, correct 47/110
class 2: acc 0.22549019607843138, correct 23/102
class 3: acc 0.6106870229007634, correct 80/131
class 4: acc 0.5175438596491229, correct 59/114

Val Set, val_loss: 1.7489, val_error: 0.6486, auc: 0.7333
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.8882, instance_loss: 0.4373, weighted_loss: 0.7529, label: 3, bag_size: 473
batch 39, loss: 0.9569, instance_loss: 0.4520, weighted_loss: 0.8054, label: 2, bag_size: 584
batch 59, loss: 0.4421, instance_loss: 0.3722, weighted_loss: 0.4211, label: 4, bag_size: 775
batch 79, loss: 2.4007, instance_loss: 0.4636, weighted_loss: 1.8196, label: 3, bag_size: 496
batch 99, loss: 1.1100, instance_loss: 0.6263, weighted_loss: 0.9649, label: 1, bag_size: 153
batch 119, loss: 0.1767, instance_loss: 0.4716, weighted_loss: 0.2652, label: 0, bag_size: 57
batch 139, loss: 2.1180, instance_loss: 0.5489, weighted_loss: 1.6473, label: 2, bag_size: 563
batch 159, loss: 0.2737, instance_loss: 0.6558, weighted_loss: 0.3883, label: 4, bag_size: 541
batch 179, loss: 0.8545, instance_loss: 0.4176, weighted_loss: 0.7234, label: 3, bag_size: 1060
batch 199, loss: 0.9406, instance_loss: 0.4323, weighted_loss: 0.7881, label: 3, bag_size: 235
batch 219, loss: 1.0621, instance_loss: 0.4604, weighted_loss: 0.8816, label: 2, bag_size: 375
batch 239, loss: 2.1477, instance_loss: 0.5513, weighted_loss: 1.6687, label: 2, bag_size: 1319
batch 259, loss: 0.0026, instance_loss: 0.3006, weighted_loss: 0.0920, label: 4, bag_size: 530
batch 279, loss: 0.6710, instance_loss: 0.4474, weighted_loss: 0.6039, label: 3, bag_size: 317
batch 299, loss: 0.0010, instance_loss: 0.4234, weighted_loss: 0.1277, label: 4, bag_size: 530
batch 319, loss: 2.5779, instance_loss: 0.7822, weighted_loss: 2.0392, label: 0, bag_size: 1073
batch 339, loss: 0.0788, instance_loss: 0.2937, weighted_loss: 0.1433, label: 0, bag_size: 513
batch 359, loss: 1.9041, instance_loss: 0.4996, weighted_loss: 1.4828, label: 0, bag_size: 243
batch 379, loss: 3.2145, instance_loss: 0.5012, weighted_loss: 2.4005, label: 3, bag_size: 497
batch 399, loss: 0.5828, instance_loss: 0.4429, weighted_loss: 0.5408, label: 3, bag_size: 97
batch 419, loss: 0.1403, instance_loss: 0.5440, weighted_loss: 0.2614, label: 4, bag_size: 541
batch 439, loss: 1.9046, instance_loss: 0.5262, weighted_loss: 1.4911, label: 3, bag_size: 120
batch 459, loss: 2.5810, instance_loss: 0.6588, weighted_loss: 2.0043, label: 0, bag_size: 600
batch 479, loss: 0.8317, instance_loss: 0.4326, weighted_loss: 0.7120, label: 2, bag_size: 617
batch 499, loss: 1.0877, instance_loss: 0.5009, weighted_loss: 0.9117, label: 1, bag_size: 233
batch 519, loss: 0.6611, instance_loss: 0.4368, weighted_loss: 0.5938, label: 1, bag_size: 534
batch 539, loss: 0.9108, instance_loss: 0.4557, weighted_loss: 0.7742, label: 1, bag_size: 1104
batch 559, loss: 0.9932, instance_loss: 0.4570, weighted_loss: 0.8323, label: 1, bag_size: 614
batch 579, loss: 0.4152, instance_loss: 0.4368, weighted_loss: 0.4217, label: 3, bag_size: 956


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.02798821548821549: correct 133/4752
Epoch: 21, train_loss: 1.1455, train_clustering_loss:  0.4859, train_error: 0.4781
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.3391304347826087, correct 39/115
class 2: acc 0.4296875, correct 55/128
class 3: acc 0.5, correct 57/114
class 4: acc 0.5086206896551724, correct 59/116

Val Set, val_loss: 1.5142, val_error: 0.6081, auc: 0.7753
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.0937, instance_loss: 0.4743, weighted_loss: 0.9079, label: 3, bag_size: 1358
batch 39, loss: 1.7292, instance_loss: 0.5533, weighted_loss: 1.3764, label: 1, bag_size: 697
batch 59, loss: 1.1026, instance_loss: 0.4578, weighted_loss: 0.9092, label: 1, bag_size: 823
batch 79, loss: 0.9232, instance_loss: 0.4260, weighted_loss: 0.7741, label: 2, bag_size: 582
batch 99, loss: 0.7371, instance_loss: 0.4222, weighted_loss: 0.6426, label: 3, bag_size: 398
batch 119, loss: 0.9949, instance_loss: 0.4475, weighted_loss: 0.8307, label: 3, bag_size: 499
batch 139, loss: 1.2547, instance_loss: 0.4842, weighted_loss: 1.0236, label: 1, bag_size: 398
batch 159, loss: 1.1688, instance_loss: 0.5240, weighted_loss: 0.9754, label: 1, bag_size: 390
batch 179, loss: 1.7239, instance_loss: 0.5386, weighted_loss: 1.3683, label: 4, bag_size: 868
batch 199, loss: 1.6046, instance_loss: 0.5139, weighted_loss: 1.2774, label: 2, bag_size: 877
batch 219, loss: 0.4605, instance_loss: 0.4797, weighted_loss: 0.4663, label: 4, bag_size: 394
batch 239, loss: 0.8134, instance_loss: 0.4917, weighted_loss: 0.7169, label: 4, bag_size: 1041
batch 259, loss: 1.4526, instance_loss: 0.4941, weighted_loss: 1.1651, label: 2, bag_size: 906
batch 279, loss: 0.9956, instance_loss: 0.4623, weighted_loss: 0.8356, label: 3, bag_size: 403
batch 299, loss: 1.0617, instance_loss: 0.4738, weighted_loss: 0.8853, label: 3, bag_size: 364
batch 319, loss: 1.3446, instance_loss: 0.4602, weighted_loss: 1.0793, label: 2, bag_size: 258
batch 339, loss: 0.8129, instance_loss: 0.4247, weighted_loss: 0.6965, label: 1, bag_size: 332
batch 359, loss: 1.6867, instance_loss: 0.5094, weighted_loss: 1.3335, label: 1, bag_size: 874
batch 379, loss: 1.1365, instance_loss: 0.4864, weighted_loss: 0.9415, label: 2, bag_size: 549
batch 399, loss: 1.1765, instance_loss: 0.4369, weighted_loss: 0.9546, label: 2, bag_size: 906
batch 419, loss: 0.2090, instance_loss: 0.3709, weighted_loss: 0.2576, label: 0, bag_size: 295
batch 439, loss: 1.3458, instance_loss: 0.5471, weighted_loss: 1.1062, label: 3, bag_size: 1365
batch 459, loss: 0.9390, instance_loss: 0.4597, weighted_loss: 0.7952, label: 1, bag_size: 221
batch 479, loss: 1.5213, instance_loss: 0.4918, weighted_loss: 1.2124, label: 3, bag_size: 1057
batch 499, loss: 1.6007, instance_loss: 0.6703, weighted_loss: 1.3216, label: 0, bag_size: 178
batch 519, loss: 1.1905, instance_loss: 0.5520, weighted_loss: 0.9990, label: 4, bag_size: 690
batch 539, loss: 1.2292, instance_loss: 0.4603, weighted_loss: 0.9985, label: 3, bag_size: 781
batch 559, loss: 0.8856, instance_loss: 0.5071, weighted_loss: 0.7720, label: 2, bag_size: 592
batch 579, loss: 1.4075, instance_loss: 0.5079, weighted_loss: 1.1376, label: 4, bag_size: 726


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.023148148148148147: correct 110/4752
Epoch: 22, train_loss: 1.1899, train_clustering_loss:  0.4923, train_error: 0.5152
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.3953488372093023, correct 51/129
class 2: acc 0.325, correct 39/120
class 3: acc 0.45689655172413796, correct 53/116
class 4: acc 0.46296296296296297, correct 50/108

Val Set, val_loss: 1.4659, val_error: 0.5270, auc: 0.8101
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 22 out of 20


batch 19, loss: 1.2124, instance_loss: 0.4298, weighted_loss: 0.9776, label: 2, bag_size: 906
batch 39, loss: 0.5624, instance_loss: 0.4047, weighted_loss: 0.5151, label: 3, bag_size: 818
batch 59, loss: 1.4344, instance_loss: 0.5150, weighted_loss: 1.1586, label: 1, bag_size: 177
batch 79, loss: 2.2586, instance_loss: 0.6032, weighted_loss: 1.7620, label: 2, bag_size: 394
batch 99, loss: 0.8671, instance_loss: 0.4704, weighted_loss: 0.7481, label: 4, bag_size: 419
batch 119, loss: 0.0826, instance_loss: 0.3014, weighted_loss: 0.1482, label: 0, bag_size: 33
batch 139, loss: 1.0975, instance_loss: 0.5120, weighted_loss: 0.9219, label: 3, bag_size: 312
batch 159, loss: 2.4513, instance_loss: 0.5676, weighted_loss: 1.8862, label: 0, bag_size: 964
batch 179, loss: 1.1835, instance_loss: 0.5109, weighted_loss: 0.9817, label: 3, bag_size: 309
batch 199, loss: 1.1598, instance_loss: 0.5310, weighted_loss: 0.9711, label: 2, bag_size: 769
batch 219, loss: 0.2367, instance_loss: 0.4057, weighted_loss: 0.2874, label: 0, bag_size: 517
batch 239, loss: 0.6576, instance_loss: 0.4359, weighted_loss: 0.5911, label: 4, bag_size: 618
batch 259, loss: 0.8721, instance_loss: 0.4634, weighted_loss: 0.7495, label: 2, bag_size: 592
batch 279, loss: 1.5162, instance_loss: 0.4704, weighted_loss: 1.2025, label: 2, bag_size: 877
batch 299, loss: 0.7200, instance_loss: 0.4852, weighted_loss: 0.6495, label: 1, bag_size: 672
batch 319, loss: 0.5533, instance_loss: 0.5076, weighted_loss: 0.5396, label: 4, bag_size: 1018
batch 339, loss: 0.6462, instance_loss: 0.4737, weighted_loss: 0.5944, label: 4, bag_size: 204
batch 359, loss: 0.8001, instance_loss: 0.4694, weighted_loss: 0.7009, label: 4, bag_size: 124
batch 379, loss: 0.3534, instance_loss: 0.3767, weighted_loss: 0.3604, label: 0, bag_size: 297
batch 399, loss: 1.0647, instance_loss: 0.4990, weighted_loss: 0.8949, label: 1, bag_size: 390
batch 419, loss: 0.8503, instance_loss: 0.4040, weighted_loss: 0.7164, label: 3, bag_size: 944
batch 439, loss: 0.0817, instance_loss: 0.2794, weighted_loss: 0.1410, label: 0, bag_size: 98
batch 459, loss: 1.7951, instance_loss: 0.5419, weighted_loss: 1.4191, label: 2, bag_size: 717
batch 479, loss: 0.9181, instance_loss: 0.4447, weighted_loss: 0.7761, label: 1, bag_size: 390
batch 499, loss: 0.9909, instance_loss: 0.3732, weighted_loss: 0.8056, label: 2, bag_size: 769
batch 519, loss: 0.6729, instance_loss: 0.4534, weighted_loss: 0.6071, label: 1, bag_size: 1104
batch 539, loss: 0.2443, instance_loss: 0.3547, weighted_loss: 0.2774, label: 0, bag_size: 103
batch 559, loss: 0.6184, instance_loss: 0.4034, weighted_loss: 0.5539, label: 3, bag_size: 272
batch 579, loss: 1.0683, instance_loss: 0.4841, weighted_loss: 0.8930, label: 1, bag_size: 764


class 0 clustering acc 0.998442760942761: correct 23723/23760
class 1 clustering acc 0.022306397306397305: correct 106/4752
Epoch: 23, train_loss: 1.1020, train_clustering_loss:  0.4826, train_error: 0.4714
class 0: acc 0.8070175438596491, correct 92/114
class 1: acc 0.4878048780487805, correct 60/123
class 2: acc 0.275, correct 33/120
class 3: acc 0.5801526717557252, correct 76/131
class 4: acc 0.5, correct 53/106

Val Set, val_loss: 1.5784, val_error: 0.5270, auc: 0.7901
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.7664, instance_loss: 0.4732, weighted_loss: 0.6784, label: 3, bag_size: 344
batch 39, loss: 1.0791, instance_loss: 0.5798, weighted_loss: 0.9293, label: 4, bag_size: 797
batch 59, loss: 0.6893, instance_loss: 0.4279, weighted_loss: 0.6109, label: 2, bag_size: 385
batch 79, loss: 0.0038, instance_loss: 0.3596, weighted_loss: 0.1106, label: 2, bag_size: 1975
batch 99, loss: 1.0734, instance_loss: 0.4727, weighted_loss: 0.8932, label: 3, bag_size: 192
batch 119, loss: 1.1774, instance_loss: 0.5117, weighted_loss: 0.9777, label: 1, bag_size: 981
batch 139, loss: 1.1365, instance_loss: 0.5285, weighted_loss: 0.9541, label: 3, bag_size: 872
batch 159, loss: 1.2604, instance_loss: 0.5550, weighted_loss: 1.0487, label: 4, bag_size: 363
batch 179, loss: 1.7220, instance_loss: 0.5299, weighted_loss: 1.3644, label: 2, bag_size: 582
batch 199, loss: 1.5505, instance_loss: 0.5124, weighted_loss: 1.2391, label: 1, bag_size: 419
batch 219, loss: 1.8140, instance_loss: 0.5617, weighted_loss: 1.4383, label: 3, bag_size: 500
batch 239, loss: 1.1807, instance_loss: 0.5170, weighted_loss: 0.9816, label: 2, bag_size: 208
batch 259, loss: 2.9105, instance_loss: 0.7410, weighted_loss: 2.2597, label: 0, bag_size: 352
batch 279, loss: 0.9646, instance_loss: 0.4524, weighted_loss: 0.8109, label: 3, bag_size: 309
batch 299, loss: 1.3231, instance_loss: 0.4572, weighted_loss: 1.0633, label: 0, bag_size: 879
batch 319, loss: 1.2043, instance_loss: 0.4973, weighted_loss: 0.9922, label: 4, bag_size: 419
batch 339, loss: 0.8951, instance_loss: 0.4429, weighted_loss: 0.7595, label: 1, bag_size: 823
batch 359, loss: 2.6695, instance_loss: 0.5615, weighted_loss: 2.0371, label: 3, bag_size: 856
batch 379, loss: 0.5836, instance_loss: 0.5311, weighted_loss: 0.5679, label: 3, bag_size: 403
batch 399, loss: 0.4546, instance_loss: 0.4607, weighted_loss: 0.4564, label: 4, bag_size: 775
batch 419, loss: 1.8480, instance_loss: 0.5607, weighted_loss: 1.4618, label: 2, bag_size: 860
batch 439, loss: 1.0091, instance_loss: 0.4412, weighted_loss: 0.8387, label: 1, bag_size: 660
batch 459, loss: 0.4037, instance_loss: 0.5416, weighted_loss: 0.4451, label: 4, bag_size: 773
batch 479, loss: 0.7248, instance_loss: 0.4472, weighted_loss: 0.6415, label: 1, bag_size: 766
batch 499, loss: 0.5411, instance_loss: 0.3974, weighted_loss: 0.4980, label: 4, bag_size: 875
batch 519, loss: 0.6236, instance_loss: 0.4433, weighted_loss: 0.5695, label: 3, bag_size: 928
batch 539, loss: 0.0547, instance_loss: 0.3006, weighted_loss: 0.1285, label: 0, bag_size: 59
batch 559, loss: 0.0381, instance_loss: 0.2832, weighted_loss: 0.1116, label: 0, bag_size: 188
batch 579, loss: 1.1647, instance_loss: 0.5816, weighted_loss: 0.9898, label: 2, bag_size: 702


class 0 clustering acc 0.9966329966329966: correct 23680/23760
class 1 clustering acc 0.04503367003367004: correct 214/4752
Epoch: 24, train_loss: 1.0819, train_clustering_loss:  0.4767, train_error: 0.4714
class 0: acc 0.796875, correct 102/128
class 1: acc 0.4017094017094017, correct 47/117
class 2: acc 0.3669724770642202, correct 40/109
class 3: acc 0.4649122807017544, correct 53/114
class 4: acc 0.5714285714285714, correct 72/126

Val Set, val_loss: 1.5480, val_error: 0.5811, auc: 0.7691
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 24 out of 20


batch 19, loss: 3.3909, instance_loss: 0.7873, weighted_loss: 2.6098, label: 0, bag_size: 492
batch 39, loss: 2.4029, instance_loss: 0.5467, weighted_loss: 1.8460, label: 4, bag_size: 590
batch 59, loss: 0.8801, instance_loss: 0.4337, weighted_loss: 0.7462, label: 1, bag_size: 695
batch 79, loss: 1.4938, instance_loss: 0.4749, weighted_loss: 1.1882, label: 2, bag_size: 746
batch 99, loss: 0.5792, instance_loss: 0.4089, weighted_loss: 0.5281, label: 3, bag_size: 309
batch 119, loss: 0.5260, instance_loss: 0.3849, weighted_loss: 0.4837, label: 3, bag_size: 1232
batch 139, loss: 0.1456, instance_loss: 0.3854, weighted_loss: 0.2176, label: 0, bag_size: 297
batch 159, loss: 0.9274, instance_loss: 0.4142, weighted_loss: 0.7734, label: 3, bag_size: 822
batch 179, loss: 3.8326, instance_loss: 0.6269, weighted_loss: 2.8709, label: 3, bag_size: 543
batch 199, loss: 1.4773, instance_loss: 0.5157, weighted_loss: 1.1888, label: 4, bag_size: 1104
batch 219, loss: 1.3733, instance_loss: 0.5149, weighted_loss: 1.1158, label: 1, bag_size: 591
batch 239, loss: 0.0893, instance_loss: 0.3193, weighted_loss: 0.1583, label: 0, bag_size: 295
batch 259, loss: 0.2736, instance_loss: 0.3002, weighted_loss: 0.2815, label: 0, bag_size: 98
batch 279, loss: 1.9512, instance_loss: 0.5410, weighted_loss: 1.5281, label: 4, bag_size: 363
batch 299, loss: 2.2723, instance_loss: 0.6326, weighted_loss: 1.7804, label: 3, bag_size: 342
batch 319, loss: 0.9784, instance_loss: 0.4858, weighted_loss: 0.8306, label: 1, bag_size: 814
batch 339, loss: 1.2116, instance_loss: 0.5518, weighted_loss: 1.0137, label: 2, bag_size: 864
batch 359, loss: 0.0538, instance_loss: 0.4489, weighted_loss: 0.1723, label: 0, bag_size: 435
batch 379, loss: 0.9929, instance_loss: 0.4692, weighted_loss: 0.8358, label: 1, bag_size: 814
batch 399, loss: 1.0105, instance_loss: 0.4744, weighted_loss: 0.8497, label: 1, bag_size: 500
batch 419, loss: 0.3956, instance_loss: 0.4281, weighted_loss: 0.4053, label: 4, bag_size: 773
batch 439, loss: 1.0518, instance_loss: 0.4565, weighted_loss: 0.8732, label: 4, bag_size: 726
batch 459, loss: 0.9615, instance_loss: 0.4468, weighted_loss: 0.8071, label: 1, bag_size: 1121
batch 479, loss: 3.4389, instance_loss: 0.6401, weighted_loss: 2.5993, label: 3, bag_size: 166
batch 499, loss: 1.1548, instance_loss: 0.5117, weighted_loss: 0.9618, label: 3, bag_size: 944
batch 519, loss: 1.1320, instance_loss: 0.4517, weighted_loss: 0.9279, label: 3, bag_size: 499
batch 539, loss: 3.0535, instance_loss: 0.6816, weighted_loss: 2.3419, label: 0, bag_size: 1073
batch 559, loss: 1.6147, instance_loss: 0.5057, weighted_loss: 1.2820, label: 3, bag_size: 120
batch 579, loss: 0.6402, instance_loss: 0.4464, weighted_loss: 0.5820, label: 3, bag_size: 956


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.04377104377104377: correct 208/4752
Epoch: 25, train_loss: 1.1101, train_clustering_loss:  0.4799, train_error: 0.4714
class 0: acc 0.8062015503875969, correct 104/129
class 1: acc 0.4915254237288136, correct 58/118
class 2: acc 0.29411764705882354, correct 35/119
class 3: acc 0.5042735042735043, correct 59/117
class 4: acc 0.5225225225225225, correct 58/111

Val Set, val_loss: 1.5692, val_error: 0.5541, auc: 0.7674
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.5320, instance_loss: 0.4037, weighted_loss: 0.4935, label: 4, bag_size: 432
batch 39, loss: 0.0554, instance_loss: 0.2061, weighted_loss: 0.1006, label: 0, bag_size: 57
batch 59, loss: 1.0704, instance_loss: 0.4523, weighted_loss: 0.8850, label: 0, bag_size: 478
batch 79, loss: 1.5694, instance_loss: 0.5024, weighted_loss: 1.2493, label: 1, bag_size: 1082
batch 99, loss: 1.0077, instance_loss: 0.4721, weighted_loss: 0.8470, label: 1, bag_size: 855
batch 119, loss: 0.9380, instance_loss: 0.4848, weighted_loss: 0.8020, label: 1, bag_size: 892
batch 139, loss: 1.2555, instance_loss: 0.5138, weighted_loss: 1.0330, label: 1, bag_size: 372
batch 159, loss: 0.9509, instance_loss: 0.5086, weighted_loss: 0.8182, label: 4, bag_size: 690
batch 179, loss: 0.0528, instance_loss: 0.2831, weighted_loss: 0.1219, label: 0, bag_size: 101
batch 199, loss: 0.7523, instance_loss: 0.4351, weighted_loss: 0.6572, label: 4, bag_size: 660
batch 219, loss: 1.1390, instance_loss: 0.4649, weighted_loss: 0.9368, label: 3, bag_size: 194
batch 239, loss: 1.5746, instance_loss: 0.6185, weighted_loss: 1.2878, label: 2, bag_size: 96
batch 259, loss: 1.8433, instance_loss: 0.5326, weighted_loss: 1.4501, label: 4, bag_size: 333
batch 279, loss: 0.1484, instance_loss: 0.3350, weighted_loss: 0.2044, label: 0, bag_size: 15
batch 299, loss: 1.2410, instance_loss: 0.5220, weighted_loss: 1.0253, label: 2, bag_size: 427
batch 319, loss: 0.9414, instance_loss: 0.4622, weighted_loss: 0.7976, label: 2, bag_size: 867
batch 339, loss: 0.0302, instance_loss: 0.2795, weighted_loss: 0.1050, label: 0, bag_size: 527
batch 359, loss: 1.3450, instance_loss: 0.4836, weighted_loss: 1.0866, label: 1, bag_size: 398
batch 379, loss: 0.6111, instance_loss: 0.3735, weighted_loss: 0.5398, label: 3, bag_size: 857
batch 399, loss: 0.4958, instance_loss: 0.6380, weighted_loss: 0.5385, label: 1, bag_size: 141
batch 419, loss: 1.2091, instance_loss: 0.4597, weighted_loss: 0.9842, label: 1, bag_size: 1103
batch 439, loss: 0.0081, instance_loss: 0.1362, weighted_loss: 0.0465, label: 0, bag_size: 133
batch 459, loss: 0.4506, instance_loss: 0.3908, weighted_loss: 0.4326, label: 3, bag_size: 684
batch 479, loss: 0.8702, instance_loss: 0.4525, weighted_loss: 0.7449, label: 2, bag_size: 697
batch 499, loss: 2.3819, instance_loss: 0.6035, weighted_loss: 1.8484, label: 2, bag_size: 553
batch 519, loss: 0.8530, instance_loss: 0.4790, weighted_loss: 0.7408, label: 3, bag_size: 1021
batch 539, loss: 0.9017, instance_loss: 0.4698, weighted_loss: 0.7721, label: 1, bag_size: 544
batch 559, loss: 0.2227, instance_loss: 0.3195, weighted_loss: 0.2518, label: 0, bag_size: 404
batch 579, loss: 1.9253, instance_loss: 0.4612, weighted_loss: 1.4861, label: 1, bag_size: 840


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.04061447811447812: correct 193/4752
Epoch: 26, train_loss: 1.0983, train_clustering_loss:  0.4773, train_error: 0.4646
class 0: acc 0.792, correct 99/125
class 1: acc 0.45901639344262296, correct 56/122
class 2: acc 0.26548672566371684, correct 30/113
class 3: acc 0.5528455284552846, correct 68/123
class 4: acc 0.5855855855855856, correct 65/111

Val Set, val_loss: 1.5865, val_error: 0.5405, auc: 0.7641
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.2152, instance_loss: 0.5078, weighted_loss: 1.0030, label: 3, bag_size: 498
batch 39, loss: 1.9548, instance_loss: 0.5469, weighted_loss: 1.5324, label: 4, bag_size: 685
batch 59, loss: 1.9175, instance_loss: 0.5393, weighted_loss: 1.5041, label: 2, bag_size: 297
batch 79, loss: 0.5757, instance_loss: 0.4023, weighted_loss: 0.5237, label: 4, bag_size: 685
batch 99, loss: 0.7020, instance_loss: 0.6577, weighted_loss: 0.6887, label: 1, bag_size: 106
batch 119, loss: 0.2262, instance_loss: 0.4547, weighted_loss: 0.2948, label: 4, bag_size: 773
batch 139, loss: 2.2037, instance_loss: 0.5325, weighted_loss: 1.7023, label: 0, bag_size: 243
batch 159, loss: 0.2208, instance_loss: 0.3227, weighted_loss: 0.2514, label: 0, bag_size: 159
batch 179, loss: 0.6072, instance_loss: 0.4720, weighted_loss: 0.5667, label: 4, bag_size: 714
batch 199, loss: 0.0310, instance_loss: 0.3332, weighted_loss: 0.1216, label: 0, bag_size: 341
batch 219, loss: 0.9783, instance_loss: 0.4223, weighted_loss: 0.8115, label: 2, bag_size: 445
batch 239, loss: 1.0797, instance_loss: 0.4790, weighted_loss: 0.8994, label: 3, bag_size: 746
batch 259, loss: 1.1159, instance_loss: 0.5201, weighted_loss: 0.9372, label: 3, bag_size: 499
batch 279, loss: 1.0699, instance_loss: 0.4622, weighted_loss: 0.8876, label: 4, bag_size: 318
batch 299, loss: 1.2670, instance_loss: 0.5009, weighted_loss: 1.0372, label: 4, bag_size: 342
batch 319, loss: 0.6765, instance_loss: 0.4362, weighted_loss: 0.6044, label: 4, bag_size: 419
batch 339, loss: 0.1063, instance_loss: 0.3010, weighted_loss: 0.1647, label: 0, bag_size: 355
batch 359, loss: 1.6555, instance_loss: 0.5377, weighted_loss: 1.3202, label: 1, bag_size: 840
batch 379, loss: 0.2025, instance_loss: 0.3055, weighted_loss: 0.2334, label: 0, bag_size: 103
batch 399, loss: 0.1914, instance_loss: 0.3374, weighted_loss: 0.2352, label: 0, bag_size: 527
batch 419, loss: 0.9330, instance_loss: 0.5024, weighted_loss: 0.8039, label: 2, bag_size: 582
batch 439, loss: 0.6758, instance_loss: 0.4383, weighted_loss: 0.6045, label: 3, bag_size: 587
batch 459, loss: 1.2390, instance_loss: 0.4795, weighted_loss: 1.0112, label: 1, bag_size: 525
batch 479, loss: 0.9511, instance_loss: 0.4436, weighted_loss: 0.7989, label: 1, bag_size: 444
batch 499, loss: 1.6751, instance_loss: 0.5499, weighted_loss: 1.3375, label: 3, bag_size: 453
batch 519, loss: 1.3837, instance_loss: 0.5605, weighted_loss: 1.1367, label: 0, bag_size: 587
batch 539, loss: 1.1420, instance_loss: 0.4492, weighted_loss: 0.9341, label: 3, bag_size: 102
batch 559, loss: 0.9642, instance_loss: 0.4704, weighted_loss: 0.8161, label: 1, bag_size: 1273
batch 579, loss: 1.0778, instance_loss: 0.4402, weighted_loss: 0.8865, label: 3, bag_size: 97


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.02798821548821549: correct 133/4752
Epoch: 27, train_loss: 1.1281, train_clustering_loss:  0.4833, train_error: 0.5185
class 0: acc 0.7522935779816514, correct 82/109
class 1: acc 0.22330097087378642, correct 23/103
class 2: acc 0.45901639344262296, correct 56/122
class 3: acc 0.4728682170542636, correct 61/129
class 4: acc 0.48854961832061067, correct 64/131

Val Set, val_loss: 1.5863, val_error: 0.5946, auc: 0.7648
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.0845, instance_loss: 0.4470, weighted_loss: 0.8932, label: 3, bag_size: 894
batch 39, loss: 0.8724, instance_loss: 0.4390, weighted_loss: 0.7423, label: 2, bag_size: 821
batch 59, loss: 0.9102, instance_loss: 0.4098, weighted_loss: 0.7601, label: 1, bag_size: 1023
batch 79, loss: 1.0689, instance_loss: 0.5083, weighted_loss: 0.9007, label: 4, bag_size: 868
batch 99, loss: 0.6158, instance_loss: 0.4582, weighted_loss: 0.5685, label: 4, bag_size: 776
batch 119, loss: 1.6363, instance_loss: 0.5787, weighted_loss: 1.3190, label: 3, bag_size: 431
batch 139, loss: 0.0001, instance_loss: 0.6192, weighted_loss: 0.1858, label: 2, bag_size: 953
batch 159, loss: 0.6661, instance_loss: 0.4385, weighted_loss: 0.5979, label: 3, bag_size: 641
batch 179, loss: 0.0003, instance_loss: 0.0596, weighted_loss: 0.0181, label: 4, bag_size: 813
batch 199, loss: 2.0620, instance_loss: 0.6847, weighted_loss: 1.6488, label: 2, bag_size: 340
batch 219, loss: 0.8706, instance_loss: 0.4255, weighted_loss: 0.7371, label: 1, bag_size: 201
batch 239, loss: 0.7619, instance_loss: 0.4632, weighted_loss: 0.6723, label: 4, bag_size: 218
batch 259, loss: 1.0251, instance_loss: 0.4473, weighted_loss: 0.8517, label: 1, bag_size: 500
batch 279, loss: 0.9392, instance_loss: 0.6130, weighted_loss: 0.8413, label: 1, bag_size: 1082
batch 299, loss: 0.9457, instance_loss: 0.4883, weighted_loss: 0.8085, label: 2, bag_size: 617
batch 319, loss: 0.8196, instance_loss: 0.4279, weighted_loss: 0.7021, label: 1, bag_size: 697
batch 339, loss: 0.9034, instance_loss: 0.4550, weighted_loss: 0.7689, label: 2, bag_size: 598
batch 359, loss: 0.5745, instance_loss: 0.4617, weighted_loss: 0.5406, label: 4, bag_size: 875
batch 379, loss: 2.3471, instance_loss: 0.5973, weighted_loss: 1.8221, label: 2, bag_size: 754
batch 399, loss: 3.4023, instance_loss: 0.6127, weighted_loss: 2.5654, label: 0, bag_size: 214
batch 419, loss: 0.6395, instance_loss: 0.4025, weighted_loss: 0.5684, label: 4, bag_size: 875
batch 439, loss: 0.5656, instance_loss: 0.5068, weighted_loss: 0.5480, label: 0, bag_size: 306
batch 459, loss: 0.9191, instance_loss: 0.4546, weighted_loss: 0.7798, label: 1, bag_size: 413
batch 479, loss: 0.7315, instance_loss: 0.4208, weighted_loss: 0.6383, label: 1, bag_size: 444
batch 499, loss: 0.0264, instance_loss: 0.3196, weighted_loss: 0.1144, label: 0, bag_size: 103
batch 519, loss: 0.7956, instance_loss: 0.5419, weighted_loss: 0.7195, label: 0, bag_size: 62
batch 539, loss: 2.1995, instance_loss: 0.5741, weighted_loss: 1.7119, label: 1, bag_size: 391
batch 559, loss: 0.8240, instance_loss: 0.4216, weighted_loss: 0.7033, label: 2, bag_size: 779
batch 579, loss: 0.8227, instance_loss: 0.4432, weighted_loss: 0.7089, label: 1, bag_size: 390


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.05176767676767677: correct 246/4752
Epoch: 28, train_loss: 1.0928, train_clustering_loss:  0.4768, train_error: 0.4966
class 0: acc 0.813953488372093, correct 105/129
class 1: acc 0.5625, correct 72/128
class 2: acc 0.16666666666666666, correct 19/114
class 3: acc 0.38596491228070173, correct 44/114
class 4: acc 0.5412844036697247, correct 59/109

Val Set, val_loss: 1.7537, val_error: 0.5541, auc: 0.7738
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.037162162162162164: correct 22/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0749, instance_loss: 0.4614, weighted_loss: 0.1909, label: 0, bag_size: 230
batch 39, loss: 0.2374, instance_loss: 0.3947, weighted_loss: 0.2846, label: 0, bag_size: 404
batch 59, loss: 0.2806, instance_loss: 0.3655, weighted_loss: 0.3061, label: 4, bag_size: 394
batch 79, loss: 2.6199, instance_loss: 0.5769, weighted_loss: 2.0070, label: 2, bag_size: 394
batch 99, loss: 1.7769, instance_loss: 0.4159, weighted_loss: 1.3686, label: 3, bag_size: 166
batch 119, loss: 0.9018, instance_loss: 0.4221, weighted_loss: 0.7579, label: 3, bag_size: 317
batch 139, loss: 1.8523, instance_loss: 0.5683, weighted_loss: 1.4671, label: 4, bag_size: 685
batch 159, loss: 0.4637, instance_loss: 0.3218, weighted_loss: 0.4211, label: 4, bag_size: 948
batch 179, loss: 0.8897, instance_loss: 0.4727, weighted_loss: 0.7646, label: 1, bag_size: 660
batch 199, loss: 1.0929, instance_loss: 0.4256, weighted_loss: 0.8927, label: 3, bag_size: 631
batch 219, loss: 1.7571, instance_loss: 0.4903, weighted_loss: 1.3770, label: 3, bag_size: 323
batch 239, loss: 0.8328, instance_loss: 0.4568, weighted_loss: 0.7200, label: 4, bag_size: 731
batch 259, loss: 2.5089, instance_loss: 0.5856, weighted_loss: 1.9319, label: 2, bag_size: 297
batch 279, loss: 0.9630, instance_loss: 0.4312, weighted_loss: 0.8035, label: 3, bag_size: 473
batch 299, loss: 0.8561, instance_loss: 0.4267, weighted_loss: 0.7273, label: 3, bag_size: 312
batch 319, loss: 1.6260, instance_loss: 0.4960, weighted_loss: 1.2870, label: 2, bag_size: 549
batch 339, loss: 1.3614, instance_loss: 0.5122, weighted_loss: 1.1066, label: 1, bag_size: 1360
batch 359, loss: 3.4593, instance_loss: 0.5661, weighted_loss: 2.5913, label: 2, bag_size: 809
batch 379, loss: 0.0963, instance_loss: 0.4067, weighted_loss: 0.1895, label: 0, bag_size: 210
batch 399, loss: 0.8217, instance_loss: 0.4295, weighted_loss: 0.7040, label: 3, bag_size: 312
batch 419, loss: 1.1964, instance_loss: 0.5998, weighted_loss: 1.0174, label: 4, bag_size: 853
batch 439, loss: 0.4197, instance_loss: 0.4301, weighted_loss: 0.4229, label: 2, bag_size: 779
batch 459, loss: 0.5613, instance_loss: 0.4163, weighted_loss: 0.5178, label: 2, bag_size: 543
batch 479, loss: 0.4416, instance_loss: 0.3650, weighted_loss: 0.4186, label: 2, bag_size: 286
batch 499, loss: 0.0000, instance_loss: 0.3894, weighted_loss: 0.1168, label: 4, bag_size: 813
batch 519, loss: 0.1432, instance_loss: 0.3272, weighted_loss: 0.1984, label: 0, bag_size: 573
batch 539, loss: 3.5715, instance_loss: 0.7740, weighted_loss: 2.7322, label: 3, bag_size: 638
batch 559, loss: 1.5332, instance_loss: 0.5634, weighted_loss: 1.2422, label: 1, bag_size: 874
batch 579, loss: 1.7181, instance_loss: 0.5589, weighted_loss: 1.3703, label: 2, bag_size: 361


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.03977272727272727: correct 189/4752
Epoch: 29, train_loss: 1.0848, train_clustering_loss:  0.4766, train_error: 0.4545
class 0: acc 0.7874015748031497, correct 100/127
class 1: acc 0.3584905660377358, correct 38/106
class 2: acc 0.4594594594594595, correct 51/111
class 3: acc 0.5681818181818182, correct 75/132
class 4: acc 0.5084745762711864, correct 60/118

Val Set, val_loss: 1.6024, val_error: 0.5541, auc: 0.7860
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 29 out of 20


batch 19, loss: 1.2738, instance_loss: 0.5241, weighted_loss: 1.0489, label: 4, bag_size: 699
batch 39, loss: 0.0516, instance_loss: 0.2948, weighted_loss: 0.1245, label: 0, bag_size: 355
batch 59, loss: 0.9839, instance_loss: 0.5641, weighted_loss: 0.8580, label: 2, bag_size: 340
batch 79, loss: 0.3924, instance_loss: 0.4810, weighted_loss: 0.4190, label: 0, bag_size: 455
batch 99, loss: 1.1958, instance_loss: 0.5011, weighted_loss: 0.9874, label: 4, bag_size: 312
batch 119, loss: 0.9496, instance_loss: 0.4721, weighted_loss: 0.8063, label: 2, bag_size: 299
batch 139, loss: 1.9301, instance_loss: 0.5349, weighted_loss: 1.5115, label: 2, bag_size: 331
batch 159, loss: 0.1761, instance_loss: 0.3491, weighted_loss: 0.2280, label: 0, bag_size: 69
batch 179, loss: 0.9319, instance_loss: 0.4474, weighted_loss: 0.7865, label: 1, bag_size: 1104
batch 199, loss: 2.1535, instance_loss: 0.5819, weighted_loss: 1.6820, label: 2, bag_size: 627
batch 219, loss: 1.5990, instance_loss: 0.6251, weighted_loss: 1.3068, label: 0, bag_size: 1414
batch 239, loss: 0.4376, instance_loss: 0.4394, weighted_loss: 0.4382, label: 0, bag_size: 238
batch 259, loss: 0.7652, instance_loss: 0.4507, weighted_loss: 0.6709, label: 4, bag_size: 589
batch 279, loss: 1.3231, instance_loss: 0.5161, weighted_loss: 1.0810, label: 3, bag_size: 944
batch 299, loss: 3.5941, instance_loss: 0.6218, weighted_loss: 2.7024, label: 2, bag_size: 1319
batch 319, loss: 1.0723, instance_loss: 0.4862, weighted_loss: 0.8965, label: 3, bag_size: 894
batch 339, loss: 0.8733, instance_loss: 0.5009, weighted_loss: 0.7615, label: 1, bag_size: 184
batch 359, loss: 0.8824, instance_loss: 0.4542, weighted_loss: 0.7539, label: 3, bag_size: 488
batch 379, loss: 0.0134, instance_loss: 0.1994, weighted_loss: 0.0692, label: 0, bag_size: 306
batch 399, loss: 0.4094, instance_loss: 0.4518, weighted_loss: 0.4221, label: 4, bag_size: 1018
batch 419, loss: 0.0122, instance_loss: 0.2141, weighted_loss: 0.0728, label: 0, bag_size: 133
batch 439, loss: 1.1483, instance_loss: 0.4119, weighted_loss: 0.9274, label: 4, bag_size: 176
batch 459, loss: 1.7101, instance_loss: 0.5042, weighted_loss: 1.3483, label: 1, bag_size: 391
batch 479, loss: 0.9742, instance_loss: 0.4581, weighted_loss: 0.8193, label: 1, bag_size: 311
batch 499, loss: 0.7261, instance_loss: 0.4109, weighted_loss: 0.6315, label: 4, bag_size: 1077
batch 519, loss: 1.3071, instance_loss: 0.5390, weighted_loss: 1.0767, label: 2, bag_size: 582
batch 539, loss: 0.8905, instance_loss: 0.4803, weighted_loss: 0.7675, label: 3, bag_size: 510
batch 559, loss: 1.2417, instance_loss: 0.4259, weighted_loss: 0.9970, label: 1, bag_size: 332
batch 579, loss: 3.8769, instance_loss: 0.6513, weighted_loss: 2.9092, label: 1, bag_size: 45


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.025252525252525252: correct 120/4752
Epoch: 30, train_loss: 1.1050, train_clustering_loss:  0.4866, train_error: 0.4663
class 0: acc 0.819672131147541, correct 100/122
class 1: acc 0.5431034482758621, correct 63/116
class 2: acc 0.1368421052631579, correct 13/95
class 3: acc 0.47619047619047616, correct 60/126
class 4: acc 0.6, correct 81/135

Val Set, val_loss: 1.6583, val_error: 0.5676, auc: 0.7593
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 30 out of 20


batch 19, loss: 1.2226, instance_loss: 0.4792, weighted_loss: 0.9996, label: 2, bag_size: 867
batch 39, loss: 0.3192, instance_loss: 0.3641, weighted_loss: 0.3326, label: 4, bag_size: 780
batch 59, loss: 0.0124, instance_loss: 0.4934, weighted_loss: 0.1567, label: 0, bag_size: 428
batch 79, loss: 1.4240, instance_loss: 0.5383, weighted_loss: 1.1583, label: 3, bag_size: 603
batch 99, loss: 1.4201, instance_loss: 0.4932, weighted_loss: 1.1420, label: 2, bag_size: 953
batch 119, loss: 2.6292, instance_loss: 0.6088, weighted_loss: 2.0231, label: 2, bag_size: 720
batch 139, loss: 1.4594, instance_loss: 0.4996, weighted_loss: 1.1714, label: 4, bag_size: 377
batch 159, loss: 0.0113, instance_loss: 0.3550, weighted_loss: 0.1144, label: 0, bag_size: 370
batch 179, loss: 0.0108, instance_loss: 0.2524, weighted_loss: 0.0833, label: 0, bag_size: 97
batch 199, loss: 1.1443, instance_loss: 0.4902, weighted_loss: 0.9481, label: 0, bag_size: 247
batch 219, loss: 0.8561, instance_loss: 0.4609, weighted_loss: 0.7376, label: 1, bag_size: 906
batch 239, loss: 1.3736, instance_loss: 0.4941, weighted_loss: 1.1098, label: 2, bag_size: 584
batch 259, loss: 1.7340, instance_loss: 0.4906, weighted_loss: 1.3609, label: 2, bag_size: 582
batch 279, loss: 1.9951, instance_loss: 0.5369, weighted_loss: 1.5577, label: 4, bag_size: 98
batch 299, loss: 0.1125, instance_loss: 0.2545, weighted_loss: 0.1551, label: 0, bag_size: 488
batch 319, loss: 0.8939, instance_loss: 0.4544, weighted_loss: 0.7620, label: 1, bag_size: 208
batch 339, loss: 1.2600, instance_loss: 0.5275, weighted_loss: 1.0402, label: 2, bag_size: 303
batch 359, loss: 0.7677, instance_loss: 0.4232, weighted_loss: 0.6644, label: 1, bag_size: 593
batch 379, loss: 2.3376, instance_loss: 0.6137, weighted_loss: 1.8204, label: 2, bag_size: 1060
batch 399, loss: 0.0520, instance_loss: 0.2491, weighted_loss: 0.1111, label: 0, bag_size: 97
batch 419, loss: 1.9572, instance_loss: 0.5792, weighted_loss: 1.5438, label: 2, bag_size: 627
batch 439, loss: 0.6208, instance_loss: 0.4080, weighted_loss: 0.5570, label: 1, bag_size: 1104
batch 459, loss: 0.6732, instance_loss: 0.4364, weighted_loss: 0.6021, label: 1, bag_size: 1273
batch 479, loss: 1.0583, instance_loss: 0.5805, weighted_loss: 0.9150, label: 4, bag_size: 395
batch 499, loss: 0.9010, instance_loss: 0.4225, weighted_loss: 0.7575, label: 3, bag_size: 317
batch 519, loss: 1.0858, instance_loss: 0.4440, weighted_loss: 0.8933, label: 3, bag_size: 102
batch 539, loss: 0.8778, instance_loss: 0.4874, weighted_loss: 0.7607, label: 2, bag_size: 934
batch 559, loss: 1.3564, instance_loss: 0.4546, weighted_loss: 1.0858, label: 1, bag_size: 233
batch 579, loss: 1.6098, instance_loss: 0.5985, weighted_loss: 1.3064, label: 2, bag_size: 1074


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.03745791245791246: correct 178/4752
Epoch: 31, train_loss: 1.0891, train_clustering_loss:  0.4803, train_error: 0.4714
class 0: acc 0.7565217391304347, correct 87/115
class 1: acc 0.5434782608695652, correct 75/138
class 2: acc 0.34210526315789475, correct 39/114
class 3: acc 0.49056603773584906, correct 52/106
class 4: acc 0.5041322314049587, correct 61/121

Val Set, val_loss: 1.7269, val_error: 0.5541, auc: 0.7823
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0155, instance_loss: 0.2813, weighted_loss: 0.0952, label: 0, bag_size: 340
batch 39, loss: 0.6109, instance_loss: 0.4267, weighted_loss: 0.5557, label: 3, bag_size: 194
batch 59, loss: 0.1002, instance_loss: 0.3609, weighted_loss: 0.1784, label: 0, bag_size: 33
batch 79, loss: 1.4262, instance_loss: 0.6130, weighted_loss: 1.1822, label: 2, bag_size: 512
batch 99, loss: 0.8305, instance_loss: 0.4273, weighted_loss: 0.7095, label: 2, bag_size: 567
batch 119, loss: 1.1096, instance_loss: 0.4782, weighted_loss: 0.9202, label: 2, bag_size: 867
batch 139, loss: 0.6465, instance_loss: 0.3966, weighted_loss: 0.5715, label: 1, bag_size: 906
batch 159, loss: 1.5676, instance_loss: 0.5814, weighted_loss: 1.2717, label: 4, bag_size: 730
batch 179, loss: 0.9724, instance_loss: 0.5379, weighted_loss: 0.8420, label: 4, bag_size: 490
batch 199, loss: 0.2218, instance_loss: 0.3698, weighted_loss: 0.2662, label: 0, bag_size: 282
batch 219, loss: 0.3081, instance_loss: 0.4758, weighted_loss: 0.3584, label: 3, bag_size: 794
batch 239, loss: 1.7975, instance_loss: 0.5570, weighted_loss: 1.4254, label: 1, bag_size: 564
batch 259, loss: 0.6846, instance_loss: 0.5247, weighted_loss: 0.6366, label: 2, bag_size: 1066
batch 279, loss: 0.6087, instance_loss: 0.5323, weighted_loss: 0.5857, label: 3, bag_size: 674
batch 299, loss: 0.6422, instance_loss: 0.4267, weighted_loss: 0.5775, label: 4, bag_size: 775
batch 319, loss: 0.0405, instance_loss: 0.3770, weighted_loss: 0.1414, label: 0, bag_size: 285
batch 339, loss: 0.4734, instance_loss: 0.4053, weighted_loss: 0.4530, label: 3, bag_size: 780
batch 359, loss: 1.5226, instance_loss: 0.6158, weighted_loss: 1.2506, label: 0, bag_size: 428
batch 379, loss: 2.8226, instance_loss: 0.8280, weighted_loss: 2.2242, label: 1, bag_size: 153
batch 399, loss: 0.8476, instance_loss: 0.4792, weighted_loss: 0.7371, label: 3, bag_size: 1078
batch 419, loss: 2.3250, instance_loss: 0.5836, weighted_loss: 1.8026, label: 2, bag_size: 498
batch 439, loss: 1.3904, instance_loss: 0.4725, weighted_loss: 1.1150, label: 3, bag_size: 899
batch 459, loss: 0.5778, instance_loss: 0.4899, weighted_loss: 0.5514, label: 2, bag_size: 690
batch 479, loss: 1.7009, instance_loss: 0.4670, weighted_loss: 1.3307, label: 2, bag_size: 941
batch 499, loss: 0.0762, instance_loss: 0.3474, weighted_loss: 0.1576, label: 0, bag_size: 71
batch 519, loss: 1.1425, instance_loss: 0.4928, weighted_loss: 0.9476, label: 3, bag_size: 344
batch 539, loss: 1.2148, instance_loss: 0.4944, weighted_loss: 0.9987, label: 3, bag_size: 344
batch 559, loss: 0.5500, instance_loss: 0.4038, weighted_loss: 0.5062, label: 4, bag_size: 218
batch 579, loss: 1.9804, instance_loss: 0.5030, weighted_loss: 1.5372, label: 4, bag_size: 363


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.025252525252525252: correct 120/4752
Epoch: 32, train_loss: 1.1132, train_clustering_loss:  0.4818, train_error: 0.4697
class 0: acc 0.7777777777777778, correct 91/117
class 1: acc 0.5327868852459017, correct 65/122
class 2: acc 0.28695652173913044, correct 33/115
class 3: acc 0.5042016806722689, correct 60/119
class 4: acc 0.5454545454545454, correct 66/121

Val Set, val_loss: 1.6409, val_error: 0.5270, auc: 0.8068
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.06587837837837837: correct 39/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.7614, instance_loss: 0.4492, weighted_loss: 0.6677, label: 2, bag_size: 1079
batch 39, loss: 1.6856, instance_loss: 0.5347, weighted_loss: 1.3403, label: 2, bag_size: 498
batch 59, loss: 0.0001, instance_loss: 0.3966, weighted_loss: 0.1191, label: 4, bag_size: 530
batch 79, loss: 0.6784, instance_loss: 0.3824, weighted_loss: 0.5896, label: 4, bag_size: 329
batch 99, loss: 1.0212, instance_loss: 0.4679, weighted_loss: 0.8552, label: 1, bag_size: 419
batch 119, loss: 0.5912, instance_loss: 0.4782, weighted_loss: 0.5573, label: 4, bag_size: 432
batch 139, loss: 0.0667, instance_loss: 0.2802, weighted_loss: 0.1307, label: 0, bag_size: 164
batch 159, loss: 0.0305, instance_loss: 0.3398, weighted_loss: 0.1233, label: 0, bag_size: 88
batch 179, loss: 0.8516, instance_loss: 0.4322, weighted_loss: 0.7258, label: 1, bag_size: 1043
batch 199, loss: 0.0321, instance_loss: 0.1853, weighted_loss: 0.0781, label: 0, bag_size: 101
batch 219, loss: 0.7971, instance_loss: 0.4865, weighted_loss: 0.7039, label: 3, bag_size: 899
batch 239, loss: 2.2262, instance_loss: 0.5345, weighted_loss: 1.7187, label: 3, bag_size: 166
batch 259, loss: 1.1766, instance_loss: 0.4450, weighted_loss: 0.9571, label: 3, bag_size: 488
batch 279, loss: 1.2318, instance_loss: 0.4542, weighted_loss: 0.9985, label: 1, bag_size: 413
batch 299, loss: 0.7461, instance_loss: 0.4661, weighted_loss: 0.6621, label: 3, bag_size: 476
batch 319, loss: 0.0408, instance_loss: 0.2500, weighted_loss: 0.1036, label: 0, bag_size: 88
batch 339, loss: 0.5715, instance_loss: 0.4566, weighted_loss: 0.5370, label: 0, bag_size: 77
batch 359, loss: 1.6928, instance_loss: 0.5250, weighted_loss: 1.3424, label: 3, bag_size: 779
batch 379, loss: 0.3089, instance_loss: 0.3748, weighted_loss: 0.3287, label: 0, bag_size: 493
batch 399, loss: 0.3472, instance_loss: 0.3752, weighted_loss: 0.3556, label: 4, bag_size: 744
batch 419, loss: 0.7950, instance_loss: 0.4452, weighted_loss: 0.6900, label: 1, bag_size: 444
batch 439, loss: 0.8372, instance_loss: 0.4652, weighted_loss: 0.7256, label: 3, bag_size: 317
batch 459, loss: 1.0404, instance_loss: 0.5182, weighted_loss: 0.8837, label: 1, bag_size: 371
batch 479, loss: 0.3641, instance_loss: 0.4762, weighted_loss: 0.3977, label: 3, bag_size: 818
batch 499, loss: 1.1429, instance_loss: 0.5018, weighted_loss: 0.9505, label: 2, bag_size: 427
batch 519, loss: 0.8402, instance_loss: 0.4984, weighted_loss: 0.7376, label: 4, bag_size: 853
batch 539, loss: 0.9171, instance_loss: 0.4697, weighted_loss: 0.7829, label: 3, bag_size: 459
batch 559, loss: 0.0574, instance_loss: 0.2976, weighted_loss: 0.1295, label: 0, bag_size: 98
batch 579, loss: 0.9974, instance_loss: 0.4221, weighted_loss: 0.8248, label: 2, bag_size: 725


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.061658249158249155: correct 293/4752
Epoch: 33, train_loss: 1.0170, train_clustering_loss:  0.4680, train_error: 0.4192
class 0: acc 0.8267716535433071, correct 105/127
class 1: acc 0.5409836065573771, correct 66/122
class 2: acc 0.23853211009174313, correct 26/109
class 3: acc 0.6147540983606558, correct 75/122
class 4: acc 0.6403508771929824, correct 73/114

Val Set, val_loss: 1.6198, val_error: 0.5676, auc: 0.7836
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.3149, instance_loss: 0.3783, weighted_loss: 0.3339, label: 3, bag_size: 476
batch 39, loss: 1.1094, instance_loss: 0.4518, weighted_loss: 0.9121, label: 2, bag_size: 779
batch 59, loss: 0.8265, instance_loss: 0.4635, weighted_loss: 0.7176, label: 1, bag_size: 381
batch 79, loss: 0.5099, instance_loss: 0.4025, weighted_loss: 0.4777, label: 4, bag_size: 618
batch 99, loss: 0.7294, instance_loss: 0.7476, weighted_loss: 0.7349, label: 0, bag_size: 416
batch 119, loss: 1.0304, instance_loss: 0.6142, weighted_loss: 0.9055, label: 1, bag_size: 371
batch 139, loss: 1.9615, instance_loss: 0.5480, weighted_loss: 1.5374, label: 0, bag_size: 214
batch 159, loss: 0.5748, instance_loss: 0.4497, weighted_loss: 0.5373, label: 1, bag_size: 605
batch 179, loss: 1.4445, instance_loss: 0.9533, weighted_loss: 1.2971, label: 3, bag_size: 31
batch 199, loss: 0.4436, instance_loss: 0.4528, weighted_loss: 0.4464, label: 4, bag_size: 695
batch 219, loss: 0.6366, instance_loss: 0.4133, weighted_loss: 0.5696, label: 1, bag_size: 390
batch 239, loss: 2.2419, instance_loss: 0.5240, weighted_loss: 1.7266, label: 3, bag_size: 498
batch 259, loss: 0.4365, instance_loss: 0.4240, weighted_loss: 0.4328, label: 4, bag_size: 776
batch 279, loss: 1.0471, instance_loss: 0.4971, weighted_loss: 0.8821, label: 2, bag_size: 404
batch 299, loss: 0.9736, instance_loss: 0.4786, weighted_loss: 0.8251, label: 2, bag_size: 614
batch 319, loss: 1.2193, instance_loss: 0.5490, weighted_loss: 1.0182, label: 3, bag_size: 309
batch 339, loss: 0.2584, instance_loss: 0.4303, weighted_loss: 0.3100, label: 0, bag_size: 59
batch 359, loss: 0.0859, instance_loss: 0.2515, weighted_loss: 0.1356, label: 0, bag_size: 133
batch 379, loss: 1.7524, instance_loss: 0.6073, weighted_loss: 1.4089, label: 2, bag_size: 321
batch 399, loss: 1.5024, instance_loss: 0.5231, weighted_loss: 1.2086, label: 2, bag_size: 1077
batch 419, loss: 0.2283, instance_loss: 0.5460, weighted_loss: 0.3236, label: 0, bag_size: 416
batch 439, loss: 0.7062, instance_loss: 0.3823, weighted_loss: 0.6090, label: 1, bag_size: 855
batch 459, loss: 1.5256, instance_loss: 0.4468, weighted_loss: 1.2019, label: 3, bag_size: 894
batch 479, loss: 0.6060, instance_loss: 0.4365, weighted_loss: 0.5551, label: 3, bag_size: 245
batch 499, loss: 1.1045, instance_loss: 0.4282, weighted_loss: 0.9016, label: 0, bag_size: 223
batch 519, loss: 0.6924, instance_loss: 0.6555, weighted_loss: 0.6813, label: 4, bag_size: 293
batch 539, loss: 0.5354, instance_loss: 0.5315, weighted_loss: 0.5342, label: 0, bag_size: 416
batch 559, loss: 1.2984, instance_loss: 0.5197, weighted_loss: 1.0647, label: 2, bag_size: 1077
batch 579, loss: 3.7711, instance_loss: 0.6614, weighted_loss: 2.8382, label: 4, bag_size: 270


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.03766835016835017: correct 179/4752
Epoch: 34, train_loss: 1.0680, train_clustering_loss:  0.4791, train_error: 0.4310
class 0: acc 0.7747747747747747, correct 86/111
class 1: acc 0.6530612244897959, correct 96/147
class 2: acc 0.2803738317757009, correct 30/107
class 3: acc 0.5384615384615384, correct 63/117
class 4: acc 0.5625, correct 63/112

Val Set, val_loss: 1.5939, val_error: 0.5676, auc: 0.7785
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 34 out of 20


batch 19, loss: 2.1070, instance_loss: 0.6157, weighted_loss: 1.6596, label: 2, bag_size: 361
batch 39, loss: 0.0198, instance_loss: 0.2086, weighted_loss: 0.0764, label: 0, bag_size: 190
batch 59, loss: 0.6586, instance_loss: 0.4712, weighted_loss: 0.6024, label: 0, bag_size: 428
batch 79, loss: 1.4231, instance_loss: 0.4804, weighted_loss: 1.1403, label: 1, bag_size: 1023
batch 99, loss: 0.7189, instance_loss: 0.4968, weighted_loss: 0.6523, label: 1, bag_size: 388
batch 119, loss: 0.9908, instance_loss: 0.5201, weighted_loss: 0.8496, label: 2, bag_size: 886
batch 139, loss: 0.9065, instance_loss: 0.4992, weighted_loss: 0.7843, label: 2, bag_size: 348
batch 159, loss: 1.8979, instance_loss: 0.6321, weighted_loss: 1.5181, label: 0, bag_size: 710
batch 179, loss: 1.1183, instance_loss: 0.4302, weighted_loss: 0.9118, label: 4, bag_size: 1031
batch 199, loss: 1.8895, instance_loss: 0.4694, weighted_loss: 1.4635, label: 4, bag_size: 310
batch 219, loss: 1.7232, instance_loss: 0.9813, weighted_loss: 1.5006, label: 3, bag_size: 31
batch 239, loss: 0.3116, instance_loss: 0.3633, weighted_loss: 0.3271, label: 4, bag_size: 228
batch 259, loss: 0.9124, instance_loss: 0.4579, weighted_loss: 0.7760, label: 1, bag_size: 221
batch 279, loss: 2.1775, instance_loss: 0.5147, weighted_loss: 1.6786, label: 1, bag_size: 988
batch 299, loss: 1.7778, instance_loss: 0.5850, weighted_loss: 1.4199, label: 2, bag_size: 799
batch 319, loss: 3.3656, instance_loss: 0.7744, weighted_loss: 2.5882, label: 3, bag_size: 520
batch 339, loss: 1.9880, instance_loss: 0.5008, weighted_loss: 1.5418, label: 4, bag_size: 407
batch 359, loss: 0.7968, instance_loss: 0.5329, weighted_loss: 0.7177, label: 3, bag_size: 1365
batch 379, loss: 3.0055, instance_loss: 0.6461, weighted_loss: 2.2977, label: 4, bag_size: 1297
batch 399, loss: 2.2932, instance_loss: 0.5956, weighted_loss: 1.7839, label: 2, bag_size: 339
batch 419, loss: 1.4545, instance_loss: 0.5632, weighted_loss: 1.1871, label: 0, bag_size: 566
batch 439, loss: 1.7619, instance_loss: 0.5238, weighted_loss: 1.3905, label: 2, bag_size: 934
batch 459, loss: 0.8773, instance_loss: 0.4077, weighted_loss: 0.7364, label: 1, bag_size: 381
batch 479, loss: 0.2267, instance_loss: 0.5775, weighted_loss: 0.3319, label: 0, bag_size: 435
batch 499, loss: 1.2807, instance_loss: 0.6173, weighted_loss: 1.0817, label: 4, bag_size: 267
batch 519, loss: 2.4482, instance_loss: 0.5195, weighted_loss: 1.8696, label: 2, bag_size: 629
batch 539, loss: 1.0360, instance_loss: 0.4923, weighted_loss: 0.8729, label: 3, bag_size: 344
batch 559, loss: 0.0747, instance_loss: 0.2857, weighted_loss: 0.1380, label: 0, bag_size: 306
batch 579, loss: 0.9351, instance_loss: 0.5145, weighted_loss: 0.8089, label: 3, bag_size: 282


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.05955387205387205: correct 283/4752
Epoch: 35, train_loss: 1.0378, train_clustering_loss:  0.4727, train_error: 0.4242
class 0: acc 0.8412698412698413, correct 106/126
class 1: acc 0.5083333333333333, correct 61/120
class 2: acc 0.3482142857142857, correct 39/112
class 3: acc 0.5714285714285714, correct 68/119
class 4: acc 0.5811965811965812, correct 68/117

Val Set, val_loss: 1.6256, val_error: 0.5946, auc: 0.7789
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 35 out of 20


batch 19, loss: 1.3656, instance_loss: 0.5184, weighted_loss: 1.1114, label: 1, bag_size: 208
batch 39, loss: 0.9961, instance_loss: 0.4480, weighted_loss: 0.8317, label: 1, bag_size: 695
batch 59, loss: 1.1482, instance_loss: 0.6045, weighted_loss: 0.9851, label: 2, bag_size: 339
batch 79, loss: 0.6324, instance_loss: 0.5108, weighted_loss: 0.5959, label: 4, bag_size: 895
batch 99, loss: 1.0163, instance_loss: 0.5084, weighted_loss: 0.8639, label: 4, bag_size: 639
batch 119, loss: 4.7166, instance_loss: 0.7502, weighted_loss: 3.5267, label: 2, bag_size: 128
batch 139, loss: 0.0000, instance_loss: 0.3965, weighted_loss: 0.1190, label: 1, bag_size: 669
batch 159, loss: 1.1939, instance_loss: 0.4968, weighted_loss: 0.9848, label: 3, bag_size: 663
batch 179, loss: 0.6686, instance_loss: 0.3957, weighted_loss: 0.5868, label: 2, bag_size: 783
batch 199, loss: 0.8717, instance_loss: 0.5030, weighted_loss: 0.7611, label: 3, bag_size: 822
batch 219, loss: 0.8273, instance_loss: 0.4404, weighted_loss: 0.7113, label: 1, bag_size: 742
batch 239, loss: 0.6912, instance_loss: 0.4171, weighted_loss: 0.6090, label: 3, bag_size: 437
batch 259, loss: 0.8611, instance_loss: 0.4262, weighted_loss: 0.7306, label: 1, bag_size: 697
batch 279, loss: 0.0125, instance_loss: 0.0954, weighted_loss: 0.0374, label: 0, bag_size: 156
batch 299, loss: 0.7812, instance_loss: 0.4622, weighted_loss: 0.6855, label: 3, bag_size: 996
batch 319, loss: 0.0032, instance_loss: 0.1592, weighted_loss: 0.0500, label: 0, bag_size: 80
batch 339, loss: 0.5576, instance_loss: 0.3707, weighted_loss: 0.5015, label: 2, bag_size: 410
batch 359, loss: 2.5155, instance_loss: 0.5694, weighted_loss: 1.9317, label: 0, bag_size: 367
batch 379, loss: 1.2192, instance_loss: 0.5218, weighted_loss: 1.0100, label: 1, bag_size: 534
batch 399, loss: 1.2621, instance_loss: 0.5455, weighted_loss: 1.0471, label: 1, bag_size: 384
batch 419, loss: 0.4699, instance_loss: 0.4480, weighted_loss: 0.4633, label: 4, bag_size: 683
batch 439, loss: 1.0343, instance_loss: 0.5060, weighted_loss: 0.8758, label: 2, bag_size: 119
batch 459, loss: 0.8095, instance_loss: 0.4174, weighted_loss: 0.6919, label: 4, bag_size: 333
batch 479, loss: 3.5603, instance_loss: 0.8629, weighted_loss: 2.7511, label: 2, bag_size: 219
batch 499, loss: 0.0301, instance_loss: 0.2277, weighted_loss: 0.0894, label: 0, bag_size: 69
batch 519, loss: 2.6838, instance_loss: 0.8032, weighted_loss: 2.1197, label: 2, bag_size: 219
batch 539, loss: 2.3239, instance_loss: 0.5912, weighted_loss: 1.8041, label: 1, bag_size: 161
batch 559, loss: 0.4710, instance_loss: 0.4159, weighted_loss: 0.4545, label: 4, bag_size: 775
batch 579, loss: 0.9033, instance_loss: 0.5048, weighted_loss: 0.7837, label: 1, bag_size: 1103


class 0 clustering acc 0.9952441077441078: correct 23647/23760
class 1 clustering acc 0.06081649831649832: correct 289/4752
Epoch: 36, train_loss: 1.0787, train_clustering_loss:  0.4773, train_error: 0.4394
class 0: acc 0.7857142857142857, correct 88/112
class 1: acc 0.4765625, correct 61/128
class 2: acc 0.40601503759398494, correct 54/133
class 3: acc 0.5798319327731093, correct 69/119
class 4: acc 0.5980392156862745, correct 61/102

Val Set, val_loss: 1.7304, val_error: 0.4595, auc: 0.7985
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 36 out of 20


batch 19, loss: 1.1636, instance_loss: 0.4763, weighted_loss: 0.9574, label: 1, bag_size: 372
batch 39, loss: 0.9667, instance_loss: 0.4656, weighted_loss: 0.8164, label: 2, bag_size: 877
batch 59, loss: 0.2517, instance_loss: 0.4197, weighted_loss: 0.3021, label: 0, bag_size: 238
batch 79, loss: 0.7250, instance_loss: 0.4662, weighted_loss: 0.6474, label: 1, bag_size: 1121
batch 99, loss: 1.1140, instance_loss: 0.5913, weighted_loss: 0.9572, label: 1, bag_size: 614
batch 119, loss: 0.4010, instance_loss: 0.4980, weighted_loss: 0.4301, label: 4, bag_size: 520
batch 139, loss: 0.7558, instance_loss: 0.4558, weighted_loss: 0.6658, label: 2, bag_size: 253
batch 159, loss: 0.0692, instance_loss: 0.3641, weighted_loss: 0.1577, label: 0, bag_size: 71
batch 179, loss: 0.5116, instance_loss: 0.4050, weighted_loss: 0.4797, label: 2, bag_size: 285
batch 199, loss: 0.5263, instance_loss: 0.5052, weighted_loss: 0.5200, label: 4, bag_size: 618
batch 219, loss: 0.0158, instance_loss: 0.3862, weighted_loss: 0.1269, label: 0, bag_size: 218
batch 239, loss: 2.2476, instance_loss: 0.5516, weighted_loss: 1.7388, label: 1, bag_size: 742
batch 259, loss: 0.0265, instance_loss: 0.3344, weighted_loss: 0.1189, label: 0, bag_size: 357
batch 279, loss: 1.4921, instance_loss: 0.5321, weighted_loss: 1.2041, label: 3, bag_size: 780
batch 299, loss: 0.6423, instance_loss: 0.3860, weighted_loss: 0.5654, label: 3, bag_size: 369
batch 319, loss: 0.1402, instance_loss: 0.2662, weighted_loss: 0.1780, label: 0, bag_size: 269
batch 339, loss: 1.3400, instance_loss: 0.5160, weighted_loss: 1.0928, label: 4, bag_size: 98
batch 359, loss: 0.2306, instance_loss: 0.3861, weighted_loss: 0.2773, label: 4, bag_size: 266
batch 379, loss: 0.0319, instance_loss: 0.1000, weighted_loss: 0.0523, label: 0, bag_size: 57
batch 399, loss: 0.3458, instance_loss: 0.4655, weighted_loss: 0.3817, label: 3, bag_size: 476
batch 419, loss: 0.6778, instance_loss: 0.5330, weighted_loss: 0.6344, label: 0, bag_size: 122
batch 439, loss: 0.6766, instance_loss: 0.4737, weighted_loss: 0.6157, label: 1, bag_size: 892
batch 459, loss: 1.5813, instance_loss: 0.4675, weighted_loss: 1.2472, label: 1, bag_size: 355
batch 479, loss: 1.1854, instance_loss: 0.5062, weighted_loss: 0.9816, label: 1, bag_size: 925
batch 499, loss: 1.5404, instance_loss: 0.5045, weighted_loss: 1.2296, label: 1, bag_size: 672
batch 519, loss: 0.4992, instance_loss: 0.3966, weighted_loss: 0.4684, label: 3, bag_size: 369
batch 539, loss: 1.1948, instance_loss: 0.5417, weighted_loss: 0.9989, label: 1, bag_size: 614
batch 559, loss: 0.5700, instance_loss: 0.4884, weighted_loss: 0.5455, label: 0, bag_size: 143
batch 579, loss: 0.1798, instance_loss: 0.2492, weighted_loss: 0.2006, label: 0, bag_size: 513


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.04903198653198653: correct 233/4752
Epoch: 37, train_loss: 1.0617, train_clustering_loss:  0.4799, train_error: 0.4815
class 0: acc 0.819672131147541, correct 100/122
class 1: acc 0.3482142857142857, correct 39/112
class 2: acc 0.3412698412698413, correct 43/126
class 3: acc 0.5984848484848485, correct 79/132
class 4: acc 0.46078431372549017, correct 47/102

Val Set, val_loss: 1.6693, val_error: 0.5541, auc: 0.7823
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 37 out of 20


batch 19, loss: 2.6055, instance_loss: 0.6407, weighted_loss: 2.0161, label: 4, bag_size: 476
batch 39, loss: 0.7342, instance_loss: 0.4036, weighted_loss: 0.6350, label: 3, bag_size: 459
batch 59, loss: 0.0264, instance_loss: 0.5026, weighted_loss: 0.1692, label: 0, bag_size: 383
batch 79, loss: 0.8734, instance_loss: 0.4152, weighted_loss: 0.7359, label: 3, bag_size: 102
batch 99, loss: 0.9984, instance_loss: 0.5463, weighted_loss: 0.8627, label: 4, bag_size: 744
batch 119, loss: 0.5945, instance_loss: 0.4479, weighted_loss: 0.5505, label: 4, bag_size: 418
batch 139, loss: 0.7128, instance_loss: 0.4159, weighted_loss: 0.6237, label: 4, bag_size: 1031
batch 159, loss: 1.8171, instance_loss: 0.5144, weighted_loss: 1.4263, label: 4, bag_size: 176
batch 179, loss: 3.5659, instance_loss: 0.6579, weighted_loss: 2.6935, label: 0, bag_size: 964
batch 199, loss: 0.0174, instance_loss: 0.3551, weighted_loss: 0.1187, label: 0, bag_size: 218
batch 219, loss: 1.6966, instance_loss: 0.5447, weighted_loss: 1.3510, label: 3, bag_size: 1022
batch 239, loss: 0.3050, instance_loss: 0.5892, weighted_loss: 0.3903, label: 4, bag_size: 854
batch 259, loss: 2.7577, instance_loss: 0.8815, weighted_loss: 2.1948, label: 2, bag_size: 219
batch 279, loss: 0.6523, instance_loss: 0.4134, weighted_loss: 0.5806, label: 0, bag_size: 277
batch 299, loss: 1.2496, instance_loss: 0.5018, weighted_loss: 1.0252, label: 1, bag_size: 874
batch 319, loss: 0.7070, instance_loss: 0.5395, weighted_loss: 0.6568, label: 1, bag_size: 1497
batch 339, loss: 0.4521, instance_loss: 0.3726, weighted_loss: 0.4282, label: 0, bag_size: 269
batch 359, loss: 2.1403, instance_loss: 0.6962, weighted_loss: 1.7071, label: 3, bag_size: 337
batch 379, loss: 0.7678, instance_loss: 0.4659, weighted_loss: 0.6773, label: 2, bag_size: 290
batch 399, loss: 0.8981, instance_loss: 0.3926, weighted_loss: 0.7465, label: 4, bag_size: 746
batch 419, loss: 0.6047, instance_loss: 0.4819, weighted_loss: 0.5678, label: 0, bag_size: 62
batch 439, loss: 2.4410, instance_loss: 0.5705, weighted_loss: 1.8798, label: 3, bag_size: 390
batch 459, loss: 1.9103, instance_loss: 0.6407, weighted_loss: 1.5294, label: 3, bag_size: 500
batch 479, loss: 1.6219, instance_loss: 0.5192, weighted_loss: 1.2911, label: 2, bag_size: 1074
batch 499, loss: 1.2766, instance_loss: 0.5094, weighted_loss: 1.0465, label: 4, bag_size: 263
batch 519, loss: 0.0616, instance_loss: 0.1986, weighted_loss: 0.1027, label: 0, bag_size: 453
batch 539, loss: 1.4969, instance_loss: 0.4427, weighted_loss: 1.1806, label: 1, bag_size: 1019
batch 559, loss: 1.4880, instance_loss: 0.5555, weighted_loss: 1.2082, label: 2, bag_size: 860
batch 579, loss: 0.7307, instance_loss: 0.4712, weighted_loss: 0.6529, label: 3, bag_size: 274


class 0 clustering acc 0.9971801346801347: correct 23693/23760
class 1 clustering acc 0.04313973063973064: correct 205/4752
Epoch: 38, train_loss: 1.0833, train_clustering_loss:  0.4804, train_error: 0.4596
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.4132231404958678, correct 50/121
class 2: acc 0.32710280373831774, correct 35/107
class 3: acc 0.5254237288135594, correct 62/118
class 4: acc 0.5826771653543307, correct 74/127

Val Set, val_loss: 1.6260, val_error: 0.6216, auc: 0.7757
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.6224, instance_loss: 0.4283, weighted_loss: 0.5642, label: 1, bag_size: 593
batch 39, loss: 1.0460, instance_loss: 0.5093, weighted_loss: 0.8850, label: 4, bag_size: 574
batch 59, loss: 1.2799, instance_loss: 0.4669, weighted_loss: 1.0360, label: 3, bag_size: 556
batch 79, loss: 0.0000, instance_loss: 0.1217, weighted_loss: 0.0365, label: 0, bag_size: 175
batch 99, loss: 0.9609, instance_loss: 0.4531, weighted_loss: 0.8086, label: 3, bag_size: 309
batch 119, loss: 1.7398, instance_loss: 0.4826, weighted_loss: 1.3627, label: 2, bag_size: 606
batch 139, loss: 2.3905, instance_loss: 0.6183, weighted_loss: 1.8588, label: 2, bag_size: 1060
batch 159, loss: 0.8785, instance_loss: 0.4263, weighted_loss: 0.7429, label: 4, bag_size: 318
batch 179, loss: 0.8715, instance_loss: 0.4590, weighted_loss: 0.7478, label: 4, bag_size: 895
batch 199, loss: 0.4582, instance_loss: 0.4460, weighted_loss: 0.4545, label: 3, bag_size: 301
batch 219, loss: 0.8504, instance_loss: 0.4804, weighted_loss: 0.7394, label: 4, bag_size: 744
batch 239, loss: 0.1189, instance_loss: 0.3517, weighted_loss: 0.1887, label: 0, bag_size: 33
batch 259, loss: 0.6001, instance_loss: 0.4264, weighted_loss: 0.5480, label: 3, bag_size: 272
batch 279, loss: 1.4019, instance_loss: 0.6641, weighted_loss: 1.1806, label: 2, bag_size: 96
batch 299, loss: 1.2386, instance_loss: 0.4910, weighted_loss: 1.0143, label: 1, bag_size: 419
batch 319, loss: 1.5902, instance_loss: 0.5082, weighted_loss: 1.2656, label: 0, bag_size: 243
batch 339, loss: 2.3597, instance_loss: 0.5778, weighted_loss: 1.8251, label: 0, bag_size: 1073
batch 359, loss: 0.4791, instance_loss: 0.5684, weighted_loss: 0.5059, label: 4, bag_size: 293
batch 379, loss: 0.4727, instance_loss: 0.4482, weighted_loss: 0.4654, label: 0, bag_size: 520
batch 399, loss: 1.7463, instance_loss: 0.5213, weighted_loss: 1.3788, label: 1, bag_size: 177
batch 419, loss: 1.3654, instance_loss: 0.5239, weighted_loss: 1.1130, label: 3, bag_size: 431
batch 439, loss: 1.8209, instance_loss: 0.5580, weighted_loss: 1.4420, label: 1, bag_size: 925
batch 459, loss: 1.3766, instance_loss: 0.4815, weighted_loss: 1.1081, label: 4, bag_size: 356
batch 479, loss: 1.9711, instance_loss: 0.6222, weighted_loss: 1.5664, label: 1, bag_size: 564
batch 499, loss: 0.7246, instance_loss: 0.4156, weighted_loss: 0.6319, label: 2, bag_size: 549
batch 519, loss: 0.3501, instance_loss: 0.4518, weighted_loss: 0.3806, label: 0, bag_size: 183
batch 539, loss: 1.6408, instance_loss: 0.6435, weighted_loss: 1.3416, label: 2, bag_size: 128
batch 559, loss: 1.1481, instance_loss: 0.4891, weighted_loss: 0.9504, label: 3, bag_size: 500
batch 579, loss: 1.4576, instance_loss: 0.4840, weighted_loss: 1.1655, label: 1, bag_size: 408


class 0 clustering acc 0.9955808080808081: correct 23655/23760
class 1 clustering acc 0.04776936026936027: correct 227/4752
Epoch: 39, train_loss: 1.0821, train_clustering_loss:  0.4810, train_error: 0.4865
class 0: acc 0.8174603174603174, correct 103/126
class 1: acc 0.3474576271186441, correct 41/118
class 2: acc 0.34108527131782945, correct 44/129
class 3: acc 0.6016260162601627, correct 74/123
class 4: acc 0.4387755102040816, correct 43/98

Val Set, val_loss: 1.6428, val_error: 0.5811, auc: 0.8000
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.09966216216216216: correct 59/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0032, instance_loss: 0.1510, weighted_loss: 0.0475, label: 0, bag_size: 221
batch 39, loss: 1.6796, instance_loss: 0.7347, weighted_loss: 1.3961, label: 2, bag_size: 208
batch 59, loss: 0.8312, instance_loss: 0.4804, weighted_loss: 0.7260, label: 3, bag_size: 510
batch 79, loss: 1.8133, instance_loss: 0.5695, weighted_loss: 1.4402, label: 2, bag_size: 297
batch 99, loss: 0.6614, instance_loss: 0.4146, weighted_loss: 0.5874, label: 2, bag_size: 371
batch 119, loss: 0.8861, instance_loss: 0.5058, weighted_loss: 0.7720, label: 1, bag_size: 1104
batch 139, loss: 1.0095, instance_loss: 0.4829, weighted_loss: 0.8515, label: 2, bag_size: 337
batch 159, loss: 0.7676, instance_loss: 0.4612, weighted_loss: 0.6757, label: 4, bag_size: 520
batch 179, loss: 0.0572, instance_loss: 0.2490, weighted_loss: 0.1147, label: 0, bag_size: 383
batch 199, loss: 0.7106, instance_loss: 0.4345, weighted_loss: 0.6278, label: 2, bag_size: 290
batch 219, loss: 2.6893, instance_loss: 0.7295, weighted_loss: 2.1014, label: 3, bag_size: 156
batch 239, loss: 1.0524, instance_loss: 0.4941, weighted_loss: 0.8849, label: 2, bag_size: 781
batch 259, loss: 1.5438, instance_loss: 0.5318, weighted_loss: 1.2402, label: 3, bag_size: 120
batch 279, loss: 0.1378, instance_loss: 0.3535, weighted_loss: 0.2025, label: 0, bag_size: 355
batch 299, loss: 0.8699, instance_loss: 0.3979, weighted_loss: 0.7283, label: 3, bag_size: 663
batch 319, loss: 0.6270, instance_loss: 0.5710, weighted_loss: 0.6102, label: 1, bag_size: 106
batch 339, loss: 0.6928, instance_loss: 0.4287, weighted_loss: 0.6136, label: 4, bag_size: 438
batch 359, loss: 1.1048, instance_loss: 0.4581, weighted_loss: 0.9108, label: 3, bag_size: 1022
batch 379, loss: 1.7411, instance_loss: 0.6647, weighted_loss: 1.4182, label: 1, bag_size: 339
batch 399, loss: 0.5613, instance_loss: 0.5832, weighted_loss: 0.5679, label: 2, bag_size: 864
batch 419, loss: 0.7707, instance_loss: 0.5103, weighted_loss: 0.6926, label: 2, bag_size: 380
batch 439, loss: 0.9493, instance_loss: 0.5307, weighted_loss: 0.8237, label: 4, bag_size: 690
batch 459, loss: 2.1000, instance_loss: 0.6044, weighted_loss: 1.6513, label: 3, bag_size: 1057
batch 479, loss: 1.8768, instance_loss: 0.6428, weighted_loss: 1.5066, label: 2, bag_size: 488
batch 499, loss: 1.0453, instance_loss: 0.4753, weighted_loss: 0.8743, label: 4, bag_size: 853
batch 519, loss: 1.2734, instance_loss: 0.5020, weighted_loss: 1.0420, label: 4, bag_size: 868
batch 539, loss: 0.5446, instance_loss: 0.6467, weighted_loss: 0.5753, label: 0, bag_size: 317
batch 559, loss: 1.0181, instance_loss: 0.4914, weighted_loss: 0.8601, label: 2, bag_size: 375
batch 579, loss: 0.0876, instance_loss: 0.1878, weighted_loss: 0.1177, label: 0, bag_size: 428


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.06186868686868687: correct 294/4752
Epoch: 40, train_loss: 1.0390, train_clustering_loss:  0.4740, train_error: 0.4495
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.42452830188679247, correct 45/106
class 2: acc 0.4435483870967742, correct 55/124
class 3: acc 0.552, correct 69/125
class 4: acc 0.5132743362831859, correct 58/113

Val Set, val_loss: 1.7155, val_error: 0.5946, auc: 0.7551
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.5763, instance_loss: 0.4017, weighted_loss: 0.5239, label: 2, bag_size: 410
batch 39, loss: 0.3318, instance_loss: 0.5091, weighted_loss: 0.3850, label: 0, bag_size: 587
batch 59, loss: 2.4869, instance_loss: 0.6408, weighted_loss: 1.9330, label: 4, bag_size: 757
batch 79, loss: 0.8019, instance_loss: 0.3997, weighted_loss: 0.6812, label: 2, bag_size: 392
batch 99, loss: 0.0000, instance_loss: 0.0699, weighted_loss: 0.0210, label: 4, bag_size: 813
batch 119, loss: 1.4041, instance_loss: 0.5283, weighted_loss: 1.1413, label: 0, bag_size: 367
batch 139, loss: 1.1212, instance_loss: 0.5175, weighted_loss: 0.9401, label: 1, bag_size: 695
batch 159, loss: 0.0457, instance_loss: 0.2782, weighted_loss: 0.1155, label: 0, bag_size: 295
batch 179, loss: 0.0466, instance_loss: 0.2025, weighted_loss: 0.0933, label: 0, bag_size: 98
batch 199, loss: 0.4945, instance_loss: 0.4143, weighted_loss: 0.4705, label: 2, bag_size: 607
batch 219, loss: 1.1263, instance_loss: 0.5264, weighted_loss: 0.9463, label: 1, bag_size: 742
batch 239, loss: 0.5267, instance_loss: 0.4352, weighted_loss: 0.4993, label: 1, bag_size: 1104
batch 259, loss: 1.4363, instance_loss: 0.4846, weighted_loss: 1.1508, label: 1, bag_size: 1082
batch 279, loss: 1.3557, instance_loss: 0.4700, weighted_loss: 1.0900, label: 1, bag_size: 823
batch 299, loss: 2.4195, instance_loss: 0.7996, weighted_loss: 1.9335, label: 2, bag_size: 219
batch 319, loss: 1.0064, instance_loss: 0.4857, weighted_loss: 0.8502, label: 2, bag_size: 390
batch 339, loss: 0.9877, instance_loss: 0.5296, weighted_loss: 0.8503, label: 0, bag_size: 283
batch 359, loss: 0.4867, instance_loss: 0.4655, weighted_loss: 0.4804, label: 3, bag_size: 369
batch 379, loss: 0.2001, instance_loss: 0.4273, weighted_loss: 0.2683, label: 2, bag_size: 864
batch 399, loss: 0.8821, instance_loss: 0.4320, weighted_loss: 0.7471, label: 2, bag_size: 837
batch 419, loss: 1.1028, instance_loss: 0.4800, weighted_loss: 0.9160, label: 4, bag_size: 730
batch 439, loss: 0.4009, instance_loss: 0.5777, weighted_loss: 0.4539, label: 0, bag_size: 283
batch 459, loss: 0.3948, instance_loss: 0.4322, weighted_loss: 0.4060, label: 0, bag_size: 231
batch 479, loss: 0.7964, instance_loss: 0.4748, weighted_loss: 0.6999, label: 3, bag_size: 102
batch 499, loss: 1.6406, instance_loss: 0.8430, weighted_loss: 1.4013, label: 1, bag_size: 153
batch 519, loss: 1.2179, instance_loss: 0.4804, weighted_loss: 0.9967, label: 4, bag_size: 1104
batch 539, loss: 0.9905, instance_loss: 0.4001, weighted_loss: 0.8134, label: 4, bag_size: 263
batch 559, loss: 0.7422, instance_loss: 0.4154, weighted_loss: 0.6442, label: 4, bag_size: 238
batch 579, loss: 0.9501, instance_loss: 0.4885, weighted_loss: 0.8117, label: 1, bag_size: 1273


class 0 clustering acc 0.9967592592592592: correct 23683/23760
class 1 clustering acc 0.05765993265993266: correct 274/4752
Epoch: 41, train_loss: 1.0678, train_clustering_loss:  0.4766, train_error: 0.4848
class 0: acc 0.8017241379310345, correct 93/116
class 1: acc 0.3050847457627119, correct 36/118
class 2: acc 0.4609375, correct 59/128
class 3: acc 0.43243243243243246, correct 48/111
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.6277, val_error: 0.5676, auc: 0.7941
class 0 clustering acc 0.9966216216216216: correct 2950/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2364, instance_loss: 0.4000, weighted_loss: 0.2855, label: 0, bag_size: 493
batch 39, loss: 0.6230, instance_loss: 0.4100, weighted_loss: 0.5591, label: 3, bag_size: 309
batch 59, loss: 0.7961, instance_loss: 0.4077, weighted_loss: 0.6796, label: 3, bag_size: 781
batch 79, loss: 1.2823, instance_loss: 0.4264, weighted_loss: 1.0255, label: 2, bag_size: 404
batch 99, loss: 0.6429, instance_loss: 0.5640, weighted_loss: 0.6192, label: 1, bag_size: 1103
batch 119, loss: 0.3096, instance_loss: 0.4397, weighted_loss: 0.3486, label: 4, bag_size: 923
batch 139, loss: 0.1015, instance_loss: 0.3824, weighted_loss: 0.1858, label: 0, bag_size: 238
batch 159, loss: 0.7423, instance_loss: 0.5389, weighted_loss: 0.6813, label: 4, bag_size: 490
batch 179, loss: 1.7127, instance_loss: 0.5099, weighted_loss: 1.3519, label: 2, bag_size: 713
batch 199, loss: 0.3985, instance_loss: 0.2196, weighted_loss: 0.3448, label: 0, bag_size: 192
batch 219, loss: 0.6074, instance_loss: 0.5395, weighted_loss: 0.5870, label: 2, bag_size: 128
batch 239, loss: 1.1124, instance_loss: 0.5012, weighted_loss: 0.9290, label: 0, bag_size: 277
batch 259, loss: 1.3073, instance_loss: 0.5410, weighted_loss: 1.0774, label: 1, bag_size: 906
batch 279, loss: 0.7732, instance_loss: 0.4715, weighted_loss: 0.6827, label: 4, bag_size: 895
batch 299, loss: 0.0018, instance_loss: 0.2937, weighted_loss: 0.0894, label: 2, bag_size: 1975
batch 319, loss: 0.5976, instance_loss: 0.4035, weighted_loss: 0.5394, label: 4, bag_size: 1031
batch 339, loss: 1.5209, instance_loss: 0.5779, weighted_loss: 1.2380, label: 4, bag_size: 342
batch 359, loss: 1.9681, instance_loss: 0.6141, weighted_loss: 1.5619, label: 3, bag_size: 337
batch 379, loss: 0.8442, instance_loss: 0.4215, weighted_loss: 0.7174, label: 3, bag_size: 830
batch 399, loss: 0.8115, instance_loss: 0.4752, weighted_loss: 0.7106, label: 4, bag_size: 446
batch 419, loss: 1.1984, instance_loss: 0.6110, weighted_loss: 1.0222, label: 0, bag_size: 581
batch 439, loss: 1.0815, instance_loss: 0.5171, weighted_loss: 0.9122, label: 4, bag_size: 730
batch 459, loss: 1.2793, instance_loss: 0.6315, weighted_loss: 1.0850, label: 3, bag_size: 897
batch 479, loss: 0.6677, instance_loss: 0.3976, weighted_loss: 0.5867, label: 2, bag_size: 886
batch 499, loss: 2.0587, instance_loss: 0.5319, weighted_loss: 1.6006, label: 1, bag_size: 988
batch 519, loss: 1.0388, instance_loss: 0.6493, weighted_loss: 0.9220, label: 0, bag_size: 367
batch 539, loss: 2.2106, instance_loss: 0.6194, weighted_loss: 1.7332, label: 1, bag_size: 397
batch 559, loss: 1.9946, instance_loss: 0.5790, weighted_loss: 1.5700, label: 1, bag_size: 564
batch 579, loss: 1.2160, instance_loss: 0.5878, weighted_loss: 1.0275, label: 4, bag_size: 267


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.034722222222222224: correct 165/4752
Epoch: 42, train_loss: 0.9994, train_clustering_loss:  0.4735, train_error: 0.4327
class 0: acc 0.8333333333333334, correct 95/114
class 1: acc 0.4, correct 40/100
class 2: acc 0.46853146853146854, correct 67/143
class 3: acc 0.5, correct 56/112
class 4: acc 0.632, correct 79/125

Val Set, val_loss: 1.6805, val_error: 0.6216, auc: 0.7531
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0048, instance_loss: 0.2917, weighted_loss: 0.0909, label: 0, bag_size: 221
batch 39, loss: 1.4200, instance_loss: 0.4817, weighted_loss: 1.1385, label: 2, bag_size: 744
batch 59, loss: 2.6891, instance_loss: 0.6729, weighted_loss: 2.0842, label: 0, bag_size: 1073
batch 79, loss: 0.8753, instance_loss: 0.5311, weighted_loss: 0.7720, label: 4, bag_size: 853
batch 99, loss: 1.0140, instance_loss: 0.5175, weighted_loss: 0.8650, label: 1, bag_size: 766
batch 119, loss: 1.7814, instance_loss: 0.6715, weighted_loss: 1.4484, label: 2, bag_size: 208
batch 139, loss: 0.3899, instance_loss: 0.3672, weighted_loss: 0.3831, label: 0, bag_size: 578
batch 159, loss: 0.0000, instance_loss: 0.2482, weighted_loss: 0.0745, label: 4, bag_size: 813
batch 179, loss: 1.3327, instance_loss: 0.4773, weighted_loss: 1.0761, label: 1, bag_size: 500
batch 199, loss: 0.1677, instance_loss: 0.4877, weighted_loss: 0.2637, label: 0, bag_size: 317
batch 219, loss: 0.0712, instance_loss: 0.4179, weighted_loss: 0.1752, label: 0, bag_size: 552
batch 239, loss: 2.0870, instance_loss: 0.5536, weighted_loss: 1.6269, label: 2, bag_size: 1060
batch 259, loss: 0.8523, instance_loss: 0.4327, weighted_loss: 0.7265, label: 3, bag_size: 192
batch 279, loss: 0.0069, instance_loss: 0.2193, weighted_loss: 0.0706, label: 0, bag_size: 80
batch 299, loss: 1.1582, instance_loss: 0.5012, weighted_loss: 0.9611, label: 3, bag_size: 817
batch 319, loss: 0.1026, instance_loss: 0.3236, weighted_loss: 0.1689, label: 0, bag_size: 573
batch 339, loss: 2.0695, instance_loss: 0.5738, weighted_loss: 1.6208, label: 4, bag_size: 310
batch 359, loss: 3.0870, instance_loss: 0.6103, weighted_loss: 2.3439, label: 3, bag_size: 856
batch 379, loss: 0.7793, instance_loss: 0.4287, weighted_loss: 0.6741, label: 2, bag_size: 821
batch 399, loss: 0.1304, instance_loss: 0.2803, weighted_loss: 0.1754, label: 0, bag_size: 488
batch 419, loss: 0.7069, instance_loss: 0.5298, weighted_loss: 0.6538, label: 3, bag_size: 274
batch 439, loss: 2.7896, instance_loss: 0.6026, weighted_loss: 2.1335, label: 1, bag_size: 875
batch 459, loss: 0.3717, instance_loss: 0.2749, weighted_loss: 0.3427, label: 0, bag_size: 513
batch 479, loss: 0.0000, instance_loss: 0.4154, weighted_loss: 0.1246, label: 2, bag_size: 553
batch 499, loss: 0.8150, instance_loss: 0.4700, weighted_loss: 0.7115, label: 0, bag_size: 238
batch 519, loss: 0.8075, instance_loss: 0.4109, weighted_loss: 0.6885, label: 1, bag_size: 605
batch 539, loss: 0.0000, instance_loss: 0.4380, weighted_loss: 0.1314, label: 2, bag_size: 953
batch 559, loss: 2.4966, instance_loss: 0.5211, weighted_loss: 1.9040, label: 2, bag_size: 606
batch 579, loss: 1.6520, instance_loss: 0.6143, weighted_loss: 1.3407, label: 4, bag_size: 395


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.043560606060606064: correct 207/4752
Epoch: 43, train_loss: 1.1003, train_clustering_loss:  0.4803, train_error: 0.4882
class 0: acc 0.7543859649122807, correct 86/114
class 1: acc 0.4857142857142857, correct 68/140
class 2: acc 0.2809917355371901, correct 34/121
class 3: acc 0.48598130841121495, correct 52/107
class 4: acc 0.5714285714285714, correct 64/112

Val Set, val_loss: 1.6866, val_error: 0.5405, auc: 0.7737
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0491, instance_loss: 0.2765, weighted_loss: 0.1173, label: 0, bag_size: 74
batch 39, loss: 1.4691, instance_loss: 0.5140, weighted_loss: 1.1826, label: 1, bag_size: 742
batch 59, loss: 1.1673, instance_loss: 0.4170, weighted_loss: 0.9422, label: 2, bag_size: 934
batch 79, loss: 0.2963, instance_loss: 0.4489, weighted_loss: 0.3421, label: 4, bag_size: 53
batch 99, loss: 0.0596, instance_loss: 0.1956, weighted_loss: 0.1004, label: 0, bag_size: 306
batch 119, loss: 0.9387, instance_loss: 0.4803, weighted_loss: 0.8011, label: 3, bag_size: 1078
batch 139, loss: 0.0215, instance_loss: 0.1823, weighted_loss: 0.0697, label: 0, bag_size: 133
batch 159, loss: 2.3052, instance_loss: 0.4694, weighted_loss: 1.7544, label: 1, bag_size: 840
batch 179, loss: 0.9123, instance_loss: 0.6746, weighted_loss: 0.8410, label: 3, bag_size: 795
batch 199, loss: 1.4292, instance_loss: 0.4977, weighted_loss: 1.1498, label: 1, bag_size: 1121
batch 219, loss: 0.7654, instance_loss: 0.4384, weighted_loss: 0.6673, label: 3, bag_size: 473
batch 239, loss: 0.8308, instance_loss: 0.4922, weighted_loss: 0.7292, label: 3, bag_size: 245
batch 259, loss: 0.9265, instance_loss: 0.5776, weighted_loss: 0.8218, label: 4, bag_size: 356
batch 279, loss: 0.8258, instance_loss: 0.4492, weighted_loss: 0.7128, label: 4, bag_size: 639
batch 299, loss: 0.5308, instance_loss: 0.5106, weighted_loss: 0.5247, label: 4, bag_size: 683
batch 319, loss: 0.7902, instance_loss: 0.4200, weighted_loss: 0.6792, label: 0, bag_size: 478
batch 339, loss: 0.1672, instance_loss: 0.2685, weighted_loss: 0.1976, label: 0, bag_size: 59
batch 359, loss: 0.3569, instance_loss: 0.4704, weighted_loss: 0.3909, label: 1, bag_size: 141
batch 379, loss: 0.0000, instance_loss: 0.5607, weighted_loss: 0.1682, label: 4, bag_size: 359
batch 399, loss: 1.0325, instance_loss: 0.4334, weighted_loss: 0.8528, label: 1, bag_size: 660
batch 419, loss: 0.4417, instance_loss: 0.4390, weighted_loss: 0.4409, label: 4, bag_size: 923
batch 439, loss: 0.8593, instance_loss: 0.4179, weighted_loss: 0.7269, label: 3, bag_size: 1078
batch 459, loss: 0.5561, instance_loss: 0.2681, weighted_loss: 0.4697, label: 0, bag_size: 282
batch 479, loss: 1.0660, instance_loss: 0.4535, weighted_loss: 0.8822, label: 2, bag_size: 844
batch 499, loss: 2.5447, instance_loss: 0.4289, weighted_loss: 1.9099, label: 3, bag_size: 795
batch 519, loss: 1.1170, instance_loss: 0.4579, weighted_loss: 0.9192, label: 1, bag_size: 634
batch 539, loss: 0.3383, instance_loss: 0.4925, weighted_loss: 0.3845, label: 4, bag_size: 446
batch 559, loss: 0.0132, instance_loss: 0.2838, weighted_loss: 0.0944, label: 0, bag_size: 218
batch 579, loss: 1.3886, instance_loss: 0.5878, weighted_loss: 1.1484, label: 2, bag_size: 258


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.06376262626262626: correct 303/4752
Epoch: 44, train_loss: 1.0589, train_clustering_loss:  0.4704, train_error: 0.4747
class 0: acc 0.7536231884057971, correct 104/138
class 1: acc 0.5588235294117647, correct 76/136
class 2: acc 0.17647058823529413, correct 18/102
class 3: acc 0.47619047619047616, correct 50/105
class 4: acc 0.5663716814159292, correct 64/113

Val Set, val_loss: 1.7275, val_error: 0.5270, auc: 0.7855
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.8070, instance_loss: 0.4767, weighted_loss: 0.7079, label: 1, bag_size: 634
batch 39, loss: 1.8509, instance_loss: 0.4972, weighted_loss: 1.4448, label: 4, bag_size: 695
batch 59, loss: 1.0380, instance_loss: 0.4935, weighted_loss: 0.8747, label: 3, bag_size: 432
batch 79, loss: 0.4698, instance_loss: 0.4033, weighted_loss: 0.4499, label: 0, bag_size: 231
batch 99, loss: 0.6366, instance_loss: 0.5147, weighted_loss: 0.6000, label: 3, bag_size: 1060
batch 119, loss: 1.4304, instance_loss: 0.5779, weighted_loss: 1.1746, label: 1, bag_size: 874
batch 139, loss: 0.7007, instance_loss: 0.3892, weighted_loss: 0.6072, label: 4, bag_size: 604
batch 159, loss: 2.1345, instance_loss: 0.5523, weighted_loss: 1.6598, label: 1, bag_size: 875
batch 179, loss: 1.8171, instance_loss: 0.4508, weighted_loss: 1.4072, label: 4, bag_size: 1104
batch 199, loss: 1.8720, instance_loss: 0.5448, weighted_loss: 1.4739, label: 2, bag_size: 554
batch 219, loss: 0.0346, instance_loss: 0.1899, weighted_loss: 0.0812, label: 0, bag_size: 355
batch 239, loss: 0.5412, instance_loss: 0.4282, weighted_loss: 0.5073, label: 0, bag_size: 183
batch 259, loss: 1.2351, instance_loss: 0.4432, weighted_loss: 0.9975, label: 1, bag_size: 1103
batch 279, loss: 0.7445, instance_loss: 0.4091, weighted_loss: 0.6439, label: 2, bag_size: 941
batch 299, loss: 0.0472, instance_loss: 0.3605, weighted_loss: 0.1412, label: 4, bag_size: 854
batch 319, loss: 1.2658, instance_loss: 0.4789, weighted_loss: 1.0297, label: 2, bag_size: 321
batch 339, loss: 1.3297, instance_loss: 0.5377, weighted_loss: 1.0921, label: 4, bag_size: 356
batch 359, loss: 1.5625, instance_loss: 0.4922, weighted_loss: 1.2414, label: 1, bag_size: 1019
batch 379, loss: 0.7048, instance_loss: 0.5344, weighted_loss: 0.6537, label: 4, bag_size: 683
batch 399, loss: 2.3497, instance_loss: 0.6284, weighted_loss: 1.8333, label: 2, bag_size: 128
batch 419, loss: 1.2131, instance_loss: 0.4922, weighted_loss: 0.9968, label: 1, bag_size: 221
batch 439, loss: 1.4302, instance_loss: 0.5787, weighted_loss: 1.1748, label: 4, bag_size: 476
batch 459, loss: 0.8640, instance_loss: 0.3697, weighted_loss: 0.7158, label: 0, bag_size: 62
batch 479, loss: 1.0717, instance_loss: 0.5347, weighted_loss: 0.9106, label: 1, bag_size: 1082
batch 499, loss: 0.0844, instance_loss: 0.1384, weighted_loss: 0.1006, label: 0, bag_size: 212
batch 519, loss: 0.8707, instance_loss: 0.5329, weighted_loss: 0.7693, label: 0, bag_size: 587
batch 539, loss: 0.8418, instance_loss: 0.5764, weighted_loss: 0.7622, label: 4, bag_size: 776
batch 559, loss: 1.6482, instance_loss: 0.4631, weighted_loss: 1.2927, label: 2, bag_size: 331
batch 579, loss: 0.7192, instance_loss: 0.4700, weighted_loss: 0.6444, label: 2, bag_size: 240


class 0 clustering acc 0.9966750841750842: correct 23681/23760
class 1 clustering acc 0.07344276094276095: correct 349/4752
Epoch: 45, train_loss: 1.0527, train_clustering_loss:  0.4677, train_error: 0.4983
class 0: acc 0.8153846153846154, correct 106/130
class 1: acc 0.26851851851851855, correct 29/108
class 2: acc 0.4296875, correct 55/128
class 3: acc 0.43859649122807015, correct 50/114
class 4: acc 0.5087719298245614, correct 58/114

Val Set, val_loss: 1.5712, val_error: 0.6351, auc: 0.7713
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.9632, instance_loss: 0.5096, weighted_loss: 0.8271, label: 3, bag_size: 603
batch 39, loss: 1.5470, instance_loss: 0.6017, weighted_loss: 1.2634, label: 3, bag_size: 1365
batch 59, loss: 1.4134, instance_loss: 0.5313, weighted_loss: 1.1487, label: 1, bag_size: 1104
batch 79, loss: 0.7645, instance_loss: 0.4708, weighted_loss: 0.6764, label: 0, bag_size: 277
batch 99, loss: 2.2493, instance_loss: 0.5116, weighted_loss: 1.7280, label: 2, bag_size: 713
batch 119, loss: 0.8120, instance_loss: 0.4432, weighted_loss: 0.7014, label: 1, bag_size: 851
batch 139, loss: 0.3656, instance_loss: 0.5636, weighted_loss: 0.4250, label: 0, bag_size: 1085
batch 159, loss: 1.5001, instance_loss: 0.6026, weighted_loss: 1.2309, label: 0, bag_size: 178
batch 179, loss: 2.4019, instance_loss: 0.6625, weighted_loss: 1.8800, label: 0, bag_size: 178
batch 199, loss: 0.4885, instance_loss: 0.3732, weighted_loss: 0.4539, label: 4, bag_size: 520
batch 219, loss: 0.0864, instance_loss: 0.5681, weighted_loss: 0.2309, label: 1, bag_size: 748
batch 239, loss: 0.3975, instance_loss: 0.4933, weighted_loss: 0.4263, label: 4, bag_size: 160
batch 259, loss: 0.4314, instance_loss: 0.4414, weighted_loss: 0.4344, label: 4, bag_size: 960
batch 279, loss: 0.8110, instance_loss: 0.4487, weighted_loss: 0.7023, label: 2, bag_size: 799
batch 299, loss: 0.0007, instance_loss: 0.4098, weighted_loss: 0.1234, label: 2, bag_size: 553
batch 319, loss: 0.0000, instance_loss: 0.4396, weighted_loss: 0.1319, label: 2, bag_size: 553
batch 339, loss: 0.5396, instance_loss: 0.5568, weighted_loss: 0.5448, label: 2, bag_size: 864
batch 359, loss: 0.0000, instance_loss: 0.5090, weighted_loss: 0.1527, label: 2, bag_size: 953
batch 379, loss: 0.9071, instance_loss: 0.4492, weighted_loss: 0.7697, label: 3, bag_size: 781
batch 399, loss: 1.7222, instance_loss: 0.5527, weighted_loss: 1.3714, label: 1, bag_size: 981
batch 419, loss: 1.2225, instance_loss: 0.4830, weighted_loss: 1.0006, label: 3, bag_size: 1358
batch 439, loss: 1.2423, instance_loss: 0.5042, weighted_loss: 1.0209, label: 1, bag_size: 339
batch 459, loss: 0.9249, instance_loss: 0.4326, weighted_loss: 0.7772, label: 1, bag_size: 500
batch 479, loss: 3.3103, instance_loss: 0.6551, weighted_loss: 2.5138, label: 0, bag_size: 710
batch 499, loss: 1.9485, instance_loss: 0.6187, weighted_loss: 1.5496, label: 2, bag_size: 105
batch 519, loss: 1.0548, instance_loss: 0.4067, weighted_loss: 0.8604, label: 1, bag_size: 1043
batch 539, loss: 2.1382, instance_loss: 0.5353, weighted_loss: 1.6574, label: 2, bag_size: 713
batch 559, loss: 1.6982, instance_loss: 0.5256, weighted_loss: 1.3464, label: 3, bag_size: 120
batch 579, loss: 1.3971, instance_loss: 0.5638, weighted_loss: 1.1471, label: 0, bag_size: 247


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.06060606060606061: correct 288/4752
Epoch: 46, train_loss: 1.0359, train_clustering_loss:  0.4784, train_error: 0.4714
class 0: acc 0.8275862068965517, correct 96/116
class 1: acc 0.4358974358974359, correct 51/117
class 2: acc 0.36153846153846153, correct 47/130
class 3: acc 0.38181818181818183, correct 42/110
class 4: acc 0.6446280991735537, correct 78/121

Val Set, val_loss: 1.5713, val_error: 0.4730, auc: 0.7919
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 46 out of 20


batch 19, loss: 0.8620, instance_loss: 0.5152, weighted_loss: 0.7579, label: 1, bag_size: 221
batch 39, loss: 0.9843, instance_loss: 0.4859, weighted_loss: 0.8348, label: 2, bag_size: 883
batch 59, loss: 0.6716, instance_loss: 0.4858, weighted_loss: 0.6159, label: 3, bag_size: 982
batch 79, loss: 1.4472, instance_loss: 0.5408, weighted_loss: 1.1752, label: 4, bag_size: 363
batch 99, loss: 0.5981, instance_loss: 0.4080, weighted_loss: 0.5411, label: 0, bag_size: 642
batch 119, loss: 1.2708, instance_loss: 0.5746, weighted_loss: 1.0620, label: 2, bag_size: 315
batch 139, loss: 0.9597, instance_loss: 0.4671, weighted_loss: 0.8119, label: 2, bag_size: 171
batch 159, loss: 0.9373, instance_loss: 0.4533, weighted_loss: 0.7921, label: 3, bag_size: 309
batch 179, loss: 1.1620, instance_loss: 0.4812, weighted_loss: 0.9578, label: 2, bag_size: 627
batch 199, loss: 1.5970, instance_loss: 0.5686, weighted_loss: 1.2885, label: 2, bag_size: 1197
batch 219, loss: 1.4194, instance_loss: 0.4655, weighted_loss: 1.1332, label: 4, bag_size: 868
batch 239, loss: 0.6257, instance_loss: 0.4636, weighted_loss: 0.5771, label: 3, bag_size: 235
batch 259, loss: 0.9053, instance_loss: 0.5660, weighted_loss: 0.8035, label: 2, bag_size: 702
batch 279, loss: 0.9197, instance_loss: 0.5018, weighted_loss: 0.7944, label: 3, bag_size: 312
batch 299, loss: 0.0393, instance_loss: 0.4628, weighted_loss: 0.1664, label: 4, bag_size: 746
batch 319, loss: 1.0521, instance_loss: 0.4558, weighted_loss: 0.8732, label: 2, bag_size: 877
batch 339, loss: 0.9956, instance_loss: 0.4842, weighted_loss: 0.8421, label: 3, bag_size: 631
batch 359, loss: 0.5737, instance_loss: 0.4653, weighted_loss: 0.5412, label: 3, bag_size: 272
batch 379, loss: 1.3421, instance_loss: 0.5984, weighted_loss: 1.1190, label: 2, bag_size: 318
batch 399, loss: 1.2102, instance_loss: 0.4036, weighted_loss: 0.9682, label: 3, bag_size: 830
batch 419, loss: 0.2022, instance_loss: 0.2802, weighted_loss: 0.2256, label: 0, bag_size: 517
batch 439, loss: 1.0334, instance_loss: 0.5209, weighted_loss: 0.8797, label: 2, bag_size: 303
batch 459, loss: 0.3902, instance_loss: 0.2956, weighted_loss: 0.3618, label: 0, bag_size: 566
batch 479, loss: 0.7275, instance_loss: 0.3820, weighted_loss: 0.6239, label: 0, bag_size: 223
batch 499, loss: 0.0033, instance_loss: 0.1460, weighted_loss: 0.0461, label: 0, bag_size: 164
batch 519, loss: 0.6913, instance_loss: 0.4580, weighted_loss: 0.6213, label: 3, bag_size: 625
batch 539, loss: 1.1854, instance_loss: 0.3866, weighted_loss: 0.9458, label: 3, bag_size: 495
batch 559, loss: 0.0432, instance_loss: 0.3018, weighted_loss: 0.1208, label: 0, bag_size: 33
batch 579, loss: 1.0192, instance_loss: 0.4422, weighted_loss: 0.8461, label: 3, bag_size: 781


class 0 clustering acc 0.9961700336700336: correct 23669/23760
class 1 clustering acc 0.08186026936026936: correct 389/4752
Epoch: 47, train_loss: 0.9801, train_clustering_loss:  0.4629, train_error: 0.4024
class 0: acc 0.851063829787234, correct 120/141
class 1: acc 0.4827586206896552, correct 56/116
class 2: acc 0.3783783783783784, correct 42/111
class 3: acc 0.5967741935483871, correct 74/124
class 4: acc 0.6176470588235294, correct 63/102

Val Set, val_loss: 1.6614, val_error: 0.5676, auc: 0.7719
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.09121621621621621: correct 54/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 47 out of 20


batch 19, loss: 0.5321, instance_loss: 0.4443, weighted_loss: 0.5057, label: 1, bag_size: 311
batch 39, loss: 1.5045, instance_loss: 0.5266, weighted_loss: 1.2112, label: 1, bag_size: 764
batch 59, loss: 0.0010, instance_loss: 0.0537, weighted_loss: 0.0168, label: 0, bag_size: 533
batch 79, loss: 0.9559, instance_loss: 0.4926, weighted_loss: 0.8169, label: 3, bag_size: 457
batch 99, loss: 1.6032, instance_loss: 0.4961, weighted_loss: 1.2711, label: 3, bag_size: 899
batch 119, loss: 1.4464, instance_loss: 0.5322, weighted_loss: 1.1721, label: 2, bag_size: 549
batch 139, loss: 0.2339, instance_loss: 0.4849, weighted_loss: 0.3092, label: 1, bag_size: 748
batch 159, loss: 1.0410, instance_loss: 0.5513, weighted_loss: 0.8941, label: 4, bag_size: 329
batch 179, loss: 1.3641, instance_loss: 0.4992, weighted_loss: 1.1046, label: 2, bag_size: 754
batch 199, loss: 0.0053, instance_loss: 0.1891, weighted_loss: 0.0604, label: 0, bag_size: 340
batch 219, loss: 1.3456, instance_loss: 0.5209, weighted_loss: 1.0982, label: 3, bag_size: 500
batch 239, loss: 1.6762, instance_loss: 0.4944, weighted_loss: 1.3217, label: 1, bag_size: 408
batch 259, loss: 0.1523, instance_loss: 0.3526, weighted_loss: 0.2124, label: 0, bag_size: 357
batch 279, loss: 0.8784, instance_loss: 0.4542, weighted_loss: 0.7511, label: 1, bag_size: 481
batch 299, loss: 1.2578, instance_loss: 0.6128, weighted_loss: 1.0643, label: 2, bag_size: 404
batch 319, loss: 0.8774, instance_loss: 0.4882, weighted_loss: 0.7606, label: 3, bag_size: 566
batch 339, loss: 0.0136, instance_loss: 0.2599, weighted_loss: 0.0875, label: 0, bag_size: 221
batch 359, loss: 1.6729, instance_loss: 0.5860, weighted_loss: 1.3468, label: 3, bag_size: 897
batch 379, loss: 0.1316, instance_loss: 0.2194, weighted_loss: 0.1579, label: 0, bag_size: 188
batch 399, loss: 0.4640, instance_loss: 0.3523, weighted_loss: 0.4305, label: 0, bag_size: 269
batch 419, loss: 0.8152, instance_loss: 0.4625, weighted_loss: 0.7094, label: 2, bag_size: 348
batch 439, loss: 0.7403, instance_loss: 0.5106, weighted_loss: 0.6714, label: 4, bag_size: 685
batch 459, loss: 0.0084, instance_loss: 0.1472, weighted_loss: 0.0501, label: 0, bag_size: 280
batch 479, loss: 0.7270, instance_loss: 0.4129, weighted_loss: 0.6328, label: 1, bag_size: 906
batch 499, loss: 0.0078, instance_loss: 0.1305, weighted_loss: 0.0446, label: 0, bag_size: 133
batch 519, loss: 0.5734, instance_loss: 0.4560, weighted_loss: 0.5382, label: 0, bag_size: 343
batch 539, loss: 1.7756, instance_loss: 0.6170, weighted_loss: 1.4280, label: 2, bag_size: 860
batch 559, loss: 0.0009, instance_loss: 0.1069, weighted_loss: 0.0327, label: 0, bag_size: 230
batch 579, loss: 0.8112, instance_loss: 0.4921, weighted_loss: 0.7154, label: 2, bag_size: 684


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.09217171717171717: correct 438/4752
Epoch: 48, train_loss: 1.0137, train_clustering_loss:  0.4606, train_error: 0.4478
class 0: acc 0.8450704225352113, correct 120/142
class 1: acc 0.45689655172413796, correct 53/116
class 2: acc 0.28695652173913044, correct 33/115
class 3: acc 0.6260869565217392, correct 72/115
class 4: acc 0.4716981132075472, correct 50/106

Val Set, val_loss: 1.7589, val_error: 0.5676, auc: 0.7812
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.09797297297297297: correct 58/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 48 out of 20


batch 19, loss: 1.3628, instance_loss: 0.5038, weighted_loss: 1.1051, label: 1, bag_size: 855
batch 39, loss: 0.5278, instance_loss: 0.5589, weighted_loss: 0.5371, label: 1, bag_size: 371
batch 59, loss: 0.5390, instance_loss: 0.4609, weighted_loss: 0.5156, label: 2, bag_size: 549
batch 79, loss: 1.3502, instance_loss: 0.4651, weighted_loss: 1.0847, label: 2, bag_size: 861
batch 99, loss: 1.5833, instance_loss: 0.5363, weighted_loss: 1.2692, label: 4, bag_size: 438
batch 119, loss: 3.1338, instance_loss: 0.6074, weighted_loss: 2.3759, label: 4, bag_size: 407
batch 139, loss: 0.6229, instance_loss: 0.5133, weighted_loss: 0.5900, label: 1, bag_size: 1023
batch 159, loss: 1.0319, instance_loss: 0.4563, weighted_loss: 0.8592, label: 1, bag_size: 660
batch 179, loss: 0.2861, instance_loss: 0.4126, weighted_loss: 0.3241, label: 0, bag_size: 33
batch 199, loss: 0.9465, instance_loss: 0.4625, weighted_loss: 0.8013, label: 1, bag_size: 928
batch 219, loss: 1.9120, instance_loss: 0.5326, weighted_loss: 1.4982, label: 2, bag_size: 717
batch 239, loss: 1.2190, instance_loss: 0.4425, weighted_loss: 0.9861, label: 3, bag_size: 488
batch 259, loss: 2.3340, instance_loss: 0.6579, weighted_loss: 1.8311, label: 0, bag_size: 745
batch 279, loss: 0.0416, instance_loss: 0.4987, weighted_loss: 0.1788, label: 0, bag_size: 732
batch 299, loss: 0.0006, instance_loss: 0.1119, weighted_loss: 0.0340, label: 0, bag_size: 175
batch 319, loss: 1.2585, instance_loss: 0.4841, weighted_loss: 1.0262, label: 3, bag_size: 1365
batch 339, loss: 2.3356, instance_loss: 0.5544, weighted_loss: 1.8012, label: 1, bag_size: 113
batch 359, loss: 0.3263, instance_loss: 0.5103, weighted_loss: 0.3815, label: 4, bag_size: 260
batch 379, loss: 1.6468, instance_loss: 0.5073, weighted_loss: 1.3050, label: 1, bag_size: 617
batch 399, loss: 1.2145, instance_loss: 0.5120, weighted_loss: 1.0038, label: 4, bag_size: 730
batch 419, loss: 1.0481, instance_loss: 0.4962, weighted_loss: 0.8825, label: 1, bag_size: 372
batch 439, loss: 0.0239, instance_loss: 0.2952, weighted_loss: 0.1053, label: 0, bag_size: 428
batch 459, loss: 2.3069, instance_loss: 0.7091, weighted_loss: 1.8276, label: 0, bag_size: 1073
batch 479, loss: 0.9639, instance_loss: 0.4809, weighted_loss: 0.8190, label: 4, bag_size: 731
batch 499, loss: 2.7103, instance_loss: 0.6319, weighted_loss: 2.0868, label: 4, bag_size: 310
batch 519, loss: 0.2478, instance_loss: 0.4807, weighted_loss: 0.3177, label: 4, bag_size: 923
batch 539, loss: 0.5092, instance_loss: 0.4956, weighted_loss: 0.5051, label: 1, bag_size: 371
batch 559, loss: 0.0004, instance_loss: 0.0772, weighted_loss: 0.0234, label: 0, bag_size: 706
batch 579, loss: 0.7449, instance_loss: 0.3896, weighted_loss: 0.6383, label: 3, bag_size: 1076


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.0726010101010101: correct 345/4752
Epoch: 49, train_loss: 1.0210, train_clustering_loss:  0.4732, train_error: 0.4613
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.5038759689922481, correct 65/129
class 2: acc 0.2807017543859649, correct 32/114
class 3: acc 0.5371900826446281, correct 65/121
class 4: acc 0.5596330275229358, correct 61/109

Val Set, val_loss: 1.7429, val_error: 0.5405, auc: 0.7751
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.08783783783783784: correct 52/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 49 out of 20


batch 19, loss: 0.7154, instance_loss: 0.4639, weighted_loss: 0.6399, label: 2, bag_size: 877
batch 39, loss: 0.8538, instance_loss: 0.4164, weighted_loss: 0.7226, label: 3, bag_size: 258
batch 59, loss: 2.2579, instance_loss: 0.6337, weighted_loss: 1.7706, label: 3, bag_size: 1057
batch 79, loss: 0.2382, instance_loss: 0.4102, weighted_loss: 0.2898, label: 4, bag_size: 618
batch 99, loss: 2.7089, instance_loss: 0.7555, weighted_loss: 2.1229, label: 0, bag_size: 214
batch 119, loss: 1.3436, instance_loss: 0.5619, weighted_loss: 1.1091, label: 2, bag_size: 713
batch 139, loss: 1.8860, instance_loss: 0.5305, weighted_loss: 1.4793, label: 4, bag_size: 395
batch 159, loss: 0.7022, instance_loss: 0.5010, weighted_loss: 0.6419, label: 4, bag_size: 618
batch 179, loss: 3.0859, instance_loss: 0.7768, weighted_loss: 2.3932, label: 1, bag_size: 45
batch 199, loss: 0.7333, instance_loss: 0.4952, weighted_loss: 0.6619, label: 2, bag_size: 299
batch 219, loss: 1.1958, instance_loss: 0.5171, weighted_loss: 0.9922, label: 1, bag_size: 925
batch 239, loss: 1.1840, instance_loss: 0.6174, weighted_loss: 1.0141, label: 3, bag_size: 794
batch 259, loss: 1.2200, instance_loss: 0.4758, weighted_loss: 0.9968, label: 2, bag_size: 1016
batch 279, loss: 0.5912, instance_loss: 0.4330, weighted_loss: 0.5437, label: 3, bag_size: 510
batch 299, loss: 0.9145, instance_loss: 0.4262, weighted_loss: 0.7680, label: 3, bag_size: 780
batch 319, loss: 0.3616, instance_loss: 0.3520, weighted_loss: 0.3587, label: 2, bag_size: 470
batch 339, loss: 1.1186, instance_loss: 0.5000, weighted_loss: 0.9330, label: 4, bag_size: 113
batch 359, loss: 0.0680, instance_loss: 0.3381, weighted_loss: 0.1490, label: 0, bag_size: 295
batch 379, loss: 2.4581, instance_loss: 0.5401, weighted_loss: 1.8827, label: 1, bag_size: 742
batch 399, loss: 0.7044, instance_loss: 0.3943, weighted_loss: 0.6114, label: 2, bag_size: 953
batch 419, loss: 1.2237, instance_loss: 0.5050, weighted_loss: 1.0081, label: 3, bag_size: 505
batch 439, loss: 0.2443, instance_loss: 0.3860, weighted_loss: 0.2868, label: 4, bag_size: 744
batch 459, loss: 0.0276, instance_loss: 0.1758, weighted_loss: 0.0720, label: 0, bag_size: 355
batch 479, loss: 1.5455, instance_loss: 0.5825, weighted_loss: 1.2566, label: 2, bag_size: 512
batch 499, loss: 0.4044, instance_loss: 0.3708, weighted_loss: 0.3943, label: 4, bag_size: 944
batch 519, loss: 0.7498, instance_loss: 0.4399, weighted_loss: 0.6568, label: 2, bag_size: 812
batch 539, loss: 2.8116, instance_loss: 0.7008, weighted_loss: 2.1783, label: 3, bag_size: 492
batch 559, loss: 1.0950, instance_loss: 0.5743, weighted_loss: 0.9388, label: 4, bag_size: 476
batch 579, loss: 0.9745, instance_loss: 0.4533, weighted_loss: 0.8182, label: 4, bag_size: 333


class 0 clustering acc 0.9946548821548822: correct 23633/23760
class 1 clustering acc 0.07954545454545454: correct 378/4752
Epoch: 50, train_loss: 0.9638, train_clustering_loss:  0.4704, train_error: 0.4141
class 0: acc 0.8492063492063492, correct 107/126
class 1: acc 0.3482142857142857, correct 39/112
class 2: acc 0.456, correct 57/125
class 3: acc 0.6517857142857143, correct 73/112
class 4: acc 0.6050420168067226, correct 72/119

Val Set, val_loss: 2.0787, val_error: 0.5676, auc: 0.7620
class 0 clustering acc 0.9935810810810811: correct 2941/2960
class 1 clustering acc 0.12331081081081081: correct 73/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 50 out of 20


batch 19, loss: 0.0096, instance_loss: 0.1406, weighted_loss: 0.0489, label: 0, bag_size: 533
batch 39, loss: 0.1751, instance_loss: 0.4717, weighted_loss: 0.2641, label: 0, bag_size: 416
batch 59, loss: 0.0099, instance_loss: 0.0641, weighted_loss: 0.0261, label: 0, bag_size: 527
batch 79, loss: 0.6742, instance_loss: 0.3944, weighted_loss: 0.5903, label: 3, bag_size: 817
batch 99, loss: 3.4409, instance_loss: 0.6178, weighted_loss: 2.5940, label: 0, bag_size: 492
batch 119, loss: 1.4274, instance_loss: 0.4535, weighted_loss: 1.1352, label: 3, bag_size: 779
batch 139, loss: 0.5639, instance_loss: 0.4011, weighted_loss: 0.5150, label: 3, bag_size: 817
batch 159, loss: 1.0972, instance_loss: 0.4261, weighted_loss: 0.8959, label: 4, bag_size: 868
batch 179, loss: 0.1192, instance_loss: 0.3297, weighted_loss: 0.1824, label: 0, bag_size: 234
batch 199, loss: 0.5581, instance_loss: 0.4211, weighted_loss: 0.5170, label: 3, bag_size: 996
batch 219, loss: 0.0172, instance_loss: 0.3224, weighted_loss: 0.1087, label: 0, bag_size: 340
batch 239, loss: 2.1322, instance_loss: 0.6119, weighted_loss: 1.6761, label: 4, bag_size: 438
batch 259, loss: 1.7094, instance_loss: 0.5550, weighted_loss: 1.3631, label: 4, bag_size: 244
batch 279, loss: 0.5541, instance_loss: 0.3518, weighted_loss: 0.4934, label: 3, bag_size: 737
batch 299, loss: 0.1076, instance_loss: 0.2330, weighted_loss: 0.1452, label: 4, bag_size: 266
batch 319, loss: 0.8269, instance_loss: 0.4697, weighted_loss: 0.7197, label: 4, bag_size: 895
batch 339, loss: 0.4813, instance_loss: 0.3649, weighted_loss: 0.4464, label: 3, bag_size: 684
batch 359, loss: 1.6674, instance_loss: 0.5391, weighted_loss: 1.3289, label: 2, bag_size: 627
batch 379, loss: 3.3328, instance_loss: 0.7666, weighted_loss: 2.5629, label: 2, bag_size: 1308
batch 399, loss: 1.7503, instance_loss: 0.6453, weighted_loss: 1.4188, label: 1, bag_size: 184
batch 419, loss: 0.2525, instance_loss: 0.4313, weighted_loss: 0.3061, label: 0, bag_size: 324
batch 439, loss: 0.9322, instance_loss: 0.4705, weighted_loss: 0.7937, label: 1, bag_size: 618
batch 459, loss: 2.0365, instance_loss: 0.5122, weighted_loss: 1.5792, label: 2, bag_size: 1016
batch 479, loss: 0.0847, instance_loss: 0.4483, weighted_loss: 0.1938, label: 4, bag_size: 293
batch 499, loss: 1.4091, instance_loss: 0.4551, weighted_loss: 1.1229, label: 4, bag_size: 72
batch 519, loss: 0.2187, instance_loss: 0.3560, weighted_loss: 0.2599, label: 4, bag_size: 1041
batch 539, loss: 1.4077, instance_loss: 0.5933, weighted_loss: 1.1634, label: 3, bag_size: 899
batch 559, loss: 0.0081, instance_loss: 0.2534, weighted_loss: 0.0817, label: 0, bag_size: 221
batch 579, loss: 0.9693, instance_loss: 0.6208, weighted_loss: 0.8647, label: 0, bag_size: 343


class 0 clustering acc 0.9960437710437711: correct 23666/23760
class 1 clustering acc 0.05366161616161616: correct 255/4752
Epoch: 51, train_loss: 0.9586, train_clustering_loss:  0.4688, train_error: 0.3923
class 0: acc 0.8269230769230769, correct 86/104
class 1: acc 0.4824561403508772, correct 55/114
class 2: acc 0.5263157894736842, correct 60/114
class 3: acc 0.6541353383458647, correct 87/133
class 4: acc 0.5658914728682171, correct 73/129

Val Set, val_loss: 1.8715, val_error: 0.5270, auc: 0.7800
class 0 clustering acc 0.9929054054054054: correct 2939/2960
class 1 clustering acc 0.07939189189189189: correct 47/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 51 out of 20
Early stopping
Val error: 0.5811, ROC AUC: 0.7414
Test error: 0.5946, ROC AUC: 0.7281
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.07142857142857142, correct 1/14

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9714, instance_loss: 0.6036, weighted_loss: 1.5611, label: 1, bag_size: 855
batch 39, loss: 2.4565, instance_loss: 0.5501, weighted_loss: 1.8846, label: 2, bag_size: 731
batch 59, loss: 2.1403, instance_loss: 0.5011, weighted_loss: 1.6485, label: 3, bag_size: 1022
batch 79, loss: 1.1296, instance_loss: 0.5317, weighted_loss: 0.9502, label: 1, bag_size: 829
batch 99, loss: 2.6425, instance_loss: 0.6033, weighted_loss: 2.0308, label: 2, bag_size: 631
batch 119, loss: 0.5584, instance_loss: 0.4492, weighted_loss: 0.5256, label: 3, bag_size: 344
batch 139, loss: 1.5513, instance_loss: 0.5260, weighted_loss: 1.2437, label: 2, bag_size: 380
batch 159, loss: 2.2199, instance_loss: 0.5447, weighted_loss: 1.7174, label: 2, bag_size: 363
batch 179, loss: 1.2134, instance_loss: 0.4974, weighted_loss: 0.9986, label: 3, bag_size: 894
batch 199, loss: 1.8748, instance_loss: 0.5208, weighted_loss: 1.4686, label: 2, bag_size: 350
batch 219, loss: 0.3401, instance_loss: 0.4137, weighted_loss: 0.3622, label: 0, bag_size: 188
batch 239, loss: 1.4883, instance_loss: 0.5573, weighted_loss: 1.2090, label: 4, bag_size: 490
batch 259, loss: 0.8490, instance_loss: 0.5291, weighted_loss: 0.7530, label: 0, bag_size: 188
batch 279, loss: 1.5560, instance_loss: 0.5043, weighted_loss: 1.2405, label: 4, bag_size: 703
batch 299, loss: 0.3799, instance_loss: 0.4384, weighted_loss: 0.3974, label: 0, bag_size: 268
batch 319, loss: 3.3506, instance_loss: 0.6507, weighted_loss: 2.5406, label: 3, bag_size: 508
batch 339, loss: 1.6307, instance_loss: 0.4924, weighted_loss: 1.2892, label: 1, bag_size: 355
batch 359, loss: 1.6947, instance_loss: 0.5154, weighted_loss: 1.3409, label: 4, bag_size: 246
batch 379, loss: 1.5957, instance_loss: 0.5483, weighted_loss: 1.2815, label: 2, bag_size: 953
batch 399, loss: 0.6215, instance_loss: 0.4122, weighted_loss: 0.5587, label: 0, bag_size: 201
batch 419, loss: 2.1933, instance_loss: 0.5606, weighted_loss: 1.7035, label: 1, bag_size: 391
batch 439, loss: 1.4251, instance_loss: 0.5414, weighted_loss: 1.1600, label: 0, bag_size: 273
batch 459, loss: 0.9261, instance_loss: 0.4516, weighted_loss: 0.7837, label: 1, bag_size: 1043
batch 479, loss: 1.0233, instance_loss: 0.4803, weighted_loss: 0.8604, label: 0, bag_size: 62
batch 499, loss: 1.8174, instance_loss: 0.5423, weighted_loss: 1.4348, label: 3, bag_size: 796
batch 519, loss: 1.2487, instance_loss: 0.4603, weighted_loss: 1.0121, label: 1, bag_size: 233
batch 539, loss: 1.3764, instance_loss: 0.5233, weighted_loss: 1.1205, label: 3, bag_size: 631
batch 559, loss: 1.3102, instance_loss: 0.5184, weighted_loss: 1.0727, label: 4, bag_size: 218
batch 579, loss: 1.5523, instance_loss: 0.5154, weighted_loss: 1.2413, label: 2, bag_size: 318


class 0 clustering acc 0.9985690235690236: correct 23726/23760
class 1 clustering acc 0.0025252525252525255: correct 12/4752
Epoch: 0, train_loss: 1.5305, train_clustering_loss:  0.5234, train_error: 0.6616
class 0: acc 0.6666666666666666, correct 76/114
class 1: acc 0.36923076923076925, correct 48/130
class 2: acc 0.1623931623931624, correct 19/117
class 3: acc 0.2564102564102564, correct 30/117
class 4: acc 0.2413793103448276, correct 28/116

Val Set, val_loss: 1.3835, val_error: 0.5676, auc: 0.7103
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.383467).  Saving model ...


batch 19, loss: 1.7242, instance_loss: 0.5405, weighted_loss: 1.3691, label: 3, bag_size: 245
batch 39, loss: 0.1243, instance_loss: 0.3618, weighted_loss: 0.1956, label: 0, bag_size: 251
batch 59, loss: 0.2077, instance_loss: 0.3790, weighted_loss: 0.2591, label: 0, bag_size: 527
batch 79, loss: 1.3433, instance_loss: 0.4743, weighted_loss: 1.0826, label: 2, bag_size: 266
batch 99, loss: 1.1856, instance_loss: 0.4402, weighted_loss: 0.9620, label: 2, bag_size: 799
batch 119, loss: 1.1225, instance_loss: 0.4213, weighted_loss: 0.9121, label: 1, bag_size: 398
batch 139, loss: 1.0165, instance_loss: 0.4411, weighted_loss: 0.8439, label: 1, bag_size: 620
batch 159, loss: 1.7318, instance_loss: 0.6190, weighted_loss: 1.3979, label: 4, bag_size: 267
batch 179, loss: 0.2670, instance_loss: 0.3958, weighted_loss: 0.3056, label: 0, bag_size: 98
batch 199, loss: 0.8545, instance_loss: 0.4196, weighted_loss: 0.7241, label: 0, bag_size: 73
batch 219, loss: 0.1683, instance_loss: 0.3414, weighted_loss: 0.2202, label: 0, bag_size: 190
batch 239, loss: 2.5822, instance_loss: 0.6534, weighted_loss: 2.0035, label: 2, bag_size: 812
batch 259, loss: 1.7365, instance_loss: 0.4608, weighted_loss: 1.3538, label: 1, bag_size: 564
batch 279, loss: 2.9065, instance_loss: 0.6686, weighted_loss: 2.2351, label: 0, bag_size: 243
batch 299, loss: 1.4213, instance_loss: 0.5043, weighted_loss: 1.1462, label: 3, bag_size: 796
batch 319, loss: 0.2872, instance_loss: 0.3983, weighted_loss: 0.3205, label: 0, bag_size: 142
batch 339, loss: 4.4663, instance_loss: 0.7961, weighted_loss: 3.3653, label: 0, bag_size: 169
batch 359, loss: 1.0607, instance_loss: 0.5224, weighted_loss: 0.8992, label: 4, bag_size: 503
batch 379, loss: 1.1568, instance_loss: 0.4578, weighted_loss: 0.9471, label: 3, bag_size: 235
batch 399, loss: 1.4161, instance_loss: 0.5017, weighted_loss: 1.1418, label: 4, bag_size: 530
batch 419, loss: 1.1771, instance_loss: 0.4451, weighted_loss: 0.9575, label: 1, bag_size: 371
batch 439, loss: 1.5016, instance_loss: 0.4605, weighted_loss: 1.1893, label: 4, bag_size: 329
batch 459, loss: 1.7897, instance_loss: 0.4915, weighted_loss: 1.4003, label: 0, bag_size: 62
batch 479, loss: 1.4984, instance_loss: 0.4797, weighted_loss: 1.1928, label: 4, bag_size: 590
batch 499, loss: 0.4521, instance_loss: 0.3496, weighted_loss: 0.4213, label: 0, bag_size: 79
batch 519, loss: 1.8480, instance_loss: 0.5154, weighted_loss: 1.4482, label: 2, bag_size: 1308
batch 539, loss: 0.1666, instance_loss: 0.3406, weighted_loss: 0.2188, label: 0, bag_size: 340
batch 559, loss: 3.1520, instance_loss: 0.6333, weighted_loss: 2.3964, label: 3, bag_size: 638
batch 579, loss: 1.3341, instance_loss: 0.5452, weighted_loss: 1.0974, label: 2, bag_size: 380


class 0 clustering acc 0.9995791245791246: correct 23750/23760
class 1 clustering acc 0.00021043771043771043: correct 1/4752
Epoch: 1, train_loss: 1.4358, train_clustering_loss:  0.5040, train_error: 0.6667
class 0: acc 0.7394957983193278, correct 88/119
class 1: acc 0.18604651162790697, correct 24/129
class 2: acc 0.25892857142857145, correct 29/112
class 3: acc 0.2857142857142857, correct 36/126
class 4: acc 0.19444444444444445, correct 21/108

Val Set, val_loss: 1.4761, val_error: 0.7297, auc: 0.6755
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0241, instance_loss: 0.4650, weighted_loss: 0.8564, label: 3, bag_size: 488
batch 39, loss: 1.0023, instance_loss: 0.5024, weighted_loss: 0.8524, label: 1, bag_size: 534
batch 59, loss: 2.1837, instance_loss: 0.5533, weighted_loss: 1.6946, label: 2, bag_size: 645
batch 79, loss: 0.1406, instance_loss: 0.4221, weighted_loss: 0.2250, label: 0, bag_size: 366
batch 99, loss: 1.0237, instance_loss: 0.5044, weighted_loss: 0.8679, label: 4, bag_size: 618
batch 119, loss: 1.6463, instance_loss: 0.5223, weighted_loss: 1.3091, label: 1, bag_size: 391
batch 139, loss: 1.2751, instance_loss: 0.4564, weighted_loss: 1.0295, label: 3, bag_size: 1060
batch 159, loss: 1.5562, instance_loss: 0.5062, weighted_loss: 1.2412, label: 4, bag_size: 46
batch 179, loss: 1.9053, instance_loss: 0.5185, weighted_loss: 1.4892, label: 1, bag_size: 660
batch 199, loss: 1.3709, instance_loss: 0.5910, weighted_loss: 1.1369, label: 1, bag_size: 669
batch 219, loss: 0.6718, instance_loss: 0.5874, weighted_loss: 0.6465, label: 0, bag_size: 283
batch 239, loss: 1.0959, instance_loss: 0.4426, weighted_loss: 0.8999, label: 4, bag_size: 233
batch 259, loss: 2.4454, instance_loss: 0.5700, weighted_loss: 1.8828, label: 3, bag_size: 508
batch 279, loss: 2.1353, instance_loss: 0.5395, weighted_loss: 1.6566, label: 1, bag_size: 875
batch 299, loss: 1.0352, instance_loss: 0.5655, weighted_loss: 0.8943, label: 0, bag_size: 615
batch 319, loss: 2.2607, instance_loss: 0.5646, weighted_loss: 1.7519, label: 3, bag_size: 428
batch 339, loss: 1.4427, instance_loss: 0.5509, weighted_loss: 1.1752, label: 4, bag_size: 231
batch 359, loss: 1.1349, instance_loss: 0.4779, weighted_loss: 0.9378, label: 1, bag_size: 522
batch 379, loss: 1.3011, instance_loss: 0.4637, weighted_loss: 1.0499, label: 3, bag_size: 830
batch 399, loss: 0.2311, instance_loss: 0.3098, weighted_loss: 0.2547, label: 2, bag_size: 1608
batch 419, loss: 1.4937, instance_loss: 0.5806, weighted_loss: 1.2198, label: 4, bag_size: 627
batch 439, loss: 2.1366, instance_loss: 0.6360, weighted_loss: 1.6864, label: 0, bag_size: 1045
batch 459, loss: 1.6101, instance_loss: 0.4625, weighted_loss: 1.2658, label: 2, bag_size: 853
batch 479, loss: 1.1511, instance_loss: 0.5237, weighted_loss: 0.9629, label: 4, bag_size: 797
batch 499, loss: 1.5066, instance_loss: 0.5865, weighted_loss: 1.2306, label: 4, bag_size: 854
batch 519, loss: 0.4509, instance_loss: 0.4257, weighted_loss: 0.4433, label: 0, bag_size: 351
batch 539, loss: 1.7862, instance_loss: 0.5710, weighted_loss: 1.4216, label: 3, bag_size: 794
batch 559, loss: 2.3733, instance_loss: 0.5877, weighted_loss: 1.8376, label: 2, bag_size: 953
batch 579, loss: 0.3480, instance_loss: 0.4204, weighted_loss: 0.3697, label: 0, bag_size: 97


class 0 clustering acc 0.9996212121212121: correct 23751/23760
class 1 clustering acc 0.003367003367003367: correct 16/4752
Epoch: 2, train_loss: 1.3550, train_clustering_loss:  0.4991, train_error: 0.5976
class 0: acc 0.859504132231405, correct 104/121
class 1: acc 0.21774193548387097, correct 27/124
class 2: acc 0.17272727272727273, correct 19/110
class 3: acc 0.35537190082644626, correct 43/121
class 4: acc 0.3898305084745763, correct 46/118

Val Set, val_loss: 1.3655, val_error: 0.6351, auc: 0.7065
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.383467 --> 1.365538).  Saving model ...


batch 19, loss: 1.9887, instance_loss: 0.5903, weighted_loss: 1.5692, label: 2, bag_size: 421
batch 39, loss: 1.3253, instance_loss: 0.5142, weighted_loss: 1.0819, label: 2, bag_size: 286
batch 59, loss: 0.0940, instance_loss: 0.3087, weighted_loss: 0.1584, label: 0, bag_size: 268
batch 79, loss: 1.7217, instance_loss: 0.6391, weighted_loss: 1.3969, label: 3, bag_size: 817
batch 99, loss: 1.9906, instance_loss: 0.5518, weighted_loss: 1.5590, label: 1, bag_size: 355
batch 119, loss: 1.7206, instance_loss: 0.5374, weighted_loss: 1.3656, label: 3, bag_size: 598
batch 139, loss: 1.2037, instance_loss: 0.4868, weighted_loss: 0.9886, label: 2, bag_size: 659
batch 159, loss: 0.9373, instance_loss: 0.4768, weighted_loss: 0.7992, label: 4, bag_size: 665
batch 179, loss: 1.1146, instance_loss: 0.4411, weighted_loss: 0.9126, label: 3, bag_size: 631
batch 199, loss: 1.0777, instance_loss: 0.4545, weighted_loss: 0.8907, label: 3, bag_size: 796
batch 219, loss: 1.3688, instance_loss: 0.5939, weighted_loss: 1.1363, label: 4, bag_size: 1018
batch 239, loss: 1.7237, instance_loss: 0.4649, weighted_loss: 1.3460, label: 1, bag_size: 672
batch 259, loss: 2.9341, instance_loss: 0.6762, weighted_loss: 2.2568, label: 3, bag_size: 638
batch 279, loss: 1.2687, instance_loss: 0.5074, weighted_loss: 1.0403, label: 3, bag_size: 393
batch 299, loss: 1.1144, instance_loss: 0.5071, weighted_loss: 0.9322, label: 3, bag_size: 398
batch 319, loss: 1.4042, instance_loss: 0.4737, weighted_loss: 1.1251, label: 1, bag_size: 616
batch 339, loss: 0.6752, instance_loss: 0.3802, weighted_loss: 0.5867, label: 0, bag_size: 79
batch 359, loss: 0.9683, instance_loss: 0.5470, weighted_loss: 0.8419, label: 4, bag_size: 1113
batch 379, loss: 1.5227, instance_loss: 0.5253, weighted_loss: 1.2235, label: 1, bag_size: 892
batch 399, loss: 0.9155, instance_loss: 0.4305, weighted_loss: 0.7700, label: 1, bag_size: 886
batch 419, loss: 1.5750, instance_loss: 0.5780, weighted_loss: 1.2759, label: 3, bag_size: 317
batch 439, loss: 0.2392, instance_loss: 0.4792, weighted_loss: 0.3112, label: 0, bag_size: 615
batch 459, loss: 1.7799, instance_loss: 0.5632, weighted_loss: 1.4149, label: 3, bag_size: 1147
batch 479, loss: 0.9223, instance_loss: 0.4852, weighted_loss: 0.7912, label: 0, bag_size: 81
batch 499, loss: 1.1016, instance_loss: 0.4571, weighted_loss: 0.9082, label: 3, bag_size: 894
batch 519, loss: 1.4576, instance_loss: 0.5128, weighted_loss: 1.1742, label: 2, bag_size: 779
batch 539, loss: 1.4035, instance_loss: 0.4929, weighted_loss: 1.1303, label: 1, bag_size: 892
batch 559, loss: 1.7479, instance_loss: 0.5701, weighted_loss: 1.3946, label: 3, bag_size: 520
batch 579, loss: 0.8629, instance_loss: 0.4676, weighted_loss: 0.7444, label: 4, bag_size: 520


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.001473063973063973: correct 7/4752
Epoch: 3, train_loss: 1.3488, train_clustering_loss:  0.4998, train_error: 0.5993
class 0: acc 0.8267716535433071, correct 105/127
class 1: acc 0.11864406779661017, correct 14/118
class 2: acc 0.3700787401574803, correct 47/127
class 3: acc 0.23008849557522124, correct 26/113
class 4: acc 0.42201834862385323, correct 46/109

Val Set, val_loss: 1.4091, val_error: 0.5811, auc: 0.7221
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5377, instance_loss: 0.4144, weighted_loss: 0.5007, label: 4, bag_size: 432
batch 39, loss: 0.1760, instance_loss: 0.3502, weighted_loss: 0.2283, label: 0, bag_size: 297
batch 59, loss: 1.7225, instance_loss: 0.5381, weighted_loss: 1.3672, label: 1, bag_size: 599
batch 79, loss: 1.6675, instance_loss: 0.5653, weighted_loss: 1.3368, label: 1, bag_size: 177
batch 99, loss: 2.5060, instance_loss: 0.6576, weighted_loss: 1.9515, label: 4, bag_size: 359
batch 119, loss: 0.0712, instance_loss: 0.3220, weighted_loss: 0.1464, label: 0, bag_size: 268
batch 139, loss: 0.8481, instance_loss: 0.4363, weighted_loss: 0.7246, label: 4, bag_size: 506
batch 159, loss: 1.4502, instance_loss: 0.5119, weighted_loss: 1.1687, label: 4, bag_size: 590
batch 179, loss: 0.0727, instance_loss: 0.3464, weighted_loss: 0.1549, label: 0, bag_size: 70
batch 199, loss: 1.4515, instance_loss: 0.5085, weighted_loss: 1.1686, label: 1, bag_size: 483
batch 219, loss: 1.1281, instance_loss: 0.4460, weighted_loss: 0.9235, label: 4, bag_size: 530
batch 239, loss: 1.6754, instance_loss: 0.5805, weighted_loss: 1.3469, label: 2, bag_size: 1066
batch 259, loss: 1.8455, instance_loss: 0.4583, weighted_loss: 1.4293, label: 1, bag_size: 1360
batch 279, loss: 1.4209, instance_loss: 0.5728, weighted_loss: 1.1664, label: 0, bag_size: 243
batch 299, loss: 1.4198, instance_loss: 0.4922, weighted_loss: 1.1415, label: 1, bag_size: 823
batch 319, loss: 1.8159, instance_loss: 0.6088, weighted_loss: 1.4538, label: 3, bag_size: 498
batch 339, loss: 1.3133, instance_loss: 0.5194, weighted_loss: 1.0751, label: 4, bag_size: 970
batch 359, loss: 1.4120, instance_loss: 0.5360, weighted_loss: 1.1492, label: 2, bag_size: 554
batch 379, loss: 1.3513, instance_loss: 0.5249, weighted_loss: 1.1034, label: 4, bag_size: 72
batch 399, loss: 0.4342, instance_loss: 0.3978, weighted_loss: 0.4233, label: 4, bag_size: 231
batch 419, loss: 1.3245, instance_loss: 0.5213, weighted_loss: 1.0835, label: 2, bag_size: 633
batch 439, loss: 1.4522, instance_loss: 0.5554, weighted_loss: 1.1831, label: 4, bag_size: 218
batch 459, loss: 1.5110, instance_loss: 0.5280, weighted_loss: 1.2161, label: 4, bag_size: 986
batch 479, loss: 2.9066, instance_loss: 0.5387, weighted_loss: 2.1962, label: 4, bag_size: 264
batch 499, loss: 1.1641, instance_loss: 0.5357, weighted_loss: 0.9755, label: 3, bag_size: 739
batch 519, loss: 1.8697, instance_loss: 0.6079, weighted_loss: 1.4912, label: 1, bag_size: 159
batch 539, loss: 1.5013, instance_loss: 0.5053, weighted_loss: 1.2025, label: 3, bag_size: 149
batch 559, loss: 1.9787, instance_loss: 0.4979, weighted_loss: 1.5345, label: 3, bag_size: 282
batch 579, loss: 2.6832, instance_loss: 0.6669, weighted_loss: 2.0783, label: 4, bag_size: 1351


class 0 clustering acc 0.9996212121212121: correct 23751/23760
class 1 clustering acc 0.003787878787878788: correct 18/4752
Epoch: 4, train_loss: 1.3199, train_clustering_loss:  0.4927, train_error: 0.5741
class 0: acc 0.8333333333333334, correct 100/120
class 1: acc 0.05555555555555555, correct 6/108
class 2: acc 0.4411764705882353, correct 60/136
class 3: acc 0.24528301886792453, correct 26/106
class 4: acc 0.49193548387096775, correct 61/124

Val Set, val_loss: 1.3557, val_error: 0.5135, auc: 0.7230
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.365538 --> 1.355733).  Saving model ...


batch 19, loss: 4.5752, instance_loss: 0.9426, weighted_loss: 3.4854, label: 0, bag_size: 214
batch 39, loss: 0.8557, instance_loss: 0.4537, weighted_loss: 0.7351, label: 2, bag_size: 702
batch 59, loss: 0.2325, instance_loss: 0.3050, weighted_loss: 0.2543, label: 0, bag_size: 351
batch 79, loss: 1.6524, instance_loss: 0.6137, weighted_loss: 1.3408, label: 3, bag_size: 192
batch 99, loss: 1.5790, instance_loss: 0.5705, weighted_loss: 1.2765, label: 2, bag_size: 645
batch 119, loss: 0.9628, instance_loss: 0.4784, weighted_loss: 0.8175, label: 3, bag_size: 102
batch 139, loss: 1.3971, instance_loss: 0.4136, weighted_loss: 1.1020, label: 1, bag_size: 544
batch 159, loss: 0.9150, instance_loss: 0.4715, weighted_loss: 0.7819, label: 3, bag_size: 818
batch 179, loss: 1.8031, instance_loss: 0.5635, weighted_loss: 1.4312, label: 1, bag_size: 184
batch 199, loss: 1.3866, instance_loss: 0.4883, weighted_loss: 1.1171, label: 2, bag_size: 953
batch 219, loss: 1.3403, instance_loss: 0.4991, weighted_loss: 1.0879, label: 2, bag_size: 348
batch 239, loss: 1.5632, instance_loss: 0.5453, weighted_loss: 1.2578, label: 2, bag_size: 361
batch 259, loss: 1.6662, instance_loss: 0.5578, weighted_loss: 1.3337, label: 1, bag_size: 159
batch 279, loss: 1.8350, instance_loss: 0.4873, weighted_loss: 1.4307, label: 1, bag_size: 1023
batch 299, loss: 1.3048, instance_loss: 0.5237, weighted_loss: 1.0705, label: 2, bag_size: 135
batch 319, loss: 0.1734, instance_loss: 0.3057, weighted_loss: 0.2131, label: 0, bag_size: 281
batch 339, loss: 1.2641, instance_loss: 0.4586, weighted_loss: 1.0224, label: 2, bag_size: 584
batch 359, loss: 1.1504, instance_loss: 0.4615, weighted_loss: 0.9437, label: 2, bag_size: 607
batch 379, loss: 1.3787, instance_loss: 0.5297, weighted_loss: 1.1240, label: 3, bag_size: 625
batch 399, loss: 1.5848, instance_loss: 0.5463, weighted_loss: 1.2733, label: 4, bag_size: 604
batch 419, loss: 2.1058, instance_loss: 0.6582, weighted_loss: 1.6715, label: 0, bag_size: 745
batch 439, loss: 1.0268, instance_loss: 0.5414, weighted_loss: 0.8812, label: 4, bag_size: 775
batch 459, loss: 1.2717, instance_loss: 0.4834, weighted_loss: 1.0352, label: 4, bag_size: 277
batch 479, loss: 0.0190, instance_loss: 0.4659, weighted_loss: 0.1531, label: 2, bag_size: 936
batch 499, loss: 6.1704, instance_loss: 0.8060, weighted_loss: 4.5611, label: 1, bag_size: 669
batch 519, loss: 1.0703, instance_loss: 0.4621, weighted_loss: 0.8878, label: 1, bag_size: 892
batch 539, loss: 1.6652, instance_loss: 0.5207, weighted_loss: 1.3219, label: 4, bag_size: 419
batch 559, loss: 1.6188, instance_loss: 0.5197, weighted_loss: 1.2891, label: 2, bag_size: 380
batch 579, loss: 4.5294, instance_loss: 0.9042, weighted_loss: 3.4418, label: 0, bag_size: 600


class 0 clustering acc 0.9994107744107744: correct 23746/23760
class 1 clustering acc 0.008838383838383838: correct 42/4752
Epoch: 5, train_loss: 1.3585, train_clustering_loss:  0.5019, train_error: 0.6010
class 0: acc 0.768, correct 96/125
class 1: acc 0.23333333333333334, correct 28/120
class 2: acc 0.23387096774193547, correct 29/124
class 3: acc 0.35833333333333334, correct 43/120
class 4: acc 0.3904761904761905, correct 41/105

Val Set, val_loss: 1.2909, val_error: 0.5270, auc: 0.7254
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.355733 --> 1.290934).  Saving model ...


batch 19, loss: 1.8953, instance_loss: 0.5369, weighted_loss: 1.4878, label: 1, bag_size: 339
batch 39, loss: 0.0997, instance_loss: 0.3756, weighted_loss: 0.1825, label: 0, bag_size: 49
batch 59, loss: 1.6129, instance_loss: 0.5208, weighted_loss: 1.2853, label: 2, bag_size: 829
batch 79, loss: 1.8910, instance_loss: 0.5010, weighted_loss: 1.4740, label: 3, bag_size: 166
batch 99, loss: 0.5642, instance_loss: 0.5241, weighted_loss: 0.5522, label: 4, bag_size: 683
batch 119, loss: 1.3558, instance_loss: 0.5080, weighted_loss: 1.1014, label: 1, bag_size: 361
batch 139, loss: 0.1108, instance_loss: 0.3932, weighted_loss: 0.1955, label: 0, bag_size: 71
batch 159, loss: 1.3949, instance_loss: 0.5587, weighted_loss: 1.1440, label: 2, bag_size: 769
batch 179, loss: 3.6514, instance_loss: 0.6202, weighted_loss: 2.7421, label: 3, bag_size: 282
batch 199, loss: 1.4824, instance_loss: 0.4664, weighted_loss: 1.1776, label: 2, bag_size: 864
batch 219, loss: 0.2101, instance_loss: 0.3566, weighted_loss: 0.2540, label: 0, bag_size: 59
batch 239, loss: 1.1620, instance_loss: 0.4822, weighted_loss: 0.9581, label: 1, bag_size: 886
batch 259, loss: 0.3263, instance_loss: 0.3864, weighted_loss: 0.3443, label: 0, bag_size: 397
batch 279, loss: 1.6003, instance_loss: 0.4552, weighted_loss: 1.2568, label: 4, bag_size: 266
batch 299, loss: 1.1065, instance_loss: 0.4571, weighted_loss: 0.9117, label: 4, bag_size: 699
batch 319, loss: 1.7235, instance_loss: 0.4973, weighted_loss: 1.3556, label: 1, bag_size: 949
batch 339, loss: 2.1860, instance_loss: 0.6280, weighted_loss: 1.7186, label: 0, bag_size: 367
batch 359, loss: 0.7602, instance_loss: 0.3999, weighted_loss: 0.6521, label: 0, bag_size: 73
batch 379, loss: 1.1739, instance_loss: 0.5002, weighted_loss: 0.9718, label: 1, bag_size: 371
batch 399, loss: 1.7897, instance_loss: 0.5549, weighted_loss: 1.4192, label: 3, bag_size: 899
batch 419, loss: 1.2141, instance_loss: 0.5343, weighted_loss: 1.0101, label: 3, bag_size: 727
batch 439, loss: 1.3252, instance_loss: 0.5723, weighted_loss: 1.0994, label: 4, bag_size: 263
batch 459, loss: 1.2430, instance_loss: 0.5192, weighted_loss: 1.0259, label: 2, bag_size: 633
batch 479, loss: 1.4095, instance_loss: 0.4973, weighted_loss: 1.1358, label: 2, bag_size: 371
batch 499, loss: 2.0303, instance_loss: 0.5297, weighted_loss: 1.5802, label: 1, bag_size: 865
batch 519, loss: 0.9781, instance_loss: 0.2598, weighted_loss: 0.7627, label: 2, bag_size: 1975
batch 539, loss: 2.7991, instance_loss: 0.4615, weighted_loss: 2.0978, label: 4, bag_size: 198
batch 559, loss: 1.0094, instance_loss: 0.4337, weighted_loss: 0.8367, label: 3, bag_size: 598
batch 579, loss: 1.2343, instance_loss: 0.4588, weighted_loss: 1.0016, label: 3, bag_size: 398


class 0 clustering acc 0.9993265993265993: correct 23744/23760
class 1 clustering acc 0.006102693602693603: correct 29/4752
Epoch: 6, train_loss: 1.2837, train_clustering_loss:  0.4964, train_error: 0.5438
class 0: acc 0.8412698412698413, correct 106/126
class 1: acc 0.31896551724137934, correct 37/116
class 2: acc 0.30357142857142855, correct 34/112
class 3: acc 0.36134453781512604, correct 43/119
class 4: acc 0.4214876033057851, correct 51/121

Val Set, val_loss: 1.3115, val_error: 0.6216, auc: 0.7287
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 3.4255, instance_loss: 0.6813, weighted_loss: 2.6023, label: 0, bag_size: 1045
batch 39, loss: 0.8147, instance_loss: 0.4903, weighted_loss: 0.7174, label: 3, bag_size: 631
batch 59, loss: 1.9566, instance_loss: 0.5836, weighted_loss: 1.5447, label: 3, bag_size: 500
batch 79, loss: 0.3799, instance_loss: 0.4531, weighted_loss: 0.4019, label: 0, bag_size: 357
batch 99, loss: 1.4162, instance_loss: 0.4875, weighted_loss: 1.1376, label: 4, bag_size: 228
batch 119, loss: 0.7230, instance_loss: 0.3955, weighted_loss: 0.6247, label: 1, bag_size: 748
batch 139, loss: 3.0223, instance_loss: 0.7510, weighted_loss: 2.3409, label: 0, bag_size: 273
batch 159, loss: 1.2458, instance_loss: 0.4246, weighted_loss: 0.9995, label: 1, bag_size: 328
batch 179, loss: 1.0864, instance_loss: 0.4907, weighted_loss: 0.9077, label: 2, bag_size: 702
batch 199, loss: 1.3443, instance_loss: 0.5165, weighted_loss: 1.0960, label: 2, bag_size: 754
batch 219, loss: 1.3162, instance_loss: 0.5269, weighted_loss: 1.0794, label: 3, bag_size: 1154
batch 239, loss: 0.8067, instance_loss: 0.6043, weighted_loss: 0.7460, label: 0, bag_size: 552
batch 259, loss: 0.8439, instance_loss: 0.4659, weighted_loss: 0.7305, label: 3, bag_size: 739
batch 279, loss: 1.7426, instance_loss: 0.4836, weighted_loss: 1.3649, label: 4, bag_size: 771
batch 299, loss: 1.5667, instance_loss: 0.5476, weighted_loss: 1.2610, label: 2, bag_size: 754
batch 319, loss: 1.1439, instance_loss: 0.4806, weighted_loss: 0.9449, label: 1, bag_size: 1360
batch 339, loss: 1.4313, instance_loss: 0.5743, weighted_loss: 1.1742, label: 0, bag_size: 178
batch 359, loss: 1.1140, instance_loss: 0.4839, weighted_loss: 0.9250, label: 2, bag_size: 605
batch 379, loss: 0.4384, instance_loss: 0.4323, weighted_loss: 0.4366, label: 4, bag_size: 204
batch 399, loss: 1.3351, instance_loss: 0.4841, weighted_loss: 1.0798, label: 4, bag_size: 731
batch 419, loss: 1.3149, instance_loss: 0.4852, weighted_loss: 1.0660, label: 2, bag_size: 725
batch 439, loss: 1.3471, instance_loss: 0.5000, weighted_loss: 1.0930, label: 2, bag_size: 906
batch 459, loss: 1.3203, instance_loss: 0.5023, weighted_loss: 1.0749, label: 3, bag_size: 443
batch 479, loss: 1.9763, instance_loss: 0.5302, weighted_loss: 1.5425, label: 1, bag_size: 328
batch 499, loss: 0.1172, instance_loss: 0.3774, weighted_loss: 0.1953, label: 0, bag_size: 33
batch 519, loss: 1.5149, instance_loss: 0.5181, weighted_loss: 1.2158, label: 1, bag_size: 329
batch 539, loss: 1.3643, instance_loss: 0.4553, weighted_loss: 1.0916, label: 2, bag_size: 860
batch 559, loss: 0.2821, instance_loss: 0.4912, weighted_loss: 0.3448, label: 4, bag_size: 895
batch 579, loss: 1.6235, instance_loss: 0.4775, weighted_loss: 1.2797, label: 2, bag_size: 717


class 0 clustering acc 0.999537037037037: correct 23749/23760
class 1 clustering acc 0.007154882154882155: correct 34/4752
Epoch: 7, train_loss: 1.3270, train_clustering_loss:  0.4998, train_error: 0.5758
class 0: acc 0.7524752475247525, correct 76/101
class 1: acc 0.16216216216216217, correct 18/111
class 2: acc 0.46616541353383456, correct 62/133
class 3: acc 0.3643410852713178, correct 47/129
class 4: acc 0.4083333333333333, correct 49/120

Val Set, val_loss: 1.3223, val_error: 0.5405, auc: 0.7226
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0955, instance_loss: 0.4928, weighted_loss: 0.9147, label: 4, bag_size: 263
batch 39, loss: 0.4270, instance_loss: 0.3607, weighted_loss: 0.4071, label: 0, bag_size: 234
batch 59, loss: 1.5477, instance_loss: 0.4807, weighted_loss: 1.2276, label: 4, bag_size: 714
batch 79, loss: 0.1866, instance_loss: 0.3074, weighted_loss: 0.2228, label: 0, bag_size: 517
batch 99, loss: 1.6707, instance_loss: 0.5215, weighted_loss: 1.3259, label: 1, bag_size: 697
batch 119, loss: 4.1535, instance_loss: 0.7280, weighted_loss: 3.1258, label: 3, bag_size: 638
batch 139, loss: 0.8726, instance_loss: 0.3829, weighted_loss: 0.7257, label: 4, bag_size: 266
batch 159, loss: 1.7314, instance_loss: 0.6414, weighted_loss: 1.4044, label: 2, bag_size: 614
batch 179, loss: 1.6733, instance_loss: 0.6319, weighted_loss: 1.3608, label: 2, bag_size: 567
batch 199, loss: 2.4162, instance_loss: 0.5441, weighted_loss: 1.8546, label: 1, bag_size: 184
batch 219, loss: 1.3915, instance_loss: 0.4913, weighted_loss: 1.1214, label: 1, bag_size: 339
batch 239, loss: 0.9190, instance_loss: 0.5289, weighted_loss: 0.8020, label: 4, bag_size: 1113
batch 259, loss: 0.2414, instance_loss: 0.2830, weighted_loss: 0.2539, label: 0, bag_size: 642
batch 279, loss: 1.0041, instance_loss: 0.4912, weighted_loss: 0.8502, label: 3, bag_size: 795
batch 299, loss: 0.6678, instance_loss: 0.4041, weighted_loss: 0.5887, label: 3, bag_size: 344
batch 319, loss: 1.0484, instance_loss: 0.5593, weighted_loss: 0.9016, label: 4, bag_size: 627
batch 339, loss: 1.2262, instance_loss: 0.4697, weighted_loss: 0.9992, label: 1, bag_size: 271
batch 359, loss: 0.2579, instance_loss: 0.3379, weighted_loss: 0.2819, label: 0, bag_size: 231
batch 379, loss: 2.1224, instance_loss: 0.5924, weighted_loss: 1.6634, label: 4, bag_size: 238
batch 399, loss: 0.7214, instance_loss: 0.3816, weighted_loss: 0.6195, label: 3, bag_size: 871
batch 419, loss: 0.3247, instance_loss: 0.4432, weighted_loss: 0.3603, label: 0, bag_size: 370
batch 439, loss: 2.6779, instance_loss: 0.5816, weighted_loss: 2.0490, label: 4, bag_size: 198
batch 459, loss: 1.6634, instance_loss: 0.5146, weighted_loss: 1.3188, label: 2, bag_size: 906
batch 479, loss: 1.4372, instance_loss: 0.4983, weighted_loss: 1.1556, label: 2, bag_size: 829
batch 499, loss: 0.1430, instance_loss: 0.3163, weighted_loss: 0.1950, label: 0, bag_size: 33
batch 519, loss: 1.2454, instance_loss: 0.4362, weighted_loss: 1.0026, label: 3, bag_size: 615
batch 539, loss: 0.4488, instance_loss: 0.3683, weighted_loss: 0.4246, label: 0, bag_size: 383
batch 559, loss: 1.1857, instance_loss: 0.5116, weighted_loss: 0.9835, label: 4, bag_size: 854
batch 579, loss: 1.1283, instance_loss: 0.4718, weighted_loss: 0.9313, label: 2, bag_size: 853


class 0 clustering acc 0.9992845117845118: correct 23743/23760
class 1 clustering acc 0.010942760942760943: correct 52/4752
Epoch: 8, train_loss: 1.2280, train_clustering_loss:  0.4829, train_error: 0.5236
class 0: acc 0.8895705521472392, correct 145/163
class 1: acc 0.3, correct 36/120
class 2: acc 0.15053763440860216, correct 14/93
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.375, correct 39/104

Val Set, val_loss: 1.3184, val_error: 0.6081, auc: 0.7428
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 2.2200, instance_loss: 0.6180, weighted_loss: 1.7394, label: 2, bag_size: 713
batch 39, loss: 1.4465, instance_loss: 0.4997, weighted_loss: 1.1624, label: 1, bag_size: 1043
batch 59, loss: 0.1081, instance_loss: 0.3790, weighted_loss: 0.1894, label: 0, bag_size: 164
batch 79, loss: 1.5393, instance_loss: 0.5133, weighted_loss: 1.2315, label: 2, bag_size: 744
batch 99, loss: 0.0686, instance_loss: 0.3029, weighted_loss: 0.1389, label: 0, bag_size: 142
batch 119, loss: 1.4030, instance_loss: 0.4857, weighted_loss: 1.1278, label: 1, bag_size: 361
batch 139, loss: 0.3664, instance_loss: 0.3647, weighted_loss: 0.3659, label: 4, bag_size: 773
batch 159, loss: 0.0214, instance_loss: 0.3623, weighted_loss: 0.1237, label: 0, bag_size: 340
batch 179, loss: 1.7651, instance_loss: 0.5359, weighted_loss: 1.3963, label: 4, bag_size: 267
batch 199, loss: 0.0534, instance_loss: 0.2718, weighted_loss: 0.1189, label: 0, bag_size: 33
batch 219, loss: 2.0693, instance_loss: 0.5825, weighted_loss: 1.6232, label: 4, bag_size: 110
batch 239, loss: 1.5245, instance_loss: 0.5710, weighted_loss: 1.2384, label: 2, bag_size: 133
batch 259, loss: 0.2970, instance_loss: 0.3343, weighted_loss: 0.3082, label: 0, bag_size: 74
batch 279, loss: 1.7834, instance_loss: 0.5606, weighted_loss: 1.4166, label: 4, bag_size: 592
batch 299, loss: 1.2112, instance_loss: 0.5046, weighted_loss: 0.9992, label: 2, bag_size: 708
batch 319, loss: 1.5077, instance_loss: 0.5426, weighted_loss: 1.2182, label: 4, bag_size: 1077
batch 339, loss: 2.0684, instance_loss: 0.6137, weighted_loss: 1.6320, label: 4, bag_size: 937
batch 359, loss: 1.3104, instance_loss: 0.4629, weighted_loss: 1.0561, label: 2, bag_size: 812
batch 379, loss: 0.1978, instance_loss: 0.2670, weighted_loss: 0.2186, label: 0, bag_size: 212
batch 399, loss: 1.0258, instance_loss: 0.4536, weighted_loss: 0.8542, label: 3, bag_size: 102
batch 419, loss: 0.7185, instance_loss: 0.4292, weighted_loss: 0.6317, label: 4, bag_size: 665
batch 439, loss: 0.2687, instance_loss: 0.4392, weighted_loss: 0.3198, label: 0, bag_size: 224
batch 459, loss: 1.2366, instance_loss: 0.4527, weighted_loss: 1.0014, label: 2, bag_size: 385
batch 479, loss: 0.9698, instance_loss: 0.4462, weighted_loss: 0.8127, label: 4, bag_size: 875
batch 499, loss: 1.0847, instance_loss: 0.4349, weighted_loss: 0.8897, label: 1, bag_size: 460
batch 519, loss: 2.6538, instance_loss: 0.5941, weighted_loss: 2.0359, label: 4, bag_size: 886
batch 539, loss: 0.2658, instance_loss: 0.3777, weighted_loss: 0.2994, label: 0, bag_size: 258
batch 559, loss: 1.0298, instance_loss: 0.4968, weighted_loss: 0.8699, label: 3, bag_size: 443
batch 579, loss: 1.1941, instance_loss: 0.5100, weighted_loss: 0.9889, label: 4, bag_size: 1104


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.014730639730639731: correct 70/4752
Epoch: 9, train_loss: 1.2705, train_clustering_loss:  0.4906, train_error: 0.5539
class 0: acc 0.8449612403100775, correct 109/129
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.3709677419354839, correct 46/124
class 3: acc 0.27450980392156865, correct 28/102
class 4: acc 0.4496124031007752, correct 58/129

Val Set, val_loss: 1.2981, val_error: 0.5676, auc: 0.7464
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.3850, instance_loss: 0.4830, weighted_loss: 1.1144, label: 1, bag_size: 814
batch 39, loss: 2.4438, instance_loss: 0.6217, weighted_loss: 1.8972, label: 3, bag_size: 796
batch 59, loss: 1.3388, instance_loss: 0.4870, weighted_loss: 1.0833, label: 3, bag_size: 451
batch 79, loss: 1.3413, instance_loss: 0.5202, weighted_loss: 1.0950, label: 3, bag_size: 230
batch 99, loss: 0.0234, instance_loss: 0.2611, weighted_loss: 0.0947, label: 0, bag_size: 80
batch 119, loss: 1.6640, instance_loss: 0.5579, weighted_loss: 1.3321, label: 2, bag_size: 1016
batch 139, loss: 0.7912, instance_loss: 0.3943, weighted_loss: 0.6721, label: 3, bag_size: 894
batch 159, loss: 1.6409, instance_loss: 0.5403, weighted_loss: 1.3108, label: 2, bag_size: 421
batch 179, loss: 1.0215, instance_loss: 0.4610, weighted_loss: 0.8533, label: 4, bag_size: 418
batch 199, loss: 1.3707, instance_loss: 0.5404, weighted_loss: 1.1216, label: 2, bag_size: 369
batch 219, loss: 0.4240, instance_loss: 0.3875, weighted_loss: 0.4130, label: 4, bag_size: 773
batch 239, loss: 0.9600, instance_loss: 0.5251, weighted_loss: 0.8296, label: 4, bag_size: 744
batch 259, loss: 1.1437, instance_loss: 0.4428, weighted_loss: 0.9334, label: 1, bag_size: 328
batch 279, loss: 0.0953, instance_loss: 0.2505, weighted_loss: 0.1419, label: 0, bag_size: 370
batch 299, loss: 1.4356, instance_loss: 0.5414, weighted_loss: 1.1674, label: 2, bag_size: 851
batch 319, loss: 0.9009, instance_loss: 0.4100, weighted_loss: 0.7537, label: 1, bag_size: 534
batch 339, loss: 1.6582, instance_loss: 0.5029, weighted_loss: 1.3116, label: 4, bag_size: 333
batch 359, loss: 1.5476, instance_loss: 0.4848, weighted_loss: 1.2287, label: 1, bag_size: 855
batch 379, loss: 1.5586, instance_loss: 0.4629, weighted_loss: 1.2299, label: 4, bag_size: 176
batch 399, loss: 1.3898, instance_loss: 0.4984, weighted_loss: 1.1224, label: 4, bag_size: 797
batch 419, loss: 0.2991, instance_loss: 0.4807, weighted_loss: 0.3536, label: 0, bag_size: 760
batch 439, loss: 1.8469, instance_loss: 0.5460, weighted_loss: 1.4566, label: 4, bag_size: 714
batch 459, loss: 1.6859, instance_loss: 0.5941, weighted_loss: 1.3584, label: 4, bag_size: 110
batch 479, loss: 1.1344, instance_loss: 0.5008, weighted_loss: 0.9444, label: 4, bag_size: 986
batch 499, loss: 1.2267, instance_loss: 0.5482, weighted_loss: 1.0232, label: 2, bag_size: 410
batch 519, loss: 1.3309, instance_loss: 0.5040, weighted_loss: 1.0828, label: 1, bag_size: 408
batch 539, loss: 0.1309, instance_loss: 0.3170, weighted_loss: 0.1867, label: 0, bag_size: 355
batch 559, loss: 1.1055, instance_loss: 0.4766, weighted_loss: 0.9168, label: 2, bag_size: 135
batch 579, loss: 1.4757, instance_loss: 0.4972, weighted_loss: 1.1821, label: 4, bag_size: 729


class 0 clustering acc 0.9987794612794613: correct 23731/23760
class 1 clustering acc 0.030723905723905723: correct 146/4752
Epoch: 10, train_loss: 1.2822, train_clustering_loss:  0.4937, train_error: 0.5673
class 0: acc 0.8347107438016529, correct 101/121
class 1: acc 0.38095238095238093, correct 48/126
class 2: acc 0.24793388429752067, correct 30/121
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.4051724137931034, correct 47/116

Val Set, val_loss: 1.3474, val_error: 0.5541, auc: 0.7415
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.3934, instance_loss: 0.4691, weighted_loss: 1.1161, label: 2, bag_size: 448
batch 39, loss: 0.0262, instance_loss: 0.1406, weighted_loss: 0.0605, label: 0, bag_size: 97
batch 59, loss: 1.5154, instance_loss: 0.5081, weighted_loss: 1.2132, label: 4, bag_size: 520
batch 79, loss: 1.4421, instance_loss: 0.5875, weighted_loss: 1.1857, label: 3, bag_size: 684
batch 99, loss: 0.8483, instance_loss: 0.4460, weighted_loss: 0.7276, label: 0, bag_size: 493
batch 119, loss: 1.9444, instance_loss: 0.6256, weighted_loss: 1.5487, label: 4, bag_size: 1113
batch 139, loss: 0.0618, instance_loss: 0.2629, weighted_loss: 0.1222, label: 0, bag_size: 59
batch 159, loss: 1.2825, instance_loss: 0.5144, weighted_loss: 1.0520, label: 4, bag_size: 729
batch 179, loss: 1.7310, instance_loss: 0.5768, weighted_loss: 1.3848, label: 2, bag_size: 348
batch 199, loss: 1.0212, instance_loss: 0.5025, weighted_loss: 0.8656, label: 2, bag_size: 754
batch 219, loss: 2.1523, instance_loss: 0.5546, weighted_loss: 1.6730, label: 4, bag_size: 432
batch 239, loss: 2.3936, instance_loss: 0.5537, weighted_loss: 1.8417, label: 3, bag_size: 282
batch 259, loss: 1.2368, instance_loss: 0.4914, weighted_loss: 1.0132, label: 1, bag_size: 233
batch 279, loss: 1.1710, instance_loss: 0.5136, weighted_loss: 0.9738, label: 4, bag_size: 824
batch 299, loss: 1.5023, instance_loss: 0.5693, weighted_loss: 1.2224, label: 4, bag_size: 432
batch 319, loss: 1.3036, instance_loss: 0.4793, weighted_loss: 1.0563, label: 1, bag_size: 614
batch 339, loss: 1.2558, instance_loss: 0.5574, weighted_loss: 1.0462, label: 3, bag_size: 780
batch 359, loss: 1.2222, instance_loss: 0.5898, weighted_loss: 1.0325, label: 2, bag_size: 410
batch 379, loss: 0.0404, instance_loss: 0.3290, weighted_loss: 0.1270, label: 0, bag_size: 523
batch 399, loss: 1.5100, instance_loss: 0.4746, weighted_loss: 1.1994, label: 1, bag_size: 372
batch 419, loss: 2.1020, instance_loss: 0.5170, weighted_loss: 1.6265, label: 2, bag_size: 1077
batch 439, loss: 1.6412, instance_loss: 0.5736, weighted_loss: 1.3209, label: 1, bag_size: 371
batch 459, loss: 1.6610, instance_loss: 0.5444, weighted_loss: 1.3260, label: 4, bag_size: 854
batch 479, loss: 0.2390, instance_loss: 0.4988, weighted_loss: 0.3169, label: 4, bag_size: 574
batch 499, loss: 1.0719, instance_loss: 0.4786, weighted_loss: 0.8939, label: 2, bag_size: 557
batch 519, loss: 0.1936, instance_loss: 0.4714, weighted_loss: 0.2770, label: 0, bag_size: 351
batch 539, loss: 0.8266, instance_loss: 0.5291, weighted_loss: 0.7373, label: 3, bag_size: 818
batch 559, loss: 0.7017, instance_loss: 0.4287, weighted_loss: 0.6198, label: 3, bag_size: 615
batch 579, loss: 2.3134, instance_loss: 0.5191, weighted_loss: 1.7751, label: 1, bag_size: 564


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.041245791245791245: correct 196/4752
Epoch: 11, train_loss: 1.2181, train_clustering_loss:  0.4885, train_error: 0.5505
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.17796610169491525, correct 21/118
class 2: acc 0.4017857142857143, correct 45/112
class 3: acc 0.5036496350364964, correct 69/137
class 4: acc 0.416, correct 52/125

Val Set, val_loss: 1.3271, val_error: 0.6081, auc: 0.7511
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.06756756756756757: correct 40/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.8541, instance_loss: 0.5390, weighted_loss: 1.4596, label: 1, bag_size: 599
batch 39, loss: 0.8028, instance_loss: 0.4796, weighted_loss: 0.7058, label: 2, bag_size: 607
batch 59, loss: 2.2510, instance_loss: 0.5787, weighted_loss: 1.7493, label: 4, bag_size: 113
batch 79, loss: 0.7678, instance_loss: 0.4681, weighted_loss: 0.6779, label: 4, bag_size: 231
batch 99, loss: 0.8330, instance_loss: 0.4800, weighted_loss: 0.7271, label: 3, bag_size: 274
batch 119, loss: 1.0285, instance_loss: 0.5319, weighted_loss: 0.8795, label: 2, bag_size: 337
batch 139, loss: 1.9391, instance_loss: 0.5055, weighted_loss: 1.5090, label: 3, bag_size: 149
batch 159, loss: 0.9217, instance_loss: 0.4303, weighted_loss: 0.7743, label: 3, bag_size: 498
batch 179, loss: 2.7584, instance_loss: 0.5137, weighted_loss: 2.0850, label: 2, bag_size: 702
batch 199, loss: 1.0655, instance_loss: 0.4695, weighted_loss: 0.8867, label: 1, bag_size: 141
batch 219, loss: 1.4611, instance_loss: 0.5266, weighted_loss: 1.1808, label: 2, bag_size: 998
batch 239, loss: 1.1099, instance_loss: 0.4351, weighted_loss: 0.9075, label: 1, bag_size: 960
batch 259, loss: 2.5550, instance_loss: 0.7770, weighted_loss: 2.0216, label: 4, bag_size: 854
batch 279, loss: 1.4698, instance_loss: 0.5603, weighted_loss: 1.1969, label: 4, bag_size: 482
batch 299, loss: 0.0480, instance_loss: 0.2048, weighted_loss: 0.0951, label: 0, bag_size: 573
batch 319, loss: 1.3439, instance_loss: 0.4946, weighted_loss: 1.0891, label: 3, bag_size: 230
batch 339, loss: 0.7684, instance_loss: 0.4011, weighted_loss: 0.6582, label: 3, bag_size: 598
batch 359, loss: 1.3870, instance_loss: 0.3989, weighted_loss: 1.0905, label: 3, bag_size: 804
batch 379, loss: 1.6326, instance_loss: 0.5087, weighted_loss: 1.2955, label: 4, bag_size: 244
batch 399, loss: 1.0415, instance_loss: 0.5015, weighted_loss: 0.8795, label: 1, bag_size: 892
batch 419, loss: 0.6846, instance_loss: 0.6914, weighted_loss: 0.6867, label: 4, bag_size: 409
batch 439, loss: 0.6638, instance_loss: 0.5264, weighted_loss: 0.6226, label: 4, bag_size: 46
batch 459, loss: 0.0002, instance_loss: 0.1355, weighted_loss: 0.0408, label: 2, bag_size: 1608
batch 479, loss: 1.2191, instance_loss: 0.5274, weighted_loss: 1.0116, label: 2, bag_size: 361
batch 499, loss: 2.9199, instance_loss: 0.6669, weighted_loss: 2.2440, label: 4, bag_size: 937
batch 519, loss: 1.6129, instance_loss: 0.5018, weighted_loss: 1.2796, label: 3, bag_size: 472
batch 539, loss: 1.2049, instance_loss: 0.4294, weighted_loss: 0.9723, label: 1, bag_size: 390
batch 559, loss: 1.0815, instance_loss: 0.5170, weighted_loss: 0.9122, label: 2, bag_size: 864
batch 579, loss: 0.3189, instance_loss: 0.4187, weighted_loss: 0.3488, label: 0, bag_size: 281


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.03303872053872054: correct 157/4752
Epoch: 12, train_loss: 1.2449, train_clustering_loss:  0.4913, train_error: 0.5387
class 0: acc 0.7692307692307693, correct 80/104
class 1: acc 0.33076923076923076, correct 43/130
class 2: acc 0.4375, correct 56/128
class 3: acc 0.48854961832061067, correct 64/131
class 4: acc 0.3069306930693069, correct 31/101

Val Set, val_loss: 1.3166, val_error: 0.4865, auc: 0.7640
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.8740, instance_loss: 0.4114, weighted_loss: 0.7352, label: 2, bag_size: 684
batch 39, loss: 1.1530, instance_loss: 0.4439, weighted_loss: 0.9403, label: 1, bag_size: 460
batch 59, loss: 1.3080, instance_loss: 0.5191, weighted_loss: 1.0714, label: 3, bag_size: 431
batch 79, loss: 2.4873, instance_loss: 0.6793, weighted_loss: 1.9449, label: 0, bag_size: 1073
batch 99, loss: 1.1328, instance_loss: 0.5006, weighted_loss: 0.9432, label: 2, bag_size: 348
batch 119, loss: 1.8181, instance_loss: 0.5212, weighted_loss: 1.4290, label: 1, bag_size: 949
batch 139, loss: 0.9378, instance_loss: 0.4513, weighted_loss: 0.7918, label: 3, bag_size: 1186
batch 159, loss: 0.5976, instance_loss: 0.5147, weighted_loss: 0.5727, label: 0, bag_size: 317
batch 179, loss: 0.6627, instance_loss: 0.4286, weighted_loss: 0.5925, label: 0, bag_size: 613
batch 199, loss: 0.1494, instance_loss: 0.7132, weighted_loss: 0.3185, label: 4, bag_size: 746
batch 219, loss: 2.2823, instance_loss: 0.5168, weighted_loss: 1.7526, label: 2, bag_size: 185
batch 239, loss: 2.0125, instance_loss: 0.5907, weighted_loss: 1.5859, label: 4, bag_size: 854
batch 259, loss: 1.3452, instance_loss: 0.4944, weighted_loss: 1.0900, label: 1, bag_size: 1013
batch 279, loss: 1.2796, instance_loss: 0.4875, weighted_loss: 1.0420, label: 0, bag_size: 143
batch 299, loss: 1.9049, instance_loss: 0.5367, weighted_loss: 1.4945, label: 1, bag_size: 742
batch 319, loss: 0.8586, instance_loss: 0.4739, weighted_loss: 0.7432, label: 4, bag_size: 875
batch 339, loss: 0.8322, instance_loss: 0.4780, weighted_loss: 0.7260, label: 2, bag_size: 613
batch 359, loss: 1.6278, instance_loss: 0.5048, weighted_loss: 1.2909, label: 4, bag_size: 476
batch 379, loss: 1.6567, instance_loss: 0.5428, weighted_loss: 1.3225, label: 4, bag_size: 238
batch 399, loss: 0.0274, instance_loss: 0.3617, weighted_loss: 0.1277, label: 2, bag_size: 953
batch 419, loss: 0.8887, instance_loss: 0.4825, weighted_loss: 0.7669, label: 2, bag_size: 567
batch 439, loss: 2.4438, instance_loss: 0.5295, weighted_loss: 1.8695, label: 3, bag_size: 192
batch 459, loss: 3.2636, instance_loss: 0.7494, weighted_loss: 2.5093, label: 0, bag_size: 1039
batch 479, loss: 1.7246, instance_loss: 0.5938, weighted_loss: 1.3854, label: 4, bag_size: 685
batch 499, loss: 0.3410, instance_loss: 0.4986, weighted_loss: 0.3883, label: 4, bag_size: 574
batch 519, loss: 2.8215, instance_loss: 0.5355, weighted_loss: 2.1357, label: 2, bag_size: 448
batch 539, loss: 0.4027, instance_loss: 0.4571, weighted_loss: 0.4190, label: 0, bag_size: 493
batch 559, loss: 1.1764, instance_loss: 0.4572, weighted_loss: 0.9606, label: 3, bag_size: 615
batch 579, loss: 0.4128, instance_loss: 0.4611, weighted_loss: 0.4273, label: 4, bag_size: 727


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.013468013468013467: correct 64/4752
Epoch: 13, train_loss: 1.2466, train_clustering_loss:  0.5042, train_error: 0.5455
class 0: acc 0.7798165137614679, correct 85/109
class 1: acc 0.18, correct 18/100
class 2: acc 0.3969465648854962, correct 52/131
class 3: acc 0.4251968503937008, correct 54/127
class 4: acc 0.48031496062992124, correct 61/127

Val Set, val_loss: 1.2775, val_error: 0.5405, auc: 0.7553
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7142857142857143, correct 10/14
Validation loss decreased (1.290934 --> 1.277483).  Saving model ...


batch 19, loss: 1.5736, instance_loss: 0.5652, weighted_loss: 1.2711, label: 1, bag_size: 233
batch 39, loss: 0.5139, instance_loss: 0.5192, weighted_loss: 0.5155, label: 4, bag_size: 530
batch 59, loss: 0.2228, instance_loss: 0.3071, weighted_loss: 0.2481, label: 0, bag_size: 218
batch 79, loss: 1.3073, instance_loss: 0.5037, weighted_loss: 1.0662, label: 1, bag_size: 840
batch 99, loss: 0.3515, instance_loss: 0.2473, weighted_loss: 0.3203, label: 0, bag_size: 212
batch 119, loss: 0.0729, instance_loss: 0.3873, weighted_loss: 0.1672, label: 0, bag_size: 15
batch 139, loss: 0.8868, instance_loss: 0.4964, weighted_loss: 0.7697, label: 3, bag_size: 739
batch 159, loss: 1.3136, instance_loss: 0.5496, weighted_loss: 1.0844, label: 3, bag_size: 364
batch 179, loss: 0.0377, instance_loss: 0.1793, weighted_loss: 0.0801, label: 0, bag_size: 341
batch 199, loss: 1.4247, instance_loss: 0.4879, weighted_loss: 1.1437, label: 3, bag_size: 520
batch 219, loss: 0.5396, instance_loss: 0.3862, weighted_loss: 0.4936, label: 3, bag_size: 476
batch 239, loss: 1.0425, instance_loss: 0.4319, weighted_loss: 0.8593, label: 3, bag_size: 431
batch 259, loss: 1.1304, instance_loss: 0.4894, weighted_loss: 0.9381, label: 1, bag_size: 1013
batch 279, loss: 1.6404, instance_loss: 0.5354, weighted_loss: 1.3089, label: 2, bag_size: 369
batch 299, loss: 1.6797, instance_loss: 0.5684, weighted_loss: 1.3463, label: 2, bag_size: 363
batch 319, loss: 1.0960, instance_loss: 0.4864, weighted_loss: 0.9131, label: 2, bag_size: 253
batch 339, loss: 1.8203, instance_loss: 0.4808, weighted_loss: 1.4184, label: 4, bag_size: 176
batch 359, loss: 0.0009, instance_loss: 0.5231, weighted_loss: 0.1576, label: 1, bag_size: 669
batch 379, loss: 0.7522, instance_loss: 0.4553, weighted_loss: 0.6631, label: 4, bag_size: 639
batch 399, loss: 1.7961, instance_loss: 0.5243, weighted_loss: 1.4146, label: 0, bag_size: 367
batch 419, loss: 1.2188, instance_loss: 0.5198, weighted_loss: 1.0091, label: 3, bag_size: 857
batch 439, loss: 0.8503, instance_loss: 0.4728, weighted_loss: 0.7371, label: 0, bag_size: 277
batch 459, loss: 2.1473, instance_loss: 0.5286, weighted_loss: 1.6617, label: 2, bag_size: 1122
batch 479, loss: 1.2870, instance_loss: 0.5515, weighted_loss: 1.0663, label: 3, bag_size: 499
batch 499, loss: 0.4703, instance_loss: 0.3586, weighted_loss: 0.4368, label: 0, bag_size: 642
batch 519, loss: 2.3464, instance_loss: 0.4951, weighted_loss: 1.7910, label: 1, bag_size: 875
batch 539, loss: 1.2315, instance_loss: 0.5500, weighted_loss: 1.0270, label: 0, bag_size: 183
batch 559, loss: 1.1864, instance_loss: 0.4772, weighted_loss: 0.9737, label: 2, bag_size: 867
batch 579, loss: 1.0988, instance_loss: 0.5323, weighted_loss: 0.9288, label: 3, bag_size: 235


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.0382996632996633: correct 182/4752
Epoch: 14, train_loss: 1.2371, train_clustering_loss:  0.4933, train_error: 0.5556
class 0: acc 0.8145161290322581, correct 101/124
class 1: acc 0.2868217054263566, correct 37/129
class 2: acc 0.3181818181818182, correct 35/110
class 3: acc 0.36363636363636365, correct 40/110
class 4: acc 0.4214876033057851, correct 51/121

Val Set, val_loss: 1.2233, val_error: 0.5000, auc: 0.7925
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.277483 --> 1.223303).  Saving model ...


batch 19, loss: 1.3535, instance_loss: 0.5424, weighted_loss: 1.1102, label: 1, bag_size: 159
batch 39, loss: 1.8915, instance_loss: 0.5583, weighted_loss: 1.4915, label: 3, bag_size: 520
batch 59, loss: 0.9369, instance_loss: 0.6234, weighted_loss: 0.8429, label: 0, bag_size: 143
batch 79, loss: 0.6852, instance_loss: 0.4754, weighted_loss: 0.6222, label: 4, bag_size: 665
batch 99, loss: 1.7417, instance_loss: 0.4738, weighted_loss: 1.3613, label: 1, bag_size: 764
batch 119, loss: 1.4615, instance_loss: 0.5376, weighted_loss: 1.1843, label: 2, bag_size: 606
batch 139, loss: 1.6146, instance_loss: 0.6374, weighted_loss: 1.3215, label: 3, bag_size: 897
batch 159, loss: 1.5980, instance_loss: 0.5475, weighted_loss: 1.2829, label: 4, bag_size: 740
batch 179, loss: 0.8895, instance_loss: 0.4457, weighted_loss: 0.7564, label: 4, bag_size: 875
batch 199, loss: 1.0636, instance_loss: 0.4912, weighted_loss: 0.8919, label: 3, bag_size: 476
batch 219, loss: 1.4599, instance_loss: 0.4959, weighted_loss: 1.1707, label: 3, bag_size: 1328
batch 239, loss: 0.1965, instance_loss: 0.2899, weighted_loss: 0.2245, label: 0, bag_size: 201
batch 259, loss: 0.9650, instance_loss: 0.5111, weighted_loss: 0.8289, label: 2, bag_size: 1079
batch 279, loss: 1.9028, instance_loss: 0.6091, weighted_loss: 1.5147, label: 0, bag_size: 376
batch 299, loss: 1.2432, instance_loss: 0.5298, weighted_loss: 1.0291, label: 3, bag_size: 258
batch 319, loss: 1.6530, instance_loss: 0.5922, weighted_loss: 1.3348, label: 0, bag_size: 243
batch 339, loss: 1.3010, instance_loss: 0.5111, weighted_loss: 1.0641, label: 2, bag_size: 598
batch 359, loss: 0.9256, instance_loss: 0.4433, weighted_loss: 0.7809, label: 3, bag_size: 194
batch 379, loss: 0.0144, instance_loss: 0.2155, weighted_loss: 0.0748, label: 0, bag_size: 341
batch 399, loss: 0.7739, instance_loss: 0.4316, weighted_loss: 0.6712, label: 3, bag_size: 780
batch 419, loss: 1.0197, instance_loss: 0.5024, weighted_loss: 0.8645, label: 4, bag_size: 489
batch 439, loss: 1.8825, instance_loss: 0.5474, weighted_loss: 1.4820, label: 2, bag_size: 219
batch 459, loss: 0.9224, instance_loss: 0.5068, weighted_loss: 0.7977, label: 2, bag_size: 208
batch 479, loss: 0.9589, instance_loss: 0.5309, weighted_loss: 0.8305, label: 0, bag_size: 316
batch 499, loss: 0.4178, instance_loss: 0.4030, weighted_loss: 0.4133, label: 0, bag_size: 210
batch 519, loss: 0.6061, instance_loss: 0.4497, weighted_loss: 0.5592, label: 0, bag_size: 97
batch 539, loss: 0.8729, instance_loss: 0.5071, weighted_loss: 0.7631, label: 4, bag_size: 468
batch 559, loss: 1.0944, instance_loss: 0.4533, weighted_loss: 0.9021, label: 4, bag_size: 729
batch 579, loss: 0.3386, instance_loss: 0.4229, weighted_loss: 0.3639, label: 1, bag_size: 1091


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.029461279461279462: correct 140/4752
Epoch: 15, train_loss: 1.2301, train_clustering_loss:  0.4917, train_error: 0.5556
class 0: acc 0.7862595419847328, correct 103/131
class 1: acc 0.2037037037037037, correct 22/108
class 2: acc 0.40625, correct 52/128
class 3: acc 0.3063063063063063, correct 34/111
class 4: acc 0.45689655172413796, correct 53/116

Val Set, val_loss: 1.3567, val_error: 0.5676, auc: 0.7675
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8920, instance_loss: 0.4437, weighted_loss: 0.7575, label: 2, bag_size: 812
batch 39, loss: 0.8795, instance_loss: 0.4980, weighted_loss: 0.7651, label: 2, bag_size: 633
batch 59, loss: 0.0129, instance_loss: 0.2380, weighted_loss: 0.0804, label: 0, bag_size: 101
batch 79, loss: 0.9362, instance_loss: 0.5106, weighted_loss: 0.8086, label: 2, bag_size: 390
batch 99, loss: 1.2139, instance_loss: 0.6106, weighted_loss: 1.0329, label: 3, bag_size: 1186
batch 119, loss: 1.3075, instance_loss: 0.4684, weighted_loss: 1.0558, label: 3, bag_size: 996
batch 139, loss: 1.5481, instance_loss: 0.4798, weighted_loss: 1.2276, label: 2, bag_size: 744
batch 159, loss: 1.3500, instance_loss: 0.4716, weighted_loss: 1.0865, label: 1, bag_size: 1043
batch 179, loss: 0.5692, instance_loss: 0.4843, weighted_loss: 0.5437, label: 0, bag_size: 524
batch 199, loss: 0.8420, instance_loss: 0.5832, weighted_loss: 0.7644, label: 4, bag_size: 689
batch 219, loss: 1.0830, instance_loss: 0.4429, weighted_loss: 0.8910, label: 4, bag_size: 854
batch 239, loss: 1.2728, instance_loss: 0.5565, weighted_loss: 1.0579, label: 2, bag_size: 702
batch 259, loss: 0.0514, instance_loss: 0.2132, weighted_loss: 0.0999, label: 0, bag_size: 97
batch 279, loss: 1.7617, instance_loss: 0.6106, weighted_loss: 1.4164, label: 0, bag_size: 343
batch 299, loss: 1.5071, instance_loss: 0.4657, weighted_loss: 1.1947, label: 1, bag_size: 321
batch 319, loss: 0.0854, instance_loss: 0.3573, weighted_loss: 0.1669, label: 0, bag_size: 188
batch 339, loss: 0.7330, instance_loss: 0.4566, weighted_loss: 0.6501, label: 3, bag_size: 488
batch 359, loss: 0.5401, instance_loss: 0.5143, weighted_loss: 0.5324, label: 3, bag_size: 403
batch 379, loss: 0.9285, instance_loss: 0.3998, weighted_loss: 0.7699, label: 4, bag_size: 490
batch 399, loss: 0.1422, instance_loss: 0.3967, weighted_loss: 0.2186, label: 0, bag_size: 238
batch 419, loss: 0.0719, instance_loss: 0.2883, weighted_loss: 0.1368, label: 0, bag_size: 70
batch 439, loss: 1.7106, instance_loss: 0.5645, weighted_loss: 1.3668, label: 3, bag_size: 393
batch 459, loss: 1.1103, instance_loss: 0.4429, weighted_loss: 0.9101, label: 1, bag_size: 660
batch 479, loss: 0.3822, instance_loss: 0.4680, weighted_loss: 0.4079, label: 0, bag_size: 62
batch 499, loss: 1.2556, instance_loss: 0.5017, weighted_loss: 1.0294, label: 0, bag_size: 710
batch 519, loss: 1.7042, instance_loss: 0.5233, weighted_loss: 1.3500, label: 2, bag_size: 746
batch 539, loss: 0.2502, instance_loss: 0.3422, weighted_loss: 0.2778, label: 0, bag_size: 142
batch 559, loss: 1.4231, instance_loss: 0.4971, weighted_loss: 1.1453, label: 2, bag_size: 398
batch 579, loss: 1.3815, instance_loss: 0.4706, weighted_loss: 1.1082, label: 2, bag_size: 627


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.028409090909090908: correct 135/4752
Epoch: 16, train_loss: 1.1751, train_clustering_loss:  0.4947, train_error: 0.4949
class 0: acc 0.8308823529411765, correct 113/136
class 1: acc 0.36666666666666664, correct 44/120
class 2: acc 0.4051724137931034, correct 47/116
class 3: acc 0.41739130434782606, correct 48/115
class 4: acc 0.4485981308411215, correct 48/107

Val Set, val_loss: 1.2868, val_error: 0.5000, auc: 0.7614
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5224, instance_loss: 0.4698, weighted_loss: 0.5067, label: 0, bag_size: 183
batch 39, loss: 2.7978, instance_loss: 0.6094, weighted_loss: 2.1413, label: 3, bag_size: 533
batch 59, loss: 0.9962, instance_loss: 0.5390, weighted_loss: 0.8591, label: 3, bag_size: 818
batch 79, loss: 0.8457, instance_loss: 0.4014, weighted_loss: 0.7124, label: 3, bag_size: 587
batch 99, loss: 1.4663, instance_loss: 0.4849, weighted_loss: 1.1719, label: 2, bag_size: 860
batch 119, loss: 2.3043, instance_loss: 0.6009, weighted_loss: 1.7933, label: 1, bag_size: 361
batch 139, loss: 1.1890, instance_loss: 0.4710, weighted_loss: 0.9736, label: 2, bag_size: 731
batch 159, loss: 1.9931, instance_loss: 0.4887, weighted_loss: 1.5417, label: 2, bag_size: 1074
batch 179, loss: 1.7634, instance_loss: 0.4914, weighted_loss: 1.3818, label: 1, bag_size: 742
batch 199, loss: 0.5395, instance_loss: 0.4940, weighted_loss: 0.5258, label: 4, bag_size: 1018
batch 219, loss: 0.4401, instance_loss: 0.5603, weighted_loss: 0.4762, label: 0, bag_size: 587
batch 239, loss: 1.3515, instance_loss: 0.5528, weighted_loss: 1.1119, label: 4, bag_size: 937
batch 259, loss: 1.9460, instance_loss: 0.5563, weighted_loss: 1.5291, label: 1, bag_size: 988
batch 279, loss: 1.2998, instance_loss: 0.5112, weighted_loss: 1.0632, label: 2, bag_size: 627
batch 299, loss: 0.9287, instance_loss: 0.4724, weighted_loss: 0.7918, label: 2, bag_size: 659
batch 319, loss: 2.0741, instance_loss: 0.5143, weighted_loss: 1.6062, label: 3, bag_size: 1057
batch 339, loss: 1.0660, instance_loss: 0.4811, weighted_loss: 0.8905, label: 3, bag_size: 97
batch 359, loss: 3.0904, instance_loss: 0.6305, weighted_loss: 2.3525, label: 3, bag_size: 282
batch 379, loss: 1.8714, instance_loss: 0.5590, weighted_loss: 1.4776, label: 4, bag_size: 476
batch 399, loss: 0.9385, instance_loss: 0.6032, weighted_loss: 0.8379, label: 3, bag_size: 897
batch 419, loss: 0.8637, instance_loss: 0.6474, weighted_loss: 0.7988, label: 1, bag_size: 311
batch 439, loss: 2.2748, instance_loss: 0.6439, weighted_loss: 1.7855, label: 4, bag_size: 1297
batch 459, loss: 0.8866, instance_loss: 0.4217, weighted_loss: 0.7471, label: 3, bag_size: 451
batch 479, loss: 1.3104, instance_loss: 0.5427, weighted_loss: 1.0800, label: 4, bag_size: 699
batch 499, loss: 1.1496, instance_loss: 0.4740, weighted_loss: 0.9469, label: 2, bag_size: 371
batch 519, loss: 1.2911, instance_loss: 0.4473, weighted_loss: 1.0380, label: 1, bag_size: 617
batch 539, loss: 0.9222, instance_loss: 0.4444, weighted_loss: 0.7789, label: 2, bag_size: 598
batch 559, loss: 0.7810, instance_loss: 0.4316, weighted_loss: 0.6762, label: 3, bag_size: 317
batch 579, loss: 0.9430, instance_loss: 0.4840, weighted_loss: 0.8053, label: 2, bag_size: 633


class 0 clustering acc 0.9987794612794613: correct 23731/23760
class 1 clustering acc 0.022937710437710437: correct 109/4752
Epoch: 17, train_loss: 1.2182, train_clustering_loss:  0.4934, train_error: 0.5253
class 0: acc 0.7948717948717948, correct 93/117
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.4198473282442748, correct 55/131
class 3: acc 0.5634920634920635, correct 71/126
class 4: acc 0.35454545454545455, correct 39/110

Val Set, val_loss: 1.2366, val_error: 0.5405, auc: 0.7753
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4296, instance_loss: 0.4848, weighted_loss: 1.1461, label: 3, bag_size: 258
batch 39, loss: 1.0645, instance_loss: 0.4183, weighted_loss: 0.8707, label: 3, bag_size: 317
batch 59, loss: 1.7902, instance_loss: 0.5449, weighted_loss: 1.4166, label: 1, bag_size: 988
batch 79, loss: 2.6159, instance_loss: 0.6379, weighted_loss: 2.0225, label: 4, bag_size: 312
batch 99, loss: 2.4555, instance_loss: 0.7231, weighted_loss: 1.9357, label: 0, bag_size: 1414
batch 119, loss: 0.2539, instance_loss: 0.3282, weighted_loss: 0.2762, label: 0, bag_size: 613
batch 139, loss: 1.1296, instance_loss: 0.4437, weighted_loss: 0.9239, label: 1, bag_size: 1043
batch 159, loss: 1.7459, instance_loss: 0.5973, weighted_loss: 1.4013, label: 1, bag_size: 350
batch 179, loss: 0.8118, instance_loss: 0.4501, weighted_loss: 0.7033, label: 3, bag_size: 473
batch 199, loss: 0.6649, instance_loss: 0.5191, weighted_loss: 0.6212, label: 4, bag_size: 204
batch 219, loss: 0.0331, instance_loss: 0.3077, weighted_loss: 0.1155, label: 0, bag_size: 59
batch 239, loss: 1.1240, instance_loss: 0.4637, weighted_loss: 0.9259, label: 1, bag_size: 949
batch 259, loss: 1.3346, instance_loss: 0.5389, weighted_loss: 1.0959, label: 2, bag_size: 522
batch 279, loss: 3.0779, instance_loss: 0.6423, weighted_loss: 2.3472, label: 3, bag_size: 961
batch 299, loss: 1.4814, instance_loss: 0.5781, weighted_loss: 1.2104, label: 3, bag_size: 192
batch 319, loss: 1.8949, instance_loss: 0.6602, weighted_loss: 1.5245, label: 1, bag_size: 1103
batch 339, loss: 0.7214, instance_loss: 0.4660, weighted_loss: 0.6448, label: 3, bag_size: 818
batch 359, loss: 1.3997, instance_loss: 0.4916, weighted_loss: 1.1272, label: 4, bag_size: 196
batch 379, loss: 1.0449, instance_loss: 0.5525, weighted_loss: 0.8972, label: 3, bag_size: 398
batch 399, loss: 1.0397, instance_loss: 0.4674, weighted_loss: 0.8680, label: 2, bag_size: 572
batch 419, loss: 1.2005, instance_loss: 0.6492, weighted_loss: 1.0351, label: 1, bag_size: 618
batch 439, loss: 0.9817, instance_loss: 0.5424, weighted_loss: 0.8499, label: 2, bag_size: 253
batch 459, loss: 0.1150, instance_loss: 0.3583, weighted_loss: 0.1880, label: 0, bag_size: 383
batch 479, loss: 1.9375, instance_loss: 0.5894, weighted_loss: 1.5330, label: 4, bag_size: 1031
batch 499, loss: 1.1405, instance_loss: 0.4162, weighted_loss: 0.9232, label: 2, bag_size: 861
batch 519, loss: 1.2662, instance_loss: 0.5072, weighted_loss: 1.0385, label: 1, bag_size: 614
batch 539, loss: 1.2630, instance_loss: 0.4938, weighted_loss: 1.0323, label: 1, bag_size: 390
batch 559, loss: 1.3220, instance_loss: 0.5111, weighted_loss: 1.0787, label: 3, bag_size: 556
batch 579, loss: 0.9129, instance_loss: 0.4835, weighted_loss: 0.7841, label: 2, bag_size: 614


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.034722222222222224: correct 165/4752
Epoch: 18, train_loss: 1.1661, train_clustering_loss:  0.4942, train_error: 0.5269
class 0: acc 0.7983870967741935, correct 99/124
class 1: acc 0.38016528925619836, correct 46/121
class 2: acc 0.3584905660377358, correct 38/106
class 3: acc 0.40476190476190477, correct 51/126
class 4: acc 0.4017094017094017, correct 47/117

Val Set, val_loss: 1.2654, val_error: 0.5270, auc: 0.7779
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8582, instance_loss: 0.5121, weighted_loss: 0.7544, label: 2, bag_size: 640
batch 39, loss: 1.5732, instance_loss: 0.5223, weighted_loss: 1.2580, label: 2, bag_size: 584
batch 59, loss: 1.5505, instance_loss: 0.4831, weighted_loss: 1.2303, label: 4, bag_size: 690
batch 79, loss: 1.7353, instance_loss: 0.5010, weighted_loss: 1.3650, label: 4, bag_size: 482
batch 99, loss: 1.0176, instance_loss: 0.4972, weighted_loss: 0.8615, label: 2, bag_size: 350
batch 119, loss: 1.1579, instance_loss: 0.5536, weighted_loss: 0.9766, label: 3, bag_size: 498
batch 139, loss: 0.4568, instance_loss: 0.5403, weighted_loss: 0.4818, label: 0, bag_size: 493
batch 159, loss: 0.0298, instance_loss: 0.3246, weighted_loss: 0.1183, label: 0, bag_size: 268
batch 179, loss: 1.0974, instance_loss: 0.5542, weighted_loss: 0.9345, label: 3, bag_size: 497
batch 199, loss: 0.6330, instance_loss: 0.4093, weighted_loss: 0.5659, label: 1, bag_size: 328
batch 219, loss: 2.0865, instance_loss: 0.5225, weighted_loss: 1.6173, label: 2, bag_size: 553
batch 239, loss: 1.0479, instance_loss: 0.5117, weighted_loss: 0.8871, label: 2, bag_size: 633
batch 259, loss: 0.7123, instance_loss: 0.5582, weighted_loss: 0.6661, label: 1, bag_size: 106
batch 279, loss: 0.9588, instance_loss: 0.5034, weighted_loss: 0.8222, label: 0, bag_size: 367
batch 299, loss: 0.0434, instance_loss: 0.3293, weighted_loss: 0.1292, label: 0, bag_size: 383
batch 319, loss: 2.7658, instance_loss: 0.6083, weighted_loss: 2.1186, label: 2, bag_size: 1074
batch 339, loss: 1.1402, instance_loss: 0.5167, weighted_loss: 0.9531, label: 2, bag_size: 754
batch 359, loss: 0.7696, instance_loss: 0.4026, weighted_loss: 0.6595, label: 3, bag_size: 344
batch 379, loss: 0.7039, instance_loss: 0.4775, weighted_loss: 0.6360, label: 3, bag_size: 194
batch 399, loss: 2.4344, instance_loss: 0.5746, weighted_loss: 1.8764, label: 2, bag_size: 713
batch 419, loss: 1.2955, instance_loss: 0.5574, weighted_loss: 1.0740, label: 1, bag_size: 892
batch 439, loss: 1.0278, instance_loss: 0.4455, weighted_loss: 0.8531, label: 1, bag_size: 371
batch 459, loss: 1.3226, instance_loss: 0.5006, weighted_loss: 1.0760, label: 2, bag_size: 522
batch 479, loss: 2.3317, instance_loss: 0.5980, weighted_loss: 1.8116, label: 4, bag_size: 293
batch 499, loss: 1.1924, instance_loss: 0.5453, weighted_loss: 0.9983, label: 3, bag_size: 1060
batch 519, loss: 3.5623, instance_loss: 0.6438, weighted_loss: 2.6868, label: 2, bag_size: 563
batch 539, loss: 0.0019, instance_loss: 0.4176, weighted_loss: 0.1266, label: 1, bag_size: 669
batch 559, loss: 2.2478, instance_loss: 0.6046, weighted_loss: 1.7548, label: 4, bag_size: 270
batch 579, loss: 0.4541, instance_loss: 0.4619, weighted_loss: 0.4564, label: 4, bag_size: 46


class 0 clustering acc 0.9985690235690236: correct 23726/23760
class 1 clustering acc 0.013888888888888888: correct 66/4752
Epoch: 19, train_loss: 1.1730, train_clustering_loss:  0.4959, train_error: 0.4848
class 0: acc 0.7909090909090909, correct 87/110
class 1: acc 0.5862068965517241, correct 85/145
class 2: acc 0.25217391304347825, correct 29/115
class 3: acc 0.47413793103448276, correct 55/116
class 4: acc 0.46296296296296297, correct 50/108

Val Set, val_loss: 1.2138, val_error: 0.5676, auc: 0.7899
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.223303 --> 1.213846).  Saving model ...


batch 19, loss: 0.0574, instance_loss: 0.2898, weighted_loss: 0.1271, label: 0, bag_size: 101
batch 39, loss: 1.2395, instance_loss: 0.4653, weighted_loss: 1.0072, label: 2, bag_size: 498
batch 59, loss: 0.0979, instance_loss: 0.4053, weighted_loss: 0.1901, label: 0, bag_size: 285
batch 79, loss: 0.0515, instance_loss: 0.3270, weighted_loss: 0.1341, label: 0, bag_size: 80
batch 99, loss: 1.7307, instance_loss: 0.4945, weighted_loss: 1.3598, label: 4, bag_size: 264
batch 119, loss: 0.8099, instance_loss: 0.5119, weighted_loss: 0.7205, label: 3, bag_size: 625
batch 139, loss: 0.0358, instance_loss: 0.2777, weighted_loss: 0.1084, label: 0, bag_size: 285
batch 159, loss: 2.7817, instance_loss: 0.6113, weighted_loss: 2.1306, label: 3, bag_size: 856
batch 179, loss: 1.2339, instance_loss: 0.4753, weighted_loss: 1.0063, label: 3, bag_size: 451
batch 199, loss: 0.1998, instance_loss: 0.4139, weighted_loss: 0.2640, label: 0, bag_size: 295
batch 219, loss: 3.1076, instance_loss: 0.6451, weighted_loss: 2.3689, label: 1, bag_size: 45
batch 239, loss: 2.3713, instance_loss: 0.6237, weighted_loss: 1.8470, label: 1, bag_size: 564
batch 259, loss: 1.2436, instance_loss: 0.5866, weighted_loss: 1.0465, label: 2, bag_size: 258
batch 279, loss: 0.7870, instance_loss: 0.3775, weighted_loss: 0.6641, label: 3, bag_size: 1154
batch 299, loss: 3.7925, instance_loss: 0.7281, weighted_loss: 2.8732, label: 2, bag_size: 606
batch 319, loss: 1.3242, instance_loss: 0.5473, weighted_loss: 1.0911, label: 1, bag_size: 159
batch 339, loss: 0.0648, instance_loss: 0.2845, weighted_loss: 0.1307, label: 4, bag_size: 394
batch 359, loss: 1.1051, instance_loss: 0.4843, weighted_loss: 0.9189, label: 2, bag_size: 731
batch 379, loss: 1.3899, instance_loss: 0.5439, weighted_loss: 1.1361, label: 1, bag_size: 372
batch 399, loss: 1.1513, instance_loss: 0.5220, weighted_loss: 0.9625, label: 3, bag_size: 472
batch 419, loss: 0.7738, instance_loss: 0.4637, weighted_loss: 0.6808, label: 0, bag_size: 493
batch 439, loss: 0.0467, instance_loss: 0.2103, weighted_loss: 0.0958, label: 4, bag_size: 773
batch 459, loss: 0.4671, instance_loss: 0.6496, weighted_loss: 0.5219, label: 0, bag_size: 317
batch 479, loss: 0.7900, instance_loss: 0.4122, weighted_loss: 0.6767, label: 3, bag_size: 472
batch 499, loss: 0.8669, instance_loss: 0.5411, weighted_loss: 0.7691, label: 4, bag_size: 1077
batch 519, loss: 1.0748, instance_loss: 0.5179, weighted_loss: 0.9077, label: 4, bag_size: 729
batch 539, loss: 0.9537, instance_loss: 0.5272, weighted_loss: 0.8258, label: 2, bag_size: 1066
batch 559, loss: 1.5003, instance_loss: 0.5555, weighted_loss: 1.2168, label: 1, bag_size: 159
batch 579, loss: 2.6217, instance_loss: 0.5941, weighted_loss: 2.0134, label: 1, bag_size: 875


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.026094276094276093: correct 124/4752
Epoch: 20, train_loss: 1.0833, train_clustering_loss:  0.4842, train_error: 0.4478
class 0: acc 0.8540145985401459, correct 117/137
class 1: acc 0.45454545454545453, correct 50/110
class 2: acc 0.2549019607843137, correct 26/102
class 3: acc 0.648854961832061, correct 85/131
class 4: acc 0.43859649122807015, correct 50/114

Val Set, val_loss: 1.1821, val_error: 0.5135, auc: 0.7999
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.213846 --> 1.182056).  Saving model ...


batch 19, loss: 0.8854, instance_loss: 0.4575, weighted_loss: 0.7570, label: 3, bag_size: 817
batch 39, loss: 1.8751, instance_loss: 0.5206, weighted_loss: 1.4688, label: 2, bag_size: 185
batch 59, loss: 1.2632, instance_loss: 0.4832, weighted_loss: 1.0292, label: 4, bag_size: 476
batch 79, loss: 2.3641, instance_loss: 0.6894, weighted_loss: 1.8617, label: 3, bag_size: 156
batch 99, loss: 0.9473, instance_loss: 0.4740, weighted_loss: 0.8053, label: 1, bag_size: 1360
batch 119, loss: 0.4223, instance_loss: 0.4710, weighted_loss: 0.4370, label: 0, bag_size: 122
batch 139, loss: 1.2760, instance_loss: 0.5066, weighted_loss: 1.0452, label: 2, bag_size: 554
batch 159, loss: 0.7115, instance_loss: 0.5817, weighted_loss: 0.6726, label: 4, bag_size: 541
batch 179, loss: 0.6690, instance_loss: 0.4699, weighted_loss: 0.6093, label: 3, bag_size: 1060
batch 199, loss: 0.4516, instance_loss: 0.4384, weighted_loss: 0.4476, label: 3, bag_size: 235
batch 219, loss: 1.6429, instance_loss: 0.5610, weighted_loss: 1.3184, label: 2, bag_size: 717
batch 239, loss: 1.2028, instance_loss: 0.5174, weighted_loss: 0.9972, label: 2, bag_size: 605
batch 259, loss: 1.1834, instance_loss: 0.4876, weighted_loss: 0.9746, label: 4, bag_size: 233
batch 279, loss: 1.7733, instance_loss: 0.5247, weighted_loss: 1.3987, label: 3, bag_size: 192
batch 299, loss: 1.2267, instance_loss: 0.4653, weighted_loss: 0.9982, label: 4, bag_size: 233
batch 319, loss: 0.1754, instance_loss: 0.3592, weighted_loss: 0.2306, label: 0, bag_size: 552
batch 339, loss: 0.0030, instance_loss: 0.3720, weighted_loss: 0.1137, label: 0, bag_size: 428
batch 359, loss: 3.0324, instance_loss: 0.7458, weighted_loss: 2.3464, label: 0, bag_size: 888
batch 379, loss: 0.9669, instance_loss: 0.5129, weighted_loss: 0.8307, label: 3, bag_size: 663
batch 399, loss: 0.7298, instance_loss: 0.4088, weighted_loss: 0.6335, label: 3, bag_size: 245
batch 419, loss: 0.0136, instance_loss: 0.4259, weighted_loss: 0.1373, label: 4, bag_size: 541
batch 439, loss: 0.5918, instance_loss: 0.4185, weighted_loss: 0.5398, label: 3, bag_size: 684
batch 459, loss: 0.0778, instance_loss: 0.3408, weighted_loss: 0.1567, label: 0, bag_size: 71
batch 479, loss: 0.7178, instance_loss: 0.4084, weighted_loss: 0.6250, label: 2, bag_size: 371
batch 499, loss: 0.8763, instance_loss: 0.4739, weighted_loss: 0.7555, label: 1, bag_size: 1273
batch 519, loss: 0.8531, instance_loss: 0.4320, weighted_loss: 0.7268, label: 1, bag_size: 1019
batch 539, loss: 1.0675, instance_loss: 0.4578, weighted_loss: 0.8846, label: 1, bag_size: 1043
batch 559, loss: 0.9472, instance_loss: 0.4377, weighted_loss: 0.7944, label: 1, bag_size: 1023
batch 579, loss: 0.6629, instance_loss: 0.4787, weighted_loss: 0.6077, label: 3, bag_size: 498


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.02462121212121212: correct 117/4752
Epoch: 21, train_loss: 1.1034, train_clustering_loss:  0.4893, train_error: 0.4731
class 0: acc 0.8429752066115702, correct 102/121
class 1: acc 0.3391304347826087, correct 39/115
class 2: acc 0.40625, correct 52/128
class 3: acc 0.5789473684210527, correct 66/114
class 4: acc 0.46551724137931033, correct 54/116

Val Set, val_loss: 1.1925, val_error: 0.5135, auc: 0.7867
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4140, instance_loss: 0.5127, weighted_loss: 1.1436, label: 3, bag_size: 393
batch 39, loss: 1.7074, instance_loss: 0.5314, weighted_loss: 1.3546, label: 1, bag_size: 697
batch 59, loss: 0.8578, instance_loss: 0.4549, weighted_loss: 0.7369, label: 1, bag_size: 328
batch 79, loss: 2.6923, instance_loss: 0.5888, weighted_loss: 2.0613, label: 2, bag_size: 340
batch 99, loss: 1.3698, instance_loss: 0.4809, weighted_loss: 1.1031, label: 3, bag_size: 149
batch 119, loss: 2.3608, instance_loss: 0.5987, weighted_loss: 1.8322, label: 3, bag_size: 282
batch 139, loss: 1.4273, instance_loss: 0.4895, weighted_loss: 1.1460, label: 1, bag_size: 658
batch 159, loss: 2.1123, instance_loss: 0.4827, weighted_loss: 1.6234, label: 1, bag_size: 599
batch 179, loss: 1.8374, instance_loss: 0.6146, weighted_loss: 1.4705, label: 4, bag_size: 1041
batch 199, loss: 2.6536, instance_loss: 0.6457, weighted_loss: 2.0512, label: 2, bag_size: 629
batch 219, loss: 0.4300, instance_loss: 0.4523, weighted_loss: 0.4366, label: 4, bag_size: 394
batch 239, loss: 0.2211, instance_loss: 0.5304, weighted_loss: 0.3139, label: 4, bag_size: 409
batch 259, loss: 0.9251, instance_loss: 0.4767, weighted_loss: 0.7906, label: 2, bag_size: 385
batch 279, loss: 1.8465, instance_loss: 0.6211, weighted_loss: 1.4788, label: 3, bag_size: 459
batch 299, loss: 1.1408, instance_loss: 0.4404, weighted_loss: 0.9307, label: 3, bag_size: 641
batch 319, loss: 1.5419, instance_loss: 0.6338, weighted_loss: 1.2695, label: 2, bag_size: 258
batch 339, loss: 1.0758, instance_loss: 0.4787, weighted_loss: 0.8966, label: 1, bag_size: 1121
batch 359, loss: 1.1108, instance_loss: 0.4656, weighted_loss: 0.9173, label: 1, bag_size: 201
batch 379, loss: 1.3486, instance_loss: 0.4502, weighted_loss: 1.0791, label: 2, bag_size: 549
batch 399, loss: 0.7983, instance_loss: 0.4835, weighted_loss: 0.7038, label: 2, bag_size: 385
batch 419, loss: 0.8513, instance_loss: 0.4426, weighted_loss: 0.7287, label: 0, bag_size: 81
batch 439, loss: 0.8789, instance_loss: 0.4983, weighted_loss: 0.7647, label: 3, bag_size: 274
batch 459, loss: 1.1707, instance_loss: 0.4807, weighted_loss: 0.9637, label: 1, bag_size: 1013
batch 479, loss: 0.6096, instance_loss: 0.4728, weighted_loss: 0.5686, label: 3, bag_size: 858
batch 499, loss: 0.0125, instance_loss: 0.2492, weighted_loss: 0.0835, label: 0, bag_size: 133
batch 519, loss: 1.1862, instance_loss: 0.4629, weighted_loss: 0.9693, label: 4, bag_size: 690
batch 539, loss: 5.0651, instance_loss: 0.8758, weighted_loss: 3.8083, label: 3, bag_size: 795
batch 559, loss: 1.4248, instance_loss: 0.5086, weighted_loss: 1.1499, label: 2, bag_size: 171
batch 579, loss: 1.8537, instance_loss: 0.5408, weighted_loss: 1.4598, label: 4, bag_size: 771


class 0 clustering acc 0.997895622895623: correct 23710/23760
class 1 clustering acc 0.02356902356902357: correct 112/4752
Epoch: 22, train_loss: 1.1406, train_clustering_loss:  0.4943, train_error: 0.4697
class 0: acc 0.768595041322314, correct 93/121
class 1: acc 0.4496124031007752, correct 58/129
class 2: acc 0.43333333333333335, correct 52/120
class 3: acc 0.49137931034482757, correct 57/116
class 4: acc 0.5092592592592593, correct 55/108

Val Set, val_loss: 1.2429, val_error: 0.5135, auc: 0.7919
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9421, instance_loss: 0.5353, weighted_loss: 0.8201, label: 2, bag_size: 385
batch 39, loss: 0.7649, instance_loss: 0.3455, weighted_loss: 0.6391, label: 3, bag_size: 309
batch 59, loss: 0.6529, instance_loss: 0.4487, weighted_loss: 0.5916, label: 1, bag_size: 925
batch 79, loss: 3.0692, instance_loss: 0.6761, weighted_loss: 2.3513, label: 2, bag_size: 606
batch 99, loss: 0.7410, instance_loss: 0.4652, weighted_loss: 0.6582, label: 4, bag_size: 419
batch 119, loss: 0.1361, instance_loss: 0.5399, weighted_loss: 0.2572, label: 0, bag_size: 477
batch 139, loss: 1.6089, instance_loss: 0.5603, weighted_loss: 1.2943, label: 3, bag_size: 499
batch 159, loss: 0.2671, instance_loss: 0.3292, weighted_loss: 0.2857, label: 0, bag_size: 527
batch 179, loss: 1.2644, instance_loss: 0.4779, weighted_loss: 1.0285, label: 3, bag_size: 258
batch 199, loss: 2.4791, instance_loss: 0.5598, weighted_loss: 1.9033, label: 2, bag_size: 861
batch 219, loss: 0.2462, instance_loss: 0.5129, weighted_loss: 0.3262, label: 0, bag_size: 517
batch 239, loss: 1.1145, instance_loss: 0.4567, weighted_loss: 0.9172, label: 4, bag_size: 729
batch 259, loss: 0.5685, instance_loss: 0.4868, weighted_loss: 0.5440, label: 2, bag_size: 171
batch 279, loss: 2.7318, instance_loss: 0.6065, weighted_loss: 2.0942, label: 2, bag_size: 629
batch 299, loss: 1.4440, instance_loss: 0.5384, weighted_loss: 1.1723, label: 1, bag_size: 419
batch 319, loss: 0.4408, instance_loss: 0.4679, weighted_loss: 0.4489, label: 4, bag_size: 1018
batch 339, loss: 1.1037, instance_loss: 0.5147, weighted_loss: 0.9270, label: 4, bag_size: 204
batch 359, loss: 2.2613, instance_loss: 0.5803, weighted_loss: 1.7570, label: 4, bag_size: 101
batch 379, loss: 0.4659, instance_loss: 0.4219, weighted_loss: 0.4527, label: 0, bag_size: 192
batch 399, loss: 0.8094, instance_loss: 0.4999, weighted_loss: 0.7166, label: 1, bag_size: 599
batch 419, loss: 0.9789, instance_loss: 0.4527, weighted_loss: 0.8211, label: 3, bag_size: 556
batch 439, loss: 0.0738, instance_loss: 0.3815, weighted_loss: 0.1661, label: 0, bag_size: 397
batch 459, loss: 0.7439, instance_loss: 0.5388, weighted_loss: 0.6823, label: 2, bag_size: 208
batch 479, loss: 1.1100, instance_loss: 0.4642, weighted_loss: 0.9162, label: 1, bag_size: 599
batch 499, loss: 2.5580, instance_loss: 0.5231, weighted_loss: 1.9475, label: 2, bag_size: 861
batch 519, loss: 1.0874, instance_loss: 0.4570, weighted_loss: 0.8983, label: 1, bag_size: 1043
batch 539, loss: 1.4477, instance_loss: 0.6260, weighted_loss: 1.2012, label: 0, bag_size: 311
batch 559, loss: 0.6707, instance_loss: 0.4826, weighted_loss: 0.6143, label: 3, bag_size: 727
batch 579, loss: 0.6144, instance_loss: 0.4425, weighted_loss: 0.5629, label: 1, bag_size: 371


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.02441077441077441: correct 116/4752
Epoch: 23, train_loss: 1.1351, train_clustering_loss:  0.4917, train_error: 0.4512
class 0: acc 0.8333333333333334, correct 95/114
class 1: acc 0.5934959349593496, correct 73/123
class 2: acc 0.36666666666666664, correct 44/120
class 3: acc 0.5114503816793893, correct 67/131
class 4: acc 0.44339622641509435, correct 47/106

Val Set, val_loss: 1.2801, val_error: 0.5676, auc: 0.7897
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7435, instance_loss: 0.4664, weighted_loss: 0.6604, label: 3, bag_size: 818
batch 39, loss: 0.5804, instance_loss: 0.5272, weighted_loss: 0.5644, label: 4, bag_size: 627
batch 59, loss: 0.7645, instance_loss: 0.5458, weighted_loss: 0.6989, label: 2, bag_size: 96
batch 79, loss: 1.0651, instance_loss: 0.5416, weighted_loss: 0.9080, label: 2, bag_size: 998
batch 99, loss: 0.8062, instance_loss: 0.4813, weighted_loss: 0.7087, label: 3, bag_size: 102
batch 119, loss: 0.5209, instance_loss: 0.4301, weighted_loss: 0.4937, label: 1, bag_size: 460
batch 139, loss: 1.6509, instance_loss: 0.5276, weighted_loss: 1.3139, label: 3, bag_size: 476
batch 159, loss: 1.2750, instance_loss: 0.4904, weighted_loss: 1.0396, label: 4, bag_size: 482
batch 179, loss: 0.6860, instance_loss: 0.4545, weighted_loss: 0.6166, label: 2, bag_size: 754
batch 199, loss: 2.2202, instance_loss: 0.5041, weighted_loss: 1.7054, label: 1, bag_size: 339
batch 219, loss: 1.2977, instance_loss: 0.5446, weighted_loss: 1.0718, label: 3, bag_size: 1021
batch 239, loss: 0.7992, instance_loss: 0.5309, weighted_loss: 0.7187, label: 2, bag_size: 286
batch 259, loss: 0.0046, instance_loss: 0.2310, weighted_loss: 0.0725, label: 0, bag_size: 80
batch 279, loss: 1.2647, instance_loss: 0.5544, weighted_loss: 1.0516, label: 3, bag_size: 505
batch 299, loss: 0.2712, instance_loss: 0.4722, weighted_loss: 0.3315, label: 0, bag_size: 642
batch 319, loss: 1.2391, instance_loss: 0.4826, weighted_loss: 1.0122, label: 4, bag_size: 419
batch 339, loss: 0.7799, instance_loss: 0.4280, weighted_loss: 0.6743, label: 1, bag_size: 328
batch 359, loss: 0.7026, instance_loss: 0.4367, weighted_loss: 0.6229, label: 3, bag_size: 473
batch 379, loss: 0.5570, instance_loss: 0.4059, weighted_loss: 0.5117, label: 3, bag_size: 459
batch 399, loss: 1.2393, instance_loss: 0.5106, weighted_loss: 1.0207, label: 4, bag_size: 476
batch 419, loss: 1.0240, instance_loss: 0.5366, weighted_loss: 0.8778, label: 2, bag_size: 135
batch 439, loss: 1.1442, instance_loss: 0.5039, weighted_loss: 0.9521, label: 1, bag_size: 389
batch 459, loss: 0.4519, instance_loss: 0.8586, weighted_loss: 0.5739, label: 4, bag_size: 773
batch 479, loss: 1.4880, instance_loss: 0.4654, weighted_loss: 1.1812, label: 1, bag_size: 617
batch 499, loss: 0.3775, instance_loss: 0.2874, weighted_loss: 0.3505, label: 4, bag_size: 266
batch 519, loss: 1.3741, instance_loss: 0.4969, weighted_loss: 1.1109, label: 3, bag_size: 899
batch 539, loss: 0.0539, instance_loss: 0.2881, weighted_loss: 0.1241, label: 0, bag_size: 212
batch 559, loss: 0.5764, instance_loss: 0.4355, weighted_loss: 0.5342, label: 0, bag_size: 277
batch 579, loss: 0.8158, instance_loss: 0.4955, weighted_loss: 0.7197, label: 2, bag_size: 684


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.024831649831649833: correct 118/4752
Epoch: 24, train_loss: 1.1312, train_clustering_loss:  0.4933, train_error: 0.4983
class 0: acc 0.7265625, correct 93/128
class 1: acc 0.39316239316239315, correct 46/117
class 2: acc 0.4036697247706422, correct 44/109
class 3: acc 0.5, correct 57/114
class 4: acc 0.4603174603174603, correct 58/126

Val Set, val_loss: 1.2281, val_error: 0.5676, auc: 0.7975
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1889, instance_loss: 0.4131, weighted_loss: 0.2562, label: 0, bag_size: 74
batch 39, loss: 0.8769, instance_loss: 0.4499, weighted_loss: 0.7488, label: 4, bag_size: 687
batch 59, loss: 1.5545, instance_loss: 0.5000, weighted_loss: 1.2382, label: 1, bag_size: 742
batch 79, loss: 1.6812, instance_loss: 0.5241, weighted_loss: 1.3341, label: 2, bag_size: 318
batch 99, loss: 0.7171, instance_loss: 0.4710, weighted_loss: 0.6433, label: 3, bag_size: 944
batch 119, loss: 0.6643, instance_loss: 0.4347, weighted_loss: 0.5954, label: 3, bag_size: 194
batch 139, loss: 0.3281, instance_loss: 0.4156, weighted_loss: 0.3543, label: 0, bag_size: 192
batch 159, loss: 0.6537, instance_loss: 0.4380, weighted_loss: 0.5890, label: 3, bag_size: 457
batch 179, loss: 0.7495, instance_loss: 0.4415, weighted_loss: 0.6571, label: 3, bag_size: 351
batch 199, loss: 2.1014, instance_loss: 0.5863, weighted_loss: 1.6469, label: 4, bag_size: 333
batch 219, loss: 1.5485, instance_loss: 0.5079, weighted_loss: 1.2363, label: 1, bag_size: 390
batch 239, loss: 0.8852, instance_loss: 0.4928, weighted_loss: 0.7675, label: 0, bag_size: 81
batch 259, loss: 0.1489, instance_loss: 0.2667, weighted_loss: 0.1842, label: 0, bag_size: 397
batch 279, loss: 1.2341, instance_loss: 0.4355, weighted_loss: 0.9945, label: 4, bag_size: 482
batch 299, loss: 1.1770, instance_loss: 0.4969, weighted_loss: 0.9730, label: 3, bag_size: 120
batch 319, loss: 1.5942, instance_loss: 0.5477, weighted_loss: 1.2802, label: 1, bag_size: 159
batch 339, loss: 0.4441, instance_loss: 0.4213, weighted_loss: 0.4373, label: 2, bag_size: 614
batch 359, loss: 0.0363, instance_loss: 0.3319, weighted_loss: 0.1250, label: 0, bag_size: 251
batch 379, loss: 1.5283, instance_loss: 0.5192, weighted_loss: 1.2256, label: 1, bag_size: 159
batch 399, loss: 0.8565, instance_loss: 0.4550, weighted_loss: 0.7361, label: 1, bag_size: 972
batch 419, loss: 0.0483, instance_loss: 0.2247, weighted_loss: 0.1012, label: 4, bag_size: 773
batch 439, loss: 2.0688, instance_loss: 0.5519, weighted_loss: 1.6138, label: 4, bag_size: 771
batch 459, loss: 0.7569, instance_loss: 0.4504, weighted_loss: 0.6649, label: 1, bag_size: 855
batch 479, loss: 1.2017, instance_loss: 0.5684, weighted_loss: 1.0117, label: 3, bag_size: 1147
batch 499, loss: 0.9782, instance_loss: 0.4766, weighted_loss: 0.8277, label: 3, bag_size: 556
batch 519, loss: 1.5016, instance_loss: 0.6706, weighted_loss: 1.2523, label: 3, bag_size: 282
batch 539, loss: 0.2254, instance_loss: 0.5358, weighted_loss: 0.3185, label: 0, bag_size: 552
batch 559, loss: 0.4492, instance_loss: 0.3675, weighted_loss: 0.4247, label: 3, bag_size: 684
batch 579, loss: 0.8241, instance_loss: 0.4984, weighted_loss: 0.7264, label: 3, bag_size: 498


class 0 clustering acc 0.9981060606060606: correct 23715/23760
class 1 clustering acc 0.01893939393939394: correct 90/4752
Epoch: 25, train_loss: 1.1147, train_clustering_loss:  0.4915, train_error: 0.4663
class 0: acc 0.8527131782945736, correct 110/129
class 1: acc 0.3644067796610169, correct 43/118
class 2: acc 0.3865546218487395, correct 46/119
class 3: acc 0.5213675213675214, correct 61/117
class 4: acc 0.5135135135135135, correct 57/111

Val Set, val_loss: 1.2941, val_error: 0.5405, auc: 0.7742
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0740, instance_loss: 0.4508, weighted_loss: 0.8870, label: 4, bag_size: 432
batch 39, loss: 0.0918, instance_loss: 0.3782, weighted_loss: 0.1777, label: 0, bag_size: 122
batch 59, loss: 0.0307, instance_loss: 0.4506, weighted_loss: 0.1567, label: 0, bag_size: 15
batch 79, loss: 1.1110, instance_loss: 0.4630, weighted_loss: 0.9166, label: 1, bag_size: 544
batch 99, loss: 0.9369, instance_loss: 0.4573, weighted_loss: 0.7931, label: 1, bag_size: 355
batch 119, loss: 0.8015, instance_loss: 0.4747, weighted_loss: 0.7035, label: 1, bag_size: 851
batch 139, loss: 0.1553, instance_loss: 0.4414, weighted_loss: 0.2411, label: 1, bag_size: 522
batch 159, loss: 0.9974, instance_loss: 0.4341, weighted_loss: 0.8284, label: 4, bag_size: 690
batch 179, loss: 0.0770, instance_loss: 0.3460, weighted_loss: 0.1577, label: 0, bag_size: 210
batch 199, loss: 0.8605, instance_loss: 0.4350, weighted_loss: 0.7328, label: 4, bag_size: 986
batch 219, loss: 1.6878, instance_loss: 0.6210, weighted_loss: 1.3678, label: 3, bag_size: 897
batch 239, loss: 1.7119, instance_loss: 0.5510, weighted_loss: 1.3636, label: 2, bag_size: 852
batch 259, loss: 2.5712, instance_loss: 0.5617, weighted_loss: 1.9684, label: 4, bag_size: 198
batch 279, loss: 0.1561, instance_loss: 0.3139, weighted_loss: 0.2034, label: 0, bag_size: 295
batch 299, loss: 0.6931, instance_loss: 0.4107, weighted_loss: 0.6084, label: 2, bag_size: 690
batch 319, loss: 1.0722, instance_loss: 0.5834, weighted_loss: 0.9256, label: 2, bag_size: 934
batch 339, loss: 0.6562, instance_loss: 0.4421, weighted_loss: 0.5920, label: 0, bag_size: 183
batch 359, loss: 1.4057, instance_loss: 0.5437, weighted_loss: 1.1471, label: 1, bag_size: 658
batch 379, loss: 0.4900, instance_loss: 0.4962, weighted_loss: 0.4919, label: 3, bag_size: 961
batch 399, loss: 0.8667, instance_loss: 0.4236, weighted_loss: 0.7338, label: 1, bag_size: 1103
batch 419, loss: 0.9890, instance_loss: 0.4493, weighted_loss: 0.8271, label: 1, bag_size: 865
batch 439, loss: 1.1312, instance_loss: 0.5046, weighted_loss: 0.9432, label: 0, bag_size: 615
batch 459, loss: 2.3604, instance_loss: 0.5439, weighted_loss: 1.8155, label: 3, bag_size: 166
batch 479, loss: 1.2437, instance_loss: 0.4360, weighted_loss: 1.0014, label: 2, bag_size: 448
batch 499, loss: 1.5930, instance_loss: 0.4610, weighted_loss: 1.2534, label: 2, bag_size: 706
batch 519, loss: 3.3368, instance_loss: 0.6225, weighted_loss: 2.5225, label: 3, bag_size: 1057
batch 539, loss: 2.7985, instance_loss: 0.7169, weighted_loss: 2.1740, label: 1, bag_size: 361
batch 559, loss: 1.8859, instance_loss: 0.7205, weighted_loss: 1.5363, label: 0, bag_size: 1414
batch 579, loss: 1.2443, instance_loss: 0.4438, weighted_loss: 1.0041, label: 1, bag_size: 634


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.026515151515151516: correct 126/4752
Epoch: 26, train_loss: 1.1125, train_clustering_loss:  0.4906, train_error: 0.4461
class 0: acc 0.864, correct 108/125
class 1: acc 0.5, correct 61/122
class 2: acc 0.34513274336283184, correct 39/113
class 3: acc 0.5528455284552846, correct 68/123
class 4: acc 0.4774774774774775, correct 53/111

Val Set, val_loss: 1.1912, val_error: 0.5270, auc: 0.7877
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9340, instance_loss: 0.4710, weighted_loss: 0.7951, label: 3, bag_size: 631
batch 39, loss: 0.5174, instance_loss: 0.3664, weighted_loss: 0.4721, label: 4, bag_size: 960
batch 59, loss: 1.1679, instance_loss: 0.5708, weighted_loss: 0.9888, label: 2, bag_size: 288
batch 79, loss: 0.5801, instance_loss: 0.3948, weighted_loss: 0.5245, label: 4, bag_size: 775
batch 99, loss: 1.0121, instance_loss: 0.5260, weighted_loss: 0.8662, label: 1, bag_size: 620
batch 119, loss: 0.3490, instance_loss: 0.5269, weighted_loss: 0.4024, label: 4, bag_size: 773
batch 139, loss: 3.3289, instance_loss: 0.8262, weighted_loss: 2.5781, label: 0, bag_size: 888
batch 159, loss: 3.5795, instance_loss: 0.7816, weighted_loss: 2.7401, label: 0, bag_size: 964
batch 179, loss: 1.1153, instance_loss: 0.4571, weighted_loss: 0.9178, label: 4, bag_size: 714
batch 199, loss: 0.6413, instance_loss: 0.5730, weighted_loss: 0.6208, label: 0, bag_size: 416
batch 219, loss: 0.9396, instance_loss: 0.4672, weighted_loss: 0.7979, label: 2, bag_size: 445
batch 239, loss: 0.9436, instance_loss: 0.5122, weighted_loss: 0.8141, label: 3, bag_size: 1007
batch 259, loss: 2.1145, instance_loss: 0.5551, weighted_loss: 1.6467, label: 3, bag_size: 282
batch 279, loss: 0.0312, instance_loss: 0.4654, weighted_loss: 0.1615, label: 4, bag_size: 530
batch 299, loss: 1.5664, instance_loss: 0.5867, weighted_loss: 1.2725, label: 4, bag_size: 342
batch 319, loss: 0.9306, instance_loss: 0.4326, weighted_loss: 0.7812, label: 4, bag_size: 419
batch 339, loss: 0.1655, instance_loss: 0.4020, weighted_loss: 0.2365, label: 0, bag_size: 613
batch 359, loss: 1.4224, instance_loss: 0.4957, weighted_loss: 1.1444, label: 1, bag_size: 634
batch 379, loss: 2.4433, instance_loss: 0.6934, weighted_loss: 1.9183, label: 0, bag_size: 311
batch 399, loss: 0.9211, instance_loss: 0.4830, weighted_loss: 0.7897, label: 0, bag_size: 183
batch 419, loss: 2.7189, instance_loss: 0.5490, weighted_loss: 2.0679, label: 2, bag_size: 340
batch 439, loss: 1.2260, instance_loss: 0.4844, weighted_loss: 1.0035, label: 3, bag_size: 492
batch 459, loss: 1.1889, instance_loss: 0.4691, weighted_loss: 0.9730, label: 1, bag_size: 823
batch 479, loss: 1.3674, instance_loss: 0.5353, weighted_loss: 1.1177, label: 1, bag_size: 161
batch 499, loss: 0.9742, instance_loss: 0.4616, weighted_loss: 0.8204, label: 3, bag_size: 309
batch 519, loss: 1.6124, instance_loss: 0.5825, weighted_loss: 1.3034, label: 0, bag_size: 587
batch 539, loss: 0.8667, instance_loss: 0.4485, weighted_loss: 0.7413, label: 3, bag_size: 344
batch 559, loss: 0.6976, instance_loss: 0.5052, weighted_loss: 0.6399, label: 1, bag_size: 814
batch 579, loss: 0.7935, instance_loss: 0.4584, weighted_loss: 0.6930, label: 3, bag_size: 245


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.041035353535353536: correct 195/4752
Epoch: 27, train_loss: 1.1584, train_clustering_loss:  0.4971, train_error: 0.5101
class 0: acc 0.7981651376146789, correct 87/109
class 1: acc 0.22330097087378642, correct 23/103
class 2: acc 0.4262295081967213, correct 52/122
class 3: acc 0.4883720930232558, correct 63/129
class 4: acc 0.5038167938931297, correct 66/131

Val Set, val_loss: 1.2414, val_error: 0.5000, auc: 0.7939
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.0945945945945946: correct 56/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.2123, instance_loss: 0.4492, weighted_loss: 0.9833, label: 3, bag_size: 615
batch 39, loss: 1.1561, instance_loss: 0.5171, weighted_loss: 0.9644, label: 2, bag_size: 906
batch 59, loss: 0.9301, instance_loss: 0.4444, weighted_loss: 0.7844, label: 1, bag_size: 398
batch 79, loss: 0.4873, instance_loss: 0.5537, weighted_loss: 0.5072, label: 4, bag_size: 1041
batch 99, loss: 0.7367, instance_loss: 0.5106, weighted_loss: 0.6688, label: 4, bag_size: 776
batch 119, loss: 0.9516, instance_loss: 0.4295, weighted_loss: 0.7950, label: 3, bag_size: 587
batch 139, loss: 0.9489, instance_loss: 0.4624, weighted_loss: 0.8029, label: 2, bag_size: 633
batch 159, loss: 1.2596, instance_loss: 0.4596, weighted_loss: 1.0196, label: 3, bag_size: 230
batch 179, loss: 0.0092, instance_loss: 0.3879, weighted_loss: 0.1228, label: 4, bag_size: 813
batch 199, loss: 0.7307, instance_loss: 0.4340, weighted_loss: 0.6417, label: 2, bag_size: 558
batch 219, loss: 0.0002, instance_loss: 0.4464, weighted_loss: 0.1341, label: 1, bag_size: 669
batch 239, loss: 0.7231, instance_loss: 0.5167, weighted_loss: 0.6612, label: 4, bag_size: 218
batch 259, loss: 1.4892, instance_loss: 0.5547, weighted_loss: 1.2089, label: 1, bag_size: 672
batch 279, loss: 0.6386, instance_loss: 0.4454, weighted_loss: 0.5807, label: 1, bag_size: 544
batch 299, loss: 1.4753, instance_loss: 0.5016, weighted_loss: 1.1832, label: 2, bag_size: 371
batch 319, loss: 1.3953, instance_loss: 0.4472, weighted_loss: 1.1108, label: 1, bag_size: 697
batch 339, loss: 0.8590, instance_loss: 0.4212, weighted_loss: 0.7277, label: 2, bag_size: 598
batch 359, loss: 0.3355, instance_loss: 0.4005, weighted_loss: 0.3550, label: 4, bag_size: 266
batch 379, loss: 0.0000, instance_loss: 0.4829, weighted_loss: 0.1449, label: 2, bag_size: 936
batch 399, loss: 1.7966, instance_loss: 0.6409, weighted_loss: 1.4499, label: 0, bag_size: 343
batch 419, loss: 0.6054, instance_loss: 0.3891, weighted_loss: 0.5405, label: 4, bag_size: 266
batch 439, loss: 1.6805, instance_loss: 0.6075, weighted_loss: 1.3586, label: 0, bag_size: 178
batch 459, loss: 0.9146, instance_loss: 0.4826, weighted_loss: 0.7850, label: 1, bag_size: 697
batch 479, loss: 0.5920, instance_loss: 0.4427, weighted_loss: 0.5472, label: 1, bag_size: 161
batch 499, loss: 0.7604, instance_loss: 0.5953, weighted_loss: 0.7109, label: 0, bag_size: 311
batch 519, loss: 0.5885, instance_loss: 0.4864, weighted_loss: 0.5579, label: 0, bag_size: 62
batch 539, loss: 1.7359, instance_loss: 0.5125, weighted_loss: 1.3689, label: 1, bag_size: 391
batch 559, loss: 0.9539, instance_loss: 0.4657, weighted_loss: 0.8074, label: 2, bag_size: 597
batch 579, loss: 1.1120, instance_loss: 0.4608, weighted_loss: 0.9167, label: 1, bag_size: 599


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.05808080808080808: correct 276/4752
Epoch: 28, train_loss: 1.1006, train_clustering_loss:  0.4897, train_error: 0.4882
class 0: acc 0.8062015503875969, correct 104/129
class 1: acc 0.515625, correct 66/128
class 2: acc 0.2631578947368421, correct 30/114
class 3: acc 0.42105263157894735, correct 48/114
class 4: acc 0.5137614678899083, correct 56/109

Val Set, val_loss: 1.2095, val_error: 0.5135, auc: 0.7929
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.060810810810810814: correct 36/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1688, instance_loss: 0.3481, weighted_loss: 0.2226, label: 0, bag_size: 366
batch 39, loss: 1.3670, instance_loss: 0.5882, weighted_loss: 1.1334, label: 0, bag_size: 1414
batch 59, loss: 0.2565, instance_loss: 0.3702, weighted_loss: 0.2906, label: 4, bag_size: 394
batch 79, loss: 2.4202, instance_loss: 0.4867, weighted_loss: 1.8401, label: 2, bag_size: 606
batch 99, loss: 0.8787, instance_loss: 0.4410, weighted_loss: 0.7474, label: 3, bag_size: 1147
batch 119, loss: 1.0238, instance_loss: 0.4080, weighted_loss: 0.8390, label: 3, bag_size: 192
batch 139, loss: 0.9174, instance_loss: 0.5370, weighted_loss: 0.8033, label: 4, bag_size: 960
batch 159, loss: 0.2627, instance_loss: 0.4516, weighted_loss: 0.3193, label: 4, bag_size: 948
batch 179, loss: 0.9132, instance_loss: 0.5347, weighted_loss: 0.7996, label: 1, bag_size: 389
batch 199, loss: 10.8756, instance_loss: 0.5914, weighted_loss: 7.7903, label: 3, bag_size: 403
batch 219, loss: 1.4675, instance_loss: 0.4952, weighted_loss: 1.1758, label: 3, bag_size: 489
batch 239, loss: 0.9861, instance_loss: 0.4526, weighted_loss: 0.8261, label: 4, bag_size: 731
batch 259, loss: 1.4029, instance_loss: 0.5700, weighted_loss: 1.1530, label: 2, bag_size: 288
batch 279, loss: 1.1961, instance_loss: 0.5161, weighted_loss: 0.9921, label: 3, bag_size: 817
batch 299, loss: 1.3788, instance_loss: 0.4886, weighted_loss: 1.1117, label: 3, bag_size: 499
batch 319, loss: 1.5878, instance_loss: 0.5381, weighted_loss: 1.2729, label: 2, bag_size: 640
batch 339, loss: 1.5436, instance_loss: 0.5277, weighted_loss: 1.2389, label: 1, bag_size: 372
batch 359, loss: 0.8177, instance_loss: 0.4584, weighted_loss: 0.7099, label: 2, bag_size: 613
batch 379, loss: 0.4288, instance_loss: 2.0379, weighted_loss: 0.9115, label: 0, bag_size: 1570
batch 399, loss: 1.2584, instance_loss: 0.4277, weighted_loss: 1.0092, label: 3, bag_size: 499
batch 419, loss: 0.8475, instance_loss: 0.5359, weighted_loss: 0.7540, label: 4, bag_size: 703
batch 439, loss: 1.6581, instance_loss: 0.5040, weighted_loss: 1.3119, label: 2, bag_size: 597
batch 459, loss: 1.7594, instance_loss: 0.4538, weighted_loss: 1.3677, label: 2, bag_size: 470
batch 479, loss: 0.4575, instance_loss: 0.3691, weighted_loss: 0.4310, label: 2, bag_size: 315
batch 499, loss: 0.0007, instance_loss: 0.3806, weighted_loss: 0.1147, label: 4, bag_size: 813
batch 519, loss: 0.0354, instance_loss: 0.2665, weighted_loss: 0.1047, label: 0, bag_size: 51
batch 539, loss: 3.1248, instance_loss: 0.6866, weighted_loss: 2.3933, label: 3, bag_size: 638
batch 559, loss: 1.8298, instance_loss: 0.5175, weighted_loss: 1.4362, label: 1, bag_size: 201
batch 579, loss: 1.7959, instance_loss: 0.5387, weighted_loss: 1.4188, label: 2, bag_size: 361


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.030723905723905723: correct 146/4752
Epoch: 29, train_loss: 1.0958, train_clustering_loss:  0.4885, train_error: 0.4411
class 0: acc 0.8188976377952756, correct 104/127
class 1: acc 0.330188679245283, correct 35/106
class 2: acc 0.42342342342342343, correct 47/111
class 3: acc 0.5984848484848485, correct 79/132
class 4: acc 0.5677966101694916, correct 67/118

Val Set, val_loss: 1.3188, val_error: 0.4865, auc: 0.7860
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.04054054054054054: correct 24/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.2017, instance_loss: 0.4847, weighted_loss: 1.6866, label: 4, bag_size: 333
batch 39, loss: 1.1091, instance_loss: 0.5305, weighted_loss: 0.9355, label: 0, bag_size: 613
batch 59, loss: 0.4182, instance_loss: 0.3887, weighted_loss: 0.4093, label: 2, bag_size: 558
batch 79, loss: 0.9301, instance_loss: 0.4672, weighted_loss: 0.7912, label: 0, bag_size: 317
batch 99, loss: 0.3587, instance_loss: 0.4289, weighted_loss: 0.3798, label: 4, bag_size: 124
batch 119, loss: 0.5878, instance_loss: 0.4606, weighted_loss: 0.5496, label: 2, bag_size: 731
batch 139, loss: 0.4117, instance_loss: 0.3839, weighted_loss: 0.4034, label: 2, bag_size: 754
batch 159, loss: 0.2009, instance_loss: 0.4182, weighted_loss: 0.2661, label: 0, bag_size: 49
batch 179, loss: 1.3596, instance_loss: 0.5004, weighted_loss: 1.1018, label: 1, bag_size: 1043
batch 199, loss: 1.9580, instance_loss: 0.6094, weighted_loss: 1.5534, label: 2, bag_size: 498
batch 219, loss: 0.0833, instance_loss: 0.2781, weighted_loss: 0.1417, label: 0, bag_size: 234
batch 239, loss: 0.1116, instance_loss: 0.3153, weighted_loss: 0.1727, label: 0, bag_size: 70
batch 259, loss: 1.2360, instance_loss: 0.4456, weighted_loss: 0.9989, label: 4, bag_size: 246
batch 279, loss: 1.3318, instance_loss: 0.5857, weighted_loss: 1.1079, label: 3, bag_size: 556
batch 299, loss: 1.1446, instance_loss: 0.5707, weighted_loss: 0.9724, label: 2, bag_size: 605
batch 319, loss: 1.0229, instance_loss: 0.5262, weighted_loss: 0.8739, label: 3, bag_size: 615
batch 339, loss: 3.1794, instance_loss: 0.7761, weighted_loss: 2.4584, label: 1, bag_size: 184
batch 359, loss: 2.0139, instance_loss: 0.5481, weighted_loss: 1.5741, label: 3, bag_size: 523
batch 379, loss: 1.4937, instance_loss: 0.6406, weighted_loss: 1.2378, label: 0, bag_size: 247
batch 399, loss: 0.3799, instance_loss: 0.4187, weighted_loss: 0.3916, label: 4, bag_size: 1018
batch 419, loss: 0.7383, instance_loss: 0.4972, weighted_loss: 0.6660, label: 0, bag_size: 615
batch 439, loss: 1.1287, instance_loss: 0.4359, weighted_loss: 0.9209, label: 4, bag_size: 110
batch 459, loss: 1.9885, instance_loss: 0.5313, weighted_loss: 1.5513, label: 1, bag_size: 391
batch 479, loss: 0.7012, instance_loss: 0.4848, weighted_loss: 0.6363, label: 1, bag_size: 141
batch 499, loss: 0.5216, instance_loss: 0.4607, weighted_loss: 0.5033, label: 4, bag_size: 1077
batch 519, loss: 5.5269, instance_loss: 0.9820, weighted_loss: 4.1634, label: 2, bag_size: 340
batch 539, loss: 0.9989, instance_loss: 0.5331, weighted_loss: 0.8592, label: 3, bag_size: 857
batch 559, loss: 0.8202, instance_loss: 0.4733, weighted_loss: 0.7161, label: 1, bag_size: 1121
batch 579, loss: 0.7059, instance_loss: 0.5700, weighted_loss: 0.6651, label: 1, bag_size: 311


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.046296296296296294: correct 220/4752
Epoch: 30, train_loss: 1.0778, train_clustering_loss:  0.4882, train_error: 0.4327
class 0: acc 0.8770491803278688, correct 107/122
class 1: acc 0.47413793103448276, correct 55/116
class 2: acc 0.37894736842105264, correct 36/95
class 3: acc 0.4523809523809524, correct 57/126
class 4: acc 0.6074074074074074, correct 82/135

Val Set, val_loss: 1.3391, val_error: 0.5270, auc: 0.7770
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.03885135135135135: correct 23/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 2.1740, instance_loss: 0.7163, weighted_loss: 1.7367, label: 2, bag_size: 934
batch 39, loss: 0.6575, instance_loss: 0.4940, weighted_loss: 0.6085, label: 4, bag_size: 685
batch 59, loss: 4.3973, instance_loss: 0.6170, weighted_loss: 3.2632, label: 0, bag_size: 214
batch 79, loss: 0.7659, instance_loss: 0.4783, weighted_loss: 0.6796, label: 3, bag_size: 1001
batch 99, loss: 2.1064, instance_loss: 0.5666, weighted_loss: 1.6445, label: 2, bag_size: 909
batch 119, loss: 1.5446, instance_loss: 0.5005, weighted_loss: 1.2314, label: 2, bag_size: 321
batch 139, loss: 0.6425, instance_loss: 0.4619, weighted_loss: 0.5883, label: 4, bag_size: 377
batch 159, loss: 0.7644, instance_loss: 0.5581, weighted_loss: 0.7025, label: 0, bag_size: 143
batch 179, loss: 0.0143, instance_loss: 0.2739, weighted_loss: 0.0922, label: 0, bag_size: 97
batch 199, loss: 0.0822, instance_loss: 0.3301, weighted_loss: 0.1566, label: 0, bag_size: 455
batch 219, loss: 1.1278, instance_loss: 0.5264, weighted_loss: 0.9474, label: 1, bag_size: 886
batch 239, loss: 1.7908, instance_loss: 0.5912, weighted_loss: 1.4309, label: 2, bag_size: 185
batch 259, loss: 0.6623, instance_loss: 0.4140, weighted_loss: 0.5878, label: 2, bag_size: 754
batch 279, loss: 1.2387, instance_loss: 0.5386, weighted_loss: 1.0286, label: 4, bag_size: 944
batch 299, loss: 1.8435, instance_loss: 0.5469, weighted_loss: 1.4545, label: 0, bag_size: 305
batch 319, loss: 1.9520, instance_loss: 0.5436, weighted_loss: 1.5295, label: 1, bag_size: 350
batch 339, loss: 1.3941, instance_loss: 0.6006, weighted_loss: 1.1560, label: 2, bag_size: 303
batch 359, loss: 0.9053, instance_loss: 0.3974, weighted_loss: 0.7529, label: 1, bag_size: 329
batch 379, loss: 1.6810, instance_loss: 0.5665, weighted_loss: 1.3467, label: 2, bag_size: 390
batch 399, loss: 0.0947, instance_loss: 0.2944, weighted_loss: 0.1546, label: 0, bag_size: 97
batch 419, loss: 1.2216, instance_loss: 0.5377, weighted_loss: 1.0164, label: 2, bag_size: 498
batch 439, loss: 1.1604, instance_loss: 0.4494, weighted_loss: 0.9471, label: 1, bag_size: 1043
batch 459, loss: 0.6335, instance_loss: 0.4114, weighted_loss: 0.5669, label: 1, bag_size: 814
batch 479, loss: 0.3435, instance_loss: 0.6522, weighted_loss: 0.4361, label: 4, bag_size: 923
batch 499, loss: 1.1160, instance_loss: 0.5840, weighted_loss: 0.9564, label: 3, bag_size: 192
batch 519, loss: 0.8009, instance_loss: 0.4710, weighted_loss: 0.7019, label: 3, bag_size: 344
batch 539, loss: 1.6792, instance_loss: 0.5228, weighted_loss: 1.3323, label: 2, bag_size: 380
batch 559, loss: 0.7636, instance_loss: 0.4386, weighted_loss: 0.6661, label: 1, bag_size: 1273
batch 579, loss: 1.8209, instance_loss: 0.5038, weighted_loss: 1.4257, label: 2, bag_size: 754


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.022095959595959596: correct 105/4752
Epoch: 31, train_loss: 1.1265, train_clustering_loss:  0.4938, train_error: 0.4478
class 0: acc 0.7739130434782608, correct 89/115
class 1: acc 0.5144927536231884, correct 71/138
class 2: acc 0.30701754385964913, correct 35/114
class 3: acc 0.5094339622641509, correct 54/106
class 4: acc 0.6528925619834711, correct 79/121

Val Set, val_loss: 1.2564, val_error: 0.5135, auc: 0.7950
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0177, instance_loss: 0.4133, weighted_loss: 0.1364, label: 0, bag_size: 340
batch 39, loss: 1.3589, instance_loss: 0.5678, weighted_loss: 1.1216, label: 3, bag_size: 897
batch 59, loss: 0.1317, instance_loss: 0.4763, weighted_loss: 0.2351, label: 0, bag_size: 477
batch 79, loss: 2.2295, instance_loss: 0.5320, weighted_loss: 1.7202, label: 2, bag_size: 512
batch 99, loss: 2.0168, instance_loss: 0.4941, weighted_loss: 1.5600, label: 2, bag_size: 1092
batch 119, loss: 1.6517, instance_loss: 0.6041, weighted_loss: 1.3374, label: 2, bag_size: 934
batch 139, loss: 0.2397, instance_loss: 0.3768, weighted_loss: 0.2808, label: 1, bag_size: 886
batch 159, loss: 2.1652, instance_loss: 0.5964, weighted_loss: 1.6946, label: 4, bag_size: 312
batch 179, loss: 1.8182, instance_loss: 0.6050, weighted_loss: 1.4542, label: 4, bag_size: 468
batch 199, loss: 0.1547, instance_loss: 0.3675, weighted_loss: 0.2185, label: 0, bag_size: 79
batch 219, loss: 0.7862, instance_loss: 0.5833, weighted_loss: 0.7253, label: 3, bag_size: 794
batch 239, loss: 1.6920, instance_loss: 0.5697, weighted_loss: 1.3553, label: 1, bag_size: 564
batch 259, loss: 0.7984, instance_loss: 0.4886, weighted_loss: 0.7054, label: 2, bag_size: 702
batch 279, loss: 1.2083, instance_loss: 0.5065, weighted_loss: 0.9978, label: 3, bag_size: 364
batch 299, loss: 1.1109, instance_loss: 0.5164, weighted_loss: 0.9326, label: 4, bag_size: 476
batch 319, loss: 0.0169, instance_loss: 0.2763, weighted_loss: 0.0947, label: 0, bag_size: 285
batch 339, loss: 2.2266, instance_loss: 0.5092, weighted_loss: 1.7114, label: 3, bag_size: 508
batch 359, loss: 4.2544, instance_loss: 0.7182, weighted_loss: 3.1935, label: 0, bag_size: 600
batch 379, loss: 0.8221, instance_loss: 0.4477, weighted_loss: 0.7098, label: 1, bag_size: 1360
batch 399, loss: 0.8420, instance_loss: 0.4244, weighted_loss: 0.7167, label: 3, bag_size: 97
batch 419, loss: 0.0000, instance_loss: 0.3721, weighted_loss: 0.1116, label: 2, bag_size: 953
batch 439, loss: 0.5671, instance_loss: 0.4626, weighted_loss: 0.5357, label: 3, bag_size: 309
batch 459, loss: 0.9864, instance_loss: 0.4837, weighted_loss: 0.8356, label: 2, bag_size: 1230
batch 479, loss: 2.2398, instance_loss: 0.5732, weighted_loss: 1.7398, label: 2, bag_size: 297
batch 499, loss: 0.3339, instance_loss: 0.3831, weighted_loss: 0.3487, label: 0, bag_size: 306
batch 519, loss: 1.1222, instance_loss: 0.5070, weighted_loss: 0.9376, label: 3, bag_size: 818
batch 539, loss: 0.7145, instance_loss: 0.4875, weighted_loss: 0.6464, label: 3, bag_size: 818
batch 559, loss: 0.7864, instance_loss: 0.4197, weighted_loss: 0.6764, label: 4, bag_size: 218
batch 579, loss: 0.8887, instance_loss: 0.3584, weighted_loss: 0.7296, label: 4, bag_size: 482


class 0 clustering acc 0.9981060606060606: correct 23715/23760
class 1 clustering acc 0.0242003367003367: correct 115/4752
Epoch: 32, train_loss: 1.1004, train_clustering_loss:  0.4936, train_error: 0.4630
class 0: acc 0.7948717948717948, correct 93/117
class 1: acc 0.4672131147540984, correct 57/122
class 2: acc 0.3739130434782609, correct 43/115
class 3: acc 0.4789915966386555, correct 57/119
class 4: acc 0.5702479338842975, correct 69/121

Val Set, val_loss: 1.3137, val_error: 0.5270, auc: 0.7854
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.6858, instance_loss: 0.5326, weighted_loss: 1.3399, label: 2, bag_size: 553
batch 39, loss: 0.0000, instance_loss: 0.4221, weighted_loss: 0.1266, label: 2, bag_size: 953
batch 59, loss: 1.6973, instance_loss: 0.5342, weighted_loss: 1.3484, label: 4, bag_size: 233
batch 79, loss: 0.8793, instance_loss: 0.4357, weighted_loss: 0.7462, label: 4, bag_size: 699
batch 99, loss: 1.8407, instance_loss: 0.7155, weighted_loss: 1.5031, label: 1, bag_size: 339
batch 119, loss: 0.3561, instance_loss: 0.5579, weighted_loss: 0.4166, label: 4, bag_size: 432
batch 139, loss: 1.0382, instance_loss: 0.4950, weighted_loss: 0.8753, label: 0, bag_size: 319
batch 159, loss: 0.0067, instance_loss: 0.1308, weighted_loss: 0.0439, label: 0, bag_size: 533
batch 179, loss: 0.8084, instance_loss: 0.4106, weighted_loss: 0.6891, label: 1, bag_size: 500
batch 199, loss: 0.0047, instance_loss: 0.1623, weighted_loss: 0.0520, label: 0, bag_size: 210
batch 219, loss: 0.5499, instance_loss: 0.5248, weighted_loss: 0.5424, label: 3, bag_size: 309
batch 239, loss: 0.8384, instance_loss: 0.5024, weighted_loss: 0.7376, label: 3, bag_size: 1147
batch 259, loss: 1.2536, instance_loss: 0.4927, weighted_loss: 1.0253, label: 3, bag_size: 523
batch 279, loss: 1.7594, instance_loss: 0.5703, weighted_loss: 1.4027, label: 1, bag_size: 697
batch 299, loss: 2.3095, instance_loss: 0.5831, weighted_loss: 1.7915, label: 3, bag_size: 520
batch 319, loss: 0.0432, instance_loss: 0.3138, weighted_loss: 0.1244, label: 0, bag_size: 533
batch 339, loss: 0.4706, instance_loss: 0.3296, weighted_loss: 0.4283, label: 0, bag_size: 201
batch 359, loss: 0.8608, instance_loss: 0.5254, weighted_loss: 0.7602, label: 3, bag_size: 476
batch 379, loss: 2.7686, instance_loss: 0.6576, weighted_loss: 2.1353, label: 0, bag_size: 243
batch 399, loss: 1.0500, instance_loss: 0.6508, weighted_loss: 0.9303, label: 4, bag_size: 160
batch 419, loss: 1.6077, instance_loss: 0.5140, weighted_loss: 1.2796, label: 1, bag_size: 161
batch 439, loss: 1.5692, instance_loss: 0.5760, weighted_loss: 1.2713, label: 3, bag_size: 192
batch 459, loss: 0.8051, instance_loss: 0.5469, weighted_loss: 0.7276, label: 1, bag_size: 748
batch 479, loss: 0.9823, instance_loss: 0.5035, weighted_loss: 0.8387, label: 3, bag_size: 309
batch 499, loss: 0.7318, instance_loss: 0.4436, weighted_loss: 0.6454, label: 2, bag_size: 690
batch 519, loss: 0.4983, instance_loss: 0.4696, weighted_loss: 0.4897, label: 4, bag_size: 703
batch 539, loss: 1.1032, instance_loss: 0.5286, weighted_loss: 0.9308, label: 3, bag_size: 344
batch 559, loss: 0.0257, instance_loss: 0.4430, weighted_loss: 0.1509, label: 0, bag_size: 397
batch 579, loss: 1.0962, instance_loss: 0.4879, weighted_loss: 0.9137, label: 2, bag_size: 350


class 0 clustering acc 0.9963383838383838: correct 23673/23760
class 1 clustering acc 0.06797138047138047: correct 323/4752
Epoch: 33, train_loss: 1.0552, train_clustering_loss:  0.4781, train_error: 0.4310
class 0: acc 0.7952755905511811, correct 101/127
class 1: acc 0.5081967213114754, correct 62/122
class 2: acc 0.27522935779816515, correct 30/109
class 3: acc 0.6147540983606558, correct 75/122
class 4: acc 0.6140350877192983, correct 70/114

Val Set, val_loss: 1.3665, val_error: 0.5270, auc: 0.7739
class 0 clustering acc 0.9949324324324325: correct 2945/2960
class 1 clustering acc 0.052364864864864864: correct 31/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8135, instance_loss: 0.4206, weighted_loss: 0.6957, label: 3, bag_size: 780
batch 39, loss: 1.4788, instance_loss: 0.5210, weighted_loss: 1.1915, label: 2, bag_size: 597
batch 59, loss: 1.1451, instance_loss: 0.4792, weighted_loss: 0.9454, label: 1, bag_size: 660
batch 79, loss: 0.6483, instance_loss: 0.4331, weighted_loss: 0.5837, label: 4, bag_size: 729
batch 99, loss: 0.0294, instance_loss: 0.2483, weighted_loss: 0.0950, label: 0, bag_size: 227
batch 119, loss: 0.5907, instance_loss: 0.4084, weighted_loss: 0.5360, label: 1, bag_size: 748
batch 139, loss: 0.8277, instance_loss: 0.5232, weighted_loss: 0.7364, label: 0, bag_size: 343
batch 159, loss: 1.2763, instance_loss: 0.4566, weighted_loss: 1.0304, label: 1, bag_size: 614
batch 179, loss: 1.5023, instance_loss: 0.4718, weighted_loss: 1.1932, label: 3, bag_size: 109
batch 199, loss: 0.8004, instance_loss: 0.4378, weighted_loss: 0.6916, label: 4, bag_size: 604
batch 219, loss: 0.4850, instance_loss: 0.4585, weighted_loss: 0.4771, label: 1, bag_size: 599
batch 239, loss: 1.3944, instance_loss: 0.5860, weighted_loss: 1.1518, label: 3, bag_size: 631
batch 259, loss: 0.4072, instance_loss: 0.4012, weighted_loss: 0.4054, label: 4, bag_size: 776
batch 279, loss: 2.8666, instance_loss: 0.4991, weighted_loss: 2.1563, label: 2, bag_size: 829
batch 299, loss: 1.1165, instance_loss: 0.5056, weighted_loss: 0.9333, label: 2, bag_size: 1077
batch 319, loss: 1.3724, instance_loss: 0.5821, weighted_loss: 1.1353, label: 3, bag_size: 505
batch 339, loss: 0.0628, instance_loss: 0.2168, weighted_loss: 0.1090, label: 0, bag_size: 212
batch 359, loss: 1.8502, instance_loss: 0.6572, weighted_loss: 1.4923, label: 0, bag_size: 615
batch 379, loss: 1.2237, instance_loss: 0.6063, weighted_loss: 1.0385, label: 2, bag_size: 557
batch 399, loss: 2.1160, instance_loss: 0.6190, weighted_loss: 1.6669, label: 2, bag_size: 582
batch 419, loss: 2.1424, instance_loss: 0.6406, weighted_loss: 1.6919, label: 0, bag_size: 370
batch 439, loss: 1.0330, instance_loss: 0.3966, weighted_loss: 0.8421, label: 1, bag_size: 355
batch 459, loss: 2.9851, instance_loss: 0.6251, weighted_loss: 2.2771, label: 3, bag_size: 615
batch 479, loss: 0.8405, instance_loss: 0.5494, weighted_loss: 0.7532, label: 3, bag_size: 1284
batch 499, loss: 0.5646, instance_loss: 0.4609, weighted_loss: 0.5335, label: 0, bag_size: 223
batch 519, loss: 1.0256, instance_loss: 0.5957, weighted_loss: 0.8966, label: 4, bag_size: 293
batch 539, loss: 2.2699, instance_loss: 0.7943, weighted_loss: 1.8272, label: 0, bag_size: 370
batch 559, loss: 1.6874, instance_loss: 0.5561, weighted_loss: 1.3480, label: 2, bag_size: 582
batch 579, loss: 2.7646, instance_loss: 0.5796, weighted_loss: 2.1091, label: 4, bag_size: 270


class 0 clustering acc 0.996969696969697: correct 23688/23760
class 1 clustering acc 0.04882154882154882: correct 232/4752
Epoch: 34, train_loss: 1.0839, train_clustering_loss:  0.4857, train_error: 0.4646
class 0: acc 0.7567567567567568, correct 84/111
class 1: acc 0.6190476190476191, correct 91/147
class 2: acc 0.2897196261682243, correct 31/107
class 3: acc 0.452991452991453, correct 53/117
class 4: acc 0.5267857142857143, correct 59/112

Val Set, val_loss: 1.3864, val_error: 0.5676, auc: 0.7562
class 0 clustering acc 0.995945945945946: correct 2948/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.8743, instance_loss: 0.6734, weighted_loss: 1.5140, label: 2, bag_size: 361
batch 39, loss: 0.1029, instance_loss: 0.3389, weighted_loss: 0.1737, label: 0, bag_size: 59
batch 59, loss: 2.9484, instance_loss: 0.7094, weighted_loss: 2.2767, label: 0, bag_size: 600
batch 79, loss: 1.5053, instance_loss: 0.5197, weighted_loss: 1.2097, label: 1, bag_size: 398
batch 99, loss: 1.1938, instance_loss: 0.5918, weighted_loss: 1.0132, label: 1, bag_size: 321
batch 119, loss: 1.6492, instance_loss: 0.5759, weighted_loss: 1.3272, label: 2, bag_size: 177
batch 139, loss: 1.3886, instance_loss: 0.5562, weighted_loss: 1.1389, label: 2, bag_size: 1003
batch 159, loss: 0.0192, instance_loss: 0.2453, weighted_loss: 0.0870, label: 0, bag_size: 73
batch 179, loss: 1.3359, instance_loss: 0.4828, weighted_loss: 1.0800, label: 4, bag_size: 318
batch 199, loss: 1.6058, instance_loss: 0.5108, weighted_loss: 1.2773, label: 4, bag_size: 310
batch 219, loss: 1.4468, instance_loss: 0.4866, weighted_loss: 1.1587, label: 3, bag_size: 109
batch 239, loss: 0.3454, instance_loss: 0.4438, weighted_loss: 0.3749, label: 4, bag_size: 228
batch 259, loss: 0.9170, instance_loss: 0.4611, weighted_loss: 0.7802, label: 1, bag_size: 1013
batch 279, loss: 0.8044, instance_loss: 0.6693, weighted_loss: 0.7639, label: 1, bag_size: 106
batch 299, loss: 1.0499, instance_loss: 0.4885, weighted_loss: 0.8815, label: 2, bag_size: 607
batch 319, loss: 1.3503, instance_loss: 0.5940, weighted_loss: 1.1234, label: 3, bag_size: 428
batch 339, loss: 0.4981, instance_loss: 0.3422, weighted_loss: 0.4513, label: 4, bag_size: 875
batch 359, loss: 1.0216, instance_loss: 0.5234, weighted_loss: 0.8721, label: 3, bag_size: 274
batch 379, loss: 0.9623, instance_loss: 0.5485, weighted_loss: 0.8382, label: 4, bag_size: 1297
batch 399, loss: 0.7049, instance_loss: 0.4144, weighted_loss: 0.6178, label: 2, bag_size: 567
batch 419, loss: 0.0413, instance_loss: 0.3790, weighted_loss: 0.1426, label: 0, bag_size: 366
batch 439, loss: 1.3882, instance_loss: 0.4845, weighted_loss: 1.1171, label: 2, bag_size: 380
batch 459, loss: 0.4140, instance_loss: 0.3942, weighted_loss: 0.4080, label: 1, bag_size: 1104
batch 479, loss: 0.0254, instance_loss: 0.3622, weighted_loss: 0.1264, label: 0, bag_size: 251
batch 499, loss: 1.6683, instance_loss: 0.6215, weighted_loss: 1.3543, label: 4, bag_size: 853
batch 519, loss: 1.8989, instance_loss: 0.4874, weighted_loss: 1.4755, label: 2, bag_size: 645
batch 539, loss: 0.5979, instance_loss: 0.4618, weighted_loss: 0.5571, label: 3, bag_size: 818
batch 559, loss: 1.2251, instance_loss: 0.5998, weighted_loss: 1.0375, label: 0, bag_size: 178
batch 579, loss: 0.6633, instance_loss: 0.4841, weighted_loss: 0.6095, label: 3, bag_size: 697


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.05134680134680135: correct 244/4752
Epoch: 35, train_loss: 1.0603, train_clustering_loss:  0.4900, train_error: 0.4461
class 0: acc 0.7698412698412699, correct 97/126
class 1: acc 0.43333333333333335, correct 52/120
class 2: acc 0.33035714285714285, correct 37/112
class 3: acc 0.6386554621848739, correct 76/119
class 4: acc 0.5726495726495726, correct 67/117

Val Set, val_loss: 1.1607, val_error: 0.5270, auc: 0.8166
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.182056 --> 1.160748).  Saving model ...


batch 19, loss: 2.3690, instance_loss: 0.5733, weighted_loss: 1.8303, label: 1, bag_size: 350
batch 39, loss: 1.1307, instance_loss: 0.4843, weighted_loss: 0.9368, label: 1, bag_size: 742
batch 59, loss: 0.4908, instance_loss: 0.4281, weighted_loss: 0.4720, label: 2, bag_size: 567
batch 79, loss: 0.4927, instance_loss: 0.3746, weighted_loss: 0.4572, label: 4, bag_size: 895
batch 99, loss: 0.9197, instance_loss: 0.4982, weighted_loss: 0.7933, label: 4, bag_size: 639
batch 119, loss: 1.0563, instance_loss: 0.5668, weighted_loss: 0.9094, label: 2, bag_size: 25
batch 139, loss: 0.6124, instance_loss: 0.4290, weighted_loss: 0.5574, label: 1, bag_size: 829
batch 159, loss: 0.9875, instance_loss: 0.4484, weighted_loss: 0.8258, label: 3, bag_size: 1328
batch 179, loss: 1.0318, instance_loss: 0.5449, weighted_loss: 0.8857, label: 2, bag_size: 1066
batch 199, loss: 0.8665, instance_loss: 0.4958, weighted_loss: 0.7553, label: 3, bag_size: 457
batch 219, loss: 0.9301, instance_loss: 0.4233, weighted_loss: 0.7781, label: 1, bag_size: 384
batch 239, loss: 1.1354, instance_loss: 0.5277, weighted_loss: 0.9531, label: 3, bag_size: 472
batch 259, loss: 1.1483, instance_loss: 0.4571, weighted_loss: 0.9409, label: 1, bag_size: 697
batch 279, loss: 1.1336, instance_loss: 0.6061, weighted_loss: 0.9754, label: 0, bag_size: 1045
batch 299, loss: 0.9699, instance_loss: 0.5875, weighted_loss: 0.8551, label: 3, bag_size: 739
batch 319, loss: 0.1825, instance_loss: 0.2799, weighted_loss: 0.2117, label: 0, bag_size: 49
batch 339, loss: 0.9995, instance_loss: 0.4617, weighted_loss: 0.8382, label: 2, bag_size: 613
batch 359, loss: 1.7049, instance_loss: 0.6089, weighted_loss: 1.3761, label: 0, bag_size: 367
batch 379, loss: 3.5964, instance_loss: 0.6299, weighted_loss: 2.7064, label: 1, bag_size: 1019
batch 399, loss: 4.1310, instance_loss: 0.6172, weighted_loss: 3.0769, label: 1, bag_size: 45
batch 419, loss: 0.2613, instance_loss: 0.6338, weighted_loss: 0.3730, label: 4, bag_size: 683
batch 439, loss: 0.5757, instance_loss: 0.4247, weighted_loss: 0.5304, label: 2, bag_size: 1079
batch 459, loss: 1.0318, instance_loss: 0.4507, weighted_loss: 0.8575, label: 4, bag_size: 198
batch 479, loss: 1.1503, instance_loss: 0.4497, weighted_loss: 0.9401, label: 2, bag_size: 337
batch 499, loss: 0.0715, instance_loss: 0.5202, weighted_loss: 0.2061, label: 0, bag_size: 49
batch 519, loss: 0.9069, instance_loss: 0.4483, weighted_loss: 0.7693, label: 2, bag_size: 337
batch 539, loss: 1.1617, instance_loss: 0.5070, weighted_loss: 0.9653, label: 1, bag_size: 177
batch 559, loss: 1.0647, instance_loss: 0.5088, weighted_loss: 0.8980, label: 4, bag_size: 476
batch 579, loss: 0.7671, instance_loss: 0.4765, weighted_loss: 0.6799, label: 1, bag_size: 865


class 0 clustering acc 0.9977693602693603: correct 23707/23760
class 1 clustering acc 0.021464646464646464: correct 102/4752
Epoch: 36, train_loss: 1.0876, train_clustering_loss:  0.4996, train_error: 0.4714
class 0: acc 0.7767857142857143, correct 87/112
class 1: acc 0.4296875, correct 55/128
class 2: acc 0.42857142857142855, correct 57/133
class 3: acc 0.46218487394957986, correct 55/119
class 4: acc 0.5882352941176471, correct 60/102

Val Set, val_loss: 1.3159, val_error: 0.5811, auc: 0.7995
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9449, instance_loss: 0.4732, weighted_loss: 0.8033, label: 1, bag_size: 522
batch 39, loss: 3.0096, instance_loss: 0.5875, weighted_loss: 2.2829, label: 2, bag_size: 629
batch 59, loss: 0.2066, instance_loss: 0.4093, weighted_loss: 0.2674, label: 0, bag_size: 70
batch 79, loss: 0.9030, instance_loss: 0.5821, weighted_loss: 0.8067, label: 1, bag_size: 855
batch 99, loss: 1.2135, instance_loss: 0.5144, weighted_loss: 1.0038, label: 1, bag_size: 1023
batch 119, loss: 0.8917, instance_loss: 0.5607, weighted_loss: 0.7924, label: 4, bag_size: 520
batch 139, loss: 1.2774, instance_loss: 0.5211, weighted_loss: 1.0505, label: 2, bag_size: 350
batch 159, loss: 0.1304, instance_loss: 0.3438, weighted_loss: 0.1944, label: 0, bag_size: 306
batch 179, loss: 1.1116, instance_loss: 0.4649, weighted_loss: 0.9176, label: 2, bag_size: 584
batch 199, loss: 0.9468, instance_loss: 0.5034, weighted_loss: 0.8138, label: 4, bag_size: 729
batch 219, loss: 0.0061, instance_loss: 0.2125, weighted_loss: 0.0681, label: 0, bag_size: 88
batch 239, loss: 1.0771, instance_loss: 0.4908, weighted_loss: 0.9012, label: 1, bag_size: 384
batch 259, loss: 0.0230, instance_loss: 0.3035, weighted_loss: 0.1071, label: 0, bag_size: 357
batch 279, loss: 4.1603, instance_loss: 0.5558, weighted_loss: 3.0789, label: 3, bag_size: 508
batch 299, loss: 0.5405, instance_loss: 0.4493, weighted_loss: 0.5132, label: 3, bag_size: 369
batch 319, loss: 0.0109, instance_loss: 0.3406, weighted_loss: 0.1098, label: 0, bag_size: 351
batch 339, loss: 0.8742, instance_loss: 0.4786, weighted_loss: 0.7555, label: 4, bag_size: 944
batch 359, loss: 1.4384, instance_loss: 0.4667, weighted_loss: 1.1469, label: 4, bag_size: 196
batch 379, loss: 0.0565, instance_loss: 0.3161, weighted_loss: 0.1344, label: 0, bag_size: 122
batch 399, loss: 0.7432, instance_loss: 0.4413, weighted_loss: 0.6526, label: 3, bag_size: 780
batch 419, loss: 1.4494, instance_loss: 0.4266, weighted_loss: 1.1425, label: 0, bag_size: 141
batch 439, loss: 0.7651, instance_loss: 0.5310, weighted_loss: 0.6949, label: 1, bag_size: 851
batch 459, loss: 2.6152, instance_loss: 0.6025, weighted_loss: 2.0114, label: 1, bag_size: 328
batch 479, loss: 2.3100, instance_loss: 0.5159, weighted_loss: 1.7718, label: 1, bag_size: 408
batch 499, loss: 1.3230, instance_loss: 0.5513, weighted_loss: 1.0915, label: 1, bag_size: 419
batch 519, loss: 0.5298, instance_loss: 0.3872, weighted_loss: 0.4870, label: 3, bag_size: 369
batch 539, loss: 1.2996, instance_loss: 0.4704, weighted_loss: 1.0508, label: 1, bag_size: 1023
batch 559, loss: 0.2021, instance_loss: 0.4190, weighted_loss: 0.2672, label: 0, bag_size: 238
batch 579, loss: 0.0025, instance_loss: 0.2060, weighted_loss: 0.0636, label: 0, bag_size: 428


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.045664983164983165: correct 217/4752
Epoch: 37, train_loss: 1.0690, train_clustering_loss:  0.4915, train_error: 0.4747
class 0: acc 0.8114754098360656, correct 99/122
class 1: acc 0.41964285714285715, correct 47/112
class 2: acc 0.38095238095238093, correct 48/126
class 3: acc 0.5454545454545454, correct 72/132
class 4: acc 0.45098039215686275, correct 46/102

Val Set, val_loss: 1.3061, val_error: 0.5270, auc: 0.7855
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.08108108108108109: correct 48/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 3.8926, instance_loss: 0.7863, weighted_loss: 2.9607, label: 4, bag_size: 1113
batch 39, loss: 1.2428, instance_loss: 0.4994, weighted_loss: 1.0198, label: 3, bag_size: 344
batch 59, loss: 1.5347, instance_loss: 0.5465, weighted_loss: 1.2383, label: 0, bag_size: 269
batch 79, loss: 0.6791, instance_loss: 0.4768, weighted_loss: 0.6184, label: 3, bag_size: 344
batch 99, loss: 0.8277, instance_loss: 0.6179, weighted_loss: 0.7648, label: 4, bag_size: 160
batch 119, loss: 1.6394, instance_loss: 0.5811, weighted_loss: 1.3219, label: 4, bag_size: 264
batch 139, loss: 1.6261, instance_loss: 0.5226, weighted_loss: 1.2950, label: 4, bag_size: 318
batch 159, loss: 0.8184, instance_loss: 0.4868, weighted_loss: 0.7190, label: 4, bag_size: 110
batch 179, loss: 0.0081, instance_loss: 0.1160, weighted_loss: 0.0405, label: 0, bag_size: 527
batch 199, loss: 0.0367, instance_loss: 0.2718, weighted_loss: 0.1072, label: 0, bag_size: 88
batch 219, loss: 1.1384, instance_loss: 0.5089, weighted_loss: 0.9496, label: 3, bag_size: 1022
batch 239, loss: 1.1518, instance_loss: 0.5046, weighted_loss: 0.9576, label: 4, bag_size: 854
batch 259, loss: 1.2597, instance_loss: 0.5236, weighted_loss: 1.0389, label: 2, bag_size: 337
batch 279, loss: 0.0406, instance_loss: 0.3289, weighted_loss: 0.1271, label: 0, bag_size: 79
batch 299, loss: 1.3828, instance_loss: 0.5198, weighted_loss: 1.1239, label: 1, bag_size: 201
batch 319, loss: 1.1818, instance_loss: 0.4901, weighted_loss: 0.9743, label: 1, bag_size: 233
batch 339, loss: 0.0536, instance_loss: 0.4903, weighted_loss: 0.1846, label: 0, bag_size: 351
batch 359, loss: 1.8173, instance_loss: 0.5343, weighted_loss: 1.4324, label: 3, bag_size: 598
batch 379, loss: 0.5542, instance_loss: 0.6112, weighted_loss: 0.5713, label: 2, bag_size: 867
batch 399, loss: 0.1441, instance_loss: 0.4986, weighted_loss: 0.2505, label: 4, bag_size: 746
batch 419, loss: 1.1223, instance_loss: 0.5684, weighted_loss: 0.9561, label: 0, bag_size: 62
batch 439, loss: 2.6388, instance_loss: 0.5803, weighted_loss: 2.0212, label: 3, bag_size: 390
batch 459, loss: 0.6128, instance_loss: 0.4964, weighted_loss: 0.5778, label: 3, bag_size: 1021
batch 479, loss: 1.6306, instance_loss: 0.5934, weighted_loss: 1.3195, label: 2, bag_size: 754
batch 499, loss: 1.4399, instance_loss: 0.5676, weighted_loss: 1.1782, label: 4, bag_size: 572
batch 519, loss: 0.0932, instance_loss: 0.4265, weighted_loss: 0.1932, label: 0, bag_size: 58
batch 539, loss: 0.6939, instance_loss: 0.4670, weighted_loss: 0.6259, label: 1, bag_size: 695
batch 559, loss: 0.9246, instance_loss: 0.4770, weighted_loss: 0.7903, label: 2, bag_size: 135
batch 579, loss: 0.9274, instance_loss: 0.4182, weighted_loss: 0.7746, label: 3, bag_size: 737


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.049873737373737376: correct 237/4752
Epoch: 38, train_loss: 1.0191, train_clustering_loss:  0.4847, train_error: 0.4461
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.4380165289256198, correct 53/121
class 2: acc 0.32710280373831774, correct 35/107
class 3: acc 0.6610169491525424, correct 78/118
class 4: acc 0.5196850393700787, correct 66/127

Val Set, val_loss: 1.4022, val_error: 0.5270, auc: 0.7789
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.08952702702702703: correct 53/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7381, instance_loss: 0.4408, weighted_loss: 0.6489, label: 1, bag_size: 329
batch 39, loss: 0.7470, instance_loss: 0.5088, weighted_loss: 0.6756, label: 4, bag_size: 418
batch 59, loss: 0.3388, instance_loss: 0.3813, weighted_loss: 0.3515, label: 3, bag_size: 432
batch 79, loss: 0.2618, instance_loss: 0.5780, weighted_loss: 0.3567, label: 0, bag_size: 316
batch 99, loss: 0.9760, instance_loss: 0.4320, weighted_loss: 0.8128, label: 3, bag_size: 258
batch 119, loss: 3.2877, instance_loss: 0.7358, weighted_loss: 2.5222, label: 2, bag_size: 380
batch 139, loss: 1.6345, instance_loss: 0.5104, weighted_loss: 1.2973, label: 2, bag_size: 390
batch 159, loss: 0.0103, instance_loss: 0.3842, weighted_loss: 0.1224, label: 4, bag_size: 530
batch 179, loss: 0.6495, instance_loss: 0.5081, weighted_loss: 0.6071, label: 4, bag_size: 895
batch 199, loss: 1.6478, instance_loss: 0.5382, weighted_loss: 1.3149, label: 3, bag_size: 796
batch 219, loss: 1.0284, instance_loss: 0.5160, weighted_loss: 0.8747, label: 4, bag_size: 160
batch 239, loss: 0.1005, instance_loss: 0.5058, weighted_loss: 0.2221, label: 0, bag_size: 477
batch 259, loss: 0.7015, instance_loss: 0.4806, weighted_loss: 0.6352, label: 3, bag_size: 727
batch 279, loss: 1.8508, instance_loss: 0.5136, weighted_loss: 1.4496, label: 2, bag_size: 852
batch 299, loss: 1.6298, instance_loss: 0.5688, weighted_loss: 1.3115, label: 1, bag_size: 339
batch 319, loss: 2.3929, instance_loss: 0.6597, weighted_loss: 1.8729, label: 0, bag_size: 888
batch 339, loss: 0.1577, instance_loss: 0.3512, weighted_loss: 0.2157, label: 0, bag_size: 552
batch 359, loss: 0.2669, instance_loss: 0.6101, weighted_loss: 0.3699, label: 4, bag_size: 293
batch 379, loss: 0.4680, instance_loss: 0.4173, weighted_loss: 0.4528, label: 0, bag_size: 520
batch 399, loss: 1.3741, instance_loss: 0.5274, weighted_loss: 1.1201, label: 1, bag_size: 925
batch 419, loss: 0.8182, instance_loss: 0.4895, weighted_loss: 0.7196, label: 3, bag_size: 587
batch 439, loss: 2.0024, instance_loss: 0.5081, weighted_loss: 1.5541, label: 1, bag_size: 408
batch 459, loss: 1.2726, instance_loss: 0.5085, weighted_loss: 1.0433, label: 4, bag_size: 356
batch 479, loss: 2.0658, instance_loss: 0.5983, weighted_loss: 1.6256, label: 1, bag_size: 564
batch 499, loss: 0.7725, instance_loss: 0.5376, weighted_loss: 0.7020, label: 2, bag_size: 549
batch 519, loss: 0.6538, instance_loss: 0.5108, weighted_loss: 0.6109, label: 0, bag_size: 428
batch 539, loss: 0.7607, instance_loss: 0.5278, weighted_loss: 0.6908, label: 2, bag_size: 25
batch 559, loss: 0.3493, instance_loss: 0.4220, weighted_loss: 0.3711, label: 3, bag_size: 1021
batch 579, loss: 0.6678, instance_loss: 0.6657, weighted_loss: 0.6672, label: 1, bag_size: 618


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.03956228956228956: correct 188/4752
Epoch: 39, train_loss: 1.0381, train_clustering_loss:  0.4914, train_error: 0.4310
class 0: acc 0.8412698412698413, correct 106/126
class 1: acc 0.4491525423728814, correct 53/118
class 2: acc 0.4263565891472868, correct 55/129
class 3: acc 0.6422764227642277, correct 79/123
class 4: acc 0.45918367346938777, correct 45/98

Val Set, val_loss: 1.3285, val_error: 0.5405, auc: 0.7830
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4737, instance_loss: 0.3871, weighted_loss: 0.4477, label: 0, bag_size: 493
batch 39, loss: 1.1598, instance_loss: 0.7255, weighted_loss: 1.0295, label: 2, bag_size: 286
batch 59, loss: 0.9236, instance_loss: 0.5430, weighted_loss: 0.8094, label: 3, bag_size: 857
batch 79, loss: 0.4556, instance_loss: 0.4510, weighted_loss: 0.4542, label: 2, bag_size: 288
batch 99, loss: 1.1486, instance_loss: 0.5073, weighted_loss: 0.9562, label: 2, bag_size: 576
batch 119, loss: 0.9741, instance_loss: 0.4667, weighted_loss: 0.8219, label: 1, bag_size: 1043
batch 139, loss: 1.1128, instance_loss: 0.4751, weighted_loss: 0.9215, label: 2, bag_size: 567
batch 159, loss: 0.6210, instance_loss: 0.4843, weighted_loss: 0.5800, label: 4, bag_size: 520
batch 179, loss: 0.7072, instance_loss: 0.4155, weighted_loss: 0.6196, label: 0, bag_size: 269
batch 199, loss: 0.7096, instance_loss: 0.5139, weighted_loss: 0.6509, label: 2, bag_size: 867
batch 219, loss: 0.5829, instance_loss: 0.4730, weighted_loss: 0.5499, label: 3, bag_size: 154
batch 239, loss: 0.7466, instance_loss: 0.5284, weighted_loss: 0.6811, label: 2, bag_size: 317
batch 259, loss: 0.4604, instance_loss: 0.4727, weighted_loss: 0.4641, label: 3, bag_size: 684
batch 279, loss: 0.8016, instance_loss: 0.5795, weighted_loss: 0.7350, label: 0, bag_size: 613
batch 299, loss: 0.8233, instance_loss: 0.4101, weighted_loss: 0.6993, label: 3, bag_size: 1328
batch 319, loss: 0.9487, instance_loss: 0.4658, weighted_loss: 0.8038, label: 1, bag_size: 620
batch 339, loss: 1.6299, instance_loss: 0.4653, weighted_loss: 1.2805, label: 4, bag_size: 438
batch 359, loss: 1.0778, instance_loss: 0.5592, weighted_loss: 0.9223, label: 3, bag_size: 1022
batch 379, loss: 0.8196, instance_loss: 0.4775, weighted_loss: 0.7170, label: 1, bag_size: 221
batch 399, loss: 0.3499, instance_loss: 0.4096, weighted_loss: 0.3678, label: 2, bag_size: 614
batch 419, loss: 2.6224, instance_loss: 0.5304, weighted_loss: 1.9948, label: 2, bag_size: 1016
batch 439, loss: 1.7812, instance_loss: 0.5645, weighted_loss: 1.4162, label: 4, bag_size: 690
batch 459, loss: 0.5220, instance_loss: 0.4989, weighted_loss: 0.5151, label: 3, bag_size: 858
batch 479, loss: 1.5468, instance_loss: 0.5074, weighted_loss: 1.2350, label: 2, bag_size: 860
batch 499, loss: 0.5221, instance_loss: 0.4775, weighted_loss: 0.5088, label: 4, bag_size: 703
batch 519, loss: 1.2450, instance_loss: 0.5156, weighted_loss: 1.0262, label: 4, bag_size: 1041
batch 539, loss: 0.0521, instance_loss: 0.3833, weighted_loss: 0.1515, label: 0, bag_size: 488
batch 559, loss: 1.6636, instance_loss: 0.5020, weighted_loss: 1.3151, label: 2, bag_size: 717
batch 579, loss: 0.0914, instance_loss: 0.4752, weighted_loss: 0.2065, label: 0, bag_size: 523


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.04461279461279461: correct 212/4752
Epoch: 40, train_loss: 1.0235, train_clustering_loss:  0.4848, train_error: 0.4529
class 0: acc 0.8333333333333334, correct 105/126
class 1: acc 0.5, correct 53/106
class 2: acc 0.3790322580645161, correct 47/124
class 3: acc 0.528, correct 66/125
class 4: acc 0.4778761061946903, correct 54/113

Val Set, val_loss: 1.2680, val_error: 0.5676, auc: 0.7833
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5575, instance_loss: 0.4962, weighted_loss: 0.5391, label: 2, bag_size: 613
batch 39, loss: 0.6580, instance_loss: 0.5954, weighted_loss: 0.6392, label: 0, bag_size: 587
batch 59, loss: 1.9782, instance_loss: 0.5401, weighted_loss: 1.5468, label: 4, bag_size: 757
batch 79, loss: 0.6802, instance_loss: 0.5169, weighted_loss: 0.6312, label: 2, bag_size: 392
batch 99, loss: 0.0005, instance_loss: 0.0978, weighted_loss: 0.0297, label: 4, bag_size: 813
batch 119, loss: 0.9847, instance_loss: 0.5530, weighted_loss: 0.8552, label: 0, bag_size: 367
batch 139, loss: 1.5903, instance_loss: 0.4809, weighted_loss: 1.2574, label: 1, bag_size: 742
batch 159, loss: 1.5527, instance_loss: 0.6207, weighted_loss: 1.2731, label: 0, bag_size: 81
batch 179, loss: 0.0307, instance_loss: 0.4067, weighted_loss: 0.1435, label: 0, bag_size: 397
batch 199, loss: 1.0759, instance_loss: 0.5288, weighted_loss: 0.9118, label: 2, bag_size: 489
batch 219, loss: 1.0024, instance_loss: 0.5084, weighted_loss: 0.8542, label: 1, bag_size: 384
batch 239, loss: 0.9455, instance_loss: 0.4923, weighted_loss: 0.8095, label: 1, bag_size: 1043
batch 259, loss: 0.5910, instance_loss: 0.4404, weighted_loss: 0.5459, label: 1, bag_size: 544
batch 279, loss: 1.0393, instance_loss: 0.4284, weighted_loss: 0.8560, label: 1, bag_size: 328
batch 299, loss: 0.8927, instance_loss: 0.4850, weighted_loss: 0.7704, label: 2, bag_size: 337
batch 319, loss: 0.8442, instance_loss: 0.4794, weighted_loss: 0.7348, label: 2, bag_size: 348
batch 339, loss: 0.3993, instance_loss: 0.4196, weighted_loss: 0.4054, label: 0, bag_size: 524
batch 359, loss: 0.6295, instance_loss: 0.4520, weighted_loss: 0.5762, label: 3, bag_size: 369
batch 379, loss: 0.2890, instance_loss: 0.4684, weighted_loss: 0.3428, label: 2, bag_size: 614
batch 399, loss: 0.6097, instance_loss: 0.5363, weighted_loss: 0.5877, label: 2, bag_size: 821
batch 419, loss: 1.0224, instance_loss: 0.4177, weighted_loss: 0.8410, label: 4, bag_size: 312
batch 439, loss: 0.4988, instance_loss: 0.5108, weighted_loss: 0.5024, label: 0, bag_size: 524
batch 459, loss: 0.3098, instance_loss: 0.5727, weighted_loss: 0.3886, label: 0, bag_size: 283
batch 479, loss: 0.6869, instance_loss: 0.5581, weighted_loss: 0.6482, label: 3, bag_size: 344
batch 499, loss: 1.3540, instance_loss: 0.5043, weighted_loss: 1.0991, label: 1, bag_size: 1360
batch 519, loss: 1.3083, instance_loss: 0.4555, weighted_loss: 1.0525, label: 4, bag_size: 333
batch 539, loss: 1.6149, instance_loss: 0.5412, weighted_loss: 1.2928, label: 4, bag_size: 572
batch 559, loss: 0.9108, instance_loss: 0.4215, weighted_loss: 0.7640, label: 4, bag_size: 238
batch 579, loss: 0.5434, instance_loss: 0.5253, weighted_loss: 0.5380, label: 1, bag_size: 814


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.049873737373737376: correct 237/4752
Epoch: 41, train_loss: 1.0025, train_clustering_loss:  0.4825, train_error: 0.4226
class 0: acc 0.8620689655172413, correct 100/116
class 1: acc 0.3813559322033898, correct 45/118
class 2: acc 0.4921875, correct 63/128
class 3: acc 0.5765765765765766, correct 64/111
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.4162, val_error: 0.5811, auc: 0.7857
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.08277027027027027: correct 49/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 2.8929, instance_loss: 0.5828, weighted_loss: 2.1998, label: 0, bag_size: 243
batch 39, loss: 0.7628, instance_loss: 0.4562, weighted_loss: 0.6708, label: 3, bag_size: 944
batch 59, loss: 4.7896, instance_loss: 0.7449, weighted_loss: 3.5762, label: 3, bag_size: 795
batch 79, loss: 3.4557, instance_loss: 0.5859, weighted_loss: 2.5948, label: 2, bag_size: 829
batch 99, loss: 0.6798, instance_loss: 0.4110, weighted_loss: 0.5991, label: 1, bag_size: 865
batch 119, loss: 1.4366, instance_loss: 0.4844, weighted_loss: 1.1509, label: 4, bag_size: 176
batch 139, loss: 0.0398, instance_loss: 0.3131, weighted_loss: 0.1218, label: 0, bag_size: 70
batch 159, loss: 0.5794, instance_loss: 0.5471, weighted_loss: 0.5697, label: 4, bag_size: 468
batch 179, loss: 1.5585, instance_loss: 0.5487, weighted_loss: 1.2555, label: 2, bag_size: 713
batch 199, loss: 0.3658, instance_loss: 0.5096, weighted_loss: 0.4089, label: 0, bag_size: 702
batch 219, loss: 0.3610, instance_loss: 0.4975, weighted_loss: 0.4019, label: 2, bag_size: 25
batch 239, loss: 0.1498, instance_loss: 0.3255, weighted_loss: 0.2025, label: 0, bag_size: 79
batch 259, loss: 0.2320, instance_loss: 0.3882, weighted_loss: 0.2788, label: 1, bag_size: 886
batch 279, loss: 0.4025, instance_loss: 0.4142, weighted_loss: 0.4060, label: 4, bag_size: 895
batch 299, loss: 1.5843, instance_loss: 0.5976, weighted_loss: 1.2883, label: 2, bag_size: 998
batch 319, loss: 0.5530, instance_loss: 0.4902, weighted_loss: 0.5342, label: 4, bag_size: 318
batch 339, loss: 1.1992, instance_loss: 0.4791, weighted_loss: 0.9832, label: 4, bag_size: 342
batch 359, loss: 1.0622, instance_loss: 0.5031, weighted_loss: 0.8944, label: 3, bag_size: 598
batch 379, loss: 1.1249, instance_loss: 0.4707, weighted_loss: 0.9286, label: 3, bag_size: 496
batch 399, loss: 0.3766, instance_loss: 0.4554, weighted_loss: 0.4003, label: 4, bag_size: 267
batch 419, loss: 0.0606, instance_loss: 0.4068, weighted_loss: 0.1644, label: 0, bag_size: 188
batch 439, loss: 1.5992, instance_loss: 0.4905, weighted_loss: 1.2666, label: 4, bag_size: 312
batch 459, loss: 0.8894, instance_loss: 0.4673, weighted_loss: 0.7627, label: 3, bag_size: 625
batch 479, loss: 1.2984, instance_loss: 0.3952, weighted_loss: 1.0274, label: 2, bag_size: 177
batch 499, loss: 0.1103, instance_loss: 0.4682, weighted_loss: 0.2177, label: 1, bag_size: 106
batch 519, loss: 1.2986, instance_loss: 0.5839, weighted_loss: 1.0842, label: 0, bag_size: 367
batch 539, loss: 0.5538, instance_loss: 0.5064, weighted_loss: 0.5396, label: 1, bag_size: 764
batch 559, loss: 2.3132, instance_loss: 0.5945, weighted_loss: 1.7976, label: 1, bag_size: 564
batch 579, loss: 0.8697, instance_loss: 0.6203, weighted_loss: 0.7949, label: 4, bag_size: 853


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.02441077441077441: correct 116/4752
Epoch: 42, train_loss: 1.0445, train_clustering_loss:  0.4907, train_error: 0.4327
class 0: acc 0.8070175438596491, correct 92/114
class 1: acc 0.38, correct 38/100
class 2: acc 0.5314685314685315, correct 76/143
class 3: acc 0.5, correct 56/112
class 4: acc 0.6, correct 75/125

Val Set, val_loss: 1.2035, val_error: 0.5135, auc: 0.7940
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0821, instance_loss: 0.3903, weighted_loss: 0.1746, label: 0, bag_size: 493
batch 39, loss: 1.2588, instance_loss: 0.5269, weighted_loss: 1.0392, label: 2, bag_size: 744
batch 59, loss: 0.0893, instance_loss: 0.5408, weighted_loss: 0.2248, label: 0, bag_size: 552
batch 79, loss: 0.6910, instance_loss: 0.4907, weighted_loss: 0.6309, label: 4, bag_size: 703
batch 99, loss: 1.6073, instance_loss: 0.4680, weighted_loss: 1.2655, label: 1, bag_size: 617
batch 119, loss: 0.9432, instance_loss: 0.6119, weighted_loss: 0.8438, label: 2, bag_size: 286
batch 139, loss: 2.5717, instance_loss: 0.5273, weighted_loss: 1.9584, label: 0, bag_size: 273
batch 159, loss: 0.0089, instance_loss: 0.0380, weighted_loss: 0.0177, label: 4, bag_size: 813
batch 179, loss: 0.8821, instance_loss: 0.4576, weighted_loss: 0.7548, label: 1, bag_size: 972
batch 199, loss: 0.0380, instance_loss: 0.3121, weighted_loss: 0.1202, label: 0, bag_size: 488
batch 219, loss: 0.0558, instance_loss: 0.3997, weighted_loss: 0.1590, label: 0, bag_size: 573
batch 239, loss: 1.3506, instance_loss: 0.5208, weighted_loss: 1.1017, label: 2, bag_size: 390
batch 259, loss: 0.6701, instance_loss: 0.4108, weighted_loss: 0.5923, label: 3, bag_size: 102
batch 279, loss: 0.2290, instance_loss: 0.4388, weighted_loss: 0.2919, label: 0, bag_size: 49
batch 299, loss: 1.0255, instance_loss: 0.5359, weighted_loss: 0.8786, label: 3, bag_size: 272
batch 319, loss: 0.0079, instance_loss: 0.2746, weighted_loss: 0.0879, label: 0, bag_size: 51
batch 339, loss: 2.1890, instance_loss: 0.5977, weighted_loss: 1.7116, label: 4, bag_size: 310
batch 359, loss: 1.4270, instance_loss: 0.4285, weighted_loss: 1.1274, label: 3, bag_size: 473
batch 379, loss: 0.8108, instance_loss: 0.4370, weighted_loss: 0.6986, label: 2, bag_size: 906
batch 399, loss: 2.3914, instance_loss: 0.5781, weighted_loss: 1.8474, label: 0, bag_size: 305
batch 419, loss: 0.9668, instance_loss: 0.5525, weighted_loss: 0.8425, label: 3, bag_size: 737
batch 439, loss: 0.5060, instance_loss: 0.3946, weighted_loss: 0.4725, label: 1, bag_size: 413
batch 459, loss: 0.0033, instance_loss: 0.3265, weighted_loss: 0.1003, label: 0, bag_size: 428
batch 479, loss: 1.0138, instance_loss: 0.5089, weighted_loss: 0.8623, label: 2, bag_size: 290
batch 499, loss: 0.0487, instance_loss: 0.3423, weighted_loss: 0.1368, label: 0, bag_size: 70
batch 519, loss: 1.1410, instance_loss: 0.4074, weighted_loss: 0.9209, label: 1, bag_size: 614
batch 539, loss: 1.1067, instance_loss: 0.5377, weighted_loss: 0.9360, label: 2, bag_size: 633
batch 559, loss: 1.3203, instance_loss: 0.5196, weighted_loss: 1.0801, label: 2, bag_size: 380
batch 579, loss: 0.2014, instance_loss: 0.4062, weighted_loss: 0.2628, label: 4, bag_size: 923


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.021675084175084174: correct 103/4752
Epoch: 43, train_loss: 0.9938, train_clustering_loss:  0.4864, train_error: 0.4209
class 0: acc 0.8421052631578947, correct 96/114
class 1: acc 0.5142857142857142, correct 72/140
class 2: acc 0.4297520661157025, correct 52/121
class 3: acc 0.5233644859813084, correct 56/107
class 4: acc 0.6071428571428571, correct 68/112

Val Set, val_loss: 1.3634, val_error: 0.5000, auc: 0.7987
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.05574324324324324: correct 33/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0002, instance_loss: 0.4009, weighted_loss: 0.8204, label: 0, bag_size: 581
batch 39, loss: 1.0108, instance_loss: 0.4624, weighted_loss: 0.8463, label: 1, bag_size: 384
batch 59, loss: 1.5411, instance_loss: 0.5552, weighted_loss: 1.2453, label: 2, bag_size: 380
batch 79, loss: 0.8445, instance_loss: 0.4625, weighted_loss: 0.7299, label: 4, bag_size: 53
batch 99, loss: 1.0416, instance_loss: 0.6368, weighted_loss: 0.9202, label: 0, bag_size: 247
batch 119, loss: 0.8940, instance_loss: 0.5222, weighted_loss: 0.7825, label: 3, bag_size: 97
batch 139, loss: 1.8008, instance_loss: 0.6044, weighted_loss: 1.4419, label: 0, bag_size: 615
batch 159, loss: 0.8988, instance_loss: 0.3936, weighted_loss: 0.7472, label: 1, bag_size: 634
batch 179, loss: 2.4751, instance_loss: 0.6698, weighted_loss: 1.9335, label: 3, bag_size: 107
batch 199, loss: 0.8222, instance_loss: 0.4918, weighted_loss: 0.7231, label: 1, bag_size: 855
batch 219, loss: 1.1704, instance_loss: 0.4985, weighted_loss: 0.9688, label: 3, bag_size: 817
batch 239, loss: 0.6943, instance_loss: 0.5182, weighted_loss: 0.6414, label: 3, bag_size: 1284
batch 259, loss: 0.5810, instance_loss: 0.4197, weighted_loss: 0.5326, label: 4, bag_size: 356
batch 279, loss: 0.9120, instance_loss: 0.4663, weighted_loss: 0.7783, label: 4, bag_size: 639
batch 299, loss: 1.5015, instance_loss: 0.5736, weighted_loss: 1.2231, label: 4, bag_size: 683
batch 319, loss: 0.0464, instance_loss: 0.4001, weighted_loss: 0.1525, label: 0, bag_size: 15
batch 339, loss: 0.0533, instance_loss: 0.2169, weighted_loss: 0.1023, label: 0, bag_size: 212
batch 359, loss: 0.4828, instance_loss: 0.4637, weighted_loss: 0.4771, label: 1, bag_size: 1103
batch 379, loss: 0.3401, instance_loss: 0.7689, weighted_loss: 0.4688, label: 4, bag_size: 359
batch 399, loss: 0.9136, instance_loss: 0.5429, weighted_loss: 0.8024, label: 1, bag_size: 389
batch 419, loss: 0.9350, instance_loss: 0.4932, weighted_loss: 0.8025, label: 4, bag_size: 176
batch 439, loss: 0.5635, instance_loss: 0.4572, weighted_loss: 0.5316, label: 3, bag_size: 97
batch 459, loss: 0.0675, instance_loss: 0.2509, weighted_loss: 0.1225, label: 0, bag_size: 79
batch 479, loss: 3.8715, instance_loss: 0.6593, weighted_loss: 2.9079, label: 2, bag_size: 720
batch 499, loss: 1.7515, instance_loss: 0.7598, weighted_loss: 1.4540, label: 3, bag_size: 107
batch 519, loss: 0.9261, instance_loss: 0.4673, weighted_loss: 0.7885, label: 1, bag_size: 906
batch 539, loss: 0.5542, instance_loss: 0.5147, weighted_loss: 0.5423, label: 4, bag_size: 267
batch 559, loss: 0.0056, instance_loss: 0.2365, weighted_loss: 0.0748, label: 0, bag_size: 88
batch 579, loss: 1.5564, instance_loss: 0.4669, weighted_loss: 1.2295, label: 2, bag_size: 258


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.06460437710437711: correct 307/4752
Epoch: 44, train_loss: 0.9853, train_clustering_loss:  0.4733, train_error: 0.3956
class 0: acc 0.8478260869565217, correct 117/138
class 1: acc 0.6176470588235294, correct 84/136
class 2: acc 0.39215686274509803, correct 40/102
class 3: acc 0.4857142857142857, correct 51/105
class 4: acc 0.5929203539823009, correct 67/113

Val Set, val_loss: 1.2976, val_error: 0.5270, auc: 0.8019
class 0 clustering acc 0.9972972972972973: correct 2952/2960
class 1 clustering acc 0.07432432432432433: correct 44/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.8375, instance_loss: 0.5095, weighted_loss: 0.7391, label: 1, bag_size: 906
batch 39, loss: 0.7581, instance_loss: 0.4366, weighted_loss: 0.6616, label: 4, bag_size: 604
batch 59, loss: 1.0250, instance_loss: 0.4229, weighted_loss: 0.8443, label: 3, bag_size: 488
batch 79, loss: 1.2495, instance_loss: 0.9097, weighted_loss: 1.1476, label: 0, bag_size: 283
batch 99, loss: 1.0910, instance_loss: 0.6242, weighted_loss: 0.9509, label: 3, bag_size: 1060
batch 119, loss: 1.2124, instance_loss: 0.4693, weighted_loss: 0.9894, label: 1, bag_size: 201
batch 139, loss: 0.3795, instance_loss: 0.4521, weighted_loss: 0.4013, label: 4, bag_size: 824
batch 159, loss: 1.4077, instance_loss: 0.5590, weighted_loss: 1.1531, label: 1, bag_size: 413
batch 179, loss: 1.1605, instance_loss: 0.4525, weighted_loss: 0.9481, label: 4, bag_size: 333
batch 199, loss: 1.3774, instance_loss: 0.5817, weighted_loss: 1.1386, label: 2, bag_size: 812
batch 219, loss: 0.3809, instance_loss: 0.3504, weighted_loss: 0.3718, label: 0, bag_size: 613
batch 239, loss: 0.1795, instance_loss: 0.3491, weighted_loss: 0.2304, label: 0, bag_size: 428
batch 259, loss: 0.8455, instance_loss: 0.5268, weighted_loss: 0.7499, label: 1, bag_size: 865
batch 279, loss: 1.9149, instance_loss: 0.5651, weighted_loss: 1.5099, label: 2, bag_size: 297
batch 299, loss: 0.2580, instance_loss: 0.4687, weighted_loss: 0.3212, label: 4, bag_size: 854
batch 319, loss: 0.2468, instance_loss: 0.4119, weighted_loss: 0.2963, label: 2, bag_size: 557
batch 339, loss: 1.7761, instance_loss: 0.5161, weighted_loss: 1.3981, label: 4, bag_size: 356
batch 359, loss: 1.2319, instance_loss: 0.4740, weighted_loss: 1.0046, label: 1, bag_size: 695
batch 379, loss: 0.6540, instance_loss: 0.4174, weighted_loss: 0.5830, label: 4, bag_size: 683
batch 399, loss: 1.0390, instance_loss: 0.5831, weighted_loss: 0.9022, label: 2, bag_size: 25
batch 419, loss: 1.3200, instance_loss: 0.4982, weighted_loss: 1.0735, label: 1, bag_size: 1013
batch 439, loss: 0.8321, instance_loss: 0.5884, weighted_loss: 0.7590, label: 4, bag_size: 1113
batch 459, loss: 0.9486, instance_loss: 0.5243, weighted_loss: 0.8213, label: 0, bag_size: 62
batch 479, loss: 0.4069, instance_loss: 0.4291, weighted_loss: 0.4135, label: 1, bag_size: 544
batch 499, loss: 4.6347, instance_loss: 0.7441, weighted_loss: 3.4675, label: 0, bag_size: 169
batch 519, loss: 0.8337, instance_loss: 0.4987, weighted_loss: 0.7332, label: 0, bag_size: 587
batch 539, loss: 0.7679, instance_loss: 0.5398, weighted_loss: 0.6995, label: 4, bag_size: 776
batch 559, loss: 0.4696, instance_loss: 0.3712, weighted_loss: 0.4401, label: 2, bag_size: 754
batch 579, loss: 0.5256, instance_loss: 0.4791, weighted_loss: 0.5117, label: 2, bag_size: 363


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.06018518518518518: correct 286/4752
Epoch: 45, train_loss: 1.0361, train_clustering_loss:  0.4864, train_error: 0.4428
class 0: acc 0.8076923076923077, correct 105/130
class 1: acc 0.4537037037037037, correct 49/108
class 2: acc 0.4375, correct 56/128
class 3: acc 0.4473684210526316, correct 51/114
class 4: acc 0.6140350877192983, correct 70/114

Val Set, val_loss: 1.4363, val_error: 0.5946, auc: 0.7749
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.5664, instance_loss: 0.5334, weighted_loss: 0.5565, label: 3, bag_size: 1001
batch 39, loss: 1.0402, instance_loss: 0.4869, weighted_loss: 0.8742, label: 3, bag_size: 274
batch 59, loss: 1.3248, instance_loss: 0.5612, weighted_loss: 1.0957, label: 1, bag_size: 1043
batch 79, loss: 0.0622, instance_loss: 0.2719, weighted_loss: 0.1251, label: 0, bag_size: 79
batch 99, loss: 0.7638, instance_loss: 0.5745, weighted_loss: 0.7070, label: 2, bag_size: 713
batch 119, loss: 1.5404, instance_loss: 0.5745, weighted_loss: 1.2506, label: 1, bag_size: 483
batch 139, loss: 0.0159, instance_loss: 0.1963, weighted_loss: 0.0700, label: 0, bag_size: 98
batch 159, loss: 0.0043, instance_loss: 0.1649, weighted_loss: 0.0525, label: 0, bag_size: 133
batch 179, loss: 0.0038, instance_loss: 0.1272, weighted_loss: 0.0409, label: 0, bag_size: 133
batch 199, loss: 0.7194, instance_loss: 0.4700, weighted_loss: 0.6446, label: 4, bag_size: 520
batch 219, loss: 1.3368, instance_loss: 0.5468, weighted_loss: 1.0998, label: 1, bag_size: 949
batch 239, loss: 0.3450, instance_loss: 0.5003, weighted_loss: 0.3916, label: 4, bag_size: 725
batch 259, loss: 1.0922, instance_loss: 0.5503, weighted_loss: 0.9297, label: 4, bag_size: 72
batch 279, loss: 0.6790, instance_loss: 0.4361, weighted_loss: 0.6061, label: 2, bag_size: 607
batch 299, loss: 0.4941, instance_loss: 0.4386, weighted_loss: 0.4774, label: 2, bag_size: 290
batch 319, loss: 0.7684, instance_loss: 0.4696, weighted_loss: 0.6788, label: 2, bag_size: 290
batch 339, loss: 0.0821, instance_loss: 0.3763, weighted_loss: 0.1704, label: 2, bag_size: 614
batch 359, loss: 0.8357, instance_loss: 0.4507, weighted_loss: 0.7202, label: 2, bag_size: 633
batch 379, loss: 5.2537, instance_loss: 0.8252, weighted_loss: 3.9251, label: 3, bag_size: 795
batch 399, loss: 0.8648, instance_loss: 0.4523, weighted_loss: 0.7411, label: 1, bag_size: 460
batch 419, loss: 1.2009, instance_loss: 0.4875, weighted_loss: 0.9869, label: 3, bag_size: 393
batch 439, loss: 0.6728, instance_loss: 0.4844, weighted_loss: 0.6163, label: 1, bag_size: 221
batch 459, loss: 0.4558, instance_loss: 0.4449, weighted_loss: 0.4526, label: 1, bag_size: 972
batch 479, loss: 0.0851, instance_loss: 0.4137, weighted_loss: 0.1837, label: 0, bag_size: 73
batch 499, loss: 0.8562, instance_loss: 0.5098, weighted_loss: 0.7523, label: 2, bag_size: 853
batch 519, loss: 1.8185, instance_loss: 0.4790, weighted_loss: 1.4166, label: 1, bag_size: 500
batch 539, loss: 0.3846, instance_loss: 0.6147, weighted_loss: 0.4536, label: 2, bag_size: 713
batch 559, loss: 0.7932, instance_loss: 0.4059, weighted_loss: 0.6770, label: 3, bag_size: 684
batch 579, loss: 0.8781, instance_loss: 0.5527, weighted_loss: 0.7805, label: 0, bag_size: 455


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.06102693602693603: correct 290/4752
Epoch: 46, train_loss: 1.0082, train_clustering_loss:  0.4803, train_error: 0.4192
class 0: acc 0.8189655172413793, correct 95/116
class 1: acc 0.5128205128205128, correct 60/117
class 2: acc 0.5307692307692308, correct 69/130
class 3: acc 0.39090909090909093, correct 43/110
class 4: acc 0.6446280991735537, correct 78/121

Val Set, val_loss: 1.4009, val_error: 0.4865, auc: 0.7819
class 0 clustering acc 0.9935810810810811: correct 2941/2960
class 1 clustering acc 0.05912162162162162: correct 35/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9076, instance_loss: 0.4132, weighted_loss: 0.7593, label: 1, bag_size: 1013
batch 39, loss: 2.0311, instance_loss: 0.5089, weighted_loss: 1.5745, label: 2, bag_size: 299
batch 59, loss: 1.1717, instance_loss: 0.5482, weighted_loss: 0.9847, label: 3, bag_size: 486
batch 79, loss: 0.8978, instance_loss: 0.4352, weighted_loss: 0.7590, label: 4, bag_size: 482
batch 99, loss: 0.0636, instance_loss: 0.2734, weighted_loss: 0.1265, label: 0, bag_size: 175
batch 119, loss: 0.9848, instance_loss: 0.5238, weighted_loss: 0.8465, label: 2, bag_size: 592
batch 139, loss: 0.8507, instance_loss: 0.6510, weighted_loss: 0.7908, label: 2, bag_size: 769
batch 159, loss: 1.0969, instance_loss: 0.4498, weighted_loss: 0.9028, label: 3, bag_size: 944
batch 179, loss: 2.0181, instance_loss: 0.5891, weighted_loss: 1.5894, label: 2, bag_size: 498
batch 199, loss: 0.0004, instance_loss: 0.3099, weighted_loss: 0.0933, label: 2, bag_size: 553
batch 219, loss: 0.9659, instance_loss: 0.5214, weighted_loss: 0.8325, label: 4, bag_size: 1041
batch 239, loss: 0.5581, instance_loss: 0.4660, weighted_loss: 0.5304, label: 3, bag_size: 235
batch 259, loss: 0.3137, instance_loss: 0.4840, weighted_loss: 0.3648, label: 2, bag_size: 684
batch 279, loss: 1.0919, instance_loss: 0.4947, weighted_loss: 0.9127, label: 3, bag_size: 499
batch 299, loss: 0.4735, instance_loss: 0.6933, weighted_loss: 0.5394, label: 4, bag_size: 746
batch 319, loss: 3.1543, instance_loss: 0.5941, weighted_loss: 2.3862, label: 2, bag_size: 629
batch 339, loss: 1.0928, instance_loss: 0.5945, weighted_loss: 0.9433, label: 3, bag_size: 403
batch 359, loss: 0.5675, instance_loss: 0.4837, weighted_loss: 0.5423, label: 3, bag_size: 727
batch 379, loss: 4.5614, instance_loss: 0.7593, weighted_loss: 3.4208, label: 2, bag_size: 488
batch 399, loss: 0.7589, instance_loss: 0.3933, weighted_loss: 0.6492, label: 3, bag_size: 496
batch 419, loss: 0.5690, instance_loss: 0.4984, weighted_loss: 0.5479, label: 0, bag_size: 517
batch 439, loss: 1.4267, instance_loss: 0.6168, weighted_loss: 1.1838, label: 2, bag_size: 303
batch 459, loss: 0.0565, instance_loss: 0.3056, weighted_loss: 0.1312, label: 0, bag_size: 366
batch 479, loss: 0.4743, instance_loss: 0.4874, weighted_loss: 0.4782, label: 0, bag_size: 223
batch 499, loss: 0.1556, instance_loss: 0.3584, weighted_loss: 0.2164, label: 0, bag_size: 319
batch 519, loss: 0.5058, instance_loss: 0.4694, weighted_loss: 0.4949, label: 3, bag_size: 322
batch 539, loss: 0.6444, instance_loss: 0.4476, weighted_loss: 0.5853, label: 3, bag_size: 872
batch 559, loss: 0.4184, instance_loss: 0.6101, weighted_loss: 0.4759, label: 0, bag_size: 477
batch 579, loss: 0.9494, instance_loss: 0.5398, weighted_loss: 0.8266, label: 3, bag_size: 795


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.04208754208754209: correct 200/4752
Epoch: 47, train_loss: 1.0578, train_clustering_loss:  0.4876, train_error: 0.4242
class 0: acc 0.8226950354609929, correct 116/141
class 1: acc 0.5344827586206896, correct 62/116
class 2: acc 0.2972972972972973, correct 33/111
class 3: acc 0.5645161290322581, correct 70/124
class 4: acc 0.5980392156862745, correct 61/102

Val Set, val_loss: 1.3712, val_error: 0.5811, auc: 0.8031
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.04560810810810811: correct 27/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3475, instance_loss: 0.5603, weighted_loss: 0.4113, label: 1, bag_size: 141
batch 39, loss: 0.0932, instance_loss: 0.4828, weighted_loss: 0.2101, label: 1, bag_size: 371
batch 59, loss: 2.6557, instance_loss: 0.6296, weighted_loss: 2.0479, label: 0, bag_size: 1039
batch 79, loss: 2.4501, instance_loss: 0.5401, weighted_loss: 1.8771, label: 3, bag_size: 533
batch 99, loss: 0.4260, instance_loss: 0.4554, weighted_loss: 0.4348, label: 3, bag_size: 309
batch 119, loss: 1.5146, instance_loss: 0.5204, weighted_loss: 1.2164, label: 2, bag_size: 640
batch 139, loss: 0.9306, instance_loss: 0.4906, weighted_loss: 0.7986, label: 1, bag_size: 949
batch 159, loss: 4.2605, instance_loss: 0.6364, weighted_loss: 3.1733, label: 4, bag_size: 699
batch 179, loss: 0.0000, instance_loss: 0.3356, weighted_loss: 0.1007, label: 2, bag_size: 936
batch 199, loss: 0.0022, instance_loss: 0.4678, weighted_loss: 0.1419, label: 0, bag_size: 340
batch 219, loss: 0.6775, instance_loss: 0.4413, weighted_loss: 0.6066, label: 3, bag_size: 1021
batch 239, loss: 1.1867, instance_loss: 0.6215, weighted_loss: 1.0172, label: 1, bag_size: 618
batch 259, loss: 0.0358, instance_loss: 0.3318, weighted_loss: 0.1246, label: 0, bag_size: 357
batch 279, loss: 0.6278, instance_loss: 0.4663, weighted_loss: 0.5793, label: 1, bag_size: 410
batch 299, loss: 2.7142, instance_loss: 0.5274, weighted_loss: 2.0582, label: 2, bag_size: 829
batch 319, loss: 0.9865, instance_loss: 0.4614, weighted_loss: 0.8290, label: 3, bag_size: 996
batch 339, loss: 0.2620, instance_loss: 0.3909, weighted_loss: 0.3007, label: 0, bag_size: 493
batch 359, loss: 0.7541, instance_loss: 0.4929, weighted_loss: 0.6758, label: 3, bag_size: 625
batch 379, loss: 0.8876, instance_loss: 0.4438, weighted_loss: 0.7545, label: 0, bag_size: 277
batch 399, loss: 0.0670, instance_loss: 0.3379, weighted_loss: 0.1483, label: 0, bag_size: 351
batch 419, loss: 1.2938, instance_loss: 0.4658, weighted_loss: 1.0454, label: 2, bag_size: 1003
batch 439, loss: 0.5134, instance_loss: 0.4586, weighted_loss: 0.4970, label: 4, bag_size: 775
batch 459, loss: 0.1284, instance_loss: 0.4778, weighted_loss: 0.2332, label: 0, bag_size: 760
batch 479, loss: 0.1959, instance_loss: 0.3489, weighted_loss: 0.2418, label: 1, bag_size: 886
batch 499, loss: 0.6957, instance_loss: 0.4605, weighted_loss: 0.6251, label: 0, bag_size: 615
batch 519, loss: 0.2630, instance_loss: 0.3871, weighted_loss: 0.3002, label: 0, bag_size: 76
batch 539, loss: 1.5296, instance_loss: 0.5684, weighted_loss: 1.2413, label: 2, bag_size: 135
batch 559, loss: 0.0088, instance_loss: 0.2072, weighted_loss: 0.0683, label: 0, bag_size: 366
batch 579, loss: 0.5922, instance_loss: 0.5203, weighted_loss: 0.5706, label: 2, bag_size: 708


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.04650673400673401: correct 221/4752
Epoch: 48, train_loss: 0.9553, train_clustering_loss:  0.4771, train_error: 0.3990
class 0: acc 0.8661971830985915, correct 123/142
class 1: acc 0.5689655172413793, correct 66/116
class 2: acc 0.3391304347826087, correct 39/115
class 3: acc 0.6260869565217392, correct 72/115
class 4: acc 0.5377358490566038, correct 57/106

Val Set, val_loss: 1.2519, val_error: 0.4865, auc: 0.8172
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.07601351351351351: correct 45/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.4287, instance_loss: 0.5195, weighted_loss: 1.1559, label: 1, bag_size: 355
batch 39, loss: 0.9814, instance_loss: 0.4809, weighted_loss: 0.8312, label: 1, bag_size: 748
batch 59, loss: 1.4194, instance_loss: 0.5389, weighted_loss: 1.1553, label: 2, bag_size: 640
batch 79, loss: 1.3510, instance_loss: 0.5259, weighted_loss: 1.1034, label: 2, bag_size: 1074
batch 99, loss: 0.4147, instance_loss: 0.4904, weighted_loss: 0.4374, label: 4, bag_size: 46
batch 119, loss: 0.5236, instance_loss: 0.4233, weighted_loss: 0.4935, label: 4, bag_size: 875
batch 139, loss: 0.9986, instance_loss: 0.5167, weighted_loss: 0.8540, label: 1, bag_size: 398
batch 159, loss: 0.9422, instance_loss: 0.4636, weighted_loss: 0.7986, label: 1, bag_size: 389
batch 179, loss: 0.2846, instance_loss: 0.5703, weighted_loss: 0.3703, label: 0, bag_size: 477
batch 199, loss: 0.5478, instance_loss: 0.4796, weighted_loss: 0.5274, label: 1, bag_size: 766
batch 219, loss: 1.8333, instance_loss: 0.6396, weighted_loss: 1.4752, label: 2, bag_size: 208
batch 239, loss: 1.0123, instance_loss: 0.5358, weighted_loss: 0.8694, label: 3, bag_size: 523
batch 259, loss: 0.0170, instance_loss: 0.4007, weighted_loss: 0.1321, label: 0, bag_size: 383
batch 279, loss: 0.1852, instance_loss: 0.4254, weighted_loss: 0.2573, label: 0, bag_size: 354
batch 299, loss: 0.2236, instance_loss: 0.4930, weighted_loss: 0.3044, label: 0, bag_size: 316
batch 319, loss: 0.7749, instance_loss: 0.4830, weighted_loss: 0.6873, label: 3, bag_size: 274
batch 339, loss: 1.6512, instance_loss: 0.5105, weighted_loss: 1.3090, label: 1, bag_size: 988
batch 359, loss: 1.6109, instance_loss: 0.5856, weighted_loss: 1.3033, label: 4, bag_size: 260
batch 379, loss: 0.7503, instance_loss: 0.4564, weighted_loss: 0.6622, label: 1, bag_size: 271
batch 399, loss: 1.9865, instance_loss: 0.5563, weighted_loss: 1.5575, label: 4, bag_size: 312
batch 419, loss: 0.0513, instance_loss: 0.4445, weighted_loss: 0.1693, label: 1, bag_size: 522
batch 439, loss: 0.0177, instance_loss: 0.2679, weighted_loss: 0.0928, label: 0, bag_size: 523
batch 459, loss: 0.0772, instance_loss: 0.3299, weighted_loss: 0.1530, label: 0, bag_size: 552
batch 479, loss: 0.7892, instance_loss: 0.4126, weighted_loss: 0.6763, label: 4, bag_size: 731
batch 499, loss: 3.0486, instance_loss: 0.6789, weighted_loss: 2.3377, label: 4, bag_size: 310
batch 519, loss: 1.2971, instance_loss: 0.5555, weighted_loss: 1.0746, label: 4, bag_size: 176
batch 539, loss: 0.7218, instance_loss: 0.4672, weighted_loss: 0.6454, label: 1, bag_size: 748
batch 559, loss: 1.6877, instance_loss: 0.6038, weighted_loss: 1.3625, label: 0, bag_size: 710
batch 579, loss: 1.0497, instance_loss: 0.4751, weighted_loss: 0.8773, label: 3, bag_size: 1076


class 0 clustering acc 0.9973905723905724: correct 23698/23760
class 1 clustering acc 0.04292929292929293: correct 204/4752
Epoch: 49, train_loss: 1.0632, train_clustering_loss:  0.4837, train_error: 0.4529
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.49612403100775193, correct 64/129
class 2: acc 0.3508771929824561, correct 40/114
class 3: acc 0.5289256198347108, correct 64/121
class 4: acc 0.5596330275229358, correct 61/109

Val Set, val_loss: 1.2180, val_error: 0.5270, auc: 0.8137
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.057432432432432436: correct 34/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 2.2796, instance_loss: 0.5691, weighted_loss: 1.7664, label: 2, bag_size: 629
batch 39, loss: 1.1648, instance_loss: 0.5794, weighted_loss: 0.9892, label: 3, bag_size: 608
batch 59, loss: 0.6947, instance_loss: 0.5241, weighted_loss: 0.6435, label: 3, bag_size: 858
batch 79, loss: 1.1946, instance_loss: 0.5242, weighted_loss: 0.9935, label: 4, bag_size: 729
batch 99, loss: 1.2119, instance_loss: 0.5846, weighted_loss: 1.0237, label: 0, bag_size: 343
batch 119, loss: 0.6459, instance_loss: 0.5566, weighted_loss: 0.6191, label: 2, bag_size: 713
batch 139, loss: 0.9623, instance_loss: 0.4937, weighted_loss: 0.8217, label: 4, bag_size: 923
batch 159, loss: 0.9775, instance_loss: 0.5225, weighted_loss: 0.8410, label: 4, bag_size: 729
batch 179, loss: 0.8779, instance_loss: 0.5173, weighted_loss: 0.7697, label: 1, bag_size: 311
batch 199, loss: 1.1906, instance_loss: 0.5197, weighted_loss: 0.9894, label: 2, bag_size: 731
batch 219, loss: 0.9652, instance_loss: 0.4649, weighted_loss: 0.8151, label: 1, bag_size: 408
batch 239, loss: 0.8057, instance_loss: 0.7910, weighted_loss: 0.8013, label: 3, bag_size: 794
batch 259, loss: 2.6293, instance_loss: 0.5454, weighted_loss: 2.0041, label: 2, bag_size: 1071
batch 279, loss: 0.7856, instance_loss: 0.4488, weighted_loss: 0.6845, label: 3, bag_size: 857
batch 299, loss: 2.6008, instance_loss: 0.4896, weighted_loss: 1.9675, label: 3, bag_size: 508
batch 319, loss: 0.9810, instance_loss: 0.4405, weighted_loss: 0.8189, label: 2, bag_size: 651
batch 339, loss: 2.2719, instance_loss: 0.5675, weighted_loss: 1.7606, label: 4, bag_size: 726
batch 359, loss: 1.2675, instance_loss: 0.5530, weighted_loss: 1.0532, label: 0, bag_size: 81
batch 379, loss: 0.8313, instance_loss: 0.4786, weighted_loss: 0.7255, label: 1, bag_size: 384
batch 399, loss: 2.2283, instance_loss: 0.5526, weighted_loss: 1.7256, label: 2, bag_size: 909
batch 419, loss: 0.8754, instance_loss: 0.5922, weighted_loss: 0.7904, label: 3, bag_size: 894
batch 439, loss: 0.1727, instance_loss: 0.4245, weighted_loss: 0.2482, label: 4, bag_size: 160
batch 459, loss: 0.6263, instance_loss: 0.4952, weighted_loss: 0.5870, label: 0, bag_size: 613
batch 479, loss: 2.1442, instance_loss: 0.5844, weighted_loss: 1.6763, label: 2, bag_size: 512
batch 499, loss: 0.4627, instance_loss: 0.4568, weighted_loss: 0.4609, label: 4, bag_size: 665
batch 519, loss: 0.7676, instance_loss: 0.4952, weighted_loss: 0.6859, label: 2, bag_size: 572
batch 539, loss: 1.5723, instance_loss: 0.6191, weighted_loss: 1.2863, label: 3, bag_size: 497
batch 559, loss: 0.4011, instance_loss: 0.6096, weighted_loss: 0.4636, label: 4, bag_size: 1113
batch 579, loss: 1.3660, instance_loss: 0.4993, weighted_loss: 1.1060, label: 4, bag_size: 198


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.0563973063973064: correct 268/4752
Epoch: 50, train_loss: 0.9561, train_clustering_loss:  0.4827, train_error: 0.4226
class 0: acc 0.8015873015873016, correct 101/126
class 1: acc 0.5267857142857143, correct 59/112
class 2: acc 0.416, correct 52/125
class 3: acc 0.5178571428571429, correct 58/112
class 4: acc 0.6134453781512605, correct 73/119

Val Set, val_loss: 1.2925, val_error: 0.5000, auc: 0.7971
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.10472972972972973: correct 62/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 3.4243, instance_loss: 0.6865, weighted_loss: 2.6029, label: 0, bag_size: 1039
batch 39, loss: 0.0610, instance_loss: 0.3400, weighted_loss: 0.1447, label: 0, bag_size: 227
batch 59, loss: 0.8625, instance_loss: 0.5059, weighted_loss: 0.7555, label: 0, bag_size: 183
batch 79, loss: 0.3860, instance_loss: 0.4079, weighted_loss: 0.3926, label: 3, bag_size: 272
batch 99, loss: 0.0397, instance_loss: 0.2823, weighted_loss: 0.1125, label: 0, bag_size: 74
batch 119, loss: 0.3824, instance_loss: 0.4584, weighted_loss: 0.4052, label: 3, bag_size: 476
batch 139, loss: 0.3744, instance_loss: 0.4450, weighted_loss: 0.3956, label: 3, bag_size: 272
batch 159, loss: 0.6116, instance_loss: 0.4799, weighted_loss: 0.5721, label: 4, bag_size: 1041
batch 179, loss: 0.0267, instance_loss: 0.2125, weighted_loss: 0.0825, label: 0, bag_size: 399
batch 199, loss: 0.6008, instance_loss: 0.4228, weighted_loss: 0.5474, label: 3, bag_size: 739
batch 219, loss: 0.0102, instance_loss: 0.2793, weighted_loss: 0.0909, label: 0, bag_size: 340
batch 239, loss: 0.7795, instance_loss: 0.4504, weighted_loss: 0.6808, label: 4, bag_size: 46
batch 259, loss: 1.3745, instance_loss: 0.4706, weighted_loss: 1.1033, label: 4, bag_size: 244
batch 279, loss: 1.0167, instance_loss: 0.5129, weighted_loss: 0.8656, label: 3, bag_size: 317
batch 299, loss: 1.3383, instance_loss: 0.5063, weighted_loss: 1.0887, label: 4, bag_size: 196
batch 319, loss: 0.6951, instance_loss: 0.4067, weighted_loss: 0.6086, label: 4, bag_size: 895
batch 339, loss: 0.9845, instance_loss: 0.4653, weighted_loss: 0.8288, label: 3, bag_size: 166
batch 359, loss: 2.3417, instance_loss: 0.5497, weighted_loss: 1.8041, label: 2, bag_size: 498
batch 379, loss: 0.7534, instance_loss: 0.4284, weighted_loss: 0.6559, label: 2, bag_size: 369
batch 399, loss: 2.9576, instance_loss: 0.5951, weighted_loss: 2.2489, label: 1, bag_size: 184
batch 419, loss: 0.0323, instance_loss: 0.2200, weighted_loss: 0.0886, label: 0, bag_size: 69
batch 439, loss: 1.0039, instance_loss: 0.3838, weighted_loss: 0.8179, label: 1, bag_size: 461
batch 459, loss: 2.6036, instance_loss: 0.6002, weighted_loss: 2.0025, label: 2, bag_size: 1071
batch 479, loss: 0.3673, instance_loss: 0.4816, weighted_loss: 0.4016, label: 4, bag_size: 293
batch 499, loss: 0.3810, instance_loss: 0.4935, weighted_loss: 0.4147, label: 4, bag_size: 263
batch 519, loss: 0.1936, instance_loss: 0.3814, weighted_loss: 0.2499, label: 4, bag_size: 409
batch 539, loss: 0.5892, instance_loss: 0.4572, weighted_loss: 0.5496, label: 3, bag_size: 309
batch 559, loss: 0.0678, instance_loss: 0.2151, weighted_loss: 0.1120, label: 0, bag_size: 493
batch 579, loss: 0.3392, instance_loss: 0.3647, weighted_loss: 0.3468, label: 0, bag_size: 76


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.054292929292929296: correct 258/4752
Epoch: 51, train_loss: 1.0109, train_clustering_loss:  0.4837, train_error: 0.4209
class 0: acc 0.7692307692307693, correct 80/104
class 1: acc 0.5877192982456141, correct 67/114
class 2: acc 0.32456140350877194, correct 37/114
class 3: acc 0.6541353383458647, correct 87/133
class 4: acc 0.5658914728682171, correct 73/129

Val Set, val_loss: 1.2708, val_error: 0.5135, auc: 0.8049
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.07263513513513513: correct 43/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3970, instance_loss: 0.3938, weighted_loss: 0.3961, label: 2, bag_size: 1079
batch 39, loss: 1.0262, instance_loss: 0.5756, weighted_loss: 0.8910, label: 3, bag_size: 1186
batch 59, loss: 1.5540, instance_loss: 0.5666, weighted_loss: 1.2578, label: 3, bag_size: 166
batch 79, loss: 1.3162, instance_loss: 0.4559, weighted_loss: 1.0581, label: 4, bag_size: 270
batch 99, loss: 0.7775, instance_loss: 0.5459, weighted_loss: 0.7080, label: 1, bag_size: 544
batch 119, loss: 0.5021, instance_loss: 0.4696, weighted_loss: 0.4924, label: 1, bag_size: 906
batch 139, loss: 0.2732, instance_loss: 0.6114, weighted_loss: 0.3746, label: 1, bag_size: 106
batch 159, loss: 0.2224, instance_loss: 0.4119, weighted_loss: 0.2793, label: 2, bag_size: 614
batch 179, loss: 2.3011, instance_loss: 0.6146, weighted_loss: 1.7952, label: 3, bag_size: 638
batch 199, loss: 0.5714, instance_loss: 0.4483, weighted_loss: 0.5345, label: 1, bag_size: 1104
batch 219, loss: 0.4635, instance_loss: 0.4076, weighted_loss: 0.4467, label: 2, bag_size: 1013
batch 239, loss: 1.3242, instance_loss: 0.5035, weighted_loss: 1.0780, label: 1, bag_size: 660
batch 259, loss: 0.5803, instance_loss: 0.4722, weighted_loss: 0.5478, label: 1, bag_size: 534
batch 279, loss: 1.5404, instance_loss: 0.5563, weighted_loss: 1.2451, label: 2, bag_size: 861
batch 299, loss: 0.8961, instance_loss: 0.6017, weighted_loss: 0.8077, label: 3, bag_size: 1186
batch 319, loss: 0.0860, instance_loss: 0.3008, weighted_loss: 0.1504, label: 0, bag_size: 399
batch 339, loss: 0.7410, instance_loss: 0.4618, weighted_loss: 0.6573, label: 2, bag_size: 883
batch 359, loss: 0.4436, instance_loss: 0.4838, weighted_loss: 0.4557, label: 3, bag_size: 476
batch 379, loss: 1.7312, instance_loss: 0.6034, weighted_loss: 1.3929, label: 1, bag_size: 328
batch 399, loss: 0.9289, instance_loss: 0.4831, weighted_loss: 0.7951, label: 3, bag_size: 364
batch 419, loss: 0.0298, instance_loss: 0.2934, weighted_loss: 0.1089, label: 0, bag_size: 103
batch 439, loss: 0.8663, instance_loss: 0.4777, weighted_loss: 0.7497, label: 4, bag_size: 53
batch 459, loss: 0.1563, instance_loss: 0.4721, weighted_loss: 0.2510, label: 1, bag_size: 748
batch 479, loss: 1.1812, instance_loss: 0.5300, weighted_loss: 0.9859, label: 2, bag_size: 185
batch 499, loss: 0.0614, instance_loss: 0.4230, weighted_loss: 0.1699, label: 0, bag_size: 370
batch 519, loss: 0.0836, instance_loss: 0.3309, weighted_loss: 0.1578, label: 0, bag_size: 355
batch 539, loss: 1.3243, instance_loss: 0.5846, weighted_loss: 1.1024, label: 3, bag_size: 897
batch 559, loss: 1.5909, instance_loss: 0.5349, weighted_loss: 1.2741, label: 4, bag_size: 572
batch 579, loss: 0.7687, instance_loss: 0.4839, weighted_loss: 0.6833, label: 3, bag_size: 737


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.057028619528619526: correct 271/4752
Epoch: 52, train_loss: 0.9961, train_clustering_loss:  0.4836, train_error: 0.4545
class 0: acc 0.8137254901960784, correct 83/102
class 1: acc 0.3173076923076923, correct 33/104
class 2: acc 0.5517241379310345, correct 80/145
class 3: acc 0.45081967213114754, correct 55/122
class 4: acc 0.6033057851239669, correct 73/121

Val Set, val_loss: 1.3529, val_error: 0.4730, auc: 0.7900
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.05405405405405406: correct 32/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.8561, instance_loss: 0.6502, weighted_loss: 0.7944, label: 0, bag_size: 367
batch 39, loss: 1.0016, instance_loss: 0.4290, weighted_loss: 0.8298, label: 3, bag_size: 499
batch 59, loss: 0.0967, instance_loss: 0.3285, weighted_loss: 0.1663, label: 0, bag_size: 493
batch 79, loss: 3.3250, instance_loss: 0.8993, weighted_loss: 2.5973, label: 1, bag_size: 153
batch 99, loss: 0.3565, instance_loss: 0.5474, weighted_loss: 0.4138, label: 2, bag_size: 288
batch 119, loss: 0.5964, instance_loss: 0.4166, weighted_loss: 0.5425, label: 3, bag_size: 97
batch 139, loss: 1.2835, instance_loss: 0.4933, weighted_loss: 1.0464, label: 2, bag_size: 1077
batch 159, loss: 1.2344, instance_loss: 0.5717, weighted_loss: 1.0356, label: 3, bag_size: 1147
batch 179, loss: 0.1629, instance_loss: 0.3371, weighted_loss: 0.2152, label: 4, bag_size: 394
batch 199, loss: 0.9281, instance_loss: 0.5212, weighted_loss: 0.8061, label: 2, bag_size: 168
batch 219, loss: 0.4369, instance_loss: 0.4140, weighted_loss: 0.4300, label: 1, bag_size: 1104
batch 239, loss: 1.1416, instance_loss: 0.5062, weighted_loss: 0.9510, label: 2, bag_size: 645
batch 259, loss: 0.5812, instance_loss: 0.5590, weighted_loss: 0.5745, label: 1, bag_size: 410
batch 279, loss: 0.8891, instance_loss: 0.4628, weighted_loss: 0.7612, label: 2, bag_size: 567
batch 299, loss: 0.9369, instance_loss: 0.4484, weighted_loss: 0.7903, label: 2, bag_size: 853
batch 319, loss: 0.5992, instance_loss: 0.4702, weighted_loss: 0.5605, label: 2, bag_size: 708
batch 339, loss: 1.5746, instance_loss: 0.6121, weighted_loss: 1.2858, label: 1, bag_size: 161
batch 359, loss: 0.6376, instance_loss: 0.4963, weighted_loss: 0.5952, label: 3, bag_size: 1147
batch 379, loss: 1.1546, instance_loss: 0.4804, weighted_loss: 0.9523, label: 2, bag_size: 445
batch 399, loss: 0.1101, instance_loss: 0.2432, weighted_loss: 0.1500, label: 0, bag_size: 188
batch 419, loss: 0.9121, instance_loss: 0.4522, weighted_loss: 0.7741, label: 4, bag_size: 960
batch 439, loss: 1.1090, instance_loss: 0.4921, weighted_loss: 0.9239, label: 1, bag_size: 658
batch 459, loss: 0.9300, instance_loss: 0.4463, weighted_loss: 0.7849, label: 1, bag_size: 660
batch 479, loss: 0.0098, instance_loss: 0.3124, weighted_loss: 0.1006, label: 0, bag_size: 49
batch 499, loss: 0.5655, instance_loss: 0.4516, weighted_loss: 0.5313, label: 3, bag_size: 476
batch 519, loss: 2.1498, instance_loss: 0.4928, weighted_loss: 1.6527, label: 1, bag_size: 972
batch 539, loss: 0.6208, instance_loss: 0.4705, weighted_loss: 0.5757, label: 3, bag_size: 245
batch 559, loss: 2.3382, instance_loss: 0.7183, weighted_loss: 1.8522, label: 0, bag_size: 1073
batch 579, loss: 1.1812, instance_loss: 0.4949, weighted_loss: 0.9753, label: 2, bag_size: 837


class 0 clustering acc 0.9968855218855219: correct 23686/23760
class 1 clustering acc 0.06628787878787878: correct 315/4752
Epoch: 53, train_loss: 0.9184, train_clustering_loss:  0.4722, train_error: 0.3687
class 0: acc 0.9024390243902439, correct 111/123
class 1: acc 0.5702479338842975, correct 69/121
class 2: acc 0.4649122807017544, correct 53/114
class 3: acc 0.5714285714285714, correct 64/112
class 4: acc 0.6290322580645161, correct 78/124

Val Set, val_loss: 1.4890, val_error: 0.5676, auc: 0.7647
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.07094594594594594: correct 42/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.2222222222222222, correct 4/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.3204, instance_loss: 0.4332, weighted_loss: 1.0543, label: 0, bag_size: 642
batch 39, loss: 0.9953, instance_loss: 0.5372, weighted_loss: 0.8579, label: 3, bag_size: 858
batch 59, loss: 0.3560, instance_loss: 0.4294, weighted_loss: 0.3781, label: 0, bag_size: 613
batch 79, loss: 0.2159, instance_loss: 0.3339, weighted_loss: 0.2513, label: 4, bag_size: 418
batch 99, loss: 0.9851, instance_loss: 0.4227, weighted_loss: 0.8164, label: 1, bag_size: 500
batch 119, loss: 0.7447, instance_loss: 0.4249, weighted_loss: 0.6488, label: 4, bag_size: 342
batch 139, loss: 0.9752, instance_loss: 0.6798, weighted_loss: 0.8866, label: 3, bag_size: 608
batch 159, loss: 0.7946, instance_loss: 0.5153, weighted_loss: 0.7108, label: 4, bag_size: 744
batch 179, loss: 0.0367, instance_loss: 0.3079, weighted_loss: 0.1180, label: 0, bag_size: 188
batch 199, loss: 0.0556, instance_loss: 0.1956, weighted_loss: 0.0976, label: 0, bag_size: 97
batch 219, loss: 1.3567, instance_loss: 0.5039, weighted_loss: 1.1009, label: 2, bag_size: 554
batch 239, loss: 1.5705, instance_loss: 0.6063, weighted_loss: 1.2812, label: 4, bag_size: 590
batch 259, loss: 0.2397, instance_loss: 0.5073, weighted_loss: 0.3200, label: 2, bag_size: 684
batch 279, loss: 2.3468, instance_loss: 0.5531, weighted_loss: 1.8087, label: 2, bag_size: 1122
batch 299, loss: 0.8274, instance_loss: 0.5092, weighted_loss: 0.7320, label: 3, bag_size: 476
batch 319, loss: 0.1836, instance_loss: 0.3683, weighted_loss: 0.2390, label: 0, bag_size: 227
batch 339, loss: 0.4261, instance_loss: 0.4716, weighted_loss: 0.4398, label: 1, bag_size: 271
batch 359, loss: 0.3156, instance_loss: 0.5087, weighted_loss: 0.3735, label: 1, bag_size: 764
batch 379, loss: 0.4273, instance_loss: 0.5289, weighted_loss: 0.4578, label: 3, bag_size: 872
batch 399, loss: 1.9455, instance_loss: 0.5105, weighted_loss: 1.5150, label: 4, bag_size: 246
batch 419, loss: 0.8059, instance_loss: 0.4738, weighted_loss: 0.7063, label: 4, bag_size: 944
batch 439, loss: 1.1808, instance_loss: 0.5152, weighted_loss: 0.9811, label: 1, bag_size: 855
batch 459, loss: 1.0482, instance_loss: 0.4681, weighted_loss: 0.8742, label: 2, bag_size: 851
batch 479, loss: 0.0394, instance_loss: 0.2464, weighted_loss: 0.1015, label: 0, bag_size: 103
batch 499, loss: 0.5702, instance_loss: 0.4284, weighted_loss: 0.5276, label: 2, bag_size: 633
batch 519, loss: 1.6282, instance_loss: 0.5299, weighted_loss: 1.2987, label: 4, bag_size: 970
batch 539, loss: 0.4858, instance_loss: 0.4284, weighted_loss: 0.4686, label: 4, bag_size: 329
batch 559, loss: 2.7437, instance_loss: 0.6127, weighted_loss: 2.1044, label: 0, bag_size: 710
batch 579, loss: 0.5934, instance_loss: 0.4781, weighted_loss: 0.5589, label: 2, bag_size: 135


class 0 clustering acc 0.996506734006734: correct 23677/23760
class 1 clustering acc 0.06481481481481481: correct 308/4752
Epoch: 54, train_loss: 1.0348, train_clustering_loss:  0.4847, train_error: 0.4192
class 0: acc 0.782258064516129, correct 97/124
class 1: acc 0.40350877192982454, correct 46/114
class 2: acc 0.5586206896551724, correct 81/145
class 3: acc 0.46808510638297873, correct 44/94
class 4: acc 0.6581196581196581, correct 77/117

Val Set, val_loss: 1.2923, val_error: 0.5135, auc: 0.8013
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.11993243243243243: correct 71/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0263, instance_loss: 0.2282, weighted_loss: 0.0868, label: 0, bag_size: 295
batch 39, loss: 1.4622, instance_loss: 0.6089, weighted_loss: 1.2062, label: 3, bag_size: 796
batch 59, loss: 3.3716, instance_loss: 0.5695, weighted_loss: 2.5309, label: 2, bag_size: 829
batch 79, loss: 1.0282, instance_loss: 0.5360, weighted_loss: 0.8806, label: 3, bag_size: 1022
batch 99, loss: 0.6571, instance_loss: 0.5039, weighted_loss: 0.6111, label: 4, bag_size: 854
batch 119, loss: 0.2975, instance_loss: 0.4350, weighted_loss: 0.3387, label: 4, bag_size: 948
batch 139, loss: 0.6383, instance_loss: 0.4685, weighted_loss: 0.5874, label: 4, bag_size: 204
batch 159, loss: 2.9578, instance_loss: 0.5265, weighted_loss: 2.2284, label: 2, bag_size: 1092
batch 179, loss: 1.6480, instance_loss: 0.6674, weighted_loss: 1.3539, label: 3, bag_size: 897
batch 199, loss: 0.9099, instance_loss: 0.4926, weighted_loss: 0.7847, label: 1, bag_size: 321
batch 219, loss: 0.7615, instance_loss: 0.4640, weighted_loss: 0.6723, label: 1, bag_size: 599
batch 239, loss: 0.9068, instance_loss: 0.4311, weighted_loss: 0.7641, label: 1, bag_size: 697
batch 259, loss: 0.0888, instance_loss: 0.2808, weighted_loss: 0.1464, label: 0, bag_size: 164
batch 279, loss: 1.1759, instance_loss: 0.5735, weighted_loss: 0.9952, label: 2, bag_size: 315
batch 299, loss: 2.6073, instance_loss: 0.7789, weighted_loss: 2.0588, label: 0, bag_size: 370
batch 319, loss: 0.7023, instance_loss: 0.4370, weighted_loss: 0.6227, label: 3, bag_size: 566
batch 339, loss: 0.0330, instance_loss: 0.2358, weighted_loss: 0.0938, label: 0, bag_size: 399
batch 359, loss: 0.5838, instance_loss: 0.4513, weighted_loss: 0.5440, label: 4, bag_size: 727
batch 379, loss: 0.7270, instance_loss: 0.4003, weighted_loss: 0.6290, label: 2, bag_size: 598
batch 399, loss: 1.6206, instance_loss: 0.5948, weighted_loss: 1.3129, label: 3, bag_size: 872
batch 419, loss: 0.7714, instance_loss: 0.4470, weighted_loss: 0.6741, label: 2, bag_size: 953
batch 439, loss: 1.5855, instance_loss: 0.5688, weighted_loss: 1.2805, label: 1, bag_size: 159
batch 459, loss: 1.7928, instance_loss: 0.5531, weighted_loss: 1.4209, label: 3, bag_size: 796
batch 479, loss: 1.3283, instance_loss: 0.4846, weighted_loss: 1.0752, label: 1, bag_size: 823
batch 499, loss: 0.1490, instance_loss: 0.6008, weighted_loss: 0.2845, label: 1, bag_size: 106
batch 519, loss: 1.5279, instance_loss: 0.4914, weighted_loss: 1.2170, label: 1, bag_size: 697
batch 539, loss: 0.0332, instance_loss: 0.5957, weighted_loss: 0.2019, label: 0, bag_size: 1570
batch 559, loss: 0.9324, instance_loss: 0.4563, weighted_loss: 0.7896, label: 1, bag_size: 500
batch 579, loss: 0.1113, instance_loss: 0.4250, weighted_loss: 0.2054, label: 4, bag_size: 503


class 0 clustering acc 0.9975589225589225: correct 23702/23760
class 1 clustering acc 0.06060606060606061: correct 288/4752
Epoch: 55, train_loss: 1.0179, train_clustering_loss:  0.4822, train_error: 0.4276
class 0: acc 0.7804878048780488, correct 96/123
class 1: acc 0.627906976744186, correct 81/129
class 2: acc 0.3412698412698413, correct 43/126
class 3: acc 0.4563106796116505, correct 47/103
class 4: acc 0.6460176991150443, correct 73/113

Val Set, val_loss: 1.2094, val_error: 0.5000, auc: 0.8215
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.0929054054054054: correct 55/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5270, ROC AUC: 0.8166
Test error: 0.5405, ROC AUC: 0.8011
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.8786, instance_loss: 0.5999, weighted_loss: 1.4950, label: 1, bag_size: 892
batch 39, loss: 2.4319, instance_loss: 0.5561, weighted_loss: 1.8692, label: 2, bag_size: 731
batch 59, loss: 2.1038, instance_loss: 0.5068, weighted_loss: 1.6247, label: 3, bag_size: 472
batch 79, loss: 0.7186, instance_loss: 0.5524, weighted_loss: 0.6687, label: 1, bag_size: 328
batch 99, loss: 2.4754, instance_loss: 0.5319, weighted_loss: 1.8924, label: 2, bag_size: 369
batch 119, loss: 0.6478, instance_loss: 0.4564, weighted_loss: 0.5904, label: 3, bag_size: 403
batch 139, loss: 1.3075, instance_loss: 0.4830, weighted_loss: 1.0602, label: 2, bag_size: 606
batch 159, loss: 2.2318, instance_loss: 0.5652, weighted_loss: 1.7318, label: 2, bag_size: 177
batch 179, loss: 2.3855, instance_loss: 0.5639, weighted_loss: 1.8390, label: 3, bag_size: 505
batch 199, loss: 2.3821, instance_loss: 0.5571, weighted_loss: 1.8346, label: 2, bag_size: 809
batch 219, loss: 1.4722, instance_loss: 0.5482, weighted_loss: 1.1950, label: 0, bag_size: 277
batch 239, loss: 1.6885, instance_loss: 0.5227, weighted_loss: 1.3388, label: 4, bag_size: 490
batch 259, loss: 2.3024, instance_loss: 0.6261, weighted_loss: 1.7995, label: 0, bag_size: 277
batch 279, loss: 1.5088, instance_loss: 0.4819, weighted_loss: 1.2007, label: 4, bag_size: 853
batch 299, loss: 0.3385, instance_loss: 0.3986, weighted_loss: 0.3565, label: 0, bag_size: 63
batch 319, loss: 1.6900, instance_loss: 0.5239, weighted_loss: 1.3402, label: 3, bag_size: 492
batch 339, loss: 1.5330, instance_loss: 0.4336, weighted_loss: 1.2032, label: 1, bag_size: 371
batch 359, loss: 1.6488, instance_loss: 0.5464, weighted_loss: 1.3181, label: 4, bag_size: 563
batch 379, loss: 1.8711, instance_loss: 0.5129, weighted_loss: 1.4636, label: 2, bag_size: 407
batch 399, loss: 0.6793, instance_loss: 0.4909, weighted_loss: 0.6228, label: 0, bag_size: 760
batch 419, loss: 2.2620, instance_loss: 0.4869, weighted_loss: 1.7295, label: 1, bag_size: 1360
batch 439, loss: 0.2285, instance_loss: 0.4415, weighted_loss: 0.2924, label: 0, bag_size: 355
batch 459, loss: 0.8731, instance_loss: 0.3990, weighted_loss: 0.7308, label: 1, bag_size: 1497
batch 479, loss: 3.0180, instance_loss: 0.4373, weighted_loss: 2.2438, label: 0, bag_size: 62
batch 499, loss: 1.7655, instance_loss: 0.4770, weighted_loss: 1.3789, label: 3, bag_size: 312
batch 519, loss: 0.9360, instance_loss: 0.3703, weighted_loss: 0.7663, label: 1, bag_size: 605
batch 539, loss: 1.1775, instance_loss: 0.5064, weighted_loss: 0.9762, label: 3, bag_size: 498
batch 559, loss: 1.4659, instance_loss: 0.5305, weighted_loss: 1.1853, label: 4, bag_size: 592
batch 579, loss: 1.6182, instance_loss: 0.4761, weighted_loss: 1.2756, label: 2, bag_size: 746


class 0 clustering acc 0.9985690235690236: correct 23726/23760
class 1 clustering acc 0.0016835016835016834: correct 8/4752
Epoch: 0, train_loss: 1.4925, train_clustering_loss:  0.5170, train_error: 0.6397
class 0: acc 0.7280701754385965, correct 83/114
class 1: acc 0.3769230769230769, correct 49/130
class 2: acc 0.23076923076923078, correct 27/117
class 3: acc 0.23076923076923078, correct 27/117
class 4: acc 0.2413793103448276, correct 28/116

Val Set, val_loss: 1.6144, val_error: 0.6486, auc: 0.6923
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.614406).  Saving model ...


batch 19, loss: 1.9623, instance_loss: 0.6090, weighted_loss: 1.5563, label: 3, bag_size: 245
batch 39, loss: 2.7440, instance_loss: 0.6647, weighted_loss: 2.1202, label: 0, bag_size: 1085
batch 59, loss: 0.3213, instance_loss: 0.3811, weighted_loss: 0.3392, label: 0, bag_size: 71
batch 79, loss: 1.7443, instance_loss: 0.5104, weighted_loss: 1.3741, label: 2, bag_size: 318
batch 99, loss: 1.0237, instance_loss: 0.4280, weighted_loss: 0.8450, label: 2, bag_size: 1010
batch 119, loss: 0.9831, instance_loss: 0.4272, weighted_loss: 0.8163, label: 1, bag_size: 398
batch 139, loss: 0.8994, instance_loss: 0.4210, weighted_loss: 0.7559, label: 1, bag_size: 1104
batch 159, loss: 1.2420, instance_loss: 0.5320, weighted_loss: 1.0290, label: 4, bag_size: 446
batch 179, loss: 0.2720, instance_loss: 0.3903, weighted_loss: 0.3075, label: 0, bag_size: 74
batch 199, loss: 0.1145, instance_loss: 0.3576, weighted_loss: 0.1874, label: 0, bag_size: 258
batch 219, loss: 1.1674, instance_loss: 0.4877, weighted_loss: 0.9635, label: 0, bag_size: 1414
batch 239, loss: 2.7162, instance_loss: 0.6874, weighted_loss: 2.1076, label: 2, bag_size: 554
batch 259, loss: 1.2589, instance_loss: 0.4376, weighted_loss: 1.0125, label: 1, bag_size: 766
batch 279, loss: 0.7878, instance_loss: 0.4042, weighted_loss: 0.6727, label: 0, bag_size: 59
batch 299, loss: 1.3423, instance_loss: 0.5221, weighted_loss: 1.0962, label: 3, bag_size: 312
batch 319, loss: 0.2705, instance_loss: 0.3612, weighted_loss: 0.2977, label: 0, bag_size: 142
batch 339, loss: 0.5152, instance_loss: 0.4215, weighted_loss: 0.4871, label: 0, bag_size: 399
batch 359, loss: 1.2226, instance_loss: 0.4934, weighted_loss: 1.0039, label: 4, bag_size: 503
batch 379, loss: 1.1422, instance_loss: 0.5211, weighted_loss: 0.9559, label: 3, bag_size: 235
batch 399, loss: 0.9521, instance_loss: 0.4927, weighted_loss: 0.8143, label: 4, bag_size: 409
batch 419, loss: 1.4799, instance_loss: 0.4547, weighted_loss: 1.1723, label: 1, bag_size: 483
batch 439, loss: 1.3681, instance_loss: 0.5391, weighted_loss: 1.1194, label: 4, bag_size: 329
batch 459, loss: 2.5994, instance_loss: 0.5209, weighted_loss: 1.9758, label: 0, bag_size: 62
batch 479, loss: 1.2823, instance_loss: 0.5198, weighted_loss: 1.0536, label: 4, bag_size: 639
batch 499, loss: 0.4974, instance_loss: 0.4170, weighted_loss: 0.4732, label: 0, bag_size: 97
batch 519, loss: 1.0423, instance_loss: 0.4832, weighted_loss: 0.8746, label: 2, bag_size: 613
batch 539, loss: 0.0907, instance_loss: 0.3765, weighted_loss: 0.1765, label: 0, bag_size: 340
batch 559, loss: 3.7613, instance_loss: 0.6441, weighted_loss: 2.8261, label: 3, bag_size: 638
batch 579, loss: 1.3782, instance_loss: 0.5228, weighted_loss: 1.1216, label: 2, bag_size: 725


class 0 clustering acc 1.0: correct 23760/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 1, train_loss: 1.4115, train_clustering_loss:  0.5013, train_error: 0.6465
class 0: acc 0.7983193277310925, correct 95/119
class 1: acc 0.27906976744186046, correct 36/129
class 2: acc 0.19642857142857142, correct 22/112
class 3: acc 0.2857142857142857, correct 36/126
class 4: acc 0.19444444444444445, correct 21/108

Val Set, val_loss: 1.5673, val_error: 0.6757, auc: 0.7101
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (1.614406 --> 1.567284).  Saving model ...


batch 19, loss: 1.1669, instance_loss: 0.4723, weighted_loss: 0.9585, label: 3, bag_size: 556
batch 39, loss: 0.8396, instance_loss: 0.3962, weighted_loss: 0.7065, label: 1, bag_size: 534
batch 59, loss: 2.0516, instance_loss: 0.5842, weighted_loss: 1.6114, label: 2, bag_size: 557
batch 79, loss: 0.2823, instance_loss: 0.3426, weighted_loss: 0.3004, label: 0, bag_size: 212
batch 99, loss: 1.1545, instance_loss: 0.4499, weighted_loss: 0.9431, label: 4, bag_size: 124
batch 119, loss: 1.6421, instance_loss: 0.4162, weighted_loss: 1.2743, label: 1, bag_size: 1360
batch 139, loss: 1.2508, instance_loss: 0.5123, weighted_loss: 1.0293, label: 3, bag_size: 1060
batch 159, loss: 1.3420, instance_loss: 0.5611, weighted_loss: 1.1077, label: 4, bag_size: 520
batch 179, loss: 1.9045, instance_loss: 0.4679, weighted_loss: 1.4735, label: 1, bag_size: 660
batch 199, loss: 1.6184, instance_loss: 0.4834, weighted_loss: 1.2779, label: 1, bag_size: 355
batch 219, loss: 0.7134, instance_loss: 0.5140, weighted_loss: 0.6536, label: 0, bag_size: 552
batch 239, loss: 1.3367, instance_loss: 0.5449, weighted_loss: 1.0992, label: 4, bag_size: 1031
batch 259, loss: 1.5559, instance_loss: 0.5031, weighted_loss: 1.2401, label: 3, bag_size: 492
batch 279, loss: 1.6870, instance_loss: 0.4445, weighted_loss: 1.3142, label: 1, bag_size: 410
batch 299, loss: 0.8095, instance_loss: 0.5698, weighted_loss: 0.7376, label: 0, bag_size: 370
batch 319, loss: 1.2004, instance_loss: 0.4464, weighted_loss: 0.9742, label: 3, bag_size: 351
batch 339, loss: 5.1973, instance_loss: 0.7972, weighted_loss: 3.8772, label: 4, bag_size: 293
batch 359, loss: 1.2253, instance_loss: 0.4325, weighted_loss: 0.9875, label: 1, bag_size: 408
batch 379, loss: 1.4223, instance_loss: 0.5447, weighted_loss: 1.1590, label: 3, bag_size: 149
batch 399, loss: 1.4868, instance_loss: 0.5399, weighted_loss: 1.2027, label: 2, bag_size: 697
batch 419, loss: 1.6999, instance_loss: 0.6915, weighted_loss: 1.3974, label: 4, bag_size: 627
batch 439, loss: 2.8424, instance_loss: 0.6826, weighted_loss: 2.1945, label: 0, bag_size: 478
batch 459, loss: 1.5311, instance_loss: 0.4820, weighted_loss: 1.2164, label: 2, bag_size: 96
batch 479, loss: 1.1919, instance_loss: 0.5077, weighted_loss: 0.9866, label: 4, bag_size: 797
batch 499, loss: 1.5559, instance_loss: 0.5783, weighted_loss: 1.2626, label: 4, bag_size: 854
batch 519, loss: 0.3341, instance_loss: 0.3995, weighted_loss: 0.3537, label: 0, bag_size: 122
batch 539, loss: 1.3984, instance_loss: 0.4705, weighted_loss: 1.1200, label: 3, bag_size: 453
batch 559, loss: 1.8778, instance_loss: 0.5441, weighted_loss: 1.4777, label: 2, bag_size: 407
batch 579, loss: 0.7813, instance_loss: 0.5151, weighted_loss: 0.7015, label: 0, bag_size: 159


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.0008417508417508417: correct 4/4752
Epoch: 2, train_loss: 1.3512, train_clustering_loss:  0.5011, train_error: 0.6094
class 0: acc 0.8099173553719008, correct 98/121
class 1: acc 0.29838709677419356, correct 37/124
class 2: acc 0.16363636363636364, correct 18/110
class 3: acc 0.2727272727272727, correct 33/121
class 4: acc 0.3898305084745763, correct 46/118

Val Set, val_loss: 1.6348, val_error: 0.6622, auc: 0.6885
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.4373, instance_loss: 0.5554, weighted_loss: 1.8727, label: 2, bag_size: 489
batch 39, loss: 1.5411, instance_loss: 0.5031, weighted_loss: 1.2297, label: 2, bag_size: 584
batch 59, loss: 0.0963, instance_loss: 0.2707, weighted_loss: 0.1486, label: 0, bag_size: 63
batch 79, loss: 1.7848, instance_loss: 0.5137, weighted_loss: 1.4035, label: 3, bag_size: 615
batch 99, loss: 1.7037, instance_loss: 0.5029, weighted_loss: 1.3435, label: 1, bag_size: 371
batch 119, loss: 1.5971, instance_loss: 0.5345, weighted_loss: 1.2784, label: 3, bag_size: 230
batch 139, loss: 1.8103, instance_loss: 0.5718, weighted_loss: 1.4387, label: 2, bag_size: 1319
batch 159, loss: 2.1942, instance_loss: 0.5585, weighted_loss: 1.7035, label: 4, bag_size: 757
batch 179, loss: 1.1723, instance_loss: 0.4695, weighted_loss: 0.9615, label: 3, bag_size: 498
batch 199, loss: 0.9971, instance_loss: 0.4575, weighted_loss: 0.8352, label: 3, bag_size: 312
batch 219, loss: 1.6399, instance_loss: 0.5839, weighted_loss: 1.3231, label: 4, bag_size: 775
batch 239, loss: 1.7073, instance_loss: 0.5105, weighted_loss: 1.3483, label: 1, bag_size: 233
batch 259, loss: 2.9078, instance_loss: 0.6144, weighted_loss: 2.2198, label: 3, bag_size: 638
batch 279, loss: 0.9969, instance_loss: 0.4610, weighted_loss: 0.8361, label: 3, bag_size: 393
batch 299, loss: 0.8599, instance_loss: 0.3670, weighted_loss: 0.7120, label: 3, bag_size: 272
batch 319, loss: 1.3361, instance_loss: 0.5042, weighted_loss: 1.0865, label: 1, bag_size: 616
batch 339, loss: 0.0469, instance_loss: 0.2846, weighted_loss: 0.1182, label: 0, bag_size: 97
batch 359, loss: 1.8165, instance_loss: 0.6021, weighted_loss: 1.4522, label: 4, bag_size: 589
batch 379, loss: 1.3140, instance_loss: 0.3976, weighted_loss: 1.0391, label: 1, bag_size: 1103
batch 399, loss: 1.4139, instance_loss: 0.4542, weighted_loss: 1.1260, label: 1, bag_size: 201
batch 419, loss: 1.7465, instance_loss: 0.4711, weighted_loss: 1.3639, label: 3, bag_size: 282
batch 439, loss: 0.2701, instance_loss: 0.3273, weighted_loss: 0.2872, label: 0, bag_size: 370
batch 459, loss: 1.6419, instance_loss: 0.5388, weighted_loss: 1.3110, label: 3, bag_size: 779
batch 479, loss: 0.6304, instance_loss: 0.3300, weighted_loss: 0.5403, label: 0, bag_size: 33
batch 499, loss: 1.5075, instance_loss: 0.4965, weighted_loss: 1.2042, label: 3, bag_size: 505
batch 519, loss: 1.6289, instance_loss: 0.4975, weighted_loss: 1.2894, label: 2, bag_size: 769
batch 539, loss: 1.2538, instance_loss: 0.4328, weighted_loss: 1.0075, label: 1, bag_size: 1103
batch 559, loss: 1.7865, instance_loss: 0.5644, weighted_loss: 1.4199, label: 3, bag_size: 1131
batch 579, loss: 0.4981, instance_loss: 0.3966, weighted_loss: 0.4676, label: 4, bag_size: 773


class 0 clustering acc 0.999452861952862: correct 23747/23760
class 1 clustering acc 0.004629629629629629: correct 22/4752
Epoch: 3, train_loss: 1.3333, train_clustering_loss:  0.4977, train_error: 0.6044
class 0: acc 0.8110236220472441, correct 103/127
class 1: acc 0.2627118644067797, correct 31/118
class 2: acc 0.3543307086614173, correct 45/127
class 3: acc 0.18584070796460178, correct 21/113
class 4: acc 0.3211009174311927, correct 35/109

Val Set, val_loss: 1.5636, val_error: 0.6351, auc: 0.7259
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.567284 --> 1.563576).  Saving model ...


batch 19, loss: 0.7339, instance_loss: 0.5251, weighted_loss: 0.6712, label: 4, bag_size: 660
batch 39, loss: 0.7063, instance_loss: 0.3659, weighted_loss: 0.6042, label: 0, bag_size: 77
batch 59, loss: 1.8486, instance_loss: 0.4991, weighted_loss: 1.4438, label: 1, bag_size: 599
batch 79, loss: 1.6374, instance_loss: 0.5071, weighted_loss: 1.2983, label: 1, bag_size: 618
batch 99, loss: 1.0319, instance_loss: 0.5715, weighted_loss: 0.8938, label: 4, bag_size: 46
batch 119, loss: 0.1196, instance_loss: 0.3322, weighted_loss: 0.1834, label: 0, bag_size: 63
batch 139, loss: 0.6674, instance_loss: 0.4240, weighted_loss: 0.5944, label: 4, bag_size: 547
batch 159, loss: 0.7897, instance_loss: 0.4570, weighted_loss: 0.6899, label: 4, bag_size: 639
batch 179, loss: 0.1814, instance_loss: 0.3653, weighted_loss: 0.2366, label: 0, bag_size: 524
batch 199, loss: 1.4837, instance_loss: 0.4766, weighted_loss: 1.1816, label: 1, bag_size: 697
batch 219, loss: 0.4568, instance_loss: 0.4277, weighted_loss: 0.4480, label: 4, bag_size: 409
batch 239, loss: 1.0491, instance_loss: 0.4558, weighted_loss: 0.8711, label: 2, bag_size: 702
batch 259, loss: 1.7434, instance_loss: 0.6155, weighted_loss: 1.4050, label: 1, bag_size: 617
batch 279, loss: 0.2347, instance_loss: 0.3534, weighted_loss: 0.2703, label: 0, bag_size: 59
batch 299, loss: 1.4326, instance_loss: 0.5187, weighted_loss: 1.1585, label: 1, bag_size: 908
batch 319, loss: 2.2361, instance_loss: 0.6455, weighted_loss: 1.7589, label: 3, bag_size: 956
batch 339, loss: 1.5465, instance_loss: 0.6083, weighted_loss: 1.2651, label: 4, bag_size: 726
batch 359, loss: 2.4018, instance_loss: 0.5716, weighted_loss: 1.8527, label: 2, bag_size: 563
batch 379, loss: 1.1946, instance_loss: 0.5865, weighted_loss: 1.0121, label: 4, bag_size: 689
batch 399, loss: 5.0060, instance_loss: 0.7073, weighted_loss: 3.7164, label: 4, bag_size: 293
batch 419, loss: 1.1888, instance_loss: 0.5019, weighted_loss: 0.9828, label: 2, bag_size: 690
batch 439, loss: 1.8110, instance_loss: 0.5732, weighted_loss: 1.4397, label: 4, bag_size: 592
batch 459, loss: 0.9808, instance_loss: 0.5033, weighted_loss: 0.8376, label: 4, bag_size: 687
batch 479, loss: 1.1905, instance_loss: 0.5122, weighted_loss: 0.9870, label: 4, bag_size: 574
batch 499, loss: 1.2046, instance_loss: 0.5028, weighted_loss: 0.9941, label: 3, bag_size: 364
batch 519, loss: 1.8698, instance_loss: 0.5282, weighted_loss: 1.4673, label: 1, bag_size: 159
batch 539, loss: 1.3632, instance_loss: 0.4650, weighted_loss: 1.0938, label: 3, bag_size: 727
batch 559, loss: 1.3724, instance_loss: 0.4652, weighted_loss: 1.1002, label: 3, bag_size: 1022
batch 579, loss: 2.1482, instance_loss: 0.5278, weighted_loss: 1.6621, label: 4, bag_size: 277


class 0 clustering acc 0.9991161616161616: correct 23739/23760
class 1 clustering acc 0.008417508417508417: correct 40/4752
Epoch: 4, train_loss: 1.3385, train_clustering_loss:  0.5017, train_error: 0.5926
class 0: acc 0.7916666666666666, correct 95/120
class 1: acc 0.1574074074074074, correct 17/108
class 2: acc 0.39705882352941174, correct 54/136
class 3: acc 0.1509433962264151, correct 16/106
class 4: acc 0.4838709677419355, correct 60/124

Val Set, val_loss: 1.5607, val_error: 0.5676, auc: 0.7404
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.563576 --> 1.560689).  Saving model ...


batch 19, loss: 0.1198, instance_loss: 0.3989, weighted_loss: 0.2035, label: 0, bag_size: 76
batch 39, loss: 1.0933, instance_loss: 0.4855, weighted_loss: 0.9110, label: 2, bag_size: 717
batch 59, loss: 0.1746, instance_loss: 0.3179, weighted_loss: 0.2176, label: 0, bag_size: 122
batch 79, loss: 1.2276, instance_loss: 0.4899, weighted_loss: 1.0063, label: 3, bag_size: 1007
batch 99, loss: 1.9864, instance_loss: 0.6157, weighted_loss: 1.5752, label: 2, bag_size: 557
batch 119, loss: 0.8388, instance_loss: 0.4619, weighted_loss: 0.7257, label: 3, bag_size: 746
batch 139, loss: 1.4274, instance_loss: 0.5528, weighted_loss: 1.1650, label: 1, bag_size: 332
batch 159, loss: 1.1013, instance_loss: 0.5734, weighted_loss: 0.9430, label: 3, bag_size: 344
batch 179, loss: 2.4689, instance_loss: 0.7308, weighted_loss: 1.9475, label: 1, bag_size: 184
batch 199, loss: 1.4732, instance_loss: 0.4996, weighted_loss: 1.1811, label: 2, bag_size: 407
batch 219, loss: 0.6337, instance_loss: 0.5388, weighted_loss: 0.6052, label: 2, bag_size: 553
batch 239, loss: 1.4940, instance_loss: 0.4547, weighted_loss: 1.1822, label: 2, bag_size: 598
batch 259, loss: 1.5546, instance_loss: 0.5380, weighted_loss: 1.2496, label: 1, bag_size: 159
batch 279, loss: 1.6438, instance_loss: 0.5259, weighted_loss: 1.3084, label: 1, bag_size: 1023
batch 299, loss: 1.5063, instance_loss: 0.4942, weighted_loss: 1.2027, label: 2, bag_size: 860
batch 319, loss: 0.3649, instance_loss: 0.3534, weighted_loss: 0.3615, label: 0, bag_size: 281
batch 339, loss: 1.0618, instance_loss: 0.4868, weighted_loss: 0.8893, label: 2, bag_size: 708
batch 359, loss: 1.4738, instance_loss: 0.5610, weighted_loss: 1.2000, label: 2, bag_size: 799
batch 379, loss: 1.6043, instance_loss: 0.5272, weighted_loss: 1.2811, label: 3, bag_size: 928
batch 399, loss: 1.6986, instance_loss: 0.6233, weighted_loss: 1.3760, label: 4, bag_size: 730
batch 419, loss: 0.7027, instance_loss: 0.4569, weighted_loss: 0.6289, label: 0, bag_size: 269
batch 439, loss: 1.7670, instance_loss: 0.5836, weighted_loss: 1.4119, label: 4, bag_size: 476
batch 459, loss: 1.0612, instance_loss: 0.5479, weighted_loss: 0.9072, label: 4, bag_size: 712
batch 479, loss: 1.6821, instance_loss: 0.5204, weighted_loss: 1.3336, label: 2, bag_size: 398
batch 499, loss: 1.2578, instance_loss: 0.4932, weighted_loss: 1.0284, label: 1, bag_size: 355
batch 519, loss: 0.6088, instance_loss: 0.4214, weighted_loss: 0.5526, label: 1, bag_size: 1103
batch 539, loss: 1.4726, instance_loss: 0.5222, weighted_loss: 1.1875, label: 4, bag_size: 419
batch 559, loss: 1.7321, instance_loss: 0.5423, weighted_loss: 1.3752, label: 2, bag_size: 606
batch 579, loss: 0.5746, instance_loss: 0.4699, weighted_loss: 0.5432, label: 0, bag_size: 251


class 0 clustering acc 0.9993686868686869: correct 23745/23760
class 1 clustering acc 0.002946127946127946: correct 14/4752
Epoch: 5, train_loss: 1.3547, train_clustering_loss:  0.5063, train_error: 0.5926
class 0: acc 0.768, correct 96/125
class 1: acc 0.3416666666666667, correct 41/120
class 2: acc 0.3629032258064516, correct 45/124
class 3: acc 0.20833333333333334, correct 25/120
class 4: acc 0.3333333333333333, correct 35/105

Val Set, val_loss: 1.5567, val_error: 0.6351, auc: 0.7213
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5, correct 8/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.560689 --> 1.556698).  Saving model ...


batch 19, loss: 2.1347, instance_loss: 0.6108, weighted_loss: 1.6775, label: 1, bag_size: 231
batch 39, loss: 0.6318, instance_loss: 0.4236, weighted_loss: 0.5693, label: 0, bag_size: 702
batch 59, loss: 1.8727, instance_loss: 0.5088, weighted_loss: 1.4635, label: 2, bag_size: 829
batch 79, loss: 1.5985, instance_loss: 0.5338, weighted_loss: 1.2791, label: 3, bag_size: 795
batch 99, loss: 0.9649, instance_loss: 0.5507, weighted_loss: 0.8406, label: 4, bag_size: 683
batch 119, loss: 1.2997, instance_loss: 0.4439, weighted_loss: 1.0430, label: 1, bag_size: 829
batch 139, loss: 2.2193, instance_loss: 0.7050, weighted_loss: 1.7650, label: 0, bag_size: 178
batch 159, loss: 1.2329, instance_loss: 0.5218, weighted_loss: 1.0196, label: 2, bag_size: 613
batch 179, loss: 1.6797, instance_loss: 0.4983, weighted_loss: 1.3253, label: 3, bag_size: 1022
batch 199, loss: 0.9418, instance_loss: 0.4781, weighted_loss: 0.8027, label: 2, bag_size: 607
batch 219, loss: 0.0319, instance_loss: 0.3692, weighted_loss: 0.1331, label: 0, bag_size: 141
batch 239, loss: 1.7124, instance_loss: 0.5317, weighted_loss: 1.3582, label: 1, bag_size: 201
batch 259, loss: 0.5926, instance_loss: 0.5938, weighted_loss: 0.5930, label: 0, bag_size: 316
batch 279, loss: 1.5996, instance_loss: 0.5348, weighted_loss: 1.2802, label: 4, bag_size: 196
batch 299, loss: 1.4228, instance_loss: 0.5156, weighted_loss: 1.1506, label: 4, bag_size: 699
batch 319, loss: 1.8588, instance_loss: 0.8496, weighted_loss: 1.5561, label: 1, bag_size: 44
batch 339, loss: 0.2375, instance_loss: 0.4014, weighted_loss: 0.2867, label: 0, bag_size: 188
batch 359, loss: 0.1374, instance_loss: 0.4125, weighted_loss: 0.2199, label: 0, bag_size: 258
batch 379, loss: 1.0645, instance_loss: 0.4196, weighted_loss: 0.8710, label: 1, bag_size: 483
batch 399, loss: 2.1493, instance_loss: 0.5362, weighted_loss: 1.6654, label: 3, bag_size: 194
batch 419, loss: 1.5180, instance_loss: 0.5624, weighted_loss: 1.2313, label: 3, bag_size: 398
batch 439, loss: 1.3607, instance_loss: 0.5600, weighted_loss: 1.1205, label: 4, bag_size: 740
batch 459, loss: 0.9721, instance_loss: 0.4631, weighted_loss: 0.8194, label: 2, bag_size: 690
batch 479, loss: 1.2311, instance_loss: 0.4621, weighted_loss: 1.0004, label: 2, bag_size: 1013
batch 499, loss: 4.8043, instance_loss: 0.8893, weighted_loss: 3.6298, label: 1, bag_size: 153
batch 519, loss: 1.1680, instance_loss: 0.4858, weighted_loss: 0.9634, label: 2, bag_size: 640
batch 539, loss: 2.3549, instance_loss: 0.5721, weighted_loss: 1.8200, label: 4, bag_size: 333
batch 559, loss: 1.0446, instance_loss: 0.4797, weighted_loss: 0.8751, label: 3, bag_size: 230
batch 579, loss: 1.0895, instance_loss: 0.5262, weighted_loss: 0.9205, label: 3, bag_size: 272


class 0 clustering acc 0.9984848484848485: correct 23724/23760
class 1 clustering acc 0.01452020202020202: correct 69/4752
Epoch: 6, train_loss: 1.2927, train_clustering_loss:  0.5002, train_error: 0.5421
class 0: acc 0.8412698412698413, correct 106/126
class 1: acc 0.3275862068965517, correct 38/116
class 2: acc 0.26785714285714285, correct 30/112
class 3: acc 0.3445378151260504, correct 41/119
class 4: acc 0.47107438016528924, correct 57/121

Val Set, val_loss: 1.4955, val_error: 0.5405, auc: 0.7343
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.556698 --> 1.495546).  Saving model ...


batch 19, loss: 1.9231, instance_loss: 0.6097, weighted_loss: 1.5291, label: 0, bag_size: 478
batch 39, loss: 1.0320, instance_loss: 0.5117, weighted_loss: 0.8759, label: 3, bag_size: 498
batch 59, loss: 1.2308, instance_loss: 0.4864, weighted_loss: 1.0075, label: 3, bag_size: 98
batch 79, loss: 0.1496, instance_loss: 0.4549, weighted_loss: 0.2412, label: 0, bag_size: 357
batch 99, loss: 1.3977, instance_loss: 0.5942, weighted_loss: 1.1567, label: 4, bag_size: 1297
batch 119, loss: 1.2855, instance_loss: 0.4961, weighted_loss: 1.0487, label: 1, bag_size: 525
batch 139, loss: 0.0556, instance_loss: 0.3669, weighted_loss: 0.1490, label: 0, bag_size: 355
batch 159, loss: 1.3002, instance_loss: 0.4728, weighted_loss: 1.0520, label: 1, bag_size: 1009
batch 179, loss: 1.0602, instance_loss: 0.4153, weighted_loss: 0.8667, label: 2, bag_size: 717
batch 199, loss: 2.0709, instance_loss: 0.5730, weighted_loss: 1.6216, label: 2, bag_size: 337
batch 219, loss: 1.5135, instance_loss: 0.4846, weighted_loss: 1.2048, label: 3, bag_size: 817
batch 239, loss: 0.4027, instance_loss: 0.3062, weighted_loss: 0.3737, label: 0, bag_size: 493
batch 259, loss: 1.1680, instance_loss: 0.4907, weighted_loss: 0.9648, label: 3, bag_size: 364
batch 279, loss: 0.7368, instance_loss: 0.4848, weighted_loss: 0.6612, label: 4, bag_size: 574
batch 299, loss: 1.5537, instance_loss: 0.5749, weighted_loss: 1.2600, label: 2, bag_size: 337
batch 319, loss: 1.1054, instance_loss: 0.4936, weighted_loss: 0.9218, label: 1, bag_size: 617
batch 339, loss: 3.3097, instance_loss: 0.6716, weighted_loss: 2.5182, label: 0, bag_size: 273
batch 359, loss: 1.1417, instance_loss: 0.4495, weighted_loss: 0.9341, label: 2, bag_size: 1197
batch 379, loss: 0.4958, instance_loss: 0.5215, weighted_loss: 0.5035, label: 4, bag_size: 1158
batch 399, loss: 0.9005, instance_loss: 0.5352, weighted_loss: 0.7909, label: 4, bag_size: 218
batch 419, loss: 1.1900, instance_loss: 0.4673, weighted_loss: 0.9732, label: 2, bag_size: 567
batch 439, loss: 1.1221, instance_loss: 0.5232, weighted_loss: 0.9424, label: 2, bag_size: 171
batch 459, loss: 1.1287, instance_loss: 0.4003, weighted_loss: 0.9102, label: 3, bag_size: 274
batch 479, loss: 2.3202, instance_loss: 0.5522, weighted_loss: 1.7898, label: 1, bag_size: 1009
batch 499, loss: 0.0356, instance_loss: 0.3189, weighted_loss: 0.1206, label: 0, bag_size: 37
batch 519, loss: 1.4557, instance_loss: 0.5053, weighted_loss: 1.1705, label: 1, bag_size: 1043
batch 539, loss: 1.0514, instance_loss: 0.4765, weighted_loss: 0.8789, label: 2, bag_size: 530
batch 559, loss: 1.3059, instance_loss: 0.5305, weighted_loss: 1.0733, label: 4, bag_size: 875
batch 579, loss: 1.1457, instance_loss: 0.4575, weighted_loss: 0.9392, label: 2, bag_size: 684


class 0 clustering acc 0.998989898989899: correct 23736/23760
class 1 clustering acc 0.00904882154882155: correct 43/4752
Epoch: 7, train_loss: 1.3351, train_clustering_loss:  0.4974, train_error: 0.5875
class 0: acc 0.7920792079207921, correct 80/101
class 1: acc 0.11711711711711711, correct 13/111
class 2: acc 0.3684210526315789, correct 49/133
class 3: acc 0.43410852713178294, correct 56/129
class 4: acc 0.39166666666666666, correct 47/120

Val Set, val_loss: 1.4473, val_error: 0.6351, auc: 0.7485
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.495546 --> 1.447277).  Saving model ...


batch 19, loss: 1.4351, instance_loss: 0.5333, weighted_loss: 1.1645, label: 4, bag_size: 740
batch 39, loss: 0.2079, instance_loss: 0.3540, weighted_loss: 0.2517, label: 0, bag_size: 175
batch 59, loss: 0.9803, instance_loss: 0.4478, weighted_loss: 0.8206, label: 4, bag_size: 394
batch 79, loss: 0.0962, instance_loss: 0.3665, weighted_loss: 0.1773, label: 0, bag_size: 285
batch 99, loss: 1.5456, instance_loss: 0.4963, weighted_loss: 1.2308, label: 1, bag_size: 695
batch 119, loss: 4.2383, instance_loss: 0.7851, weighted_loss: 3.2023, label: 3, bag_size: 638
batch 139, loss: 1.3710, instance_loss: 0.5520, weighted_loss: 1.1253, label: 4, bag_size: 196
batch 159, loss: 1.9362, instance_loss: 0.5594, weighted_loss: 1.5232, label: 2, bag_size: 572
batch 179, loss: 1.6827, instance_loss: 0.6184, weighted_loss: 1.3634, label: 2, bag_size: 567
batch 199, loss: 2.0021, instance_loss: 0.7136, weighted_loss: 1.6155, label: 1, bag_size: 184
batch 219, loss: 0.8840, instance_loss: 0.4935, weighted_loss: 0.7668, label: 1, bag_size: 231
batch 239, loss: 1.7678, instance_loss: 0.5302, weighted_loss: 1.3965, label: 4, bag_size: 589
batch 259, loss: 3.5907, instance_loss: 0.5854, weighted_loss: 2.6891, label: 0, bag_size: 169
batch 279, loss: 2.6699, instance_loss: 0.6011, weighted_loss: 2.0493, label: 3, bag_size: 107
batch 299, loss: 1.0226, instance_loss: 0.5190, weighted_loss: 0.8715, label: 3, bag_size: 804
batch 319, loss: 0.7896, instance_loss: 0.4432, weighted_loss: 0.6857, label: 4, bag_size: 627
batch 339, loss: 2.2640, instance_loss: 0.5421, weighted_loss: 1.7474, label: 1, bag_size: 113
batch 359, loss: 2.0001, instance_loss: 0.4507, weighted_loss: 1.5353, label: 0, bag_size: 1073
batch 379, loss: 1.8112, instance_loss: 0.5506, weighted_loss: 1.4330, label: 4, bag_size: 228
batch 399, loss: 2.2839, instance_loss: 0.5529, weighted_loss: 1.7646, label: 3, bag_size: 282
batch 419, loss: 0.0595, instance_loss: 0.2685, weighted_loss: 0.1222, label: 0, bag_size: 706
batch 439, loss: 2.6584, instance_loss: 0.5925, weighted_loss: 2.0386, label: 4, bag_size: 333
batch 459, loss: 2.2180, instance_loss: 0.6091, weighted_loss: 1.7353, label: 2, bag_size: 171
batch 479, loss: 1.6730, instance_loss: 0.5200, weighted_loss: 1.3271, label: 2, bag_size: 829
batch 499, loss: 0.0252, instance_loss: 0.2284, weighted_loss: 0.0862, label: 0, bag_size: 37
batch 519, loss: 1.2979, instance_loss: 0.4344, weighted_loss: 1.0388, label: 3, bag_size: 473
batch 539, loss: 0.2762, instance_loss: 0.4626, weighted_loss: 0.3321, label: 0, bag_size: 351
batch 559, loss: 1.8543, instance_loss: 0.5472, weighted_loss: 1.4622, label: 4, bag_size: 250
batch 579, loss: 1.5449, instance_loss: 0.6188, weighted_loss: 1.2670, label: 2, bag_size: 96


class 0 clustering acc 0.9949494949494949: correct 23640/23760
class 1 clustering acc 0.05808080808080808: correct 276/4752
Epoch: 8, train_loss: 1.2075, train_clustering_loss:  0.4851, train_error: 0.5303
class 0: acc 0.8282208588957055, correct 135/163
class 1: acc 0.425, correct 51/120
class 2: acc 0.0967741935483871, correct 9/93
class 3: acc 0.2982456140350877, correct 34/114
class 4: acc 0.4807692307692308, correct 50/104

Val Set, val_loss: 1.4821, val_error: 0.5135, auc: 0.7673
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1829, instance_loss: 0.4489, weighted_loss: 0.9627, label: 2, bag_size: 549
batch 39, loss: 1.0198, instance_loss: 0.5615, weighted_loss: 0.8823, label: 1, bag_size: 1497
batch 59, loss: 0.5366, instance_loss: 0.5946, weighted_loss: 0.5540, label: 0, bag_size: 416
batch 79, loss: 1.6039, instance_loss: 0.5088, weighted_loss: 1.2754, label: 2, bag_size: 445
batch 99, loss: 0.0859, instance_loss: 0.3125, weighted_loss: 0.1538, label: 0, bag_size: 142
batch 119, loss: 1.0889, instance_loss: 0.4284, weighted_loss: 0.8907, label: 1, bag_size: 829
batch 139, loss: 2.0867, instance_loss: 0.5160, weighted_loss: 1.6155, label: 4, bag_size: 1351
batch 159, loss: 0.0150, instance_loss: 0.2969, weighted_loss: 0.0995, label: 0, bag_size: 340
batch 179, loss: 0.9178, instance_loss: 0.5461, weighted_loss: 0.8063, label: 4, bag_size: 446
batch 199, loss: 0.0313, instance_loss: 0.2274, weighted_loss: 0.0901, label: 0, bag_size: 37
batch 219, loss: 2.0091, instance_loss: 0.5704, weighted_loss: 1.5775, label: 4, bag_size: 110
batch 239, loss: 2.0452, instance_loss: 0.5915, weighted_loss: 1.6091, label: 2, bag_size: 351
batch 259, loss: 0.6654, instance_loss: 0.4243, weighted_loss: 0.5931, label: 0, bag_size: 613
batch 279, loss: 2.3003, instance_loss: 0.6111, weighted_loss: 1.7936, label: 4, bag_size: 690
batch 299, loss: 1.5449, instance_loss: 0.5038, weighted_loss: 1.2326, label: 2, bag_size: 119
batch 319, loss: 1.9033, instance_loss: 0.5253, weighted_loss: 1.4899, label: 4, bag_size: 356
batch 339, loss: 1.3489, instance_loss: 0.5249, weighted_loss: 1.1017, label: 4, bag_size: 590
batch 359, loss: 1.1578, instance_loss: 0.5703, weighted_loss: 0.9815, label: 2, bag_size: 554
batch 379, loss: 0.0482, instance_loss: 0.3123, weighted_loss: 0.1274, label: 0, bag_size: 234
batch 399, loss: 1.1135, instance_loss: 0.4701, weighted_loss: 0.9205, label: 3, bag_size: 746
batch 419, loss: 2.6020, instance_loss: 0.5902, weighted_loss: 1.9984, label: 4, bag_size: 757
batch 439, loss: 0.8663, instance_loss: 0.4682, weighted_loss: 0.7469, label: 0, bag_size: 168
batch 459, loss: 1.3253, instance_loss: 0.4467, weighted_loss: 1.0617, label: 2, bag_size: 769
batch 479, loss: 1.5700, instance_loss: 0.4810, weighted_loss: 1.2433, label: 4, bag_size: 266
batch 499, loss: 1.0294, instance_loss: 0.4597, weighted_loss: 0.8585, label: 1, bag_size: 460
batch 519, loss: 1.3306, instance_loss: 0.5161, weighted_loss: 1.0862, label: 4, bag_size: 244
batch 539, loss: 0.8609, instance_loss: 0.4683, weighted_loss: 0.7431, label: 0, bag_size: 573
batch 559, loss: 1.0597, instance_loss: 0.4611, weighted_loss: 0.8801, label: 3, bag_size: 274
batch 579, loss: 1.2286, instance_loss: 0.5160, weighted_loss: 1.0148, label: 4, bag_size: 824


class 0 clustering acc 0.99743265993266: correct 23699/23760
class 1 clustering acc 0.057028619528619526: correct 271/4752
Epoch: 9, train_loss: 1.2322, train_clustering_loss:  0.4828, train_error: 0.5337
class 0: acc 0.8604651162790697, correct 111/129
class 1: acc 0.2909090909090909, correct 32/110
class 2: acc 0.28225806451612906, correct 35/124
class 3: acc 0.24509803921568626, correct 25/102
class 4: acc 0.5736434108527132, correct 74/129

Val Set, val_loss: 1.4823, val_error: 0.5676, auc: 0.7468
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9985, instance_loss: 0.4877, weighted_loss: 0.8452, label: 1, bag_size: 814
batch 39, loss: 1.1930, instance_loss: 0.5102, weighted_loss: 0.9882, label: 3, bag_size: 312
batch 59, loss: 1.4000, instance_loss: 0.5135, weighted_loss: 1.1341, label: 3, bag_size: 451
batch 79, loss: 1.5323, instance_loss: 0.6531, weighted_loss: 1.2686, label: 3, bag_size: 1232
batch 99, loss: 0.1393, instance_loss: 0.2161, weighted_loss: 0.1623, label: 0, bag_size: 393
batch 119, loss: 1.0840, instance_loss: 0.4723, weighted_loss: 0.9005, label: 2, bag_size: 543
batch 139, loss: 1.3242, instance_loss: 0.5364, weighted_loss: 1.0879, label: 3, bag_size: 505
batch 159, loss: 2.0573, instance_loss: 0.5819, weighted_loss: 1.6147, label: 2, bag_size: 489
batch 179, loss: 1.5002, instance_loss: 0.5765, weighted_loss: 1.2230, label: 4, bag_size: 293
batch 199, loss: 1.2645, instance_loss: 0.4729, weighted_loss: 1.0270, label: 2, bag_size: 1308
batch 219, loss: 2.6391, instance_loss: 0.6748, weighted_loss: 2.0498, label: 4, bag_size: 1351
batch 239, loss: 1.7680, instance_loss: 0.5204, weighted_loss: 1.3937, label: 4, bag_size: 198
batch 259, loss: 1.1004, instance_loss: 0.5688, weighted_loss: 0.9409, label: 1, bag_size: 851
batch 279, loss: 0.0212, instance_loss: 0.2353, weighted_loss: 0.0854, label: 0, bag_size: 706
batch 299, loss: 1.0562, instance_loss: 0.4483, weighted_loss: 0.8738, label: 2, bag_size: 867
batch 319, loss: 0.7499, instance_loss: 0.4587, weighted_loss: 0.6626, label: 1, bag_size: 534
batch 339, loss: 1.5305, instance_loss: 0.4806, weighted_loss: 1.2155, label: 4, bag_size: 333
batch 359, loss: 0.9622, instance_loss: 0.4629, weighted_loss: 0.8124, label: 1, bag_size: 892
batch 379, loss: 0.4113, instance_loss: 0.4516, weighted_loss: 0.4234, label: 4, bag_size: 923
batch 399, loss: 1.1541, instance_loss: 0.5019, weighted_loss: 0.9584, label: 4, bag_size: 797
batch 419, loss: 0.0072, instance_loss: 0.2834, weighted_loss: 0.0901, label: 0, bag_size: 236
batch 439, loss: 1.1189, instance_loss: 0.4863, weighted_loss: 0.9291, label: 4, bag_size: 394
batch 459, loss: 1.5774, instance_loss: 0.5268, weighted_loss: 1.2622, label: 4, bag_size: 110
batch 479, loss: 0.8662, instance_loss: 0.4489, weighted_loss: 0.7410, label: 4, bag_size: 687
batch 499, loss: 1.7963, instance_loss: 0.4946, weighted_loss: 1.4058, label: 2, bag_size: 627
batch 519, loss: 1.3501, instance_loss: 0.4654, weighted_loss: 1.0847, label: 1, bag_size: 702
batch 539, loss: 0.2242, instance_loss: 0.4081, weighted_loss: 0.2793, label: 0, bag_size: 397
batch 559, loss: 1.5867, instance_loss: 0.4895, weighted_loss: 1.2576, label: 2, bag_size: 860
batch 579, loss: 1.9615, instance_loss: 0.5845, weighted_loss: 1.5484, label: 4, bag_size: 101


class 0 clustering acc 0.9983164983164983: correct 23720/23760
class 1 clustering acc 0.027146464646464648: correct 129/4752
Epoch: 10, train_loss: 1.2534, train_clustering_loss:  0.4940, train_error: 0.5623
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.3888888888888889, correct 49/126
class 2: acc 0.24793388429752067, correct 30/121
class 3: acc 0.2909090909090909, correct 32/110
class 4: acc 0.46551724137931033, correct 54/116

Val Set, val_loss: 1.5099, val_error: 0.6216, auc: 0.7418
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.5, correct 8/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3615, instance_loss: 0.4720, weighted_loss: 1.0946, label: 2, bag_size: 448
batch 39, loss: 0.5864, instance_loss: 0.3730, weighted_loss: 0.5223, label: 0, bag_size: 159
batch 59, loss: 0.4239, instance_loss: 0.5096, weighted_loss: 0.4496, label: 4, bag_size: 773
batch 79, loss: 2.1350, instance_loss: 0.5296, weighted_loss: 1.6534, label: 3, bag_size: 166
batch 99, loss: 0.4651, instance_loss: 0.4005, weighted_loss: 0.4457, label: 0, bag_size: 282
batch 119, loss: 0.9577, instance_loss: 0.5358, weighted_loss: 0.8311, label: 4, bag_size: 589
batch 139, loss: 0.0994, instance_loss: 0.3902, weighted_loss: 0.1867, label: 0, bag_size: 141
batch 159, loss: 2.8111, instance_loss: 0.5999, weighted_loss: 2.1477, label: 4, bag_size: 101
batch 179, loss: 0.5439, instance_loss: 0.4885, weighted_loss: 0.5273, label: 2, bag_size: 553
batch 199, loss: 1.4978, instance_loss: 0.6097, weighted_loss: 1.2313, label: 2, bag_size: 337
batch 219, loss: 0.9996, instance_loss: 0.4716, weighted_loss: 0.8412, label: 4, bag_size: 660
batch 239, loss: 2.1032, instance_loss: 0.5642, weighted_loss: 1.6415, label: 3, bag_size: 1022
batch 259, loss: 1.3818, instance_loss: 0.5206, weighted_loss: 1.1234, label: 1, bag_size: 605
batch 279, loss: 1.0654, instance_loss: 0.5168, weighted_loss: 0.9008, label: 4, bag_size: 450
batch 299, loss: 0.9542, instance_loss: 0.4845, weighted_loss: 0.8133, label: 4, bag_size: 660
batch 319, loss: 1.2224, instance_loss: 0.5008, weighted_loss: 1.0059, label: 1, bag_size: 500
batch 339, loss: 1.4520, instance_loss: 0.4563, weighted_loss: 1.1533, label: 3, bag_size: 587
batch 359, loss: 2.1149, instance_loss: 0.5855, weighted_loss: 1.6561, label: 2, bag_size: 627
batch 379, loss: 0.5712, instance_loss: 0.5147, weighted_loss: 0.5542, label: 0, bag_size: 247
batch 399, loss: 1.2025, instance_loss: 0.5713, weighted_loss: 1.0131, label: 1, bag_size: 271
batch 419, loss: 2.6915, instance_loss: 0.5830, weighted_loss: 2.0589, label: 2, bag_size: 597
batch 439, loss: 1.3095, instance_loss: 0.4652, weighted_loss: 1.0562, label: 1, bag_size: 483
batch 459, loss: 3.0734, instance_loss: 0.5783, weighted_loss: 2.3249, label: 4, bag_size: 854
batch 479, loss: 0.4355, instance_loss: 0.3784, weighted_loss: 0.4184, label: 4, bag_size: 727
batch 499, loss: 1.7077, instance_loss: 0.5206, weighted_loss: 1.3515, label: 2, bag_size: 629
batch 519, loss: 1.1117, instance_loss: 0.5838, weighted_loss: 0.9533, label: 0, bag_size: 122
batch 539, loss: 0.9329, instance_loss: 0.4270, weighted_loss: 0.7811, label: 3, bag_size: 344
batch 559, loss: 0.8194, instance_loss: 0.4495, weighted_loss: 0.7085, label: 3, bag_size: 473
batch 579, loss: 1.3791, instance_loss: 0.5052, weighted_loss: 1.1170, label: 1, bag_size: 766


class 0 clustering acc 0.9981902356902357: correct 23717/23760
class 1 clustering acc 0.018518518518518517: correct 88/4752
Epoch: 11, train_loss: 1.2490, train_clustering_loss:  0.4918, train_error: 0.5522
class 0: acc 0.8137254901960784, correct 83/102
class 1: acc 0.23728813559322035, correct 28/118
class 2: acc 0.25, correct 28/112
class 3: acc 0.45255474452554745, correct 62/137
class 4: acc 0.52, correct 65/125

Val Set, val_loss: 1.6127, val_error: 0.6486, auc: 0.7414
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.375, correct 6/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.8571428571428571, correct 12/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.8641, instance_loss: 0.5738, weighted_loss: 1.4770, label: 1, bag_size: 599
batch 39, loss: 0.9941, instance_loss: 0.4956, weighted_loss: 0.8445, label: 2, bag_size: 799
batch 59, loss: 2.3390, instance_loss: 0.5820, weighted_loss: 1.8119, label: 4, bag_size: 399
batch 79, loss: 3.2915, instance_loss: 0.6104, weighted_loss: 2.4871, label: 4, bag_size: 293
batch 99, loss: 0.7743, instance_loss: 0.4086, weighted_loss: 0.6646, label: 3, bag_size: 737
batch 119, loss: 0.8891, instance_loss: 0.4862, weighted_loss: 0.7683, label: 2, bag_size: 1608
batch 139, loss: 0.8146, instance_loss: 0.3981, weighted_loss: 0.6896, label: 3, bag_size: 727
batch 159, loss: 0.8578, instance_loss: 0.4135, weighted_loss: 0.7245, label: 3, bag_size: 956
batch 179, loss: 1.4865, instance_loss: 0.4509, weighted_loss: 1.1758, label: 2, bag_size: 717
batch 199, loss: 1.4981, instance_loss: 0.5668, weighted_loss: 1.2187, label: 1, bag_size: 949
batch 219, loss: 1.2275, instance_loss: 0.4710, weighted_loss: 1.0006, label: 2, bag_size: 369
batch 239, loss: 1.2266, instance_loss: 0.4553, weighted_loss: 0.9952, label: 1, bag_size: 329
batch 259, loss: 2.4198, instance_loss: 0.6209, weighted_loss: 1.8801, label: 4, bag_size: 854
batch 279, loss: 2.1923, instance_loss: 0.5381, weighted_loss: 1.6960, label: 4, bag_size: 886
batch 299, loss: 2.2810, instance_loss: 0.4651, weighted_loss: 1.7363, label: 0, bag_size: 243
batch 319, loss: 1.0257, instance_loss: 0.4907, weighted_loss: 0.8652, label: 3, bag_size: 1232
batch 339, loss: 1.0050, instance_loss: 0.4134, weighted_loss: 0.8275, label: 3, bag_size: 230
batch 359, loss: 1.1307, instance_loss: 0.3844, weighted_loss: 0.9068, label: 3, bag_size: 499
batch 379, loss: 2.2794, instance_loss: 0.5732, weighted_loss: 1.7675, label: 4, bag_size: 862
batch 399, loss: 0.8182, instance_loss: 0.4793, weighted_loss: 0.7166, label: 1, bag_size: 1103
batch 419, loss: 0.4400, instance_loss: 0.5206, weighted_loss: 0.4642, label: 4, bag_size: 1018
batch 439, loss: 1.4941, instance_loss: 0.5101, weighted_loss: 1.1989, label: 4, bag_size: 520
batch 459, loss: 1.8621, instance_loss: 0.5367, weighted_loss: 1.4645, label: 2, bag_size: 697
batch 479, loss: 0.9492, instance_loss: 0.4598, weighted_loss: 0.8024, label: 2, bag_size: 598
batch 499, loss: 1.5177, instance_loss: 0.5893, weighted_loss: 1.2392, label: 4, bag_size: 590
batch 519, loss: 1.5491, instance_loss: 0.5120, weighted_loss: 1.2380, label: 3, bag_size: 488
batch 539, loss: 1.0371, instance_loss: 0.4499, weighted_loss: 0.8609, label: 1, bag_size: 390
batch 559, loss: 0.8767, instance_loss: 0.5147, weighted_loss: 0.7681, label: 2, bag_size: 607
batch 579, loss: 0.3461, instance_loss: 0.4250, weighted_loss: 0.3698, label: 0, bag_size: 281


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.03156565656565657: correct 150/4752
Epoch: 12, train_loss: 1.2132, train_clustering_loss:  0.4884, train_error: 0.5185
class 0: acc 0.8461538461538461, correct 88/104
class 1: acc 0.3384615384615385, correct 44/130
class 2: acc 0.3515625, correct 45/128
class 3: acc 0.5343511450381679, correct 70/131
class 4: acc 0.38613861386138615, correct 39/101

Val Set, val_loss: 1.4353, val_error: 0.5541, auc: 0.7645
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.447277 --> 1.435278).  Saving model ...


batch 19, loss: 0.9643, instance_loss: 0.4189, weighted_loss: 0.8007, label: 2, bag_size: 285
batch 39, loss: 1.2101, instance_loss: 0.4358, weighted_loss: 0.9778, label: 1, bag_size: 460
batch 59, loss: 1.6131, instance_loss: 0.5424, weighted_loss: 1.2919, label: 3, bag_size: 423
batch 79, loss: 0.0362, instance_loss: 0.2592, weighted_loss: 0.1031, label: 0, bag_size: 221
batch 99, loss: 0.1416, instance_loss: 0.4362, weighted_loss: 0.2300, label: 2, bag_size: 553
batch 119, loss: 0.9292, instance_loss: 0.5624, weighted_loss: 0.8192, label: 1, bag_size: 44
batch 139, loss: 0.9560, instance_loss: 0.4714, weighted_loss: 0.8106, label: 3, bag_size: 309
batch 159, loss: 0.2407, instance_loss: 0.4059, weighted_loss: 0.2903, label: 0, bag_size: 428
batch 179, loss: 0.1425, instance_loss: 0.2996, weighted_loss: 0.1896, label: 0, bag_size: 49
batch 199, loss: 1.5707, instance_loss: 0.5310, weighted_loss: 1.2588, label: 4, bag_size: 377
batch 219, loss: 1.6672, instance_loss: 0.5662, weighted_loss: 1.3369, label: 2, bag_size: 404
batch 239, loss: 1.1994, instance_loss: 0.5661, weighted_loss: 1.0094, label: 4, bag_size: 854
batch 259, loss: 1.7430, instance_loss: 0.4737, weighted_loss: 1.3622, label: 1, bag_size: 1013
batch 279, loss: 2.3310, instance_loss: 0.6465, weighted_loss: 1.8257, label: 0, bag_size: 710
batch 299, loss: 2.7050, instance_loss: 0.7115, weighted_loss: 2.1070, label: 1, bag_size: 45
batch 319, loss: 0.6347, instance_loss: 0.4279, weighted_loss: 0.5726, label: 4, bag_size: 266
batch 339, loss: 0.7816, instance_loss: 0.4353, weighted_loss: 0.6777, label: 2, bag_size: 558
batch 359, loss: 0.4540, instance_loss: 0.3791, weighted_loss: 0.4315, label: 4, bag_size: 780
batch 379, loss: 0.9027, instance_loss: 0.4510, weighted_loss: 0.7672, label: 4, bag_size: 228
batch 399, loss: 0.7150, instance_loss: 0.4793, weighted_loss: 0.6443, label: 2, bag_size: 616
batch 419, loss: 0.8493, instance_loss: 0.4608, weighted_loss: 0.7327, label: 2, bag_size: 290
batch 439, loss: 1.6041, instance_loss: 0.5406, weighted_loss: 1.2851, label: 3, bag_size: 1007
batch 459, loss: 0.2366, instance_loss: 0.4679, weighted_loss: 0.3060, label: 0, bag_size: 218
batch 479, loss: 0.7328, instance_loss: 0.5339, weighted_loss: 0.6731, label: 4, bag_size: 960
batch 499, loss: 0.4463, instance_loss: 0.4170, weighted_loss: 0.4375, label: 4, bag_size: 727
batch 519, loss: 1.7848, instance_loss: 0.5809, weighted_loss: 1.4236, label: 2, bag_size: 448
batch 539, loss: 0.5243, instance_loss: 0.3215, weighted_loss: 0.4634, label: 0, bag_size: 282
batch 559, loss: 1.0778, instance_loss: 0.4639, weighted_loss: 0.8937, label: 3, bag_size: 473
batch 579, loss: 0.6871, instance_loss: 0.4302, weighted_loss: 0.6100, label: 4, bag_size: 729


class 0 clustering acc 0.9984848484848485: correct 23724/23760
class 1 clustering acc 0.022095959595959596: correct 105/4752
Epoch: 13, train_loss: 1.2216, train_clustering_loss:  0.4927, train_error: 0.5589
class 0: acc 0.8348623853211009, correct 91/109
class 1: acc 0.15, correct 15/100
class 2: acc 0.3969465648854962, correct 52/131
class 3: acc 0.3937007874015748, correct 50/127
class 4: acc 0.4251968503937008, correct 54/127

Val Set, val_loss: 1.5566, val_error: 0.5676, auc: 0.7471
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1884, instance_loss: 0.5174, weighted_loss: 0.9871, label: 1, bag_size: 605
batch 39, loss: 0.3030, instance_loss: 0.3917, weighted_loss: 0.3296, label: 4, bag_size: 409
batch 59, loss: 0.0923, instance_loss: 0.3205, weighted_loss: 0.1608, label: 0, bag_size: 156
batch 79, loss: 0.7748, instance_loss: 0.4777, weighted_loss: 0.6856, label: 1, bag_size: 1082
batch 99, loss: 0.3341, instance_loss: 0.4363, weighted_loss: 0.3647, label: 0, bag_size: 234
batch 119, loss: 1.0160, instance_loss: 0.5367, weighted_loss: 0.8722, label: 0, bag_size: 295
batch 139, loss: 1.3649, instance_loss: 0.5402, weighted_loss: 1.1175, label: 3, bag_size: 364
batch 159, loss: 1.3390, instance_loss: 0.5260, weighted_loss: 1.0951, label: 3, bag_size: 154
batch 179, loss: 3.1173, instance_loss: 0.7080, weighted_loss: 2.3945, label: 0, bag_size: 1039
batch 199, loss: 1.0112, instance_loss: 0.4705, weighted_loss: 0.8490, label: 3, bag_size: 1131
batch 219, loss: 0.7866, instance_loss: 0.4443, weighted_loss: 0.6839, label: 3, bag_size: 431
batch 239, loss: 0.9812, instance_loss: 0.4861, weighted_loss: 0.8327, label: 3, bag_size: 423
batch 259, loss: 1.0779, instance_loss: 0.5124, weighted_loss: 0.9083, label: 1, bag_size: 1013
batch 279, loss: 2.4879, instance_loss: 0.6318, weighted_loss: 1.9311, label: 2, bag_size: 1308
batch 299, loss: 1.8001, instance_loss: 0.6009, weighted_loss: 1.4403, label: 2, bag_size: 177
batch 319, loss: 1.1664, instance_loss: 0.5639, weighted_loss: 0.9856, label: 2, bag_size: 253
batch 339, loss: 0.3414, instance_loss: 0.5206, weighted_loss: 0.3952, label: 4, bag_size: 923
batch 359, loss: 1.0864, instance_loss: 0.5196, weighted_loss: 0.9163, label: 1, bag_size: 355
batch 379, loss: 0.7208, instance_loss: 0.4280, weighted_loss: 0.6330, label: 4, bag_size: 665
batch 399, loss: 0.8547, instance_loss: 0.4015, weighted_loss: 0.7187, label: 0, bag_size: 188
batch 419, loss: 1.2997, instance_loss: 0.5035, weighted_loss: 1.0608, label: 3, bag_size: 857
batch 439, loss: 0.3942, instance_loss: 0.3729, weighted_loss: 0.3878, label: 0, bag_size: 79
batch 459, loss: 2.2381, instance_loss: 0.5347, weighted_loss: 1.7271, label: 2, bag_size: 1122
batch 479, loss: 1.9425, instance_loss: 0.5524, weighted_loss: 1.5255, label: 3, bag_size: 390
batch 499, loss: 2.7694, instance_loss: 0.5949, weighted_loss: 2.1171, label: 0, bag_size: 169
batch 519, loss: 1.2083, instance_loss: 0.4983, weighted_loss: 0.9953, label: 1, bag_size: 410
batch 539, loss: 1.4453, instance_loss: 0.5263, weighted_loss: 1.1696, label: 0, bag_size: 230
batch 559, loss: 1.2254, instance_loss: 0.5710, weighted_loss: 1.0291, label: 2, bag_size: 317
batch 579, loss: 1.4675, instance_loss: 0.5036, weighted_loss: 1.1783, label: 3, bag_size: 235


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.0242003367003367: correct 115/4752
Epoch: 14, train_loss: 1.2571, train_clustering_loss:  0.4956, train_error: 0.5370
class 0: acc 0.8306451612903226, correct 103/124
class 1: acc 0.35658914728682173, correct 46/129
class 2: acc 0.24545454545454545, correct 27/110
class 3: acc 0.32727272727272727, correct 36/110
class 4: acc 0.5206611570247934, correct 63/121

Val Set, val_loss: 1.5645, val_error: 0.5946, auc: 0.7850
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4561, instance_loss: 0.5387, weighted_loss: 1.1809, label: 1, bag_size: 159
batch 39, loss: 1.0510, instance_loss: 0.5190, weighted_loss: 0.8914, label: 3, bag_size: 1131
batch 59, loss: 1.2746, instance_loss: 0.5888, weighted_loss: 1.0689, label: 0, bag_size: 710
batch 79, loss: 2.0776, instance_loss: 0.5683, weighted_loss: 1.6248, label: 4, bag_size: 757
batch 99, loss: 0.9574, instance_loss: 0.4880, weighted_loss: 0.8166, label: 1, bag_size: 748
batch 119, loss: 1.1984, instance_loss: 0.4348, weighted_loss: 0.9693, label: 2, bag_size: 394
batch 139, loss: 0.8831, instance_loss: 0.4705, weighted_loss: 0.7593, label: 3, bag_size: 822
batch 159, loss: 1.8114, instance_loss: 0.6246, weighted_loss: 1.4554, label: 4, bag_size: 937
batch 179, loss: 0.7348, instance_loss: 0.3612, weighted_loss: 0.6227, label: 4, bag_size: 266
batch 199, loss: 1.6343, instance_loss: 0.5040, weighted_loss: 1.2953, label: 3, bag_size: 431
batch 219, loss: 1.6283, instance_loss: 0.5121, weighted_loss: 1.2934, label: 3, bag_size: 323
batch 239, loss: 0.6090, instance_loss: 0.4998, weighted_loss: 0.5762, label: 0, bag_size: 760
batch 259, loss: 0.8582, instance_loss: 0.4421, weighted_loss: 0.7334, label: 2, bag_size: 1079
batch 279, loss: 0.1162, instance_loss: 0.4288, weighted_loss: 0.2100, label: 0, bag_size: 366
batch 299, loss: 1.0408, instance_loss: 0.4700, weighted_loss: 0.8696, label: 3, bag_size: 258
batch 319, loss: 0.1406, instance_loss: 0.3345, weighted_loss: 0.1988, label: 0, bag_size: 59
batch 339, loss: 1.7419, instance_loss: 0.5474, weighted_loss: 1.3836, label: 2, bag_size: 411
batch 359, loss: 1.0349, instance_loss: 0.4670, weighted_loss: 0.8645, label: 3, bag_size: 566
batch 379, loss: 2.8318, instance_loss: 0.5761, weighted_loss: 2.1551, label: 0, bag_size: 1039
batch 399, loss: 1.0294, instance_loss: 0.3832, weighted_loss: 0.8355, label: 3, bag_size: 587
batch 419, loss: 1.1448, instance_loss: 0.6282, weighted_loss: 0.9898, label: 4, bag_size: 489
batch 439, loss: 1.7878, instance_loss: 0.5273, weighted_loss: 1.4096, label: 2, bag_size: 297
batch 459, loss: 0.9125, instance_loss: 0.4371, weighted_loss: 0.7699, label: 2, bag_size: 208
batch 479, loss: 0.1431, instance_loss: 0.2547, weighted_loss: 0.1766, label: 0, bag_size: 210
batch 499, loss: 0.1882, instance_loss: 0.2399, weighted_loss: 0.2037, label: 0, bag_size: 201
batch 519, loss: 0.0122, instance_loss: 0.1922, weighted_loss: 0.0662, label: 0, bag_size: 258
batch 539, loss: 1.2243, instance_loss: 0.4990, weighted_loss: 1.0067, label: 4, bag_size: 468
batch 559, loss: 1.5925, instance_loss: 0.5154, weighted_loss: 1.2694, label: 4, bag_size: 101
batch 579, loss: 1.2886, instance_loss: 0.4647, weighted_loss: 1.0414, label: 1, bag_size: 1091


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.05134680134680135: correct 244/4752
Epoch: 15, train_loss: 1.1269, train_clustering_loss:  0.4776, train_error: 0.4646
class 0: acc 0.8549618320610687, correct 112/131
class 1: acc 0.2962962962962963, correct 32/108
class 2: acc 0.4609375, correct 59/128
class 3: acc 0.4594594594594595, correct 51/111
class 4: acc 0.5517241379310345, correct 64/116

Val Set, val_loss: 1.5260, val_error: 0.4730, auc: 0.8199
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.02533783783783784: correct 15/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1238, instance_loss: 0.5058, weighted_loss: 0.9384, label: 2, bag_size: 554
batch 39, loss: 0.5871, instance_loss: 0.4347, weighted_loss: 0.5414, label: 2, bag_size: 690
batch 59, loss: 0.1251, instance_loss: 0.2972, weighted_loss: 0.1768, label: 0, bag_size: 453
batch 79, loss: 0.5863, instance_loss: 0.3912, weighted_loss: 0.5278, label: 2, bag_size: 852
batch 99, loss: 0.8135, instance_loss: 0.4718, weighted_loss: 0.7110, label: 3, bag_size: 309
batch 119, loss: 1.3061, instance_loss: 0.5322, weighted_loss: 1.0739, label: 3, bag_size: 681
batch 139, loss: 1.3793, instance_loss: 0.4560, weighted_loss: 1.1023, label: 2, bag_size: 445
batch 159, loss: 0.4859, instance_loss: 0.4720, weighted_loss: 0.4818, label: 1, bag_size: 1497
batch 179, loss: 0.7120, instance_loss: 0.5459, weighted_loss: 0.6622, label: 0, bag_size: 383
batch 199, loss: 1.0180, instance_loss: 0.4781, weighted_loss: 0.8560, label: 4, bag_size: 263
batch 219, loss: 1.4857, instance_loss: 0.5374, weighted_loss: 1.2012, label: 4, bag_size: 250
batch 239, loss: 1.5351, instance_loss: 0.5090, weighted_loss: 1.2273, label: 2, bag_size: 717
batch 259, loss: 0.1295, instance_loss: 0.3016, weighted_loss: 0.1812, label: 0, bag_size: 159
batch 279, loss: 0.3774, instance_loss: 0.4377, weighted_loss: 0.3955, label: 0, bag_size: 224
batch 299, loss: 1.1729, instance_loss: 0.5166, weighted_loss: 0.9760, label: 1, bag_size: 177
batch 319, loss: 0.2684, instance_loss: 0.3200, weighted_loss: 0.2839, label: 0, bag_size: 517
batch 339, loss: 0.9661, instance_loss: 0.4407, weighted_loss: 0.8085, label: 3, bag_size: 556
batch 359, loss: 1.0567, instance_loss: 0.4654, weighted_loss: 0.8793, label: 3, bag_size: 631
batch 379, loss: 0.6724, instance_loss: 0.4325, weighted_loss: 0.6004, label: 4, bag_size: 490
batch 399, loss: 3.3939, instance_loss: 0.7843, weighted_loss: 2.6110, label: 0, bag_size: 283
batch 419, loss: 0.3394, instance_loss: 0.4611, weighted_loss: 0.3759, label: 0, bag_size: 524
batch 439, loss: 1.2121, instance_loss: 0.4878, weighted_loss: 0.9948, label: 3, bag_size: 393
batch 459, loss: 1.2378, instance_loss: 0.5461, weighted_loss: 1.0303, label: 1, bag_size: 660
batch 479, loss: 0.2853, instance_loss: 0.3659, weighted_loss: 0.3095, label: 0, bag_size: 62
batch 499, loss: 0.0865, instance_loss: 0.3091, weighted_loss: 0.1533, label: 0, bag_size: 231
batch 519, loss: 1.1429, instance_loss: 0.4891, weighted_loss: 0.9468, label: 2, bag_size: 315
batch 539, loss: 0.3094, instance_loss: 0.3544, weighted_loss: 0.3229, label: 0, bag_size: 142
batch 559, loss: 1.1563, instance_loss: 0.5296, weighted_loss: 0.9683, label: 2, bag_size: 576
batch 579, loss: 2.1611, instance_loss: 0.5649, weighted_loss: 1.6823, label: 2, bag_size: 367


class 0 clustering acc 0.9953703703703703: correct 23650/23760
class 1 clustering acc 0.03367003367003367: correct 160/4752
Epoch: 16, train_loss: 1.1378, train_clustering_loss:  0.4865, train_error: 0.5084
class 0: acc 0.8676470588235294, correct 118/136
class 1: acc 0.325, correct 39/120
class 2: acc 0.3103448275862069, correct 36/116
class 3: acc 0.45217391304347826, correct 52/115
class 4: acc 0.4392523364485981, correct 47/107

Val Set, val_loss: 1.5387, val_error: 0.6216, auc: 0.7811
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9117, instance_loss: 0.5784, weighted_loss: 0.8117, label: 0, bag_size: 230
batch 39, loss: 0.8863, instance_loss: 0.4598, weighted_loss: 0.7584, label: 3, bag_size: 739
batch 59, loss: 1.2835, instance_loss: 0.5183, weighted_loss: 1.0540, label: 3, bag_size: 344
batch 79, loss: 0.8080, instance_loss: 0.3957, weighted_loss: 0.6843, label: 3, bag_size: 603
batch 99, loss: 0.6280, instance_loss: 0.3927, weighted_loss: 0.5574, label: 2, bag_size: 530
batch 119, loss: 1.2577, instance_loss: 0.4765, weighted_loss: 1.0233, label: 1, bag_size: 829
batch 139, loss: 1.6922, instance_loss: 0.4731, weighted_loss: 1.3265, label: 2, bag_size: 731
batch 159, loss: 1.1373, instance_loss: 0.5407, weighted_loss: 0.9583, label: 2, bag_size: 614
batch 179, loss: 4.3225, instance_loss: 0.8201, weighted_loss: 3.2718, label: 1, bag_size: 45
batch 199, loss: 0.4453, instance_loss: 0.4044, weighted_loss: 0.4330, label: 4, bag_size: 775
batch 219, loss: 0.6313, instance_loss: 0.4171, weighted_loss: 0.5670, label: 0, bag_size: 183
batch 239, loss: 1.5235, instance_loss: 0.5432, weighted_loss: 1.2294, label: 4, bag_size: 590
batch 259, loss: 2.0739, instance_loss: 0.5203, weighted_loss: 1.6078, label: 1, bag_size: 422
batch 279, loss: 1.9242, instance_loss: 0.5180, weighted_loss: 1.5023, label: 2, bag_size: 367
batch 299, loss: 2.0044, instance_loss: 0.5458, weighted_loss: 1.5669, label: 2, bag_size: 1319
batch 319, loss: 1.2552, instance_loss: 0.5281, weighted_loss: 1.0370, label: 3, bag_size: 1021
batch 339, loss: 1.3067, instance_loss: 0.4247, weighted_loss: 1.0421, label: 3, bag_size: 495
batch 359, loss: 1.9840, instance_loss: 0.5335, weighted_loss: 1.5489, label: 3, bag_size: 1022
batch 379, loss: 0.9243, instance_loss: 0.4327, weighted_loss: 0.7768, label: 4, bag_size: 780
batch 399, loss: 0.6542, instance_loss: 0.3607, weighted_loss: 0.5661, label: 3, bag_size: 822
batch 419, loss: 1.4145, instance_loss: 0.4803, weighted_loss: 1.1343, label: 1, bag_size: 906
batch 439, loss: 1.2611, instance_loss: 0.5543, weighted_loss: 1.0491, label: 4, bag_size: 418
batch 459, loss: 1.0610, instance_loss: 0.4319, weighted_loss: 0.8723, label: 3, bag_size: 451
batch 479, loss: 1.4945, instance_loss: 0.6124, weighted_loss: 1.2299, label: 4, bag_size: 699
batch 499, loss: 1.5224, instance_loss: 0.4702, weighted_loss: 1.2067, label: 2, bag_size: 1013
batch 519, loss: 1.1194, instance_loss: 0.5111, weighted_loss: 0.9369, label: 1, bag_size: 925
batch 539, loss: 1.5128, instance_loss: 0.4920, weighted_loss: 1.2066, label: 2, bag_size: 411
batch 559, loss: 1.1612, instance_loss: 0.4831, weighted_loss: 0.9578, label: 3, bag_size: 282
batch 579, loss: 0.9542, instance_loss: 0.5151, weighted_loss: 0.8225, label: 2, bag_size: 690


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.018518518518518517: correct 88/4752
Epoch: 17, train_loss: 1.2000, train_clustering_loss:  0.4864, train_error: 0.5185
class 0: acc 0.8034188034188035, correct 94/117
class 1: acc 0.3090909090909091, correct 34/110
class 2: acc 0.3816793893129771, correct 50/131
class 3: acc 0.5317460317460317, correct 67/126
class 4: acc 0.37272727272727274, correct 41/110

Val Set, val_loss: 1.5157, val_error: 0.4730, auc: 0.8218
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0889, instance_loss: 0.4547, weighted_loss: 0.8986, label: 3, bag_size: 258
batch 39, loss: 0.8067, instance_loss: 0.4758, weighted_loss: 0.7075, label: 3, bag_size: 282
batch 59, loss: 2.0406, instance_loss: 0.6144, weighted_loss: 1.6127, label: 1, bag_size: 422
batch 79, loss: 1.8828, instance_loss: 0.5686, weighted_loss: 1.4886, label: 4, bag_size: 604
batch 99, loss: 0.4304, instance_loss: 0.4170, weighted_loss: 0.4264, label: 0, bag_size: 642
batch 119, loss: 0.0350, instance_loss: 0.2614, weighted_loss: 0.1029, label: 0, bag_size: 49
batch 139, loss: 0.8814, instance_loss: 0.9358, weighted_loss: 0.8977, label: 1, bag_size: 1497
batch 159, loss: 1.0500, instance_loss: 0.4951, weighted_loss: 0.8835, label: 1, bag_size: 591
batch 179, loss: 1.1682, instance_loss: 0.4315, weighted_loss: 0.9472, label: 3, bag_size: 894
batch 199, loss: 0.5561, instance_loss: 0.4893, weighted_loss: 0.5360, label: 4, bag_size: 1158
batch 219, loss: 0.2087, instance_loss: 0.3917, weighted_loss: 0.2636, label: 0, bag_size: 141
batch 239, loss: 0.8093, instance_loss: 0.6238, weighted_loss: 0.7537, label: 1, bag_size: 44
batch 259, loss: 1.2154, instance_loss: 0.5118, weighted_loss: 1.0043, label: 2, bag_size: 1066
batch 279, loss: 1.2987, instance_loss: 0.4620, weighted_loss: 1.0477, label: 3, bag_size: 428
batch 299, loss: 1.0122, instance_loss: 0.4419, weighted_loss: 0.8411, label: 3, bag_size: 1007
batch 319, loss: 2.4107, instance_loss: 0.5344, weighted_loss: 1.8478, label: 1, bag_size: 564
batch 339, loss: 1.0068, instance_loss: 0.5212, weighted_loss: 0.8611, label: 3, bag_size: 344
batch 359, loss: 0.5295, instance_loss: 0.3892, weighted_loss: 0.4874, label: 4, bag_size: 948
batch 379, loss: 0.5248, instance_loss: 0.4526, weighted_loss: 0.5032, label: 3, bag_size: 272
batch 399, loss: 0.8993, instance_loss: 0.4466, weighted_loss: 0.7635, label: 2, bag_size: 402
batch 419, loss: 1.0198, instance_loss: 0.6989, weighted_loss: 0.9235, label: 1, bag_size: 106
batch 439, loss: 0.9008, instance_loss: 0.4455, weighted_loss: 0.7642, label: 2, bag_size: 253
batch 459, loss: 0.0492, instance_loss: 0.4048, weighted_loss: 0.1559, label: 0, bag_size: 351
batch 479, loss: 1.4202, instance_loss: 0.5666, weighted_loss: 1.1641, label: 4, bag_size: 868
batch 499, loss: 1.3647, instance_loss: 0.4720, weighted_loss: 1.0969, label: 2, bag_size: 864
batch 519, loss: 1.2517, instance_loss: 0.4646, weighted_loss: 1.0156, label: 1, bag_size: 500
batch 539, loss: 1.2848, instance_loss: 0.4948, weighted_loss: 1.0478, label: 1, bag_size: 390
batch 559, loss: 0.6670, instance_loss: 0.4767, weighted_loss: 0.6099, label: 3, bag_size: 309
batch 579, loss: 1.1078, instance_loss: 0.4475, weighted_loss: 0.9097, label: 2, bag_size: 572


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.026936026936026935: correct 128/4752
Epoch: 18, train_loss: 1.1310, train_clustering_loss:  0.4875, train_error: 0.4983
class 0: acc 0.8306451612903226, correct 103/124
class 1: acc 0.4132231404958678, correct 50/121
class 2: acc 0.27358490566037735, correct 29/106
class 3: acc 0.49206349206349204, correct 62/126
class 4: acc 0.46153846153846156, correct 54/117

Val Set, val_loss: 1.5434, val_error: 0.5811, auc: 0.8065
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3849, instance_loss: 0.4472, weighted_loss: 1.1036, label: 2, bag_size: 549
batch 39, loss: 0.8872, instance_loss: 0.4170, weighted_loss: 0.7461, label: 2, bag_size: 708
batch 59, loss: 1.5092, instance_loss: 0.5270, weighted_loss: 1.2146, label: 4, bag_size: 318
batch 79, loss: 1.3762, instance_loss: 0.4929, weighted_loss: 1.1112, label: 4, bag_size: 886
batch 99, loss: 1.6860, instance_loss: 0.4658, weighted_loss: 1.3199, label: 2, bag_size: 1092
batch 119, loss: 0.8021, instance_loss: 0.4972, weighted_loss: 0.7106, label: 3, bag_size: 956
batch 139, loss: 0.0808, instance_loss: 0.3232, weighted_loss: 0.1535, label: 0, bag_size: 282
batch 159, loss: 0.0250, instance_loss: 0.2789, weighted_loss: 0.1012, label: 0, bag_size: 63
batch 179, loss: 0.9627, instance_loss: 0.5087, weighted_loss: 0.8265, label: 3, bag_size: 982
batch 199, loss: 1.1615, instance_loss: 0.4277, weighted_loss: 0.9414, label: 1, bag_size: 1009
batch 219, loss: 1.3855, instance_loss: 0.4837, weighted_loss: 1.1149, label: 2, bag_size: 315
batch 239, loss: 0.9525, instance_loss: 0.4700, weighted_loss: 0.8078, label: 2, bag_size: 690
batch 259, loss: 1.1278, instance_loss: 0.4684, weighted_loss: 0.9300, label: 1, bag_size: 620
batch 279, loss: 0.0581, instance_loss: 0.2853, weighted_loss: 0.1262, label: 0, bag_size: 188
batch 299, loss: 0.0712, instance_loss: 0.3023, weighted_loss: 0.1405, label: 0, bag_size: 351
batch 319, loss: 0.8879, instance_loss: 0.4834, weighted_loss: 0.7665, label: 2, bag_size: 614
batch 339, loss: 1.2694, instance_loss: 0.5105, weighted_loss: 1.0417, label: 2, bag_size: 337
batch 359, loss: 1.2012, instance_loss: 0.4797, weighted_loss: 0.9847, label: 3, bag_size: 804
batch 379, loss: 0.7673, instance_loss: 0.3941, weighted_loss: 0.6554, label: 3, bag_size: 566
batch 399, loss: 1.7670, instance_loss: 0.5131, weighted_loss: 1.3909, label: 2, bag_size: 549
batch 419, loss: 1.1714, instance_loss: 0.4810, weighted_loss: 0.9642, label: 1, bag_size: 1103
batch 439, loss: 1.1680, instance_loss: 0.5103, weighted_loss: 0.9707, label: 1, bag_size: 483
batch 459, loss: 1.1770, instance_loss: 0.5575, weighted_loss: 0.9912, label: 2, bag_size: 1066
batch 479, loss: 1.1804, instance_loss: 0.5036, weighted_loss: 0.9774, label: 4, bag_size: 506
batch 499, loss: 1.2525, instance_loss: 0.5482, weighted_loss: 1.0412, label: 3, bag_size: 1060
batch 519, loss: 1.5218, instance_loss: 0.4803, weighted_loss: 1.2094, label: 2, bag_size: 488
batch 539, loss: 0.9537, instance_loss: 0.4426, weighted_loss: 0.8004, label: 1, bag_size: 355
batch 559, loss: 2.2596, instance_loss: 0.5345, weighted_loss: 1.7421, label: 4, bag_size: 270
batch 579, loss: 0.5039, instance_loss: 0.4562, weighted_loss: 0.4896, label: 4, bag_size: 520


class 0 clustering acc 0.9963804713804714: correct 23674/23760
class 1 clustering acc 0.024831649831649833: correct 118/4752
Epoch: 19, train_loss: 1.1577, train_clustering_loss:  0.4850, train_error: 0.4916
class 0: acc 0.8, correct 88/110
class 1: acc 0.5241379310344828, correct 76/145
class 2: acc 0.3826086956521739, correct 44/115
class 3: acc 0.41379310344827586, correct 48/116
class 4: acc 0.42592592592592593, correct 46/108

Val Set, val_loss: 1.4911, val_error: 0.5811, auc: 0.8213
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3003, instance_loss: 0.4292, weighted_loss: 0.3390, label: 0, bag_size: 453
batch 39, loss: 1.1669, instance_loss: 0.4650, weighted_loss: 0.9564, label: 2, bag_size: 906
batch 59, loss: 1.1300, instance_loss: 0.4934, weighted_loss: 0.9390, label: 0, bag_size: 223
batch 79, loss: 0.2598, instance_loss: 0.3724, weighted_loss: 0.2936, label: 0, bag_size: 393
batch 99, loss: 0.3140, instance_loss: 0.4459, weighted_loss: 0.3536, label: 4, bag_size: 574
batch 119, loss: 1.3414, instance_loss: 0.4921, weighted_loss: 1.0866, label: 3, bag_size: 928
batch 139, loss: 0.0826, instance_loss: 0.2762, weighted_loss: 0.1407, label: 0, bag_size: 223
batch 159, loss: 0.9209, instance_loss: 0.4063, weighted_loss: 0.7665, label: 3, bag_size: 789
batch 179, loss: 1.2339, instance_loss: 0.4926, weighted_loss: 1.0115, label: 3, bag_size: 451
batch 199, loss: 0.6320, instance_loss: 0.4770, weighted_loss: 0.5855, label: 0, bag_size: 81
batch 219, loss: 1.6068, instance_loss: 0.5467, weighted_loss: 1.2887, label: 1, bag_size: 840
batch 239, loss: 1.4767, instance_loss: 0.5299, weighted_loss: 1.1927, label: 1, bag_size: 766
batch 259, loss: 1.8098, instance_loss: 0.5359, weighted_loss: 1.4277, label: 2, bag_size: 258
batch 279, loss: 0.6453, instance_loss: 0.3645, weighted_loss: 0.5611, label: 3, bag_size: 817
batch 299, loss: 3.1304, instance_loss: 0.6455, weighted_loss: 2.3849, label: 2, bag_size: 394
batch 319, loss: 1.4147, instance_loss: 0.5407, weighted_loss: 1.1525, label: 1, bag_size: 159
batch 339, loss: 0.2316, instance_loss: 0.4582, weighted_loss: 0.2996, label: 4, bag_size: 541
batch 359, loss: 1.1031, instance_loss: 0.4631, weighted_loss: 0.9111, label: 2, bag_size: 731
batch 379, loss: 0.9136, instance_loss: 0.4552, weighted_loss: 0.7761, label: 1, bag_size: 271
batch 399, loss: 1.3150, instance_loss: 0.5483, weighted_loss: 1.0850, label: 3, bag_size: 488
batch 419, loss: 0.3911, instance_loss: 0.4352, weighted_loss: 0.4043, label: 0, bag_size: 282
batch 439, loss: 3.6374, instance_loss: 0.7813, weighted_loss: 2.7806, label: 4, bag_size: 1351
batch 459, loss: 0.0165, instance_loss: 0.3339, weighted_loss: 0.1118, label: 0, bag_size: 428
batch 479, loss: 0.8926, instance_loss: 0.4320, weighted_loss: 0.7544, label: 3, bag_size: 488
batch 499, loss: 1.7569, instance_loss: 0.5693, weighted_loss: 1.4006, label: 4, bag_size: 356
batch 519, loss: 3.2353, instance_loss: 0.6471, weighted_loss: 2.4589, label: 4, bag_size: 101
batch 539, loss: 1.1962, instance_loss: 0.5055, weighted_loss: 0.9890, label: 2, bag_size: 702
batch 559, loss: 1.8236, instance_loss: 0.5882, weighted_loss: 1.4530, label: 1, bag_size: 159
batch 579, loss: 1.5177, instance_loss: 0.5743, weighted_loss: 1.2347, label: 1, bag_size: 410


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.03009259259259259: correct 143/4752
Epoch: 20, train_loss: 1.1365, train_clustering_loss:  0.4815, train_error: 0.4714
class 0: acc 0.8686131386861314, correct 119/137
class 1: acc 0.24545454545454545, correct 27/110
class 2: acc 0.30392156862745096, correct 31/102
class 3: acc 0.6183206106870229, correct 81/131
class 4: acc 0.49122807017543857, correct 56/114

Val Set, val_loss: 1.5100, val_error: 0.4865, auc: 0.7840
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.3748, instance_loss: 0.4430, weighted_loss: 1.0952, label: 3, bag_size: 615
batch 39, loss: 0.9498, instance_loss: 0.5123, weighted_loss: 0.8185, label: 2, bag_size: 404
batch 59, loss: 1.2100, instance_loss: 0.5109, weighted_loss: 1.0003, label: 4, bag_size: 780
batch 79, loss: 1.1868, instance_loss: 0.4898, weighted_loss: 0.9777, label: 3, bag_size: 496
batch 99, loss: 1.7085, instance_loss: 0.5673, weighted_loss: 1.3661, label: 1, bag_size: 617
batch 119, loss: 0.0651, instance_loss: 0.2898, weighted_loss: 0.1325, label: 0, bag_size: 488
batch 139, loss: 3.1044, instance_loss: 0.5513, weighted_loss: 2.3385, label: 2, bag_size: 563
batch 159, loss: 0.8823, instance_loss: 0.5335, weighted_loss: 0.7776, label: 4, bag_size: 204
batch 179, loss: 1.0658, instance_loss: 0.5486, weighted_loss: 0.9106, label: 3, bag_size: 1060
batch 199, loss: 1.0967, instance_loss: 0.4998, weighted_loss: 0.9176, label: 3, bag_size: 235
batch 219, loss: 0.8438, instance_loss: 0.4454, weighted_loss: 0.7243, label: 2, bag_size: 684
batch 239, loss: 1.4488, instance_loss: 0.4706, weighted_loss: 1.1553, label: 2, bag_size: 1197
batch 259, loss: 2.1475, instance_loss: 0.6068, weighted_loss: 1.6853, label: 4, bag_size: 1031
batch 279, loss: 0.8802, instance_loss: 0.4953, weighted_loss: 0.7647, label: 3, bag_size: 1007
batch 299, loss: 1.8159, instance_loss: 0.5945, weighted_loss: 1.4494, label: 4, bag_size: 1031
batch 319, loss: 0.1048, instance_loss: 0.2993, weighted_loss: 0.1632, label: 0, bag_size: 493
batch 339, loss: 1.0241, instance_loss: 0.5241, weighted_loss: 0.8741, label: 0, bag_size: 343
batch 359, loss: 1.9459, instance_loss: 0.5587, weighted_loss: 1.5298, label: 0, bag_size: 879
batch 379, loss: 1.0571, instance_loss: 0.4475, weighted_loss: 0.8742, label: 3, bag_size: 663
batch 399, loss: 0.7310, instance_loss: 0.4448, weighted_loss: 0.6452, label: 3, bag_size: 245
batch 419, loss: 0.9150, instance_loss: 0.4501, weighted_loss: 0.7755, label: 4, bag_size: 204
batch 439, loss: 1.6584, instance_loss: 0.4961, weighted_loss: 1.3097, label: 3, bag_size: 166
batch 459, loss: 1.9885, instance_loss: 0.6682, weighted_loss: 1.5924, label: 0, bag_size: 178
batch 479, loss: 0.8020, instance_loss: 0.3946, weighted_loss: 0.6798, label: 2, bag_size: 1013
batch 499, loss: 1.8864, instance_loss: 0.4942, weighted_loss: 1.4687, label: 1, bag_size: 350
batch 519, loss: 0.9696, instance_loss: 0.4676, weighted_loss: 0.8190, label: 1, bag_size: 697
batch 539, loss: 0.6745, instance_loss: 0.5656, weighted_loss: 0.6419, label: 1, bag_size: 1497
batch 559, loss: 1.1108, instance_loss: 0.4293, weighted_loss: 0.9063, label: 1, bag_size: 1023
batch 579, loss: 1.2903, instance_loss: 0.5152, weighted_loss: 1.0577, label: 3, bag_size: 956


class 0 clustering acc 0.99743265993266: correct 23699/23760
class 1 clustering acc 0.041035353535353536: correct 195/4752
Epoch: 21, train_loss: 1.1046, train_clustering_loss:  0.4792, train_error: 0.4562
class 0: acc 0.8677685950413223, correct 105/121
class 1: acc 0.4608695652173913, correct 53/115
class 2: acc 0.46875, correct 60/128
class 3: acc 0.4298245614035088, correct 49/114
class 4: acc 0.4827586206896552, correct 56/116

Val Set, val_loss: 1.5694, val_error: 0.6081, auc: 0.7599
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.8096, instance_loss: 0.4843, weighted_loss: 0.7120, label: 3, bag_size: 393
batch 39, loss: 1.4552, instance_loss: 0.5206, weighted_loss: 1.1748, label: 1, bag_size: 372
batch 59, loss: 0.8808, instance_loss: 0.4594, weighted_loss: 0.7544, label: 1, bag_size: 1009
batch 79, loss: 0.8147, instance_loss: 0.4049, weighted_loss: 0.6918, label: 2, bag_size: 821
batch 99, loss: 0.9773, instance_loss: 0.4640, weighted_loss: 0.8233, label: 3, bag_size: 727
batch 119, loss: 1.8645, instance_loss: 0.5221, weighted_loss: 1.4618, label: 3, bag_size: 1022
batch 139, loss: 1.3863, instance_loss: 0.4901, weighted_loss: 1.1174, label: 1, bag_size: 658
batch 159, loss: 2.1756, instance_loss: 0.5294, weighted_loss: 1.6817, label: 1, bag_size: 599
batch 179, loss: 0.8022, instance_loss: 0.4823, weighted_loss: 0.7062, label: 4, bag_size: 744
batch 199, loss: 1.5608, instance_loss: 0.5079, weighted_loss: 1.2449, label: 2, bag_size: 348
batch 219, loss: 0.3152, instance_loss: 0.4654, weighted_loss: 0.3603, label: 4, bag_size: 541
batch 239, loss: 0.3577, instance_loss: 0.4980, weighted_loss: 0.3998, label: 4, bag_size: 1018
batch 259, loss: 0.9290, instance_loss: 0.4417, weighted_loss: 0.7828, label: 2, bag_size: 769
batch 279, loss: 1.6514, instance_loss: 0.5557, weighted_loss: 1.3227, label: 3, bag_size: 300
batch 299, loss: 1.1903, instance_loss: 0.5543, weighted_loss: 0.9995, label: 3, bag_size: 674
batch 319, loss: 1.0953, instance_loss: 0.4903, weighted_loss: 0.9138, label: 2, bag_size: 258
batch 339, loss: 2.2139, instance_loss: 0.5730, weighted_loss: 1.7217, label: 1, bag_size: 397
batch 359, loss: 0.7552, instance_loss: 0.4310, weighted_loss: 0.6580, label: 1, bag_size: 855
batch 379, loss: 1.7920, instance_loss: 0.5166, weighted_loss: 1.4094, label: 2, bag_size: 361
batch 399, loss: 0.5925, instance_loss: 0.3796, weighted_loss: 0.5286, label: 2, bag_size: 769
batch 419, loss: 0.3910, instance_loss: 0.3507, weighted_loss: 0.3789, label: 0, bag_size: 33
batch 439, loss: 0.6798, instance_loss: 0.4707, weighted_loss: 0.6170, label: 3, bag_size: 737
batch 459, loss: 1.0661, instance_loss: 0.4358, weighted_loss: 0.8770, label: 1, bag_size: 1013
batch 479, loss: 2.1494, instance_loss: 0.6406, weighted_loss: 1.6967, label: 3, bag_size: 1057
batch 499, loss: 0.0845, instance_loss: 0.3848, weighted_loss: 0.1746, label: 0, bag_size: 98
batch 519, loss: 0.8204, instance_loss: 0.5482, weighted_loss: 0.7387, label: 4, bag_size: 318
batch 539, loss: 1.8322, instance_loss: 0.7219, weighted_loss: 1.4991, label: 3, bag_size: 107
batch 559, loss: 3.4420, instance_loss: 0.6756, weighted_loss: 2.6121, label: 2, bag_size: 340
batch 579, loss: 0.4752, instance_loss: 0.4474, weighted_loss: 0.4669, label: 4, bag_size: 574


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.03409090909090909: correct 162/4752
Epoch: 22, train_loss: 1.1190, train_clustering_loss:  0.4822, train_error: 0.4798
class 0: acc 0.8264462809917356, correct 100/121
class 1: acc 0.40310077519379844, correct 52/129
class 2: acc 0.36666666666666664, correct 44/120
class 3: acc 0.43103448275862066, correct 50/116
class 4: acc 0.5833333333333334, correct 63/108

Val Set, val_loss: 1.6788, val_error: 0.6216, auc: 0.7812
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.3125, correct 5/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.9593, instance_loss: 0.4195, weighted_loss: 0.7974, label: 2, bag_size: 769
batch 39, loss: 0.6111, instance_loss: 0.4188, weighted_loss: 0.5534, label: 3, bag_size: 818
batch 59, loss: 2.1308, instance_loss: 0.5558, weighted_loss: 1.6583, label: 1, bag_size: 988
batch 79, loss: 2.6817, instance_loss: 0.5986, weighted_loss: 2.0568, label: 2, bag_size: 394
batch 99, loss: 0.8811, instance_loss: 0.5178, weighted_loss: 0.7721, label: 4, bag_size: 419
batch 119, loss: 1.1938, instance_loss: 0.5349, weighted_loss: 0.9961, label: 0, bag_size: 732
batch 139, loss: 2.1611, instance_loss: 0.6370, weighted_loss: 1.7039, label: 3, bag_size: 390
batch 159, loss: 0.1720, instance_loss: 0.3269, weighted_loss: 0.2185, label: 0, bag_size: 71
batch 179, loss: 1.4000, instance_loss: 0.5202, weighted_loss: 1.1360, label: 3, bag_size: 258
batch 199, loss: 1.9804, instance_loss: 0.4882, weighted_loss: 1.5327, label: 2, bag_size: 864
batch 219, loss: 0.0894, instance_loss: 0.3261, weighted_loss: 0.1604, label: 0, bag_size: 285
batch 239, loss: 1.9614, instance_loss: 0.5676, weighted_loss: 1.5433, label: 4, bag_size: 101
batch 259, loss: 3.7323, instance_loss: 0.7429, weighted_loss: 2.8355, label: 2, bag_size: 340
batch 279, loss: 1.3723, instance_loss: 0.4741, weighted_loss: 1.1028, label: 2, bag_size: 348
batch 299, loss: 1.0338, instance_loss: 0.4968, weighted_loss: 0.8727, label: 1, bag_size: 419
batch 319, loss: 0.6015, instance_loss: 0.4061, weighted_loss: 0.5429, label: 4, bag_size: 775
batch 339, loss: 0.2740, instance_loss: 0.4175, weighted_loss: 0.3170, label: 4, bag_size: 1158
batch 359, loss: 2.9209, instance_loss: 0.6180, weighted_loss: 2.2300, label: 4, bag_size: 1104
batch 379, loss: 0.1041, instance_loss: 0.3527, weighted_loss: 0.1787, label: 0, bag_size: 280
batch 399, loss: 0.7953, instance_loss: 0.4582, weighted_loss: 0.6942, label: 1, bag_size: 599
batch 419, loss: 0.7266, instance_loss: 0.4061, weighted_loss: 0.6304, label: 3, bag_size: 309
batch 439, loss: 0.5535, instance_loss: 0.4772, weighted_loss: 0.5306, label: 0, bag_size: 143
batch 459, loss: 1.1286, instance_loss: 0.5554, weighted_loss: 0.9567, label: 2, bag_size: 208
batch 479, loss: 1.0333, instance_loss: 0.4631, weighted_loss: 0.8622, label: 1, bag_size: 599
batch 499, loss: 1.4120, instance_loss: 0.4780, weighted_loss: 1.1318, label: 2, bag_size: 864
batch 519, loss: 0.5894, instance_loss: 0.6146, weighted_loss: 0.5970, label: 1, bag_size: 1497
batch 539, loss: 0.0004, instance_loss: 0.5064, weighted_loss: 0.1522, label: 0, bag_size: 428
batch 559, loss: 0.7201, instance_loss: 0.4364, weighted_loss: 0.6350, label: 3, bag_size: 398
batch 579, loss: 0.7283, instance_loss: 0.4814, weighted_loss: 0.6543, label: 1, bag_size: 483


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.027356902356902357: correct 130/4752
Epoch: 23, train_loss: 1.1149, train_clustering_loss:  0.4822, train_error: 0.4428
class 0: acc 0.7982456140350878, correct 91/114
class 1: acc 0.5284552845528455, correct 65/123
class 2: acc 0.39166666666666666, correct 47/120
class 3: acc 0.5877862595419847, correct 77/131
class 4: acc 0.4811320754716981, correct 51/106

Val Set, val_loss: 1.5373, val_error: 0.5811, auc: 0.7896
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.6258, instance_loss: 0.3752, weighted_loss: 0.5506, label: 3, bag_size: 344
batch 39, loss: 0.5139, instance_loss: 0.5255, weighted_loss: 0.5174, label: 4, bag_size: 627
batch 59, loss: 0.6781, instance_loss: 0.4375, weighted_loss: 0.6059, label: 2, bag_size: 571
batch 79, loss: 0.9059, instance_loss: 0.4472, weighted_loss: 0.7683, label: 2, bag_size: 369
batch 99, loss: 1.3347, instance_loss: 0.4871, weighted_loss: 1.0804, label: 3, bag_size: 746
batch 119, loss: 0.4961, instance_loss: 0.4225, weighted_loss: 0.4740, label: 1, bag_size: 460
batch 139, loss: 0.9284, instance_loss: 0.4300, weighted_loss: 0.7789, label: 3, bag_size: 510
batch 159, loss: 0.7040, instance_loss: 0.5007, weighted_loss: 0.6430, label: 4, bag_size: 886
batch 179, loss: 1.1151, instance_loss: 0.4483, weighted_loss: 0.9151, label: 2, bag_size: 337
batch 199, loss: 0.6639, instance_loss: 0.5593, weighted_loss: 0.6325, label: 1, bag_size: 231
batch 219, loss: 1.1415, instance_loss: 0.5892, weighted_loss: 0.9758, label: 3, bag_size: 500
batch 239, loss: 2.0147, instance_loss: 0.5870, weighted_loss: 1.5863, label: 2, bag_size: 584
batch 259, loss: 0.0235, instance_loss: 0.1713, weighted_loss: 0.0679, label: 0, bag_size: 393
batch 279, loss: 0.8848, instance_loss: 0.4452, weighted_loss: 0.7529, label: 3, bag_size: 309
batch 299, loss: 3.8266, instance_loss: 0.5085, weighted_loss: 2.8312, label: 0, bag_size: 169
batch 319, loss: 1.2946, instance_loss: 0.5094, weighted_loss: 1.0590, label: 4, bag_size: 419
batch 339, loss: 0.5466, instance_loss: 0.4244, weighted_loss: 0.5100, label: 1, bag_size: 1009
batch 359, loss: 1.0200, instance_loss: 0.5129, weighted_loss: 0.8679, label: 3, bag_size: 894
batch 379, loss: 0.8334, instance_loss: 0.4889, weighted_loss: 0.7300, label: 3, bag_size: 300
batch 399, loss: 1.0854, instance_loss: 0.5002, weighted_loss: 0.9099, label: 4, bag_size: 780
batch 419, loss: 1.8058, instance_loss: 0.5312, weighted_loss: 1.4234, label: 2, bag_size: 860
batch 439, loss: 0.8018, instance_loss: 0.4498, weighted_loss: 0.6962, label: 1, bag_size: 389
batch 459, loss: 2.1344, instance_loss: 0.6657, weighted_loss: 1.6938, label: 4, bag_size: 1351
batch 479, loss: 0.5564, instance_loss: 0.3835, weighted_loss: 0.5045, label: 1, bag_size: 925
batch 499, loss: 1.3429, instance_loss: 0.4200, weighted_loss: 1.0660, label: 4, bag_size: 196
batch 519, loss: 0.8131, instance_loss: 0.3934, weighted_loss: 0.6872, label: 3, bag_size: 194
batch 539, loss: 0.0337, instance_loss: 0.2890, weighted_loss: 0.1103, label: 0, bag_size: 234
batch 559, loss: 0.4878, instance_loss: 0.4151, weighted_loss: 0.4660, label: 0, bag_size: 79
batch 579, loss: 0.7056, instance_loss: 0.4291, weighted_loss: 0.6226, label: 2, bag_size: 285


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.04377104377104377: correct 208/4752
Epoch: 24, train_loss: 1.0747, train_clustering_loss:  0.4769, train_error: 0.4663
class 0: acc 0.859375, correct 110/128
class 1: acc 0.39316239316239315, correct 46/117
class 2: acc 0.3302752293577982, correct 36/109
class 3: acc 0.4649122807017544, correct 53/114
class 4: acc 0.5714285714285714, correct 72/126

Val Set, val_loss: 1.4824, val_error: 0.5811, auc: 0.8004
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8414, instance_loss: 0.6878, weighted_loss: 0.7953, label: 0, bag_size: 613
batch 39, loss: 0.7533, instance_loss: 0.4320, weighted_loss: 0.6569, label: 4, bag_size: 755
batch 59, loss: 3.5792, instance_loss: 0.6861, weighted_loss: 2.7113, label: 1, bag_size: 45
batch 79, loss: 1.0426, instance_loss: 0.4539, weighted_loss: 0.8660, label: 2, bag_size: 746
batch 99, loss: 0.8182, instance_loss: 0.5203, weighted_loss: 0.7288, label: 3, bag_size: 598
batch 119, loss: 0.5321, instance_loss: 0.4427, weighted_loss: 0.5053, label: 3, bag_size: 566
batch 139, loss: 0.0131, instance_loss: 0.2682, weighted_loss: 0.0896, label: 0, bag_size: 280
batch 159, loss: 0.8459, instance_loss: 0.4102, weighted_loss: 0.7152, label: 3, bag_size: 641
batch 179, loss: 1.7837, instance_loss: 0.5426, weighted_loss: 1.4114, label: 3, bag_size: 1365
batch 199, loss: 1.2766, instance_loss: 0.5254, weighted_loss: 1.0513, label: 4, bag_size: 618
batch 219, loss: 1.4854, instance_loss: 0.5404, weighted_loss: 1.2019, label: 1, bag_size: 390
batch 239, loss: 0.2811, instance_loss: 0.3637, weighted_loss: 0.3059, label: 0, bag_size: 33
batch 259, loss: 0.9910, instance_loss: 0.4826, weighted_loss: 0.8385, label: 0, bag_size: 143
batch 279, loss: 0.9890, instance_loss: 0.6285, weighted_loss: 0.8809, label: 4, bag_size: 886
batch 299, loss: 1.0548, instance_loss: 0.4725, weighted_loss: 0.8801, label: 3, bag_size: 120
batch 319, loss: 1.6875, instance_loss: 0.5811, weighted_loss: 1.3556, label: 1, bag_size: 159
batch 339, loss: 0.8135, instance_loss: 0.4174, weighted_loss: 0.6947, label: 2, bag_size: 572
batch 359, loss: 2.9080, instance_loss: 0.6410, weighted_loss: 2.2279, label: 0, bag_size: 1085
batch 379, loss: 1.1285, instance_loss: 0.5299, weighted_loss: 0.9489, label: 1, bag_size: 159
batch 399, loss: 1.0030, instance_loss: 0.4741, weighted_loss: 0.8444, label: 1, bag_size: 972
batch 419, loss: 1.7887, instance_loss: 0.6832, weighted_loss: 1.4571, label: 4, bag_size: 1351
batch 439, loss: 0.3075, instance_loss: 0.3964, weighted_loss: 0.3341, label: 4, bag_size: 574
batch 459, loss: 0.4018, instance_loss: 0.4239, weighted_loss: 0.4084, label: 1, bag_size: 892
batch 479, loss: 2.0378, instance_loss: 0.5739, weighted_loss: 1.5987, label: 3, bag_size: 779
batch 499, loss: 0.9878, instance_loss: 0.5586, weighted_loss: 0.8591, label: 3, bag_size: 309
batch 519, loss: 1.2423, instance_loss: 0.4534, weighted_loss: 1.0056, label: 3, bag_size: 1022
batch 539, loss: 0.1549, instance_loss: 0.2424, weighted_loss: 0.1811, label: 0, bag_size: 493
batch 559, loss: 1.2129, instance_loss: 0.4860, weighted_loss: 0.9949, label: 3, bag_size: 166
batch 579, loss: 0.6121, instance_loss: 0.4345, weighted_loss: 0.5588, label: 3, bag_size: 956


class 0 clustering acc 0.9965909090909091: correct 23679/23760
class 1 clustering acc 0.04882154882154882: correct 232/4752
Epoch: 25, train_loss: 1.1507, train_clustering_loss:  0.4782, train_error: 0.5051
class 0: acc 0.813953488372093, correct 105/129
class 1: acc 0.3389830508474576, correct 40/118
class 2: acc 0.3697478991596639, correct 44/119
class 3: acc 0.4700854700854701, correct 55/117
class 4: acc 0.45045045045045046, correct 50/111

Val Set, val_loss: 1.5348, val_error: 0.5676, auc: 0.7808
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6288, instance_loss: 0.4103, weighted_loss: 0.5632, label: 4, bag_size: 660
batch 39, loss: 0.1704, instance_loss: 0.3921, weighted_loss: 0.2369, label: 0, bag_size: 488
batch 59, loss: 0.0576, instance_loss: 0.3053, weighted_loss: 0.1319, label: 0, bag_size: 295
batch 79, loss: 0.9014, instance_loss: 0.4294, weighted_loss: 0.7598, label: 1, bag_size: 332
batch 99, loss: 0.5152, instance_loss: 0.4760, weighted_loss: 0.5034, label: 1, bag_size: 371
batch 119, loss: 0.8846, instance_loss: 0.4402, weighted_loss: 0.7513, label: 1, bag_size: 328
batch 139, loss: 1.1670, instance_loss: 0.4839, weighted_loss: 0.9621, label: 1, bag_size: 408
batch 159, loss: 0.9869, instance_loss: 0.5078, weighted_loss: 0.8432, label: 4, bag_size: 318
batch 179, loss: 0.0459, instance_loss: 0.2006, weighted_loss: 0.0923, label: 0, bag_size: 201
batch 199, loss: 0.4423, instance_loss: 0.3113, weighted_loss: 0.4030, label: 4, bag_size: 687
batch 219, loss: 1.2547, instance_loss: 0.5112, weighted_loss: 1.0316, label: 3, bag_size: 822
batch 239, loss: 1.9593, instance_loss: 0.5061, weighted_loss: 1.5233, label: 2, bag_size: 1060
batch 259, loss: 2.2540, instance_loss: 0.6791, weighted_loss: 1.7816, label: 4, bag_size: 333
batch 279, loss: 1.1911, instance_loss: 0.4496, weighted_loss: 0.9686, label: 0, bag_size: 81
batch 299, loss: 1.3773, instance_loss: 0.5205, weighted_loss: 1.1203, label: 2, bag_size: 105
batch 319, loss: 0.7140, instance_loss: 0.4274, weighted_loss: 0.6280, label: 2, bag_size: 851
batch 339, loss: 0.3022, instance_loss: 0.4332, weighted_loss: 0.3415, label: 0, bag_size: 230
batch 359, loss: 1.2069, instance_loss: 0.5092, weighted_loss: 0.9976, label: 1, bag_size: 658
batch 379, loss: 0.5510, instance_loss: 0.3661, weighted_loss: 0.4955, label: 3, bag_size: 428
batch 399, loss: 2.3466, instance_loss: 0.6216, weighted_loss: 1.8291, label: 1, bag_size: 564
batch 419, loss: 2.8434, instance_loss: 0.6764, weighted_loss: 2.1933, label: 1, bag_size: 153
batch 439, loss: 0.1253, instance_loss: 0.2825, weighted_loss: 0.1724, label: 0, bag_size: 370
batch 459, loss: 1.9140, instance_loss: 0.6572, weighted_loss: 1.5369, label: 3, bag_size: 795
batch 479, loss: 1.3236, instance_loss: 0.4710, weighted_loss: 1.0678, label: 2, bag_size: 448
batch 499, loss: 1.1598, instance_loss: 0.4596, weighted_loss: 0.9497, label: 2, bag_size: 592
batch 519, loss: 0.9938, instance_loss: 0.5039, weighted_loss: 0.8469, label: 3, bag_size: 1021
batch 539, loss: 1.1153, instance_loss: 0.4762, weighted_loss: 0.9235, label: 1, bag_size: 829
batch 559, loss: 0.4585, instance_loss: 0.4730, weighted_loss: 0.4628, label: 0, bag_size: 642
batch 579, loss: 0.7347, instance_loss: 0.4704, weighted_loss: 0.6554, label: 1, bag_size: 874


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.03998316498316498: correct 190/4752
Epoch: 26, train_loss: 1.0930, train_clustering_loss:  0.4827, train_error: 0.4293
class 0: acc 0.848, correct 106/125
class 1: acc 0.4672131147540984, correct 57/122
class 2: acc 0.4778761061946903, correct 54/113
class 3: acc 0.5040650406504065, correct 62/123
class 4: acc 0.5405405405405406, correct 60/111

Val Set, val_loss: 1.5114, val_error: 0.5676, auc: 0.8003
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.9923, instance_loss: 0.4932, weighted_loss: 0.8425, label: 3, bag_size: 498
batch 39, loss: 1.9920, instance_loss: 0.5169, weighted_loss: 1.5495, label: 4, bag_size: 246
batch 59, loss: 1.6945, instance_loss: 0.4778, weighted_loss: 1.3295, label: 2, bag_size: 512
batch 79, loss: 0.6792, instance_loss: 0.4304, weighted_loss: 0.6045, label: 4, bag_size: 476
batch 99, loss: 1.1653, instance_loss: 0.4756, weighted_loss: 0.9584, label: 1, bag_size: 1104
batch 119, loss: 0.6181, instance_loss: 0.5064, weighted_loss: 0.5846, label: 4, bag_size: 1351
batch 139, loss: 2.6816, instance_loss: 0.5668, weighted_loss: 2.0471, label: 0, bag_size: 879
batch 159, loss: 2.4440, instance_loss: 0.6267, weighted_loss: 1.8988, label: 0, bag_size: 600
batch 179, loss: 0.1586, instance_loss: 0.3904, weighted_loss: 0.2282, label: 4, bag_size: 394
batch 199, loss: 0.0283, instance_loss: 0.2616, weighted_loss: 0.0983, label: 0, bag_size: 533
batch 219, loss: 0.8173, instance_loss: 0.4083, weighted_loss: 0.6946, label: 2, bag_size: 522
batch 239, loss: 0.8126, instance_loss: 0.4982, weighted_loss: 0.7183, label: 3, bag_size: 301
batch 259, loss: 1.3277, instance_loss: 0.4988, weighted_loss: 1.0791, label: 3, bag_size: 1022
batch 279, loss: 0.2800, instance_loss: 0.4458, weighted_loss: 0.3297, label: 4, bag_size: 409
batch 299, loss: 0.8503, instance_loss: 0.6248, weighted_loss: 0.7827, label: 4, bag_size: 160
batch 319, loss: 0.9815, instance_loss: 0.4314, weighted_loss: 0.8164, label: 4, bag_size: 419
batch 339, loss: 0.0235, instance_loss: 0.2469, weighted_loss: 0.0905, label: 0, bag_size: 49
batch 359, loss: 1.4095, instance_loss: 0.5342, weighted_loss: 1.1469, label: 1, bag_size: 874
batch 379, loss: 0.0048, instance_loss: 0.4782, weighted_loss: 0.1468, label: 0, bag_size: 428
batch 399, loss: 1.6381, instance_loss: 0.4921, weighted_loss: 1.2943, label: 0, bag_size: 230
batch 419, loss: 0.6794, instance_loss: 0.4743, weighted_loss: 0.6179, label: 2, bag_size: 821
batch 439, loss: 0.9773, instance_loss: 0.4095, weighted_loss: 0.8070, label: 3, bag_size: 497
batch 459, loss: 1.4765, instance_loss: 0.4991, weighted_loss: 1.1833, label: 1, bag_size: 908
batch 479, loss: 0.8510, instance_loss: 0.4886, weighted_loss: 0.7423, label: 1, bag_size: 509
batch 499, loss: 3.2339, instance_loss: 0.6170, weighted_loss: 2.4488, label: 3, bag_size: 342
batch 519, loss: 1.3797, instance_loss: 0.6518, weighted_loss: 1.1613, label: 0, bag_size: 183
batch 539, loss: 1.0696, instance_loss: 0.4583, weighted_loss: 0.8862, label: 3, bag_size: 804
batch 559, loss: 0.4533, instance_loss: 0.4324, weighted_loss: 0.4470, label: 1, bag_size: 814
batch 579, loss: 0.9694, instance_loss: 0.4704, weighted_loss: 0.8197, label: 3, bag_size: 245


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.026725589225589225: correct 127/4752
Epoch: 27, train_loss: 1.1331, train_clustering_loss:  0.4819, train_error: 0.4764
class 0: acc 0.7798165137614679, correct 85/109
class 1: acc 0.24271844660194175, correct 25/103
class 2: acc 0.5081967213114754, correct 62/122
class 3: acc 0.4806201550387597, correct 62/129
class 4: acc 0.5877862595419847, correct 77/131

Val Set, val_loss: 1.4144, val_error: 0.5135, auc: 0.8183
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.435278 --> 1.414427).  Saving model ...


batch 19, loss: 1.0493, instance_loss: 0.4342, weighted_loss: 0.8648, label: 3, bag_size: 473
batch 39, loss: 0.8017, instance_loss: 0.4550, weighted_loss: 0.6977, label: 2, bag_size: 171
batch 59, loss: 0.4115, instance_loss: 0.4124, weighted_loss: 0.4118, label: 1, bag_size: 398
batch 79, loss: 0.5516, instance_loss: 0.4575, weighted_loss: 0.5233, label: 4, bag_size: 744
batch 99, loss: 0.4520, instance_loss: 0.4479, weighted_loss: 0.4507, label: 4, bag_size: 776
batch 119, loss: 1.2700, instance_loss: 0.5451, weighted_loss: 1.0525, label: 3, bag_size: 603
batch 139, loss: 0.9781, instance_loss: 0.4693, weighted_loss: 0.8255, label: 2, bag_size: 690
batch 159, loss: 1.2325, instance_loss: 0.5246, weighted_loss: 1.0201, label: 3, bag_size: 1232
batch 179, loss: 0.6468, instance_loss: 0.6374, weighted_loss: 0.6440, label: 4, bag_size: 813
batch 199, loss: 0.9815, instance_loss: 0.4429, weighted_loss: 0.8199, label: 2, bag_size: 498
batch 219, loss: 1.1079, instance_loss: 0.3916, weighted_loss: 0.8930, label: 1, bag_size: 355
batch 239, loss: 1.5983, instance_loss: 0.5708, weighted_loss: 1.2901, label: 4, bag_size: 592
batch 259, loss: 1.1098, instance_loss: 0.4676, weighted_loss: 0.9171, label: 1, bag_size: 233
batch 279, loss: 0.9357, instance_loss: 0.4787, weighted_loss: 0.7986, label: 1, bag_size: 332
batch 299, loss: 1.0811, instance_loss: 0.4464, weighted_loss: 0.8907, label: 2, bag_size: 1013
batch 319, loss: 0.9379, instance_loss: 0.4265, weighted_loss: 0.7844, label: 1, bag_size: 372
batch 339, loss: 1.8281, instance_loss: 0.5030, weighted_loss: 1.4306, label: 2, bag_size: 411
batch 359, loss: 1.3365, instance_loss: 0.4610, weighted_loss: 1.0738, label: 4, bag_size: 196
batch 379, loss: 1.5359, instance_loss: 0.5201, weighted_loss: 1.2311, label: 2, bag_size: 398
batch 399, loss: 0.6157, instance_loss: 0.4252, weighted_loss: 0.5585, label: 0, bag_size: 224
batch 419, loss: 1.8631, instance_loss: 0.5977, weighted_loss: 1.4835, label: 4, bag_size: 196
batch 439, loss: 3.5642, instance_loss: 0.7209, weighted_loss: 2.7112, label: 0, bag_size: 273
batch 459, loss: 0.9658, instance_loss: 0.4227, weighted_loss: 0.8028, label: 1, bag_size: 695
batch 479, loss: 0.6168, instance_loss: 0.3840, weighted_loss: 0.5470, label: 1, bag_size: 509
batch 499, loss: 0.0001, instance_loss: 0.4330, weighted_loss: 0.1300, label: 0, bag_size: 428
batch 519, loss: 1.3426, instance_loss: 0.5885, weighted_loss: 1.1164, label: 0, bag_size: 62
batch 539, loss: 0.8620, instance_loss: 0.5176, weighted_loss: 0.7587, label: 1, bag_size: 1360
batch 559, loss: 0.7090, instance_loss: 0.4921, weighted_loss: 0.6440, label: 2, bag_size: 617
batch 579, loss: 1.1175, instance_loss: 0.4780, weighted_loss: 0.9257, label: 1, bag_size: 599


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.054503367003367005: correct 259/4752
Epoch: 28, train_loss: 1.0699, train_clustering_loss:  0.4752, train_error: 0.4663
class 0: acc 0.8837209302325582, correct 114/129
class 1: acc 0.5, correct 64/128
class 2: acc 0.2543859649122807, correct 29/114
class 3: acc 0.4649122807017544, correct 53/114
class 4: acc 0.5229357798165137, correct 57/109

Val Set, val_loss: 1.3489, val_error: 0.5405, auc: 0.8086
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.414427 --> 1.348946).  Saving model ...


batch 19, loss: 0.0515, instance_loss: 0.2806, weighted_loss: 0.1203, label: 0, bag_size: 212
batch 39, loss: 0.1603, instance_loss: 0.3144, weighted_loss: 0.2066, label: 0, bag_size: 642
batch 59, loss: 0.0777, instance_loss: 0.4276, weighted_loss: 0.1827, label: 4, bag_size: 541
batch 79, loss: 2.2845, instance_loss: 0.5628, weighted_loss: 1.7680, label: 2, bag_size: 394
batch 99, loss: 1.0855, instance_loss: 0.4970, weighted_loss: 0.9089, label: 3, bag_size: 779
batch 119, loss: 0.8413, instance_loss: 0.4322, weighted_loss: 0.7186, label: 3, bag_size: 1007
batch 139, loss: 2.4428, instance_loss: 0.6209, weighted_loss: 1.8962, label: 4, bag_size: 246
batch 159, loss: 0.7294, instance_loss: 0.4533, weighted_loss: 0.6466, label: 4, bag_size: 53
batch 179, loss: 0.7539, instance_loss: 0.5594, weighted_loss: 0.6955, label: 1, bag_size: 389
batch 199, loss: 1.3148, instance_loss: 0.4987, weighted_loss: 1.0699, label: 3, bag_size: 631
batch 219, loss: 1.5641, instance_loss: 0.4827, weighted_loss: 1.2396, label: 3, bag_size: 486
batch 239, loss: 0.7851, instance_loss: 0.5080, weighted_loss: 0.7019, label: 4, bag_size: 218
batch 259, loss: 2.3678, instance_loss: 0.6891, weighted_loss: 1.8642, label: 2, bag_size: 512
batch 279, loss: 1.8724, instance_loss: 0.5004, weighted_loss: 1.4608, label: 3, bag_size: 615
batch 299, loss: 1.1708, instance_loss: 0.5964, weighted_loss: 0.9985, label: 3, bag_size: 390
batch 319, loss: 1.8172, instance_loss: 0.5528, weighted_loss: 1.4378, label: 2, bag_size: 549
batch 339, loss: 1.1850, instance_loss: 0.5034, weighted_loss: 0.9805, label: 1, bag_size: 271
batch 359, loss: 0.6383, instance_loss: 0.4598, weighted_loss: 0.5847, label: 2, bag_size: 350
batch 379, loss: 0.0143, instance_loss: 0.3904, weighted_loss: 0.1271, label: 0, bag_size: 58
batch 399, loss: 0.8953, instance_loss: 0.4600, weighted_loss: 0.7647, label: 3, bag_size: 390
batch 419, loss: 1.0074, instance_loss: 0.5961, weighted_loss: 0.8840, label: 4, bag_size: 853
batch 439, loss: 0.5807, instance_loss: 0.4334, weighted_loss: 0.5365, label: 2, bag_size: 617
batch 459, loss: 0.0188, instance_loss: 0.3746, weighted_loss: 0.1255, label: 2, bag_size: 1975
batch 479, loss: 1.1751, instance_loss: 0.5373, weighted_loss: 0.9838, label: 2, bag_size: 185
batch 499, loss: 0.0421, instance_loss: 0.3878, weighted_loss: 0.1458, label: 4, bag_size: 813
batch 519, loss: 0.0078, instance_loss: 0.3998, weighted_loss: 0.1254, label: 0, bag_size: 230
batch 539, loss: 2.1077, instance_loss: 0.8175, weighted_loss: 1.7206, label: 3, bag_size: 638
batch 559, loss: 0.9345, instance_loss: 0.4157, weighted_loss: 0.7788, label: 1, bag_size: 855
batch 579, loss: 0.7901, instance_loss: 0.4653, weighted_loss: 0.6927, label: 2, bag_size: 598


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.055134680134680134: correct 262/4752
Epoch: 29, train_loss: 1.0426, train_clustering_loss:  0.4760, train_error: 0.4596
class 0: acc 0.84251968503937, correct 107/127
class 1: acc 0.37735849056603776, correct 40/106
class 2: acc 0.3783783783783784, correct 42/111
class 3: acc 0.5378787878787878, correct 71/132
class 4: acc 0.5169491525423728, correct 61/118

Val Set, val_loss: 1.4047, val_error: 0.5676, auc: 0.7963
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.8136, instance_loss: 0.6722, weighted_loss: 2.1712, label: 4, bag_size: 333
batch 39, loss: 0.0408, instance_loss: 0.2929, weighted_loss: 0.1165, label: 0, bag_size: 49
batch 59, loss: 1.1938, instance_loss: 0.4944, weighted_loss: 0.9840, label: 2, bag_size: 498
batch 79, loss: 0.0913, instance_loss: 0.4084, weighted_loss: 0.1864, label: 0, bag_size: 428
batch 99, loss: 1.3710, instance_loss: 0.5018, weighted_loss: 1.1103, label: 4, bag_size: 312
batch 119, loss: 0.8080, instance_loss: 0.4340, weighted_loss: 0.6958, label: 2, bag_size: 731
batch 139, loss: 0.8567, instance_loss: 0.3826, weighted_loss: 0.7145, label: 2, bag_size: 363
batch 159, loss: 0.2308, instance_loss: 0.4274, weighted_loss: 0.2898, label: 0, bag_size: 702
batch 179, loss: 0.9756, instance_loss: 0.5786, weighted_loss: 0.8565, label: 1, bag_size: 1497
batch 199, loss: 1.2447, instance_loss: 0.4461, weighted_loss: 1.0052, label: 2, bag_size: 906
batch 219, loss: 0.0002, instance_loss: 0.2140, weighted_loss: 0.0644, label: 0, bag_size: 175
batch 239, loss: 0.3366, instance_loss: 0.4637, weighted_loss: 0.3747, label: 0, bag_size: 524
batch 259, loss: 1.1552, instance_loss: 0.4913, weighted_loss: 0.9560, label: 4, bag_size: 563
batch 279, loss: 1.1647, instance_loss: 0.6163, weighted_loss: 1.0002, label: 3, bag_size: 309
batch 299, loss: 0.9445, instance_loss: 0.4503, weighted_loss: 0.7963, label: 2, bag_size: 1197
batch 319, loss: 1.2276, instance_loss: 0.4998, weighted_loss: 1.0093, label: 3, bag_size: 473
batch 339, loss: 2.5496, instance_loss: 0.7110, weighted_loss: 1.9980, label: 1, bag_size: 184
batch 359, loss: 2.1699, instance_loss: 0.5731, weighted_loss: 1.6909, label: 3, bag_size: 474
batch 379, loss: 2.3220, instance_loss: 0.4934, weighted_loss: 1.7734, label: 0, bag_size: 115
batch 399, loss: 0.3349, instance_loss: 0.3778, weighted_loss: 0.3478, label: 4, bag_size: 775
batch 419, loss: 0.0405, instance_loss: 0.4260, weighted_loss: 0.1562, label: 0, bag_size: 370
batch 439, loss: 0.9501, instance_loss: 0.4231, weighted_loss: 0.7920, label: 4, bag_size: 110
batch 459, loss: 1.2889, instance_loss: 0.5509, weighted_loss: 1.0675, label: 1, bag_size: 1360
batch 479, loss: 1.0489, instance_loss: 0.4941, weighted_loss: 0.8824, label: 1, bag_size: 949
batch 499, loss: 2.0237, instance_loss: 0.5198, weighted_loss: 1.5725, label: 4, bag_size: 356
batch 519, loss: 1.4667, instance_loss: 0.5661, weighted_loss: 1.1965, label: 2, bag_size: 821
batch 539, loss: 1.5162, instance_loss: 0.5436, weighted_loss: 1.2244, label: 3, bag_size: 857
batch 559, loss: 2.6850, instance_loss: 0.5220, weighted_loss: 2.0361, label: 1, bag_size: 397
batch 579, loss: 0.8268, instance_loss: 0.4297, weighted_loss: 0.7076, label: 1, bag_size: 906


class 0 clustering acc 0.9983585858585858: correct 23721/23760
class 1 clustering acc 0.03324915824915825: correct 158/4752
Epoch: 30, train_loss: 1.1149, train_clustering_loss:  0.4872, train_error: 0.4815
class 0: acc 0.7950819672131147, correct 97/122
class 1: acc 0.46551724137931033, correct 54/116
class 2: acc 0.28421052631578947, correct 27/95
class 3: acc 0.373015873015873, correct 47/126
class 4: acc 0.6148148148148148, correct 83/135

Val Set, val_loss: 1.2852, val_error: 0.4865, auc: 0.8251
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.348946 --> 1.285199).  Saving model ...


batch 19, loss: 1.3024, instance_loss: 0.5146, weighted_loss: 1.0661, label: 2, bag_size: 851
batch 39, loss: 0.2551, instance_loss: 0.3726, weighted_loss: 0.2904, label: 4, bag_size: 960
batch 59, loss: 0.2309, instance_loss: 0.4001, weighted_loss: 0.2817, label: 0, bag_size: 76
batch 79, loss: 1.9596, instance_loss: 0.5537, weighted_loss: 1.5378, label: 3, bag_size: 1358
batch 99, loss: 2.3285, instance_loss: 0.6374, weighted_loss: 1.8211, label: 2, bag_size: 909
batch 119, loss: 1.3092, instance_loss: 0.5015, weighted_loss: 1.0669, label: 2, bag_size: 363
batch 139, loss: 2.4894, instance_loss: 0.6037, weighted_loss: 1.9237, label: 4, bag_size: 98
batch 159, loss: 0.6683, instance_loss: 0.5689, weighted_loss: 0.6385, label: 0, bag_size: 710
batch 179, loss: 0.0646, instance_loss: 0.3248, weighted_loss: 0.1427, label: 0, bag_size: 159
batch 199, loss: 1.5910, instance_loss: 0.6573, weighted_loss: 1.3109, label: 0, bag_size: 311
batch 219, loss: 1.0656, instance_loss: 0.5003, weighted_loss: 0.8961, label: 1, bag_size: 201
batch 239, loss: 1.3010, instance_loss: 0.4630, weighted_loss: 1.0496, label: 2, bag_size: 404
batch 259, loss: 1.0721, instance_loss: 0.4466, weighted_loss: 0.8845, label: 2, bag_size: 337
batch 279, loss: 2.6705, instance_loss: 0.6211, weighted_loss: 2.0557, label: 4, bag_size: 970
batch 299, loss: 0.0407, instance_loss: 0.3241, weighted_loss: 0.1257, label: 0, bag_size: 523
batch 319, loss: 0.7157, instance_loss: 0.4392, weighted_loss: 0.6327, label: 1, bag_size: 591
batch 339, loss: 1.4833, instance_loss: 0.5896, weighted_loss: 1.2152, label: 2, bag_size: 303
batch 359, loss: 0.8706, instance_loss: 0.4284, weighted_loss: 0.7379, label: 1, bag_size: 1043
batch 379, loss: 1.7717, instance_loss: 0.5519, weighted_loss: 1.4058, label: 2, bag_size: 852
batch 399, loss: 0.1642, instance_loss: 0.4202, weighted_loss: 0.2410, label: 0, bag_size: 159
batch 419, loss: 1.3988, instance_loss: 0.5305, weighted_loss: 1.1383, label: 2, bag_size: 906
batch 439, loss: 0.9971, instance_loss: 0.6573, weighted_loss: 0.8951, label: 1, bag_size: 1497
batch 459, loss: 0.6273, instance_loss: 0.4277, weighted_loss: 0.5674, label: 1, bag_size: 814
batch 479, loss: 1.0348, instance_loss: 0.4609, weighted_loss: 0.8626, label: 4, bag_size: 395
batch 499, loss: 0.9185, instance_loss: 0.4599, weighted_loss: 0.7809, label: 3, bag_size: 1007
batch 519, loss: 1.1843, instance_loss: 0.5600, weighted_loss: 0.9970, label: 3, bag_size: 804
batch 539, loss: 0.8155, instance_loss: 0.4389, weighted_loss: 0.7025, label: 2, bag_size: 725
batch 559, loss: 2.2577, instance_loss: 0.4816, weighted_loss: 1.7248, label: 1, bag_size: 350
batch 579, loss: 2.0801, instance_loss: 0.6491, weighted_loss: 1.6508, label: 2, bag_size: 168


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.0242003367003367: correct 115/4752
Epoch: 31, train_loss: 1.0948, train_clustering_loss:  0.4861, train_error: 0.4882
class 0: acc 0.808695652173913, correct 93/115
class 1: acc 0.5, correct 69/138
class 2: acc 0.2982456140350877, correct 34/114
class 3: acc 0.37735849056603776, correct 40/106
class 4: acc 0.5619834710743802, correct 68/121

Val Set, val_loss: 1.4831, val_error: 0.5811, auc: 0.8272
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0029, instance_loss: 0.3049, weighted_loss: 0.0935, label: 0, bag_size: 340
batch 39, loss: 1.6381, instance_loss: 0.4690, weighted_loss: 1.2874, label: 3, bag_size: 822
batch 59, loss: 1.2926, instance_loss: 0.5999, weighted_loss: 1.0848, label: 0, bag_size: 732
batch 79, loss: 0.8399, instance_loss: 0.4758, weighted_loss: 0.7307, label: 2, bag_size: 375
batch 99, loss: 1.3667, instance_loss: 0.4837, weighted_loss: 1.1018, label: 2, bag_size: 934
batch 119, loss: 1.1225, instance_loss: 0.4661, weighted_loss: 0.9256, label: 2, bag_size: 851
batch 139, loss: 0.8626, instance_loss: 0.4322, weighted_loss: 0.7335, label: 1, bag_size: 201
batch 159, loss: 0.8912, instance_loss: 0.4628, weighted_loss: 0.7627, label: 4, bag_size: 604
batch 179, loss: 0.9352, instance_loss: 0.5593, weighted_loss: 0.8224, label: 4, bag_size: 468
batch 199, loss: 0.2521, instance_loss: 0.5045, weighted_loss: 0.3278, label: 0, bag_size: 324
batch 219, loss: 1.6235, instance_loss: 0.5351, weighted_loss: 1.2970, label: 3, bag_size: 453
batch 239, loss: 1.1445, instance_loss: 0.4410, weighted_loss: 0.9334, label: 1, bag_size: 766
batch 259, loss: 1.1100, instance_loss: 0.4765, weighted_loss: 0.9200, label: 2, bag_size: 717
batch 279, loss: 0.9626, instance_loss: 0.5624, weighted_loss: 0.8425, label: 3, bag_size: 154
batch 299, loss: 1.0183, instance_loss: 0.4596, weighted_loss: 0.8507, label: 4, bag_size: 780
batch 319, loss: 0.5787, instance_loss: 0.3797, weighted_loss: 0.5190, label: 0, bag_size: 223
batch 339, loss: 0.6637, instance_loss: 0.4351, weighted_loss: 0.5951, label: 3, bag_size: 492
batch 359, loss: 0.1089, instance_loss: 0.3400, weighted_loss: 0.1782, label: 0, bag_size: 251
batch 379, loss: 1.1471, instance_loss: 0.4480, weighted_loss: 0.9374, label: 1, bag_size: 617
batch 399, loss: 1.1263, instance_loss: 0.4839, weighted_loss: 0.9336, label: 3, bag_size: 495
batch 419, loss: 1.1773, instance_loss: 0.4748, weighted_loss: 0.9666, label: 2, bag_size: 616
batch 439, loss: 0.9252, instance_loss: 0.4842, weighted_loss: 0.7929, label: 3, bag_size: 337
batch 459, loss: 0.6764, instance_loss: 0.4419, weighted_loss: 0.6061, label: 2, bag_size: 633
batch 479, loss: 0.0774, instance_loss: 0.5234, weighted_loss: 0.2112, label: 2, bag_size: 596
batch 499, loss: 0.0057, instance_loss: 0.1644, weighted_loss: 0.0533, label: 0, bag_size: 133
batch 519, loss: 1.4246, instance_loss: 0.4714, weighted_loss: 1.1386, label: 3, bag_size: 344
batch 539, loss: 0.5467, instance_loss: 0.4258, weighted_loss: 0.5104, label: 3, bag_size: 344
batch 559, loss: 1.4710, instance_loss: 0.5455, weighted_loss: 1.1933, label: 4, bag_size: 592
batch 579, loss: 0.3535, instance_loss: 0.3731, weighted_loss: 0.3594, label: 4, bag_size: 886


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.030303030303030304: correct 144/4752
Epoch: 32, train_loss: 1.1368, train_clustering_loss:  0.4893, train_error: 0.4848
class 0: acc 0.7863247863247863, correct 92/117
class 1: acc 0.36885245901639346, correct 45/122
class 2: acc 0.3652173913043478, correct 42/115
class 3: acc 0.4789915966386555, correct 57/119
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.4663, val_error: 0.5000, auc: 0.8118
class 0 clustering acc 0.9956081081081081: correct 2947/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9661, instance_loss: 0.5329, weighted_loss: 0.8362, label: 2, bag_size: 315
batch 39, loss: 0.9893, instance_loss: 0.4395, weighted_loss: 0.8243, label: 2, bag_size: 616
batch 59, loss: 1.6888, instance_loss: 0.6125, weighted_loss: 1.3659, label: 4, bag_size: 1031
batch 79, loss: 1.4856, instance_loss: 0.6420, weighted_loss: 1.2325, label: 4, bag_size: 699
batch 99, loss: 0.7698, instance_loss: 0.4954, weighted_loss: 0.6875, label: 1, bag_size: 231
batch 119, loss: 1.0050, instance_loss: 0.4597, weighted_loss: 0.8414, label: 4, bag_size: 660
batch 139, loss: 0.1290, instance_loss: 0.4607, weighted_loss: 0.2285, label: 0, bag_size: 227
batch 159, loss: 0.0156, instance_loss: 0.2141, weighted_loss: 0.0752, label: 0, bag_size: 255
batch 179, loss: 0.8316, instance_loss: 0.4159, weighted_loss: 0.7069, label: 1, bag_size: 208
batch 199, loss: 0.1715, instance_loss: 0.3884, weighted_loss: 0.2366, label: 0, bag_size: 201
batch 219, loss: 1.9015, instance_loss: 0.5677, weighted_loss: 1.5014, label: 3, bag_size: 337
batch 239, loss: 1.4812, instance_loss: 0.4915, weighted_loss: 1.1843, label: 3, bag_size: 779
batch 259, loss: 1.6342, instance_loss: 0.5546, weighted_loss: 1.3103, label: 3, bag_size: 474
batch 279, loss: 1.4059, instance_loss: 0.4609, weighted_loss: 1.1224, label: 1, bag_size: 695
batch 299, loss: 1.0528, instance_loss: 0.5060, weighted_loss: 0.8888, label: 3, bag_size: 1131
batch 319, loss: 0.0013, instance_loss: 0.1066, weighted_loss: 0.0329, label: 0, bag_size: 255
batch 339, loss: 0.3560, instance_loss: 0.6232, weighted_loss: 0.4361, label: 0, bag_size: 760
batch 359, loss: 1.8115, instance_loss: 0.5749, weighted_loss: 1.4406, label: 3, bag_size: 431
batch 379, loss: 0.0583, instance_loss: 0.3964, weighted_loss: 0.1597, label: 0, bag_size: 59
batch 399, loss: 0.2519, instance_loss: 0.4200, weighted_loss: 0.3023, label: 4, bag_size: 725
batch 419, loss: 0.8455, instance_loss: 0.4557, weighted_loss: 0.7286, label: 1, bag_size: 509
batch 439, loss: 1.1093, instance_loss: 0.5038, weighted_loss: 0.9277, label: 3, bag_size: 1007
batch 459, loss: 1.2675, instance_loss: 0.4642, weighted_loss: 1.0265, label: 1, bag_size: 525
batch 479, loss: 0.6513, instance_loss: 0.5397, weighted_loss: 0.6178, label: 3, bag_size: 818
batch 499, loss: 2.6008, instance_loss: 0.7289, weighted_loss: 2.0392, label: 2, bag_size: 105
batch 519, loss: 2.9308, instance_loss: 0.5727, weighted_loss: 2.2233, label: 4, bag_size: 853
batch 539, loss: 1.4272, instance_loss: 0.9256, weighted_loss: 1.2767, label: 3, bag_size: 403
batch 559, loss: 1.7779, instance_loss: 0.5964, weighted_loss: 1.4234, label: 0, bag_size: 143
batch 579, loss: 2.1010, instance_loss: 0.6069, weighted_loss: 1.6527, label: 2, bag_size: 1092


class 0 clustering acc 0.9961700336700336: correct 23669/23760
class 1 clustering acc 0.052398989898989896: correct 249/4752
Epoch: 33, train_loss: 1.0457, train_clustering_loss:  0.4809, train_error: 0.4630
class 0: acc 0.8031496062992126, correct 102/127
class 1: acc 0.4672131147540984, correct 57/122
class 2: acc 0.23853211009174313, correct 26/109
class 3: acc 0.5655737704918032, correct 69/122
class 4: acc 0.5701754385964912, correct 65/114

Val Set, val_loss: 1.7500, val_error: 0.5270, auc: 0.8017
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4484, instance_loss: 0.4367, weighted_loss: 0.4448, label: 3, bag_size: 587
batch 39, loss: 0.8335, instance_loss: 0.4648, weighted_loss: 0.7229, label: 2, bag_size: 617
batch 59, loss: 0.7610, instance_loss: 0.3732, weighted_loss: 0.6446, label: 1, bag_size: 660
batch 79, loss: 0.9698, instance_loss: 0.5610, weighted_loss: 0.8472, label: 4, bag_size: 101
batch 99, loss: 0.0294, instance_loss: 0.2626, weighted_loss: 0.0994, label: 0, bag_size: 88
batch 119, loss: 1.2130, instance_loss: 0.4522, weighted_loss: 0.9848, label: 1, bag_size: 525
batch 139, loss: 0.2638, instance_loss: 0.3960, weighted_loss: 0.3034, label: 0, bag_size: 224
batch 159, loss: 0.8648, instance_loss: 0.3918, weighted_loss: 0.7229, label: 1, bag_size: 500
batch 179, loss: 1.1436, instance_loss: 0.5004, weighted_loss: 0.9507, label: 3, bag_size: 625
batch 199, loss: 0.8665, instance_loss: 0.4463, weighted_loss: 0.7405, label: 4, bag_size: 730
batch 219, loss: 1.7397, instance_loss: 0.4630, weighted_loss: 1.3567, label: 1, bag_size: 599
batch 239, loss: 1.8289, instance_loss: 0.6011, weighted_loss: 1.4606, label: 3, bag_size: 498
batch 259, loss: 0.4937, instance_loss: 0.3545, weighted_loss: 0.4519, label: 4, bag_size: 776
batch 279, loss: 2.8329, instance_loss: 0.5668, weighted_loss: 2.1531, label: 2, bag_size: 829
batch 299, loss: 1.1764, instance_loss: 0.4782, weighted_loss: 0.9669, label: 2, bag_size: 597
batch 319, loss: 1.2264, instance_loss: 0.4937, weighted_loss: 1.0066, label: 3, bag_size: 309
batch 339, loss: 0.0319, instance_loss: 0.3148, weighted_loss: 0.1168, label: 0, bag_size: 234
batch 359, loss: 0.0160, instance_loss: 0.3497, weighted_loss: 0.1161, label: 0, bag_size: 370
batch 379, loss: 2.4948, instance_loss: 0.5700, weighted_loss: 1.9173, label: 2, bag_size: 629
batch 399, loss: 2.5905, instance_loss: 0.7150, weighted_loss: 2.0279, label: 2, bag_size: 754
batch 419, loss: 0.0450, instance_loss: 0.2013, weighted_loss: 0.0919, label: 0, bag_size: 57
batch 439, loss: 0.4446, instance_loss: 0.4122, weighted_loss: 0.4349, label: 1, bag_size: 371
batch 459, loss: 0.8830, instance_loss: 0.5213, weighted_loss: 0.7745, label: 3, bag_size: 473
batch 479, loss: 0.9592, instance_loss: 0.4996, weighted_loss: 0.8213, label: 3, bag_size: 1284
batch 499, loss: 0.0673, instance_loss: 0.2345, weighted_loss: 0.1174, label: 0, bag_size: 97
batch 519, loss: 0.7278, instance_loss: 0.5261, weighted_loss: 0.6673, label: 4, bag_size: 506
batch 539, loss: 0.2768, instance_loss: 0.2365, weighted_loss: 0.2647, label: 0, bag_size: 57
batch 559, loss: 2.0289, instance_loss: 0.5006, weighted_loss: 1.5704, label: 2, bag_size: 754
batch 579, loss: 1.7454, instance_loss: 0.5281, weighted_loss: 1.3802, label: 4, bag_size: 270


class 0 clustering acc 0.9976430976430977: correct 23704/23760
class 1 clustering acc 0.026304713804713806: correct 125/4752
Epoch: 34, train_loss: 1.0994, train_clustering_loss:  0.4854, train_error: 0.4663
class 0: acc 0.7927927927927928, correct 88/111
class 1: acc 0.5986394557823129, correct 88/147
class 2: acc 0.2523364485981308, correct 27/107
class 3: acc 0.46153846153846156, correct 54/117
class 4: acc 0.5357142857142857, correct 60/112

Val Set, val_loss: 1.5601, val_error: 0.6622, auc: 0.7708
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9543, instance_loss: 0.5330, weighted_loss: 0.8279, label: 2, bag_size: 598
batch 39, loss: 0.2606, instance_loss: 0.5066, weighted_loss: 0.3344, label: 0, bag_size: 141
batch 59, loss: 0.0734, instance_loss: 0.4201, weighted_loss: 0.1774, label: 0, bag_size: 251
batch 79, loss: 0.8918, instance_loss: 0.4474, weighted_loss: 0.7585, label: 1, bag_size: 398
batch 99, loss: 0.8379, instance_loss: 0.4296, weighted_loss: 0.7154, label: 1, bag_size: 177
batch 119, loss: 0.9280, instance_loss: 0.4731, weighted_loss: 0.7916, label: 2, bag_size: 886
batch 139, loss: 0.9107, instance_loss: 0.4230, weighted_loss: 0.7644, label: 2, bag_size: 244
batch 159, loss: 0.3804, instance_loss: 0.4827, weighted_loss: 0.4111, label: 0, bag_size: 258
batch 179, loss: 0.5555, instance_loss: 0.4637, weighted_loss: 0.5280, label: 4, bag_size: 1041
batch 199, loss: 0.2855, instance_loss: 0.4045, weighted_loss: 0.3212, label: 4, bag_size: 1064
batch 219, loss: 0.4769, instance_loss: 0.4168, weighted_loss: 0.4589, label: 3, bag_size: 625
batch 239, loss: 1.4840, instance_loss: 0.5845, weighted_loss: 1.2141, label: 4, bag_size: 1297
batch 259, loss: 0.9837, instance_loss: 0.5222, weighted_loss: 0.8453, label: 1, bag_size: 1013
batch 279, loss: 1.0198, instance_loss: 0.4784, weighted_loss: 0.8574, label: 1, bag_size: 620
batch 299, loss: 1.8061, instance_loss: 0.6489, weighted_loss: 1.4589, label: 2, bag_size: 799
batch 319, loss: 0.6306, instance_loss: 0.5561, weighted_loss: 0.6083, label: 3, bag_size: 351
batch 339, loss: 0.3256, instance_loss: 0.3847, weighted_loss: 0.3433, label: 4, bag_size: 266
batch 359, loss: 0.9493, instance_loss: 0.5299, weighted_loss: 0.8235, label: 3, bag_size: 737
batch 379, loss: 0.3913, instance_loss: 0.3481, weighted_loss: 0.3783, label: 4, bag_size: 418
batch 399, loss: 0.8615, instance_loss: 0.4528, weighted_loss: 0.7389, label: 2, bag_size: 290
batch 419, loss: 0.9037, instance_loss: 0.3195, weighted_loss: 0.7284, label: 0, bag_size: 581
batch 439, loss: 0.8930, instance_loss: 0.4693, weighted_loss: 0.7659, label: 2, bag_size: 725
batch 459, loss: 0.6134, instance_loss: 0.4322, weighted_loss: 0.5590, label: 1, bag_size: 960
batch 479, loss: 1.4987, instance_loss: 0.6766, weighted_loss: 1.2521, label: 0, bag_size: 1085
batch 499, loss: 2.3227, instance_loss: 0.7463, weighted_loss: 1.8498, label: 4, bag_size: 267
batch 519, loss: 0.7727, instance_loss: 0.4754, weighted_loss: 0.6835, label: 2, bag_size: 557
batch 539, loss: 0.7870, instance_loss: 0.5198, weighted_loss: 0.7069, label: 3, bag_size: 344
batch 559, loss: 4.0293, instance_loss: 0.6495, weighted_loss: 3.0154, label: 0, bag_size: 273
batch 579, loss: 1.1512, instance_loss: 0.5354, weighted_loss: 0.9664, label: 3, bag_size: 796


class 0 clustering acc 0.9962962962962963: correct 23672/23760
class 1 clustering acc 0.032617845117845115: correct 155/4752
Epoch: 35, train_loss: 1.0629, train_clustering_loss:  0.4929, train_error: 0.4444
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.5416666666666666, correct 65/120
class 2: acc 0.32142857142857145, correct 36/112
class 3: acc 0.5546218487394958, correct 66/119
class 4: acc 0.5470085470085471, correct 64/117

Val Set, val_loss: 1.4726, val_error: 0.5811, auc: 0.8007
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8947, instance_loss: 0.4765, weighted_loss: 0.7692, label: 1, bag_size: 591
batch 39, loss: 2.6380, instance_loss: 0.5534, weighted_loss: 2.0127, label: 1, bag_size: 45
batch 59, loss: 0.7471, instance_loss: 0.4468, weighted_loss: 0.6570, label: 2, bag_size: 290
batch 79, loss: 0.5294, instance_loss: 0.3857, weighted_loss: 0.4863, label: 4, bag_size: 875
batch 99, loss: 1.0089, instance_loss: 0.4764, weighted_loss: 0.8491, label: 4, bag_size: 665
batch 119, loss: 2.2922, instance_loss: 0.6481, weighted_loss: 1.7990, label: 2, bag_size: 128
batch 139, loss: 0.7378, instance_loss: 0.4172, weighted_loss: 0.6416, label: 1, bag_size: 328
batch 159, loss: 2.3653, instance_loss: 0.5236, weighted_loss: 1.8128, label: 3, bag_size: 323
batch 179, loss: 0.2015, instance_loss: 0.4245, weighted_loss: 0.2684, label: 2, bag_size: 702
batch 199, loss: 1.2518, instance_loss: 0.5712, weighted_loss: 1.0476, label: 3, bag_size: 641
batch 219, loss: 0.2250, instance_loss: 0.4965, weighted_loss: 0.3065, label: 1, bag_size: 311
batch 239, loss: 1.0028, instance_loss: 0.4507, weighted_loss: 0.8371, label: 3, bag_size: 488
batch 259, loss: 0.9733, instance_loss: 0.4143, weighted_loss: 0.8056, label: 1, bag_size: 372
batch 279, loss: 1.3726, instance_loss: 0.5730, weighted_loss: 1.1327, label: 0, bag_size: 478
batch 299, loss: 1.2884, instance_loss: 0.5088, weighted_loss: 1.0545, label: 3, bag_size: 364
batch 319, loss: 1.2440, instance_loss: 0.5557, weighted_loss: 1.0375, label: 0, bag_size: 642
batch 339, loss: 0.6012, instance_loss: 0.4518, weighted_loss: 0.5564, label: 2, bag_size: 558
batch 359, loss: 0.0208, instance_loss: 0.2732, weighted_loss: 0.0965, label: 0, bag_size: 188
batch 379, loss: 1.8121, instance_loss: 0.5714, weighted_loss: 1.4399, label: 1, bag_size: 697
batch 399, loss: 1.2609, instance_loss: 0.5091, weighted_loss: 1.0353, label: 1, bag_size: 840
batch 419, loss: 0.3870, instance_loss: 0.5250, weighted_loss: 0.4284, label: 4, bag_size: 683
batch 439, loss: 0.5758, instance_loss: 0.4491, weighted_loss: 0.5378, label: 2, bag_size: 1079
batch 459, loss: 0.6598, instance_loss: 0.4072, weighted_loss: 0.5840, label: 4, bag_size: 333
batch 479, loss: 0.3273, instance_loss: 0.4594, weighted_loss: 0.3669, label: 2, bag_size: 1608
batch 499, loss: 0.0398, instance_loss: 0.3817, weighted_loss: 0.1424, label: 0, bag_size: 702
batch 519, loss: 0.0624, instance_loss: 0.3877, weighted_loss: 0.1600, label: 2, bag_size: 1608
batch 539, loss: 1.9799, instance_loss: 0.6296, weighted_loss: 1.5748, label: 1, bag_size: 618
batch 559, loss: 0.9072, instance_loss: 0.4624, weighted_loss: 0.7738, label: 4, bag_size: 780
batch 579, loss: 0.6055, instance_loss: 0.5125, weighted_loss: 0.5776, label: 1, bag_size: 153


class 0 clustering acc 0.9983585858585858: correct 23721/23760
class 1 clustering acc 0.017676767676767676: correct 84/4752
Epoch: 36, train_loss: 1.0175, train_clustering_loss:  0.4831, train_error: 0.4343
class 0: acc 0.8571428571428571, correct 96/112
class 1: acc 0.5234375, correct 67/128
class 2: acc 0.42105263157894735, correct 56/133
class 3: acc 0.5798319327731093, correct 69/119
class 4: acc 0.47058823529411764, correct 48/102

Val Set, val_loss: 1.5737, val_error: 0.5676, auc: 0.8219
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3721, instance_loss: 0.5313, weighted_loss: 1.1199, label: 1, bag_size: 408
batch 39, loss: 1.5058, instance_loss: 0.4978, weighted_loss: 1.2034, label: 2, bag_size: 348
batch 59, loss: 0.1759, instance_loss: 0.4134, weighted_loss: 0.2472, label: 0, bag_size: 524
batch 79, loss: 0.3054, instance_loss: 0.4344, weighted_loss: 0.3441, label: 1, bag_size: 892
batch 99, loss: 1.3183, instance_loss: 0.5400, weighted_loss: 1.0848, label: 1, bag_size: 1023
batch 119, loss: 0.1816, instance_loss: 0.4501, weighted_loss: 0.2622, label: 4, bag_size: 773
batch 139, loss: 3.0379, instance_loss: 0.6506, weighted_loss: 2.3217, label: 2, bag_size: 809
batch 159, loss: 0.0167, instance_loss: 0.2825, weighted_loss: 0.0964, label: 0, bag_size: 133
batch 179, loss: 0.6465, instance_loss: 0.3895, weighted_loss: 0.5694, label: 2, bag_size: 708
batch 199, loss: 5.1822, instance_loss: 0.6547, weighted_loss: 3.8239, label: 4, bag_size: 101
batch 219, loss: 3.2195, instance_loss: 0.7215, weighted_loss: 2.4701, label: 0, bag_size: 1045
batch 239, loss: 0.8462, instance_loss: 0.6865, weighted_loss: 0.7983, label: 1, bag_size: 311
batch 259, loss: 0.0340, instance_loss: 0.3061, weighted_loss: 0.1156, label: 0, bag_size: 357
batch 279, loss: 2.5239, instance_loss: 0.6049, weighted_loss: 1.9482, label: 3, bag_size: 492
batch 299, loss: 0.9292, instance_loss: 0.5399, weighted_loss: 0.8124, label: 3, bag_size: 1186
batch 319, loss: 0.1301, instance_loss: 0.4072, weighted_loss: 0.2132, label: 0, bag_size: 122
batch 339, loss: 1.3217, instance_loss: 0.5720, weighted_loss: 1.0968, label: 4, bag_size: 970
batch 359, loss: 0.3203, instance_loss: 0.3089, weighted_loss: 0.3169, label: 4, bag_size: 948
batch 379, loss: 0.0427, instance_loss: 0.2772, weighted_loss: 0.1131, label: 0, bag_size: 488
batch 399, loss: 0.2687, instance_loss: 0.5156, weighted_loss: 0.3427, label: 3, bag_size: 587
batch 419, loss: 0.0191, instance_loss: 0.2713, weighted_loss: 0.0948, label: 0, bag_size: 69
batch 439, loss: 1.0129, instance_loss: 0.4614, weighted_loss: 0.8475, label: 1, bag_size: 328
batch 459, loss: 1.5892, instance_loss: 0.5118, weighted_loss: 1.2660, label: 1, bag_size: 851
batch 479, loss: 1.2248, instance_loss: 0.4845, weighted_loss: 1.0027, label: 1, bag_size: 702
batch 499, loss: 1.4372, instance_loss: 0.5270, weighted_loss: 1.1641, label: 1, bag_size: 419
batch 519, loss: 0.7493, instance_loss: 0.4343, weighted_loss: 0.6548, label: 3, bag_size: 1186
batch 539, loss: 1.1329, instance_loss: 0.4996, weighted_loss: 0.9429, label: 1, bag_size: 1023
batch 559, loss: 0.9344, instance_loss: 0.4628, weighted_loss: 0.7929, label: 0, bag_size: 283
batch 579, loss: 1.0687, instance_loss: 0.5734, weighted_loss: 0.9201, label: 0, bag_size: 343


class 0 clustering acc 0.9976430976430977: correct 23704/23760
class 1 clustering acc 0.026094276094276093: correct 124/4752
Epoch: 37, train_loss: 1.0833, train_clustering_loss:  0.4801, train_error: 0.4714
class 0: acc 0.8442622950819673, correct 103/122
class 1: acc 0.2857142857142857, correct 32/112
class 2: acc 0.36507936507936506, correct 46/126
class 3: acc 0.5833333333333334, correct 77/132
class 4: acc 0.5490196078431373, correct 56/102

Val Set, val_loss: 1.6031, val_error: 0.5000, auc: 0.8090
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.0871, instance_loss: 0.5956, weighted_loss: 1.6396, label: 4, bag_size: 589
batch 39, loss: 1.5043, instance_loss: 0.5093, weighted_loss: 1.2058, label: 3, bag_size: 403
batch 59, loss: 0.0235, instance_loss: 0.2913, weighted_loss: 0.1038, label: 0, bag_size: 366
batch 79, loss: 1.1920, instance_loss: 0.5081, weighted_loss: 0.9868, label: 3, bag_size: 804
batch 99, loss: 0.2623, instance_loss: 0.4651, weighted_loss: 0.3231, label: 4, bag_size: 725
batch 119, loss: 0.5468, instance_loss: 0.5728, weighted_loss: 0.5546, label: 4, bag_size: 574
batch 139, loss: 0.4850, instance_loss: 0.4573, weighted_loss: 0.4767, label: 4, bag_size: 1041
batch 159, loss: 0.6537, instance_loss: 0.4384, weighted_loss: 0.5891, label: 4, bag_size: 110
batch 179, loss: 0.0205, instance_loss: 0.3042, weighted_loss: 0.1056, label: 0, bag_size: 71
batch 199, loss: 2.2324, instance_loss: 0.6190, weighted_loss: 1.7484, label: 0, bag_size: 1045
batch 219, loss: 1.6486, instance_loss: 0.4949, weighted_loss: 1.3025, label: 3, bag_size: 472
batch 239, loss: 1.3420, instance_loss: 0.5301, weighted_loss: 1.0984, label: 4, bag_size: 250
batch 259, loss: 0.7075, instance_loss: 0.5895, weighted_loss: 0.6721, label: 2, bag_size: 1608
batch 279, loss: 0.5698, instance_loss: 0.3498, weighted_loss: 0.5038, label: 0, bag_size: 97
batch 299, loss: 1.2041, instance_loss: 0.4422, weighted_loss: 0.9755, label: 1, bag_size: 855
batch 319, loss: 1.1890, instance_loss: 0.4678, weighted_loss: 0.9726, label: 1, bag_size: 605
batch 339, loss: 0.6308, instance_loss: 0.4369, weighted_loss: 0.5727, label: 0, bag_size: 122
batch 359, loss: 1.7626, instance_loss: 0.5742, weighted_loss: 1.4061, label: 3, bag_size: 230
batch 379, loss: 0.5448, instance_loss: 0.4223, weighted_loss: 0.5081, label: 2, bag_size: 317
batch 399, loss: 0.6727, instance_loss: 0.5183, weighted_loss: 0.6264, label: 4, bag_size: 377
batch 419, loss: 0.8115, instance_loss: 0.5174, weighted_loss: 0.7233, label: 0, bag_size: 62
batch 439, loss: 0.9583, instance_loss: 0.5002, weighted_loss: 0.8209, label: 3, bag_size: 437
batch 459, loss: 1.5804, instance_loss: 0.5029, weighted_loss: 1.2572, label: 3, bag_size: 500
batch 479, loss: 1.3100, instance_loss: 0.5339, weighted_loss: 1.0772, label: 2, bag_size: 168
batch 499, loss: 2.4945, instance_loss: 0.5593, weighted_loss: 1.9139, label: 4, bag_size: 432
batch 519, loss: 1.0976, instance_loss: 0.5941, weighted_loss: 0.9466, label: 0, bag_size: 416
batch 539, loss: 0.9378, instance_loss: 0.4721, weighted_loss: 0.7981, label: 1, bag_size: 742
batch 559, loss: 1.5402, instance_loss: 0.6370, weighted_loss: 1.2692, label: 2, bag_size: 860
batch 579, loss: 0.7404, instance_loss: 0.4750, weighted_loss: 0.6608, label: 3, bag_size: 344


class 0 clustering acc 0.9970117845117845: correct 23689/23760
class 1 clustering acc 0.03935185185185185: correct 187/4752
Epoch: 38, train_loss: 1.0372, train_clustering_loss:  0.4738, train_error: 0.4276
class 0: acc 0.8181818181818182, correct 99/121
class 1: acc 0.4297520661157025, correct 52/121
class 2: acc 0.34579439252336447, correct 37/107
class 3: acc 0.576271186440678, correct 68/118
class 4: acc 0.6614173228346457, correct 84/127

Val Set, val_loss: 1.5423, val_error: 0.5000, auc: 0.8198
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.1137, instance_loss: 0.5203, weighted_loss: 0.9357, label: 1, bag_size: 1043
batch 39, loss: 0.5939, instance_loss: 0.4020, weighted_loss: 0.5363, label: 4, bag_size: 293
batch 59, loss: 0.9279, instance_loss: 0.4121, weighted_loss: 0.7731, label: 3, bag_size: 109
batch 79, loss: 0.0200, instance_loss: 0.3035, weighted_loss: 0.1050, label: 0, bag_size: 210
batch 99, loss: 1.4827, instance_loss: 0.4717, weighted_loss: 1.1794, label: 3, bag_size: 258
batch 119, loss: 2.1459, instance_loss: 0.4584, weighted_loss: 1.6396, label: 2, bag_size: 606
batch 139, loss: 1.5139, instance_loss: 0.5551, weighted_loss: 1.2263, label: 2, bag_size: 852
batch 159, loss: 0.0812, instance_loss: 0.3131, weighted_loss: 0.1508, label: 4, bag_size: 409
batch 179, loss: 0.6964, instance_loss: 0.4341, weighted_loss: 0.6177, label: 4, bag_size: 875
batch 199, loss: 0.7806, instance_loss: 0.4380, weighted_loss: 0.6778, label: 3, bag_size: 312
batch 219, loss: 0.4984, instance_loss: 0.5742, weighted_loss: 0.5212, label: 4, bag_size: 725
batch 239, loss: 0.0243, instance_loss: 0.4852, weighted_loss: 0.1626, label: 0, bag_size: 732
batch 259, loss: 0.6717, instance_loss: 0.5114, weighted_loss: 0.6236, label: 3, bag_size: 398
batch 279, loss: 1.9055, instance_loss: 0.5691, weighted_loss: 1.5046, label: 2, bag_size: 1060
batch 299, loss: 0.8044, instance_loss: 0.4978, weighted_loss: 0.7124, label: 1, bag_size: 231
batch 319, loss: 1.3073, instance_loss: 0.4870, weighted_loss: 1.0612, label: 0, bag_size: 879
batch 339, loss: 0.0355, instance_loss: 0.2967, weighted_loss: 0.1139, label: 0, bag_size: 493
batch 359, loss: 1.1542, instance_loss: 0.5728, weighted_loss: 0.9798, label: 4, bag_size: 506
batch 379, loss: 0.0091, instance_loss: 0.2875, weighted_loss: 0.0926, label: 0, bag_size: 341
batch 399, loss: 2.2426, instance_loss: 0.5916, weighted_loss: 1.7473, label: 1, bag_size: 988
batch 419, loss: 1.0194, instance_loss: 0.4611, weighted_loss: 0.8519, label: 3, bag_size: 603
batch 439, loss: 1.5226, instance_loss: 0.5360, weighted_loss: 1.2267, label: 1, bag_size: 702
batch 459, loss: 1.0441, instance_loss: 0.4598, weighted_loss: 0.8688, label: 4, bag_size: 356
batch 479, loss: 0.9817, instance_loss: 0.4746, weighted_loss: 0.8296, label: 1, bag_size: 766
batch 499, loss: 2.0461, instance_loss: 0.5267, weighted_loss: 1.5903, label: 2, bag_size: 361
batch 519, loss: 0.2275, instance_loss: 0.2759, weighted_loss: 0.2421, label: 0, bag_size: 435
batch 539, loss: 2.0218, instance_loss: 0.6276, weighted_loss: 1.6035, label: 2, bag_size: 128
batch 559, loss: 0.8208, instance_loss: 0.4862, weighted_loss: 0.7204, label: 3, bag_size: 500
batch 579, loss: 0.6632, instance_loss: 0.7473, weighted_loss: 0.6884, label: 1, bag_size: 106


class 0 clustering acc 0.9962121212121212: correct 23670/23760
class 1 clustering acc 0.03409090909090909: correct 162/4752
Epoch: 39, train_loss: 1.1067, train_clustering_loss:  0.4826, train_error: 0.4899
class 0: acc 0.8253968253968254, correct 104/126
class 1: acc 0.4067796610169492, correct 48/118
class 2: acc 0.27906976744186046, correct 36/129
class 3: acc 0.5365853658536586, correct 66/123
class 4: acc 0.5, correct 49/98

Val Set, val_loss: 2.2221, val_error: 0.6081, auc: 0.7859
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2260, instance_loss: 0.3929, weighted_loss: 0.2761, label: 0, bag_size: 282
batch 39, loss: 0.9493, instance_loss: 0.4042, weighted_loss: 0.7857, label: 2, bag_size: 584
batch 59, loss: 1.5978, instance_loss: 0.6218, weighted_loss: 1.3050, label: 3, bag_size: 857
batch 79, loss: 1.6868, instance_loss: 0.5881, weighted_loss: 1.3571, label: 2, bag_size: 512
batch 99, loss: 0.9153, instance_loss: 0.4557, weighted_loss: 0.7774, label: 2, bag_size: 883
batch 119, loss: 0.9162, instance_loss: 0.6487, weighted_loss: 0.8359, label: 1, bag_size: 1497
batch 139, loss: 0.6290, instance_loss: 0.4554, weighted_loss: 0.5769, label: 2, bag_size: 567
batch 159, loss: 0.2192, instance_loss: 0.4646, weighted_loss: 0.2928, label: 4, bag_size: 773
batch 179, loss: 0.0415, instance_loss: 0.3859, weighted_loss: 0.1448, label: 0, bag_size: 366
batch 199, loss: 0.6064, instance_loss: 0.4049, weighted_loss: 0.5459, label: 2, bag_size: 317
batch 219, loss: 1.5879, instance_loss: 0.6165, weighted_loss: 1.2965, label: 3, bag_size: 156
batch 239, loss: 0.6555, instance_loss: 0.4352, weighted_loss: 0.5894, label: 2, bag_size: 290
batch 259, loss: 2.0388, instance_loss: 0.5860, weighted_loss: 1.6030, label: 3, bag_size: 166
batch 279, loss: 0.2087, instance_loss: 0.3758, weighted_loss: 0.2588, label: 0, bag_size: 49
batch 299, loss: 0.9974, instance_loss: 0.4602, weighted_loss: 0.8362, label: 3, bag_size: 323
batch 319, loss: 0.5252, instance_loss: 0.4511, weighted_loss: 0.5029, label: 1, bag_size: 1104
batch 339, loss: 0.2793, instance_loss: 0.3412, weighted_loss: 0.2979, label: 4, bag_size: 986
batch 359, loss: 0.8382, instance_loss: 0.4538, weighted_loss: 0.7229, label: 3, bag_size: 472
batch 379, loss: 1.1362, instance_loss: 0.4700, weighted_loss: 0.9363, label: 1, bag_size: 221
batch 399, loss: 0.4634, instance_loss: 0.4039, weighted_loss: 0.4455, label: 2, bag_size: 572
batch 419, loss: 0.6086, instance_loss: 0.4660, weighted_loss: 0.5658, label: 2, bag_size: 543
batch 439, loss: 0.5366, instance_loss: 0.5063, weighted_loss: 0.5275, label: 4, bag_size: 318
batch 459, loss: 1.3519, instance_loss: 0.6277, weighted_loss: 1.1346, label: 3, bag_size: 1057
batch 479, loss: 1.2451, instance_loss: 0.4822, weighted_loss: 1.0162, label: 2, bag_size: 530
batch 499, loss: 1.1004, instance_loss: 0.5264, weighted_loss: 0.9282, label: 4, bag_size: 853
batch 519, loss: 0.2675, instance_loss: 0.3748, weighted_loss: 0.2997, label: 4, bag_size: 744
batch 539, loss: 0.2138, instance_loss: 0.4117, weighted_loss: 0.2732, label: 0, bag_size: 455
batch 559, loss: 0.1434, instance_loss: 0.3506, weighted_loss: 0.2055, label: 2, bag_size: 684
batch 579, loss: 2.0059, instance_loss: 0.6582, weighted_loss: 1.6016, label: 0, bag_size: 247


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.041035353535353536: correct 195/4752
Epoch: 40, train_loss: 1.0395, train_clustering_loss:  0.4751, train_error: 0.4293
class 0: acc 0.8888888888888888, correct 112/126
class 1: acc 0.3584905660377358, correct 38/106
class 2: acc 0.4435483870967742, correct 55/124
class 3: acc 0.496, correct 62/125
class 4: acc 0.6371681415929203, correct 72/113

Val Set, val_loss: 1.5628, val_error: 0.5946, auc: 0.7916
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2487, instance_loss: 0.3323, weighted_loss: 0.2737, label: 2, bag_size: 558
batch 39, loss: 0.5354, instance_loss: 0.5470, weighted_loss: 0.5388, label: 0, bag_size: 183
batch 59, loss: 1.3192, instance_loss: 0.4809, weighted_loss: 1.0677, label: 4, bag_size: 113
batch 79, loss: 1.3997, instance_loss: 0.5032, weighted_loss: 1.1308, label: 2, bag_size: 331
batch 99, loss: 0.0000, instance_loss: 0.2538, weighted_loss: 0.0761, label: 4, bag_size: 813
batch 119, loss: 0.0135, instance_loss: 0.2145, weighted_loss: 0.0738, label: 0, bag_size: 188
batch 139, loss: 4.4937, instance_loss: 0.7352, weighted_loss: 3.3661, label: 1, bag_size: 45
batch 159, loss: 0.1800, instance_loss: 0.4452, weighted_loss: 0.2595, label: 0, bag_size: 33
batch 179, loss: 1.3828, instance_loss: 0.5266, weighted_loss: 1.1259, label: 0, bag_size: 143
batch 199, loss: 0.8796, instance_loss: 0.4390, weighted_loss: 0.7474, label: 2, bag_size: 135
batch 219, loss: 0.4962, instance_loss: 0.6461, weighted_loss: 0.5412, label: 1, bag_size: 311
batch 239, loss: 0.5306, instance_loss: 0.7935, weighted_loss: 0.6095, label: 1, bag_size: 1497
batch 259, loss: 1.1995, instance_loss: 0.4708, weighted_loss: 0.9809, label: 1, bag_size: 332
batch 279, loss: 1.0855, instance_loss: 0.3993, weighted_loss: 0.8796, label: 1, bag_size: 1009
batch 299, loss: 0.0618, instance_loss: 0.5142, weighted_loss: 0.1975, label: 2, bag_size: 1608
batch 319, loss: 0.0003, instance_loss: 0.3871, weighted_loss: 0.1163, label: 2, bag_size: 553
batch 339, loss: 0.0632, instance_loss: 0.4899, weighted_loss: 0.1912, label: 0, bag_size: 383
batch 359, loss: 1.1958, instance_loss: 0.5827, weighted_loss: 1.0119, label: 3, bag_size: 1186
batch 379, loss: 0.5047, instance_loss: 0.3900, weighted_loss: 0.4703, label: 2, bag_size: 572
batch 399, loss: 0.7708, instance_loss: 0.3542, weighted_loss: 0.6458, label: 2, bag_size: 706
batch 419, loss: 0.4747, instance_loss: 0.4118, weighted_loss: 0.4559, label: 4, bag_size: 604
batch 439, loss: 0.2212, instance_loss: 0.4458, weighted_loss: 0.2886, label: 0, bag_size: 383
batch 459, loss: 0.1889, instance_loss: 0.3866, weighted_loss: 0.2482, label: 0, bag_size: 552
batch 479, loss: 0.8620, instance_loss: 0.5863, weighted_loss: 0.7793, label: 3, bag_size: 804
batch 499, loss: 1.5316, instance_loss: 0.5049, weighted_loss: 1.2236, label: 1, bag_size: 617
batch 519, loss: 1.1236, instance_loss: 0.4697, weighted_loss: 0.9274, label: 4, bag_size: 618
batch 539, loss: 0.7753, instance_loss: 0.5772, weighted_loss: 0.7159, label: 4, bag_size: 432
batch 559, loss: 0.0750, instance_loss: 0.4015, weighted_loss: 0.1729, label: 4, bag_size: 228
batch 579, loss: 0.8550, instance_loss: 0.4503, weighted_loss: 0.7336, label: 1, bag_size: 814


class 0 clustering acc 0.9962542087542088: correct 23671/23760
class 1 clustering acc 0.061237373737373736: correct 291/4752
Epoch: 41, train_loss: 0.9987, train_clustering_loss:  0.4730, train_error: 0.4242
class 0: acc 0.8189655172413793, correct 95/116
class 1: acc 0.3474576271186441, correct 41/118
class 2: acc 0.546875, correct 70/128
class 3: acc 0.4954954954954955, correct 55/111
class 4: acc 0.6694214876033058, correct 81/121

Val Set, val_loss: 1.6721, val_error: 0.6216, auc: 0.7772
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1971, instance_loss: 0.4876, weighted_loss: 0.2842, label: 0, bag_size: 59
batch 39, loss: 0.9025, instance_loss: 0.5086, weighted_loss: 0.7843, label: 3, bag_size: 598
batch 59, loss: 1.3968, instance_loss: 0.6403, weighted_loss: 1.1699, label: 3, bag_size: 107
batch 79, loss: 2.8888, instance_loss: 0.5802, weighted_loss: 2.1963, label: 2, bag_size: 829
batch 99, loss: 2.4202, instance_loss: 0.6601, weighted_loss: 1.8922, label: 1, bag_size: 153
batch 119, loss: 0.3099, instance_loss: 0.4492, weighted_loss: 0.3517, label: 4, bag_size: 923
batch 139, loss: 0.2431, instance_loss: 0.3421, weighted_loss: 0.2728, label: 0, bag_size: 524
batch 159, loss: 0.4078, instance_loss: 0.4228, weighted_loss: 0.4123, label: 4, bag_size: 468
batch 179, loss: 0.6065, instance_loss: 0.3933, weighted_loss: 0.5426, label: 2, bag_size: 549
batch 199, loss: 0.5387, instance_loss: 0.5641, weighted_loss: 0.5463, label: 0, bag_size: 400
batch 219, loss: 0.9883, instance_loss: 0.5981, weighted_loss: 0.8712, label: 2, bag_size: 128
batch 239, loss: 0.4160, instance_loss: 0.4138, weighted_loss: 0.4153, label: 0, bag_size: 97
batch 259, loss: 2.4690, instance_loss: 0.5749, weighted_loss: 1.9008, label: 1, bag_size: 201
batch 279, loss: 0.5148, instance_loss: 0.3658, weighted_loss: 0.4701, label: 4, bag_size: 875
batch 299, loss: 0.5332, instance_loss: 0.3826, weighted_loss: 0.4880, label: 2, bag_size: 369
batch 319, loss: 0.3693, instance_loss: 0.3898, weighted_loss: 0.3755, label: 4, bag_size: 1041
batch 339, loss: 0.0584, instance_loss: 0.5711, weighted_loss: 0.2122, label: 4, bag_size: 160
batch 359, loss: 1.4806, instance_loss: 0.5579, weighted_loss: 1.2038, label: 3, bag_size: 230
batch 379, loss: 0.4262, instance_loss: 0.4849, weighted_loss: 0.4438, label: 3, bag_size: 830
batch 399, loss: 0.6230, instance_loss: 0.5164, weighted_loss: 0.5910, label: 4, bag_size: 446
batch 419, loss: 0.4554, instance_loss: 0.5213, weighted_loss: 0.4752, label: 0, bag_size: 277
batch 439, loss: 0.9199, instance_loss: 0.3889, weighted_loss: 0.7606, label: 4, bag_size: 604
batch 459, loss: 0.7024, instance_loss: 0.4828, weighted_loss: 0.6366, label: 3, bag_size: 928
batch 479, loss: 0.4109, instance_loss: 0.5015, weighted_loss: 0.4381, label: 2, bag_size: 886
batch 499, loss: 1.5238, instance_loss: 0.5029, weighted_loss: 1.2176, label: 1, bag_size: 620
batch 519, loss: 0.0972, instance_loss: 0.3396, weighted_loss: 0.1699, label: 0, bag_size: 188
batch 539, loss: 0.4156, instance_loss: 0.4584, weighted_loss: 0.4285, label: 1, bag_size: 748
batch 559, loss: 0.7211, instance_loss: 0.4878, weighted_loss: 0.6511, label: 1, bag_size: 766
batch 579, loss: 0.8641, instance_loss: 0.5912, weighted_loss: 0.7822, label: 4, bag_size: 267


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.020622895622895623: correct 98/4752
Epoch: 42, train_loss: 1.0539, train_clustering_loss:  0.4901, train_error: 0.4596
class 0: acc 0.7982456140350878, correct 91/114
class 1: acc 0.29, correct 29/100
class 2: acc 0.5314685314685315, correct 76/143
class 3: acc 0.4732142857142857, correct 53/112
class 4: acc 0.576, correct 72/125

Val Set, val_loss: 1.7378, val_error: 0.6081, auc: 0.7498
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1279, instance_loss: 0.3078, weighted_loss: 0.1818, label: 0, bag_size: 282
batch 39, loss: 1.2864, instance_loss: 0.4768, weighted_loss: 1.0435, label: 2, bag_size: 445
batch 59, loss: 0.3190, instance_loss: 0.4965, weighted_loss: 0.3722, label: 0, bag_size: 493
batch 79, loss: 2.0781, instance_loss: 0.6167, weighted_loss: 1.6396, label: 4, bag_size: 853
batch 99, loss: 0.6790, instance_loss: 0.4752, weighted_loss: 0.6178, label: 1, bag_size: 925
batch 119, loss: 0.9743, instance_loss: 0.5120, weighted_loss: 0.8356, label: 2, bag_size: 584
batch 139, loss: 0.0642, instance_loss: 0.3290, weighted_loss: 0.1436, label: 0, bag_size: 355
batch 159, loss: 0.0000, instance_loss: 0.7598, weighted_loss: 0.2280, label: 4, bag_size: 813
batch 179, loss: 1.5188, instance_loss: 0.5512, weighted_loss: 1.2285, label: 1, bag_size: 972
batch 199, loss: 0.1943, instance_loss: 0.4290, weighted_loss: 0.2647, label: 0, bag_size: 455
batch 219, loss: 1.6864, instance_loss: 0.4943, weighted_loss: 1.3288, label: 0, bag_size: 243
batch 239, loss: 1.6028, instance_loss: 0.5335, weighted_loss: 1.2820, label: 2, bag_size: 852
batch 259, loss: 0.6013, instance_loss: 0.4386, weighted_loss: 0.5525, label: 3, bag_size: 746
batch 279, loss: 1.6274, instance_loss: 0.4371, weighted_loss: 1.2703, label: 0, bag_size: 642
batch 299, loss: 1.2890, instance_loss: 0.4769, weighted_loss: 1.0454, label: 3, bag_size: 1154
batch 319, loss: 0.0187, instance_loss: 0.4313, weighted_loss: 0.1425, label: 0, bag_size: 230
batch 339, loss: 0.2069, instance_loss: 0.4265, weighted_loss: 0.2728, label: 4, bag_size: 1064
batch 359, loss: 1.6389, instance_loss: 0.5294, weighted_loss: 1.3060, label: 3, bag_size: 894
batch 379, loss: 1.0016, instance_loss: 0.4518, weighted_loss: 0.8367, label: 2, bag_size: 171
batch 399, loss: 0.0847, instance_loss: 0.5179, weighted_loss: 0.2146, label: 0, bag_size: 523
batch 419, loss: 1.2362, instance_loss: 0.4432, weighted_loss: 0.9983, label: 3, bag_size: 344
batch 439, loss: 1.2163, instance_loss: 0.4475, weighted_loss: 0.9856, label: 1, bag_size: 413
batch 459, loss: 2.2819, instance_loss: 0.7921, weighted_loss: 1.8350, label: 0, bag_size: 343
batch 479, loss: 1.1555, instance_loss: 0.4658, weighted_loss: 0.9486, label: 2, bag_size: 781
batch 499, loss: 0.1059, instance_loss: 0.3790, weighted_loss: 0.1879, label: 0, bag_size: 524
batch 519, loss: 0.8825, instance_loss: 0.4575, weighted_loss: 0.7550, label: 1, bag_size: 500
batch 539, loss: 0.4636, instance_loss: 0.4172, weighted_loss: 0.4497, label: 2, bag_size: 690
batch 559, loss: 2.3931, instance_loss: 0.5191, weighted_loss: 1.8309, label: 2, bag_size: 606
batch 579, loss: 2.7127, instance_loss: 0.5657, weighted_loss: 2.0686, label: 4, bag_size: 395


class 0 clustering acc 0.9972222222222222: correct 23694/23760
class 1 clustering acc 0.026094276094276093: correct 124/4752
Epoch: 43, train_loss: 1.0370, train_clustering_loss:  0.4875, train_error: 0.4529
class 0: acc 0.8333333333333334, correct 95/114
class 1: acc 0.4714285714285714, correct 66/140
class 2: acc 0.36363636363636365, correct 44/121
class 3: acc 0.45794392523364486, correct 49/107
class 4: acc 0.6339285714285714, correct 71/112

Val Set, val_loss: 1.6403, val_error: 0.5946, auc: 0.8069
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.5, correct 8/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0276, instance_loss: 0.2689, weighted_loss: 0.1000, label: 0, bag_size: 188
batch 39, loss: 0.4172, instance_loss: 0.3949, weighted_loss: 0.4105, label: 1, bag_size: 311
batch 59, loss: 0.9857, instance_loss: 0.5075, weighted_loss: 0.8423, label: 2, bag_size: 725
batch 79, loss: 0.7147, instance_loss: 0.4032, weighted_loss: 0.6212, label: 4, bag_size: 1077
batch 99, loss: 3.4979, instance_loss: 0.6625, weighted_loss: 2.6473, label: 0, bag_size: 115
batch 119, loss: 1.1385, instance_loss: 0.4726, weighted_loss: 0.9387, label: 3, bag_size: 495
batch 139, loss: 0.3510, instance_loss: 0.3312, weighted_loss: 0.3451, label: 0, bag_size: 370
batch 159, loss: 1.1095, instance_loss: 0.4666, weighted_loss: 0.9166, label: 1, bag_size: 874
batch 179, loss: 0.5729, instance_loss: 0.4508, weighted_loss: 0.5363, label: 3, bag_size: 476
batch 199, loss: 0.3348, instance_loss: 0.3877, weighted_loss: 0.3507, label: 1, bag_size: 892
batch 219, loss: 1.4280, instance_loss: 0.5745, weighted_loss: 1.1720, label: 3, bag_size: 615
batch 239, loss: 0.7076, instance_loss: 0.5295, weighted_loss: 0.6542, label: 3, bag_size: 1284
batch 259, loss: 0.6999, instance_loss: 0.3926, weighted_loss: 0.6077, label: 4, bag_size: 366
batch 279, loss: 0.4496, instance_loss: 0.4214, weighted_loss: 0.4411, label: 4, bag_size: 665
batch 299, loss: 1.8014, instance_loss: 0.5912, weighted_loss: 1.4383, label: 4, bag_size: 683
batch 319, loss: 0.0538, instance_loss: 0.3969, weighted_loss: 0.1567, label: 0, bag_size: 295
batch 339, loss: 0.0778, instance_loss: 0.4004, weighted_loss: 0.1746, label: 0, bag_size: 234
batch 359, loss: 1.1431, instance_loss: 0.5459, weighted_loss: 0.9639, label: 1, bag_size: 564
batch 379, loss: 1.0809, instance_loss: 0.4770, weighted_loss: 0.8997, label: 4, bag_size: 46
batch 399, loss: 0.9399, instance_loss: 0.4000, weighted_loss: 0.7780, label: 1, bag_size: 389
batch 419, loss: 0.3192, instance_loss: 0.4281, weighted_loss: 0.3519, label: 4, bag_size: 923
batch 439, loss: 1.0026, instance_loss: 0.4714, weighted_loss: 0.8433, label: 3, bag_size: 495
batch 459, loss: 0.0693, instance_loss: 0.4136, weighted_loss: 0.1726, label: 0, bag_size: 324
batch 479, loss: 0.9047, instance_loss: 0.3932, weighted_loss: 0.7513, label: 2, bag_size: 240
batch 499, loss: 0.1719, instance_loss: 0.4016, weighted_loss: 0.2408, label: 3, bag_size: 476
batch 519, loss: 1.4267, instance_loss: 0.5278, weighted_loss: 1.1570, label: 1, bag_size: 361
batch 539, loss: 1.1754, instance_loss: 0.5020, weighted_loss: 0.9734, label: 4, bag_size: 446
batch 559, loss: 1.1987, instance_loss: 0.6085, weighted_loss: 1.0217, label: 0, bag_size: 1045
batch 579, loss: 1.9510, instance_loss: 0.4736, weighted_loss: 1.5078, label: 2, bag_size: 258


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.037247474747474744: correct 177/4752
Epoch: 44, train_loss: 1.0440, train_clustering_loss:  0.4776, train_error: 0.4596
class 0: acc 0.8260869565217391, correct 114/138
class 1: acc 0.5514705882352942, correct 75/136
class 2: acc 0.21568627450980393, correct 22/102
class 3: acc 0.47619047619047616, correct 50/105
class 4: acc 0.5309734513274337, correct 60/113

Val Set, val_loss: 1.6503, val_error: 0.6081, auc: 0.7593
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.7038, instance_loss: 0.5986, weighted_loss: 1.3722, label: 1, bag_size: 361
batch 39, loss: 2.3063, instance_loss: 0.5637, weighted_loss: 1.7835, label: 4, bag_size: 730
batch 59, loss: 1.0317, instance_loss: 0.5340, weighted_loss: 0.8824, label: 3, bag_size: 556
batch 79, loss: 0.2782, instance_loss: 0.4878, weighted_loss: 0.3411, label: 0, bag_size: 552
batch 99, loss: 0.8275, instance_loss: 0.4888, weighted_loss: 0.7259, label: 3, bag_size: 1060
batch 119, loss: 0.2287, instance_loss: 0.4254, weighted_loss: 0.2877, label: 1, bag_size: 855
batch 139, loss: 0.7424, instance_loss: 0.4890, weighted_loss: 0.6664, label: 4, bag_size: 450
batch 159, loss: 0.9368, instance_loss: 0.4256, weighted_loss: 0.7834, label: 1, bag_size: 413
batch 179, loss: 1.2444, instance_loss: 0.5181, weighted_loss: 1.0265, label: 4, bag_size: 618
batch 199, loss: 0.9570, instance_loss: 0.5072, weighted_loss: 0.8221, label: 2, bag_size: 554
batch 219, loss: 0.0912, instance_loss: 0.2600, weighted_loss: 0.1419, label: 0, bag_size: 49
batch 239, loss: 0.0101, instance_loss: 0.1166, weighted_loss: 0.0420, label: 0, bag_size: 435
batch 259, loss: 2.5818, instance_loss: 0.8673, weighted_loss: 2.0675, label: 1, bag_size: 153
batch 279, loss: 0.2324, instance_loss: 0.4705, weighted_loss: 0.3039, label: 2, bag_size: 596
batch 299, loss: 0.1086, instance_loss: 0.5026, weighted_loss: 0.2268, label: 4, bag_size: 854
batch 319, loss: 2.5359, instance_loss: 0.5324, weighted_loss: 1.9349, label: 2, bag_size: 629
batch 339, loss: 1.2963, instance_loss: 0.5323, weighted_loss: 1.0671, label: 4, bag_size: 356
batch 359, loss: 1.2536, instance_loss: 0.4789, weighted_loss: 1.0212, label: 1, bag_size: 742
batch 379, loss: 0.4941, instance_loss: 0.5707, weighted_loss: 0.5171, label: 4, bag_size: 683
batch 399, loss: 1.7335, instance_loss: 0.8232, weighted_loss: 1.4605, label: 2, bag_size: 128
batch 419, loss: 0.9647, instance_loss: 0.4606, weighted_loss: 0.8135, label: 1, bag_size: 1013
batch 439, loss: 1.7992, instance_loss: 0.5998, weighted_loss: 1.4394, label: 4, bag_size: 589
batch 459, loss: 0.5218, instance_loss: 0.4931, weighted_loss: 0.5132, label: 0, bag_size: 62
batch 479, loss: 0.7724, instance_loss: 0.4592, weighted_loss: 0.6784, label: 1, bag_size: 332
batch 499, loss: 0.0383, instance_loss: 0.2746, weighted_loss: 0.1092, label: 0, bag_size: 399
batch 519, loss: 0.7129, instance_loss: 0.5170, weighted_loss: 0.6541, label: 0, bag_size: 183
batch 539, loss: 0.7509, instance_loss: 0.4570, weighted_loss: 0.6627, label: 4, bag_size: 776
batch 559, loss: 1.0513, instance_loss: 0.4219, weighted_loss: 0.8625, label: 2, bag_size: 363
batch 579, loss: 2.3573, instance_loss: 0.4739, weighted_loss: 1.7923, label: 2, bag_size: 720


class 0 clustering acc 0.9959175084175084: correct 23663/23760
class 1 clustering acc 0.05534511784511784: correct 263/4752
Epoch: 45, train_loss: 1.0138, train_clustering_loss:  0.4766, train_error: 0.4209
class 0: acc 0.8307692307692308, correct 108/130
class 1: acc 0.3888888888888889, correct 42/108
class 2: acc 0.4921875, correct 63/128
class 3: acc 0.543859649122807, correct 62/114
class 4: acc 0.6052631578947368, correct 69/114

Val Set, val_loss: 1.5996, val_error: 0.5676, auc: 0.7761
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.018581081081081082: correct 11/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.2587, instance_loss: 0.5309, weighted_loss: 1.0403, label: 3, bag_size: 1358
batch 39, loss: 0.6545, instance_loss: 0.4799, weighted_loss: 0.6021, label: 3, bag_size: 737
batch 59, loss: 0.9262, instance_loss: 0.7369, weighted_loss: 0.8694, label: 1, bag_size: 1497
batch 79, loss: 0.3962, instance_loss: 0.4111, weighted_loss: 0.4007, label: 0, bag_size: 97
batch 99, loss: 0.6984, instance_loss: 0.4085, weighted_loss: 0.6115, label: 2, bag_size: 549
batch 119, loss: 1.3253, instance_loss: 0.4645, weighted_loss: 1.0671, label: 1, bag_size: 697
batch 139, loss: 0.0534, instance_loss: 0.3662, weighted_loss: 0.1472, label: 0, bag_size: 74
batch 159, loss: 0.0067, instance_loss: 0.2383, weighted_loss: 0.0762, label: 0, bag_size: 98
batch 179, loss: 0.0390, instance_loss: 0.2840, weighted_loss: 0.1125, label: 0, bag_size: 98
batch 199, loss: 0.1029, instance_loss: 0.3488, weighted_loss: 0.1767, label: 4, bag_size: 773
batch 219, loss: 1.1233, instance_loss: 0.6248, weighted_loss: 0.9738, label: 1, bag_size: 44
batch 239, loss: 2.6091, instance_loss: 0.6189, weighted_loss: 2.0121, label: 4, bag_size: 685
batch 259, loss: 0.6506, instance_loss: 0.4384, weighted_loss: 0.5869, label: 4, bag_size: 689
batch 279, loss: 1.2948, instance_loss: 0.4939, weighted_loss: 1.0545, label: 2, bag_size: 799
batch 299, loss: 0.7060, instance_loss: 0.4149, weighted_loss: 0.6186, label: 2, bag_size: 781
batch 319, loss: 0.8141, instance_loss: 0.4232, weighted_loss: 0.6969, label: 2, bag_size: 781
batch 339, loss: 0.4983, instance_loss: 0.4157, weighted_loss: 0.4735, label: 2, bag_size: 572
batch 359, loss: 0.6295, instance_loss: 0.3766, weighted_loss: 0.5536, label: 2, bag_size: 690
batch 379, loss: 2.2266, instance_loss: 0.6488, weighted_loss: 1.7533, label: 3, bag_size: 107
batch 399, loss: 0.5348, instance_loss: 0.4673, weighted_loss: 0.5146, label: 1, bag_size: 460
batch 419, loss: 2.1698, instance_loss: 0.5195, weighted_loss: 1.6747, label: 3, bag_size: 393
batch 439, loss: 0.9886, instance_loss: 0.4865, weighted_loss: 0.8380, label: 1, bag_size: 221
batch 459, loss: 1.0367, instance_loss: 0.5155, weighted_loss: 0.8803, label: 1, bag_size: 972
batch 479, loss: 0.4094, instance_loss: 0.4732, weighted_loss: 0.4286, label: 0, bag_size: 258
batch 499, loss: 1.6436, instance_loss: 0.6760, weighted_loss: 1.3534, label: 2, bag_size: 96
batch 519, loss: 1.5787, instance_loss: 0.5187, weighted_loss: 1.2607, label: 1, bag_size: 208
batch 539, loss: 1.1347, instance_loss: 0.4265, weighted_loss: 0.9222, label: 2, bag_size: 549
batch 559, loss: 2.3848, instance_loss: 0.5436, weighted_loss: 1.8324, label: 3, bag_size: 166
batch 579, loss: 1.7695, instance_loss: 0.6988, weighted_loss: 1.4483, label: 0, bag_size: 311


class 0 clustering acc 0.9964225589225589: correct 23675/23760
class 1 clustering acc 0.04313973063973064: correct 205/4752
Epoch: 46, train_loss: 1.0659, train_clustering_loss:  0.4834, train_error: 0.4545
class 0: acc 0.7844827586206896, correct 91/116
class 1: acc 0.4358974358974359, correct 51/117
class 2: acc 0.46923076923076923, correct 61/130
class 3: acc 0.4, correct 44/110
class 4: acc 0.6363636363636364, correct 77/121

Val Set, val_loss: 1.6040, val_error: 0.5405, auc: 0.8121
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.9696, instance_loss: 0.4785, weighted_loss: 0.8223, label: 1, bag_size: 1013
batch 39, loss: 1.4155, instance_loss: 0.5100, weighted_loss: 1.1438, label: 2, bag_size: 582
batch 59, loss: 0.8038, instance_loss: 0.6575, weighted_loss: 0.7599, label: 3, bag_size: 228
batch 79, loss: 0.9876, instance_loss: 0.5555, weighted_loss: 0.8580, label: 4, bag_size: 886
batch 99, loss: 0.1370, instance_loss: 0.3778, weighted_loss: 0.2092, label: 0, bag_size: 297
batch 119, loss: 0.9845, instance_loss: 0.4472, weighted_loss: 0.8233, label: 2, bag_size: 998
batch 139, loss: 0.4928, instance_loss: 0.4138, weighted_loss: 0.4691, label: 2, bag_size: 613
batch 159, loss: 1.9877, instance_loss: 0.4923, weighted_loss: 1.5391, label: 3, bag_size: 598
batch 179, loss: 1.2755, instance_loss: 0.5212, weighted_loss: 1.0492, label: 2, bag_size: 906
batch 199, loss: 1.2644, instance_loss: 0.5076, weighted_loss: 1.0373, label: 2, bag_size: 605
batch 219, loss: 0.5263, instance_loss: 0.4204, weighted_loss: 0.4945, label: 4, bag_size: 744
batch 239, loss: 2.3234, instance_loss: 0.5821, weighted_loss: 1.8010, label: 3, bag_size: 235
batch 259, loss: 0.8187, instance_loss: 0.5043, weighted_loss: 0.7244, label: 2, bag_size: 285
batch 279, loss: 1.5869, instance_loss: 0.5893, weighted_loss: 1.2876, label: 3, bag_size: 390
batch 299, loss: 0.8825, instance_loss: 0.5333, weighted_loss: 0.7777, label: 4, bag_size: 377
batch 319, loss: 1.0678, instance_loss: 0.4689, weighted_loss: 0.8881, label: 2, bag_size: 348
batch 339, loss: 0.9815, instance_loss: 0.4852, weighted_loss: 0.8326, label: 3, bag_size: 631
batch 359, loss: 0.8435, instance_loss: 0.6212, weighted_loss: 0.7768, label: 3, bag_size: 398
batch 379, loss: 0.5760, instance_loss: 0.5132, weighted_loss: 0.5571, label: 2, bag_size: 25
batch 399, loss: 0.7063, instance_loss: 0.4697, weighted_loss: 0.6353, label: 3, bag_size: 830
batch 419, loss: 0.0090, instance_loss: 0.3051, weighted_loss: 0.0978, label: 0, bag_size: 285
batch 439, loss: 1.2124, instance_loss: 0.5983, weighted_loss: 1.0282, label: 2, bag_size: 303
batch 459, loss: 1.4327, instance_loss: 0.4878, weighted_loss: 1.1493, label: 0, bag_size: 581
batch 479, loss: 0.0462, instance_loss: 0.2570, weighted_loss: 0.1094, label: 0, bag_size: 97
batch 499, loss: 0.0976, instance_loss: 0.3476, weighted_loss: 0.1726, label: 0, bag_size: 227
batch 519, loss: 2.2823, instance_loss: 0.6208, weighted_loss: 1.7838, label: 3, bag_size: 533
batch 539, loss: 0.9962, instance_loss: 0.4646, weighted_loss: 0.8367, label: 3, bag_size: 872
batch 559, loss: 0.0434, instance_loss: 0.4455, weighted_loss: 0.1640, label: 0, bag_size: 732
batch 579, loss: 1.6146, instance_loss: 0.6502, weighted_loss: 1.3253, label: 3, bag_size: 107


class 0 clustering acc 0.9980639730639731: correct 23714/23760
class 1 clustering acc 0.041877104377104374: correct 199/4752
Epoch: 47, train_loss: 0.9983, train_clustering_loss:  0.4786, train_error: 0.4310
class 0: acc 0.8156028368794326, correct 115/141
class 1: acc 0.41379310344827586, correct 48/116
class 2: acc 0.4864864864864865, correct 54/111
class 3: acc 0.5, correct 62/124
class 4: acc 0.5784313725490197, correct 59/102

Val Set, val_loss: 1.7430, val_error: 0.5676, auc: 0.7791
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.42857142857142855, correct 6/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.2009, instance_loss: 0.4794, weighted_loss: 0.9845, label: 1, bag_size: 949
batch 39, loss: 0.9460, instance_loss: 0.5126, weighted_loss: 0.8160, label: 1, bag_size: 483
batch 59, loss: 0.0106, instance_loss: 0.2727, weighted_loss: 0.0892, label: 0, bag_size: 218
batch 79, loss: 1.0182, instance_loss: 0.4814, weighted_loss: 0.8571, label: 3, bag_size: 739
batch 99, loss: 2.0756, instance_loss: 0.5134, weighted_loss: 1.6069, label: 3, bag_size: 337
batch 119, loss: 3.1097, instance_loss: 0.6441, weighted_loss: 2.3700, label: 2, bag_size: 549
batch 139, loss: 0.7090, instance_loss: 0.7325, weighted_loss: 0.7160, label: 1, bag_size: 44
batch 159, loss: 1.8200, instance_loss: 0.7002, weighted_loss: 1.4841, label: 4, bag_size: 699
batch 179, loss: 1.9256, instance_loss: 0.5392, weighted_loss: 1.5097, label: 2, bag_size: 398
batch 199, loss: 0.0016, instance_loss: 0.3546, weighted_loss: 0.1075, label: 0, bag_size: 340
batch 219, loss: 1.5398, instance_loss: 0.5793, weighted_loss: 1.2517, label: 3, bag_size: 500
batch 239, loss: 1.4146, instance_loss: 0.5586, weighted_loss: 1.1578, label: 1, bag_size: 106
batch 259, loss: 0.0183, instance_loss: 0.2803, weighted_loss: 0.0969, label: 0, bag_size: 357
batch 279, loss: 0.3043, instance_loss: 0.4639, weighted_loss: 0.3522, label: 1, bag_size: 490
batch 299, loss: 2.9401, instance_loss: 0.6168, weighted_loss: 2.2431, label: 2, bag_size: 829
batch 319, loss: 2.3798, instance_loss: 0.6489, weighted_loss: 1.8605, label: 3, bag_size: 681
batch 339, loss: 0.2720, instance_loss: 0.3209, weighted_loss: 0.2867, label: 0, bag_size: 282
batch 359, loss: 0.8822, instance_loss: 0.5717, weighted_loss: 0.7890, label: 3, bag_size: 928
batch 379, loss: 0.0846, instance_loss: 0.2845, weighted_loss: 0.1446, label: 0, bag_size: 79
batch 399, loss: 0.1213, instance_loss: 0.3456, weighted_loss: 0.1885, label: 0, bag_size: 122
batch 419, loss: 0.6150, instance_loss: 0.3728, weighted_loss: 0.5424, label: 2, bag_size: 244
batch 439, loss: 1.6557, instance_loss: 0.5775, weighted_loss: 1.3323, label: 4, bag_size: 476
batch 459, loss: 0.0012, instance_loss: 0.1758, weighted_loss: 0.0536, label: 0, bag_size: 236
batch 479, loss: 1.2296, instance_loss: 0.5245, weighted_loss: 1.0181, label: 1, bag_size: 201
batch 499, loss: 0.0165, instance_loss: 0.2252, weighted_loss: 0.0792, label: 0, bag_size: 370
batch 519, loss: 0.0244, instance_loss: 0.2402, weighted_loss: 0.0892, label: 0, bag_size: 74
batch 539, loss: 1.3770, instance_loss: 0.5825, weighted_loss: 1.1386, label: 2, bag_size: 860
batch 559, loss: 0.0123, instance_loss: 0.1328, weighted_loss: 0.0485, label: 0, bag_size: 212
batch 579, loss: 0.7161, instance_loss: 0.4707, weighted_loss: 0.6425, label: 2, bag_size: 119


class 0 clustering acc 0.9957491582491582: correct 23659/23760
class 1 clustering acc 0.0723905723905724: correct 344/4752
Epoch: 48, train_loss: 0.9441, train_clustering_loss:  0.4683, train_error: 0.4057
class 0: acc 0.8591549295774648, correct 122/142
class 1: acc 0.4827586206896552, correct 56/116
class 2: acc 0.43478260869565216, correct 50/115
class 3: acc 0.6086956521739131, correct 70/115
class 4: acc 0.5188679245283019, correct 55/106

Val Set, val_loss: 1.9155, val_error: 0.5270, auc: 0.7986
class 0 clustering acc 0.9962837837837838: correct 2949/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2737, instance_loss: 0.6156, weighted_loss: 0.3763, label: 1, bag_size: 371
batch 39, loss: 1.9833, instance_loss: 0.5811, weighted_loss: 1.5626, label: 1, bag_size: 525
batch 59, loss: 1.0723, instance_loss: 0.4500, weighted_loss: 0.8856, label: 2, bag_size: 549
batch 79, loss: 0.6493, instance_loss: 0.4776, weighted_loss: 0.5978, label: 2, bag_size: 614
batch 99, loss: 0.3335, instance_loss: 0.3458, weighted_loss: 0.3372, label: 4, bag_size: 520
batch 119, loss: 0.3809, instance_loss: 0.2975, weighted_loss: 0.3559, label: 4, bag_size: 266
batch 139, loss: 1.1393, instance_loss: 0.5790, weighted_loss: 0.9712, label: 1, bag_size: 398
batch 159, loss: 1.1037, instance_loss: 0.4722, weighted_loss: 0.9142, label: 1, bag_size: 389
batch 179, loss: 2.0664, instance_loss: 0.6379, weighted_loss: 1.6378, label: 0, bag_size: 732
batch 199, loss: 0.9796, instance_loss: 0.5271, weighted_loss: 0.8439, label: 1, bag_size: 161
batch 219, loss: 2.3875, instance_loss: 0.6584, weighted_loss: 1.8688, label: 2, bag_size: 208
batch 239, loss: 1.1178, instance_loss: 0.5166, weighted_loss: 0.9375, label: 3, bag_size: 474
batch 259, loss: 0.0262, instance_loss: 0.2836, weighted_loss: 0.1034, label: 0, bag_size: 351
batch 279, loss: 0.0936, instance_loss: 0.3113, weighted_loss: 0.1589, label: 0, bag_size: 354
batch 299, loss: 0.0675, instance_loss: 0.2048, weighted_loss: 0.1087, label: 0, bag_size: 210
batch 319, loss: 0.7153, instance_loss: 0.4873, weighted_loss: 0.6469, label: 3, bag_size: 737
batch 339, loss: 1.1810, instance_loss: 0.5740, weighted_loss: 0.9989, label: 1, bag_size: 422
batch 359, loss: 0.7015, instance_loss: 0.5525, weighted_loss: 0.6568, label: 4, bag_size: 260
batch 379, loss: 0.2430, instance_loss: 0.4355, weighted_loss: 0.3008, label: 1, bag_size: 113
batch 399, loss: 0.9274, instance_loss: 0.4680, weighted_loss: 0.7896, label: 4, bag_size: 604
batch 419, loss: 0.9549, instance_loss: 0.4952, weighted_loss: 0.8170, label: 1, bag_size: 408
batch 439, loss: 1.2628, instance_loss: 0.5963, weighted_loss: 1.0629, label: 0, bag_size: 247
batch 459, loss: 0.0887, instance_loss: 0.2379, weighted_loss: 0.1335, label: 0, bag_size: 493
batch 479, loss: 0.4914, instance_loss: 0.4694, weighted_loss: 0.4848, label: 4, bag_size: 218
batch 499, loss: 0.6619, instance_loss: 0.5321, weighted_loss: 0.6230, label: 4, bag_size: 1064
batch 519, loss: 0.4770, instance_loss: 0.5111, weighted_loss: 0.4873, label: 4, bag_size: 923
batch 539, loss: 1.2869, instance_loss: 0.4690, weighted_loss: 1.0416, label: 1, bag_size: 525
batch 559, loss: 0.1493, instance_loss: 0.2641, weighted_loss: 0.1838, label: 0, bag_size: 231
batch 579, loss: 1.3922, instance_loss: 0.5437, weighted_loss: 1.1376, label: 3, bag_size: 523


class 0 clustering acc 0.9956649831649832: correct 23657/23760
class 1 clustering acc 0.045244107744107746: correct 215/4752
Epoch: 49, train_loss: 1.0231, train_clustering_loss:  0.4806, train_error: 0.4579
class 0: acc 0.8181818181818182, correct 99/121
class 1: acc 0.4806201550387597, correct 62/129
class 2: acc 0.2894736842105263, correct 33/114
class 3: acc 0.5537190082644629, correct 67/121
class 4: acc 0.5596330275229358, correct 61/109

Val Set, val_loss: 1.7594, val_error: 0.5946, auc: 0.8108
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.14285714285714285, correct 2/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6917, instance_loss: 0.4856, weighted_loss: 0.6298, label: 2, bag_size: 348
batch 39, loss: 0.4809, instance_loss: 0.4626, weighted_loss: 0.4754, label: 3, bag_size: 684
batch 59, loss: 6.0054, instance_loss: 0.9076, weighted_loss: 4.4761, label: 3, bag_size: 1057
batch 79, loss: 2.4452, instance_loss: 0.6334, weighted_loss: 1.9017, label: 4, bag_size: 101
batch 99, loss: 0.7260, instance_loss: 0.3888, weighted_loss: 0.6248, label: 0, bag_size: 224
batch 119, loss: 2.0684, instance_loss: 0.5466, weighted_loss: 1.6118, label: 2, bag_size: 549
batch 139, loss: 4.9569, instance_loss: 0.6900, weighted_loss: 3.6768, label: 4, bag_size: 395
batch 159, loss: 0.3048, instance_loss: 0.5667, weighted_loss: 0.3834, label: 4, bag_size: 101
batch 179, loss: 0.8926, instance_loss: 0.4454, weighted_loss: 0.7584, label: 1, bag_size: 906
batch 199, loss: 0.9177, instance_loss: 0.4345, weighted_loss: 0.7728, label: 2, bag_size: 731
batch 219, loss: 0.8056, instance_loss: 0.4676, weighted_loss: 0.7042, label: 1, bag_size: 702
batch 239, loss: 2.3765, instance_loss: 0.5953, weighted_loss: 1.8422, label: 3, bag_size: 453
batch 259, loss: 1.3626, instance_loss: 0.4634, weighted_loss: 1.0928, label: 2, bag_size: 1016
batch 279, loss: 0.6975, instance_loss: 0.4884, weighted_loss: 0.6348, label: 3, bag_size: 857
batch 299, loss: 1.1208, instance_loss: 0.5534, weighted_loss: 0.9506, label: 3, bag_size: 492
batch 319, loss: 0.7812, instance_loss: 0.3632, weighted_loss: 0.6558, label: 2, bag_size: 470
batch 339, loss: 0.4141, instance_loss: 0.5199, weighted_loss: 0.4458, label: 4, bag_size: 231
batch 359, loss: 0.0723, instance_loss: 0.3784, weighted_loss: 0.1641, label: 0, bag_size: 33
batch 379, loss: 0.2289, instance_loss: 0.4722, weighted_loss: 0.3019, label: 1, bag_size: 311
batch 399, loss: 1.5635, instance_loss: 0.5798, weighted_loss: 1.2684, label: 2, bag_size: 909
batch 419, loss: 0.8204, instance_loss: 0.4673, weighted_loss: 0.7145, label: 3, bag_size: 505
batch 439, loss: 0.2781, instance_loss: 0.4829, weighted_loss: 0.3395, label: 4, bag_size: 725
batch 459, loss: 0.0873, instance_loss: 0.3267, weighted_loss: 0.1591, label: 0, bag_size: 49
batch 479, loss: 1.1148, instance_loss: 0.4424, weighted_loss: 0.9131, label: 2, bag_size: 375
batch 499, loss: 1.5619, instance_loss: 0.5194, weighted_loss: 1.2491, label: 4, bag_size: 757
batch 519, loss: 0.7011, instance_loss: 0.4076, weighted_loss: 0.6130, label: 2, bag_size: 402
batch 539, loss: 0.7101, instance_loss: 0.3944, weighted_loss: 0.6154, label: 3, bag_size: 982
batch 559, loss: 1.5772, instance_loss: 0.6000, weighted_loss: 1.2840, label: 4, bag_size: 589
batch 579, loss: 0.8711, instance_loss: 0.4304, weighted_loss: 0.7389, label: 4, bag_size: 333


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.0361952861952862: correct 172/4752
Epoch: 50, train_loss: 1.0461, train_clustering_loss:  0.4832, train_error: 0.4562
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.33035714285714285, correct 37/112
class 2: acc 0.416, correct 52/125
class 3: acc 0.5982142857142857, correct 67/112
class 4: acc 0.5630252100840336, correct 67/119

Val Set, val_loss: 1.7455, val_error: 0.5405, auc: 0.8092
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02364864864864865: correct 14/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0289, instance_loss: 0.2742, weighted_loss: 0.1024, label: 0, bag_size: 218
batch 39, loss: 0.0157, instance_loss: 0.2254, weighted_loss: 0.0786, label: 0, bag_size: 88
batch 59, loss: 1.3025, instance_loss: 0.5423, weighted_loss: 1.0744, label: 0, bag_size: 230
batch 79, loss: 0.9326, instance_loss: 0.4106, weighted_loss: 0.7760, label: 3, bag_size: 1154
batch 99, loss: 0.8570, instance_loss: 0.6602, weighted_loss: 0.7979, label: 0, bag_size: 613
batch 119, loss: 1.3215, instance_loss: 0.5218, weighted_loss: 1.0816, label: 3, bag_size: 431
batch 139, loss: 1.1014, instance_loss: 0.4767, weighted_loss: 0.9140, label: 3, bag_size: 1154
batch 159, loss: 0.3071, instance_loss: 0.4216, weighted_loss: 0.3415, label: 4, bag_size: 744
batch 179, loss: 0.0204, instance_loss: 0.2104, weighted_loss: 0.0774, label: 0, bag_size: 192
batch 199, loss: 1.3232, instance_loss: 0.4790, weighted_loss: 1.0699, label: 3, bag_size: 364
batch 219, loss: 0.0024, instance_loss: 0.2338, weighted_loss: 0.0718, label: 0, bag_size: 340
batch 239, loss: 0.6088, instance_loss: 0.4803, weighted_loss: 0.5703, label: 4, bag_size: 520
batch 259, loss: 1.5515, instance_loss: 0.5760, weighted_loss: 1.2588, label: 4, bag_size: 862
batch 279, loss: 0.8545, instance_loss: 0.4495, weighted_loss: 0.7330, label: 3, bag_size: 282
batch 299, loss: 0.1510, instance_loss: 0.3233, weighted_loss: 0.2027, label: 4, bag_size: 948
batch 319, loss: 0.3747, instance_loss: 0.4033, weighted_loss: 0.3833, label: 4, bag_size: 875
batch 339, loss: 1.1006, instance_loss: 0.5566, weighted_loss: 0.9374, label: 3, bag_size: 795
batch 359, loss: 1.3508, instance_loss: 0.4726, weighted_loss: 1.0874, label: 2, bag_size: 906
batch 379, loss: 2.8255, instance_loss: 0.6201, weighted_loss: 2.1639, label: 2, bag_size: 1308
batch 399, loss: 0.6595, instance_loss: 0.5131, weighted_loss: 0.6156, label: 1, bag_size: 184
batch 419, loss: 0.1070, instance_loss: 0.4317, weighted_loss: 0.2044, label: 0, bag_size: 397
batch 439, loss: 1.1060, instance_loss: 0.4440, weighted_loss: 0.9074, label: 1, bag_size: 381
batch 459, loss: 1.4401, instance_loss: 0.4825, weighted_loss: 1.1528, label: 2, bag_size: 1016
batch 479, loss: 0.2671, instance_loss: 0.4398, weighted_loss: 0.3189, label: 4, bag_size: 506
batch 499, loss: 1.6163, instance_loss: 0.4628, weighted_loss: 1.2702, label: 4, bag_size: 740
batch 519, loss: 0.4818, instance_loss: 0.3840, weighted_loss: 0.4524, label: 4, bag_size: 1018
batch 539, loss: 1.4282, instance_loss: 0.5453, weighted_loss: 1.1633, label: 3, bag_size: 337
batch 559, loss: 0.0460, instance_loss: 0.2787, weighted_loss: 0.1158, label: 0, bag_size: 282
batch 579, loss: 0.0086, instance_loss: 0.1676, weighted_loss: 0.0563, label: 0, bag_size: 74


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.04861111111111111: correct 231/4752
Epoch: 51, train_loss: 0.9382, train_clustering_loss:  0.4707, train_error: 0.4057
class 0: acc 0.8365384615384616, correct 87/104
class 1: acc 0.4298245614035088, correct 49/114
class 2: acc 0.42105263157894735, correct 48/114
class 3: acc 0.5939849624060151, correct 79/133
class 4: acc 0.6976744186046512, correct 90/129

Val Set, val_loss: 1.9596, val_error: 0.5541, auc: 0.8230
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.04222972972972973: correct 25/592
class 0: acc 0.4375, correct 7/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 21 out of 20
Early stopping
Val error: 0.4865, ROC AUC: 0.8251
Test error: 0.5811, ROC AUC: 0.7602
class 0: acc 0.625, correct 10/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 594 samples
Validating on 74 samples
Testing on 74 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Res3x2(
      (Attn_Net): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_1): Attn_Net_Gated_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Double_1): Attn_Net_Double_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (Attn_Net_Triple_1): Attn_Net_Triple_Without_Fc(
        (attention_a): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_b): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_c): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_d): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_e): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Tanh()
          (2): Dropout(p=0.25, inplace=False)
        )
        (attention_f): Sequential(
          (0): Linear(in_features=512, out_features=256, bias=True)
          (1): Sigmoid()
          (2): Dropout(p=0.25, inplace=False)
        )
      )
      (parallel_linear): Parallel_Linear()
    )
  )
  (classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 5268013
Total number of trainable parameters: 5268013

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9866, instance_loss: 0.6090, weighted_loss: 1.5733, label: 1, bag_size: 855
batch 39, loss: 2.5157, instance_loss: 0.5382, weighted_loss: 1.9224, label: 2, bag_size: 219
batch 59, loss: 1.8433, instance_loss: 0.5361, weighted_loss: 1.4512, label: 3, bag_size: 312
batch 79, loss: 0.9849, instance_loss: 0.5567, weighted_loss: 0.8564, label: 1, bag_size: 829
batch 99, loss: 2.3774, instance_loss: 0.5201, weighted_loss: 1.8202, label: 2, bag_size: 331
batch 119, loss: 0.8444, instance_loss: 0.4567, weighted_loss: 0.7281, label: 3, bag_size: 300
batch 139, loss: 1.2873, instance_loss: 0.4964, weighted_loss: 1.0500, label: 2, bag_size: 543
batch 159, loss: 2.1747, instance_loss: 0.5793, weighted_loss: 1.6961, label: 2, bag_size: 363
batch 179, loss: 1.6734, instance_loss: 0.5379, weighted_loss: 1.3328, label: 3, bag_size: 856
batch 199, loss: 2.0135, instance_loss: 0.5339, weighted_loss: 1.5696, label: 2, bag_size: 549
batch 219, loss: 0.5929, instance_loss: 0.5248, weighted_loss: 0.5725, label: 0, bag_size: 295
batch 239, loss: 1.4740, instance_loss: 0.5411, weighted_loss: 1.1941, label: 4, bag_size: 329
batch 259, loss: 1.2082, instance_loss: 0.5779, weighted_loss: 1.0191, label: 0, bag_size: 295
batch 279, loss: 1.5509, instance_loss: 0.4891, weighted_loss: 1.2324, label: 4, bag_size: 862
batch 299, loss: 0.3986, instance_loss: 0.4500, weighted_loss: 0.4140, label: 0, bag_size: 268
batch 319, loss: 1.4013, instance_loss: 0.5580, weighted_loss: 1.1483, label: 3, bag_size: 603
batch 339, loss: 1.8371, instance_loss: 0.5201, weighted_loss: 1.4420, label: 1, bag_size: 355
batch 359, loss: 1.5792, instance_loss: 0.4969, weighted_loss: 1.2545, label: 4, bag_size: 780
batch 379, loss: 1.7709, instance_loss: 0.5278, weighted_loss: 1.3980, label: 2, bag_size: 582
batch 399, loss: 1.1053, instance_loss: 0.6222, weighted_loss: 0.9604, label: 0, bag_size: 400
batch 419, loss: 2.1272, instance_loss: 0.5614, weighted_loss: 1.6575, label: 1, bag_size: 391
batch 439, loss: 2.5513, instance_loss: 0.6196, weighted_loss: 1.9718, label: 0, bag_size: 273
batch 459, loss: 0.9033, instance_loss: 0.4990, weighted_loss: 0.7820, label: 1, bag_size: 208
batch 479, loss: 1.9148, instance_loss: 0.4503, weighted_loss: 1.4755, label: 0, bag_size: 62
batch 499, loss: 3.0459, instance_loss: 0.5584, weighted_loss: 2.2997, label: 3, bag_size: 282
batch 519, loss: 0.9939, instance_loss: 0.3992, weighted_loss: 0.8155, label: 1, bag_size: 591
batch 539, loss: 1.1838, instance_loss: 0.5709, weighted_loss: 0.9999, label: 3, bag_size: 956
batch 559, loss: 1.2636, instance_loss: 0.4794, weighted_loss: 1.0284, label: 4, bag_size: 731
batch 579, loss: 1.4535, instance_loss: 0.5444, weighted_loss: 1.1808, label: 2, bag_size: 25


class 0 clustering acc 0.9983164983164983: correct 23720/23760
class 1 clustering acc 0.001473063973063973: correct 7/4752
Epoch: 0, train_loss: 1.5302, train_clustering_loss:  0.5230, train_error: 0.6582
class 0: acc 0.6929824561403509, correct 79/114
class 1: acc 0.34615384615384615, correct 45/130
class 2: acc 0.15384615384615385, correct 18/117
class 3: acc 0.24786324786324787, correct 29/117
class 4: acc 0.27586206896551724, correct 32/116

Val Set, val_loss: 1.4069, val_error: 0.6081, auc: 0.7277
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.0, correct 0/14
Validation loss decreased (inf --> 1.406868).  Saving model ...


batch 19, loss: 1.8956, instance_loss: 0.5672, weighted_loss: 1.4971, label: 3, bag_size: 245
batch 39, loss: 1.7266, instance_loss: 0.5599, weighted_loss: 1.3766, label: 0, bag_size: 178
batch 59, loss: 1.1105, instance_loss: 0.5021, weighted_loss: 0.9280, label: 0, bag_size: 428
batch 79, loss: 1.3845, instance_loss: 0.4753, weighted_loss: 1.1118, label: 2, bag_size: 488
batch 99, loss: 1.1377, instance_loss: 0.4398, weighted_loss: 0.9283, label: 2, bag_size: 799
batch 119, loss: 1.5463, instance_loss: 0.5451, weighted_loss: 1.2460, label: 1, bag_size: 159
batch 139, loss: 0.9656, instance_loss: 0.4764, weighted_loss: 0.8188, label: 1, bag_size: 329
batch 159, loss: 1.2758, instance_loss: 0.5448, weighted_loss: 1.0565, label: 4, bag_size: 703
batch 179, loss: 3.0233, instance_loss: 0.6832, weighted_loss: 2.3213, label: 0, bag_size: 492
batch 199, loss: 0.2169, instance_loss: 0.3806, weighted_loss: 0.2660, label: 0, bag_size: 238
batch 219, loss: 1.3443, instance_loss: 0.4646, weighted_loss: 1.0804, label: 0, bag_size: 888
batch 239, loss: 2.6251, instance_loss: 0.6511, weighted_loss: 2.0329, label: 2, bag_size: 812
batch 259, loss: 1.4856, instance_loss: 0.4897, weighted_loss: 1.1868, label: 1, bag_size: 564
batch 279, loss: 0.3122, instance_loss: 0.3553, weighted_loss: 0.3251, label: 0, bag_size: 51
batch 299, loss: 2.9099, instance_loss: 0.6190, weighted_loss: 2.2227, label: 3, bag_size: 282
batch 319, loss: 0.3008, instance_loss: 0.4126, weighted_loss: 0.3343, label: 0, bag_size: 63
batch 339, loss: 0.8093, instance_loss: 0.4602, weighted_loss: 0.7046, label: 0, bag_size: 642
batch 359, loss: 1.1359, instance_loss: 0.4956, weighted_loss: 0.9438, label: 4, bag_size: 503
batch 379, loss: 1.0631, instance_loss: 0.4562, weighted_loss: 0.8810, label: 3, bag_size: 235
batch 399, loss: 1.3063, instance_loss: 0.5189, weighted_loss: 1.0701, label: 4, bag_size: 233
batch 419, loss: 1.2436, instance_loss: 0.5525, weighted_loss: 1.0363, label: 1, bag_size: 311
batch 439, loss: 1.0637, instance_loss: 0.4891, weighted_loss: 0.8913, label: 4, bag_size: 730
batch 459, loss: 2.5725, instance_loss: 0.5158, weighted_loss: 1.9555, label: 0, bag_size: 62
batch 479, loss: 0.9972, instance_loss: 0.5422, weighted_loss: 0.8607, label: 4, bag_size: 432
batch 499, loss: 0.3545, instance_loss: 0.4012, weighted_loss: 0.3685, label: 0, bag_size: 97
batch 519, loss: 1.0965, instance_loss: 0.4530, weighted_loss: 0.9035, label: 2, bag_size: 1308
batch 539, loss: 0.1724, instance_loss: 0.4088, weighted_loss: 0.2433, label: 0, bag_size: 340
batch 559, loss: 1.4720, instance_loss: 0.4972, weighted_loss: 1.1796, label: 3, bag_size: 1060
batch 579, loss: 1.5070, instance_loss: 0.4899, weighted_loss: 1.2018, label: 2, bag_size: 746


class 0 clustering acc 1.0: correct 23760/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 1, train_loss: 1.4316, train_clustering_loss:  0.5064, train_error: 0.6431
class 0: acc 0.7563025210084033, correct 90/119
class 1: acc 0.17054263565891473, correct 22/129
class 2: acc 0.29464285714285715, correct 33/112
class 3: acc 0.30158730158730157, correct 38/126
class 4: acc 0.26851851851851855, correct 29/108

Val Set, val_loss: 1.4128, val_error: 0.6081, auc: 0.7069
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.9285714285714286, correct 13/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1692, instance_loss: 0.4863, weighted_loss: 0.9643, label: 3, bag_size: 474
batch 39, loss: 0.9551, instance_loss: 0.4646, weighted_loss: 0.8079, label: 1, bag_size: 534
batch 59, loss: 2.3707, instance_loss: 0.5751, weighted_loss: 1.8320, label: 2, bag_size: 337
batch 79, loss: 0.3390, instance_loss: 0.3654, weighted_loss: 0.3469, label: 0, bag_size: 230
batch 99, loss: 2.2489, instance_loss: 0.5754, weighted_loss: 1.7468, label: 4, bag_size: 101
batch 119, loss: 1.6744, instance_loss: 0.5107, weighted_loss: 1.3253, label: 1, bag_size: 391
batch 139, loss: 1.0678, instance_loss: 0.4223, weighted_loss: 0.8742, label: 3, bag_size: 369
batch 159, loss: 1.5690, instance_loss: 0.5991, weighted_loss: 1.2780, label: 4, bag_size: 46
batch 179, loss: 1.7912, instance_loss: 0.4532, weighted_loss: 1.3898, label: 1, bag_size: 389
batch 199, loss: 1.6774, instance_loss: 0.4931, weighted_loss: 1.3221, label: 1, bag_size: 669
batch 219, loss: 0.7517, instance_loss: 0.4000, weighted_loss: 0.6462, label: 0, bag_size: 73
batch 239, loss: 1.3822, instance_loss: 0.4837, weighted_loss: 1.1127, label: 4, bag_size: 690
batch 259, loss: 1.4533, instance_loss: 0.5564, weighted_loss: 1.1842, label: 3, bag_size: 603
batch 279, loss: 1.4910, instance_loss: 0.5022, weighted_loss: 1.1944, label: 1, bag_size: 490
batch 299, loss: 0.9930, instance_loss: 0.5183, weighted_loss: 0.8506, label: 0, bag_size: 615
batch 319, loss: 1.5758, instance_loss: 0.4562, weighted_loss: 1.2399, label: 3, bag_size: 428
batch 339, loss: 2.4607, instance_loss: 0.5849, weighted_loss: 1.8980, label: 4, bag_size: 771
batch 359, loss: 1.1333, instance_loss: 0.4672, weighted_loss: 0.9334, label: 1, bag_size: 271
batch 379, loss: 1.3678, instance_loss: 0.4391, weighted_loss: 1.0892, label: 3, bag_size: 830
batch 399, loss: 1.5286, instance_loss: 0.5497, weighted_loss: 1.2349, label: 2, bag_size: 567
batch 419, loss: 2.3760, instance_loss: 0.6402, weighted_loss: 1.8553, label: 4, bag_size: 490
batch 439, loss: 0.5964, instance_loss: 0.4699, weighted_loss: 0.5584, label: 0, bag_size: 288
batch 459, loss: 1.5145, instance_loss: 0.5106, weighted_loss: 1.2133, label: 2, bag_size: 1060
batch 479, loss: 1.7853, instance_loss: 0.5790, weighted_loss: 1.4234, label: 4, bag_size: 333
batch 499, loss: 1.7969, instance_loss: 0.5478, weighted_loss: 1.4221, label: 4, bag_size: 260
batch 519, loss: 2.1430, instance_loss: 0.6539, weighted_loss: 1.6963, label: 0, bag_size: 243
batch 539, loss: 1.5193, instance_loss: 0.5253, weighted_loss: 1.2211, label: 3, bag_size: 1186
batch 559, loss: 1.7065, instance_loss: 0.5130, weighted_loss: 1.3485, label: 2, bag_size: 582
batch 579, loss: 3.6858, instance_loss: 0.7727, weighted_loss: 2.8119, label: 0, bag_size: 964


class 0 clustering acc 0.9999579124579124: correct 23759/23760
class 1 clustering acc 0.0: correct 0/4752
Epoch: 2, train_loss: 1.3920, train_clustering_loss:  0.5057, train_error: 0.6077
class 0: acc 0.7933884297520661, correct 96/121
class 1: acc 0.2661290322580645, correct 33/124
class 2: acc 0.16363636363636364, correct 18/110
class 3: acc 0.3140495867768595, correct 38/121
class 4: acc 0.4067796610169492, correct 48/118

Val Set, val_loss: 1.3633, val_error: 0.6351, auc: 0.7193
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.406868 --> 1.363255).  Saving model ...


batch 19, loss: 1.7854, instance_loss: 0.5630, weighted_loss: 1.4186, label: 2, bag_size: 864
batch 39, loss: 1.4867, instance_loss: 0.5073, weighted_loss: 1.1929, label: 2, bag_size: 119
batch 59, loss: 0.0589, instance_loss: 0.3220, weighted_loss: 0.1378, label: 0, bag_size: 268
batch 79, loss: 1.6747, instance_loss: 0.5832, weighted_loss: 1.3472, label: 3, bag_size: 1154
batch 99, loss: 1.9089, instance_loss: 0.5480, weighted_loss: 1.5006, label: 1, bag_size: 355
batch 119, loss: 1.6784, instance_loss: 0.5416, weighted_loss: 1.3374, label: 3, bag_size: 899
batch 139, loss: 1.2169, instance_loss: 0.4289, weighted_loss: 0.9805, label: 2, bag_size: 363
batch 159, loss: 2.0204, instance_loss: 0.5300, weighted_loss: 1.5733, label: 4, bag_size: 98
batch 179, loss: 0.9903, instance_loss: 0.4922, weighted_loss: 0.8409, label: 3, bag_size: 956
batch 199, loss: 2.0388, instance_loss: 0.5300, weighted_loss: 1.5861, label: 3, bag_size: 282
batch 219, loss: 2.0187, instance_loss: 0.5392, weighted_loss: 1.5749, label: 4, bag_size: 868
batch 239, loss: 1.5618, instance_loss: 0.5067, weighted_loss: 1.2453, label: 1, bag_size: 672
batch 259, loss: 1.5150, instance_loss: 0.4525, weighted_loss: 1.1962, label: 3, bag_size: 1060
batch 279, loss: 1.1189, instance_loss: 0.4764, weighted_loss: 0.9262, label: 3, bag_size: 451
batch 299, loss: 0.8853, instance_loss: 0.4511, weighted_loss: 0.7550, label: 3, bag_size: 727
batch 319, loss: 1.9025, instance_loss: 0.5033, weighted_loss: 1.4827, label: 1, bag_size: 658
batch 339, loss: 0.4037, instance_loss: 0.3894, weighted_loss: 0.3994, label: 0, bag_size: 97
batch 359, loss: 2.3585, instance_loss: 0.6284, weighted_loss: 1.8395, label: 4, bag_size: 476
batch 379, loss: 1.3344, instance_loss: 0.5392, weighted_loss: 1.0958, label: 1, bag_size: 764
batch 399, loss: 1.0824, instance_loss: 0.5171, weighted_loss: 0.9128, label: 1, bag_size: 544
batch 419, loss: 1.6796, instance_loss: 0.5772, weighted_loss: 1.3489, label: 3, bag_size: 102
batch 439, loss: 0.7222, instance_loss: 0.4494, weighted_loss: 0.6404, label: 0, bag_size: 615
batch 459, loss: 1.6862, instance_loss: 0.5601, weighted_loss: 1.3484, label: 3, bag_size: 1147
batch 479, loss: 1.8922, instance_loss: 0.9532, weighted_loss: 1.6105, label: 0, bag_size: 421
batch 499, loss: 1.3855, instance_loss: 0.5216, weighted_loss: 1.1263, label: 3, bag_size: 856
batch 519, loss: 1.9705, instance_loss: 0.5715, weighted_loss: 1.5508, label: 2, bag_size: 421
batch 539, loss: 1.3782, instance_loss: 0.5292, weighted_loss: 1.1235, label: 1, bag_size: 764
batch 559, loss: 2.2519, instance_loss: 0.6636, weighted_loss: 1.7754, label: 3, bag_size: 520
batch 579, loss: 1.5659, instance_loss: 0.5027, weighted_loss: 1.2469, label: 4, bag_size: 438


class 0 clustering acc 0.9999158249158249: correct 23758/23760
class 1 clustering acc 0.0008417508417508417: correct 4/4752
Epoch: 3, train_loss: 1.3699, train_clustering_loss:  0.5003, train_error: 0.6195
class 0: acc 0.8031496062992126, correct 102/127
class 1: acc 0.16101694915254236, correct 19/118
class 2: acc 0.3700787401574803, correct 47/127
class 3: acc 0.21238938053097345, correct 24/113
class 4: acc 0.3119266055045872, correct 34/109

Val Set, val_loss: 1.3221, val_error: 0.5676, auc: 0.7233
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.42857142857142855, correct 6/14
Validation loss decreased (1.363255 --> 1.322052).  Saving model ...


batch 19, loss: 0.6299, instance_loss: 0.4749, weighted_loss: 0.5834, label: 4, bag_size: 689
batch 39, loss: 0.1068, instance_loss: 0.3082, weighted_loss: 0.1672, label: 0, bag_size: 297
batch 59, loss: 1.6722, instance_loss: 0.5378, weighted_loss: 1.3319, label: 1, bag_size: 398
batch 79, loss: 1.7021, instance_loss: 0.5511, weighted_loss: 1.3568, label: 1, bag_size: 988
batch 99, loss: 2.0220, instance_loss: 0.5094, weighted_loss: 1.5682, label: 4, bag_size: 356
batch 119, loss: 0.0939, instance_loss: 0.2967, weighted_loss: 0.1547, label: 0, bag_size: 268
batch 139, loss: 0.7508, instance_loss: 0.5317, weighted_loss: 0.6851, label: 4, bag_size: 506
batch 159, loss: 0.7932, instance_loss: 0.4707, weighted_loss: 0.6964, label: 4, bag_size: 432
batch 179, loss: 0.6357, instance_loss: 0.3738, weighted_loss: 0.5571, label: 0, bag_size: 231
batch 199, loss: 1.0669, instance_loss: 0.4527, weighted_loss: 0.8827, label: 1, bag_size: 1103
batch 219, loss: 1.4201, instance_loss: 0.5239, weighted_loss: 1.1512, label: 4, bag_size: 233
batch 239, loss: 1.2039, instance_loss: 0.5109, weighted_loss: 0.9960, label: 2, bag_size: 783
batch 259, loss: 1.5951, instance_loss: 0.5104, weighted_loss: 1.2697, label: 1, bag_size: 1009
batch 279, loss: 0.0217, instance_loss: 0.3047, weighted_loss: 0.1066, label: 0, bag_size: 51
batch 299, loss: 1.5683, instance_loss: 0.5085, weighted_loss: 1.2504, label: 1, bag_size: 525
batch 319, loss: 2.3034, instance_loss: 0.5583, weighted_loss: 1.7798, label: 3, bag_size: 1328
batch 339, loss: 0.9679, instance_loss: 0.5051, weighted_loss: 0.8290, label: 4, bag_size: 742
batch 359, loss: 1.3358, instance_loss: 0.4724, weighted_loss: 1.0768, label: 2, bag_size: 135
batch 379, loss: 1.6329, instance_loss: 0.5323, weighted_loss: 1.3027, label: 4, bag_size: 685
batch 399, loss: 1.3579, instance_loss: 0.5084, weighted_loss: 1.1030, label: 4, bag_size: 771
batch 419, loss: 1.4968, instance_loss: 0.4997, weighted_loss: 1.1977, label: 2, bag_size: 853
batch 439, loss: 1.6381, instance_loss: 0.6156, weighted_loss: 1.3313, label: 4, bag_size: 731
batch 459, loss: 1.3156, instance_loss: 0.5409, weighted_loss: 1.0831, label: 4, bag_size: 740
batch 479, loss: 2.4770, instance_loss: 0.5127, weighted_loss: 1.8877, label: 4, bag_size: 264
batch 499, loss: 1.1868, instance_loss: 0.5183, weighted_loss: 0.9862, label: 3, bag_size: 641
batch 519, loss: 1.6698, instance_loss: 0.5448, weighted_loss: 1.3323, label: 1, bag_size: 221
batch 539, loss: 1.5133, instance_loss: 0.5195, weighted_loss: 1.2152, label: 3, bag_size: 149
batch 559, loss: 1.4152, instance_loss: 0.5097, weighted_loss: 1.1435, label: 3, bag_size: 301
batch 579, loss: 0.6460, instance_loss: 0.4544, weighted_loss: 0.5885, label: 4, bag_size: 773


class 0 clustering acc 0.9992424242424243: correct 23742/23760
class 1 clustering acc 0.00989057239057239: correct 47/4752
Epoch: 4, train_loss: 1.3429, train_clustering_loss:  0.4975, train_error: 0.6077
class 0: acc 0.8333333333333334, correct 100/120
class 1: acc 0.06481481481481481, correct 7/108
class 2: acc 0.375, correct 51/136
class 3: acc 0.3018867924528302, correct 32/106
class 4: acc 0.3467741935483871, correct 43/124

Val Set, val_loss: 1.3168, val_error: 0.6216, auc: 0.7509
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.14285714285714285, correct 2/14
Validation loss decreased (1.322052 --> 1.316822).  Saving model ...


batch 19, loss: 4.1833, instance_loss: 0.9396, weighted_loss: 3.2102, label: 0, bag_size: 214
batch 39, loss: 1.0498, instance_loss: 0.4322, weighted_loss: 0.8645, label: 2, bag_size: 1066
batch 59, loss: 1.4318, instance_loss: 0.5769, weighted_loss: 1.1753, label: 0, bag_size: 243
batch 79, loss: 1.3968, instance_loss: 0.6177, weighted_loss: 1.1630, label: 3, bag_size: 344
batch 99, loss: 1.5833, instance_loss: 0.5815, weighted_loss: 1.2828, label: 2, bag_size: 337
batch 119, loss: 1.0584, instance_loss: 0.4555, weighted_loss: 0.8775, label: 3, bag_size: 282
batch 139, loss: 1.3504, instance_loss: 0.4580, weighted_loss: 1.0827, label: 1, bag_size: 874
batch 159, loss: 1.1688, instance_loss: 0.5662, weighted_loss: 0.9880, label: 3, bag_size: 403
batch 179, loss: 1.6738, instance_loss: 0.5330, weighted_loss: 1.3316, label: 1, bag_size: 460
batch 199, loss: 1.3643, instance_loss: 0.5492, weighted_loss: 1.1198, label: 2, bag_size: 582
batch 219, loss: 2.8604, instance_loss: 0.6773, weighted_loss: 2.2055, label: 2, bag_size: 244
batch 239, loss: 1.3511, instance_loss: 0.5007, weighted_loss: 1.0959, label: 2, bag_size: 598
batch 259, loss: 1.5567, instance_loss: 0.5194, weighted_loss: 1.2455, label: 1, bag_size: 221
batch 279, loss: 1.5366, instance_loss: 0.5156, weighted_loss: 1.2303, label: 1, bag_size: 339
batch 299, loss: 1.0829, instance_loss: 0.4410, weighted_loss: 0.8903, label: 2, bag_size: 607
batch 319, loss: 0.3351, instance_loss: 0.2990, weighted_loss: 0.3243, label: 0, bag_size: 281
batch 339, loss: 1.7281, instance_loss: 0.4975, weighted_loss: 1.3589, label: 2, bag_size: 208
batch 359, loss: 1.2743, instance_loss: 0.4674, weighted_loss: 1.0322, label: 2, bag_size: 402
batch 379, loss: 2.0076, instance_loss: 0.6113, weighted_loss: 1.5887, label: 3, bag_size: 533
batch 399, loss: 1.9854, instance_loss: 0.5172, weighted_loss: 1.5449, label: 4, bag_size: 312
batch 419, loss: 0.5514, instance_loss: 0.4657, weighted_loss: 0.5257, label: 0, bag_size: 552
batch 439, loss: 1.4673, instance_loss: 0.5003, weighted_loss: 1.1772, label: 4, bag_size: 342
batch 459, loss: 1.5742, instance_loss: 0.5754, weighted_loss: 1.2746, label: 4, bag_size: 1351
batch 479, loss: 1.6875, instance_loss: 0.5220, weighted_loss: 1.3379, label: 2, bag_size: 407
batch 499, loss: 1.1100, instance_loss: 0.4771, weighted_loss: 0.9201, label: 1, bag_size: 669
batch 519, loss: 1.3437, instance_loss: 0.4791, weighted_loss: 1.0843, label: 1, bag_size: 764
batch 539, loss: 1.6439, instance_loss: 0.4981, weighted_loss: 1.3002, label: 4, bag_size: 419
batch 559, loss: 1.2890, instance_loss: 0.4873, weighted_loss: 1.0485, label: 2, bag_size: 543
batch 579, loss: 1.0397, instance_loss: 0.5540, weighted_loss: 0.8940, label: 0, bag_size: 230


class 0 clustering acc 0.9998316498316498: correct 23756/23760
class 1 clustering acc 0.0016835016835016834: correct 8/4752
Epoch: 5, train_loss: 1.3565, train_clustering_loss:  0.5054, train_error: 0.6061
class 0: acc 0.8, correct 100/125
class 1: acc 0.225, correct 27/120
class 2: acc 0.3548387096774194, correct 44/124
class 3: acc 0.275, correct 33/120
class 4: acc 0.2857142857142857, correct 30/105

Val Set, val_loss: 1.2739, val_error: 0.5676, auc: 0.7330
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.316822 --> 1.273910).  Saving model ...


batch 19, loss: 2.4684, instance_loss: 0.6046, weighted_loss: 1.9093, label: 1, bag_size: 272
batch 39, loss: 0.0670, instance_loss: 0.3746, weighted_loss: 0.1593, label: 0, bag_size: 49
batch 59, loss: 1.4652, instance_loss: 0.5361, weighted_loss: 1.1865, label: 2, bag_size: 315
batch 79, loss: 1.9275, instance_loss: 0.4775, weighted_loss: 1.4925, label: 3, bag_size: 166
batch 99, loss: 0.6965, instance_loss: 0.5504, weighted_loss: 0.6527, label: 4, bag_size: 683
batch 119, loss: 1.4133, instance_loss: 0.4556, weighted_loss: 1.1260, label: 1, bag_size: 361
batch 139, loss: 1.7658, instance_loss: 0.7923, weighted_loss: 1.4737, label: 0, bag_size: 435
batch 159, loss: 1.2837, instance_loss: 0.5338, weighted_loss: 1.0587, label: 2, bag_size: 385
batch 179, loss: 1.7755, instance_loss: 0.5246, weighted_loss: 1.4002, label: 3, bag_size: 301
batch 199, loss: 1.0854, instance_loss: 0.4934, weighted_loss: 0.9078, label: 2, bag_size: 535
batch 219, loss: 0.8915, instance_loss: 0.5403, weighted_loss: 0.7861, label: 0, bag_size: 404
batch 239, loss: 1.5203, instance_loss: 0.4941, weighted_loss: 1.2124, label: 1, bag_size: 544
batch 259, loss: 0.0707, instance_loss: 0.3766, weighted_loss: 0.1624, label: 0, bag_size: 175
batch 279, loss: 1.3658, instance_loss: 0.5394, weighted_loss: 1.1179, label: 4, bag_size: 1064
batch 299, loss: 1.5438, instance_loss: 0.4935, weighted_loss: 1.2288, label: 4, bag_size: 695
batch 319, loss: 1.6034, instance_loss: 0.5020, weighted_loss: 1.2729, label: 1, bag_size: 949
batch 339, loss: 1.1722, instance_loss: 0.5765, weighted_loss: 0.9935, label: 0, bag_size: 367
batch 359, loss: 0.9616, instance_loss: 0.5282, weighted_loss: 0.8316, label: 0, bag_size: 238
batch 379, loss: 1.4792, instance_loss: 0.5177, weighted_loss: 1.1907, label: 1, bag_size: 311
batch 399, loss: 2.1235, instance_loss: 0.5937, weighted_loss: 1.6646, label: 3, bag_size: 457
batch 419, loss: 2.6317, instance_loss: 0.6764, weighted_loss: 2.0451, label: 3, bag_size: 98
batch 439, loss: 2.0994, instance_loss: 0.6112, weighted_loss: 1.6529, label: 4, bag_size: 960
batch 459, loss: 1.2046, instance_loss: 0.4859, weighted_loss: 0.9890, label: 2, bag_size: 853
batch 479, loss: 1.2892, instance_loss: 0.4674, weighted_loss: 1.0427, label: 2, bag_size: 1077
batch 499, loss: 1.7193, instance_loss: 0.4964, weighted_loss: 1.3525, label: 1, bag_size: 865
batch 519, loss: 0.7625, instance_loss: 0.4858, weighted_loss: 0.6795, label: 2, bag_size: 1975
batch 539, loss: 0.8359, instance_loss: 0.4636, weighted_loss: 0.7242, label: 4, bag_size: 727
batch 559, loss: 1.2171, instance_loss: 0.4436, weighted_loss: 0.9851, label: 3, bag_size: 899
batch 579, loss: 1.1505, instance_loss: 0.4348, weighted_loss: 0.9358, label: 3, bag_size: 727


class 0 clustering acc 0.9998316498316498: correct 23756/23760
class 1 clustering acc 0.0031565656565656565: correct 15/4752
Epoch: 6, train_loss: 1.3355, train_clustering_loss:  0.5012, train_error: 0.6178
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.21551724137931033, correct 25/116
class 2: acc 0.20535714285714285, correct 23/112
class 3: acc 0.2689075630252101, correct 32/119
class 4: acc 0.3884297520661157, correct 47/121

Val Set, val_loss: 1.2810, val_error: 0.5135, auc: 0.7416
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.07142857142857142, correct 1/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6885, instance_loss: 0.5426, weighted_loss: 0.6447, label: 0, bag_size: 288
batch 39, loss: 0.7167, instance_loss: 0.4437, weighted_loss: 0.6348, label: 3, bag_size: 956
batch 59, loss: 1.3818, instance_loss: 0.4772, weighted_loss: 1.1104, label: 3, bag_size: 500
batch 79, loss: 0.2341, instance_loss: 0.4222, weighted_loss: 0.2905, label: 0, bag_size: 357
batch 99, loss: 1.4387, instance_loss: 0.5087, weighted_loss: 1.1597, label: 4, bag_size: 228
batch 119, loss: 1.0150, instance_loss: 0.4527, weighted_loss: 0.8463, label: 1, bag_size: 851
batch 139, loss: 2.3906, instance_loss: 0.7743, weighted_loss: 1.9057, label: 0, bag_size: 273
batch 159, loss: 1.4859, instance_loss: 0.4985, weighted_loss: 1.1897, label: 1, bag_size: 328
batch 179, loss: 1.4579, instance_loss: 0.4455, weighted_loss: 1.1542, label: 2, bag_size: 1066
batch 199, loss: 1.3689, instance_loss: 0.4996, weighted_loss: 1.1081, label: 2, bag_size: 337
batch 219, loss: 1.2629, instance_loss: 0.4623, weighted_loss: 1.0228, label: 3, bag_size: 272
batch 239, loss: 0.3621, instance_loss: 0.5172, weighted_loss: 0.4086, label: 0, bag_size: 524
batch 259, loss: 1.0588, instance_loss: 0.4258, weighted_loss: 0.8689, label: 3, bag_size: 641
batch 279, loss: 1.5716, instance_loss: 0.4955, weighted_loss: 1.2487, label: 4, bag_size: 399
batch 299, loss: 1.5127, instance_loss: 0.5166, weighted_loss: 1.2139, label: 2, bag_size: 337
batch 319, loss: 1.5075, instance_loss: 0.5366, weighted_loss: 1.2162, label: 1, bag_size: 1009
batch 339, loss: 0.2105, instance_loss: 0.5809, weighted_loss: 0.3216, label: 0, bag_size: 578
batch 359, loss: 2.1072, instance_loss: 0.5747, weighted_loss: 1.6474, label: 2, bag_size: 321
batch 379, loss: 1.4827, instance_loss: 0.4981, weighted_loss: 1.1873, label: 4, bag_size: 267
batch 399, loss: 1.7195, instance_loss: 0.4799, weighted_loss: 1.3476, label: 4, bag_size: 356
batch 419, loss: 1.2850, instance_loss: 0.5016, weighted_loss: 1.0500, label: 2, bag_size: 315
batch 439, loss: 1.2914, instance_loss: 0.5156, weighted_loss: 1.0587, label: 2, bag_size: 498
batch 459, loss: 1.3240, instance_loss: 0.4977, weighted_loss: 1.0761, label: 3, bag_size: 737
batch 479, loss: 1.8982, instance_loss: 0.5182, weighted_loss: 1.4842, label: 1, bag_size: 328
batch 499, loss: 0.8327, instance_loss: 0.5744, weighted_loss: 0.7552, label: 0, bag_size: 477
batch 519, loss: 1.6329, instance_loss: 0.5244, weighted_loss: 1.3004, label: 1, bag_size: 500
batch 539, loss: 1.4219, instance_loss: 0.4768, weighted_loss: 1.1383, label: 2, bag_size: 860
batch 559, loss: 3.3288, instance_loss: 0.6239, weighted_loss: 2.5174, label: 4, bag_size: 310
batch 579, loss: 1.0926, instance_loss: 0.5030, weighted_loss: 0.9157, label: 2, bag_size: 375


class 0 clustering acc 0.9996632996632997: correct 23752/23760
class 1 clustering acc 0.001893939393939394: correct 9/4752
Epoch: 7, train_loss: 1.3752, train_clustering_loss:  0.5072, train_error: 0.6077
class 0: acc 0.7425742574257426, correct 75/101
class 1: acc 0.10810810810810811, correct 12/111
class 2: acc 0.39849624060150374, correct 53/133
class 3: acc 0.4186046511627907, correct 54/129
class 4: acc 0.325, correct 39/120

Val Set, val_loss: 1.2709, val_error: 0.5541, auc: 0.7535
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.273910 --> 1.270850).  Saving model ...


batch 19, loss: 1.5012, instance_loss: 0.4833, weighted_loss: 1.1958, label: 4, bag_size: 960
batch 39, loss: 0.5199, instance_loss: 0.4932, weighted_loss: 0.5119, label: 0, bag_size: 212
batch 59, loss: 1.3738, instance_loss: 0.4441, weighted_loss: 1.0948, label: 4, bag_size: 277
batch 79, loss: 0.0349, instance_loss: 0.3604, weighted_loss: 0.1326, label: 0, bag_size: 97
batch 99, loss: 1.5684, instance_loss: 0.5559, weighted_loss: 1.2646, label: 1, bag_size: 697
batch 119, loss: 1.3052, instance_loss: 0.4767, weighted_loss: 1.0567, label: 3, bag_size: 1060
batch 139, loss: 0.7423, instance_loss: 0.4537, weighted_loss: 0.6557, label: 4, bag_size: 1064
batch 159, loss: 2.6726, instance_loss: 0.5947, weighted_loss: 2.0492, label: 2, bag_size: 861
batch 179, loss: 1.8891, instance_loss: 0.5593, weighted_loss: 1.4901, label: 2, bag_size: 445
batch 199, loss: 1.3830, instance_loss: 0.5048, weighted_loss: 1.1195, label: 1, bag_size: 460
batch 219, loss: 2.1287, instance_loss: 0.5477, weighted_loss: 1.6544, label: 1, bag_size: 272
batch 239, loss: 2.0390, instance_loss: 0.6070, weighted_loss: 1.6094, label: 4, bag_size: 476
batch 259, loss: 0.0550, instance_loss: 0.3878, weighted_loss: 0.1548, label: 0, bag_size: 324
batch 279, loss: 1.2057, instance_loss: 0.4468, weighted_loss: 0.9780, label: 3, bag_size: 779
batch 299, loss: 0.9236, instance_loss: 0.4343, weighted_loss: 0.7768, label: 3, bag_size: 697
batch 319, loss: 1.8263, instance_loss: 0.6868, weighted_loss: 1.4845, label: 4, bag_size: 490
batch 339, loss: 1.4485, instance_loss: 0.4275, weighted_loss: 1.1422, label: 1, bag_size: 925
batch 359, loss: 1.4680, instance_loss: 0.5970, weighted_loss: 1.2067, label: 0, bag_size: 642
batch 379, loss: 1.5428, instance_loss: 0.5520, weighted_loss: 1.2455, label: 4, bag_size: 238
batch 399, loss: 0.7851, instance_loss: 0.4357, weighted_loss: 0.6803, label: 3, bag_size: 1007
batch 419, loss: 0.1514, instance_loss: 0.4291, weighted_loss: 0.2347, label: 0, bag_size: 355
batch 439, loss: 1.5025, instance_loss: 0.5804, weighted_loss: 1.2259, label: 4, bag_size: 727
batch 459, loss: 1.6551, instance_loss: 0.6777, weighted_loss: 1.3619, label: 2, bag_size: 498
batch 479, loss: 1.1322, instance_loss: 0.5646, weighted_loss: 0.9620, label: 2, bag_size: 315
batch 499, loss: 0.7549, instance_loss: 0.5219, weighted_loss: 0.6850, label: 0, bag_size: 477
batch 519, loss: 1.2048, instance_loss: 0.4644, weighted_loss: 0.9827, label: 3, bag_size: 615
batch 539, loss: 0.0286, instance_loss: 0.2595, weighted_loss: 0.0979, label: 0, bag_size: 221
batch 559, loss: 5.2983, instance_loss: 0.6034, weighted_loss: 3.8899, label: 4, bag_size: 293
batch 579, loss: 1.8704, instance_loss: 0.6582, weighted_loss: 1.5068, label: 2, bag_size: 1060


class 0 clustering acc 0.9992845117845118: correct 23743/23760
class 1 clustering acc 0.010101010101010102: correct 48/4752
Epoch: 8, train_loss: 1.2424, train_clustering_loss:  0.4949, train_error: 0.5589
class 0: acc 0.8711656441717791, correct 142/163
class 1: acc 0.19166666666666668, correct 23/120
class 2: acc 0.17204301075268819, correct 16/93
class 3: acc 0.4473684210526316, correct 51/114
class 4: acc 0.28846153846153844, correct 30/104

Val Set, val_loss: 1.2564, val_error: 0.5811, auc: 0.7533
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.14285714285714285, correct 2/14
Validation loss decreased (1.270850 --> 1.256444).  Saving model ...


batch 19, loss: 1.1947, instance_loss: 0.4816, weighted_loss: 0.9807, label: 2, bag_size: 549
batch 39, loss: 1.8127, instance_loss: 0.5463, weighted_loss: 1.4328, label: 1, bag_size: 208
batch 59, loss: 3.6548, instance_loss: 0.6621, weighted_loss: 2.7570, label: 0, bag_size: 608
batch 79, loss: 1.7433, instance_loss: 0.5972, weighted_loss: 1.3995, label: 2, bag_size: 744
batch 99, loss: 0.3395, instance_loss: 0.3428, weighted_loss: 0.3405, label: 0, bag_size: 63
batch 119, loss: 1.3819, instance_loss: 0.4992, weighted_loss: 1.1171, label: 1, bag_size: 361
batch 139, loss: 1.2341, instance_loss: 0.4690, weighted_loss: 1.0046, label: 4, bag_size: 520
batch 159, loss: 0.0092, instance_loss: 0.3535, weighted_loss: 0.1125, label: 0, bag_size: 340
batch 179, loss: 0.9654, instance_loss: 0.4834, weighted_loss: 0.8208, label: 4, bag_size: 703
batch 199, loss: 0.2997, instance_loss: 0.5703, weighted_loss: 0.3809, label: 0, bag_size: 477
batch 219, loss: 1.5961, instance_loss: 0.4818, weighted_loss: 1.2618, label: 4, bag_size: 110
batch 239, loss: 1.6923, instance_loss: 0.5814, weighted_loss: 1.3590, label: 2, bag_size: 351
batch 259, loss: 0.0207, instance_loss: 0.2259, weighted_loss: 0.0823, label: 0, bag_size: 80
batch 279, loss: 1.2867, instance_loss: 0.4951, weighted_loss: 1.0492, label: 4, bag_size: 218
batch 299, loss: 1.3596, instance_loss: 0.4912, weighted_loss: 1.0991, label: 2, bag_size: 684
batch 319, loss: 2.0740, instance_loss: 0.6620, weighted_loss: 1.6504, label: 4, bag_size: 53
batch 339, loss: 1.5128, instance_loss: 0.5191, weighted_loss: 1.2147, label: 4, bag_size: 572
batch 359, loss: 1.2964, instance_loss: 0.4973, weighted_loss: 1.0567, label: 2, bag_size: 812
batch 379, loss: 0.3128, instance_loss: 0.3207, weighted_loss: 0.3152, label: 0, bag_size: 122
batch 399, loss: 1.1852, instance_loss: 0.4423, weighted_loss: 0.9623, label: 3, bag_size: 282
batch 419, loss: 1.8575, instance_loss: 0.4798, weighted_loss: 1.4442, label: 4, bag_size: 98
batch 439, loss: 0.0157, instance_loss: 0.2865, weighted_loss: 0.0970, label: 0, bag_size: 138
batch 459, loss: 1.0919, instance_loss: 0.5109, weighted_loss: 0.9176, label: 2, bag_size: 953
batch 479, loss: 0.5587, instance_loss: 0.6296, weighted_loss: 0.5800, label: 4, bag_size: 895
batch 499, loss: 1.0546, instance_loss: 0.4578, weighted_loss: 0.8756, label: 1, bag_size: 981
batch 519, loss: 1.0783, instance_loss: 0.4880, weighted_loss: 0.9012, label: 4, bag_size: 854
batch 539, loss: 3.5130, instance_loss: 0.6337, weighted_loss: 2.6492, label: 0, bag_size: 1073
batch 559, loss: 1.3205, instance_loss: 0.5579, weighted_loss: 1.0917, label: 3, bag_size: 737
batch 579, loss: 1.0367, instance_loss: 0.5049, weighted_loss: 0.8771, label: 4, bag_size: 618


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.020412457912457913: correct 97/4752
Epoch: 9, train_loss: 1.2531, train_clustering_loss:  0.4919, train_error: 0.5606
class 0: acc 0.8682170542635659, correct 112/129
class 1: acc 0.21818181818181817, correct 24/110
class 2: acc 0.3709677419354839, correct 46/124
class 3: acc 0.2549019607843137, correct 26/102
class 4: acc 0.4108527131782946, correct 53/129

Val Set, val_loss: 1.2866, val_error: 0.5405, auc: 0.7293
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.0267, instance_loss: 0.5225, weighted_loss: 1.5755, label: 1, bag_size: 231
batch 39, loss: 2.6656, instance_loss: 0.6401, weighted_loss: 2.0579, label: 3, bag_size: 282
batch 59, loss: 2.0762, instance_loss: 0.6151, weighted_loss: 1.6379, label: 3, bag_size: 1358
batch 79, loss: 1.4776, instance_loss: 0.5080, weighted_loss: 1.1867, label: 3, bag_size: 822
batch 99, loss: 0.1221, instance_loss: 0.4665, weighted_loss: 0.2254, label: 0, bag_size: 370
batch 119, loss: 1.7913, instance_loss: 0.5728, weighted_loss: 1.4258, label: 2, bag_size: 470
batch 139, loss: 1.3332, instance_loss: 0.5873, weighted_loss: 1.1095, label: 3, bag_size: 856
batch 159, loss: 1.7116, instance_loss: 0.5504, weighted_loss: 1.3632, label: 2, bag_size: 864
batch 179, loss: 0.8789, instance_loss: 0.4207, weighted_loss: 0.7414, label: 4, bag_size: 418
batch 199, loss: 1.4000, instance_loss: 0.5382, weighted_loss: 1.1414, label: 2, bag_size: 369
batch 219, loss: 1.0589, instance_loss: 0.4573, weighted_loss: 0.8784, label: 4, bag_size: 520
batch 239, loss: 1.3277, instance_loss: 0.4668, weighted_loss: 1.0695, label: 4, bag_size: 293
batch 259, loss: 1.8181, instance_loss: 0.4944, weighted_loss: 1.4210, label: 1, bag_size: 397
batch 279, loss: 0.1651, instance_loss: 0.2722, weighted_loss: 0.1972, label: 0, bag_size: 355
batch 299, loss: 0.8770, instance_loss: 0.4705, weighted_loss: 0.7550, label: 2, bag_size: 567
batch 319, loss: 1.0380, instance_loss: 0.5575, weighted_loss: 0.8939, label: 1, bag_size: 534
batch 339, loss: 0.6752, instance_loss: 0.4226, weighted_loss: 0.5994, label: 4, bag_size: 498
batch 359, loss: 1.5000, instance_loss: 0.4764, weighted_loss: 1.1929, label: 1, bag_size: 855
batch 379, loss: 1.4414, instance_loss: 0.4482, weighted_loss: 1.1434, label: 4, bag_size: 176
batch 399, loss: 1.8812, instance_loss: 0.5309, weighted_loss: 1.4761, label: 4, bag_size: 333
batch 419, loss: 0.3572, instance_loss: 0.4142, weighted_loss: 0.3743, label: 0, bag_size: 201
batch 439, loss: 1.4861, instance_loss: 0.4626, weighted_loss: 1.1790, label: 4, bag_size: 277
batch 459, loss: 1.7418, instance_loss: 0.4887, weighted_loss: 1.3659, label: 4, bag_size: 110
batch 479, loss: 1.5858, instance_loss: 0.5547, weighted_loss: 1.2765, label: 4, bag_size: 740
batch 499, loss: 1.6001, instance_loss: 0.6225, weighted_loss: 1.3068, label: 2, bag_size: 627
batch 519, loss: 1.5539, instance_loss: 0.4963, weighted_loss: 1.2366, label: 1, bag_size: 461
batch 539, loss: 0.1901, instance_loss: 0.3546, weighted_loss: 0.2394, label: 0, bag_size: 98
batch 559, loss: 0.9544, instance_loss: 0.4640, weighted_loss: 0.8073, label: 2, bag_size: 607
batch 579, loss: 2.1066, instance_loss: 0.5507, weighted_loss: 1.6398, label: 4, bag_size: 198


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.022937710437710437: correct 109/4752
Epoch: 10, train_loss: 1.3155, train_clustering_loss:  0.5065, train_error: 0.5976
class 0: acc 0.7355371900826446, correct 89/121
class 1: acc 0.30158730158730157, correct 38/126
class 2: acc 0.2644628099173554, correct 32/121
class 3: acc 0.33636363636363636, correct 37/110
class 4: acc 0.3706896551724138, correct 43/116

Val Set, val_loss: 1.2489, val_error: 0.5405, auc: 0.7652
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.256444 --> 1.248858).  Saving model ...


batch 19, loss: 1.8992, instance_loss: 0.4578, weighted_loss: 1.4668, label: 2, bag_size: 809
batch 39, loss: 3.1259, instance_loss: 0.7507, weighted_loss: 2.4133, label: 0, bag_size: 964
batch 59, loss: 2.0919, instance_loss: 0.5680, weighted_loss: 1.6347, label: 4, bag_size: 438
batch 79, loss: 1.6585, instance_loss: 0.5183, weighted_loss: 1.3165, label: 3, bag_size: 684
batch 99, loss: 0.2565, instance_loss: 0.4182, weighted_loss: 0.3050, label: 0, bag_size: 573
batch 119, loss: 1.7746, instance_loss: 0.4876, weighted_loss: 1.3885, label: 4, bag_size: 476
batch 139, loss: 0.3962, instance_loss: 0.4830, weighted_loss: 0.4222, label: 0, bag_size: 404
batch 159, loss: 2.5626, instance_loss: 0.5555, weighted_loss: 1.9604, label: 4, bag_size: 198
batch 179, loss: 2.9379, instance_loss: 0.8292, weighted_loss: 2.3053, label: 2, bag_size: 244
batch 199, loss: 1.4383, instance_loss: 0.5264, weighted_loss: 1.1647, label: 2, bag_size: 337
batch 219, loss: 1.6163, instance_loss: 0.5058, weighted_loss: 1.2832, label: 4, bag_size: 689
batch 239, loss: 1.3390, instance_loss: 0.4927, weighted_loss: 1.0851, label: 3, bag_size: 301
batch 259, loss: 1.3879, instance_loss: 0.5420, weighted_loss: 1.1341, label: 1, bag_size: 591
batch 279, loss: 0.6845, instance_loss: 0.4940, weighted_loss: 0.6274, label: 4, bag_size: 129
batch 299, loss: 1.0818, instance_loss: 0.4728, weighted_loss: 0.8991, label: 4, bag_size: 689
batch 319, loss: 1.4908, instance_loss: 0.5363, weighted_loss: 1.2044, label: 1, bag_size: 614
batch 339, loss: 1.2307, instance_loss: 0.4781, weighted_loss: 1.0049, label: 3, bag_size: 423
batch 359, loss: 1.7641, instance_loss: 0.5512, weighted_loss: 1.4002, label: 2, bag_size: 627
batch 379, loss: 0.7524, instance_loss: 0.4976, weighted_loss: 0.6759, label: 0, bag_size: 455
batch 399, loss: 0.9619, instance_loss: 0.4885, weighted_loss: 0.8198, label: 1, bag_size: 1360
batch 419, loss: 1.2088, instance_loss: 0.5164, weighted_loss: 1.0010, label: 2, bag_size: 168
batch 439, loss: 1.9757, instance_loss: 0.5625, weighted_loss: 1.5518, label: 1, bag_size: 311
batch 459, loss: 3.4359, instance_loss: 0.6347, weighted_loss: 2.5955, label: 4, bag_size: 260
batch 479, loss: 0.3599, instance_loss: 0.4778, weighted_loss: 0.3952, label: 4, bag_size: 574
batch 499, loss: 1.6021, instance_loss: 0.4624, weighted_loss: 1.2602, label: 2, bag_size: 1003
batch 519, loss: 2.3652, instance_loss: 0.6871, weighted_loss: 1.8618, label: 0, bag_size: 243
batch 539, loss: 1.4947, instance_loss: 0.5580, weighted_loss: 1.2136, label: 3, bag_size: 403
batch 559, loss: 0.9145, instance_loss: 0.4354, weighted_loss: 0.7707, label: 3, bag_size: 615
batch 579, loss: 1.7917, instance_loss: 0.5386, weighted_loss: 1.4158, label: 1, bag_size: 564


class 0 clustering acc 0.999537037037037: correct 23749/23760
class 1 clustering acc 0.005050505050505051: correct 24/4752
Epoch: 11, train_loss: 1.3208, train_clustering_loss:  0.5051, train_error: 0.5808
class 0: acc 0.7843137254901961, correct 80/102
class 1: acc 0.1271186440677966, correct 15/118
class 2: acc 0.32142857142857145, correct 36/112
class 3: acc 0.45255474452554745, correct 62/137
class 4: acc 0.448, correct 56/125

Val Set, val_loss: 1.3310, val_error: 0.5811, auc: 0.7609
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.9285714285714286, correct 13/14
class 4: acc 0.0, correct 0/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9328, instance_loss: 0.6295, weighted_loss: 1.5418, label: 1, bag_size: 398
batch 39, loss: 0.9132, instance_loss: 0.4429, weighted_loss: 0.7721, label: 2, bag_size: 402
batch 59, loss: 1.7300, instance_loss: 0.4932, weighted_loss: 1.3590, label: 4, bag_size: 113
batch 79, loss: 1.6149, instance_loss: 0.5318, weighted_loss: 1.2900, label: 4, bag_size: 771
batch 99, loss: 1.1639, instance_loss: 0.4334, weighted_loss: 0.9448, label: 3, bag_size: 317
batch 119, loss: 1.3377, instance_loss: 0.5142, weighted_loss: 1.0907, label: 2, bag_size: 697
batch 139, loss: 1.3850, instance_loss: 0.5523, weighted_loss: 1.1352, label: 3, bag_size: 149
batch 159, loss: 1.2891, instance_loss: 0.4059, weighted_loss: 1.0241, label: 3, bag_size: 1328
batch 179, loss: 1.1660, instance_loss: 0.5206, weighted_loss: 0.9724, label: 2, bag_size: 1066
batch 199, loss: 1.1622, instance_loss: 0.5364, weighted_loss: 0.9744, label: 1, bag_size: 371
batch 219, loss: 2.0749, instance_loss: 0.5490, weighted_loss: 1.6171, label: 2, bag_size: 380
batch 239, loss: 0.5864, instance_loss: 0.4302, weighted_loss: 0.5396, label: 1, bag_size: 1497
batch 259, loss: 2.4507, instance_loss: 0.6010, weighted_loss: 1.8958, label: 4, bag_size: 260
batch 279, loss: 1.7795, instance_loss: 0.5149, weighted_loss: 1.4001, label: 4, bag_size: 363
batch 299, loss: 3.0253, instance_loss: 0.8425, weighted_loss: 2.3705, label: 0, bag_size: 745
batch 319, loss: 0.9959, instance_loss: 0.4391, weighted_loss: 0.8288, label: 3, bag_size: 822
batch 339, loss: 1.0997, instance_loss: 0.3996, weighted_loss: 0.8897, label: 3, bag_size: 899
batch 359, loss: 1.5227, instance_loss: 0.5332, weighted_loss: 1.2259, label: 3, bag_size: 796
batch 379, loss: 1.9057, instance_loss: 0.5830, weighted_loss: 1.5089, label: 4, bag_size: 250
batch 399, loss: 1.5544, instance_loss: 0.5260, weighted_loss: 1.2458, label: 1, bag_size: 764
batch 419, loss: 1.6534, instance_loss: 0.5749, weighted_loss: 1.3299, label: 4, bag_size: 1031
batch 439, loss: 0.7453, instance_loss: 0.5277, weighted_loss: 0.6800, label: 4, bag_size: 46
batch 459, loss: 0.9054, instance_loss: 0.4590, weighted_loss: 0.7715, label: 2, bag_size: 567
batch 479, loss: 0.9237, instance_loss: 0.4317, weighted_loss: 0.7761, label: 2, bag_size: 598
batch 499, loss: 2.2206, instance_loss: 0.5869, weighted_loss: 1.7305, label: 4, bag_size: 572
batch 519, loss: 1.6185, instance_loss: 0.4912, weighted_loss: 1.2803, label: 3, bag_size: 1076
batch 539, loss: 1.2388, instance_loss: 0.4614, weighted_loss: 1.0056, label: 1, bag_size: 419
batch 559, loss: 0.8759, instance_loss: 0.4456, weighted_loss: 0.7468, label: 2, bag_size: 535
batch 579, loss: 0.2240, instance_loss: 0.4025, weighted_loss: 0.2776, label: 0, bag_size: 281


class 0 clustering acc 0.9991582491582491: correct 23740/23760
class 1 clustering acc 0.00968013468013468: correct 46/4752
Epoch: 12, train_loss: 1.3106, train_clustering_loss:  0.4962, train_error: 0.6111
class 0: acc 0.8076923076923077, correct 84/104
class 1: acc 0.23076923076923078, correct 30/130
class 2: acc 0.3203125, correct 41/128
class 3: acc 0.4122137404580153, correct 54/131
class 4: acc 0.21782178217821782, correct 22/101

Val Set, val_loss: 1.2378, val_error: 0.5405, auc: 0.7798
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.07142857142857142, correct 1/14
class 4: acc 0.5, correct 7/14
Validation loss decreased (1.248858 --> 1.237823).  Saving model ...


batch 19, loss: 0.9961, instance_loss: 0.4143, weighted_loss: 0.8215, label: 2, bag_size: 702
batch 39, loss: 1.4396, instance_loss: 0.4803, weighted_loss: 1.1518, label: 1, bag_size: 981
batch 59, loss: 1.3519, instance_loss: 0.5118, weighted_loss: 1.0999, label: 3, bag_size: 431
batch 79, loss: 0.0422, instance_loss: 0.2996, weighted_loss: 0.1194, label: 0, bag_size: 70
batch 99, loss: 1.9512, instance_loss: 0.6460, weighted_loss: 1.5596, label: 2, bag_size: 244
batch 119, loss: 1.6156, instance_loss: 0.5022, weighted_loss: 1.2815, label: 1, bag_size: 949
batch 139, loss: 1.0576, instance_loss: 0.4547, weighted_loss: 0.8767, label: 3, bag_size: 453
batch 159, loss: 0.2472, instance_loss: 0.3797, weighted_loss: 0.2870, label: 0, bag_size: 488
batch 179, loss: 0.1046, instance_loss: 0.3891, weighted_loss: 0.1899, label: 0, bag_size: 397
batch 199, loss: 1.5298, instance_loss: 0.5019, weighted_loss: 1.2214, label: 4, bag_size: 986
batch 219, loss: 1.9350, instance_loss: 0.5449, weighted_loss: 1.5180, label: 2, bag_size: 286
batch 239, loss: 2.0008, instance_loss: 0.5579, weighted_loss: 1.5680, label: 4, bag_size: 260
batch 259, loss: 0.9521, instance_loss: 0.4923, weighted_loss: 0.8142, label: 1, bag_size: 1091
batch 279, loss: 0.0142, instance_loss: 0.3489, weighted_loss: 0.1146, label: 0, bag_size: 706
batch 299, loss: 2.0787, instance_loss: 0.5739, weighted_loss: 1.6272, label: 1, bag_size: 742
batch 319, loss: 0.5441, instance_loss: 0.4805, weighted_loss: 0.5250, label: 4, bag_size: 895
batch 339, loss: 1.0072, instance_loss: 0.4803, weighted_loss: 0.8491, label: 2, bag_size: 427
batch 359, loss: 0.8687, instance_loss: 0.3957, weighted_loss: 0.7268, label: 4, bag_size: 775
batch 379, loss: 1.4153, instance_loss: 0.5112, weighted_loss: 1.1441, label: 4, bag_size: 238
batch 399, loss: 1.3723, instance_loss: 0.5151, weighted_loss: 1.1152, label: 2, bag_size: 105
batch 419, loss: 1.4202, instance_loss: 0.5207, weighted_loss: 1.1503, label: 2, bag_size: 725
batch 439, loss: 0.9268, instance_loss: 0.4434, weighted_loss: 0.7817, label: 3, bag_size: 344
batch 459, loss: 2.3351, instance_loss: 0.6957, weighted_loss: 1.8433, label: 0, bag_size: 376
batch 479, loss: 0.3184, instance_loss: 0.4794, weighted_loss: 0.3667, label: 4, bag_size: 725
batch 499, loss: 0.6016, instance_loss: 0.4488, weighted_loss: 0.5557, label: 4, bag_size: 574
batch 519, loss: 3.1758, instance_loss: 0.6180, weighted_loss: 2.4085, label: 2, bag_size: 809
batch 539, loss: 0.5105, instance_loss: 0.3850, weighted_loss: 0.4728, label: 0, bag_size: 573
batch 559, loss: 0.6296, instance_loss: 0.3832, weighted_loss: 0.5557, label: 3, bag_size: 615
batch 579, loss: 0.3294, instance_loss: 0.4343, weighted_loss: 0.3609, label: 4, bag_size: 744


class 0 clustering acc 0.9986111111111111: correct 23727/23760
class 1 clustering acc 0.008207070707070708: correct 39/4752
Epoch: 13, train_loss: 1.2812, train_clustering_loss:  0.5038, train_error: 0.5859
class 0: acc 0.7889908256880734, correct 86/109
class 1: acc 0.14, correct 14/100
class 2: acc 0.33587786259541985, correct 44/131
class 3: acc 0.4409448818897638, correct 56/127
class 4: acc 0.36220472440944884, correct 46/127

Val Set, val_loss: 1.3773, val_error: 0.6216, auc: 0.7221
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7865, instance_loss: 0.6190, weighted_loss: 1.4363, label: 1, bag_size: 591
batch 39, loss: 1.8454, instance_loss: 0.5436, weighted_loss: 1.4549, label: 4, bag_size: 233
batch 59, loss: 0.1122, instance_loss: 0.3550, weighted_loss: 0.1851, label: 0, bag_size: 366
batch 79, loss: 1.1071, instance_loss: 0.4376, weighted_loss: 0.9062, label: 1, bag_size: 906
batch 99, loss: 1.1497, instance_loss: 0.5165, weighted_loss: 0.9597, label: 0, bag_size: 122
batch 119, loss: 0.3312, instance_loss: 0.4587, weighted_loss: 0.3695, label: 0, bag_size: 188
batch 139, loss: 1.1182, instance_loss: 0.4796, weighted_loss: 0.9266, label: 3, bag_size: 641
batch 159, loss: 1.1811, instance_loss: 0.4878, weighted_loss: 0.9731, label: 3, bag_size: 566
batch 179, loss: 0.5367, instance_loss: 0.4649, weighted_loss: 0.5152, label: 0, bag_size: 227
batch 199, loss: 1.3760, instance_loss: 0.5073, weighted_loss: 1.1154, label: 3, bag_size: 520
batch 219, loss: 0.6707, instance_loss: 0.3836, weighted_loss: 0.5846, label: 3, bag_size: 476
batch 239, loss: 0.9617, instance_loss: 0.4638, weighted_loss: 0.8123, label: 3, bag_size: 431
batch 259, loss: 0.9305, instance_loss: 0.4920, weighted_loss: 0.7990, label: 1, bag_size: 1091
batch 279, loss: 1.8754, instance_loss: 0.5632, weighted_loss: 1.4817, label: 2, bag_size: 369
batch 299, loss: 1.5181, instance_loss: 0.5380, weighted_loss: 1.2240, label: 2, bag_size: 363
batch 319, loss: 1.2325, instance_loss: 0.5317, weighted_loss: 1.0223, label: 2, bag_size: 613
batch 339, loss: 1.8178, instance_loss: 0.5190, weighted_loss: 1.4282, label: 4, bag_size: 176
batch 359, loss: 0.9288, instance_loss: 0.4203, weighted_loss: 0.7763, label: 1, bag_size: 669
batch 379, loss: 1.2681, instance_loss: 0.4444, weighted_loss: 1.0210, label: 4, bag_size: 755
batch 399, loss: 1.9955, instance_loss: 0.5606, weighted_loss: 1.5651, label: 0, bag_size: 367
batch 419, loss: 1.0806, instance_loss: 0.4940, weighted_loss: 0.9046, label: 3, bag_size: 1131
batch 439, loss: 0.2823, instance_loss: 0.2901, weighted_loss: 0.2846, label: 0, bag_size: 79
batch 459, loss: 2.4747, instance_loss: 0.6398, weighted_loss: 1.9242, label: 2, bag_size: 1122
batch 479, loss: 1.1244, instance_loss: 0.4167, weighted_loss: 0.9121, label: 3, bag_size: 499
batch 499, loss: 0.1534, instance_loss: 0.4011, weighted_loss: 0.2277, label: 0, bag_size: 324
batch 519, loss: 0.9559, instance_loss: 0.4415, weighted_loss: 0.8015, label: 1, bag_size: 490
batch 539, loss: 3.8920, instance_loss: 0.6790, weighted_loss: 2.9281, label: 0, bag_size: 600
batch 559, loss: 1.7865, instance_loss: 0.4914, weighted_loss: 1.3980, label: 2, bag_size: 851
batch 579, loss: 1.1904, instance_loss: 0.5110, weighted_loss: 0.9866, label: 3, bag_size: 235


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.025883838383838384: correct 123/4752
Epoch: 14, train_loss: 1.2719, train_clustering_loss:  0.4931, train_error: 0.5522
class 0: acc 0.8225806451612904, correct 102/124
class 1: acc 0.3333333333333333, correct 43/129
class 2: acc 0.24545454545454545, correct 27/110
class 3: acc 0.39090909090909093, correct 43/110
class 4: acc 0.4214876033057851, correct 51/121

Val Set, val_loss: 1.2360, val_error: 0.5676, auc: 0.7948
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.35714285714285715, correct 5/14
Validation loss decreased (1.237823 --> 1.236021).  Saving model ...


batch 19, loss: 1.2274, instance_loss: 0.4824, weighted_loss: 1.0039, label: 1, bag_size: 221
batch 39, loss: 1.7563, instance_loss: 0.5711, weighted_loss: 1.4007, label: 3, bag_size: 520
batch 59, loss: 0.0187, instance_loss: 0.3361, weighted_loss: 0.1139, label: 0, bag_size: 706
batch 79, loss: 1.8240, instance_loss: 0.5126, weighted_loss: 1.4306, label: 4, bag_size: 98
batch 99, loss: 1.8076, instance_loss: 0.5172, weighted_loss: 1.4205, label: 1, bag_size: 328
batch 119, loss: 1.0337, instance_loss: 0.3977, weighted_loss: 0.8429, label: 2, bag_size: 606
batch 139, loss: 1.8183, instance_loss: 0.5334, weighted_loss: 1.4328, label: 3, bag_size: 230
batch 159, loss: 1.9784, instance_loss: 0.5412, weighted_loss: 1.5472, label: 4, bag_size: 72
batch 179, loss: 0.4473, instance_loss: 0.4352, weighted_loss: 0.4437, label: 4, bag_size: 895
batch 199, loss: 0.8637, instance_loss: 0.4176, weighted_loss: 0.7299, label: 3, bag_size: 476
batch 219, loss: 1.0416, instance_loss: 0.5043, weighted_loss: 0.8804, label: 3, bag_size: 393
batch 239, loss: 0.4906, instance_loss: 0.5263, weighted_loss: 0.5013, label: 0, bag_size: 400
batch 259, loss: 1.0856, instance_loss: 0.5069, weighted_loss: 0.9120, label: 2, bag_size: 708
batch 279, loss: 2.9028, instance_loss: 0.6395, weighted_loss: 2.2238, label: 0, bag_size: 1045
batch 299, loss: 1.3498, instance_loss: 0.5186, weighted_loss: 1.1005, label: 3, bag_size: 258
batch 319, loss: 0.0151, instance_loss: 0.2810, weighted_loss: 0.0949, label: 0, bag_size: 51
batch 339, loss: 1.2278, instance_loss: 0.5267, weighted_loss: 1.0174, label: 2, bag_size: 411
batch 359, loss: 0.7687, instance_loss: 0.3731, weighted_loss: 0.6500, label: 3, bag_size: 996
batch 379, loss: 0.0535, instance_loss: 0.3423, weighted_loss: 0.1401, label: 0, bag_size: 227
batch 399, loss: 1.0637, instance_loss: 0.5132, weighted_loss: 0.8985, label: 3, bag_size: 423
batch 419, loss: 2.4513, instance_loss: 0.6377, weighted_loss: 1.9072, label: 4, bag_size: 270
batch 439, loss: 2.3597, instance_loss: 0.6567, weighted_loss: 1.8488, label: 2, bag_size: 219
batch 459, loss: 1.0845, instance_loss: 0.4946, weighted_loss: 0.9076, label: 2, bag_size: 717
batch 479, loss: 0.4866, instance_loss: 0.5934, weighted_loss: 0.5186, label: 0, bag_size: 316
batch 499, loss: 0.1871, instance_loss: 0.3386, weighted_loss: 0.2326, label: 0, bag_size: 280
batch 519, loss: 0.0757, instance_loss: 0.3739, weighted_loss: 0.1651, label: 0, bag_size: 37
batch 539, loss: 1.4809, instance_loss: 0.4400, weighted_loss: 1.1686, label: 4, bag_size: 699
batch 559, loss: 2.4993, instance_loss: 0.5226, weighted_loss: 1.9063, label: 4, bag_size: 198
batch 579, loss: 1.2034, instance_loss: 0.4647, weighted_loss: 0.9818, label: 1, bag_size: 660


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.01914983164983165: correct 91/4752
Epoch: 15, train_loss: 1.2505, train_clustering_loss:  0.4935, train_error: 0.5404
class 0: acc 0.8015267175572519, correct 105/131
class 1: acc 0.14814814814814814, correct 16/108
class 2: acc 0.453125, correct 58/128
class 3: acc 0.3783783783783784, correct 42/111
class 4: acc 0.4482758620689655, correct 52/116

Val Set, val_loss: 1.2470, val_error: 0.5135, auc: 0.7825
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.21428571428571427, correct 3/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0126, instance_loss: 0.4670, weighted_loss: 0.8489, label: 2, bag_size: 812
batch 39, loss: 0.7645, instance_loss: 0.4426, weighted_loss: 0.6680, label: 2, bag_size: 853
batch 59, loss: 0.9228, instance_loss: 0.4095, weighted_loss: 0.7688, label: 0, bag_size: 77
batch 79, loss: 0.9101, instance_loss: 0.4566, weighted_loss: 0.7741, label: 2, bag_size: 605
batch 99, loss: 1.1984, instance_loss: 0.5575, weighted_loss: 1.0062, label: 3, bag_size: 453
batch 119, loss: 1.0773, instance_loss: 0.5161, weighted_loss: 0.9089, label: 3, bag_size: 364
batch 139, loss: 1.9623, instance_loss: 0.5651, weighted_loss: 1.5431, label: 2, bag_size: 744
batch 159, loss: 1.2471, instance_loss: 0.4804, weighted_loss: 1.0171, label: 1, bag_size: 208
batch 179, loss: 0.5453, instance_loss: 0.5761, weighted_loss: 0.5545, label: 0, bag_size: 258
batch 199, loss: 1.5515, instance_loss: 0.4932, weighted_loss: 1.2340, label: 4, bag_size: 589
batch 219, loss: 2.2400, instance_loss: 0.6410, weighted_loss: 1.7603, label: 4, bag_size: 293
batch 239, loss: 1.4764, instance_loss: 0.5076, weighted_loss: 1.1858, label: 2, bag_size: 1066
batch 259, loss: 2.8679, instance_loss: 0.5875, weighted_loss: 2.1838, label: 0, bag_size: 964
batch 279, loss: 1.1205, instance_loss: 0.5181, weighted_loss: 0.9398, label: 0, bag_size: 343
batch 299, loss: 0.9926, instance_loss: 0.4454, weighted_loss: 0.8284, label: 1, bag_size: 766
batch 319, loss: 0.0333, instance_loss: 0.2661, weighted_loss: 0.1031, label: 0, bag_size: 285
batch 339, loss: 1.2018, instance_loss: 0.5217, weighted_loss: 0.9978, label: 3, bag_size: 474
batch 359, loss: 1.2097, instance_loss: 0.5475, weighted_loss: 1.0110, label: 3, bag_size: 498
batch 379, loss: 0.4583, instance_loss: 0.7514, weighted_loss: 0.5462, label: 4, bag_size: 329
batch 399, loss: 1.2742, instance_loss: 0.6243, weighted_loss: 1.0792, label: 0, bag_size: 710
batch 419, loss: 0.1759, instance_loss: 0.3102, weighted_loss: 0.2162, label: 0, bag_size: 231
batch 439, loss: 1.2501, instance_loss: 0.4955, weighted_loss: 1.0237, label: 3, bag_size: 451
batch 459, loss: 0.9548, instance_loss: 0.4666, weighted_loss: 0.8083, label: 1, bag_size: 389
batch 479, loss: 0.3033, instance_loss: 0.3755, weighted_loss: 0.3250, label: 0, bag_size: 62
batch 499, loss: 0.4209, instance_loss: 0.4496, weighted_loss: 0.4295, label: 0, bag_size: 143
batch 519, loss: 2.1788, instance_loss: 0.6898, weighted_loss: 1.7321, label: 2, bag_size: 318
batch 539, loss: 0.2598, instance_loss: 0.3469, weighted_loss: 0.2860, label: 0, bag_size: 63
batch 559, loss: 1.4236, instance_loss: 0.5389, weighted_loss: 1.1582, label: 2, bag_size: 299
batch 579, loss: 1.1244, instance_loss: 0.4839, weighted_loss: 0.9322, label: 2, bag_size: 706


class 0 clustering acc 0.9986952861952862: correct 23729/23760
class 1 clustering acc 0.023989898989898988: correct 114/4752
Epoch: 16, train_loss: 1.2212, train_clustering_loss:  0.4917, train_error: 0.5236
class 0: acc 0.8382352941176471, correct 114/136
class 1: acc 0.35, correct 42/120
class 2: acc 0.2672413793103448, correct 31/116
class 3: acc 0.46956521739130436, correct 54/115
class 4: acc 0.3925233644859813, correct 42/107

Val Set, val_loss: 1.2657, val_error: 0.5676, auc: 0.7865
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7142857142857143, correct 10/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.7839, instance_loss: 0.6163, weighted_loss: 2.1336, label: 0, bag_size: 600
batch 39, loss: 1.5345, instance_loss: 0.5430, weighted_loss: 1.2370, label: 3, bag_size: 897
batch 59, loss: 1.0264, instance_loss: 0.5423, weighted_loss: 0.8812, label: 3, bag_size: 403
batch 79, loss: 0.6828, instance_loss: 0.4228, weighted_loss: 0.6048, label: 3, bag_size: 780
batch 99, loss: 1.2986, instance_loss: 0.4855, weighted_loss: 1.0546, label: 2, bag_size: 860
batch 119, loss: 2.2572, instance_loss: 0.5163, weighted_loss: 1.7349, label: 1, bag_size: 361
batch 139, loss: 2.3507, instance_loss: 0.5579, weighted_loss: 1.8129, label: 2, bag_size: 219
batch 159, loss: 1.9812, instance_loss: 0.5576, weighted_loss: 1.5541, label: 2, bag_size: 1074
batch 179, loss: 1.4521, instance_loss: 0.4685, weighted_loss: 1.1570, label: 1, bag_size: 742
batch 199, loss: 1.3196, instance_loss: 0.5165, weighted_loss: 1.0787, label: 4, bag_size: 868
batch 219, loss: 0.0727, instance_loss: 0.2599, weighted_loss: 0.1289, label: 0, bag_size: 527
batch 239, loss: 1.4764, instance_loss: 0.4959, weighted_loss: 1.1823, label: 4, bag_size: 572
batch 259, loss: 1.2288, instance_loss: 0.5105, weighted_loss: 1.0133, label: 1, bag_size: 381
batch 279, loss: 0.9698, instance_loss: 0.4714, weighted_loss: 0.8203, label: 2, bag_size: 706
batch 299, loss: 1.2928, instance_loss: 0.4718, weighted_loss: 1.0465, label: 2, bag_size: 363
batch 319, loss: 1.3182, instance_loss: 0.5280, weighted_loss: 1.0811, label: 3, bag_size: 1057
batch 339, loss: 1.1087, instance_loss: 0.4772, weighted_loss: 0.9192, label: 3, bag_size: 1078
batch 359, loss: 1.3177, instance_loss: 0.5147, weighted_loss: 1.0768, label: 3, bag_size: 301
batch 379, loss: 0.7077, instance_loss: 0.4179, weighted_loss: 0.6207, label: 4, bag_size: 775
batch 399, loss: 0.9205, instance_loss: 0.4201, weighted_loss: 0.7704, label: 3, bag_size: 230
batch 419, loss: 1.6529, instance_loss: 0.5616, weighted_loss: 1.3255, label: 1, bag_size: 840
batch 439, loss: 2.5375, instance_loss: 0.6865, weighted_loss: 1.9822, label: 4, bag_size: 1297
batch 459, loss: 0.9385, instance_loss: 0.4091, weighted_loss: 0.7797, label: 3, bag_size: 1358
batch 479, loss: 1.6134, instance_loss: 0.4871, weighted_loss: 1.2755, label: 4, bag_size: 695
batch 499, loss: 1.3860, instance_loss: 0.5621, weighted_loss: 1.1389, label: 2, bag_size: 1077
batch 519, loss: 0.9863, instance_loss: 0.4508, weighted_loss: 0.8257, label: 1, bag_size: 161
batch 539, loss: 1.3969, instance_loss: 0.4806, weighted_loss: 1.1220, label: 2, bag_size: 411
batch 559, loss: 1.4037, instance_loss: 0.5318, weighted_loss: 1.1421, label: 3, bag_size: 102
batch 579, loss: 1.0002, instance_loss: 0.5298, weighted_loss: 0.8591, label: 2, bag_size: 853


class 0 clustering acc 0.9987373737373737: correct 23730/23760
class 1 clustering acc 0.017045454545454544: correct 81/4752
Epoch: 17, train_loss: 1.2145, train_clustering_loss:  0.4929, train_error: 0.5185
class 0: acc 0.8376068376068376, correct 98/117
class 1: acc 0.2636363636363636, correct 29/110
class 2: acc 0.3893129770992366, correct 51/131
class 3: acc 0.5, correct 63/126
class 4: acc 0.4090909090909091, correct 45/110

Val Set, val_loss: 1.2459, val_error: 0.5541, auc: 0.7794
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.0, correct 0/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2246, instance_loss: 0.4999, weighted_loss: 1.0072, label: 3, bag_size: 258
batch 39, loss: 0.9060, instance_loss: 0.4195, weighted_loss: 0.7600, label: 3, bag_size: 102
batch 59, loss: 1.2196, instance_loss: 0.5423, weighted_loss: 1.0164, label: 1, bag_size: 381
batch 79, loss: 1.7341, instance_loss: 0.5713, weighted_loss: 1.3853, label: 4, bag_size: 824
batch 99, loss: 0.1894, instance_loss: 0.3382, weighted_loss: 0.2340, label: 0, bag_size: 366
batch 119, loss: 0.1179, instance_loss: 0.3446, weighted_loss: 0.1859, label: 0, bag_size: 397
batch 139, loss: 1.7949, instance_loss: 0.4697, weighted_loss: 1.3973, label: 1, bag_size: 208
batch 159, loss: 1.2803, instance_loss: 0.5181, weighted_loss: 1.0517, label: 1, bag_size: 350
batch 179, loss: 0.7246, instance_loss: 0.3907, weighted_loss: 0.6244, label: 3, bag_size: 473
batch 199, loss: 1.9495, instance_loss: 0.6072, weighted_loss: 1.5468, label: 4, bag_size: 267
batch 219, loss: 0.3787, instance_loss: 0.4258, weighted_loss: 0.3928, label: 0, bag_size: 404
batch 239, loss: 1.2108, instance_loss: 0.4679, weighted_loss: 0.9879, label: 1, bag_size: 949
batch 259, loss: 1.9689, instance_loss: 0.5320, weighted_loss: 1.5378, label: 2, bag_size: 941
batch 279, loss: 1.3947, instance_loss: 0.5107, weighted_loss: 1.1295, label: 3, bag_size: 961
batch 299, loss: 0.7146, instance_loss: 0.4275, weighted_loss: 0.6285, label: 3, bag_size: 344
batch 319, loss: 1.1411, instance_loss: 0.4815, weighted_loss: 0.9432, label: 1, bag_size: 748
batch 339, loss: 1.1592, instance_loss: 0.6187, weighted_loss: 0.9971, label: 3, bag_size: 403
batch 359, loss: 0.6561, instance_loss: 0.3691, weighted_loss: 0.5700, label: 4, bag_size: 875
batch 379, loss: 1.0187, instance_loss: 0.4230, weighted_loss: 0.8400, label: 3, bag_size: 727
batch 399, loss: 0.9240, instance_loss: 0.5049, weighted_loss: 0.7983, label: 2, bag_size: 769
batch 419, loss: 1.5292, instance_loss: 0.5252, weighted_loss: 1.2280, label: 1, bag_size: 422
batch 439, loss: 0.9788, instance_loss: 0.4527, weighted_loss: 0.8210, label: 2, bag_size: 613
batch 459, loss: 0.0333, instance_loss: 0.2874, weighted_loss: 0.1095, label: 0, bag_size: 221
batch 479, loss: 1.2087, instance_loss: 0.5879, weighted_loss: 1.0225, label: 4, bag_size: 318
batch 499, loss: 0.5222, instance_loss: 0.4214, weighted_loss: 0.4920, label: 2, bag_size: 779
batch 519, loss: 1.2111, instance_loss: 0.4630, weighted_loss: 0.9867, label: 1, bag_size: 614
batch 539, loss: 1.6422, instance_loss: 0.5806, weighted_loss: 1.3237, label: 1, bag_size: 419
batch 559, loss: 1.1566, instance_loss: 0.5254, weighted_loss: 0.9673, label: 3, bag_size: 944
batch 579, loss: 1.8930, instance_loss: 0.5212, weighted_loss: 1.4815, label: 2, bag_size: 861


class 0 clustering acc 0.9981481481481481: correct 23716/23760
class 1 clustering acc 0.010942760942760943: correct 52/4752
Epoch: 18, train_loss: 1.2433, train_clustering_loss:  0.4987, train_error: 0.5606
class 0: acc 0.7741935483870968, correct 96/124
class 1: acc 0.2809917355371901, correct 34/121
class 2: acc 0.29245283018867924, correct 31/106
class 3: acc 0.4444444444444444, correct 56/126
class 4: acc 0.37606837606837606, correct 44/117

Val Set, val_loss: 1.2155, val_error: 0.4595, auc: 0.8113
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.236021 --> 1.215472).  Saving model ...


batch 19, loss: 1.1122, instance_loss: 0.5059, weighted_loss: 0.9303, label: 2, bag_size: 640
batch 39, loss: 0.9303, instance_loss: 0.5496, weighted_loss: 0.8160, label: 2, bag_size: 208
batch 59, loss: 1.7098, instance_loss: 0.5185, weighted_loss: 1.3524, label: 4, bag_size: 592
batch 79, loss: 1.7784, instance_loss: 0.4974, weighted_loss: 1.3941, label: 4, bag_size: 363
batch 99, loss: 0.5558, instance_loss: 0.4177, weighted_loss: 0.5144, label: 2, bag_size: 376
batch 119, loss: 0.9607, instance_loss: 0.4655, weighted_loss: 0.8121, label: 3, bag_size: 1328
batch 139, loss: 0.4280, instance_loss: 0.5397, weighted_loss: 0.4615, label: 0, bag_size: 573
batch 159, loss: 0.0091, instance_loss: 0.3217, weighted_loss: 0.1029, label: 0, bag_size: 268
batch 179, loss: 3.0438, instance_loss: 0.5209, weighted_loss: 2.2869, label: 3, bag_size: 497
batch 199, loss: 1.0434, instance_loss: 0.4582, weighted_loss: 0.8678, label: 1, bag_size: 328
batch 219, loss: 1.9251, instance_loss: 0.5331, weighted_loss: 1.5075, label: 2, bag_size: 576
batch 239, loss: 1.3080, instance_loss: 0.5005, weighted_loss: 1.0658, label: 2, bag_size: 853
batch 259, loss: 1.2483, instance_loss: 0.4278, weighted_loss: 1.0021, label: 1, bag_size: 1104
batch 279, loss: 1.5158, instance_loss: 0.4856, weighted_loss: 1.2068, label: 0, bag_size: 367
batch 299, loss: 0.0257, instance_loss: 0.3176, weighted_loss: 0.1133, label: 0, bag_size: 221
batch 319, loss: 2.1193, instance_loss: 0.5587, weighted_loss: 1.6511, label: 2, bag_size: 1074
batch 339, loss: 1.1475, instance_loss: 0.5087, weighted_loss: 0.9558, label: 2, bag_size: 337
batch 359, loss: 0.8070, instance_loss: 0.4712, weighted_loss: 0.7062, label: 3, bag_size: 697
batch 379, loss: 1.3660, instance_loss: 0.4088, weighted_loss: 1.0789, label: 3, bag_size: 996
batch 399, loss: 2.2162, instance_loss: 0.5905, weighted_loss: 1.7285, label: 2, bag_size: 549
batch 419, loss: 2.4484, instance_loss: 0.5638, weighted_loss: 1.8830, label: 1, bag_size: 764
batch 439, loss: 1.4897, instance_loss: 0.4756, weighted_loss: 1.1855, label: 1, bag_size: 311
batch 459, loss: 1.8313, instance_loss: 0.5269, weighted_loss: 1.4400, label: 2, bag_size: 941
batch 479, loss: 2.6412, instance_loss: 0.6162, weighted_loss: 2.0337, label: 4, bag_size: 482
batch 499, loss: 1.1105, instance_loss: 0.5094, weighted_loss: 0.9302, label: 3, bag_size: 369
batch 519, loss: 2.5940, instance_loss: 0.5915, weighted_loss: 1.9933, label: 2, bag_size: 563
batch 539, loss: 0.4476, instance_loss: 0.4104, weighted_loss: 0.4364, label: 1, bag_size: 669
batch 559, loss: 0.6001, instance_loss: 0.4801, weighted_loss: 0.5641, label: 4, bag_size: 627
batch 579, loss: 0.3516, instance_loss: 0.5289, weighted_loss: 0.4048, label: 4, bag_size: 46


class 0 clustering acc 0.9993265993265993: correct 23744/23760
class 1 clustering acc 0.003367003367003367: correct 16/4752
Epoch: 19, train_loss: 1.2312, train_clustering_loss:  0.4933, train_error: 0.5404
class 0: acc 0.7454545454545455, correct 82/110
class 1: acc 0.496551724137931, correct 72/145
class 2: acc 0.25217391304347825, correct 29/115
class 3: acc 0.4482758620689655, correct 52/116
class 4: acc 0.35185185185185186, correct 38/108

Val Set, val_loss: 1.3049, val_error: 0.5000, auc: 0.7804
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9726, instance_loss: 0.5058, weighted_loss: 1.5325, label: 0, bag_size: 77
batch 39, loss: 1.0204, instance_loss: 0.5163, weighted_loss: 0.8692, label: 2, bag_size: 769
batch 59, loss: 1.3361, instance_loss: 0.4968, weighted_loss: 1.0843, label: 0, bag_size: 587
batch 79, loss: 0.0692, instance_loss: 0.3554, weighted_loss: 0.1550, label: 0, bag_size: 370
batch 99, loss: 1.4508, instance_loss: 0.4763, weighted_loss: 1.1585, label: 4, bag_size: 264
batch 119, loss: 2.6500, instance_loss: 0.6200, weighted_loss: 2.0410, label: 3, bag_size: 533
batch 139, loss: 0.6006, instance_loss: 0.5120, weighted_loss: 0.5740, label: 0, bag_size: 587
batch 159, loss: 0.8012, instance_loss: 0.4465, weighted_loss: 0.6948, label: 3, bag_size: 505
batch 179, loss: 1.4925, instance_loss: 0.5242, weighted_loss: 1.2020, label: 3, bag_size: 1358
batch 199, loss: 0.5286, instance_loss: 0.3790, weighted_loss: 0.4837, label: 0, bag_size: 81
batch 219, loss: 0.9279, instance_loss: 0.5750, weighted_loss: 0.8221, label: 1, bag_size: 311
batch 239, loss: 2.1910, instance_loss: 0.5811, weighted_loss: 1.7080, label: 1, bag_size: 564
batch 259, loss: 1.2951, instance_loss: 0.5042, weighted_loss: 1.0578, label: 2, bag_size: 258
batch 279, loss: 0.3246, instance_loss: 0.3246, weighted_loss: 0.3246, label: 3, bag_size: 272
batch 299, loss: 2.9126, instance_loss: 0.6955, weighted_loss: 2.2475, label: 2, bag_size: 606
batch 319, loss: 1.2629, instance_loss: 0.4749, weighted_loss: 1.0265, label: 1, bag_size: 221
batch 339, loss: 0.9170, instance_loss: 0.5241, weighted_loss: 0.7991, label: 4, bag_size: 712
batch 359, loss: 2.4952, instance_loss: 0.6409, weighted_loss: 1.9389, label: 2, bag_size: 219
batch 379, loss: 0.6577, instance_loss: 0.5247, weighted_loss: 0.6178, label: 1, bag_size: 1360
batch 399, loss: 1.5241, instance_loss: 0.5045, weighted_loss: 1.2182, label: 3, bag_size: 1076
batch 419, loss: 0.2304, instance_loss: 0.4849, weighted_loss: 0.3068, label: 0, bag_size: 573
batch 439, loss: 0.7334, instance_loss: 0.4904, weighted_loss: 0.6605, label: 4, bag_size: 520
batch 459, loss: 0.0536, instance_loss: 0.2605, weighted_loss: 0.1157, label: 0, bag_size: 488
batch 479, loss: 0.9949, instance_loss: 0.3976, weighted_loss: 0.8157, label: 3, bag_size: 1076
batch 499, loss: 1.2979, instance_loss: 0.4292, weighted_loss: 1.0373, label: 4, bag_size: 53
batch 519, loss: 1.8542, instance_loss: 0.4933, weighted_loss: 1.4459, label: 4, bag_size: 198
batch 539, loss: 1.0372, instance_loss: 0.4746, weighted_loss: 0.8684, label: 2, bag_size: 783
batch 559, loss: 1.4355, instance_loss: 0.5116, weighted_loss: 1.1583, label: 1, bag_size: 221
batch 579, loss: 1.5692, instance_loss: 0.5287, weighted_loss: 1.2571, label: 1, bag_size: 490


class 0 clustering acc 0.9986111111111111: correct 23727/23760
class 1 clustering acc 0.012626262626262626: correct 60/4752
Epoch: 20, train_loss: 1.1395, train_clustering_loss:  0.4879, train_error: 0.5135
class 0: acc 0.8540145985401459, correct 117/137
class 1: acc 0.2909090909090909, correct 32/110
class 2: acc 0.2549019607843137, correct 26/102
class 3: acc 0.5114503816793893, correct 67/131
class 4: acc 0.41228070175438597, correct 47/114

Val Set, val_loss: 1.3848, val_error: 0.5676, auc: 0.7554
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1906, instance_loss: 0.4566, weighted_loss: 0.9704, label: 3, bag_size: 1154
batch 39, loss: 1.0515, instance_loss: 0.5272, weighted_loss: 0.8942, label: 2, bag_size: 286
batch 59, loss: 0.5717, instance_loss: 0.3453, weighted_loss: 0.5038, label: 4, bag_size: 775
batch 79, loss: 0.8992, instance_loss: 0.4670, weighted_loss: 0.7695, label: 3, bag_size: 858
batch 99, loss: 1.2412, instance_loss: 0.5636, weighted_loss: 1.0379, label: 1, bag_size: 1009
batch 119, loss: 0.2835, instance_loss: 0.5455, weighted_loss: 0.3621, label: 0, bag_size: 416
batch 139, loss: 1.2932, instance_loss: 0.4829, weighted_loss: 1.0501, label: 2, bag_size: 135
batch 159, loss: 0.4591, instance_loss: 0.4789, weighted_loss: 0.4651, label: 4, bag_size: 1158
batch 179, loss: 0.9162, instance_loss: 0.4131, weighted_loss: 0.7653, label: 3, bag_size: 369
batch 199, loss: 1.2197, instance_loss: 0.4760, weighted_loss: 0.9966, label: 3, bag_size: 235
batch 219, loss: 1.1728, instance_loss: 0.4951, weighted_loss: 0.9695, label: 2, bag_size: 375
batch 239, loss: 1.4852, instance_loss: 0.5056, weighted_loss: 1.1913, label: 2, bag_size: 321
batch 259, loss: 1.0712, instance_loss: 0.4843, weighted_loss: 0.8951, label: 4, bag_size: 690
batch 279, loss: 0.5403, instance_loss: 0.4137, weighted_loss: 0.5023, label: 3, bag_size: 344
batch 299, loss: 1.0085, instance_loss: 0.4543, weighted_loss: 0.8423, label: 4, bag_size: 690
batch 319, loss: 0.2325, instance_loss: 0.4865, weighted_loss: 0.3087, label: 0, bag_size: 524
batch 339, loss: 0.0028, instance_loss: 0.3678, weighted_loss: 0.1123, label: 0, bag_size: 428
batch 359, loss: 0.0819, instance_loss: 0.3762, weighted_loss: 0.1702, label: 0, bag_size: 351
batch 379, loss: 1.0288, instance_loss: 0.4912, weighted_loss: 0.8675, label: 3, bag_size: 982
batch 399, loss: 1.0267, instance_loss: 0.4570, weighted_loss: 0.8558, label: 3, bag_size: 245
batch 419, loss: 0.4180, instance_loss: 0.3886, weighted_loss: 0.4092, label: 4, bag_size: 1158
batch 439, loss: 0.6824, instance_loss: 0.4583, weighted_loss: 0.6151, label: 3, bag_size: 684
batch 459, loss: 0.1676, instance_loss: 0.3614, weighted_loss: 0.2257, label: 0, bag_size: 435
batch 479, loss: 1.2537, instance_loss: 0.5167, weighted_loss: 1.0326, label: 2, bag_size: 1077
batch 499, loss: 0.7180, instance_loss: 0.3839, weighted_loss: 0.6178, label: 1, bag_size: 1273
batch 519, loss: 0.9951, instance_loss: 0.4450, weighted_loss: 0.8301, label: 1, bag_size: 1019
batch 539, loss: 1.7287, instance_loss: 0.4708, weighted_loss: 1.3513, label: 1, bag_size: 208
batch 559, loss: 2.0254, instance_loss: 0.4705, weighted_loss: 1.5589, label: 1, bag_size: 339
batch 579, loss: 0.6684, instance_loss: 0.4812, weighted_loss: 0.6123, label: 3, bag_size: 1328


class 0 clustering acc 0.998526936026936: correct 23725/23760
class 1 clustering acc 0.020622895622895623: correct 98/4752
Epoch: 21, train_loss: 1.1951, train_clustering_loss:  0.4924, train_error: 0.5269
class 0: acc 0.8016528925619835, correct 97/121
class 1: acc 0.3565217391304348, correct 41/115
class 2: acc 0.3046875, correct 39/128
class 3: acc 0.45614035087719296, correct 52/114
class 4: acc 0.4482758620689655, correct 52/116

Val Set, val_loss: 1.2256, val_error: 0.5270, auc: 0.8043
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6842, instance_loss: 0.5177, weighted_loss: 1.3343, label: 3, bag_size: 451
batch 39, loss: 3.6556, instance_loss: 0.6137, weighted_loss: 2.7430, label: 1, bag_size: 44
batch 59, loss: 1.0311, instance_loss: 0.5165, weighted_loss: 0.8768, label: 1, bag_size: 328
batch 79, loss: 1.0861, instance_loss: 0.4570, weighted_loss: 0.8974, label: 2, bag_size: 821
batch 99, loss: 1.8864, instance_loss: 0.4669, weighted_loss: 1.4605, label: 3, bag_size: 149
batch 119, loss: 1.3875, instance_loss: 0.4425, weighted_loss: 1.1040, label: 3, bag_size: 301
batch 139, loss: 1.7813, instance_loss: 0.4751, weighted_loss: 1.3894, label: 1, bag_size: 381
batch 159, loss: 1.7288, instance_loss: 0.5370, weighted_loss: 1.3712, label: 1, bag_size: 398
batch 179, loss: 0.7124, instance_loss: 0.4616, weighted_loss: 0.6372, label: 4, bag_size: 409
batch 199, loss: 1.5987, instance_loss: 0.5041, weighted_loss: 1.2703, label: 2, bag_size: 557
batch 219, loss: 1.2682, instance_loss: 0.6206, weighted_loss: 1.0739, label: 4, bag_size: 712
batch 239, loss: 1.6692, instance_loss: 0.5805, weighted_loss: 1.3426, label: 4, bag_size: 1031
batch 259, loss: 0.7590, instance_loss: 0.4125, weighted_loss: 0.6551, label: 2, bag_size: 953
batch 279, loss: 1.1275, instance_loss: 0.5564, weighted_loss: 0.9561, label: 3, bag_size: 631
batch 299, loss: 1.0406, instance_loss: 0.4918, weighted_loss: 0.8760, label: 3, bag_size: 1232
batch 319, loss: 1.5556, instance_loss: 0.5149, weighted_loss: 1.2434, label: 2, bag_size: 258
batch 339, loss: 1.3634, instance_loss: 0.4915, weighted_loss: 1.1018, label: 1, bag_size: 1121
batch 359, loss: 0.8282, instance_loss: 0.4319, weighted_loss: 0.7093, label: 1, bag_size: 201
batch 379, loss: 1.6359, instance_loss: 0.4941, weighted_loss: 1.2934, label: 2, bag_size: 361
batch 399, loss: 0.3169, instance_loss: 0.4103, weighted_loss: 0.3449, label: 2, bag_size: 953
batch 419, loss: 0.6985, instance_loss: 0.6948, weighted_loss: 0.6974, label: 0, bag_size: 421
batch 439, loss: 1.3491, instance_loss: 0.4687, weighted_loss: 1.0850, label: 3, bag_size: 317
batch 459, loss: 0.7466, instance_loss: 0.5103, weighted_loss: 0.6757, label: 1, bag_size: 1091
batch 479, loss: 0.8163, instance_loss: 0.4853, weighted_loss: 0.7170, label: 3, bag_size: 154
batch 499, loss: 2.3617, instance_loss: 0.6927, weighted_loss: 1.8610, label: 0, bag_size: 1085
batch 519, loss: 1.8408, instance_loss: 0.5461, weighted_loss: 1.4524, label: 4, bag_size: 592
batch 539, loss: 2.0754, instance_loss: 0.5225, weighted_loss: 1.6095, label: 3, bag_size: 779
batch 559, loss: 1.4629, instance_loss: 0.4540, weighted_loss: 1.1602, label: 2, bag_size: 171
batch 579, loss: 2.8098, instance_loss: 0.5089, weighted_loss: 2.1195, label: 4, bag_size: 399


class 0 clustering acc 0.9987794612794613: correct 23731/23760
class 1 clustering acc 0.013678451178451179: correct 65/4752
Epoch: 22, train_loss: 1.1675, train_clustering_loss:  0.4888, train_error: 0.4680
class 0: acc 0.8099173553719008, correct 98/121
class 1: acc 0.4418604651162791, correct 57/129
class 2: acc 0.38333333333333336, correct 46/120
class 3: acc 0.5, correct 58/116
class 4: acc 0.5277777777777778, correct 57/108

Val Set, val_loss: 1.2078, val_error: 0.5000, auc: 0.8113
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
Validation loss decreased (1.215472 --> 1.207816).  Saving model ...


batch 19, loss: 0.8412, instance_loss: 0.4093, weighted_loss: 0.7116, label: 2, bag_size: 953
batch 39, loss: 0.7743, instance_loss: 0.3881, weighted_loss: 0.6584, label: 3, bag_size: 459
batch 59, loss: 0.8849, instance_loss: 0.4293, weighted_loss: 0.7482, label: 1, bag_size: 702
batch 79, loss: 2.7395, instance_loss: 0.5736, weighted_loss: 2.0897, label: 2, bag_size: 606
batch 99, loss: 0.5760, instance_loss: 0.3673, weighted_loss: 0.5133, label: 4, bag_size: 419
batch 119, loss: 0.0059, instance_loss: 0.3330, weighted_loss: 0.1041, label: 0, bag_size: 258
batch 139, loss: 0.8679, instance_loss: 0.4730, weighted_loss: 0.7494, label: 3, bag_size: 499
batch 159, loss: 0.9795, instance_loss: 0.4905, weighted_loss: 0.8328, label: 0, bag_size: 428
batch 179, loss: 2.2877, instance_loss: 0.5352, weighted_loss: 1.7620, label: 3, bag_size: 258
batch 199, loss: 1.0685, instance_loss: 0.4608, weighted_loss: 0.8862, label: 2, bag_size: 779
batch 219, loss: 0.1048, instance_loss: 0.2882, weighted_loss: 0.1598, label: 0, bag_size: 97
batch 239, loss: 1.0067, instance_loss: 0.4408, weighted_loss: 0.8369, label: 4, bag_size: 198
batch 259, loss: 0.9510, instance_loss: 0.4860, weighted_loss: 0.8115, label: 2, bag_size: 171
batch 279, loss: 1.0915, instance_loss: 0.5045, weighted_loss: 0.9154, label: 2, bag_size: 557
batch 299, loss: 1.0811, instance_loss: 0.5152, weighted_loss: 0.9113, label: 1, bag_size: 1023
batch 319, loss: 1.1503, instance_loss: 0.4954, weighted_loss: 0.9538, label: 4, bag_size: 868
batch 339, loss: 1.2791, instance_loss: 0.4987, weighted_loss: 1.0450, label: 4, bag_size: 267
batch 359, loss: 2.0167, instance_loss: 0.6139, weighted_loss: 1.5958, label: 4, bag_size: 333
batch 379, loss: 0.2673, instance_loss: 0.2894, weighted_loss: 0.2739, label: 0, bag_size: 192
batch 399, loss: 1.2166, instance_loss: 0.4819, weighted_loss: 0.9962, label: 1, bag_size: 398
batch 419, loss: 0.7828, instance_loss: 0.4142, weighted_loss: 0.6722, label: 3, bag_size: 944
batch 439, loss: 0.3128, instance_loss: 0.3642, weighted_loss: 0.3282, label: 0, bag_size: 74
batch 459, loss: 1.7683, instance_loss: 0.5640, weighted_loss: 1.4070, label: 2, bag_size: 717
batch 479, loss: 1.6149, instance_loss: 0.5257, weighted_loss: 1.2881, label: 1, bag_size: 398
batch 499, loss: 0.6182, instance_loss: 0.3975, weighted_loss: 0.5520, label: 2, bag_size: 779
batch 519, loss: 2.0618, instance_loss: 0.4853, weighted_loss: 1.5888, label: 1, bag_size: 208
batch 539, loss: 1.3817, instance_loss: 0.6641, weighted_loss: 1.1664, label: 0, bag_size: 311
batch 559, loss: 1.3131, instance_loss: 0.5076, weighted_loss: 1.0715, label: 3, bag_size: 98
batch 579, loss: 1.4842, instance_loss: 0.5046, weighted_loss: 1.1903, label: 1, bag_size: 311


class 0 clustering acc 0.9982323232323232: correct 23718/23760
class 1 clustering acc 0.011153198653198653: correct 53/4752
Epoch: 23, train_loss: 1.1928, train_clustering_loss:  0.4943, train_error: 0.5101
class 0: acc 0.7631578947368421, correct 87/114
class 1: acc 0.4796747967479675, correct 59/123
class 2: acc 0.26666666666666666, correct 32/120
class 3: acc 0.5572519083969466, correct 73/131
class 4: acc 0.37735849056603776, correct 40/106

Val Set, val_loss: 1.1532, val_error: 0.5000, auc: 0.8233
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.21428571428571427, correct 3/14
Validation loss decreased (1.207816 --> 1.153202).  Saving model ...


batch 19, loss: 0.7096, instance_loss: 0.3961, weighted_loss: 0.6155, label: 3, bag_size: 403
batch 39, loss: 1.5212, instance_loss: 0.7578, weighted_loss: 1.2922, label: 4, bag_size: 490
batch 59, loss: 0.8197, instance_loss: 0.4569, weighted_loss: 0.7108, label: 2, bag_size: 633
batch 79, loss: 1.0944, instance_loss: 0.4401, weighted_loss: 0.8981, label: 2, bag_size: 380
batch 99, loss: 1.1843, instance_loss: 0.5372, weighted_loss: 0.9902, label: 3, bag_size: 282
batch 119, loss: 1.3570, instance_loss: 0.5039, weighted_loss: 1.1011, label: 1, bag_size: 981
batch 139, loss: 1.5684, instance_loss: 0.5291, weighted_loss: 1.2566, label: 3, bag_size: 476
batch 159, loss: 1.2937, instance_loss: 0.5058, weighted_loss: 1.0573, label: 4, bag_size: 363
batch 179, loss: 1.1359, instance_loss: 0.4583, weighted_loss: 0.9326, label: 2, bag_size: 337
batch 199, loss: 2.0596, instance_loss: 0.5065, weighted_loss: 1.5937, label: 1, bag_size: 272
batch 219, loss: 1.0644, instance_loss: 0.5480, weighted_loss: 0.9095, label: 3, bag_size: 1021
batch 239, loss: 1.0974, instance_loss: 0.4475, weighted_loss: 0.9024, label: 2, bag_size: 119
batch 259, loss: 0.0266, instance_loss: 0.3745, weighted_loss: 0.1310, label: 0, bag_size: 370
batch 279, loss: 0.9689, instance_loss: 0.4305, weighted_loss: 0.8074, label: 3, bag_size: 309
batch 299, loss: 0.2734, instance_loss: 0.4811, weighted_loss: 0.3357, label: 0, bag_size: 324
batch 319, loss: 1.5838, instance_loss: 0.4827, weighted_loss: 1.2534, label: 4, bag_size: 419
batch 339, loss: 0.6992, instance_loss: 0.4903, weighted_loss: 0.6365, label: 1, bag_size: 328
batch 359, loss: 0.8091, instance_loss: 0.4592, weighted_loss: 0.7041, label: 3, bag_size: 473
batch 379, loss: 0.9534, instance_loss: 0.3775, weighted_loss: 0.7807, label: 3, bag_size: 631
batch 399, loss: 0.8919, instance_loss: 0.4533, weighted_loss: 0.7603, label: 4, bag_size: 775
batch 419, loss: 1.6200, instance_loss: 0.5511, weighted_loss: 1.2993, label: 2, bag_size: 607
batch 439, loss: 2.2125, instance_loss: 0.5063, weighted_loss: 1.7006, label: 1, bag_size: 184
batch 459, loss: 0.6563, instance_loss: 0.4253, weighted_loss: 0.5870, label: 4, bag_size: 520
batch 479, loss: 0.7807, instance_loss: 0.5027, weighted_loss: 0.6973, label: 1, bag_size: 161
batch 499, loss: 1.3042, instance_loss: 0.4981, weighted_loss: 1.0624, label: 4, bag_size: 1064
batch 519, loss: 0.7000, instance_loss: 0.4573, weighted_loss: 0.6272, label: 3, bag_size: 457
batch 539, loss: 0.1639, instance_loss: 0.3211, weighted_loss: 0.2111, label: 0, bag_size: 122
batch 559, loss: 0.0954, instance_loss: 0.3012, weighted_loss: 0.1571, label: 0, bag_size: 79
batch 579, loss: 1.2995, instance_loss: 0.6166, weighted_loss: 1.0946, label: 2, bag_size: 702


class 0 clustering acc 0.9980218855218855: correct 23713/23760
class 1 clustering acc 0.015782828282828284: correct 75/4752
Epoch: 24, train_loss: 1.1491, train_clustering_loss:  0.4917, train_error: 0.4680
class 0: acc 0.8203125, correct 105/128
class 1: acc 0.41025641025641024, correct 48/117
class 2: acc 0.3853211009174312, correct 42/109
class 3: acc 0.5087719298245614, correct 58/114
class 4: acc 0.5, correct 63/126

Val Set, val_loss: 1.2496, val_error: 0.4459, auc: 0.8041
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.21428571428571427, correct 3/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0113, instance_loss: 0.2507, weighted_loss: 0.0831, label: 0, bag_size: 80
batch 39, loss: 1.0377, instance_loss: 0.5186, weighted_loss: 0.8820, label: 4, bag_size: 660
batch 59, loss: 2.4462, instance_loss: 0.5170, weighted_loss: 1.8674, label: 1, bag_size: 742
batch 79, loss: 0.9335, instance_loss: 0.6056, weighted_loss: 0.8351, label: 2, bag_size: 25
batch 99, loss: 0.4757, instance_loss: 0.4025, weighted_loss: 0.4537, label: 3, bag_size: 309
batch 119, loss: 0.8225, instance_loss: 0.3675, weighted_loss: 0.6860, label: 3, bag_size: 996
batch 139, loss: 0.2518, instance_loss: 0.3453, weighted_loss: 0.2798, label: 0, bag_size: 192
batch 159, loss: 0.4066, instance_loss: 0.4211, weighted_loss: 0.4110, label: 3, bag_size: 194
batch 179, loss: 0.6123, instance_loss: 0.4307, weighted_loss: 0.5578, label: 3, bag_size: 351
batch 199, loss: 1.4932, instance_loss: 0.5105, weighted_loss: 1.1984, label: 4, bag_size: 729
batch 219, loss: 1.6537, instance_loss: 0.5524, weighted_loss: 1.3233, label: 1, bag_size: 419
batch 239, loss: 1.2551, instance_loss: 0.7317, weighted_loss: 1.0981, label: 0, bag_size: 421
batch 259, loss: 0.1412, instance_loss: 0.3620, weighted_loss: 0.2075, label: 0, bag_size: 74
batch 279, loss: 1.6330, instance_loss: 0.5116, weighted_loss: 1.2966, label: 4, bag_size: 363
batch 299, loss: 1.0854, instance_loss: 0.4912, weighted_loss: 0.9071, label: 3, bag_size: 120
batch 319, loss: 1.9744, instance_loss: 0.5691, weighted_loss: 1.5528, label: 1, bag_size: 221
batch 339, loss: 1.9827, instance_loss: 0.4603, weighted_loss: 1.5260, label: 2, bag_size: 861
batch 359, loss: 1.3809, instance_loss: 0.6153, weighted_loss: 1.1512, label: 0, bag_size: 178
batch 379, loss: 1.3384, instance_loss: 0.5395, weighted_loss: 1.0987, label: 1, bag_size: 221
batch 399, loss: 1.3272, instance_loss: 0.4784, weighted_loss: 1.0725, label: 1, bag_size: 526
batch 419, loss: 0.4736, instance_loss: 0.4558, weighted_loss: 0.4682, label: 4, bag_size: 520
batch 439, loss: 1.9318, instance_loss: 0.5466, weighted_loss: 1.5163, label: 4, bag_size: 399
batch 459, loss: 0.8080, instance_loss: 0.4656, weighted_loss: 0.7053, label: 1, bag_size: 855
batch 479, loss: 2.2749, instance_loss: 0.5655, weighted_loss: 1.7621, label: 3, bag_size: 1147
batch 499, loss: 1.1453, instance_loss: 0.5151, weighted_loss: 0.9563, label: 3, bag_size: 944
batch 519, loss: 0.6948, instance_loss: 0.4913, weighted_loss: 0.6338, label: 3, bag_size: 301
batch 539, loss: 0.1049, instance_loss: 0.5004, weighted_loss: 0.2236, label: 0, bag_size: 524
batch 559, loss: 0.6137, instance_loss: 0.3981, weighted_loss: 0.5490, label: 3, bag_size: 684
batch 579, loss: 0.8941, instance_loss: 0.3833, weighted_loss: 0.7408, label: 3, bag_size: 1328


class 0 clustering acc 0.9989478114478114: correct 23735/23760
class 1 clustering acc 0.011574074074074073: correct 55/4752
Epoch: 25, train_loss: 1.1414, train_clustering_loss:  0.4964, train_error: 0.5101
class 0: acc 0.813953488372093, correct 105/129
class 1: acc 0.4661016949152542, correct 55/118
class 2: acc 0.25210084033613445, correct 30/119
class 3: acc 0.46153846153846156, correct 54/117
class 4: acc 0.42342342342342343, correct 47/111

Val Set, val_loss: 1.1834, val_error: 0.4324, auc: 0.8064
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6164, instance_loss: 0.4712, weighted_loss: 0.5728, label: 4, bag_size: 689
batch 39, loss: 0.1284, instance_loss: 0.4725, weighted_loss: 0.2316, label: 0, bag_size: 416
batch 59, loss: 0.0280, instance_loss: 0.3058, weighted_loss: 0.1113, label: 0, bag_size: 188
batch 79, loss: 0.5632, instance_loss: 0.4623, weighted_loss: 0.5330, label: 1, bag_size: 874
batch 99, loss: 1.0691, instance_loss: 0.4600, weighted_loss: 0.8864, label: 1, bag_size: 355
batch 119, loss: 0.0894, instance_loss: 0.4643, weighted_loss: 0.2019, label: 1, bag_size: 141
batch 139, loss: 0.4660, instance_loss: 0.3833, weighted_loss: 0.4412, label: 1, bag_size: 271
batch 159, loss: 1.6802, instance_loss: 0.5494, weighted_loss: 1.3410, label: 4, bag_size: 592
batch 179, loss: 0.0306, instance_loss: 0.2822, weighted_loss: 0.1061, label: 0, bag_size: 280
batch 199, loss: 1.4279, instance_loss: 0.5369, weighted_loss: 1.1606, label: 4, bag_size: 740
batch 219, loss: 2.3241, instance_loss: 0.5474, weighted_loss: 1.7911, label: 3, bag_size: 230
batch 239, loss: 1.4339, instance_loss: 0.5702, weighted_loss: 1.1748, label: 2, bag_size: 1197
batch 259, loss: 0.7993, instance_loss: 0.5401, weighted_loss: 0.7216, label: 4, bag_size: 727
batch 279, loss: 0.7890, instance_loss: 0.5345, weighted_loss: 0.7127, label: 0, bag_size: 81
batch 299, loss: 1.0829, instance_loss: 0.4651, weighted_loss: 0.8976, label: 2, bag_size: 844
batch 319, loss: 1.2926, instance_loss: 0.4899, weighted_loss: 1.0518, label: 2, bag_size: 1092
batch 339, loss: 2.0266, instance_loss: 0.5495, weighted_loss: 1.5835, label: 0, bag_size: 600
batch 359, loss: 2.0344, instance_loss: 0.6192, weighted_loss: 1.6099, label: 1, bag_size: 381
batch 379, loss: 1.4382, instance_loss: 0.5352, weighted_loss: 1.1673, label: 3, bag_size: 961
batch 399, loss: 0.6215, instance_loss: 0.4372, weighted_loss: 0.5662, label: 1, bag_size: 748
batch 419, loss: 1.0702, instance_loss: 0.4850, weighted_loss: 0.8946, label: 1, bag_size: 865
batch 439, loss: 1.5235, instance_loss: 0.5225, weighted_loss: 1.2232, label: 0, bag_size: 615
batch 459, loss: 2.4712, instance_loss: 0.5585, weighted_loss: 1.8974, label: 3, bag_size: 166
batch 479, loss: 1.9741, instance_loss: 0.5128, weighted_loss: 1.5357, label: 2, bag_size: 809
batch 499, loss: 0.8566, instance_loss: 0.4285, weighted_loss: 0.7282, label: 2, bag_size: 582
batch 519, loss: 1.8244, instance_loss: 0.5841, weighted_loss: 1.4523, label: 3, bag_size: 1057
batch 539, loss: 2.4453, instance_loss: 0.5694, weighted_loss: 1.8825, label: 1, bag_size: 361
batch 559, loss: 0.0889, instance_loss: 0.3155, weighted_loss: 0.1568, label: 0, bag_size: 366
batch 579, loss: 0.3217, instance_loss: 0.3785, weighted_loss: 0.3387, label: 1, bag_size: 886


class 0 clustering acc 0.9977272727272727: correct 23706/23760
class 1 clustering acc 0.0180976430976431: correct 86/4752
Epoch: 26, train_loss: 1.1016, train_clustering_loss:  0.4886, train_error: 0.4714
class 0: acc 0.848, correct 106/125
class 1: acc 0.48360655737704916, correct 59/122
class 2: acc 0.35398230088495575, correct 40/113
class 3: acc 0.4878048780487805, correct 60/123
class 4: acc 0.44144144144144143, correct 49/111

Val Set, val_loss: 1.1582, val_error: 0.4730, auc: 0.8078
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6874, instance_loss: 0.3627, weighted_loss: 0.5900, label: 3, bag_size: 956
batch 39, loss: 2.9477, instance_loss: 0.6475, weighted_loss: 2.2577, label: 4, bag_size: 1113
batch 59, loss: 1.0683, instance_loss: 0.5985, weighted_loss: 0.9274, label: 2, bag_size: 288
batch 79, loss: 1.8874, instance_loss: 0.5443, weighted_loss: 1.4845, label: 4, bag_size: 342
batch 99, loss: 1.5955, instance_loss: 0.5830, weighted_loss: 1.2917, label: 1, bag_size: 329
batch 119, loss: 0.6825, instance_loss: 0.5115, weighted_loss: 0.6312, label: 4, bag_size: 520
batch 139, loss: 0.0457, instance_loss: 0.3469, weighted_loss: 0.1361, label: 0, bag_size: 351
batch 159, loss: 0.3041, instance_loss: 0.4697, weighted_loss: 0.3537, label: 0, bag_size: 183
batch 179, loss: 1.0569, instance_loss: 0.4886, weighted_loss: 0.8864, label: 4, bag_size: 277
batch 199, loss: 4.1271, instance_loss: 0.6297, weighted_loss: 3.0779, label: 0, bag_size: 1039
batch 219, loss: 0.6253, instance_loss: 0.3914, weighted_loss: 0.5552, label: 2, bag_size: 445
batch 239, loss: 1.0448, instance_loss: 0.4843, weighted_loss: 0.8767, label: 3, bag_size: 804
batch 259, loss: 0.9513, instance_loss: 0.4758, weighted_loss: 0.8087, label: 3, bag_size: 301
batch 279, loss: 1.3719, instance_loss: 0.5423, weighted_loss: 1.1231, label: 4, bag_size: 233
batch 299, loss: 0.7558, instance_loss: 0.5244, weighted_loss: 0.6864, label: 4, bag_size: 1018
batch 319, loss: 1.0555, instance_loss: 0.4222, weighted_loss: 0.8655, label: 4, bag_size: 419
batch 339, loss: 0.1519, instance_loss: 0.3849, weighted_loss: 0.2218, label: 0, bag_size: 397
batch 359, loss: 0.9465, instance_loss: 0.5065, weighted_loss: 0.8145, label: 1, bag_size: 886
batch 379, loss: 1.5241, instance_loss: 0.6265, weighted_loss: 1.2548, label: 0, bag_size: 311
batch 399, loss: 1.5779, instance_loss: 0.6264, weighted_loss: 1.2924, label: 0, bag_size: 600
batch 419, loss: 0.7723, instance_loss: 0.4944, weighted_loss: 0.6890, label: 2, bag_size: 821
batch 439, loss: 1.5098, instance_loss: 0.4895, weighted_loss: 1.2037, label: 3, bag_size: 492
batch 459, loss: 1.2899, instance_loss: 0.4843, weighted_loss: 1.0483, label: 1, bag_size: 525
batch 479, loss: 0.8456, instance_loss: 0.6105, weighted_loss: 0.7751, label: 1, bag_size: 522
batch 499, loss: 3.5485, instance_loss: 0.6447, weighted_loss: 2.6774, label: 3, bag_size: 342
batch 519, loss: 0.0400, instance_loss: 0.3500, weighted_loss: 0.1330, label: 0, bag_size: 527
batch 539, loss: 1.2069, instance_loss: 0.5336, weighted_loss: 1.0049, label: 3, bag_size: 697
batch 559, loss: 1.4821, instance_loss: 0.4584, weighted_loss: 1.1750, label: 1, bag_size: 231
batch 579, loss: 0.9127, instance_loss: 0.4559, weighted_loss: 0.7757, label: 3, bag_size: 245


class 0 clustering acc 0.9988215488215488: correct 23732/23760
class 1 clustering acc 0.011574074074074073: correct 55/4752
Epoch: 27, train_loss: 1.1307, train_clustering_loss:  0.4919, train_error: 0.5000
class 0: acc 0.7981651376146789, correct 87/109
class 1: acc 0.2621359223300971, correct 27/103
class 2: acc 0.4918032786885246, correct 60/122
class 3: acc 0.4728682170542636, correct 61/129
class 4: acc 0.4732824427480916, correct 62/131

Val Set, val_loss: 1.2591, val_error: 0.4324, auc: 0.8240
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0033783783783783786: correct 2/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2532, instance_loss: 0.5223, weighted_loss: 1.0339, label: 3, bag_size: 615
batch 39, loss: 1.2064, instance_loss: 0.5753, weighted_loss: 1.0171, label: 2, bag_size: 498
batch 59, loss: 1.7647, instance_loss: 0.4796, weighted_loss: 1.3792, label: 1, bag_size: 159
batch 79, loss: 0.3262, instance_loss: 0.3396, weighted_loss: 0.3302, label: 4, bag_size: 409
batch 99, loss: 0.4312, instance_loss: 0.4064, weighted_loss: 0.4238, label: 4, bag_size: 776
batch 119, loss: 0.7749, instance_loss: 0.4825, weighted_loss: 0.6872, label: 3, bag_size: 780
batch 139, loss: 0.8921, instance_loss: 0.4915, weighted_loss: 0.7719, label: 2, bag_size: 853
batch 159, loss: 1.1535, instance_loss: 0.4634, weighted_loss: 0.9464, label: 3, bag_size: 822
batch 179, loss: 1.2840, instance_loss: 0.5997, weighted_loss: 1.0787, label: 4, bag_size: 854
batch 199, loss: 0.6708, instance_loss: 0.4118, weighted_loss: 0.5931, label: 2, bag_size: 616
batch 219, loss: 0.7722, instance_loss: 0.5961, weighted_loss: 0.7193, label: 1, bag_size: 669
batch 239, loss: 0.8351, instance_loss: 0.5081, weighted_loss: 0.7370, label: 4, bag_size: 731
batch 259, loss: 1.4621, instance_loss: 0.5129, weighted_loss: 1.1773, label: 1, bag_size: 672
batch 279, loss: 0.6787, instance_loss: 0.5543, weighted_loss: 0.6414, label: 1, bag_size: 874
batch 299, loss: 1.4795, instance_loss: 0.4919, weighted_loss: 1.1832, label: 2, bag_size: 1077
batch 319, loss: 1.3500, instance_loss: 0.5858, weighted_loss: 1.1207, label: 1, bag_size: 44
batch 339, loss: 2.8099, instance_loss: 0.6518, weighted_loss: 2.1624, label: 2, bag_size: 411
batch 359, loss: 1.0161, instance_loss: 0.5451, weighted_loss: 0.8748, label: 4, bag_size: 1064
batch 379, loss: 2.3005, instance_loss: 0.7161, weighted_loss: 1.8252, label: 2, bag_size: 407
batch 399, loss: 1.7688, instance_loss: 0.6392, weighted_loss: 1.4299, label: 0, bag_size: 343
batch 419, loss: 1.1884, instance_loss: 0.4459, weighted_loss: 0.9656, label: 4, bag_size: 1064
batch 439, loss: 0.1883, instance_loss: 0.4435, weighted_loss: 0.2648, label: 0, bag_size: 578
batch 459, loss: 1.0901, instance_loss: 0.4508, weighted_loss: 0.8983, label: 1, bag_size: 697
batch 479, loss: 0.5642, instance_loss: 0.5134, weighted_loss: 0.5490, label: 1, bag_size: 522
batch 499, loss: 1.2123, instance_loss: 0.6089, weighted_loss: 1.0313, label: 0, bag_size: 311
batch 519, loss: 0.5803, instance_loss: 0.4755, weighted_loss: 0.5489, label: 0, bag_size: 62
batch 539, loss: 2.1339, instance_loss: 0.5729, weighted_loss: 1.6656, label: 1, bag_size: 391
batch 559, loss: 0.7412, instance_loss: 0.5245, weighted_loss: 0.6762, label: 2, bag_size: 1013
batch 579, loss: 1.2258, instance_loss: 0.5246, weighted_loss: 1.0155, label: 1, bag_size: 398


class 0 clustering acc 0.998442760942761: correct 23723/23760
class 1 clustering acc 0.019570707070707072: correct 93/4752
Epoch: 28, train_loss: 1.0970, train_clustering_loss:  0.4891, train_error: 0.4731
class 0: acc 0.7906976744186046, correct 102/129
class 1: acc 0.5078125, correct 65/128
class 2: acc 0.2894736842105263, correct 33/114
class 3: acc 0.5350877192982456, correct 61/114
class 4: acc 0.47706422018348627, correct 52/109

Val Set, val_loss: 1.2201, val_error: 0.5405, auc: 0.8183
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0073, instance_loss: 0.3288, weighted_loss: 0.1037, label: 0, bag_size: 230
batch 39, loss: 0.0282, instance_loss: 0.2699, weighted_loss: 0.1007, label: 0, bag_size: 366
batch 59, loss: 0.9127, instance_loss: 0.4397, weighted_loss: 0.7708, label: 4, bag_size: 712
batch 79, loss: 2.6075, instance_loss: 0.6021, weighted_loss: 2.0059, label: 2, bag_size: 606
batch 99, loss: 0.6893, instance_loss: 0.4015, weighted_loss: 0.6029, label: 3, bag_size: 1147
batch 119, loss: 0.7162, instance_loss: 0.4211, weighted_loss: 0.6277, label: 3, bag_size: 344
batch 139, loss: 1.8046, instance_loss: 0.5876, weighted_loss: 1.4395, label: 4, bag_size: 1113
batch 159, loss: 0.3808, instance_loss: 0.3805, weighted_loss: 0.3807, label: 4, bag_size: 266
batch 179, loss: 2.0305, instance_loss: 0.5446, weighted_loss: 1.5847, label: 1, bag_size: 184
batch 199, loss: 1.3750, instance_loss: 0.5230, weighted_loss: 1.1194, label: 3, bag_size: 498
batch 219, loss: 2.0732, instance_loss: 0.6175, weighted_loss: 1.6365, label: 3, bag_size: 228
batch 239, loss: 1.4441, instance_loss: 0.5383, weighted_loss: 1.1724, label: 4, bag_size: 356
batch 259, loss: 1.4964, instance_loss: 0.6027, weighted_loss: 1.2283, label: 2, bag_size: 288
batch 279, loss: 1.4425, instance_loss: 0.5648, weighted_loss: 1.1792, label: 3, bag_size: 1154
batch 299, loss: 1.4152, instance_loss: 0.4446, weighted_loss: 1.1240, label: 3, bag_size: 499
batch 319, loss: 1.3858, instance_loss: 0.4245, weighted_loss: 1.0974, label: 2, bag_size: 640
batch 339, loss: 1.9342, instance_loss: 0.5684, weighted_loss: 1.5244, label: 1, bag_size: 1360
batch 359, loss: 1.6199, instance_loss: 0.4869, weighted_loss: 1.2800, label: 2, bag_size: 394
batch 379, loss: 0.3594, instance_loss: 0.4004, weighted_loss: 0.3717, label: 0, bag_size: 453
batch 399, loss: 0.9149, instance_loss: 0.3984, weighted_loss: 0.7599, label: 3, bag_size: 499
batch 419, loss: 0.4907, instance_loss: 0.4073, weighted_loss: 0.4657, label: 4, bag_size: 862
batch 439, loss: 1.0537, instance_loss: 0.4888, weighted_loss: 0.8842, label: 2, bag_size: 1013
batch 459, loss: 1.1796, instance_loss: 0.4724, weighted_loss: 0.9675, label: 2, bag_size: 998
batch 479, loss: 0.2432, instance_loss: 0.3184, weighted_loss: 0.2658, label: 2, bag_size: 1079
batch 499, loss: 0.8550, instance_loss: 0.5455, weighted_loss: 0.7622, label: 4, bag_size: 854
batch 519, loss: 0.0887, instance_loss: 0.5141, weighted_loss: 0.2163, label: 0, bag_size: 383
batch 539, loss: 1.1357, instance_loss: 0.5589, weighted_loss: 0.9627, label: 3, bag_size: 1060
batch 559, loss: 1.5156, instance_loss: 0.5427, weighted_loss: 1.2238, label: 1, bag_size: 201
batch 579, loss: 0.9721, instance_loss: 0.4783, weighted_loss: 0.8240, label: 2, bag_size: 598


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.027146464646464648: correct 129/4752
Epoch: 29, train_loss: 1.1289, train_clustering_loss:  0.4902, train_error: 0.4865
class 0: acc 0.8267716535433071, correct 105/127
class 1: acc 0.3113207547169811, correct 33/106
class 2: acc 0.35135135135135137, correct 39/111
class 3: acc 0.5833333333333334, correct 77/132
class 4: acc 0.4322033898305085, correct 51/118

Val Set, val_loss: 1.1778, val_error: 0.4459, auc: 0.8201
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7983, instance_loss: 0.4554, weighted_loss: 0.6954, label: 4, bag_size: 498
batch 39, loss: 0.0260, instance_loss: 0.2872, weighted_loss: 0.1044, label: 0, bag_size: 397
batch 59, loss: 0.6663, instance_loss: 0.4611, weighted_loss: 0.6048, label: 2, bag_size: 616
batch 79, loss: 0.0302, instance_loss: 0.2271, weighted_loss: 0.0892, label: 0, bag_size: 488
batch 99, loss: 1.3038, instance_loss: 0.4907, weighted_loss: 1.0598, label: 4, bag_size: 1104
batch 119, loss: 2.6949, instance_loss: 0.7007, weighted_loss: 2.0966, label: 2, bag_size: 219
batch 139, loss: 1.1269, instance_loss: 0.4515, weighted_loss: 0.9243, label: 2, bag_size: 631
batch 159, loss: 0.1624, instance_loss: 0.4356, weighted_loss: 0.2443, label: 0, bag_size: 49
batch 179, loss: 1.7133, instance_loss: 0.4936, weighted_loss: 1.3474, label: 1, bag_size: 208
batch 199, loss: 1.2364, instance_loss: 0.5293, weighted_loss: 1.0243, label: 2, bag_size: 769
batch 219, loss: 0.0585, instance_loss: 0.3211, weighted_loss: 0.1373, label: 0, bag_size: 212
batch 239, loss: 0.6932, instance_loss: 0.5557, weighted_loss: 0.6519, label: 0, bag_size: 231
batch 259, loss: 0.7523, instance_loss: 0.4727, weighted_loss: 0.6684, label: 4, bag_size: 780
batch 279, loss: 1.1112, instance_loss: 0.5035, weighted_loss: 0.9289, label: 3, bag_size: 944
batch 299, loss: 1.4940, instance_loss: 0.5300, weighted_loss: 1.2048, label: 2, bag_size: 321
batch 319, loss: 0.9063, instance_loss: 0.5488, weighted_loss: 0.7991, label: 3, bag_size: 615
batch 339, loss: 0.7924, instance_loss: 0.4735, weighted_loss: 0.6967, label: 1, bag_size: 460
batch 359, loss: 0.6493, instance_loss: 0.4613, weighted_loss: 0.5929, label: 3, bag_size: 488
batch 379, loss: 0.7914, instance_loss: 0.5769, weighted_loss: 0.7270, label: 0, bag_size: 247
batch 399, loss: 1.0235, instance_loss: 0.5134, weighted_loss: 0.8705, label: 4, bag_size: 868
batch 419, loss: 0.9389, instance_loss: 0.5819, weighted_loss: 0.8318, label: 0, bag_size: 615
batch 439, loss: 1.6137, instance_loss: 0.4790, weighted_loss: 1.2733, label: 4, bag_size: 110
batch 459, loss: 2.0865, instance_loss: 0.5360, weighted_loss: 1.6214, label: 1, bag_size: 391
batch 479, loss: 0.5430, instance_loss: 0.4838, weighted_loss: 0.5252, label: 1, bag_size: 371
batch 499, loss: 1.0808, instance_loss: 0.4811, weighted_loss: 0.9009, label: 4, bag_size: 53
batch 519, loss: 1.2956, instance_loss: 0.5443, weighted_loss: 1.0702, label: 2, bag_size: 821
batch 539, loss: 1.1940, instance_loss: 0.4568, weighted_loss: 0.9728, label: 3, bag_size: 1131
batch 559, loss: 1.1070, instance_loss: 0.4026, weighted_loss: 0.8957, label: 1, bag_size: 1121
batch 579, loss: 2.2782, instance_loss: 0.5116, weighted_loss: 1.7482, label: 1, bag_size: 840


class 0 clustering acc 0.9983164983164983: correct 23720/23760
class 1 clustering acc 0.027356902356902357: correct 130/4752
Epoch: 30, train_loss: 1.1033, train_clustering_loss:  0.4891, train_error: 0.4747
class 0: acc 0.8278688524590164, correct 101/122
class 1: acc 0.5086206896551724, correct 59/116
class 2: acc 0.17894736842105263, correct 17/95
class 3: acc 0.5158730158730159, correct 65/126
class 4: acc 0.5185185185185185, correct 70/135

Val Set, val_loss: 1.2335, val_error: 0.5000, auc: 0.7963
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.9727, instance_loss: 0.5911, weighted_loss: 2.2582, label: 2, bag_size: 1092
batch 39, loss: 0.0657, instance_loss: 0.4670, weighted_loss: 0.1861, label: 4, bag_size: 725
batch 59, loss: 3.8659, instance_loss: 0.4770, weighted_loss: 2.8492, label: 0, bag_size: 214
batch 79, loss: 1.0450, instance_loss: 0.4965, weighted_loss: 0.8804, label: 3, bag_size: 1001
batch 99, loss: 0.7068, instance_loss: 0.4705, weighted_loss: 0.6359, label: 2, bag_size: 754
batch 119, loss: 2.8343, instance_loss: 0.6043, weighted_loss: 2.1653, label: 2, bag_size: 629
batch 139, loss: 0.8771, instance_loss: 0.4823, weighted_loss: 0.7587, label: 4, bag_size: 665
batch 159, loss: 0.0023, instance_loss: 0.1849, weighted_loss: 0.0571, label: 0, bag_size: 706
batch 179, loss: 2.2362, instance_loss: 0.5753, weighted_loss: 1.7380, label: 0, bag_size: 964
batch 199, loss: 0.1272, instance_loss: 0.3226, weighted_loss: 0.1858, label: 0, bag_size: 428
batch 219, loss: 0.7696, instance_loss: 0.4655, weighted_loss: 0.6784, label: 1, bag_size: 544
batch 239, loss: 1.7492, instance_loss: 0.6536, weighted_loss: 1.4206, label: 2, bag_size: 286
batch 259, loss: 0.7436, instance_loss: 0.4491, weighted_loss: 0.6552, label: 2, bag_size: 337
batch 279, loss: 2.0278, instance_loss: 0.6090, weighted_loss: 1.6022, label: 4, bag_size: 757
batch 299, loss: 0.1842, instance_loss: 0.5392, weighted_loss: 0.2907, label: 0, bag_size: 122
batch 319, loss: 1.8617, instance_loss: 0.5223, weighted_loss: 1.4599, label: 1, bag_size: 350
batch 339, loss: 2.0343, instance_loss: 0.6267, weighted_loss: 1.6120, label: 2, bag_size: 303
batch 359, loss: 0.6638, instance_loss: 0.4148, weighted_loss: 0.5891, label: 1, bag_size: 500
batch 379, loss: 1.0654, instance_loss: 0.5799, weighted_loss: 0.9198, label: 2, bag_size: 605
batch 399, loss: 3.0735, instance_loss: 0.6749, weighted_loss: 2.3539, label: 0, bag_size: 964
batch 419, loss: 1.3573, instance_loss: 0.5155, weighted_loss: 1.1048, label: 2, bag_size: 769
batch 439, loss: 2.2878, instance_loss: 0.5255, weighted_loss: 1.7591, label: 1, bag_size: 208
batch 459, loss: 1.8762, instance_loss: 0.4617, weighted_loss: 1.4519, label: 1, bag_size: 231
batch 479, loss: 0.1651, instance_loss: 0.4782, weighted_loss: 0.2590, label: 4, bag_size: 923
batch 499, loss: 1.0951, instance_loss: 0.4986, weighted_loss: 0.9161, label: 3, bag_size: 344
batch 519, loss: 0.8315, instance_loss: 0.4667, weighted_loss: 0.7221, label: 3, bag_size: 697
batch 539, loss: 1.7654, instance_loss: 0.4693, weighted_loss: 1.3766, label: 2, bag_size: 746
batch 559, loss: 0.7288, instance_loss: 0.4464, weighted_loss: 0.6441, label: 1, bag_size: 1273
batch 579, loss: 1.2076, instance_loss: 0.5099, weighted_loss: 0.9983, label: 2, bag_size: 576


class 0 clustering acc 0.997516835016835: correct 23701/23760
class 1 clustering acc 0.022727272727272728: correct 108/4752
Epoch: 31, train_loss: 1.0985, train_clustering_loss:  0.4880, train_error: 0.4613
class 0: acc 0.8347826086956521, correct 96/115
class 1: acc 0.45652173913043476, correct 63/138
class 2: acc 0.34210526315789475, correct 39/114
class 3: acc 0.4716981132075472, correct 50/106
class 4: acc 0.5950413223140496, correct 72/121

Val Set, val_loss: 1.2244, val_error: 0.4865, auc: 0.8213
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0023, instance_loss: 0.3246, weighted_loss: 0.0990, label: 0, bag_size: 340
batch 39, loss: 1.2152, instance_loss: 0.5142, weighted_loss: 1.0049, label: 3, bag_size: 230
batch 59, loss: 0.0114, instance_loss: 0.1616, weighted_loss: 0.0564, label: 0, bag_size: 258
batch 79, loss: 0.9818, instance_loss: 0.5186, weighted_loss: 0.8428, label: 2, bag_size: 522
batch 99, loss: 1.6385, instance_loss: 0.5921, weighted_loss: 1.3246, label: 2, bag_size: 380
batch 119, loss: 2.3359, instance_loss: 0.5201, weighted_loss: 1.7912, label: 2, bag_size: 1092
batch 139, loss: 1.0134, instance_loss: 0.4303, weighted_loss: 0.8385, label: 1, bag_size: 544
batch 159, loss: 1.2892, instance_loss: 0.4777, weighted_loss: 1.0457, label: 4, bag_size: 824
batch 179, loss: 1.2639, instance_loss: 0.5353, weighted_loss: 1.0453, label: 4, bag_size: 699
batch 199, loss: 0.4841, instance_loss: 0.3350, weighted_loss: 0.4393, label: 0, bag_size: 282
batch 219, loss: 1.3617, instance_loss: 0.5672, weighted_loss: 1.1233, label: 3, bag_size: 1186
batch 239, loss: 1.3928, instance_loss: 0.5664, weighted_loss: 1.1449, label: 1, bag_size: 564
batch 259, loss: 0.7957, instance_loss: 0.4253, weighted_loss: 0.6846, label: 2, bag_size: 1066
batch 279, loss: 1.4634, instance_loss: 0.5615, weighted_loss: 1.1928, label: 3, bag_size: 566
batch 299, loss: 0.6783, instance_loss: 0.4436, weighted_loss: 0.6079, label: 4, bag_size: 775
batch 319, loss: 0.8525, instance_loss: 0.5702, weighted_loss: 0.7678, label: 0, bag_size: 587
batch 339, loss: 1.0073, instance_loss: 0.4326, weighted_loss: 0.8349, label: 3, bag_size: 603
batch 359, loss: 0.6064, instance_loss: 0.3466, weighted_loss: 0.5285, label: 0, bag_size: 230
batch 379, loss: 0.9541, instance_loss: 0.4486, weighted_loss: 0.8024, label: 1, bag_size: 1009
batch 399, loss: 1.0838, instance_loss: 0.4537, weighted_loss: 0.8948, label: 3, bag_size: 1078
batch 419, loss: 2.2141, instance_loss: 0.6420, weighted_loss: 1.7425, label: 2, bag_size: 105
batch 439, loss: 0.8712, instance_loss: 0.4796, weighted_loss: 0.7537, label: 3, bag_size: 598
batch 459, loss: 2.8569, instance_loss: 0.6352, weighted_loss: 2.1904, label: 2, bag_size: 720
batch 479, loss: 3.1072, instance_loss: 0.6155, weighted_loss: 2.3597, label: 2, bag_size: 297
batch 499, loss: 0.2499, instance_loss: 0.3369, weighted_loss: 0.2760, label: 0, bag_size: 306
batch 519, loss: 2.0660, instance_loss: 0.5464, weighted_loss: 1.6101, label: 3, bag_size: 403
batch 539, loss: 1.1215, instance_loss: 0.5172, weighted_loss: 0.9402, label: 3, bag_size: 403
batch 559, loss: 1.7169, instance_loss: 0.5205, weighted_loss: 1.3580, label: 4, bag_size: 731
batch 579, loss: 2.0011, instance_loss: 0.5303, weighted_loss: 1.5599, label: 4, bag_size: 363


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.026515151515151516: correct 126/4752
Epoch: 32, train_loss: 1.1267, train_clustering_loss:  0.4877, train_error: 0.5000
class 0: acc 0.8376068376068376, correct 98/117
class 1: acc 0.4180327868852459, correct 51/122
class 2: acc 0.23478260869565218, correct 27/115
class 3: acc 0.42857142857142855, correct 51/119
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.2203, val_error: 0.4730, auc: 0.7990
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.7099, instance_loss: 0.5027, weighted_loss: 1.3477, label: 2, bag_size: 576
batch 39, loss: 2.2740, instance_loss: 0.6491, weighted_loss: 1.7866, label: 2, bag_size: 105
batch 59, loss: 1.4427, instance_loss: 0.5329, weighted_loss: 1.1698, label: 4, bag_size: 690
batch 79, loss: 0.9243, instance_loss: 0.5047, weighted_loss: 0.7984, label: 4, bag_size: 695
batch 99, loss: 1.2174, instance_loss: 0.4387, weighted_loss: 0.9838, label: 1, bag_size: 272
batch 119, loss: 1.1562, instance_loss: 0.5468, weighted_loss: 0.9734, label: 4, bag_size: 689
batch 139, loss: 0.3551, instance_loss: 0.5710, weighted_loss: 0.4199, label: 0, bag_size: 416
batch 159, loss: 0.0313, instance_loss: 0.4933, weighted_loss: 0.1699, label: 0, bag_size: 218
batch 179, loss: 1.3364, instance_loss: 0.4600, weighted_loss: 1.0735, label: 1, bag_size: 233
batch 199, loss: 0.0508, instance_loss: 0.2991, weighted_loss: 0.1253, label: 0, bag_size: 280
batch 219, loss: 1.7905, instance_loss: 0.4710, weighted_loss: 1.3947, label: 3, bag_size: 598
batch 239, loss: 1.7271, instance_loss: 0.5361, weighted_loss: 1.3698, label: 3, bag_size: 1147
batch 259, loss: 1.2630, instance_loss: 0.4721, weighted_loss: 1.0257, label: 3, bag_size: 488
batch 279, loss: 1.2770, instance_loss: 0.4625, weighted_loss: 1.0326, label: 1, bag_size: 697
batch 299, loss: 2.1151, instance_loss: 0.6358, weighted_loss: 1.6713, label: 3, bag_size: 520
batch 319, loss: 0.0757, instance_loss: 0.4362, weighted_loss: 0.1839, label: 0, bag_size: 218
batch 339, loss: 0.5202, instance_loss: 0.6278, weighted_loss: 0.5525, label: 0, bag_size: 400
batch 359, loss: 1.0765, instance_loss: 0.5531, weighted_loss: 0.9195, label: 3, bag_size: 476
batch 379, loss: 0.0128, instance_loss: 0.3868, weighted_loss: 0.1250, label: 0, bag_size: 51
batch 399, loss: 0.3196, instance_loss: 0.4585, weighted_loss: 0.3613, label: 4, bag_size: 685
batch 419, loss: 0.4422, instance_loss: 0.5168, weighted_loss: 0.4646, label: 1, bag_size: 522
batch 439, loss: 0.8469, instance_loss: 0.5110, weighted_loss: 0.7461, label: 3, bag_size: 344
batch 459, loss: 1.2605, instance_loss: 0.4940, weighted_loss: 1.0305, label: 1, bag_size: 851
batch 479, loss: 0.5435, instance_loss: 0.4565, weighted_loss: 0.5174, label: 3, bag_size: 459
batch 499, loss: 1.0659, instance_loss: 0.4171, weighted_loss: 0.8712, label: 2, bag_size: 844
batch 519, loss: 1.0596, instance_loss: 0.4745, weighted_loss: 0.8841, label: 4, bag_size: 862
batch 539, loss: 1.5732, instance_loss: 0.5062, weighted_loss: 1.2531, label: 3, bag_size: 300
batch 559, loss: 0.3676, instance_loss: 0.4038, weighted_loss: 0.3785, label: 0, bag_size: 74
batch 579, loss: 1.3861, instance_loss: 0.6042, weighted_loss: 1.1515, label: 2, bag_size: 376


class 0 clustering acc 0.9965488215488215: correct 23678/23760
class 1 clustering acc 0.0422979797979798: correct 201/4752
Epoch: 33, train_loss: 1.0659, train_clustering_loss:  0.4854, train_error: 0.4461
class 0: acc 0.7795275590551181, correct 99/127
class 1: acc 0.45901639344262296, correct 56/122
class 2: acc 0.3394495412844037, correct 37/109
class 3: acc 0.5901639344262295, correct 72/122
class 4: acc 0.5701754385964912, correct 65/114

Val Set, val_loss: 1.2799, val_error: 0.4730, auc: 0.8214
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.04391891891891892: correct 26/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.9063, instance_loss: 0.4482, weighted_loss: 0.7689, label: 3, bag_size: 423
batch 39, loss: 2.0669, instance_loss: 0.6444, weighted_loss: 1.6402, label: 2, bag_size: 1013
batch 59, loss: 0.7581, instance_loss: 0.4299, weighted_loss: 0.6597, label: 1, bag_size: 389
batch 79, loss: 0.9004, instance_loss: 0.4327, weighted_loss: 0.7601, label: 4, bag_size: 198
batch 99, loss: 0.0717, instance_loss: 0.4176, weighted_loss: 0.1754, label: 0, bag_size: 88
batch 119, loss: 0.7135, instance_loss: 0.4301, weighted_loss: 0.6285, label: 1, bag_size: 851
batch 139, loss: 1.3515, instance_loss: 0.6336, weighted_loss: 1.1361, label: 0, bag_size: 343
batch 159, loss: 0.9155, instance_loss: 0.4508, weighted_loss: 0.7761, label: 1, bag_size: 614
batch 179, loss: 0.8675, instance_loss: 0.5387, weighted_loss: 0.7689, label: 3, bag_size: 322
batch 199, loss: 1.1090, instance_loss: 0.4814, weighted_loss: 0.9207, label: 4, bag_size: 312
batch 219, loss: 0.5027, instance_loss: 0.4652, weighted_loss: 0.4915, label: 1, bag_size: 398
batch 239, loss: 0.9124, instance_loss: 0.5841, weighted_loss: 0.8139, label: 3, bag_size: 956
batch 259, loss: 0.3421, instance_loss: 0.4014, weighted_loss: 0.3599, label: 4, bag_size: 776
batch 279, loss: 1.2073, instance_loss: 0.6019, weighted_loss: 1.0257, label: 2, bag_size: 315
batch 299, loss: 2.2269, instance_loss: 0.5844, weighted_loss: 1.7341, label: 2, bag_size: 168
batch 319, loss: 0.7264, instance_loss: 0.4664, weighted_loss: 0.6484, label: 3, bag_size: 309
batch 339, loss: 0.9838, instance_loss: 0.5111, weighted_loss: 0.8420, label: 0, bag_size: 122
batch 359, loss: 0.9977, instance_loss: 0.5058, weighted_loss: 0.8501, label: 0, bag_size: 615
batch 379, loss: 1.9831, instance_loss: 0.5604, weighted_loss: 1.5563, label: 2, bag_size: 1003
batch 399, loss: 1.0811, instance_loss: 0.5517, weighted_loss: 0.9223, label: 2, bag_size: 398
batch 419, loss: 0.0029, instance_loss: 0.2821, weighted_loss: 0.0867, label: 0, bag_size: 236
batch 439, loss: 0.9262, instance_loss: 0.4099, weighted_loss: 0.7713, label: 1, bag_size: 355
batch 459, loss: 1.7281, instance_loss: 0.5607, weighted_loss: 1.3778, label: 3, bag_size: 615
batch 479, loss: 1.0116, instance_loss: 0.4684, weighted_loss: 0.8486, label: 3, bag_size: 857
batch 499, loss: 0.1831, instance_loss: 0.3929, weighted_loss: 0.2460, label: 0, bag_size: 159
batch 519, loss: 1.7457, instance_loss: 0.5097, weighted_loss: 1.3749, label: 4, bag_size: 482
batch 539, loss: 0.0006, instance_loss: 0.2867, weighted_loss: 0.0864, label: 0, bag_size: 236
batch 559, loss: 1.2184, instance_loss: 0.5262, weighted_loss: 1.0107, label: 2, bag_size: 398
batch 579, loss: 0.5281, instance_loss: 0.4393, weighted_loss: 0.5015, label: 4, bag_size: 627


class 0 clustering acc 0.9968434343434344: correct 23685/23760
class 1 clustering acc 0.03303872053872054: correct 157/4752
Epoch: 34, train_loss: 1.1082, train_clustering_loss:  0.4891, train_error: 0.4663
class 0: acc 0.8018018018018018, correct 89/111
class 1: acc 0.564625850340136, correct 83/147
class 2: acc 0.21495327102803738, correct 23/107
class 3: acc 0.5213675213675214, correct 61/117
class 4: acc 0.5446428571428571, correct 61/112

Val Set, val_loss: 1.3207, val_error: 0.5000, auc: 0.7785
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9746, instance_loss: 0.4401, weighted_loss: 0.8143, label: 2, bag_size: 598
batch 39, loss: 0.2438, instance_loss: 0.5061, weighted_loss: 0.3225, label: 0, bag_size: 404
batch 59, loss: 1.3166, instance_loss: 0.4189, weighted_loss: 1.0473, label: 0, bag_size: 230
batch 79, loss: 1.3052, instance_loss: 0.5284, weighted_loss: 1.0722, label: 1, bag_size: 159
batch 99, loss: 1.4091, instance_loss: 0.5110, weighted_loss: 1.1397, label: 1, bag_size: 766
batch 119, loss: 1.9657, instance_loss: 0.5637, weighted_loss: 1.5451, label: 2, bag_size: 1071
batch 139, loss: 0.9008, instance_loss: 0.5647, weighted_loss: 0.7999, label: 2, bag_size: 317
batch 159, loss: 0.4038, instance_loss: 0.5021, weighted_loss: 0.4333, label: 0, bag_size: 238
batch 179, loss: 0.3775, instance_loss: 0.5283, weighted_loss: 0.4228, label: 4, bag_size: 530
batch 199, loss: 0.9630, instance_loss: 0.4599, weighted_loss: 0.8121, label: 4, bag_size: 489
batch 219, loss: 0.8909, instance_loss: 0.4520, weighted_loss: 0.7593, label: 3, bag_size: 322
batch 239, loss: 0.3611, instance_loss: 0.4985, weighted_loss: 0.4023, label: 4, bag_size: 228
batch 259, loss: 0.9923, instance_loss: 0.4753, weighted_loss: 0.8372, label: 1, bag_size: 1091
batch 279, loss: 0.8249, instance_loss: 0.4624, weighted_loss: 0.7162, label: 1, bag_size: 1104
batch 299, loss: 1.1323, instance_loss: 0.4740, weighted_loss: 0.9348, label: 2, bag_size: 402
batch 319, loss: 0.6704, instance_loss: 0.5424, weighted_loss: 0.6320, label: 3, bag_size: 428
batch 339, loss: 0.3758, instance_loss: 0.4749, weighted_loss: 0.4055, label: 4, bag_size: 895
batch 359, loss: 1.6471, instance_loss: 0.5774, weighted_loss: 1.3262, label: 3, bag_size: 317
batch 379, loss: 1.4556, instance_loss: 0.5689, weighted_loss: 1.1896, label: 4, bag_size: 1297
batch 399, loss: 1.0356, instance_loss: 0.5167, weighted_loss: 0.8800, label: 2, bag_size: 725
batch 419, loss: 0.0495, instance_loss: 0.4249, weighted_loss: 0.1621, label: 0, bag_size: 74
batch 439, loss: 1.5082, instance_loss: 0.5486, weighted_loss: 1.2203, label: 2, bag_size: 746
batch 459, loss: 0.8096, instance_loss: 0.4248, weighted_loss: 0.6941, label: 1, bag_size: 1043
batch 479, loss: 0.8371, instance_loss: 0.6707, weighted_loss: 0.7872, label: 0, bag_size: 178
batch 499, loss: 0.8028, instance_loss: 0.5739, weighted_loss: 0.7341, label: 4, bag_size: 769
batch 519, loss: 1.6100, instance_loss: 0.5008, weighted_loss: 1.2773, label: 2, bag_size: 337
batch 539, loss: 1.0626, instance_loss: 0.6163, weighted_loss: 0.9287, label: 3, bag_size: 403
batch 559, loss: 0.1351, instance_loss: 0.4867, weighted_loss: 0.2405, label: 0, bag_size: 578
batch 579, loss: 0.8677, instance_loss: 0.3996, weighted_loss: 0.7273, label: 3, bag_size: 871


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.022727272727272728: correct 108/4752
Epoch: 35, train_loss: 1.1308, train_clustering_loss:  0.4982, train_error: 0.4966
class 0: acc 0.7936507936507936, correct 100/126
class 1: acc 0.45, correct 54/120
class 2: acc 0.2857142857142857, correct 32/112
class 3: acc 0.5042016806722689, correct 60/119
class 4: acc 0.452991452991453, correct 53/117

Val Set, val_loss: 1.1808, val_error: 0.4865, auc: 0.8048
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.006756756756756757: correct 4/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 2.2660, instance_loss: 0.5951, weighted_loss: 1.7648, label: 1, bag_size: 350
batch 39, loss: 1.1558, instance_loss: 0.4954, weighted_loss: 0.9577, label: 1, bag_size: 742
batch 59, loss: 0.6461, instance_loss: 0.4238, weighted_loss: 0.5794, label: 2, bag_size: 725
batch 79, loss: 2.0634, instance_loss: 0.6009, weighted_loss: 1.6246, label: 4, bag_size: 310
batch 99, loss: 0.7385, instance_loss: 0.4524, weighted_loss: 0.6527, label: 4, bag_size: 755
batch 119, loss: 1.1252, instance_loss: 0.4674, weighted_loss: 0.9279, label: 2, bag_size: 266
batch 139, loss: 0.7990, instance_loss: 0.4320, weighted_loss: 0.6889, label: 1, bag_size: 829
batch 159, loss: 0.6544, instance_loss: 0.4944, weighted_loss: 0.6064, label: 3, bag_size: 393
batch 179, loss: 0.8031, instance_loss: 0.4598, weighted_loss: 0.7001, label: 2, bag_size: 783
batch 199, loss: 0.6243, instance_loss: 0.4745, weighted_loss: 0.5793, label: 3, bag_size: 194
batch 219, loss: 3.4655, instance_loss: 0.6312, weighted_loss: 2.6152, label: 1, bag_size: 45
batch 239, loss: 1.4132, instance_loss: 0.4730, weighted_loss: 1.1311, label: 3, bag_size: 1076
batch 259, loss: 0.5200, instance_loss: 0.4829, weighted_loss: 0.5089, label: 1, bag_size: 44
batch 279, loss: 0.1765, instance_loss: 0.4612, weighted_loss: 0.2619, label: 0, bag_size: 288
batch 299, loss: 0.9723, instance_loss: 0.4442, weighted_loss: 0.8138, label: 3, bag_size: 641
batch 319, loss: 0.0914, instance_loss: 0.2755, weighted_loss: 0.1466, label: 0, bag_size: 393
batch 339, loss: 1.0649, instance_loss: 0.5559, weighted_loss: 0.9122, label: 2, bag_size: 427
batch 359, loss: 1.3781, instance_loss: 0.6065, weighted_loss: 1.1466, label: 0, bag_size: 367
batch 379, loss: 2.6635, instance_loss: 0.5708, weighted_loss: 2.0357, label: 1, bag_size: 1019
batch 399, loss: 0.5383, instance_loss: 0.4420, weighted_loss: 0.5094, label: 1, bag_size: 311
batch 419, loss: 0.6845, instance_loss: 0.5123, weighted_loss: 0.6328, label: 4, bag_size: 683
batch 439, loss: 0.7673, instance_loss: 0.4340, weighted_loss: 0.6673, label: 2, bag_size: 708
batch 459, loss: 0.2743, instance_loss: 0.4215, weighted_loss: 0.3185, label: 4, bag_size: 727
batch 479, loss: 0.8514, instance_loss: 0.4496, weighted_loss: 0.7308, label: 2, bag_size: 697
batch 499, loss: 0.3365, instance_loss: 0.5258, weighted_loss: 0.3933, label: 0, bag_size: 49
batch 519, loss: 0.6878, instance_loss: 0.4115, weighted_loss: 0.6049, label: 2, bag_size: 697
batch 539, loss: 2.2095, instance_loss: 0.6023, weighted_loss: 1.7274, label: 1, bag_size: 988
batch 559, loss: 0.6649, instance_loss: 0.4231, weighted_loss: 0.5924, label: 4, bag_size: 775
batch 579, loss: 0.7540, instance_loss: 0.4884, weighted_loss: 0.6743, label: 1, bag_size: 865


class 0 clustering acc 0.9977693602693603: correct 23707/23760
class 1 clustering acc 0.015572390572390573: correct 74/4752
Epoch: 36, train_loss: 1.1124, train_clustering_loss:  0.4940, train_error: 0.4680
class 0: acc 0.7857142857142857, correct 88/112
class 1: acc 0.515625, correct 66/128
class 2: acc 0.39849624060150374, correct 53/133
class 3: acc 0.5294117647058824, correct 63/119
class 4: acc 0.45098039215686275, correct 46/102

Val Set, val_loss: 1.3289, val_error: 0.5676, auc: 0.8066
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8266, instance_loss: 0.4901, weighted_loss: 0.7257, label: 1, bag_size: 271
batch 39, loss: 1.8081, instance_loss: 0.5049, weighted_loss: 1.4171, label: 2, bag_size: 557
batch 59, loss: 1.0460, instance_loss: 0.5092, weighted_loss: 0.8850, label: 0, bag_size: 231
batch 79, loss: 0.9213, instance_loss: 0.4933, weighted_loss: 0.7929, label: 1, bag_size: 855
batch 99, loss: 1.6695, instance_loss: 0.5133, weighted_loss: 1.3226, label: 1, bag_size: 339
batch 119, loss: 1.1842, instance_loss: 0.4690, weighted_loss: 0.9697, label: 4, bag_size: 438
batch 139, loss: 2.5998, instance_loss: 0.6470, weighted_loss: 2.0140, label: 2, bag_size: 549
batch 159, loss: 0.6992, instance_loss: 0.4656, weighted_loss: 0.6291, label: 0, bag_size: 306
batch 179, loss: 1.2911, instance_loss: 0.6327, weighted_loss: 1.0936, label: 2, bag_size: 208
batch 199, loss: 1.3810, instance_loss: 0.5164, weighted_loss: 1.1216, label: 4, bag_size: 198
batch 219, loss: 0.0182, instance_loss: 0.2779, weighted_loss: 0.0961, label: 0, bag_size: 255
batch 239, loss: 3.9056, instance_loss: 0.6287, weighted_loss: 2.9225, label: 1, bag_size: 45
batch 259, loss: 0.0935, instance_loss: 0.2845, weighted_loss: 0.1508, label: 0, bag_size: 357
batch 279, loss: 1.4802, instance_loss: 0.4779, weighted_loss: 1.1795, label: 3, bag_size: 603
batch 299, loss: 0.8539, instance_loss: 0.5446, weighted_loss: 0.7611, label: 3, bag_size: 794
batch 319, loss: 1.1475, instance_loss: 0.5291, weighted_loss: 0.9620, label: 0, bag_size: 243
batch 339, loss: 1.8327, instance_loss: 0.5827, weighted_loss: 1.4577, label: 4, bag_size: 757
batch 359, loss: 0.4411, instance_loss: 0.3950, weighted_loss: 0.4272, label: 4, bag_size: 875
batch 379, loss: 0.1073, instance_loss: 0.3653, weighted_loss: 0.1847, label: 0, bag_size: 416
batch 399, loss: 0.6747, instance_loss: 0.4652, weighted_loss: 0.6119, label: 3, bag_size: 423
batch 419, loss: 2.9473, instance_loss: 0.7281, weighted_loss: 2.2815, label: 0, bag_size: 1414
batch 439, loss: 0.0883, instance_loss: 0.4665, weighted_loss: 0.2018, label: 1, bag_size: 141
batch 459, loss: 2.3713, instance_loss: 0.5391, weighted_loss: 1.8216, label: 1, bag_size: 397
batch 479, loss: 1.2201, instance_loss: 0.4641, weighted_loss: 0.9933, label: 1, bag_size: 461
batch 499, loss: 1.3572, instance_loss: 0.4501, weighted_loss: 1.0851, label: 1, bag_size: 1023
batch 519, loss: 0.6829, instance_loss: 0.4415, weighted_loss: 0.6105, label: 3, bag_size: 794
batch 539, loss: 1.1708, instance_loss: 0.4698, weighted_loss: 0.9605, label: 1, bag_size: 339
batch 559, loss: 1.8595, instance_loss: 0.6171, weighted_loss: 1.4868, label: 0, bag_size: 710
batch 579, loss: 0.0055, instance_loss: 0.2995, weighted_loss: 0.0937, label: 0, bag_size: 428


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.015151515151515152: correct 72/4752
Epoch: 37, train_loss: 1.1170, train_clustering_loss:  0.4890, train_error: 0.4882
class 0: acc 0.8360655737704918, correct 102/122
class 1: acc 0.32142857142857145, correct 36/112
class 2: acc 0.3492063492063492, correct 44/126
class 3: acc 0.6060606060606061, correct 80/132
class 4: acc 0.4117647058823529, correct 42/102

Val Set, val_loss: 1.2035, val_error: 0.5000, auc: 0.8026
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.5419, instance_loss: 0.6160, weighted_loss: 1.2641, label: 4, bag_size: 476
batch 39, loss: 1.2102, instance_loss: 0.4540, weighted_loss: 0.9833, label: 3, bag_size: 300
batch 59, loss: 0.7296, instance_loss: 0.4856, weighted_loss: 0.6564, label: 0, bag_size: 493
batch 79, loss: 0.9351, instance_loss: 0.4885, weighted_loss: 0.8011, label: 3, bag_size: 697
batch 99, loss: 0.6525, instance_loss: 0.5410, weighted_loss: 0.6190, label: 4, bag_size: 685
batch 119, loss: 1.5278, instance_loss: 0.4968, weighted_loss: 1.2185, label: 4, bag_size: 264
batch 139, loss: 0.6616, instance_loss: 0.5103, weighted_loss: 0.6162, label: 4, bag_size: 530
batch 159, loss: 1.0174, instance_loss: 0.4502, weighted_loss: 0.8473, label: 4, bag_size: 110
batch 179, loss: 0.4173, instance_loss: 0.4264, weighted_loss: 0.4201, label: 0, bag_size: 428
batch 199, loss: 0.0306, instance_loss: 0.2951, weighted_loss: 0.1100, label: 0, bag_size: 255
batch 219, loss: 1.3586, instance_loss: 0.5132, weighted_loss: 1.1050, label: 3, bag_size: 312
batch 239, loss: 0.5922, instance_loss: 0.7363, weighted_loss: 0.6354, label: 4, bag_size: 293
batch 259, loss: 1.0108, instance_loss: 0.4918, weighted_loss: 0.8551, label: 2, bag_size: 697
batch 279, loss: 0.3201, instance_loss: 0.3897, weighted_loss: 0.3410, label: 0, bag_size: 97
batch 299, loss: 1.4993, instance_loss: 0.4895, weighted_loss: 1.1964, label: 1, bag_size: 201
batch 319, loss: 1.4561, instance_loss: 0.5550, weighted_loss: 1.1858, label: 1, bag_size: 591
batch 339, loss: 0.8622, instance_loss: 0.4767, weighted_loss: 0.7466, label: 0, bag_size: 243
batch 359, loss: 1.9165, instance_loss: 0.5893, weighted_loss: 1.5184, label: 3, bag_size: 899
batch 379, loss: 0.4310, instance_loss: 0.3778, weighted_loss: 0.4151, label: 2, bag_size: 851
batch 399, loss: 0.7240, instance_loss: 0.3818, weighted_loss: 0.6214, label: 4, bag_size: 986
batch 419, loss: 0.4784, instance_loss: 0.5202, weighted_loss: 0.4909, label: 0, bag_size: 62
batch 439, loss: 1.2312, instance_loss: 0.5231, weighted_loss: 1.0188, label: 3, bag_size: 1022
batch 459, loss: 0.9288, instance_loss: 0.5168, weighted_loss: 0.8052, label: 3, bag_size: 1021
batch 479, loss: 0.9667, instance_loss: 0.4577, weighted_loss: 0.8140, label: 2, bag_size: 576
batch 499, loss: 0.6149, instance_loss: 0.4628, weighted_loss: 0.5693, label: 4, bag_size: 563
batch 519, loss: 0.0000, instance_loss: 0.1833, weighted_loss: 0.0550, label: 0, bag_size: 1570
batch 539, loss: 1.2557, instance_loss: 0.4584, weighted_loss: 1.0165, label: 1, bag_size: 695
batch 559, loss: 0.9288, instance_loss: 0.4719, weighted_loss: 0.7918, label: 2, bag_size: 607
batch 579, loss: 1.2456, instance_loss: 0.4915, weighted_loss: 1.0194, label: 3, bag_size: 192


class 0 clustering acc 0.9977693602693603: correct 23707/23760
class 1 clustering acc 0.015361952861952861: correct 73/4752
Epoch: 38, train_loss: 1.0728, train_clustering_loss:  0.4934, train_error: 0.4461
class 0: acc 0.7851239669421488, correct 95/121
class 1: acc 0.4380165289256198, correct 53/121
class 2: acc 0.4205607476635514, correct 45/107
class 3: acc 0.4491525423728814, correct 53/118
class 4: acc 0.6535433070866141, correct 83/127

Val Set, val_loss: 1.1953, val_error: 0.5000, auc: 0.8224
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.005067567567567568: correct 3/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.0837, instance_loss: 0.4937, weighted_loss: 0.9067, label: 1, bag_size: 500
batch 39, loss: 0.5621, instance_loss: 0.3795, weighted_loss: 0.5073, label: 4, bag_size: 418
batch 59, loss: 0.9091, instance_loss: 0.4371, weighted_loss: 0.7675, label: 3, bag_size: 109
batch 79, loss: 0.5054, instance_loss: 0.5780, weighted_loss: 0.5272, label: 0, bag_size: 316
batch 99, loss: 1.6515, instance_loss: 0.4536, weighted_loss: 1.2921, label: 3, bag_size: 258
batch 119, loss: 1.0417, instance_loss: 0.4476, weighted_loss: 0.8635, label: 2, bag_size: 543
batch 139, loss: 1.5355, instance_loss: 0.4915, weighted_loss: 1.2223, label: 2, bag_size: 605
batch 159, loss: 0.9529, instance_loss: 0.4881, weighted_loss: 0.8134, label: 4, bag_size: 233
batch 179, loss: 1.3651, instance_loss: 0.5708, weighted_loss: 1.1268, label: 4, bag_size: 310
batch 199, loss: 2.4154, instance_loss: 0.5663, weighted_loss: 1.8606, label: 3, bag_size: 282
batch 219, loss: 0.5260, instance_loss: 0.4699, weighted_loss: 0.5092, label: 4, bag_size: 685
batch 239, loss: 0.0478, instance_loss: 0.1544, weighted_loss: 0.0798, label: 0, bag_size: 258
batch 259, loss: 1.1796, instance_loss: 0.5167, weighted_loss: 0.9807, label: 3, bag_size: 98
batch 279, loss: 1.3822, instance_loss: 0.5000, weighted_loss: 1.1176, label: 2, bag_size: 1197
batch 299, loss: 1.4341, instance_loss: 0.4486, weighted_loss: 1.1385, label: 1, bag_size: 272
batch 319, loss: 0.0451, instance_loss: 0.3436, weighted_loss: 0.1347, label: 0, bag_size: 351
batch 339, loss: 0.2163, instance_loss: 0.5005, weighted_loss: 0.3016, label: 0, bag_size: 524
batch 359, loss: 2.1474, instance_loss: 0.6037, weighted_loss: 1.6843, label: 4, bag_size: 482
batch 379, loss: 0.2073, instance_loss: 0.3816, weighted_loss: 0.2595, label: 0, bag_size: 319
batch 399, loss: 1.1013, instance_loss: 0.5112, weighted_loss: 0.9243, label: 1, bag_size: 702
batch 419, loss: 0.6969, instance_loss: 0.4580, weighted_loss: 0.6252, label: 3, bag_size: 780
batch 439, loss: 1.6495, instance_loss: 0.5690, weighted_loss: 1.3253, label: 1, bag_size: 461
batch 459, loss: 0.9971, instance_loss: 0.4282, weighted_loss: 0.8264, label: 4, bag_size: 395
batch 479, loss: 1.9222, instance_loss: 0.6276, weighted_loss: 1.5338, label: 1, bag_size: 564
batch 499, loss: 1.8243, instance_loss: 0.5327, weighted_loss: 1.4368, label: 2, bag_size: 361
batch 519, loss: 0.2169, instance_loss: 0.3447, weighted_loss: 0.2552, label: 0, bag_size: 71
batch 539, loss: 1.1237, instance_loss: 0.4735, weighted_loss: 0.9286, label: 2, bag_size: 266
batch 559, loss: 0.5787, instance_loss: 0.4325, weighted_loss: 0.5349, label: 3, bag_size: 1021
batch 579, loss: 1.0644, instance_loss: 0.4496, weighted_loss: 0.8799, label: 1, bag_size: 422


class 0 clustering acc 0.9981902356902357: correct 23717/23760
class 1 clustering acc 0.027567340067340067: correct 131/4752
Epoch: 39, train_loss: 1.0911, train_clustering_loss:  0.4868, train_error: 0.4798
class 0: acc 0.8015873015873016, correct 101/126
class 1: acc 0.4322033898305085, correct 51/118
class 2: acc 0.2868217054263566, correct 37/129
class 3: acc 0.5365853658536586, correct 66/123
class 4: acc 0.5510204081632653, correct 54/98

Val Set, val_loss: 1.1838, val_error: 0.5270, auc: 0.8262
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.06756756756756757: correct 40/592
class 0: acc 0.9375, correct 15/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0375, instance_loss: 0.2688, weighted_loss: 0.1069, label: 0, bag_size: 573
batch 39, loss: 1.1741, instance_loss: 0.4382, weighted_loss: 0.9533, label: 2, bag_size: 119
batch 59, loss: 1.0371, instance_loss: 0.4033, weighted_loss: 0.8469, label: 3, bag_size: 1131
batch 79, loss: 0.9148, instance_loss: 0.5150, weighted_loss: 0.7948, label: 2, bag_size: 288
batch 99, loss: 1.7850, instance_loss: 0.5453, weighted_loss: 1.4131, label: 2, bag_size: 582
batch 119, loss: 1.8209, instance_loss: 0.4939, weighted_loss: 1.4228, label: 1, bag_size: 208
batch 139, loss: 0.9076, instance_loss: 0.4235, weighted_loss: 0.7624, label: 2, bag_size: 445
batch 159, loss: 1.5850, instance_loss: 0.5200, weighted_loss: 1.2655, label: 4, bag_size: 438
batch 179, loss: 0.1559, instance_loss: 0.2519, weighted_loss: 0.1847, label: 0, bag_size: 493
batch 199, loss: 0.6262, instance_loss: 0.4567, weighted_loss: 0.5753, label: 2, bag_size: 851
batch 219, loss: 1.4407, instance_loss: 0.5427, weighted_loss: 1.1713, label: 3, bag_size: 681
batch 239, loss: 1.0880, instance_loss: 0.5271, weighted_loss: 0.9197, label: 2, bag_size: 867
batch 259, loss: 0.6294, instance_loss: 0.4268, weighted_loss: 0.5686, label: 3, bag_size: 684
batch 279, loss: 0.0309, instance_loss: 0.3925, weighted_loss: 0.1394, label: 0, bag_size: 397
batch 299, loss: 0.7725, instance_loss: 0.4432, weighted_loss: 0.6737, label: 3, bag_size: 393
batch 319, loss: 1.4094, instance_loss: 0.5030, weighted_loss: 1.1375, label: 1, bag_size: 329
batch 339, loss: 0.3761, instance_loss: 0.5123, weighted_loss: 0.4169, label: 4, bag_size: 263
batch 359, loss: 0.7062, instance_loss: 0.4830, weighted_loss: 0.6393, label: 3, bag_size: 312
batch 379, loss: 1.7798, instance_loss: 0.4562, weighted_loss: 1.3827, label: 1, bag_size: 616
batch 399, loss: 2.2900, instance_loss: 0.5574, weighted_loss: 1.7702, label: 2, bag_size: 861
batch 419, loss: 0.2543, instance_loss: 0.4174, weighted_loss: 0.3032, label: 2, bag_size: 470
batch 439, loss: 2.2741, instance_loss: 0.5588, weighted_loss: 1.7595, label: 4, bag_size: 592
batch 459, loss: 1.5289, instance_loss: 0.5811, weighted_loss: 1.2446, label: 3, bag_size: 154
batch 479, loss: 2.0239, instance_loss: 0.6220, weighted_loss: 1.6033, label: 2, bag_size: 860
batch 499, loss: 1.0830, instance_loss: 0.4575, weighted_loss: 0.8953, label: 4, bag_size: 862
batch 519, loss: 0.2475, instance_loss: 0.4132, weighted_loss: 0.2972, label: 4, bag_size: 409
batch 539, loss: 0.0951, instance_loss: 0.1744, weighted_loss: 0.1189, label: 0, bag_size: 57
batch 559, loss: 0.6379, instance_loss: 0.4033, weighted_loss: 0.5675, label: 2, bag_size: 375
batch 579, loss: 0.2512, instance_loss: 0.4486, weighted_loss: 0.3104, label: 0, bag_size: 455


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.041877104377104374: correct 199/4752
Epoch: 40, train_loss: 1.0339, train_clustering_loss:  0.4834, train_error: 0.4461
class 0: acc 0.8095238095238095, correct 102/126
class 1: acc 0.39622641509433965, correct 42/106
class 2: acc 0.43548387096774194, correct 54/124
class 3: acc 0.552, correct 69/125
class 4: acc 0.5486725663716814, correct 62/113

Val Set, val_loss: 1.2636, val_error: 0.4865, auc: 0.7971
class 0 clustering acc 0.9945945945945946: correct 2944/2960
class 1 clustering acc 0.03885135135135135: correct 23/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.6440, instance_loss: 0.4809, weighted_loss: 0.5950, label: 2, bag_size: 427
batch 39, loss: 0.0117, instance_loss: 0.2116, weighted_loss: 0.0717, label: 0, bag_size: 527
batch 59, loss: 1.3693, instance_loss: 0.5205, weighted_loss: 1.1147, label: 4, bag_size: 970
batch 79, loss: 2.1206, instance_loss: 0.6159, weighted_loss: 1.6692, label: 2, bag_size: 754
batch 99, loss: 0.9190, instance_loss: 0.6570, weighted_loss: 0.8404, label: 4, bag_size: 854
batch 119, loss: 0.7784, instance_loss: 0.5504, weighted_loss: 0.7100, label: 0, bag_size: 367
batch 139, loss: 1.4585, instance_loss: 0.4913, weighted_loss: 1.1683, label: 1, bag_size: 742
batch 159, loss: 2.5623, instance_loss: 1.1210, weighted_loss: 2.1299, label: 0, bag_size: 421
batch 179, loss: 0.2644, instance_loss: 0.3936, weighted_loss: 0.3031, label: 0, bag_size: 74
batch 199, loss: 0.9214, instance_loss: 0.4718, weighted_loss: 0.7865, label: 2, bag_size: 489
batch 219, loss: 3.9547, instance_loss: 0.7399, weighted_loss: 2.9902, label: 1, bag_size: 45
batch 239, loss: 1.4730, instance_loss: 0.4970, weighted_loss: 1.1802, label: 1, bag_size: 208
batch 259, loss: 0.7801, instance_loss: 0.6399, weighted_loss: 0.7380, label: 1, bag_size: 874
batch 279, loss: 0.8082, instance_loss: 0.4565, weighted_loss: 0.7027, label: 1, bag_size: 328
batch 299, loss: 1.1084, instance_loss: 0.4582, weighted_loss: 0.9133, label: 2, bag_size: 697
batch 319, loss: 2.1411, instance_loss: 0.7241, weighted_loss: 1.7160, label: 2, bag_size: 244
batch 339, loss: 0.3055, instance_loss: 0.4220, weighted_loss: 0.3404, label: 0, bag_size: 258
batch 359, loss: 1.2900, instance_loss: 0.7685, weighted_loss: 1.1335, label: 3, bag_size: 794
batch 379, loss: 1.0088, instance_loss: 0.4443, weighted_loss: 0.8395, label: 2, bag_size: 861
batch 399, loss: 0.3887, instance_loss: 0.4235, weighted_loss: 0.3991, label: 2, bag_size: 592
batch 419, loss: 0.9488, instance_loss: 0.4459, weighted_loss: 0.7979, label: 4, bag_size: 824
batch 439, loss: 0.1941, instance_loss: 0.4892, weighted_loss: 0.2827, label: 0, bag_size: 258
batch 459, loss: 0.2393, instance_loss: 0.5402, weighted_loss: 0.3296, label: 0, bag_size: 73
batch 479, loss: 1.0053, instance_loss: 0.5596, weighted_loss: 0.8716, label: 3, bag_size: 697
batch 499, loss: 2.3790, instance_loss: 0.4985, weighted_loss: 1.8148, label: 1, bag_size: 1009
batch 519, loss: 1.1959, instance_loss: 0.3973, weighted_loss: 0.9563, label: 4, bag_size: 729
batch 539, loss: 0.5047, instance_loss: 0.4172, weighted_loss: 0.4785, label: 4, bag_size: 563
batch 559, loss: 0.5035, instance_loss: 0.5335, weighted_loss: 0.5125, label: 4, bag_size: 238
batch 579, loss: 0.4282, instance_loss: 0.4868, weighted_loss: 0.4458, label: 1, bag_size: 231


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.03409090909090909: correct 162/4752
Epoch: 41, train_loss: 1.0408, train_clustering_loss:  0.4828, train_error: 0.4377
class 0: acc 0.8448275862068966, correct 98/116
class 1: acc 0.4152542372881356, correct 49/118
class 2: acc 0.4765625, correct 61/128
class 3: acc 0.5135135135135135, correct 57/111
class 4: acc 0.5702479338842975, correct 69/121

Val Set, val_loss: 1.1064, val_error: 0.3784, auc: 0.8459
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5714285714285714, correct 8/14
Validation loss decreased (1.153202 --> 1.106437).  Saving model ...


batch 19, loss: 0.0067, instance_loss: 0.2718, weighted_loss: 0.0863, label: 0, bag_size: 51
batch 39, loss: 0.2930, instance_loss: 0.3994, weighted_loss: 0.3249, label: 3, bag_size: 309
batch 59, loss: 1.1219, instance_loss: 0.4832, weighted_loss: 0.9303, label: 3, bag_size: 779
batch 79, loss: 0.8359, instance_loss: 0.4949, weighted_loss: 0.7336, label: 2, bag_size: 315
batch 99, loss: 0.6201, instance_loss: 0.4595, weighted_loss: 0.5719, label: 1, bag_size: 865
batch 119, loss: 1.0760, instance_loss: 0.4553, weighted_loss: 0.8898, label: 4, bag_size: 176
batch 139, loss: 0.3786, instance_loss: 0.4442, weighted_loss: 0.3983, label: 0, bag_size: 231
batch 159, loss: 0.9742, instance_loss: 0.5298, weighted_loss: 0.8408, label: 4, bag_size: 699
batch 179, loss: 1.1094, instance_loss: 0.5339, weighted_loss: 0.9368, label: 2, bag_size: 549
batch 199, loss: 0.0480, instance_loss: 0.4105, weighted_loss: 0.1567, label: 0, bag_size: 702
batch 219, loss: 0.6907, instance_loss: 0.4105, weighted_loss: 0.6066, label: 2, bag_size: 266
batch 239, loss: 0.8485, instance_loss: 0.3961, weighted_loss: 0.7128, label: 0, bag_size: 97
batch 259, loss: 1.1352, instance_loss: 0.4240, weighted_loss: 0.9218, label: 1, bag_size: 544
batch 279, loss: 2.9237, instance_loss: 0.5728, weighted_loss: 2.2184, label: 4, bag_size: 310
batch 299, loss: 1.0936, instance_loss: 0.3767, weighted_loss: 0.8785, label: 2, bag_size: 380
batch 319, loss: 0.1832, instance_loss: 0.4790, weighted_loss: 0.2720, label: 4, bag_size: 530
batch 339, loss: 0.4316, instance_loss: 0.3867, weighted_loss: 0.4181, label: 4, bag_size: 1018
batch 359, loss: 1.9255, instance_loss: 0.6053, weighted_loss: 1.5295, label: 3, bag_size: 899
batch 379, loss: 0.9347, instance_loss: 0.4740, weighted_loss: 0.7965, label: 3, bag_size: 496
batch 399, loss: 0.7809, instance_loss: 0.4835, weighted_loss: 0.6917, label: 4, bag_size: 703
batch 419, loss: 0.1148, instance_loss: 0.5169, weighted_loss: 0.2355, label: 0, bag_size: 295
batch 439, loss: 0.6989, instance_loss: 0.4104, weighted_loss: 0.6124, label: 4, bag_size: 824
batch 459, loss: 2.0772, instance_loss: 0.5770, weighted_loss: 1.6271, label: 3, bag_size: 533
batch 479, loss: 2.0388, instance_loss: 0.5425, weighted_loss: 1.5899, label: 2, bag_size: 1071
batch 499, loss: 1.3844, instance_loss: 0.5530, weighted_loss: 1.1350, label: 1, bag_size: 1104
batch 519, loss: 0.4688, instance_loss: 0.4942, weighted_loss: 0.4764, label: 0, bag_size: 367
batch 539, loss: 0.7344, instance_loss: 0.4797, weighted_loss: 0.6580, label: 1, bag_size: 328
batch 559, loss: 1.5532, instance_loss: 0.5352, weighted_loss: 1.2478, label: 1, bag_size: 564
batch 579, loss: 0.0005, instance_loss: 0.3485, weighted_loss: 0.1049, label: 4, bag_size: 769


class 0 clustering acc 0.9976010101010101: correct 23703/23760
class 1 clustering acc 0.026304713804713806: correct 125/4752
Epoch: 42, train_loss: 1.1080, train_clustering_loss:  0.4870, train_error: 0.4815
class 0: acc 0.7105263157894737, correct 81/114
class 1: acc 0.35, correct 35/100
class 2: acc 0.45454545454545453, correct 65/143
class 3: acc 0.5267857142857143, correct 59/112
class 4: acc 0.544, correct 68/125

Val Set, val_loss: 1.2204, val_error: 0.4730, auc: 0.8203
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.03547297297297297: correct 21/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1343, instance_loss: 0.4042, weighted_loss: 0.2153, label: 0, bag_size: 573
batch 39, loss: 1.5876, instance_loss: 0.4985, weighted_loss: 1.2609, label: 2, bag_size: 744
batch 59, loss: 0.0315, instance_loss: 0.3066, weighted_loss: 0.1140, label: 0, bag_size: 524
batch 79, loss: 0.7556, instance_loss: 0.5574, weighted_loss: 0.6961, label: 4, bag_size: 862
batch 99, loss: 0.7110, instance_loss: 0.5809, weighted_loss: 0.6720, label: 1, bag_size: 161
batch 119, loss: 2.0744, instance_loss: 0.5166, weighted_loss: 1.6071, label: 2, bag_size: 119
batch 139, loss: 1.5150, instance_loss: 0.6715, weighted_loss: 1.2619, label: 0, bag_size: 273
batch 159, loss: 0.9424, instance_loss: 0.5406, weighted_loss: 0.8219, label: 4, bag_size: 854
batch 179, loss: 2.3185, instance_loss: 0.5895, weighted_loss: 1.7998, label: 1, bag_size: 526
batch 199, loss: 0.1609, instance_loss: 0.2965, weighted_loss: 0.2016, label: 0, bag_size: 57
batch 219, loss: 2.4195, instance_loss: 0.6442, weighted_loss: 1.8869, label: 0, bag_size: 745
batch 239, loss: 1.0424, instance_loss: 0.5114, weighted_loss: 0.8831, label: 2, bag_size: 605
batch 259, loss: 0.4995, instance_loss: 0.4682, weighted_loss: 0.4901, label: 3, bag_size: 282
batch 279, loss: 0.2419, instance_loss: 0.3317, weighted_loss: 0.2688, label: 0, bag_size: 393
batch 299, loss: 0.6667, instance_loss: 0.5239, weighted_loss: 0.6239, label: 3, bag_size: 398
batch 319, loss: 0.1364, instance_loss: 0.4771, weighted_loss: 0.2386, label: 0, bag_size: 383
batch 339, loss: 0.5902, instance_loss: 0.4670, weighted_loss: 0.5532, label: 4, bag_size: 489
batch 359, loss: 2.2862, instance_loss: 0.4850, weighted_loss: 1.7459, label: 3, bag_size: 473
batch 379, loss: 1.5198, instance_loss: 0.4798, weighted_loss: 1.2078, label: 2, bag_size: 498
batch 399, loss: 0.2797, instance_loss: 0.4622, weighted_loss: 0.3345, label: 0, bag_size: 122
batch 419, loss: 0.9251, instance_loss: 0.4500, weighted_loss: 0.7826, label: 3, bag_size: 192
batch 439, loss: 1.2526, instance_loss: 0.4244, weighted_loss: 1.0041, label: 1, bag_size: 413
batch 459, loss: 0.0148, instance_loss: 0.3559, weighted_loss: 0.1171, label: 0, bag_size: 428
batch 479, loss: 1.2758, instance_loss: 0.4419, weighted_loss: 1.0256, label: 2, bag_size: 645
batch 499, loss: 0.4496, instance_loss: 0.4636, weighted_loss: 0.4538, label: 0, bag_size: 231
batch 519, loss: 1.2023, instance_loss: 0.4280, weighted_loss: 0.9700, label: 1, bag_size: 614
batch 539, loss: 1.1441, instance_loss: 0.5035, weighted_loss: 0.9519, label: 2, bag_size: 853
batch 559, loss: 1.4723, instance_loss: 0.4805, weighted_loss: 1.1747, label: 2, bag_size: 543
batch 579, loss: 0.1879, instance_loss: 0.4052, weighted_loss: 0.2531, label: 4, bag_size: 923


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.023148148148148147: correct 110/4752
Epoch: 43, train_loss: 1.0987, train_clustering_loss:  0.4918, train_error: 0.4512
class 0: acc 0.7894736842105263, correct 90/114
class 1: acc 0.5428571428571428, correct 76/140
class 2: acc 0.2892561983471074, correct 35/121
class 3: acc 0.5233644859813084, correct 56/107
class 4: acc 0.6160714285714286, correct 69/112

Val Set, val_loss: 1.2450, val_error: 0.5135, auc: 0.8267
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.02702702702702703: correct 16/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.2857142857142857, correct 4/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5475, instance_loss: 0.4815, weighted_loss: 0.5277, label: 0, bag_size: 581
batch 39, loss: 3.4528, instance_loss: 0.5763, weighted_loss: 2.5899, label: 1, bag_size: 45
batch 59, loss: 1.6352, instance_loss: 0.5254, weighted_loss: 1.3022, label: 2, bag_size: 746
batch 79, loss: 0.0957, instance_loss: 0.6046, weighted_loss: 0.2484, label: 4, bag_size: 948
batch 99, loss: 0.7005, instance_loss: 0.5771, weighted_loss: 0.6635, label: 0, bag_size: 247
batch 119, loss: 1.0044, instance_loss: 0.5320, weighted_loss: 0.8627, label: 3, bag_size: 1078
batch 139, loss: 1.0602, instance_loss: 0.4560, weighted_loss: 0.8789, label: 0, bag_size: 615
batch 159, loss: 0.2872, instance_loss: 0.3141, weighted_loss: 0.2953, label: 1, bag_size: 886
batch 179, loss: 0.9430, instance_loss: 0.4807, weighted_loss: 0.8043, label: 3, bag_size: 797
batch 199, loss: 0.8897, instance_loss: 0.4388, weighted_loss: 0.7545, label: 1, bag_size: 855
batch 219, loss: 1.2486, instance_loss: 0.5259, weighted_loss: 1.0317, label: 3, bag_size: 1154
batch 239, loss: 1.2657, instance_loss: 0.5570, weighted_loss: 1.0531, label: 3, bag_size: 857
batch 259, loss: 0.7038, instance_loss: 0.4570, weighted_loss: 0.6298, label: 4, bag_size: 1077
batch 279, loss: 0.8128, instance_loss: 0.4826, weighted_loss: 0.7137, label: 4, bag_size: 755
batch 299, loss: 0.7766, instance_loss: 0.5180, weighted_loss: 0.6990, label: 4, bag_size: 683
batch 319, loss: 0.0292, instance_loss: 0.2885, weighted_loss: 0.1070, label: 0, bag_size: 188
batch 339, loss: 0.2903, instance_loss: 0.3410, weighted_loss: 0.3055, label: 0, bag_size: 122
batch 359, loss: 0.3036, instance_loss: 0.3798, weighted_loss: 0.3265, label: 1, bag_size: 748
batch 379, loss: 1.1857, instance_loss: 0.5795, weighted_loss: 1.0038, label: 4, bag_size: 356
batch 399, loss: 2.8949, instance_loss: 0.6015, weighted_loss: 2.2069, label: 1, bag_size: 184
batch 419, loss: 1.3238, instance_loss: 0.5074, weighted_loss: 1.0789, label: 4, bag_size: 176
batch 439, loss: 0.9792, instance_loss: 0.5059, weighted_loss: 0.8372, label: 3, bag_size: 1078
batch 459, loss: 0.1085, instance_loss: 0.2734, weighted_loss: 0.1579, label: 0, bag_size: 282
batch 479, loss: 1.1310, instance_loss: 0.5184, weighted_loss: 0.9472, label: 2, bag_size: 390
batch 499, loss: 0.9045, instance_loss: 0.4892, weighted_loss: 0.7800, label: 3, bag_size: 797
batch 519, loss: 1.0846, instance_loss: 0.4009, weighted_loss: 0.8795, label: 1, bag_size: 1082
batch 539, loss: 0.9060, instance_loss: 0.5136, weighted_loss: 0.7883, label: 4, bag_size: 703
batch 559, loss: 0.0170, instance_loss: 0.2083, weighted_loss: 0.0744, label: 0, bag_size: 255
batch 579, loss: 1.1404, instance_loss: 0.5726, weighted_loss: 0.9701, label: 2, bag_size: 258


class 0 clustering acc 0.997895622895623: correct 23710/23760
class 1 clustering acc 0.02441077441077441: correct 116/4752
Epoch: 44, train_loss: 1.0481, train_clustering_loss:  0.4839, train_error: 0.4209
class 0: acc 0.8260869565217391, correct 114/138
class 1: acc 0.5882352941176471, correct 80/136
class 2: acc 0.24509803921568626, correct 25/102
class 3: acc 0.6, correct 63/105
class 4: acc 0.5486725663716814, correct 62/113

Val Set, val_loss: 1.1722, val_error: 0.4459, auc: 0.8253
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.011824324324324325: correct 7/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0922, instance_loss: 0.4796, weighted_loss: 0.9084, label: 1, bag_size: 1082
batch 39, loss: 1.5769, instance_loss: 0.5099, weighted_loss: 1.2568, label: 4, bag_size: 312
batch 59, loss: 0.9266, instance_loss: 0.4795, weighted_loss: 0.7925, label: 3, bag_size: 474
batch 79, loss: 0.1370, instance_loss: 0.4118, weighted_loss: 0.2194, label: 0, bag_size: 73
batch 99, loss: 1.0495, instance_loss: 0.5488, weighted_loss: 0.8993, label: 3, bag_size: 369
batch 119, loss: 1.1975, instance_loss: 0.4510, weighted_loss: 0.9735, label: 1, bag_size: 201
batch 139, loss: 0.2528, instance_loss: 0.3833, weighted_loss: 0.2920, label: 4, bag_size: 129
batch 159, loss: 1.2448, instance_loss: 0.4578, weighted_loss: 1.0087, label: 1, bag_size: 413
batch 179, loss: 0.7453, instance_loss: 0.4241, weighted_loss: 0.6489, label: 4, bag_size: 729
batch 199, loss: 0.8650, instance_loss: 0.4750, weighted_loss: 0.7480, label: 2, bag_size: 812
batch 219, loss: 0.0308, instance_loss: 0.2834, weighted_loss: 0.1066, label: 0, bag_size: 397
batch 239, loss: 0.1074, instance_loss: 0.3256, weighted_loss: 0.1729, label: 0, bag_size: 71
batch 259, loss: 0.8425, instance_loss: 0.5576, weighted_loss: 0.7570, label: 1, bag_size: 865
batch 279, loss: 2.0540, instance_loss: 0.5246, weighted_loss: 1.5952, label: 2, bag_size: 297
batch 299, loss: 0.0929, instance_loss: 0.4935, weighted_loss: 0.2131, label: 4, bag_size: 260
batch 319, loss: 0.8658, instance_loss: 0.3867, weighted_loss: 0.7221, label: 2, bag_size: 1003
batch 339, loss: 1.6229, instance_loss: 0.5705, weighted_loss: 1.3072, label: 4, bag_size: 395
batch 359, loss: 1.6218, instance_loss: 0.4823, weighted_loss: 1.2799, label: 1, bag_size: 695
batch 379, loss: 0.5322, instance_loss: 0.5190, weighted_loss: 0.5283, label: 4, bag_size: 683
batch 399, loss: 1.0310, instance_loss: 0.5118, weighted_loss: 0.8753, label: 2, bag_size: 266
batch 419, loss: 0.9517, instance_loss: 0.4859, weighted_loss: 0.8119, label: 1, bag_size: 1091
batch 439, loss: 1.6712, instance_loss: 0.5940, weighted_loss: 1.3480, label: 4, bag_size: 476
batch 459, loss: 0.7429, instance_loss: 0.5382, weighted_loss: 0.6815, label: 0, bag_size: 62
batch 479, loss: 1.0892, instance_loss: 0.6380, weighted_loss: 0.9538, label: 1, bag_size: 874
batch 499, loss: 0.1834, instance_loss: 0.3448, weighted_loss: 0.2318, label: 0, bag_size: 642
batch 519, loss: 0.0198, instance_loss: 0.2268, weighted_loss: 0.0819, label: 0, bag_size: 527
batch 539, loss: 0.8305, instance_loss: 0.4902, weighted_loss: 0.7284, label: 4, bag_size: 776
batch 559, loss: 0.4557, instance_loss: 0.4055, weighted_loss: 0.4406, label: 2, bag_size: 631
batch 579, loss: 0.8744, instance_loss: 0.4211, weighted_loss: 0.7384, label: 2, bag_size: 877


class 0 clustering acc 0.9974747474747475: correct 23700/23760
class 1 clustering acc 0.031144781144781145: correct 148/4752
Epoch: 45, train_loss: 1.0593, train_clustering_loss:  0.4863, train_error: 0.4579
class 0: acc 0.7846153846153846, correct 102/130
class 1: acc 0.3611111111111111, correct 39/108
class 2: acc 0.4453125, correct 57/128
class 3: acc 0.5, correct 57/114
class 4: acc 0.5877192982456141, correct 67/114

Val Set, val_loss: 1.0729, val_error: 0.4324, auc: 0.8438
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.6428571428571429, correct 9/14
Validation loss decreased (1.106437 --> 1.072932).  Saving model ...


batch 19, loss: 0.9904, instance_loss: 0.5899, weighted_loss: 0.8702, label: 3, bag_size: 1001
batch 39, loss: 1.6742, instance_loss: 0.5137, weighted_loss: 1.3260, label: 3, bag_size: 317
batch 59, loss: 1.5937, instance_loss: 0.5077, weighted_loss: 1.2679, label: 1, bag_size: 208
batch 79, loss: 0.2038, instance_loss: 0.3529, weighted_loss: 0.2485, label: 0, bag_size: 97
batch 99, loss: 0.9317, instance_loss: 0.5421, weighted_loss: 0.8148, label: 2, bag_size: 549
batch 119, loss: 0.6791, instance_loss: 0.4579, weighted_loss: 0.6127, label: 1, bag_size: 1103
batch 139, loss: 2.4705, instance_loss: 0.7204, weighted_loss: 1.9455, label: 0, bag_size: 492
batch 159, loss: 0.2821, instance_loss: 0.4626, weighted_loss: 0.3363, label: 0, bag_size: 1085
batch 179, loss: 0.5200, instance_loss: 0.4174, weighted_loss: 0.4892, label: 0, bag_size: 1085
batch 199, loss: 1.3763, instance_loss: 0.5376, weighted_loss: 1.1247, label: 4, bag_size: 438
batch 219, loss: 1.3191, instance_loss: 0.5246, weighted_loss: 1.0808, label: 1, bag_size: 949
batch 239, loss: 0.5887, instance_loss: 0.5126, weighted_loss: 0.5659, label: 4, bag_size: 160
batch 259, loss: 2.1757, instance_loss: 0.5308, weighted_loss: 1.6822, label: 4, bag_size: 685
batch 279, loss: 0.8417, instance_loss: 0.4050, weighted_loss: 0.7107, label: 2, bag_size: 402
batch 299, loss: 1.1416, instance_loss: 0.4342, weighted_loss: 0.9294, label: 2, bag_size: 645
batch 319, loss: 1.1668, instance_loss: 0.4826, weighted_loss: 0.9616, label: 2, bag_size: 645
batch 339, loss: 1.0810, instance_loss: 0.4372, weighted_loss: 0.8879, label: 2, bag_size: 861
batch 359, loss: 0.6277, instance_loss: 0.4135, weighted_loss: 0.5634, label: 2, bag_size: 853
batch 379, loss: 1.4702, instance_loss: 0.4197, weighted_loss: 1.1551, label: 3, bag_size: 779
batch 399, loss: 2.0983, instance_loss: 0.5657, weighted_loss: 1.6385, label: 1, bag_size: 981
batch 419, loss: 0.9618, instance_loss: 0.4792, weighted_loss: 0.8170, label: 3, bag_size: 451
batch 439, loss: 1.4816, instance_loss: 0.6507, weighted_loss: 1.2323, label: 1, bag_size: 616
batch 459, loss: 1.0914, instance_loss: 0.4391, weighted_loss: 0.8957, label: 1, bag_size: 526
batch 479, loss: 0.4606, instance_loss: 0.5426, weighted_loss: 0.4852, label: 0, bag_size: 238
batch 499, loss: 2.0437, instance_loss: 0.5423, weighted_loss: 1.5933, label: 2, bag_size: 1060
batch 519, loss: 1.9045, instance_loss: 0.5002, weighted_loss: 1.4832, label: 1, bag_size: 233
batch 539, loss: 0.5480, instance_loss: 0.4838, weighted_loss: 0.5287, label: 2, bag_size: 549
batch 559, loss: 0.4856, instance_loss: 0.4369, weighted_loss: 0.4710, label: 3, bag_size: 684
batch 579, loss: 0.0774, instance_loss: 0.3688, weighted_loss: 0.1648, label: 0, bag_size: 428


class 0 clustering acc 0.9976851851851852: correct 23705/23760
class 1 clustering acc 0.026515151515151516: correct 126/4752
Epoch: 46, train_loss: 1.0512, train_clustering_loss:  0.4933, train_error: 0.4815
class 0: acc 0.8103448275862069, correct 94/116
class 1: acc 0.41025641025641024, correct 48/117
class 2: acc 0.36923076923076925, correct 48/130
class 3: acc 0.42727272727272725, correct 47/110
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.1406, val_error: 0.5676, auc: 0.8300
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.028716216216216218: correct 17/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6354, instance_loss: 0.5085, weighted_loss: 0.5973, label: 1, bag_size: 1091
batch 39, loss: 0.0000, instance_loss: 0.3897, weighted_loss: 0.1169, label: 2, bag_size: 936
batch 59, loss: 0.8377, instance_loss: 0.4380, weighted_loss: 0.7178, label: 3, bag_size: 663
batch 79, loss: 1.4260, instance_loss: 0.5022, weighted_loss: 1.1489, label: 4, bag_size: 363
batch 99, loss: 0.0356, instance_loss: 0.2540, weighted_loss: 0.1011, label: 0, bag_size: 425
batch 119, loss: 2.8209, instance_loss: 0.6721, weighted_loss: 2.1762, label: 2, bag_size: 829
batch 139, loss: 0.7093, instance_loss: 0.4790, weighted_loss: 0.6402, label: 2, bag_size: 385
batch 159, loss: 0.6118, instance_loss: 0.4359, weighted_loss: 0.5590, label: 3, bag_size: 309
batch 179, loss: 0.7781, instance_loss: 0.4620, weighted_loss: 0.6833, label: 2, bag_size: 769
batch 199, loss: 1.2223, instance_loss: 0.4619, weighted_loss: 0.9942, label: 2, bag_size: 781
batch 219, loss: 0.9532, instance_loss: 0.4281, weighted_loss: 0.7957, label: 4, bag_size: 409
batch 239, loss: 0.6711, instance_loss: 0.4602, weighted_loss: 0.6078, label: 3, bag_size: 235
batch 259, loss: 0.8487, instance_loss: 0.4699, weighted_loss: 0.7351, label: 2, bag_size: 702
batch 279, loss: 1.1369, instance_loss: 0.4871, weighted_loss: 0.9419, label: 3, bag_size: 499
batch 299, loss: 0.6137, instance_loss: 0.4408, weighted_loss: 0.5619, label: 4, bag_size: 986
batch 319, loss: 1.3623, instance_loss: 0.5128, weighted_loss: 1.1075, label: 2, bag_size: 557
batch 339, loss: 0.9765, instance_loss: 0.4875, weighted_loss: 0.8298, label: 3, bag_size: 498
batch 359, loss: 1.4194, instance_loss: 0.5812, weighted_loss: 1.1679, label: 3, bag_size: 98
batch 379, loss: 0.8329, instance_loss: 0.4032, weighted_loss: 0.7040, label: 2, bag_size: 530
batch 399, loss: 0.2933, instance_loss: 0.4214, weighted_loss: 0.3317, label: 3, bag_size: 496
batch 419, loss: 0.0259, instance_loss: 0.2010, weighted_loss: 0.0785, label: 0, bag_size: 97
batch 439, loss: 0.5726, instance_loss: 0.5645, weighted_loss: 0.5702, label: 2, bag_size: 303
batch 459, loss: 0.0755, instance_loss: 0.2289, weighted_loss: 0.1215, label: 0, bag_size: 74
batch 479, loss: 0.2184, instance_loss: 0.3772, weighted_loss: 0.2660, label: 0, bag_size: 159
batch 499, loss: 0.3027, instance_loss: 0.4957, weighted_loss: 0.3606, label: 0, bag_size: 416
batch 519, loss: 0.4853, instance_loss: 0.3915, weighted_loss: 0.4571, label: 3, bag_size: 625
batch 539, loss: 0.7156, instance_loss: 0.4061, weighted_loss: 0.6227, label: 3, bag_size: 97
batch 559, loss: 0.0016, instance_loss: 0.1929, weighted_loss: 0.0590, label: 0, bag_size: 258
batch 579, loss: 1.0405, instance_loss: 0.4754, weighted_loss: 0.8710, label: 3, bag_size: 779


class 0 clustering acc 0.9969276094276094: correct 23687/23760
class 1 clustering acc 0.03745791245791246: correct 178/4752
Epoch: 47, train_loss: 0.9977, train_clustering_loss:  0.4785, train_error: 0.4343
class 0: acc 0.8439716312056738, correct 119/141
class 1: acc 0.4224137931034483, correct 49/116
class 2: acc 0.34234234234234234, correct 38/111
class 3: acc 0.6370967741935484, correct 79/124
class 4: acc 0.5, correct 51/102

Val Set, val_loss: 1.2160, val_error: 0.5000, auc: 0.8174
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0741, instance_loss: 0.4616, weighted_loss: 0.1904, label: 1, bag_size: 371
batch 39, loss: 0.8748, instance_loss: 0.4731, weighted_loss: 0.7543, label: 1, bag_size: 311
batch 59, loss: 1.4733, instance_loss: 0.5359, weighted_loss: 1.1921, label: 0, bag_size: 376
batch 79, loss: 1.6185, instance_loss: 0.5324, weighted_loss: 1.2927, label: 3, bag_size: 897
batch 99, loss: 0.6017, instance_loss: 0.4453, weighted_loss: 0.5548, label: 3, bag_size: 598
batch 119, loss: 2.8056, instance_loss: 0.5899, weighted_loss: 2.1409, label: 2, bag_size: 640
batch 139, loss: 1.2393, instance_loss: 0.5367, weighted_loss: 1.0285, label: 1, bag_size: 949
batch 159, loss: 1.3982, instance_loss: 0.6153, weighted_loss: 1.1634, label: 4, bag_size: 695
batch 179, loss: 1.6366, instance_loss: 0.6185, weighted_loss: 1.3312, label: 2, bag_size: 407
batch 199, loss: 0.0016, instance_loss: 0.3316, weighted_loss: 0.1006, label: 0, bag_size: 340
batch 219, loss: 0.8661, instance_loss: 0.4670, weighted_loss: 0.7464, label: 3, bag_size: 1021
batch 239, loss: 1.4048, instance_loss: 0.5387, weighted_loss: 1.1450, label: 1, bag_size: 422
batch 259, loss: 0.0376, instance_loss: 0.2350, weighted_loss: 0.0968, label: 0, bag_size: 357
batch 279, loss: 0.7996, instance_loss: 0.4447, weighted_loss: 0.6931, label: 1, bag_size: 481
batch 299, loss: 0.6858, instance_loss: 0.5023, weighted_loss: 0.6308, label: 2, bag_size: 315
batch 319, loss: 1.2159, instance_loss: 0.4724, weighted_loss: 0.9929, label: 3, bag_size: 364
batch 339, loss: 0.0364, instance_loss: 0.3043, weighted_loss: 0.1168, label: 0, bag_size: 573
batch 359, loss: 2.6693, instance_loss: 0.6182, weighted_loss: 2.0539, label: 3, bag_size: 533
batch 379, loss: 0.0451, instance_loss: 0.2902, weighted_loss: 0.1187, label: 0, bag_size: 79
batch 399, loss: 2.1737, instance_loss: 0.5239, weighted_loss: 1.6787, label: 0, bag_size: 243
batch 419, loss: 1.1612, instance_loss: 0.4748, weighted_loss: 0.9553, label: 2, bag_size: 317
batch 439, loss: 0.8035, instance_loss: 0.5415, weighted_loss: 0.7249, label: 4, bag_size: 342
batch 459, loss: 0.1620, instance_loss: 0.2675, weighted_loss: 0.1936, label: 0, bag_size: 201
batch 479, loss: 0.5396, instance_loss: 0.4144, weighted_loss: 0.5020, label: 1, bag_size: 544
batch 499, loss: 1.0317, instance_loss: 0.5301, weighted_loss: 0.8812, label: 0, bag_size: 615
batch 519, loss: 0.1007, instance_loss: 0.3369, weighted_loss: 0.1715, label: 0, bag_size: 74
batch 539, loss: 1.1111, instance_loss: 0.5299, weighted_loss: 0.9368, label: 2, bag_size: 607
batch 559, loss: 0.0024, instance_loss: 0.2053, weighted_loss: 0.0633, label: 0, bag_size: 230
batch 579, loss: 1.0382, instance_loss: 0.4748, weighted_loss: 0.8692, label: 2, bag_size: 684


class 0 clustering acc 0.9960858585858586: correct 23667/23760
class 1 clustering acc 0.046296296296296294: correct 220/4752
Epoch: 48, train_loss: 1.0566, train_clustering_loss:  0.4852, train_error: 0.4630
class 0: acc 0.8309859154929577, correct 118/142
class 1: acc 0.4482758620689655, correct 52/116
class 2: acc 0.26956521739130435, correct 31/115
class 3: acc 0.6260869565217392, correct 72/115
class 4: acc 0.4339622641509434, correct 46/106

Val Set, val_loss: 1.1589, val_error: 0.4730, auc: 0.8364
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.013513513513513514: correct 8/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4313, instance_loss: 0.4935, weighted_loss: 1.1500, label: 1, bag_size: 355
batch 39, loss: 1.2358, instance_loss: 0.5174, weighted_loss: 1.0202, label: 1, bag_size: 851
batch 59, loss: 2.4447, instance_loss: 0.6769, weighted_loss: 1.9144, label: 2, bag_size: 640
batch 79, loss: 1.5506, instance_loss: 0.5552, weighted_loss: 1.2520, label: 2, bag_size: 1074
batch 99, loss: 1.0171, instance_loss: 0.4980, weighted_loss: 0.8614, label: 4, bag_size: 46
batch 119, loss: 0.4203, instance_loss: 0.4857, weighted_loss: 0.4399, label: 4, bag_size: 895
batch 139, loss: 1.6630, instance_loss: 0.5226, weighted_loss: 1.3208, label: 1, bag_size: 159
batch 159, loss: 2.1017, instance_loss: 0.5447, weighted_loss: 1.6346, label: 1, bag_size: 184
batch 179, loss: 0.0252, instance_loss: 0.1523, weighted_loss: 0.0634, label: 0, bag_size: 258
batch 199, loss: 0.8890, instance_loss: 0.4673, weighted_loss: 0.7625, label: 1, bag_size: 928
batch 219, loss: 1.3691, instance_loss: 0.5482, weighted_loss: 1.1228, label: 2, bag_size: 717
batch 239, loss: 0.3542, instance_loss: 0.5027, weighted_loss: 0.3987, label: 3, bag_size: 488
batch 259, loss: 0.0028, instance_loss: 0.3483, weighted_loss: 0.1064, label: 0, bag_size: 221
batch 279, loss: 0.0462, instance_loss: 0.2983, weighted_loss: 0.1218, label: 0, bag_size: 354
batch 299, loss: 0.4621, instance_loss: 0.5111, weighted_loss: 0.4768, label: 0, bag_size: 316
batch 319, loss: 1.2022, instance_loss: 0.4306, weighted_loss: 0.9707, label: 3, bag_size: 317
batch 339, loss: 0.1792, instance_loss: 0.4408, weighted_loss: 0.2577, label: 1, bag_size: 381
batch 359, loss: 2.5834, instance_loss: 0.5927, weighted_loss: 1.9862, label: 4, bag_size: 468
batch 379, loss: 0.4639, instance_loss: 0.4242, weighted_loss: 0.4520, label: 1, bag_size: 925
batch 399, loss: 0.5660, instance_loss: 0.5176, weighted_loss: 0.5515, label: 4, bag_size: 824
batch 419, loss: 0.4548, instance_loss: 0.4227, weighted_loss: 0.4451, label: 1, bag_size: 271
batch 439, loss: 0.2614, instance_loss: 0.5037, weighted_loss: 0.3341, label: 0, bag_size: 455
batch 459, loss: 0.0930, instance_loss: 0.3947, weighted_loss: 0.1835, label: 0, bag_size: 524
batch 479, loss: 0.8370, instance_loss: 0.3535, weighted_loss: 0.6920, label: 4, bag_size: 356
batch 499, loss: 2.3537, instance_loss: 0.5064, weighted_loss: 1.7995, label: 4, bag_size: 489
batch 519, loss: 1.3376, instance_loss: 0.5074, weighted_loss: 1.0885, label: 4, bag_size: 176
batch 539, loss: 0.7172, instance_loss: 0.5499, weighted_loss: 0.6670, label: 1, bag_size: 851
batch 559, loss: 1.3513, instance_loss: 0.5441, weighted_loss: 1.1091, label: 0, bag_size: 143
batch 579, loss: 1.6244, instance_loss: 0.5524, weighted_loss: 1.3028, label: 3, bag_size: 390


class 0 clustering acc 0.9973484848484848: correct 23697/23760
class 1 clustering acc 0.027567340067340067: correct 131/4752
Epoch: 49, train_loss: 1.0073, train_clustering_loss:  0.4890, train_error: 0.4394
class 0: acc 0.8347107438016529, correct 101/121
class 1: acc 0.5116279069767442, correct 66/129
class 2: acc 0.32456140350877194, correct 37/114
class 3: acc 0.6033057851239669, correct 73/121
class 4: acc 0.5137614678899083, correct 56/109

Val Set, val_loss: 1.1580, val_error: 0.4865, auc: 0.8294
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.048986486486486486: correct 29/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7634, instance_loss: 0.5031, weighted_loss: 0.6853, label: 2, bag_size: 557
batch 39, loss: 2.3602, instance_loss: 0.7870, weighted_loss: 1.8882, label: 3, bag_size: 608
batch 59, loss: 0.6325, instance_loss: 0.4739, weighted_loss: 0.5849, label: 3, bag_size: 154
batch 79, loss: 1.5209, instance_loss: 0.5596, weighted_loss: 1.2325, label: 4, bag_size: 198
batch 99, loss: 1.1028, instance_loss: 0.6576, weighted_loss: 0.9693, label: 0, bag_size: 343
batch 119, loss: 0.9811, instance_loss: 0.5180, weighted_loss: 0.8421, label: 2, bag_size: 549
batch 139, loss: 0.4257, instance_loss: 0.5118, weighted_loss: 0.4515, label: 4, bag_size: 923
batch 159, loss: 0.7934, instance_loss: 0.4462, weighted_loss: 0.6892, label: 4, bag_size: 198
batch 179, loss: 1.9252, instance_loss: 0.5222, weighted_loss: 1.5043, label: 1, bag_size: 840
batch 199, loss: 0.9654, instance_loss: 0.6674, weighted_loss: 0.8760, label: 2, bag_size: 219
batch 219, loss: 0.5032, instance_loss: 0.4546, weighted_loss: 0.4886, label: 1, bag_size: 461
batch 239, loss: 0.8935, instance_loss: 0.5701, weighted_loss: 0.7965, label: 3, bag_size: 1186
batch 259, loss: 0.9546, instance_loss: 0.4773, weighted_loss: 0.8114, label: 2, bag_size: 651
batch 279, loss: 0.6728, instance_loss: 0.4730, weighted_loss: 0.6129, label: 3, bag_size: 1131
batch 299, loss: 0.8843, instance_loss: 0.4474, weighted_loss: 0.7532, label: 3, bag_size: 603
batch 319, loss: 0.3391, instance_loss: 0.3754, weighted_loss: 0.3500, label: 2, bag_size: 886
batch 339, loss: 0.7568, instance_loss: 0.4877, weighted_loss: 0.6761, label: 4, bag_size: 726
batch 359, loss: 0.3529, instance_loss: 0.7918, weighted_loss: 0.4846, label: 0, bag_size: 421
batch 379, loss: 3.1077, instance_loss: 0.5763, weighted_loss: 2.3483, label: 1, bag_size: 45
batch 399, loss: 0.8454, instance_loss: 0.4698, weighted_loss: 0.7327, label: 2, bag_size: 754
batch 419, loss: 2.5588, instance_loss: 0.5426, weighted_loss: 1.9540, label: 3, bag_size: 856
batch 439, loss: 0.2041, instance_loss: 0.4256, weighted_loss: 0.2706, label: 4, bag_size: 685
batch 459, loss: 0.0387, instance_loss: 0.3384, weighted_loss: 0.1286, label: 0, bag_size: 397
batch 479, loss: 0.9952, instance_loss: 0.5459, weighted_loss: 0.8604, label: 2, bag_size: 522
batch 499, loss: 1.3960, instance_loss: 0.4878, weighted_loss: 1.1236, label: 4, bag_size: 98
batch 519, loss: 0.6839, instance_loss: 0.4578, weighted_loss: 0.6160, label: 2, bag_size: 769
batch 539, loss: 1.8820, instance_loss: 0.6844, weighted_loss: 1.5227, label: 3, bag_size: 497
batch 559, loss: 2.0852, instance_loss: 0.6298, weighted_loss: 1.6486, label: 4, bag_size: 476
batch 579, loss: 0.4811, instance_loss: 0.3973, weighted_loss: 0.4560, label: 4, bag_size: 727


class 0 clustering acc 0.9964646464646465: correct 23676/23760
class 1 clustering acc 0.02861952861952862: correct 136/4752
Epoch: 50, train_loss: 1.0217, train_clustering_loss:  0.4869, train_error: 0.4158
class 0: acc 0.7857142857142857, correct 99/126
class 1: acc 0.4375, correct 49/112
class 2: acc 0.416, correct 52/125
class 3: acc 0.6517857142857143, correct 73/112
class 4: acc 0.6218487394957983, correct 74/119

Val Set, val_loss: 1.1446, val_error: 0.4324, auc: 0.8377
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.0651, instance_loss: 0.5848, weighted_loss: 1.6210, label: 0, bag_size: 376
batch 39, loss: 0.0109, instance_loss: 0.3278, weighted_loss: 0.1060, label: 0, bag_size: 88
batch 59, loss: 0.8815, instance_loss: 0.6251, weighted_loss: 0.8046, label: 0, bag_size: 600
batch 79, loss: 0.3872, instance_loss: 0.5198, weighted_loss: 0.4270, label: 3, bag_size: 398
batch 99, loss: 0.0155, instance_loss: 0.3363, weighted_loss: 0.1117, label: 0, bag_size: 80
batch 119, loss: 0.1215, instance_loss: 0.4966, weighted_loss: 0.2340, label: 3, bag_size: 476
batch 139, loss: 0.3362, instance_loss: 0.4753, weighted_loss: 0.3779, label: 3, bag_size: 398
batch 159, loss: 1.0964, instance_loss: 0.4328, weighted_loss: 0.8973, label: 4, bag_size: 409
batch 179, loss: 0.0053, instance_loss: 0.2909, weighted_loss: 0.0910, label: 0, bag_size: 399
batch 199, loss: 1.2849, instance_loss: 0.4722, weighted_loss: 1.0411, label: 3, bag_size: 641
batch 219, loss: 0.0009, instance_loss: 0.2715, weighted_loss: 0.0821, label: 0, bag_size: 340
batch 239, loss: 0.4203, instance_loss: 0.4124, weighted_loss: 0.4179, label: 4, bag_size: 46
batch 259, loss: 1.6994, instance_loss: 0.6848, weighted_loss: 1.3950, label: 4, bag_size: 250
batch 279, loss: 1.1401, instance_loss: 0.4418, weighted_loss: 0.9306, label: 3, bag_size: 102
batch 299, loss: 0.5844, instance_loss: 0.4393, weighted_loss: 0.5408, label: 4, bag_size: 875
batch 319, loss: 2.3868, instance_loss: 0.6186, weighted_loss: 1.8564, label: 4, bag_size: 310
batch 339, loss: 2.0254, instance_loss: 0.5446, weighted_loss: 1.5811, label: 3, bag_size: 166
batch 359, loss: 0.8186, instance_loss: 0.4536, weighted_loss: 0.7091, label: 2, bag_size: 769
batch 379, loss: 0.8847, instance_loss: 0.4382, weighted_loss: 0.7507, label: 2, bag_size: 369
batch 399, loss: 0.6825, instance_loss: 0.5023, weighted_loss: 0.6285, label: 1, bag_size: 460
batch 419, loss: 0.8581, instance_loss: 0.4326, weighted_loss: 0.7305, label: 0, bag_size: 141
batch 439, loss: 1.3467, instance_loss: 0.4009, weighted_loss: 1.0630, label: 1, bag_size: 593
batch 459, loss: 1.2742, instance_loss: 0.5416, weighted_loss: 1.0544, label: 2, bag_size: 651
batch 479, loss: 1.0144, instance_loss: 0.4360, weighted_loss: 0.8408, label: 4, bag_size: 482
batch 499, loss: 0.7382, instance_loss: 0.5606, weighted_loss: 0.6849, label: 4, bag_size: 960
batch 519, loss: 0.4554, instance_loss: 0.5212, weighted_loss: 0.4752, label: 4, bag_size: 1031
batch 539, loss: 0.8888, instance_loss: 0.5191, weighted_loss: 0.7779, label: 3, bag_size: 598
batch 559, loss: 0.1362, instance_loss: 0.2401, weighted_loss: 0.1674, label: 0, bag_size: 573
batch 579, loss: 0.1610, instance_loss: 0.3637, weighted_loss: 0.2218, label: 0, bag_size: 74


class 0 clustering acc 0.9970538720538721: correct 23690/23760
class 1 clustering acc 0.025252525252525252: correct 120/4752
Epoch: 51, train_loss: 0.9842, train_clustering_loss:  0.4860, train_error: 0.4108
class 0: acc 0.8173076923076923, correct 85/104
class 1: acc 0.543859649122807, correct 62/114
class 2: acc 0.39473684210526316, correct 45/114
class 3: acc 0.6390977443609023, correct 85/133
class 4: acc 0.5658914728682171, correct 73/129

Val Set, val_loss: 1.1563, val_error: 0.4865, auc: 0.8252
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.25, correct 3/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7058, instance_loss: 0.5654, weighted_loss: 0.6636, label: 2, bag_size: 708
batch 39, loss: 1.1485, instance_loss: 0.5067, weighted_loss: 0.9559, label: 3, bag_size: 453
batch 59, loss: 1.8432, instance_loss: 0.5573, weighted_loss: 1.4574, label: 3, bag_size: 166
batch 79, loss: 0.1005, instance_loss: 0.3257, weighted_loss: 0.1681, label: 4, bag_size: 627
batch 99, loss: 1.6481, instance_loss: 0.6493, weighted_loss: 1.3484, label: 1, bag_size: 874
batch 119, loss: 0.9173, instance_loss: 0.4845, weighted_loss: 0.7875, label: 1, bag_size: 1082
batch 139, loss: 1.4029, instance_loss: 0.5160, weighted_loss: 1.1368, label: 1, bag_size: 1104
batch 159, loss: 1.4053, instance_loss: 0.4180, weighted_loss: 1.1091, label: 2, bag_size: 861
batch 179, loss: 0.4708, instance_loss: 0.5339, weighted_loss: 0.4898, label: 3, bag_size: 1060
batch 199, loss: 1.2004, instance_loss: 0.4691, weighted_loss: 0.9810, label: 1, bag_size: 1043
batch 219, loss: 0.5886, instance_loss: 0.4186, weighted_loss: 0.5376, label: 2, bag_size: 614
batch 239, loss: 1.2400, instance_loss: 0.5041, weighted_loss: 1.0192, label: 1, bag_size: 389
batch 259, loss: 0.7550, instance_loss: 0.5258, weighted_loss: 0.6862, label: 1, bag_size: 534
batch 279, loss: 0.6624, instance_loss: 0.4748, weighted_loss: 0.6061, label: 2, bag_size: 779
batch 299, loss: 0.6926, instance_loss: 0.4620, weighted_loss: 0.6234, label: 3, bag_size: 453
batch 319, loss: 0.0506, instance_loss: 0.2996, weighted_loss: 0.1253, label: 0, bag_size: 399
batch 339, loss: 2.8205, instance_loss: 0.6882, weighted_loss: 2.1808, label: 2, bag_size: 754
batch 359, loss: 0.6310, instance_loss: 0.4739, weighted_loss: 0.5839, label: 3, bag_size: 476
batch 379, loss: 2.4697, instance_loss: 0.5984, weighted_loss: 1.9083, label: 1, bag_size: 397
batch 399, loss: 0.7244, instance_loss: 0.4332, weighted_loss: 0.6370, label: 3, bag_size: 566
batch 419, loss: 0.0360, instance_loss: 0.3407, weighted_loss: 0.1274, label: 0, bag_size: 103
batch 439, loss: 0.3418, instance_loss: 0.4696, weighted_loss: 0.3801, label: 4, bag_size: 948
batch 459, loss: 0.8472, instance_loss: 0.5772, weighted_loss: 0.7662, label: 1, bag_size: 851
batch 479, loss: 0.5371, instance_loss: 0.5225, weighted_loss: 0.5327, label: 2, bag_size: 286
batch 499, loss: 0.0593, instance_loss: 0.3373, weighted_loss: 0.1427, label: 0, bag_size: 355
batch 519, loss: 0.0766, instance_loss: 0.3683, weighted_loss: 0.1641, label: 0, bag_size: 98
batch 539, loss: 1.4398, instance_loss: 0.4588, weighted_loss: 1.1455, label: 3, bag_size: 230
batch 559, loss: 3.0375, instance_loss: 0.5635, weighted_loss: 2.2953, label: 4, bag_size: 563
batch 579, loss: 1.2566, instance_loss: 0.4997, weighted_loss: 1.0295, label: 3, bag_size: 192


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.020833333333333332: correct 99/4752
Epoch: 52, train_loss: 1.0186, train_clustering_loss:  0.4835, train_error: 0.4394
class 0: acc 0.8725490196078431, correct 89/102
class 1: acc 0.25961538461538464, correct 27/104
class 2: acc 0.5724137931034483, correct 83/145
class 3: acc 0.5163934426229508, correct 63/122
class 4: acc 0.5867768595041323, correct 71/121

Val Set, val_loss: 1.1213, val_error: 0.4595, auc: 0.8388
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.0271, instance_loss: 0.6801, weighted_loss: 1.6230, label: 0, bag_size: 367
batch 39, loss: 1.1944, instance_loss: 0.4851, weighted_loss: 0.9816, label: 3, bag_size: 499
batch 59, loss: 0.1089, instance_loss: 0.4044, weighted_loss: 0.1975, label: 0, bag_size: 573
batch 79, loss: 1.2547, instance_loss: 0.5678, weighted_loss: 1.0486, label: 1, bag_size: 153
batch 99, loss: 1.6617, instance_loss: 0.5779, weighted_loss: 1.3366, label: 2, bag_size: 288
batch 119, loss: 0.9444, instance_loss: 0.4673, weighted_loss: 0.8013, label: 3, bag_size: 1078
batch 139, loss: 2.1177, instance_loss: 0.6201, weighted_loss: 1.6684, label: 2, bag_size: 168
batch 159, loss: 0.7634, instance_loss: 0.4550, weighted_loss: 0.6709, label: 3, bag_size: 1147
batch 179, loss: 0.6222, instance_loss: 0.4211, weighted_loss: 0.5619, label: 4, bag_size: 712
batch 199, loss: 0.5725, instance_loss: 0.6270, weighted_loss: 0.5889, label: 2, bag_size: 883
batch 219, loss: 1.1777, instance_loss: 0.4651, weighted_loss: 0.9639, label: 1, bag_size: 1043
batch 239, loss: 1.6508, instance_loss: 0.5695, weighted_loss: 1.3264, label: 2, bag_size: 337
batch 259, loss: 1.1919, instance_loss: 0.4801, weighted_loss: 0.9783, label: 1, bag_size: 481
batch 279, loss: 0.8010, instance_loss: 0.4107, weighted_loss: 0.6839, label: 2, bag_size: 445
batch 299, loss: 2.1552, instance_loss: 0.4754, weighted_loss: 1.6513, label: 2, bag_size: 1060
batch 319, loss: 2.5502, instance_loss: 0.5245, weighted_loss: 1.9425, label: 2, bag_size: 684
batch 339, loss: 0.1056, instance_loss: 0.4583, weighted_loss: 0.2114, label: 1, bag_size: 522
batch 359, loss: 0.8572, instance_loss: 0.4839, weighted_loss: 0.7452, label: 3, bag_size: 1147
batch 379, loss: 0.8489, instance_loss: 0.4985, weighted_loss: 0.7438, label: 2, bag_size: 253
batch 399, loss: 0.0070, instance_loss: 0.2974, weighted_loss: 0.0941, label: 0, bag_size: 285
batch 419, loss: 1.1160, instance_loss: 0.5817, weighted_loss: 0.9557, label: 4, bag_size: 1113
batch 439, loss: 0.8893, instance_loss: 0.4203, weighted_loss: 0.7486, label: 1, bag_size: 381
batch 459, loss: 0.7818, instance_loss: 0.4700, weighted_loss: 0.6882, label: 1, bag_size: 389
batch 479, loss: 0.0455, instance_loss: 0.3739, weighted_loss: 0.1440, label: 0, bag_size: 49
batch 499, loss: 0.5045, instance_loss: 0.4359, weighted_loss: 0.4839, label: 3, bag_size: 476
batch 519, loss: 1.1539, instance_loss: 0.4413, weighted_loss: 0.9401, label: 1, bag_size: 526
batch 539, loss: 0.7919, instance_loss: 0.4271, weighted_loss: 0.6825, label: 3, bag_size: 245
batch 559, loss: 0.0413, instance_loss: 0.3385, weighted_loss: 0.1305, label: 0, bag_size: 70
batch 579, loss: 2.4354, instance_loss: 0.5827, weighted_loss: 1.8796, label: 2, bag_size: 185


class 0 clustering acc 0.9971380471380471: correct 23692/23760
class 1 clustering acc 0.03998316498316498: correct 190/4752
Epoch: 53, train_loss: 0.9889, train_clustering_loss:  0.4770, train_error: 0.4327
class 0: acc 0.7967479674796748, correct 98/123
class 1: acc 0.49586776859504134, correct 60/121
class 2: acc 0.39473684210526316, correct 45/114
class 3: acc 0.6071428571428571, correct 68/112
class 4: acc 0.532258064516129, correct 66/124

Val Set, val_loss: 1.1906, val_error: 0.5135, auc: 0.8338
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.030405405405405407: correct 18/592
class 0: acc 0.5, correct 8/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.2857142857142857, correct 4/14
class 4: acc 0.8571428571428571, correct 12/14
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3177, instance_loss: 0.3152, weighted_loss: 0.3169, label: 0, bag_size: 49
batch 39, loss: 2.7452, instance_loss: 0.6392, weighted_loss: 2.1134, label: 3, bag_size: 154
batch 59, loss: 0.0529, instance_loss: 0.2918, weighted_loss: 0.1246, label: 0, bag_size: 397
batch 79, loss: 0.3669, instance_loss: 0.4242, weighted_loss: 0.3841, label: 4, bag_size: 418
batch 99, loss: 1.4746, instance_loss: 0.4769, weighted_loss: 1.1753, label: 1, bag_size: 233
batch 119, loss: 0.4935, instance_loss: 0.4909, weighted_loss: 0.4927, label: 4, bag_size: 1018
batch 139, loss: 1.5878, instance_loss: 0.4728, weighted_loss: 1.2533, label: 3, bag_size: 608
batch 159, loss: 0.7797, instance_loss: 0.3833, weighted_loss: 0.6608, label: 4, bag_size: 293
batch 179, loss: 0.0072, instance_loss: 0.2573, weighted_loss: 0.0822, label: 0, bag_size: 285
batch 199, loss: 2.0472, instance_loss: 0.6419, weighted_loss: 1.6256, label: 0, bag_size: 964
batch 219, loss: 0.9411, instance_loss: 0.5563, weighted_loss: 0.8256, label: 2, bag_size: 135
batch 239, loss: 1.1582, instance_loss: 0.5504, weighted_loss: 0.9758, label: 4, bag_size: 432
batch 259, loss: 0.5679, instance_loss: 0.4428, weighted_loss: 0.5304, label: 2, bag_size: 702
batch 279, loss: 2.8177, instance_loss: 0.5775, weighted_loss: 2.1456, label: 2, bag_size: 1122
batch 299, loss: 0.7139, instance_loss: 0.4792, weighted_loss: 0.6435, label: 3, bag_size: 476
batch 319, loss: 0.0087, instance_loss: 0.2053, weighted_loss: 0.0677, label: 0, bag_size: 88
batch 339, loss: 0.7845, instance_loss: 0.4699, weighted_loss: 0.6901, label: 1, bag_size: 925
batch 359, loss: 0.5789, instance_loss: 0.4217, weighted_loss: 0.5318, label: 1, bag_size: 328
batch 379, loss: 1.0644, instance_loss: 0.4694, weighted_loss: 0.8859, label: 3, bag_size: 97
batch 399, loss: 0.5687, instance_loss: 0.4557, weighted_loss: 0.5348, label: 4, bag_size: 780
batch 419, loss: 1.1925, instance_loss: 0.5917, weighted_loss: 1.0123, label: 4, bag_size: 757
batch 439, loss: 0.9678, instance_loss: 0.5023, weighted_loss: 0.8282, label: 1, bag_size: 855
batch 459, loss: 0.6403, instance_loss: 0.4666, weighted_loss: 0.5882, label: 2, bag_size: 567
batch 479, loss: 0.0205, instance_loss: 0.2862, weighted_loss: 0.1003, label: 0, bag_size: 103
batch 499, loss: 0.6672, instance_loss: 0.3894, weighted_loss: 0.5839, label: 2, bag_size: 853
batch 519, loss: 0.4688, instance_loss: 0.4940, weighted_loss: 0.4763, label: 4, bag_size: 742
batch 539, loss: 0.7200, instance_loss: 0.4602, weighted_loss: 0.6421, label: 4, bag_size: 730
batch 559, loss: 0.6843, instance_loss: 0.5201, weighted_loss: 0.6350, label: 0, bag_size: 143
batch 579, loss: 0.6401, instance_loss: 0.5548, weighted_loss: 0.6145, label: 2, bag_size: 607


class 0 clustering acc 0.9973063973063973: correct 23696/23760
class 1 clustering acc 0.03808922558922559: correct 181/4752
Epoch: 54, train_loss: 1.0273, train_clustering_loss:  0.4865, train_error: 0.4444
class 0: acc 0.7419354838709677, correct 92/124
class 1: acc 0.40350877192982454, correct 46/114
class 2: acc 0.496551724137931, correct 72/145
class 3: acc 0.5319148936170213, correct 50/94
class 4: acc 0.5982905982905983, correct 70/117

Val Set, val_loss: 1.4572, val_error: 0.4324, auc: 0.8012
class 0 clustering acc 0.9969594594594594: correct 2951/2960
class 1 clustering acc 0.02195945945945946: correct 13/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.9798, instance_loss: 0.5109, weighted_loss: 0.8391, label: 0, bag_size: 81
batch 39, loss: 1.5986, instance_loss: 0.5906, weighted_loss: 1.2962, label: 3, bag_size: 282
batch 59, loss: 1.3015, instance_loss: 0.5602, weighted_loss: 1.0791, label: 2, bag_size: 315
batch 79, loss: 0.9106, instance_loss: 0.4955, weighted_loss: 0.7861, label: 3, bag_size: 312
batch 99, loss: 0.3240, instance_loss: 0.6938, weighted_loss: 0.4350, label: 4, bag_size: 293
batch 119, loss: 0.1539, instance_loss: 0.3332, weighted_loss: 0.2077, label: 4, bag_size: 266
batch 139, loss: 0.0615, instance_loss: 0.3474, weighted_loss: 0.1473, label: 4, bag_size: 267
batch 159, loss: 1.4888, instance_loss: 0.5597, weighted_loss: 1.2101, label: 2, bag_size: 380
batch 179, loss: 1.9851, instance_loss: 0.5545, weighted_loss: 1.5559, label: 3, bag_size: 230
batch 199, loss: 0.8409, instance_loss: 0.4964, weighted_loss: 0.7376, label: 1, bag_size: 766
batch 219, loss: 0.8655, instance_loss: 0.4983, weighted_loss: 0.7553, label: 1, bag_size: 398
batch 239, loss: 0.2750, instance_loss: 0.5606, weighted_loss: 0.3607, label: 1, bag_size: 44
batch 259, loss: 4.0245, instance_loss: 0.6879, weighted_loss: 3.0235, label: 0, bag_size: 608
batch 279, loss: 0.7370, instance_loss: 0.5072, weighted_loss: 0.6681, label: 2, bag_size: 1079
batch 299, loss: 0.0009, instance_loss: 0.3157, weighted_loss: 0.0953, label: 0, bag_size: 236
batch 319, loss: 0.1862, instance_loss: 0.5797, weighted_loss: 0.3042, label: 3, bag_size: 674
batch 339, loss: 0.2516, instance_loss: 0.4067, weighted_loss: 0.2981, label: 0, bag_size: 399
batch 359, loss: 1.8745, instance_loss: 0.5699, weighted_loss: 1.4832, label: 4, bag_size: 744
batch 379, loss: 2.3278, instance_loss: 0.5684, weighted_loss: 1.8000, label: 2, bag_size: 411
batch 399, loss: 0.9567, instance_loss: 0.5413, weighted_loss: 0.8321, label: 3, bag_size: 97
batch 419, loss: 1.2696, instance_loss: 0.5689, weighted_loss: 1.0594, label: 2, bag_size: 582
batch 439, loss: 1.6063, instance_loss: 0.5380, weighted_loss: 1.2858, label: 1, bag_size: 221
batch 459, loss: 1.9141, instance_loss: 0.6066, weighted_loss: 1.5219, label: 3, bag_size: 282
batch 479, loss: 1.3891, instance_loss: 0.4851, weighted_loss: 1.1179, label: 1, bag_size: 525
batch 499, loss: 0.4866, instance_loss: 0.4544, weighted_loss: 0.4769, label: 1, bag_size: 1104
batch 519, loss: 3.0124, instance_loss: 0.6616, weighted_loss: 2.3072, label: 1, bag_size: 44
batch 539, loss: 0.2050, instance_loss: 0.3468, weighted_loss: 0.2475, label: 0, bag_size: 453
batch 559, loss: 1.5428, instance_loss: 0.4577, weighted_loss: 1.2173, label: 1, bag_size: 233
batch 579, loss: 0.0201, instance_loss: 0.4105, weighted_loss: 0.1373, label: 4, bag_size: 503


class 0 clustering acc 0.9975589225589225: correct 23702/23760
class 1 clustering acc 0.027146464646464648: correct 129/4752
Epoch: 55, train_loss: 1.0283, train_clustering_loss:  0.4901, train_error: 0.4411
class 0: acc 0.7886178861788617, correct 97/123
class 1: acc 0.5116279069767442, correct 66/129
class 2: acc 0.42857142857142855, correct 54/126
class 3: acc 0.42718446601941745, correct 44/103
class 4: acc 0.6283185840707964, correct 71/113

Val Set, val_loss: 1.0751, val_error: 0.4189, auc: 0.8369
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.9285714285714286, correct 13/14
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.4054, instance_loss: 0.3784, weighted_loss: 0.3973, label: 2, bag_size: 821
batch 39, loss: 0.8616, instance_loss: 0.4705, weighted_loss: 0.7443, label: 3, bag_size: 476
batch 59, loss: 2.3840, instance_loss: 0.6776, weighted_loss: 1.8721, label: 3, bag_size: 897
batch 79, loss: 0.7394, instance_loss: 0.4130, weighted_loss: 0.6415, label: 1, bag_size: 1104
batch 99, loss: 0.6276, instance_loss: 0.4371, weighted_loss: 0.5704, label: 2, bag_size: 567
batch 119, loss: 0.0000, instance_loss: 0.3751, weighted_loss: 0.1125, label: 2, bag_size: 953
batch 139, loss: 0.4107, instance_loss: 0.3932, weighted_loss: 0.4054, label: 2, bag_size: 614
batch 159, loss: 1.1665, instance_loss: 0.4591, weighted_loss: 0.9543, label: 1, bag_size: 1091
batch 179, loss: 5.7241, instance_loss: 0.5325, weighted_loss: 4.1666, label: 2, bag_size: 563
batch 199, loss: 3.2142, instance_loss: 0.6182, weighted_loss: 2.4354, label: 3, bag_size: 856
batch 219, loss: 0.5127, instance_loss: 0.4547, weighted_loss: 0.4953, label: 4, bag_size: 46
batch 239, loss: 0.0659, instance_loss: 0.4137, weighted_loss: 0.1703, label: 0, bag_size: 122
batch 259, loss: 0.0297, instance_loss: 0.3562, weighted_loss: 0.1276, label: 0, bag_size: 98
batch 279, loss: 1.2672, instance_loss: 0.4937, weighted_loss: 1.0351, label: 0, bag_size: 367
batch 299, loss: 1.5351, instance_loss: 0.4604, weighted_loss: 1.2127, label: 1, bag_size: 593
batch 319, loss: 1.5850, instance_loss: 0.5894, weighted_loss: 1.2863, label: 3, bag_size: 779
batch 339, loss: 0.0018, instance_loss: 0.4731, weighted_loss: 0.1432, label: 4, bag_size: 530
batch 359, loss: 0.0794, instance_loss: 0.4979, weighted_loss: 0.2049, label: 4, bag_size: 1351
batch 379, loss: 1.7251, instance_loss: 0.6115, weighted_loss: 1.3910, label: 4, bag_size: 333
batch 399, loss: 0.3557, instance_loss: 0.4472, weighted_loss: 0.3831, label: 4, bag_size: 574
batch 419, loss: 1.3026, instance_loss: 0.4584, weighted_loss: 1.0494, label: 2, bag_size: 941
batch 439, loss: 1.7431, instance_loss: 0.5631, weighted_loss: 1.3891, label: 2, bag_size: 1013
batch 459, loss: 0.0484, instance_loss: 0.3273, weighted_loss: 0.1320, label: 1, bag_size: 886
batch 479, loss: 0.3670, instance_loss: 0.4249, weighted_loss: 0.3844, label: 4, bag_size: 695
batch 499, loss: 0.0601, instance_loss: 0.3659, weighted_loss: 0.1518, label: 4, bag_size: 948
batch 519, loss: 0.6778, instance_loss: 0.5782, weighted_loss: 0.6480, label: 3, bag_size: 982
batch 539, loss: 0.0661, instance_loss: 0.2608, weighted_loss: 0.1245, label: 0, bag_size: 97
batch 559, loss: 0.8618, instance_loss: 0.5805, weighted_loss: 0.7774, label: 3, bag_size: 737
batch 579, loss: 0.8329, instance_loss: 0.4437, weighted_loss: 0.7161, label: 2, bag_size: 258


class 0 clustering acc 0.9972643097643098: correct 23695/23760
class 1 clustering acc 0.027146464646464648: correct 129/4752
Epoch: 56, train_loss: 0.9658, train_clustering_loss:  0.4854, train_error: 0.4310
class 0: acc 0.8508771929824561, correct 97/114
class 1: acc 0.4369747899159664, correct 52/119
class 2: acc 0.4426229508196721, correct 54/122
class 3: acc 0.5206611570247934, correct 63/121
class 4: acc 0.6101694915254238, correct 72/118

Val Set, val_loss: 1.1449, val_error: 0.5135, auc: 0.8322
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.5625, correct 9/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1280, instance_loss: 0.5484, weighted_loss: 0.2541, label: 0, bag_size: 702
batch 39, loss: 0.9283, instance_loss: 0.4925, weighted_loss: 0.7976, label: 1, bag_size: 1104
batch 59, loss: 1.9457, instance_loss: 0.5059, weighted_loss: 1.5138, label: 0, bag_size: 273
batch 79, loss: 1.5266, instance_loss: 0.6823, weighted_loss: 1.2733, label: 0, bag_size: 247
batch 99, loss: 0.0149, instance_loss: 0.3073, weighted_loss: 0.1026, label: 0, bag_size: 188
batch 119, loss: 0.5321, instance_loss: 0.4609, weighted_loss: 0.5108, label: 1, bag_size: 534
batch 139, loss: 0.8734, instance_loss: 0.4763, weighted_loss: 0.7543, label: 3, bag_size: 245
batch 159, loss: 0.3730, instance_loss: 0.4515, weighted_loss: 0.3965, label: 0, bag_size: 231
batch 179, loss: 1.1379, instance_loss: 0.4877, weighted_loss: 0.9429, label: 4, bag_size: 329
batch 199, loss: 1.8075, instance_loss: 0.5988, weighted_loss: 1.4449, label: 3, bag_size: 497
batch 219, loss: 0.7741, instance_loss: 0.4476, weighted_loss: 0.6761, label: 2, bag_size: 244
batch 239, loss: 0.4461, instance_loss: 0.4448, weighted_loss: 0.4457, label: 4, bag_size: 574
batch 259, loss: 0.4546, instance_loss: 0.3932, weighted_loss: 0.4362, label: 2, bag_size: 317
batch 279, loss: 0.0385, instance_loss: 0.3244, weighted_loss: 0.1242, label: 0, bag_size: 573
batch 299, loss: 0.0133, instance_loss: 0.3429, weighted_loss: 0.1122, label: 0, bag_size: 70
batch 319, loss: 0.8938, instance_loss: 0.4838, weighted_loss: 0.7708, label: 1, bag_size: 1091
batch 339, loss: 2.4600, instance_loss: 0.5782, weighted_loss: 1.8955, label: 2, bag_size: 629
batch 359, loss: 1.4566, instance_loss: 0.5700, weighted_loss: 1.1906, label: 3, bag_size: 961
batch 379, loss: 2.8137, instance_loss: 0.5814, weighted_loss: 2.1440, label: 2, bag_size: 351
batch 399, loss: 2.2297, instance_loss: 0.6589, weighted_loss: 1.7584, label: 1, bag_size: 481
batch 419, loss: 0.1162, instance_loss: 0.4478, weighted_loss: 0.2156, label: 4, bag_size: 948
batch 439, loss: 0.7515, instance_loss: 0.4497, weighted_loss: 0.6610, label: 3, bag_size: 982
batch 459, loss: 1.5149, instance_loss: 0.6521, weighted_loss: 1.2561, label: 2, bag_size: 407
batch 479, loss: 3.1013, instance_loss: 0.5504, weighted_loss: 2.3360, label: 4, bag_size: 970
batch 499, loss: 0.2150, instance_loss: 0.3484, weighted_loss: 0.2550, label: 0, bag_size: 282
batch 519, loss: 0.0428, instance_loss: 0.2824, weighted_loss: 0.1147, label: 0, bag_size: 366
batch 539, loss: 0.0721, instance_loss: 0.3074, weighted_loss: 0.1427, label: 0, bag_size: 201
batch 559, loss: 0.9090, instance_loss: 0.3675, weighted_loss: 0.7466, label: 4, bag_size: 1077
batch 579, loss: 0.9341, instance_loss: 0.4875, weighted_loss: 0.8002, label: 3, bag_size: 1131


class 0 clustering acc 0.99743265993266: correct 23699/23760
class 1 clustering acc 0.026515151515151516: correct 126/4752
Epoch: 57, train_loss: 0.9816, train_clustering_loss:  0.4876, train_error: 0.4276
class 0: acc 0.8362068965517241, correct 97/116
class 1: acc 0.4260869565217391, correct 49/115
class 2: acc 0.3949579831932773, correct 47/119
class 3: acc 0.5, correct 57/114
class 4: acc 0.6923076923076923, correct 90/130

Val Set, val_loss: 1.1959, val_error: 0.4595, auc: 0.8264
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.0: correct 0/592
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.7010, instance_loss: 0.4757, weighted_loss: 1.3334, label: 2, bag_size: 244
batch 39, loss: 1.1869, instance_loss: 0.4700, weighted_loss: 0.9719, label: 4, bag_size: 318
batch 59, loss: 1.6321, instance_loss: 0.4536, weighted_loss: 1.2786, label: 2, bag_size: 844
batch 79, loss: 1.3926, instance_loss: 0.5922, weighted_loss: 1.1525, label: 0, bag_size: 243
batch 99, loss: 0.0302, instance_loss: 0.3509, weighted_loss: 0.1264, label: 0, bag_size: 168
batch 119, loss: 0.1610, instance_loss: 0.3313, weighted_loss: 0.2121, label: 4, bag_size: 742
batch 139, loss: 0.1034, instance_loss: 0.3932, weighted_loss: 0.1903, label: 4, bag_size: 377
batch 159, loss: 0.9595, instance_loss: 0.5241, weighted_loss: 0.8289, label: 2, bag_size: 613
batch 179, loss: 0.1598, instance_loss: 0.3498, weighted_loss: 0.2168, label: 0, bag_size: 453
batch 199, loss: 0.8611, instance_loss: 0.5452, weighted_loss: 0.7663, label: 2, bag_size: 380
batch 219, loss: 1.1795, instance_loss: 0.4955, weighted_loss: 0.9743, label: 1, bag_size: 311
batch 239, loss: 1.6244, instance_loss: 0.5196, weighted_loss: 1.2930, label: 2, bag_size: 488
batch 259, loss: 0.1510, instance_loss: 0.4839, weighted_loss: 0.2509, label: 0, bag_size: 183
batch 279, loss: 3.2129, instance_loss: 0.5944, weighted_loss: 2.4274, label: 3, bag_size: 961
batch 299, loss: 0.6364, instance_loss: 0.4385, weighted_loss: 0.5770, label: 4, bag_size: 520
batch 319, loss: 0.1446, instance_loss: 0.3995, weighted_loss: 0.2211, label: 0, bag_size: 62
batch 339, loss: 1.9984, instance_loss: 0.6688, weighted_loss: 1.5995, label: 3, bag_size: 856
batch 359, loss: 0.0807, instance_loss: 0.4449, weighted_loss: 0.1900, label: 0, bag_size: 383
batch 379, loss: 0.1035, instance_loss: 0.6827, weighted_loss: 0.2773, label: 4, bag_size: 769
batch 399, loss: 1.3460, instance_loss: 0.4877, weighted_loss: 1.0885, label: 2, bag_size: 746
batch 419, loss: 2.0842, instance_loss: 0.5834, weighted_loss: 1.6340, label: 3, bag_size: 663
batch 439, loss: 0.0601, instance_loss: 0.4576, weighted_loss: 0.1794, label: 4, bag_size: 231
batch 459, loss: 1.1606, instance_loss: 0.5024, weighted_loss: 0.9632, label: 3, bag_size: 453
batch 479, loss: 1.2778, instance_loss: 0.5670, weighted_loss: 1.0646, label: 2, bag_size: 613
batch 499, loss: 1.4019, instance_loss: 0.5604, weighted_loss: 1.1494, label: 4, bag_size: 438
batch 519, loss: 0.9334, instance_loss: 0.5145, weighted_loss: 0.8077, label: 3, bag_size: 312
batch 539, loss: 0.9475, instance_loss: 0.4775, weighted_loss: 0.8065, label: 3, bag_size: 364
batch 559, loss: 0.5460, instance_loss: 0.4787, weighted_loss: 0.5258, label: 2, bag_size: 119
batch 579, loss: 1.8749, instance_loss: 0.5726, weighted_loss: 1.4842, label: 3, bag_size: 192


class 0 clustering acc 0.9970959595959596: correct 23691/23760
class 1 clustering acc 0.027777777777777776: correct 132/4752
Epoch: 58, train_loss: 0.9932, train_clustering_loss:  0.4859, train_error: 0.4226
class 0: acc 0.811965811965812, correct 95/117
class 1: acc 0.5481481481481482, correct 74/135
class 2: acc 0.3821138211382114, correct 47/123
class 3: acc 0.5454545454545454, correct 60/110
class 4: acc 0.6146788990825688, correct 67/109

Val Set, val_loss: 1.2454, val_error: 0.5541, auc: 0.8237
class 0 clustering acc 0.9996621621621622: correct 2959/2960
class 1 clustering acc 0.010135135135135136: correct 6/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 8/14
class 4: acc 0.35714285714285715, correct 5/14
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.3678, instance_loss: 0.5206, weighted_loss: 1.1136, label: 4, bag_size: 868
batch 39, loss: 0.9692, instance_loss: 0.5787, weighted_loss: 0.8520, label: 4, bag_size: 731
batch 59, loss: 2.3180, instance_loss: 0.6140, weighted_loss: 1.8068, label: 0, bag_size: 243
batch 79, loss: 1.0626, instance_loss: 0.4988, weighted_loss: 0.8934, label: 3, bag_size: 300
batch 99, loss: 1.2262, instance_loss: 0.5297, weighted_loss: 1.0173, label: 4, bag_size: 1077
batch 119, loss: 0.7048, instance_loss: 0.5166, weighted_loss: 0.6483, label: 2, bag_size: 240
batch 139, loss: 1.4934, instance_loss: 0.4297, weighted_loss: 1.1743, label: 1, bag_size: 525
batch 159, loss: 0.6602, instance_loss: 0.5098, weighted_loss: 0.6151, label: 2, bag_size: 731
batch 179, loss: 0.3586, instance_loss: 0.5209, weighted_loss: 0.4073, label: 1, bag_size: 1103
batch 199, loss: 0.5694, instance_loss: 0.4505, weighted_loss: 0.5337, label: 4, bag_size: 685
batch 219, loss: 2.0534, instance_loss: 0.4573, weighted_loss: 1.5746, label: 2, bag_size: 258
batch 239, loss: 0.7429, instance_loss: 0.4954, weighted_loss: 0.6686, label: 1, bag_size: 490
batch 259, loss: 0.9496, instance_loss: 0.4611, weighted_loss: 0.8031, label: 2, bag_size: 369
batch 279, loss: 1.6698, instance_loss: 0.5495, weighted_loss: 1.3337, label: 2, bag_size: 258
batch 299, loss: 0.0138, instance_loss: 0.2523, weighted_loss: 0.0853, label: 0, bag_size: 354
batch 319, loss: 1.6293, instance_loss: 0.4646, weighted_loss: 1.2799, label: 1, bag_size: 339
batch 339, loss: 0.4245, instance_loss: 0.4247, weighted_loss: 0.4246, label: 0, bag_size: 231
batch 359, loss: 1.2166, instance_loss: 0.5234, weighted_loss: 1.0086, label: 4, bag_size: 729
batch 379, loss: 0.7908, instance_loss: 0.5213, weighted_loss: 0.7100, label: 3, bag_size: 312
batch 399, loss: 0.1587, instance_loss: 0.4385, weighted_loss: 0.2426, label: 0, bag_size: 122
batch 419, loss: 1.7431, instance_loss: 0.6768, weighted_loss: 1.4232, label: 0, bag_size: 710
batch 439, loss: 0.0890, instance_loss: 0.4632, weighted_loss: 0.2013, label: 0, bag_size: 201
batch 459, loss: 0.6761, instance_loss: 0.4470, weighted_loss: 0.6074, label: 2, bag_size: 779
batch 479, loss: 0.7737, instance_loss: 0.5110, weighted_loss: 0.6949, label: 4, bag_size: 238
batch 499, loss: 1.1110, instance_loss: 0.4713, weighted_loss: 0.9191, label: 1, bag_size: 697
batch 519, loss: 2.2844, instance_loss: 0.6127, weighted_loss: 1.7829, label: 4, bag_size: 333
batch 539, loss: 3.4905, instance_loss: 0.7238, weighted_loss: 2.6605, label: 2, bag_size: 519
batch 559, loss: 2.5254, instance_loss: 0.5701, weighted_loss: 1.9388, label: 4, bag_size: 395
batch 579, loss: 0.6127, instance_loss: 0.4966, weighted_loss: 0.5779, label: 2, bag_size: 582


class 0 clustering acc 0.9978114478114478: correct 23708/23760
class 1 clustering acc 0.03198653198653199: correct 152/4752
Epoch: 59, train_loss: 0.9816, train_clustering_loss:  0.4809, train_error: 0.4024
class 0: acc 0.8503937007874016, correct 108/127
class 1: acc 0.5294117647058824, correct 72/136
class 2: acc 0.41739130434782606, correct 48/115
class 3: acc 0.5462962962962963, correct 59/108
class 4: acc 0.6296296296296297, correct 68/108

Val Set, val_loss: 1.2061, val_error: 0.4865, auc: 0.8223
class 0 clustering acc 0.9989864864864865: correct 2957/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6428571428571429, correct 9/14
class 4: acc 0.5, correct 7/14
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.2188, instance_loss: 0.4927, weighted_loss: 1.0010, label: 1, bag_size: 851
batch 39, loss: 1.7716, instance_loss: 0.4619, weighted_loss: 1.3787, label: 1, bag_size: 906
batch 59, loss: 0.0059, instance_loss: 0.3396, weighted_loss: 0.1060, label: 0, bag_size: 80
batch 79, loss: 1.2060, instance_loss: 0.5162, weighted_loss: 0.9991, label: 4, bag_size: 1077
batch 99, loss: 0.6617, instance_loss: 0.4126, weighted_loss: 0.5869, label: 2, bag_size: 708
batch 119, loss: 1.1186, instance_loss: 0.6210, weighted_loss: 0.9693, label: 1, bag_size: 840
batch 139, loss: 0.0216, instance_loss: 0.3080, weighted_loss: 0.1075, label: 0, bag_size: 188
batch 159, loss: 0.0370, instance_loss: 0.2864, weighted_loss: 0.1118, label: 0, bag_size: 98
batch 179, loss: 0.6328, instance_loss: 0.4686, weighted_loss: 0.5835, label: 3, bag_size: 996
batch 199, loss: 1.1385, instance_loss: 0.4820, weighted_loss: 0.9416, label: 1, bag_size: 616
batch 219, loss: 1.3977, instance_loss: 0.6327, weighted_loss: 1.1682, label: 2, bag_size: 380
batch 239, loss: 0.3988, instance_loss: 0.5038, weighted_loss: 0.4303, label: 3, bag_size: 194
batch 259, loss: 1.1690, instance_loss: 0.4863, weighted_loss: 0.9642, label: 3, bag_size: 663
batch 279, loss: 1.9243, instance_loss: 0.5838, weighted_loss: 1.5221, label: 0, bag_size: 642
batch 299, loss: 0.0001, instance_loss: 0.2146, weighted_loss: 0.0644, label: 0, bag_size: 706
batch 319, loss: 0.7367, instance_loss: 0.4224, weighted_loss: 0.6424, label: 2, bag_size: 369
batch 339, loss: 0.8542, instance_loss: 0.4502, weighted_loss: 0.7330, label: 3, bag_size: 830
batch 359, loss: 0.4689, instance_loss: 0.4341, weighted_loss: 0.4585, label: 4, bag_size: 895
batch 379, loss: 1.1288, instance_loss: 0.5099, weighted_loss: 0.9431, label: 3, bag_size: 301
batch 399, loss: 1.1259, instance_loss: 0.4789, weighted_loss: 0.9318, label: 2, bag_size: 1077
batch 419, loss: 0.4272, instance_loss: 0.3708, weighted_loss: 0.4103, label: 4, bag_size: 776
batch 439, loss: 1.1148, instance_loss: 0.4850, weighted_loss: 0.9259, label: 3, bag_size: 282
batch 459, loss: 0.7262, instance_loss: 0.4804, weighted_loss: 0.6524, label: 1, bag_size: 1082
batch 479, loss: 0.3469, instance_loss: 0.5026, weighted_loss: 0.3936, label: 3, bag_size: 684
batch 499, loss: 0.0041, instance_loss: 0.3317, weighted_loss: 0.1024, label: 0, bag_size: 58
batch 519, loss: 0.0462, instance_loss: 0.2943, weighted_loss: 0.1207, label: 4, bag_size: 260
batch 539, loss: 1.4789, instance_loss: 0.5447, weighted_loss: 1.1986, label: 0, bag_size: 178
batch 559, loss: 0.5807, instance_loss: 0.3912, weighted_loss: 0.5239, label: 4, bag_size: 563
batch 579, loss: 0.6443, instance_loss: 0.4946, weighted_loss: 0.5994, label: 4, bag_size: 618


class 0 clustering acc 0.9982744107744108: correct 23719/23760
class 1 clustering acc 0.0242003367003367: correct 115/4752
Epoch: 60, train_loss: 0.9649, train_clustering_loss:  0.4831, train_error: 0.4242
class 0: acc 0.8333333333333334, correct 95/114
class 1: acc 0.4915254237288136, correct 58/118
class 2: acc 0.4482758620689655, correct 52/116
class 3: acc 0.6031746031746031, correct 76/126
class 4: acc 0.5083333333333333, correct 61/120

Val Set, val_loss: 1.1198, val_error: 0.4189, auc: 0.8482
class 0 clustering acc 0.9993243243243243: correct 2958/2960
class 1 clustering acc 0.033783783783783786: correct 20/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 15 out of 20


batch 19, loss: 3.0975, instance_loss: 0.6355, weighted_loss: 2.3589, label: 0, bag_size: 1073
batch 39, loss: 0.0682, instance_loss: 0.3896, weighted_loss: 0.1646, label: 0, bag_size: 366
batch 59, loss: 0.5126, instance_loss: 0.4446, weighted_loss: 0.4922, label: 4, bag_size: 780
batch 79, loss: 1.2700, instance_loss: 0.6168, weighted_loss: 1.0741, label: 4, bag_size: 160
batch 99, loss: 0.9853, instance_loss: 0.4885, weighted_loss: 0.8362, label: 3, bag_size: 520
batch 119, loss: 1.1813, instance_loss: 0.4598, weighted_loss: 0.9648, label: 2, bag_size: 421
batch 139, loss: 0.7148, instance_loss: 0.4963, weighted_loss: 0.6492, label: 2, bag_size: 133
batch 159, loss: 0.7758, instance_loss: 0.4436, weighted_loss: 0.6761, label: 2, bag_size: 337
batch 179, loss: 0.4809, instance_loss: 0.4494, weighted_loss: 0.4714, label: 1, bag_size: 672
batch 199, loss: 2.1327, instance_loss: 0.5269, weighted_loss: 1.6509, label: 1, bag_size: 908
batch 219, loss: 1.3077, instance_loss: 0.6119, weighted_loss: 1.0989, label: 2, bag_size: 799
batch 239, loss: 1.1389, instance_loss: 0.4538, weighted_loss: 0.9334, label: 2, bag_size: 375
batch 259, loss: 2.2132, instance_loss: 0.6488, weighted_loss: 1.7439, label: 2, bag_size: 258
batch 279, loss: 0.4668, instance_loss: 0.4677, weighted_loss: 0.4671, label: 1, bag_size: 544
batch 299, loss: 0.3404, instance_loss: 0.3398, weighted_loss: 0.3402, label: 4, bag_size: 238
batch 319, loss: 1.1892, instance_loss: 0.5618, weighted_loss: 1.0010, label: 2, bag_size: 376
batch 339, loss: 0.4301, instance_loss: 0.4161, weighted_loss: 0.4259, label: 3, bag_size: 982
batch 359, loss: 2.4806, instance_loss: 0.6290, weighted_loss: 1.9252, label: 2, bag_size: 498
batch 379, loss: 1.8996, instance_loss: 0.5311, weighted_loss: 1.4891, label: 1, bag_size: 695
batch 399, loss: 0.1696, instance_loss: 0.4536, weighted_loss: 0.2548, label: 4, bag_size: 160
batch 419, loss: 2.5162, instance_loss: 0.6344, weighted_loss: 1.9517, label: 2, bag_size: 297
batch 439, loss: 0.0819, instance_loss: 0.2972, weighted_loss: 0.1465, label: 0, bag_size: 357
batch 459, loss: 0.9569, instance_loss: 0.4675, weighted_loss: 0.8101, label: 3, bag_size: 230
batch 479, loss: 0.3332, instance_loss: 0.4612, weighted_loss: 0.3716, label: 3, bag_size: 194
batch 499, loss: 1.0237, instance_loss: 0.4794, weighted_loss: 0.8604, label: 3, bag_size: 1076
batch 519, loss: 1.4761, instance_loss: 0.6027, weighted_loss: 1.2141, label: 2, bag_size: 909
batch 539, loss: 2.0978, instance_loss: 0.5557, weighted_loss: 1.6351, label: 3, bag_size: 899
batch 559, loss: 2.4903, instance_loss: 0.6909, weighted_loss: 1.9505, label: 2, bag_size: 337
batch 579, loss: 2.6794, instance_loss: 0.6760, weighted_loss: 2.0783, label: 3, bag_size: 856


class 0 clustering acc 0.99743265993266: correct 23699/23760
class 1 clustering acc 0.03177609427609428: correct 151/4752
Epoch: 61, train_loss: 1.0033, train_clustering_loss:  0.4802, train_error: 0.4478
class 0: acc 0.7948717948717948, correct 93/117
class 1: acc 0.4666666666666667, correct 49/105
class 2: acc 0.423728813559322, correct 50/118
class 3: acc 0.525, correct 63/120
class 4: acc 0.5447761194029851, correct 73/134

Val Set, val_loss: 1.3101, val_error: 0.5135, auc: 0.8123
class 0 clustering acc 0.9986486486486487: correct 2956/2960
class 1 clustering acc 0.02027027027027027: correct 12/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.5622, instance_loss: 0.5592, weighted_loss: 1.2613, label: 2, bag_size: 168
batch 39, loss: 2.4578, instance_loss: 0.4784, weighted_loss: 1.8640, label: 3, bag_size: 492
batch 59, loss: 0.7988, instance_loss: 0.4464, weighted_loss: 0.6931, label: 4, bag_size: 277
batch 79, loss: 1.1537, instance_loss: 0.5050, weighted_loss: 0.9591, label: 1, bag_size: 1082
batch 99, loss: 0.5246, instance_loss: 0.4599, weighted_loss: 0.5052, label: 3, bag_size: 795
batch 119, loss: 0.0139, instance_loss: 0.2416, weighted_loss: 0.0822, label: 0, bag_size: 425
batch 139, loss: 0.0100, instance_loss: 0.2921, weighted_loss: 0.0946, label: 0, bag_size: 138
batch 159, loss: 0.5651, instance_loss: 0.4008, weighted_loss: 0.5158, label: 2, bag_size: 1010
batch 179, loss: 0.0753, instance_loss: 0.4353, weighted_loss: 0.1833, label: 4, bag_size: 725
batch 199, loss: 1.1399, instance_loss: 0.5233, weighted_loss: 0.9549, label: 2, bag_size: 867
batch 219, loss: 0.2845, instance_loss: 0.4524, weighted_loss: 0.3349, label: 4, bag_size: 854
batch 239, loss: 1.0921, instance_loss: 0.4611, weighted_loss: 0.9028, label: 1, bag_size: 460
batch 259, loss: 2.1552, instance_loss: 0.5799, weighted_loss: 1.6826, label: 2, bag_size: 331
batch 279, loss: 0.3428, instance_loss: 0.4071, weighted_loss: 0.3621, label: 0, bag_size: 428
batch 299, loss: 0.0066, instance_loss: 0.2799, weighted_loss: 0.0886, label: 0, bag_size: 350
batch 319, loss: 3.7829, instance_loss: 0.6205, weighted_loss: 2.8342, label: 2, bag_size: 337
batch 339, loss: 0.4934, instance_loss: 0.4092, weighted_loss: 0.4681, label: 4, bag_size: 895
batch 359, loss: 0.8948, instance_loss: 0.4525, weighted_loss: 0.7621, label: 2, bag_size: 1197
batch 379, loss: 0.0762, instance_loss: 0.2599, weighted_loss: 0.1313, label: 0, bag_size: 493
batch 399, loss: 0.1452, instance_loss: 0.3896, weighted_loss: 0.2185, label: 0, bag_size: 297
batch 419, loss: 1.8725, instance_loss: 0.5842, weighted_loss: 1.4860, label: 2, bag_size: 318
batch 439, loss: 0.0819, instance_loss: 0.3800, weighted_loss: 0.1714, label: 0, bag_size: 488
batch 459, loss: 1.2719, instance_loss: 0.4798, weighted_loss: 1.0342, label: 3, bag_size: 523
batch 479, loss: 2.3424, instance_loss: 0.5079, weighted_loss: 1.7920, label: 4, bag_size: 699
batch 499, loss: 0.0141, instance_loss: 0.2765, weighted_loss: 0.0928, label: 0, bag_size: 74
batch 519, loss: 1.8325, instance_loss: 0.5195, weighted_loss: 1.4386, label: 2, bag_size: 297
batch 539, loss: 1.7437, instance_loss: 0.5358, weighted_loss: 1.3813, label: 4, bag_size: 592
batch 559, loss: 0.0120, instance_loss: 0.2646, weighted_loss: 0.0878, label: 0, bag_size: 435
batch 579, loss: 0.0053, instance_loss: 0.3526, weighted_loss: 0.1095, label: 0, bag_size: 227


class 0 clustering acc 0.9975589225589225: correct 23702/23760
class 1 clustering acc 0.027356902356902357: correct 130/4752
Epoch: 62, train_loss: 0.9618, train_clustering_loss:  0.4746, train_error: 0.4141
class 0: acc 0.8861788617886179, correct 109/123
class 1: acc 0.47058823529411764, correct 56/119
class 2: acc 0.43609022556390975, correct 58/133
class 3: acc 0.46464646464646464, correct 46/99
class 4: acc 0.6583333333333333, correct 79/120

Val Set, val_loss: 1.2415, val_error: 0.5135, auc: 0.8247
class 0 clustering acc 1.0: correct 2960/2960
class 1 clustering acc 0.015202702702702704: correct 9/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.14285714285714285, correct 2/14
class 4: acc 0.7857142857142857, correct 11/14
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.9825, instance_loss: 0.4287, weighted_loss: 0.8164, label: 2, bag_size: 380
batch 39, loss: 1.8563, instance_loss: 0.5234, weighted_loss: 1.4564, label: 2, bag_size: 105
batch 59, loss: 0.6574, instance_loss: 0.5440, weighted_loss: 0.6234, label: 3, bag_size: 351
batch 79, loss: 0.6776, instance_loss: 0.4369, weighted_loss: 0.6054, label: 2, bag_size: 522
batch 99, loss: 1.7244, instance_loss: 0.4894, weighted_loss: 1.3539, label: 1, bag_size: 391
batch 119, loss: 0.7247, instance_loss: 0.4796, weighted_loss: 0.6511, label: 1, bag_size: 1082
batch 139, loss: 1.1357, instance_loss: 0.4637, weighted_loss: 0.9341, label: 4, bag_size: 46
batch 159, loss: 0.7186, instance_loss: 0.4643, weighted_loss: 0.6423, label: 2, bag_size: 119
batch 179, loss: 0.6523, instance_loss: 0.5351, weighted_loss: 0.6172, label: 3, bag_size: 476
batch 199, loss: 0.1851, instance_loss: 0.6111, weighted_loss: 0.3129, label: 4, bag_size: 231
batch 219, loss: 4.2117, instance_loss: 0.9207, weighted_loss: 3.2244, label: 4, bag_size: 1351
batch 239, loss: 0.4384, instance_loss: 0.3493, weighted_loss: 0.4117, label: 3, bag_size: 1154
batch 259, loss: 2.8406, instance_loss: 0.6301, weighted_loss: 2.1774, label: 0, bag_size: 1570
batch 279, loss: 0.4054, instance_loss: 0.4484, weighted_loss: 0.4183, label: 1, bag_size: 1121
batch 299, loss: 0.7571, instance_loss: 0.4403, weighted_loss: 0.6620, label: 1, bag_size: 591
batch 319, loss: 0.1153, instance_loss: 0.3698, weighted_loss: 0.1917, label: 0, bag_size: 231
batch 339, loss: 1.5238, instance_loss: 0.4183, weighted_loss: 1.1922, label: 3, bag_size: 496
batch 359, loss: 0.9572, instance_loss: 0.4500, weighted_loss: 0.8050, label: 1, bag_size: 605
batch 379, loss: 0.3872, instance_loss: 0.4378, weighted_loss: 0.4024, label: 0, bag_size: 393
batch 399, loss: 0.0142, instance_loss: 0.3332, weighted_loss: 0.1099, label: 0, bag_size: 357
batch 419, loss: 0.0205, instance_loss: 0.2672, weighted_loss: 0.0945, label: 0, bag_size: 425
batch 439, loss: 0.9390, instance_loss: 0.5989, weighted_loss: 0.8370, label: 4, bag_size: 356
batch 459, loss: 2.0078, instance_loss: 0.6731, weighted_loss: 1.6074, label: 2, bag_size: 288
batch 479, loss: 0.6916, instance_loss: 0.4292, weighted_loss: 0.6129, label: 2, bag_size: 631
batch 499, loss: 2.1338, instance_loss: 0.5278, weighted_loss: 1.6520, label: 2, bag_size: 754
batch 519, loss: 1.0935, instance_loss: 0.5438, weighted_loss: 0.9286, label: 4, bag_size: 868
batch 539, loss: 0.6115, instance_loss: 0.5147, weighted_loss: 0.5825, label: 4, bag_size: 450
batch 559, loss: 1.9125, instance_loss: 0.4732, weighted_loss: 1.4807, label: 4, bag_size: 264
batch 579, loss: 1.5007, instance_loss: 0.4884, weighted_loss: 1.1970, label: 1, bag_size: 981


class 0 clustering acc 0.9978535353535354: correct 23709/23760
class 1 clustering acc 0.027146464646464648: correct 129/4752
Epoch: 63, train_loss: 1.0147, train_clustering_loss:  0.4794, train_error: 0.4529
class 0: acc 0.7757009345794392, correct 83/107
class 1: acc 0.4462809917355372, correct 54/121
class 2: acc 0.4016393442622951, correct 49/122
class 3: acc 0.6642335766423357, correct 91/137
class 4: acc 0.4485981308411215, correct 48/107

Val Set, val_loss: 1.4262, val_error: 0.5270, auc: 0.7877
class 0 clustering acc 0.9976351351351351: correct 2953/2960
class 1 clustering acc 0.0016891891891891893: correct 1/592
class 0: acc 0.625, correct 10/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.7857142857142857, correct 11/14
class 4: acc 0.5714285714285714, correct 8/14
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.5583, instance_loss: 0.4415, weighted_loss: 0.5233, label: 0, bag_size: 428
batch 39, loss: 0.0012, instance_loss: 0.3234, weighted_loss: 0.0978, label: 0, bag_size: 527
batch 59, loss: 0.9093, instance_loss: 0.4089, weighted_loss: 0.7592, label: 3, bag_size: 258
batch 79, loss: 0.8308, instance_loss: 0.4342, weighted_loss: 0.7118, label: 2, bag_size: 697
batch 99, loss: 0.0961, instance_loss: 0.3196, weighted_loss: 0.1631, label: 0, bag_size: 493
batch 119, loss: 0.5053, instance_loss: 0.4287, weighted_loss: 0.4823, label: 4, bag_size: 418
batch 139, loss: 1.2281, instance_loss: 0.5369, weighted_loss: 1.0207, label: 2, bag_size: 1197
batch 159, loss: 0.9983, instance_loss: 0.5767, weighted_loss: 0.8718, label: 3, bag_size: 154
batch 179, loss: 0.7591, instance_loss: 0.4481, weighted_loss: 0.6658, label: 3, bag_size: 1022
batch 199, loss: 1.0399, instance_loss: 0.5328, weighted_loss: 0.8878, label: 2, bag_size: 883
batch 219, loss: 1.3141, instance_loss: 0.4880, weighted_loss: 1.0663, label: 4, bag_size: 482
batch 239, loss: 3.1003, instance_loss: 0.6417, weighted_loss: 2.3627, label: 2, bag_size: 1308
batch 259, loss: 0.8763, instance_loss: 0.4379, weighted_loss: 0.7448, label: 3, bag_size: 393
batch 279, loss: 0.0389, instance_loss: 0.4066, weighted_loss: 0.1492, label: 0, bag_size: 156
batch 299, loss: 0.6579, instance_loss: 0.4506, weighted_loss: 0.5957, label: 0, bag_size: 159
batch 319, loss: 0.4754, instance_loss: 0.4997, weighted_loss: 0.4827, label: 0, bag_size: 702
batch 339, loss: 1.1522, instance_loss: 0.5269, weighted_loss: 0.9646, label: 3, bag_size: 351
batch 359, loss: 1.1315, instance_loss: 0.4552, weighted_loss: 0.9286, label: 1, bag_size: 697
batch 379, loss: 0.8720, instance_loss: 0.4901, weighted_loss: 0.7574, label: 3, bag_size: 631
batch 399, loss: 2.3426, instance_loss: 0.5536, weighted_loss: 1.8059, label: 2, bag_size: 105
batch 419, loss: 1.1274, instance_loss: 0.5265, weighted_loss: 0.9471, label: 3, bag_size: 364
batch 439, loss: 1.8051, instance_loss: 0.7879, weighted_loss: 1.4999, label: 3, bag_size: 98
batch 459, loss: 0.7110, instance_loss: 0.4319, weighted_loss: 0.6273, label: 0, bag_size: 122
batch 479, loss: 1.6771, instance_loss: 0.4771, weighted_loss: 1.3171, label: 1, bag_size: 339
batch 499, loss: 0.4815, instance_loss: 0.3931, weighted_loss: 0.4550, label: 2, bag_size: 812
batch 519, loss: 0.3634, instance_loss: 0.4099, weighted_loss: 0.3774, label: 2, bag_size: 754
batch 539, loss: 1.9104, instance_loss: 0.5542, weighted_loss: 1.5036, label: 4, bag_size: 592
batch 559, loss: 2.0268, instance_loss: 0.6005, weighted_loss: 1.5989, label: 3, bag_size: 301
batch 579, loss: 0.7777, instance_loss: 0.6096, weighted_loss: 0.7273, label: 0, bag_size: 306


class 0 clustering acc 0.9979377104377104: correct 23711/23760
class 1 clustering acc 0.014730639730639731: correct 70/4752
Epoch: 64, train_loss: 0.9850, train_clustering_loss:  0.4885, train_error: 0.4091
class 0: acc 0.7967479674796748, correct 98/123
class 1: acc 0.4915254237288136, correct 58/118
class 2: acc 0.46923076923076923, correct 61/130
class 3: acc 0.6057692307692307, correct 63/104
class 4: acc 0.5966386554621849, correct 71/119

Val Set, val_loss: 1.1577, val_error: 0.4324, auc: 0.8427
class 0 clustering acc 0.9983108108108109: correct 2955/2960
class 1 clustering acc 0.016891891891891893: correct 10/592
class 0: acc 0.8125, correct 13/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5, correct 7/14
class 4: acc 0.6428571428571429, correct 9/14
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.6884, instance_loss: 0.4939, weighted_loss: 1.3300, label: 1, bag_size: 1009
batch 39, loss: 0.4487, instance_loss: 0.4419, weighted_loss: 0.4467, label: 1, bag_size: 44
batch 59, loss: 0.1753, instance_loss: 0.4881, weighted_loss: 0.2691, label: 0, bag_size: 354
batch 79, loss: 0.8166, instance_loss: 0.4094, weighted_loss: 0.6944, label: 1, bag_size: 981
batch 99, loss: 2.7574, instance_loss: 0.7353, weighted_loss: 2.1508, label: 0, bag_size: 492
batch 119, loss: 0.9690, instance_loss: 0.4799, weighted_loss: 0.8223, label: 3, bag_size: 351
batch 139, loss: 1.3647, instance_loss: 0.5360, weighted_loss: 1.1161, label: 4, bag_size: 263
batch 159, loss: 0.0086, instance_loss: 0.3431, weighted_loss: 0.1089, label: 0, bag_size: 103
batch 179, loss: 2.1047, instance_loss: 0.5697, weighted_loss: 1.6442, label: 2, bag_size: 498
batch 199, loss: 0.9602, instance_loss: 0.4676, weighted_loss: 0.8124, label: 2, bag_size: 392
batch 219, loss: 1.4354, instance_loss: 0.7177, weighted_loss: 1.2201, label: 0, bag_size: 343
batch 239, loss: 0.4630, instance_loss: 0.4878, weighted_loss: 0.4705, label: 1, bag_size: 1360
batch 259, loss: 1.1283, instance_loss: 0.4438, weighted_loss: 0.9229, label: 3, bag_size: 309
batch 279, loss: 0.6093, instance_loss: 0.5201, weighted_loss: 0.5825, label: 0, bag_size: 258
batch 299, loss: 0.6216, instance_loss: 0.4168, weighted_loss: 0.5601, label: 2, bag_size: 853
batch 319, loss: 0.6951, instance_loss: 0.4716, weighted_loss: 0.6281, label: 0, bag_size: 428
batch 339, loss: 0.7784, instance_loss: 0.4651, weighted_loss: 0.6844, label: 2, bag_size: 883
batch 359, loss: 0.5254, instance_loss: 0.4498, weighted_loss: 0.5027, label: 2, bag_size: 557
batch 379, loss: 0.7701, instance_loss: 0.4023, weighted_loss: 0.6598, label: 3, bag_size: 858
batch 399, loss: 1.4888, instance_loss: 0.5398, weighted_loss: 1.2041, label: 1, bag_size: 702
batch 419, loss: 0.3809, instance_loss: 0.4491, weighted_loss: 0.4014, label: 4, bag_size: 875
batch 439, loss: 0.0474, instance_loss: 0.3127, weighted_loss: 0.1270, label: 0, bag_size: 201
batch 459, loss: 0.0876, instance_loss: 0.4534, weighted_loss: 0.1974, label: 4, bag_size: 683
batch 479, loss: 0.0012, instance_loss: 0.3466, weighted_loss: 0.1048, label: 0, bag_size: 51
batch 499, loss: 0.7888, instance_loss: 0.3986, weighted_loss: 0.6717, label: 4, bag_size: 342
batch 519, loss: 1.2405, instance_loss: 0.4634, weighted_loss: 1.0073, label: 3, bag_size: 871
batch 539, loss: 0.0005, instance_loss: 0.3442, weighted_loss: 0.1036, label: 0, bag_size: 51
batch 559, loss: 0.4887, instance_loss: 0.4505, weighted_loss: 0.4773, label: 3, bag_size: 1078
batch 579, loss: 2.7392, instance_loss: 0.5343, weighted_loss: 2.0778, label: 1, bag_size: 616


class 0 clustering acc 0.997979797979798: correct 23712/23760
class 1 clustering acc 0.016203703703703703: correct 77/4752
Epoch: 65, train_loss: 0.9521, train_clustering_loss:  0.4789, train_error: 0.4091
class 0: acc 0.8389830508474576, correct 99/118
class 1: acc 0.525, correct 63/120
class 2: acc 0.4915254237288136, correct 58/118
class 3: acc 0.5511811023622047, correct 70/127
class 4: acc 0.5495495495495496, correct 61/111

Val Set, val_loss: 1.2204, val_error: 0.4189, auc: 0.8382
class 0 clustering acc 0.9979729729729729: correct 2954/2960
class 1 clustering acc 0.008445945945945946: correct 5/592
class 0: acc 0.75, correct 12/16
class 1: acc 0.5, correct 6/12
class 2: acc 0.5, correct 9/18
class 3: acc 0.7142857142857143, correct 10/14
class 4: acc 0.42857142857142855, correct 6/14
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.4324, ROC AUC: 0.8438
Test error: 0.5135, ROC AUC: 0.7957
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.35714285714285715, correct 5/14
class 4: acc 0.5, correct 7/14
finished!
end script
