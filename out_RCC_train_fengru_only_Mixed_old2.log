
Load Dataset
label column: label
label dictionary: {0: 0, 1: 1, 2: 2}
number of classes: 3
slide-level counts:  
 label
0    516
1    297
2    120
Name: count, dtype: int64
Patient-LVL; Number of samples registered in class 0: 516
Slide-LVL; Number of samples registered in class 0: 516
Patient-LVL; Number of samples registered in class 1: 297
Slide-LVL; Number of samples registered in class 1: 297
Patient-LVL; Number of samples registered in class 2: 120
Slide-LVL; Number of samples registered in class 2: 120
split_dir:  /home/graduate2024/code/zxb/CLAM-master/splits/RCC_fengru_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  RCC_fengru
max_epochs:  200
results_dir:  /home/graduate2024/code/baseline/CLAM-master/results/RCC_only_Mixed_UNI_d1024
lr:  0.0002
experiment:  RCC_only_Mixed_fengru
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_mb
model_size:  small
use_drop_out:  0.25
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  /home/graduate2024/code/zxb/CLAM-master/splits/RCC_fengru_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.4451, instance_loss: 0.7073, weighted_loss: 0.5237, label: 1, bag_size: 5195
batch 39, loss: 1.2922, instance_loss: 0.8012, weighted_loss: 1.1449, label: 0, bag_size: 5368
batch 59, loss: 1.3391, instance_loss: 0.7798, weighted_loss: 1.1713, label: 2, bag_size: 3546
batch 79, loss: 0.9700, instance_loss: 0.7612, weighted_loss: 0.9074, label: 2, bag_size: 5406
batch 99, loss: 2.0397, instance_loss: 0.7070, weighted_loss: 1.6399, label: 1, bag_size: 5340
batch 119, loss: 1.9338, instance_loss: 0.8048, weighted_loss: 1.5951, label: 0, bag_size: 1025
batch 139, loss: 1.1734, instance_loss: 0.7645, weighted_loss: 1.0507, label: 1, bag_size: 5167
batch 159, loss: 1.0533, instance_loss: 0.8975, weighted_loss: 1.0066, label: 0, bag_size: 5011
batch 179, loss: 1.2501, instance_loss: 0.7536, weighted_loss: 1.1012, label: 0, bag_size: 4524
batch 199, loss: 1.4624, instance_loss: 0.7397, weighted_loss: 1.2456, label: 2, bag_size: 3546
batch 219, loss: 0.5975, instance_loss: 0.8788, weighted_loss: 0.6819, label: 2, bag_size: 4745
batch 239, loss: 2.2065, instance_loss: 0.8514, weighted_loss: 1.8000, label: 0, bag_size: 1365
batch 259, loss: 0.8545, instance_loss: 0.6371, weighted_loss: 0.7893, label: 2, bag_size: 4302
batch 279, loss: 0.5295, instance_loss: 0.5822, weighted_loss: 0.5453, label: 2, bag_size: 2561
batch 299, loss: 0.3017, instance_loss: 0.5282, weighted_loss: 0.3697, label: 0, bag_size: 4841
batch 319, loss: 1.8274, instance_loss: 0.9417, weighted_loss: 1.5617, label: 2, bag_size: 552
batch 339, loss: 2.2941, instance_loss: 0.9666, weighted_loss: 1.8958, label: 1, bag_size: 20666
batch 359, loss: 0.4814, instance_loss: 0.6260, weighted_loss: 0.5248, label: 1, bag_size: 3357
batch 379, loss: 0.9698, instance_loss: 0.7979, weighted_loss: 0.9182, label: 0, bag_size: 4458
batch 399, loss: 0.4389, instance_loss: 0.4694, weighted_loss: 0.4480, label: 1, bag_size: 1045
batch 419, loss: 0.5385, instance_loss: 0.7782, weighted_loss: 0.6104, label: 2, bag_size: 3112
batch 439, loss: 0.4349, instance_loss: 0.6776, weighted_loss: 0.5077, label: 2, bag_size: 4569
batch 459, loss: 0.9760, instance_loss: 0.7516, weighted_loss: 0.9087, label: 2, bag_size: 6644
batch 479, loss: 1.5327, instance_loss: 0.8153, weighted_loss: 1.3175, label: 0, bag_size: 4711
batch 499, loss: 1.0846, instance_loss: 0.6706, weighted_loss: 0.9604, label: 1, bag_size: 14449
batch 519, loss: 0.7594, instance_loss: 0.5850, weighted_loss: 0.7071, label: 0, bag_size: 3188
batch 539, loss: 0.2734, instance_loss: 0.5135, weighted_loss: 0.3454, label: 2, bag_size: 3121
batch 559, loss: 0.8538, instance_loss: 0.7299, weighted_loss: 0.8166, label: 1, bag_size: 4898
batch 579, loss: 1.0383, instance_loss: 0.6412, weighted_loss: 0.9192, label: 0, bag_size: 3475
batch 599, loss: 1.0792, instance_loss: 0.6909, weighted_loss: 0.9627, label: 0, bag_size: 1485
batch 619, loss: 1.0705, instance_loss: 0.6596, weighted_loss: 0.9472, label: 0, bag_size: 35080
batch 639, loss: 0.5623, instance_loss: 0.5737, weighted_loss: 0.5657, label: 1, bag_size: 1029
batch 659, loss: 0.9094, instance_loss: 0.6744, weighted_loss: 0.8389, label: 0, bag_size: 3983
batch 679, loss: 0.5026, instance_loss: 0.4871, weighted_loss: 0.4979, label: 1, bag_size: 3338
batch 699, loss: 0.9215, instance_loss: 0.8011, weighted_loss: 0.8854, label: 2, bag_size: 4291
batch 719, loss: 0.6388, instance_loss: 0.6102, weighted_loss: 0.6302, label: 1, bag_size: 1221
batch 739, loss: 0.8224, instance_loss: 0.6001, weighted_loss: 0.7558, label: 0, bag_size: 4547


class 0 clustering acc 0.9973713646532438: correct 17833/17880
class 1 clustering acc 0.0055369127516778525: correct 33/5960
Epoch: 0, train_loss: 1.0426, train_clustering_loss:  0.7228, train_error: 0.4886
class 0: acc 0.4549019607843137, correct 116/255
class 1: acc 0.4732510288065844, correct 115/243
class 2: acc 0.6072874493927125, correct 150/247

Val Set, val_loss: 0.8758, val_error: 0.4681, auc: 0.7772
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.40384615384615385, correct 21/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (inf --> 0.875815).  Saving model ...


batch 19, loss: 1.5929, instance_loss: 0.9153, weighted_loss: 1.3896, label: 2, bag_size: 6298
batch 39, loss: 0.6334, instance_loss: 0.5690, weighted_loss: 0.6141, label: 2, bag_size: 5426
batch 59, loss: 1.2220, instance_loss: 0.6250, weighted_loss: 1.0429, label: 1, bag_size: 4181
batch 79, loss: 0.7195, instance_loss: 0.6998, weighted_loss: 0.7136, label: 0, bag_size: 855
batch 99, loss: 0.7055, instance_loss: 0.6277, weighted_loss: 0.6822, label: 0, bag_size: 5368
batch 119, loss: 2.2811, instance_loss: 0.9755, weighted_loss: 1.8894, label: 1, bag_size: 1122
batch 139, loss: 0.2599, instance_loss: 0.5529, weighted_loss: 0.3478, label: 2, bag_size: 4856
batch 159, loss: 0.9888, instance_loss: 0.7352, weighted_loss: 0.9127, label: 0, bag_size: 4325
batch 179, loss: 0.2606, instance_loss: 0.2806, weighted_loss: 0.2666, label: 1, bag_size: 3367
batch 199, loss: 0.2028, instance_loss: 0.4915, weighted_loss: 0.2894, label: 2, bag_size: 3497
batch 219, loss: 1.5980, instance_loss: 0.8633, weighted_loss: 1.3776, label: 1, bag_size: 1595
batch 239, loss: 1.3872, instance_loss: 0.9902, weighted_loss: 1.2681, label: 2, bag_size: 3746
batch 259, loss: 0.2298, instance_loss: 0.3754, weighted_loss: 0.2735, label: 1, bag_size: 796
batch 279, loss: 0.9068, instance_loss: 0.5547, weighted_loss: 0.8012, label: 1, bag_size: 7109
batch 299, loss: 1.6420, instance_loss: 0.8033, weighted_loss: 1.3904, label: 0, bag_size: 4310
batch 319, loss: 0.7443, instance_loss: 1.1928, weighted_loss: 0.8788, label: 0, bag_size: 3594
batch 339, loss: 0.6032, instance_loss: 0.9003, weighted_loss: 0.6923, label: 2, bag_size: 4745
batch 359, loss: 2.3924, instance_loss: 1.0799, weighted_loss: 1.9986, label: 2, bag_size: 223
batch 379, loss: 1.1191, instance_loss: 0.7895, weighted_loss: 1.0202, label: 0, bag_size: 436
batch 399, loss: 0.3983, instance_loss: 0.4787, weighted_loss: 0.4224, label: 2, bag_size: 4691
batch 419, loss: 0.4138, instance_loss: 0.7232, weighted_loss: 0.5066, label: 2, bag_size: 4497
batch 439, loss: 2.9125, instance_loss: 1.1193, weighted_loss: 2.3745, label: 2, bag_size: 361
batch 459, loss: 0.4689, instance_loss: 0.4409, weighted_loss: 0.4605, label: 1, bag_size: 5003
batch 479, loss: 1.6781, instance_loss: 0.8345, weighted_loss: 1.4250, label: 0, bag_size: 6630
batch 499, loss: 0.1083, instance_loss: 0.6024, weighted_loss: 0.2566, label: 2, bag_size: 657
batch 519, loss: 1.5418, instance_loss: 1.0224, weighted_loss: 1.3860, label: 2, bag_size: 4241
batch 539, loss: 0.1554, instance_loss: 0.1935, weighted_loss: 0.1668, label: 1, bag_size: 3398
batch 559, loss: 1.5351, instance_loss: 0.5923, weighted_loss: 1.2523, label: 0, bag_size: 2069
batch 579, loss: 0.2911, instance_loss: 0.4070, weighted_loss: 0.3259, label: 0, bag_size: 2257
batch 599, loss: 1.3718, instance_loss: 0.6647, weighted_loss: 1.1596, label: 0, bag_size: 20234
batch 619, loss: 0.6983, instance_loss: 0.6134, weighted_loss: 0.6728, label: 1, bag_size: 6475
batch 639, loss: 0.9654, instance_loss: 0.7623, weighted_loss: 0.9045, label: 1, bag_size: 2671
batch 659, loss: 0.6900, instance_loss: 0.6890, weighted_loss: 0.6897, label: 2, bag_size: 4691
batch 679, loss: 0.5435, instance_loss: 0.4708, weighted_loss: 0.5217, label: 0, bag_size: 1399
batch 699, loss: 1.3597, instance_loss: 0.9305, weighted_loss: 1.2309, label: 2, bag_size: 597
batch 719, loss: 0.2685, instance_loss: 0.2622, weighted_loss: 0.2666, label: 1, bag_size: 4253
batch 739, loss: 0.4816, instance_loss: 0.4861, weighted_loss: 0.4829, label: 1, bag_size: 440


class 0 clustering acc 0.9937919463087248: correct 17769/17880
class 1 clustering acc 0.05570469798657718: correct 332/5960
Epoch: 1, train_loss: 0.8952, train_clustering_loss:  0.6639, train_error: 0.3946
class 0: acc 0.5714285714285714, correct 144/252
class 1: acc 0.6374045801526718, correct 167/262
class 2: acc 0.6060606060606061, correct 140/231

Val Set, val_loss: 1.1065, val_error: 0.5426, auc: 0.8165
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.2692307692307692, correct 14/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1027, instance_loss: 0.3959, weighted_loss: 0.1906, label: 2, bag_size: 4487
batch 39, loss: 0.9021, instance_loss: 0.8037, weighted_loss: 0.8726, label: 0, bag_size: 4524
batch 59, loss: 0.7199, instance_loss: 0.8020, weighted_loss: 0.7445, label: 2, bag_size: 5472
batch 79, loss: 0.5796, instance_loss: 0.6331, weighted_loss: 0.5956, label: 1, bag_size: 1510
batch 99, loss: 0.6016, instance_loss: 0.6590, weighted_loss: 0.6188, label: 2, bag_size: 4691
batch 119, loss: 2.1386, instance_loss: 1.3343, weighted_loss: 1.8973, label: 0, bag_size: 15105
batch 139, loss: 0.6213, instance_loss: 0.6062, weighted_loss: 0.6167, label: 2, bag_size: 4162
batch 159, loss: 0.5363, instance_loss: 0.6510, weighted_loss: 0.5707, label: 2, bag_size: 6644
batch 179, loss: 1.1263, instance_loss: 0.7803, weighted_loss: 1.0225, label: 1, bag_size: 3821
batch 199, loss: 1.2500, instance_loss: 0.8203, weighted_loss: 1.1211, label: 2, bag_size: 1050
batch 219, loss: 0.7227, instance_loss: 0.7237, weighted_loss: 0.7230, label: 0, bag_size: 3182
batch 239, loss: 1.2484, instance_loss: 0.8697, weighted_loss: 1.1348, label: 1, bag_size: 4346
batch 259, loss: 0.7160, instance_loss: 0.6536, weighted_loss: 0.6973, label: 0, bag_size: 4570
batch 279, loss: 1.4406, instance_loss: 0.6482, weighted_loss: 1.2029, label: 1, bag_size: 5693
batch 299, loss: 0.8529, instance_loss: 0.5622, weighted_loss: 0.7657, label: 1, bag_size: 4784
batch 319, loss: 0.7173, instance_loss: 0.5850, weighted_loss: 0.6776, label: 1, bag_size: 3396
batch 339, loss: 2.7535, instance_loss: 1.4543, weighted_loss: 2.3638, label: 0, bag_size: 19216
batch 359, loss: 0.5865, instance_loss: 0.5028, weighted_loss: 0.5614, label: 1, bag_size: 4578
batch 379, loss: 0.2464, instance_loss: 0.5981, weighted_loss: 0.3519, label: 2, bag_size: 614
batch 399, loss: 1.0200, instance_loss: 0.7702, weighted_loss: 0.9451, label: 1, bag_size: 9099
batch 419, loss: 0.7352, instance_loss: 0.7963, weighted_loss: 0.7536, label: 0, bag_size: 3666
batch 439, loss: 0.3497, instance_loss: 0.5114, weighted_loss: 0.3982, label: 2, bag_size: 4856
batch 459, loss: 0.6386, instance_loss: 0.5067, weighted_loss: 0.5990, label: 2, bag_size: 3415
batch 479, loss: 0.6377, instance_loss: 0.3873, weighted_loss: 0.5626, label: 1, bag_size: 2870
batch 499, loss: 0.3108, instance_loss: 0.5098, weighted_loss: 0.3705, label: 0, bag_size: 5036
batch 519, loss: 0.8855, instance_loss: 0.6280, weighted_loss: 0.8082, label: 1, bag_size: 4373
batch 539, loss: 0.4943, instance_loss: 0.5599, weighted_loss: 0.5140, label: 1, bag_size: 1029
batch 559, loss: 0.4635, instance_loss: 0.4776, weighted_loss: 0.4677, label: 2, bag_size: 4162
batch 579, loss: 0.2702, instance_loss: 0.3822, weighted_loss: 0.3038, label: 2, bag_size: 4203
batch 599, loss: 1.2505, instance_loss: 0.8195, weighted_loss: 1.1212, label: 1, bag_size: 1542
batch 619, loss: 1.7830, instance_loss: 0.9585, weighted_loss: 1.5357, label: 1, bag_size: 1580
batch 639, loss: 0.0981, instance_loss: 0.3929, weighted_loss: 0.1865, label: 0, bag_size: 1545
batch 659, loss: 0.6319, instance_loss: 0.6948, weighted_loss: 0.6507, label: 1, bag_size: 3337
batch 679, loss: 0.0455, instance_loss: 0.2173, weighted_loss: 0.0971, label: 2, bag_size: 4302
batch 699, loss: 0.6928, instance_loss: 0.6886, weighted_loss: 0.6915, label: 1, bag_size: 800
batch 719, loss: 0.9299, instance_loss: 0.7391, weighted_loss: 0.8726, label: 2, bag_size: 4535
batch 739, loss: 0.7777, instance_loss: 0.7151, weighted_loss: 0.7589, label: 1, bag_size: 4940


class 0 clustering acc 0.9956375838926175: correct 17802/17880
class 1 clustering acc 0.02785234899328859: correct 166/5960
Epoch: 2, train_loss: 0.9050, train_clustering_loss:  0.6732, train_error: 0.4174
class 0: acc 0.575107296137339, correct 134/233
class 1: acc 0.5203252032520326, correct 128/246
class 2: acc 0.6466165413533834, correct 172/266

Val Set, val_loss: 0.9140, val_error: 0.3723, auc: 0.8125
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.5767, instance_loss: 1.1908, weighted_loss: 2.1609, label: 0, bag_size: 2915
batch 39, loss: 1.1343, instance_loss: 0.7716, weighted_loss: 1.0255, label: 1, bag_size: 4187
batch 59, loss: 0.4993, instance_loss: 0.5562, weighted_loss: 0.5164, label: 1, bag_size: 2009
batch 79, loss: 0.7607, instance_loss: 0.5304, weighted_loss: 0.6916, label: 0, bag_size: 4719
batch 99, loss: 0.3478, instance_loss: 0.4935, weighted_loss: 0.3915, label: 2, bag_size: 4978
batch 119, loss: 0.8085, instance_loss: 0.5521, weighted_loss: 0.7316, label: 0, bag_size: 7219
batch 139, loss: 0.6189, instance_loss: 0.5420, weighted_loss: 0.5958, label: 0, bag_size: 4946
batch 159, loss: 0.3493, instance_loss: 0.4269, weighted_loss: 0.3726, label: 0, bag_size: 3188
batch 179, loss: 0.3160, instance_loss: 0.4944, weighted_loss: 0.3695, label: 2, bag_size: 2905
batch 199, loss: 1.2757, instance_loss: 0.8322, weighted_loss: 1.1427, label: 1, bag_size: 5402
batch 219, loss: 0.1586, instance_loss: 0.5536, weighted_loss: 0.2771, label: 0, bag_size: 4070
batch 239, loss: 1.8121, instance_loss: 1.1077, weighted_loss: 1.6008, label: 1, bag_size: 1477
batch 259, loss: 0.1617, instance_loss: 0.3543, weighted_loss: 0.2195, label: 0, bag_size: 2019
batch 279, loss: 0.1926, instance_loss: 0.2613, weighted_loss: 0.2132, label: 0, bag_size: 6797
batch 299, loss: 0.7617, instance_loss: 0.6083, weighted_loss: 0.7157, label: 0, bag_size: 1373
batch 319, loss: 0.1111, instance_loss: 0.3722, weighted_loss: 0.1894, label: 2, bag_size: 4555
batch 339, loss: 0.5177, instance_loss: 0.9503, weighted_loss: 0.6475, label: 2, bag_size: 4745
batch 359, loss: 0.3003, instance_loss: 0.4338, weighted_loss: 0.3404, label: 1, bag_size: 3007
batch 379, loss: 2.0750, instance_loss: 1.1172, weighted_loss: 1.7876, label: 2, bag_size: 3475
batch 399, loss: 1.0485, instance_loss: 0.7647, weighted_loss: 0.9634, label: 1, bag_size: 2319
batch 419, loss: 0.1597, instance_loss: 0.3731, weighted_loss: 0.2238, label: 0, bag_size: 5036
batch 439, loss: 1.4671, instance_loss: 0.7921, weighted_loss: 1.2646, label: 2, bag_size: 724
batch 459, loss: 2.4893, instance_loss: 0.8969, weighted_loss: 2.0116, label: 1, bag_size: 5760
batch 479, loss: 0.7599, instance_loss: 0.7090, weighted_loss: 0.7447, label: 2, bag_size: 4203
batch 499, loss: 1.1079, instance_loss: 0.7770, weighted_loss: 1.0087, label: 0, bag_size: 3182
batch 519, loss: 0.2075, instance_loss: 0.4889, weighted_loss: 0.2919, label: 1, bag_size: 1558
batch 539, loss: 0.9160, instance_loss: 0.8803, weighted_loss: 0.9053, label: 0, bag_size: 4707
batch 559, loss: 0.6682, instance_loss: 0.4517, weighted_loss: 0.6032, label: 1, bag_size: 440
batch 579, loss: 0.2045, instance_loss: 0.7251, weighted_loss: 0.3607, label: 2, bag_size: 5138
batch 599, loss: 0.3743, instance_loss: 0.5221, weighted_loss: 0.4186, label: 0, bag_size: 3833
batch 619, loss: 0.4196, instance_loss: 0.4435, weighted_loss: 0.4268, label: 0, bag_size: 5041
batch 639, loss: 1.3782, instance_loss: 0.9169, weighted_loss: 1.2398, label: 0, bag_size: 4529
batch 659, loss: 0.1105, instance_loss: 0.3802, weighted_loss: 0.1914, label: 2, bag_size: 2483
batch 679, loss: 0.6234, instance_loss: 0.7130, weighted_loss: 0.6503, label: 2, bag_size: 5017
batch 699, loss: 2.2739, instance_loss: 1.0368, weighted_loss: 1.9027, label: 0, bag_size: 5840
batch 719, loss: 0.1856, instance_loss: 0.3983, weighted_loss: 0.2494, label: 1, bag_size: 5385
batch 739, loss: 0.3894, instance_loss: 0.3564, weighted_loss: 0.3795, label: 1, bag_size: 5195


class 0 clustering acc 0.9917225950782997: correct 17732/17880
class 1 clustering acc 0.056711409395973154: correct 338/5960
Epoch: 3, train_loss: 0.7910, train_clustering_loss:  0.6404, train_error: 0.3423
class 0: acc 0.7056451612903226, correct 175/248
class 1: acc 0.5265306122448979, correct 129/245
class 2: acc 0.7380952380952381, correct 186/252

Val Set, val_loss: 0.7986, val_error: 0.3298, auc: 0.8249
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.13031914893617022: correct 98/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.875815 --> 0.798620).  Saving model ...


batch 19, loss: 0.0969, instance_loss: 0.3316, weighted_loss: 0.1673, label: 0, bag_size: 873
batch 39, loss: 0.2108, instance_loss: 0.4049, weighted_loss: 0.2690, label: 1, bag_size: 6315
batch 59, loss: 0.2511, instance_loss: 0.4777, weighted_loss: 0.3190, label: 2, bag_size: 88
batch 79, loss: 0.2614, instance_loss: 0.4534, weighted_loss: 0.3190, label: 0, bag_size: 3525
batch 99, loss: 0.0639, instance_loss: 0.2842, weighted_loss: 0.1300, label: 2, bag_size: 4203
batch 119, loss: 0.1259, instance_loss: 0.7003, weighted_loss: 0.2982, label: 2, bag_size: 2049
batch 139, loss: 0.0357, instance_loss: 0.3739, weighted_loss: 0.1371, label: 2, bag_size: 6026
batch 159, loss: 0.4256, instance_loss: 0.4934, weighted_loss: 0.4460, label: 1, bag_size: 4708
batch 179, loss: 0.9796, instance_loss: 0.8824, weighted_loss: 0.9504, label: 0, bag_size: 5656
batch 199, loss: 0.1084, instance_loss: 0.3667, weighted_loss: 0.1859, label: 0, bag_size: 577
batch 219, loss: 0.1390, instance_loss: 0.3445, weighted_loss: 0.2007, label: 2, bag_size: 4569
batch 239, loss: 0.9057, instance_loss: 0.8325, weighted_loss: 0.8837, label: 2, bag_size: 2326
batch 259, loss: 0.2463, instance_loss: 0.4213, weighted_loss: 0.2988, label: 0, bag_size: 4071
batch 279, loss: 0.4868, instance_loss: 0.5180, weighted_loss: 0.4962, label: 0, bag_size: 2983
batch 299, loss: 0.1490, instance_loss: 0.4033, weighted_loss: 0.2253, label: 0, bag_size: 4229
batch 319, loss: 0.3776, instance_loss: 0.5913, weighted_loss: 0.4418, label: 1, bag_size: 2796
batch 339, loss: 0.5343, instance_loss: 0.9009, weighted_loss: 0.6443, label: 0, bag_size: 3601
batch 359, loss: 1.5003, instance_loss: 0.6644, weighted_loss: 1.2495, label: 0, bag_size: 3675
batch 379, loss: 1.2586, instance_loss: 0.7255, weighted_loss: 1.0987, label: 1, bag_size: 6992
batch 399, loss: 0.0388, instance_loss: 0.3974, weighted_loss: 0.1464, label: 2, bag_size: 657
batch 419, loss: 0.6613, instance_loss: 0.6217, weighted_loss: 0.6494, label: 0, bag_size: 4146
batch 439, loss: 0.3284, instance_loss: 0.6327, weighted_loss: 0.4197, label: 2, bag_size: 5914
batch 459, loss: 0.9360, instance_loss: 0.7281, weighted_loss: 0.8736, label: 2, bag_size: 4179
batch 479, loss: 0.2159, instance_loss: 0.4099, weighted_loss: 0.2741, label: 1, bag_size: 4027
batch 499, loss: 1.0904, instance_loss: 0.7444, weighted_loss: 0.9866, label: 1, bag_size: 14449
batch 519, loss: 0.0276, instance_loss: 0.3836, weighted_loss: 0.1344, label: 1, bag_size: 5018
batch 539, loss: 0.6202, instance_loss: 0.6009, weighted_loss: 0.6144, label: 0, bag_size: 3834
batch 559, loss: 1.7795, instance_loss: 0.9747, weighted_loss: 1.5380, label: 1, bag_size: 5205
batch 579, loss: 0.2330, instance_loss: 0.3846, weighted_loss: 0.2785, label: 1, bag_size: 3677
batch 599, loss: 0.6087, instance_loss: 0.4823, weighted_loss: 0.5708, label: 1, bag_size: 8632
batch 619, loss: 0.7080, instance_loss: 0.7774, weighted_loss: 0.7288, label: 0, bag_size: 3334
batch 639, loss: 2.8456, instance_loss: 1.3328, weighted_loss: 2.3918, label: 0, bag_size: 434
batch 659, loss: 0.0856, instance_loss: 0.3082, weighted_loss: 0.1524, label: 0, bag_size: 5029
batch 679, loss: 0.5085, instance_loss: 0.5749, weighted_loss: 0.5284, label: 0, bag_size: 3339
batch 699, loss: 0.6749, instance_loss: 0.5860, weighted_loss: 0.6483, label: 1, bag_size: 1023
batch 719, loss: 0.3528, instance_loss: 0.5452, weighted_loss: 0.4106, label: 0, bag_size: 1611
batch 739, loss: 0.1708, instance_loss: 0.4752, weighted_loss: 0.2621, label: 2, bag_size: 2997


class 0 clustering acc 0.986185682326622: correct 17633/17880
class 1 clustering acc 0.10167785234899329: correct 606/5960
Epoch: 4, train_loss: 0.7672, train_clustering_loss:  0.6379, train_error: 0.3423
class 0: acc 0.6807692307692308, correct 177/260
class 1: acc 0.5374449339207048, correct 122/227
class 2: acc 0.7403100775193798, correct 191/258

Val Set, val_loss: 0.7600, val_error: 0.2766, auc: 0.8442
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.14361702127659576: correct 108/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.798620 --> 0.760021).  Saving model ...


batch 19, loss: 0.5812, instance_loss: 0.4818, weighted_loss: 0.5514, label: 0, bag_size: 5950
batch 39, loss: 0.9421, instance_loss: 0.6227, weighted_loss: 0.8463, label: 1, bag_size: 5512
batch 59, loss: 0.1230, instance_loss: 0.3574, weighted_loss: 0.1933, label: 2, bag_size: 3397
batch 79, loss: 0.3296, instance_loss: 0.3714, weighted_loss: 0.3421, label: 1, bag_size: 425
batch 99, loss: 0.5197, instance_loss: 0.4230, weighted_loss: 0.4907, label: 2, bag_size: 3546
batch 119, loss: 0.2801, instance_loss: 0.5195, weighted_loss: 0.3519, label: 0, bag_size: 2601
batch 139, loss: 0.3616, instance_loss: 0.5886, weighted_loss: 0.4297, label: 1, bag_size: 3586
batch 159, loss: 0.6125, instance_loss: 0.6152, weighted_loss: 0.6133, label: 2, bag_size: 2422
batch 179, loss: 1.5950, instance_loss: 0.8697, weighted_loss: 1.3774, label: 0, bag_size: 20234
batch 199, loss: 0.5697, instance_loss: 0.8844, weighted_loss: 0.6641, label: 2, bag_size: 3618
batch 219, loss: 1.0952, instance_loss: 0.9124, weighted_loss: 1.0404, label: 2, bag_size: 4241
batch 239, loss: 1.2624, instance_loss: 0.8596, weighted_loss: 1.1416, label: 1, bag_size: 5197
batch 259, loss: 0.0851, instance_loss: 0.3837, weighted_loss: 0.1747, label: 1, bag_size: 874
batch 279, loss: 0.1716, instance_loss: 0.5070, weighted_loss: 0.2722, label: 2, bag_size: 5037
batch 299, loss: 0.3171, instance_loss: 0.6800, weighted_loss: 0.4260, label: 0, bag_size: 1097
batch 319, loss: 0.4278, instance_loss: 0.5395, weighted_loss: 0.4613, label: 0, bag_size: 7177
batch 339, loss: 1.0995, instance_loss: 0.5730, weighted_loss: 0.9416, label: 0, bag_size: 4604
batch 359, loss: 2.7401, instance_loss: 0.8539, weighted_loss: 2.1742, label: 1, bag_size: 5423
batch 379, loss: 1.1448, instance_loss: 0.6562, weighted_loss: 0.9982, label: 2, bag_size: 3604
batch 399, loss: 1.5843, instance_loss: 0.8566, weighted_loss: 1.3660, label: 1, bag_size: 1860
batch 419, loss: 0.5557, instance_loss: 0.5282, weighted_loss: 0.5475, label: 1, bag_size: 2865
batch 439, loss: 0.1331, instance_loss: 0.3887, weighted_loss: 0.2098, label: 2, bag_size: 3121
batch 459, loss: 0.1637, instance_loss: 0.3026, weighted_loss: 0.2054, label: 2, bag_size: 2359
batch 479, loss: 0.9230, instance_loss: 0.7730, weighted_loss: 0.8780, label: 0, bag_size: 4997
batch 499, loss: 0.4121, instance_loss: 0.3401, weighted_loss: 0.3905, label: 2, bag_size: 2905
batch 519, loss: 0.3342, instance_loss: 0.5655, weighted_loss: 0.4036, label: 2, bag_size: 6594
batch 539, loss: 0.1856, instance_loss: 0.4254, weighted_loss: 0.2575, label: 0, bag_size: 4071
batch 559, loss: 1.2748, instance_loss: 0.7158, weighted_loss: 1.1071, label: 2, bag_size: 724
batch 579, loss: 1.2998, instance_loss: 0.7571, weighted_loss: 1.1370, label: 0, bag_size: 1341
batch 599, loss: 0.3600, instance_loss: 0.7022, weighted_loss: 0.4627, label: 0, bag_size: 3038
batch 619, loss: 0.7027, instance_loss: 0.4880, weighted_loss: 0.6383, label: 1, bag_size: 3813
batch 639, loss: 0.1297, instance_loss: 0.2978, weighted_loss: 0.1801, label: 1, bag_size: 2905
batch 659, loss: 0.8251, instance_loss: 0.4648, weighted_loss: 0.7170, label: 1, bag_size: 2945
batch 679, loss: 0.1093, instance_loss: 0.3991, weighted_loss: 0.1962, label: 1, bag_size: 5026
batch 699, loss: 0.2687, instance_loss: 0.4244, weighted_loss: 0.3154, label: 2, bag_size: 4302
batch 719, loss: 0.4307, instance_loss: 0.5620, weighted_loss: 0.4701, label: 1, bag_size: 1599
batch 739, loss: 0.7786, instance_loss: 0.4251, weighted_loss: 0.6726, label: 2, bag_size: 2031


class 0 clustering acc 0.9883668903803132: correct 17672/17880
class 1 clustering acc 0.10436241610738255: correct 622/5960
Epoch: 5, train_loss: 0.7735, train_clustering_loss:  0.6314, train_error: 0.3544
class 0: acc 0.5855855855855856, correct 130/222
class 1: acc 0.6045627376425855, correct 159/263
class 2: acc 0.7384615384615385, correct 192/260

Val Set, val_loss: 0.7111, val_error: 0.2979, auc: 0.8503
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.09973404255319149: correct 75/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.760021 --> 0.711105).  Saving model ...


batch 19, loss: 0.2740, instance_loss: 0.4625, weighted_loss: 0.3306, label: 0, bag_size: 4458
batch 39, loss: 1.5107, instance_loss: 1.1085, weighted_loss: 1.3900, label: 2, bag_size: 1222
batch 59, loss: 0.4266, instance_loss: 0.3421, weighted_loss: 0.4013, label: 2, bag_size: 2905
batch 79, loss: 0.4263, instance_loss: 0.5458, weighted_loss: 0.4621, label: 0, bag_size: 5036
batch 99, loss: 0.1459, instance_loss: 0.3814, weighted_loss: 0.2166, label: 0, bag_size: 4312
batch 119, loss: 0.0935, instance_loss: 0.5118, weighted_loss: 0.2190, label: 1, bag_size: 6277
batch 139, loss: 0.6731, instance_loss: 0.4736, weighted_loss: 0.6132, label: 2, bag_size: 4162
batch 159, loss: 2.4002, instance_loss: 1.7582, weighted_loss: 2.2076, label: 0, bag_size: 3841
batch 179, loss: 1.2988, instance_loss: 1.1658, weighted_loss: 1.2589, label: 1, bag_size: 1549
batch 199, loss: 0.5326, instance_loss: 0.5646, weighted_loss: 0.5422, label: 2, bag_size: 1543
batch 219, loss: 1.3207, instance_loss: 0.8357, weighted_loss: 1.1752, label: 1, bag_size: 4069
batch 239, loss: 0.2011, instance_loss: 0.2877, weighted_loss: 0.2271, label: 2, bag_size: 4978
batch 259, loss: 0.8368, instance_loss: 0.7066, weighted_loss: 0.7977, label: 0, bag_size: 7330
batch 279, loss: 0.2141, instance_loss: 0.5379, weighted_loss: 0.3113, label: 1, bag_size: 5385
batch 299, loss: 0.6051, instance_loss: 0.5753, weighted_loss: 0.5962, label: 2, bag_size: 5426
batch 319, loss: 1.6121, instance_loss: 1.1859, weighted_loss: 1.4843, label: 2, bag_size: 5472
batch 339, loss: 1.7637, instance_loss: 0.9643, weighted_loss: 1.5239, label: 1, bag_size: 4069
batch 359, loss: 0.2775, instance_loss: 0.4948, weighted_loss: 0.3427, label: 2, bag_size: 5914
batch 379, loss: 0.3158, instance_loss: 0.3501, weighted_loss: 0.3261, label: 2, bag_size: 2483
batch 399, loss: 0.2524, instance_loss: 0.6326, weighted_loss: 0.3664, label: 1, bag_size: 4812
batch 419, loss: 0.5234, instance_loss: 0.7137, weighted_loss: 0.5805, label: 1, bag_size: 1604
batch 439, loss: 1.7666, instance_loss: 0.8420, weighted_loss: 1.4892, label: 1, bag_size: 4395
batch 459, loss: 0.3108, instance_loss: 0.3239, weighted_loss: 0.3147, label: 2, bag_size: 3176
batch 479, loss: 0.2151, instance_loss: 0.4112, weighted_loss: 0.2739, label: 0, bag_size: 5526
batch 499, loss: 2.3963, instance_loss: 1.1661, weighted_loss: 2.0272, label: 0, bag_size: 603
batch 519, loss: 0.5206, instance_loss: 0.6099, weighted_loss: 0.5474, label: 2, bag_size: 4162
batch 539, loss: 0.7160, instance_loss: 0.6292, weighted_loss: 0.6899, label: 1, bag_size: 2248
batch 559, loss: 0.7518, instance_loss: 0.6545, weighted_loss: 0.7226, label: 0, bag_size: 1353
batch 579, loss: 2.0360, instance_loss: 0.8545, weighted_loss: 1.6816, label: 2, bag_size: 1513
batch 599, loss: 0.2004, instance_loss: 0.3712, weighted_loss: 0.2516, label: 0, bag_size: 5036
batch 619, loss: 0.1412, instance_loss: 0.2753, weighted_loss: 0.1814, label: 2, bag_size: 4056
batch 639, loss: 0.4203, instance_loss: 0.5750, weighted_loss: 0.4667, label: 0, bag_size: 4529
batch 659, loss: 0.6540, instance_loss: 0.5846, weighted_loss: 0.6332, label: 1, bag_size: 1066
batch 679, loss: 1.0918, instance_loss: 0.5743, weighted_loss: 0.9366, label: 1, bag_size: 6993
batch 699, loss: 0.0536, instance_loss: 0.2171, weighted_loss: 0.1026, label: 1, bag_size: 5462
batch 719, loss: 2.8030, instance_loss: 1.1223, weighted_loss: 2.2988, label: 1, bag_size: 3497
batch 739, loss: 0.1747, instance_loss: 0.4819, weighted_loss: 0.2669, label: 1, bag_size: 3337


class 0 clustering acc 0.9845637583892617: correct 17604/17880
class 1 clustering acc 0.12046979865771812: correct 718/5960
Epoch: 6, train_loss: 0.7760, train_clustering_loss:  0.6399, train_error: 0.3342
class 0: acc 0.6624472573839663, correct 157/237
class 1: acc 0.59375, correct 152/256
class 2: acc 0.7420634920634921, correct 187/252

Val Set, val_loss: 0.7177, val_error: 0.2766, auc: 0.8377
class 0 clustering acc 0.9862588652482269: correct 2225/2256
class 1 clustering acc 0.07845744680851063: correct 59/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1261, instance_loss: 0.2876, weighted_loss: 0.1745, label: 0, bag_size: 3741
batch 39, loss: 0.1224, instance_loss: 0.3218, weighted_loss: 0.1822, label: 2, bag_size: 2422
batch 59, loss: 1.0941, instance_loss: 0.7544, weighted_loss: 0.9922, label: 0, bag_size: 893
batch 79, loss: 1.1515, instance_loss: 0.8236, weighted_loss: 1.0532, label: 1, bag_size: 4395
batch 99, loss: 0.8496, instance_loss: 0.6117, weighted_loss: 0.7782, label: 2, bag_size: 6298
batch 119, loss: 0.0546, instance_loss: 0.1494, weighted_loss: 0.0830, label: 2, bag_size: 4043
batch 139, loss: 0.3440, instance_loss: 0.4104, weighted_loss: 0.3640, label: 2, bag_size: 4569
batch 159, loss: 1.4040, instance_loss: 0.7810, weighted_loss: 1.2171, label: 1, bag_size: 5035
batch 179, loss: 0.0969, instance_loss: 0.2473, weighted_loss: 0.1420, label: 2, bag_size: 4203
batch 199, loss: 1.4353, instance_loss: 0.8763, weighted_loss: 1.2676, label: 1, bag_size: 817
batch 219, loss: 1.0648, instance_loss: 0.8725, weighted_loss: 1.0071, label: 2, bag_size: 3112
batch 239, loss: 0.5162, instance_loss: 0.5497, weighted_loss: 0.5262, label: 2, bag_size: 4569
batch 259, loss: 1.4097, instance_loss: 0.7925, weighted_loss: 1.2245, label: 0, bag_size: 609
batch 279, loss: 1.1823, instance_loss: 0.8663, weighted_loss: 1.0875, label: 0, bag_size: 5098
batch 299, loss: 0.3133, instance_loss: 0.4241, weighted_loss: 0.3466, label: 2, bag_size: 6273
batch 319, loss: 0.5869, instance_loss: 0.5551, weighted_loss: 0.5774, label: 2, bag_size: 5406
batch 339, loss: 0.3340, instance_loss: 0.4041, weighted_loss: 0.3550, label: 2, bag_size: 4535
batch 359, loss: 0.8501, instance_loss: 1.0014, weighted_loss: 0.8955, label: 1, bag_size: 6315
batch 379, loss: 0.7904, instance_loss: 0.6965, weighted_loss: 0.7623, label: 0, bag_size: 1025
batch 399, loss: 1.0827, instance_loss: 0.8270, weighted_loss: 1.0060, label: 1, bag_size: 817
batch 419, loss: 0.8062, instance_loss: 0.6304, weighted_loss: 0.7535, label: 0, bag_size: 1373
batch 439, loss: 1.0238, instance_loss: 0.7868, weighted_loss: 0.9527, label: 1, bag_size: 869
batch 459, loss: 0.8944, instance_loss: 0.6145, weighted_loss: 0.8105, label: 1, bag_size: 4200
batch 479, loss: 0.9950, instance_loss: 0.6902, weighted_loss: 0.9036, label: 1, bag_size: 3596
batch 499, loss: 0.1667, instance_loss: 0.2998, weighted_loss: 0.2066, label: 1, bag_size: 2009
batch 519, loss: 0.2820, instance_loss: 0.4519, weighted_loss: 0.3330, label: 0, bag_size: 4922
batch 539, loss: 0.2467, instance_loss: 0.4747, weighted_loss: 0.3151, label: 2, bag_size: 3810
batch 559, loss: 0.3284, instance_loss: 0.6010, weighted_loss: 0.4101, label: 0, bag_size: 996
batch 579, loss: 0.6016, instance_loss: 0.5083, weighted_loss: 0.5736, label: 2, bag_size: 6298
batch 599, loss: 1.9630, instance_loss: 0.8551, weighted_loss: 1.6306, label: 1, bag_size: 3497
batch 619, loss: 0.3712, instance_loss: 0.3976, weighted_loss: 0.3791, label: 0, bag_size: 5893
batch 639, loss: 0.8454, instance_loss: 0.7777, weighted_loss: 0.8251, label: 2, bag_size: 2326
batch 659, loss: 0.1293, instance_loss: 0.4174, weighted_loss: 0.2157, label: 0, bag_size: 1611
batch 679, loss: 1.5755, instance_loss: 1.0710, weighted_loss: 1.4241, label: 1, bag_size: 5512
batch 699, loss: 0.3406, instance_loss: 0.4215, weighted_loss: 0.3649, label: 0, bag_size: 2791
batch 719, loss: 0.4590, instance_loss: 0.7000, weighted_loss: 0.5313, label: 0, bag_size: 966
batch 739, loss: 0.7372, instance_loss: 1.0071, weighted_loss: 0.8182, label: 0, bag_size: 2232


class 0 clustering acc 0.988255033557047: correct 17670/17880
class 1 clustering acc 0.1278523489932886: correct 762/5960
Epoch: 7, train_loss: 0.7990, train_clustering_loss:  0.6391, train_error: 0.3450
class 0: acc 0.6536796536796536, correct 151/231
class 1: acc 0.5387755102040817, correct 132/245
class 2: acc 0.7620817843866171, correct 205/269

Val Set, val_loss: 0.6613, val_error: 0.2660, auc: 0.8572
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.10106382978723404: correct 76/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.711105 --> 0.661309).  Saving model ...


batch 19, loss: 0.0649, instance_loss: 0.1538, weighted_loss: 0.0916, label: 2, bag_size: 2997
batch 39, loss: 0.3193, instance_loss: 0.4215, weighted_loss: 0.3500, label: 0, bag_size: 5036
batch 59, loss: 2.1888, instance_loss: 0.8541, weighted_loss: 1.7884, label: 2, bag_size: 3604
batch 79, loss: 0.4796, instance_loss: 0.6432, weighted_loss: 0.5287, label: 1, bag_size: 5195
batch 99, loss: 0.2289, instance_loss: 0.4145, weighted_loss: 0.2846, label: 0, bag_size: 3038
batch 119, loss: 1.0500, instance_loss: 0.8596, weighted_loss: 0.9929, label: 1, bag_size: 2751
batch 139, loss: 0.0258, instance_loss: 0.1930, weighted_loss: 0.0760, label: 2, bag_size: 6026
batch 159, loss: 0.0737, instance_loss: 0.3792, weighted_loss: 0.1654, label: 2, bag_size: 3678
batch 179, loss: 0.1429, instance_loss: 0.2927, weighted_loss: 0.1878, label: 2, bag_size: 2997
batch 199, loss: 0.4651, instance_loss: 0.7004, weighted_loss: 0.5357, label: 0, bag_size: 3920
batch 219, loss: 0.1071, instance_loss: 0.2210, weighted_loss: 0.1412, label: 2, bag_size: 3285
batch 239, loss: 0.4909, instance_loss: 0.6062, weighted_loss: 0.5255, label: 1, bag_size: 3357
batch 259, loss: 0.2068, instance_loss: 0.4163, weighted_loss: 0.2696, label: 2, bag_size: 2422
batch 279, loss: 1.0344, instance_loss: 0.5030, weighted_loss: 0.8750, label: 0, bag_size: 1814
batch 299, loss: 0.2942, instance_loss: 0.3156, weighted_loss: 0.3006, label: 1, bag_size: 10941
batch 319, loss: 2.4468, instance_loss: 0.9212, weighted_loss: 1.9891, label: 1, bag_size: 12936
batch 339, loss: 0.3321, instance_loss: 0.5277, weighted_loss: 0.3907, label: 0, bag_size: 5823
batch 359, loss: 1.7527, instance_loss: 1.0171, weighted_loss: 1.5320, label: 1, bag_size: 3791
batch 379, loss: 1.2109, instance_loss: 0.7019, weighted_loss: 1.0582, label: 0, bag_size: 3341
batch 399, loss: 0.6681, instance_loss: 0.5419, weighted_loss: 0.6302, label: 2, bag_size: 4569
batch 419, loss: 0.3721, instance_loss: 0.4181, weighted_loss: 0.3859, label: 2, bag_size: 2359
batch 439, loss: 0.4992, instance_loss: 0.2800, weighted_loss: 0.4334, label: 2, bag_size: 88
batch 459, loss: 0.0997, instance_loss: 0.2506, weighted_loss: 0.1450, label: 2, bag_size: 4088
batch 479, loss: 0.7900, instance_loss: 0.7857, weighted_loss: 0.7887, label: 0, bag_size: 3268
batch 499, loss: 0.4875, instance_loss: 0.6445, weighted_loss: 0.5346, label: 0, bag_size: 6285
batch 519, loss: 0.6557, instance_loss: 0.5559, weighted_loss: 0.6257, label: 0, bag_size: 1141
batch 539, loss: 0.2402, instance_loss: 0.4670, weighted_loss: 0.3082, label: 0, bag_size: 667
batch 559, loss: 0.2919, instance_loss: 0.3682, weighted_loss: 0.3148, label: 0, bag_size: 1194
batch 579, loss: 1.6167, instance_loss: 1.0428, weighted_loss: 1.4445, label: 0, bag_size: 3310
batch 599, loss: 0.2815, instance_loss: 0.7405, weighted_loss: 0.4192, label: 2, bag_size: 3607
batch 619, loss: 0.2375, instance_loss: 0.5499, weighted_loss: 0.3312, label: 0, bag_size: 1245
batch 639, loss: 0.3123, instance_loss: 0.2962, weighted_loss: 0.3075, label: 0, bag_size: 5902
batch 659, loss: 0.0749, instance_loss: 0.5079, weighted_loss: 0.2048, label: 1, bag_size: 4111
batch 679, loss: 0.0228, instance_loss: 0.1062, weighted_loss: 0.0478, label: 2, bag_size: 6026
batch 699, loss: 0.0745, instance_loss: 0.1882, weighted_loss: 0.1086, label: 2, bag_size: 3327
batch 719, loss: 0.0787, instance_loss: 0.2840, weighted_loss: 0.1403, label: 2, bag_size: 3678
batch 739, loss: 0.8822, instance_loss: 0.6574, weighted_loss: 0.8148, label: 2, bag_size: 4535


class 0 clustering acc 0.9837807606263982: correct 17590/17880
class 1 clustering acc 0.15453020134228188: correct 921/5960
Epoch: 8, train_loss: 0.7531, train_clustering_loss:  0.6199, train_error: 0.3235
class 0: acc 0.7470817120622568, correct 192/257
class 1: acc 0.5686274509803921, correct 145/255
class 2: acc 0.7167381974248928, correct 167/233

Val Set, val_loss: 0.6534, val_error: 0.2766, auc: 0.8601
class 0 clustering acc 0.9875886524822695: correct 2228/2256
class 1 clustering acc 0.11037234042553191: correct 83/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.661309 --> 0.653433).  Saving model ...


batch 19, loss: 1.0977, instance_loss: 0.8561, weighted_loss: 1.0252, label: 1, bag_size: 3596
batch 39, loss: 0.2366, instance_loss: 0.3047, weighted_loss: 0.2570, label: 0, bag_size: 3883
batch 59, loss: 2.7269, instance_loss: 1.2782, weighted_loss: 2.2923, label: 1, bag_size: 3837
batch 79, loss: 1.2186, instance_loss: 0.8470, weighted_loss: 1.1071, label: 0, bag_size: 4541
batch 99, loss: 0.1596, instance_loss: 0.3386, weighted_loss: 0.2133, label: 0, bag_size: 4326
batch 119, loss: 0.9948, instance_loss: 0.4504, weighted_loss: 0.8315, label: 1, bag_size: 5167
batch 139, loss: 0.1403, instance_loss: 0.3361, weighted_loss: 0.1990, label: 2, bag_size: 3176
batch 159, loss: 0.7071, instance_loss: 0.7619, weighted_loss: 0.7235, label: 0, bag_size: 4794
batch 179, loss: 0.5100, instance_loss: 0.5879, weighted_loss: 0.5334, label: 2, bag_size: 4192
batch 199, loss: 2.2890, instance_loss: 0.7213, weighted_loss: 1.8187, label: 1, bag_size: 3497
batch 219, loss: 0.4829, instance_loss: 0.7447, weighted_loss: 0.5614, label: 0, bag_size: 4914
batch 239, loss: 0.4802, instance_loss: 0.8109, weighted_loss: 0.5794, label: 0, bag_size: 5585
batch 259, loss: 0.2272, instance_loss: 0.5746, weighted_loss: 0.3314, label: 2, bag_size: 3810
batch 279, loss: 0.5468, instance_loss: 0.6113, weighted_loss: 0.5661, label: 2, bag_size: 3299
batch 299, loss: 0.9574, instance_loss: 0.3489, weighted_loss: 0.7749, label: 2, bag_size: 4043
batch 319, loss: 0.4164, instance_loss: 0.3155, weighted_loss: 0.3861, label: 0, bag_size: 3641
batch 339, loss: 1.2915, instance_loss: 0.7989, weighted_loss: 1.1437, label: 1, bag_size: 3422
batch 359, loss: 0.0648, instance_loss: 0.3274, weighted_loss: 0.1436, label: 1, bag_size: 4578
batch 379, loss: 0.1971, instance_loss: 0.4656, weighted_loss: 0.2777, label: 2, bag_size: 4555
batch 399, loss: 0.3753, instance_loss: 0.7565, weighted_loss: 0.4896, label: 2, bag_size: 4535
batch 419, loss: 0.0012, instance_loss: 0.2571, weighted_loss: 0.0779, label: 0, bag_size: 1106
batch 439, loss: 0.0500, instance_loss: 0.2558, weighted_loss: 0.1118, label: 2, bag_size: 4856
batch 459, loss: 0.1866, instance_loss: 0.3258, weighted_loss: 0.2284, label: 0, bag_size: 1233
batch 479, loss: 0.2052, instance_loss: 0.3775, weighted_loss: 0.2569, label: 0, bag_size: 3406
batch 499, loss: 0.2149, instance_loss: 0.4675, weighted_loss: 0.2907, label: 1, bag_size: 2731
batch 519, loss: 0.1480, instance_loss: 0.3997, weighted_loss: 0.2235, label: 2, bag_size: 4555
batch 539, loss: 1.4381, instance_loss: 0.4492, weighted_loss: 1.1415, label: 2, bag_size: 705
batch 559, loss: 1.3079, instance_loss: 0.8536, weighted_loss: 1.1716, label: 1, bag_size: 9099
batch 579, loss: 0.0286, instance_loss: 0.2242, weighted_loss: 0.0873, label: 1, bag_size: 3172
batch 599, loss: 4.8775, instance_loss: 1.6509, weighted_loss: 3.9095, label: 1, bag_size: 3791
batch 619, loss: 0.3192, instance_loss: 0.4780, weighted_loss: 0.3669, label: 0, bag_size: 2487
batch 639, loss: 0.3978, instance_loss: 0.5970, weighted_loss: 0.4575, label: 0, bag_size: 4479
batch 659, loss: 2.6887, instance_loss: 1.1201, weighted_loss: 2.2181, label: 2, bag_size: 728
batch 679, loss: 2.2196, instance_loss: 0.9480, weighted_loss: 1.8381, label: 2, bag_size: 728
batch 699, loss: 1.1084, instance_loss: 1.0595, weighted_loss: 1.0937, label: 1, bag_size: 4181
batch 719, loss: 0.7763, instance_loss: 0.8125, weighted_loss: 0.7871, label: 0, bag_size: 768
batch 739, loss: 0.5381, instance_loss: 0.6927, weighted_loss: 0.5845, label: 0, bag_size: 3752


class 0 clustering acc 0.9792505592841163: correct 17509/17880
class 1 clustering acc 0.2087248322147651: correct 1244/5960
Epoch: 9, train_loss: 0.6916, train_clustering_loss:  0.6053, train_error: 0.2872
class 0: acc 0.73828125, correct 189/256
class 1: acc 0.6547619047619048, correct 165/252
class 2: acc 0.7468354430379747, correct 177/237

Val Set, val_loss: 0.6181, val_error: 0.2447, auc: 0.8819
class 0 clustering acc 0.9835992907801419: correct 2219/2256
class 1 clustering acc 0.17553191489361702: correct 132/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.653433 --> 0.618147).  Saving model ...


batch 19, loss: 0.7272, instance_loss: 0.6965, weighted_loss: 0.7180, label: 1, bag_size: 1027
batch 39, loss: 0.3173, instance_loss: 0.6504, weighted_loss: 0.4173, label: 0, bag_size: 2830
batch 59, loss: 0.1994, instance_loss: 0.3740, weighted_loss: 0.2518, label: 1, bag_size: 4595
batch 79, loss: 0.1154, instance_loss: 0.3590, weighted_loss: 0.1885, label: 2, bag_size: 3810
batch 99, loss: 0.0320, instance_loss: 0.1158, weighted_loss: 0.0571, label: 1, bag_size: 3338
batch 119, loss: 0.1496, instance_loss: 0.5206, weighted_loss: 0.2609, label: 0, bag_size: 4485
batch 139, loss: 0.6799, instance_loss: 0.5078, weighted_loss: 0.6283, label: 0, bag_size: 4416
batch 159, loss: 1.4131, instance_loss: 0.9173, weighted_loss: 1.2643, label: 0, bag_size: 1289
batch 179, loss: 0.8674, instance_loss: 1.0059, weighted_loss: 0.9089, label: 0, bag_size: 4146
batch 199, loss: 0.1349, instance_loss: 0.6400, weighted_loss: 0.2864, label: 0, bag_size: 4485
batch 219, loss: 0.0567, instance_loss: 0.2720, weighted_loss: 0.1213, label: 0, bag_size: 1647
batch 239, loss: 0.4362, instance_loss: 0.5885, weighted_loss: 0.4819, label: 1, bag_size: 1027
batch 259, loss: 3.2008, instance_loss: 1.2276, weighted_loss: 2.6088, label: 0, bag_size: 35080
batch 279, loss: 0.2226, instance_loss: 0.5352, weighted_loss: 0.3164, label: 0, bag_size: 4071
batch 299, loss: 0.3878, instance_loss: 0.5485, weighted_loss: 0.4360, label: 1, bag_size: 4644
batch 319, loss: 0.3813, instance_loss: 0.4698, weighted_loss: 0.4078, label: 2, bag_size: 6704
batch 339, loss: 2.3358, instance_loss: 1.3087, weighted_loss: 2.0277, label: 2, bag_size: 4179
batch 359, loss: 0.9187, instance_loss: 0.6570, weighted_loss: 0.8402, label: 0, bag_size: 2915
batch 379, loss: 0.9729, instance_loss: 0.9874, weighted_loss: 0.9773, label: 2, bag_size: 22464
batch 399, loss: 0.1226, instance_loss: 0.2207, weighted_loss: 0.1520, label: 2, bag_size: 4203
batch 419, loss: 0.3560, instance_loss: 0.5235, weighted_loss: 0.4062, label: 0, bag_size: 5634
batch 439, loss: 0.6593, instance_loss: 0.6001, weighted_loss: 0.6416, label: 2, bag_size: 1050
batch 459, loss: 0.6347, instance_loss: 0.6724, weighted_loss: 0.6460, label: 2, bag_size: 4535
batch 479, loss: 0.2277, instance_loss: 0.3301, weighted_loss: 0.2584, label: 2, bag_size: 4745
batch 499, loss: 0.5370, instance_loss: 0.5985, weighted_loss: 0.5555, label: 2, bag_size: 6704
batch 519, loss: 0.8768, instance_loss: 0.4843, weighted_loss: 0.7591, label: 2, bag_size: 4096
batch 539, loss: 0.1109, instance_loss: 0.2528, weighted_loss: 0.1535, label: 2, bag_size: 4223
batch 559, loss: 1.1597, instance_loss: 0.6748, weighted_loss: 1.0142, label: 1, bag_size: 1510
batch 579, loss: 0.0134, instance_loss: 0.5023, weighted_loss: 0.1600, label: 0, bag_size: 3038
batch 599, loss: 1.9567, instance_loss: 0.9117, weighted_loss: 1.6432, label: 2, bag_size: 909
batch 619, loss: 0.0681, instance_loss: 0.2282, weighted_loss: 0.1161, label: 2, bag_size: 3285
batch 639, loss: 0.4903, instance_loss: 0.5025, weighted_loss: 0.4940, label: 0, bag_size: 873
batch 659, loss: 0.4569, instance_loss: 0.4974, weighted_loss: 0.4691, label: 0, bag_size: 1052
batch 679, loss: 0.4125, instance_loss: 0.4263, weighted_loss: 0.4167, label: 0, bag_size: 4071
batch 699, loss: 1.3165, instance_loss: 0.8873, weighted_loss: 1.1878, label: 1, bag_size: 6993
batch 719, loss: 0.6554, instance_loss: 0.5180, weighted_loss: 0.6142, label: 0, bag_size: 5373
batch 739, loss: 0.2454, instance_loss: 0.3884, weighted_loss: 0.2883, label: 0, bag_size: 5236


class 0 clustering acc 0.9791387024608501: correct 17507/17880
class 1 clustering acc 0.1733221476510067: correct 1033/5960
Epoch: 10, train_loss: 0.7526, train_clustering_loss:  0.6246, train_error: 0.3248
class 0: acc 0.6826086956521739, correct 157/230
class 1: acc 0.5968992248062015, correct 154/258
class 2: acc 0.7470817120622568, correct 192/257

Val Set, val_loss: 0.7423, val_error: 0.2660, auc: 0.8741
class 0 clustering acc 0.9831560283687943: correct 2218/2256
class 1 clustering acc 0.09441489361702128: correct 71/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5972, instance_loss: 0.6067, weighted_loss: 0.6000, label: 1, bag_size: 3156
batch 39, loss: 0.7574, instance_loss: 0.4528, weighted_loss: 0.6660, label: 1, bag_size: 6475
batch 59, loss: 0.8998, instance_loss: 0.6354, weighted_loss: 0.8205, label: 0, bag_size: 4450
batch 79, loss: 0.5464, instance_loss: 0.5619, weighted_loss: 0.5510, label: 2, bag_size: 1050
batch 99, loss: 0.1805, instance_loss: 0.2986, weighted_loss: 0.2159, label: 2, bag_size: 4043
batch 119, loss: 0.6779, instance_loss: 0.8299, weighted_loss: 0.7235, label: 0, bag_size: 5848
batch 139, loss: 1.8907, instance_loss: 1.4894, weighted_loss: 1.7703, label: 2, bag_size: 4179
batch 159, loss: 0.5361, instance_loss: 0.5667, weighted_loss: 0.5453, label: 2, bag_size: 5406
batch 179, loss: 0.4529, instance_loss: 0.4520, weighted_loss: 0.4526, label: 0, bag_size: 4562
batch 199, loss: 0.1260, instance_loss: 0.2561, weighted_loss: 0.1650, label: 2, bag_size: 2905
batch 219, loss: 1.3000, instance_loss: 0.6910, weighted_loss: 1.1173, label: 2, bag_size: 3274
batch 239, loss: 1.1409, instance_loss: 0.8012, weighted_loss: 1.0390, label: 2, bag_size: 5406
batch 259, loss: 4.1215, instance_loss: 1.1580, weighted_loss: 3.2325, label: 0, bag_size: 4605
batch 279, loss: 1.4462, instance_loss: 0.9366, weighted_loss: 1.2933, label: 1, bag_size: 7176
batch 299, loss: 0.3319, instance_loss: 0.3299, weighted_loss: 0.3313, label: 2, bag_size: 2483
batch 319, loss: 0.7060, instance_loss: 0.7403, weighted_loss: 0.7163, label: 0, bag_size: 4678
batch 339, loss: 0.1223, instance_loss: 0.3387, weighted_loss: 0.1872, label: 2, bag_size: 4978
batch 359, loss: 0.0367, instance_loss: 0.4196, weighted_loss: 0.1516, label: 1, bag_size: 4111
batch 379, loss: 0.1894, instance_loss: 0.6065, weighted_loss: 0.3145, label: 1, bag_size: 314
batch 399, loss: 0.2240, instance_loss: 0.2705, weighted_loss: 0.2380, label: 2, bag_size: 4088
batch 419, loss: 0.1602, instance_loss: 0.3761, weighted_loss: 0.2250, label: 2, bag_size: 4302
batch 439, loss: 0.5838, instance_loss: 0.4306, weighted_loss: 0.5379, label: 0, bag_size: 6440
batch 459, loss: 0.0465, instance_loss: 0.3424, weighted_loss: 0.1353, label: 2, bag_size: 2483
batch 479, loss: 0.1882, instance_loss: 0.3828, weighted_loss: 0.2466, label: 0, bag_size: 6015
batch 499, loss: 1.0437, instance_loss: 0.6217, weighted_loss: 0.9171, label: 1, bag_size: 3109
batch 519, loss: 0.6040, instance_loss: 0.3169, weighted_loss: 0.5179, label: 2, bag_size: 2501
batch 539, loss: 2.7941, instance_loss: 1.1698, weighted_loss: 2.3068, label: 0, bag_size: 2217
batch 559, loss: 0.5542, instance_loss: 0.6465, weighted_loss: 0.5819, label: 1, bag_size: 1906
batch 579, loss: 0.3746, instance_loss: 0.6880, weighted_loss: 0.4687, label: 2, bag_size: 3810
batch 599, loss: 1.5751, instance_loss: 0.8113, weighted_loss: 1.3459, label: 1, bag_size: 5072
batch 619, loss: 0.6642, instance_loss: 0.6170, weighted_loss: 0.6500, label: 1, bag_size: 4184
batch 639, loss: 0.5306, instance_loss: 0.5480, weighted_loss: 0.5358, label: 1, bag_size: 2865
batch 659, loss: 0.0044, instance_loss: 0.1471, weighted_loss: 0.0472, label: 0, bag_size: 855
batch 679, loss: 2.2447, instance_loss: 0.9283, weighted_loss: 1.8497, label: 0, bag_size: 2618
batch 699, loss: 1.0886, instance_loss: 0.8205, weighted_loss: 1.0081, label: 1, bag_size: 3611
batch 719, loss: 0.4498, instance_loss: 0.5410, weighted_loss: 0.4771, label: 0, bag_size: 2841
batch 739, loss: 0.0916, instance_loss: 0.5697, weighted_loss: 0.2350, label: 0, bag_size: 3872


class 0 clustering acc 0.9781879194630873: correct 17490/17880
class 1 clustering acc 0.22080536912751678: correct 1316/5960
Epoch: 11, train_loss: 0.6667, train_clustering_loss:  0.5913, train_error: 0.2725
class 0: acc 0.7814814814814814, correct 211/270
class 1: acc 0.5958333333333333, correct 143/240
class 2: acc 0.8, correct 188/235

Val Set, val_loss: 0.6067, val_error: 0.2447, auc: 0.8783
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.3816489361702128: correct 287/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.618147 --> 0.606672).  Saving model ...


batch 19, loss: 0.9728, instance_loss: 0.8280, weighted_loss: 0.9293, label: 1, bag_size: 1712
batch 39, loss: 0.1204, instance_loss: 0.2592, weighted_loss: 0.1621, label: 2, bag_size: 2422
batch 59, loss: 1.2667, instance_loss: 0.7641, weighted_loss: 1.1159, label: 1, bag_size: 1860
batch 79, loss: 0.1059, instance_loss: 0.3518, weighted_loss: 0.1797, label: 0, bag_size: 3690
batch 99, loss: 0.0838, instance_loss: 0.2963, weighted_loss: 0.1476, label: 0, bag_size: 1640
batch 119, loss: 0.6431, instance_loss: 0.7293, weighted_loss: 0.6689, label: 1, bag_size: 2182
batch 139, loss: 0.3269, instance_loss: 0.4809, weighted_loss: 0.3731, label: 2, bag_size: 1543
batch 159, loss: 0.5259, instance_loss: 0.5526, weighted_loss: 0.5339, label: 2, bag_size: 3618
batch 179, loss: 0.9686, instance_loss: 1.0266, weighted_loss: 0.9860, label: 0, bag_size: 6249
batch 199, loss: 1.6122, instance_loss: 0.7721, weighted_loss: 1.3601, label: 1, bag_size: 2859
batch 219, loss: 2.7171, instance_loss: 1.1741, weighted_loss: 2.2542, label: 2, bag_size: 223
batch 239, loss: 2.5095, instance_loss: 1.0027, weighted_loss: 2.0575, label: 0, bag_size: 2597
batch 259, loss: 0.9679, instance_loss: 0.6881, weighted_loss: 0.8840, label: 1, bag_size: 5011
batch 279, loss: 0.1564, instance_loss: 0.3064, weighted_loss: 0.2014, label: 1, bag_size: 8482
batch 299, loss: 0.3667, instance_loss: 0.4327, weighted_loss: 0.3865, label: 0, bag_size: 1640
batch 319, loss: 0.0996, instance_loss: 0.4639, weighted_loss: 0.2088, label: 1, bag_size: 5026
batch 339, loss: 0.6773, instance_loss: 0.4282, weighted_loss: 0.6026, label: 2, bag_size: 2561
batch 359, loss: 0.7222, instance_loss: 0.5401, weighted_loss: 0.6676, label: 1, bag_size: 5572
batch 379, loss: 0.1197, instance_loss: 0.2912, weighted_loss: 0.1712, label: 1, bag_size: 5084
batch 399, loss: 0.3140, instance_loss: 0.6619, weighted_loss: 0.4184, label: 1, bag_size: 3475
batch 419, loss: 0.0419, instance_loss: 0.2683, weighted_loss: 0.1098, label: 2, bag_size: 2483
batch 439, loss: 2.4588, instance_loss: 1.1492, weighted_loss: 2.0659, label: 1, bag_size: 32
batch 459, loss: 0.3258, instance_loss: 0.6978, weighted_loss: 0.4374, label: 0, bag_size: 3164
batch 479, loss: 0.1144, instance_loss: 0.2809, weighted_loss: 0.1643, label: 1, bag_size: 3367
batch 499, loss: 0.8043, instance_loss: 0.6099, weighted_loss: 0.7460, label: 1, bag_size: 6315
batch 519, loss: 0.9660, instance_loss: 0.4411, weighted_loss: 0.8085, label: 0, bag_size: 4245
batch 539, loss: 0.3753, instance_loss: 0.2912, weighted_loss: 0.3501, label: 2, bag_size: 597
batch 559, loss: 0.6111, instance_loss: 0.7355, weighted_loss: 0.6484, label: 0, bag_size: 4678
batch 579, loss: 1.9520, instance_loss: 0.9950, weighted_loss: 1.6649, label: 1, bag_size: 1595
batch 599, loss: 0.6245, instance_loss: 0.6122, weighted_loss: 0.6208, label: 2, bag_size: 3604
batch 619, loss: 0.8277, instance_loss: 0.6763, weighted_loss: 0.7823, label: 2, bag_size: 1513
batch 639, loss: 0.5594, instance_loss: 0.4719, weighted_loss: 0.5332, label: 1, bag_size: 3761
batch 659, loss: 1.9924, instance_loss: 1.2241, weighted_loss: 1.7619, label: 1, bag_size: 6717
batch 679, loss: 0.2651, instance_loss: 0.4847, weighted_loss: 0.3310, label: 0, bag_size: 1194
batch 699, loss: 0.3779, instance_loss: 0.4476, weighted_loss: 0.3988, label: 1, bag_size: 2998
batch 719, loss: 0.0547, instance_loss: 0.1375, weighted_loss: 0.0795, label: 2, bag_size: 3285
batch 739, loss: 0.0207, instance_loss: 0.1850, weighted_loss: 0.0700, label: 0, bag_size: 1647


class 0 clustering acc 0.9784675615212528: correct 17495/17880
class 1 clustering acc 0.24765100671140938: correct 1476/5960
Epoch: 12, train_loss: 0.7032, train_clustering_loss:  0.5924, train_error: 0.3114
class 0: acc 0.6958333333333333, correct 167/240
class 1: acc 0.627906976744186, correct 162/258
class 2: acc 0.7449392712550608, correct 184/247

Val Set, val_loss: 0.6826, val_error: 0.2660, auc: 0.8655
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.2712765957446808: correct 204/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.9778, instance_loss: 1.2886, weighted_loss: 2.4711, label: 0, bag_size: 3711
batch 39, loss: 0.1193, instance_loss: 0.2450, weighted_loss: 0.1570, label: 0, bag_size: 5006
batch 59, loss: 0.6211, instance_loss: 0.5911, weighted_loss: 0.6121, label: 2, bag_size: 3746
batch 79, loss: 0.7725, instance_loss: 0.6504, weighted_loss: 0.7359, label: 0, bag_size: 3475
batch 99, loss: 0.0810, instance_loss: 0.3398, weighted_loss: 0.1586, label: 0, bag_size: 5375
batch 119, loss: 0.0759, instance_loss: 0.2761, weighted_loss: 0.1360, label: 2, bag_size: 5037
batch 139, loss: 0.7985, instance_loss: 1.6251, weighted_loss: 1.0465, label: 1, bag_size: 4684
batch 159, loss: 3.6278, instance_loss: 1.5142, weighted_loss: 2.9937, label: 1, bag_size: 4258
batch 179, loss: 0.1327, instance_loss: 0.3197, weighted_loss: 0.1888, label: 0, bag_size: 2601
batch 199, loss: 1.1925, instance_loss: 1.0225, weighted_loss: 1.1415, label: 0, bag_size: 1808
batch 219, loss: 0.0465, instance_loss: 0.3722, weighted_loss: 0.1442, label: 1, bag_size: 425
batch 239, loss: 0.5268, instance_loss: 1.2665, weighted_loss: 0.7487, label: 1, bag_size: 5084
batch 259, loss: 0.8359, instance_loss: 0.8510, weighted_loss: 0.8404, label: 2, bag_size: 1222
batch 279, loss: 0.0064, instance_loss: 0.0485, weighted_loss: 0.0190, label: 1, bag_size: 5462
batch 299, loss: 0.4245, instance_loss: 0.3298, weighted_loss: 0.3961, label: 2, bag_size: 4096
batch 319, loss: 0.7302, instance_loss: 0.6286, weighted_loss: 0.6997, label: 1, bag_size: 3221
batch 339, loss: 0.8575, instance_loss: 0.6852, weighted_loss: 0.8058, label: 1, bag_size: 1500
batch 359, loss: 0.0444, instance_loss: 0.1114, weighted_loss: 0.0645, label: 1, bag_size: 6992
batch 379, loss: 0.0074, instance_loss: 0.2272, weighted_loss: 0.0733, label: 2, bag_size: 4497
batch 399, loss: 0.1517, instance_loss: 0.6749, weighted_loss: 0.3086, label: 0, bag_size: 4997
batch 419, loss: 0.1754, instance_loss: 0.5100, weighted_loss: 0.2758, label: 1, bag_size: 4684
batch 439, loss: 0.5764, instance_loss: 0.6461, weighted_loss: 0.5973, label: 1, bag_size: 6156
batch 459, loss: 0.7662, instance_loss: 0.7724, weighted_loss: 0.7681, label: 2, bag_size: 3607
batch 479, loss: 0.4026, instance_loss: 0.7140, weighted_loss: 0.4960, label: 2, bag_size: 22464
batch 499, loss: 1.0648, instance_loss: 0.6008, weighted_loss: 0.9256, label: 2, bag_size: 2501
batch 519, loss: 0.6918, instance_loss: 0.7577, weighted_loss: 0.7116, label: 1, bag_size: 14449
batch 539, loss: 0.0857, instance_loss: 0.1608, weighted_loss: 0.1082, label: 2, bag_size: 4691
batch 559, loss: 1.3352, instance_loss: 0.2635, weighted_loss: 1.0137, label: 2, bag_size: 88
batch 579, loss: 0.3403, instance_loss: 0.5393, weighted_loss: 0.4000, label: 1, bag_size: 209
batch 599, loss: 2.2030, instance_loss: 0.7968, weighted_loss: 1.7812, label: 0, bag_size: 3387
batch 619, loss: 0.0293, instance_loss: 0.2455, weighted_loss: 0.0942, label: 2, bag_size: 4569
batch 639, loss: 1.1599, instance_loss: 0.6428, weighted_loss: 1.0048, label: 0, bag_size: 726
batch 659, loss: 0.8290, instance_loss: 0.8700, weighted_loss: 0.8413, label: 1, bag_size: 1510
batch 679, loss: 0.4608, instance_loss: 0.2600, weighted_loss: 0.4006, label: 2, bag_size: 4691
batch 699, loss: 0.0250, instance_loss: 0.1568, weighted_loss: 0.0645, label: 1, bag_size: 862
batch 719, loss: 0.0942, instance_loss: 0.4067, weighted_loss: 0.1880, label: 2, bag_size: 6001
batch 739, loss: 0.1100, instance_loss: 0.4327, weighted_loss: 0.2068, label: 2, bag_size: 4497


class 0 clustering acc 0.9772371364653244: correct 17473/17880
class 1 clustering acc 0.28053691275167786: correct 1672/5960
Epoch: 13, train_loss: 0.6686, train_clustering_loss:  0.5817, train_error: 0.2980
class 0: acc 0.7333333333333333, correct 176/240
class 1: acc 0.6, correct 144/240
class 2: acc 0.7660377358490567, correct 203/265

Val Set, val_loss: 0.6836, val_error: 0.2553, auc: 0.8732
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.2300531914893617: correct 173/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0194, instance_loss: 0.6562, weighted_loss: 0.9104, label: 1, bag_size: 1066
batch 39, loss: 0.7149, instance_loss: 0.5405, weighted_loss: 0.6626, label: 1, bag_size: 4373
batch 59, loss: 0.1017, instance_loss: 0.2163, weighted_loss: 0.1361, label: 2, bag_size: 4569
batch 79, loss: 2.0360, instance_loss: 0.8734, weighted_loss: 1.6872, label: 2, bag_size: 552
batch 99, loss: 0.4581, instance_loss: 0.3666, weighted_loss: 0.4307, label: 2, bag_size: 3678
batch 119, loss: 0.1408, instance_loss: 0.2721, weighted_loss: 0.1802, label: 0, bag_size: 3367
batch 139, loss: 0.0792, instance_loss: 0.2134, weighted_loss: 0.1195, label: 2, bag_size: 2481
batch 159, loss: 0.1553, instance_loss: 0.3742, weighted_loss: 0.2210, label: 1, bag_size: 1599
batch 179, loss: 0.0404, instance_loss: 0.8944, weighted_loss: 0.2966, label: 0, bag_size: 3298
batch 199, loss: 1.3455, instance_loss: 0.9809, weighted_loss: 1.2361, label: 0, bag_size: 5840
batch 219, loss: 0.2966, instance_loss: 0.6670, weighted_loss: 0.4078, label: 0, bag_size: 5011
batch 239, loss: 2.4282, instance_loss: 1.3261, weighted_loss: 2.0976, label: 2, bag_size: 3475
batch 259, loss: 0.2675, instance_loss: 0.3600, weighted_loss: 0.2953, label: 1, bag_size: 4684
batch 279, loss: 1.3208, instance_loss: 0.9016, weighted_loss: 1.1951, label: 0, bag_size: 6445
batch 299, loss: 2.0398, instance_loss: 1.5634, weighted_loss: 1.8969, label: 0, bag_size: 1753
batch 319, loss: 0.9270, instance_loss: 0.5911, weighted_loss: 0.8262, label: 1, bag_size: 800
batch 339, loss: 0.4736, instance_loss: 0.5405, weighted_loss: 0.4937, label: 2, bag_size: 22464
batch 359, loss: 1.7187, instance_loss: 0.9023, weighted_loss: 1.4738, label: 0, bag_size: 3419
batch 379, loss: 0.1496, instance_loss: 0.3926, weighted_loss: 0.2225, label: 2, bag_size: 4978
batch 399, loss: 0.2346, instance_loss: 0.4141, weighted_loss: 0.2884, label: 2, bag_size: 5406
batch 419, loss: 1.4013, instance_loss: 1.1950, weighted_loss: 1.3394, label: 0, bag_size: 477
batch 439, loss: 1.3844, instance_loss: 1.1030, weighted_loss: 1.3000, label: 0, bag_size: 1755
batch 459, loss: 0.7088, instance_loss: 0.5682, weighted_loss: 0.6666, label: 1, bag_size: 2919
batch 479, loss: 0.0754, instance_loss: 0.1002, weighted_loss: 0.0829, label: 2, bag_size: 657
batch 499, loss: 0.1081, instance_loss: 0.4372, weighted_loss: 0.2068, label: 1, bag_size: 3127
batch 519, loss: 1.3956, instance_loss: 1.0418, weighted_loss: 1.2894, label: 2, bag_size: 724
batch 539, loss: 1.5796, instance_loss: 1.1990, weighted_loss: 1.4654, label: 0, bag_size: 1052
batch 559, loss: 1.7923, instance_loss: 0.7116, weighted_loss: 1.4681, label: 0, bag_size: 2217
batch 579, loss: 0.1433, instance_loss: 0.2384, weighted_loss: 0.1718, label: 2, bag_size: 4302
batch 599, loss: 0.0716, instance_loss: 0.2207, weighted_loss: 0.1163, label: 2, bag_size: 3327
batch 619, loss: 0.7014, instance_loss: 0.4717, weighted_loss: 0.6325, label: 2, bag_size: 5406
batch 639, loss: 2.5681, instance_loss: 0.9540, weighted_loss: 2.0839, label: 1, bag_size: 5035
batch 659, loss: 0.4618, instance_loss: 0.2442, weighted_loss: 0.3965, label: 2, bag_size: 3583
batch 679, loss: 0.1743, instance_loss: 0.1632, weighted_loss: 0.1710, label: 1, bag_size: 6475
batch 699, loss: 1.3847, instance_loss: 0.7974, weighted_loss: 1.2085, label: 0, bag_size: 3661
batch 719, loss: 0.7674, instance_loss: 0.5510, weighted_loss: 0.7025, label: 1, bag_size: 3604
batch 739, loss: 0.2184, instance_loss: 0.5038, weighted_loss: 0.3041, label: 0, bag_size: 6927


class 0 clustering acc 0.980089485458613: correct 17524/17880
class 1 clustering acc 0.27181208053691275: correct 1620/5960
Epoch: 14, train_loss: 0.6788, train_clustering_loss:  0.5786, train_error: 0.2966
class 0: acc 0.7072072072072072, correct 157/222
class 1: acc 0.640926640926641, correct 166/259
class 2: acc 0.7613636363636364, correct 201/264

Val Set, val_loss: 0.6893, val_error: 0.2766, auc: 0.8734
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.23404255319148937: correct 176/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6017, instance_loss: 0.4459, weighted_loss: 0.5549, label: 2, bag_size: 2049
batch 39, loss: 1.3467, instance_loss: 1.0436, weighted_loss: 1.2557, label: 1, bag_size: 2927
batch 59, loss: 0.6603, instance_loss: 1.0760, weighted_loss: 0.7850, label: 1, bag_size: 314
batch 79, loss: 0.2344, instance_loss: 0.2819, weighted_loss: 0.2487, label: 1, bag_size: 4599
batch 99, loss: 0.1170, instance_loss: 0.1442, weighted_loss: 0.1252, label: 2, bag_size: 597
batch 119, loss: 1.4219, instance_loss: 1.2793, weighted_loss: 1.3791, label: 1, bag_size: 1670
batch 139, loss: 0.1197, instance_loss: 0.1970, weighted_loss: 0.1429, label: 0, bag_size: 5337
batch 159, loss: 0.2372, instance_loss: 0.2479, weighted_loss: 0.2404, label: 2, bag_size: 2422
batch 179, loss: 0.3625, instance_loss: 0.3987, weighted_loss: 0.3734, label: 1, bag_size: 700
batch 199, loss: 0.4708, instance_loss: 0.3369, weighted_loss: 0.4307, label: 2, bag_size: 3227
batch 219, loss: 0.8869, instance_loss: 0.6626, weighted_loss: 0.8196, label: 0, bag_size: 4717
batch 239, loss: 0.2798, instance_loss: 0.4459, weighted_loss: 0.3296, label: 2, bag_size: 4302
batch 259, loss: 0.0897, instance_loss: 0.2186, weighted_loss: 0.1283, label: 2, bag_size: 597
batch 279, loss: 0.1919, instance_loss: 0.3190, weighted_loss: 0.2300, label: 1, bag_size: 3221
batch 299, loss: 1.5676, instance_loss: 0.5644, weighted_loss: 1.2666, label: 0, bag_size: 4245
batch 319, loss: 0.4484, instance_loss: 0.6243, weighted_loss: 0.5012, label: 1, bag_size: 5195
batch 339, loss: 0.5088, instance_loss: 0.5521, weighted_loss: 0.5218, label: 2, bag_size: 4535
batch 359, loss: 0.0181, instance_loss: 0.2334, weighted_loss: 0.0827, label: 1, bag_size: 3677
batch 379, loss: 0.8971, instance_loss: 0.6347, weighted_loss: 0.8184, label: 2, bag_size: 6644
batch 399, loss: 0.3470, instance_loss: 0.2832, weighted_loss: 0.3279, label: 2, bag_size: 4096
batch 419, loss: 0.0911, instance_loss: 0.4092, weighted_loss: 0.1865, label: 2, bag_size: 4487
batch 439, loss: 1.3101, instance_loss: 0.7575, weighted_loss: 1.1443, label: 2, bag_size: 3604
batch 459, loss: 0.5351, instance_loss: 0.4685, weighted_loss: 0.5151, label: 0, bag_size: 4909
batch 479, loss: 0.5984, instance_loss: 0.5401, weighted_loss: 0.5809, label: 1, bag_size: 4438
batch 499, loss: 1.6609, instance_loss: 0.7001, weighted_loss: 1.3726, label: 0, bag_size: 7056
batch 519, loss: 0.4937, instance_loss: 0.7260, weighted_loss: 0.5634, label: 1, bag_size: 5003
batch 539, loss: 0.9649, instance_loss: 0.8873, weighted_loss: 0.9416, label: 0, bag_size: 1709
batch 559, loss: 1.3875, instance_loss: 0.8814, weighted_loss: 1.2357, label: 1, bag_size: 574
batch 579, loss: 0.3271, instance_loss: 0.5440, weighted_loss: 0.3922, label: 0, bag_size: 1883
batch 599, loss: 0.1989, instance_loss: 0.1608, weighted_loss: 0.1875, label: 2, bag_size: 4056
batch 619, loss: 0.9417, instance_loss: 0.6600, weighted_loss: 0.8572, label: 2, bag_size: 4569
batch 639, loss: 0.1140, instance_loss: 0.3270, weighted_loss: 0.1779, label: 1, bag_size: 2453
batch 659, loss: 0.0405, instance_loss: 0.4560, weighted_loss: 0.1651, label: 1, bag_size: 5760
batch 679, loss: 0.3687, instance_loss: 0.5826, weighted_loss: 0.4329, label: 0, bag_size: 4416
batch 699, loss: 0.2242, instance_loss: 0.3113, weighted_loss: 0.2503, label: 1, bag_size: 1221
batch 719, loss: 0.8459, instance_loss: 0.8827, weighted_loss: 0.8569, label: 1, bag_size: 3791
batch 739, loss: 0.3322, instance_loss: 0.3513, weighted_loss: 0.3379, label: 2, bag_size: 4043


class 0 clustering acc 0.9768456375838926: correct 17466/17880
class 1 clustering acc 0.22818791946308725: correct 1360/5960
Epoch: 15, train_loss: 0.7063, train_clustering_loss:  0.6044, train_error: 0.2966
class 0: acc 0.7003891050583657, correct 180/257
class 1: acc 0.6374501992031872, correct 160/251
class 2: acc 0.7763713080168776, correct 184/237

Val Set, val_loss: 0.6513, val_error: 0.2234, auc: 0.8740
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.25132978723404253: correct 189/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0070, instance_loss: 0.0059, weighted_loss: 0.0067, label: 0, bag_size: 5003
batch 39, loss: 0.3053, instance_loss: 0.4344, weighted_loss: 0.3440, label: 0, bag_size: 1545
batch 59, loss: 0.6369, instance_loss: 0.5558, weighted_loss: 0.6126, label: 1, bag_size: 2156
batch 79, loss: 1.5058, instance_loss: 0.7694, weighted_loss: 1.2849, label: 0, bag_size: 4032
batch 99, loss: 0.6186, instance_loss: 0.3033, weighted_loss: 0.5240, label: 2, bag_size: 4056
batch 119, loss: 0.8725, instance_loss: 0.6817, weighted_loss: 0.8152, label: 1, bag_size: 2248
batch 139, loss: 0.2987, instance_loss: 0.4224, weighted_loss: 0.3358, label: 2, bag_size: 5914
batch 159, loss: 0.1603, instance_loss: 0.3595, weighted_loss: 0.2200, label: 1, bag_size: 3156
batch 179, loss: 0.9400, instance_loss: 0.5547, weighted_loss: 0.8244, label: 1, bag_size: 2753
batch 199, loss: 2.4958, instance_loss: 1.5006, weighted_loss: 2.1972, label: 2, bag_size: 4241
batch 219, loss: 0.0290, instance_loss: 0.1295, weighted_loss: 0.0591, label: 2, bag_size: 3285
batch 239, loss: 0.8199, instance_loss: 0.6331, weighted_loss: 0.7639, label: 1, bag_size: 4184
batch 259, loss: 0.4330, instance_loss: 0.2117, weighted_loss: 0.3666, label: 1, bag_size: 1712
batch 279, loss: 0.0337, instance_loss: 0.3936, weighted_loss: 0.1417, label: 0, bag_size: 3920
batch 299, loss: 0.4233, instance_loss: 0.7530, weighted_loss: 0.5222, label: 0, bag_size: 3833
batch 319, loss: 0.1022, instance_loss: 0.1139, weighted_loss: 0.1057, label: 2, bag_size: 4056
batch 339, loss: 0.1590, instance_loss: 0.4972, weighted_loss: 0.2605, label: 2, bag_size: 5017
batch 359, loss: 0.3861, instance_loss: 0.4952, weighted_loss: 0.4188, label: 0, bag_size: 1353
batch 379, loss: 0.1045, instance_loss: 0.3868, weighted_loss: 0.1892, label: 0, bag_size: 3367
batch 399, loss: 0.9580, instance_loss: 0.5222, weighted_loss: 0.8273, label: 1, bag_size: 4262
batch 419, loss: 0.4711, instance_loss: 0.6495, weighted_loss: 0.5246, label: 0, bag_size: 1883
batch 439, loss: 0.2694, instance_loss: 0.2736, weighted_loss: 0.2707, label: 2, bag_size: 3210
batch 459, loss: 0.8743, instance_loss: 0.7215, weighted_loss: 0.8284, label: 0, bag_size: 313
batch 479, loss: 3.1704, instance_loss: 0.9245, weighted_loss: 2.4966, label: 0, bag_size: 4310
batch 499, loss: 0.1525, instance_loss: 0.1791, weighted_loss: 0.1605, label: 2, bag_size: 3397
batch 519, loss: 0.4436, instance_loss: 0.9966, weighted_loss: 0.6095, label: 0, bag_size: 1981
batch 539, loss: 0.3811, instance_loss: 0.5515, weighted_loss: 0.4322, label: 0, bag_size: 4485
batch 559, loss: 0.3277, instance_loss: 0.5012, weighted_loss: 0.3798, label: 1, bag_size: 3534
batch 579, loss: 2.0365, instance_loss: 1.4752, weighted_loss: 1.8681, label: 1, bag_size: 5205
batch 599, loss: 0.1105, instance_loss: 0.2902, weighted_loss: 0.1644, label: 2, bag_size: 4555
batch 619, loss: 0.2295, instance_loss: 0.5556, weighted_loss: 0.3273, label: 0, bag_size: 4416
batch 639, loss: 0.2500, instance_loss: 0.3396, weighted_loss: 0.2769, label: 1, bag_size: 3156
batch 659, loss: 1.4823, instance_loss: 1.0100, weighted_loss: 1.3406, label: 2, bag_size: 2326
batch 679, loss: 0.7225, instance_loss: 0.3616, weighted_loss: 0.6143, label: 2, bag_size: 2031
batch 699, loss: 1.9055, instance_loss: 0.9131, weighted_loss: 1.6078, label: 2, bag_size: 223
batch 719, loss: 0.1493, instance_loss: 0.3122, weighted_loss: 0.1982, label: 2, bag_size: 1094
batch 739, loss: 0.1421, instance_loss: 0.3460, weighted_loss: 0.2032, label: 0, bag_size: 4734


class 0 clustering acc 0.9752237136465325: correct 17437/17880
class 1 clustering acc 0.25956375838926177: correct 1547/5960
Epoch: 16, train_loss: 0.6451, train_clustering_loss:  0.5818, train_error: 0.2805
class 0: acc 0.7829457364341085, correct 202/258
class 1: acc 0.6033755274261603, correct 143/237
class 2: acc 0.764, correct 191/250

Val Set, val_loss: 0.6880, val_error: 0.2766, auc: 0.8808
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.1901595744680851: correct 143/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.3630, instance_loss: 0.8691, weighted_loss: 1.2148, label: 2, bag_size: 3274
batch 39, loss: 0.6074, instance_loss: 0.5706, weighted_loss: 0.5963, label: 1, bag_size: 4940
batch 59, loss: 0.1794, instance_loss: 0.5180, weighted_loss: 0.2809, label: 2, bag_size: 5017
batch 79, loss: 3.0897, instance_loss: 1.5108, weighted_loss: 2.6160, label: 1, bag_size: 3159
batch 99, loss: 0.3141, instance_loss: 0.5800, weighted_loss: 0.3939, label: 1, bag_size: 3007
batch 119, loss: 0.2280, instance_loss: 0.2900, weighted_loss: 0.2466, label: 0, bag_size: 1782
batch 139, loss: 1.9672, instance_loss: 1.2346, weighted_loss: 1.7474, label: 2, bag_size: 3475
batch 159, loss: 4.5019, instance_loss: 1.5459, weighted_loss: 3.6151, label: 0, bag_size: 12971
batch 179, loss: 0.0422, instance_loss: 0.0754, weighted_loss: 0.0522, label: 2, bag_size: 2483
batch 199, loss: 0.0821, instance_loss: 0.2317, weighted_loss: 0.1270, label: 1, bag_size: 425
batch 219, loss: 0.1177, instance_loss: 0.1809, weighted_loss: 0.1366, label: 2, bag_size: 3285
batch 239, loss: 1.3385, instance_loss: 0.9723, weighted_loss: 1.2286, label: 1, bag_size: 5926
batch 259, loss: 0.0711, instance_loss: 0.5955, weighted_loss: 0.2284, label: 0, bag_size: 3872
batch 279, loss: 0.2595, instance_loss: 0.4198, weighted_loss: 0.3076, label: 0, bag_size: 4894
batch 299, loss: 0.1299, instance_loss: 0.2730, weighted_loss: 0.1728, label: 2, bag_size: 5138
batch 319, loss: 0.5815, instance_loss: 0.9446, weighted_loss: 0.6904, label: 2, bag_size: 3299
batch 339, loss: 1.2169, instance_loss: 0.4839, weighted_loss: 0.9970, label: 0, bag_size: 3475
batch 359, loss: 0.6947, instance_loss: 0.5279, weighted_loss: 0.6447, label: 0, bag_size: 5848
batch 379, loss: 0.1379, instance_loss: 0.6936, weighted_loss: 0.3046, label: 0, bag_size: 996
batch 399, loss: 1.5634, instance_loss: 0.9571, weighted_loss: 1.3816, label: 0, bag_size: 436
batch 419, loss: 1.4937, instance_loss: 0.8675, weighted_loss: 1.3059, label: 2, bag_size: 5406
batch 439, loss: 0.4609, instance_loss: 0.3764, weighted_loss: 0.4356, label: 0, bag_size: 3224
batch 459, loss: 0.0110, instance_loss: 0.4059, weighted_loss: 0.1295, label: 0, bag_size: 2354
batch 479, loss: 0.0565, instance_loss: 0.2757, weighted_loss: 0.1222, label: 0, bag_size: 6015
batch 499, loss: 0.0978, instance_loss: 0.3805, weighted_loss: 0.1826, label: 2, bag_size: 2313
batch 519, loss: 0.8767, instance_loss: 0.8343, weighted_loss: 0.8640, label: 2, bag_size: 1222
batch 539, loss: 0.2753, instance_loss: 0.3250, weighted_loss: 0.2902, label: 2, bag_size: 4192
batch 559, loss: 0.4154, instance_loss: 0.7551, weighted_loss: 0.5173, label: 1, bag_size: 7176
batch 579, loss: 0.2463, instance_loss: 0.5319, weighted_loss: 0.3320, label: 0, bag_size: 1034
batch 599, loss: 0.1119, instance_loss: 0.1432, weighted_loss: 0.1213, label: 0, bag_size: 2019
batch 619, loss: 0.1217, instance_loss: 0.3344, weighted_loss: 0.1855, label: 2, bag_size: 3121
batch 639, loss: 2.6052, instance_loss: 1.2419, weighted_loss: 2.1962, label: 1, bag_size: 5072
batch 659, loss: 0.1686, instance_loss: 0.3579, weighted_loss: 0.2254, label: 1, bag_size: 3983
batch 679, loss: 0.0089, instance_loss: 0.1491, weighted_loss: 0.0509, label: 1, bag_size: 4111
batch 699, loss: 0.7035, instance_loss: 0.7767, weighted_loss: 0.7255, label: 1, bag_size: 2481
batch 719, loss: 1.2672, instance_loss: 0.9122, weighted_loss: 1.1607, label: 1, bag_size: 3184
batch 739, loss: 0.0673, instance_loss: 0.2034, weighted_loss: 0.1081, label: 1, bag_size: 2870


class 0 clustering acc 0.9701901565995525: correct 17347/17880
class 1 clustering acc 0.3144295302013423: correct 1874/5960
Epoch: 17, train_loss: 0.6539, train_clustering_loss:  0.5689, train_error: 0.2872
class 0: acc 0.8015267175572519, correct 210/262
class 1: acc 0.5391304347826087, correct 124/230
class 2: acc 0.7786561264822134, correct 197/253

Val Set, val_loss: 0.6523, val_error: 0.2340, auc: 0.8804
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.2646276595744681: correct 199/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3581, instance_loss: 0.5777, weighted_loss: 0.4240, label: 0, bag_size: 4071
batch 39, loss: 0.4383, instance_loss: 0.4689, weighted_loss: 0.4475, label: 1, bag_size: 3225
batch 59, loss: 0.1246, instance_loss: 0.2750, weighted_loss: 0.1697, label: 2, bag_size: 5037
batch 79, loss: 0.4514, instance_loss: 0.6102, weighted_loss: 0.4990, label: 2, bag_size: 22464
batch 99, loss: 1.0599, instance_loss: 0.7772, weighted_loss: 0.9751, label: 1, bag_size: 2156
batch 119, loss: 0.1451, instance_loss: 0.5963, weighted_loss: 0.2805, label: 0, bag_size: 5519
batch 139, loss: 0.9994, instance_loss: 0.7433, weighted_loss: 0.9226, label: 1, bag_size: 1607
batch 159, loss: 0.4997, instance_loss: 0.5684, weighted_loss: 0.5203, label: 2, bag_size: 7607
batch 179, loss: 0.1108, instance_loss: 0.2391, weighted_loss: 0.1493, label: 2, bag_size: 4555
batch 199, loss: 1.7839, instance_loss: 1.0283, weighted_loss: 1.5572, label: 2, bag_size: 728
batch 219, loss: 0.0436, instance_loss: 0.1819, weighted_loss: 0.0851, label: 0, bag_size: 2873
batch 239, loss: 0.0937, instance_loss: 0.1726, weighted_loss: 0.1174, label: 0, bag_size: 1399
batch 259, loss: 0.8362, instance_loss: 0.7651, weighted_loss: 0.8149, label: 1, bag_size: 6817
batch 279, loss: 3.7837, instance_loss: 1.8450, weighted_loss: 3.2021, label: 2, bag_size: 4179
batch 299, loss: 0.0346, instance_loss: 0.1615, weighted_loss: 0.0727, label: 2, bag_size: 3397
batch 319, loss: 0.6154, instance_loss: 0.7951, weighted_loss: 0.6693, label: 0, bag_size: 3675
batch 339, loss: 0.8782, instance_loss: 0.5293, weighted_loss: 0.7735, label: 2, bag_size: 6298
batch 359, loss: 0.1556, instance_loss: 0.3750, weighted_loss: 0.2214, label: 1, bag_size: 3357
batch 379, loss: 0.0900, instance_loss: 0.4999, weighted_loss: 0.2130, label: 0, bag_size: 1176
batch 399, loss: 0.0474, instance_loss: 0.2483, weighted_loss: 0.1077, label: 1, bag_size: 3007
batch 419, loss: 0.2086, instance_loss: 0.4227, weighted_loss: 0.2729, label: 0, bag_size: 3113
batch 439, loss: 0.0991, instance_loss: 0.5534, weighted_loss: 0.2354, label: 2, bag_size: 4141
batch 459, loss: 0.2149, instance_loss: 0.3427, weighted_loss: 0.2532, label: 0, bag_size: 4707
batch 479, loss: 1.3384, instance_loss: 0.9811, weighted_loss: 1.2312, label: 1, bag_size: 817
batch 499, loss: 0.1025, instance_loss: 0.2726, weighted_loss: 0.1535, label: 2, bag_size: 4302
batch 519, loss: 3.3221, instance_loss: 1.8468, weighted_loss: 2.8795, label: 0, bag_size: 11141
batch 539, loss: 0.3900, instance_loss: 0.5088, weighted_loss: 0.4256, label: 2, bag_size: 5037
batch 559, loss: 0.5937, instance_loss: 0.5245, weighted_loss: 0.5730, label: 2, bag_size: 909
batch 579, loss: 0.5391, instance_loss: 0.7385, weighted_loss: 0.5989, label: 0, bag_size: 2915
batch 599, loss: 0.1268, instance_loss: 0.4476, weighted_loss: 0.2231, label: 0, bag_size: 5646
batch 619, loss: 0.0834, instance_loss: 0.3090, weighted_loss: 0.1511, label: 2, bag_size: 6026
batch 639, loss: 0.8976, instance_loss: 0.7497, weighted_loss: 0.8532, label: 1, bag_size: 4200
batch 659, loss: 0.2915, instance_loss: 0.6120, weighted_loss: 0.3877, label: 0, bag_size: 1417
batch 679, loss: 0.5163, instance_loss: 0.3465, weighted_loss: 0.4654, label: 1, bag_size: 2865
batch 699, loss: 0.1021, instance_loss: 0.2987, weighted_loss: 0.1611, label: 0, bag_size: 3289
batch 719, loss: 0.5357, instance_loss: 0.7476, weighted_loss: 0.5992, label: 0, bag_size: 5585
batch 739, loss: 0.7456, instance_loss: 0.5314, weighted_loss: 0.6813, label: 0, bag_size: 4547


class 0 clustering acc 0.9675055928411633: correct 17299/17880
class 1 clustering acc 0.32667785234899327: correct 1947/5960
Epoch: 18, train_loss: 0.6468, train_clustering_loss:  0.5803, train_error: 0.2913
class 0: acc 0.7602996254681648, correct 203/267
class 1: acc 0.6163265306122448, correct 151/245
class 2: acc 0.7467811158798283, correct 174/233

Val Set, val_loss: 0.6554, val_error: 0.2660, auc: 0.8610
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.375: correct 282/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.4631, instance_loss: 0.8955, weighted_loss: 1.2929, label: 1, bag_size: 2744
batch 39, loss: 2.2734, instance_loss: 0.9563, weighted_loss: 1.8783, label: 2, bag_size: 361
batch 59, loss: 0.9752, instance_loss: 0.4803, weighted_loss: 0.8267, label: 1, bag_size: 5423
batch 79, loss: 0.4377, instance_loss: 0.5841, weighted_loss: 0.4816, label: 0, bag_size: 1385
batch 99, loss: 0.4964, instance_loss: 0.5751, weighted_loss: 0.5200, label: 1, bag_size: 4184
batch 119, loss: 0.0719, instance_loss: 0.1304, weighted_loss: 0.0894, label: 0, bag_size: 4015
batch 139, loss: 1.7342, instance_loss: 1.0171, weighted_loss: 1.5191, label: 2, bag_size: 223
batch 159, loss: 0.1144, instance_loss: 0.1466, weighted_loss: 0.1241, label: 2, bag_size: 6644
batch 179, loss: 0.0358, instance_loss: 0.0942, weighted_loss: 0.0534, label: 2, bag_size: 4056
batch 199, loss: 0.2166, instance_loss: 0.6346, weighted_loss: 0.3420, label: 0, bag_size: 667
batch 219, loss: 0.1998, instance_loss: 0.4053, weighted_loss: 0.2614, label: 0, bag_size: 5646
batch 239, loss: 0.1919, instance_loss: 0.4382, weighted_loss: 0.2658, label: 2, bag_size: 614
batch 259, loss: 0.0999, instance_loss: 0.3002, weighted_loss: 0.1600, label: 0, bag_size: 5236
batch 279, loss: 0.5032, instance_loss: 0.6361, weighted_loss: 0.5431, label: 1, bag_size: 2945
batch 299, loss: 0.2811, instance_loss: 0.4866, weighted_loss: 0.3428, label: 1, bag_size: 1027
batch 319, loss: 0.9564, instance_loss: 0.7012, weighted_loss: 0.8798, label: 1, bag_size: 1161
batch 339, loss: 0.2819, instance_loss: 0.3987, weighted_loss: 0.3169, label: 0, bag_size: 5890
batch 359, loss: 0.4891, instance_loss: 0.8010, weighted_loss: 0.5827, label: 0, bag_size: 1176
batch 379, loss: 0.3393, instance_loss: 0.4384, weighted_loss: 0.3690, label: 0, bag_size: 1645
batch 399, loss: 0.1166, instance_loss: 0.3329, weighted_loss: 0.1815, label: 0, bag_size: 4165
batch 419, loss: 1.6549, instance_loss: 1.1521, weighted_loss: 1.5041, label: 1, bag_size: 1327
batch 439, loss: 0.3456, instance_loss: 0.4612, weighted_loss: 0.3803, label: 2, bag_size: 3174
batch 459, loss: 0.2067, instance_loss: 0.3150, weighted_loss: 0.2392, label: 2, bag_size: 3227
batch 479, loss: 0.5490, instance_loss: 0.2387, weighted_loss: 0.4559, label: 2, bag_size: 705
batch 499, loss: 0.2509, instance_loss: 1.1525, weighted_loss: 0.5214, label: 1, bag_size: 314
batch 519, loss: 0.1389, instance_loss: 0.1705, weighted_loss: 0.1484, label: 2, bag_size: 597
batch 539, loss: 0.3961, instance_loss: 0.8721, weighted_loss: 0.5389, label: 0, bag_size: 2028
batch 559, loss: 0.4838, instance_loss: 0.7461, weighted_loss: 0.5625, label: 1, bag_size: 3519
batch 579, loss: 0.4256, instance_loss: 0.3215, weighted_loss: 0.3944, label: 2, bag_size: 4096
batch 599, loss: 0.0485, instance_loss: 0.2245, weighted_loss: 0.1013, label: 0, bag_size: 1234
batch 619, loss: 0.6657, instance_loss: 0.5348, weighted_loss: 0.6264, label: 2, bag_size: 2813
batch 639, loss: 0.2855, instance_loss: 0.2568, weighted_loss: 0.2769, label: 2, bag_size: 2997
batch 659, loss: 1.7127, instance_loss: 1.1173, weighted_loss: 1.5340, label: 1, bag_size: 1670
batch 679, loss: 1.8011, instance_loss: 0.8452, weighted_loss: 1.5143, label: 1, bag_size: 32
batch 699, loss: 0.4638, instance_loss: 0.4765, weighted_loss: 0.4676, label: 1, bag_size: 4346
batch 719, loss: 0.2459, instance_loss: 0.5927, weighted_loss: 0.3500, label: 0, bag_size: 2069
batch 739, loss: 0.9054, instance_loss: 1.1037, weighted_loss: 0.9649, label: 0, bag_size: 4509


class 0 clustering acc 0.9766219239373601: correct 17462/17880
class 1 clustering acc 0.2854026845637584: correct 1701/5960
Epoch: 19, train_loss: 0.6601, train_clustering_loss:  0.5754, train_error: 0.2859
class 0: acc 0.7579365079365079, correct 191/252
class 1: acc 0.5606694560669456, correct 134/239
class 2: acc 0.8149606299212598, correct 207/254

Val Set, val_loss: 0.8233, val_error: 0.3191, auc: 0.8562
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.1276595744680851: correct 96/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5153, instance_loss: 0.3637, weighted_loss: 0.4698, label: 1, bag_size: 2753
batch 39, loss: 0.0656, instance_loss: 0.1584, weighted_loss: 0.0934, label: 1, bag_size: 2254
batch 59, loss: 1.5195, instance_loss: 1.0738, weighted_loss: 1.3858, label: 0, bag_size: 1025
batch 79, loss: 1.7110, instance_loss: 1.2222, weighted_loss: 1.5644, label: 0, bag_size: 1753
batch 99, loss: 0.0211, instance_loss: 0.1036, weighted_loss: 0.0459, label: 2, bag_size: 3121
batch 119, loss: 0.2138, instance_loss: 0.7927, weighted_loss: 0.3875, label: 0, bag_size: 3164
batch 139, loss: 0.1116, instance_loss: 0.4560, weighted_loss: 0.2149, label: 0, bag_size: 4326
batch 159, loss: 0.7438, instance_loss: 0.8390, weighted_loss: 0.7724, label: 1, bag_size: 302
batch 179, loss: 0.8218, instance_loss: 0.7898, weighted_loss: 0.8122, label: 1, bag_size: 5276
batch 199, loss: 1.8765, instance_loss: 1.3511, weighted_loss: 1.7189, label: 0, bag_size: 609
batch 219, loss: 0.4280, instance_loss: 0.4318, weighted_loss: 0.4291, label: 0, bag_size: 1052
batch 239, loss: 0.0772, instance_loss: 0.2787, weighted_loss: 0.1376, label: 0, bag_size: 2873
batch 259, loss: 0.7918, instance_loss: 0.7031, weighted_loss: 0.7652, label: 1, bag_size: 4812
batch 279, loss: 1.4768, instance_loss: 0.8884, weighted_loss: 1.3003, label: 1, bag_size: 1327
batch 299, loss: 0.0784, instance_loss: 0.1115, weighted_loss: 0.0883, label: 2, bag_size: 4203
batch 319, loss: 0.3264, instance_loss: 0.5618, weighted_loss: 0.3970, label: 0, bag_size: 1492
batch 339, loss: 1.9475, instance_loss: 1.1123, weighted_loss: 1.6969, label: 2, bag_size: 724
batch 359, loss: 0.4813, instance_loss: 0.4187, weighted_loss: 0.4625, label: 2, bag_size: 3227
batch 379, loss: 0.8032, instance_loss: 0.5503, weighted_loss: 0.7273, label: 2, bag_size: 6298
batch 399, loss: 1.6058, instance_loss: 0.6823, weighted_loss: 1.3288, label: 1, bag_size: 3261
batch 419, loss: 0.3878, instance_loss: 0.3603, weighted_loss: 0.3795, label: 2, bag_size: 2049
batch 439, loss: 0.0645, instance_loss: 0.2244, weighted_loss: 0.1124, label: 2, bag_size: 5138
batch 459, loss: 1.1949, instance_loss: 0.6585, weighted_loss: 1.0340, label: 0, bag_size: 1695
batch 479, loss: 0.0617, instance_loss: 0.1772, weighted_loss: 0.0963, label: 2, bag_size: 2483
batch 499, loss: 1.7756, instance_loss: 1.7411, weighted_loss: 1.7653, label: 1, bag_size: 1477
batch 519, loss: 0.8602, instance_loss: 0.5554, weighted_loss: 0.7688, label: 2, bag_size: 5426
batch 539, loss: 0.0219, instance_loss: 0.0398, weighted_loss: 0.0272, label: 2, bag_size: 3415
batch 559, loss: 0.0316, instance_loss: 0.2959, weighted_loss: 0.1109, label: 0, bag_size: 4326
batch 579, loss: 0.9523, instance_loss: 0.6229, weighted_loss: 0.8535, label: 0, bag_size: 2428
batch 599, loss: 0.4553, instance_loss: 0.6919, weighted_loss: 0.5263, label: 1, bag_size: 4824
batch 619, loss: 1.9776, instance_loss: 1.3001, weighted_loss: 1.7743, label: 2, bag_size: 4179
batch 639, loss: 1.0950, instance_loss: 1.0216, weighted_loss: 1.0729, label: 1, bag_size: 1364
batch 659, loss: 0.5635, instance_loss: 0.5518, weighted_loss: 0.5600, label: 1, bag_size: 2945
batch 679, loss: 0.2570, instance_loss: 0.6017, weighted_loss: 0.3604, label: 1, bag_size: 1595
batch 699, loss: 0.3797, instance_loss: 0.4005, weighted_loss: 0.3860, label: 0, bag_size: 622
batch 719, loss: 0.0472, instance_loss: 0.1247, weighted_loss: 0.0705, label: 2, bag_size: 1094
batch 739, loss: 0.3382, instance_loss: 0.4920, weighted_loss: 0.3843, label: 1, bag_size: 5728


class 0 clustering acc 0.9715883668903803: correct 17372/17880
class 1 clustering acc 0.34261744966442953: correct 2042/5960
Epoch: 20, train_loss: 0.6032, train_clustering_loss:  0.5549, train_error: 0.2752
class 0: acc 0.762114537444934, correct 173/227
class 1: acc 0.6425855513307985, correct 169/263
class 2: acc 0.7764705882352941, correct 198/255

Val Set, val_loss: 1.0104, val_error: 0.4574, auc: 0.8560
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.14361702127659576: correct 108/752
class 0: acc 0.3269230769230769, correct 17/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.1700, instance_loss: 0.9377, weighted_loss: 1.8003, label: 1, bag_size: 3837
batch 39, loss: 1.2035, instance_loss: 0.7711, weighted_loss: 1.0738, label: 2, bag_size: 3274
batch 59, loss: 0.2883, instance_loss: 0.6897, weighted_loss: 0.4087, label: 2, bag_size: 3607
batch 79, loss: 0.0459, instance_loss: 0.8000, weighted_loss: 0.2721, label: 0, bag_size: 4485
batch 99, loss: 1.5388, instance_loss: 1.1040, weighted_loss: 1.4083, label: 0, bag_size: 5330
batch 119, loss: 0.1897, instance_loss: 0.2268, weighted_loss: 0.2008, label: 1, bag_size: 2254
batch 139, loss: 1.2053, instance_loss: 0.9845, weighted_loss: 1.1390, label: 1, bag_size: 2642
batch 159, loss: 1.2479, instance_loss: 0.5974, weighted_loss: 1.0527, label: 0, bag_size: 3402
batch 179, loss: 0.1236, instance_loss: 0.1705, weighted_loss: 0.1376, label: 2, bag_size: 4691
batch 199, loss: 0.1503, instance_loss: 0.3115, weighted_loss: 0.1987, label: 2, bag_size: 4132
batch 219, loss: 0.2518, instance_loss: 0.2367, weighted_loss: 0.2473, label: 2, bag_size: 2905
batch 239, loss: 0.4581, instance_loss: 0.6920, weighted_loss: 0.5283, label: 0, bag_size: 3885
batch 259, loss: 0.0601, instance_loss: 0.1513, weighted_loss: 0.0875, label: 2, bag_size: 2483
batch 279, loss: 2.1008, instance_loss: 1.5430, weighted_loss: 1.9335, label: 0, bag_size: 1289
batch 299, loss: 0.2484, instance_loss: 0.5859, weighted_loss: 0.3496, label: 1, bag_size: 5195
batch 319, loss: 0.0589, instance_loss: 0.3995, weighted_loss: 0.1610, label: 0, bag_size: 5795
batch 339, loss: 0.6224, instance_loss: 0.7320, weighted_loss: 0.6553, label: 1, bag_size: 2905
batch 359, loss: 2.6368, instance_loss: 0.9012, weighted_loss: 2.1161, label: 0, bag_size: 557
batch 379, loss: 1.4480, instance_loss: 1.0806, weighted_loss: 1.3378, label: 1, bag_size: 2013
batch 399, loss: 0.3891, instance_loss: 0.3232, weighted_loss: 0.3693, label: 0, bag_size: 3532
batch 419, loss: 0.0512, instance_loss: 0.2013, weighted_loss: 0.0962, label: 2, bag_size: 4745
batch 439, loss: 0.5573, instance_loss: 0.8444, weighted_loss: 0.6434, label: 1, bag_size: 2731
batch 459, loss: 0.2082, instance_loss: 0.4347, weighted_loss: 0.2762, label: 0, bag_size: 1640
batch 479, loss: 0.6255, instance_loss: 0.5947, weighted_loss: 0.6162, label: 0, bag_size: 1762
batch 499, loss: 0.3531, instance_loss: 0.7398, weighted_loss: 0.4691, label: 0, bag_size: 3164
batch 519, loss: 0.4642, instance_loss: 0.6128, weighted_loss: 0.5088, label: 2, bag_size: 4291
batch 539, loss: 0.0208, instance_loss: 0.0918, weighted_loss: 0.0421, label: 2, bag_size: 3415
batch 559, loss: 0.1091, instance_loss: 0.2402, weighted_loss: 0.1484, label: 2, bag_size: 4203
batch 579, loss: 0.0771, instance_loss: 0.3184, weighted_loss: 0.1495, label: 2, bag_size: 3397
batch 599, loss: 0.1159, instance_loss: 0.4607, weighted_loss: 0.2193, label: 0, bag_size: 3701
batch 619, loss: 0.1010, instance_loss: 0.1510, weighted_loss: 0.1160, label: 2, bag_size: 2561
batch 639, loss: 2.3129, instance_loss: 0.9493, weighted_loss: 1.9039, label: 0, bag_size: 2597
batch 659, loss: 0.0024, instance_loss: 0.1103, weighted_loss: 0.0348, label: 0, bag_size: 1647
batch 679, loss: 0.7747, instance_loss: 0.5790, weighted_loss: 0.7160, label: 2, bag_size: 5426
batch 699, loss: 0.9962, instance_loss: 0.6199, weighted_loss: 0.8833, label: 2, bag_size: 909
batch 719, loss: 0.4561, instance_loss: 1.1699, weighted_loss: 0.6703, label: 1, bag_size: 20666
batch 739, loss: 0.0994, instance_loss: 0.6218, weighted_loss: 0.2561, label: 1, bag_size: 10941


class 0 clustering acc 0.9724832214765101: correct 17388/17880
class 1 clustering acc 0.3080536912751678: correct 1836/5960
Epoch: 21, train_loss: 0.6482, train_clustering_loss:  0.5717, train_error: 0.2685
class 0: acc 0.8, correct 212/265
class 1: acc 0.6017316017316018, correct 139/231
class 2: acc 0.7791164658634538, correct 194/249

Val Set, val_loss: 0.6764, val_error: 0.2447, auc: 0.8793
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.2845744680851064: correct 214/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.7127, instance_loss: 0.7126, weighted_loss: 0.7127, label: 2, bag_size: 3299
batch 39, loss: 0.3333, instance_loss: 0.2438, weighted_loss: 0.3064, label: 2, bag_size: 88
batch 59, loss: 0.4896, instance_loss: 0.3151, weighted_loss: 0.4372, label: 2, bag_size: 3583
batch 79, loss: 0.6375, instance_loss: 0.8019, weighted_loss: 0.6868, label: 0, bag_size: 640
batch 99, loss: 0.6732, instance_loss: 0.6986, weighted_loss: 0.6808, label: 1, bag_size: 4784
batch 119, loss: 0.4518, instance_loss: 0.9725, weighted_loss: 0.6080, label: 0, bag_size: 1352
batch 139, loss: 0.0900, instance_loss: 0.1878, weighted_loss: 0.1194, label: 0, bag_size: 3525
batch 159, loss: 0.5041, instance_loss: 0.4127, weighted_loss: 0.4767, label: 0, bag_size: 3571
batch 179, loss: 0.0554, instance_loss: 0.2213, weighted_loss: 0.1052, label: 2, bag_size: 2483
batch 199, loss: 0.0902, instance_loss: 0.5532, weighted_loss: 0.2291, label: 2, bag_size: 5472
batch 219, loss: 0.0673, instance_loss: 0.3237, weighted_loss: 0.1442, label: 0, bag_size: 829
batch 239, loss: 0.0401, instance_loss: 0.3141, weighted_loss: 0.1223, label: 2, bag_size: 4745
batch 259, loss: 0.0097, instance_loss: 0.1358, weighted_loss: 0.0475, label: 0, bag_size: 4918
batch 279, loss: 0.3668, instance_loss: 0.6961, weighted_loss: 0.4656, label: 1, bag_size: 6315
batch 299, loss: 0.2794, instance_loss: 0.5080, weighted_loss: 0.3480, label: 2, bag_size: 3174
batch 319, loss: 0.6112, instance_loss: 0.5623, weighted_loss: 0.5965, label: 0, bag_size: 3532
batch 339, loss: 0.1183, instance_loss: 0.1404, weighted_loss: 0.1249, label: 0, bag_size: 1845
batch 359, loss: 0.1006, instance_loss: 0.3323, weighted_loss: 0.1701, label: 0, bag_size: 4229
batch 379, loss: 0.0566, instance_loss: 0.2581, weighted_loss: 0.1170, label: 0, bag_size: 1825
batch 399, loss: 0.1597, instance_loss: 0.2598, weighted_loss: 0.1898, label: 0, bag_size: 2756
batch 419, loss: 0.1374, instance_loss: 0.2943, weighted_loss: 0.1845, label: 0, bag_size: 2601
batch 439, loss: 0.5133, instance_loss: 0.6172, weighted_loss: 0.5444, label: 2, bag_size: 1050
batch 459, loss: 0.1105, instance_loss: 0.1474, weighted_loss: 0.1216, label: 2, bag_size: 4043
batch 479, loss: 0.3646, instance_loss: 1.0238, weighted_loss: 0.5624, label: 0, bag_size: 889
batch 499, loss: 0.1638, instance_loss: 0.3935, weighted_loss: 0.2327, label: 1, bag_size: 758
batch 519, loss: 0.1894, instance_loss: 0.3273, weighted_loss: 0.2307, label: 2, bag_size: 3174
batch 539, loss: 0.4430, instance_loss: 0.9000, weighted_loss: 0.5801, label: 0, bag_size: 889
batch 559, loss: 0.7772, instance_loss: 0.5933, weighted_loss: 0.7221, label: 2, bag_size: 4291
batch 579, loss: 2.4470, instance_loss: 0.9937, weighted_loss: 2.0110, label: 2, bag_size: 361
batch 599, loss: 0.5326, instance_loss: 0.6376, weighted_loss: 0.5641, label: 0, bag_size: 6285
batch 619, loss: 0.6636, instance_loss: 0.4846, weighted_loss: 0.6099, label: 1, bag_size: 3422
batch 639, loss: 0.2995, instance_loss: 0.4578, weighted_loss: 0.3470, label: 1, bag_size: 3586
batch 659, loss: 1.2675, instance_loss: 0.6284, weighted_loss: 1.0758, label: 1, bag_size: 3438
batch 679, loss: 1.0033, instance_loss: 1.0682, weighted_loss: 1.0227, label: 0, bag_size: 3370
batch 699, loss: 2.8738, instance_loss: 1.3590, weighted_loss: 2.4193, label: 0, bag_size: 5259
batch 719, loss: 0.0967, instance_loss: 1.5976, weighted_loss: 0.5470, label: 0, bag_size: 1055
batch 739, loss: 0.0273, instance_loss: 0.1829, weighted_loss: 0.0740, label: 2, bag_size: 3810


class 0 clustering acc 0.9701901565995525: correct 17347/17880
class 1 clustering acc 0.3295302013422819: correct 1964/5960
Epoch: 22, train_loss: 0.5985, train_clustering_loss:  0.5571, train_error: 0.2537
class 0: acc 0.782608695652174, correct 198/253
class 1: acc 0.6473029045643154, correct 156/241
class 2: acc 0.8047808764940239, correct 202/251

Val Set, val_loss: 0.8084, val_error: 0.3085, auc: 0.8937
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.1981382978723404: correct 149/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4586, instance_loss: 0.4669, weighted_loss: 0.4611, label: 2, bag_size: 3112
batch 39, loss: 0.0424, instance_loss: 0.2769, weighted_loss: 0.1127, label: 0, bag_size: 4797
batch 59, loss: 0.3748, instance_loss: 0.5594, weighted_loss: 0.4302, label: 0, bag_size: 3664
batch 79, loss: 0.2659, instance_loss: 0.3025, weighted_loss: 0.2769, label: 2, bag_size: 6704
batch 99, loss: 0.6415, instance_loss: 0.6900, weighted_loss: 0.6560, label: 1, bag_size: 3746
batch 119, loss: 0.3904, instance_loss: 0.6384, weighted_loss: 0.4648, label: 2, bag_size: 3604
batch 139, loss: 0.0745, instance_loss: 0.2951, weighted_loss: 0.1406, label: 0, bag_size: 4831
batch 159, loss: 1.8653, instance_loss: 0.9393, weighted_loss: 1.5875, label: 1, bag_size: 3261
batch 179, loss: 0.1747, instance_loss: 0.2771, weighted_loss: 0.2054, label: 0, bag_size: 4865
batch 199, loss: 0.1985, instance_loss: 0.3833, weighted_loss: 0.2539, label: 0, bag_size: 3188
batch 219, loss: 0.3995, instance_loss: 0.7537, weighted_loss: 0.5058, label: 1, bag_size: 9099
batch 239, loss: 0.3500, instance_loss: 0.4209, weighted_loss: 0.3713, label: 2, bag_size: 4487
batch 259, loss: 0.1368, instance_loss: 0.4851, weighted_loss: 0.2413, label: 0, bag_size: 1981
batch 279, loss: 0.1306, instance_loss: 0.1467, weighted_loss: 0.1354, label: 2, bag_size: 3176
batch 299, loss: 0.0413, instance_loss: 0.0972, weighted_loss: 0.0581, label: 2, bag_size: 3415
batch 319, loss: 0.0189, instance_loss: 0.1825, weighted_loss: 0.0680, label: 1, bag_size: 455
batch 339, loss: 0.3547, instance_loss: 0.5559, weighted_loss: 0.4151, label: 0, bag_size: 5656
batch 359, loss: 0.9742, instance_loss: 0.7501, weighted_loss: 0.9070, label: 1, bag_size: 4395
batch 379, loss: 0.2529, instance_loss: 0.3226, weighted_loss: 0.2738, label: 2, bag_size: 5914
batch 399, loss: 0.9241, instance_loss: 0.8080, weighted_loss: 0.8893, label: 1, bag_size: 2747
batch 419, loss: 0.4219, instance_loss: 0.4927, weighted_loss: 0.4431, label: 1, bag_size: 2753
batch 439, loss: 0.2290, instance_loss: 0.3723, weighted_loss: 0.2720, label: 1, bag_size: 4192
batch 459, loss: 0.0423, instance_loss: 0.2890, weighted_loss: 0.1163, label: 0, bag_size: 5437
batch 479, loss: 0.8700, instance_loss: 0.8121, weighted_loss: 0.8526, label: 2, bag_size: 7607
batch 499, loss: 1.2845, instance_loss: 1.4437, weighted_loss: 1.3323, label: 1, bag_size: 2229
batch 519, loss: 0.6053, instance_loss: 0.7182, weighted_loss: 0.6391, label: 1, bag_size: 2182
batch 539, loss: 0.6803, instance_loss: 0.8680, weighted_loss: 0.7366, label: 1, bag_size: 6152
batch 559, loss: 0.1854, instance_loss: 0.2941, weighted_loss: 0.2180, label: 0, bag_size: 1845
batch 579, loss: 0.9564, instance_loss: 0.5374, weighted_loss: 0.8307, label: 2, bag_size: 4096
batch 599, loss: 0.3275, instance_loss: 0.7095, weighted_loss: 0.4421, label: 2, bag_size: 5017
batch 619, loss: 1.4516, instance_loss: 0.8515, weighted_loss: 1.2716, label: 2, bag_size: 223
batch 639, loss: 0.2289, instance_loss: 0.5058, weighted_loss: 0.3120, label: 0, bag_size: 3188
batch 659, loss: 0.3834, instance_loss: 0.3943, weighted_loss: 0.3867, label: 0, bag_size: 5459
batch 679, loss: 0.0500, instance_loss: 0.2781, weighted_loss: 0.1184, label: 2, bag_size: 2483
batch 699, loss: 0.2285, instance_loss: 0.5011, weighted_loss: 0.3102, label: 1, bag_size: 4595
batch 719, loss: 0.0581, instance_loss: 0.2601, weighted_loss: 0.1187, label: 0, bag_size: 3443
batch 739, loss: 0.2474, instance_loss: 0.1454, weighted_loss: 0.2168, label: 2, bag_size: 5914


class 0 clustering acc 0.9717561521252797: correct 17375/17880
class 1 clustering acc 0.3458053691275168: correct 2061/5960
Epoch: 23, train_loss: 0.6577, train_clustering_loss:  0.5569, train_error: 0.2711
class 0: acc 0.7547169811320755, correct 200/265
class 1: acc 0.6228070175438597, correct 142/228
class 2: acc 0.7976190476190477, correct 201/252

Val Set, val_loss: 0.7229, val_error: 0.2553, auc: 0.8820
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.30186170212765956: correct 227/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.1001, instance_loss: 0.7915, weighted_loss: 1.0075, label: 1, bag_size: 1607
batch 39, loss: 0.5151, instance_loss: 0.6911, weighted_loss: 0.5679, label: 0, bag_size: 2257
batch 59, loss: 0.7360, instance_loss: 0.5458, weighted_loss: 0.6789, label: 0, bag_size: 4541
batch 79, loss: 0.4373, instance_loss: 0.5580, weighted_loss: 0.4735, label: 0, bag_size: 2392
batch 99, loss: 1.1662, instance_loss: 0.6891, weighted_loss: 1.0231, label: 1, bag_size: 1066
batch 119, loss: 0.1350, instance_loss: 0.2200, weighted_loss: 0.1605, label: 2, bag_size: 6644
batch 139, loss: 0.5190, instance_loss: 0.5044, weighted_loss: 0.5146, label: 0, bag_size: 2428
batch 159, loss: 0.0359, instance_loss: 0.0870, weighted_loss: 0.0512, label: 2, bag_size: 1094
batch 179, loss: 0.3200, instance_loss: 0.3059, weighted_loss: 0.3158, label: 1, bag_size: 4705
batch 199, loss: 0.8481, instance_loss: 0.7740, weighted_loss: 0.8258, label: 1, bag_size: 2831
batch 219, loss: 0.8536, instance_loss: 0.7841, weighted_loss: 0.8328, label: 1, bag_size: 2642
batch 239, loss: 0.7534, instance_loss: 0.8658, weighted_loss: 0.7871, label: 0, bag_size: 1543
batch 259, loss: 0.2832, instance_loss: 0.2725, weighted_loss: 0.2800, label: 2, bag_size: 2501
batch 279, loss: 0.5192, instance_loss: 0.5546, weighted_loss: 0.5298, label: 2, bag_size: 3174
batch 299, loss: 0.3998, instance_loss: 0.4758, weighted_loss: 0.4226, label: 1, bag_size: 1042
batch 319, loss: 1.0594, instance_loss: 0.8164, weighted_loss: 0.9865, label: 1, bag_size: 4395
batch 339, loss: 0.4496, instance_loss: 1.0868, weighted_loss: 0.6408, label: 1, bag_size: 20666
batch 359, loss: 0.2246, instance_loss: 0.8885, weighted_loss: 0.4238, label: 1, bag_size: 20666
batch 379, loss: 0.0132, instance_loss: 0.2921, weighted_loss: 0.0969, label: 2, bag_size: 4497
batch 399, loss: 0.1844, instance_loss: 0.3784, weighted_loss: 0.2426, label: 1, bag_size: 4684
batch 419, loss: 0.6628, instance_loss: 0.7866, weighted_loss: 0.6999, label: 1, bag_size: 782
batch 439, loss: 0.0998, instance_loss: 0.3695, weighted_loss: 0.1807, label: 0, bag_size: 2094
batch 459, loss: 0.0515, instance_loss: 0.1109, weighted_loss: 0.0693, label: 2, bag_size: 4088
batch 479, loss: 2.2564, instance_loss: 1.2401, weighted_loss: 1.9515, label: 1, bag_size: 1670
batch 499, loss: 0.4722, instance_loss: 0.9209, weighted_loss: 0.6068, label: 0, bag_size: 1933
batch 519, loss: 0.0633, instance_loss: 0.3925, weighted_loss: 0.1621, label: 1, bag_size: 5833
batch 539, loss: 0.1464, instance_loss: 0.5172, weighted_loss: 0.2577, label: 1, bag_size: 582
batch 559, loss: 1.4037, instance_loss: 1.0126, weighted_loss: 1.2864, label: 1, bag_size: 3424
batch 579, loss: 0.2363, instance_loss: 0.3488, weighted_loss: 0.2700, label: 0, bag_size: 4648
batch 599, loss: 0.0239, instance_loss: 0.1019, weighted_loss: 0.0473, label: 2, bag_size: 3121
batch 619, loss: 0.0070, instance_loss: 0.1266, weighted_loss: 0.0429, label: 0, bag_size: 6221
batch 639, loss: 0.0192, instance_loss: 0.0299, weighted_loss: 0.0224, label: 2, bag_size: 657
batch 659, loss: 0.0614, instance_loss: 0.1990, weighted_loss: 0.1027, label: 0, bag_size: 3348
batch 679, loss: 0.8121, instance_loss: 0.6916, weighted_loss: 0.7759, label: 1, bag_size: 4438
batch 699, loss: 0.9411, instance_loss: 0.9157, weighted_loss: 0.9335, label: 2, bag_size: 6594
batch 719, loss: 0.0169, instance_loss: 0.2923, weighted_loss: 0.0995, label: 0, bag_size: 4485
batch 739, loss: 0.6568, instance_loss: 0.6091, weighted_loss: 0.6425, label: 1, bag_size: 4395


class 0 clustering acc 0.9732662192393736: correct 17402/17880
class 1 clustering acc 0.3412751677852349: correct 2034/5960
Epoch: 24, train_loss: 0.5481, train_clustering_loss:  0.5403, train_error: 0.2376
class 0: acc 0.8060344827586207, correct 187/232
class 1: acc 0.7078651685393258, correct 189/267
class 2: acc 0.7804878048780488, correct 192/246

Val Set, val_loss: 0.7739, val_error: 0.2979, auc: 0.8721
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.31117021276595747: correct 234/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 3.3437, instance_loss: 1.5345, weighted_loss: 2.8010, label: 0, bag_size: 11141
batch 39, loss: 1.7945, instance_loss: 1.5922, weighted_loss: 1.7338, label: 2, bag_size: 3299
batch 59, loss: 0.0334, instance_loss: 0.1403, weighted_loss: 0.0655, label: 2, bag_size: 3176
batch 79, loss: 0.0018, instance_loss: 0.2996, weighted_loss: 0.0911, label: 0, bag_size: 3920
batch 99, loss: 0.9643, instance_loss: 0.8250, weighted_loss: 0.9225, label: 2, bag_size: 4571
batch 119, loss: 0.3041, instance_loss: 0.6505, weighted_loss: 0.4080, label: 1, bag_size: 2494
batch 139, loss: 0.0656, instance_loss: 0.6584, weighted_loss: 0.2435, label: 0, bag_size: 1933
batch 159, loss: 0.0660, instance_loss: 0.4130, weighted_loss: 0.1701, label: 0, bag_size: 5646
batch 179, loss: 0.8059, instance_loss: 0.6584, weighted_loss: 0.7616, label: 1, bag_size: 1599
batch 199, loss: 1.0924, instance_loss: 0.8726, weighted_loss: 1.0265, label: 1, bag_size: 2751
batch 219, loss: 0.3305, instance_loss: 0.2365, weighted_loss: 0.3023, label: 2, bag_size: 705
batch 239, loss: 1.0098, instance_loss: 0.7083, weighted_loss: 0.9194, label: 1, bag_size: 3604
batch 259, loss: 0.1587, instance_loss: 0.2231, weighted_loss: 0.1780, label: 2, bag_size: 5138
batch 279, loss: 0.0415, instance_loss: 0.2915, weighted_loss: 0.1165, label: 1, bag_size: 4898
batch 299, loss: 0.0408, instance_loss: 0.2423, weighted_loss: 0.1013, label: 0, bag_size: 3983
batch 319, loss: 0.0047, instance_loss: 0.1819, weighted_loss: 0.0579, label: 0, bag_size: 6797
batch 339, loss: 0.0680, instance_loss: 0.5401, weighted_loss: 0.2096, label: 0, bag_size: 614
batch 359, loss: 0.2938, instance_loss: 0.3790, weighted_loss: 0.3194, label: 0, bag_size: 1353
batch 379, loss: 0.9463, instance_loss: 0.6107, weighted_loss: 0.8456, label: 0, bag_size: 4725
batch 399, loss: 0.1487, instance_loss: 0.2332, weighted_loss: 0.1740, label: 0, bag_size: 6863
batch 419, loss: 1.4275, instance_loss: 1.0068, weighted_loss: 1.3013, label: 0, bag_size: 7219
batch 439, loss: 0.1757, instance_loss: 0.6479, weighted_loss: 0.3173, label: 1, bag_size: 4644
batch 459, loss: 0.3213, instance_loss: 0.3898, weighted_loss: 0.3419, label: 0, bag_size: 3816
batch 479, loss: 1.1702, instance_loss: 0.6989, weighted_loss: 1.0288, label: 0, bag_size: 2428
batch 499, loss: 0.2536, instance_loss: 0.4243, weighted_loss: 0.3048, label: 1, bag_size: 3761
batch 519, loss: 0.3083, instance_loss: 0.6097, weighted_loss: 0.3987, label: 0, bag_size: 1018
batch 539, loss: 2.0503, instance_loss: 1.4437, weighted_loss: 1.8683, label: 1, bag_size: 1595
batch 559, loss: 2.4681, instance_loss: 1.2533, weighted_loss: 2.1036, label: 0, bag_size: 4572
batch 579, loss: 0.2383, instance_loss: 0.6133, weighted_loss: 0.3508, label: 1, bag_size: 4869
batch 599, loss: 0.4398, instance_loss: 0.3405, weighted_loss: 0.4100, label: 2, bag_size: 2359
batch 619, loss: 0.0531, instance_loss: 0.1008, weighted_loss: 0.0674, label: 0, bag_size: 3816
batch 639, loss: 0.6812, instance_loss: 0.4560, weighted_loss: 0.6136, label: 1, bag_size: 2945
batch 659, loss: 0.2551, instance_loss: 0.2591, weighted_loss: 0.2563, label: 2, bag_size: 4056
batch 679, loss: 0.2712, instance_loss: 0.7656, weighted_loss: 0.4195, label: 1, bag_size: 14449
batch 699, loss: 0.0011, instance_loss: 0.2287, weighted_loss: 0.0694, label: 0, bag_size: 3298
batch 719, loss: 1.2205, instance_loss: 1.0504, weighted_loss: 1.1695, label: 1, bag_size: 1364
batch 739, loss: 0.7107, instance_loss: 0.7395, weighted_loss: 0.7193, label: 1, bag_size: 3823


class 0 clustering acc 0.9701901565995525: correct 17347/17880
class 1 clustering acc 0.36761744966442955: correct 2191/5960
Epoch: 25, train_loss: 0.5802, train_clustering_loss:  0.5443, train_error: 0.2604
class 0: acc 0.7798507462686567, correct 209/268
class 1: acc 0.6363636363636364, correct 140/220
class 2: acc 0.7859922178988327, correct 202/257

Val Set, val_loss: 0.6934, val_error: 0.2553, auc: 0.8888
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.3523936170212766: correct 265/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.8492, instance_loss: 0.4954, weighted_loss: 0.7431, label: 0, bag_size: 1695
batch 39, loss: 0.9562, instance_loss: 0.6918, weighted_loss: 0.8769, label: 1, bag_size: 7176
batch 59, loss: 0.5717, instance_loss: 0.5943, weighted_loss: 0.5785, label: 0, bag_size: 4227
batch 79, loss: 1.2988, instance_loss: 0.8059, weighted_loss: 1.1509, label: 0, bag_size: 877
batch 99, loss: 1.1519, instance_loss: 0.5865, weighted_loss: 0.9823, label: 0, bag_size: 4719
batch 119, loss: 1.0084, instance_loss: 0.6349, weighted_loss: 0.8964, label: 2, bag_size: 3112
batch 139, loss: 0.4872, instance_loss: 0.2702, weighted_loss: 0.4221, label: 2, bag_size: 2561
batch 159, loss: 3.2419, instance_loss: 1.2174, weighted_loss: 2.6345, label: 0, bag_size: 3830
batch 179, loss: 0.0074, instance_loss: 0.0689, weighted_loss: 0.0258, label: 2, bag_size: 6026
batch 199, loss: 0.0600, instance_loss: 0.0813, weighted_loss: 0.0664, label: 0, bag_size: 2791
batch 219, loss: 0.3898, instance_loss: 0.3574, weighted_loss: 0.3801, label: 2, bag_size: 3112
batch 239, loss: 0.4272, instance_loss: 0.2086, weighted_loss: 0.3616, label: 0, bag_size: 4405
batch 259, loss: 0.6284, instance_loss: 0.4438, weighted_loss: 0.5730, label: 1, bag_size: 9099
batch 279, loss: 1.0376, instance_loss: 0.9886, weighted_loss: 1.0229, label: 1, bag_size: 3322
batch 299, loss: 0.1928, instance_loss: 0.2622, weighted_loss: 0.2136, label: 2, bag_size: 4569
batch 319, loss: 0.1912, instance_loss: 0.4078, weighted_loss: 0.2562, label: 2, bag_size: 5037
batch 339, loss: 0.2617, instance_loss: 0.5957, weighted_loss: 0.3619, label: 2, bag_size: 5472
batch 359, loss: 0.0272, instance_loss: 0.1293, weighted_loss: 0.0578, label: 2, bag_size: 4203
batch 379, loss: 0.6175, instance_loss: 0.2949, weighted_loss: 0.5207, label: 2, bag_size: 2481
batch 399, loss: 0.4912, instance_loss: 0.4539, weighted_loss: 0.4800, label: 2, bag_size: 3174
batch 419, loss: 0.7287, instance_loss: 0.4667, weighted_loss: 0.6501, label: 2, bag_size: 705
batch 439, loss: 1.0130, instance_loss: 0.8812, weighted_loss: 0.9735, label: 1, bag_size: 1122
batch 459, loss: 0.1888, instance_loss: 0.4986, weighted_loss: 0.2817, label: 1, bag_size: 3337
batch 479, loss: 0.1263, instance_loss: 0.4453, weighted_loss: 0.2220, label: 0, bag_size: 1812
batch 499, loss: 0.8242, instance_loss: 0.7224, weighted_loss: 0.7937, label: 1, bag_size: 5693
batch 519, loss: 0.0485, instance_loss: 0.3054, weighted_loss: 0.1255, label: 2, bag_size: 4497
batch 539, loss: 1.1103, instance_loss: 0.8698, weighted_loss: 1.0382, label: 0, bag_size: 893
batch 559, loss: 0.7059, instance_loss: 0.7356, weighted_loss: 0.7148, label: 1, bag_size: 2671
batch 579, loss: 4.2609, instance_loss: 1.6936, weighted_loss: 3.4907, label: 0, bag_size: 12971
batch 599, loss: 0.0383, instance_loss: 0.2839, weighted_loss: 0.1120, label: 1, bag_size: 874
batch 619, loss: 0.0073, instance_loss: 0.1188, weighted_loss: 0.0408, label: 0, bag_size: 1132
batch 639, loss: 1.7448, instance_loss: 0.8790, weighted_loss: 1.4850, label: 0, bag_size: 3664
batch 659, loss: 1.0383, instance_loss: 0.7875, weighted_loss: 0.9630, label: 1, bag_size: 1500
batch 679, loss: 1.2083, instance_loss: 1.8746, weighted_loss: 1.4082, label: 1, bag_size: 3016
batch 699, loss: 0.0636, instance_loss: 0.1527, weighted_loss: 0.0903, label: 2, bag_size: 3285
batch 719, loss: 0.4416, instance_loss: 0.3723, weighted_loss: 0.4208, label: 1, bag_size: 5696
batch 739, loss: 0.0951, instance_loss: 0.3220, weighted_loss: 0.1632, label: 1, bag_size: 3983


class 0 clustering acc 0.970413870246085: correct 17351/17880
class 1 clustering acc 0.3179530201342282: correct 1895/5960
Epoch: 26, train_loss: 0.6364, train_clustering_loss:  0.5743, train_error: 0.2886
class 0: acc 0.751004016064257, correct 187/249
class 1: acc 0.6461538461538462, correct 168/260
class 2: acc 0.7415254237288136, correct 175/236

Val Set, val_loss: 0.7427, val_error: 0.2660, auc: 0.8903
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.1981382978723404: correct 149/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.8166, instance_loss: 0.5822, weighted_loss: 0.7463, label: 1, bag_size: 1161
batch 39, loss: 0.0380, instance_loss: 0.3765, weighted_loss: 0.1395, label: 1, bag_size: 5086
batch 59, loss: 0.3749, instance_loss: 0.3983, weighted_loss: 0.3819, label: 1, bag_size: 6156
batch 79, loss: 0.2451, instance_loss: 0.5632, weighted_loss: 0.3406, label: 0, bag_size: 1910
batch 99, loss: 0.0779, instance_loss: 0.3941, weighted_loss: 0.1728, label: 1, bag_size: 3493
batch 119, loss: 0.0109, instance_loss: 0.1423, weighted_loss: 0.0503, label: 2, bag_size: 2483
batch 139, loss: 0.4885, instance_loss: 0.4824, weighted_loss: 0.4866, label: 1, bag_size: 800
batch 159, loss: 1.0321, instance_loss: 0.3597, weighted_loss: 0.8303, label: 2, bag_size: 2031
batch 179, loss: 0.1646, instance_loss: 0.3026, weighted_loss: 0.2060, label: 0, bag_size: 5893
batch 199, loss: 0.9467, instance_loss: 0.6921, weighted_loss: 0.8703, label: 2, bag_size: 1543
batch 219, loss: 0.1451, instance_loss: 0.8009, weighted_loss: 0.3418, label: 0, bag_size: 1601
batch 239, loss: 0.6657, instance_loss: 0.4541, weighted_loss: 0.6022, label: 0, bag_size: 3224
batch 259, loss: 1.1882, instance_loss: 0.9481, weighted_loss: 1.1162, label: 1, bag_size: 5880
batch 279, loss: 0.0768, instance_loss: 0.2183, weighted_loss: 0.1193, label: 2, bag_size: 4162
batch 299, loss: 0.0000, instance_loss: 0.0032, weighted_loss: 0.0010, label: 0, bag_size: 4918
batch 319, loss: 1.2169, instance_loss: 0.8014, weighted_loss: 1.0922, label: 1, bag_size: 6025
batch 339, loss: 0.6936, instance_loss: 0.5720, weighted_loss: 0.6572, label: 1, bag_size: 3225
batch 359, loss: 0.7300, instance_loss: 0.9436, weighted_loss: 0.7941, label: 1, bag_size: 582
batch 379, loss: 0.2650, instance_loss: 0.3107, weighted_loss: 0.2787, label: 0, bag_size: 4827
batch 399, loss: 0.7794, instance_loss: 0.6995, weighted_loss: 0.7554, label: 0, bag_size: 4541
batch 419, loss: 0.1028, instance_loss: 1.5833, weighted_loss: 0.5469, label: 1, bag_size: 1604
batch 439, loss: 0.0799, instance_loss: 0.2421, weighted_loss: 0.1286, label: 0, bag_size: 4734
batch 459, loss: 0.1897, instance_loss: 0.3156, weighted_loss: 0.2275, label: 0, bag_size: 4282
batch 479, loss: 0.3861, instance_loss: 0.7217, weighted_loss: 0.4868, label: 1, bag_size: 3596
batch 499, loss: 1.9211, instance_loss: 1.0404, weighted_loss: 1.6569, label: 2, bag_size: 7607
batch 519, loss: 0.4798, instance_loss: 0.4481, weighted_loss: 0.4703, label: 1, bag_size: 3391
batch 539, loss: 0.2803, instance_loss: 0.4811, weighted_loss: 0.3406, label: 1, bag_size: 2182
batch 559, loss: 0.0652, instance_loss: 0.2310, weighted_loss: 0.1149, label: 0, bag_size: 3339
batch 579, loss: 1.4829, instance_loss: 1.7472, weighted_loss: 1.5622, label: 1, bag_size: 3016
batch 599, loss: 0.5486, instance_loss: 0.4130, weighted_loss: 0.5079, label: 2, bag_size: 6298
batch 619, loss: 0.0501, instance_loss: 0.1391, weighted_loss: 0.0768, label: 2, bag_size: 4203
batch 639, loss: 0.0275, instance_loss: 0.2537, weighted_loss: 0.0953, label: 2, bag_size: 5138
batch 659, loss: 1.5976, instance_loss: 1.0338, weighted_loss: 1.4284, label: 2, bag_size: 2326
batch 679, loss: 0.3715, instance_loss: 0.8853, weighted_loss: 0.5256, label: 0, bag_size: 1601
batch 699, loss: 0.2132, instance_loss: 0.8039, weighted_loss: 0.3904, label: 1, bag_size: 5833
batch 719, loss: 0.5991, instance_loss: 0.7610, weighted_loss: 0.6476, label: 1, bag_size: 3991
batch 739, loss: 0.0881, instance_loss: 0.3753, weighted_loss: 0.1742, label: 1, bag_size: 4812


class 0 clustering acc 0.9737136465324385: correct 17410/17880
class 1 clustering acc 0.3731543624161074: correct 2224/5960
Epoch: 27, train_loss: 0.5343, train_clustering_loss:  0.5309, train_error: 0.2430
class 0: acc 0.8073770491803278, correct 197/244
class 1: acc 0.6818181818181818, correct 180/264
class 2: acc 0.7890295358649789, correct 187/237

Val Set, val_loss: 0.6937, val_error: 0.2553, auc: 0.8939
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.19547872340425532: correct 147/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.8338, instance_loss: 0.5721, weighted_loss: 0.7553, label: 1, bag_size: 3604
batch 39, loss: 4.4716, instance_loss: 1.5555, weighted_loss: 3.5967, label: 0, bag_size: 603
batch 59, loss: 1.2427, instance_loss: 1.3591, weighted_loss: 1.2776, label: 1, bag_size: 3322
batch 79, loss: 0.0336, instance_loss: 0.0748, weighted_loss: 0.0459, label: 2, bag_size: 2313
batch 99, loss: 0.0234, instance_loss: 0.1012, weighted_loss: 0.0468, label: 2, bag_size: 2313
batch 119, loss: 0.0449, instance_loss: 0.0656, weighted_loss: 0.0511, label: 2, bag_size: 2997
batch 139, loss: 0.0730, instance_loss: 0.2656, weighted_loss: 0.1307, label: 0, bag_size: 4577
batch 159, loss: 0.1158, instance_loss: 0.2358, weighted_loss: 0.1518, label: 2, bag_size: 1094
batch 179, loss: 0.3735, instance_loss: 0.7392, weighted_loss: 0.4832, label: 1, bag_size: 3821
batch 199, loss: 0.2107, instance_loss: 0.2319, weighted_loss: 0.2170, label: 2, bag_size: 4203
batch 219, loss: 0.0092, instance_loss: 0.2101, weighted_loss: 0.0694, label: 1, bag_size: 4111
batch 239, loss: 0.6001, instance_loss: 1.0894, weighted_loss: 0.7469, label: 1, bag_size: 2229
batch 259, loss: 0.3431, instance_loss: 0.7996, weighted_loss: 0.4800, label: 0, bag_size: 313
batch 279, loss: 1.0608, instance_loss: 0.6710, weighted_loss: 0.9439, label: 2, bag_size: 361
batch 299, loss: 1.5575, instance_loss: 0.8515, weighted_loss: 1.3457, label: 0, bag_size: 7219
batch 319, loss: 0.2029, instance_loss: 0.3778, weighted_loss: 0.2554, label: 2, bag_size: 4555
batch 339, loss: 2.1119, instance_loss: 1.3066, weighted_loss: 1.8703, label: 0, bag_size: 436
batch 359, loss: 0.0091, instance_loss: 0.1924, weighted_loss: 0.0641, label: 2, bag_size: 4497
batch 379, loss: 0.5074, instance_loss: 0.5161, weighted_loss: 0.5100, label: 1, bag_size: 4705
batch 399, loss: 0.0362, instance_loss: 0.2897, weighted_loss: 0.1123, label: 0, bag_size: 1417
batch 419, loss: 1.4028, instance_loss: 1.0592, weighted_loss: 1.2997, label: 1, bag_size: 5276
batch 439, loss: 0.0244, instance_loss: 0.2199, weighted_loss: 0.0831, label: 2, bag_size: 5037
batch 459, loss: 0.0155, instance_loss: 0.0788, weighted_loss: 0.0345, label: 0, bag_size: 873
batch 479, loss: 0.5421, instance_loss: 1.1620, weighted_loss: 0.7281, label: 1, bag_size: 3322
batch 499, loss: 0.0334, instance_loss: 0.1835, weighted_loss: 0.0784, label: 1, bag_size: 862
batch 519, loss: 0.1842, instance_loss: 0.2521, weighted_loss: 0.2045, label: 0, bag_size: 1385
batch 539, loss: 0.1567, instance_loss: 0.1783, weighted_loss: 0.1631, label: 2, bag_size: 2561
batch 559, loss: 0.1514, instance_loss: 0.2238, weighted_loss: 0.1731, label: 2, bag_size: 6704
batch 579, loss: 0.4676, instance_loss: 0.2949, weighted_loss: 0.4158, label: 0, bag_size: 3224
batch 599, loss: 0.1459, instance_loss: 0.4974, weighted_loss: 0.2514, label: 2, bag_size: 5017
batch 619, loss: 0.2318, instance_loss: 0.3631, weighted_loss: 0.2712, label: 2, bag_size: 3210
batch 639, loss: 0.8541, instance_loss: 0.8109, weighted_loss: 0.8412, label: 2, bag_size: 3274
batch 659, loss: 0.4693, instance_loss: 0.3159, weighted_loss: 0.4233, label: 2, bag_size: 3112
batch 679, loss: 0.1169, instance_loss: 0.6058, weighted_loss: 0.2636, label: 2, bag_size: 5017
batch 699, loss: 0.0656, instance_loss: 0.3315, weighted_loss: 0.1453, label: 1, bag_size: 5026
batch 719, loss: 0.4414, instance_loss: 0.4451, weighted_loss: 0.4425, label: 0, bag_size: 2608
batch 739, loss: 1.2425, instance_loss: 1.1761, weighted_loss: 1.2226, label: 2, bag_size: 4910


class 0 clustering acc 0.9719798657718121: correct 17379/17880
class 1 clustering acc 0.3790268456375839: correct 2259/5960
Epoch: 28, train_loss: 0.5821, train_clustering_loss:  0.5369, train_error: 0.2403
class 0: acc 0.8, correct 204/255
class 1: acc 0.6396396396396397, correct 142/222
class 2: acc 0.8208955223880597, correct 220/268

Val Set, val_loss: 0.6966, val_error: 0.2766, auc: 0.8898
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.32180851063829785: correct 242/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.2904, instance_loss: 0.6619, weighted_loss: 1.1019, label: 1, bag_size: 2481
batch 39, loss: 0.4120, instance_loss: 0.7728, weighted_loss: 0.5202, label: 0, bag_size: 3164
batch 59, loss: 0.0910, instance_loss: 0.2442, weighted_loss: 0.1369, label: 2, bag_size: 3497
batch 79, loss: 0.1935, instance_loss: 0.5305, weighted_loss: 0.2946, label: 1, bag_size: 5696
batch 99, loss: 0.2174, instance_loss: 0.4518, weighted_loss: 0.2877, label: 0, bag_size: 2601
batch 119, loss: 0.0469, instance_loss: 0.2844, weighted_loss: 0.1182, label: 0, bag_size: 4570
batch 139, loss: 0.8510, instance_loss: 0.9511, weighted_loss: 0.8810, label: 2, bag_size: 4342
batch 159, loss: 0.6472, instance_loss: 0.9494, weighted_loss: 0.7379, label: 1, bag_size: 32
batch 179, loss: 0.4253, instance_loss: 0.2070, weighted_loss: 0.3598, label: 2, bag_size: 4096
batch 199, loss: 0.0565, instance_loss: 0.1126, weighted_loss: 0.0733, label: 2, bag_size: 4203
batch 219, loss: 1.3143, instance_loss: 1.4578, weighted_loss: 1.3574, label: 1, bag_size: 5205
batch 239, loss: 0.6334, instance_loss: 0.4100, weighted_loss: 0.5664, label: 2, bag_size: 3112
batch 259, loss: 4.7198, instance_loss: 2.1773, weighted_loss: 3.9570, label: 0, bag_size: 5259
batch 279, loss: 0.2567, instance_loss: 0.2808, weighted_loss: 0.2639, label: 0, bag_size: 4201
batch 299, loss: 0.7085, instance_loss: 0.6431, weighted_loss: 0.6889, label: 1, bag_size: 3935
batch 319, loss: 0.0082, instance_loss: 0.0989, weighted_loss: 0.0354, label: 0, bag_size: 6221
batch 339, loss: 0.6068, instance_loss: 0.5586, weighted_loss: 0.5923, label: 2, bag_size: 1050
batch 359, loss: 0.0878, instance_loss: 0.2901, weighted_loss: 0.1485, label: 1, bag_size: 3127
batch 379, loss: 0.2364, instance_loss: 0.3733, weighted_loss: 0.2775, label: 2, bag_size: 2481
batch 399, loss: 0.0931, instance_loss: 0.4965, weighted_loss: 0.2141, label: 1, bag_size: 1027
batch 419, loss: 0.0674, instance_loss: 0.3223, weighted_loss: 0.1439, label: 0, bag_size: 4165
batch 439, loss: 0.0552, instance_loss: 0.3626, weighted_loss: 0.1474, label: 0, bag_size: 4914
batch 459, loss: 0.2737, instance_loss: 0.4292, weighted_loss: 0.3203, label: 2, bag_size: 3174
batch 479, loss: 0.1479, instance_loss: 0.5660, weighted_loss: 0.2733, label: 0, bag_size: 5837
batch 499, loss: 0.7076, instance_loss: 0.8610, weighted_loss: 0.7536, label: 1, bag_size: 4262
batch 519, loss: 1.2185, instance_loss: 0.6634, weighted_loss: 1.0519, label: 0, bag_size: 14218
batch 539, loss: 0.3387, instance_loss: 0.2845, weighted_loss: 0.3224, label: 1, bag_size: 5167
batch 559, loss: 0.3211, instance_loss: 0.5061, weighted_loss: 0.3766, label: 2, bag_size: 3678
batch 579, loss: 0.0507, instance_loss: 0.1164, weighted_loss: 0.0704, label: 2, bag_size: 4088
batch 599, loss: 0.8698, instance_loss: 0.5866, weighted_loss: 0.7848, label: 1, bag_size: 3786
batch 619, loss: 1.7822, instance_loss: 0.7060, weighted_loss: 1.4593, label: 0, bag_size: 3661
batch 639, loss: 0.0281, instance_loss: 0.2876, weighted_loss: 0.1060, label: 0, bag_size: 5899
batch 659, loss: 0.0150, instance_loss: 0.1060, weighted_loss: 0.0423, label: 2, bag_size: 4856
batch 679, loss: 0.0562, instance_loss: 0.1699, weighted_loss: 0.0903, label: 2, bag_size: 614
batch 699, loss: 0.0720, instance_loss: 0.2724, weighted_loss: 0.1321, label: 2, bag_size: 3810
batch 719, loss: 0.2321, instance_loss: 0.5981, weighted_loss: 0.3419, label: 1, bag_size: 2319
batch 739, loss: 0.1563, instance_loss: 0.1443, weighted_loss: 0.1527, label: 2, bag_size: 2905


class 0 clustering acc 0.970917225950783: correct 17360/17880
class 1 clustering acc 0.37399328859060404: correct 2229/5960
Epoch: 29, train_loss: 0.5730, train_clustering_loss:  0.5448, train_error: 0.2523
class 0: acc 0.7379032258064516, correct 183/248
class 1: acc 0.6854838709677419, correct 170/248
class 2: acc 0.8192771084337349, correct 204/249

Val Set, val_loss: 0.7750, val_error: 0.2766, auc: 0.8773
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.15558510638297873: correct 117/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3886, instance_loss: 0.5761, weighted_loss: 0.4449, label: 2, bag_size: 6594
batch 39, loss: 0.5246, instance_loss: 0.4570, weighted_loss: 0.5043, label: 1, bag_size: 2919
batch 59, loss: 0.2043, instance_loss: 0.3666, weighted_loss: 0.2530, label: 2, bag_size: 4302
batch 79, loss: 0.1279, instance_loss: 0.2228, weighted_loss: 0.1564, label: 0, bag_size: 4827
batch 99, loss: 1.0491, instance_loss: 1.2033, weighted_loss: 1.0953, label: 1, bag_size: 12936
batch 119, loss: 0.0071, instance_loss: 0.0837, weighted_loss: 0.0300, label: 2, bag_size: 4856
batch 139, loss: 1.7742, instance_loss: 0.9728, weighted_loss: 1.5338, label: 1, bag_size: 1670
batch 159, loss: 0.5654, instance_loss: 0.6283, weighted_loss: 0.5843, label: 0, bag_size: 4946
batch 179, loss: 0.0881, instance_loss: 0.6277, weighted_loss: 0.2500, label: 1, bag_size: 6717
batch 199, loss: 0.1911, instance_loss: 0.2377, weighted_loss: 0.2051, label: 2, bag_size: 2905
batch 219, loss: 0.4137, instance_loss: 0.6990, weighted_loss: 0.4993, label: 0, bag_size: 673
batch 239, loss: 0.4959, instance_loss: 0.6054, weighted_loss: 0.5288, label: 1, bag_size: 3821
batch 259, loss: 0.1529, instance_loss: 0.3935, weighted_loss: 0.2251, label: 0, bag_size: 3864
batch 279, loss: 0.0815, instance_loss: 0.1905, weighted_loss: 0.1142, label: 2, bag_size: 4302
batch 299, loss: 1.1663, instance_loss: 0.7497, weighted_loss: 1.0414, label: 2, bag_size: 3618
batch 319, loss: 1.8911, instance_loss: 0.9453, weighted_loss: 1.6073, label: 0, bag_size: 14218
batch 339, loss: 1.0658, instance_loss: 0.9142, weighted_loss: 1.0203, label: 0, bag_size: 877
batch 359, loss: 0.4045, instance_loss: 0.5511, weighted_loss: 0.4485, label: 1, bag_size: 1906
batch 379, loss: 0.0241, instance_loss: 0.1045, weighted_loss: 0.0482, label: 2, bag_size: 6026
batch 399, loss: 0.0899, instance_loss: 0.4221, weighted_loss: 0.1895, label: 0, bag_size: 2927
batch 419, loss: 0.3987, instance_loss: 0.8872, weighted_loss: 0.5452, label: 0, bag_size: 889
batch 439, loss: 0.0175, instance_loss: 0.3244, weighted_loss: 0.1096, label: 0, bag_size: 5646
batch 459, loss: 0.0305, instance_loss: 0.2937, weighted_loss: 0.1094, label: 0, bag_size: 5646
batch 479, loss: 0.0005, instance_loss: 0.1416, weighted_loss: 0.0429, label: 0, bag_size: 4196
batch 499, loss: 0.0290, instance_loss: 0.1156, weighted_loss: 0.0550, label: 0, bag_size: 5337
batch 519, loss: 0.2989, instance_loss: 0.6061, weighted_loss: 0.3911, label: 2, bag_size: 4162
batch 539, loss: 0.0311, instance_loss: 0.4982, weighted_loss: 0.1712, label: 0, bag_size: 1233
batch 559, loss: 0.5724, instance_loss: 1.1284, weighted_loss: 0.7392, label: 1, bag_size: 582
batch 579, loss: 0.9581, instance_loss: 0.9105, weighted_loss: 0.9438, label: 0, bag_size: 5823
batch 599, loss: 0.7768, instance_loss: 1.0046, weighted_loss: 0.8451, label: 0, bag_size: 3341
batch 619, loss: 1.4142, instance_loss: 1.2443, weighted_loss: 1.3632, label: 2, bag_size: 2326
batch 639, loss: 0.1408, instance_loss: 0.3045, weighted_loss: 0.1899, label: 0, bag_size: 3864
batch 659, loss: 0.1311, instance_loss: 0.3585, weighted_loss: 0.1993, label: 0, bag_size: 5377
batch 679, loss: 0.5296, instance_loss: 0.5598, weighted_loss: 0.5387, label: 1, bag_size: 800
batch 699, loss: 0.8827, instance_loss: 0.4943, weighted_loss: 0.7662, label: 0, bag_size: 3382
batch 719, loss: 0.0355, instance_loss: 0.1306, weighted_loss: 0.0640, label: 2, bag_size: 2483
batch 739, loss: 0.3896, instance_loss: 0.6371, weighted_loss: 0.4638, label: 1, bag_size: 2919


class 0 clustering acc 0.9700782997762863: correct 17345/17880
class 1 clustering acc 0.3157718120805369: correct 1882/5960
Epoch: 30, train_loss: 0.6171, train_clustering_loss:  0.5764, train_error: 0.2403
class 0: acc 0.796875, correct 204/256
class 1: acc 0.684, correct 171/250
class 2: acc 0.799163179916318, correct 191/239

Val Set, val_loss: 0.6987, val_error: 0.2234, auc: 0.8857
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.4242021276595745: correct 319/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3867, instance_loss: 0.3047, weighted_loss: 0.3621, label: 2, bag_size: 3546
batch 39, loss: 1.4134, instance_loss: 0.7941, weighted_loss: 1.2276, label: 2, bag_size: 728
batch 59, loss: 0.0608, instance_loss: 0.1557, weighted_loss: 0.0892, label: 2, bag_size: 2561
batch 79, loss: 0.0479, instance_loss: 0.4519, weighted_loss: 0.1691, label: 0, bag_size: 996
batch 99, loss: 0.6868, instance_loss: 0.7843, weighted_loss: 0.7161, label: 2, bag_size: 4342
batch 119, loss: 0.4325, instance_loss: 0.7580, weighted_loss: 0.5302, label: 2, bag_size: 3604
batch 139, loss: 0.0356, instance_loss: 0.4234, weighted_loss: 0.1519, label: 0, bag_size: 5377
batch 159, loss: 2.4064, instance_loss: 0.9570, weighted_loss: 1.9716, label: 2, bag_size: 728
batch 179, loss: 0.0331, instance_loss: 0.4341, weighted_loss: 0.1534, label: 1, bag_size: 4192
batch 199, loss: 0.0255, instance_loss: 0.1915, weighted_loss: 0.0753, label: 1, bag_size: 6277
batch 219, loss: 0.5646, instance_loss: 0.5072, weighted_loss: 0.5474, label: 1, bag_size: 2731
batch 239, loss: 0.6546, instance_loss: 0.5569, weighted_loss: 0.6253, label: 2, bag_size: 4291
batch 259, loss: 0.3245, instance_loss: 0.6494, weighted_loss: 0.4220, label: 1, bag_size: 2731
batch 279, loss: 1.9431, instance_loss: 1.0880, weighted_loss: 1.6866, label: 1, bag_size: 869
batch 299, loss: 0.0038, instance_loss: 0.3460, weighted_loss: 0.1065, label: 1, bag_size: 4578
batch 319, loss: 0.9652, instance_loss: 0.8706, weighted_loss: 0.9368, label: 2, bag_size: 1513
batch 339, loss: 0.0448, instance_loss: 0.3668, weighted_loss: 0.1414, label: 0, bag_size: 2094
batch 359, loss: 1.8181, instance_loss: 0.7269, weighted_loss: 1.4908, label: 0, bag_size: 4921
batch 379, loss: 0.0659, instance_loss: 0.1833, weighted_loss: 0.1011, label: 1, bag_size: 1221
batch 399, loss: 0.4665, instance_loss: 0.3520, weighted_loss: 0.4321, label: 2, bag_size: 3112
batch 419, loss: 1.0143, instance_loss: 0.7139, weighted_loss: 0.9242, label: 0, bag_size: 2915
batch 439, loss: 1.1878, instance_loss: 0.9220, weighted_loss: 1.1081, label: 1, bag_size: 1607
batch 459, loss: 0.1817, instance_loss: 0.3606, weighted_loss: 0.2354, label: 0, bag_size: 6971
batch 479, loss: 0.0504, instance_loss: 0.2520, weighted_loss: 0.1109, label: 0, bag_size: 667
batch 499, loss: 0.0000, instance_loss: 0.0643, weighted_loss: 0.0193, label: 1, bag_size: 5462
batch 519, loss: 0.0626, instance_loss: 0.4068, weighted_loss: 0.1658, label: 0, bag_size: 4147
batch 539, loss: 0.4978, instance_loss: 0.5362, weighted_loss: 0.5093, label: 1, bag_size: 4069
batch 559, loss: 0.0760, instance_loss: 0.1888, weighted_loss: 0.1098, label: 2, bag_size: 4056
batch 579, loss: 0.0977, instance_loss: 0.4213, weighted_loss: 0.1948, label: 1, bag_size: 3755
batch 599, loss: 0.1050, instance_loss: 0.2135, weighted_loss: 0.1375, label: 1, bag_size: 4184
batch 619, loss: 0.8120, instance_loss: 0.9126, weighted_loss: 0.8422, label: 2, bag_size: 6594
batch 639, loss: 0.6620, instance_loss: 0.9422, weighted_loss: 0.7460, label: 0, bag_size: 477
batch 659, loss: 0.8082, instance_loss: 0.9781, weighted_loss: 0.8591, label: 2, bag_size: 3604
batch 679, loss: 1.4006, instance_loss: 0.7020, weighted_loss: 1.1910, label: 1, bag_size: 3438
batch 699, loss: 1.8607, instance_loss: 1.5485, weighted_loss: 1.7671, label: 0, bag_size: 1289
batch 719, loss: 0.0226, instance_loss: 0.3709, weighted_loss: 0.1271, label: 0, bag_size: 4458
batch 739, loss: 0.0274, instance_loss: 0.2857, weighted_loss: 0.1049, label: 0, bag_size: 4332


class 0 clustering acc 0.9757270693512304: correct 17446/17880
class 1 clustering acc 0.30318791946308726: correct 1807/5960
Epoch: 31, train_loss: 0.6031, train_clustering_loss:  0.5712, train_error: 0.2362
class 0: acc 0.7662337662337663, correct 177/231
class 1: acc 0.7234848484848485, correct 191/264
class 2: acc 0.804, correct 201/250

Val Set, val_loss: 0.7050, val_error: 0.2872, auc: 0.8878
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.31648936170212766: correct 238/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 2.1706, instance_loss: 1.3948, weighted_loss: 1.9379, label: 0, bag_size: 1755
batch 39, loss: 2.2483, instance_loss: 0.9911, weighted_loss: 1.8711, label: 2, bag_size: 909
batch 59, loss: 0.0240, instance_loss: 0.2142, weighted_loss: 0.0811, label: 0, bag_size: 1006
batch 79, loss: 0.6298, instance_loss: 1.0405, weighted_loss: 0.7530, label: 1, bag_size: 6315
batch 99, loss: 1.1512, instance_loss: 0.8468, weighted_loss: 1.0599, label: 1, bag_size: 5197
batch 119, loss: 0.4913, instance_loss: 0.8475, weighted_loss: 0.5982, label: 1, bag_size: 3184
batch 139, loss: 0.3943, instance_loss: 0.6933, weighted_loss: 0.4840, label: 2, bag_size: 3604
batch 159, loss: 0.1344, instance_loss: 0.3986, weighted_loss: 0.2137, label: 0, bag_size: 1625
batch 179, loss: 0.2534, instance_loss: 0.4091, weighted_loss: 0.3001, label: 0, bag_size: 1611
batch 199, loss: 0.0235, instance_loss: 0.4797, weighted_loss: 0.1603, label: 2, bag_size: 4497
batch 219, loss: 0.0080, instance_loss: 0.1496, weighted_loss: 0.0505, label: 0, bag_size: 6221
batch 239, loss: 0.2070, instance_loss: 0.4330, weighted_loss: 0.2748, label: 2, bag_size: 22464
batch 259, loss: 0.0659, instance_loss: 0.7576, weighted_loss: 0.2734, label: 0, bag_size: 1601
batch 279, loss: 0.0345, instance_loss: 0.0935, weighted_loss: 0.0522, label: 0, bag_size: 3437
batch 299, loss: 0.2332, instance_loss: 0.5273, weighted_loss: 0.3214, label: 0, bag_size: 4416
batch 319, loss: 0.0177, instance_loss: 0.0761, weighted_loss: 0.0352, label: 2, bag_size: 3415
batch 339, loss: 0.8678, instance_loss: 0.6623, weighted_loss: 0.8061, label: 1, bag_size: 1066
batch 359, loss: 0.0058, instance_loss: 0.3572, weighted_loss: 0.1112, label: 2, bag_size: 5037
batch 379, loss: 1.4419, instance_loss: 1.1030, weighted_loss: 1.3403, label: 1, bag_size: 5880
batch 399, loss: 0.0030, instance_loss: 0.1869, weighted_loss: 0.0582, label: 0, bag_size: 3438
batch 419, loss: 0.7225, instance_loss: 0.6600, weighted_loss: 0.7037, label: 2, bag_size: 3604
batch 439, loss: 0.0326, instance_loss: 0.1315, weighted_loss: 0.0622, label: 2, bag_size: 2561
batch 459, loss: 0.0247, instance_loss: 0.1697, weighted_loss: 0.0682, label: 2, bag_size: 5138
batch 479, loss: 0.9102, instance_loss: 1.2611, weighted_loss: 1.0154, label: 1, bag_size: 5205
batch 499, loss: 1.5432, instance_loss: 0.9528, weighted_loss: 1.3661, label: 1, bag_size: 5873
batch 519, loss: 0.0809, instance_loss: 0.5524, weighted_loss: 0.2223, label: 2, bag_size: 4487
batch 539, loss: 0.1693, instance_loss: 0.1933, weighted_loss: 0.1765, label: 2, bag_size: 3497
batch 559, loss: 0.2217, instance_loss: 0.3925, weighted_loss: 0.2729, label: 0, bag_size: 4282
batch 579, loss: 0.6623, instance_loss: 1.0666, weighted_loss: 0.7836, label: 2, bag_size: 3299
batch 599, loss: 0.0242, instance_loss: 0.3380, weighted_loss: 0.1183, label: 0, bag_size: 1176
batch 619, loss: 0.7672, instance_loss: 0.5897, weighted_loss: 0.7139, label: 1, bag_size: 800
batch 639, loss: 0.6742, instance_loss: 0.5423, weighted_loss: 0.6346, label: 1, bag_size: 800
batch 659, loss: 0.5964, instance_loss: 0.3120, weighted_loss: 0.5111, label: 2, bag_size: 3227
batch 679, loss: 0.0849, instance_loss: 0.5064, weighted_loss: 0.2113, label: 0, bag_size: 2712
batch 699, loss: 0.0467, instance_loss: 0.1413, weighted_loss: 0.0751, label: 2, bag_size: 2313
batch 719, loss: 1.6042, instance_loss: 0.8410, weighted_loss: 1.3752, label: 1, bag_size: 2055
batch 739, loss: 1.5851, instance_loss: 1.5500, weighted_loss: 1.5745, label: 1, bag_size: 1558


class 0 clustering acc 0.9732102908277405: correct 17401/17880
class 1 clustering acc 0.3743288590604027: correct 2231/5960
Epoch: 32, train_loss: 0.5566, train_clustering_loss:  0.5319, train_error: 0.2376
class 0: acc 0.7739130434782608, correct 178/230
class 1: acc 0.6666666666666666, correct 154/231
class 2: acc 0.8309859154929577, correct 236/284

Val Set, val_loss: 0.8856, val_error: 0.3617, auc: 0.8823
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.18085106382978725: correct 136/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1474, instance_loss: 0.3784, weighted_loss: 0.2167, label: 0, bag_size: 5837
batch 39, loss: 0.8476, instance_loss: 0.8077, weighted_loss: 0.8356, label: 1, bag_size: 3935
batch 59, loss: 0.0955, instance_loss: 0.5854, weighted_loss: 0.2425, label: 0, bag_size: 4529
batch 79, loss: 0.3979, instance_loss: 0.3272, weighted_loss: 0.3767, label: 2, bag_size: 597
batch 99, loss: 0.0176, instance_loss: 0.4502, weighted_loss: 0.1474, label: 0, bag_size: 2607
batch 119, loss: 0.0837, instance_loss: 0.5061, weighted_loss: 0.2104, label: 1, bag_size: 2796
batch 139, loss: 0.6619, instance_loss: 0.6385, weighted_loss: 0.6549, label: 0, bag_size: 3075
batch 159, loss: 0.7837, instance_loss: 0.7331, weighted_loss: 0.7685, label: 1, bag_size: 817
batch 179, loss: 0.3990, instance_loss: 0.6406, weighted_loss: 0.4714, label: 1, bag_size: 4373
batch 199, loss: 0.4348, instance_loss: 0.7408, weighted_loss: 0.5266, label: 1, bag_size: 3821
batch 219, loss: 1.7187, instance_loss: 1.4493, weighted_loss: 1.6379, label: 1, bag_size: 5205
batch 239, loss: 0.1491, instance_loss: 0.2289, weighted_loss: 0.1731, label: 2, bag_size: 3176
batch 259, loss: 0.7937, instance_loss: 0.7241, weighted_loss: 0.7728, label: 2, bag_size: 1543
batch 279, loss: 0.4094, instance_loss: 0.6466, weighted_loss: 0.4806, label: 1, bag_size: 1122
batch 299, loss: 0.2318, instance_loss: 0.4104, weighted_loss: 0.2853, label: 1, bag_size: 2865
batch 319, loss: 0.6936, instance_loss: 0.5706, weighted_loss: 0.6567, label: 1, bag_size: 2744
batch 339, loss: 0.0097, instance_loss: 0.4128, weighted_loss: 0.1307, label: 1, bag_size: 5760
batch 359, loss: 0.3181, instance_loss: 0.3642, weighted_loss: 0.3319, label: 1, bag_size: 4184
batch 379, loss: 0.8070, instance_loss: 0.9238, weighted_loss: 0.8421, label: 0, bag_size: 4725
batch 399, loss: 1.0086, instance_loss: 1.1574, weighted_loss: 1.0532, label: 0, bag_size: 6249
batch 419, loss: 0.3571, instance_loss: 0.6500, weighted_loss: 0.4450, label: 2, bag_size: 5472
batch 439, loss: 0.0042, instance_loss: 0.1081, weighted_loss: 0.0354, label: 1, bag_size: 4578
batch 459, loss: 0.0774, instance_loss: 0.5991, weighted_loss: 0.2339, label: 0, bag_size: 7927
batch 479, loss: 0.7056, instance_loss: 0.9849, weighted_loss: 0.7894, label: 0, bag_size: 1883
batch 499, loss: 0.4124, instance_loss: 0.3600, weighted_loss: 0.3967, label: 2, bag_size: 705
batch 519, loss: 0.0214, instance_loss: 0.1300, weighted_loss: 0.0539, label: 1, bag_size: 460
batch 539, loss: 1.0912, instance_loss: 0.9229, weighted_loss: 1.0407, label: 1, bag_size: 1313
batch 559, loss: 0.2237, instance_loss: 0.6087, weighted_loss: 0.3392, label: 1, bag_size: 3265
batch 579, loss: 0.0285, instance_loss: 0.7337, weighted_loss: 0.2401, label: 1, bag_size: 6513
batch 599, loss: 0.1427, instance_loss: 0.3239, weighted_loss: 0.1971, label: 2, bag_size: 3618
batch 619, loss: 0.0000, instance_loss: 1.1961, weighted_loss: 0.3589, label: 0, bag_size: 1709
batch 639, loss: 0.3443, instance_loss: 0.4946, weighted_loss: 0.3894, label: 1, bag_size: 3225
batch 659, loss: 0.5680, instance_loss: 1.0813, weighted_loss: 0.7220, label: 0, bag_size: 4351
batch 679, loss: 0.0413, instance_loss: 0.6668, weighted_loss: 0.2289, label: 0, bag_size: 1933
batch 699, loss: 0.3556, instance_loss: 0.5190, weighted_loss: 0.4046, label: 1, bag_size: 3991
batch 719, loss: 0.0512, instance_loss: 0.2599, weighted_loss: 0.1138, label: 2, bag_size: 3285
batch 739, loss: 1.8977, instance_loss: 1.2033, weighted_loss: 1.6894, label: 2, bag_size: 1513


class 0 clustering acc 0.9733221476510067: correct 17403/17880
class 1 clustering acc 0.3119127516778524: correct 1859/5960
Epoch: 33, train_loss: 0.5852, train_clustering_loss:  0.5693, train_error: 0.2510
class 0: acc 0.7695652173913043, correct 177/230
class 1: acc 0.6931818181818182, correct 183/264
class 2: acc 0.7888446215139442, correct 198/251

Val Set, val_loss: 0.7002, val_error: 0.2447, auc: 0.8860
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.363031914893617: correct 273/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.8005, instance_loss: 0.6016, weighted_loss: 0.7408, label: 0, bag_size: 5098
batch 39, loss: 3.6365, instance_loss: 1.5827, weighted_loss: 3.0204, label: 1, bag_size: 4258
batch 59, loss: 0.0362, instance_loss: 0.4925, weighted_loss: 0.1731, label: 0, bag_size: 3182
batch 79, loss: 0.6691, instance_loss: 0.7549, weighted_loss: 0.6948, label: 2, bag_size: 3274
batch 99, loss: 0.1531, instance_loss: 0.2943, weighted_loss: 0.1955, label: 0, bag_size: 5570
batch 119, loss: 0.4160, instance_loss: 0.5852, weighted_loss: 0.4668, label: 0, bag_size: 4584
batch 139, loss: 4.7381, instance_loss: 1.5538, weighted_loss: 3.7828, label: 0, bag_size: 603
batch 159, loss: 0.3136, instance_loss: 0.4435, weighted_loss: 0.3526, label: 1, bag_size: 5003
batch 179, loss: 1.0110, instance_loss: 1.1537, weighted_loss: 1.0538, label: 2, bag_size: 22464
batch 199, loss: 0.1346, instance_loss: 0.7281, weighted_loss: 0.3126, label: 2, bag_size: 5017
batch 219, loss: 0.0438, instance_loss: 0.2779, weighted_loss: 0.1140, label: 2, bag_size: 2031
batch 239, loss: 0.2972, instance_loss: 0.6911, weighted_loss: 0.4154, label: 0, bag_size: 673
batch 259, loss: 0.6298, instance_loss: 0.6540, weighted_loss: 0.6370, label: 1, bag_size: 4200
batch 279, loss: 0.0042, instance_loss: 0.0857, weighted_loss: 0.0286, label: 0, bag_size: 4196
batch 299, loss: 0.0518, instance_loss: 0.3485, weighted_loss: 0.1408, label: 1, bag_size: 5760
batch 319, loss: 0.0160, instance_loss: 0.2973, weighted_loss: 0.1004, label: 0, bag_size: 1485
batch 339, loss: 0.2961, instance_loss: 0.2682, weighted_loss: 0.2878, label: 1, bag_size: 1410
batch 359, loss: 1.3812, instance_loss: 0.7345, weighted_loss: 1.1872, label: 2, bag_size: 4691
batch 379, loss: 0.0703, instance_loss: 0.3003, weighted_loss: 0.1393, label: 0, bag_size: 966
batch 399, loss: 3.6740, instance_loss: 1.2781, weighted_loss: 2.9552, label: 0, bag_size: 1365
batch 419, loss: 0.0466, instance_loss: 0.3288, weighted_loss: 0.1312, label: 0, bag_size: 1006
batch 439, loss: 0.5542, instance_loss: 0.7950, weighted_loss: 0.6265, label: 0, bag_size: 1353
batch 459, loss: 0.0410, instance_loss: 0.7770, weighted_loss: 0.2618, label: 1, bag_size: 3475
batch 479, loss: 0.1523, instance_loss: 0.2694, weighted_loss: 0.1875, label: 0, bag_size: 4092
batch 499, loss: 0.1162, instance_loss: 0.2631, weighted_loss: 0.1603, label: 2, bag_size: 3176
batch 519, loss: 0.2504, instance_loss: 0.2997, weighted_loss: 0.2652, label: 2, bag_size: 4691
batch 539, loss: 0.0891, instance_loss: 0.3066, weighted_loss: 0.1544, label: 2, bag_size: 3810
batch 559, loss: 0.0509, instance_loss: 0.1886, weighted_loss: 0.0922, label: 0, bag_size: 3408
batch 579, loss: 0.0698, instance_loss: 0.2006, weighted_loss: 0.1091, label: 0, bag_size: 5375
batch 599, loss: 0.1369, instance_loss: 0.2465, weighted_loss: 0.1697, label: 2, bag_size: 6704
batch 619, loss: 0.5499, instance_loss: 0.5766, weighted_loss: 0.5579, label: 1, bag_size: 2156
batch 639, loss: 0.6193, instance_loss: 0.6874, weighted_loss: 0.6397, label: 1, bag_size: 9099
batch 659, loss: 0.2679, instance_loss: 0.2474, weighted_loss: 0.2618, label: 2, bag_size: 2049
batch 679, loss: 3.9948, instance_loss: 1.7140, weighted_loss: 3.3105, label: 1, bag_size: 4258
batch 699, loss: 0.1452, instance_loss: 0.6679, weighted_loss: 0.3020, label: 1, bag_size: 5340
batch 719, loss: 0.1890, instance_loss: 0.1995, weighted_loss: 0.1922, label: 0, bag_size: 5368
batch 739, loss: 0.0500, instance_loss: 0.1686, weighted_loss: 0.0856, label: 2, bag_size: 2997


class 0 clustering acc 0.9720917225950783: correct 17381/17880
class 1 clustering acc 0.37298657718120803: correct 2223/5960
Epoch: 34, train_loss: 0.5427, train_clustering_loss:  0.5379, train_error: 0.2309
class 0: acc 0.7760617760617761, correct 201/259
class 1: acc 0.72, correct 180/250
class 2: acc 0.8135593220338984, correct 192/236

Val Set, val_loss: 0.6418, val_error: 0.2447, auc: 0.8874
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.40558510638297873: correct 305/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0029, instance_loss: 0.0819, weighted_loss: 0.0266, label: 1, bag_size: 460
batch 39, loss: 0.0021, instance_loss: 0.2214, weighted_loss: 0.0679, label: 0, bag_size: 4922
batch 59, loss: 0.0649, instance_loss: 0.3233, weighted_loss: 0.1424, label: 0, bag_size: 4794
batch 79, loss: 0.0176, instance_loss: 0.0915, weighted_loss: 0.0397, label: 2, bag_size: 88
batch 99, loss: 0.7265, instance_loss: 1.1653, weighted_loss: 0.8582, label: 2, bag_size: 3299
batch 119, loss: 0.0186, instance_loss: 0.1213, weighted_loss: 0.0494, label: 2, bag_size: 2313
batch 139, loss: 0.1215, instance_loss: 0.4835, weighted_loss: 0.2301, label: 0, bag_size: 667
batch 159, loss: 0.6970, instance_loss: 0.5568, weighted_loss: 0.6550, label: 0, bag_size: 4935
batch 179, loss: 0.6150, instance_loss: 0.3946, weighted_loss: 0.5489, label: 1, bag_size: 1221
batch 199, loss: 0.2453, instance_loss: 0.4289, weighted_loss: 0.3004, label: 0, bag_size: 598
batch 219, loss: 0.3066, instance_loss: 0.6479, weighted_loss: 0.4090, label: 1, bag_size: 2747
batch 239, loss: 0.4279, instance_loss: 0.8520, weighted_loss: 0.5551, label: 0, bag_size: 2153
batch 259, loss: 1.0992, instance_loss: 0.6464, weighted_loss: 0.9634, label: 1, bag_size: 3786
batch 279, loss: 1.6718, instance_loss: 0.9161, weighted_loss: 1.4451, label: 1, bag_size: 2642
batch 299, loss: 0.2484, instance_loss: 0.4759, weighted_loss: 0.3166, label: 0, bag_size: 5656
batch 319, loss: 0.4903, instance_loss: 0.5001, weighted_loss: 0.4933, label: 0, bag_size: 4935
batch 339, loss: 0.5207, instance_loss: 0.6854, weighted_loss: 0.5701, label: 0, bag_size: 1373
batch 359, loss: 0.0003, instance_loss: 0.5864, weighted_loss: 0.1762, label: 0, bag_size: 3594
batch 379, loss: 0.3204, instance_loss: 0.5457, weighted_loss: 0.3880, label: 1, bag_size: 2743
batch 399, loss: 0.6228, instance_loss: 0.6408, weighted_loss: 0.6282, label: 1, bag_size: 5276
batch 419, loss: 0.3939, instance_loss: 0.6122, weighted_loss: 0.4594, label: 1, bag_size: 1066
batch 439, loss: 0.2355, instance_loss: 0.2292, weighted_loss: 0.2336, label: 0, bag_size: 4405
batch 459, loss: 0.6726, instance_loss: 0.5061, weighted_loss: 0.6227, label: 0, bag_size: 5526
batch 479, loss: 0.0169, instance_loss: 0.0808, weighted_loss: 0.0360, label: 2, bag_size: 657
batch 499, loss: 0.0658, instance_loss: 0.1515, weighted_loss: 0.0915, label: 2, bag_size: 2359
batch 519, loss: 0.7470, instance_loss: 0.7206, weighted_loss: 0.7391, label: 1, bag_size: 3424
batch 539, loss: 0.2327, instance_loss: 0.5414, weighted_loss: 0.3253, label: 0, bag_size: 4794
batch 559, loss: 0.2703, instance_loss: 0.5865, weighted_loss: 0.3652, label: 1, bag_size: 6689
batch 579, loss: 0.1961, instance_loss: 0.1885, weighted_loss: 0.1938, label: 2, bag_size: 2501
batch 599, loss: 0.2129, instance_loss: 0.6190, weighted_loss: 0.3347, label: 2, bag_size: 4141
batch 619, loss: 0.9650, instance_loss: 0.6729, weighted_loss: 0.8774, label: 2, bag_size: 5406
batch 639, loss: 0.2323, instance_loss: 0.2609, weighted_loss: 0.2409, label: 2, bag_size: 2359
batch 659, loss: 0.0651, instance_loss: 0.1273, weighted_loss: 0.0838, label: 2, bag_size: 3210
batch 679, loss: 0.0688, instance_loss: 0.1580, weighted_loss: 0.0956, label: 0, bag_size: 4455
batch 699, loss: 0.0962, instance_loss: 0.2185, weighted_loss: 0.1329, label: 0, bag_size: 4562
batch 719, loss: 0.0733, instance_loss: 0.1572, weighted_loss: 0.0984, label: 0, bag_size: 2290
batch 739, loss: 1.1364, instance_loss: 1.0652, weighted_loss: 1.1150, label: 1, bag_size: 1477


class 0 clustering acc 0.9686800894854586: correct 17320/17880
class 1 clustering acc 0.3585570469798658: correct 2137/5960
Epoch: 35, train_loss: 0.5325, train_clustering_loss:  0.5470, train_error: 0.2081
class 0: acc 0.7975708502024291, correct 197/247
class 1: acc 0.7306122448979592, correct 179/245
class 2: acc 0.8458498023715415, correct 214/253

Val Set, val_loss: 0.6065, val_error: 0.2872, auc: 0.9037
class 0 clustering acc 0.9893617021276596: correct 2232/2256
class 1 clustering acc 0.2978723404255319: correct 224/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.606672 --> 0.606542).  Saving model ...


batch 19, loss: 0.2801, instance_loss: 0.5479, weighted_loss: 0.3605, label: 1, bag_size: 4192
batch 39, loss: 0.3359, instance_loss: 0.2955, weighted_loss: 0.3238, label: 2, bag_size: 614
batch 59, loss: 0.1279, instance_loss: 0.4345, weighted_loss: 0.2199, label: 0, bag_size: 2094
batch 79, loss: 0.2591, instance_loss: 0.6716, weighted_loss: 0.3828, label: 1, bag_size: 4644
batch 99, loss: 2.8154, instance_loss: 1.2551, weighted_loss: 2.3473, label: 1, bag_size: 3791
batch 119, loss: 0.0039, instance_loss: 0.4406, weighted_loss: 0.1349, label: 1, bag_size: 4181
batch 139, loss: 0.1566, instance_loss: 0.3448, weighted_loss: 0.2131, label: 2, bag_size: 3327
batch 159, loss: 3.7976, instance_loss: 1.1547, weighted_loss: 3.0048, label: 0, bag_size: 557
batch 179, loss: 1.2281, instance_loss: 0.6900, weighted_loss: 1.0667, label: 1, bag_size: 1860
batch 199, loss: 0.0451, instance_loss: 0.1003, weighted_loss: 0.0616, label: 2, bag_size: 2997
batch 219, loss: 0.2856, instance_loss: 0.3778, weighted_loss: 0.3132, label: 1, bag_size: 2494
batch 239, loss: 0.4427, instance_loss: 0.6238, weighted_loss: 0.4970, label: 2, bag_size: 3274
batch 259, loss: 0.0998, instance_loss: 0.1440, weighted_loss: 0.1131, label: 2, bag_size: 2049
batch 279, loss: 1.0897, instance_loss: 0.7291, weighted_loss: 0.9815, label: 1, bag_size: 1712
batch 299, loss: 5.9823, instance_loss: 2.0439, weighted_loss: 4.8007, label: 0, bag_size: 3750
batch 319, loss: 1.1035, instance_loss: 0.6754, weighted_loss: 0.9750, label: 0, bag_size: 4450
batch 339, loss: 2.1099, instance_loss: 0.3342, weighted_loss: 1.5772, label: 2, bag_size: 88
batch 359, loss: 0.0024, instance_loss: 0.3345, weighted_loss: 0.1021, label: 1, bag_size: 3172
batch 379, loss: 0.0616, instance_loss: 0.3388, weighted_loss: 0.1447, label: 2, bag_size: 4192
batch 399, loss: 0.0043, instance_loss: 0.3401, weighted_loss: 0.1051, label: 2, bag_size: 4088
batch 419, loss: 0.3702, instance_loss: 0.4773, weighted_loss: 0.4023, label: 2, bag_size: 3746
batch 439, loss: 0.3225, instance_loss: 0.3360, weighted_loss: 0.3266, label: 2, bag_size: 3746
batch 459, loss: 0.7695, instance_loss: 0.6835, weighted_loss: 0.7437, label: 1, bag_size: 1607
batch 479, loss: 0.0405, instance_loss: 0.2457, weighted_loss: 0.1021, label: 0, bag_size: 4071
batch 499, loss: 0.3688, instance_loss: 0.6503, weighted_loss: 0.4532, label: 0, bag_size: 2153
batch 519, loss: 1.1525, instance_loss: 0.9389, weighted_loss: 1.0884, label: 1, bag_size: 3422
batch 539, loss: 0.4297, instance_loss: 0.4748, weighted_loss: 0.4432, label: 0, bag_size: 5146
batch 559, loss: 0.0829, instance_loss: 0.3351, weighted_loss: 0.1585, label: 2, bag_size: 4856
batch 579, loss: 0.1277, instance_loss: 0.4519, weighted_loss: 0.2249, label: 2, bag_size: 4487
batch 599, loss: 0.1602, instance_loss: 0.2484, weighted_loss: 0.1867, label: 2, bag_size: 4555
batch 619, loss: 0.5325, instance_loss: 0.8946, weighted_loss: 0.6411, label: 1, bag_size: 3821
batch 639, loss: 0.9208, instance_loss: 0.9024, weighted_loss: 0.9153, label: 1, bag_size: 869
batch 659, loss: 0.5032, instance_loss: 0.5021, weighted_loss: 0.5029, label: 0, bag_size: 272
batch 679, loss: 0.9727, instance_loss: 0.5513, weighted_loss: 0.8463, label: 0, bag_size: 7315
batch 699, loss: 0.1198, instance_loss: 0.3955, weighted_loss: 0.2025, label: 0, bag_size: 3885
batch 719, loss: 0.4105, instance_loss: 0.2495, weighted_loss: 0.3622, label: 2, bag_size: 597
batch 739, loss: 1.3030, instance_loss: 0.9085, weighted_loss: 1.1847, label: 0, bag_size: 4220


class 0 clustering acc 0.9708612975391498: correct 17359/17880
class 1 clustering acc 0.33859060402684565: correct 2018/5960
Epoch: 36, train_loss: 0.5688, train_clustering_loss:  0.5599, train_error: 0.2376
class 0: acc 0.7510204081632653, correct 184/245
class 1: acc 0.7090163934426229, correct 173/244
class 2: acc 0.82421875, correct 211/256

Val Set, val_loss: 0.7814, val_error: 0.2979, auc: 0.8913
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.14893617021276595: correct 112/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0006, instance_loss: 0.0802, weighted_loss: 0.0244, label: 1, bag_size: 3338
batch 39, loss: 0.2228, instance_loss: 0.4081, weighted_loss: 0.2784, label: 1, bag_size: 796
batch 59, loss: 0.5491, instance_loss: 0.6871, weighted_loss: 0.5905, label: 0, bag_size: 768
batch 79, loss: 0.1208, instance_loss: 0.5632, weighted_loss: 0.2535, label: 2, bag_size: 3607
batch 99, loss: 0.1232, instance_loss: 0.5958, weighted_loss: 0.2650, label: 1, bag_size: 2182
batch 119, loss: 0.3507, instance_loss: 0.4270, weighted_loss: 0.3736, label: 2, bag_size: 6644
batch 139, loss: 0.3306, instance_loss: 0.2702, weighted_loss: 0.3125, label: 2, bag_size: 2501
batch 159, loss: 0.1051, instance_loss: 0.3829, weighted_loss: 0.1884, label: 1, bag_size: 782
batch 179, loss: 3.2036, instance_loss: 1.5973, weighted_loss: 2.7217, label: 0, bag_size: 1071
batch 199, loss: 0.1936, instance_loss: 0.3679, weighted_loss: 0.2459, label: 0, bag_size: 2767
batch 219, loss: 0.4050, instance_loss: 0.4160, weighted_loss: 0.4083, label: 0, bag_size: 4509
batch 239, loss: 0.1254, instance_loss: 0.7467, weighted_loss: 0.3118, label: 0, bag_size: 4841
batch 259, loss: 0.0396, instance_loss: 0.2658, weighted_loss: 0.1075, label: 1, bag_size: 4898
batch 279, loss: 0.0891, instance_loss: 0.1619, weighted_loss: 0.1109, label: 2, bag_size: 2501
batch 299, loss: 0.7399, instance_loss: 0.8976, weighted_loss: 0.7872, label: 2, bag_size: 3475
batch 319, loss: 0.1687, instance_loss: 0.1849, weighted_loss: 0.1736, label: 2, bag_size: 3174
batch 339, loss: 0.0522, instance_loss: 0.2752, weighted_loss: 0.1191, label: 2, bag_size: 2313
batch 359, loss: 0.0476, instance_loss: 0.2947, weighted_loss: 0.1217, label: 2, bag_size: 3121
batch 379, loss: 0.1654, instance_loss: 0.2501, weighted_loss: 0.1908, label: 0, bag_size: 3437
batch 399, loss: 0.0425, instance_loss: 0.2850, weighted_loss: 0.1153, label: 0, bag_size: 5823
batch 419, loss: 0.3775, instance_loss: 0.2015, weighted_loss: 0.3247, label: 2, bag_size: 3227
batch 439, loss: 0.1259, instance_loss: 0.1596, weighted_loss: 0.1360, label: 2, bag_size: 5011
batch 459, loss: 0.0360, instance_loss: 0.4632, weighted_loss: 0.1641, label: 0, bag_size: 3268
batch 479, loss: 0.0039, instance_loss: 0.7342, weighted_loss: 0.2230, label: 0, bag_size: 3594
batch 499, loss: 0.0179, instance_loss: 0.2702, weighted_loss: 0.0936, label: 2, bag_size: 4497
batch 519, loss: 0.1068, instance_loss: 0.1834, weighted_loss: 0.1298, label: 0, bag_size: 2873
batch 539, loss: 0.7877, instance_loss: 0.5706, weighted_loss: 0.7226, label: 0, bag_size: 5098
batch 559, loss: 0.4227, instance_loss: 0.7028, weighted_loss: 0.5067, label: 1, bag_size: 4346
batch 579, loss: 0.0037, instance_loss: 0.2671, weighted_loss: 0.0827, label: 2, bag_size: 4497
batch 599, loss: 0.0290, instance_loss: 0.3555, weighted_loss: 0.1270, label: 0, bag_size: 4831
batch 619, loss: 0.0395, instance_loss: 0.1922, weighted_loss: 0.0853, label: 2, bag_size: 6273
batch 639, loss: 0.7610, instance_loss: 0.8086, weighted_loss: 0.7753, label: 1, bag_size: 1712
batch 659, loss: 1.0298, instance_loss: 0.5657, weighted_loss: 0.8906, label: 2, bag_size: 909
batch 679, loss: 0.6212, instance_loss: 0.6264, weighted_loss: 0.6227, label: 0, bag_size: 3841
batch 699, loss: 2.1250, instance_loss: 1.1099, weighted_loss: 1.8205, label: 1, bag_size: 5035
batch 719, loss: 0.0563, instance_loss: 0.2730, weighted_loss: 0.1213, label: 0, bag_size: 3793
batch 739, loss: 0.0260, instance_loss: 0.0641, weighted_loss: 0.0375, label: 2, bag_size: 2313


class 0 clustering acc 0.973434004474273: correct 17405/17880
class 1 clustering acc 0.398993288590604: correct 2378/5960
Epoch: 37, train_loss: 0.4987, train_clustering_loss:  0.5194, train_error: 0.1960
class 0: acc 0.8171206225680934, correct 210/257
class 1: acc 0.6964285714285714, correct 156/224
class 2: acc 0.8825757575757576, correct 233/264

Val Set, val_loss: 0.7146, val_error: 0.2766, auc: 0.8847
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.4454787234042553: correct 335/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.6969, instance_loss: 1.0323, weighted_loss: 2.1976, label: 2, bag_size: 1513
batch 39, loss: 0.0046, instance_loss: 0.3860, weighted_loss: 0.1190, label: 1, bag_size: 4027
batch 59, loss: 0.3193, instance_loss: 0.3911, weighted_loss: 0.3409, label: 2, bag_size: 3618
batch 79, loss: 0.4383, instance_loss: 0.6714, weighted_loss: 0.5083, label: 0, bag_size: 5041
batch 99, loss: 0.5135, instance_loss: 0.4577, weighted_loss: 0.4968, label: 2, bag_size: 552
batch 119, loss: 1.6042, instance_loss: 1.0696, weighted_loss: 1.4438, label: 1, bag_size: 1364
batch 139, loss: 0.1710, instance_loss: 0.1926, weighted_loss: 0.1775, label: 2, bag_size: 4056
batch 159, loss: 0.1135, instance_loss: 0.3701, weighted_loss: 0.1905, label: 1, bag_size: 4595
batch 179, loss: 0.6410, instance_loss: 0.9897, weighted_loss: 0.7456, label: 2, bag_size: 2813
batch 199, loss: 1.8993, instance_loss: 1.2738, weighted_loss: 1.7117, label: 1, bag_size: 7176
batch 219, loss: 0.0018, instance_loss: 0.5957, weighted_loss: 0.1800, label: 0, bag_size: 1055
batch 239, loss: 1.4732, instance_loss: 0.9148, weighted_loss: 1.3057, label: 1, bag_size: 3823
batch 259, loss: 0.6046, instance_loss: 0.6132, weighted_loss: 0.6071, label: 1, bag_size: 1595
batch 279, loss: 2.0407, instance_loss: 0.9980, weighted_loss: 1.7279, label: 0, bag_size: 3402
batch 299, loss: 0.1958, instance_loss: 0.3918, weighted_loss: 0.2546, label: 2, bag_size: 6704
batch 319, loss: 0.1077, instance_loss: 0.2271, weighted_loss: 0.1435, label: 2, bag_size: 4569
batch 339, loss: 0.2077, instance_loss: 0.4299, weighted_loss: 0.2744, label: 2, bag_size: 3618
batch 359, loss: 0.1957, instance_loss: 0.4766, weighted_loss: 0.2800, label: 0, bag_size: 5484
batch 379, loss: 1.2024, instance_loss: 0.8516, weighted_loss: 1.0972, label: 1, bag_size: 6152
batch 399, loss: 0.0439, instance_loss: 0.1903, weighted_loss: 0.0878, label: 0, bag_size: 6430
batch 419, loss: 1.0207, instance_loss: 1.0120, weighted_loss: 1.0181, label: 2, bag_size: 4241
batch 439, loss: 0.3319, instance_loss: 0.4909, weighted_loss: 0.3796, label: 1, bag_size: 3519
batch 459, loss: 0.2997, instance_loss: 0.2574, weighted_loss: 0.2870, label: 2, bag_size: 597
batch 479, loss: 0.2746, instance_loss: 0.5453, weighted_loss: 0.3558, label: 2, bag_size: 3604
batch 499, loss: 0.0492, instance_loss: 0.2478, weighted_loss: 0.1088, label: 2, bag_size: 3810
batch 519, loss: 2.1641, instance_loss: 1.3530, weighted_loss: 1.9208, label: 1, bag_size: 4258
batch 539, loss: 0.0200, instance_loss: 0.2055, weighted_loss: 0.0757, label: 2, bag_size: 5138
batch 559, loss: 0.2451, instance_loss: 0.5994, weighted_loss: 0.3514, label: 1, bag_size: 4644
batch 579, loss: 0.9860, instance_loss: 0.9567, weighted_loss: 0.9772, label: 1, bag_size: 5880
batch 599, loss: 0.2179, instance_loss: 0.3212, weighted_loss: 0.2489, label: 2, bag_size: 614
batch 619, loss: 0.6500, instance_loss: 0.8724, weighted_loss: 0.7167, label: 0, bag_size: 3709
batch 639, loss: 1.0680, instance_loss: 0.8115, weighted_loss: 0.9911, label: 1, bag_size: 3424
batch 659, loss: 0.1192, instance_loss: 0.3508, weighted_loss: 0.1887, label: 0, bag_size: 2545
batch 679, loss: 0.0378, instance_loss: 0.2797, weighted_loss: 0.1104, label: 0, bag_size: 3219
batch 699, loss: 0.0877, instance_loss: 0.1999, weighted_loss: 0.1214, label: 2, bag_size: 2209
batch 719, loss: 0.2345, instance_loss: 0.3223, weighted_loss: 0.2608, label: 1, bag_size: 2753
batch 739, loss: 0.2188, instance_loss: 0.4310, weighted_loss: 0.2825, label: 0, bag_size: 3571


class 0 clustering acc 0.9690715883668903: correct 17327/17880
class 1 clustering acc 0.3699664429530201: correct 2205/5960
Epoch: 38, train_loss: 0.5615, train_clustering_loss:  0.5451, train_error: 0.2309
class 0: acc 0.7647058823529411, correct 182/238
class 1: acc 0.68, correct 170/250
class 2: acc 0.8599221789883269, correct 221/257

Val Set, val_loss: 0.6933, val_error: 0.3191, auc: 0.8778
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.4321808510638298: correct 325/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1677, instance_loss: 0.4519, weighted_loss: 0.2530, label: 2, bag_size: 3678
batch 39, loss: 0.2509, instance_loss: 0.5163, weighted_loss: 0.3305, label: 0, bag_size: 1141
batch 59, loss: 0.3917, instance_loss: 0.4551, weighted_loss: 0.4107, label: 2, bag_size: 4291
batch 79, loss: 2.0620, instance_loss: 1.0885, weighted_loss: 1.7699, label: 0, bag_size: 640
batch 99, loss: 0.0359, instance_loss: 0.2525, weighted_loss: 0.1009, label: 1, bag_size: 596
batch 119, loss: 0.8439, instance_loss: 0.9049, weighted_loss: 0.8622, label: 2, bag_size: 22464
batch 139, loss: 1.3441, instance_loss: 1.0085, weighted_loss: 1.2435, label: 1, bag_size: 4187
batch 159, loss: 0.1108, instance_loss: 0.5085, weighted_loss: 0.2301, label: 0, bag_size: 4227
batch 179, loss: 0.1008, instance_loss: 0.2107, weighted_loss: 0.1337, label: 2, bag_size: 3546
batch 199, loss: 1.0709, instance_loss: 0.6170, weighted_loss: 0.9348, label: 2, bag_size: 2326
batch 219, loss: 0.7567, instance_loss: 0.6928, weighted_loss: 0.7375, label: 1, bag_size: 4069
batch 239, loss: 0.2154, instance_loss: 0.9035, weighted_loss: 0.4218, label: 1, bag_size: 3755
batch 259, loss: 0.1824, instance_loss: 0.4101, weighted_loss: 0.2507, label: 2, bag_size: 1050
batch 279, loss: 0.0000, instance_loss: 0.1007, weighted_loss: 0.0302, label: 0, bag_size: 1106
batch 299, loss: 0.2905, instance_loss: 0.4883, weighted_loss: 0.3498, label: 1, bag_size: 4184
batch 319, loss: 0.0791, instance_loss: 0.3260, weighted_loss: 0.1532, label: 1, bag_size: 1595
batch 339, loss: 0.2777, instance_loss: 0.5857, weighted_loss: 0.3701, label: 0, bag_size: 3601
batch 359, loss: 0.0056, instance_loss: 0.5145, weighted_loss: 0.1583, label: 1, bag_size: 4027
batch 379, loss: 0.0080, instance_loss: 0.5148, weighted_loss: 0.1601, label: 1, bag_size: 3172
batch 399, loss: 0.0000, instance_loss: 0.1637, weighted_loss: 0.0491, label: 0, bag_size: 5053
batch 419, loss: 0.0339, instance_loss: 0.1553, weighted_loss: 0.0703, label: 0, bag_size: 5823
batch 439, loss: 0.5988, instance_loss: 0.6672, weighted_loss: 0.6193, label: 1, bag_size: 2731
batch 459, loss: 1.0783, instance_loss: 0.9057, weighted_loss: 1.0265, label: 1, bag_size: 4438
batch 479, loss: 0.0003, instance_loss: 0.3125, weighted_loss: 0.0939, label: 0, bag_size: 3594
batch 499, loss: 0.6564, instance_loss: 0.7969, weighted_loss: 0.6986, label: 1, bag_size: 5011
batch 519, loss: 0.7000, instance_loss: 0.9314, weighted_loss: 0.7694, label: 0, bag_size: 1289
batch 539, loss: 1.9113, instance_loss: 1.1242, weighted_loss: 1.6752, label: 0, bag_size: 436
batch 559, loss: 0.4915, instance_loss: 0.4562, weighted_loss: 0.4809, label: 0, bag_size: 3475
batch 579, loss: 0.2366, instance_loss: 0.2721, weighted_loss: 0.2472, label: 2, bag_size: 3746
batch 599, loss: 0.0184, instance_loss: 0.1435, weighted_loss: 0.0560, label: 1, bag_size: 758
batch 619, loss: 0.1251, instance_loss: 0.3137, weighted_loss: 0.1817, label: 2, bag_size: 6704
batch 639, loss: 0.0010, instance_loss: 0.2239, weighted_loss: 0.0679, label: 2, bag_size: 5037
batch 659, loss: 0.0474, instance_loss: 0.4928, weighted_loss: 0.1810, label: 0, bag_size: 5646
batch 679, loss: 0.0455, instance_loss: 0.2386, weighted_loss: 0.1034, label: 2, bag_size: 3121
batch 699, loss: 0.7246, instance_loss: 0.8949, weighted_loss: 0.7757, label: 2, bag_size: 724
batch 719, loss: 0.6982, instance_loss: 0.6192, weighted_loss: 0.6745, label: 2, bag_size: 2326
batch 739, loss: 0.0823, instance_loss: 0.1897, weighted_loss: 0.1145, label: 2, bag_size: 2313


class 0 clustering acc 0.9697986577181208: correct 17340/17880
class 1 clustering acc 0.4248322147651007: correct 2532/5960
Epoch: 39, train_loss: 0.5039, train_clustering_loss:  0.5141, train_error: 0.1960
class 0: acc 0.807843137254902, correct 206/255
class 1: acc 0.7110091743119266, correct 155/218
class 2: acc 0.875, correct 238/272

Val Set, val_loss: 0.7804, val_error: 0.2766, auc: 0.8826
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.2074468085106383: correct 156/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0780, instance_loss: 0.5952, weighted_loss: 0.2332, label: 0, bag_size: 5375
batch 39, loss: 0.0541, instance_loss: 0.5281, weighted_loss: 0.1963, label: 0, bag_size: 5519
batch 59, loss: 0.0220, instance_loss: 0.2388, weighted_loss: 0.0870, label: 0, bag_size: 4529
batch 79, loss: 0.1342, instance_loss: 0.2714, weighted_loss: 0.1754, label: 0, bag_size: 4378
batch 99, loss: 2.3812, instance_loss: 1.3717, weighted_loss: 2.0784, label: 2, bag_size: 3475
batch 119, loss: 0.2703, instance_loss: 0.3523, weighted_loss: 0.2949, label: 2, bag_size: 4096
batch 139, loss: 0.0367, instance_loss: 0.2587, weighted_loss: 0.1033, label: 2, bag_size: 3210
batch 159, loss: 4.6868, instance_loss: 1.9115, weighted_loss: 3.8542, label: 0, bag_size: 2736
batch 179, loss: 4.9614, instance_loss: 2.6087, weighted_loss: 4.2556, label: 0, bag_size: 1910
batch 199, loss: 0.2279, instance_loss: 0.4511, weighted_loss: 0.2949, label: 0, bag_size: 1647
batch 219, loss: 0.0197, instance_loss: 0.0972, weighted_loss: 0.0429, label: 0, bag_size: 3443
batch 239, loss: 0.0870, instance_loss: 0.2126, weighted_loss: 0.1247, label: 2, bag_size: 3497
batch 259, loss: 0.0725, instance_loss: 0.2176, weighted_loss: 0.1160, label: 0, bag_size: 3437
batch 279, loss: 0.5991, instance_loss: 0.7870, weighted_loss: 0.6555, label: 1, bag_size: 3126
batch 299, loss: 2.7183, instance_loss: 1.3117, weighted_loss: 2.2964, label: 1, bag_size: 1595
batch 319, loss: 0.3609, instance_loss: 0.2945, weighted_loss: 0.3410, label: 2, bag_size: 6644
batch 339, loss: 0.0007, instance_loss: 0.1841, weighted_loss: 0.0557, label: 1, bag_size: 4067
batch 359, loss: 1.3000, instance_loss: 0.7883, weighted_loss: 1.1465, label: 1, bag_size: 6241
batch 379, loss: 0.3845, instance_loss: 0.5298, weighted_loss: 0.4281, label: 2, bag_size: 4291
batch 399, loss: 1.8193, instance_loss: 1.0156, weighted_loss: 1.5782, label: 2, bag_size: 2326
batch 419, loss: 0.0368, instance_loss: 0.4589, weighted_loss: 0.1634, label: 2, bag_size: 5037
batch 439, loss: 0.0188, instance_loss: 0.0593, weighted_loss: 0.0310, label: 2, bag_size: 3285
batch 459, loss: 0.4344, instance_loss: 0.4382, weighted_loss: 0.4355, label: 0, bag_size: 3224
batch 479, loss: 0.0413, instance_loss: 0.2024, weighted_loss: 0.0896, label: 2, bag_size: 3121
batch 499, loss: 0.7970, instance_loss: 0.7479, weighted_loss: 0.7823, label: 2, bag_size: 1050
batch 519, loss: 0.0122, instance_loss: 0.2642, weighted_loss: 0.0878, label: 0, bag_size: 4326
batch 539, loss: 0.1726, instance_loss: 0.4328, weighted_loss: 0.2507, label: 1, bag_size: 4812
batch 559, loss: 0.1935, instance_loss: 0.3913, weighted_loss: 0.2528, label: 1, bag_size: 5696
batch 579, loss: 0.0933, instance_loss: 0.2295, weighted_loss: 0.1341, label: 2, bag_size: 3210
batch 599, loss: 0.3002, instance_loss: 0.5755, weighted_loss: 0.3828, label: 1, bag_size: 3586
batch 619, loss: 0.5149, instance_loss: 0.2036, weighted_loss: 0.4215, label: 0, bag_size: 4855
batch 639, loss: 0.0079, instance_loss: 0.1905, weighted_loss: 0.0627, label: 0, bag_size: 1132
batch 659, loss: 0.5146, instance_loss: 0.6173, weighted_loss: 0.5454, label: 1, bag_size: 6817
batch 679, loss: 1.1396, instance_loss: 0.7117, weighted_loss: 1.0112, label: 1, bag_size: 1807
batch 699, loss: 0.9284, instance_loss: 1.0671, weighted_loss: 0.9700, label: 1, bag_size: 3755
batch 719, loss: 0.0232, instance_loss: 0.0677, weighted_loss: 0.0365, label: 2, bag_size: 3210
batch 739, loss: 1.0701, instance_loss: 1.6312, weighted_loss: 1.2384, label: 1, bag_size: 3016


class 0 clustering acc 0.9679530201342282: correct 17307/17880
class 1 clustering acc 0.3884228187919463: correct 2315/5960
Epoch: 40, train_loss: 0.5282, train_clustering_loss:  0.5398, train_error: 0.2027
class 0: acc 0.8185328185328186, correct 212/259
class 1: acc 0.6977777777777778, correct 157/225
class 2: acc 0.8620689655172413, correct 225/261

Val Set, val_loss: 0.6035, val_error: 0.2340, auc: 0.8998
class 0 clustering acc 0.9556737588652482: correct 2156/2256
class 1 clustering acc 0.5186170212765957: correct 390/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.606542 --> 0.603503).  Saving model ...


batch 19, loss: 0.0054, instance_loss: 0.0425, weighted_loss: 0.0165, label: 2, bag_size: 2483
batch 39, loss: 3.1396, instance_loss: 1.4532, weighted_loss: 2.6337, label: 0, bag_size: 5259
batch 59, loss: 0.6206, instance_loss: 0.4473, weighted_loss: 0.5686, label: 2, bag_size: 6298
batch 79, loss: 0.9184, instance_loss: 1.0109, weighted_loss: 0.9462, label: 2, bag_size: 4342
batch 99, loss: 0.0363, instance_loss: 1.0615, weighted_loss: 0.3439, label: 1, bag_size: 3016
batch 119, loss: 0.0005, instance_loss: 0.8566, weighted_loss: 0.2573, label: 0, bag_size: 3594
batch 139, loss: 0.0053, instance_loss: 0.4454, weighted_loss: 0.1373, label: 1, bag_size: 4111
batch 159, loss: 0.3317, instance_loss: 0.4936, weighted_loss: 0.3803, label: 2, bag_size: 2313
batch 179, loss: 0.1167, instance_loss: 0.3457, weighted_loss: 0.1854, label: 2, bag_size: 4978
batch 199, loss: 0.0158, instance_loss: 0.4115, weighted_loss: 0.1345, label: 0, bag_size: 3319
batch 219, loss: 0.8594, instance_loss: 0.7579, weighted_loss: 0.8289, label: 1, bag_size: 2248
batch 239, loss: 0.0087, instance_loss: 0.0573, weighted_loss: 0.0233, label: 2, bag_size: 2483
batch 259, loss: 0.7625, instance_loss: 0.6942, weighted_loss: 0.7420, label: 0, bag_size: 272
batch 279, loss: 0.0774, instance_loss: 0.4498, weighted_loss: 0.1891, label: 0, bag_size: 420
batch 299, loss: 0.2021, instance_loss: 0.5306, weighted_loss: 0.3006, label: 0, bag_size: 4337
batch 319, loss: 0.1021, instance_loss: 0.8754, weighted_loss: 0.3341, label: 0, bag_size: 3886
batch 339, loss: 0.0381, instance_loss: 0.2809, weighted_loss: 0.1109, label: 0, bag_size: 7330
batch 359, loss: 0.0263, instance_loss: 0.1528, weighted_loss: 0.0642, label: 2, bag_size: 5138
batch 379, loss: 0.0557, instance_loss: 0.1301, weighted_loss: 0.0780, label: 2, bag_size: 4555
batch 399, loss: 0.1883, instance_loss: 0.2382, weighted_loss: 0.2033, label: 2, bag_size: 597
batch 419, loss: 0.6447, instance_loss: 0.8516, weighted_loss: 0.7068, label: 2, bag_size: 5406
batch 439, loss: 0.2535, instance_loss: 0.3182, weighted_loss: 0.2729, label: 0, bag_size: 5368
batch 459, loss: 0.0851, instance_loss: 0.3375, weighted_loss: 0.1608, label: 0, bag_size: 1417
batch 479, loss: 2.2797, instance_loss: 1.4099, weighted_loss: 2.0187, label: 1, bag_size: 5035
batch 499, loss: 0.5732, instance_loss: 0.7759, weighted_loss: 0.6340, label: 2, bag_size: 724
batch 519, loss: 0.8901, instance_loss: 0.5871, weighted_loss: 0.7992, label: 2, bag_size: 552
batch 539, loss: 0.0026, instance_loss: 0.3083, weighted_loss: 0.0943, label: 0, bag_size: 855
batch 559, loss: 0.0318, instance_loss: 0.0437, weighted_loss: 0.0353, label: 2, bag_size: 4056
batch 579, loss: 0.0009, instance_loss: 0.1614, weighted_loss: 0.0491, label: 2, bag_size: 5017
batch 599, loss: 0.0398, instance_loss: 0.6057, weighted_loss: 0.2096, label: 1, bag_size: 4111
batch 619, loss: 0.6104, instance_loss: 0.5946, weighted_loss: 0.6056, label: 2, bag_size: 4179
batch 639, loss: 0.0346, instance_loss: 0.3071, weighted_loss: 0.1164, label: 1, bag_size: 4181
batch 659, loss: 0.4275, instance_loss: 0.4237, weighted_loss: 0.4264, label: 0, bag_size: 5526
batch 679, loss: 0.6918, instance_loss: 0.9013, weighted_loss: 0.7546, label: 2, bag_size: 5426
batch 699, loss: 0.0280, instance_loss: 0.5904, weighted_loss: 0.1968, label: 0, bag_size: 4070
batch 719, loss: 3.3722, instance_loss: 1.2119, weighted_loss: 2.7241, label: 0, bag_size: 15388
batch 739, loss: 1.2068, instance_loss: 0.4423, weighted_loss: 0.9774, label: 2, bag_size: 2031


class 0 clustering acc 0.9725950782997763: correct 17390/17880
class 1 clustering acc 0.3959731543624161: correct 2360/5960
Epoch: 41, train_loss: 0.4791, train_clustering_loss:  0.5221, train_error: 0.1973
class 0: acc 0.8326180257510729, correct 194/233
class 1: acc 0.6863636363636364, correct 151/220
class 2: acc 0.8664383561643836, correct 253/292

Val Set, val_loss: 0.6508, val_error: 0.2234, auc: 0.9018
class 0 clustering acc 0.9663120567375887: correct 2180/2256
class 1 clustering acc 0.48271276595744683: correct 363/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0904, instance_loss: 0.1492, weighted_loss: 0.1081, label: 2, bag_size: 2905
batch 39, loss: 0.0880, instance_loss: 0.2596, weighted_loss: 0.1395, label: 0, bag_size: 7169
batch 59, loss: 0.1253, instance_loss: 0.2356, weighted_loss: 0.1584, label: 0, bag_size: 5041
batch 79, loss: 0.3973, instance_loss: 0.1999, weighted_loss: 0.3381, label: 2, bag_size: 88
batch 99, loss: 0.5170, instance_loss: 0.5792, weighted_loss: 0.5357, label: 1, bag_size: 1528
batch 119, loss: 0.0041, instance_loss: 0.1903, weighted_loss: 0.0600, label: 0, bag_size: 5459
batch 139, loss: 0.0337, instance_loss: 0.5674, weighted_loss: 0.1938, label: 0, bag_size: 1744
batch 159, loss: 0.0128, instance_loss: 0.2543, weighted_loss: 0.0853, label: 2, bag_size: 4497
batch 179, loss: 1.5882, instance_loss: 1.4174, weighted_loss: 1.5370, label: 0, bag_size: 2189
batch 199, loss: 0.6535, instance_loss: 0.7819, weighted_loss: 0.6920, label: 2, bag_size: 4910
batch 219, loss: 2.5388, instance_loss: 1.4011, weighted_loss: 2.1975, label: 0, bag_size: 621
batch 239, loss: 0.7402, instance_loss: 0.6984, weighted_loss: 0.7277, label: 1, bag_size: 1854
batch 259, loss: 0.7704, instance_loss: 0.6866, weighted_loss: 0.7452, label: 1, bag_size: 4187
batch 279, loss: 5.2085, instance_loss: 2.0360, weighted_loss: 4.2568, label: 0, bag_size: 2736
batch 299, loss: 0.0010, instance_loss: 0.0235, weighted_loss: 0.0077, label: 1, bag_size: 460
batch 319, loss: 0.8693, instance_loss: 0.4856, weighted_loss: 0.7542, label: 1, bag_size: 5926
batch 339, loss: 0.5395, instance_loss: 0.3137, weighted_loss: 0.4717, label: 2, bag_size: 4691
batch 359, loss: 0.0117, instance_loss: 0.2803, weighted_loss: 0.0923, label: 1, bag_size: 3983
batch 379, loss: 0.0208, instance_loss: 0.2170, weighted_loss: 0.0797, label: 0, bag_size: 3901
batch 399, loss: 1.3982, instance_loss: 1.0723, weighted_loss: 1.3004, label: 1, bag_size: 3644
batch 419, loss: 0.0586, instance_loss: 0.4497, weighted_loss: 0.1759, label: 1, bag_size: 1023
batch 439, loss: 0.0477, instance_loss: 0.2030, weighted_loss: 0.0943, label: 1, bag_size: 1221
batch 459, loss: 0.2237, instance_loss: 0.4696, weighted_loss: 0.2975, label: 0, bag_size: 4524
batch 479, loss: 0.0736, instance_loss: 0.5220, weighted_loss: 0.2081, label: 0, bag_size: 5893
batch 499, loss: 1.0053, instance_loss: 0.6466, weighted_loss: 0.8977, label: 0, bag_size: 4146
batch 519, loss: 0.1709, instance_loss: 0.1057, weighted_loss: 0.1513, label: 2, bag_size: 3583
batch 539, loss: 0.0226, instance_loss: 0.1740, weighted_loss: 0.0680, label: 0, bag_size: 1647
batch 559, loss: 0.3907, instance_loss: 0.7652, weighted_loss: 0.5031, label: 1, bag_size: 2919
batch 579, loss: 0.0369, instance_loss: 0.2186, weighted_loss: 0.0915, label: 1, bag_size: 4253
batch 599, loss: 0.4522, instance_loss: 0.4287, weighted_loss: 0.4452, label: 2, bag_size: 728
batch 619, loss: 4.3392, instance_loss: 2.0202, weighted_loss: 3.6435, label: 1, bag_size: 3159
batch 639, loss: 1.7433, instance_loss: 0.7628, weighted_loss: 1.4491, label: 0, bag_size: 1782
batch 659, loss: 0.1286, instance_loss: 0.2189, weighted_loss: 0.1557, label: 2, bag_size: 2313
batch 679, loss: 0.2944, instance_loss: 0.4929, weighted_loss: 0.3540, label: 0, bag_size: 5840
batch 699, loss: 0.2858, instance_loss: 0.4686, weighted_loss: 0.3407, label: 2, bag_size: 1050
batch 719, loss: 0.9613, instance_loss: 0.8508, weighted_loss: 0.9282, label: 1, bag_size: 6241
batch 739, loss: 2.5988, instance_loss: 1.4836, weighted_loss: 2.2642, label: 1, bag_size: 12936


class 0 clustering acc 0.9691275167785235: correct 17328/17880
class 1 clustering acc 0.3738255033557047: correct 2228/5960
Epoch: 42, train_loss: 0.5416, train_clustering_loss:  0.5442, train_error: 0.2255
class 0: acc 0.755656108597285, correct 167/221
class 1: acc 0.7061068702290076, correct 185/262
class 2: acc 0.8587786259541985, correct 225/262

Val Set, val_loss: 1.1187, val_error: 0.4468, auc: 0.8420
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.15824468085106383: correct 119/752
class 0: acc 0.36538461538461536, correct 19/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2183, instance_loss: 0.4626, weighted_loss: 0.2916, label: 1, bag_size: 2905
batch 39, loss: 0.3452, instance_loss: 0.4510, weighted_loss: 0.3769, label: 2, bag_size: 2501
batch 59, loss: 0.9340, instance_loss: 0.9832, weighted_loss: 0.9488, label: 2, bag_size: 361
batch 79, loss: 1.3407, instance_loss: 1.4132, weighted_loss: 1.3625, label: 0, bag_size: 3316
batch 99, loss: 0.0052, instance_loss: 0.2096, weighted_loss: 0.0665, label: 0, bag_size: 6221
batch 119, loss: 3.6716, instance_loss: 1.4926, weighted_loss: 3.0179, label: 2, bag_size: 4179
batch 139, loss: 0.0578, instance_loss: 0.1095, weighted_loss: 0.0733, label: 0, bag_size: 1399
batch 159, loss: 0.7523, instance_loss: 0.6858, weighted_loss: 0.7324, label: 1, bag_size: 4960
batch 179, loss: 0.6029, instance_loss: 0.8984, weighted_loss: 0.6915, label: 1, bag_size: 4960
batch 199, loss: 0.2299, instance_loss: 0.4905, weighted_loss: 0.3081, label: 2, bag_size: 4192
batch 219, loss: 1.1089, instance_loss: 0.8458, weighted_loss: 1.0300, label: 0, bag_size: 1543
batch 239, loss: 1.1671, instance_loss: 0.6384, weighted_loss: 1.0085, label: 0, bag_size: 4719
batch 259, loss: 0.0484, instance_loss: 0.2528, weighted_loss: 0.1097, label: 2, bag_size: 4203
batch 279, loss: 0.3591, instance_loss: 0.6704, weighted_loss: 0.4525, label: 1, bag_size: 5003
batch 299, loss: 0.0690, instance_loss: 0.2812, weighted_loss: 0.1327, label: 2, bag_size: 3121
batch 319, loss: 0.0780, instance_loss: 0.1389, weighted_loss: 0.0963, label: 2, bag_size: 2313
batch 339, loss: 0.2256, instance_loss: 0.3319, weighted_loss: 0.2575, label: 0, bag_size: 3690
batch 359, loss: 0.2087, instance_loss: 0.4447, weighted_loss: 0.2795, label: 2, bag_size: 3618
batch 379, loss: 0.1795, instance_loss: 0.2657, weighted_loss: 0.2054, label: 0, bag_size: 5459
batch 399, loss: 0.0535, instance_loss: 0.3303, weighted_loss: 0.1365, label: 1, bag_size: 683
batch 419, loss: 0.0890, instance_loss: 0.1673, weighted_loss: 0.1125, label: 2, bag_size: 3176
batch 439, loss: 0.1524, instance_loss: 0.2467, weighted_loss: 0.1807, label: 2, bag_size: 3746
batch 459, loss: 1.1250, instance_loss: 1.2669, weighted_loss: 1.1676, label: 1, bag_size: 3184
batch 479, loss: 0.0166, instance_loss: 0.4609, weighted_loss: 0.1499, label: 1, bag_size: 4027
batch 499, loss: 0.0431, instance_loss: 0.0905, weighted_loss: 0.0573, label: 2, bag_size: 3397
batch 519, loss: 0.5479, instance_loss: 0.3750, weighted_loss: 0.4960, label: 2, bag_size: 3174
batch 539, loss: 0.1567, instance_loss: 0.2113, weighted_loss: 0.1731, label: 0, bag_size: 2019
batch 559, loss: 0.2184, instance_loss: 0.1796, weighted_loss: 0.2068, label: 2, bag_size: 1094
batch 579, loss: 0.2328, instance_loss: 0.2894, weighted_loss: 0.2498, label: 2, bag_size: 2049
batch 599, loss: 0.4647, instance_loss: 0.7767, weighted_loss: 0.5583, label: 1, bag_size: 1528
batch 619, loss: 0.0198, instance_loss: 0.3932, weighted_loss: 0.1318, label: 1, bag_size: 1836
batch 639, loss: 0.4409, instance_loss: 0.8214, weighted_loss: 0.5550, label: 1, bag_size: 4467
batch 659, loss: 0.9727, instance_loss: 0.7856, weighted_loss: 0.9166, label: 1, bag_size: 3823
batch 679, loss: 0.1704, instance_loss: 0.5521, weighted_loss: 0.2849, label: 0, bag_size: 5377
batch 699, loss: 1.5993, instance_loss: 1.0431, weighted_loss: 1.4324, label: 0, bag_size: 877
batch 719, loss: 0.1351, instance_loss: 0.4146, weighted_loss: 0.2190, label: 0, bag_size: 7315
batch 739, loss: 0.0446, instance_loss: 0.2252, weighted_loss: 0.0987, label: 2, bag_size: 4745


class 0 clustering acc 0.96834451901566: correct 17314/17880
class 1 clustering acc 0.38104026845637584: correct 2271/5960
Epoch: 43, train_loss: 0.5249, train_clustering_loss:  0.5425, train_error: 0.2228
class 0: acc 0.8081632653061225, correct 198/245
class 1: acc 0.6842105263157895, correct 169/247
class 2: acc 0.8379446640316206, correct 212/253

Val Set, val_loss: 0.6459, val_error: 0.2766, auc: 0.8936
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.3949468085106383: correct 297/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0188, instance_loss: 1.0688, weighted_loss: 0.3338, label: 1, bag_size: 6717
batch 39, loss: 0.0635, instance_loss: 0.1231, weighted_loss: 0.0814, label: 2, bag_size: 2481
batch 59, loss: 0.7499, instance_loss: 0.6712, weighted_loss: 0.7263, label: 1, bag_size: 3823
batch 79, loss: 0.1783, instance_loss: 0.2654, weighted_loss: 0.2044, label: 0, bag_size: 2983
batch 99, loss: 2.1545, instance_loss: 1.6515, weighted_loss: 2.0036, label: 2, bag_size: 3299
batch 119, loss: 0.7260, instance_loss: 0.3670, weighted_loss: 0.6183, label: 1, bag_size: 2945
batch 139, loss: 0.4119, instance_loss: 0.6659, weighted_loss: 0.4881, label: 0, bag_size: 3904
batch 159, loss: 0.6717, instance_loss: 0.8022, weighted_loss: 0.7109, label: 2, bag_size: 2813
batch 179, loss: 0.2607, instance_loss: 0.6256, weighted_loss: 0.3701, label: 0, bag_size: 621
batch 199, loss: 0.5007, instance_loss: 0.4368, weighted_loss: 0.4815, label: 2, bag_size: 5426
batch 219, loss: 0.6445, instance_loss: 0.7068, weighted_loss: 0.6632, label: 1, bag_size: 1854
batch 239, loss: 1.0913, instance_loss: 0.7212, weighted_loss: 0.9803, label: 0, bag_size: 2671
batch 259, loss: 0.0806, instance_loss: 0.4119, weighted_loss: 0.1800, label: 0, bag_size: 2545
batch 279, loss: 0.0098, instance_loss: 0.4748, weighted_loss: 0.1493, label: 0, bag_size: 4165
batch 299, loss: 1.6027, instance_loss: 0.7797, weighted_loss: 1.3558, label: 0, bag_size: 4562
batch 319, loss: 0.2095, instance_loss: 0.4410, weighted_loss: 0.2790, label: 1, bag_size: 2905
batch 339, loss: 0.0243, instance_loss: 0.3808, weighted_loss: 0.1312, label: 0, bag_size: 3694
batch 359, loss: 0.2302, instance_loss: 0.5619, weighted_loss: 0.3297, label: 1, bag_size: 2319
batch 379, loss: 0.7804, instance_loss: 0.4813, weighted_loss: 0.6906, label: 2, bag_size: 6298
batch 399, loss: 0.1138, instance_loss: 0.4238, weighted_loss: 0.2068, label: 1, bag_size: 5385
batch 419, loss: 0.0626, instance_loss: 0.1702, weighted_loss: 0.0949, label: 2, bag_size: 4302
batch 439, loss: 0.0564, instance_loss: 0.7464, weighted_loss: 0.2634, label: 0, bag_size: 5950
batch 459, loss: 0.0122, instance_loss: 0.1968, weighted_loss: 0.0676, label: 0, bag_size: 6221
batch 479, loss: 0.5397, instance_loss: 0.4713, weighted_loss: 0.5192, label: 1, bag_size: 3391
batch 499, loss: 0.0417, instance_loss: 0.4528, weighted_loss: 0.1650, label: 2, bag_size: 4497
batch 519, loss: 0.5642, instance_loss: 0.6365, weighted_loss: 0.5858, label: 1, bag_size: 4694
batch 539, loss: 0.6065, instance_loss: 0.6325, weighted_loss: 0.6143, label: 2, bag_size: 3604
batch 559, loss: 0.0619, instance_loss: 0.6422, weighted_loss: 0.2360, label: 1, bag_size: 6315
batch 579, loss: 0.2524, instance_loss: 0.3689, weighted_loss: 0.2873, label: 0, bag_size: 5146
batch 599, loss: 0.8316, instance_loss: 0.9738, weighted_loss: 0.8743, label: 2, bag_size: 7607
batch 619, loss: 0.5435, instance_loss: 0.6721, weighted_loss: 0.5821, label: 1, bag_size: 4346
batch 639, loss: 0.0107, instance_loss: 0.0991, weighted_loss: 0.0372, label: 1, bag_size: 6992
batch 659, loss: 0.0331, instance_loss: 0.1975, weighted_loss: 0.0824, label: 0, bag_size: 614
batch 679, loss: 2.3845, instance_loss: 0.8250, weighted_loss: 1.9167, label: 0, bag_size: 6630
batch 699, loss: 1.0567, instance_loss: 0.6085, weighted_loss: 0.9222, label: 0, bag_size: 3382
batch 719, loss: 0.0034, instance_loss: 0.0857, weighted_loss: 0.0281, label: 0, bag_size: 4312
batch 739, loss: 0.8591, instance_loss: 0.6392, weighted_loss: 0.7931, label: 1, bag_size: 3367


class 0 clustering acc 0.9697986577181208: correct 17340/17880
class 1 clustering acc 0.36593959731543624: correct 2181/5960
Epoch: 44, train_loss: 0.4603, train_clustering_loss:  0.5390, train_error: 0.1799
class 0: acc 0.819327731092437, correct 195/238
class 1: acc 0.7795275590551181, correct 198/254
class 2: acc 0.8616600790513834, correct 218/253

Val Set, val_loss: 0.6887, val_error: 0.2447, auc: 0.8829
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.5345744680851063: correct 402/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6984, instance_loss: 1.4155, weighted_loss: 0.9135, label: 2, bag_size: 3299
batch 39, loss: 1.6249, instance_loss: 0.8131, weighted_loss: 1.3814, label: 1, bag_size: 3786
batch 59, loss: 0.0273, instance_loss: 0.0767, weighted_loss: 0.0421, label: 2, bag_size: 3415
batch 79, loss: 0.0240, instance_loss: 0.5575, weighted_loss: 0.1841, label: 1, bag_size: 3604
batch 99, loss: 0.0838, instance_loss: 0.2119, weighted_loss: 0.1222, label: 2, bag_size: 4302
batch 119, loss: 0.5210, instance_loss: 0.3828, weighted_loss: 0.4796, label: 0, bag_size: 6252
batch 139, loss: 0.0336, instance_loss: 0.1475, weighted_loss: 0.0678, label: 0, bag_size: 5368
batch 159, loss: 3.0489, instance_loss: 1.2165, weighted_loss: 2.4992, label: 1, bag_size: 3261
batch 179, loss: 1.0016, instance_loss: 0.6907, weighted_loss: 0.9083, label: 0, bag_size: 1808
batch 199, loss: 0.1179, instance_loss: 0.1686, weighted_loss: 0.1331, label: 2, bag_size: 88
batch 219, loss: 0.5590, instance_loss: 0.9700, weighted_loss: 0.6823, label: 1, bag_size: 2013
batch 239, loss: 0.0318, instance_loss: 0.2321, weighted_loss: 0.0919, label: 0, bag_size: 1034
batch 259, loss: 0.7416, instance_loss: 0.8509, weighted_loss: 0.7744, label: 1, bag_size: 3357
batch 279, loss: 1.3775, instance_loss: 0.9086, weighted_loss: 1.2368, label: 1, bag_size: 1500
batch 299, loss: 0.0001, instance_loss: 0.2834, weighted_loss: 0.0851, label: 0, bag_size: 3594
batch 319, loss: 0.2030, instance_loss: 0.5572, weighted_loss: 0.3093, label: 1, bag_size: 1510
batch 339, loss: 0.2643, instance_loss: 0.3357, weighted_loss: 0.2857, label: 0, bag_size: 2897
batch 359, loss: 0.3824, instance_loss: 0.6110, weighted_loss: 0.4510, label: 1, bag_size: 6156
batch 379, loss: 0.3672, instance_loss: 0.4963, weighted_loss: 0.4059, label: 1, bag_size: 2753
batch 399, loss: 0.3625, instance_loss: 0.8588, weighted_loss: 0.5113, label: 1, bag_size: 5167
batch 419, loss: 0.0001, instance_loss: 0.1312, weighted_loss: 0.0395, label: 1, bag_size: 3338
batch 439, loss: 0.0062, instance_loss: 0.2076, weighted_loss: 0.0666, label: 1, bag_size: 455
batch 459, loss: 0.0833, instance_loss: 0.2558, weighted_loss: 0.1350, label: 1, bag_size: 3493
batch 479, loss: 0.0108, instance_loss: 0.5644, weighted_loss: 0.1769, label: 1, bag_size: 6513
batch 499, loss: 0.0095, instance_loss: 0.0397, weighted_loss: 0.0185, label: 1, bag_size: 2254
batch 519, loss: 0.1149, instance_loss: 0.5264, weighted_loss: 0.2384, label: 0, bag_size: 1234
batch 539, loss: 1.1567, instance_loss: 1.1595, weighted_loss: 1.1576, label: 2, bag_size: 4179
batch 559, loss: 0.1617, instance_loss: 0.1950, weighted_loss: 0.1717, label: 0, bag_size: 2852
batch 579, loss: 1.5912, instance_loss: 1.4510, weighted_loss: 1.5491, label: 1, bag_size: 1371
batch 599, loss: 0.1786, instance_loss: 0.2122, weighted_loss: 0.1887, label: 2, bag_size: 3746
batch 619, loss: 0.0399, instance_loss: 0.6885, weighted_loss: 0.2345, label: 0, bag_size: 3820
batch 639, loss: 2.2104, instance_loss: 1.1954, weighted_loss: 1.9059, label: 2, bag_size: 223
batch 659, loss: 0.5983, instance_loss: 0.3747, weighted_loss: 0.5312, label: 0, bag_size: 3864
batch 679, loss: 0.2169, instance_loss: 0.4695, weighted_loss: 0.2927, label: 1, bag_size: 4599
batch 699, loss: 0.9235, instance_loss: 0.5077, weighted_loss: 0.7988, label: 1, bag_size: 2753
batch 719, loss: 1.0501, instance_loss: 0.4307, weighted_loss: 0.8643, label: 2, bag_size: 597
batch 739, loss: 0.0925, instance_loss: 0.4183, weighted_loss: 0.1903, label: 0, bag_size: 2607


class 0 clustering acc 0.9677293064876957: correct 17303/17880
class 1 clustering acc 0.40570469798657716: correct 2418/5960
Epoch: 45, train_loss: 0.4907, train_clustering_loss:  0.5291, train_error: 0.2027
class 0: acc 0.828125, correct 212/256
class 1: acc 0.722007722007722, correct 187/259
class 2: acc 0.8478260869565217, correct 195/230

Val Set, val_loss: 1.0578, val_error: 0.3511, auc: 0.8626
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.1981382978723404: correct 149/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0427, instance_loss: 0.1748, weighted_loss: 0.0824, label: 2, bag_size: 4555
batch 39, loss: 0.7313, instance_loss: 0.7333, weighted_loss: 0.7319, label: 1, bag_size: 1066
batch 59, loss: 0.0833, instance_loss: 0.3977, weighted_loss: 0.1777, label: 0, bag_size: 3525
batch 79, loss: 0.1166, instance_loss: 0.4602, weighted_loss: 0.2197, label: 2, bag_size: 5472
batch 99, loss: 0.1883, instance_loss: 0.4454, weighted_loss: 0.2654, label: 2, bag_size: 3546
batch 119, loss: 0.0962, instance_loss: 0.2626, weighted_loss: 0.1461, label: 2, bag_size: 597
batch 139, loss: 0.0211, instance_loss: 0.2793, weighted_loss: 0.0986, label: 2, bag_size: 3810
batch 159, loss: 0.1032, instance_loss: 0.6588, weighted_loss: 0.2698, label: 1, bag_size: 5340
batch 179, loss: 0.0919, instance_loss: 0.2073, weighted_loss: 0.1265, label: 2, bag_size: 3746
batch 199, loss: 1.0019, instance_loss: 0.8777, weighted_loss: 0.9646, label: 1, bag_size: 1580
batch 219, loss: 0.5435, instance_loss: 0.7005, weighted_loss: 0.5906, label: 2, bag_size: 728
batch 239, loss: 1.1700, instance_loss: 0.8577, weighted_loss: 1.0763, label: 0, bag_size: 1562
batch 259, loss: 0.6813, instance_loss: 0.6475, weighted_loss: 0.6711, label: 1, bag_size: 1371
batch 279, loss: 1.0301, instance_loss: 0.6427, weighted_loss: 0.9139, label: 1, bag_size: 3367
batch 299, loss: 0.0459, instance_loss: 0.1130, weighted_loss: 0.0660, label: 2, bag_size: 2313
batch 319, loss: 0.2129, instance_loss: 1.3179, weighted_loss: 0.5444, label: 0, bag_size: 4509
batch 339, loss: 1.1574, instance_loss: 0.5428, weighted_loss: 0.9730, label: 0, bag_size: 4647
batch 359, loss: 1.0002, instance_loss: 0.8747, weighted_loss: 0.9625, label: 1, bag_size: 4784
batch 379, loss: 0.0768, instance_loss: 0.4468, weighted_loss: 0.1878, label: 1, bag_size: 2493
batch 399, loss: 0.0495, instance_loss: 0.1712, weighted_loss: 0.0860, label: 2, bag_size: 6273
batch 419, loss: 0.6007, instance_loss: 0.6792, weighted_loss: 0.6242, label: 1, bag_size: 3935
batch 439, loss: 0.0788, instance_loss: 0.3093, weighted_loss: 0.1479, label: 0, bag_size: 4458
batch 459, loss: 0.0455, instance_loss: 0.1028, weighted_loss: 0.0627, label: 2, bag_size: 4088
batch 479, loss: 2.5705, instance_loss: 1.2432, weighted_loss: 2.1723, label: 2, bag_size: 7607
batch 499, loss: 0.0135, instance_loss: 0.1745, weighted_loss: 0.0618, label: 0, bag_size: 1385
batch 519, loss: 1.1994, instance_loss: 0.7679, weighted_loss: 1.0699, label: 1, bag_size: 5276
batch 539, loss: 0.4199, instance_loss: 0.5265, weighted_loss: 0.4518, label: 1, bag_size: 2865
batch 559, loss: 0.0518, instance_loss: 0.0934, weighted_loss: 0.0643, label: 2, bag_size: 5914
batch 579, loss: 0.1671, instance_loss: 0.8055, weighted_loss: 0.3586, label: 1, bag_size: 3755
batch 599, loss: 0.1706, instance_loss: 0.2700, weighted_loss: 0.2004, label: 2, bag_size: 3810
batch 619, loss: 0.5361, instance_loss: 0.6746, weighted_loss: 0.5777, label: 1, bag_size: 1854
batch 639, loss: 2.8683, instance_loss: 1.3763, weighted_loss: 2.4207, label: 1, bag_size: 3159
batch 659, loss: 0.0438, instance_loss: 0.5085, weighted_loss: 0.1832, label: 0, bag_size: 6015
batch 679, loss: 0.7575, instance_loss: 0.5052, weighted_loss: 0.6818, label: 1, bag_size: 209
batch 699, loss: 0.3455, instance_loss: 0.4688, weighted_loss: 0.3825, label: 0, bag_size: 3339
batch 719, loss: 0.3013, instance_loss: 0.5258, weighted_loss: 0.3687, label: 2, bag_size: 5037
batch 739, loss: 0.0005, instance_loss: 0.1444, weighted_loss: 0.0437, label: 0, bag_size: 4196


class 0 clustering acc 0.9695749440715884: correct 17336/17880
class 1 clustering acc 0.37483221476510065: correct 2234/5960
Epoch: 46, train_loss: 0.4990, train_clustering_loss:  0.5343, train_error: 0.2040
class 0: acc 0.8099173553719008, correct 196/242
class 1: acc 0.7246963562753036, correct 179/247
class 2: acc 0.8515625, correct 218/256

Val Set, val_loss: 0.7228, val_error: 0.2766, auc: 0.8953
class 0 clustering acc 0.9893617021276596: correct 2232/2256
class 1 clustering acc 0.26861702127659576: correct 202/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5037, instance_loss: 0.6175, weighted_loss: 0.5378, label: 2, bag_size: 552
batch 39, loss: 1.0592, instance_loss: 1.1473, weighted_loss: 1.0857, label: 0, bag_size: 3316
batch 59, loss: 0.0159, instance_loss: 0.2329, weighted_loss: 0.0810, label: 0, bag_size: 577
batch 79, loss: 0.5792, instance_loss: 0.6489, weighted_loss: 0.6001, label: 0, bag_size: 6863
batch 99, loss: 3.6124, instance_loss: 1.2920, weighted_loss: 2.9163, label: 0, bag_size: 557
batch 119, loss: 1.5495, instance_loss: 0.7306, weighted_loss: 1.3038, label: 1, bag_size: 302
batch 139, loss: 0.0056, instance_loss: 0.3018, weighted_loss: 0.0945, label: 0, bag_size: 3641
batch 159, loss: 0.5700, instance_loss: 0.6997, weighted_loss: 0.6090, label: 0, bag_size: 313
batch 179, loss: 0.4584, instance_loss: 0.4204, weighted_loss: 0.4470, label: 0, bag_size: 1695
batch 199, loss: 1.0483, instance_loss: 0.8451, weighted_loss: 0.9873, label: 2, bag_size: 2813
batch 219, loss: 0.7227, instance_loss: 0.7162, weighted_loss: 0.7207, label: 2, bag_size: 4571
batch 239, loss: 0.7623, instance_loss: 0.5237, weighted_loss: 0.6907, label: 0, bag_size: 3525
batch 259, loss: 0.0360, instance_loss: 0.1296, weighted_loss: 0.0641, label: 2, bag_size: 88
batch 279, loss: 2.8606, instance_loss: 1.4534, weighted_loss: 2.4385, label: 0, bag_size: 5259
batch 299, loss: 2.1065, instance_loss: 0.9383, weighted_loss: 1.7561, label: 1, bag_size: 4187
batch 319, loss: 0.0063, instance_loss: 0.3231, weighted_loss: 0.1014, label: 1, bag_size: 4111
batch 339, loss: 0.0323, instance_loss: 0.4088, weighted_loss: 0.1452, label: 2, bag_size: 3607
batch 359, loss: 0.3592, instance_loss: 1.0454, weighted_loss: 0.5651, label: 1, bag_size: 4940
batch 379, loss: 0.2829, instance_loss: 0.4639, weighted_loss: 0.3372, label: 1, bag_size: 1906
batch 399, loss: 0.2758, instance_loss: 1.2700, weighted_loss: 0.5741, label: 1, bag_size: 3322
batch 419, loss: 2.2737, instance_loss: 1.1884, weighted_loss: 1.9481, label: 0, bag_size: 15388
batch 439, loss: 0.0726, instance_loss: 0.2125, weighted_loss: 0.1146, label: 0, bag_size: 4242
batch 459, loss: 0.8761, instance_loss: 0.6271, weighted_loss: 0.8014, label: 2, bag_size: 7607
batch 479, loss: 1.1873, instance_loss: 0.8371, weighted_loss: 1.0823, label: 1, bag_size: 800
batch 499, loss: 0.0516, instance_loss: 0.5279, weighted_loss: 0.1945, label: 0, bag_size: 4509
batch 519, loss: 0.0010, instance_loss: 0.0157, weighted_loss: 0.0054, label: 1, bag_size: 2254
batch 539, loss: 0.0059, instance_loss: 0.5655, weighted_loss: 0.1737, label: 1, bag_size: 5833
batch 559, loss: 0.0440, instance_loss: 0.1456, weighted_loss: 0.0745, label: 1, bag_size: 3322
batch 579, loss: 0.0254, instance_loss: 0.3950, weighted_loss: 0.1363, label: 0, bag_size: 5011
batch 599, loss: 0.0067, instance_loss: 0.1001, weighted_loss: 0.0347, label: 2, bag_size: 2483
batch 619, loss: 1.1400, instance_loss: 0.6753, weighted_loss: 1.0006, label: 0, bag_size: 4572
batch 639, loss: 0.0192, instance_loss: 0.1053, weighted_loss: 0.0450, label: 2, bag_size: 2997
batch 659, loss: 0.0005, instance_loss: 0.7685, weighted_loss: 0.2309, label: 0, bag_size: 3298
batch 679, loss: 0.0482, instance_loss: 0.2104, weighted_loss: 0.0968, label: 2, bag_size: 3210
batch 699, loss: 0.7824, instance_loss: 0.9017, weighted_loss: 0.8182, label: 0, bag_size: 1071
batch 719, loss: 3.2679, instance_loss: 1.6126, weighted_loss: 2.7713, label: 1, bag_size: 3159
batch 739, loss: 0.1042, instance_loss: 0.2531, weighted_loss: 0.1488, label: 2, bag_size: 4978


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.3781879194630873: correct 2254/5960
Epoch: 47, train_loss: 0.5077, train_clustering_loss:  0.5392, train_error: 0.2161
class 0: acc 0.8014705882352942, correct 218/272
class 1: acc 0.7253218884120172, correct 169/233
class 2: acc 0.8208333333333333, correct 197/240

Val Set, val_loss: 0.6317, val_error: 0.2660, auc: 0.8851
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.40691489361702127: correct 306/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0678, instance_loss: 0.2070, weighted_loss: 0.1096, label: 2, bag_size: 4056
batch 39, loss: 0.1041, instance_loss: 0.4250, weighted_loss: 0.2003, label: 1, bag_size: 2796
batch 59, loss: 0.5010, instance_loss: 0.6574, weighted_loss: 0.5479, label: 1, bag_size: 5693
batch 79, loss: 0.6876, instance_loss: 0.7319, weighted_loss: 0.7009, label: 1, bag_size: 7176
batch 99, loss: 4.7644, instance_loss: 1.8786, weighted_loss: 3.8986, label: 0, bag_size: 5259
batch 119, loss: 0.0401, instance_loss: 0.3713, weighted_loss: 0.1395, label: 0, bag_size: 3297
batch 139, loss: 0.5532, instance_loss: 0.9544, weighted_loss: 0.6736, label: 0, bag_size: 4921
batch 159, loss: 0.0548, instance_loss: 0.3970, weighted_loss: 0.1574, label: 0, bag_size: 1176
batch 179, loss: 0.0064, instance_loss: 0.0461, weighted_loss: 0.0183, label: 1, bag_size: 460
batch 199, loss: 0.0044, instance_loss: 0.2193, weighted_loss: 0.0689, label: 2, bag_size: 2422
batch 219, loss: 0.0459, instance_loss: 0.3856, weighted_loss: 0.1478, label: 0, bag_size: 4678
batch 239, loss: 0.0856, instance_loss: 0.2168, weighted_loss: 0.1250, label: 0, bag_size: 4584
batch 259, loss: 0.3289, instance_loss: 0.6636, weighted_loss: 0.4293, label: 2, bag_size: 4535
batch 279, loss: 0.2659, instance_loss: 0.2459, weighted_loss: 0.2599, label: 2, bag_size: 3112
batch 299, loss: 0.0073, instance_loss: 0.1271, weighted_loss: 0.0433, label: 1, bag_size: 3221
batch 319, loss: 0.0026, instance_loss: 0.0564, weighted_loss: 0.0188, label: 1, bag_size: 3677
batch 339, loss: 0.4036, instance_loss: 0.7412, weighted_loss: 0.5049, label: 0, bag_size: 2501
batch 359, loss: 0.0692, instance_loss: 0.6077, weighted_loss: 0.2307, label: 0, bag_size: 4894
batch 379, loss: 0.6340, instance_loss: 1.1558, weighted_loss: 0.7906, label: 0, bag_size: 3316
batch 399, loss: 0.0102, instance_loss: 0.9971, weighted_loss: 0.3062, label: 1, bag_size: 1542
batch 419, loss: 0.2114, instance_loss: 0.5029, weighted_loss: 0.2988, label: 0, bag_size: 3156
batch 439, loss: 0.1473, instance_loss: 1.2029, weighted_loss: 0.4640, label: 0, bag_size: 2232
batch 459, loss: 0.0776, instance_loss: 0.2411, weighted_loss: 0.1266, label: 0, bag_size: 4528
batch 479, loss: 0.2857, instance_loss: 0.5991, weighted_loss: 0.3797, label: 1, bag_size: 3398
batch 499, loss: 0.1619, instance_loss: 0.3757, weighted_loss: 0.2261, label: 2, bag_size: 3327
batch 519, loss: 1.0216, instance_loss: 1.2183, weighted_loss: 1.0806, label: 2, bag_size: 3475
batch 539, loss: 0.4679, instance_loss: 0.4647, weighted_loss: 0.4669, label: 1, bag_size: 4812
batch 559, loss: 2.1524, instance_loss: 0.9832, weighted_loss: 1.8016, label: 1, bag_size: 4258
batch 579, loss: 0.0104, instance_loss: 0.2549, weighted_loss: 0.0838, label: 2, bag_size: 4497
batch 599, loss: 1.7435, instance_loss: 0.5705, weighted_loss: 1.3916, label: 2, bag_size: 2031
batch 619, loss: 1.1984, instance_loss: 0.8421, weighted_loss: 1.0915, label: 1, bag_size: 574
batch 639, loss: 0.3188, instance_loss: 0.3935, weighted_loss: 0.3412, label: 2, bag_size: 4978
batch 659, loss: 0.3528, instance_loss: 0.5089, weighted_loss: 0.3996, label: 1, bag_size: 1029
batch 679, loss: 0.1796, instance_loss: 0.6050, weighted_loss: 0.3072, label: 1, bag_size: 1510
batch 699, loss: 0.1095, instance_loss: 0.4823, weighted_loss: 0.2214, label: 1, bag_size: 1510
batch 719, loss: 0.1137, instance_loss: 0.2356, weighted_loss: 0.1503, label: 2, bag_size: 4096
batch 739, loss: 0.4550, instance_loss: 0.3618, weighted_loss: 0.4270, label: 1, bag_size: 1410


class 0 clustering acc 0.9700782997762863: correct 17345/17880
class 1 clustering acc 0.40956375838926173: correct 2441/5960
Epoch: 48, train_loss: 0.4980, train_clustering_loss:  0.5244, train_error: 0.1906
class 0: acc 0.8143939393939394, correct 215/264
class 1: acc 0.7429718875502008, correct 185/249
class 2: acc 0.875, correct 203/232

Val Set, val_loss: 0.9294, val_error: 0.3617, auc: 0.8790
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.21808510638297873: correct 164/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0244, instance_loss: 0.1069, weighted_loss: 0.0492, label: 2, bag_size: 4056
batch 39, loss: 4.7517, instance_loss: 1.7512, weighted_loss: 3.8516, label: 0, bag_size: 15105
batch 59, loss: 4.3525, instance_loss: 1.5310, weighted_loss: 3.5061, label: 2, bag_size: 223
batch 79, loss: 0.2563, instance_loss: 0.4118, weighted_loss: 0.3029, label: 2, bag_size: 6001
batch 99, loss: 1.2762, instance_loss: 1.1466, weighted_loss: 1.2374, label: 2, bag_size: 4241
batch 119, loss: 0.0009, instance_loss: 0.6370, weighted_loss: 0.1917, label: 1, bag_size: 3172
batch 139, loss: 0.0148, instance_loss: 0.2270, weighted_loss: 0.0784, label: 1, bag_size: 3677
batch 159, loss: 0.5888, instance_loss: 0.3156, weighted_loss: 0.5068, label: 0, bag_size: 2601
batch 179, loss: 1.3766, instance_loss: 0.8407, weighted_loss: 1.2158, label: 1, bag_size: 6993
batch 199, loss: 0.3229, instance_loss: 0.5310, weighted_loss: 0.3853, label: 2, bag_size: 5472
batch 219, loss: 0.6791, instance_loss: 0.6518, weighted_loss: 0.6709, label: 1, bag_size: 4612
batch 239, loss: 0.4825, instance_loss: 0.7761, weighted_loss: 0.5706, label: 2, bag_size: 3604
batch 259, loss: 0.4793, instance_loss: 0.4795, weighted_loss: 0.4794, label: 0, bag_size: 3525
batch 279, loss: 0.0019, instance_loss: 0.1590, weighted_loss: 0.0490, label: 0, bag_size: 1485
batch 299, loss: 0.1001, instance_loss: 0.2392, weighted_loss: 0.1418, label: 2, bag_size: 3546
batch 319, loss: 0.3641, instance_loss: 0.6870, weighted_loss: 0.4609, label: 2, bag_size: 4179
batch 339, loss: 0.3626, instance_loss: 0.3323, weighted_loss: 0.3535, label: 1, bag_size: 4184
batch 359, loss: 0.6821, instance_loss: 0.6408, weighted_loss: 0.6697, label: 0, bag_size: 5840
batch 379, loss: 0.4152, instance_loss: 0.8230, weighted_loss: 0.5376, label: 1, bag_size: 6025
batch 399, loss: 0.3930, instance_loss: 0.3536, weighted_loss: 0.3812, label: 2, bag_size: 5011
batch 419, loss: 0.0064, instance_loss: 0.1091, weighted_loss: 0.0372, label: 2, bag_size: 4203
batch 439, loss: 0.1813, instance_loss: 0.5920, weighted_loss: 0.3045, label: 1, bag_size: 683
batch 459, loss: 0.2124, instance_loss: 0.7524, weighted_loss: 0.3744, label: 1, bag_size: 6156
batch 479, loss: 0.0777, instance_loss: 0.1714, weighted_loss: 0.1058, label: 2, bag_size: 2049
batch 499, loss: 0.3937, instance_loss: 0.2564, weighted_loss: 0.3525, label: 0, bag_size: 1049
batch 519, loss: 0.0977, instance_loss: 0.2302, weighted_loss: 0.1375, label: 2, bag_size: 3210
batch 539, loss: 0.6996, instance_loss: 0.4725, weighted_loss: 0.6315, label: 1, bag_size: 3534
batch 559, loss: 1.3792, instance_loss: 0.8220, weighted_loss: 1.2120, label: 1, bag_size: 4200
batch 579, loss: 0.1813, instance_loss: 0.6057, weighted_loss: 0.3086, label: 2, bag_size: 4487
batch 599, loss: 0.8249, instance_loss: 1.0503, weighted_loss: 0.8925, label: 0, bag_size: 1289
batch 619, loss: 0.3809, instance_loss: 0.2813, weighted_loss: 0.3510, label: 2, bag_size: 597
batch 639, loss: 1.7381, instance_loss: 1.1889, weighted_loss: 1.5733, label: 0, bag_size: 5017
batch 659, loss: 0.3912, instance_loss: 0.8781, weighted_loss: 0.5372, label: 1, bag_size: 7176
batch 679, loss: 0.1141, instance_loss: 0.2971, weighted_loss: 0.1690, label: 0, bag_size: 4524
batch 699, loss: 0.0415, instance_loss: 0.4002, weighted_loss: 0.1491, label: 2, bag_size: 5037
batch 719, loss: 0.0207, instance_loss: 0.1093, weighted_loss: 0.0473, label: 2, bag_size: 6026
batch 739, loss: 0.0206, instance_loss: 0.4815, weighted_loss: 0.1589, label: 0, bag_size: 3641


class 0 clustering acc 0.9686241610738255: correct 17319/17880
class 1 clustering acc 0.4097315436241611: correct 2442/5960
Epoch: 49, train_loss: 0.4779, train_clustering_loss:  0.5227, train_error: 0.1933
class 0: acc 0.8104838709677419, correct 201/248
class 1: acc 0.7837837837837838, correct 203/259
class 2: acc 0.8277310924369747, correct 197/238

Val Set, val_loss: 0.7952, val_error: 0.3617, auc: 0.8858
class 0 clustering acc 0.988031914893617: correct 2229/2256
class 1 clustering acc 0.19281914893617022: correct 145/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1616, instance_loss: 0.2396, weighted_loss: 0.1850, label: 2, bag_size: 2997
batch 39, loss: 0.0583, instance_loss: 0.3965, weighted_loss: 0.1598, label: 0, bag_size: 4797
batch 59, loss: 0.0512, instance_loss: 0.7200, weighted_loss: 0.2518, label: 0, bag_size: 996
batch 79, loss: 2.0203, instance_loss: 0.9595, weighted_loss: 1.7021, label: 0, bag_size: 455
batch 99, loss: 0.2711, instance_loss: 0.3647, weighted_loss: 0.2992, label: 2, bag_size: 3678
batch 119, loss: 0.0193, instance_loss: 0.2325, weighted_loss: 0.0833, label: 0, bag_size: 4229
batch 139, loss: 1.1590, instance_loss: 0.9241, weighted_loss: 1.0885, label: 2, bag_size: 552
batch 159, loss: 0.6648, instance_loss: 0.8093, weighted_loss: 0.7081, label: 2, bag_size: 5426
batch 179, loss: 0.1022, instance_loss: 1.2410, weighted_loss: 0.4439, label: 0, bag_size: 2232
batch 199, loss: 1.0612, instance_loss: 0.8850, weighted_loss: 1.0083, label: 0, bag_size: 5373
batch 219, loss: 0.1370, instance_loss: 0.1830, weighted_loss: 0.1508, label: 2, bag_size: 6644
batch 239, loss: 0.5824, instance_loss: 0.5872, weighted_loss: 0.5839, label: 2, bag_size: 3174
batch 259, loss: 1.1868, instance_loss: 1.6621, weighted_loss: 1.3294, label: 0, bag_size: 1601
batch 279, loss: 0.0436, instance_loss: 0.3498, weighted_loss: 0.1355, label: 0, bag_size: 2195
batch 299, loss: 2.0612, instance_loss: 1.4764, weighted_loss: 1.8858, label: 1, bag_size: 3399
batch 319, loss: 0.8038, instance_loss: 0.7219, weighted_loss: 0.7793, label: 1, bag_size: 5873
batch 339, loss: 0.0124, instance_loss: 0.3319, weighted_loss: 0.1082, label: 0, bag_size: 1814
batch 359, loss: 0.0682, instance_loss: 0.4850, weighted_loss: 0.1932, label: 0, bag_size: 4905
batch 379, loss: 0.0176, instance_loss: 0.2121, weighted_loss: 0.0760, label: 2, bag_size: 4203
batch 399, loss: 0.0857, instance_loss: 0.2470, weighted_loss: 0.1341, label: 2, bag_size: 3678
batch 419, loss: 0.2891, instance_loss: 0.5030, weighted_loss: 0.3533, label: 2, bag_size: 3618
batch 439, loss: 0.1642, instance_loss: 0.3530, weighted_loss: 0.2208, label: 1, bag_size: 4599
batch 459, loss: 0.2155, instance_loss: 0.3240, weighted_loss: 0.2480, label: 1, bag_size: 5760
batch 479, loss: 0.0542, instance_loss: 0.1996, weighted_loss: 0.0978, label: 2, bag_size: 3415
batch 499, loss: 1.2318, instance_loss: 0.4855, weighted_loss: 1.0079, label: 2, bag_size: 3274
batch 519, loss: 0.7950, instance_loss: 0.6327, weighted_loss: 0.7463, label: 2, bag_size: 3112
batch 539, loss: 0.0459, instance_loss: 0.4875, weighted_loss: 0.1784, label: 0, bag_size: 5837
batch 559, loss: 0.0097, instance_loss: 0.3408, weighted_loss: 0.1090, label: 0, bag_size: 5646
batch 579, loss: 0.6467, instance_loss: 0.6477, weighted_loss: 0.6470, label: 1, bag_size: 2859
batch 599, loss: 0.0391, instance_loss: 0.3520, weighted_loss: 0.1330, label: 0, bag_size: 1744
batch 619, loss: 0.0356, instance_loss: 0.3597, weighted_loss: 0.1328, label: 1, bag_size: 4192
batch 639, loss: 0.0021, instance_loss: 0.2282, weighted_loss: 0.0699, label: 1, bag_size: 6277
batch 659, loss: 0.0000, instance_loss: 0.1885, weighted_loss: 0.0566, label: 0, bag_size: 1645
batch 679, loss: 0.0234, instance_loss: 0.4776, weighted_loss: 0.1597, label: 1, bag_size: 3761
batch 699, loss: 0.0576, instance_loss: 0.2273, weighted_loss: 0.1085, label: 1, bag_size: 4705
batch 719, loss: 0.0084, instance_loss: 0.2942, weighted_loss: 0.0941, label: 0, bag_size: 4379
batch 739, loss: 0.0192, instance_loss: 0.2596, weighted_loss: 0.0913, label: 1, bag_size: 3983


class 0 clustering acc 0.9732102908277405: correct 17401/17880
class 1 clustering acc 0.33993288590604026: correct 2026/5960
Epoch: 50, train_loss: 0.4941, train_clustering_loss:  0.5461, train_error: 0.1933
class 0: acc 0.7873303167420814, correct 174/221
class 1: acc 0.7950530035335689, correct 225/283
class 2: acc 0.8381742738589212, correct 202/241

Val Set, val_loss: 0.7744, val_error: 0.3191, auc: 0.8929
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.29521276595744683: correct 222/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0034, instance_loss: 0.0494, weighted_loss: 0.0172, label: 1, bag_size: 2254
batch 39, loss: 0.8386, instance_loss: 1.1198, weighted_loss: 0.9230, label: 0, bag_size: 7056
batch 59, loss: 2.8631, instance_loss: 1.0346, weighted_loss: 2.3145, label: 2, bag_size: 1513
batch 79, loss: 1.7917, instance_loss: 0.7154, weighted_loss: 1.4688, label: 1, bag_size: 6993
batch 99, loss: 0.3472, instance_loss: 0.7750, weighted_loss: 0.4756, label: 1, bag_size: 3619
batch 119, loss: 2.6508, instance_loss: 0.8760, weighted_loss: 2.1183, label: 1, bag_size: 3823
batch 139, loss: 2.7267, instance_loss: 1.4019, weighted_loss: 2.3292, label: 0, bag_size: 11141
batch 159, loss: 0.0019, instance_loss: 0.1911, weighted_loss: 0.0587, label: 1, bag_size: 1836
batch 179, loss: 0.1083, instance_loss: 0.4858, weighted_loss: 0.2216, label: 0, bag_size: 4584
batch 199, loss: 0.0058, instance_loss: 0.5034, weighted_loss: 0.1551, label: 0, bag_size: 4300
batch 219, loss: 0.0390, instance_loss: 0.7142, weighted_loss: 0.2416, label: 0, bag_size: 2927
batch 239, loss: 1.1697, instance_loss: 0.6318, weighted_loss: 1.0083, label: 2, bag_size: 2326
batch 259, loss: 0.0128, instance_loss: 0.3869, weighted_loss: 0.1250, label: 0, bag_size: 5992
batch 279, loss: 0.1725, instance_loss: 0.2446, weighted_loss: 0.1942, label: 2, bag_size: 2049
batch 299, loss: 0.3056, instance_loss: 0.5533, weighted_loss: 0.3799, label: 1, bag_size: 1042
batch 319, loss: 0.3484, instance_loss: 0.1622, weighted_loss: 0.2925, label: 2, bag_size: 88
batch 339, loss: 0.0003, instance_loss: 0.0451, weighted_loss: 0.0137, label: 0, bag_size: 1825
batch 359, loss: 0.0461, instance_loss: 0.4165, weighted_loss: 0.1572, label: 1, bag_size: 582
batch 379, loss: 0.5743, instance_loss: 1.0716, weighted_loss: 0.7235, label: 2, bag_size: 361
batch 399, loss: 1.6270, instance_loss: 0.6317, weighted_loss: 1.3284, label: 1, bag_size: 3786
batch 419, loss: 0.0025, instance_loss: 0.2907, weighted_loss: 0.0890, label: 2, bag_size: 4497
batch 439, loss: 0.0035, instance_loss: 0.3830, weighted_loss: 0.1173, label: 0, bag_size: 5899
batch 459, loss: 0.1623, instance_loss: 0.4727, weighted_loss: 0.2554, label: 2, bag_size: 724
batch 479, loss: 0.9833, instance_loss: 0.7828, weighted_loss: 0.9232, label: 1, bag_size: 4438
batch 499, loss: 0.0000, instance_loss: 0.0502, weighted_loss: 0.0151, label: 0, bag_size: 5902
batch 519, loss: 0.0220, instance_loss: 0.2792, weighted_loss: 0.0992, label: 0, bag_size: 4531
batch 539, loss: 0.0645, instance_loss: 0.1813, weighted_loss: 0.0995, label: 0, bag_size: 4251
batch 559, loss: 0.3588, instance_loss: 0.9599, weighted_loss: 0.5392, label: 0, bag_size: 4509
batch 579, loss: 0.5126, instance_loss: 0.6372, weighted_loss: 0.5500, label: 1, bag_size: 5512
batch 599, loss: 1.0330, instance_loss: 0.9333, weighted_loss: 1.0031, label: 0, bag_size: 5840
batch 619, loss: 0.3613, instance_loss: 0.4047, weighted_loss: 0.3743, label: 0, bag_size: 3864
batch 639, loss: 0.4695, instance_loss: 0.5402, weighted_loss: 0.4907, label: 2, bag_size: 6594
batch 659, loss: 0.0520, instance_loss: 0.5413, weighted_loss: 0.1988, label: 1, bag_size: 3991
batch 679, loss: 0.0918, instance_loss: 0.1960, weighted_loss: 0.1230, label: 2, bag_size: 2997
batch 699, loss: 1.4254, instance_loss: 0.9520, weighted_loss: 1.2833, label: 0, bag_size: 5125
batch 719, loss: 0.2892, instance_loss: 0.3724, weighted_loss: 0.3141, label: 2, bag_size: 614
batch 739, loss: 1.0070, instance_loss: 1.0784, weighted_loss: 1.0284, label: 1, bag_size: 782


class 0 clustering acc 0.96834451901566: correct 17314/17880
class 1 clustering acc 0.39228187919463087: correct 2338/5960
Epoch: 51, train_loss: 0.4915, train_clustering_loss:  0.5321, train_error: 0.2107
class 0: acc 0.7937743190661478, correct 204/257
class 1: acc 0.7196652719665272, correct 172/239
class 2: acc 0.8514056224899599, correct 212/249

Val Set, val_loss: 0.6958, val_error: 0.2660, auc: 0.8881
class 0 clustering acc 0.9862588652482269: correct 2225/2256
class 1 clustering acc 0.3324468085106383: correct 250/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2514, instance_loss: 0.5226, weighted_loss: 0.3328, label: 1, bag_size: 3823
batch 39, loss: 0.1463, instance_loss: 0.5141, weighted_loss: 0.2566, label: 1, bag_size: 4373
batch 59, loss: 0.1365, instance_loss: 0.3062, weighted_loss: 0.1875, label: 2, bag_size: 6644
batch 79, loss: 0.0460, instance_loss: 0.3812, weighted_loss: 0.1466, label: 0, bag_size: 4604
batch 99, loss: 1.4475, instance_loss: 1.2440, weighted_loss: 1.3864, label: 2, bag_size: 3475
batch 119, loss: 0.0259, instance_loss: 0.6130, weighted_loss: 0.2020, label: 0, bag_size: 2069
batch 139, loss: 0.2036, instance_loss: 0.3108, weighted_loss: 0.2358, label: 2, bag_size: 3174
batch 159, loss: 0.2285, instance_loss: 0.4162, weighted_loss: 0.2848, label: 2, bag_size: 4096
batch 179, loss: 0.0108, instance_loss: 0.1306, weighted_loss: 0.0467, label: 2, bag_size: 3121
batch 199, loss: 0.1245, instance_loss: 0.2396, weighted_loss: 0.1590, label: 2, bag_size: 3497
batch 219, loss: 0.0401, instance_loss: 0.1748, weighted_loss: 0.0805, label: 2, bag_size: 5138
batch 239, loss: 0.5044, instance_loss: 0.6126, weighted_loss: 0.5368, label: 2, bag_size: 5406
batch 259, loss: 4.8303, instance_loss: 1.1004, weighted_loss: 3.7113, label: 2, bag_size: 552
batch 279, loss: 0.3132, instance_loss: 0.8750, weighted_loss: 0.4818, label: 2, bag_size: 4910
batch 299, loss: 0.2556, instance_loss: 0.3486, weighted_loss: 0.2835, label: 0, bag_size: 5041
batch 319, loss: 0.3201, instance_loss: 0.7772, weighted_loss: 0.4572, label: 2, bag_size: 3604
batch 339, loss: 0.0982, instance_loss: 0.3264, weighted_loss: 0.1666, label: 0, bag_size: 598
batch 359, loss: 0.1675, instance_loss: 0.7230, weighted_loss: 0.3342, label: 2, bag_size: 2031
batch 379, loss: 0.0835, instance_loss: 0.1922, weighted_loss: 0.1161, label: 2, bag_size: 4555
batch 399, loss: 0.0230, instance_loss: 0.2521, weighted_loss: 0.0917, label: 0, bag_size: 5036
batch 419, loss: 0.0102, instance_loss: 0.0606, weighted_loss: 0.0253, label: 2, bag_size: 3415
batch 439, loss: 0.3848, instance_loss: 0.8899, weighted_loss: 0.5363, label: 2, bag_size: 4910
batch 459, loss: 0.0058, instance_loss: 0.0373, weighted_loss: 0.0153, label: 0, bag_size: 3304
batch 479, loss: 0.0000, instance_loss: 0.0000, weighted_loss: 0.0000, label: 0, bag_size: 1087
batch 499, loss: 0.0129, instance_loss: 0.2804, weighted_loss: 0.0931, label: 0, bag_size: 4165
batch 519, loss: 0.9577, instance_loss: 0.9772, weighted_loss: 0.9635, label: 1, bag_size: 6025
batch 539, loss: 0.0604, instance_loss: 0.2137, weighted_loss: 0.1064, label: 2, bag_size: 3678
batch 559, loss: 0.0708, instance_loss: 0.1492, weighted_loss: 0.0943, label: 2, bag_size: 3497
batch 579, loss: 0.1041, instance_loss: 0.2026, weighted_loss: 0.1337, label: 0, bag_size: 3617
batch 599, loss: 0.0320, instance_loss: 0.3026, weighted_loss: 0.1132, label: 1, bag_size: 455
batch 619, loss: 0.0915, instance_loss: 0.3800, weighted_loss: 0.1780, label: 2, bag_size: 3497
batch 639, loss: 0.1778, instance_loss: 0.2433, weighted_loss: 0.1974, label: 1, bag_size: 6992
batch 659, loss: 1.2752, instance_loss: 0.6392, weighted_loss: 1.0844, label: 2, bag_size: 2031
batch 679, loss: 0.0110, instance_loss: 0.1873, weighted_loss: 0.0639, label: 0, bag_size: 966
batch 699, loss: 0.0142, instance_loss: 0.1893, weighted_loss: 0.0667, label: 1, bag_size: 796
batch 719, loss: 0.2570, instance_loss: 0.5894, weighted_loss: 0.3567, label: 2, bag_size: 3604
batch 739, loss: 0.2929, instance_loss: 0.5923, weighted_loss: 0.3827, label: 0, bag_size: 4460


class 0 clustering acc 0.9725391498881432: correct 17389/17880
class 1 clustering acc 0.37214765100671143: correct 2218/5960
Epoch: 52, train_loss: 0.4590, train_clustering_loss:  0.5228, train_error: 0.1866
class 0: acc 0.7932489451476793, correct 188/237
class 1: acc 0.7701149425287356, correct 201/261
class 2: acc 0.8785425101214575, correct 217/247

Val Set, val_loss: 0.7297, val_error: 0.2979, auc: 0.8884
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.35106382978723405: correct 264/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0044, instance_loss: 0.2878, weighted_loss: 0.0894, label: 0, bag_size: 4918
batch 39, loss: 0.0398, instance_loss: 0.2210, weighted_loss: 0.0942, label: 2, bag_size: 4569
batch 59, loss: 0.0619, instance_loss: 0.5833, weighted_loss: 0.2183, label: 1, bag_size: 4192
batch 79, loss: 0.2967, instance_loss: 0.6653, weighted_loss: 0.4073, label: 1, bag_size: 3126
batch 99, loss: 0.4233, instance_loss: 0.5609, weighted_loss: 0.4646, label: 1, bag_size: 4069
batch 119, loss: 0.0141, instance_loss: 0.1236, weighted_loss: 0.0470, label: 1, bag_size: 712
batch 139, loss: 1.4242, instance_loss: 0.7223, weighted_loss: 1.2136, label: 0, bag_size: 3661
batch 159, loss: 0.1740, instance_loss: 0.2202, weighted_loss: 0.1879, label: 2, bag_size: 5011
batch 179, loss: 0.0878, instance_loss: 0.4436, weighted_loss: 0.1945, label: 0, bag_size: 5632
batch 199, loss: 0.4867, instance_loss: 0.8221, weighted_loss: 0.5873, label: 1, bag_size: 1313
batch 219, loss: 1.3069, instance_loss: 0.6613, weighted_loss: 1.1132, label: 1, bag_size: 3109
batch 239, loss: 0.3886, instance_loss: 0.6615, weighted_loss: 0.4705, label: 1, bag_size: 1045
batch 259, loss: 0.0014, instance_loss: 0.4572, weighted_loss: 0.1382, label: 0, bag_size: 1645
batch 279, loss: 0.0301, instance_loss: 0.7112, weighted_loss: 0.2344, label: 1, bag_size: 6315
batch 299, loss: 0.1898, instance_loss: 0.2950, weighted_loss: 0.2213, label: 2, bag_size: 3327
batch 319, loss: 0.9180, instance_loss: 0.5415, weighted_loss: 0.8050, label: 1, bag_size: 3106
batch 339, loss: 0.1836, instance_loss: 0.4313, weighted_loss: 0.2579, label: 0, bag_size: 640
batch 359, loss: 0.0250, instance_loss: 0.1556, weighted_loss: 0.0642, label: 2, bag_size: 4745
batch 379, loss: 3.4194, instance_loss: 1.5103, weighted_loss: 2.8467, label: 0, bag_size: 5259
batch 399, loss: 0.6801, instance_loss: 0.5510, weighted_loss: 0.6414, label: 1, bag_size: 1500
batch 419, loss: 0.0305, instance_loss: 0.2179, weighted_loss: 0.0867, label: 1, bag_size: 2453
batch 439, loss: 0.2351, instance_loss: 0.3736, weighted_loss: 0.2766, label: 2, bag_size: 2359
batch 459, loss: 0.1064, instance_loss: 0.2300, weighted_loss: 0.1434, label: 0, bag_size: 4455
batch 479, loss: 0.0024, instance_loss: 0.2447, weighted_loss: 0.0751, label: 0, bag_size: 2139
batch 499, loss: 0.0087, instance_loss: 0.1375, weighted_loss: 0.0473, label: 2, bag_size: 3285
batch 519, loss: 0.1005, instance_loss: 0.5826, weighted_loss: 0.2451, label: 1, bag_size: 3475
batch 539, loss: 0.6776, instance_loss: 0.3491, weighted_loss: 0.5790, label: 1, bag_size: 2945
batch 559, loss: 1.9350, instance_loss: 1.0677, weighted_loss: 1.6748, label: 2, bag_size: 7607
batch 579, loss: 0.0000, instance_loss: 0.0659, weighted_loss: 0.0198, label: 0, bag_size: 5003
batch 599, loss: 0.0109, instance_loss: 0.0833, weighted_loss: 0.0326, label: 2, bag_size: 4745
batch 619, loss: 0.6883, instance_loss: 0.6263, weighted_loss: 0.6697, label: 1, bag_size: 3604
batch 639, loss: 0.0838, instance_loss: 0.4465, weighted_loss: 0.1926, label: 1, bag_size: 3221
batch 659, loss: 0.0551, instance_loss: 0.8314, weighted_loss: 0.2880, label: 0, bag_size: 3298
batch 679, loss: 0.0033, instance_loss: 0.1776, weighted_loss: 0.0556, label: 2, bag_size: 2422
batch 699, loss: 0.2481, instance_loss: 0.7220, weighted_loss: 0.3903, label: 1, bag_size: 3184
batch 719, loss: 0.9849, instance_loss: 0.5779, weighted_loss: 0.8628, label: 2, bag_size: 614
batch 739, loss: 0.2964, instance_loss: 0.7936, weighted_loss: 0.4456, label: 0, bag_size: 4547


class 0 clustering acc 0.9731543624161074: correct 17400/17880
class 1 clustering acc 0.3714765100671141: correct 2214/5960
Epoch: 53, train_loss: 0.4568, train_clustering_loss:  0.5318, train_error: 0.1973
class 0: acc 0.8016877637130801, correct 190/237
class 1: acc 0.7681159420289855, correct 212/276
class 2: acc 0.8448275862068966, correct 196/232

Val Set, val_loss: 0.7271, val_error: 0.2660, auc: 0.8814
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.363031914893617: correct 273/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0080, instance_loss: 0.1732, weighted_loss: 0.0575, label: 2, bag_size: 4856
batch 39, loss: 0.0341, instance_loss: 0.2406, weighted_loss: 0.0960, label: 2, bag_size: 6001
batch 59, loss: 0.6919, instance_loss: 0.7486, weighted_loss: 0.7089, label: 1, bag_size: 3813
batch 79, loss: 0.0738, instance_loss: 0.4637, weighted_loss: 0.1908, label: 1, bag_size: 4595
batch 99, loss: 1.2868, instance_loss: 1.0985, weighted_loss: 1.2303, label: 0, bag_size: 621
batch 119, loss: 0.5374, instance_loss: 0.7898, weighted_loss: 0.6131, label: 1, bag_size: 5011
batch 139, loss: 1.0613, instance_loss: 0.7279, weighted_loss: 0.9613, label: 1, bag_size: 302
batch 159, loss: 0.0051, instance_loss: 0.0338, weighted_loss: 0.0137, label: 1, bag_size: 460
batch 179, loss: 0.3693, instance_loss: 0.4700, weighted_loss: 0.3995, label: 0, bag_size: 4719
batch 199, loss: 0.3793, instance_loss: 0.5585, weighted_loss: 0.4330, label: 2, bag_size: 728
batch 219, loss: 5.1225, instance_loss: 1.4295, weighted_loss: 4.0146, label: 0, bag_size: 15105
batch 239, loss: 0.1426, instance_loss: 0.3449, weighted_loss: 0.2033, label: 2, bag_size: 4132
batch 259, loss: 0.0212, instance_loss: 0.2008, weighted_loss: 0.0751, label: 2, bag_size: 5017
batch 279, loss: 1.0937, instance_loss: 0.4830, weighted_loss: 0.9105, label: 0, bag_size: 3370
batch 299, loss: 1.2920, instance_loss: 0.8147, weighted_loss: 1.1488, label: 1, bag_size: 1500
batch 319, loss: 0.5463, instance_loss: 0.5948, weighted_loss: 0.5609, label: 1, bag_size: 3438
batch 339, loss: 0.5077, instance_loss: 0.6247, weighted_loss: 0.5428, label: 2, bag_size: 2813
batch 359, loss: 0.0042, instance_loss: 0.2777, weighted_loss: 0.0862, label: 0, bag_size: 5899
batch 379, loss: 0.4339, instance_loss: 0.5925, weighted_loss: 0.4815, label: 0, bag_size: 3834
batch 399, loss: 0.0350, instance_loss: 0.1838, weighted_loss: 0.0796, label: 2, bag_size: 2209
batch 419, loss: 2.1512, instance_loss: 1.1329, weighted_loss: 1.8457, label: 0, bag_size: 2579
batch 439, loss: 0.7455, instance_loss: 0.6866, weighted_loss: 0.7279, label: 1, bag_size: 4784
batch 459, loss: 0.5302, instance_loss: 0.7581, weighted_loss: 0.5985, label: 1, bag_size: 1371
batch 479, loss: 0.3347, instance_loss: 0.4651, weighted_loss: 0.3738, label: 2, bag_size: 4192
batch 499, loss: 1.2167, instance_loss: 0.7739, weighted_loss: 1.0839, label: 2, bag_size: 909
batch 519, loss: 1.6354, instance_loss: 0.9963, weighted_loss: 1.4437, label: 0, bag_size: 5840
batch 539, loss: 0.0887, instance_loss: 0.2954, weighted_loss: 0.1507, label: 2, bag_size: 4691
batch 559, loss: 0.0839, instance_loss: 0.4467, weighted_loss: 0.1928, label: 2, bag_size: 4487
batch 579, loss: 0.0753, instance_loss: 0.3371, weighted_loss: 0.1538, label: 0, bag_size: 2094
batch 599, loss: 0.0732, instance_loss: 0.3315, weighted_loss: 0.1507, label: 0, bag_size: 2841
batch 619, loss: 0.2200, instance_loss: 0.5402, weighted_loss: 0.3161, label: 1, bag_size: 475
batch 639, loss: 0.5411, instance_loss: 0.8341, weighted_loss: 0.6290, label: 0, bag_size: 4719
batch 659, loss: 0.9826, instance_loss: 1.1151, weighted_loss: 1.0224, label: 1, bag_size: 1313
batch 679, loss: 0.8498, instance_loss: 0.5697, weighted_loss: 0.7657, label: 1, bag_size: 3396
batch 699, loss: 0.5837, instance_loss: 0.6281, weighted_loss: 0.5970, label: 2, bag_size: 4162
batch 719, loss: 0.1250, instance_loss: 0.6350, weighted_loss: 0.2780, label: 1, bag_size: 3127
batch 739, loss: 1.5983, instance_loss: 0.9399, weighted_loss: 1.4008, label: 1, bag_size: 4708


class 0 clustering acc 0.9688478747203579: correct 17323/17880
class 1 clustering acc 0.42516778523489934: correct 2534/5960
Epoch: 54, train_loss: 0.4208, train_clustering_loss:  0.5149, train_error: 0.1678
class 0: acc 0.8443579766536965, correct 217/257
class 1: acc 0.7787234042553192, correct 183/235
class 2: acc 0.8695652173913043, correct 220/253

Val Set, val_loss: 0.7249, val_error: 0.2660, auc: 0.8731
class 0 clustering acc 0.9853723404255319: correct 2223/2256
class 1 clustering acc 0.35771276595744683: correct 269/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0312, instance_loss: 0.4698, weighted_loss: 0.1628, label: 1, bag_size: 3127
batch 39, loss: 0.2106, instance_loss: 0.6375, weighted_loss: 0.3387, label: 1, bag_size: 1510
batch 59, loss: 0.0049, instance_loss: 0.0708, weighted_loss: 0.0246, label: 0, bag_size: 1399
batch 79, loss: 0.1319, instance_loss: 0.5258, weighted_loss: 0.2501, label: 1, bag_size: 2919
batch 99, loss: 0.4177, instance_loss: 0.4657, weighted_loss: 0.4321, label: 0, bag_size: 3571
batch 119, loss: 0.0693, instance_loss: 0.2481, weighted_loss: 0.1229, label: 2, bag_size: 4569
batch 139, loss: 0.1540, instance_loss: 0.2834, weighted_loss: 0.1928, label: 0, bag_size: 4201
batch 159, loss: 0.1721, instance_loss: 0.1804, weighted_loss: 0.1746, label: 2, bag_size: 3415
batch 179, loss: 0.7818, instance_loss: 0.5471, weighted_loss: 0.7114, label: 1, bag_size: 4708
batch 199, loss: 0.1547, instance_loss: 0.4599, weighted_loss: 0.2462, label: 2, bag_size: 3604
batch 219, loss: 0.0165, instance_loss: 0.2165, weighted_loss: 0.0765, label: 2, bag_size: 614
batch 239, loss: 0.1624, instance_loss: 0.3456, weighted_loss: 0.2174, label: 2, bag_size: 6644
batch 259, loss: 0.7573, instance_loss: 0.8197, weighted_loss: 0.7760, label: 1, bag_size: 3644
batch 279, loss: 0.0537, instance_loss: 0.2224, weighted_loss: 0.1043, label: 2, bag_size: 3397
batch 299, loss: 0.0572, instance_loss: 0.6271, weighted_loss: 0.2282, label: 1, bag_size: 4705
batch 319, loss: 0.0171, instance_loss: 0.1044, weighted_loss: 0.0433, label: 2, bag_size: 4745
batch 339, loss: 0.0126, instance_loss: 0.1803, weighted_loss: 0.0629, label: 2, bag_size: 4745
batch 359, loss: 0.0146, instance_loss: 0.3427, weighted_loss: 0.1130, label: 1, bag_size: 5195
batch 379, loss: 0.0004, instance_loss: 0.0438, weighted_loss: 0.0134, label: 1, bag_size: 1836
batch 399, loss: 0.1265, instance_loss: 0.2708, weighted_loss: 0.1698, label: 2, bag_size: 3327
batch 419, loss: 2.5546, instance_loss: 1.2046, weighted_loss: 2.1496, label: 0, bag_size: 2217
batch 439, loss: 0.0068, instance_loss: 0.4035, weighted_loss: 0.1258, label: 0, bag_size: 1933
batch 459, loss: 1.1395, instance_loss: 0.5715, weighted_loss: 0.9691, label: 2, bag_size: 2501
batch 479, loss: 0.9125, instance_loss: 1.1154, weighted_loss: 0.9734, label: 1, bag_size: 2927
batch 499, loss: 0.7016, instance_loss: 0.5090, weighted_loss: 0.6438, label: 0, bag_size: 4717
batch 519, loss: 1.7382, instance_loss: 0.8846, weighted_loss: 1.4821, label: 1, bag_size: 4187
batch 539, loss: 0.0053, instance_loss: 0.6792, weighted_loss: 0.2075, label: 1, bag_size: 314
batch 559, loss: 0.1442, instance_loss: 0.3749, weighted_loss: 0.2134, label: 1, bag_size: 2494
batch 579, loss: 0.0000, instance_loss: 0.5247, weighted_loss: 0.1574, label: 0, bag_size: 1055
batch 599, loss: 0.1354, instance_loss: 0.5255, weighted_loss: 0.2524, label: 2, bag_size: 1222
batch 619, loss: 0.0126, instance_loss: 0.5832, weighted_loss: 0.1838, label: 0, bag_size: 996
batch 639, loss: 2.0565, instance_loss: 0.8855, weighted_loss: 1.7052, label: 1, bag_size: 3823
batch 659, loss: 0.0009, instance_loss: 0.1886, weighted_loss: 0.0572, label: 1, bag_size: 455
batch 679, loss: 0.2778, instance_loss: 0.7267, weighted_loss: 0.4125, label: 1, bag_size: 5011
batch 699, loss: 0.7275, instance_loss: 0.5466, weighted_loss: 0.6732, label: 0, bag_size: 4378
batch 719, loss: 0.0024, instance_loss: 0.3947, weighted_loss: 0.1201, label: 1, bag_size: 4684
batch 739, loss: 1.5187, instance_loss: 0.7658, weighted_loss: 1.2928, label: 2, bag_size: 1050


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.3958053691275168: correct 2359/5960
Epoch: 55, train_loss: 0.4206, train_clustering_loss:  0.5226, train_error: 0.1570
class 0: acc 0.8401639344262295, correct 205/244
class 1: acc 0.8046875, correct 206/256
class 2: acc 0.8857142857142857, correct 217/245

Val Set, val_loss: 0.6621, val_error: 0.2979, auc: 0.8882
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.511968085106383: correct 385/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0023, instance_loss: 0.1587, weighted_loss: 0.0492, label: 2, bag_size: 4497
batch 39, loss: 0.8890, instance_loss: 0.6751, weighted_loss: 0.8248, label: 0, bag_size: 3387
batch 59, loss: 0.0000, instance_loss: 0.0077, weighted_loss: 0.0023, label: 1, bag_size: 5462
batch 79, loss: 0.2415, instance_loss: 1.0042, weighted_loss: 0.4703, label: 0, bag_size: 5950
batch 99, loss: 0.8568, instance_loss: 0.8982, weighted_loss: 0.8692, label: 2, bag_size: 4910
batch 119, loss: 0.3907, instance_loss: 0.5788, weighted_loss: 0.4472, label: 1, bag_size: 3935
batch 139, loss: 0.1607, instance_loss: 0.4168, weighted_loss: 0.2375, label: 1, bag_size: 4812
batch 159, loss: 0.5977, instance_loss: 1.0230, weighted_loss: 0.7253, label: 1, bag_size: 5880
batch 179, loss: 0.2914, instance_loss: 0.6378, weighted_loss: 0.3953, label: 0, bag_size: 3038
batch 199, loss: 0.5016, instance_loss: 0.9780, weighted_loss: 0.6445, label: 1, bag_size: 3322
batch 219, loss: 0.7771, instance_loss: 0.4351, weighted_loss: 0.6745, label: 2, bag_size: 3583
batch 239, loss: 0.0853, instance_loss: 0.6197, weighted_loss: 0.2456, label: 0, bag_size: 4794
batch 259, loss: 0.1651, instance_loss: 0.4141, weighted_loss: 0.2398, label: 0, bag_size: 4506
batch 279, loss: 0.0223, instance_loss: 0.0925, weighted_loss: 0.0434, label: 0, bag_size: 3304
batch 299, loss: 0.4239, instance_loss: 0.7472, weighted_loss: 0.5209, label: 0, bag_size: 1052
batch 319, loss: 1.4394, instance_loss: 1.0582, weighted_loss: 1.3250, label: 1, bag_size: 4200
batch 339, loss: 2.2669, instance_loss: 1.6420, weighted_loss: 2.0794, label: 1, bag_size: 1549
batch 359, loss: 0.0248, instance_loss: 0.4100, weighted_loss: 0.1404, label: 0, bag_size: 2607
batch 379, loss: 0.1804, instance_loss: 0.3303, weighted_loss: 0.2254, label: 2, bag_size: 4192
batch 399, loss: 4.3947, instance_loss: 1.2309, weighted_loss: 3.4455, label: 0, bag_size: 603
batch 419, loss: 0.3294, instance_loss: 0.7559, weighted_loss: 0.4574, label: 2, bag_size: 5472
batch 439, loss: 0.0324, instance_loss: 0.4746, weighted_loss: 0.1651, label: 0, bag_size: 4379
batch 459, loss: 1.0198, instance_loss: 0.8518, weighted_loss: 0.9694, label: 1, bag_size: 3422
batch 479, loss: 1.5846, instance_loss: 0.7034, weighted_loss: 1.3203, label: 1, bag_size: 3786
batch 499, loss: 0.0213, instance_loss: 0.2478, weighted_loss: 0.0893, label: 0, bag_size: 4292
batch 519, loss: 0.5592, instance_loss: 0.4415, weighted_loss: 0.5239, label: 0, bag_size: 272
batch 539, loss: 0.2260, instance_loss: 0.3527, weighted_loss: 0.2640, label: 2, bag_size: 5426
batch 559, loss: 0.0416, instance_loss: 0.1256, weighted_loss: 0.0668, label: 0, bag_size: 1845
batch 579, loss: 0.8312, instance_loss: 0.8421, weighted_loss: 0.8345, label: 0, bag_size: 609
batch 599, loss: 0.0000, instance_loss: 0.1092, weighted_loss: 0.0327, label: 0, bag_size: 5003
batch 619, loss: 0.1224, instance_loss: 0.2519, weighted_loss: 0.1613, label: 2, bag_size: 3397
batch 639, loss: 0.0003, instance_loss: 0.0707, weighted_loss: 0.0214, label: 1, bag_size: 460
batch 659, loss: 0.3452, instance_loss: 0.3773, weighted_loss: 0.3548, label: 0, bag_size: 5459
batch 679, loss: 0.1116, instance_loss: 0.4849, weighted_loss: 0.2236, label: 2, bag_size: 5138
batch 699, loss: 0.1737, instance_loss: 1.6557, weighted_loss: 0.6183, label: 1, bag_size: 8482
batch 719, loss: 0.7253, instance_loss: 0.4315, weighted_loss: 0.6372, label: 0, bag_size: 3661
batch 739, loss: 0.4761, instance_loss: 0.5191, weighted_loss: 0.4890, label: 1, bag_size: 1595


class 0 clustering acc 0.9681767337807606: correct 17311/17880
class 1 clustering acc 0.4065436241610738: correct 2423/5960
Epoch: 56, train_loss: 0.4788, train_clustering_loss:  0.5242, train_error: 0.2000
class 0: acc 0.7976653696498055, correct 205/257
class 1: acc 0.7330508474576272, correct 173/236
class 2: acc 0.8650793650793651, correct 218/252

Val Set, val_loss: 0.6483, val_error: 0.2128, auc: 0.8990
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.3497340425531915: correct 263/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0334, instance_loss: 0.4533, weighted_loss: 0.1593, label: 1, bag_size: 5086
batch 39, loss: 0.3282, instance_loss: 0.4204, weighted_loss: 0.3558, label: 2, bag_size: 4291
batch 59, loss: 0.3165, instance_loss: 0.5464, weighted_loss: 0.3855, label: 2, bag_size: 728
batch 79, loss: 0.2437, instance_loss: 0.4004, weighted_loss: 0.2907, label: 0, bag_size: 1545
batch 99, loss: 0.5156, instance_loss: 0.8113, weighted_loss: 0.6043, label: 2, bag_size: 1543
batch 119, loss: 0.0007, instance_loss: 0.1530, weighted_loss: 0.0464, label: 0, bag_size: 5487
batch 139, loss: 0.1456, instance_loss: 0.4105, weighted_loss: 0.2251, label: 2, bag_size: 1050
batch 159, loss: 0.0091, instance_loss: 0.5201, weighted_loss: 0.1624, label: 1, bag_size: 3497
batch 179, loss: 0.3675, instance_loss: 0.3008, weighted_loss: 0.3475, label: 1, bag_size: 1410
batch 199, loss: 0.0000, instance_loss: 0.0002, weighted_loss: 0.0001, label: 0, bag_size: 4918
batch 219, loss: 0.0045, instance_loss: 0.5257, weighted_loss: 0.1608, label: 0, bag_size: 5837
batch 239, loss: 0.0942, instance_loss: 0.5804, weighted_loss: 0.2400, label: 2, bag_size: 5472
batch 259, loss: 0.0101, instance_loss: 0.1487, weighted_loss: 0.0517, label: 2, bag_size: 2561
batch 279, loss: 0.3233, instance_loss: 0.7117, weighted_loss: 0.4398, label: 1, bag_size: 5086
batch 299, loss: 0.4329, instance_loss: 0.5706, weighted_loss: 0.4742, label: 1, bag_size: 3322
batch 319, loss: 0.2222, instance_loss: 0.4916, weighted_loss: 0.3030, label: 0, bag_size: 3533
batch 339, loss: 0.1473, instance_loss: 0.2067, weighted_loss: 0.1651, label: 0, bag_size: 4092
batch 359, loss: 0.0006, instance_loss: 0.1066, weighted_loss: 0.0324, label: 1, bag_size: 1836
batch 379, loss: 0.0492, instance_loss: 0.6202, weighted_loss: 0.2205, label: 0, bag_size: 3701
batch 399, loss: 0.1869, instance_loss: 0.5212, weighted_loss: 0.2872, label: 2, bag_size: 4162
batch 419, loss: 0.0034, instance_loss: 0.0677, weighted_loss: 0.0227, label: 2, bag_size: 3285
batch 439, loss: 0.0116, instance_loss: 0.4008, weighted_loss: 0.1283, label: 1, bag_size: 3043
batch 459, loss: 0.0030, instance_loss: 0.3909, weighted_loss: 0.1194, label: 0, bag_size: 3247
batch 479, loss: 0.1692, instance_loss: 0.2487, weighted_loss: 0.1930, label: 0, bag_size: 5459
batch 499, loss: 0.2190, instance_loss: 0.2425, weighted_loss: 0.2260, label: 2, bag_size: 6298
batch 519, loss: 0.0022, instance_loss: 0.1424, weighted_loss: 0.0442, label: 0, bag_size: 3901
batch 539, loss: 1.5631, instance_loss: 1.5373, weighted_loss: 1.5554, label: 1, bag_size: 2229
batch 559, loss: 0.0288, instance_loss: 0.3572, weighted_loss: 0.1273, label: 1, bag_size: 3357
batch 579, loss: 0.1215, instance_loss: 0.4823, weighted_loss: 0.2298, label: 1, bag_size: 3221
batch 599, loss: 0.2432, instance_loss: 0.6460, weighted_loss: 0.3641, label: 1, bag_size: 2743
batch 619, loss: 0.0541, instance_loss: 0.3943, weighted_loss: 0.1562, label: 1, bag_size: 6156
batch 639, loss: 1.3041, instance_loss: 0.4773, weighted_loss: 1.0561, label: 2, bag_size: 2501
batch 659, loss: 0.1236, instance_loss: 0.3027, weighted_loss: 0.1773, label: 2, bag_size: 4569
batch 679, loss: 0.5749, instance_loss: 0.9167, weighted_loss: 0.6774, label: 1, bag_size: 1528
batch 699, loss: 0.6485, instance_loss: 0.6371, weighted_loss: 0.6451, label: 1, bag_size: 2342
batch 719, loss: 0.0189, instance_loss: 0.1387, weighted_loss: 0.0548, label: 2, bag_size: 4745
batch 739, loss: 0.2334, instance_loss: 0.2606, weighted_loss: 0.2416, label: 0, bag_size: 4325


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.40738255033557047: correct 2428/5960
Epoch: 57, train_loss: 0.4802, train_clustering_loss:  0.5366, train_error: 0.1799
class 0: acc 0.8064516129032258, correct 200/248
class 1: acc 0.7601626016260162, correct 187/246
class 2: acc 0.8924302788844621, correct 224/251

Val Set, val_loss: 0.7711, val_error: 0.2766, auc: 0.8745
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.29654255319148937: correct 223/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1982, instance_loss: 0.5087, weighted_loss: 0.2914, label: 1, bag_size: 3493
batch 39, loss: 0.4353, instance_loss: 0.3915, weighted_loss: 0.4222, label: 2, bag_size: 2501
batch 59, loss: 3.9942, instance_loss: 1.8167, weighted_loss: 3.3409, label: 1, bag_size: 3159
batch 79, loss: 0.1385, instance_loss: 0.6629, weighted_loss: 0.2958, label: 2, bag_size: 1543
batch 99, loss: 1.6208, instance_loss: 1.4781, weighted_loss: 1.5780, label: 1, bag_size: 8632
batch 119, loss: 0.0062, instance_loss: 0.2094, weighted_loss: 0.0672, label: 0, bag_size: 6138
batch 139, loss: 0.0191, instance_loss: 0.3808, weighted_loss: 0.1276, label: 0, bag_size: 3319
batch 159, loss: 0.2562, instance_loss: 0.4005, weighted_loss: 0.2995, label: 0, bag_size: 4337
batch 179, loss: 0.0270, instance_loss: 0.1428, weighted_loss: 0.0617, label: 2, bag_size: 3285
batch 199, loss: 0.0708, instance_loss: 0.2267, weighted_loss: 0.1175, label: 2, bag_size: 4302
batch 219, loss: 0.2612, instance_loss: 0.2313, weighted_loss: 0.2522, label: 2, bag_size: 4691
batch 239, loss: 0.1427, instance_loss: 0.4000, weighted_loss: 0.2199, label: 2, bag_size: 3618
batch 259, loss: 0.5863, instance_loss: 0.7066, weighted_loss: 0.6224, label: 1, bag_size: 5197
batch 279, loss: 0.0340, instance_loss: 0.1092, weighted_loss: 0.0566, label: 2, bag_size: 4856
batch 299, loss: 0.3465, instance_loss: 0.2276, weighted_loss: 0.3108, label: 2, bag_size: 3112
batch 319, loss: 0.6936, instance_loss: 0.5226, weighted_loss: 0.6423, label: 0, bag_size: 5484
batch 339, loss: 0.0331, instance_loss: 0.1149, weighted_loss: 0.0576, label: 2, bag_size: 4569
batch 359, loss: 0.0751, instance_loss: 0.3603, weighted_loss: 0.1607, label: 0, bag_size: 4378
batch 379, loss: 0.6293, instance_loss: 0.6741, weighted_loss: 0.6428, label: 2, bag_size: 552
batch 399, loss: 0.0054, instance_loss: 0.4306, weighted_loss: 0.1329, label: 0, bag_size: 4379
batch 419, loss: 1.8526, instance_loss: 1.1002, weighted_loss: 1.6269, label: 0, bag_size: 5840
batch 439, loss: 0.0052, instance_loss: 0.0650, weighted_loss: 0.0231, label: 2, bag_size: 4088
batch 459, loss: 0.5759, instance_loss: 0.4424, weighted_loss: 0.5358, label: 2, bag_size: 909
batch 479, loss: 0.1510, instance_loss: 0.2158, weighted_loss: 0.1704, label: 2, bag_size: 2359
batch 499, loss: 0.0045, instance_loss: 0.7911, weighted_loss: 0.2404, label: 1, bag_size: 6513
batch 519, loss: 0.0125, instance_loss: 0.3472, weighted_loss: 0.1129, label: 0, bag_size: 3289
batch 539, loss: 0.0741, instance_loss: 0.1322, weighted_loss: 0.0915, label: 2, bag_size: 2049
batch 559, loss: 0.4271, instance_loss: 0.7214, weighted_loss: 0.5154, label: 2, bag_size: 2813
batch 579, loss: 0.0483, instance_loss: 0.1261, weighted_loss: 0.0716, label: 2, bag_size: 6644
batch 599, loss: 0.1722, instance_loss: 0.1977, weighted_loss: 0.1799, label: 2, bag_size: 4096
batch 619, loss: 0.0454, instance_loss: 0.4484, weighted_loss: 0.1663, label: 1, bag_size: 5385
batch 639, loss: 0.0220, instance_loss: 0.2092, weighted_loss: 0.0782, label: 0, bag_size: 1545
batch 659, loss: 0.0264, instance_loss: 0.6483, weighted_loss: 0.2129, label: 0, bag_size: 889
batch 679, loss: 1.0761, instance_loss: 0.9978, weighted_loss: 1.0526, label: 2, bag_size: 4342
batch 699, loss: 2.9876, instance_loss: 1.6811, weighted_loss: 2.5957, label: 1, bag_size: 869
batch 719, loss: 0.1531, instance_loss: 0.5916, weighted_loss: 0.2846, label: 2, bag_size: 4535
batch 739, loss: 0.2959, instance_loss: 0.5170, weighted_loss: 0.3623, label: 1, bag_size: 3009


class 0 clustering acc 0.9705816554809843: correct 17354/17880
class 1 clustering acc 0.45486577181208054: correct 2711/5960
Epoch: 58, train_loss: 0.3958, train_clustering_loss:  0.4891, train_error: 0.1597
class 0: acc 0.8607594936708861, correct 204/237
class 1: acc 0.7426160337552743, correct 176/237
class 2: acc 0.9077490774907749, correct 246/271

Val Set, val_loss: 0.8954, val_error: 0.3298, auc: 0.8831
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.19547872340425532: correct 147/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0459, instance_loss: 0.3716, weighted_loss: 0.1436, label: 0, bag_size: 7927
batch 39, loss: 0.0032, instance_loss: 0.2109, weighted_loss: 0.0655, label: 0, bag_size: 3289
batch 59, loss: 0.0009, instance_loss: 0.1625, weighted_loss: 0.0493, label: 0, bag_size: 1233
batch 79, loss: 0.5035, instance_loss: 0.6715, weighted_loss: 0.5539, label: 2, bag_size: 5426
batch 99, loss: 0.0159, instance_loss: 0.0707, weighted_loss: 0.0324, label: 2, bag_size: 5914
batch 119, loss: 0.2513, instance_loss: 0.4308, weighted_loss: 0.3051, label: 0, bag_size: 768
batch 139, loss: 0.8708, instance_loss: 0.5448, weighted_loss: 0.7730, label: 2, bag_size: 5406
batch 159, loss: 0.0110, instance_loss: 0.0754, weighted_loss: 0.0303, label: 2, bag_size: 6026
batch 179, loss: 0.0240, instance_loss: 0.3506, weighted_loss: 0.1220, label: 1, bag_size: 6156
batch 199, loss: 0.0150, instance_loss: 0.2992, weighted_loss: 0.1003, label: 1, bag_size: 1027
batch 219, loss: 0.0754, instance_loss: 0.5826, weighted_loss: 0.2275, label: 0, bag_size: 2841
batch 239, loss: 0.0000, instance_loss: 0.2024, weighted_loss: 0.0607, label: 0, bag_size: 1106
batch 259, loss: 0.0693, instance_loss: 0.5194, weighted_loss: 0.2043, label: 0, bag_size: 4529
batch 279, loss: 0.0544, instance_loss: 0.1006, weighted_loss: 0.0683, label: 2, bag_size: 2905
batch 299, loss: 0.0019, instance_loss: 0.0485, weighted_loss: 0.0159, label: 0, bag_size: 4312
batch 319, loss: 0.6956, instance_loss: 0.7105, weighted_loss: 0.7000, label: 1, bag_size: 574
batch 339, loss: 0.1396, instance_loss: 0.2734, weighted_loss: 0.1797, label: 2, bag_size: 2359
batch 359, loss: 0.0723, instance_loss: 0.2175, weighted_loss: 0.1158, label: 0, bag_size: 5036
batch 379, loss: 0.0912, instance_loss: 0.3865, weighted_loss: 0.1798, label: 1, bag_size: 3367
batch 399, loss: 0.0000, instance_loss: 0.0777, weighted_loss: 0.0233, label: 1, bag_size: 2493
batch 419, loss: 0.0768, instance_loss: 0.2223, weighted_loss: 0.1204, label: 2, bag_size: 3327
batch 439, loss: 0.0087, instance_loss: 0.2282, weighted_loss: 0.0746, label: 1, bag_size: 712
batch 459, loss: 0.4027, instance_loss: 0.5067, weighted_loss: 0.4339, label: 2, bag_size: 5406
batch 479, loss: 0.0823, instance_loss: 0.3244, weighted_loss: 0.1549, label: 2, bag_size: 4569
batch 499, loss: 0.0942, instance_loss: 0.2371, weighted_loss: 0.1371, label: 2, bag_size: 2905
batch 519, loss: 0.0404, instance_loss: 0.8715, weighted_loss: 0.2898, label: 1, bag_size: 4181
batch 539, loss: 0.1924, instance_loss: 0.5612, weighted_loss: 0.3030, label: 1, bag_size: 2671
batch 559, loss: 2.1314, instance_loss: 0.8494, weighted_loss: 1.7468, label: 0, bag_size: 2597
batch 579, loss: 0.0025, instance_loss: 0.0929, weighted_loss: 0.0296, label: 2, bag_size: 4141
batch 599, loss: 0.0553, instance_loss: 0.1269, weighted_loss: 0.0768, label: 2, bag_size: 3678
batch 619, loss: 0.0208, instance_loss: 0.0652, weighted_loss: 0.0341, label: 1, bag_size: 5760
batch 639, loss: 2.8276, instance_loss: 1.1250, weighted_loss: 2.3168, label: 1, bag_size: 3261
batch 659, loss: 2.4548, instance_loss: 1.0951, weighted_loss: 2.0469, label: 0, bag_size: 20234
batch 679, loss: 0.2837, instance_loss: 0.3724, weighted_loss: 0.3103, label: 2, bag_size: 6704
batch 699, loss: 0.0149, instance_loss: 0.4710, weighted_loss: 0.1517, label: 1, bag_size: 4898
batch 719, loss: 4.3628, instance_loss: 1.5561, weighted_loss: 3.5208, label: 0, bag_size: 7504
batch 739, loss: 0.1636, instance_loss: 0.2534, weighted_loss: 0.1906, label: 2, bag_size: 4291


class 0 clustering acc 0.9668903803131991: correct 17288/17880
class 1 clustering acc 0.42953020134228187: correct 2560/5960
Epoch: 59, train_loss: 0.4439, train_clustering_loss:  0.5132, train_error: 0.1906
class 0: acc 0.8093385214007782, correct 208/257
class 1: acc 0.729957805907173, correct 173/237
class 2: acc 0.8844621513944223, correct 222/251

Val Set, val_loss: 0.7348, val_error: 0.2660, auc: 0.8922
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.29521276595744683: correct 222/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2096, instance_loss: 0.3712, weighted_loss: 0.2581, label: 0, bag_size: 3571
batch 39, loss: 0.0766, instance_loss: 0.4070, weighted_loss: 0.1757, label: 2, bag_size: 3210
batch 59, loss: 1.2515, instance_loss: 1.3318, weighted_loss: 1.2756, label: 1, bag_size: 5205
batch 79, loss: 3.5279, instance_loss: 1.4380, weighted_loss: 2.9009, label: 0, bag_size: 4605
batch 99, loss: 0.0338, instance_loss: 0.2492, weighted_loss: 0.0984, label: 2, bag_size: 3285
batch 119, loss: 0.0949, instance_loss: 0.7215, weighted_loss: 0.2829, label: 1, bag_size: 5340
batch 139, loss: 1.0252, instance_loss: 0.8338, weighted_loss: 0.9678, label: 1, bag_size: 1327
batch 159, loss: 0.1783, instance_loss: 0.6818, weighted_loss: 0.3293, label: 1, bag_size: 4262
batch 179, loss: 0.2266, instance_loss: 0.3860, weighted_loss: 0.2744, label: 1, bag_size: 2865
batch 199, loss: 0.3402, instance_loss: 0.2344, weighted_loss: 0.3085, label: 2, bag_size: 88
batch 219, loss: 0.7337, instance_loss: 0.5410, weighted_loss: 0.6759, label: 2, bag_size: 2481
batch 239, loss: 0.1027, instance_loss: 0.4982, weighted_loss: 0.2213, label: 1, bag_size: 3586
batch 259, loss: 0.0781, instance_loss: 0.3237, weighted_loss: 0.1518, label: 2, bag_size: 4132
batch 279, loss: 0.1436, instance_loss: 0.2418, weighted_loss: 0.1730, label: 2, bag_size: 4555
batch 299, loss: 0.1517, instance_loss: 0.3041, weighted_loss: 0.1974, label: 2, bag_size: 4555
batch 319, loss: 0.1168, instance_loss: 0.7237, weighted_loss: 0.2989, label: 2, bag_size: 223
batch 339, loss: 0.0044, instance_loss: 0.3540, weighted_loss: 0.1093, label: 2, bag_size: 4487
batch 359, loss: 0.4320, instance_loss: 1.0291, weighted_loss: 0.6111, label: 1, bag_size: 4467
batch 379, loss: 0.0039, instance_loss: 0.2451, weighted_loss: 0.0763, label: 0, bag_size: 2610
batch 399, loss: 0.0683, instance_loss: 0.2352, weighted_loss: 0.1184, label: 2, bag_size: 5138
batch 419, loss: 0.9513, instance_loss: 0.6557, weighted_loss: 0.8626, label: 1, bag_size: 2744
batch 439, loss: 0.0479, instance_loss: 0.2244, weighted_loss: 0.1009, label: 0, bag_size: 3777
batch 459, loss: 0.0884, instance_loss: 0.5939, weighted_loss: 0.2401, label: 1, bag_size: 5003
batch 479, loss: 0.5836, instance_loss: 0.8315, weighted_loss: 0.6580, label: 2, bag_size: 3604
batch 499, loss: 0.0677, instance_loss: 0.5351, weighted_loss: 0.2079, label: 1, bag_size: 4595
batch 519, loss: 0.7764, instance_loss: 0.5669, weighted_loss: 0.7136, label: 2, bag_size: 1222
batch 539, loss: 1.3439, instance_loss: 0.5083, weighted_loss: 1.0932, label: 0, bag_size: 4201
batch 559, loss: 0.9343, instance_loss: 0.8741, weighted_loss: 0.9162, label: 0, bag_size: 4146
batch 579, loss: 0.3946, instance_loss: 0.2165, weighted_loss: 0.3412, label: 2, bag_size: 2501
batch 599, loss: 0.0003, instance_loss: 1.2480, weighted_loss: 0.3746, label: 0, bag_size: 3594
batch 619, loss: 0.0435, instance_loss: 0.1211, weighted_loss: 0.0668, label: 2, bag_size: 1094
batch 639, loss: 0.0138, instance_loss: 0.1438, weighted_loss: 0.0528, label: 2, bag_size: 3176
batch 659, loss: 0.2348, instance_loss: 0.3418, weighted_loss: 0.2669, label: 2, bag_size: 2031
batch 679, loss: 0.0246, instance_loss: 0.6123, weighted_loss: 0.2009, label: 0, bag_size: 2232
batch 699, loss: 0.0960, instance_loss: 0.3159, weighted_loss: 0.1620, label: 0, bag_size: 999
batch 719, loss: 0.0167, instance_loss: 0.1536, weighted_loss: 0.0577, label: 0, bag_size: 966
batch 739, loss: 0.0640, instance_loss: 0.1579, weighted_loss: 0.0922, label: 2, bag_size: 4223


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.3785234899328859: correct 2256/5960
Epoch: 60, train_loss: 0.4541, train_clustering_loss:  0.5338, train_error: 0.1879
class 0: acc 0.8135593220338984, correct 192/236
class 1: acc 0.7429718875502008, correct 185/249
class 2: acc 0.8769230769230769, correct 228/260

Val Set, val_loss: 0.7518, val_error: 0.2660, auc: 0.8890
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.3617021276595745: correct 272/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.2340, ROC AUC: 0.8998
Test error: 0.2447, ROC AUC: 0.9009
class 0: acc 0.9423076923076923, correct 49/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.3632, instance_loss: 0.6627, weighted_loss: 0.4530, label: 1, bag_size: 2744
batch 39, loss: 1.9065, instance_loss: 0.8362, weighted_loss: 1.5854, label: 0, bag_size: 421
batch 59, loss: 1.1833, instance_loss: 0.7721, weighted_loss: 1.0599, label: 2, bag_size: 3112
batch 79, loss: 1.8195, instance_loss: 0.8772, weighted_loss: 1.5368, label: 2, bag_size: 2813
batch 99, loss: 2.2762, instance_loss: 0.8420, weighted_loss: 1.8459, label: 1, bag_size: 1066
batch 119, loss: 1.8778, instance_loss: 0.6792, weighted_loss: 1.5182, label: 0, bag_size: 4935
batch 139, loss: 0.8493, instance_loss: 0.7961, weighted_loss: 0.8333, label: 1, bag_size: 3050
batch 159, loss: 1.4668, instance_loss: 0.8035, weighted_loss: 1.2678, label: 0, bag_size: 5893
batch 179, loss: 1.5300, instance_loss: 0.8328, weighted_loss: 1.3209, label: 0, bag_size: 768
batch 199, loss: 1.3690, instance_loss: 0.7847, weighted_loss: 1.1937, label: 2, bag_size: 3112
batch 219, loss: 0.5489, instance_loss: 0.6150, weighted_loss: 0.5688, label: 2, bag_size: 88
batch 239, loss: 1.5556, instance_loss: 0.8524, weighted_loss: 1.3447, label: 0, bag_size: 1365
batch 259, loss: 0.7987, instance_loss: 0.6535, weighted_loss: 0.7551, label: 2, bag_size: 2031
batch 279, loss: 0.5572, instance_loss: 0.6685, weighted_loss: 0.5906, label: 2, bag_size: 4372
batch 299, loss: 0.4827, instance_loss: 0.5980, weighted_loss: 0.5173, label: 0, bag_size: 2825
batch 319, loss: 0.9436, instance_loss: 0.7472, weighted_loss: 0.8847, label: 2, bag_size: 4555
batch 339, loss: 3.1975, instance_loss: 1.6576, weighted_loss: 2.7355, label: 1, bag_size: 3533
batch 359, loss: 0.1947, instance_loss: 0.5685, weighted_loss: 0.3069, label: 1, bag_size: 874
batch 379, loss: 1.0733, instance_loss: 0.5215, weighted_loss: 0.9078, label: 1, bag_size: 6156
batch 399, loss: 0.2743, instance_loss: 0.4213, weighted_loss: 0.3184, label: 1, bag_size: 5011
batch 419, loss: 0.7362, instance_loss: 0.6937, weighted_loss: 0.7234, label: 2, bag_size: 1103
batch 439, loss: 1.3423, instance_loss: 0.9986, weighted_loss: 1.2392, label: 2, bag_size: 2486
batch 459, loss: 0.9877, instance_loss: 0.7594, weighted_loss: 0.9192, label: 2, bag_size: 3299
batch 479, loss: 1.5938, instance_loss: 0.8323, weighted_loss: 1.3654, label: 0, bag_size: 4711
batch 499, loss: 0.4026, instance_loss: 0.5648, weighted_loss: 0.4513, label: 1, bag_size: 874
batch 519, loss: 0.6764, instance_loss: 0.6214, weighted_loss: 0.6599, label: 0, bag_size: 5795
batch 539, loss: 1.0046, instance_loss: 0.6808, weighted_loss: 0.9074, label: 0, bag_size: 5585
batch 559, loss: 1.0251, instance_loss: 0.8405, weighted_loss: 0.9698, label: 1, bag_size: 3221
batch 579, loss: 0.9329, instance_loss: 0.6204, weighted_loss: 0.8392, label: 0, bag_size: 4584
batch 599, loss: 0.3853, instance_loss: 0.5805, weighted_loss: 0.4438, label: 0, bag_size: 477
batch 619, loss: 0.7744, instance_loss: 0.6223, weighted_loss: 0.7288, label: 0, bag_size: 4071
batch 639, loss: 0.4582, instance_loss: 0.5055, weighted_loss: 0.4724, label: 1, bag_size: 3109
batch 659, loss: 0.5764, instance_loss: 0.6367, weighted_loss: 0.5945, label: 0, bag_size: 4841
batch 679, loss: 0.7002, instance_loss: 0.7649, weighted_loss: 0.7196, label: 2, bag_size: 3227
batch 699, loss: 1.3274, instance_loss: 0.7975, weighted_loss: 1.1685, label: 2, bag_size: 1543
batch 719, loss: 1.6476, instance_loss: 0.8485, weighted_loss: 1.4079, label: 1, bag_size: 1122
batch 739, loss: 1.8077, instance_loss: 0.8446, weighted_loss: 1.5188, label: 0, bag_size: 20234


class 0 clustering acc 0.995413870246085: correct 17798/17880
class 1 clustering acc 0.016107382550335572: correct 96/5960
Epoch: 0, train_loss: 1.0249, train_clustering_loss:  0.7218, train_error: 0.4913
class 0: acc 0.5077519379844961, correct 131/258
class 1: acc 0.46938775510204084, correct 115/245
class 2: acc 0.5495867768595041, correct 133/242

Val Set, val_loss: 0.8794, val_error: 0.4043, auc: 0.7679
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (inf --> 0.879449).  Saving model ...


batch 19, loss: 2.2807, instance_loss: 0.9841, weighted_loss: 1.8917, label: 2, bag_size: 728
batch 39, loss: 0.3228, instance_loss: 0.6149, weighted_loss: 0.4104, label: 2, bag_size: 3210
batch 59, loss: 0.1631, instance_loss: 0.2730, weighted_loss: 0.1960, label: 1, bag_size: 3127
batch 79, loss: 0.6125, instance_loss: 0.6780, weighted_loss: 0.6321, label: 0, bag_size: 1399
batch 99, loss: 0.7192, instance_loss: 0.7117, weighted_loss: 0.7169, label: 0, bag_size: 421
batch 119, loss: 1.8377, instance_loss: 1.0517, weighted_loss: 1.6019, label: 1, bag_size: 32
batch 139, loss: 0.6321, instance_loss: 0.7299, weighted_loss: 0.6614, label: 2, bag_size: 5037
batch 159, loss: 0.8146, instance_loss: 0.6694, weighted_loss: 0.7711, label: 0, bag_size: 4506
batch 179, loss: 0.5071, instance_loss: 0.4317, weighted_loss: 0.4845, label: 1, bag_size: 5532
batch 199, loss: 0.1723, instance_loss: 0.5289, weighted_loss: 0.2793, label: 2, bag_size: 3094
batch 219, loss: 0.9286, instance_loss: 0.7019, weighted_loss: 0.8606, label: 1, bag_size: 4395
batch 239, loss: 1.0011, instance_loss: 0.8951, weighted_loss: 0.9693, label: 2, bag_size: 4241
batch 259, loss: 0.6474, instance_loss: 0.6394, weighted_loss: 0.6450, label: 1, bag_size: 3296
batch 279, loss: 1.0634, instance_loss: 0.6009, weighted_loss: 0.9247, label: 1, bag_size: 2852
batch 299, loss: 1.2062, instance_loss: 0.7256, weighted_loss: 1.0620, label: 0, bag_size: 4201
batch 319, loss: 0.7205, instance_loss: 0.6207, weighted_loss: 0.6905, label: 0, bag_size: 4918
batch 339, loss: 0.4941, instance_loss: 0.6892, weighted_loss: 0.5526, label: 2, bag_size: 88
batch 359, loss: 1.1524, instance_loss: 0.8112, weighted_loss: 1.0500, label: 2, bag_size: 5743
batch 379, loss: 0.4253, instance_loss: 0.5727, weighted_loss: 0.4695, label: 0, bag_size: 3319
batch 399, loss: 0.2423, instance_loss: 0.5221, weighted_loss: 0.3262, label: 2, bag_size: 2481
batch 419, loss: 0.3129, instance_loss: 0.5081, weighted_loss: 0.3715, label: 2, bag_size: 1094
batch 439, loss: 1.4517, instance_loss: 0.8469, weighted_loss: 1.2703, label: 2, bag_size: 3746
batch 459, loss: 0.9437, instance_loss: 0.6379, weighted_loss: 0.8520, label: 1, bag_size: 3403
batch 479, loss: 1.1956, instance_loss: 0.6670, weighted_loss: 1.0370, label: 1, bag_size: 1964
batch 499, loss: 2.2462, instance_loss: 0.9692, weighted_loss: 1.8631, label: 2, bag_size: 3475
batch 519, loss: 0.4195, instance_loss: 0.6466, weighted_loss: 0.4876, label: 2, bag_size: 4223
batch 539, loss: 0.2517, instance_loss: 0.6547, weighted_loss: 0.3726, label: 2, bag_size: 6273
batch 559, loss: 0.3366, instance_loss: 0.6178, weighted_loss: 0.4210, label: 0, bag_size: 966
batch 579, loss: 0.2168, instance_loss: 0.3439, weighted_loss: 0.2550, label: 0, bag_size: 6015
batch 599, loss: 0.7874, instance_loss: 0.3478, weighted_loss: 0.6555, label: 0, bag_size: 3777
batch 619, loss: 0.9801, instance_loss: 0.8297, weighted_loss: 0.9350, label: 1, bag_size: 1394
batch 639, loss: 0.6327, instance_loss: 0.6593, weighted_loss: 0.6407, label: 1, bag_size: 5693
batch 659, loss: 1.9487, instance_loss: 0.9934, weighted_loss: 1.6621, label: 2, bag_size: 4342
batch 679, loss: 1.4905, instance_loss: 0.7359, weighted_loss: 1.2641, label: 1, bag_size: 2229
batch 699, loss: 0.5405, instance_loss: 0.7193, weighted_loss: 0.5941, label: 2, bag_size: 3497
batch 719, loss: 0.8113, instance_loss: 0.9544, weighted_loss: 0.8542, label: 2, bag_size: 3607
batch 739, loss: 1.2548, instance_loss: 0.5362, weighted_loss: 1.0392, label: 1, bag_size: 3885


class 0 clustering acc 0.9970357941834452: correct 17827/17880
class 1 clustering acc 0.017281879194630874: correct 103/5960
Epoch: 1, train_loss: 0.9235, train_clustering_loss:  0.6955, train_error: 0.4537
class 0: acc 0.5224489795918368, correct 128/245
class 1: acc 0.5353159851301115, correct 144/269
class 2: acc 0.5844155844155844, correct 135/231

Val Set, val_loss: 1.1693, val_error: 0.6383, auc: 0.7950
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.011968085106382979: correct 9/752
class 0: acc 0.15384615384615385, correct 8/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6029, instance_loss: 0.8683, weighted_loss: 0.6825, label: 2, bag_size: 2049
batch 39, loss: 0.9935, instance_loss: 0.8194, weighted_loss: 0.9413, label: 0, bag_size: 768
batch 59, loss: 0.7831, instance_loss: 0.8672, weighted_loss: 0.8083, label: 2, bag_size: 3172
batch 79, loss: 0.5051, instance_loss: 0.6177, weighted_loss: 0.5389, label: 1, bag_size: 3357
batch 99, loss: 0.4447, instance_loss: 0.6067, weighted_loss: 0.4933, label: 2, bag_size: 2481
batch 119, loss: 1.1152, instance_loss: 0.7040, weighted_loss: 0.9919, label: 0, bag_size: 2610
batch 139, loss: 1.0996, instance_loss: 0.7753, weighted_loss: 1.0023, label: 2, bag_size: 4291
batch 159, loss: 0.6047, instance_loss: 0.6731, weighted_loss: 0.6252, label: 2, bag_size: 3299
batch 179, loss: 0.4668, instance_loss: 0.6634, weighted_loss: 0.5258, label: 1, bag_size: 4184
batch 199, loss: 0.2135, instance_loss: 0.6124, weighted_loss: 0.3332, label: 2, bag_size: 3678
batch 219, loss: 0.4006, instance_loss: 0.6228, weighted_loss: 0.4672, label: 0, bag_size: 1176
batch 239, loss: 1.0195, instance_loss: 0.7329, weighted_loss: 0.9336, label: 1, bag_size: 4346
batch 259, loss: 0.8009, instance_loss: 0.7145, weighted_loss: 0.7750, label: 0, bag_size: 3376
batch 279, loss: 0.0931, instance_loss: 0.4045, weighted_loss: 0.1865, label: 1, bag_size: 1836
batch 299, loss: 1.4034, instance_loss: 0.6803, weighted_loss: 1.1865, label: 1, bag_size: 1307
batch 319, loss: 0.3756, instance_loss: 0.5185, weighted_loss: 0.4185, label: 1, bag_size: 2753
batch 339, loss: 3.9867, instance_loss: 1.5327, weighted_loss: 3.2505, label: 0, bag_size: 2736
batch 359, loss: 0.9644, instance_loss: 0.7023, weighted_loss: 0.8858, label: 1, bag_size: 667
batch 379, loss: 0.3005, instance_loss: 0.6489, weighted_loss: 0.4050, label: 2, bag_size: 5017
batch 399, loss: 1.7663, instance_loss: 0.9734, weighted_loss: 1.5284, label: 1, bag_size: 782
batch 419, loss: 1.0260, instance_loss: 0.7942, weighted_loss: 0.9565, label: 0, bag_size: 1782
batch 439, loss: 0.8839, instance_loss: 0.6095, weighted_loss: 0.8016, label: 2, bag_size: 5037
batch 459, loss: 0.7915, instance_loss: 0.7961, weighted_loss: 0.7929, label: 2, bag_size: 3810
batch 479, loss: 1.7424, instance_loss: 0.7759, weighted_loss: 1.4525, label: 1, bag_size: 1604
batch 499, loss: 3.0106, instance_loss: 1.0892, weighted_loss: 2.4342, label: 0, bag_size: 434
batch 519, loss: 0.5041, instance_loss: 0.6520, weighted_loss: 0.5485, label: 1, bag_size: 712
batch 539, loss: 1.0066, instance_loss: 0.6860, weighted_loss: 0.9104, label: 1, bag_size: 2642
batch 559, loss: 0.4822, instance_loss: 0.7107, weighted_loss: 0.5507, label: 2, bag_size: 4291
batch 579, loss: 0.8051, instance_loss: 0.6650, weighted_loss: 0.7630, label: 2, bag_size: 3534
batch 599, loss: 1.5575, instance_loss: 0.7662, weighted_loss: 1.3201, label: 1, bag_size: 4187
batch 619, loss: 0.4790, instance_loss: 0.5279, weighted_loss: 0.4936, label: 0, bag_size: 3816
batch 639, loss: 0.3067, instance_loss: 0.5828, weighted_loss: 0.3895, label: 1, bag_size: 2796
batch 659, loss: 1.8471, instance_loss: 0.8270, weighted_loss: 1.5411, label: 1, bag_size: 4784
batch 679, loss: 0.2825, instance_loss: 0.4390, weighted_loss: 0.3295, label: 2, bag_size: 5406
batch 699, loss: 0.7354, instance_loss: 0.7601, weighted_loss: 0.7428, label: 1, bag_size: 800
batch 719, loss: 0.5049, instance_loss: 0.4648, weighted_loss: 0.4929, label: 2, bag_size: 4096
batch 739, loss: 0.8610, instance_loss: 0.8170, weighted_loss: 0.8478, label: 1, bag_size: 1607


class 0 clustering acc 0.9961968680089486: correct 17812/17880
class 1 clustering acc 0.019630872483221477: correct 117/5960
Epoch: 2, train_loss: 0.8621, train_clustering_loss:  0.6844, train_error: 0.3785
class 0: acc 0.5619834710743802, correct 136/242
class 1: acc 0.5232067510548524, correct 124/237
class 2: acc 0.7631578947368421, correct 203/266

Val Set, val_loss: 0.8216, val_error: 0.3191, auc: 0.8137
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.879449 --> 0.821574).  Saving model ...


batch 19, loss: 0.4976, instance_loss: 0.6627, weighted_loss: 0.5471, label: 1, bag_size: 8632
batch 39, loss: 1.1349, instance_loss: 0.8094, weighted_loss: 1.0372, label: 1, bag_size: 2481
batch 59, loss: 1.5011, instance_loss: 0.8755, weighted_loss: 1.3135, label: 1, bag_size: 1371
batch 79, loss: 0.2594, instance_loss: 0.4486, weighted_loss: 0.3162, label: 0, bag_size: 921
batch 99, loss: 0.1844, instance_loss: 0.5367, weighted_loss: 0.2901, label: 2, bag_size: 4856
batch 119, loss: 0.3868, instance_loss: 0.4585, weighted_loss: 0.4083, label: 0, bag_size: 4242
batch 139, loss: 0.2652, instance_loss: 0.3940, weighted_loss: 0.3039, label: 0, bag_size: 4455
batch 159, loss: 0.1715, instance_loss: 0.3269, weighted_loss: 0.2181, label: 0, bag_size: 5795
batch 179, loss: 0.6761, instance_loss: 0.8944, weighted_loss: 0.7416, label: 2, bag_size: 3746
batch 199, loss: 1.5952, instance_loss: 0.8201, weighted_loss: 1.3627, label: 1, bag_size: 5402
batch 219, loss: 0.6398, instance_loss: 0.7039, weighted_loss: 0.6590, label: 0, bag_size: 2428
batch 239, loss: 1.0853, instance_loss: 0.8076, weighted_loss: 1.0020, label: 1, bag_size: 3746
batch 259, loss: 0.5791, instance_loss: 0.5520, weighted_loss: 0.5710, label: 0, bag_size: 2487
batch 279, loss: 0.3908, instance_loss: 0.5185, weighted_loss: 0.4291, label: 0, bag_size: 2579
batch 299, loss: 2.4945, instance_loss: 1.1467, weighted_loss: 2.0901, label: 0, bag_size: 603
batch 319, loss: 0.3092, instance_loss: 0.5130, weighted_loss: 0.3703, label: 2, bag_size: 2501
batch 339, loss: 0.1983, instance_loss: 0.3248, weighted_loss: 0.2362, label: 2, bag_size: 88
batch 359, loss: 1.5490, instance_loss: 0.9306, weighted_loss: 1.3635, label: 1, bag_size: 5873
batch 379, loss: 1.3465, instance_loss: 0.7448, weighted_loss: 1.1660, label: 2, bag_size: 1513
batch 399, loss: 1.6580, instance_loss: 0.8013, weighted_loss: 1.4010, label: 1, bag_size: 1097
batch 419, loss: 0.4420, instance_loss: 0.5443, weighted_loss: 0.4726, label: 0, bag_size: 2712
batch 439, loss: 0.3204, instance_loss: 0.5202, weighted_loss: 0.3803, label: 2, bag_size: 657
batch 459, loss: 1.3250, instance_loss: 0.7484, weighted_loss: 1.1521, label: 1, bag_size: 7109
batch 479, loss: 1.3909, instance_loss: 0.6663, weighted_loss: 1.1736, label: 2, bag_size: 3534
batch 499, loss: 0.5606, instance_loss: 0.6918, weighted_loss: 0.6000, label: 0, bag_size: 1176
batch 519, loss: 1.8173, instance_loss: 0.8561, weighted_loss: 1.5289, label: 1, bag_size: 3399
batch 539, loss: 0.3004, instance_loss: 0.5830, weighted_loss: 0.3852, label: 0, bag_size: 471
batch 559, loss: 1.0741, instance_loss: 0.6633, weighted_loss: 0.9509, label: 1, bag_size: 578
batch 579, loss: 0.5778, instance_loss: 0.6683, weighted_loss: 0.6050, label: 2, bag_size: 597
batch 599, loss: 0.2338, instance_loss: 0.5750, weighted_loss: 0.3361, label: 0, bag_size: 829
batch 619, loss: 0.5022, instance_loss: 0.6418, weighted_loss: 0.5441, label: 0, bag_size: 4544
batch 639, loss: 1.0835, instance_loss: 0.8336, weighted_loss: 1.0085, label: 0, bag_size: 4398
batch 659, loss: 1.4748, instance_loss: 0.8444, weighted_loss: 1.2857, label: 0, bag_size: 5260
batch 679, loss: 0.8728, instance_loss: 0.7392, weighted_loss: 0.8327, label: 2, bag_size: 5472
batch 699, loss: 0.7388, instance_loss: 0.6120, weighted_loss: 0.7008, label: 0, bag_size: 4165
batch 719, loss: 0.1965, instance_loss: 0.4151, weighted_loss: 0.2620, label: 1, bag_size: 2753
batch 739, loss: 0.3694, instance_loss: 0.4252, weighted_loss: 0.3861, label: 1, bag_size: 2744


class 0 clustering acc 0.9968680089485459: correct 17824/17880
class 1 clustering acc 0.024161073825503355: correct 144/5960
Epoch: 3, train_loss: 0.8212, train_clustering_loss:  0.6610, train_error: 0.3745
class 0: acc 0.649402390438247, correct 163/251
class 1: acc 0.5163934426229508, correct 126/244
class 2: acc 0.708, correct 177/250

Val Set, val_loss: 0.8561, val_error: 0.3830, auc: 0.8129
class 0 clustering acc 0.9986702127659575: correct 2253/2256
class 1 clustering acc 0.003989361702127659: correct 3/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8699, instance_loss: 0.6565, weighted_loss: 0.8059, label: 0, bag_size: 8611
batch 39, loss: 2.1668, instance_loss: 0.7321, weighted_loss: 1.7364, label: 1, bag_size: 2852
batch 59, loss: 0.2697, instance_loss: 0.3858, weighted_loss: 0.3045, label: 2, bag_size: 4056
batch 79, loss: 0.4301, instance_loss: 0.5602, weighted_loss: 0.4691, label: 0, bag_size: 1601
batch 99, loss: 0.6029, instance_loss: 0.5941, weighted_loss: 0.6003, label: 2, bag_size: 3534
batch 119, loss: 0.0708, instance_loss: 0.2580, weighted_loss: 0.1269, label: 2, bag_size: 2254
batch 139, loss: 0.1814, instance_loss: 0.5256, weighted_loss: 0.2847, label: 2, bag_size: 4132
batch 159, loss: 0.1830, instance_loss: 0.6347, weighted_loss: 0.3185, label: 1, bag_size: 3333
batch 179, loss: 0.8747, instance_loss: 0.5358, weighted_loss: 0.7731, label: 0, bag_size: 5656
batch 199, loss: 0.2285, instance_loss: 0.4368, weighted_loss: 0.2910, label: 0, bag_size: 1025
batch 219, loss: 0.0825, instance_loss: 0.2215, weighted_loss: 0.1242, label: 2, bag_size: 4088
batch 239, loss: 0.0955, instance_loss: 0.4440, weighted_loss: 0.2001, label: 2, bag_size: 3121
batch 259, loss: 0.0942, instance_loss: 0.3928, weighted_loss: 0.1838, label: 0, bag_size: 4744
batch 279, loss: 0.0847, instance_loss: 0.2990, weighted_loss: 0.1490, label: 0, bag_size: 1174
batch 299, loss: 1.0737, instance_loss: 0.7400, weighted_loss: 0.9736, label: 0, bag_size: 14791
batch 319, loss: 0.7964, instance_loss: 0.8542, weighted_loss: 0.8137, label: 1, bag_size: 5003
batch 339, loss: 0.7999, instance_loss: 0.7391, weighted_loss: 0.7817, label: 0, bag_size: 2378
batch 359, loss: 0.4584, instance_loss: 0.5025, weighted_loss: 0.4716, label: 0, bag_size: 3113
batch 379, loss: 1.2433, instance_loss: 0.7958, weighted_loss: 1.1091, label: 1, bag_size: 3322
batch 399, loss: 2.4493, instance_loss: 0.8640, weighted_loss: 1.9737, label: 2, bag_size: 3475
batch 419, loss: 0.3320, instance_loss: 0.3958, weighted_loss: 0.3511, label: 0, bag_size: 3344
batch 439, loss: 0.5442, instance_loss: 0.6848, weighted_loss: 0.5864, label: 2, bag_size: 3778
batch 459, loss: 0.6638, instance_loss: 0.7612, weighted_loss: 0.6930, label: 2, bag_size: 5743
batch 479, loss: 0.2122, instance_loss: 0.8122, weighted_loss: 0.3922, label: 1, bag_size: 4027
batch 499, loss: 0.0507, instance_loss: 0.6471, weighted_loss: 0.2296, label: 1, bag_size: 3043
batch 519, loss: 3.7248, instance_loss: 1.4454, weighted_loss: 3.0410, label: 1, bag_size: 4067
batch 539, loss: 0.0051, instance_loss: 0.0103, weighted_loss: 0.0067, label: 0, bag_size: 4918
batch 559, loss: 1.2455, instance_loss: 0.7495, weighted_loss: 1.0967, label: 1, bag_size: 2751
batch 579, loss: 0.5503, instance_loss: 0.5966, weighted_loss: 0.5642, label: 1, bag_size: 3983
batch 599, loss: 0.3057, instance_loss: 0.5022, weighted_loss: 0.3647, label: 1, bag_size: 3396
batch 619, loss: 2.4996, instance_loss: 1.4389, weighted_loss: 2.1814, label: 0, bag_size: 7504
batch 639, loss: 1.0743, instance_loss: 0.9406, weighted_loss: 1.0342, label: 0, bag_size: 436
batch 659, loss: 1.0953, instance_loss: 0.8319, weighted_loss: 1.0163, label: 1, bag_size: 6156
batch 679, loss: 2.1329, instance_loss: 1.2694, weighted_loss: 1.8738, label: 1, bag_size: 3159
batch 699, loss: 1.3600, instance_loss: 0.8380, weighted_loss: 1.2034, label: 1, bag_size: 1122
batch 719, loss: 0.4562, instance_loss: 0.5654, weighted_loss: 0.4890, label: 0, bag_size: 5632
batch 739, loss: 1.4080, instance_loss: 1.0082, weighted_loss: 1.2880, label: 2, bag_size: 5072


class 0 clustering acc 0.9940715883668904: correct 17774/17880
class 1 clustering acc 0.04697986577181208: correct 280/5960
Epoch: 4, train_loss: 0.8050, train_clustering_loss:  0.6551, train_error: 0.3463
class 0: acc 0.6853932584269663, correct 183/267
class 1: acc 0.4594594594594595, correct 102/222
class 2: acc 0.7890625, correct 202/256

Val Set, val_loss: 0.7422, val_error: 0.3191, auc: 0.8288
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0013297872340425532: correct 1/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.821574 --> 0.742211).  Saving model ...


batch 19, loss: 2.3659, instance_loss: 0.7911, weighted_loss: 1.8934, label: 1, bag_size: 5880
batch 39, loss: 0.2296, instance_loss: 0.4984, weighted_loss: 0.3102, label: 1, bag_size: 700
batch 59, loss: 0.9547, instance_loss: 0.6984, weighted_loss: 0.8778, label: 2, bag_size: 5307
batch 79, loss: 0.4579, instance_loss: 0.5831, weighted_loss: 0.4955, label: 1, bag_size: 2494
batch 99, loss: 0.3228, instance_loss: 0.6605, weighted_loss: 0.4241, label: 2, bag_size: 3112
batch 119, loss: 0.4179, instance_loss: 0.5925, weighted_loss: 0.4703, label: 0, bag_size: 2601
batch 139, loss: 0.3044, instance_loss: 0.4472, weighted_loss: 0.3472, label: 1, bag_size: 2870
batch 159, loss: 0.6404, instance_loss: 0.4989, weighted_loss: 0.5979, label: 2, bag_size: 4223
batch 179, loss: 0.4905, instance_loss: 0.5338, weighted_loss: 0.5035, label: 0, bag_size: 3777
batch 199, loss: 1.1671, instance_loss: 0.9193, weighted_loss: 1.0927, label: 2, bag_size: 4910
batch 219, loss: 0.0854, instance_loss: 0.4130, weighted_loss: 0.1837, label: 2, bag_size: 5914
batch 239, loss: 0.8740, instance_loss: 0.7037, weighted_loss: 0.8230, label: 1, bag_size: 2831
batch 259, loss: 0.3107, instance_loss: 0.4079, weighted_loss: 0.3399, label: 1, bag_size: 862
batch 279, loss: 0.3028, instance_loss: 0.3680, weighted_loss: 0.3224, label: 2, bag_size: 2481
batch 299, loss: 0.2867, instance_loss: 0.4998, weighted_loss: 0.3506, label: 0, bag_size: 3408
batch 319, loss: 0.8595, instance_loss: 0.6342, weighted_loss: 0.7919, label: 0, bag_size: 4909
batch 339, loss: 0.3794, instance_loss: 0.5790, weighted_loss: 0.4393, label: 0, bag_size: 16741
batch 359, loss: 1.1770, instance_loss: 0.5650, weighted_loss: 0.9934, label: 1, bag_size: 7109
batch 379, loss: 0.6825, instance_loss: 0.8869, weighted_loss: 0.7438, label: 2, bag_size: 5472
batch 399, loss: 0.9022, instance_loss: 0.5815, weighted_loss: 0.8060, label: 1, bag_size: 5512
batch 419, loss: 0.4768, instance_loss: 0.4731, weighted_loss: 0.4757, label: 1, bag_size: 2865
batch 439, loss: 1.6234, instance_loss: 0.8214, weighted_loss: 1.3828, label: 0, bag_size: 4509
batch 459, loss: 0.0671, instance_loss: 0.2718, weighted_loss: 0.1285, label: 2, bag_size: 3397
batch 479, loss: 0.2171, instance_loss: 0.4718, weighted_loss: 0.2935, label: 0, bag_size: 5337
batch 499, loss: 1.8234, instance_loss: 0.8381, weighted_loss: 1.5278, label: 2, bag_size: 4179
batch 519, loss: 1.9834, instance_loss: 0.7908, weighted_loss: 1.6256, label: 2, bag_size: 3274
batch 539, loss: 0.2431, instance_loss: 0.4132, weighted_loss: 0.2941, label: 0, bag_size: 4744
batch 559, loss: 0.1081, instance_loss: 0.3226, weighted_loss: 0.1725, label: 2, bag_size: 657
batch 579, loss: 0.3425, instance_loss: 0.5477, weighted_loss: 0.4041, label: 0, bag_size: 3539
batch 599, loss: 1.6710, instance_loss: 0.6362, weighted_loss: 1.3606, label: 0, bag_size: 4018
batch 619, loss: 1.1309, instance_loss: 0.5176, weighted_loss: 0.9469, label: 1, bag_size: 3813
batch 639, loss: 0.0601, instance_loss: 0.2110, weighted_loss: 0.1054, label: 1, bag_size: 2905
batch 659, loss: 0.5541, instance_loss: 0.4704, weighted_loss: 0.5290, label: 1, bag_size: 3823
batch 679, loss: 2.1921, instance_loss: 0.8128, weighted_loss: 1.7783, label: 1, bag_size: 1542
batch 699, loss: 1.1164, instance_loss: 0.5038, weighted_loss: 0.9326, label: 2, bag_size: 2031
batch 719, loss: 0.0736, instance_loss: 0.2995, weighted_loss: 0.1413, label: 1, bag_size: 4027
batch 739, loss: 0.7950, instance_loss: 0.9543, weighted_loss: 0.8428, label: 2, bag_size: 4571


class 0 clustering acc 0.9884228187919463: correct 17673/17880
class 1 clustering acc 0.10251677852348993: correct 611/5960
Epoch: 5, train_loss: 0.7642, train_clustering_loss:  0.6310, train_error: 0.3248
class 0: acc 0.6183574879227053, correct 128/207
class 1: acc 0.6240875912408759, correct 171/274
class 2: acc 0.7727272727272727, correct 204/264

Val Set, val_loss: 0.9294, val_error: 0.4468, auc: 0.8238
class 0 clustering acc 0.9995567375886525: correct 2255/2256
class 1 clustering acc 0.003989361702127659: correct 3/752
class 0: acc 0.4423076923076923, correct 23/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5323, instance_loss: 0.5892, weighted_loss: 0.5494, label: 1, bag_size: 6156
batch 39, loss: 2.0483, instance_loss: 0.9503, weighted_loss: 1.7189, label: 2, bag_size: 705
batch 59, loss: 1.3831, instance_loss: 1.0697, weighted_loss: 1.2891, label: 2, bag_size: 4179
batch 79, loss: 0.6412, instance_loss: 0.5242, weighted_loss: 0.6061, label: 0, bag_size: 2712
batch 99, loss: 0.1187, instance_loss: 0.3277, weighted_loss: 0.1814, label: 0, bag_size: 1710
batch 119, loss: 1.1863, instance_loss: 1.0796, weighted_loss: 1.1543, label: 1, bag_size: 5205
batch 139, loss: 0.8946, instance_loss: 0.7737, weighted_loss: 0.8583, label: 2, bag_size: 4291
batch 159, loss: 0.1984, instance_loss: 0.5518, weighted_loss: 0.3044, label: 0, bag_size: 4783
batch 179, loss: 0.8758, instance_loss: 0.7830, weighted_loss: 0.8479, label: 1, bag_size: 683
batch 199, loss: 0.4781, instance_loss: 0.4822, weighted_loss: 0.4793, label: 2, bag_size: 3026
batch 219, loss: 1.4318, instance_loss: 0.8995, weighted_loss: 1.2721, label: 1, bag_size: 817
batch 239, loss: 0.2588, instance_loss: 0.5177, weighted_loss: 0.3364, label: 2, bag_size: 5017
batch 259, loss: 1.6986, instance_loss: 0.8536, weighted_loss: 1.4451, label: 0, bag_size: 3075
batch 279, loss: 0.4906, instance_loss: 0.5201, weighted_loss: 0.4995, label: 1, bag_size: 2753
batch 299, loss: 0.1672, instance_loss: 0.3831, weighted_loss: 0.2319, label: 2, bag_size: 3210
batch 319, loss: 1.1878, instance_loss: 0.8351, weighted_loss: 1.0820, label: 2, bag_size: 3172
batch 339, loss: 1.5409, instance_loss: 0.7982, weighted_loss: 1.3181, label: 1, bag_size: 817
batch 359, loss: 0.4965, instance_loss: 0.6643, weighted_loss: 0.5468, label: 2, bag_size: 3778
batch 379, loss: 0.4968, instance_loss: 0.4603, weighted_loss: 0.4858, label: 0, bag_size: 4700
batch 399, loss: 0.5977, instance_loss: 0.6364, weighted_loss: 0.6093, label: 1, bag_size: 3322
batch 419, loss: 0.4090, instance_loss: 0.4500, weighted_loss: 0.4213, label: 1, bag_size: 3604
batch 439, loss: 0.5440, instance_loss: 0.4196, weighted_loss: 0.5067, label: 1, bag_size: 1906
batch 459, loss: 0.6402, instance_loss: 0.6380, weighted_loss: 0.6395, label: 0, bag_size: 2428
batch 479, loss: 1.3236, instance_loss: 0.8316, weighted_loss: 1.1760, label: 0, bag_size: 789
batch 499, loss: 0.5810, instance_loss: 0.4238, weighted_loss: 0.5339, label: 0, bag_size: 3915
batch 519, loss: 0.6280, instance_loss: 0.6376, weighted_loss: 0.6309, label: 2, bag_size: 4291
batch 539, loss: 1.1378, instance_loss: 0.8062, weighted_loss: 1.0384, label: 1, bag_size: 3837
batch 559, loss: 2.1111, instance_loss: 0.9152, weighted_loss: 1.7523, label: 0, bag_size: 4572
batch 579, loss: 0.4603, instance_loss: 0.6877, weighted_loss: 0.5285, label: 2, bag_size: 6594
batch 599, loss: 2.5035, instance_loss: 1.5442, weighted_loss: 2.2157, label: 0, bag_size: 1420
batch 619, loss: 0.4009, instance_loss: 0.4831, weighted_loss: 0.4255, label: 2, bag_size: 5914
batch 639, loss: 0.2312, instance_loss: 0.6689, weighted_loss: 0.3625, label: 0, bag_size: 2044
batch 659, loss: 0.2618, instance_loss: 0.4846, weighted_loss: 0.3286, label: 0, bag_size: 6430
batch 679, loss: 0.3188, instance_loss: 0.4063, weighted_loss: 0.3450, label: 1, bag_size: 1410
batch 699, loss: 0.5052, instance_loss: 0.6872, weighted_loss: 0.5598, label: 2, bag_size: 3618
batch 719, loss: 0.4406, instance_loss: 0.4601, weighted_loss: 0.4464, label: 1, bag_size: 2919
batch 739, loss: 1.3160, instance_loss: 0.8680, weighted_loss: 1.1816, label: 1, bag_size: 4784


class 0 clustering acc 0.991275167785235: correct 17724/17880
class 1 clustering acc 0.07483221476510067: correct 446/5960
Epoch: 6, train_loss: 0.7769, train_clustering_loss:  0.6397, train_error: 0.3356
class 0: acc 0.6693877551020408, correct 164/245
class 1: acc 0.5806451612903226, correct 144/248
class 2: acc 0.7420634920634921, correct 187/252

Val Set, val_loss: 0.6632, val_error: 0.2553, auc: 0.8460
class 0 clustering acc 0.9791666666666666: correct 2209/2256
class 1 clustering acc 0.3071808510638298: correct 231/752
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.742211 --> 0.663194).  Saving model ...


batch 19, loss: 0.7372, instance_loss: 0.5762, weighted_loss: 0.6889, label: 0, bag_size: 2850
batch 39, loss: 0.6720, instance_loss: 0.3721, weighted_loss: 0.5820, label: 2, bag_size: 3026
batch 59, loss: 0.2196, instance_loss: 0.3802, weighted_loss: 0.2678, label: 0, bag_size: 6221
batch 79, loss: 0.3081, instance_loss: 0.7162, weighted_loss: 0.4305, label: 1, bag_size: 2731
batch 99, loss: 0.0124, instance_loss: 0.0855, weighted_loss: 0.0344, label: 2, bag_size: 6026
batch 119, loss: 0.0260, instance_loss: 0.0550, weighted_loss: 0.0347, label: 2, bag_size: 3415
batch 139, loss: 0.7117, instance_loss: 0.6468, weighted_loss: 0.6922, label: 2, bag_size: 4132
batch 159, loss: 0.3364, instance_loss: 0.3999, weighted_loss: 0.3555, label: 1, bag_size: 4812
batch 179, loss: 0.6540, instance_loss: 0.6787, weighted_loss: 0.6614, label: 2, bag_size: 3534
batch 199, loss: 0.9529, instance_loss: 0.6641, weighted_loss: 0.8663, label: 0, bag_size: 4378
batch 219, loss: 0.5404, instance_loss: 0.4074, weighted_loss: 0.5005, label: 2, bag_size: 1103
batch 239, loss: 0.1559, instance_loss: 0.5652, weighted_loss: 0.2787, label: 2, bag_size: 4132
batch 259, loss: 0.4682, instance_loss: 0.5007, weighted_loss: 0.4779, label: 0, bag_size: 2897
batch 279, loss: 0.7424, instance_loss: 0.8749, weighted_loss: 0.7821, label: 0, bag_size: 4997
batch 299, loss: 0.1418, instance_loss: 0.2027, weighted_loss: 0.1601, label: 2, bag_size: 6026
batch 319, loss: 0.2671, instance_loss: 0.4841, weighted_loss: 0.3322, label: 2, bag_size: 5924
batch 339, loss: 0.2082, instance_loss: 0.3076, weighted_loss: 0.2380, label: 2, bag_size: 4096
batch 359, loss: 3.3750, instance_loss: 1.4770, weighted_loss: 2.8056, label: 1, bag_size: 2852
batch 379, loss: 0.3996, instance_loss: 0.5803, weighted_loss: 0.4538, label: 0, bag_size: 4935
batch 399, loss: 1.1722, instance_loss: 0.7503, weighted_loss: 1.0456, label: 0, bag_size: 4378
batch 419, loss: 2.6102, instance_loss: 1.1532, weighted_loss: 2.1731, label: 0, bag_size: 603
batch 439, loss: 0.6410, instance_loss: 0.6558, weighted_loss: 0.6454, label: 1, bag_size: 4438
batch 459, loss: 0.2320, instance_loss: 0.5652, weighted_loss: 0.3319, label: 1, bag_size: 6315
batch 479, loss: 0.5958, instance_loss: 0.5786, weighted_loss: 0.5907, label: 1, bag_size: 5412
batch 499, loss: 1.8036, instance_loss: 1.0182, weighted_loss: 1.5680, label: 1, bag_size: 1371
batch 519, loss: 2.7150, instance_loss: 0.7725, weighted_loss: 2.1322, label: 0, bag_size: 12971
batch 539, loss: 0.3529, instance_loss: 0.7386, weighted_loss: 0.4686, label: 2, bag_size: 5072
batch 559, loss: 0.4639, instance_loss: 0.5785, weighted_loss: 0.4983, label: 0, bag_size: 4857
batch 579, loss: 0.0567, instance_loss: 0.0769, weighted_loss: 0.0628, label: 2, bag_size: 6026
batch 599, loss: 0.6061, instance_loss: 0.5360, weighted_loss: 0.5851, label: 1, bag_size: 2919
batch 619, loss: 0.4026, instance_loss: 0.4664, weighted_loss: 0.4217, label: 0, bag_size: 5041
batch 639, loss: 0.0564, instance_loss: 0.4155, weighted_loss: 0.1641, label: 2, bag_size: 3121
batch 659, loss: 0.2490, instance_loss: 0.3248, weighted_loss: 0.2717, label: 0, bag_size: 5632
batch 679, loss: 1.1611, instance_loss: 0.6654, weighted_loss: 1.0124, label: 1, bag_size: 10941
batch 699, loss: 0.1950, instance_loss: 0.8117, weighted_loss: 0.3800, label: 0, bag_size: 3920
batch 719, loss: 0.1993, instance_loss: 0.5052, weighted_loss: 0.2911, label: 0, bag_size: 2257
batch 739, loss: 0.6133, instance_loss: 0.6949, weighted_loss: 0.6377, label: 1, bag_size: 8632


class 0 clustering acc 0.9854586129753915: correct 17620/17880
class 1 clustering acc 0.12063758389261744: correct 719/5960
Epoch: 7, train_loss: 0.7580, train_clustering_loss:  0.6316, train_error: 0.3047
class 0: acc 0.688034188034188, correct 161/234
class 1: acc 0.563265306122449, correct 138/245
class 2: acc 0.8233082706766918, correct 219/266

Val Set, val_loss: 0.8683, val_error: 0.3723, auc: 0.8276
class 0 clustering acc 0.9964539007092199: correct 2248/2256
class 1 clustering acc 0.017287234042553192: correct 13/752
class 0: acc 0.5, correct 26/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5165, instance_loss: 0.6201, weighted_loss: 0.5476, label: 2, bag_size: 22464
batch 39, loss: 0.9005, instance_loss: 0.7080, weighted_loss: 0.8427, label: 0, bag_size: 2712
batch 59, loss: 0.3923, instance_loss: 0.7567, weighted_loss: 0.5016, label: 2, bag_size: 4141
batch 79, loss: 0.5251, instance_loss: 0.5754, weighted_loss: 0.5402, label: 1, bag_size: 2744
batch 99, loss: 0.6542, instance_loss: 0.4928, weighted_loss: 0.6058, label: 0, bag_size: 4018
batch 119, loss: 0.5584, instance_loss: 0.6307, weighted_loss: 0.5801, label: 1, bag_size: 2494
batch 139, loss: 0.1797, instance_loss: 0.5135, weighted_loss: 0.2799, label: 2, bag_size: 4132
batch 159, loss: 0.4826, instance_loss: 0.3806, weighted_loss: 0.4520, label: 2, bag_size: 4096
batch 179, loss: 0.6317, instance_loss: 0.7601, weighted_loss: 0.6702, label: 2, bag_size: 22464
batch 199, loss: 1.0973, instance_loss: 0.6873, weighted_loss: 0.9743, label: 0, bag_size: 4614
batch 219, loss: 1.8274, instance_loss: 0.9708, weighted_loss: 1.5704, label: 2, bag_size: 552
batch 239, loss: 0.5138, instance_loss: 0.4889, weighted_loss: 0.5063, label: 1, bag_size: 582
batch 259, loss: 0.8884, instance_loss: 0.4006, weighted_loss: 0.7421, label: 2, bag_size: 3026
batch 279, loss: 4.4261, instance_loss: 1.8180, weighted_loss: 3.6437, label: 0, bag_size: 2392
batch 299, loss: 1.0908, instance_loss: 0.5649, weighted_loss: 0.9330, label: 1, bag_size: 3644
batch 319, loss: 0.9448, instance_loss: 0.9279, weighted_loss: 0.9397, label: 1, bag_size: 1477
batch 339, loss: 1.0556, instance_loss: 0.6665, weighted_loss: 0.9389, label: 0, bag_size: 3525
batch 359, loss: 1.0722, instance_loss: 0.7454, weighted_loss: 0.9742, label: 1, bag_size: 1860
batch 379, loss: 0.8279, instance_loss: 0.6332, weighted_loss: 0.7695, label: 0, bag_size: 1071
batch 399, loss: 0.4815, instance_loss: 0.7750, weighted_loss: 0.5696, label: 2, bag_size: 2486
batch 419, loss: 0.1905, instance_loss: 0.2679, weighted_loss: 0.2137, label: 2, bag_size: 3397
batch 439, loss: 0.4436, instance_loss: 0.1702, weighted_loss: 0.3616, label: 2, bag_size: 4056
batch 459, loss: 1.8520, instance_loss: 1.2514, weighted_loss: 1.6718, label: 2, bag_size: 4179
batch 479, loss: 0.6626, instance_loss: 0.4756, weighted_loss: 0.6065, label: 0, bag_size: 3886
batch 499, loss: 0.4558, instance_loss: 0.4503, weighted_loss: 0.4541, label: 0, bag_size: 4416
batch 519, loss: 0.5987, instance_loss: 0.6552, weighted_loss: 0.6156, label: 0, bag_size: 4547
batch 539, loss: 0.1850, instance_loss: 0.3125, weighted_loss: 0.2233, label: 0, bag_size: 2607
batch 559, loss: 0.0906, instance_loss: 0.6320, weighted_loss: 0.2530, label: 0, bag_size: 577
batch 579, loss: 0.1889, instance_loss: 0.4826, weighted_loss: 0.2770, label: 0, bag_size: 3871
batch 599, loss: 3.1693, instance_loss: 1.1653, weighted_loss: 2.5681, label: 2, bag_size: 728
batch 619, loss: 0.0660, instance_loss: 0.3902, weighted_loss: 0.1633, label: 0, bag_size: 1006
batch 639, loss: 0.4532, instance_loss: 0.1519, weighted_loss: 0.3628, label: 0, bag_size: 5902
batch 659, loss: 0.1053, instance_loss: 0.4740, weighted_loss: 0.2159, label: 1, bag_size: 2453
batch 679, loss: 0.2213, instance_loss: 0.6771, weighted_loss: 0.3581, label: 2, bag_size: 4132
batch 699, loss: 1.8784, instance_loss: 1.0503, weighted_loss: 1.6300, label: 2, bag_size: 4316
batch 719, loss: 0.3588, instance_loss: 0.3631, weighted_loss: 0.3601, label: 2, bag_size: 4096
batch 739, loss: 0.4005, instance_loss: 0.4555, weighted_loss: 0.4170, label: 2, bag_size: 4096


class 0 clustering acc 0.9866890380313199: correct 17642/17880
class 1 clustering acc 0.12365771812080537: correct 737/5960
Epoch: 8, train_loss: 0.7257, train_clustering_loss:  0.6295, train_error: 0.3114
class 0: acc 0.746031746031746, correct 188/252
class 1: acc 0.5905511811023622, correct 150/254
class 2: acc 0.7322175732217573, correct 175/239

Val Set, val_loss: 0.7506, val_error: 0.3298, auc: 0.8209
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.2473404255319149: correct 186/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4359, instance_loss: 0.5364, weighted_loss: 0.4660, label: 1, bag_size: 5412
batch 39, loss: 0.3447, instance_loss: 0.3032, weighted_loss: 0.3322, label: 0, bag_size: 5038
batch 59, loss: 1.2644, instance_loss: 0.9951, weighted_loss: 1.1836, label: 1, bag_size: 1477
batch 79, loss: 0.1356, instance_loss: 0.4441, weighted_loss: 0.2282, label: 0, bag_size: 3182
batch 99, loss: 0.1017, instance_loss: 0.2373, weighted_loss: 0.1424, label: 0, bag_size: 3103
batch 119, loss: 0.1578, instance_loss: 0.4193, weighted_loss: 0.2363, label: 1, bag_size: 3050
batch 139, loss: 1.6721, instance_loss: 0.6464, weighted_loss: 1.3644, label: 0, bag_size: 4509
batch 159, loss: 1.0714, instance_loss: 0.9915, weighted_loss: 1.0475, label: 0, bag_size: 3191
batch 179, loss: 0.2396, instance_loss: 0.4127, weighted_loss: 0.2915, label: 2, bag_size: 6001
batch 199, loss: 0.4990, instance_loss: 0.4456, weighted_loss: 0.4830, label: 1, bag_size: 2919
batch 219, loss: 1.5780, instance_loss: 0.7940, weighted_loss: 1.3428, label: 0, bag_size: 6630
batch 239, loss: 0.5700, instance_loss: 0.4917, weighted_loss: 0.5466, label: 0, bag_size: 272
batch 259, loss: 0.3297, instance_loss: 0.8638, weighted_loss: 0.4899, label: 2, bag_size: 5072
batch 279, loss: 0.3134, instance_loss: 0.4306, weighted_loss: 0.3485, label: 2, bag_size: 2359
batch 299, loss: 0.1476, instance_loss: 0.4179, weighted_loss: 0.2287, label: 2, bag_size: 4302
batch 319, loss: 0.5017, instance_loss: 0.6814, weighted_loss: 0.5556, label: 0, bag_size: 4531
batch 339, loss: 0.9042, instance_loss: 0.8463, weighted_loss: 0.8868, label: 1, bag_size: 3126
batch 359, loss: 1.7618, instance_loss: 0.9306, weighted_loss: 1.5124, label: 1, bag_size: 667
batch 379, loss: 0.4536, instance_loss: 0.4025, weighted_loss: 0.4383, label: 2, bag_size: 2501
batch 399, loss: 0.2796, instance_loss: 0.4511, weighted_loss: 0.3311, label: 2, bag_size: 4096
batch 419, loss: 0.5473, instance_loss: 0.4613, weighted_loss: 0.5215, label: 0, bag_size: 5226
batch 439, loss: 0.0424, instance_loss: 0.3579, weighted_loss: 0.1371, label: 2, bag_size: 5037
batch 459, loss: 0.1793, instance_loss: 0.3463, weighted_loss: 0.2294, label: 0, bag_size: 2705
batch 479, loss: 0.8045, instance_loss: 0.6155, weighted_loss: 0.7478, label: 0, bag_size: 3639
batch 499, loss: 0.4487, instance_loss: 0.6873, weighted_loss: 0.5203, label: 1, bag_size: 2962
batch 519, loss: 0.6898, instance_loss: 0.4878, weighted_loss: 0.6292, label: 2, bag_size: 2501
batch 539, loss: 0.4276, instance_loss: 0.1786, weighted_loss: 0.3529, label: 2, bag_size: 88
batch 559, loss: 1.5880, instance_loss: 0.7651, weighted_loss: 1.3412, label: 1, bag_size: 5035
batch 579, loss: 0.5359, instance_loss: 0.5600, weighted_loss: 0.5431, label: 1, bag_size: 455
batch 599, loss: 0.6814, instance_loss: 0.6572, weighted_loss: 0.6741, label: 1, bag_size: 4960
batch 619, loss: 0.1132, instance_loss: 0.2179, weighted_loss: 0.1446, label: 0, bag_size: 5003
batch 639, loss: 1.0349, instance_loss: 0.8720, weighted_loss: 0.9860, label: 0, bag_size: 313
batch 659, loss: 0.2848, instance_loss: 0.4070, weighted_loss: 0.3215, label: 2, bag_size: 4043
batch 679, loss: 0.0808, instance_loss: 0.2175, weighted_loss: 0.1218, label: 2, bag_size: 4043
batch 699, loss: 1.5841, instance_loss: 0.9945, weighted_loss: 1.4072, label: 1, bag_size: 6717
batch 719, loss: 0.9917, instance_loss: 0.7752, weighted_loss: 0.9267, label: 0, bag_size: 11663
batch 739, loss: 1.4410, instance_loss: 0.6354, weighted_loss: 1.1993, label: 0, bag_size: 3664


class 0 clustering acc 0.9799776286353468: correct 17522/17880
class 1 clustering acc 0.17919463087248322: correct 1068/5960
Epoch: 9, train_loss: 0.6978, train_clustering_loss:  0.6067, train_error: 0.2926
class 0: acc 0.7341269841269841, correct 185/252
class 1: acc 0.6335877862595419, correct 166/262
class 2: acc 0.7619047619047619, correct 176/231

Val Set, val_loss: 0.7079, val_error: 0.2872, auc: 0.8403
class 0 clustering acc 0.9884751773049646: correct 2230/2256
class 1 clustering acc 0.21010638297872342: correct 158/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2061, instance_loss: 0.7196, weighted_loss: 0.3602, label: 1, bag_size: 5385
batch 39, loss: 3.2972, instance_loss: 1.3834, weighted_loss: 2.7231, label: 0, bag_size: 877
batch 59, loss: 1.5256, instance_loss: 0.8991, weighted_loss: 1.3376, label: 1, bag_size: 4467
batch 79, loss: 0.5068, instance_loss: 0.7958, weighted_loss: 0.5935, label: 2, bag_size: 5072
batch 99, loss: 0.3322, instance_loss: 0.4123, weighted_loss: 0.3562, label: 2, bag_size: 3227
batch 119, loss: 0.1505, instance_loss: 0.3813, weighted_loss: 0.2197, label: 0, bag_size: 4606
batch 139, loss: 0.4614, instance_loss: 0.5272, weighted_loss: 0.4811, label: 0, bag_size: 4351
batch 159, loss: 1.1359, instance_loss: 0.6364, weighted_loss: 0.9860, label: 0, bag_size: 4337
batch 179, loss: 0.4349, instance_loss: 0.5050, weighted_loss: 0.4559, label: 0, bag_size: 3344
batch 199, loss: 0.1040, instance_loss: 0.2110, weighted_loss: 0.1361, label: 0, bag_size: 4606
batch 219, loss: 0.8042, instance_loss: 0.4763, weighted_loss: 0.7058, label: 0, bag_size: 3033
batch 239, loss: 0.1658, instance_loss: 0.5543, weighted_loss: 0.2823, label: 1, bag_size: 6277
batch 259, loss: 0.5609, instance_loss: 0.6097, weighted_loss: 0.5755, label: 0, bag_size: 4071
batch 279, loss: 0.0774, instance_loss: 0.3262, weighted_loss: 0.1520, label: 0, bag_size: 4744
batch 299, loss: 1.8150, instance_loss: 0.8609, weighted_loss: 1.5287, label: 1, bag_size: 4187
batch 319, loss: 0.0568, instance_loss: 0.2443, weighted_loss: 0.1131, label: 2, bag_size: 3285
batch 339, loss: 1.6312, instance_loss: 1.5849, weighted_loss: 1.6173, label: 2, bag_size: 4241
batch 359, loss: 1.5826, instance_loss: 0.9696, weighted_loss: 1.3987, label: 1, bag_size: 8632
batch 379, loss: 0.1372, instance_loss: 0.6903, weighted_loss: 0.3031, label: 2, bag_size: 5011
batch 399, loss: 0.2157, instance_loss: 0.5194, weighted_loss: 0.3068, label: 2, bag_size: 3534
batch 419, loss: 0.1579, instance_loss: 0.3596, weighted_loss: 0.2184, label: 0, bag_size: 3530
batch 439, loss: 0.3181, instance_loss: 0.4343, weighted_loss: 0.3529, label: 2, bag_size: 3678
batch 459, loss: 0.8117, instance_loss: 0.6553, weighted_loss: 0.7648, label: 2, bag_size: 4096
batch 479, loss: 0.4298, instance_loss: 0.3097, weighted_loss: 0.3938, label: 2, bag_size: 88
batch 499, loss: 0.0586, instance_loss: 0.4472, weighted_loss: 0.1752, label: 2, bag_size: 3285
batch 519, loss: 0.6576, instance_loss: 0.6734, weighted_loss: 0.6623, label: 2, bag_size: 3396
batch 539, loss: 0.1688, instance_loss: 0.3831, weighted_loss: 0.2330, label: 2, bag_size: 4978
batch 559, loss: 0.1370, instance_loss: 0.6593, weighted_loss: 0.2937, label: 1, bag_size: 3357
batch 579, loss: 1.0042, instance_loss: 0.8679, weighted_loss: 0.9633, label: 0, bag_size: 4541
batch 599, loss: 0.2001, instance_loss: 0.3398, weighted_loss: 0.2420, label: 0, bag_size: 3525
batch 619, loss: 2.0470, instance_loss: 1.0031, weighted_loss: 1.7338, label: 2, bag_size: 552
batch 639, loss: 0.5554, instance_loss: 0.5322, weighted_loss: 0.5484, label: 0, bag_size: 8611
batch 659, loss: 0.1053, instance_loss: 0.3196, weighted_loss: 0.1696, label: 0, bag_size: 5029
batch 679, loss: 0.2066, instance_loss: 0.3721, weighted_loss: 0.2562, label: 0, bag_size: 4744
batch 699, loss: 1.0470, instance_loss: 0.6972, weighted_loss: 0.9421, label: 1, bag_size: 2747
batch 719, loss: 2.9723, instance_loss: 1.3180, weighted_loss: 2.4760, label: 1, bag_size: 5880
batch 739, loss: 0.1986, instance_loss: 0.4033, weighted_loss: 0.2601, label: 0, bag_size: 3617


class 0 clustering acc 0.9808724832214765: correct 17538/17880
class 1 clustering acc 0.18238255033557046: correct 1087/5960
Epoch: 10, train_loss: 0.6740, train_clustering_loss:  0.6050, train_error: 0.2752
class 0: acc 0.7248908296943232, correct 166/229
class 1: acc 0.6215139442231076, correct 156/251
class 2: acc 0.8226415094339623, correct 218/265

Val Set, val_loss: 0.7090, val_error: 0.3298, auc: 0.8532
class 0 clustering acc 0.9942375886524822: correct 2243/2256
class 1 clustering acc 0.05186170212765957: correct 39/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4398, instance_loss: 0.5689, weighted_loss: 0.4785, label: 1, bag_size: 3367
batch 39, loss: 0.8144, instance_loss: 0.6312, weighted_loss: 0.7595, label: 1, bag_size: 1394
batch 59, loss: 0.2097, instance_loss: 0.5304, weighted_loss: 0.3059, label: 0, bag_size: 5029
batch 79, loss: 0.2022, instance_loss: 0.4283, weighted_loss: 0.2700, label: 2, bag_size: 3678
batch 99, loss: 0.1761, instance_loss: 0.5679, weighted_loss: 0.2937, label: 2, bag_size: 4302
batch 119, loss: 0.6455, instance_loss: 0.5479, weighted_loss: 0.6162, label: 0, bag_size: 1373
batch 139, loss: 1.0974, instance_loss: 1.1017, weighted_loss: 1.0987, label: 2, bag_size: 4241
batch 159, loss: 0.1270, instance_loss: 0.2748, weighted_loss: 0.1714, label: 2, bag_size: 5924
batch 179, loss: 0.4135, instance_loss: 0.6336, weighted_loss: 0.4795, label: 0, bag_size: 2501
batch 199, loss: 0.8628, instance_loss: 0.8951, weighted_loss: 0.8725, label: 2, bag_size: 3746
batch 219, loss: 0.1186, instance_loss: 0.2438, weighted_loss: 0.1562, label: 2, bag_size: 4203
batch 239, loss: 0.3944, instance_loss: 0.5711, weighted_loss: 0.4474, label: 2, bag_size: 5924
batch 259, loss: 0.3457, instance_loss: 0.4977, weighted_loss: 0.3913, label: 1, bag_size: 1221
batch 279, loss: 0.0843, instance_loss: 0.2964, weighted_loss: 0.1479, label: 1, bag_size: 796
batch 299, loss: 0.1320, instance_loss: 0.3450, weighted_loss: 0.1959, label: 0, bag_size: 2479
batch 319, loss: 1.9891, instance_loss: 1.0328, weighted_loss: 1.7022, label: 0, bag_size: 2618
batch 339, loss: 0.3416, instance_loss: 0.5714, weighted_loss: 0.4105, label: 2, bag_size: 5017
batch 359, loss: 0.1419, instance_loss: 0.4949, weighted_loss: 0.2478, label: 1, bag_size: 2453
batch 379, loss: 1.6723, instance_loss: 0.8718, weighted_loss: 1.4322, label: 1, bag_size: 5197
batch 399, loss: 1.6640, instance_loss: 0.9376, weighted_loss: 1.4461, label: 2, bag_size: 4179
batch 419, loss: 0.9443, instance_loss: 0.4399, weighted_loss: 0.7930, label: 2, bag_size: 2031
batch 439, loss: 0.2938, instance_loss: 0.5351, weighted_loss: 0.3662, label: 0, bag_size: 1170
batch 459, loss: 2.2123, instance_loss: 0.5891, weighted_loss: 1.7254, label: 0, bag_size: 19216
batch 479, loss: 0.3363, instance_loss: 0.5229, weighted_loss: 0.3923, label: 1, bag_size: 1027
batch 499, loss: 0.7400, instance_loss: 0.5903, weighted_loss: 0.6951, label: 1, bag_size: 3935
batch 519, loss: 0.3334, instance_loss: 0.5958, weighted_loss: 0.4121, label: 2, bag_size: 4487
batch 539, loss: 2.4313, instance_loss: 1.1627, weighted_loss: 2.0507, label: 0, bag_size: 2217
batch 559, loss: 0.3166, instance_loss: 0.5281, weighted_loss: 0.3800, label: 1, bag_size: 2962
batch 579, loss: 0.5787, instance_loss: 0.9508, weighted_loss: 0.6903, label: 2, bag_size: 5072
batch 599, loss: 1.7259, instance_loss: 0.8545, weighted_loss: 1.4645, label: 1, bag_size: 5072
batch 619, loss: 0.8962, instance_loss: 1.0947, weighted_loss: 0.9557, label: 1, bag_size: 3437
batch 639, loss: 0.4858, instance_loss: 0.5752, weighted_loss: 0.5126, label: 1, bag_size: 2865
batch 659, loss: 2.6067, instance_loss: 1.4210, weighted_loss: 2.2510, label: 0, bag_size: 455
batch 679, loss: 0.2533, instance_loss: 0.3902, weighted_loss: 0.2943, label: 0, bag_size: 3294
batch 699, loss: 0.8528, instance_loss: 0.5258, weighted_loss: 0.7547, label: 1, bag_size: 4069
batch 719, loss: 0.4909, instance_loss: 0.4649, weighted_loss: 0.4831, label: 0, bag_size: 3833
batch 739, loss: 0.6597, instance_loss: 0.4476, weighted_loss: 0.5961, label: 0, bag_size: 2559


class 0 clustering acc 0.9824384787472036: correct 17566/17880
class 1 clustering acc 0.1610738255033557: correct 960/5960
Epoch: 11, train_loss: 0.7119, train_clustering_loss:  0.6202, train_error: 0.3168
class 0: acc 0.7180451127819549, correct 191/266
class 1: acc 0.5983935742971888, correct 149/249
class 2: acc 0.7347826086956522, correct 169/230

Val Set, val_loss: 0.7439, val_error: 0.3191, auc: 0.8462
class 0 clustering acc 0.9720744680851063: correct 2193/2256
class 1 clustering acc 0.3484042553191489: correct 262/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3159, instance_loss: 0.6555, weighted_loss: 0.4178, label: 1, bag_size: 3471
batch 39, loss: 0.1376, instance_loss: 0.2486, weighted_loss: 0.1709, label: 2, bag_size: 4223
batch 59, loss: 0.3576, instance_loss: 0.6407, weighted_loss: 0.4425, label: 1, bag_size: 5118
batch 79, loss: 0.5603, instance_loss: 0.6921, weighted_loss: 0.5999, label: 0, bag_size: 8866
batch 99, loss: 0.4552, instance_loss: 0.4716, weighted_loss: 0.4601, label: 0, bag_size: 4122
batch 119, loss: 0.7359, instance_loss: 0.6286, weighted_loss: 0.7037, label: 1, bag_size: 800
batch 139, loss: 0.3928, instance_loss: 0.5390, weighted_loss: 0.4367, label: 2, bag_size: 4535
batch 159, loss: 0.8226, instance_loss: 1.1098, weighted_loss: 0.9087, label: 2, bag_size: 4910
batch 179, loss: 1.3518, instance_loss: 0.9265, weighted_loss: 1.2242, label: 0, bag_size: 4310
batch 199, loss: 2.3734, instance_loss: 0.8894, weighted_loss: 1.9282, label: 1, bag_size: 1608
batch 219, loss: 1.9285, instance_loss: 1.3850, weighted_loss: 1.7655, label: 2, bag_size: 5743
batch 239, loss: 0.9834, instance_loss: 0.4598, weighted_loss: 0.8263, label: 1, bag_size: 3534
batch 259, loss: 0.3413, instance_loss: 0.6021, weighted_loss: 0.4195, label: 0, bag_size: 3648
batch 279, loss: 0.0731, instance_loss: 0.3233, weighted_loss: 0.1482, label: 1, bag_size: 1410
batch 299, loss: 0.3043, instance_loss: 0.4158, weighted_loss: 0.3378, label: 0, bag_size: 5038
batch 319, loss: 2.4510, instance_loss: 0.9741, weighted_loss: 2.0079, label: 1, bag_size: 5035
batch 339, loss: 0.2575, instance_loss: 0.6662, weighted_loss: 0.3801, label: 2, bag_size: 4372
batch 359, loss: 0.3073, instance_loss: 0.4216, weighted_loss: 0.3416, label: 1, bag_size: 2945
batch 379, loss: 0.0220, instance_loss: 0.8369, weighted_loss: 0.2665, label: 1, bag_size: 5084
batch 399, loss: 1.4043, instance_loss: 0.8443, weighted_loss: 1.2363, label: 1, bag_size: 1860
batch 419, loss: 0.2366, instance_loss: 0.3461, weighted_loss: 0.2694, label: 0, bag_size: 4700
batch 439, loss: 0.2175, instance_loss: 0.5049, weighted_loss: 0.3037, label: 1, bag_size: 3493
batch 459, loss: 0.3612, instance_loss: 0.6759, weighted_loss: 0.4556, label: 0, bag_size: 5519
batch 479, loss: 0.0076, instance_loss: 0.3260, weighted_loss: 0.1031, label: 1, bag_size: 2809
batch 499, loss: 2.1596, instance_loss: 0.9806, weighted_loss: 1.8059, label: 1, bag_size: 2852
batch 519, loss: 0.7422, instance_loss: 0.5688, weighted_loss: 0.6902, label: 0, bag_size: 1543
batch 539, loss: 0.2759, instance_loss: 0.5448, weighted_loss: 0.3565, label: 2, bag_size: 3497
batch 559, loss: 1.4483, instance_loss: 0.7164, weighted_loss: 1.2287, label: 0, bag_size: 2618
batch 579, loss: 0.9191, instance_loss: 0.6516, weighted_loss: 0.8388, label: 1, bag_size: 4612
batch 599, loss: 0.1533, instance_loss: 0.5321, weighted_loss: 0.2669, label: 2, bag_size: 4141
batch 619, loss: 0.2533, instance_loss: 0.4702, weighted_loss: 0.3184, label: 2, bag_size: 6594
batch 639, loss: 0.2012, instance_loss: 0.4989, weighted_loss: 0.2905, label: 1, bag_size: 425
batch 659, loss: 1.4045, instance_loss: 0.7730, weighted_loss: 1.2150, label: 1, bag_size: 5167
batch 679, loss: 0.0497, instance_loss: 0.4038, weighted_loss: 0.1559, label: 0, bag_size: 577
batch 699, loss: 0.0539, instance_loss: 0.5683, weighted_loss: 0.2082, label: 1, bag_size: 683
batch 719, loss: 1.2063, instance_loss: 0.7688, weighted_loss: 1.0750, label: 2, bag_size: 552
batch 739, loss: 1.2975, instance_loss: 0.6737, weighted_loss: 1.1104, label: 0, bag_size: 3033


class 0 clustering acc 0.9790268456375839: correct 17505/17880
class 1 clustering acc 0.20838926174496644: correct 1242/5960
Epoch: 12, train_loss: 0.7013, train_clustering_loss:  0.6085, train_error: 0.2940
class 0: acc 0.7041666666666667, correct 169/240
class 1: acc 0.64453125, correct 165/256
class 2: acc 0.7710843373493976, correct 192/249

Val Set, val_loss: 0.8014, val_error: 0.3511, auc: 0.8357
class 0 clustering acc 0.9920212765957447: correct 2238/2256
class 1 clustering acc 0.06382978723404255: correct 48/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 2.5483, instance_loss: 1.0068, weighted_loss: 2.0859, label: 0, bag_size: 3711
batch 39, loss: 0.4136, instance_loss: 0.4121, weighted_loss: 0.4131, label: 0, bag_size: 3936
batch 59, loss: 2.1689, instance_loss: 1.5338, weighted_loss: 1.9784, label: 2, bag_size: 4241
batch 79, loss: 0.6524, instance_loss: 0.5046, weighted_loss: 0.6080, label: 0, bag_size: 4584
batch 99, loss: 0.3886, instance_loss: 0.2963, weighted_loss: 0.3609, label: 0, bag_size: 6252
batch 119, loss: 0.1307, instance_loss: 0.2332, weighted_loss: 0.1614, label: 2, bag_size: 2481
batch 139, loss: 1.0610, instance_loss: 0.7639, weighted_loss: 0.9719, label: 1, bag_size: 2319
batch 159, loss: 0.5696, instance_loss: 0.7204, weighted_loss: 0.6149, label: 1, bag_size: 4534
batch 179, loss: 0.2168, instance_loss: 0.3424, weighted_loss: 0.2545, label: 0, bag_size: 2601
batch 199, loss: 0.4649, instance_loss: 0.3375, weighted_loss: 0.4267, label: 0, bag_size: 5459
batch 219, loss: 0.1103, instance_loss: 0.4145, weighted_loss: 0.2016, label: 1, bag_size: 596
batch 239, loss: 0.0925, instance_loss: 1.2499, weighted_loss: 0.4397, label: 1, bag_size: 5084
batch 259, loss: 0.3409, instance_loss: 0.2448, weighted_loss: 0.3120, label: 2, bag_size: 705
batch 279, loss: 0.2819, instance_loss: 0.6168, weighted_loss: 0.3824, label: 2, bag_size: 3618
batch 299, loss: 0.3325, instance_loss: 0.4446, weighted_loss: 0.3661, label: 2, bag_size: 3396
batch 319, loss: 0.8806, instance_loss: 0.7929, weighted_loss: 0.8543, label: 1, bag_size: 4940
batch 339, loss: 0.0454, instance_loss: 0.5924, weighted_loss: 0.2095, label: 1, bag_size: 259
batch 359, loss: 0.6982, instance_loss: 0.4975, weighted_loss: 0.6380, label: 1, bag_size: 3322
batch 379, loss: 0.1573, instance_loss: 0.2382, weighted_loss: 0.1816, label: 2, bag_size: 1094
batch 399, loss: 0.0288, instance_loss: 0.1812, weighted_loss: 0.0745, label: 0, bag_size: 5337
batch 419, loss: 1.7895, instance_loss: 0.8974, weighted_loss: 1.5219, label: 1, bag_size: 5197
batch 439, loss: 0.0537, instance_loss: 0.2746, weighted_loss: 0.1200, label: 1, bag_size: 2493
batch 459, loss: 1.9874, instance_loss: 0.7787, weighted_loss: 1.6248, label: 2, bag_size: 728
batch 479, loss: 0.0547, instance_loss: 0.5632, weighted_loss: 0.2072, label: 2, bag_size: 4497
batch 499, loss: 0.9703, instance_loss: 0.8018, weighted_loss: 0.9198, label: 2, bag_size: 4487
batch 519, loss: 0.0013, instance_loss: 0.4817, weighted_loss: 0.1454, label: 1, bag_size: 3043
batch 539, loss: 0.1397, instance_loss: 0.1823, weighted_loss: 0.1525, label: 2, bag_size: 2481
batch 559, loss: 0.4597, instance_loss: 0.2343, weighted_loss: 0.3921, label: 2, bag_size: 4056
batch 579, loss: 0.1115, instance_loss: 0.2838, weighted_loss: 0.1632, label: 1, bag_size: 3761
batch 599, loss: 0.6417, instance_loss: 0.8473, weighted_loss: 0.7034, label: 0, bag_size: 3164
batch 619, loss: 0.0828, instance_loss: 0.0829, weighted_loss: 0.0828, label: 2, bag_size: 4088
batch 639, loss: 1.3432, instance_loss: 0.8095, weighted_loss: 1.1831, label: 0, bag_size: 726
batch 659, loss: 0.7172, instance_loss: 0.6988, weighted_loss: 0.7117, label: 1, bag_size: 3357
batch 679, loss: 0.1833, instance_loss: 0.2524, weighted_loss: 0.2041, label: 2, bag_size: 2481
batch 699, loss: 1.1249, instance_loss: 0.8394, weighted_loss: 1.0392, label: 1, bag_size: 574
batch 719, loss: 0.5590, instance_loss: 0.5724, weighted_loss: 0.5630, label: 2, bag_size: 5406
batch 739, loss: 0.3408, instance_loss: 0.4792, weighted_loss: 0.3824, label: 2, bag_size: 4162


class 0 clustering acc 0.978523489932886: correct 17496/17880
class 1 clustering acc 0.21409395973154363: correct 1276/5960
Epoch: 13, train_loss: 0.6927, train_clustering_loss:  0.6047, train_error: 0.3020
class 0: acc 0.7435897435897436, correct 174/234
class 1: acc 0.5836734693877551, correct 143/245
class 2: acc 0.7631578947368421, correct 203/266

Val Set, val_loss: 0.8864, val_error: 0.3191, auc: 0.8320
class 0 clustering acc 0.9791666666666666: correct 2209/2256
class 1 clustering acc 0.08643617021276596: correct 65/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.4594, instance_loss: 1.2076, weighted_loss: 2.0839, label: 0, bag_size: 3750
batch 39, loss: 0.3217, instance_loss: 0.3987, weighted_loss: 0.3448, label: 1, bag_size: 712
batch 59, loss: 0.2391, instance_loss: 0.2003, weighted_loss: 0.2274, label: 2, bag_size: 2905
batch 79, loss: 0.1968, instance_loss: 0.5476, weighted_loss: 0.3020, label: 2, bag_size: 4555
batch 99, loss: 0.8608, instance_loss: 0.5867, weighted_loss: 0.7786, label: 2, bag_size: 4096
batch 119, loss: 1.2000, instance_loss: 0.9052, weighted_loss: 1.1115, label: 0, bag_size: 1695
batch 139, loss: 0.0488, instance_loss: 0.1942, weighted_loss: 0.0924, label: 2, bag_size: 3121
batch 159, loss: 0.0059, instance_loss: 0.2127, weighted_loss: 0.0680, label: 1, bag_size: 4027
batch 179, loss: 1.0467, instance_loss: 0.5783, weighted_loss: 0.9062, label: 0, bag_size: 3397
batch 199, loss: 0.2564, instance_loss: 0.3284, weighted_loss: 0.2780, label: 0, bag_size: 4165
batch 219, loss: 0.5811, instance_loss: 0.6502, weighted_loss: 0.6018, label: 0, bag_size: 2607
batch 239, loss: 2.0132, instance_loss: 1.2363, weighted_loss: 1.7801, label: 2, bag_size: 1513
batch 259, loss: 1.2124, instance_loss: 0.7568, weighted_loss: 1.0757, label: 1, bag_size: 2319
batch 279, loss: 0.1104, instance_loss: 0.2525, weighted_loss: 0.1530, label: 0, bag_size: 4196
batch 299, loss: 1.9292, instance_loss: 1.0409, weighted_loss: 1.6627, label: 0, bag_size: 1753
batch 319, loss: 0.3456, instance_loss: 0.5394, weighted_loss: 0.4038, label: 1, bag_size: 14449
batch 339, loss: 0.1742, instance_loss: 0.4065, weighted_loss: 0.2439, label: 2, bag_size: 5011
batch 359, loss: 0.7366, instance_loss: 0.8180, weighted_loss: 0.7610, label: 0, bag_size: 3341
batch 379, loss: 0.0582, instance_loss: 0.2544, weighted_loss: 0.1171, label: 2, bag_size: 4856
batch 399, loss: 0.2285, instance_loss: 0.3020, weighted_loss: 0.2506, label: 2, bag_size: 5924
batch 419, loss: 0.0487, instance_loss: 0.4266, weighted_loss: 0.1621, label: 0, bag_size: 4458
batch 439, loss: 0.3303, instance_loss: 0.4207, weighted_loss: 0.3574, label: 1, bag_size: 3619
batch 459, loss: 1.1125, instance_loss: 0.9112, weighted_loss: 1.0521, label: 1, bag_size: 782
batch 479, loss: 1.5832, instance_loss: 1.0142, weighted_loss: 1.4125, label: 2, bag_size: 3475
batch 499, loss: 1.7545, instance_loss: 0.9181, weighted_loss: 1.5036, label: 1, bag_size: 2747
batch 519, loss: 0.1146, instance_loss: 0.2600, weighted_loss: 0.1582, label: 2, bag_size: 657
batch 539, loss: 0.1385, instance_loss: 0.4371, weighted_loss: 0.2281, label: 0, bag_size: 5029
batch 559, loss: 1.7564, instance_loss: 0.9352, weighted_loss: 1.5100, label: 0, bag_size: 2217
batch 579, loss: 0.7921, instance_loss: 0.4381, weighted_loss: 0.6859, label: 2, bag_size: 2031
batch 599, loss: 1.2876, instance_loss: 0.9400, weighted_loss: 1.1834, label: 2, bag_size: 4316
batch 619, loss: 0.1025, instance_loss: 0.3174, weighted_loss: 0.1669, label: 2, bag_size: 5924
batch 639, loss: 0.2275, instance_loss: 0.3619, weighted_loss: 0.2678, label: 1, bag_size: 4812
batch 659, loss: 0.0596, instance_loss: 0.4685, weighted_loss: 0.1822, label: 2, bag_size: 3810
batch 679, loss: 1.3331, instance_loss: 0.8342, weighted_loss: 1.1834, label: 1, bag_size: 5873
batch 699, loss: 0.2478, instance_loss: 0.3491, weighted_loss: 0.2782, label: 0, bag_size: 5950
batch 719, loss: 0.5640, instance_loss: 0.6706, weighted_loss: 0.5960, label: 1, bag_size: 3471
batch 739, loss: 0.4803, instance_loss: 0.5369, weighted_loss: 0.4973, label: 0, bag_size: 4479


class 0 clustering acc 0.97751677852349: correct 17478/17880
class 1 clustering acc 0.19093959731543625: correct 1138/5960
Epoch: 14, train_loss: 0.7212, train_clustering_loss:  0.6233, train_error: 0.3141
class 0: acc 0.695067264573991, correct 155/223
class 1: acc 0.5961538461538461, correct 155/260
class 2: acc 0.767175572519084, correct 201/262

Val Set, val_loss: 0.7944, val_error: 0.3617, auc: 0.8448
class 0 clustering acc 0.9875886524822695: correct 2228/2256
class 1 clustering acc 0.20212765957446807: correct 152/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0653, instance_loss: 0.1705, weighted_loss: 0.0968, label: 2, bag_size: 2254
batch 39, loss: 1.1606, instance_loss: 0.8850, weighted_loss: 1.0779, label: 1, bag_size: 2927
batch 59, loss: 1.5189, instance_loss: 0.7461, weighted_loss: 1.2871, label: 1, bag_size: 5197
batch 79, loss: 0.5321, instance_loss: 0.6235, weighted_loss: 0.5595, label: 1, bag_size: 1066
batch 99, loss: 0.1478, instance_loss: 0.5165, weighted_loss: 0.2584, label: 2, bag_size: 5037
batch 119, loss: 0.0179, instance_loss: 0.1032, weighted_loss: 0.0435, label: 1, bag_size: 2009
batch 139, loss: 0.0737, instance_loss: 0.2781, weighted_loss: 0.1350, label: 0, bag_size: 855
batch 159, loss: 1.5884, instance_loss: 0.5649, weighted_loss: 1.2813, label: 2, bag_size: 3026
batch 179, loss: 1.1088, instance_loss: 0.6493, weighted_loss: 0.9709, label: 1, bag_size: 3644
batch 199, loss: 0.0695, instance_loss: 0.2402, weighted_loss: 0.1207, label: 2, bag_size: 2209
batch 219, loss: 1.1939, instance_loss: 0.6650, weighted_loss: 1.0353, label: 0, bag_size: 4717
batch 239, loss: 0.7882, instance_loss: 0.6720, weighted_loss: 0.7534, label: 2, bag_size: 5406
batch 259, loss: 0.0244, instance_loss: 0.1097, weighted_loss: 0.0500, label: 2, bag_size: 3497
batch 279, loss: 0.8990, instance_loss: 0.7175, weighted_loss: 0.8445, label: 1, bag_size: 4940
batch 299, loss: 0.8966, instance_loss: 0.7615, weighted_loss: 0.8561, label: 0, bag_size: 1543
batch 319, loss: 0.3094, instance_loss: 0.4548, weighted_loss: 0.3530, label: 1, bag_size: 1807
batch 339, loss: 0.3276, instance_loss: 0.4958, weighted_loss: 0.3780, label: 2, bag_size: 4978
batch 359, loss: 0.3270, instance_loss: 0.5861, weighted_loss: 0.4047, label: 1, bag_size: 3983
batch 379, loss: 1.8901, instance_loss: 1.2644, weighted_loss: 1.7024, label: 2, bag_size: 3299
batch 399, loss: 0.2031, instance_loss: 0.3703, weighted_loss: 0.2533, label: 2, bag_size: 597
batch 419, loss: 0.3405, instance_loss: 0.3634, weighted_loss: 0.3474, label: 2, bag_size: 2049
batch 439, loss: 0.1403, instance_loss: 0.6222, weighted_loss: 0.2849, label: 2, bag_size: 4141
batch 459, loss: 0.1182, instance_loss: 0.2407, weighted_loss: 0.1550, label: 0, bag_size: 5108
batch 479, loss: 0.9072, instance_loss: 0.6956, weighted_loss: 0.8437, label: 1, bag_size: 1712
batch 499, loss: 0.6222, instance_loss: 0.5201, weighted_loss: 0.5916, label: 0, bag_size: 6971
batch 519, loss: 1.2437, instance_loss: 0.5700, weighted_loss: 1.0416, label: 1, bag_size: 5167
batch 539, loss: 0.2826, instance_loss: 0.8965, weighted_loss: 0.4667, label: 0, bag_size: 3038
batch 559, loss: 0.2731, instance_loss: 0.3814, weighted_loss: 0.3056, label: 1, bag_size: 2945
batch 579, loss: 0.1443, instance_loss: 0.3965, weighted_loss: 0.2199, label: 0, bag_size: 5519
batch 599, loss: 0.1099, instance_loss: 0.3779, weighted_loss: 0.1903, label: 2, bag_size: 5914
batch 619, loss: 0.6190, instance_loss: 0.7760, weighted_loss: 0.6661, label: 2, bag_size: 2486
batch 639, loss: 0.8091, instance_loss: 0.8554, weighted_loss: 0.8230, label: 1, bag_size: 3596
batch 659, loss: 1.1315, instance_loss: 0.6199, weighted_loss: 0.9780, label: 1, bag_size: 7109
batch 679, loss: 0.5784, instance_loss: 1.0712, weighted_loss: 0.7262, label: 0, bag_size: 4351
batch 699, loss: 1.3788, instance_loss: 0.9827, weighted_loss: 1.2600, label: 1, bag_size: 1122
batch 719, loss: 0.8451, instance_loss: 0.7878, weighted_loss: 0.8279, label: 1, bag_size: 1860
batch 739, loss: 0.1039, instance_loss: 0.1938, weighted_loss: 0.1309, label: 2, bag_size: 3415


class 0 clustering acc 0.9817673378076063: correct 17554/17880
class 1 clustering acc 0.20268456375838925: correct 1208/5960
Epoch: 15, train_loss: 0.6879, train_clustering_loss:  0.6057, train_error: 0.3101
class 0: acc 0.7114624505928854, correct 180/253
class 1: acc 0.6317829457364341, correct 163/258
class 2: acc 0.7307692307692307, correct 171/234

Val Set, val_loss: 0.6848, val_error: 0.3085, auc: 0.8517
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.28324468085106386: correct 213/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.8372, instance_loss: 0.7756, weighted_loss: 0.8187, label: 0, bag_size: 3648
batch 39, loss: 0.1173, instance_loss: 0.5154, weighted_loss: 0.2367, label: 1, bag_size: 2796
batch 59, loss: 0.7960, instance_loss: 0.5824, weighted_loss: 0.7319, label: 2, bag_size: 3618
batch 79, loss: 2.2582, instance_loss: 0.7663, weighted_loss: 1.8107, label: 0, bag_size: 5867
batch 99, loss: 0.4877, instance_loss: 0.6230, weighted_loss: 0.5283, label: 2, bag_size: 5914
batch 119, loss: 2.9118, instance_loss: 1.2567, weighted_loss: 2.4153, label: 1, bag_size: 3837
batch 139, loss: 0.2476, instance_loss: 0.4719, weighted_loss: 0.3149, label: 2, bag_size: 614
batch 159, loss: 0.0147, instance_loss: 0.3054, weighted_loss: 0.1019, label: 1, bag_size: 2809
batch 179, loss: 0.2095, instance_loss: 0.5842, weighted_loss: 0.3219, label: 1, bag_size: 3333
batch 199, loss: 0.3513, instance_loss: 0.5584, weighted_loss: 0.4135, label: 2, bag_size: 5914
batch 219, loss: 2.0902, instance_loss: 0.9795, weighted_loss: 1.7570, label: 2, bag_size: 552
batch 239, loss: 0.9328, instance_loss: 1.1770, weighted_loss: 1.0061, label: 1, bag_size: 3437
batch 259, loss: 0.4129, instance_loss: 0.5800, weighted_loss: 0.4630, label: 1, bag_size: 2998
batch 279, loss: 0.9629, instance_loss: 0.7084, weighted_loss: 0.8865, label: 0, bag_size: 4614
batch 299, loss: 0.0394, instance_loss: 0.2729, weighted_loss: 0.1095, label: 0, bag_size: 829
batch 319, loss: 0.2279, instance_loss: 0.3626, weighted_loss: 0.2683, label: 2, bag_size: 5914
batch 339, loss: 0.2048, instance_loss: 0.3109, weighted_loss: 0.2366, label: 2, bag_size: 3094
batch 359, loss: 2.7012, instance_loss: 0.9770, weighted_loss: 2.1840, label: 0, bag_size: 4572
batch 379, loss: 1.2689, instance_loss: 0.7177, weighted_loss: 1.1036, label: 0, bag_size: 1695
batch 399, loss: 1.3439, instance_loss: 0.6452, weighted_loss: 1.1343, label: 1, bag_size: 4373
batch 419, loss: 0.3053, instance_loss: 0.3764, weighted_loss: 0.3267, label: 0, bag_size: 5519
batch 439, loss: 0.0124, instance_loss: 0.4321, weighted_loss: 0.1383, label: 2, bag_size: 4497
batch 459, loss: 1.3690, instance_loss: 0.6748, weighted_loss: 1.1608, label: 0, bag_size: 4032
batch 479, loss: 0.2713, instance_loss: 0.2575, weighted_loss: 0.2671, label: 0, bag_size: 4201
batch 499, loss: 2.4981, instance_loss: 1.2186, weighted_loss: 2.1142, label: 2, bag_size: 5307
batch 519, loss: 0.6810, instance_loss: 0.5140, weighted_loss: 0.6309, label: 0, bag_size: 4460
batch 539, loss: 0.1338, instance_loss: 0.3323, weighted_loss: 0.1933, label: 0, bag_size: 4606
batch 559, loss: 0.0042, instance_loss: 0.3963, weighted_loss: 0.1218, label: 1, bag_size: 6277
batch 579, loss: 1.1005, instance_loss: 0.7302, weighted_loss: 0.9894, label: 1, bag_size: 2751
batch 599, loss: 0.1517, instance_loss: 0.1806, weighted_loss: 0.1604, label: 2, bag_size: 2501
batch 619, loss: 1.0737, instance_loss: 0.9823, weighted_loss: 1.0463, label: 0, bag_size: 4351
batch 639, loss: 0.3062, instance_loss: 0.4809, weighted_loss: 0.3586, label: 1, bag_size: 3367
batch 659, loss: 0.1908, instance_loss: 0.3639, weighted_loss: 0.2428, label: 0, bag_size: 2479
batch 679, loss: 0.6628, instance_loss: 0.9016, weighted_loss: 0.7345, label: 2, bag_size: 4571
batch 699, loss: 0.7949, instance_loss: 1.1332, weighted_loss: 0.8964, label: 2, bag_size: 5743
batch 719, loss: 0.8246, instance_loss: 0.9158, weighted_loss: 0.8519, label: 2, bag_size: 361
batch 739, loss: 0.2823, instance_loss: 0.4846, weighted_loss: 0.3430, label: 0, bag_size: 4734


class 0 clustering acc 0.9753914988814317: correct 17440/17880
class 1 clustering acc 0.2625838926174497: correct 1565/5960
Epoch: 16, train_loss: 0.6640, train_clustering_loss:  0.5908, train_error: 0.2859
class 0: acc 0.7547169811320755, correct 200/265
class 1: acc 0.594017094017094, correct 139/234
class 2: acc 0.7845528455284553, correct 193/246

Val Set, val_loss: 0.9019, val_error: 0.3723, auc: 0.8160
class 0 clustering acc 0.9862588652482269: correct 2225/2256
class 1 clustering acc 0.1276595744680851: correct 96/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.4, correct 12/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.4491, instance_loss: 2.9206, weighted_loss: 1.8906, label: 2, bag_size: 4203
batch 39, loss: 0.8911, instance_loss: 0.7658, weighted_loss: 0.8535, label: 1, bag_size: 1607
batch 59, loss: 0.7150, instance_loss: 0.8708, weighted_loss: 0.7617, label: 2, bag_size: 5472
batch 79, loss: 0.2785, instance_loss: 0.6964, weighted_loss: 0.4039, label: 1, bag_size: 8482
batch 99, loss: 1.4953, instance_loss: 1.1039, weighted_loss: 1.3779, label: 1, bag_size: 5873
batch 119, loss: 0.1293, instance_loss: 0.4938, weighted_loss: 0.2387, label: 0, bag_size: 3245
batch 139, loss: 1.2533, instance_loss: 0.9360, weighted_loss: 1.1581, label: 2, bag_size: 1513
batch 159, loss: 0.4976, instance_loss: 0.6846, weighted_loss: 0.5537, label: 1, bag_size: 4119
batch 179, loss: 1.9003, instance_loss: 1.0133, weighted_loss: 1.6342, label: 0, bag_size: 2195
batch 199, loss: 0.1227, instance_loss: 0.4422, weighted_loss: 0.2186, label: 1, bag_size: 596
batch 219, loss: 1.3983, instance_loss: 0.7761, weighted_loss: 1.2117, label: 2, bag_size: 552
batch 239, loss: 0.0397, instance_loss: 0.5679, weighted_loss: 0.1982, label: 1, bag_size: 3337
batch 259, loss: 0.3087, instance_loss: 0.4489, weighted_loss: 0.3507, label: 0, bag_size: 5915
batch 279, loss: 0.5691, instance_loss: 0.4774, weighted_loss: 0.5416, label: 0, bag_size: 1762
batch 299, loss: 0.5113, instance_loss: 0.3881, weighted_loss: 0.4744, label: 2, bag_size: 597
batch 319, loss: 0.2354, instance_loss: 0.3483, weighted_loss: 0.2693, label: 2, bag_size: 2359
batch 339, loss: 0.4159, instance_loss: 0.3699, weighted_loss: 0.4021, label: 0, bag_size: 4584
batch 359, loss: 0.9684, instance_loss: 0.8224, weighted_loss: 0.9246, label: 0, bag_size: 1373
batch 379, loss: 0.1915, instance_loss: 0.3328, weighted_loss: 0.2339, label: 0, bag_size: 4857
batch 399, loss: 0.0214, instance_loss: 0.4567, weighted_loss: 0.1520, label: 0, bag_size: 3319
batch 419, loss: 1.4679, instance_loss: 1.2274, weighted_loss: 1.3957, label: 2, bag_size: 2813
batch 439, loss: 0.8235, instance_loss: 0.6670, weighted_loss: 0.7765, label: 0, bag_size: 3841
batch 459, loss: 0.2323, instance_loss: 0.3657, weighted_loss: 0.2723, label: 0, bag_size: 5823
batch 479, loss: 0.6415, instance_loss: 0.8005, weighted_loss: 0.6892, label: 1, bag_size: 1027
batch 499, loss: 0.4213, instance_loss: 0.5693, weighted_loss: 0.4657, label: 2, bag_size: 3778
batch 519, loss: 0.7698, instance_loss: 0.6444, weighted_loss: 0.7322, label: 2, bag_size: 4291
batch 539, loss: 0.0749, instance_loss: 0.2141, weighted_loss: 0.1166, label: 2, bag_size: 4302
batch 559, loss: 0.3867, instance_loss: 0.5212, weighted_loss: 0.4270, label: 1, bag_size: 1029
batch 579, loss: 0.0237, instance_loss: 0.1345, weighted_loss: 0.0569, label: 0, bag_size: 873
batch 599, loss: 0.0986, instance_loss: 0.2549, weighted_loss: 0.1455, label: 0, bag_size: 2487
batch 619, loss: 0.0864, instance_loss: 0.2187, weighted_loss: 0.1261, label: 0, bag_size: 6863
batch 639, loss: 1.7962, instance_loss: 0.7974, weighted_loss: 1.4966, label: 1, bag_size: 5072
batch 659, loss: 0.0673, instance_loss: 0.3156, weighted_loss: 0.1418, label: 1, bag_size: 712
batch 679, loss: 0.0444, instance_loss: 0.4842, weighted_loss: 0.1763, label: 1, bag_size: 6513
batch 699, loss: 0.7366, instance_loss: 0.5285, weighted_loss: 0.6742, label: 1, bag_size: 302
batch 719, loss: 0.0465, instance_loss: 0.1723, weighted_loss: 0.0842, label: 1, bag_size: 7135
batch 739, loss: 0.0236, instance_loss: 0.7910, weighted_loss: 0.2538, label: 1, bag_size: 3995


class 0 clustering acc 0.9741051454138703: correct 17417/17880
class 1 clustering acc 0.2773489932885906: correct 1653/5960
Epoch: 17, train_loss: 0.6323, train_clustering_loss:  0.5923, train_error: 0.2752
class 0: acc 0.7755905511811023, correct 197/254
class 1: acc 0.6118143459915611, correct 145/237
class 2: acc 0.7795275590551181, correct 198/254

Val Set, val_loss: 0.8754, val_error: 0.3298, auc: 0.8195
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.17420212765957446: correct 131/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1899, instance_loss: 0.7411, weighted_loss: 0.3553, label: 0, bag_size: 4744
batch 39, loss: 0.1306, instance_loss: 0.3146, weighted_loss: 0.1858, label: 1, bag_size: 3493
batch 59, loss: 0.0660, instance_loss: 0.1902, weighted_loss: 0.1032, label: 2, bag_size: 2481
batch 79, loss: 0.0075, instance_loss: 0.3237, weighted_loss: 0.1024, label: 2, bag_size: 4497
batch 99, loss: 0.0921, instance_loss: 0.4844, weighted_loss: 0.2098, label: 2, bag_size: 3618
batch 119, loss: 0.2270, instance_loss: 0.5204, weighted_loss: 0.3150, label: 0, bag_size: 3339
batch 139, loss: 1.1970, instance_loss: 0.6938, weighted_loss: 1.0460, label: 1, bag_size: 1327
batch 159, loss: 0.8583, instance_loss: 0.8267, weighted_loss: 0.8488, label: 2, bag_size: 361
batch 179, loss: 0.4171, instance_loss: 0.3469, weighted_loss: 0.3960, label: 2, bag_size: 2501
batch 199, loss: 1.4206, instance_loss: 1.0557, weighted_loss: 1.3111, label: 2, bag_size: 2486
batch 219, loss: 0.1137, instance_loss: 0.2327, weighted_loss: 0.1494, label: 0, bag_size: 4994
batch 239, loss: 0.7933, instance_loss: 1.2502, weighted_loss: 0.9304, label: 1, bag_size: 2229
batch 259, loss: 1.9265, instance_loss: 0.9665, weighted_loss: 1.6385, label: 1, bag_size: 1097
batch 279, loss: 3.3353, instance_loss: 1.7476, weighted_loss: 2.8590, label: 2, bag_size: 4241
batch 299, loss: 2.2980, instance_loss: 1.1029, weighted_loss: 1.9395, label: 2, bag_size: 5307
batch 319, loss: 0.3500, instance_loss: 0.4621, weighted_loss: 0.3836, label: 0, bag_size: 3113
batch 339, loss: 0.0872, instance_loss: 0.2001, weighted_loss: 0.1211, label: 2, bag_size: 6026
batch 359, loss: 0.0924, instance_loss: 0.4440, weighted_loss: 0.1978, label: 1, bag_size: 874
batch 379, loss: 0.7232, instance_loss: 0.5293, weighted_loss: 0.6650, label: 0, bag_size: 2392
batch 399, loss: 0.0750, instance_loss: 0.8477, weighted_loss: 0.3068, label: 1, bag_size: 1604
batch 419, loss: 0.2194, instance_loss: 0.4156, weighted_loss: 0.2783, label: 0, bag_size: 5236
batch 439, loss: 0.0191, instance_loss: 0.1315, weighted_loss: 0.0528, label: 2, bag_size: 2483
batch 459, loss: 0.0231, instance_loss: 0.1917, weighted_loss: 0.0737, label: 0, bag_size: 471
batch 479, loss: 0.2813, instance_loss: 0.3189, weighted_loss: 0.2926, label: 0, bag_size: 2853
batch 499, loss: 1.5334, instance_loss: 0.6651, weighted_loss: 1.2729, label: 2, bag_size: 2031
batch 519, loss: 0.2501, instance_loss: 0.3916, weighted_loss: 0.2925, label: 0, bag_size: 622
batch 539, loss: 0.1491, instance_loss: 0.2579, weighted_loss: 0.1818, label: 2, bag_size: 2481
batch 559, loss: 0.3782, instance_loss: 0.6621, weighted_loss: 0.4634, label: 0, bag_size: 3525
batch 579, loss: 0.5510, instance_loss: 0.6475, weighted_loss: 0.5800, label: 1, bag_size: 8632
batch 599, loss: 0.7809, instance_loss: 0.7243, weighted_loss: 0.7639, label: 0, bag_size: 609
batch 619, loss: 0.1662, instance_loss: 0.4563, weighted_loss: 0.2533, label: 2, bag_size: 4132
batch 639, loss: 0.1992, instance_loss: 0.7682, weighted_loss: 0.3699, label: 1, bag_size: 6315
batch 659, loss: 1.2893, instance_loss: 1.2039, weighted_loss: 1.2636, label: 0, bag_size: 889
batch 679, loss: 0.3041, instance_loss: 0.4867, weighted_loss: 0.3589, label: 1, bag_size: 2865
batch 699, loss: 0.3318, instance_loss: 0.5599, weighted_loss: 0.4003, label: 0, bag_size: 5340
batch 719, loss: 2.7011, instance_loss: 0.9317, weighted_loss: 2.1703, label: 0, bag_size: 272
batch 739, loss: 2.1135, instance_loss: 1.4566, weighted_loss: 1.9165, label: 0, bag_size: 20234


class 0 clustering acc 0.9737136465324385: correct 17410/17880
class 1 clustering acc 0.2669463087248322: correct 1591/5960
Epoch: 18, train_loss: 0.6406, train_clustering_loss:  0.5894, train_error: 0.2617
class 0: acc 0.7584905660377359, correct 201/265
class 1: acc 0.6666666666666666, correct 168/252
class 2: acc 0.793859649122807, correct 181/228

Val Set, val_loss: 0.7683, val_error: 0.3298, auc: 0.8427
class 0 clustering acc 0.9778368794326241: correct 2206/2256
class 1 clustering acc 0.2327127659574468: correct 175/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4063, instance_loss: 0.4527, weighted_loss: 0.4202, label: 1, bag_size: 3050
batch 39, loss: 0.4552, instance_loss: 0.5574, weighted_loss: 0.4859, label: 2, bag_size: 3746
batch 59, loss: 0.2541, instance_loss: 0.6645, weighted_loss: 0.3772, label: 1, bag_size: 6315
batch 79, loss: 0.4447, instance_loss: 1.1995, weighted_loss: 0.6712, label: 0, bag_size: 1910
batch 99, loss: 0.9215, instance_loss: 0.8795, weighted_loss: 0.9089, label: 1, bag_size: 3437
batch 119, loss: 1.2943, instance_loss: 0.8981, weighted_loss: 1.1755, label: 0, bag_size: 3075
batch 139, loss: 1.1511, instance_loss: 0.6053, weighted_loss: 0.9874, label: 2, bag_size: 1543
batch 159, loss: 0.1762, instance_loss: 0.6751, weighted_loss: 0.3258, label: 2, bag_size: 3299
batch 179, loss: 0.0538, instance_loss: 0.1783, weighted_loss: 0.0911, label: 2, bag_size: 5914
batch 199, loss: 0.1245, instance_loss: 0.3286, weighted_loss: 0.1857, label: 0, bag_size: 2607
batch 219, loss: 0.3245, instance_loss: 0.4898, weighted_loss: 0.3741, label: 0, bag_size: 609
batch 239, loss: 0.5962, instance_loss: 0.7951, weighted_loss: 0.6559, label: 2, bag_size: 5017
batch 259, loss: 0.4114, instance_loss: 0.4434, weighted_loss: 0.4210, label: 0, bag_size: 3617
batch 279, loss: 0.5848, instance_loss: 0.5116, weighted_loss: 0.5629, label: 1, bag_size: 3823
batch 299, loss: 0.0375, instance_loss: 0.5218, weighted_loss: 0.1828, label: 1, bag_size: 5385
batch 319, loss: 1.4011, instance_loss: 0.6236, weighted_loss: 1.1678, label: 1, bag_size: 3823
batch 339, loss: 0.0148, instance_loss: 0.2352, weighted_loss: 0.0810, label: 0, bag_size: 4855
batch 359, loss: 0.6795, instance_loss: 0.4562, weighted_loss: 0.6125, label: 0, bag_size: 2392
batch 379, loss: 2.7478, instance_loss: 1.1609, weighted_loss: 2.2717, label: 0, bag_size: 1774
batch 399, loss: 0.0179, instance_loss: 0.3262, weighted_loss: 0.1104, label: 0, bag_size: 4147
batch 419, loss: 0.0831, instance_loss: 0.3281, weighted_loss: 0.1566, label: 1, bag_size: 3367
batch 439, loss: 0.1669, instance_loss: 0.3252, weighted_loss: 0.2144, label: 2, bag_size: 5637
batch 459, loss: 0.1035, instance_loss: 0.3613, weighted_loss: 0.1808, label: 2, bag_size: 2209
batch 479, loss: 0.0374, instance_loss: 0.1245, weighted_loss: 0.0635, label: 2, bag_size: 6148
batch 499, loss: 1.7673, instance_loss: 0.9141, weighted_loss: 1.5113, label: 1, bag_size: 5197
batch 519, loss: 0.0408, instance_loss: 0.3042, weighted_loss: 0.1198, label: 2, bag_size: 3497
batch 539, loss: 0.0830, instance_loss: 0.6610, weighted_loss: 0.2564, label: 1, bag_size: 2796
batch 559, loss: 0.3192, instance_loss: 0.4571, weighted_loss: 0.3606, label: 2, bag_size: 3227
batch 579, loss: 0.0871, instance_loss: 0.2930, weighted_loss: 0.1489, label: 2, bag_size: 3396
batch 599, loss: 0.6674, instance_loss: 0.4301, weighted_loss: 0.5962, label: 0, bag_size: 13770
batch 619, loss: 0.1072, instance_loss: 0.2524, weighted_loss: 0.1508, label: 2, bag_size: 4569
batch 639, loss: 0.5640, instance_loss: 0.7283, weighted_loss: 0.6133, label: 2, bag_size: 22464
batch 659, loss: 0.0039, instance_loss: 0.1630, weighted_loss: 0.0516, label: 1, bag_size: 2009
batch 679, loss: 0.0583, instance_loss: 0.3739, weighted_loss: 0.1530, label: 1, bag_size: 3493
batch 699, loss: 0.0213, instance_loss: 0.6919, weighted_loss: 0.2225, label: 1, bag_size: 3533
batch 719, loss: 0.0934, instance_loss: 0.3378, weighted_loss: 0.1668, label: 0, bag_size: 4994
batch 739, loss: 0.3195, instance_loss: 0.5268, weighted_loss: 0.3817, label: 0, bag_size: 1883


class 0 clustering acc 0.9725950782997763: correct 17390/17880
class 1 clustering acc 0.30838926174496645: correct 1838/5960
Epoch: 19, train_loss: 0.5641, train_clustering_loss:  0.5678, train_error: 0.2443
class 0: acc 0.7991967871485943, correct 199/249
class 1: acc 0.6446280991735537, correct 156/242
class 2: acc 0.8188976377952756, correct 208/254

Val Set, val_loss: 0.7416, val_error: 0.3298, auc: 0.8651
class 0 clustering acc 0.9862588652482269: correct 2225/2256
class 1 clustering acc 0.10638297872340426: correct 80/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6554, instance_loss: 0.7702, weighted_loss: 0.6898, label: 1, bag_size: 7176
batch 39, loss: 1.2316, instance_loss: 0.8990, weighted_loss: 1.1318, label: 1, bag_size: 7176
batch 59, loss: 0.3856, instance_loss: 0.5515, weighted_loss: 0.4354, label: 0, bag_size: 4935
batch 79, loss: 1.2606, instance_loss: 0.7230, weighted_loss: 1.0993, label: 0, bag_size: 1753
batch 99, loss: 0.1513, instance_loss: 0.3722, weighted_loss: 0.2176, label: 0, bag_size: 2153
batch 119, loss: 0.0716, instance_loss: 0.2757, weighted_loss: 0.1328, label: 0, bag_size: 5519
batch 139, loss: 2.2417, instance_loss: 0.9928, weighted_loss: 1.8670, label: 0, bag_size: 3156
batch 159, loss: 0.7325, instance_loss: 0.6639, weighted_loss: 0.7119, label: 1, bag_size: 1250
batch 179, loss: 0.0429, instance_loss: 0.4862, weighted_loss: 0.1759, label: 1, bag_size: 4192
batch 199, loss: 0.1784, instance_loss: 0.4630, weighted_loss: 0.2638, label: 0, bag_size: 2897
batch 219, loss: 0.7602, instance_loss: 0.8905, weighted_loss: 0.7993, label: 0, bag_size: 2232
batch 239, loss: 0.2425, instance_loss: 0.5062, weighted_loss: 0.3216, label: 0, bag_size: 4994
batch 259, loss: 2.7094, instance_loss: 0.9794, weighted_loss: 2.1904, label: 1, bag_size: 1558
batch 279, loss: 0.1573, instance_loss: 0.4110, weighted_loss: 0.2334, label: 1, bag_size: 3156
batch 299, loss: 0.4073, instance_loss: 0.5463, weighted_loss: 0.4490, label: 2, bag_size: 3534
batch 319, loss: 0.6582, instance_loss: 0.4662, weighted_loss: 0.6006, label: 0, bag_size: 3070
batch 339, loss: 0.0630, instance_loss: 0.1911, weighted_loss: 0.1015, label: 2, bag_size: 657
batch 359, loss: 0.2045, instance_loss: 0.4859, weighted_loss: 0.2889, label: 2, bag_size: 2209
batch 379, loss: 0.6691, instance_loss: 1.0182, weighted_loss: 0.7738, label: 2, bag_size: 728
batch 399, loss: 1.3153, instance_loss: 0.9509, weighted_loss: 1.2060, label: 1, bag_size: 2614
batch 419, loss: 0.0760, instance_loss: 0.2565, weighted_loss: 0.1301, label: 2, bag_size: 2254
batch 439, loss: 0.0260, instance_loss: 0.0906, weighted_loss: 0.0454, label: 2, bag_size: 4856
batch 459, loss: 0.2113, instance_loss: 0.3809, weighted_loss: 0.2622, label: 0, bag_size: 7595
batch 479, loss: 0.5346, instance_loss: 0.8903, weighted_loss: 0.6413, label: 0, bag_size: 2195
batch 499, loss: 1.0079, instance_loss: 0.8231, weighted_loss: 0.9525, label: 1, bag_size: 3746
batch 519, loss: 0.3788, instance_loss: 0.6643, weighted_loss: 0.4644, label: 2, bag_size: 22464
batch 539, loss: 0.0502, instance_loss: 0.0925, weighted_loss: 0.0629, label: 2, bag_size: 2997
batch 559, loss: 0.0144, instance_loss: 0.1079, weighted_loss: 0.0424, label: 0, bag_size: 3103
batch 579, loss: 1.2386, instance_loss: 0.7801, weighted_loss: 1.1010, label: 0, bag_size: 5526
batch 599, loss: 0.5108, instance_loss: 0.7802, weighted_loss: 0.5916, label: 1, bag_size: 6689
batch 619, loss: 0.4893, instance_loss: 0.8709, weighted_loss: 0.6038, label: 2, bag_size: 5743
batch 639, loss: 0.0604, instance_loss: 0.4803, weighted_loss: 0.1863, label: 1, bag_size: 3398
batch 659, loss: 0.7677, instance_loss: 0.5396, weighted_loss: 0.6992, label: 1, bag_size: 3823
batch 679, loss: 1.0345, instance_loss: 0.6465, weighted_loss: 0.9181, label: 1, bag_size: 4612
batch 699, loss: 0.0014, instance_loss: 0.3158, weighted_loss: 0.0957, label: 0, bag_size: 5053
batch 719, loss: 0.2440, instance_loss: 0.2529, weighted_loss: 0.2467, label: 2, bag_size: 2905
batch 739, loss: 0.2560, instance_loss: 0.5375, weighted_loss: 0.3404, label: 2, bag_size: 3227


class 0 clustering acc 0.9744407158836689: correct 17423/17880
class 1 clustering acc 0.30453020134228187: correct 1815/5960
Epoch: 20, train_loss: 0.6187, train_clustering_loss:  0.5673, train_error: 0.2523
class 0: acc 0.7420814479638009, correct 164/221
class 1: acc 0.6853932584269663, correct 183/267
class 2: acc 0.8171206225680934, correct 210/257

Val Set, val_loss: 0.8770, val_error: 0.3723, auc: 0.8321
class 0 clustering acc 0.987145390070922: correct 2227/2256
class 1 clustering acc 0.11702127659574468: correct 88/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 3.2259, instance_loss: 1.4673, weighted_loss: 2.6983, label: 1, bag_size: 12936
batch 39, loss: 0.1230, instance_loss: 0.2758, weighted_loss: 0.1688, label: 2, bag_size: 4203
batch 59, loss: 0.0727, instance_loss: 0.2189, weighted_loss: 0.1165, label: 2, bag_size: 6273
batch 79, loss: 0.1473, instance_loss: 0.5071, weighted_loss: 0.2553, label: 0, bag_size: 4606
batch 99, loss: 1.5170, instance_loss: 1.5961, weighted_loss: 1.5408, label: 0, bag_size: 2231
batch 119, loss: 1.0822, instance_loss: 0.7605, weighted_loss: 0.9857, label: 1, bag_size: 2751
batch 139, loss: 0.2668, instance_loss: 0.5877, weighted_loss: 0.3631, label: 2, bag_size: 3618
batch 159, loss: 2.2489, instance_loss: 0.9102, weighted_loss: 1.8473, label: 0, bag_size: 3402
batch 179, loss: 1.3180, instance_loss: 1.0233, weighted_loss: 1.2296, label: 2, bag_size: 4342
batch 199, loss: 0.1732, instance_loss: 0.3988, weighted_loss: 0.2409, label: 2, bag_size: 5637
batch 219, loss: 0.1871, instance_loss: 0.4822, weighted_loss: 0.2756, label: 2, bag_size: 3746
batch 239, loss: 0.8290, instance_loss: 0.3769, weighted_loss: 0.6934, label: 0, bag_size: 1744
batch 259, loss: 0.2458, instance_loss: 0.4679, weighted_loss: 0.3124, label: 0, bag_size: 4700
batch 279, loss: 0.1656, instance_loss: 0.3982, weighted_loss: 0.2354, label: 0, bag_size: 4337
batch 299, loss: 0.1202, instance_loss: 0.3179, weighted_loss: 0.1795, label: 1, bag_size: 1807
batch 319, loss: 1.5319, instance_loss: 0.9111, weighted_loss: 1.3457, label: 0, bag_size: 1755
batch 339, loss: 0.2607, instance_loss: 0.7752, weighted_loss: 0.4151, label: 1, bag_size: 2905
batch 359, loss: 0.1814, instance_loss: 0.4711, weighted_loss: 0.2683, label: 0, bag_size: 5570
batch 379, loss: 0.2692, instance_loss: 1.1537, weighted_loss: 0.5346, label: 1, bag_size: 8482
batch 399, loss: 0.7099, instance_loss: 0.7711, weighted_loss: 0.7282, label: 0, bag_size: 4725
batch 419, loss: 0.1497, instance_loss: 0.1232, weighted_loss: 0.1417, label: 2, bag_size: 88
batch 439, loss: 1.0113, instance_loss: 0.5848, weighted_loss: 0.8834, label: 1, bag_size: 2870
batch 459, loss: 0.6473, instance_loss: 0.5681, weighted_loss: 0.6235, label: 0, bag_size: 4122
batch 479, loss: 0.2246, instance_loss: 0.4210, weighted_loss: 0.2835, label: 0, bag_size: 4332
batch 499, loss: 0.3203, instance_loss: 0.6718, weighted_loss: 0.4258, label: 0, bag_size: 5519
batch 519, loss: 0.8573, instance_loss: 0.5360, weighted_loss: 0.7609, label: 2, bag_size: 1050
batch 539, loss: 0.0522, instance_loss: 0.3128, weighted_loss: 0.1304, label: 2, bag_size: 3810
batch 559, loss: 0.6007, instance_loss: 0.3619, weighted_loss: 0.5291, label: 2, bag_size: 3534
batch 579, loss: 3.1256, instance_loss: 1.2010, weighted_loss: 2.5482, label: 2, bag_size: 5307
batch 599, loss: 0.4234, instance_loss: 0.5019, weighted_loss: 0.4470, label: 0, bag_size: 4894
batch 619, loss: 0.1227, instance_loss: 0.5892, weighted_loss: 0.2627, label: 2, bag_size: 4372
batch 639, loss: 0.3692, instance_loss: 0.3881, weighted_loss: 0.3748, label: 1, bag_size: 3534
batch 659, loss: 0.4373, instance_loss: 0.5121, weighted_loss: 0.4597, label: 0, bag_size: 3033
batch 679, loss: 0.2902, instance_loss: 0.6046, weighted_loss: 0.3845, label: 2, bag_size: 22464
batch 699, loss: 0.0397, instance_loss: 0.1343, weighted_loss: 0.0681, label: 0, bag_size: 5899
batch 719, loss: 1.1682, instance_loss: 2.0203, weighted_loss: 1.4238, label: 1, bag_size: 3533
batch 739, loss: 0.0062, instance_loss: 0.1433, weighted_loss: 0.0473, label: 1, bag_size: 314


class 0 clustering acc 0.9703020134228187: correct 17349/17880
class 1 clustering acc 0.31291946308724833: correct 1865/5960
Epoch: 21, train_loss: 0.5830, train_clustering_loss:  0.5823, train_error: 0.2336
class 0: acc 0.816793893129771, correct 214/262
class 1: acc 0.62882096069869, correct 144/229
class 2: acc 0.8385826771653543, correct 213/254

Val Set, val_loss: 0.8174, val_error: 0.3298, auc: 0.8332
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.33111702127659576: correct 249/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2076, instance_loss: 0.3515, weighted_loss: 0.2507, label: 2, bag_size: 2359
batch 39, loss: 0.3237, instance_loss: 0.1771, weighted_loss: 0.2797, label: 2, bag_size: 4056
batch 59, loss: 0.4013, instance_loss: 0.5737, weighted_loss: 0.4530, label: 2, bag_size: 3810
batch 79, loss: 0.0676, instance_loss: 0.2988, weighted_loss: 0.1370, label: 0, bag_size: 4570
batch 99, loss: 1.9121, instance_loss: 1.0129, weighted_loss: 1.6423, label: 1, bag_size: 1307
batch 119, loss: 5.6105, instance_loss: 1.8846, weighted_loss: 4.4927, label: 0, bag_size: 4605
batch 139, loss: 0.3260, instance_loss: 1.4293, weighted_loss: 0.6570, label: 0, bag_size: 1601
batch 159, loss: 0.6540, instance_loss: 0.4724, weighted_loss: 0.5995, label: 0, bag_size: 3571
batch 179, loss: 0.0916, instance_loss: 0.2161, weighted_loss: 0.1289, label: 0, bag_size: 5260
batch 199, loss: 0.3963, instance_loss: 0.3707, weighted_loss: 0.3886, label: 2, bag_size: 3172
batch 219, loss: 0.1482, instance_loss: 0.3131, weighted_loss: 0.1977, label: 0, bag_size: 5871
batch 239, loss: 0.2081, instance_loss: 0.3436, weighted_loss: 0.2488, label: 2, bag_size: 1050
batch 259, loss: 0.2538, instance_loss: 0.6603, weighted_loss: 0.3758, label: 0, bag_size: 3752
batch 279, loss: 1.0975, instance_loss: 0.7368, weighted_loss: 0.9893, label: 1, bag_size: 5276
batch 299, loss: 1.2011, instance_loss: 0.7679, weighted_loss: 1.0711, label: 2, bag_size: 5637
batch 319, loss: 0.9616, instance_loss: 0.6431, weighted_loss: 0.8660, label: 0, bag_size: 4725
batch 339, loss: 0.8565, instance_loss: 1.0280, weighted_loss: 0.9080, label: 0, bag_size: 1352
batch 359, loss: 1.6528, instance_loss: 0.9694, weighted_loss: 1.4478, label: 0, bag_size: 14791
batch 379, loss: 0.0093, instance_loss: 0.2959, weighted_loss: 0.0953, label: 0, bag_size: 1825
batch 399, loss: 0.0433, instance_loss: 0.2584, weighted_loss: 0.1078, label: 0, bag_size: 4227
batch 419, loss: 0.1389, instance_loss: 0.3381, weighted_loss: 0.1987, label: 0, bag_size: 2601
batch 439, loss: 0.2043, instance_loss: 0.6348, weighted_loss: 0.3334, label: 2, bag_size: 4535
batch 459, loss: 0.0332, instance_loss: 0.1059, weighted_loss: 0.0550, label: 2, bag_size: 3415
batch 479, loss: 0.6719, instance_loss: 0.7985, weighted_loss: 0.7099, label: 0, bag_size: 6285
batch 499, loss: 0.3309, instance_loss: 0.7612, weighted_loss: 0.4599, label: 1, bag_size: 2731
batch 519, loss: 0.0844, instance_loss: 0.1908, weighted_loss: 0.1164, label: 2, bag_size: 6001
batch 539, loss: 0.1866, instance_loss: 0.4608, weighted_loss: 0.2688, label: 0, bag_size: 6285
batch 559, loss: 0.7764, instance_loss: 0.5318, weighted_loss: 0.7030, label: 2, bag_size: 1050
batch 579, loss: 0.2355, instance_loss: 0.4450, weighted_loss: 0.2983, label: 2, bag_size: 3746
batch 599, loss: 0.4625, instance_loss: 0.5557, weighted_loss: 0.4905, label: 0, bag_size: 4416
batch 619, loss: 0.1373, instance_loss: 0.4754, weighted_loss: 0.2388, label: 1, bag_size: 1029
batch 639, loss: 0.3543, instance_loss: 0.5125, weighted_loss: 0.4018, label: 1, bag_size: 2870
batch 659, loss: 0.1126, instance_loss: 0.4115, weighted_loss: 0.2023, label: 1, bag_size: 3761
batch 679, loss: 0.0144, instance_loss: 0.1338, weighted_loss: 0.0502, label: 0, bag_size: 5500
batch 699, loss: 0.0053, instance_loss: 0.5873, weighted_loss: 0.1799, label: 0, bag_size: 4403
batch 719, loss: 0.1537, instance_loss: 0.3009, weighted_loss: 0.1978, label: 0, bag_size: 5992
batch 739, loss: 0.5253, instance_loss: 0.8132, weighted_loss: 0.6117, label: 2, bag_size: 5072


class 0 clustering acc 0.9759507829977628: correct 17450/17880
class 1 clustering acc 0.2961409395973154: correct 1765/5960
Epoch: 22, train_loss: 0.6070, train_clustering_loss:  0.5762, train_error: 0.2430
class 0: acc 0.7751004016064257, correct 193/249
class 1: acc 0.6694560669456067, correct 160/239
class 2: acc 0.8210116731517509, correct 211/257

Val Set, val_loss: 0.7105, val_error: 0.3191, auc: 0.8622
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.2127659574468085: correct 160/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2258, instance_loss: 0.2820, weighted_loss: 0.2427, label: 2, bag_size: 1103
batch 39, loss: 0.1488, instance_loss: 0.3791, weighted_loss: 0.2179, label: 0, bag_size: 5039
batch 59, loss: 0.1496, instance_loss: 0.4672, weighted_loss: 0.2449, label: 0, bag_size: 6445
batch 79, loss: 0.0885, instance_loss: 0.1267, weighted_loss: 0.0999, label: 2, bag_size: 3285
batch 99, loss: 0.1119, instance_loss: 0.3956, weighted_loss: 0.1970, label: 1, bag_size: 210
batch 119, loss: 0.2498, instance_loss: 0.6408, weighted_loss: 0.3671, label: 2, bag_size: 5472
batch 139, loss: 0.9305, instance_loss: 0.8503, weighted_loss: 0.9065, label: 0, bag_size: 2189
batch 159, loss: 0.5067, instance_loss: 0.6766, weighted_loss: 0.5577, label: 1, bag_size: 5340
batch 179, loss: 0.1235, instance_loss: 0.4063, weighted_loss: 0.2084, label: 0, bag_size: 4344
batch 199, loss: 0.1589, instance_loss: 0.4329, weighted_loss: 0.2411, label: 0, bag_size: 4914
batch 219, loss: 1.9954, instance_loss: 0.9332, weighted_loss: 1.6768, label: 1, bag_size: 5035
batch 239, loss: 0.3258, instance_loss: 0.3760, weighted_loss: 0.3409, label: 2, bag_size: 2049
batch 259, loss: 0.8344, instance_loss: 0.6238, weighted_loss: 0.7712, label: 0, bag_size: 4460
batch 279, loss: 0.6970, instance_loss: 0.5265, weighted_loss: 0.6459, label: 0, bag_size: 2428
batch 299, loss: 0.1841, instance_loss: 0.2209, weighted_loss: 0.1951, label: 2, bag_size: 2997
batch 319, loss: 0.8693, instance_loss: 0.9238, weighted_loss: 0.8856, label: 1, bag_size: 2743
batch 339, loss: 0.4366, instance_loss: 0.3175, weighted_loss: 0.4009, label: 0, bag_size: 5656
batch 359, loss: 0.4151, instance_loss: 0.6034, weighted_loss: 0.4716, label: 1, bag_size: 1906
batch 379, loss: 0.3105, instance_loss: 0.5200, weighted_loss: 0.3733, label: 2, bag_size: 3778
batch 399, loss: 0.8566, instance_loss: 0.7207, weighted_loss: 0.8158, label: 1, bag_size: 3422
batch 419, loss: 0.0209, instance_loss: 0.4249, weighted_loss: 0.1421, label: 1, bag_size: 3333
batch 439, loss: 0.6339, instance_loss: 0.5538, weighted_loss: 0.6099, label: 1, bag_size: 4612
batch 459, loss: 0.4663, instance_loss: 0.3820, weighted_loss: 0.4410, label: 0, bag_size: 3532
batch 479, loss: 0.3957, instance_loss: 0.9261, weighted_loss: 0.5548, label: 2, bag_size: 361
batch 499, loss: 0.0026, instance_loss: 0.5195, weighted_loss: 0.1576, label: 1, bag_size: 7279
batch 519, loss: 0.4166, instance_loss: 0.6110, weighted_loss: 0.4749, label: 1, bag_size: 800
batch 539, loss: 1.4861, instance_loss: 1.1801, weighted_loss: 1.3943, label: 1, bag_size: 3424
batch 559, loss: 1.1194, instance_loss: 0.8244, weighted_loss: 1.0309, label: 0, bag_size: 1782
batch 579, loss: 0.4399, instance_loss: 0.4421, weighted_loss: 0.4405, label: 2, bag_size: 597
batch 599, loss: 0.1476, instance_loss: 0.3040, weighted_loss: 0.1946, label: 2, bag_size: 3094
batch 619, loss: 1.2155, instance_loss: 0.5658, weighted_loss: 1.0206, label: 2, bag_size: 1543
batch 639, loss: 0.0997, instance_loss: 0.3159, weighted_loss: 0.1646, label: 0, bag_size: 4914
batch 659, loss: 0.3779, instance_loss: 0.3220, weighted_loss: 0.3611, label: 0, bag_size: 4251
batch 679, loss: 1.9748, instance_loss: 0.5166, weighted_loss: 1.5373, label: 0, bag_size: 19216
batch 699, loss: 0.1050, instance_loss: 0.4257, weighted_loss: 0.2012, label: 1, bag_size: 1807
batch 719, loss: 0.1766, instance_loss: 0.3800, weighted_loss: 0.2376, label: 0, bag_size: 1545
batch 739, loss: 0.8806, instance_loss: 0.7178, weighted_loss: 0.8317, label: 2, bag_size: 614


class 0 clustering acc 0.9737695749440716: correct 17411/17880
class 1 clustering acc 0.28875838926174496: correct 1721/5960
Epoch: 23, train_loss: 0.6041, train_clustering_loss:  0.5852, train_error: 0.2591
class 0: acc 0.7538461538461538, correct 196/260
class 1: acc 0.6553191489361702, correct 154/235
class 2: acc 0.808, correct 202/250

Val Set, val_loss: 0.8856, val_error: 0.3298, auc: 0.8355
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.32845744680851063: correct 247/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0124, instance_loss: 0.2102, weighted_loss: 0.0718, label: 1, bag_size: 3156
batch 39, loss: 0.6304, instance_loss: 0.3525, weighted_loss: 0.5471, label: 0, bag_size: 4544
batch 59, loss: 0.0053, instance_loss: 0.1971, weighted_loss: 0.0628, label: 0, bag_size: 3182
batch 79, loss: 0.0536, instance_loss: 0.2627, weighted_loss: 0.1163, label: 0, bag_size: 4644
batch 99, loss: 0.1265, instance_loss: 0.2754, weighted_loss: 0.1711, label: 0, bag_size: 6430
batch 119, loss: 0.9454, instance_loss: 0.8696, weighted_loss: 0.9227, label: 2, bag_size: 3299
batch 139, loss: 0.0432, instance_loss: 0.1842, weighted_loss: 0.0855, label: 0, bag_size: 4092
batch 159, loss: 0.1228, instance_loss: 0.1317, weighted_loss: 0.1254, label: 2, bag_size: 2905
batch 179, loss: 0.0013, instance_loss: 0.2064, weighted_loss: 0.0628, label: 1, bag_size: 3043
batch 199, loss: 1.5021, instance_loss: 0.8781, weighted_loss: 1.3149, label: 1, bag_size: 2614
batch 219, loss: 0.0211, instance_loss: 0.1725, weighted_loss: 0.0665, label: 1, bag_size: 460
batch 239, loss: 0.3310, instance_loss: 0.5126, weighted_loss: 0.3855, label: 0, bag_size: 3188
batch 259, loss: 0.4058, instance_loss: 0.6729, weighted_loss: 0.4860, label: 2, bag_size: 4487
batch 279, loss: 0.9544, instance_loss: 0.7006, weighted_loss: 0.8783, label: 2, bag_size: 5637
batch 299, loss: 0.3963, instance_loss: 0.4913, weighted_loss: 0.4248, label: 1, bag_size: 3885
batch 319, loss: 0.1711, instance_loss: 0.5941, weighted_loss: 0.2980, label: 1, bag_size: 2731
batch 339, loss: 0.4983, instance_loss: 1.0251, weighted_loss: 0.6563, label: 1, bag_size: 20666
batch 359, loss: 0.3555, instance_loss: 0.8747, weighted_loss: 0.5113, label: 1, bag_size: 20666
batch 379, loss: 0.3133, instance_loss: 0.5573, weighted_loss: 0.3865, label: 2, bag_size: 4162
batch 399, loss: 0.7506, instance_loss: 0.5447, weighted_loss: 0.6889, label: 1, bag_size: 2319
batch 419, loss: 0.6751, instance_loss: 0.7179, weighted_loss: 0.6879, label: 1, bag_size: 3460
batch 439, loss: 1.5591, instance_loss: 0.5938, weighted_loss: 1.2695, label: 0, bag_size: 3155
batch 459, loss: 1.4074, instance_loss: 0.9137, weighted_loss: 1.2593, label: 2, bag_size: 4179
batch 479, loss: 0.0110, instance_loss: 0.2013, weighted_loss: 0.0681, label: 1, bag_size: 2009
batch 499, loss: 4.0349, instance_loss: 1.0707, weighted_loss: 3.1456, label: 0, bag_size: 3830
batch 519, loss: 0.0574, instance_loss: 0.4561, weighted_loss: 0.1770, label: 1, bag_size: 3338
batch 539, loss: 0.3243, instance_loss: 0.4042, weighted_loss: 0.3482, label: 1, bag_size: 862
batch 559, loss: 1.3078, instance_loss: 0.4891, weighted_loss: 1.0622, label: 1, bag_size: 4192
batch 579, loss: 0.0727, instance_loss: 0.2971, weighted_loss: 0.1400, label: 0, bag_size: 4229
batch 599, loss: 0.1194, instance_loss: 0.3132, weighted_loss: 0.1775, label: 0, bag_size: 6863
batch 619, loss: 0.0512, instance_loss: 0.2088, weighted_loss: 0.0985, label: 0, bag_size: 2019
batch 639, loss: 2.0744, instance_loss: 1.1210, weighted_loss: 1.7884, label: 2, bag_size: 3475
batch 659, loss: 0.2514, instance_loss: 0.3152, weighted_loss: 0.2705, label: 0, bag_size: 6440
batch 679, loss: 0.2377, instance_loss: 0.5929, weighted_loss: 0.3443, label: 1, bag_size: 700
batch 699, loss: 1.6057, instance_loss: 1.0510, weighted_loss: 1.4393, label: 2, bag_size: 3274
batch 719, loss: 0.0569, instance_loss: 0.3673, weighted_loss: 0.1500, label: 0, bag_size: 4606
batch 739, loss: 0.1796, instance_loss: 0.4058, weighted_loss: 0.2475, label: 1, bag_size: 2731


class 0 clustering acc 0.970917225950783: correct 17360/17880
class 1 clustering acc 0.31778523489932886: correct 1894/5960
Epoch: 24, train_loss: 0.6033, train_clustering_loss:  0.5656, train_error: 0.2483
class 0: acc 0.7911646586345381, correct 197/249
class 1: acc 0.6641221374045801, correct 174/262
class 2: acc 0.8076923076923077, correct 189/234

Val Set, val_loss: 0.7295, val_error: 0.2553, auc: 0.8530
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.2579787234042553: correct 194/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1222, instance_loss: 0.3060, weighted_loss: 0.1773, label: 0, bag_size: 622
batch 39, loss: 0.1868, instance_loss: 0.3046, weighted_loss: 0.2221, label: 2, bag_size: 2359
batch 59, loss: 1.8825, instance_loss: 0.7289, weighted_loss: 1.5364, label: 0, bag_size: 3387
batch 79, loss: 0.7220, instance_loss: 0.4427, weighted_loss: 0.6382, label: 0, bag_size: 4614
batch 99, loss: 0.0784, instance_loss: 0.2909, weighted_loss: 0.1422, label: 2, bag_size: 5011
batch 119, loss: 0.7242, instance_loss: 0.5341, weighted_loss: 0.6672, label: 1, bag_size: 2156
batch 139, loss: 4.1501, instance_loss: 1.1383, weighted_loss: 3.2466, label: 0, bag_size: 3830
batch 159, loss: 0.6189, instance_loss: 0.6094, weighted_loss: 0.6161, label: 0, bag_size: 609
batch 179, loss: 0.0008, instance_loss: 0.3607, weighted_loss: 0.1088, label: 1, bag_size: 5364
batch 199, loss: 0.0460, instance_loss: 0.3651, weighted_loss: 0.1417, label: 1, bag_size: 796
batch 219, loss: 0.0361, instance_loss: 0.0543, weighted_loss: 0.0416, label: 2, bag_size: 6148
batch 239, loss: 0.6006, instance_loss: 0.5391, weighted_loss: 0.5821, label: 1, bag_size: 6025
batch 259, loss: 0.0435, instance_loss: 0.1069, weighted_loss: 0.0625, label: 2, bag_size: 4856
batch 279, loss: 0.7593, instance_loss: 0.5647, weighted_loss: 0.7009, label: 1, bag_size: 1161
batch 299, loss: 0.0505, instance_loss: 0.6475, weighted_loss: 0.2296, label: 0, bag_size: 4841
batch 319, loss: 0.6984, instance_loss: 0.8284, weighted_loss: 0.7374, label: 0, bag_size: 2579
batch 339, loss: 0.0390, instance_loss: 0.2318, weighted_loss: 0.0969, label: 0, bag_size: 614
batch 359, loss: 1.8211, instance_loss: 0.9250, weighted_loss: 1.5523, label: 0, bag_size: 4572
batch 379, loss: 0.0000, instance_loss: 0.5504, weighted_loss: 0.1651, label: 0, bag_size: 1814
batch 399, loss: 0.5140, instance_loss: 0.4258, weighted_loss: 0.4875, label: 0, bag_size: 3224
batch 419, loss: 0.3023, instance_loss: 0.3978, weighted_loss: 0.3310, label: 0, bag_size: 4242
batch 439, loss: 0.0584, instance_loss: 0.5150, weighted_loss: 0.1954, label: 1, bag_size: 1394
batch 459, loss: 0.3418, instance_loss: 0.4338, weighted_loss: 0.3694, label: 0, bag_size: 5353
batch 479, loss: 0.7480, instance_loss: 0.6789, weighted_loss: 0.7272, label: 0, bag_size: 5526
batch 499, loss: 0.0868, instance_loss: 0.2856, weighted_loss: 0.1465, label: 1, bag_size: 425
batch 519, loss: 0.3898, instance_loss: 0.3702, weighted_loss: 0.3839, label: 1, bag_size: 4119
batch 539, loss: 1.4610, instance_loss: 0.8998, weighted_loss: 1.2926, label: 1, bag_size: 4612
batch 559, loss: 0.2596, instance_loss: 0.4030, weighted_loss: 0.3027, label: 1, bag_size: 3534
batch 579, loss: 0.4832, instance_loss: 0.5079, weighted_loss: 0.4906, label: 1, bag_size: 9099
batch 599, loss: 0.1504, instance_loss: 0.4194, weighted_loss: 0.2311, label: 2, bag_size: 3397
batch 619, loss: 0.1155, instance_loss: 0.2015, weighted_loss: 0.1413, label: 0, bag_size: 5353
batch 639, loss: 1.4519, instance_loss: 0.7643, weighted_loss: 1.2456, label: 1, bag_size: 3823
batch 659, loss: 0.0747, instance_loss: 0.2343, weighted_loss: 0.1226, label: 2, bag_size: 2313
batch 679, loss: 0.0606, instance_loss: 0.5160, weighted_loss: 0.1972, label: 1, bag_size: 874
batch 699, loss: 0.6721, instance_loss: 0.4357, weighted_loss: 0.6012, label: 0, bag_size: 3397
batch 719, loss: 0.0096, instance_loss: 0.7151, weighted_loss: 0.2213, label: 2, bag_size: 3607
batch 739, loss: 0.1602, instance_loss: 0.2369, weighted_loss: 0.1832, label: 1, bag_size: 4134


class 0 clustering acc 0.9705257270693513: correct 17353/17880
class 1 clustering acc 0.3447986577181208: correct 2055/5960
Epoch: 25, train_loss: 0.5513, train_clustering_loss:  0.5595, train_error: 0.2282
class 0: acc 0.78515625, correct 201/256
class 1: acc 0.6794871794871795, correct 159/234
class 2: acc 0.8431372549019608, correct 215/255

Val Set, val_loss: 0.9812, val_error: 0.3511, auc: 0.8101
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.2074468085106383: correct 156/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2488, instance_loss: 0.2492, weighted_loss: 0.2489, label: 0, bag_size: 7595
batch 39, loss: 0.0505, instance_loss: 0.3853, weighted_loss: 0.1509, label: 1, bag_size: 796
batch 59, loss: 0.0054, instance_loss: 0.4961, weighted_loss: 0.1526, label: 0, bag_size: 4083
batch 79, loss: 0.0034, instance_loss: 0.4526, weighted_loss: 0.1382, label: 0, bag_size: 2306
batch 99, loss: 0.5046, instance_loss: 0.6532, weighted_loss: 0.5492, label: 0, bag_size: 921
batch 119, loss: 0.1776, instance_loss: 0.3140, weighted_loss: 0.2185, label: 2, bag_size: 1103
batch 139, loss: 0.0643, instance_loss: 0.3458, weighted_loss: 0.1487, label: 2, bag_size: 4372
batch 159, loss: 0.0004, instance_loss: 0.0646, weighted_loss: 0.0197, label: 0, bag_size: 1087
batch 179, loss: 0.1732, instance_loss: 0.4381, weighted_loss: 0.2526, label: 2, bag_size: 4132
batch 199, loss: 0.0002, instance_loss: 0.0269, weighted_loss: 0.0082, label: 0, bag_size: 3920
batch 219, loss: 0.2303, instance_loss: 0.3352, weighted_loss: 0.2618, label: 2, bag_size: 1103
batch 239, loss: 0.2767, instance_loss: 0.5832, weighted_loss: 0.3687, label: 0, bag_size: 1662
batch 259, loss: 2.4017, instance_loss: 1.0969, weighted_loss: 2.0103, label: 1, bag_size: 5035
batch 279, loss: 0.2131, instance_loss: 1.1202, weighted_loss: 0.4853, label: 1, bag_size: 3437
batch 299, loss: 0.0768, instance_loss: 0.4163, weighted_loss: 0.1786, label: 2, bag_size: 2486
batch 319, loss: 0.1155, instance_loss: 0.3071, weighted_loss: 0.1730, label: 2, bag_size: 2481
batch 339, loss: 1.5590, instance_loss: 0.9147, weighted_loss: 1.3657, label: 2, bag_size: 909
batch 359, loss: 0.3594, instance_loss: 0.3221, weighted_loss: 0.3482, label: 2, bag_size: 3534
batch 379, loss: 0.0982, instance_loss: 0.2027, weighted_loss: 0.1295, label: 2, bag_size: 3121
batch 399, loss: 0.2485, instance_loss: 0.5367, weighted_loss: 0.3350, label: 2, bag_size: 5637
batch 419, loss: 0.0501, instance_loss: 0.2034, weighted_loss: 0.0961, label: 2, bag_size: 6148
batch 439, loss: 3.2477, instance_loss: 1.3229, weighted_loss: 2.6702, label: 1, bag_size: 32
batch 459, loss: 0.5001, instance_loss: 0.5551, weighted_loss: 0.5166, label: 1, bag_size: 4784
batch 479, loss: 0.3100, instance_loss: 0.8665, weighted_loss: 0.4769, label: 0, bag_size: 1812
batch 499, loss: 0.6694, instance_loss: 0.5734, weighted_loss: 0.6406, label: 1, bag_size: 5693
batch 519, loss: 0.0517, instance_loss: 0.1826, weighted_loss: 0.0909, label: 2, bag_size: 1094
batch 539, loss: 0.1100, instance_loss: 0.4241, weighted_loss: 0.2043, label: 0, bag_size: 6221
batch 559, loss: 0.7237, instance_loss: 0.6785, weighted_loss: 0.7101, label: 1, bag_size: 5693
batch 579, loss: 0.2818, instance_loss: 0.3438, weighted_loss: 0.3004, label: 1, bag_size: 4119
batch 599, loss: 0.5801, instance_loss: 0.5009, weighted_loss: 0.5563, label: 1, bag_size: 862
batch 619, loss: 0.6265, instance_loss: 0.5982, weighted_loss: 0.6180, label: 0, bag_size: 3797
batch 639, loss: 0.0903, instance_loss: 0.3147, weighted_loss: 0.1576, label: 0, bag_size: 6445
batch 659, loss: 0.9579, instance_loss: 0.8534, weighted_loss: 0.9266, label: 1, bag_size: 9099
batch 679, loss: 0.2597, instance_loss: 0.8125, weighted_loss: 0.4255, label: 1, bag_size: 4898
batch 699, loss: 1.7459, instance_loss: 0.9822, weighted_loss: 1.5168, label: 2, bag_size: 552
batch 719, loss: 0.0181, instance_loss: 0.5309, weighted_loss: 0.1719, label: 1, bag_size: 3337
batch 739, loss: 0.1306, instance_loss: 0.3538, weighted_loss: 0.1976, label: 1, bag_size: 712


class 0 clustering acc 0.9718680089485459: correct 17377/17880
class 1 clustering acc 0.287248322147651: correct 1712/5960
Epoch: 26, train_loss: 0.5926, train_clustering_loss:  0.5921, train_error: 0.2322
class 0: acc 0.782258064516129, correct 194/248
class 1: acc 0.6926070038910506, correct 178/257
class 2: acc 0.8333333333333334, correct 200/240

Val Set, val_loss: 0.7318, val_error: 0.2872, auc: 0.8511
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.19414893617021275: correct 146/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.4310, instance_loss: 0.5714, weighted_loss: 0.4731, label: 1, bag_size: 6165
batch 39, loss: 0.4161, instance_loss: 0.6174, weighted_loss: 0.4765, label: 1, bag_size: 3265
batch 59, loss: 0.0101, instance_loss: 0.3966, weighted_loss: 0.1260, label: 1, bag_size: 2493
batch 79, loss: 1.5583, instance_loss: 0.8222, weighted_loss: 1.3374, label: 0, bag_size: 5098
batch 99, loss: 0.5513, instance_loss: 0.9410, weighted_loss: 0.6682, label: 1, bag_size: 2342
batch 119, loss: 0.0588, instance_loss: 0.4059, weighted_loss: 0.1629, label: 0, bag_size: 4700
batch 139, loss: 0.7280, instance_loss: 0.5781, weighted_loss: 0.6830, label: 1, bag_size: 14449
batch 159, loss: 1.5385, instance_loss: 0.9736, weighted_loss: 1.3690, label: 2, bag_size: 4571
batch 179, loss: 0.4820, instance_loss: 0.4252, weighted_loss: 0.4650, label: 0, bag_size: 5041
batch 199, loss: 0.1809, instance_loss: 0.5488, weighted_loss: 0.2913, label: 2, bag_size: 4535
batch 219, loss: 0.0349, instance_loss: 0.2941, weighted_loss: 0.1126, label: 0, bag_size: 3743
batch 239, loss: 0.9536, instance_loss: 0.9599, weighted_loss: 0.9555, label: 0, bag_size: 3841
batch 259, loss: 0.5348, instance_loss: 0.5516, weighted_loss: 0.5398, label: 1, bag_size: 2744
batch 279, loss: 0.1536, instance_loss: 0.6659, weighted_loss: 0.3073, label: 2, bag_size: 223
batch 299, loss: 0.0866, instance_loss: 0.3467, weighted_loss: 0.1646, label: 0, bag_size: 5170
batch 319, loss: 0.1253, instance_loss: 0.3631, weighted_loss: 0.1966, label: 1, bag_size: 3677
batch 339, loss: 0.0235, instance_loss: 0.3629, weighted_loss: 0.1253, label: 1, bag_size: 3493
batch 359, loss: 2.3212, instance_loss: 1.6910, weighted_loss: 2.1321, label: 1, bag_size: 3016
batch 379, loss: 0.7247, instance_loss: 0.7354, weighted_loss: 0.7279, label: 0, bag_size: 7315
batch 399, loss: 0.0048, instance_loss: 0.5696, weighted_loss: 0.1742, label: 0, bag_size: 3182
batch 419, loss: 0.3938, instance_loss: 0.4623, weighted_loss: 0.4144, label: 1, bag_size: 1712
batch 439, loss: 0.0873, instance_loss: 0.4152, weighted_loss: 0.1857, label: 0, bag_size: 4734
batch 459, loss: 0.0334, instance_loss: 0.4454, weighted_loss: 0.1570, label: 0, bag_size: 1245
batch 479, loss: 0.2811, instance_loss: 0.5344, weighted_loss: 0.3571, label: 1, bag_size: 5412
batch 499, loss: 1.4682, instance_loss: 1.6705, weighted_loss: 1.5288, label: 2, bag_size: 361
batch 519, loss: 0.2331, instance_loss: 0.4930, weighted_loss: 0.3111, label: 1, bag_size: 4960
batch 539, loss: 0.4985, instance_loss: 0.4942, weighted_loss: 0.4972, label: 1, bag_size: 800
batch 559, loss: 3.1867, instance_loss: 1.3756, weighted_loss: 2.6433, label: 1, bag_size: 3159
batch 579, loss: 0.1825, instance_loss: 0.5381, weighted_loss: 0.2891, label: 1, bag_size: 4898
batch 599, loss: 0.1164, instance_loss: 0.2034, weighted_loss: 0.1425, label: 2, bag_size: 6026
batch 619, loss: 1.0455, instance_loss: 0.6234, weighted_loss: 0.9188, label: 2, bag_size: 3534
batch 639, loss: 0.7122, instance_loss: 0.5558, weighted_loss: 0.6653, label: 2, bag_size: 597
batch 659, loss: 0.1287, instance_loss: 0.2970, weighted_loss: 0.1792, label: 2, bag_size: 3121
batch 679, loss: 0.4883, instance_loss: 0.7282, weighted_loss: 0.5603, label: 0, bag_size: 3743
batch 699, loss: 1.2007, instance_loss: 0.9102, weighted_loss: 1.1135, label: 1, bag_size: 6942
batch 719, loss: 0.9461, instance_loss: 0.9068, weighted_loss: 0.9343, label: 1, bag_size: 4395
batch 739, loss: 0.0648, instance_loss: 0.6347, weighted_loss: 0.2357, label: 1, bag_size: 3322


class 0 clustering acc 0.9703020134228187: correct 17349/17880
class 1 clustering acc 0.2721476510067114: correct 1622/5960
Epoch: 27, train_loss: 0.6125, train_clustering_loss:  0.5937, train_error: 0.2497
class 0: acc 0.7701612903225806, correct 191/248
class 1: acc 0.6821705426356589, correct 176/258
class 2: acc 0.803347280334728, correct 192/239

Val Set, val_loss: 0.9176, val_error: 0.3511, auc: 0.8333
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.11569148936170212: correct 87/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.2135, instance_loss: 0.3646, weighted_loss: 0.2588, label: 1, bag_size: 3471
batch 39, loss: 0.4969, instance_loss: 0.6197, weighted_loss: 0.5338, label: 0, bag_size: 3915
batch 59, loss: 0.5145, instance_loss: 0.9849, weighted_loss: 0.6556, label: 1, bag_size: 3437
batch 79, loss: 0.1926, instance_loss: 0.5318, weighted_loss: 0.2944, label: 2, bag_size: 3778
batch 99, loss: 0.0777, instance_loss: 0.3642, weighted_loss: 0.1637, label: 2, bag_size: 3396
batch 119, loss: 0.5534, instance_loss: 0.8749, weighted_loss: 0.6499, label: 2, bag_size: 22464
batch 139, loss: 0.4595, instance_loss: 0.4696, weighted_loss: 0.4626, label: 0, bag_size: 3370
batch 159, loss: 0.1886, instance_loss: 0.2453, weighted_loss: 0.2056, label: 2, bag_size: 2905
batch 179, loss: 0.1703, instance_loss: 0.7702, weighted_loss: 0.3502, label: 1, bag_size: 4184
batch 199, loss: 0.5948, instance_loss: 0.4201, weighted_loss: 0.5424, label: 2, bag_size: 3534
batch 219, loss: 0.0941, instance_loss: 0.6756, weighted_loss: 0.2686, label: 1, bag_size: 6513
batch 239, loss: 0.0034, instance_loss: 0.4543, weighted_loss: 0.1387, label: 1, bag_size: 7279
batch 259, loss: 1.7917, instance_loss: 0.8602, weighted_loss: 1.5122, label: 0, bag_size: 4032
batch 279, loss: 0.0421, instance_loss: 0.2617, weighted_loss: 0.1080, label: 2, bag_size: 6148
batch 299, loss: 0.1501, instance_loss: 0.3122, weighted_loss: 0.1988, label: 0, bag_size: 4242
batch 319, loss: 0.1345, instance_loss: 0.1643, weighted_loss: 0.1435, label: 2, bag_size: 2501
batch 339, loss: 0.0004, instance_loss: 0.3462, weighted_loss: 0.1041, label: 0, bag_size: 3319
batch 359, loss: 0.1780, instance_loss: 0.4257, weighted_loss: 0.2523, label: 2, bag_size: 4162
batch 379, loss: 0.0002, instance_loss: 0.5773, weighted_loss: 0.1734, label: 1, bag_size: 3043
batch 399, loss: 0.5191, instance_loss: 0.8901, weighted_loss: 0.6304, label: 0, bag_size: 889
batch 419, loss: 0.5141, instance_loss: 0.5724, weighted_loss: 0.5316, label: 1, bag_size: 4192
batch 439, loss: 0.1228, instance_loss: 0.2498, weighted_loss: 0.1609, label: 2, bag_size: 2481
batch 459, loss: 0.1867, instance_loss: 0.2401, weighted_loss: 0.2027, label: 0, bag_size: 8611
batch 479, loss: 0.3523, instance_loss: 1.0421, weighted_loss: 0.5592, label: 1, bag_size: 3755
batch 499, loss: 1.3524, instance_loss: 0.7369, weighted_loss: 1.1678, label: 1, bag_size: 5572
batch 519, loss: 0.0013, instance_loss: 0.7700, weighted_loss: 0.2319, label: 0, bag_size: 1910
batch 539, loss: 0.1451, instance_loss: 0.5421, weighted_loss: 0.2642, label: 2, bag_size: 4372
batch 559, loss: 0.0194, instance_loss: 0.1689, weighted_loss: 0.0643, label: 2, bag_size: 3285
batch 579, loss: 1.1230, instance_loss: 0.7664, weighted_loss: 1.0160, label: 0, bag_size: 3841
batch 599, loss: 0.3617, instance_loss: 0.5926, weighted_loss: 0.4310, label: 2, bag_size: 5472
batch 619, loss: 0.0306, instance_loss: 0.2566, weighted_loss: 0.0984, label: 2, bag_size: 4497
batch 639, loss: 0.1639, instance_loss: 0.3352, weighted_loss: 0.2153, label: 2, bag_size: 4203
batch 659, loss: 0.3381, instance_loss: 0.4199, weighted_loss: 0.3627, label: 2, bag_size: 1103
batch 679, loss: 0.8014, instance_loss: 0.9776, weighted_loss: 0.8543, label: 2, bag_size: 5472
batch 699, loss: 2.9722, instance_loss: 1.4307, weighted_loss: 2.5097, label: 1, bag_size: 5035
batch 719, loss: 0.1100, instance_loss: 0.5579, weighted_loss: 0.2443, label: 0, bag_size: 2286
batch 739, loss: 0.1059, instance_loss: 0.5055, weighted_loss: 0.2258, label: 2, bag_size: 2770


class 0 clustering acc 0.974496644295302: correct 17424/17880
class 1 clustering acc 0.3496644295302013: correct 2084/5960
Epoch: 28, train_loss: 0.5379, train_clustering_loss:  0.5443, train_error: 0.2188
class 0: acc 0.8226415094339623, correct 218/265
class 1: acc 0.6238532110091743, correct 136/218
class 2: acc 0.8702290076335878, correct 228/262

Val Set, val_loss: 0.7462, val_error: 0.2979, auc: 0.8534
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.2912234042553192: correct 219/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.4112, instance_loss: 0.4603, weighted_loss: 0.4259, label: 1, bag_size: 6025
batch 39, loss: 0.1717, instance_loss: 0.5214, weighted_loss: 0.2766, label: 0, bag_size: 5519
batch 59, loss: 0.1302, instance_loss: 0.2662, weighted_loss: 0.1710, label: 2, bag_size: 3094
batch 79, loss: 0.5654, instance_loss: 0.4975, weighted_loss: 0.5451, label: 1, bag_size: 3391
batch 99, loss: 0.1428, instance_loss: 0.4284, weighted_loss: 0.2285, label: 0, bag_size: 2601
batch 119, loss: 0.4253, instance_loss: 0.6287, weighted_loss: 0.4863, label: 0, bag_size: 3376
batch 139, loss: 0.0577, instance_loss: 0.0987, weighted_loss: 0.0700, label: 2, bag_size: 3176
batch 159, loss: 0.0169, instance_loss: 0.2521, weighted_loss: 0.0874, label: 1, bag_size: 2878
batch 179, loss: 0.1071, instance_loss: 0.2976, weighted_loss: 0.1642, label: 2, bag_size: 3396
batch 199, loss: 0.5194, instance_loss: 0.3190, weighted_loss: 0.4593, label: 2, bag_size: 3534
batch 219, loss: 0.0217, instance_loss: 0.2617, weighted_loss: 0.0937, label: 1, bag_size: 425
batch 239, loss: 0.3142, instance_loss: 0.3179, weighted_loss: 0.3153, label: 2, bag_size: 1103
batch 259, loss: 0.0425, instance_loss: 0.2167, weighted_loss: 0.0947, label: 0, bag_size: 1647
batch 279, loss: 0.0146, instance_loss: 0.2644, weighted_loss: 0.0895, label: 0, bag_size: 7169
batch 299, loss: 0.0899, instance_loss: 0.2054, weighted_loss: 0.1245, label: 2, bag_size: 4788
batch 319, loss: 0.0407, instance_loss: 0.1701, weighted_loss: 0.0795, label: 0, bag_size: 2019
batch 339, loss: 0.1138, instance_loss: 0.2727, weighted_loss: 0.1615, label: 2, bag_size: 3678
batch 359, loss: 0.7101, instance_loss: 0.6645, weighted_loss: 0.6964, label: 1, bag_size: 3482
batch 379, loss: 0.2759, instance_loss: 0.5516, weighted_loss: 0.3586, label: 2, bag_size: 3121
batch 399, loss: 0.0053, instance_loss: 0.2637, weighted_loss: 0.0828, label: 1, bag_size: 6277
batch 419, loss: 0.0079, instance_loss: 0.1296, weighted_loss: 0.0444, label: 0, bag_size: 4147
batch 439, loss: 1.7442, instance_loss: 0.8307, weighted_loss: 1.4702, label: 0, bag_size: 6630
batch 459, loss: 0.2273, instance_loss: 0.3744, weighted_loss: 0.2715, label: 2, bag_size: 5637
batch 479, loss: 0.0031, instance_loss: 0.4298, weighted_loss: 0.1311, label: 0, bag_size: 5837
batch 499, loss: 0.9621, instance_loss: 0.6576, weighted_loss: 0.8707, label: 1, bag_size: 2319
batch 519, loss: 0.0578, instance_loss: 0.5362, weighted_loss: 0.2013, label: 0, bag_size: 1417
batch 539, loss: 0.0913, instance_loss: 0.4590, weighted_loss: 0.2016, label: 1, bag_size: 3050
batch 559, loss: 0.0949, instance_loss: 0.2634, weighted_loss: 0.1455, label: 2, bag_size: 2313
batch 579, loss: 0.3028, instance_loss: 1.2764, weighted_loss: 0.5949, label: 2, bag_size: 223
batch 599, loss: 0.0847, instance_loss: 0.5987, weighted_loss: 0.2389, label: 1, bag_size: 6475
batch 619, loss: 0.6918, instance_loss: 0.7421, weighted_loss: 0.7068, label: 0, bag_size: 5950
batch 639, loss: 0.0099, instance_loss: 0.3880, weighted_loss: 0.1233, label: 0, bag_size: 1904
batch 659, loss: 0.0977, instance_loss: 0.4913, weighted_loss: 0.2158, label: 2, bag_size: 4141
batch 679, loss: 0.0292, instance_loss: 0.2093, weighted_loss: 0.0832, label: 2, bag_size: 3497
batch 699, loss: 0.3456, instance_loss: 0.6398, weighted_loss: 0.4338, label: 2, bag_size: 5072
batch 719, loss: 0.5766, instance_loss: 0.8014, weighted_loss: 0.6440, label: 1, bag_size: 2831
batch 739, loss: 0.6567, instance_loss: 0.5844, weighted_loss: 0.6350, label: 2, bag_size: 3746


class 0 clustering acc 0.9702460850111857: correct 17348/17880
class 1 clustering acc 0.30083892617449665: correct 1793/5960
Epoch: 29, train_loss: 0.5909, train_clustering_loss:  0.5852, train_error: 0.2497
class 0: acc 0.766798418972332, correct 194/253
class 1: acc 0.6533864541832669, correct 164/251
class 2: acc 0.8340248962655602, correct 201/241

Val Set, val_loss: 0.8928, val_error: 0.3830, auc: 0.8537
class 0 clustering acc 0.9822695035460993: correct 2216/2256
class 1 clustering acc 0.13962765957446807: correct 105/752
class 0: acc 0.5192307692307693, correct 27/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 1.1420, instance_loss: 0.3788, weighted_loss: 0.9130, label: 2, bag_size: 3274
batch 39, loss: 0.0623, instance_loss: 0.7680, weighted_loss: 0.2740, label: 1, bag_size: 782
batch 59, loss: 0.8081, instance_loss: 0.3970, weighted_loss: 0.6847, label: 2, bag_size: 2031
batch 79, loss: 0.1447, instance_loss: 0.6914, weighted_loss: 0.3087, label: 0, bag_size: 7315
batch 99, loss: 0.3113, instance_loss: 0.6209, weighted_loss: 0.4042, label: 1, bag_size: 3746
batch 119, loss: 0.0858, instance_loss: 0.5404, weighted_loss: 0.2222, label: 2, bag_size: 4141
batch 139, loss: 1.5532, instance_loss: 0.8106, weighted_loss: 1.3304, label: 1, bag_size: 1371
batch 159, loss: 0.3609, instance_loss: 0.4256, weighted_loss: 0.3803, label: 0, bag_size: 4455
batch 179, loss: 1.5685, instance_loss: 0.6554, weighted_loss: 1.2945, label: 1, bag_size: 5167
batch 199, loss: 0.8155, instance_loss: 0.6890, weighted_loss: 0.7775, label: 2, bag_size: 3746
batch 219, loss: 0.0391, instance_loss: 0.5253, weighted_loss: 0.1850, label: 0, bag_size: 7927
batch 239, loss: 0.5423, instance_loss: 0.8293, weighted_loss: 0.6284, label: 1, bag_size: 3821
batch 259, loss: 0.2753, instance_loss: 0.4668, weighted_loss: 0.3327, label: 0, bag_size: 3694
batch 279, loss: 0.5286, instance_loss: 0.2962, weighted_loss: 0.4588, label: 2, bag_size: 2031
batch 299, loss: 0.3575, instance_loss: 0.6507, weighted_loss: 0.4454, label: 2, bag_size: 4910
batch 319, loss: 0.0954, instance_loss: 0.4271, weighted_loss: 0.1949, label: 0, bag_size: 1417
batch 339, loss: 0.0094, instance_loss: 0.6373, weighted_loss: 0.1978, label: 0, bag_size: 2306
batch 359, loss: 0.2790, instance_loss: 0.5912, weighted_loss: 0.3726, label: 1, bag_size: 6475
batch 379, loss: 0.7235, instance_loss: 0.6795, weighted_loss: 0.7103, label: 2, bag_size: 4132
batch 399, loss: 0.6467, instance_loss: 0.5776, weighted_loss: 0.6259, label: 0, bag_size: 6927
batch 419, loss: 0.3455, instance_loss: 0.5764, weighted_loss: 0.4148, label: 0, bag_size: 6285
batch 439, loss: 0.9719, instance_loss: 0.6961, weighted_loss: 0.8892, label: 0, bag_size: 609
batch 459, loss: 1.2977, instance_loss: 0.8608, weighted_loss: 1.1667, label: 0, bag_size: 609
batch 479, loss: 0.7654, instance_loss: 0.5990, weighted_loss: 0.7155, label: 0, bag_size: 5890
batch 499, loss: 0.0166, instance_loss: 0.1830, weighted_loss: 0.0665, label: 0, bag_size: 855
batch 519, loss: 1.0130, instance_loss: 0.8485, weighted_loss: 0.9637, label: 2, bag_size: 4291
batch 539, loss: 0.1758, instance_loss: 0.5973, weighted_loss: 0.3022, label: 0, bag_size: 2705
batch 559, loss: 0.0701, instance_loss: 0.2772, weighted_loss: 0.1322, label: 1, bag_size: 862
batch 579, loss: 0.3106, instance_loss: 0.5643, weighted_loss: 0.3867, label: 0, bag_size: 3525
batch 599, loss: 1.4492, instance_loss: 0.9100, weighted_loss: 1.2875, label: 0, bag_size: 1071
batch 619, loss: 0.1196, instance_loss: 0.3926, weighted_loss: 0.2015, label: 2, bag_size: 3121
batch 639, loss: 0.7082, instance_loss: 0.3408, weighted_loss: 0.5979, label: 0, bag_size: 3156
batch 659, loss: 0.2341, instance_loss: 0.5523, weighted_loss: 0.3295, label: 0, bag_size: 5377
batch 679, loss: 0.7174, instance_loss: 0.8625, weighted_loss: 0.7609, label: 1, bag_size: 800
batch 699, loss: 0.6301, instance_loss: 0.4863, weighted_loss: 0.5869, label: 0, bag_size: 3475
batch 719, loss: 0.1210, instance_loss: 0.4256, weighted_loss: 0.2124, label: 0, bag_size: 2195
batch 739, loss: 0.1341, instance_loss: 0.9212, weighted_loss: 0.3702, label: 1, bag_size: 782


class 0 clustering acc 0.9743288590604027: correct 17421/17880
class 1 clustering acc 0.30318791946308726: correct 1807/5960
Epoch: 30, train_loss: 0.5557, train_clustering_loss:  0.5618, train_error: 0.2282
class 0: acc 0.7870722433460076, correct 207/263
class 1: acc 0.672, correct 168/250
class 2: acc 0.8620689655172413, correct 200/232

Val Set, val_loss: 0.6599, val_error: 0.2979, auc: 0.8889
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.1901595744680851: correct 143/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.663194 --> 0.659873).  Saving model ...


batch 19, loss: 0.3314, instance_loss: 0.6313, weighted_loss: 0.4213, label: 2, bag_size: 3112
batch 39, loss: 0.2035, instance_loss: 0.6661, weighted_loss: 0.3423, label: 2, bag_size: 2486
batch 59, loss: 0.1587, instance_loss: 0.5115, weighted_loss: 0.2646, label: 2, bag_size: 4372
batch 79, loss: 0.0432, instance_loss: 0.1570, weighted_loss: 0.0773, label: 0, bag_size: 4857
batch 99, loss: 0.1230, instance_loss: 0.2621, weighted_loss: 0.1647, label: 2, bag_size: 3176
batch 119, loss: 0.3179, instance_loss: 0.7217, weighted_loss: 0.4390, label: 2, bag_size: 5472
batch 139, loss: 0.1294, instance_loss: 0.3857, weighted_loss: 0.2063, label: 0, bag_size: 5377
batch 159, loss: 0.9118, instance_loss: 1.0336, weighted_loss: 0.9484, label: 2, bag_size: 2486
batch 179, loss: 0.0993, instance_loss: 0.3389, weighted_loss: 0.1712, label: 1, bag_size: 2919
batch 199, loss: 0.0020, instance_loss: 0.2618, weighted_loss: 0.0799, label: 1, bag_size: 2254
batch 219, loss: 0.3748, instance_loss: 0.7525, weighted_loss: 0.4881, label: 1, bag_size: 2870
batch 239, loss: 1.6641, instance_loss: 0.7711, weighted_loss: 1.3962, label: 2, bag_size: 1050
batch 259, loss: 0.2217, instance_loss: 0.5817, weighted_loss: 0.3297, label: 1, bag_size: 2962
batch 279, loss: 0.8863, instance_loss: 0.8977, weighted_loss: 0.8897, label: 1, bag_size: 2472
batch 299, loss: 1.0162, instance_loss: 0.7918, weighted_loss: 0.9489, label: 1, bag_size: 667
batch 319, loss: 0.1918, instance_loss: 0.4592, weighted_loss: 0.2720, label: 2, bag_size: 6594
batch 339, loss: 0.4016, instance_loss: 0.3691, weighted_loss: 0.3919, label: 0, bag_size: 3155
batch 359, loss: 0.3489, instance_loss: 0.2528, weighted_loss: 0.3201, label: 0, bag_size: 4131
batch 379, loss: 1.7904, instance_loss: 0.8717, weighted_loss: 1.5148, label: 1, bag_size: 1122
batch 399, loss: 0.1259, instance_loss: 0.2511, weighted_loss: 0.1635, label: 2, bag_size: 1103
batch 419, loss: 1.1541, instance_loss: 0.9863, weighted_loss: 1.1038, label: 1, bag_size: 8632
batch 439, loss: 0.0643, instance_loss: 0.4168, weighted_loss: 0.1700, label: 1, bag_size: 3156
batch 459, loss: 0.0185, instance_loss: 0.1663, weighted_loss: 0.0629, label: 0, bag_size: 3754
batch 479, loss: 0.0877, instance_loss: 0.3189, weighted_loss: 0.1570, label: 0, bag_size: 2607
batch 499, loss: 0.3551, instance_loss: 0.5602, weighted_loss: 0.4167, label: 2, bag_size: 3618
batch 519, loss: 0.0314, instance_loss: 0.1652, weighted_loss: 0.0716, label: 0, bag_size: 3594
batch 539, loss: 0.6123, instance_loss: 1.1166, weighted_loss: 0.7636, label: 1, bag_size: 4599
batch 559, loss: 0.0497, instance_loss: 0.1838, weighted_loss: 0.0899, label: 2, bag_size: 2313
batch 579, loss: 0.0026, instance_loss: 0.5883, weighted_loss: 0.1783, label: 1, bag_size: 3755
batch 599, loss: 0.0139, instance_loss: 0.7327, weighted_loss: 0.2295, label: 1, bag_size: 3437
batch 619, loss: 1.4882, instance_loss: 0.7138, weighted_loss: 1.2559, label: 2, bag_size: 3274
batch 639, loss: 0.0085, instance_loss: 0.2103, weighted_loss: 0.0690, label: 0, bag_size: 4458
batch 659, loss: 0.2354, instance_loss: 0.6262, weighted_loss: 0.3527, label: 2, bag_size: 4141
batch 679, loss: 1.2565, instance_loss: 0.8756, weighted_loss: 1.1422, label: 1, bag_size: 5205
batch 699, loss: 0.1939, instance_loss: 0.9129, weighted_loss: 0.4096, label: 0, bag_size: 4337
batch 719, loss: 0.0895, instance_loss: 0.4293, weighted_loss: 0.1914, label: 1, bag_size: 6156
batch 739, loss: 1.2113, instance_loss: 0.6635, weighted_loss: 1.0470, label: 0, bag_size: 4145


class 0 clustering acc 0.9729865771812081: correct 17397/17880
class 1 clustering acc 0.2959731543624161: correct 1764/5960
Epoch: 31, train_loss: 0.5615, train_clustering_loss:  0.5667, train_error: 0.2564
class 0: acc 0.7456896551724138, correct 173/232
class 1: acc 0.6814814814814815, correct 184/270
class 2: acc 0.8106995884773662, correct 197/243

Val Set, val_loss: 0.7905, val_error: 0.3085, auc: 0.8444
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.22074468085106383: correct 166/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0850, instance_loss: 0.8765, weighted_loss: 1.0224, label: 1, bag_size: 3619
batch 39, loss: 0.0838, instance_loss: 0.2602, weighted_loss: 0.1367, label: 0, bag_size: 4700
batch 59, loss: 0.5590, instance_loss: 0.4887, weighted_loss: 0.5379, label: 0, bag_size: 6223
batch 79, loss: 1.0251, instance_loss: 0.7564, weighted_loss: 0.9445, label: 1, bag_size: 5276
batch 99, loss: 0.0061, instance_loss: 0.4598, weighted_loss: 0.1422, label: 1, bag_size: 3611
batch 119, loss: 0.2272, instance_loss: 0.4440, weighted_loss: 0.2922, label: 1, bag_size: 7135
batch 139, loss: 0.6455, instance_loss: 0.9431, weighted_loss: 0.7348, label: 2, bag_size: 5472
batch 159, loss: 0.0671, instance_loss: 0.4048, weighted_loss: 0.1684, label: 0, bag_size: 1625
batch 179, loss: 0.0900, instance_loss: 0.3561, weighted_loss: 0.1698, label: 0, bag_size: 5632
batch 199, loss: 0.0605, instance_loss: 0.1320, weighted_loss: 0.0820, label: 2, bag_size: 1094
batch 219, loss: 0.0236, instance_loss: 0.1749, weighted_loss: 0.0690, label: 0, bag_size: 2019
batch 239, loss: 0.0012, instance_loss: 0.2173, weighted_loss: 0.0660, label: 2, bag_size: 4497
batch 259, loss: 0.2907, instance_loss: 0.4157, weighted_loss: 0.3282, label: 0, bag_size: 3743
batch 279, loss: 0.0303, instance_loss: 0.1294, weighted_loss: 0.0600, label: 0, bag_size: 4325
batch 299, loss: 0.3166, instance_loss: 1.6367, weighted_loss: 0.7126, label: 0, bag_size: 4351
batch 319, loss: 0.0352, instance_loss: 0.0836, weighted_loss: 0.0497, label: 2, bag_size: 2997
batch 339, loss: 3.4715, instance_loss: 1.5498, weighted_loss: 2.8950, label: 0, bag_size: 3750
batch 359, loss: 0.2930, instance_loss: 0.4500, weighted_loss: 0.3401, label: 2, bag_size: 2481
batch 379, loss: 0.2689, instance_loss: 0.5799, weighted_loss: 0.3622, label: 1, bag_size: 2122
batch 399, loss: 0.0306, instance_loss: 0.1308, weighted_loss: 0.0606, label: 0, bag_size: 3438
batch 419, loss: 0.1514, instance_loss: 0.5461, weighted_loss: 0.2698, label: 2, bag_size: 4141
batch 439, loss: 0.1035, instance_loss: 0.4667, weighted_loss: 0.2125, label: 2, bag_size: 4372
batch 459, loss: 0.0267, instance_loss: 0.1912, weighted_loss: 0.0760, label: 2, bag_size: 4856
batch 479, loss: 1.3669, instance_loss: 0.6904, weighted_loss: 1.1640, label: 1, bag_size: 2751
batch 499, loss: 1.1470, instance_loss: 1.1056, weighted_loss: 1.1346, label: 1, bag_size: 3604
batch 519, loss: 0.5305, instance_loss: 0.2757, weighted_loss: 0.4541, label: 2, bag_size: 2049
batch 539, loss: 0.0652, instance_loss: 0.2240, weighted_loss: 0.1129, label: 2, bag_size: 3094
batch 559, loss: 0.3258, instance_loss: 1.0216, weighted_loss: 0.5346, label: 0, bag_size: 1245
batch 579, loss: 0.4518, instance_loss: 0.5301, weighted_loss: 0.4752, label: 2, bag_size: 2359
batch 599, loss: 0.1200, instance_loss: 0.5421, weighted_loss: 0.2466, label: 0, bag_size: 2392
batch 619, loss: 0.3062, instance_loss: 0.6026, weighted_loss: 0.3952, label: 1, bag_size: 14449
batch 639, loss: 0.4591, instance_loss: 0.5372, weighted_loss: 0.4826, label: 1, bag_size: 14449
batch 659, loss: 0.0112, instance_loss: 0.1114, weighted_loss: 0.0412, label: 2, bag_size: 2209
batch 679, loss: 1.2293, instance_loss: 0.6063, weighted_loss: 1.0424, label: 0, bag_size: 4626
batch 699, loss: 0.2203, instance_loss: 0.4827, weighted_loss: 0.2990, label: 2, bag_size: 3778
batch 719, loss: 1.6207, instance_loss: 0.9733, weighted_loss: 1.4265, label: 1, bag_size: 574
batch 739, loss: 1.6020, instance_loss: 1.4414, weighted_loss: 1.5539, label: 1, bag_size: 302


class 0 clustering acc 0.9706375838926175: correct 17355/17880
class 1 clustering acc 0.33003355704697984: correct 1967/5960
Epoch: 32, train_loss: 0.5271, train_clustering_loss:  0.5642, train_error: 0.2242
class 0: acc 0.7935222672064778, correct 196/247
class 1: acc 0.6636363636363637, correct 146/220
class 2: acc 0.8489208633093526, correct 236/278

Val Set, val_loss: 1.1910, val_error: 0.3723, auc: 0.8248
class 0 clustering acc 0.9312943262411347: correct 2101/2256
class 1 clustering acc 0.1622340425531915: correct 122/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5, correct 15/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9214, instance_loss: 0.4383, weighted_loss: 0.7764, label: 0, bag_size: 5837
batch 39, loss: 0.2020, instance_loss: 0.2374, weighted_loss: 0.2126, label: 2, bag_size: 4788
batch 59, loss: 2.1603, instance_loss: 1.1790, weighted_loss: 1.8659, label: 0, bag_size: 2044
batch 79, loss: 0.0357, instance_loss: 0.2137, weighted_loss: 0.0891, label: 2, bag_size: 3497
batch 99, loss: 0.0052, instance_loss: 0.1914, weighted_loss: 0.0611, label: 0, bag_size: 855
batch 119, loss: 0.0388, instance_loss: 1.1510, weighted_loss: 0.3725, label: 1, bag_size: 6717
batch 139, loss: 0.0709, instance_loss: 0.6181, weighted_loss: 0.2351, label: 0, bag_size: 3666
batch 159, loss: 0.5547, instance_loss: 0.4773, weighted_loss: 0.5315, label: 0, bag_size: 4378
batch 179, loss: 2.4199, instance_loss: 1.1139, weighted_loss: 2.0281, label: 1, bag_size: 3261
batch 199, loss: 0.7259, instance_loss: 0.7048, weighted_loss: 0.7196, label: 1, bag_size: 3821
batch 219, loss: 0.0275, instance_loss: 0.3793, weighted_loss: 0.1331, label: 1, bag_size: 425
batch 239, loss: 0.7546, instance_loss: 0.6252, weighted_loss: 0.7158, label: 0, bag_size: 4245
batch 259, loss: 1.0432, instance_loss: 0.9930, weighted_loss: 1.0281, label: 2, bag_size: 4535
batch 279, loss: 2.2043, instance_loss: 1.0806, weighted_loss: 1.8672, label: 1, bag_size: 32
batch 299, loss: 0.3121, instance_loss: 0.4645, weighted_loss: 0.3578, label: 1, bag_size: 2865
batch 319, loss: 0.4235, instance_loss: 0.3113, weighted_loss: 0.3898, label: 1, bag_size: 3225
batch 339, loss: 1.4308, instance_loss: 0.9057, weighted_loss: 1.2733, label: 1, bag_size: 4200
batch 359, loss: 0.3642, instance_loss: 0.5391, weighted_loss: 0.4167, label: 1, bag_size: 4184
batch 379, loss: 0.0277, instance_loss: 1.6013, weighted_loss: 0.4998, label: 0, bag_size: 1814
batch 399, loss: 0.7645, instance_loss: 0.7180, weighted_loss: 0.7506, label: 0, bag_size: 4310
batch 419, loss: 2.4882, instance_loss: 0.9786, weighted_loss: 2.0353, label: 2, bag_size: 909
batch 439, loss: 0.4093, instance_loss: 0.6217, weighted_loss: 0.4730, label: 1, bag_size: 667
batch 459, loss: 0.5349, instance_loss: 0.6198, weighted_loss: 0.5604, label: 0, bag_size: 5375
batch 479, loss: 0.0047, instance_loss: 0.5180, weighted_loss: 0.1587, label: 0, bag_size: 1204
batch 499, loss: 0.0125, instance_loss: 0.0772, weighted_loss: 0.0319, label: 2, bag_size: 6148
batch 519, loss: 0.0986, instance_loss: 0.0898, weighted_loss: 0.0960, label: 2, bag_size: 4788
batch 539, loss: 1.5064, instance_loss: 0.8175, weighted_loss: 1.2997, label: 1, bag_size: 2642
batch 559, loss: 0.9962, instance_loss: 0.6647, weighted_loss: 0.8967, label: 1, bag_size: 4200
batch 579, loss: 0.2551, instance_loss: 0.6099, weighted_loss: 0.3615, label: 1, bag_size: 2643
batch 599, loss: 0.2965, instance_loss: 0.6981, weighted_loss: 0.4170, label: 2, bag_size: 4910
batch 619, loss: 0.0076, instance_loss: 0.6384, weighted_loss: 0.1969, label: 0, bag_size: 3038
batch 639, loss: 0.0550, instance_loss: 0.4060, weighted_loss: 0.1603, label: 1, bag_size: 3126
batch 659, loss: 0.0529, instance_loss: 0.2433, weighted_loss: 0.1101, label: 0, bag_size: 4070
batch 679, loss: 3.3603, instance_loss: 1.0547, weighted_loss: 2.6686, label: 0, bag_size: 3830
batch 699, loss: 0.3353, instance_loss: 0.5171, weighted_loss: 0.3898, label: 1, bag_size: 2921
batch 719, loss: 0.7702, instance_loss: 0.7812, weighted_loss: 0.7735, label: 2, bag_size: 552
batch 739, loss: 0.1290, instance_loss: 0.6716, weighted_loss: 0.2918, label: 2, bag_size: 6594


class 0 clustering acc 0.9706935123042506: correct 17356/17880
class 1 clustering acc 0.32046979865771813: correct 1910/5960
Epoch: 33, train_loss: 0.4973, train_clustering_loss:  0.5562, train_error: 0.2081
class 0: acc 0.777292576419214, correct 178/229
class 1: acc 0.7251908396946565, correct 190/262
class 2: acc 0.8740157480314961, correct 222/254

Val Set, val_loss: 0.9562, val_error: 0.3298, auc: 0.8315
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.24335106382978725: correct 183/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0268, instance_loss: 0.4886, weighted_loss: 0.1654, label: 0, bag_size: 4997
batch 39, loss: 0.0420, instance_loss: 0.3830, weighted_loss: 0.1443, label: 1, bag_size: 4534
batch 59, loss: 0.1920, instance_loss: 0.5272, weighted_loss: 0.2925, label: 0, bag_size: 1176
batch 79, loss: 0.2495, instance_loss: 0.4130, weighted_loss: 0.2985, label: 2, bag_size: 4203
batch 99, loss: 0.0000, instance_loss: 0.0000, weighted_loss: 0.0000, label: 0, bag_size: 4582
batch 119, loss: 0.1436, instance_loss: 0.5167, weighted_loss: 0.2555, label: 0, bag_size: 6015
batch 139, loss: 0.3553, instance_loss: 0.3521, weighted_loss: 0.3544, label: 0, bag_size: 3915
batch 159, loss: 0.4620, instance_loss: 0.6262, weighted_loss: 0.5113, label: 1, bag_size: 3403
batch 179, loss: 0.0022, instance_loss: 0.3245, weighted_loss: 0.0989, label: 2, bag_size: 4497
batch 199, loss: 0.0110, instance_loss: 0.1118, weighted_loss: 0.0412, label: 2, bag_size: 3094
batch 219, loss: 0.6787, instance_loss: 0.7542, weighted_loss: 0.7014, label: 2, bag_size: 2813
batch 239, loss: 0.2489, instance_loss: 1.0023, weighted_loss: 0.4749, label: 0, bag_size: 7927
batch 259, loss: 1.2100, instance_loss: 1.3057, weighted_loss: 1.2387, label: 1, bag_size: 3184
batch 279, loss: 0.4417, instance_loss: 0.5398, weighted_loss: 0.4711, label: 0, bag_size: 5890
batch 299, loss: 0.6759, instance_loss: 0.4627, weighted_loss: 0.6119, label: 1, bag_size: 4200
batch 319, loss: 0.7856, instance_loss: 0.8087, weighted_loss: 0.7925, label: 0, bag_size: 477
batch 339, loss: 0.5239, instance_loss: 0.5565, weighted_loss: 0.5337, label: 1, bag_size: 19265
batch 359, loss: 1.8968, instance_loss: 1.3321, weighted_loss: 1.7274, label: 2, bag_size: 4342
batch 379, loss: 0.0207, instance_loss: 0.4241, weighted_loss: 0.1417, label: 0, bag_size: 2257
batch 399, loss: 2.3897, instance_loss: 1.0532, weighted_loss: 1.9888, label: 0, bag_size: 1365
batch 419, loss: 0.5359, instance_loss: 0.7915, weighted_loss: 0.6126, label: 0, bag_size: 6223
batch 439, loss: 0.0741, instance_loss: 0.4200, weighted_loss: 0.1779, label: 0, bag_size: 8088
batch 459, loss: 0.8527, instance_loss: 0.7328, weighted_loss: 0.8167, label: 1, bag_size: 1860
batch 479, loss: 2.8881, instance_loss: 0.9060, weighted_loss: 2.2935, label: 0, bag_size: 3316
batch 499, loss: 0.6545, instance_loss: 0.6518, weighted_loss: 0.6537, label: 0, bag_size: 2428
batch 519, loss: 1.5221, instance_loss: 1.1633, weighted_loss: 1.4145, label: 2, bag_size: 4342
batch 539, loss: 0.4160, instance_loss: 0.8188, weighted_loss: 0.5368, label: 2, bag_size: 4571
batch 559, loss: 0.0494, instance_loss: 0.4942, weighted_loss: 0.1829, label: 0, bag_size: 420
batch 579, loss: 0.4082, instance_loss: 0.2381, weighted_loss: 0.3572, label: 0, bag_size: 6252
batch 599, loss: 0.0055, instance_loss: 0.0683, weighted_loss: 0.0244, label: 2, bag_size: 3285
batch 619, loss: 0.0242, instance_loss: 0.1528, weighted_loss: 0.0628, label: 2, bag_size: 3618
batch 639, loss: 0.0566, instance_loss: 0.6015, weighted_loss: 0.2201, label: 1, bag_size: 782
batch 659, loss: 0.0382, instance_loss: 0.1495, weighted_loss: 0.0716, label: 2, bag_size: 2254
batch 679, loss: 0.3224, instance_loss: 0.6941, weighted_loss: 0.4339, label: 1, bag_size: 4534
batch 699, loss: 0.7482, instance_loss: 0.6822, weighted_loss: 0.7284, label: 1, bag_size: 1066
batch 719, loss: 0.5296, instance_loss: 0.7008, weighted_loss: 0.5810, label: 0, bag_size: 421
batch 739, loss: 0.6407, instance_loss: 0.9235, weighted_loss: 0.7255, label: 2, bag_size: 22464


class 0 clustering acc 0.9736017897091722: correct 17408/17880
class 1 clustering acc 0.28808724832214766: correct 1717/5960
Epoch: 34, train_loss: 0.5541, train_clustering_loss:  0.5784, train_error: 0.2483
class 0: acc 0.744, correct 186/250
class 1: acc 0.6956521739130435, correct 176/253
class 2: acc 0.8181818181818182, correct 198/242

Val Set, val_loss: 0.8622, val_error: 0.3298, auc: 0.8531
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.20877659574468085: correct 157/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0659, instance_loss: 0.2381, weighted_loss: 0.1176, label: 2, bag_size: 4788
batch 39, loss: 0.0602, instance_loss: 0.2602, weighted_loss: 0.1202, label: 0, bag_size: 1545
batch 59, loss: 1.0079, instance_loss: 0.6926, weighted_loss: 0.9133, label: 0, bag_size: 3191
batch 79, loss: 0.0711, instance_loss: 0.1267, weighted_loss: 0.0878, label: 2, bag_size: 4056
batch 99, loss: 0.2804, instance_loss: 0.3461, weighted_loss: 0.3001, label: 2, bag_size: 2359
batch 119, loss: 0.0914, instance_loss: 0.2598, weighted_loss: 0.1419, label: 2, bag_size: 3778
batch 139, loss: 0.0511, instance_loss: 0.4038, weighted_loss: 0.1569, label: 0, bag_size: 2607
batch 159, loss: 0.1266, instance_loss: 0.2431, weighted_loss: 0.1615, label: 0, bag_size: 4734
batch 179, loss: 1.6713, instance_loss: 0.8464, weighted_loss: 1.4239, label: 1, bag_size: 1122
batch 199, loss: 0.0833, instance_loss: 0.2690, weighted_loss: 0.1390, label: 0, bag_size: 2873
batch 219, loss: 1.2789, instance_loss: 0.5661, weighted_loss: 1.0650, label: 1, bag_size: 19265
batch 239, loss: 0.4663, instance_loss: 0.5946, weighted_loss: 0.5048, label: 0, bag_size: 3690
batch 259, loss: 0.4625, instance_loss: 0.7937, weighted_loss: 0.5618, label: 1, bag_size: 1542
batch 279, loss: 0.1489, instance_loss: 0.4396, weighted_loss: 0.2361, label: 2, bag_size: 3618
batch 299, loss: 0.2034, instance_loss: 0.3538, weighted_loss: 0.2485, label: 0, bag_size: 5656
batch 319, loss: 0.4014, instance_loss: 0.4028, weighted_loss: 0.4018, label: 0, bag_size: 4734
batch 339, loss: 5.4126, instance_loss: 1.5736, weighted_loss: 4.2609, label: 0, bag_size: 603
batch 359, loss: 0.0247, instance_loss: 0.1445, weighted_loss: 0.0607, label: 0, bag_size: 4918
batch 379, loss: 0.6541, instance_loss: 0.5545, weighted_loss: 0.6243, label: 1, bag_size: 2743
batch 399, loss: 0.0282, instance_loss: 0.5483, weighted_loss: 0.1843, label: 1, bag_size: 4192
batch 419, loss: 3.0855, instance_loss: 1.2477, weighted_loss: 2.5342, label: 0, bag_size: 3750
batch 439, loss: 0.3947, instance_loss: 0.4931, weighted_loss: 0.4242, label: 0, bag_size: 1662
batch 459, loss: 0.3976, instance_loss: 0.3583, weighted_loss: 0.3858, label: 0, bag_size: 789
batch 479, loss: 3.0372, instance_loss: 1.3281, weighted_loss: 2.5245, label: 2, bag_size: 3475
batch 499, loss: 0.0582, instance_loss: 0.2280, weighted_loss: 0.1091, label: 2, bag_size: 3397
batch 519, loss: 0.0404, instance_loss: 0.7040, weighted_loss: 0.2395, label: 1, bag_size: 4192
batch 539, loss: 0.7546, instance_loss: 0.8640, weighted_loss: 0.7874, label: 0, bag_size: 3191
batch 559, loss: 0.4715, instance_loss: 0.6411, weighted_loss: 0.5224, label: 1, bag_size: 2921
batch 579, loss: 0.1557, instance_loss: 0.3504, weighted_loss: 0.2141, label: 2, bag_size: 4487
batch 599, loss: 0.0274, instance_loss: 0.1827, weighted_loss: 0.0740, label: 2, bag_size: 2483
batch 619, loss: 0.1731, instance_loss: 0.4311, weighted_loss: 0.2505, label: 2, bag_size: 5924
batch 639, loss: 0.0963, instance_loss: 0.2832, weighted_loss: 0.1523, label: 2, bag_size: 3397
batch 659, loss: 0.1809, instance_loss: 0.4331, weighted_loss: 0.2565, label: 2, bag_size: 5924
batch 679, loss: 2.4819, instance_loss: 1.5761, weighted_loss: 2.2102, label: 0, bag_size: 15105
batch 699, loss: 0.0523, instance_loss: 0.5446, weighted_loss: 0.2000, label: 0, bag_size: 2501
batch 719, loss: 0.5954, instance_loss: 0.4864, weighted_loss: 0.5627, label: 0, bag_size: 2190
batch 739, loss: 0.2050, instance_loss: 0.3966, weighted_loss: 0.2625, label: 1, bag_size: 210


class 0 clustering acc 0.9742170022371365: correct 17419/17880
class 1 clustering acc 0.33506711409395973: correct 1997/5960
Epoch: 35, train_loss: 0.5358, train_clustering_loss:  0.5501, train_error: 0.2215
class 0: acc 0.7698744769874477, correct 184/239
class 1: acc 0.7195121951219512, correct 177/246
class 2: acc 0.8423076923076923, correct 219/260

Val Set, val_loss: 0.8364, val_error: 0.3298, auc: 0.8383
class 0 clustering acc 0.9738475177304965: correct 2197/2256
class 1 clustering acc 0.2752659574468085: correct 207/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2406, instance_loss: 0.4746, weighted_loss: 0.3108, label: 1, bag_size: 2919
batch 39, loss: 0.1180, instance_loss: 0.4157, weighted_loss: 0.2073, label: 2, bag_size: 5017
batch 59, loss: 0.9613, instance_loss: 0.3636, weighted_loss: 0.7820, label: 0, bag_size: 3155
batch 79, loss: 0.2305, instance_loss: 0.5912, weighted_loss: 0.3387, label: 1, bag_size: 1394
batch 99, loss: 0.3465, instance_loss: 0.6493, weighted_loss: 0.4373, label: 1, bag_size: 4960
batch 119, loss: 0.0500, instance_loss: 0.3697, weighted_loss: 0.1459, label: 1, bag_size: 3127
batch 139, loss: 2.9232, instance_loss: 1.4088, weighted_loss: 2.4689, label: 2, bag_size: 4316
batch 159, loss: 0.0763, instance_loss: 0.3235, weighted_loss: 0.1505, label: 0, bag_size: 5570
batch 179, loss: 0.5446, instance_loss: 0.5735, weighted_loss: 0.5533, label: 1, bag_size: 5118
batch 199, loss: 0.3969, instance_loss: 0.7555, weighted_loss: 0.5045, label: 2, bag_size: 22464
batch 219, loss: 0.0000, instance_loss: 0.3188, weighted_loss: 0.0957, label: 1, bag_size: 5462
batch 239, loss: 0.3906, instance_loss: 0.6098, weighted_loss: 0.4563, label: 2, bag_size: 4203
batch 259, loss: 0.0435, instance_loss: 0.1795, weighted_loss: 0.0843, label: 2, bag_size: 2254
batch 279, loss: 0.3784, instance_loss: 0.6971, weighted_loss: 0.4740, label: 1, bag_size: 3471
batch 299, loss: 0.1052, instance_loss: 0.6867, weighted_loss: 0.2796, label: 0, bag_size: 2826
batch 319, loss: 0.0922, instance_loss: 0.2167, weighted_loss: 0.1295, label: 0, bag_size: 5029
batch 339, loss: 0.0702, instance_loss: 0.2712, weighted_loss: 0.1305, label: 2, bag_size: 3678
batch 359, loss: 0.0240, instance_loss: 0.3723, weighted_loss: 0.1285, label: 1, bag_size: 455
batch 379, loss: 0.0562, instance_loss: 0.2276, weighted_loss: 0.1076, label: 2, bag_size: 6001
batch 399, loss: 0.6911, instance_loss: 1.3183, weighted_loss: 0.8792, label: 2, bag_size: 223
batch 419, loss: 1.3710, instance_loss: 0.8592, weighted_loss: 1.2174, label: 2, bag_size: 4241
batch 439, loss: 0.7691, instance_loss: 0.6976, weighted_loss: 0.7477, label: 2, bag_size: 4241
batch 459, loss: 0.0446, instance_loss: 0.4005, weighted_loss: 0.1514, label: 1, bag_size: 3156
batch 479, loss: 0.0082, instance_loss: 0.3061, weighted_loss: 0.0975, label: 0, bag_size: 4744
batch 499, loss: 0.0931, instance_loss: 0.2842, weighted_loss: 0.1505, label: 0, bag_size: 4707
batch 519, loss: 0.0011, instance_loss: 0.3218, weighted_loss: 0.0973, label: 1, bag_size: 3126
batch 539, loss: 0.1308, instance_loss: 0.5598, weighted_loss: 0.2595, label: 1, bag_size: 1197
batch 559, loss: 0.2349, instance_loss: 0.5809, weighted_loss: 0.3387, label: 2, bag_size: 5037
batch 579, loss: 11.1210, instance_loss: 1.7645, weighted_loss: 8.3141, label: 2, bag_size: 2049
batch 599, loss: 0.6005, instance_loss: 0.4024, weighted_loss: 0.5411, label: 2, bag_size: 2501
batch 619, loss: 0.1655, instance_loss: 0.6202, weighted_loss: 0.3019, label: 1, bag_size: 4184
batch 639, loss: 0.1802, instance_loss: 0.6138, weighted_loss: 0.3102, label: 1, bag_size: 2472
batch 659, loss: 0.3588, instance_loss: 0.3853, weighted_loss: 0.3667, label: 0, bag_size: 4450
batch 679, loss: 0.1741, instance_loss: 0.5681, weighted_loss: 0.2923, label: 0, bag_size: 4485
batch 699, loss: 0.5896, instance_loss: 0.5212, weighted_loss: 0.5691, label: 0, bag_size: 1744
batch 719, loss: 0.1656, instance_loss: 0.5001, weighted_loss: 0.2659, label: 2, bag_size: 3497
batch 739, loss: 0.2662, instance_loss: 0.5527, weighted_loss: 0.3521, label: 0, bag_size: 4282


class 0 clustering acc 0.9732662192393736: correct 17402/17880
class 1 clustering acc 0.28942953020134227: correct 1725/5960
Epoch: 36, train_loss: 0.5869, train_clustering_loss:  0.5766, train_error: 0.2389
class 0: acc 0.7627118644067796, correct 180/236
class 1: acc 0.7007874015748031, correct 178/254
class 2: acc 0.8196078431372549, correct 209/255

Val Set, val_loss: 1.0693, val_error: 0.3936, auc: 0.8444
class 0 clustering acc 0.9552304964539007: correct 2155/2256
class 1 clustering acc 0.1077127659574468: correct 81/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2314, instance_loss: 0.4355, weighted_loss: 0.2926, label: 2, bag_size: 3227
batch 39, loss: 0.0001, instance_loss: 0.3708, weighted_loss: 0.1113, label: 1, bag_size: 5462
batch 59, loss: 0.4485, instance_loss: 0.5434, weighted_loss: 0.4770, label: 0, bag_size: 11663
batch 79, loss: 0.0911, instance_loss: 0.4131, weighted_loss: 0.1877, label: 2, bag_size: 6273
batch 99, loss: 1.4522, instance_loss: 0.6758, weighted_loss: 1.2193, label: 1, bag_size: 800
batch 119, loss: 0.9705, instance_loss: 1.0158, weighted_loss: 0.9841, label: 2, bag_size: 3299
batch 139, loss: 0.6006, instance_loss: 0.7175, weighted_loss: 0.6357, label: 2, bag_size: 4487
batch 159, loss: 0.2338, instance_loss: 0.6881, weighted_loss: 0.3701, label: 1, bag_size: 3460
batch 179, loss: 5.0628, instance_loss: 2.0364, weighted_loss: 4.1549, label: 0, bag_size: 11141
batch 199, loss: 0.0134, instance_loss: 0.2632, weighted_loss: 0.0884, label: 0, bag_size: 1234
batch 219, loss: 0.0643, instance_loss: 0.5648, weighted_loss: 0.2145, label: 0, bag_size: 1883
batch 239, loss: 0.0177, instance_loss: 0.1787, weighted_loss: 0.0660, label: 0, bag_size: 2825
batch 259, loss: 0.7423, instance_loss: 0.8086, weighted_loss: 0.7622, label: 1, bag_size: 1161
batch 279, loss: 0.1660, instance_loss: 0.4641, weighted_loss: 0.2554, label: 2, bag_size: 4487
batch 299, loss: 1.2085, instance_loss: 0.6996, weighted_loss: 1.0558, label: 2, bag_size: 1513
batch 319, loss: 0.1066, instance_loss: 0.3668, weighted_loss: 0.1847, label: 2, bag_size: 5637
batch 339, loss: 0.3414, instance_loss: 0.4814, weighted_loss: 0.3834, label: 2, bag_size: 3396
batch 359, loss: 0.0134, instance_loss: 0.6752, weighted_loss: 0.2120, label: 0, bag_size: 5585
batch 379, loss: 0.1248, instance_loss: 0.1909, weighted_loss: 0.1446, label: 0, bag_size: 4325
batch 399, loss: 0.3719, instance_loss: 0.5755, weighted_loss: 0.4330, label: 0, bag_size: 3525
batch 419, loss: 0.0628, instance_loss: 0.1963, weighted_loss: 0.1028, label: 2, bag_size: 2209
batch 439, loss: 0.0719, instance_loss: 0.4136, weighted_loss: 0.1744, label: 2, bag_size: 4162
batch 459, loss: 0.3626, instance_loss: 0.2811, weighted_loss: 0.3381, label: 0, bag_size: 3886
batch 479, loss: 0.0130, instance_loss: 0.1469, weighted_loss: 0.0532, label: 0, bag_size: 4918
batch 499, loss: 0.1651, instance_loss: 0.5460, weighted_loss: 0.2794, label: 2, bag_size: 4162
batch 519, loss: 0.1025, instance_loss: 0.3104, weighted_loss: 0.1649, label: 0, bag_size: 4994
batch 539, loss: 0.0974, instance_loss: 0.6092, weighted_loss: 0.2509, label: 0, bag_size: 4997
batch 559, loss: 0.3126, instance_loss: 0.6231, weighted_loss: 0.4058, label: 1, bag_size: 4346
batch 579, loss: 0.1782, instance_loss: 0.4013, weighted_loss: 0.2451, label: 2, bag_size: 4162
batch 599, loss: 1.5819, instance_loss: 0.8117, weighted_loss: 1.3509, label: 0, bag_size: 2189
batch 619, loss: 0.0848, instance_loss: 0.3379, weighted_loss: 0.1607, label: 2, bag_size: 4043
batch 639, loss: 0.4854, instance_loss: 0.6984, weighted_loss: 0.5493, label: 1, bag_size: 3471
batch 659, loss: 0.0724, instance_loss: 0.4215, weighted_loss: 0.1771, label: 0, bag_size: 7330
batch 679, loss: 0.0119, instance_loss: 0.2996, weighted_loss: 0.0982, label: 0, bag_size: 4458
batch 699, loss: 0.1414, instance_loss: 0.5200, weighted_loss: 0.2550, label: 1, bag_size: 4812
batch 719, loss: 0.0436, instance_loss: 0.2965, weighted_loss: 0.1194, label: 0, bag_size: 3864
batch 739, loss: 0.1328, instance_loss: 0.3595, weighted_loss: 0.2008, label: 2, bag_size: 3778


class 0 clustering acc 0.9729865771812081: correct 17397/17880
class 1 clustering acc 0.3040268456375839: correct 1812/5960
Epoch: 37, train_loss: 0.5449, train_clustering_loss:  0.5724, train_error: 0.2201
class 0: acc 0.80859375, correct 207/256
class 1: acc 0.6888888888888889, correct 155/225
class 2: acc 0.8295454545454546, correct 219/264

Val Set, val_loss: 1.0486, val_error: 0.3617, auc: 0.8459
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.12898936170212766: correct 97/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.5, correct 15/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1222, instance_loss: 0.4449, weighted_loss: 0.2190, label: 2, bag_size: 6594
batch 39, loss: 0.0325, instance_loss: 0.6474, weighted_loss: 0.2169, label: 1, bag_size: 2453
batch 59, loss: 0.4545, instance_loss: 0.6583, weighted_loss: 0.5156, label: 2, bag_size: 4910
batch 79, loss: 0.0021, instance_loss: 1.0320, weighted_loss: 0.3111, label: 0, bag_size: 5646
batch 99, loss: 0.0763, instance_loss: 0.2447, weighted_loss: 0.1268, label: 2, bag_size: 4555
batch 119, loss: 0.0006, instance_loss: 0.2834, weighted_loss: 0.0854, label: 2, bag_size: 3607
batch 139, loss: 0.0362, instance_loss: 0.0969, weighted_loss: 0.0544, label: 2, bag_size: 2313
batch 159, loss: 0.8801, instance_loss: 0.7280, weighted_loss: 0.8345, label: 1, bag_size: 4467
batch 179, loss: 0.2287, instance_loss: 0.4185, weighted_loss: 0.2857, label: 2, bag_size: 4569
batch 199, loss: 0.1942, instance_loss: 0.3979, weighted_loss: 0.2553, label: 1, bag_size: 1029
batch 219, loss: 0.0335, instance_loss: 0.2450, weighted_loss: 0.0969, label: 0, bag_size: 5992
batch 239, loss: 0.8000, instance_loss: 0.8104, weighted_loss: 0.8031, label: 1, bag_size: 4940
batch 259, loss: 0.8123, instance_loss: 0.6556, weighted_loss: 0.7653, label: 1, bag_size: 4395
batch 279, loss: 1.2782, instance_loss: 0.6797, weighted_loss: 1.0986, label: 0, bag_size: 3402
batch 299, loss: 0.0897, instance_loss: 0.1660, weighted_loss: 0.1126, label: 2, bag_size: 3285
batch 319, loss: 0.0591, instance_loss: 0.0897, weighted_loss: 0.0683, label: 2, bag_size: 4088
batch 339, loss: 0.1687, instance_loss: 0.5108, weighted_loss: 0.2713, label: 2, bag_size: 4910
batch 359, loss: 0.9068, instance_loss: 0.6169, weighted_loss: 0.8198, label: 0, bag_size: 5484
batch 379, loss: 1.3839, instance_loss: 0.9011, weighted_loss: 1.2391, label: 1, bag_size: 3424
batch 399, loss: 0.0000, instance_loss: 0.0242, weighted_loss: 0.0073, label: 0, bag_size: 2354
batch 419, loss: 0.0624, instance_loss: 0.1509, weighted_loss: 0.0889, label: 2, bag_size: 4223
batch 439, loss: 0.0699, instance_loss: 0.1049, weighted_loss: 0.0804, label: 2, bag_size: 4788
batch 459, loss: 0.0620, instance_loss: 0.2523, weighted_loss: 0.1190, label: 2, bag_size: 3497
batch 479, loss: 0.0460, instance_loss: 0.2990, weighted_loss: 0.1219, label: 2, bag_size: 4141
batch 499, loss: 0.2357, instance_loss: 0.5239, weighted_loss: 0.3222, label: 2, bag_size: 5072
batch 519, loss: 0.0075, instance_loss: 0.5842, weighted_loss: 0.1805, label: 1, bag_size: 4534
batch 539, loss: 0.0115, instance_loss: 0.1295, weighted_loss: 0.0469, label: 2, bag_size: 4856
batch 559, loss: 2.5259, instance_loss: 0.8294, weighted_loss: 2.0169, label: 1, bag_size: 4187
batch 579, loss: 0.3010, instance_loss: 0.4965, weighted_loss: 0.3597, label: 1, bag_size: 2744
batch 599, loss: 0.3526, instance_loss: 0.5859, weighted_loss: 0.4226, label: 2, bag_size: 5017
batch 619, loss: 0.0881, instance_loss: 0.2156, weighted_loss: 0.1263, label: 0, bag_size: 1647
batch 639, loss: 0.0710, instance_loss: 0.4254, weighted_loss: 0.1774, label: 1, bag_size: 3497
batch 659, loss: 0.6977, instance_loss: 0.6666, weighted_loss: 0.6884, label: 1, bag_size: 3619
batch 679, loss: 0.2295, instance_loss: 0.4729, weighted_loss: 0.3025, label: 0, bag_size: 4347
batch 699, loss: 0.3177, instance_loss: 0.6844, weighted_loss: 0.4277, label: 2, bag_size: 6704
batch 719, loss: 0.0067, instance_loss: 0.3406, weighted_loss: 0.1069, label: 1, bag_size: 3333
batch 739, loss: 0.6257, instance_loss: 0.5020, weighted_loss: 0.5886, label: 0, bag_size: 3571


class 0 clustering acc 0.9738255033557047: correct 17412/17880
class 1 clustering acc 0.3098993288590604: correct 1847/5960
Epoch: 38, train_loss: 0.5431, train_clustering_loss:  0.5671, train_error: 0.2282
class 0: acc 0.8042553191489362, correct 189/235
class 1: acc 0.6613545816733067, correct 166/251
class 2: acc 0.8494208494208494, correct 220/259

Val Set, val_loss: 0.9606, val_error: 0.3723, auc: 0.8442
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.19946808510638298: correct 150/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.4, correct 12/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0787, instance_loss: 0.1811, weighted_loss: 0.1094, label: 2, bag_size: 2313
batch 39, loss: 0.5566, instance_loss: 0.5250, weighted_loss: 0.5471, label: 0, bag_size: 4547
batch 59, loss: 0.5262, instance_loss: 0.7582, weighted_loss: 0.5958, label: 2, bag_size: 1050
batch 79, loss: 0.2781, instance_loss: 0.3303, weighted_loss: 0.2938, label: 0, bag_size: 4570
batch 99, loss: 0.2962, instance_loss: 0.4593, weighted_loss: 0.3451, label: 1, bag_size: 2156
batch 119, loss: 0.0106, instance_loss: 0.2871, weighted_loss: 0.0936, label: 2, bag_size: 4497
batch 139, loss: 0.8209, instance_loss: 0.8671, weighted_loss: 0.8348, label: 1, bag_size: 2481
batch 159, loss: 0.0162, instance_loss: 0.2500, weighted_loss: 0.0863, label: 0, bag_size: 4458
batch 179, loss: 0.2556, instance_loss: 0.5755, weighted_loss: 0.3516, label: 2, bag_size: 3112
batch 199, loss: 0.0314, instance_loss: 0.1457, weighted_loss: 0.0657, label: 2, bag_size: 3121
batch 219, loss: 0.2825, instance_loss: 0.9295, weighted_loss: 0.4766, label: 1, bag_size: 4599
batch 239, loss: 0.0022, instance_loss: 0.4947, weighted_loss: 0.1499, label: 1, bag_size: 3755
batch 259, loss: 0.4782, instance_loss: 0.7468, weighted_loss: 0.5588, label: 2, bag_size: 4535
batch 279, loss: 0.0478, instance_loss: 0.3795, weighted_loss: 0.1473, label: 0, bag_size: 5226
batch 299, loss: 0.0078, instance_loss: 0.5871, weighted_loss: 0.1816, label: 1, bag_size: 3437
batch 319, loss: 1.2075, instance_loss: 0.9911, weighted_loss: 1.1426, label: 1, bag_size: 4395
batch 339, loss: 0.3346, instance_loss: 0.4886, weighted_loss: 0.3808, label: 0, bag_size: 2378
batch 359, loss: 0.0487, instance_loss: 0.5954, weighted_loss: 0.2127, label: 1, bag_size: 2453
batch 379, loss: 0.0021, instance_loss: 0.4770, weighted_loss: 0.1445, label: 1, bag_size: 455
batch 399, loss: 0.1512, instance_loss: 0.5954, weighted_loss: 0.2845, label: 0, bag_size: 5840
batch 419, loss: 0.0716, instance_loss: 0.2909, weighted_loss: 0.1374, label: 0, bag_size: 3525
batch 439, loss: 1.1529, instance_loss: 0.7439, weighted_loss: 1.0302, label: 1, bag_size: 2870
batch 459, loss: 0.4946, instance_loss: 0.5566, weighted_loss: 0.5132, label: 1, bag_size: 1712
batch 479, loss: 0.0193, instance_loss: 0.2294, weighted_loss: 0.0823, label: 0, bag_size: 4918
batch 499, loss: 0.0450, instance_loss: 0.1344, weighted_loss: 0.0718, label: 0, bag_size: 3816
batch 519, loss: 0.0356, instance_loss: 0.5143, weighted_loss: 0.1792, label: 0, bag_size: 4337
batch 539, loss: 0.0029, instance_loss: 0.3005, weighted_loss: 0.0922, label: 0, bag_size: 3319
batch 559, loss: 0.1813, instance_loss: 0.2518, weighted_loss: 0.2024, label: 0, bag_size: 4584
batch 579, loss: 0.0976, instance_loss: 0.0931, weighted_loss: 0.0963, label: 2, bag_size: 4056
batch 599, loss: 0.1435, instance_loss: 0.4846, weighted_loss: 0.2459, label: 1, bag_size: 2731
batch 619, loss: 0.0325, instance_loss: 0.1155, weighted_loss: 0.0574, label: 2, bag_size: 3285
batch 639, loss: 0.0508, instance_loss: 0.1940, weighted_loss: 0.0938, label: 2, bag_size: 2481
batch 659, loss: 0.2416, instance_loss: 0.4630, weighted_loss: 0.3080, label: 0, bag_size: 609
batch 679, loss: 0.0222, instance_loss: 0.3786, weighted_loss: 0.1291, label: 0, bag_size: 5011
batch 699, loss: 0.0351, instance_loss: 0.0704, weighted_loss: 0.0457, label: 2, bag_size: 657
batch 719, loss: 0.0427, instance_loss: 0.1946, weighted_loss: 0.0882, label: 2, bag_size: 3121
batch 739, loss: 0.2374, instance_loss: 0.4774, weighted_loss: 0.3094, label: 2, bag_size: 3778


class 0 clustering acc 0.9722035794183446: correct 17383/17880
class 1 clustering acc 0.3667785234899329: correct 2186/5960
Epoch: 39, train_loss: 0.4807, train_clustering_loss:  0.5435, train_error: 0.1960
class 0: acc 0.825925925925926, correct 223/270
class 1: acc 0.6728971962616822, correct 144/214
class 2: acc 0.8888888888888888, correct 232/261

Val Set, val_loss: 0.8034, val_error: 0.2766, auc: 0.8566
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.32180851063829785: correct 242/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4930, instance_loss: 0.2282, weighted_loss: 0.4135, label: 0, bag_size: 6252
batch 39, loss: 1.7167, instance_loss: 1.3285, weighted_loss: 1.6003, label: 0, bag_size: 12971
batch 59, loss: 0.0614, instance_loss: 0.5804, weighted_loss: 0.2171, label: 0, bag_size: 4398
batch 79, loss: 0.3926, instance_loss: 0.2920, weighted_loss: 0.3625, label: 0, bag_size: 3754
batch 99, loss: 1.2469, instance_loss: 0.8845, weighted_loss: 1.1382, label: 2, bag_size: 1513
batch 119, loss: 0.5745, instance_loss: 0.5314, weighted_loss: 0.5615, label: 2, bag_size: 597
batch 139, loss: 0.2080, instance_loss: 0.4465, weighted_loss: 0.2795, label: 2, bag_size: 5924
batch 159, loss: 0.0801, instance_loss: 0.3309, weighted_loss: 0.1553, label: 0, bag_size: 1947
batch 179, loss: 1.4864, instance_loss: 0.6691, weighted_loss: 1.2412, label: 0, bag_size: 5098
batch 199, loss: 2.1025, instance_loss: 1.0447, weighted_loss: 1.7851, label: 0, bag_size: 1774
batch 219, loss: 0.0082, instance_loss: 0.2391, weighted_loss: 0.0775, label: 0, bag_size: 1545
batch 239, loss: 0.0140, instance_loss: 0.0924, weighted_loss: 0.0375, label: 2, bag_size: 3094
batch 259, loss: 0.0196, instance_loss: 0.1325, weighted_loss: 0.0535, label: 0, bag_size: 4325
batch 279, loss: 0.7388, instance_loss: 0.8944, weighted_loss: 0.7855, label: 1, bag_size: 3109
batch 299, loss: 0.9047, instance_loss: 0.7005, weighted_loss: 0.8434, label: 1, bag_size: 4612
batch 319, loss: 0.1627, instance_loss: 0.4298, weighted_loss: 0.2428, label: 2, bag_size: 3299
batch 339, loss: 0.2007, instance_loss: 0.3865, weighted_loss: 0.2565, label: 1, bag_size: 7135
batch 359, loss: 0.0382, instance_loss: 0.4365, weighted_loss: 0.1577, label: 1, bag_size: 596
batch 379, loss: 0.2780, instance_loss: 0.3765, weighted_loss: 0.3076, label: 2, bag_size: 1543
batch 399, loss: 0.1881, instance_loss: 0.4698, weighted_loss: 0.2726, label: 0, bag_size: 598
batch 419, loss: 0.0385, instance_loss: 0.1118, weighted_loss: 0.0605, label: 2, bag_size: 2483
batch 439, loss: 0.4373, instance_loss: 0.7944, weighted_loss: 0.5444, label: 2, bag_size: 552
batch 459, loss: 0.8927, instance_loss: 0.6257, weighted_loss: 0.8126, label: 0, bag_size: 3841
batch 479, loss: 0.7874, instance_loss: 0.7170, weighted_loss: 0.7663, label: 0, bag_size: 2153
batch 499, loss: 0.0963, instance_loss: 0.1406, weighted_loss: 0.1096, label: 2, bag_size: 3678
batch 519, loss: 0.0485, instance_loss: 0.3108, weighted_loss: 0.1272, label: 0, bag_size: 3103
batch 539, loss: 0.8673, instance_loss: 0.6942, weighted_loss: 0.8153, label: 1, bag_size: 3322
batch 559, loss: 0.0086, instance_loss: 0.5396, weighted_loss: 0.1679, label: 1, bag_size: 3337
batch 579, loss: 0.0192, instance_loss: 0.3776, weighted_loss: 0.1267, label: 2, bag_size: 4497
batch 599, loss: 0.3514, instance_loss: 0.5831, weighted_loss: 0.4209, label: 1, bag_size: 4784
batch 619, loss: 0.5817, instance_loss: 0.8702, weighted_loss: 0.6683, label: 0, bag_size: 1562
batch 639, loss: 0.6847, instance_loss: 0.5728, weighted_loss: 0.6511, label: 0, bag_size: 3797
batch 659, loss: 2.0902, instance_loss: 1.2284, weighted_loss: 1.8316, label: 1, bag_size: 1097
batch 679, loss: 0.0275, instance_loss: 0.8064, weighted_loss: 0.2612, label: 1, bag_size: 3051
batch 699, loss: 0.2011, instance_loss: 0.6008, weighted_loss: 0.3210, label: 1, bag_size: 3755
batch 719, loss: 0.0849, instance_loss: 0.2589, weighted_loss: 0.1371, label: 2, bag_size: 5924
batch 739, loss: 1.1218, instance_loss: 0.8604, weighted_loss: 1.0434, label: 1, bag_size: 4898


class 0 clustering acc 0.9719798657718121: correct 17379/17880
class 1 clustering acc 0.3585570469798658: correct 2137/5960
Epoch: 40, train_loss: 0.5030, train_clustering_loss:  0.5439, train_error: 0.2174
class 0: acc 0.8192307692307692, correct 213/260
class 1: acc 0.6502242152466368, correct 145/223
class 2: acc 0.8587786259541985, correct 225/262

Val Set, val_loss: 0.9779, val_error: 0.2872, auc: 0.8537
class 0 clustering acc 0.938386524822695: correct 2117/2256
class 1 clustering acc 0.4627659574468085: correct 348/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0328, instance_loss: 0.2284, weighted_loss: 0.0914, label: 0, bag_size: 2195
batch 39, loss: 0.0020, instance_loss: 0.2580, weighted_loss: 0.0788, label: 0, bag_size: 4403
batch 59, loss: 0.0271, instance_loss: 0.6832, weighted_loss: 0.2239, label: 2, bag_size: 728
batch 79, loss: 0.0099, instance_loss: 0.3983, weighted_loss: 0.1264, label: 2, bag_size: 3172
batch 99, loss: 0.1019, instance_loss: 0.7999, weighted_loss: 0.3113, label: 1, bag_size: 4898
batch 119, loss: 0.0090, instance_loss: 0.1479, weighted_loss: 0.0507, label: 0, bag_size: 4918
batch 139, loss: 0.0097, instance_loss: 0.3742, weighted_loss: 0.1191, label: 1, bag_size: 2453
batch 159, loss: 0.2571, instance_loss: 0.4372, weighted_loss: 0.3111, label: 2, bag_size: 3778
batch 179, loss: 0.0033, instance_loss: 0.0510, weighted_loss: 0.0176, label: 2, bag_size: 4856
batch 199, loss: 0.0296, instance_loss: 0.1816, weighted_loss: 0.0752, label: 0, bag_size: 4831
batch 219, loss: 1.1578, instance_loss: 0.8096, weighted_loss: 1.0534, label: 1, bag_size: 475
batch 239, loss: 0.4229, instance_loss: 0.6024, weighted_loss: 0.4767, label: 0, bag_size: 4700
batch 259, loss: 1.5901, instance_loss: 0.9954, weighted_loss: 1.4117, label: 0, bag_size: 4450
batch 279, loss: 0.0318, instance_loss: 0.3322, weighted_loss: 0.1219, label: 0, bag_size: 3406
batch 299, loss: 0.0986, instance_loss: 0.5797, weighted_loss: 0.2429, label: 0, bag_size: 14070
batch 319, loss: 0.0072, instance_loss: 0.1103, weighted_loss: 0.0381, label: 0, bag_size: 5782
batch 339, loss: 0.7876, instance_loss: 1.1767, weighted_loss: 0.9044, label: 0, bag_size: 3075
batch 359, loss: 0.7654, instance_loss: 0.4525, weighted_loss: 0.6715, label: 2, bag_size: 597
batch 379, loss: 0.3943, instance_loss: 0.3871, weighted_loss: 0.3921, label: 2, bag_size: 2501
batch 399, loss: 0.0402, instance_loss: 0.2127, weighted_loss: 0.0920, label: 2, bag_size: 3497
batch 419, loss: 0.7608, instance_loss: 0.6066, weighted_loss: 0.7146, label: 2, bag_size: 2813
batch 439, loss: 1.9713, instance_loss: 1.1787, weighted_loss: 1.7335, label: 0, bag_size: 421
batch 459, loss: 0.7111, instance_loss: 1.1559, weighted_loss: 0.8445, label: 0, bag_size: 889
batch 479, loss: 0.8488, instance_loss: 0.5885, weighted_loss: 0.7707, label: 1, bag_size: 4812
batch 499, loss: 0.0090, instance_loss: 0.0915, weighted_loss: 0.0337, label: 2, bag_size: 657
batch 519, loss: 0.1144, instance_loss: 0.2370, weighted_loss: 0.1512, label: 2, bag_size: 4555
batch 539, loss: 2.9168, instance_loss: 1.3564, weighted_loss: 2.4487, label: 0, bag_size: 455
batch 559, loss: 0.0496, instance_loss: 0.0970, weighted_loss: 0.0638, label: 2, bag_size: 2313
batch 579, loss: 0.0260, instance_loss: 0.1138, weighted_loss: 0.0523, label: 2, bag_size: 3094
batch 599, loss: 0.0223, instance_loss: 0.4842, weighted_loss: 0.1609, label: 1, bag_size: 2453
batch 619, loss: 0.6478, instance_loss: 0.9166, weighted_loss: 0.7284, label: 2, bag_size: 4241
batch 639, loss: 0.0459, instance_loss: 0.4226, weighted_loss: 0.1589, label: 1, bag_size: 3127
batch 659, loss: 0.0763, instance_loss: 0.3457, weighted_loss: 0.1571, label: 0, bag_size: 789
batch 679, loss: 0.0818, instance_loss: 0.1954, weighted_loss: 0.1159, label: 2, bag_size: 3210
batch 699, loss: 0.1281, instance_loss: 0.8911, weighted_loss: 0.3570, label: 0, bag_size: 2428
batch 719, loss: 0.2249, instance_loss: 0.4566, weighted_loss: 0.2944, label: 0, bag_size: 4562
batch 739, loss: 0.4848, instance_loss: 0.5922, weighted_loss: 0.5170, label: 2, bag_size: 2813


class 0 clustering acc 0.9690715883668903: correct 17327/17880
class 1 clustering acc 0.3412751677852349: correct 2034/5960
Epoch: 41, train_loss: 0.5246, train_clustering_loss:  0.5641, train_error: 0.2309
class 0: acc 0.7931034482758621, correct 184/232
class 1: acc 0.6363636363636364, correct 147/231
class 2: acc 0.8581560283687943, correct 242/282

Val Set, val_loss: 0.9306, val_error: 0.3298, auc: 0.8474
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.2300531914893617: correct 173/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.8888, instance_loss: 0.8161, weighted_loss: 0.8670, label: 2, bag_size: 4179
batch 39, loss: 2.0795, instance_loss: 0.9403, weighted_loss: 1.7377, label: 0, bag_size: 3675
batch 59, loss: 0.1644, instance_loss: 0.4196, weighted_loss: 0.2410, label: 0, bag_size: 4544
batch 79, loss: 0.1386, instance_loss: 0.1102, weighted_loss: 0.1301, label: 2, bag_size: 4056
batch 99, loss: 0.1731, instance_loss: 0.6083, weighted_loss: 0.3037, label: 1, bag_size: 3519
batch 119, loss: 3.1879, instance_loss: 1.6184, weighted_loss: 2.7170, label: 1, bag_size: 3159
batch 139, loss: 0.0191, instance_loss: 0.2856, weighted_loss: 0.0991, label: 0, bag_size: 4405
batch 159, loss: 0.1052, instance_loss: 0.1174, weighted_loss: 0.1089, label: 2, bag_size: 1094
batch 179, loss: 0.6426, instance_loss: 0.5517, weighted_loss: 0.6154, label: 0, bag_size: 4228
batch 199, loss: 0.0476, instance_loss: 0.5561, weighted_loss: 0.2002, label: 2, bag_size: 2770
batch 219, loss: 0.5850, instance_loss: 0.6331, weighted_loss: 0.5994, label: 0, bag_size: 4946
batch 239, loss: 0.4096, instance_loss: 0.4771, weighted_loss: 0.4298, label: 1, bag_size: 1854
batch 259, loss: 0.0230, instance_loss: 0.6547, weighted_loss: 0.2125, label: 1, bag_size: 1558
batch 279, loss: 0.0443, instance_loss: 0.3588, weighted_loss: 0.1387, label: 0, bag_size: 1947
batch 299, loss: 0.0717, instance_loss: 0.1024, weighted_loss: 0.0809, label: 2, bag_size: 4788
batch 319, loss: 0.0390, instance_loss: 0.7782, weighted_loss: 0.2607, label: 1, bag_size: 3586
batch 339, loss: 1.4891, instance_loss: 1.3597, weighted_loss: 1.4503, label: 2, bag_size: 4342
batch 359, loss: 0.5509, instance_loss: 0.8708, weighted_loss: 0.6469, label: 1, bag_size: 712
batch 379, loss: 0.0075, instance_loss: 0.6698, weighted_loss: 0.2062, label: 0, bag_size: 2927
batch 399, loss: 1.0593, instance_loss: 0.9085, weighted_loss: 1.0141, label: 1, bag_size: 2302
batch 419, loss: 0.6887, instance_loss: 0.5352, weighted_loss: 0.6426, label: 1, bag_size: 3438
batch 439, loss: 0.5616, instance_loss: 0.4323, weighted_loss: 0.5228, label: 1, bag_size: 4467
batch 459, loss: 0.2623, instance_loss: 0.4356, weighted_loss: 0.3143, label: 0, bag_size: 768
batch 479, loss: 1.8127, instance_loss: 0.4993, weighted_loss: 1.4187, label: 0, bag_size: 5041
batch 499, loss: 0.3176, instance_loss: 0.3679, weighted_loss: 0.3327, label: 0, bag_size: 3344
batch 519, loss: 0.0837, instance_loss: 0.3831, weighted_loss: 0.1735, label: 2, bag_size: 3810
batch 539, loss: 2.9032, instance_loss: 1.1169, weighted_loss: 2.3673, label: 0, bag_size: 1774
batch 559, loss: 0.0628, instance_loss: 0.5377, weighted_loss: 0.2053, label: 1, bag_size: 3475
batch 579, loss: 0.0297, instance_loss: 0.7648, weighted_loss: 0.2503, label: 2, bag_size: 3607
batch 599, loss: 0.4588, instance_loss: 0.5960, weighted_loss: 0.5000, label: 2, bag_size: 2486
batch 619, loss: 2.1879, instance_loss: 0.9396, weighted_loss: 1.8134, label: 1, bag_size: 6993
batch 639, loss: 0.0086, instance_loss: 0.4477, weighted_loss: 0.1403, label: 0, bag_size: 3245
batch 659, loss: 0.1970, instance_loss: 0.4442, weighted_loss: 0.2711, label: 2, bag_size: 3396
batch 679, loss: 0.0357, instance_loss: 0.1173, weighted_loss: 0.0602, label: 0, bag_size: 4165
batch 699, loss: 0.4965, instance_loss: 0.8579, weighted_loss: 0.6049, label: 2, bag_size: 4535
batch 719, loss: 0.7900, instance_loss: 0.6702, weighted_loss: 0.7541, label: 1, bag_size: 1608
batch 739, loss: 0.3012, instance_loss: 0.4847, weighted_loss: 0.3562, label: 1, bag_size: 3746


class 0 clustering acc 0.971923937360179: correct 17378/17880
class 1 clustering acc 0.29328859060402684: correct 1748/5960
Epoch: 42, train_loss: 0.5576, train_clustering_loss:  0.5724, train_error: 0.2362
class 0: acc 0.7532467532467533, correct 174/231
class 1: acc 0.7115384615384616, correct 185/260
class 2: acc 0.8267716535433071, correct 210/254

Val Set, val_loss: 1.0969, val_error: 0.3404, auc: 0.8268
class 0 clustering acc 0.987145390070922: correct 2227/2256
class 1 clustering acc 0.13430851063829788: correct 101/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3010, instance_loss: 0.2418, weighted_loss: 0.2832, label: 1, bag_size: 368
batch 39, loss: 0.2100, instance_loss: 0.4309, weighted_loss: 0.2763, label: 2, bag_size: 4487
batch 59, loss: 0.0444, instance_loss: 0.2075, weighted_loss: 0.0933, label: 2, bag_size: 6148
batch 79, loss: 0.8284, instance_loss: 0.7985, weighted_loss: 0.8194, label: 0, bag_size: 3070
batch 99, loss: 0.1166, instance_loss: 0.2523, weighted_loss: 0.1573, label: 0, bag_size: 2019
batch 119, loss: 1.0311, instance_loss: 1.2757, weighted_loss: 1.1045, label: 2, bag_size: 4241
batch 139, loss: 1.7405, instance_loss: 1.2545, weighted_loss: 1.5947, label: 1, bag_size: 2229
batch 159, loss: 0.5718, instance_loss: 0.6518, weighted_loss: 0.5958, label: 1, bag_size: 4438
batch 179, loss: 0.3027, instance_loss: 0.5828, weighted_loss: 0.3867, label: 1, bag_size: 4438
batch 199, loss: 0.0663, instance_loss: 0.5516, weighted_loss: 0.2119, label: 2, bag_size: 6001
batch 219, loss: 0.1464, instance_loss: 0.4117, weighted_loss: 0.2260, label: 0, bag_size: 3188
batch 239, loss: 0.0121, instance_loss: 0.3427, weighted_loss: 0.1113, label: 0, bag_size: 921
batch 259, loss: 0.5075, instance_loss: 0.3291, weighted_loss: 0.4540, label: 2, bag_size: 3534
batch 279, loss: 0.4589, instance_loss: 0.8397, weighted_loss: 0.5731, label: 1, bag_size: 3403
batch 299, loss: 0.9566, instance_loss: 0.7010, weighted_loss: 0.8799, label: 0, bag_size: 4509
batch 319, loss: 0.1958, instance_loss: 0.3849, weighted_loss: 0.2525, label: 2, bag_size: 3778
batch 339, loss: 0.7645, instance_loss: 0.7278, weighted_loss: 0.7535, label: 0, bag_size: 8866
batch 359, loss: 0.6705, instance_loss: 0.8029, weighted_loss: 0.7102, label: 2, bag_size: 4910
batch 379, loss: 0.3307, instance_loss: 0.2819, weighted_loss: 0.3160, label: 0, bag_size: 4251
batch 399, loss: 0.0056, instance_loss: 0.6558, weighted_loss: 0.2007, label: 1, bag_size: 3611
batch 419, loss: 0.4596, instance_loss: 0.7052, weighted_loss: 0.5333, label: 0, bag_size: 2428
batch 439, loss: 2.3543, instance_loss: 1.3571, weighted_loss: 2.0551, label: 2, bag_size: 4241
batch 459, loss: 0.0286, instance_loss: 0.4942, weighted_loss: 0.1683, label: 1, bag_size: 7135
batch 479, loss: 0.0141, instance_loss: 0.5156, weighted_loss: 0.1645, label: 1, bag_size: 2453
batch 499, loss: 0.1973, instance_loss: 0.4746, weighted_loss: 0.2805, label: 2, bag_size: 5307
batch 519, loss: 0.0130, instance_loss: 0.5935, weighted_loss: 0.1871, label: 2, bag_size: 6001
batch 539, loss: 0.1612, instance_loss: 0.2597, weighted_loss: 0.1907, label: 0, bag_size: 2487
batch 559, loss: 0.2625, instance_loss: 0.2060, weighted_loss: 0.2455, label: 2, bag_size: 2905
batch 579, loss: 0.0267, instance_loss: 0.0671, weighted_loss: 0.0388, label: 2, bag_size: 2254
batch 599, loss: 0.6462, instance_loss: 0.7183, weighted_loss: 0.6678, label: 1, bag_size: 3935
batch 619, loss: 0.0136, instance_loss: 0.4152, weighted_loss: 0.1340, label: 1, bag_size: 1836
batch 639, loss: 0.4068, instance_loss: 0.4793, weighted_loss: 0.4285, label: 1, bag_size: 296
batch 659, loss: 0.0004, instance_loss: 0.2845, weighted_loss: 0.0857, label: 1, bag_size: 4134
batch 679, loss: 0.1731, instance_loss: 0.4999, weighted_loss: 0.2712, label: 0, bag_size: 5377
batch 699, loss: 0.0242, instance_loss: 0.6644, weighted_loss: 0.2163, label: 0, bag_size: 2306
batch 719, loss: 0.1191, instance_loss: 0.8355, weighted_loss: 0.3340, label: 0, bag_size: 4485
batch 739, loss: 0.9907, instance_loss: 0.7906, weighted_loss: 0.9307, label: 2, bag_size: 1050


class 0 clustering acc 0.9705257270693513: correct 17353/17880
class 1 clustering acc 0.3157718120805369: correct 1882/5960
Epoch: 43, train_loss: 0.5282, train_clustering_loss:  0.5658, train_error: 0.2295
class 0: acc 0.792, correct 198/250
class 1: acc 0.6869918699186992, correct 169/246
class 2: acc 0.8313253012048193, correct 207/249

Val Set, val_loss: 0.9944, val_error: 0.3298, auc: 0.8176
class 0 clustering acc 0.9432624113475178: correct 2128/2256
class 1 clustering acc 0.4375: correct 329/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.7226, instance_loss: 0.7943, weighted_loss: 1.4441, label: 1, bag_size: 5167
batch 39, loss: 0.0616, instance_loss: 0.1581, weighted_loss: 0.0905, label: 2, bag_size: 3176
batch 59, loss: 0.0038, instance_loss: 0.5081, weighted_loss: 0.1551, label: 1, bag_size: 4134
batch 79, loss: 0.0220, instance_loss: 0.3857, weighted_loss: 0.1311, label: 0, bag_size: 1174
batch 99, loss: 0.2475, instance_loss: 0.3314, weighted_loss: 0.2727, label: 2, bag_size: 2359
batch 119, loss: 2.5062, instance_loss: 0.8332, weighted_loss: 2.0043, label: 1, bag_size: 3823
batch 139, loss: 0.1931, instance_loss: 0.2867, weighted_loss: 0.2212, label: 0, bag_size: 5831
batch 159, loss: 0.0202, instance_loss: 0.0753, weighted_loss: 0.0368, label: 2, bag_size: 4569
batch 179, loss: 0.2165, instance_loss: 0.5853, weighted_loss: 0.3272, label: 0, bag_size: 4946
batch 199, loss: 0.4395, instance_loss: 0.7543, weighted_loss: 0.5339, label: 2, bag_size: 22464
batch 219, loss: 0.8441, instance_loss: 0.8244, weighted_loss: 0.8382, label: 1, bag_size: 1854
batch 239, loss: 0.0338, instance_loss: 0.4797, weighted_loss: 0.1676, label: 0, bag_size: 2293
batch 259, loss: 0.7834, instance_loss: 0.7912, weighted_loss: 0.7857, label: 1, bag_size: 3619
batch 279, loss: 0.0156, instance_loss: 0.1656, weighted_loss: 0.0606, label: 0, bag_size: 4147
batch 299, loss: 0.7612, instance_loss: 0.7120, weighted_loss: 0.7464, label: 0, bag_size: 2501
batch 319, loss: 0.2267, instance_loss: 0.4405, weighted_loss: 0.2908, label: 1, bag_size: 2905
batch 339, loss: 0.1146, instance_loss: 0.3768, weighted_loss: 0.1932, label: 0, bag_size: 2545
batch 359, loss: 0.9884, instance_loss: 0.7194, weighted_loss: 0.9077, label: 1, bag_size: 1097
batch 379, loss: 0.2574, instance_loss: 0.9886, weighted_loss: 0.4767, label: 2, bag_size: 728
batch 399, loss: 0.0500, instance_loss: 0.3152, weighted_loss: 0.1295, label: 1, bag_size: 2254
batch 419, loss: 1.9569, instance_loss: 0.7571, weighted_loss: 1.5970, label: 2, bag_size: 2031
batch 439, loss: 0.1559, instance_loss: 0.4453, weighted_loss: 0.2427, label: 1, bag_size: 1221
batch 459, loss: 0.0723, instance_loss: 0.3614, weighted_loss: 0.1590, label: 0, bag_size: 2019
batch 479, loss: 0.2685, instance_loss: 0.6625, weighted_loss: 0.3867, label: 1, bag_size: 4960
batch 499, loss: 0.4065, instance_loss: 0.6945, weighted_loss: 0.4929, label: 2, bag_size: 4162
batch 519, loss: 0.7360, instance_loss: 0.5275, weighted_loss: 0.6735, label: 1, bag_size: 2643
batch 539, loss: 0.1550, instance_loss: 0.6004, weighted_loss: 0.2886, label: 2, bag_size: 5472
batch 559, loss: 1.9352, instance_loss: 1.2855, weighted_loss: 1.7403, label: 1, bag_size: 2852
batch 579, loss: 0.1742, instance_loss: 0.4293, weighted_loss: 0.2507, label: 1, bag_size: 1197
batch 599, loss: 1.3031, instance_loss: 0.6355, weighted_loss: 1.1028, label: 2, bag_size: 705
batch 619, loss: 0.2376, instance_loss: 0.6924, weighted_loss: 0.3740, label: 1, bag_size: 4346
batch 639, loss: 0.0006, instance_loss: 0.8529, weighted_loss: 0.2563, label: 1, bag_size: 3322
batch 659, loss: 0.1642, instance_loss: 0.4458, weighted_loss: 0.2487, label: 0, bag_size: 614
batch 679, loss: 0.5727, instance_loss: 0.6044, weighted_loss: 0.5822, label: 1, bag_size: 3619
batch 699, loss: 0.7445, instance_loss: 0.6551, weighted_loss: 0.7177, label: 0, bag_size: 3475
batch 719, loss: 0.0131, instance_loss: 0.1728, weighted_loss: 0.0610, label: 0, bag_size: 1710
batch 739, loss: 0.0013, instance_loss: 0.4267, weighted_loss: 0.1289, label: 1, bag_size: 2809


class 0 clustering acc 0.9737136465324385: correct 17410/17880
class 1 clustering acc 0.31711409395973156: correct 1890/5960
Epoch: 44, train_loss: 0.5153, train_clustering_loss:  0.5577, train_error: 0.2174
class 0: acc 0.7617021276595745, correct 179/235
class 1: acc 0.751937984496124, correct 194/258
class 2: acc 0.8333333333333334, correct 210/252

Val Set, val_loss: 1.0198, val_error: 0.3511, auc: 0.8370
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.3829787234042553: correct 288/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0817, instance_loss: 0.2870, weighted_loss: 0.1433, label: 2, bag_size: 2359
batch 39, loss: 0.0071, instance_loss: 0.7412, weighted_loss: 0.2273, label: 1, bag_size: 1542
batch 59, loss: 0.0637, instance_loss: 0.0937, weighted_loss: 0.0727, label: 2, bag_size: 2997
batch 79, loss: 0.0846, instance_loss: 0.4021, weighted_loss: 0.1798, label: 1, bag_size: 3471
batch 99, loss: 0.1304, instance_loss: 0.4122, weighted_loss: 0.2149, label: 2, bag_size: 5406
batch 119, loss: 1.0798, instance_loss: 1.0571, weighted_loss: 1.0730, label: 0, bag_size: 6249
batch 139, loss: 1.2433, instance_loss: 0.7603, weighted_loss: 1.0984, label: 0, bag_size: 421
batch 159, loss: 0.2279, instance_loss: 0.8391, weighted_loss: 0.4112, label: 1, bag_size: 5340
batch 179, loss: 0.1818, instance_loss: 0.2538, weighted_loss: 0.2034, label: 0, bag_size: 5459
batch 199, loss: 0.2208, instance_loss: 0.1290, weighted_loss: 0.1932, label: 2, bag_size: 4056
batch 219, loss: 0.0656, instance_loss: 0.5944, weighted_loss: 0.2242, label: 1, bag_size: 8482
batch 239, loss: 0.0930, instance_loss: 0.1913, weighted_loss: 0.1225, label: 0, bag_size: 873
batch 259, loss: 0.0035, instance_loss: 0.3838, weighted_loss: 0.1176, label: 1, bag_size: 874
batch 279, loss: 0.2222, instance_loss: 0.3493, weighted_loss: 0.2603, label: 1, bag_size: 9099
batch 299, loss: 0.0197, instance_loss: 0.1909, weighted_loss: 0.0710, label: 0, bag_size: 4918
batch 319, loss: 0.0130, instance_loss: 0.3039, weighted_loss: 0.1003, label: 1, bag_size: 3357
batch 339, loss: 0.4389, instance_loss: 0.6027, weighted_loss: 0.4880, label: 0, bag_size: 4808
batch 359, loss: 0.3784, instance_loss: 0.5162, weighted_loss: 0.4197, label: 1, bag_size: 3396
batch 379, loss: 0.7296, instance_loss: 1.1396, weighted_loss: 0.8526, label: 1, bag_size: 7176
batch 399, loss: 0.1573, instance_loss: 0.5756, weighted_loss: 0.2828, label: 1, bag_size: 3050
batch 419, loss: 0.2393, instance_loss: 0.5574, weighted_loss: 0.3347, label: 2, bag_size: 3227
batch 439, loss: 0.6426, instance_loss: 0.5505, weighted_loss: 0.6150, label: 1, bag_size: 2743
batch 459, loss: 0.3842, instance_loss: 0.5914, weighted_loss: 0.4463, label: 1, bag_size: 1528
batch 479, loss: 0.3328, instance_loss: 0.5665, weighted_loss: 0.4029, label: 1, bag_size: 2643
batch 499, loss: 0.9937, instance_loss: 1.0290, weighted_loss: 1.0043, label: 1, bag_size: 7176
batch 519, loss: 0.0354, instance_loss: 0.3235, weighted_loss: 0.1219, label: 0, bag_size: 1385
batch 539, loss: 0.5093, instance_loss: 0.6663, weighted_loss: 0.5564, label: 2, bag_size: 5743
batch 559, loss: 0.1339, instance_loss: 0.3082, weighted_loss: 0.1862, label: 0, bag_size: 3701
batch 579, loss: 0.0000, instance_loss: 0.2675, weighted_loss: 0.0803, label: 2, bag_size: 3607
batch 599, loss: 0.1037, instance_loss: 0.1391, weighted_loss: 0.1144, label: 2, bag_size: 4056
batch 619, loss: 0.2817, instance_loss: 0.6310, weighted_loss: 0.3865, label: 0, bag_size: 2232
batch 639, loss: 0.4438, instance_loss: 0.7045, weighted_loss: 0.5220, label: 2, bag_size: 5743
batch 659, loss: 1.5216, instance_loss: 0.7950, weighted_loss: 1.3036, label: 0, bag_size: 3156
batch 679, loss: 0.8332, instance_loss: 0.6494, weighted_loss: 0.7780, label: 1, bag_size: 1066
batch 699, loss: 0.0081, instance_loss: 0.6176, weighted_loss: 0.1909, label: 1, bag_size: 3333
batch 719, loss: 0.1066, instance_loss: 0.2904, weighted_loss: 0.1617, label: 2, bag_size: 3497
batch 739, loss: 0.0009, instance_loss: 0.0603, weighted_loss: 0.0187, label: 0, bag_size: 855


class 0 clustering acc 0.9695190156599552: correct 17335/17880
class 1 clustering acc 0.3768456375838926: correct 2246/5960
Epoch: 45, train_loss: 0.4417, train_clustering_loss:  0.5313, train_error: 0.1852
class 0: acc 0.8372093023255814, correct 216/258
class 1: acc 0.7509727626459144, correct 193/257
class 2: acc 0.8608695652173913, correct 198/230

Val Set, val_loss: 0.9656, val_error: 0.3298, auc: 0.8406
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.19148936170212766: correct 144/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.9125, instance_loss: 0.3157, weighted_loss: 0.7335, label: 2, bag_size: 2501
batch 39, loss: 0.1140, instance_loss: 0.2728, weighted_loss: 0.1616, label: 0, bag_size: 6430
batch 59, loss: 0.0761, instance_loss: 0.7837, weighted_loss: 0.2884, label: 0, bag_size: 1601
batch 79, loss: 2.3408, instance_loss: 0.8707, weighted_loss: 1.8998, label: 2, bag_size: 909
batch 99, loss: 0.0564, instance_loss: 0.5528, weighted_loss: 0.2053, label: 2, bag_size: 3112
batch 119, loss: 0.0808, instance_loss: 0.4308, weighted_loss: 0.1858, label: 2, bag_size: 5037
batch 139, loss: 0.6216, instance_loss: 0.6260, weighted_loss: 0.6229, label: 2, bag_size: 5072
batch 159, loss: 1.3377, instance_loss: 0.9509, weighted_loss: 1.2217, label: 1, bag_size: 1580
batch 179, loss: 1.0432, instance_loss: 0.3441, weighted_loss: 0.8335, label: 2, bag_size: 4056
batch 199, loss: 0.0924, instance_loss: 0.3411, weighted_loss: 0.1670, label: 0, bag_size: 3816
batch 219, loss: 0.3684, instance_loss: 0.3404, weighted_loss: 0.3600, label: 2, bag_size: 4043
batch 239, loss: 0.0888, instance_loss: 0.1988, weighted_loss: 0.1218, label: 0, bag_size: 5036
batch 259, loss: 0.0252, instance_loss: 0.2764, weighted_loss: 0.1006, label: 2, bag_size: 3607
batch 279, loss: 0.0001, instance_loss: 0.1496, weighted_loss: 0.0449, label: 1, bag_size: 2809
batch 299, loss: 0.1571, instance_loss: 0.4866, weighted_loss: 0.2559, label: 2, bag_size: 3778
batch 319, loss: 0.0902, instance_loss: 0.5621, weighted_loss: 0.2318, label: 0, bag_size: 1883
batch 339, loss: 0.4437, instance_loss: 0.2228, weighted_loss: 0.3775, label: 0, bag_size: 3533
batch 359, loss: 0.4504, instance_loss: 0.7607, weighted_loss: 0.5435, label: 1, bag_size: 2472
batch 379, loss: 0.0065, instance_loss: 0.4719, weighted_loss: 0.1461, label: 1, bag_size: 4578
batch 399, loss: 0.0139, instance_loss: 0.0739, weighted_loss: 0.0319, label: 2, bag_size: 6026
batch 419, loss: 0.1228, instance_loss: 0.2851, weighted_loss: 0.1715, label: 2, bag_size: 4788
batch 439, loss: 0.2041, instance_loss: 0.4597, weighted_loss: 0.2808, label: 0, bag_size: 3885
batch 459, loss: 0.9768, instance_loss: 0.8511, weighted_loss: 0.9391, label: 2, bag_size: 4179
batch 479, loss: 0.2302, instance_loss: 1.2538, weighted_loss: 0.5373, label: 2, bag_size: 361
batch 499, loss: 0.0000, instance_loss: 0.4132, weighted_loss: 0.1240, label: 0, bag_size: 1910
batch 519, loss: 0.0918, instance_loss: 0.2850, weighted_loss: 0.1498, label: 1, bag_size: 4192
batch 539, loss: 0.8024, instance_loss: 0.5961, weighted_loss: 0.7405, label: 1, bag_size: 2865
batch 559, loss: 0.0058, instance_loss: 0.1155, weighted_loss: 0.0387, label: 2, bag_size: 614
batch 579, loss: 0.0029, instance_loss: 0.1864, weighted_loss: 0.0579, label: 1, bag_size: 3755
batch 599, loss: 0.4669, instance_loss: 0.6699, weighted_loss: 0.5278, label: 2, bag_size: 5072
batch 619, loss: 0.4911, instance_loss: 0.7018, weighted_loss: 0.5543, label: 1, bag_size: 1854
batch 639, loss: 0.2325, instance_loss: 0.7061, weighted_loss: 0.3746, label: 1, bag_size: 8482
batch 659, loss: 0.0404, instance_loss: 0.4071, weighted_loss: 0.1504, label: 1, bag_size: 1027
batch 679, loss: 0.2441, instance_loss: 0.6466, weighted_loss: 0.3648, label: 1, bag_size: 3761
batch 699, loss: 3.9349, instance_loss: 1.5267, weighted_loss: 3.2125, label: 1, bag_size: 3159
batch 719, loss: 0.0609, instance_loss: 0.1676, weighted_loss: 0.0929, label: 2, bag_size: 2483
batch 739, loss: 0.4937, instance_loss: 0.5283, weighted_loss: 0.5041, label: 0, bag_size: 5890


class 0 clustering acc 0.9701342281879195: correct 17346/17880
class 1 clustering acc 0.3711409395973154: correct 2212/5960
Epoch: 46, train_loss: 0.4625, train_clustering_loss:  0.5401, train_error: 0.1893
class 0: acc 0.8237704918032787, correct 201/244
class 1: acc 0.7379032258064516, correct 183/248
class 2: acc 0.8695652173913043, correct 220/253

Val Set, val_loss: 0.9819, val_error: 0.2766, auc: 0.8425
class 0 clustering acc 0.9831560283687943: correct 2218/2256
class 1 clustering acc 0.21409574468085107: correct 161/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0704, instance_loss: 0.2595, weighted_loss: 0.1271, label: 2, bag_size: 4555
batch 39, loss: 0.6686, instance_loss: 0.7802, weighted_loss: 0.7021, label: 0, bag_size: 3070
batch 59, loss: 2.7459, instance_loss: 1.1976, weighted_loss: 2.2814, label: 0, bag_size: 1025
batch 79, loss: 0.4021, instance_loss: 0.5635, weighted_loss: 0.4505, label: 0, bag_size: 3690
batch 99, loss: 0.0427, instance_loss: 0.2259, weighted_loss: 0.0977, label: 0, bag_size: 5570
batch 119, loss: 0.7552, instance_loss: 0.6782, weighted_loss: 0.7321, label: 1, bag_size: 1250
batch 139, loss: 0.1478, instance_loss: 0.5332, weighted_loss: 0.2634, label: 0, bag_size: 4531
batch 159, loss: 3.0677, instance_loss: 1.3194, weighted_loss: 2.5432, label: 0, bag_size: 4032
batch 179, loss: 0.3547, instance_loss: 0.2691, weighted_loss: 0.3290, label: 0, bag_size: 7595
batch 199, loss: 0.0441, instance_loss: 0.1310, weighted_loss: 0.0702, label: 2, bag_size: 1094
batch 219, loss: 0.0265, instance_loss: 0.1627, weighted_loss: 0.0674, label: 2, bag_size: 4569
batch 239, loss: 0.0106, instance_loss: 0.1171, weighted_loss: 0.0425, label: 0, bag_size: 2290
batch 259, loss: 0.0095, instance_loss: 0.1595, weighted_loss: 0.0545, label: 2, bag_size: 3678
batch 279, loss: 0.0076, instance_loss: 0.9664, weighted_loss: 0.2953, label: 0, bag_size: 4403
batch 299, loss: 0.6955, instance_loss: 0.7204, weighted_loss: 0.7030, label: 1, bag_size: 2481
batch 319, loss: 0.1110, instance_loss: 0.9590, weighted_loss: 0.3654, label: 1, bag_size: 6513
batch 339, loss: 0.3793, instance_loss: 1.0725, weighted_loss: 0.5872, label: 2, bag_size: 728
batch 359, loss: 0.4893, instance_loss: 0.5565, weighted_loss: 0.5094, label: 1, bag_size: 1607
batch 379, loss: 0.0133, instance_loss: 0.6097, weighted_loss: 0.1922, label: 1, bag_size: 6475
batch 399, loss: 0.0014, instance_loss: 0.4440, weighted_loss: 0.1342, label: 1, bag_size: 3755
batch 419, loss: 0.6339, instance_loss: 0.7449, weighted_loss: 0.6672, label: 0, bag_size: 4562
batch 439, loss: 0.0307, instance_loss: 0.2529, weighted_loss: 0.0973, label: 0, bag_size: 2094
batch 459, loss: 0.4734, instance_loss: 0.7604, weighted_loss: 0.5595, label: 2, bag_size: 361
batch 479, loss: 0.6812, instance_loss: 0.6191, weighted_loss: 0.6626, label: 1, bag_size: 14449
batch 499, loss: 0.0488, instance_loss: 0.4836, weighted_loss: 0.1792, label: 0, bag_size: 1883
batch 519, loss: 0.9398, instance_loss: 1.5579, weighted_loss: 1.1252, label: 1, bag_size: 7176
batch 539, loss: 0.0014, instance_loss: 0.3314, weighted_loss: 0.1004, label: 1, bag_size: 3338
batch 559, loss: 2.0353, instance_loss: 1.0367, weighted_loss: 1.7357, label: 1, bag_size: 3399
batch 579, loss: 0.4024, instance_loss: 0.3934, weighted_loss: 0.3997, label: 0, bag_size: 5893
batch 599, loss: 0.1116, instance_loss: 0.2491, weighted_loss: 0.1528, label: 0, bag_size: 5260
batch 619, loss: 0.2568, instance_loss: 0.4718, weighted_loss: 0.3213, label: 1, bag_size: 3534
batch 639, loss: 0.1440, instance_loss: 0.4749, weighted_loss: 0.2433, label: 2, bag_size: 5072
batch 659, loss: 0.3774, instance_loss: 0.6696, weighted_loss: 0.4651, label: 0, bag_size: 3397
batch 679, loss: 0.2941, instance_loss: 0.4826, weighted_loss: 0.3507, label: 2, bag_size: 5924
batch 699, loss: 1.5982, instance_loss: 1.0676, weighted_loss: 1.4390, label: 0, bag_size: 11141
batch 719, loss: 1.6395, instance_loss: 0.6617, weighted_loss: 1.3462, label: 1, bag_size: 6993
batch 739, loss: 0.0321, instance_loss: 0.1173, weighted_loss: 0.0577, label: 2, bag_size: 4856


class 0 clustering acc 0.9707494407158836: correct 17357/17880
class 1 clustering acc 0.3699664429530201: correct 2205/5960
Epoch: 47, train_loss: 0.4756, train_clustering_loss:  0.5378, train_error: 0.1946
class 0: acc 0.8587360594795539, correct 231/269
class 1: acc 0.6877637130801688, correct 163/237
class 2: acc 0.8619246861924686, correct 206/239

Val Set, val_loss: 1.2131, val_error: 0.2766, auc: 0.8233
class 0 clustering acc 0.9543439716312057: correct 2153/2256
class 1 clustering acc 0.3523936170212766: correct 265/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0212, instance_loss: 0.0713, weighted_loss: 0.0362, label: 2, bag_size: 2313
batch 39, loss: 0.0932, instance_loss: 0.5200, weighted_loss: 0.2213, label: 1, bag_size: 5003
batch 59, loss: 0.0055, instance_loss: 0.1335, weighted_loss: 0.0439, label: 1, bag_size: 1836
batch 79, loss: 0.0426, instance_loss: 0.2699, weighted_loss: 0.1108, label: 1, bag_size: 796
batch 99, loss: 0.0005, instance_loss: 0.4560, weighted_loss: 0.1372, label: 0, bag_size: 4403
batch 119, loss: 0.0039, instance_loss: 0.9238, weighted_loss: 0.2799, label: 0, bag_size: 4178
batch 139, loss: 0.2451, instance_loss: 0.3763, weighted_loss: 0.2845, label: 0, bag_size: 4131
batch 159, loss: 0.2449, instance_loss: 0.4044, weighted_loss: 0.2927, label: 0, bag_size: 2392
batch 179, loss: 0.0493, instance_loss: 0.0808, weighted_loss: 0.0587, label: 2, bag_size: 4788
batch 199, loss: 0.2362, instance_loss: 0.3213, weighted_loss: 0.2618, label: 2, bag_size: 4223
batch 219, loss: 0.0002, instance_loss: 1.0985, weighted_loss: 0.3297, label: 0, bag_size: 2618
batch 239, loss: 0.0250, instance_loss: 0.2793, weighted_loss: 0.1013, label: 0, bag_size: 6015
batch 259, loss: 0.0942, instance_loss: 0.4429, weighted_loss: 0.1988, label: 2, bag_size: 4978
batch 279, loss: 0.0677, instance_loss: 0.1577, weighted_loss: 0.0947, label: 2, bag_size: 1103
batch 299, loss: 0.0987, instance_loss: 0.5331, weighted_loss: 0.2290, label: 1, bag_size: 4940
batch 319, loss: 0.0004, instance_loss: 0.0976, weighted_loss: 0.0296, label: 1, bag_size: 3983
batch 339, loss: 0.0092, instance_loss: 0.1303, weighted_loss: 0.0455, label: 0, bag_size: 2791
batch 359, loss: 1.3037, instance_loss: 0.6064, weighted_loss: 1.0945, label: 0, bag_size: 1762
batch 379, loss: 1.2627, instance_loss: 0.8914, weighted_loss: 1.1513, label: 0, bag_size: 3070
batch 399, loss: 0.2535, instance_loss: 0.3896, weighted_loss: 0.2944, label: 1, bag_size: 4812
batch 419, loss: 0.0173, instance_loss: 0.3862, weighted_loss: 0.1280, label: 0, bag_size: 6015
batch 439, loss: 1.5041, instance_loss: 0.9377, weighted_loss: 1.3342, label: 1, bag_size: 8632
batch 459, loss: 0.3152, instance_loss: 0.3015, weighted_loss: 0.3111, label: 0, bag_size: 5437
batch 479, loss: 0.0145, instance_loss: 0.1182, weighted_loss: 0.0456, label: 2, bag_size: 6273
batch 499, loss: 3.2706, instance_loss: 1.2506, weighted_loss: 2.6646, label: 2, bag_size: 4316
batch 519, loss: 0.7393, instance_loss: 0.8020, weighted_loss: 0.7581, label: 2, bag_size: 1513
batch 539, loss: 1.1419, instance_loss: 0.8979, weighted_loss: 1.0687, label: 1, bag_size: 1558
batch 559, loss: 0.0009, instance_loss: 0.4993, weighted_loss: 0.1504, label: 1, bag_size: 4534
batch 579, loss: 0.0177, instance_loss: 0.0471, weighted_loss: 0.0266, label: 2, bag_size: 1094
batch 599, loss: 0.2929, instance_loss: 0.5838, weighted_loss: 0.3802, label: 2, bag_size: 2813
batch 619, loss: 1.0573, instance_loss: 0.5877, weighted_loss: 0.9165, label: 1, bag_size: 2945
batch 639, loss: 0.0084, instance_loss: 0.0574, weighted_loss: 0.0231, label: 2, bag_size: 4856
batch 659, loss: 0.3252, instance_loss: 0.5849, weighted_loss: 0.4031, label: 1, bag_size: 3109
batch 679, loss: 0.0489, instance_loss: 0.5212, weighted_loss: 0.1906, label: 1, bag_size: 3357
batch 699, loss: 0.0200, instance_loss: 0.4536, weighted_loss: 0.1501, label: 1, bag_size: 3357
batch 719, loss: 0.5021, instance_loss: 0.2958, weighted_loss: 0.4402, label: 2, bag_size: 597
batch 739, loss: 0.9341, instance_loss: 0.8801, weighted_loss: 0.9179, label: 1, bag_size: 667


class 0 clustering acc 0.9720357941834452: correct 17380/17880
class 1 clustering acc 0.388255033557047: correct 2314/5960
Epoch: 48, train_loss: 0.4642, train_clustering_loss:  0.5212, train_error: 0.2027
class 0: acc 0.8171206225680934, correct 210/257
class 1: acc 0.726530612244898, correct 178/245
class 2: acc 0.8477366255144033, correct 206/243

Val Set, val_loss: 0.9758, val_error: 0.2447, auc: 0.8561
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.2553191489361702: correct 192/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0281, instance_loss: 0.1049, weighted_loss: 0.0512, label: 2, bag_size: 2313
batch 39, loss: 0.5438, instance_loss: 0.5411, weighted_loss: 0.5430, label: 0, bag_size: 2610
batch 59, loss: 0.4494, instance_loss: 0.8851, weighted_loss: 0.5801, label: 2, bag_size: 1543
batch 79, loss: 0.0629, instance_loss: 0.3839, weighted_loss: 0.1592, label: 2, bag_size: 3210
batch 99, loss: 0.0845, instance_loss: 0.1851, weighted_loss: 0.1147, label: 2, bag_size: 5914
batch 119, loss: 0.0094, instance_loss: 0.5102, weighted_loss: 0.1596, label: 1, bag_size: 5084
batch 139, loss: 0.0157, instance_loss: 0.1249, weighted_loss: 0.0485, label: 1, bag_size: 3983
batch 159, loss: 0.6009, instance_loss: 0.5698, weighted_loss: 0.5916, label: 0, bag_size: 2601
batch 179, loss: 0.2690, instance_loss: 0.5476, weighted_loss: 0.3526, label: 1, bag_size: 2747
batch 199, loss: 0.4930, instance_loss: 0.5132, weighted_loss: 0.4990, label: 2, bag_size: 909
batch 219, loss: 0.0241, instance_loss: 0.5796, weighted_loss: 0.1907, label: 1, bag_size: 3475
batch 239, loss: 0.0368, instance_loss: 0.3065, weighted_loss: 0.1177, label: 2, bag_size: 4141
batch 259, loss: 0.0470, instance_loss: 0.2439, weighted_loss: 0.1061, label: 0, bag_size: 2290
batch 279, loss: 0.1087, instance_loss: 0.5695, weighted_loss: 0.2470, label: 0, bag_size: 477
batch 299, loss: 0.0949, instance_loss: 0.5621, weighted_loss: 0.2351, label: 2, bag_size: 3112
batch 319, loss: 2.1369, instance_loss: 1.2381, weighted_loss: 1.8672, label: 2, bag_size: 4241
batch 339, loss: 0.1755, instance_loss: 0.4915, weighted_loss: 0.2703, label: 1, bag_size: 4184
batch 359, loss: 0.1276, instance_loss: 0.3476, weighted_loss: 0.1936, label: 0, bag_size: 4165
batch 379, loss: 1.2507, instance_loss: 0.6624, weighted_loss: 1.0742, label: 1, bag_size: 578
batch 399, loss: 0.0492, instance_loss: 0.1030, weighted_loss: 0.0653, label: 2, bag_size: 4088
batch 419, loss: 0.5184, instance_loss: 0.2995, weighted_loss: 0.4527, label: 2, bag_size: 3534
batch 439, loss: 0.0144, instance_loss: 0.7666, weighted_loss: 0.2401, label: 1, bag_size: 3611
batch 459, loss: 0.3280, instance_loss: 0.5204, weighted_loss: 0.3857, label: 1, bag_size: 3396
batch 479, loss: 0.0216, instance_loss: 0.1067, weighted_loss: 0.0472, label: 2, bag_size: 2254
batch 499, loss: 0.2025, instance_loss: 0.6449, weighted_loss: 0.3352, label: 0, bag_size: 4146
batch 519, loss: 0.1648, instance_loss: 0.3450, weighted_loss: 0.2189, label: 2, bag_size: 5924
batch 539, loss: 0.0004, instance_loss: 0.5741, weighted_loss: 0.1725, label: 1, bag_size: 6277
batch 559, loss: 0.0315, instance_loss: 0.8143, weighted_loss: 0.2663, label: 1, bag_size: 6315
batch 579, loss: 0.6659, instance_loss: 0.6522, weighted_loss: 0.6618, label: 2, bag_size: 2049
batch 599, loss: 0.0035, instance_loss: 0.4305, weighted_loss: 0.1316, label: 0, bag_size: 4337
batch 619, loss: 0.0444, instance_loss: 0.3633, weighted_loss: 0.1400, label: 2, bag_size: 3497
batch 639, loss: 0.1612, instance_loss: 0.7002, weighted_loss: 0.3229, label: 0, bag_size: 1353
batch 659, loss: 0.1119, instance_loss: 0.4146, weighted_loss: 0.2027, label: 1, bag_size: 1029
batch 679, loss: 0.4367, instance_loss: 0.6258, weighted_loss: 0.4934, label: 0, bag_size: 768
batch 699, loss: 0.0442, instance_loss: 0.0603, weighted_loss: 0.0490, label: 2, bag_size: 2483
batch 719, loss: 0.0335, instance_loss: 0.0555, weighted_loss: 0.0401, label: 2, bag_size: 3415
batch 739, loss: 0.0832, instance_loss: 0.4034, weighted_loss: 0.1793, label: 0, bag_size: 4531


class 0 clustering acc 0.971923937360179: correct 17378/17880
class 1 clustering acc 0.3651006711409396: correct 2176/5960
Epoch: 49, train_loss: 0.4465, train_clustering_loss:  0.5327, train_error: 0.1691
class 0: acc 0.842741935483871, correct 209/248
class 1: acc 0.7739463601532567, correct 202/261
class 2: acc 0.8813559322033898, correct 208/236

Val Set, val_loss: 0.8096, val_error: 0.2660, auc: 0.8699
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.21941489361702127: correct 165/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6870, instance_loss: 0.7339, weighted_loss: 0.7011, label: 2, bag_size: 5072
batch 39, loss: 0.0195, instance_loss: 0.4073, weighted_loss: 0.1359, label: 0, bag_size: 5039
batch 59, loss: 0.0253, instance_loss: 0.2604, weighted_loss: 0.0958, label: 0, bag_size: 4857
batch 79, loss: 0.0276, instance_loss: 0.2918, weighted_loss: 0.1069, label: 0, bag_size: 1194
batch 99, loss: 0.0349, instance_loss: 0.0972, weighted_loss: 0.0536, label: 2, bag_size: 2313
batch 119, loss: 0.8387, instance_loss: 0.6609, weighted_loss: 0.7853, label: 0, bag_size: 14791
batch 139, loss: 0.0800, instance_loss: 0.2589, weighted_loss: 0.1337, label: 2, bag_size: 4555
batch 159, loss: 0.1754, instance_loss: 0.2404, weighted_loss: 0.1949, label: 2, bag_size: 3210
batch 179, loss: 0.3453, instance_loss: 0.7262, weighted_loss: 0.4596, label: 1, bag_size: 8632
batch 199, loss: 1.7590, instance_loss: 1.1455, weighted_loss: 1.5749, label: 1, bag_size: 5880
batch 219, loss: 0.3846, instance_loss: 0.5757, weighted_loss: 0.4419, label: 2, bag_size: 3299
batch 239, loss: 0.0071, instance_loss: 0.3257, weighted_loss: 0.1027, label: 2, bag_size: 6001
batch 259, loss: 0.0483, instance_loss: 0.8939, weighted_loss: 0.3020, label: 0, bag_size: 3743
batch 279, loss: 3.0366, instance_loss: 1.3845, weighted_loss: 2.5410, label: 0, bag_size: 1341
batch 299, loss: 1.2175, instance_loss: 1.0784, weighted_loss: 1.1757, label: 1, bag_size: 1250
batch 319, loss: 0.9552, instance_loss: 0.7410, weighted_loss: 0.8909, label: 1, bag_size: 3604
batch 339, loss: 4.4603, instance_loss: 1.4693, weighted_loss: 3.5630, label: 0, bag_size: 2392
batch 359, loss: 0.6061, instance_loss: 0.6591, weighted_loss: 0.6220, label: 0, bag_size: 3061
batch 379, loss: 1.2362, instance_loss: 0.6735, weighted_loss: 1.0674, label: 2, bag_size: 3534
batch 399, loss: 0.0144, instance_loss: 0.0850, weighted_loss: 0.0356, label: 2, bag_size: 2313
batch 419, loss: 0.2991, instance_loss: 0.8875, weighted_loss: 0.4756, label: 2, bag_size: 4910
batch 439, loss: 0.2183, instance_loss: 0.5846, weighted_loss: 0.3282, label: 0, bag_size: 4378
batch 459, loss: 0.7261, instance_loss: 0.7516, weighted_loss: 0.7337, label: 1, bag_size: 4200
batch 479, loss: 0.0851, instance_loss: 0.2429, weighted_loss: 0.1325, label: 2, bag_size: 2997
batch 499, loss: 0.0642, instance_loss: 0.3504, weighted_loss: 0.1501, label: 2, bag_size: 4203
batch 519, loss: 0.2367, instance_loss: 0.2958, weighted_loss: 0.2544, label: 2, bag_size: 1103
batch 539, loss: 0.1571, instance_loss: 0.9591, weighted_loss: 0.3977, label: 0, bag_size: 5837
batch 559, loss: 0.1897, instance_loss: 0.5431, weighted_loss: 0.2957, label: 0, bag_size: 609
batch 579, loss: 0.4084, instance_loss: 0.7874, weighted_loss: 0.5221, label: 1, bag_size: 2342
batch 599, loss: 0.0055, instance_loss: 0.2828, weighted_loss: 0.0887, label: 0, bag_size: 4405
batch 619, loss: 1.5922, instance_loss: 0.8411, weighted_loss: 1.3669, label: 1, bag_size: 4612
batch 639, loss: 0.0145, instance_loss: 0.2977, weighted_loss: 0.0995, label: 1, bag_size: 2254
batch 659, loss: 3.9977, instance_loss: 1.4579, weighted_loss: 3.2358, label: 0, bag_size: 1886
batch 679, loss: 0.0243, instance_loss: 0.2418, weighted_loss: 0.0896, label: 1, bag_size: 425
batch 699, loss: 0.0265, instance_loss: 0.2734, weighted_loss: 0.1006, label: 1, bag_size: 3357
batch 719, loss: 0.0172, instance_loss: 0.4275, weighted_loss: 0.1403, label: 0, bag_size: 4379
batch 739, loss: 0.3342, instance_loss: 0.5729, weighted_loss: 0.4058, label: 1, bag_size: 4069


class 0 clustering acc 0.9691834451901566: correct 17329/17880
class 1 clustering acc 0.3384228187919463: correct 2017/5960
Epoch: 50, train_loss: 0.4713, train_clustering_loss:  0.5554, train_error: 0.1933
class 0: acc 0.8067226890756303, correct 192/238
class 1: acc 0.7463235294117647, correct 203/272
class 2: acc 0.8765957446808511, correct 206/235

Val Set, val_loss: 0.8363, val_error: 0.2660, auc: 0.8550
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.2526595744680851: correct 190/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.5073, instance_loss: 0.5631, weighted_loss: 0.5241, label: 1, bag_size: 2751
batch 39, loss: 0.0702, instance_loss: 0.2978, weighted_loss: 0.1385, label: 0, bag_size: 6971
batch 59, loss: 0.2759, instance_loss: 0.4613, weighted_loss: 0.3315, label: 2, bag_size: 6594
batch 79, loss: 0.4952, instance_loss: 0.6230, weighted_loss: 0.5335, label: 1, bag_size: 2747
batch 99, loss: 0.1323, instance_loss: 0.5244, weighted_loss: 0.2499, label: 1, bag_size: 2122
batch 119, loss: 0.6587, instance_loss: 0.7815, weighted_loss: 0.6955, label: 1, bag_size: 4940
batch 139, loss: 0.2267, instance_loss: 0.3926, weighted_loss: 0.2765, label: 0, bag_size: 622
batch 159, loss: 0.0114, instance_loss: 0.3022, weighted_loss: 0.0986, label: 1, bag_size: 1836
batch 179, loss: 0.3570, instance_loss: 0.4515, weighted_loss: 0.3853, label: 0, bag_size: 6015
batch 199, loss: 0.7099, instance_loss: 0.5459, weighted_loss: 0.6607, label: 0, bag_size: 4827
batch 219, loss: 0.1676, instance_loss: 0.4337, weighted_loss: 0.2475, label: 0, bag_size: 6927
batch 239, loss: 0.0403, instance_loss: 0.2952, weighted_loss: 0.1168, label: 0, bag_size: 598
batch 259, loss: 0.0231, instance_loss: 0.0772, weighted_loss: 0.0393, label: 0, bag_size: 3741
batch 279, loss: 0.1231, instance_loss: 0.1747, weighted_loss: 0.1386, label: 2, bag_size: 2254
batch 299, loss: 0.2154, instance_loss: 0.5539, weighted_loss: 0.3169, label: 1, bag_size: 3885
batch 319, loss: 1.0073, instance_loss: 0.2176, weighted_loss: 0.7704, label: 2, bag_size: 4056
batch 339, loss: 0.0004, instance_loss: 0.0196, weighted_loss: 0.0062, label: 0, bag_size: 1825
batch 359, loss: 0.0121, instance_loss: 0.1964, weighted_loss: 0.0674, label: 1, bag_size: 862
batch 379, loss: 0.0361, instance_loss: 0.2695, weighted_loss: 0.1061, label: 2, bag_size: 6148
batch 399, loss: 0.0021, instance_loss: 0.4229, weighted_loss: 0.1283, label: 1, bag_size: 1542
batch 419, loss: 0.0322, instance_loss: 0.1063, weighted_loss: 0.0545, label: 2, bag_size: 1094
batch 439, loss: 0.0025, instance_loss: 0.6991, weighted_loss: 0.2115, label: 0, bag_size: 1904
batch 459, loss: 0.0010, instance_loss: 0.4372, weighted_loss: 0.1319, label: 2, bag_size: 657
batch 479, loss: 0.6242, instance_loss: 0.8577, weighted_loss: 0.6943, label: 1, bag_size: 1712
batch 499, loss: 0.0006, instance_loss: 0.1131, weighted_loss: 0.0343, label: 0, bag_size: 5902
batch 519, loss: 0.1106, instance_loss: 0.5721, weighted_loss: 0.2491, label: 1, bag_size: 5003
batch 539, loss: 0.2506, instance_loss: 0.2251, weighted_loss: 0.2430, label: 0, bag_size: 4325
batch 559, loss: 0.1380, instance_loss: 0.5554, weighted_loss: 0.2632, label: 0, bag_size: 1883
batch 579, loss: 0.0537, instance_loss: 0.4379, weighted_loss: 0.1689, label: 1, bag_size: 700
batch 599, loss: 0.0404, instance_loss: 0.4074, weighted_loss: 0.1505, label: 0, bag_size: 4165
batch 619, loss: 2.1993, instance_loss: 1.1493, weighted_loss: 1.8843, label: 0, bag_size: 3156
batch 639, loss: 1.9465, instance_loss: 0.7223, weighted_loss: 1.5792, label: 2, bag_size: 3274
batch 659, loss: 0.9570, instance_loss: 0.8308, weighted_loss: 0.9191, label: 1, bag_size: 4395
batch 679, loss: 0.6519, instance_loss: 0.7963, weighted_loss: 0.6952, label: 2, bag_size: 22464
batch 699, loss: 0.1315, instance_loss: 0.3056, weighted_loss: 0.1837, label: 0, bag_size: 3268
batch 719, loss: 0.0620, instance_loss: 0.2600, weighted_loss: 0.1214, label: 2, bag_size: 5017
batch 739, loss: 0.0709, instance_loss: 0.5205, weighted_loss: 0.2058, label: 1, bag_size: 6992


class 0 clustering acc 0.9686241610738255: correct 17319/17880
class 1 clustering acc 0.3716442953020134: correct 2215/5960
Epoch: 51, train_loss: 0.4606, train_clustering_loss:  0.5413, train_error: 0.1973
class 0: acc 0.8054474708171206, correct 207/257
class 1: acc 0.7215189873417721, correct 171/237
class 2: acc 0.8764940239043825, correct 220/251

Val Set, val_loss: 1.1151, val_error: 0.3511, auc: 0.8317
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.28856382978723405: correct 217/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 21 out of 20
Early stopping
Val error: 0.2979, ROC AUC: 0.8889
Test error: 0.2553, ROC AUC: 0.8345
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5833333333333334, correct 7/12

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.2473, instance_loss: 0.6894, weighted_loss: 0.3799, label: 1, bag_size: 3396
batch 39, loss: 1.2107, instance_loss: 0.8100, weighted_loss: 1.0905, label: 0, bag_size: 1485
batch 59, loss: 0.5495, instance_loss: 0.7424, weighted_loss: 0.6073, label: 2, bag_size: 3327
batch 79, loss: 1.3785, instance_loss: 0.7924, weighted_loss: 1.2027, label: 2, bag_size: 5406
batch 99, loss: 2.3558, instance_loss: 0.7902, weighted_loss: 1.8861, label: 1, bag_size: 817
batch 119, loss: 1.6761, instance_loss: 0.6404, weighted_loss: 1.3654, label: 0, bag_size: 4734
batch 139, loss: 1.2624, instance_loss: 0.8099, weighted_loss: 1.1267, label: 1, bag_size: 832
batch 159, loss: 1.1840, instance_loss: 0.8249, weighted_loss: 1.0763, label: 0, bag_size: 1601
batch 179, loss: 1.4233, instance_loss: 0.7463, weighted_loss: 1.2202, label: 0, bag_size: 5992
batch 199, loss: 0.7891, instance_loss: 0.6643, weighted_loss: 0.7516, label: 2, bag_size: 3327
batch 219, loss: 1.2058, instance_loss: 0.8147, weighted_loss: 1.0885, label: 2, bag_size: 361
batch 239, loss: 1.7260, instance_loss: 0.8853, weighted_loss: 1.4737, label: 0, bag_size: 614
batch 259, loss: 0.8335, instance_loss: 0.6594, weighted_loss: 0.7813, label: 2, bag_size: 6001
batch 279, loss: 0.4558, instance_loss: 0.5266, weighted_loss: 0.4770, label: 2, bag_size: 2254
batch 299, loss: 0.8653, instance_loss: 0.6950, weighted_loss: 0.8142, label: 0, bag_size: 1933
batch 319, loss: 0.8372, instance_loss: 0.7618, weighted_loss: 0.8146, label: 2, bag_size: 4140
batch 339, loss: 2.0771, instance_loss: 1.1095, weighted_loss: 1.7868, label: 1, bag_size: 1854
batch 359, loss: 0.4107, instance_loss: 0.7342, weighted_loss: 0.5078, label: 1, bag_size: 3357
batch 379, loss: 1.0236, instance_loss: 0.7654, weighted_loss: 0.9461, label: 0, bag_size: 6630
batch 399, loss: 0.8544, instance_loss: 0.5487, weighted_loss: 0.7627, label: 1, bag_size: 2614
batch 419, loss: 1.0940, instance_loss: 0.8330, weighted_loss: 1.0157, label: 2, bag_size: 3112
batch 439, loss: 0.3044, instance_loss: 0.6005, weighted_loss: 0.3933, label: 2, bag_size: 6026
batch 459, loss: 0.5676, instance_loss: 0.7365, weighted_loss: 0.6183, label: 2, bag_size: 2561
batch 479, loss: 0.7949, instance_loss: 0.7258, weighted_loss: 0.7742, label: 0, bag_size: 5036
batch 499, loss: 1.5954, instance_loss: 0.8142, weighted_loss: 1.3611, label: 1, bag_size: 14449
batch 519, loss: 0.6306, instance_loss: 0.5161, weighted_loss: 0.5963, label: 0, bag_size: 5041
batch 539, loss: 1.2929, instance_loss: 0.6672, weighted_loss: 1.1052, label: 0, bag_size: 4015
batch 559, loss: 1.0575, instance_loss: 0.6969, weighted_loss: 0.9493, label: 1, bag_size: 3221
batch 579, loss: 0.7547, instance_loss: 0.6928, weighted_loss: 0.7361, label: 0, bag_size: 5848
batch 599, loss: 0.4644, instance_loss: 0.4862, weighted_loss: 0.4709, label: 0, bag_size: 1174
batch 619, loss: 1.0521, instance_loss: 0.7876, weighted_loss: 0.9727, label: 0, bag_size: 877
batch 639, loss: 0.6450, instance_loss: 0.6603, weighted_loss: 0.6496, label: 1, bag_size: 3126
batch 659, loss: 1.0207, instance_loss: 0.6583, weighted_loss: 0.9120, label: 0, bag_size: 3191
batch 679, loss: 0.4377, instance_loss: 0.6656, weighted_loss: 0.5061, label: 2, bag_size: 3618
batch 699, loss: 1.7846, instance_loss: 0.6784, weighted_loss: 1.4528, label: 2, bag_size: 223
batch 719, loss: 0.6163, instance_loss: 1.0010, weighted_loss: 0.7317, label: 1, bag_size: 8482
batch 739, loss: 0.8964, instance_loss: 0.6879, weighted_loss: 0.8339, label: 0, bag_size: 4547


class 0 clustering acc 0.9983221476510067: correct 17850/17880
class 1 clustering acc 0.002348993288590604: correct 14/5960
Epoch: 0, train_loss: 1.0294, train_clustering_loss:  0.7293, train_error: 0.4872
class 0: acc 0.5118110236220472, correct 130/254
class 1: acc 0.4279835390946502, correct 104/243
class 2: acc 0.5967741935483871, correct 148/248

Val Set, val_loss: 0.7986, val_error: 0.3298, auc: 0.8221
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.3333333333333333, correct 4/12
Validation loss decreased (inf --> 0.798617).  Saving model ...


batch 19, loss: 1.1088, instance_loss: 0.8326, weighted_loss: 1.0259, label: 2, bag_size: 6298
batch 39, loss: 0.5500, instance_loss: 0.5735, weighted_loss: 0.5570, label: 2, bag_size: 5426
batch 59, loss: 0.5305, instance_loss: 0.5417, weighted_loss: 0.5339, label: 1, bag_size: 4595
batch 79, loss: 0.5897, instance_loss: 0.6565, weighted_loss: 0.6097, label: 0, bag_size: 1018
batch 99, loss: 0.4347, instance_loss: 0.5847, weighted_loss: 0.4797, label: 0, bag_size: 1485
batch 119, loss: 0.7808, instance_loss: 0.7082, weighted_loss: 0.7590, label: 1, bag_size: 1410
batch 139, loss: 1.0956, instance_loss: 0.8915, weighted_loss: 1.0344, label: 2, bag_size: 3604
batch 159, loss: 0.4796, instance_loss: 0.6471, weighted_loss: 0.5298, label: 0, bag_size: 1762
batch 179, loss: 1.1628, instance_loss: 0.7192, weighted_loss: 1.0298, label: 1, bag_size: 475
batch 199, loss: 0.1308, instance_loss: 0.4396, weighted_loss: 0.2234, label: 2, bag_size: 5037
batch 219, loss: 1.0424, instance_loss: 0.6869, weighted_loss: 0.9357, label: 1, bag_size: 3991
batch 239, loss: 1.2387, instance_loss: 0.8805, weighted_loss: 1.1312, label: 2, bag_size: 3746
batch 259, loss: 1.1594, instance_loss: 0.6795, weighted_loss: 1.0154, label: 1, bag_size: 1608
batch 279, loss: 0.2648, instance_loss: 0.4720, weighted_loss: 0.3270, label: 1, bag_size: 6315
batch 299, loss: 1.1387, instance_loss: 0.8191, weighted_loss: 1.0428, label: 0, bag_size: 2378
batch 319, loss: 0.5956, instance_loss: 0.6266, weighted_loss: 0.6049, label: 0, bag_size: 3924
batch 339, loss: 3.2566, instance_loss: 1.0476, weighted_loss: 2.5939, label: 2, bag_size: 361
batch 359, loss: 1.6798, instance_loss: 1.0047, weighted_loss: 1.4773, label: 2, bag_size: 4179
batch 379, loss: 1.0271, instance_loss: 0.6635, weighted_loss: 0.9180, label: 0, bag_size: 4228
batch 399, loss: 1.2132, instance_loss: 0.7412, weighted_loss: 1.0716, label: 2, bag_size: 4342
batch 419, loss: 0.3711, instance_loss: 0.5544, weighted_loss: 0.4261, label: 2, bag_size: 5924
batch 439, loss: 0.7642, instance_loss: 0.6747, weighted_loss: 0.7374, label: 2, bag_size: 4088
batch 459, loss: 0.2529, instance_loss: 0.4163, weighted_loss: 0.3019, label: 1, bag_size: 6277
batch 479, loss: 1.3177, instance_loss: 0.7571, weighted_loss: 1.1495, label: 1, bag_size: 3508
batch 499, loss: 0.2144, instance_loss: 0.5575, weighted_loss: 0.3173, label: 2, bag_size: 4487
batch 519, loss: 0.3915, instance_loss: 0.5328, weighted_loss: 0.4339, label: 2, bag_size: 4056
batch 539, loss: 0.6076, instance_loss: 0.7807, weighted_loss: 0.6595, label: 2, bag_size: 3607
batch 559, loss: 0.1641, instance_loss: 0.4634, weighted_loss: 0.2539, label: 0, bag_size: 4405
batch 579, loss: 1.6385, instance_loss: 0.4843, weighted_loss: 1.2922, label: 0, bag_size: 12971
batch 599, loss: 1.9730, instance_loss: 0.6474, weighted_loss: 1.5753, label: 0, bag_size: 20234
batch 619, loss: 1.0910, instance_loss: 0.8009, weighted_loss: 1.0040, label: 1, bag_size: 1860
batch 639, loss: 0.4276, instance_loss: 0.5199, weighted_loss: 0.4553, label: 1, bag_size: 368
batch 659, loss: 0.5808, instance_loss: 0.7408, weighted_loss: 0.6288, label: 2, bag_size: 5037
batch 679, loss: 0.6444, instance_loss: 0.5600, weighted_loss: 0.6191, label: 0, bag_size: 4531
batch 699, loss: 0.3189, instance_loss: 0.5403, weighted_loss: 0.3853, label: 2, bag_size: 4856
batch 719, loss: 0.5735, instance_loss: 0.6803, weighted_loss: 0.6055, label: 1, bag_size: 2092
batch 739, loss: 2.4544, instance_loss: 1.1774, weighted_loss: 2.0713, label: 1, bag_size: 1549


class 0 clustering acc 0.998993288590604: correct 17862/17880
class 1 clustering acc 0.004530201342281879: correct 27/5960
Epoch: 1, train_loss: 0.9000, train_clustering_loss:  0.6867, train_error: 0.4054
class 0: acc 0.5975609756097561, correct 147/246
class 1: acc 0.5280898876404494, correct 141/267
class 2: acc 0.6681034482758621, correct 155/232

Val Set, val_loss: 1.1291, val_error: 0.5745, auc: 0.8303
class 0 clustering acc 0.9986702127659575: correct 2253/2256
class 1 clustering acc 0.027925531914893616: correct 21/752
class 0: acc 0.3076923076923077, correct 16/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3599, instance_loss: 0.7312, weighted_loss: 1.1713, label: 2, bag_size: 724
batch 39, loss: 0.6941, instance_loss: 0.6639, weighted_loss: 0.6850, label: 0, bag_size: 5992
batch 59, loss: 1.4169, instance_loss: 0.7443, weighted_loss: 1.2151, label: 2, bag_size: 909
batch 79, loss: 0.3255, instance_loss: 0.5065, weighted_loss: 0.3798, label: 1, bag_size: 800
batch 99, loss: 1.2365, instance_loss: 0.9026, weighted_loss: 1.1363, label: 2, bag_size: 4342
batch 119, loss: 2.5827, instance_loss: 1.1041, weighted_loss: 2.1391, label: 0, bag_size: 14432
batch 139, loss: 1.3977, instance_loss: 0.9159, weighted_loss: 1.2532, label: 2, bag_size: 1222
batch 159, loss: 0.3037, instance_loss: 0.3806, weighted_loss: 0.3268, label: 2, bag_size: 2561
batch 179, loss: 0.8161, instance_loss: 0.5843, weighted_loss: 0.7466, label: 1, bag_size: 5072
batch 199, loss: 0.2711, instance_loss: 0.3284, weighted_loss: 0.2883, label: 2, bag_size: 88
batch 219, loss: 0.2012, instance_loss: 0.4282, weighted_loss: 0.2693, label: 0, bag_size: 1087
batch 239, loss: 0.7530, instance_loss: 0.6992, weighted_loss: 0.7369, label: 1, bag_size: 3755
batch 259, loss: 1.8429, instance_loss: 0.8464, weighted_loss: 1.5440, label: 0, bag_size: 15388
batch 279, loss: 0.7395, instance_loss: 0.6269, weighted_loss: 0.7057, label: 1, bag_size: 2905
batch 299, loss: 1.0840, instance_loss: 0.7194, weighted_loss: 0.9746, label: 1, bag_size: 4187
batch 319, loss: 0.6643, instance_loss: 0.5825, weighted_loss: 0.6397, label: 1, bag_size: 2744
batch 339, loss: 1.0917, instance_loss: 0.6800, weighted_loss: 0.9682, label: 0, bag_size: 2139
batch 359, loss: 0.7226, instance_loss: 0.5159, weighted_loss: 0.6606, label: 1, bag_size: 296
batch 379, loss: 0.6700, instance_loss: 0.6078, weighted_loss: 0.6514, label: 2, bag_size: 597
batch 399, loss: 1.0554, instance_loss: 0.6755, weighted_loss: 0.9415, label: 1, bag_size: 9099
batch 419, loss: 1.1491, instance_loss: 0.7790, weighted_loss: 1.0381, label: 0, bag_size: 4122
batch 439, loss: 1.2070, instance_loss: 0.8189, weighted_loss: 1.0905, label: 2, bag_size: 3604
batch 459, loss: 1.1140, instance_loss: 0.9021, weighted_loss: 1.0504, label: 2, bag_size: 4302
batch 479, loss: 0.4936, instance_loss: 0.5324, weighted_loss: 0.5052, label: 1, bag_size: 4812
batch 499, loss: 1.0053, instance_loss: 0.6029, weighted_loss: 0.8846, label: 0, bag_size: 4831
batch 519, loss: 1.2674, instance_loss: 0.7316, weighted_loss: 1.1067, label: 1, bag_size: 4373
batch 539, loss: 1.5493, instance_loss: 0.8364, weighted_loss: 1.3355, label: 1, bag_size: 1313
batch 559, loss: 0.9888, instance_loss: 0.9305, weighted_loss: 0.9713, label: 2, bag_size: 1222
batch 579, loss: 0.6835, instance_loss: 0.4846, weighted_loss: 0.6238, label: 2, bag_size: 5307
batch 599, loss: 1.3148, instance_loss: 0.7536, weighted_loss: 1.1464, label: 1, bag_size: 869
batch 619, loss: 0.4667, instance_loss: 0.5355, weighted_loss: 0.4873, label: 0, bag_size: 3789
batch 639, loss: 0.7205, instance_loss: 0.6389, weighted_loss: 0.6960, label: 0, bag_size: 4719
batch 659, loss: 2.7596, instance_loss: 1.4289, weighted_loss: 2.3604, label: 1, bag_size: 3791
batch 679, loss: 0.2070, instance_loss: 0.4168, weighted_loss: 0.2699, label: 2, bag_size: 5637
batch 699, loss: 1.2058, instance_loss: 0.9440, weighted_loss: 1.1273, label: 1, bag_size: 2182
batch 719, loss: 0.2838, instance_loss: 0.3960, weighted_loss: 0.3175, label: 2, bag_size: 5914
batch 739, loss: 1.1235, instance_loss: 0.7961, weighted_loss: 1.0252, label: 1, bag_size: 1607


class 0 clustering acc 0.9983780760626398: correct 17851/17880
class 1 clustering acc 0.027516778523489934: correct 164/5960
Epoch: 2, train_loss: 0.9084, train_clustering_loss:  0.6710, train_error: 0.4013
class 0: acc 0.6008230452674898, correct 146/243
class 1: acc 0.4322033898305085, correct 102/236
class 2: acc 0.7443609022556391, correct 198/266

Val Set, val_loss: 0.8085, val_error: 0.3085, auc: 0.8456
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.02127659574468085: correct 16/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9455, instance_loss: 0.6819, weighted_loss: 0.8664, label: 0, bag_size: 4531
batch 39, loss: 0.5220, instance_loss: 0.7055, weighted_loss: 0.5771, label: 1, bag_size: 6243
batch 59, loss: 0.3613, instance_loss: 0.3761, weighted_loss: 0.3657, label: 1, bag_size: 4253
batch 79, loss: 0.4325, instance_loss: 0.5654, weighted_loss: 0.4724, label: 0, bag_size: 3224
batch 99, loss: 0.4694, instance_loss: 0.5589, weighted_loss: 0.4962, label: 2, bag_size: 3396
batch 119, loss: 0.3609, instance_loss: 0.5635, weighted_loss: 0.4217, label: 0, bag_size: 3741
batch 139, loss: 0.4962, instance_loss: 0.4838, weighted_loss: 0.4925, label: 0, bag_size: 2392
batch 159, loss: 0.2671, instance_loss: 0.3478, weighted_loss: 0.2913, label: 0, bag_size: 5041
batch 179, loss: 0.0886, instance_loss: 0.1843, weighted_loss: 0.1173, label: 2, bag_size: 4088
batch 199, loss: 0.2176, instance_loss: 0.6033, weighted_loss: 0.3333, label: 1, bag_size: 5084
batch 219, loss: 0.3161, instance_loss: 0.4994, weighted_loss: 0.3711, label: 0, bag_size: 1097
batch 239, loss: 1.2810, instance_loss: 0.8995, weighted_loss: 1.1666, label: 1, bag_size: 4346
batch 259, loss: 0.3539, instance_loss: 0.6235, weighted_loss: 0.4348, label: 0, bag_size: 1176
batch 279, loss: 0.3287, instance_loss: 0.3044, weighted_loss: 0.3214, label: 0, bag_size: 5526
batch 299, loss: 0.5804, instance_loss: 0.5445, weighted_loss: 0.5696, label: 0, bag_size: 5036
batch 319, loss: 1.1312, instance_loss: 0.7670, weighted_loss: 1.0219, label: 2, bag_size: 552
batch 339, loss: 1.8123, instance_loss: 0.8449, weighted_loss: 1.5221, label: 2, bag_size: 361
batch 359, loss: 0.4344, instance_loss: 0.6420, weighted_loss: 0.4967, label: 1, bag_size: 3460
batch 379, loss: 2.1473, instance_loss: 1.0578, weighted_loss: 1.8205, label: 2, bag_size: 3475
batch 399, loss: 1.4722, instance_loss: 0.8075, weighted_loss: 1.2728, label: 1, bag_size: 5197
batch 419, loss: 0.2857, instance_loss: 0.4491, weighted_loss: 0.3347, label: 0, bag_size: 6015
batch 439, loss: 0.4664, instance_loss: 0.3648, weighted_loss: 0.4359, label: 2, bag_size: 2501
batch 459, loss: 0.8295, instance_loss: 0.7518, weighted_loss: 0.8062, label: 1, bag_size: 3640
batch 479, loss: 1.9378, instance_loss: 0.7678, weighted_loss: 1.5868, label: 2, bag_size: 5307
batch 499, loss: 0.1672, instance_loss: 0.3700, weighted_loss: 0.2281, label: 0, bag_size: 1087
batch 519, loss: 0.1461, instance_loss: 0.3833, weighted_loss: 0.2173, label: 1, bag_size: 700
batch 539, loss: 1.5811, instance_loss: 0.8169, weighted_loss: 1.3518, label: 0, bag_size: 3033
batch 559, loss: 3.0445, instance_loss: 1.5943, weighted_loss: 2.6095, label: 1, bag_size: 1549
batch 579, loss: 1.0478, instance_loss: 0.9282, weighted_loss: 1.0119, label: 2, bag_size: 3778
batch 599, loss: 0.6051, instance_loss: 0.5520, weighted_loss: 0.5892, label: 0, bag_size: 4146
batch 619, loss: 3.5096, instance_loss: 0.8703, weighted_loss: 2.7178, label: 0, bag_size: 12971
batch 639, loss: 0.9134, instance_loss: 0.6446, weighted_loss: 0.8328, label: 0, bag_size: 4946
batch 659, loss: 0.3513, instance_loss: 0.2864, weighted_loss: 0.3318, label: 2, bag_size: 4241
batch 679, loss: 0.2742, instance_loss: 0.3841, weighted_loss: 0.3072, label: 2, bag_size: 3497
batch 699, loss: 1.0718, instance_loss: 0.7330, weighted_loss: 0.9701, label: 0, bag_size: 3701
batch 719, loss: 0.5719, instance_loss: 0.4778, weighted_loss: 0.5437, label: 1, bag_size: 2122
batch 739, loss: 0.5606, instance_loss: 0.5030, weighted_loss: 0.5433, label: 1, bag_size: 3396


class 0 clustering acc 0.9898769574944072: correct 17699/17880
class 1 clustering acc 0.07432885906040268: correct 443/5960
Epoch: 3, train_loss: 0.8249, train_clustering_loss:  0.6502, train_error: 0.3624
class 0: acc 0.6827309236947792, correct 170/249
class 1: acc 0.4959349593495935, correct 122/246
class 2: acc 0.732, correct 183/250

Val Set, val_loss: 0.7169, val_error: 0.3085, auc: 0.8509
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.010638297872340425: correct 8/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (0.798617 --> 0.716932).  Saving model ...


batch 19, loss: 0.5006, instance_loss: 0.5141, weighted_loss: 0.5046, label: 0, bag_size: 3571
batch 39, loss: 0.3655, instance_loss: 0.4697, weighted_loss: 0.3968, label: 1, bag_size: 6315
batch 59, loss: 0.2670, instance_loss: 0.5937, weighted_loss: 0.3650, label: 2, bag_size: 6148
batch 79, loss: 0.4229, instance_loss: 0.4471, weighted_loss: 0.4301, label: 0, bag_size: 6863
batch 99, loss: 0.8741, instance_loss: 0.5354, weighted_loss: 0.7725, label: 2, bag_size: 5307
batch 119, loss: 0.0835, instance_loss: 0.1009, weighted_loss: 0.0887, label: 2, bag_size: 657
batch 139, loss: 0.1062, instance_loss: 0.0991, weighted_loss: 0.1041, label: 2, bag_size: 4043
batch 159, loss: 0.4474, instance_loss: 0.5519, weighted_loss: 0.4787, label: 1, bag_size: 3051
batch 179, loss: 0.6826, instance_loss: 0.7460, weighted_loss: 0.7016, label: 0, bag_size: 5487
batch 199, loss: 0.1699, instance_loss: 0.1982, weighted_loss: 0.1784, label: 0, bag_size: 4734
batch 219, loss: 0.1829, instance_loss: 0.5076, weighted_loss: 0.2803, label: 2, bag_size: 5011
batch 239, loss: 0.1082, instance_loss: 0.1921, weighted_loss: 0.1334, label: 2, bag_size: 3176
batch 259, loss: 0.2871, instance_loss: 0.4018, weighted_loss: 0.3215, label: 0, bag_size: 2293
batch 279, loss: 0.1235, instance_loss: 0.2407, weighted_loss: 0.1586, label: 0, bag_size: 3816
batch 299, loss: 0.1411, instance_loss: 0.2712, weighted_loss: 0.1801, label: 0, bag_size: 4229
batch 319, loss: 0.7985, instance_loss: 1.0026, weighted_loss: 0.8597, label: 1, bag_size: 1221
batch 339, loss: 1.3504, instance_loss: 0.7421, weighted_loss: 1.1679, label: 0, bag_size: 4310
batch 359, loss: 0.1400, instance_loss: 0.2951, weighted_loss: 0.1865, label: 0, bag_size: 7169
batch 379, loss: 1.2889, instance_loss: 0.8507, weighted_loss: 1.1574, label: 1, bag_size: 2472
batch 399, loss: 0.4099, instance_loss: 0.4184, weighted_loss: 0.4124, label: 2, bag_size: 4487
batch 419, loss: 0.0660, instance_loss: 0.2756, weighted_loss: 0.1288, label: 0, bag_size: 829
batch 439, loss: 1.2873, instance_loss: 0.6623, weighted_loss: 1.0998, label: 2, bag_size: 4096
batch 459, loss: 1.3355, instance_loss: 0.7628, weighted_loss: 1.1637, label: 2, bag_size: 4179
batch 479, loss: 0.9807, instance_loss: 0.8003, weighted_loss: 0.9266, label: 1, bag_size: 1599
batch 499, loss: 0.7995, instance_loss: 0.6530, weighted_loss: 0.7556, label: 1, bag_size: 4705
batch 519, loss: 1.4000, instance_loss: 0.8049, weighted_loss: 1.2214, label: 1, bag_size: 7109
batch 539, loss: 0.1915, instance_loss: 0.4565, weighted_loss: 0.2710, label: 0, bag_size: 1194
batch 559, loss: 0.8396, instance_loss: 0.7356, weighted_loss: 0.8084, label: 1, bag_size: 3422
batch 579, loss: 0.1551, instance_loss: 0.4095, weighted_loss: 0.2314, label: 1, bag_size: 3558
batch 599, loss: 0.3045, instance_loss: 0.4314, weighted_loss: 0.3426, label: 1, bag_size: 5003
batch 619, loss: 0.4359, instance_loss: 0.5850, weighted_loss: 0.4807, label: 0, bag_size: 5899
batch 639, loss: 0.4858, instance_loss: 0.5958, weighted_loss: 0.5188, label: 0, bag_size: 2189
batch 659, loss: 0.8646, instance_loss: 0.7738, weighted_loss: 0.8373, label: 0, bag_size: 6630
batch 679, loss: 0.8391, instance_loss: 0.6187, weighted_loss: 0.7729, label: 0, bag_size: 1774
batch 699, loss: 0.8255, instance_loss: 0.6809, weighted_loss: 0.7821, label: 1, bag_size: 11974
batch 719, loss: 0.6775, instance_loss: 0.5310, weighted_loss: 0.6335, label: 0, bag_size: 7056
batch 739, loss: 1.6752, instance_loss: 1.9783, weighted_loss: 1.7662, label: 2, bag_size: 3810


class 0 clustering acc 0.9852348993288591: correct 17616/17880
class 1 clustering acc 0.1389261744966443: correct 828/5960
Epoch: 4, train_loss: 0.7748, train_clustering_loss:  0.6258, train_error: 0.3503
class 0: acc 0.7203065134099617, correct 188/261
class 1: acc 0.46875, correct 105/224
class 2: acc 0.7346153846153847, correct 191/260

Val Set, val_loss: 0.6767, val_error: 0.3085, auc: 0.8528
class 0 clustering acc 0.9968971631205674: correct 2249/2256
class 1 clustering acc 0.041223404255319146: correct 31/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.716932 --> 0.676690).  Saving model ...


batch 19, loss: 0.5002, instance_loss: 0.5343, weighted_loss: 0.5104, label: 1, bag_size: 8632
batch 39, loss: 1.1817, instance_loss: 0.7791, weighted_loss: 1.0609, label: 1, bag_size: 1558
batch 59, loss: 0.0987, instance_loss: 0.2643, weighted_loss: 0.1484, label: 2, bag_size: 3397
batch 79, loss: 2.1211, instance_loss: 0.8218, weighted_loss: 1.7313, label: 1, bag_size: 6241
batch 99, loss: 0.2522, instance_loss: 0.1580, weighted_loss: 0.2240, label: 2, bag_size: 3327
batch 119, loss: 0.7503, instance_loss: 0.7844, weighted_loss: 0.7605, label: 0, bag_size: 5330
batch 139, loss: 0.3931, instance_loss: 0.4205, weighted_loss: 0.4013, label: 1, bag_size: 3391
batch 159, loss: 0.5221, instance_loss: 0.3783, weighted_loss: 0.4790, label: 2, bag_size: 4056
batch 179, loss: 1.6392, instance_loss: 1.1123, weighted_loss: 1.4812, label: 0, bag_size: 20234
batch 199, loss: 0.2191, instance_loss: 0.3551, weighted_loss: 0.2599, label: 2, bag_size: 4788
batch 219, loss: 0.0204, instance_loss: 0.3841, weighted_loss: 0.1295, label: 2, bag_size: 3678
batch 239, loss: 1.0316, instance_loss: 0.9533, weighted_loss: 1.0081, label: 1, bag_size: 2302
batch 259, loss: 0.1226, instance_loss: 0.3357, weighted_loss: 0.1865, label: 1, bag_size: 874
batch 279, loss: 1.2569, instance_loss: 0.8756, weighted_loss: 1.1425, label: 2, bag_size: 4342
batch 299, loss: 0.3680, instance_loss: 0.5062, weighted_loss: 0.4095, label: 0, bag_size: 3408
batch 319, loss: 0.3213, instance_loss: 0.5843, weighted_loss: 0.4002, label: 0, bag_size: 1006
batch 339, loss: 0.4850, instance_loss: 0.6138, weighted_loss: 0.5236, label: 0, bag_size: 2339
batch 359, loss: 0.6373, instance_loss: 0.4481, weighted_loss: 0.5805, label: 1, bag_size: 3640
batch 379, loss: 0.1057, instance_loss: 0.3229, weighted_loss: 0.1709, label: 2, bag_size: 3497
batch 399, loss: 1.5230, instance_loss: 1.4491, weighted_loss: 1.5008, label: 1, bag_size: 3995
batch 419, loss: 0.1584, instance_loss: 0.5317, weighted_loss: 0.2704, label: 1, bag_size: 3172
batch 439, loss: 2.5115, instance_loss: 0.6404, weighted_loss: 1.9501, label: 0, bag_size: 19216
batch 459, loss: 0.5497, instance_loss: 0.4947, weighted_loss: 0.5332, label: 2, bag_size: 6594
batch 479, loss: 0.7965, instance_loss: 0.6168, weighted_loss: 0.7426, label: 0, bag_size: 7077
batch 499, loss: 0.9151, instance_loss: 0.6654, weighted_loss: 0.8402, label: 2, bag_size: 4162
batch 519, loss: 0.1506, instance_loss: 0.5374, weighted_loss: 0.2666, label: 2, bag_size: 4372
batch 539, loss: 0.1917, instance_loss: 0.3054, weighted_loss: 0.2259, label: 0, bag_size: 2293
batch 559, loss: 0.1548, instance_loss: 0.2783, weighted_loss: 0.1918, label: 2, bag_size: 2501
batch 579, loss: 0.3735, instance_loss: 0.5707, weighted_loss: 0.4327, label: 0, bag_size: 1655
batch 599, loss: 0.8153, instance_loss: 0.6932, weighted_loss: 0.7787, label: 0, bag_size: 1071
batch 619, loss: 0.8430, instance_loss: 0.6038, weighted_loss: 0.7712, label: 1, bag_size: 3322
batch 639, loss: 0.0070, instance_loss: 0.2618, weighted_loss: 0.0835, label: 1, bag_size: 3425
batch 659, loss: 0.5881, instance_loss: 0.4389, weighted_loss: 0.5433, label: 1, bag_size: 3823
batch 679, loss: 0.0768, instance_loss: 0.5203, weighted_loss: 0.2099, label: 1, bag_size: 5026
batch 699, loss: 0.4487, instance_loss: 0.4989, weighted_loss: 0.4638, label: 2, bag_size: 6001
batch 719, loss: 1.5007, instance_loss: 0.7777, weighted_loss: 1.2838, label: 1, bag_size: 1670
batch 739, loss: 1.0914, instance_loss: 0.5619, weighted_loss: 0.9326, label: 2, bag_size: 2031


class 0 clustering acc 0.9884228187919463: correct 17673/17880
class 1 clustering acc 0.09798657718120805: correct 584/5960
Epoch: 5, train_loss: 0.8121, train_clustering_loss:  0.6445, train_error: 0.3611
class 0: acc 0.5619047619047619, correct 118/210
class 1: acc 0.6286764705882353, correct 171/272
class 2: acc 0.7110266159695817, correct 187/263

Val Set, val_loss: 0.8602, val_error: 0.3723, auc: 0.8628
class 0 clustering acc 0.9884751773049646: correct 2230/2256
class 1 clustering acc 0.09441489361702128: correct 71/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2680, instance_loss: 0.6772, weighted_loss: 1.0908, label: 0, bag_size: 6630
batch 39, loss: 2.2846, instance_loss: 1.0912, weighted_loss: 1.9266, label: 2, bag_size: 7607
batch 59, loss: 0.8826, instance_loss: 0.8978, weighted_loss: 0.8872, label: 2, bag_size: 4162
batch 79, loss: 0.3613, instance_loss: 0.5015, weighted_loss: 0.4034, label: 0, bag_size: 6015
batch 99, loss: 0.4288, instance_loss: 0.4753, weighted_loss: 0.4428, label: 0, bag_size: 3649
batch 119, loss: 1.5126, instance_loss: 0.9344, weighted_loss: 1.3391, label: 1, bag_size: 5167
batch 139, loss: 1.4041, instance_loss: 0.9831, weighted_loss: 1.2778, label: 2, bag_size: 1222
batch 159, loss: 0.5582, instance_loss: 0.5949, weighted_loss: 0.5692, label: 0, bag_size: 5795
batch 179, loss: 1.5438, instance_loss: 0.7516, weighted_loss: 1.3062, label: 1, bag_size: 3644
batch 199, loss: 1.1679, instance_loss: 1.1658, weighted_loss: 1.1673, label: 2, bag_size: 4241
batch 219, loss: 1.1317, instance_loss: 0.7689, weighted_loss: 1.0228, label: 1, bag_size: 1045
batch 239, loss: 0.4985, instance_loss: 0.3542, weighted_loss: 0.4552, label: 2, bag_size: 597
batch 259, loss: 1.8575, instance_loss: 0.9492, weighted_loss: 1.5850, label: 0, bag_size: 4509
batch 279, loss: 0.4779, instance_loss: 0.4748, weighted_loss: 0.4770, label: 1, bag_size: 2744
batch 299, loss: 0.5887, instance_loss: 0.7452, weighted_loss: 0.6356, label: 2, bag_size: 5426
batch 319, loss: 2.0072, instance_loss: 1.0437, weighted_loss: 1.7181, label: 2, bag_size: 909
batch 339, loss: 1.9913, instance_loss: 0.9150, weighted_loss: 1.6684, label: 1, bag_size: 1045
batch 359, loss: 0.2678, instance_loss: 0.4103, weighted_loss: 0.3106, label: 2, bag_size: 4096
batch 379, loss: 0.1341, instance_loss: 0.3918, weighted_loss: 0.2114, label: 2, bag_size: 3121
batch 399, loss: 0.6921, instance_loss: 0.6340, weighted_loss: 0.6747, label: 1, bag_size: 4438
batch 419, loss: 0.3651, instance_loss: 0.4700, weighted_loss: 0.3966, label: 1, bag_size: 5118
batch 439, loss: 0.2243, instance_loss: 0.4382, weighted_loss: 0.2885, label: 1, bag_size: 758
batch 459, loss: 0.2314, instance_loss: 0.4256, weighted_loss: 0.2896, label: 0, bag_size: 3872
batch 479, loss: 0.2426, instance_loss: 0.3602, weighted_loss: 0.2778, label: 0, bag_size: 4760
batch 499, loss: 1.1045, instance_loss: 0.8061, weighted_loss: 1.0150, label: 0, bag_size: 2927
batch 519, loss: 1.0802, instance_loss: 0.8580, weighted_loss: 1.0135, label: 2, bag_size: 1222
batch 539, loss: 1.6466, instance_loss: 1.1463, weighted_loss: 1.4965, label: 1, bag_size: 1477
batch 559, loss: 0.2850, instance_loss: 0.4115, weighted_loss: 0.3230, label: 0, bag_size: 5459
batch 579, loss: 0.3687, instance_loss: 0.5081, weighted_loss: 0.4105, label: 2, bag_size: 6644
batch 599, loss: 0.3671, instance_loss: 0.4782, weighted_loss: 0.4005, label: 0, bag_size: 3586
batch 619, loss: 0.4106, instance_loss: 0.4017, weighted_loss: 0.4080, label: 2, bag_size: 3678
batch 639, loss: 0.9243, instance_loss: 0.5532, weighted_loss: 0.8129, label: 0, bag_size: 4794
batch 659, loss: 0.4830, instance_loss: 0.5006, weighted_loss: 0.4883, label: 0, bag_size: 5368
batch 679, loss: 1.0075, instance_loss: 0.7422, weighted_loss: 0.9279, label: 1, bag_size: 1122
batch 699, loss: 1.4240, instance_loss: 0.8650, weighted_loss: 1.2563, label: 1, bag_size: 6942
batch 719, loss: 1.5509, instance_loss: 0.8462, weighted_loss: 1.3395, label: 1, bag_size: 3497
batch 739, loss: 2.1523, instance_loss: 1.0043, weighted_loss: 1.8079, label: 1, bag_size: 3791


class 0 clustering acc 0.988758389261745: correct 17679/17880
class 1 clustering acc 0.10687919463087249: correct 637/5960
Epoch: 6, train_loss: 0.8096, train_clustering_loss:  0.6416, train_error: 0.3517
class 0: acc 0.6322314049586777, correct 153/242
class 1: acc 0.5378486055776892, correct 135/251
class 2: acc 0.7738095238095238, correct 195/252

Val Set, val_loss: 0.6929, val_error: 0.2660, auc: 0.8646
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.010638297872340425: correct 8/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7972, instance_loss: 0.6493, weighted_loss: 0.7528, label: 0, bag_size: 1652
batch 39, loss: 1.3249, instance_loss: 0.9607, weighted_loss: 1.2156, label: 2, bag_size: 4241
batch 59, loss: 1.2054, instance_loss: 0.7506, weighted_loss: 1.0690, label: 0, bag_size: 4541
batch 79, loss: 0.3339, instance_loss: 0.6651, weighted_loss: 0.4333, label: 1, bag_size: 758
batch 99, loss: 1.5123, instance_loss: 0.7772, weighted_loss: 1.2918, label: 2, bag_size: 728
batch 119, loss: 0.1048, instance_loss: 0.3530, weighted_loss: 0.1792, label: 2, bag_size: 4192
batch 139, loss: 0.2000, instance_loss: 0.3440, weighted_loss: 0.2432, label: 2, bag_size: 4043
batch 159, loss: 0.7707, instance_loss: 0.4951, weighted_loss: 0.6880, label: 1, bag_size: 4784
batch 179, loss: 1.1686, instance_loss: 0.6291, weighted_loss: 1.0068, label: 2, bag_size: 5307
batch 199, loss: 1.0575, instance_loss: 0.8204, weighted_loss: 0.9864, label: 1, bag_size: 1066
batch 219, loss: 0.7862, instance_loss: 0.6558, weighted_loss: 0.7471, label: 2, bag_size: 3112
batch 239, loss: 0.2935, instance_loss: 0.2092, weighted_loss: 0.2682, label: 2, bag_size: 4043
batch 259, loss: 0.4933, instance_loss: 0.5795, weighted_loss: 0.5192, label: 0, bag_size: 7595
batch 279, loss: 0.3452, instance_loss: 0.5629, weighted_loss: 0.4105, label: 0, bag_size: 4997
batch 299, loss: 2.7186, instance_loss: 1.0151, weighted_loss: 2.2076, label: 2, bag_size: 728
batch 319, loss: 0.2910, instance_loss: 0.5607, weighted_loss: 0.3719, label: 2, bag_size: 3210
batch 339, loss: 0.0426, instance_loss: 0.1765, weighted_loss: 0.0827, label: 2, bag_size: 5914
batch 359, loss: 1.1782, instance_loss: 0.8493, weighted_loss: 1.0796, label: 1, bag_size: 3184
batch 379, loss: 0.4022, instance_loss: 0.4470, weighted_loss: 0.4157, label: 0, bag_size: 4734
batch 399, loss: 0.3659, instance_loss: 0.4740, weighted_loss: 0.3983, label: 1, bag_size: 1066
batch 419, loss: 0.5159, instance_loss: 0.5312, weighted_loss: 0.5205, label: 0, bag_size: 5036
batch 439, loss: 0.2580, instance_loss: 0.8250, weighted_loss: 0.4281, label: 1, bag_size: 1604
batch 459, loss: 1.6677, instance_loss: 0.9218, weighted_loss: 1.4439, label: 1, bag_size: 2425
batch 479, loss: 0.9607, instance_loss: 0.8279, weighted_loss: 0.9209, label: 1, bag_size: 3596
batch 499, loss: 0.3718, instance_loss: 0.3314, weighted_loss: 0.3597, label: 1, bag_size: 4253
batch 519, loss: 0.6658, instance_loss: 0.5444, weighted_loss: 0.6294, label: 0, bag_size: 1352
batch 539, loss: 0.1273, instance_loss: 0.5191, weighted_loss: 0.2449, label: 2, bag_size: 3810
batch 559, loss: 0.3183, instance_loss: 0.3540, weighted_loss: 0.3290, label: 0, bag_size: 5413
batch 579, loss: 1.0779, instance_loss: 0.6759, weighted_loss: 0.9573, label: 2, bag_size: 728
batch 599, loss: 1.8042, instance_loss: 1.1178, weighted_loss: 1.5983, label: 1, bag_size: 3497
batch 619, loss: 2.3324, instance_loss: 0.4212, weighted_loss: 1.7590, label: 0, bag_size: 3316
batch 639, loss: 1.4014, instance_loss: 0.8354, weighted_loss: 1.2316, label: 2, bag_size: 4241
batch 659, loss: 0.8567, instance_loss: 0.5768, weighted_loss: 0.7727, label: 0, bag_size: 7056
batch 679, loss: 1.9523, instance_loss: 1.0098, weighted_loss: 1.6696, label: 1, bag_size: 2481
batch 699, loss: 2.6085, instance_loss: 1.3191, weighted_loss: 2.2217, label: 0, bag_size: 4032
batch 719, loss: 1.0137, instance_loss: 0.8168, weighted_loss: 0.9546, label: 0, bag_size: 1492
batch 739, loss: 2.2881, instance_loss: 0.9423, weighted_loss: 1.8844, label: 0, bag_size: 1755


class 0 clustering acc 0.9886465324384788: correct 17677/17880
class 1 clustering acc 0.12516778523489933: correct 746/5960
Epoch: 7, train_loss: 0.7853, train_clustering_loss:  0.6217, train_error: 0.3423
class 0: acc 0.6899563318777293, correct 158/229
class 1: acc 0.5532786885245902, correct 135/244
class 2: acc 0.7242647058823529, correct 197/272

Val Set, val_loss: 0.6858, val_error: 0.2766, auc: 0.8580
class 0 clustering acc 0.9973404255319149: correct 2250/2256
class 1 clustering acc 0.08776595744680851: correct 66/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0357, instance_loss: 0.0890, weighted_loss: 0.0517, label: 2, bag_size: 2997
batch 39, loss: 0.4363, instance_loss: 0.4610, weighted_loss: 0.4437, label: 0, bag_size: 6015
batch 59, loss: 0.4664, instance_loss: 0.5671, weighted_loss: 0.4966, label: 2, bag_size: 5017
batch 79, loss: 0.6283, instance_loss: 0.6846, weighted_loss: 0.6452, label: 1, bag_size: 3396
batch 99, loss: 0.3606, instance_loss: 0.4861, weighted_loss: 0.3983, label: 0, bag_size: 1071
batch 119, loss: 0.4490, instance_loss: 0.5854, weighted_loss: 0.4899, label: 1, bag_size: 425
batch 139, loss: 0.3700, instance_loss: 0.5916, weighted_loss: 0.4365, label: 2, bag_size: 2486
batch 159, loss: 0.3056, instance_loss: 0.3651, weighted_loss: 0.3235, label: 2, bag_size: 3026
batch 179, loss: 0.2861, instance_loss: 0.4155, weighted_loss: 0.3249, label: 2, bag_size: 2997
batch 199, loss: 1.6883, instance_loss: 0.9624, weighted_loss: 1.4706, label: 0, bag_size: 609
batch 219, loss: 1.8362, instance_loss: 1.1007, weighted_loss: 1.6156, label: 2, bag_size: 4316
batch 239, loss: 0.3679, instance_loss: 0.5105, weighted_loss: 0.4107, label: 1, bag_size: 3357
batch 259, loss: 1.3239, instance_loss: 0.9259, weighted_loss: 1.2045, label: 2, bag_size: 4241
batch 279, loss: 0.4041, instance_loss: 1.7980, weighted_loss: 0.8222, label: 0, bag_size: 1814
batch 299, loss: 0.3352, instance_loss: 0.3936, weighted_loss: 0.3527, label: 1, bag_size: 1042
batch 319, loss: 0.5999, instance_loss: 0.6453, weighted_loss: 0.6135, label: 1, bag_size: 3533
batch 339, loss: 0.4854, instance_loss: 0.4947, weighted_loss: 0.4882, label: 0, bag_size: 4242
batch 359, loss: 0.7477, instance_loss: 0.6544, weighted_loss: 0.7197, label: 1, bag_size: 782
batch 379, loss: 0.2014, instance_loss: 0.4019, weighted_loss: 0.2616, label: 0, bag_size: 5757
batch 399, loss: 0.0402, instance_loss: 0.0541, weighted_loss: 0.0444, label: 2, bag_size: 6026
batch 419, loss: 0.6322, instance_loss: 0.5839, weighted_loss: 0.6177, label: 2, bag_size: 6594
batch 439, loss: 0.4195, instance_loss: 0.5075, weighted_loss: 0.4459, label: 2, bag_size: 6148
batch 459, loss: 0.6339, instance_loss: 0.6133, weighted_loss: 0.6277, label: 2, bag_size: 4162
batch 479, loss: 0.6122, instance_loss: 0.4730, weighted_loss: 0.5705, label: 0, bag_size: 702
batch 499, loss: 0.4727, instance_loss: 0.4922, weighted_loss: 0.4786, label: 0, bag_size: 4351
batch 519, loss: 0.1026, instance_loss: 0.2860, weighted_loss: 0.1576, label: 0, bag_size: 5437
batch 539, loss: 0.1215, instance_loss: 0.4121, weighted_loss: 0.2087, label: 0, bag_size: 4403
batch 559, loss: 1.4425, instance_loss: 0.9388, weighted_loss: 1.2914, label: 0, bag_size: 1025
batch 579, loss: 0.2019, instance_loss: 0.3030, weighted_loss: 0.2322, label: 0, bag_size: 6430
batch 599, loss: 1.5604, instance_loss: 0.8639, weighted_loss: 1.3515, label: 2, bag_size: 6298
batch 619, loss: 0.2473, instance_loss: 0.3313, weighted_loss: 0.2725, label: 0, bag_size: 3368
batch 639, loss: 0.5068, instance_loss: 0.4009, weighted_loss: 0.4750, label: 0, bag_size: 4292
batch 659, loss: 0.6044, instance_loss: 0.5490, weighted_loss: 0.5877, label: 1, bag_size: 1599
batch 679, loss: 0.5504, instance_loss: 0.2644, weighted_loss: 0.4646, label: 2, bag_size: 4043
batch 699, loss: 0.2260, instance_loss: 0.4998, weighted_loss: 0.3081, label: 2, bag_size: 2770
batch 719, loss: 0.5055, instance_loss: 0.2750, weighted_loss: 0.4364, label: 2, bag_size: 3026
batch 739, loss: 0.5247, instance_loss: 0.3092, weighted_loss: 0.4601, label: 2, bag_size: 3026


class 0 clustering acc 0.9842281879194631: correct 17598/17880
class 1 clustering acc 0.13573825503355705: correct 809/5960
Epoch: 8, train_loss: 0.7863, train_clustering_loss:  0.6235, train_error: 0.3477
class 0: acc 0.744, correct 186/250
class 1: acc 0.53125, correct 136/256
class 2: acc 0.6861924686192469, correct 164/239

Val Set, val_loss: 0.6570, val_error: 0.2766, auc: 0.8619
class 0 clustering acc 0.9858156028368794: correct 2224/2256
class 1 clustering acc 0.28856382978723405: correct 217/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.676690 --> 0.656954).  Saving model ...


batch 19, loss: 1.6050, instance_loss: 1.2555, weighted_loss: 1.5002, label: 1, bag_size: 3596
batch 39, loss: 0.1274, instance_loss: 0.2322, weighted_loss: 0.1589, label: 0, bag_size: 3539
batch 59, loss: 0.3544, instance_loss: 0.4353, weighted_loss: 0.3787, label: 1, bag_size: 210
batch 79, loss: 3.2215, instance_loss: 1.1087, weighted_loss: 2.5877, label: 0, bag_size: 3830
batch 99, loss: 0.3211, instance_loss: 0.4449, weighted_loss: 0.3582, label: 0, bag_size: 4922
batch 119, loss: 1.6003, instance_loss: 0.6720, weighted_loss: 1.3218, label: 1, bag_size: 832
batch 139, loss: 0.7213, instance_loss: 0.5711, weighted_loss: 0.6762, label: 0, bag_size: 4604
batch 159, loss: 1.7190, instance_loss: 0.7377, weighted_loss: 1.4246, label: 0, bag_size: 1709
batch 179, loss: 0.1551, instance_loss: 0.4153, weighted_loss: 0.2331, label: 2, bag_size: 3174
batch 199, loss: 1.3827, instance_loss: 0.8766, weighted_loss: 1.2309, label: 1, bag_size: 1595
batch 219, loss: 0.3634, instance_loss: 0.4719, weighted_loss: 0.3959, label: 0, bag_size: 8088
batch 239, loss: 0.0722, instance_loss: 0.2154, weighted_loss: 0.1152, label: 0, bag_size: 1647
batch 259, loss: 0.0761, instance_loss: 0.4550, weighted_loss: 0.1898, label: 2, bag_size: 3810
batch 279, loss: 0.9032, instance_loss: 0.6391, weighted_loss: 0.8240, label: 2, bag_size: 1513
batch 299, loss: 0.4215, instance_loss: 0.7422, weighted_loss: 0.5177, label: 2, bag_size: 4192
batch 319, loss: 0.1091, instance_loss: 0.2096, weighted_loss: 0.1392, label: 0, bag_size: 5782
batch 339, loss: 1.2643, instance_loss: 0.8581, weighted_loss: 1.1424, label: 1, bag_size: 7176
batch 359, loss: 0.7638, instance_loss: 0.6079, weighted_loss: 0.7170, label: 1, bag_size: 296
batch 379, loss: 2.0871, instance_loss: 1.0597, weighted_loss: 1.7789, label: 2, bag_size: 552
batch 399, loss: 0.8211, instance_loss: 0.5222, weighted_loss: 0.7314, label: 2, bag_size: 3026
batch 419, loss: 0.1373, instance_loss: 0.2244, weighted_loss: 0.1634, label: 0, bag_size: 4405
batch 439, loss: 0.4617, instance_loss: 0.8019, weighted_loss: 0.5637, label: 2, bag_size: 3604
batch 459, loss: 0.1286, instance_loss: 0.2155, weighted_loss: 0.1546, label: 0, bag_size: 2853
batch 479, loss: 0.7788, instance_loss: 0.4180, weighted_loss: 0.6705, label: 0, bag_size: 3639
batch 499, loss: 0.0204, instance_loss: 0.2420, weighted_loss: 0.0868, label: 1, bag_size: 3337
batch 519, loss: 1.8345, instance_loss: 1.0471, weighted_loss: 1.5983, label: 2, bag_size: 552
batch 539, loss: 2.1296, instance_loss: 0.9658, weighted_loss: 1.7805, label: 2, bag_size: 361
batch 559, loss: 0.5182, instance_loss: 0.4453, weighted_loss: 0.4963, label: 1, bag_size: 9099
batch 579, loss: 1.0614, instance_loss: 0.8040, weighted_loss: 0.9842, label: 1, bag_size: 2743
batch 599, loss: 0.8083, instance_loss: 0.7868, weighted_loss: 0.8018, label: 1, bag_size: 782
batch 619, loss: 0.3541, instance_loss: 0.6545, weighted_loss: 0.4443, label: 0, bag_size: 3298
batch 639, loss: 0.4748, instance_loss: 0.4094, weighted_loss: 0.4552, label: 0, bag_size: 4479
batch 659, loss: 0.0420, instance_loss: 0.0646, weighted_loss: 0.0488, label: 2, bag_size: 6026
batch 679, loss: 0.1670, instance_loss: 0.6401, weighted_loss: 0.3090, label: 2, bag_size: 4569
batch 699, loss: 0.5841, instance_loss: 0.4601, weighted_loss: 0.5469, label: 1, bag_size: 4595
batch 719, loss: 0.6680, instance_loss: 0.6111, weighted_loss: 0.6509, label: 0, bag_size: 13540
batch 739, loss: 0.1791, instance_loss: 0.2417, weighted_loss: 0.1979, label: 0, bag_size: 3752


class 0 clustering acc 0.9756711409395973: correct 17445/17880
class 1 clustering acc 0.25: correct 1490/5960
Epoch: 9, train_loss: 0.7140, train_clustering_loss:  0.5960, train_error: 0.3074
class 0: acc 0.74, correct 185/250
class 1: acc 0.609375, correct 156/256
class 2: acc 0.7322175732217573, correct 175/239

Val Set, val_loss: 0.6863, val_error: 0.3191, auc: 0.8517
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.32313829787234044: correct 243/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2231, instance_loss: 0.3568, weighted_loss: 0.2632, label: 1, bag_size: 3127
batch 39, loss: 1.1173, instance_loss: 0.7503, weighted_loss: 1.0072, label: 0, bag_size: 2712
batch 59, loss: 0.0460, instance_loss: 0.2327, weighted_loss: 0.1020, label: 1, bag_size: 2493
batch 79, loss: 0.0849, instance_loss: 0.3987, weighted_loss: 0.1790, label: 2, bag_size: 3810
batch 99, loss: 0.1971, instance_loss: 0.4022, weighted_loss: 0.2586, label: 2, bag_size: 3618
batch 119, loss: 0.8428, instance_loss: 0.5925, weighted_loss: 0.7677, label: 0, bag_size: 4157
batch 139, loss: 0.7165, instance_loss: 0.7369, weighted_loss: 0.7226, label: 0, bag_size: 1611
batch 159, loss: 1.2144, instance_loss: 0.7698, weighted_loss: 1.0810, label: 0, bag_size: 4337
batch 179, loss: 0.0562, instance_loss: 0.2743, weighted_loss: 0.1216, label: 0, bag_size: 829
batch 199, loss: 0.8235, instance_loss: 0.4742, weighted_loss: 0.7187, label: 0, bag_size: 4157
batch 219, loss: 0.2116, instance_loss: 0.3284, weighted_loss: 0.2467, label: 0, bag_size: 1640
batch 239, loss: 0.2232, instance_loss: 0.3648, weighted_loss: 0.2657, label: 1, bag_size: 3127
batch 259, loss: 3.2875, instance_loss: 1.3884, weighted_loss: 2.7178, label: 0, bag_size: 877
batch 279, loss: 0.1738, instance_loss: 0.2678, weighted_loss: 0.2020, label: 0, bag_size: 2293
batch 299, loss: 1.5812, instance_loss: 0.8124, weighted_loss: 1.3506, label: 1, bag_size: 1860
batch 319, loss: 0.5856, instance_loss: 0.6264, weighted_loss: 0.5979, label: 2, bag_size: 3080
batch 339, loss: 1.2654, instance_loss: 0.7836, weighted_loss: 1.1208, label: 2, bag_size: 3746
batch 359, loss: 0.3597, instance_loss: 0.5134, weighted_loss: 0.4058, label: 0, bag_size: 4531
batch 379, loss: 0.7851, instance_loss: 0.8027, weighted_loss: 0.7904, label: 2, bag_size: 5072
batch 399, loss: 0.9961, instance_loss: 0.8685, weighted_loss: 0.9578, label: 2, bag_size: 5307
batch 419, loss: 0.6157, instance_loss: 0.4850, weighted_loss: 0.5765, label: 0, bag_size: 4827
batch 439, loss: 0.3465, instance_loss: 0.1092, weighted_loss: 0.2753, label: 2, bag_size: 88
batch 459, loss: 0.6707, instance_loss: 0.4054, weighted_loss: 0.5911, label: 2, bag_size: 3026
batch 479, loss: 1.9269, instance_loss: 0.8667, weighted_loss: 1.6088, label: 2, bag_size: 361
batch 499, loss: 0.4669, instance_loss: 0.5753, weighted_loss: 0.4995, label: 2, bag_size: 3080
batch 519, loss: 0.2346, instance_loss: 0.3909, weighted_loss: 0.2815, label: 2, bag_size: 5138
batch 539, loss: 0.1662, instance_loss: 0.2141, weighted_loss: 0.1806, label: 2, bag_size: 2313
batch 559, loss: 0.4654, instance_loss: 0.6217, weighted_loss: 0.5123, label: 1, bag_size: 800
batch 579, loss: 0.8360, instance_loss: 0.8637, weighted_loss: 0.8443, label: 0, bag_size: 1808
batch 599, loss: 0.4370, instance_loss: 0.5424, weighted_loss: 0.4686, label: 0, bag_size: 598
batch 619, loss: 1.2030, instance_loss: 0.9256, weighted_loss: 1.1198, label: 2, bag_size: 4316
batch 639, loss: 0.5244, instance_loss: 0.3967, weighted_loss: 0.4861, label: 0, bag_size: 3571
batch 659, loss: 0.7430, instance_loss: 0.5194, weighted_loss: 0.6759, label: 0, bag_size: 3070
batch 679, loss: 0.3881, instance_loss: 0.3810, weighted_loss: 0.3859, label: 0, bag_size: 2293
batch 699, loss: 0.8424, instance_loss: 0.6313, weighted_loss: 0.7791, label: 1, bag_size: 1122
batch 719, loss: 0.5723, instance_loss: 0.7654, weighted_loss: 0.6302, label: 1, bag_size: 2229
batch 739, loss: 0.3577, instance_loss: 0.4215, weighted_loss: 0.3768, label: 0, bag_size: 3113


class 0 clustering acc 0.9794183445190157: correct 17512/17880
class 1 clustering acc 0.17919463087248322: correct 1068/5960
Epoch: 10, train_loss: 0.7195, train_clustering_loss:  0.6141, train_error: 0.3262
class 0: acc 0.7203389830508474, correct 170/236
class 1: acc 0.5823293172690763, correct 145/249
class 2: acc 0.7192307692307692, correct 187/260

Val Set, val_loss: 0.8048, val_error: 0.3085, auc: 0.8623
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.16356382978723405: correct 123/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1794, instance_loss: 0.7264, weighted_loss: 1.0435, label: 1, bag_size: 2248
batch 39, loss: 0.2954, instance_loss: 0.4173, weighted_loss: 0.3320, label: 1, bag_size: 6992
batch 59, loss: 2.2166, instance_loss: 0.8308, weighted_loss: 1.8009, label: 0, bag_size: 3070
batch 79, loss: 0.5389, instance_loss: 0.2619, weighted_loss: 0.4558, label: 2, bag_size: 88
batch 99, loss: 0.8543, instance_loss: 0.7296, weighted_loss: 0.8169, label: 2, bag_size: 4192
batch 119, loss: 1.2265, instance_loss: 1.0775, weighted_loss: 1.1818, label: 0, bag_size: 1562
batch 139, loss: 0.3055, instance_loss: 0.4182, weighted_loss: 0.3393, label: 2, bag_size: 3746
batch 159, loss: 0.2330, instance_loss: 0.2872, weighted_loss: 0.2492, label: 2, bag_size: 3210
batch 179, loss: 1.2128, instance_loss: 0.5107, weighted_loss: 1.0021, label: 0, bag_size: 5867
batch 199, loss: 0.1060, instance_loss: 0.1915, weighted_loss: 0.1316, label: 2, bag_size: 4088
batch 219, loss: 1.5973, instance_loss: 0.8112, weighted_loss: 1.3615, label: 2, bag_size: 3274
batch 239, loss: 0.5298, instance_loss: 0.5119, weighted_loss: 0.5244, label: 2, bag_size: 3210
batch 259, loss: 0.9515, instance_loss: 0.7419, weighted_loss: 0.8886, label: 1, bag_size: 8632
batch 279, loss: 1.2978, instance_loss: 0.8034, weighted_loss: 1.1495, label: 1, bag_size: 2751
batch 299, loss: 2.3428, instance_loss: 0.8248, weighted_loss: 1.8874, label: 2, bag_size: 4241
batch 319, loss: 0.5389, instance_loss: 0.5740, weighted_loss: 0.5494, label: 0, bag_size: 4325
batch 339, loss: 0.3553, instance_loss: 0.4635, weighted_loss: 0.3878, label: 2, bag_size: 597
batch 359, loss: 0.1367, instance_loss: 0.2975, weighted_loss: 0.1849, label: 1, bag_size: 4027
batch 379, loss: 0.6046, instance_loss: 0.5383, weighted_loss: 0.5847, label: 1, bag_size: 3885
batch 399, loss: 0.2250, instance_loss: 0.4416, weighted_loss: 0.2900, label: 2, bag_size: 4162
batch 419, loss: 0.4776, instance_loss: 0.5894, weighted_loss: 0.5112, label: 2, bag_size: 5637
batch 439, loss: 0.1551, instance_loss: 0.3381, weighted_loss: 0.2100, label: 0, bag_size: 4634
batch 459, loss: 0.4835, instance_loss: 0.5341, weighted_loss: 0.4987, label: 2, bag_size: 4241
batch 479, loss: 0.2297, instance_loss: 0.7889, weighted_loss: 0.3974, label: 1, bag_size: 4181
batch 499, loss: 0.3644, instance_loss: 0.4930, weighted_loss: 0.4030, label: 1, bag_size: 2156
batch 519, loss: 0.2670, instance_loss: 0.5806, weighted_loss: 0.3611, label: 2, bag_size: 4555
batch 539, loss: 2.0706, instance_loss: 0.9732, weighted_loss: 1.7414, label: 0, bag_size: 2217
batch 559, loss: 0.6010, instance_loss: 0.6132, weighted_loss: 0.6047, label: 1, bag_size: 2731
batch 579, loss: 0.8962, instance_loss: 0.4171, weighted_loss: 0.7524, label: 2, bag_size: 2031
batch 599, loss: 0.0662, instance_loss: 0.3030, weighted_loss: 0.1373, label: 1, bag_size: 1836
batch 619, loss: 0.5683, instance_loss: 0.6258, weighted_loss: 0.5855, label: 1, bag_size: 5072
batch 639, loss: 0.2107, instance_loss: 0.5754, weighted_loss: 0.3201, label: 1, bag_size: 3172
batch 659, loss: 0.6311, instance_loss: 0.5594, weighted_loss: 0.6096, label: 0, bag_size: 3370
batch 679, loss: 0.1789, instance_loss: 0.3228, weighted_loss: 0.2220, label: 0, bag_size: 4506
batch 699, loss: 0.5760, instance_loss: 0.9777, weighted_loss: 0.6965, label: 1, bag_size: 3611
batch 719, loss: 0.2154, instance_loss: 0.2913, weighted_loss: 0.2382, label: 0, bag_size: 2841
batch 739, loss: 0.1044, instance_loss: 0.1771, weighted_loss: 0.1262, label: 0, bag_size: 3247


class 0 clustering acc 0.9805928411633109: correct 17533/17880
class 1 clustering acc 0.20939597315436242: correct 1248/5960
Epoch: 11, train_loss: 0.7539, train_clustering_loss:  0.6061, train_error: 0.3369
class 0: acc 0.6806083650190115, correct 179/263
class 1: acc 0.5447154471544715, correct 134/246
class 2: acc 0.7669491525423728, correct 181/236

Val Set, val_loss: 0.6429, val_error: 0.2872, auc: 0.8704
class 0 clustering acc 0.9676418439716312: correct 2183/2256
class 1 clustering acc 0.3603723404255319: correct 271/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.656954 --> 0.642936).  Saving model ...


batch 19, loss: 2.5356, instance_loss: 1.8266, weighted_loss: 2.3229, label: 1, bag_size: 3399
batch 39, loss: 0.0742, instance_loss: 0.0564, weighted_loss: 0.0688, label: 2, bag_size: 4056
batch 59, loss: 1.6055, instance_loss: 0.9297, weighted_loss: 1.4028, label: 1, bag_size: 1307
batch 79, loss: 2.6419, instance_loss: 1.2097, weighted_loss: 2.2123, label: 0, bag_size: 3419
batch 99, loss: 0.6902, instance_loss: 0.5717, weighted_loss: 0.6546, label: 0, bag_size: 3666
batch 119, loss: 0.5349, instance_loss: 0.7023, weighted_loss: 0.5851, label: 1, bag_size: 2182
batch 139, loss: 0.5316, instance_loss: 0.4732, weighted_loss: 0.5141, label: 2, bag_size: 1050
batch 159, loss: 0.0481, instance_loss: 0.0686, weighted_loss: 0.0543, label: 2, bag_size: 4788
batch 179, loss: 0.0074, instance_loss: 0.8692, weighted_loss: 0.2660, label: 0, bag_size: 4485
batch 199, loss: 1.0888, instance_loss: 0.8356, weighted_loss: 1.0128, label: 1, bag_size: 2859
batch 219, loss: 2.1729, instance_loss: 1.2180, weighted_loss: 1.8864, label: 2, bag_size: 4179
batch 239, loss: 0.7760, instance_loss: 0.9873, weighted_loss: 0.8394, label: 1, bag_size: 4181
batch 259, loss: 0.5655, instance_loss: 0.5261, weighted_loss: 0.5537, label: 0, bag_size: 1233
batch 279, loss: 0.5773, instance_loss: 0.5626, weighted_loss: 0.5729, label: 1, bag_size: 4467
batch 299, loss: 0.1478, instance_loss: 0.2966, weighted_loss: 0.1924, label: 0, bag_size: 3539
batch 319, loss: 0.2957, instance_loss: 0.5054, weighted_loss: 0.3586, label: 1, bag_size: 5026
batch 339, loss: 0.3412, instance_loss: 0.2834, weighted_loss: 0.3239, label: 2, bag_size: 2254
batch 359, loss: 0.2850, instance_loss: 0.3557, weighted_loss: 0.3062, label: 1, bag_size: 2945
batch 379, loss: 0.7820, instance_loss: 0.6757, weighted_loss: 0.7501, label: 1, bag_size: 455
batch 399, loss: 0.4513, instance_loss: 0.5750, weighted_loss: 0.4884, label: 1, bag_size: 6475
batch 419, loss: 0.1194, instance_loss: 0.2384, weighted_loss: 0.1551, label: 2, bag_size: 3121
batch 439, loss: 0.9676, instance_loss: 0.6434, weighted_loss: 0.8704, label: 1, bag_size: 3986
batch 459, loss: 1.6255, instance_loss: 1.0165, weighted_loss: 1.4428, label: 0, bag_size: 5017
batch 479, loss: 0.3474, instance_loss: 0.4493, weighted_loss: 0.3779, label: 1, bag_size: 475
batch 499, loss: 0.6532, instance_loss: 0.7671, weighted_loss: 0.6874, label: 1, bag_size: 3184
batch 519, loss: 0.1954, instance_loss: 0.3968, weighted_loss: 0.2559, label: 0, bag_size: 667
batch 539, loss: 0.2708, instance_loss: 0.1492, weighted_loss: 0.2344, label: 2, bag_size: 4856
batch 559, loss: 0.2121, instance_loss: 0.3343, weighted_loss: 0.2488, label: 0, bag_size: 4325
batch 579, loss: 1.1288, instance_loss: 0.8487, weighted_loss: 1.0448, label: 1, bag_size: 3991
batch 599, loss: 0.1493, instance_loss: 0.5184, weighted_loss: 0.2600, label: 2, bag_size: 5017
batch 619, loss: 0.3369, instance_loss: 0.4990, weighted_loss: 0.3856, label: 2, bag_size: 6644
batch 639, loss: 1.1083, instance_loss: 0.5551, weighted_loss: 0.9424, label: 1, bag_size: 19265
batch 659, loss: 1.4608, instance_loss: 0.9796, weighted_loss: 1.3165, label: 1, bag_size: 3438
batch 679, loss: 0.7759, instance_loss: 0.6453, weighted_loss: 0.7367, label: 0, bag_size: 1025
batch 699, loss: 0.1351, instance_loss: 0.2459, weighted_loss: 0.1683, label: 1, bag_size: 314
batch 719, loss: 1.7741, instance_loss: 1.0221, weighted_loss: 1.5485, label: 2, bag_size: 4316
batch 739, loss: 1.0832, instance_loss: 0.4959, weighted_loss: 0.9070, label: 0, bag_size: 4707


class 0 clustering acc 0.9786353467561522: correct 17498/17880
class 1 clustering acc 0.2266778523489933: correct 1351/5960
Epoch: 12, train_loss: 0.7118, train_clustering_loss:  0.5966, train_error: 0.3047
class 0: acc 0.7530364372469636, correct 186/247
class 1: acc 0.5657370517928287, correct 142/251
class 2: acc 0.7692307692307693, correct 190/247

Val Set, val_loss: 0.6606, val_error: 0.2553, auc: 0.8710
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.31117021276595747: correct 234/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3301, instance_loss: 0.4313, weighted_loss: 0.3604, label: 0, bag_size: 5036
batch 39, loss: 0.1929, instance_loss: 0.2485, weighted_loss: 0.2096, label: 0, bag_size: 5006
batch 59, loss: 0.9755, instance_loss: 0.8525, weighted_loss: 0.9386, label: 2, bag_size: 3746
batch 79, loss: 0.8226, instance_loss: 0.6132, weighted_loss: 0.7598, label: 0, bag_size: 5848
batch 99, loss: 0.2361, instance_loss: 0.4222, weighted_loss: 0.2919, label: 0, bag_size: 5375
batch 119, loss: 0.7464, instance_loss: 0.6487, weighted_loss: 0.7171, label: 2, bag_size: 4342
batch 139, loss: 1.3615, instance_loss: 0.7306, weighted_loss: 1.1722, label: 1, bag_size: 578
batch 159, loss: 0.2162, instance_loss: 0.6826, weighted_loss: 0.3561, label: 1, bag_size: 4534
batch 179, loss: 0.6113, instance_loss: 1.0345, weighted_loss: 0.7383, label: 0, bag_size: 5330
batch 199, loss: 0.4775, instance_loss: 0.4880, weighted_loss: 0.4806, label: 0, bag_size: 7177
batch 219, loss: 0.4602, instance_loss: 0.3970, weighted_loss: 0.4413, label: 1, bag_size: 6241
batch 239, loss: 0.4716, instance_loss: 0.5619, weighted_loss: 0.4986, label: 1, bag_size: 455
batch 259, loss: 1.0280, instance_loss: 1.0228, weighted_loss: 1.0264, label: 2, bag_size: 1222
batch 279, loss: 1.3321, instance_loss: 1.0289, weighted_loss: 1.2412, label: 1, bag_size: 6942
batch 299, loss: 0.1229, instance_loss: 0.2259, weighted_loss: 0.1538, label: 2, bag_size: 5138
batch 319, loss: 0.9100, instance_loss: 0.7841, weighted_loss: 0.8722, label: 1, bag_size: 4940
batch 339, loss: 0.7158, instance_loss: 0.6950, weighted_loss: 0.7095, label: 1, bag_size: 3497
batch 359, loss: 0.6525, instance_loss: 0.9201, weighted_loss: 0.7328, label: 1, bag_size: 2472
batch 379, loss: 0.0509, instance_loss: 0.1746, weighted_loss: 0.0880, label: 2, bag_size: 5924
batch 399, loss: 0.3130, instance_loss: 0.3548, weighted_loss: 0.3256, label: 0, bag_size: 7077
batch 419, loss: 0.7974, instance_loss: 0.6839, weighted_loss: 0.7634, label: 1, bag_size: 3885
batch 439, loss: 0.9082, instance_loss: 1.0707, weighted_loss: 0.9569, label: 1, bag_size: 1197
batch 459, loss: 0.8480, instance_loss: 0.6145, weighted_loss: 0.7779, label: 2, bag_size: 6298
batch 479, loss: 1.2807, instance_loss: 1.1691, weighted_loss: 1.2472, label: 2, bag_size: 22464
batch 499, loss: 0.1110, instance_loss: 0.4442, weighted_loss: 0.2110, label: 2, bag_size: 4555
batch 519, loss: 0.7187, instance_loss: 0.8202, weighted_loss: 0.7491, label: 1, bag_size: 4705
batch 539, loss: 1.2910, instance_loss: 0.8706, weighted_loss: 1.1649, label: 2, bag_size: 4342
batch 559, loss: 0.0830, instance_loss: 0.0971, weighted_loss: 0.0872, label: 2, bag_size: 6148
batch 579, loss: 1.1553, instance_loss: 0.8906, weighted_loss: 1.0759, label: 1, bag_size: 2747
batch 599, loss: 1.2471, instance_loss: 0.9783, weighted_loss: 1.1665, label: 0, bag_size: 16741
batch 619, loss: 0.2052, instance_loss: 0.4767, weighted_loss: 0.2866, label: 2, bag_size: 5011
batch 639, loss: 1.0623, instance_loss: 0.9706, weighted_loss: 1.0348, label: 0, bag_size: 4711
batch 659, loss: 0.6824, instance_loss: 0.6223, weighted_loss: 0.6644, label: 1, bag_size: 800
batch 679, loss: 1.2720, instance_loss: 1.0727, weighted_loss: 1.2122, label: 2, bag_size: 4342
batch 699, loss: 1.1483, instance_loss: 0.8880, weighted_loss: 1.0702, label: 1, bag_size: 3016
batch 719, loss: 1.3452, instance_loss: 0.6792, weighted_loss: 1.1454, label: 2, bag_size: 5637
batch 739, loss: 0.1641, instance_loss: 0.7183, weighted_loss: 0.3303, label: 2, bag_size: 4497


class 0 clustering acc 0.977572706935123: correct 17479/17880
class 1 clustering acc 0.2506711409395973: correct 1494/5960
Epoch: 13, train_loss: 0.7030, train_clustering_loss:  0.5927, train_error: 0.3114
class 0: acc 0.7021276595744681, correct 165/235
class 1: acc 0.5551020408163265, correct 136/245
class 2: acc 0.8, correct 212/265

Val Set, val_loss: 0.7641, val_error: 0.3404, auc: 0.8478
class 0 clustering acc 0.9906914893617021: correct 2235/2256
class 1 clustering acc 0.19148936170212766: correct 144/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.25, correct 3/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7867, instance_loss: 0.6476, weighted_loss: 0.7450, label: 0, bag_size: 3310
batch 39, loss: 1.2118, instance_loss: 0.6203, weighted_loss: 1.0343, label: 1, bag_size: 4373
batch 59, loss: 0.1527, instance_loss: 0.2501, weighted_loss: 0.1819, label: 2, bag_size: 4569
batch 79, loss: 0.3759, instance_loss: 0.5394, weighted_loss: 0.4250, label: 2, bag_size: 4140
batch 99, loss: 0.9924, instance_loss: 0.3845, weighted_loss: 0.8101, label: 2, bag_size: 3026
batch 119, loss: 0.3652, instance_loss: 0.3713, weighted_loss: 0.3670, label: 0, bag_size: 4626
batch 139, loss: 0.1567, instance_loss: 0.2682, weighted_loss: 0.1901, label: 2, bag_size: 3176
batch 159, loss: 1.5742, instance_loss: 0.6266, weighted_loss: 1.2899, label: 1, bag_size: 1670
batch 179, loss: 0.9385, instance_loss: 0.9192, weighted_loss: 0.9327, label: 0, bag_size: 4479
batch 199, loss: 0.9170, instance_loss: 0.6862, weighted_loss: 0.8477, label: 0, bag_size: 3701
batch 219, loss: 0.1170, instance_loss: 0.4073, weighted_loss: 0.2041, label: 0, bag_size: 4403
batch 239, loss: 3.2926, instance_loss: 1.2992, weighted_loss: 2.6946, label: 2, bag_size: 3475
batch 259, loss: 0.6635, instance_loss: 0.6381, weighted_loss: 0.6559, label: 1, bag_size: 578
batch 279, loss: 2.0666, instance_loss: 1.2218, weighted_loss: 1.8131, label: 0, bag_size: 14791
batch 299, loss: 0.1230, instance_loss: 0.4657, weighted_loss: 0.2258, label: 0, bag_size: 996
batch 319, loss: 1.2480, instance_loss: 1.2925, weighted_loss: 1.2613, label: 1, bag_size: 936
batch 339, loss: 0.7269, instance_loss: 0.8804, weighted_loss: 0.7729, label: 2, bag_size: 5072
batch 359, loss: 0.1425, instance_loss: 0.2507, weighted_loss: 0.1750, label: 0, bag_size: 4529
batch 379, loss: 0.2054, instance_loss: 0.2297, weighted_loss: 0.2127, label: 2, bag_size: 597
batch 399, loss: 0.0566, instance_loss: 0.0826, weighted_loss: 0.0644, label: 2, bag_size: 3210
batch 419, loss: 0.2671, instance_loss: 0.4944, weighted_loss: 0.3353, label: 0, bag_size: 2608
batch 439, loss: 1.7740, instance_loss: 0.8789, weighted_loss: 1.5055, label: 1, bag_size: 3508
batch 459, loss: 0.0461, instance_loss: 0.3298, weighted_loss: 0.1312, label: 1, bag_size: 259
batch 479, loss: 0.0681, instance_loss: 0.2325, weighted_loss: 0.1174, label: 2, bag_size: 4487
batch 499, loss: 0.6325, instance_loss: 0.5050, weighted_loss: 0.5942, label: 1, bag_size: 209
batch 519, loss: 0.1965, instance_loss: 0.1585, weighted_loss: 0.1851, label: 2, bag_size: 2501
batch 539, loss: 1.4944, instance_loss: 0.8777, weighted_loss: 1.3094, label: 0, bag_size: 3070
batch 559, loss: 1.2075, instance_loss: 0.9125, weighted_loss: 1.1190, label: 0, bag_size: 2217
batch 579, loss: 0.0904, instance_loss: 0.1304, weighted_loss: 0.1024, label: 2, bag_size: 6001
batch 599, loss: 0.0290, instance_loss: 0.2683, weighted_loss: 0.1008, label: 2, bag_size: 2770
batch 619, loss: 0.6412, instance_loss: 0.3874, weighted_loss: 0.5651, label: 2, bag_size: 3210
batch 639, loss: 0.9275, instance_loss: 0.7378, weighted_loss: 0.8706, label: 1, bag_size: 4784
batch 659, loss: 0.0723, instance_loss: 0.2286, weighted_loss: 0.1192, label: 2, bag_size: 4302
batch 679, loss: 0.1517, instance_loss: 0.3570, weighted_loss: 0.2132, label: 1, bag_size: 6992
batch 699, loss: 1.1448, instance_loss: 0.7066, weighted_loss: 1.0134, label: 0, bag_size: 2915
batch 719, loss: 0.3277, instance_loss: 0.7379, weighted_loss: 0.4508, label: 1, bag_size: 779
batch 739, loss: 0.3679, instance_loss: 0.3741, weighted_loss: 0.3698, label: 0, bag_size: 6927


class 0 clustering acc 0.9771252796420582: correct 17471/17880
class 1 clustering acc 0.24916107382550334: correct 1485/5960
Epoch: 14, train_loss: 0.7103, train_clustering_loss:  0.5871, train_error: 0.2966
class 0: acc 0.6756756756756757, correct 150/222
class 1: acc 0.6718146718146718, correct 174/259
class 2: acc 0.7575757575757576, correct 200/264

Val Set, val_loss: 0.6290, val_error: 0.2766, auc: 0.8791
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.1422872340425532: correct 107/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.642936 --> 0.628986).  Saving model ...


batch 19, loss: 0.0475, instance_loss: 0.0790, weighted_loss: 0.0570, label: 2, bag_size: 657
batch 39, loss: 3.3995, instance_loss: 1.5543, weighted_loss: 2.8460, label: 1, bag_size: 4258
batch 59, loss: 0.6585, instance_loss: 0.6761, weighted_loss: 0.6638, label: 1, bag_size: 3885
batch 79, loss: 0.7703, instance_loss: 0.6553, weighted_loss: 0.7358, label: 1, bag_size: 817
batch 99, loss: 0.4342, instance_loss: 0.7165, weighted_loss: 0.5189, label: 2, bag_size: 3604
batch 119, loss: 1.5205, instance_loss: 0.9291, weighted_loss: 1.3431, label: 1, bag_size: 1364
batch 139, loss: 0.1798, instance_loss: 0.2526, weighted_loss: 0.2017, label: 0, bag_size: 3727
batch 159, loss: 2.8049, instance_loss: 1.5367, weighted_loss: 2.4244, label: 2, bag_size: 4241
batch 179, loss: 0.5578, instance_loss: 0.4741, weighted_loss: 0.5326, label: 1, bag_size: 302
batch 199, loss: 1.7299, instance_loss: 1.1905, weighted_loss: 1.5681, label: 2, bag_size: 4910
batch 219, loss: 0.2256, instance_loss: 0.4319, weighted_loss: 0.2875, label: 0, bag_size: 1812
batch 239, loss: 0.4581, instance_loss: 0.5054, weighted_loss: 0.4723, label: 2, bag_size: 5637
batch 259, loss: 0.0071, instance_loss: 0.0263, weighted_loss: 0.0129, label: 2, bag_size: 4856
batch 279, loss: 0.8058, instance_loss: 0.9070, weighted_loss: 0.8361, label: 1, bag_size: 4940
batch 299, loss: 0.3195, instance_loss: 0.4225, weighted_loss: 0.3504, label: 0, bag_size: 667
batch 319, loss: 0.5657, instance_loss: 0.7162, weighted_loss: 0.6108, label: 1, bag_size: 3396
batch 339, loss: 0.0588, instance_loss: 0.1308, weighted_loss: 0.0804, label: 2, bag_size: 5914
batch 359, loss: 0.2126, instance_loss: 0.5410, weighted_loss: 0.3111, label: 1, bag_size: 3558
batch 379, loss: 0.2565, instance_loss: 0.1524, weighted_loss: 0.2253, label: 2, bag_size: 2561
batch 399, loss: 0.3577, instance_loss: 0.5591, weighted_loss: 0.4181, label: 2, bag_size: 3778
batch 419, loss: 1.7360, instance_loss: 0.8542, weighted_loss: 1.4715, label: 2, bag_size: 724
batch 439, loss: 0.0320, instance_loss: 0.1310, weighted_loss: 0.0617, label: 2, bag_size: 3497
batch 459, loss: 0.4815, instance_loss: 0.5124, weighted_loss: 0.4908, label: 0, bag_size: 3797
batch 479, loss: 3.1689, instance_loss: 1.6254, weighted_loss: 2.7059, label: 1, bag_size: 1558
batch 499, loss: 0.5226, instance_loss: 0.3806, weighted_loss: 0.4800, label: 0, bag_size: 6971
batch 519, loss: 0.2603, instance_loss: 0.4396, weighted_loss: 0.3141, label: 1, bag_size: 6277
batch 539, loss: 0.4374, instance_loss: 0.4250, weighted_loss: 0.4337, label: 0, bag_size: 3297
batch 559, loss: 0.1096, instance_loss: 0.5095, weighted_loss: 0.2296, label: 1, bag_size: 2945
batch 579, loss: 1.0644, instance_loss: 0.8745, weighted_loss: 1.0074, label: 0, bag_size: 5017
batch 599, loss: 0.2089, instance_loss: 0.1106, weighted_loss: 0.1794, label: 2, bag_size: 3678
batch 619, loss: 0.0402, instance_loss: 0.0473, weighted_loss: 0.0423, label: 2, bag_size: 6026
batch 639, loss: 0.1052, instance_loss: 0.4867, weighted_loss: 0.2196, label: 1, bag_size: 2453
batch 659, loss: 0.8196, instance_loss: 0.7365, weighted_loss: 0.7947, label: 1, bag_size: 3640
batch 679, loss: 0.7806, instance_loss: 0.8389, weighted_loss: 0.7981, label: 0, bag_size: 1611
batch 699, loss: 0.4579, instance_loss: 0.6473, weighted_loss: 0.5147, label: 1, bag_size: 8482
batch 719, loss: 0.6522, instance_loss: 0.6342, weighted_loss: 0.6468, label: 1, bag_size: 782
batch 739, loss: 1.0940, instance_loss: 0.8844, weighted_loss: 1.0311, label: 2, bag_size: 2486


class 0 clustering acc 0.977572706935123: correct 17479/17880
class 1 clustering acc 0.25738255033557045: correct 1534/5960
Epoch: 15, train_loss: 0.6582, train_clustering_loss:  0.5682, train_error: 0.2899
class 0: acc 0.75, correct 195/260
class 1: acc 0.6245059288537549, correct 158/253
class 2: acc 0.7586206896551724, correct 176/232

Val Set, val_loss: 0.6242, val_error: 0.2660, auc: 0.8784
class 0 clustering acc 0.9587765957446809: correct 2163/2256
class 1 clustering acc 0.4122340425531915: correct 310/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.628986 --> 0.624239).  Saving model ...


batch 19, loss: 0.7367, instance_loss: 0.4984, weighted_loss: 0.6652, label: 0, bag_size: 3397
batch 39, loss: 1.5772, instance_loss: 0.6756, weighted_loss: 1.3067, label: 0, bag_size: 4719
batch 59, loss: 0.0046, instance_loss: 0.3589, weighted_loss: 0.1109, label: 1, bag_size: 3338
batch 79, loss: 0.7286, instance_loss: 0.6055, weighted_loss: 0.6917, label: 0, bag_size: 313
batch 99, loss: 0.7355, instance_loss: 0.6122, weighted_loss: 0.6985, label: 2, bag_size: 3678
batch 119, loss: 1.9215, instance_loss: 1.5006, weighted_loss: 1.7952, label: 1, bag_size: 1477
batch 139, loss: 0.1137, instance_loss: 0.2815, weighted_loss: 0.1640, label: 2, bag_size: 2313
batch 159, loss: 1.0453, instance_loss: 0.6258, weighted_loss: 0.9195, label: 1, bag_size: 2248
batch 179, loss: 0.7027, instance_loss: 0.5097, weighted_loss: 0.6448, label: 1, bag_size: 3225
batch 199, loss: 0.6581, instance_loss: 0.3398, weighted_loss: 0.5626, label: 2, bag_size: 3678
batch 219, loss: 2.7070, instance_loss: 1.0972, weighted_loss: 2.2241, label: 2, bag_size: 4316
batch 239, loss: 0.3424, instance_loss: 0.5017, weighted_loss: 0.3902, label: 1, bag_size: 5072
batch 259, loss: 2.1171, instance_loss: 1.3803, weighted_loss: 1.8960, label: 1, bag_size: 3399
batch 279, loss: 1.3287, instance_loss: 0.7892, weighted_loss: 1.1668, label: 0, bag_size: 609
batch 299, loss: 1.2917, instance_loss: 0.5516, weighted_loss: 1.0697, label: 0, bag_size: 4146
batch 319, loss: 0.3678, instance_loss: 0.2679, weighted_loss: 0.3378, label: 2, bag_size: 3678
batch 339, loss: 0.0630, instance_loss: 0.0705, weighted_loss: 0.0653, label: 2, bag_size: 4691
batch 359, loss: 0.0382, instance_loss: 0.2102, weighted_loss: 0.0898, label: 0, bag_size: 4083
batch 379, loss: 0.5206, instance_loss: 0.4557, weighted_loss: 0.5011, label: 0, bag_size: 4626
batch 399, loss: 0.0579, instance_loss: 0.4866, weighted_loss: 0.1865, label: 1, bag_size: 3677
batch 419, loss: 0.3772, instance_loss: 0.6995, weighted_loss: 0.4739, label: 0, bag_size: 5017
batch 439, loss: 0.7024, instance_loss: 1.4341, weighted_loss: 0.9219, label: 2, bag_size: 22464
batch 459, loss: 0.4803, instance_loss: 0.6283, weighted_loss: 0.5247, label: 0, bag_size: 5646
batch 479, loss: 0.3018, instance_loss: 0.4213, weighted_loss: 0.3377, label: 0, bag_size: 2378
batch 499, loss: 0.3789, instance_loss: 0.5565, weighted_loss: 0.4322, label: 2, bag_size: 3397
batch 519, loss: 1.3104, instance_loss: 0.6968, weighted_loss: 1.1263, label: 0, bag_size: 5840
batch 539, loss: 0.5986, instance_loss: 0.3899, weighted_loss: 0.5360, label: 0, bag_size: 4157
batch 559, loss: 0.2450, instance_loss: 0.4231, weighted_loss: 0.2985, label: 1, bag_size: 3127
batch 579, loss: 0.8933, instance_loss: 0.7318, weighted_loss: 0.8448, label: 1, bag_size: 3422
batch 599, loss: 2.6510, instance_loss: 0.9876, weighted_loss: 2.1520, label: 2, bag_size: 552
batch 619, loss: 0.3014, instance_loss: 0.5187, weighted_loss: 0.3665, label: 0, bag_size: 1611
batch 639, loss: 0.7161, instance_loss: 0.6143, weighted_loss: 0.6855, label: 1, bag_size: 2248
batch 659, loss: 1.4716, instance_loss: 0.8321, weighted_loss: 1.2798, label: 2, bag_size: 4241
batch 679, loss: 0.9574, instance_loss: 0.4945, weighted_loss: 0.8185, label: 2, bag_size: 2031
batch 699, loss: 1.4931, instance_loss: 0.9705, weighted_loss: 1.3363, label: 2, bag_size: 4179
batch 719, loss: 0.2340, instance_loss: 0.1709, weighted_loss: 0.2150, label: 2, bag_size: 1094
batch 739, loss: 0.2655, instance_loss: 0.3240, weighted_loss: 0.2830, label: 0, bag_size: 1495


class 0 clustering acc 0.9739373601789709: correct 17414/17880
class 1 clustering acc 0.25771812080536916: correct 1536/5960
Epoch: 16, train_loss: 0.6911, train_clustering_loss:  0.6025, train_error: 0.2980
class 0: acc 0.7587548638132295, correct 195/257
class 1: acc 0.6228813559322034, correct 147/236
class 2: acc 0.7182539682539683, correct 181/252

Val Set, val_loss: 0.7352, val_error: 0.2766, auc: 0.8709
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.3071808510638298: correct 231/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0785, instance_loss: 0.9061, weighted_loss: 1.0268, label: 2, bag_size: 3274
batch 39, loss: 0.5622, instance_loss: 0.5872, weighted_loss: 0.5697, label: 1, bag_size: 1607
batch 59, loss: 0.0528, instance_loss: 0.3243, weighted_loss: 0.1343, label: 2, bag_size: 3497
batch 79, loss: 2.1898, instance_loss: 1.0372, weighted_loss: 1.8441, label: 1, bag_size: 5880
batch 99, loss: 0.5928, instance_loss: 0.6202, weighted_loss: 0.6010, label: 1, bag_size: 3460
batch 119, loss: 0.6553, instance_loss: 0.6686, weighted_loss: 0.6593, label: 0, bag_size: 2232
batch 139, loss: 1.8763, instance_loss: 1.1114, weighted_loss: 1.6468, label: 2, bag_size: 3475
batch 159, loss: 1.0968, instance_loss: 0.7594, weighted_loss: 0.9956, label: 0, bag_size: 5950
batch 179, loss: 0.0901, instance_loss: 0.1953, weighted_loss: 0.1217, label: 2, bag_size: 3121
batch 199, loss: 1.0290, instance_loss: 0.7554, weighted_loss: 0.9469, label: 1, bag_size: 6241
batch 219, loss: 1.7091, instance_loss: 0.9530, weighted_loss: 1.4822, label: 2, bag_size: 4316
batch 239, loss: 0.8988, instance_loss: 0.8001, weighted_loss: 0.8692, label: 1, bag_size: 4612
batch 259, loss: 0.2523, instance_loss: 0.3098, weighted_loss: 0.2696, label: 0, bag_size: 3247
batch 279, loss: 0.5669, instance_loss: 0.6837, weighted_loss: 0.6020, label: 0, bag_size: 4147
batch 299, loss: 0.7665, instance_loss: 0.7684, weighted_loss: 0.7671, label: 2, bag_size: 3778
batch 319, loss: 1.3397, instance_loss: 0.9045, weighted_loss: 1.2091, label: 2, bag_size: 1513
batch 339, loss: 0.8191, instance_loss: 0.5555, weighted_loss: 0.7400, label: 0, bag_size: 5848
batch 359, loss: 0.4973, instance_loss: 0.6727, weighted_loss: 0.5499, label: 0, bag_size: 1562
batch 379, loss: 0.2806, instance_loss: 0.3488, weighted_loss: 0.3011, label: 0, bag_size: 5413
batch 399, loss: 0.6740, instance_loss: 0.5612, weighted_loss: 0.6402, label: 0, bag_size: 4228
batch 419, loss: 1.1869, instance_loss: 0.6538, weighted_loss: 1.0270, label: 2, bag_size: 5406
batch 439, loss: 1.6271, instance_loss: 0.8852, weighted_loss: 1.4045, label: 0, bag_size: 5023
batch 459, loss: 1.2350, instance_loss: 0.9332, weighted_loss: 1.1445, label: 0, bag_size: 22822
batch 479, loss: 0.2828, instance_loss: 0.9792, weighted_loss: 0.4917, label: 1, bag_size: 4181
batch 499, loss: 0.3131, instance_loss: 0.3614, weighted_loss: 0.3276, label: 2, bag_size: 4096
batch 519, loss: 0.8428, instance_loss: 0.8613, weighted_loss: 0.8483, label: 2, bag_size: 1222
batch 539, loss: 0.2877, instance_loss: 0.6742, weighted_loss: 0.4036, label: 2, bag_size: 4192
batch 559, loss: 1.2125, instance_loss: 0.9212, weighted_loss: 1.1251, label: 1, bag_size: 2751
batch 579, loss: 0.4972, instance_loss: 0.2641, weighted_loss: 0.4273, label: 0, bag_size: 8611
batch 599, loss: 0.0742, instance_loss: 0.1770, weighted_loss: 0.1051, label: 0, bag_size: 1176
batch 619, loss: 0.1061, instance_loss: 0.2551, weighted_loss: 0.1508, label: 0, bag_size: 7330
batch 639, loss: 0.0920, instance_loss: 0.3894, weighted_loss: 0.1812, label: 1, bag_size: 1836
batch 659, loss: 0.0601, instance_loss: 0.2601, weighted_loss: 0.1201, label: 1, bag_size: 3983
batch 679, loss: 0.0214, instance_loss: 0.5315, weighted_loss: 0.1744, label: 1, bag_size: 4027
batch 699, loss: 0.3144, instance_loss: 0.6058, weighted_loss: 0.4018, label: 1, bag_size: 700
batch 719, loss: 0.9472, instance_loss: 0.4557, weighted_loss: 0.7998, label: 1, bag_size: 4067
batch 739, loss: 0.3407, instance_loss: 0.6198, weighted_loss: 0.4245, label: 1, bag_size: 4812


class 0 clustering acc 0.9729306487695749: correct 17396/17880
class 1 clustering acc 0.2651006711409396: correct 1580/5960
Epoch: 17, train_loss: 0.6844, train_clustering_loss:  0.5920, train_error: 0.2886
class 0: acc 0.8038461538461539, correct 209/260
class 1: acc 0.5434782608695652, correct 125/230
class 2: acc 0.7686274509803922, correct 196/255

Val Set, val_loss: 0.6483, val_error: 0.2766, auc: 0.8746
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.375: correct 282/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3224, instance_loss: 0.4684, weighted_loss: 0.3662, label: 0, bag_size: 2293
batch 39, loss: 0.1425, instance_loss: 0.5577, weighted_loss: 0.2671, label: 1, bag_size: 3333
batch 59, loss: 0.1080, instance_loss: 0.1909, weighted_loss: 0.1328, label: 2, bag_size: 2481
batch 79, loss: 0.3665, instance_loss: 0.6190, weighted_loss: 0.4422, label: 2, bag_size: 22464
batch 99, loss: 0.0299, instance_loss: 0.4812, weighted_loss: 0.1653, label: 1, bag_size: 3338
batch 119, loss: 0.9820, instance_loss: 0.5999, weighted_loss: 0.8673, label: 0, bag_size: 3661
batch 139, loss: 0.4481, instance_loss: 0.4564, weighted_loss: 0.4506, label: 1, bag_size: 3156
batch 159, loss: 0.2099, instance_loss: 0.1733, weighted_loss: 0.1989, label: 2, bag_size: 1094
batch 179, loss: 0.9123, instance_loss: 0.6900, weighted_loss: 0.8456, label: 2, bag_size: 552
batch 199, loss: 0.1387, instance_loss: 0.1548, weighted_loss: 0.1435, label: 2, bag_size: 6026
batch 219, loss: 0.5571, instance_loss: 0.6808, weighted_loss: 0.5942, label: 0, bag_size: 1904
batch 239, loss: 0.2052, instance_loss: 0.2706, weighted_loss: 0.2248, label: 0, bag_size: 4531
batch 259, loss: 1.2572, instance_loss: 0.8245, weighted_loss: 1.1274, label: 1, bag_size: 5197
batch 279, loss: 0.3381, instance_loss: 0.5337, weighted_loss: 0.3968, label: 2, bag_size: 3746
batch 299, loss: 0.1230, instance_loss: 0.2254, weighted_loss: 0.1537, label: 2, bag_size: 3397
batch 319, loss: 0.2432, instance_loss: 0.3802, weighted_loss: 0.2843, label: 0, bag_size: 7169
batch 339, loss: 1.4656, instance_loss: 0.7437, weighted_loss: 1.2490, label: 2, bag_size: 728
batch 359, loss: 0.4515, instance_loss: 0.6810, weighted_loss: 0.5204, label: 1, bag_size: 3357
batch 379, loss: 0.3199, instance_loss: 0.4347, weighted_loss: 0.3544, label: 0, bag_size: 4678
batch 399, loss: 0.9943, instance_loss: 0.6818, weighted_loss: 0.9006, label: 1, bag_size: 3460
batch 419, loss: 0.7389, instance_loss: 0.7282, weighted_loss: 0.7357, label: 0, bag_size: 3675
batch 439, loss: 0.2852, instance_loss: 0.3090, weighted_loss: 0.2923, label: 2, bag_size: 2481
batch 459, loss: 0.5734, instance_loss: 0.3964, weighted_loss: 0.5203, label: 0, bag_size: 3033
batch 479, loss: 1.1463, instance_loss: 1.0054, weighted_loss: 1.1040, label: 1, bag_size: 1066
batch 499, loss: 0.0513, instance_loss: 0.0995, weighted_loss: 0.0657, label: 2, bag_size: 6001
batch 519, loss: 0.4046, instance_loss: 0.3534, weighted_loss: 0.3892, label: 0, bag_size: 4344
batch 539, loss: 1.3014, instance_loss: 0.9566, weighted_loss: 1.1980, label: 2, bag_size: 4342
batch 559, loss: 0.3131, instance_loss: 0.4978, weighted_loss: 0.3685, label: 0, bag_size: 598
batch 579, loss: 0.2227, instance_loss: 0.4561, weighted_loss: 0.2927, label: 0, bag_size: 2545
batch 599, loss: 0.2194, instance_loss: 0.2319, weighted_loss: 0.2232, label: 0, bag_size: 6440
batch 619, loss: 0.2521, instance_loss: 0.1853, weighted_loss: 0.2321, label: 2, bag_size: 4043
batch 639, loss: 2.3143, instance_loss: 1.3307, weighted_loss: 2.0192, label: 1, bag_size: 2425
batch 659, loss: 0.9084, instance_loss: 0.8404, weighted_loss: 0.8880, label: 0, bag_size: 6285
batch 679, loss: 0.1587, instance_loss: 0.5123, weighted_loss: 0.2648, label: 1, bag_size: 3172
batch 699, loss: 0.4597, instance_loss: 0.6176, weighted_loss: 0.5070, label: 0, bag_size: 5340
batch 719, loss: 0.0982, instance_loss: 0.2788, weighted_loss: 0.1524, label: 0, bag_size: 1647
batch 739, loss: 0.9617, instance_loss: 0.7837, weighted_loss: 0.9083, label: 0, bag_size: 4547


class 0 clustering acc 0.9753355704697987: correct 17439/17880
class 1 clustering acc 0.2726510067114094: correct 1625/5960
Epoch: 18, train_loss: 0.6717, train_clustering_loss:  0.5793, train_error: 0.2993
class 0: acc 0.7366412213740458, correct 193/262
class 1: acc 0.6135458167330677, correct 154/251
class 2: acc 0.7543103448275862, correct 175/232

Val Set, val_loss: 0.5963, val_error: 0.2766, auc: 0.8870
class 0 clustering acc 0.9587765957446809: correct 2163/2256
class 1 clustering acc 0.425531914893617: correct 320/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.624239 --> 0.596255).  Saving model ...


batch 19, loss: 2.7382, instance_loss: 1.4960, weighted_loss: 2.3656, label: 1, bag_size: 5205
batch 39, loss: 0.1316, instance_loss: 0.1677, weighted_loss: 0.1424, label: 2, bag_size: 4088
batch 59, loss: 1.0288, instance_loss: 0.7536, weighted_loss: 0.9462, label: 1, bag_size: 4200
batch 79, loss: 0.0100, instance_loss: 0.1836, weighted_loss: 0.0621, label: 0, bag_size: 1910
batch 99, loss: 0.9528, instance_loss: 0.9107, weighted_loss: 0.9401, label: 1, bag_size: 3821
batch 119, loss: 1.2668, instance_loss: 0.8291, weighted_loss: 1.1355, label: 0, bag_size: 4509
batch 139, loss: 1.5700, instance_loss: 0.9713, weighted_loss: 1.3904, label: 2, bag_size: 223
batch 159, loss: 0.1078, instance_loss: 0.0855, weighted_loss: 0.1011, label: 2, bag_size: 2561
batch 179, loss: 0.0462, instance_loss: 0.0855, weighted_loss: 0.0580, label: 2, bag_size: 3678
batch 199, loss: 0.0351, instance_loss: 0.3572, weighted_loss: 0.1318, label: 0, bag_size: 4403
batch 219, loss: 0.4244, instance_loss: 0.3985, weighted_loss: 0.4167, label: 0, bag_size: 6440
batch 239, loss: 0.4170, instance_loss: 0.3640, weighted_loss: 0.4011, label: 2, bag_size: 597
batch 259, loss: 0.3950, instance_loss: 0.3328, weighted_loss: 0.3764, label: 0, bag_size: 3113
batch 279, loss: 0.8798, instance_loss: 0.6937, weighted_loss: 0.8240, label: 1, bag_size: 3823
batch 299, loss: 0.0666, instance_loss: 0.2909, weighted_loss: 0.1339, label: 1, bag_size: 3127
batch 319, loss: 0.9095, instance_loss: 0.6597, weighted_loss: 0.8346, label: 1, bag_size: 3823
batch 339, loss: 0.4193, instance_loss: 0.3353, weighted_loss: 0.3941, label: 0, bag_size: 5890
batch 359, loss: 0.2728, instance_loss: 0.5417, weighted_loss: 0.3535, label: 0, bag_size: 4678
batch 379, loss: 0.5056, instance_loss: 0.4776, weighted_loss: 0.4972, label: 0, bag_size: 4544
batch 399, loss: 0.1159, instance_loss: 0.1259, weighted_loss: 0.1189, label: 0, bag_size: 5108
batch 419, loss: 0.2662, instance_loss: 0.3833, weighted_loss: 0.3013, label: 1, bag_size: 3367
batch 439, loss: 0.6017, instance_loss: 0.5720, weighted_loss: 0.5928, label: 2, bag_size: 4132
batch 459, loss: 1.2200, instance_loss: 1.1740, weighted_loss: 1.2062, label: 2, bag_size: 4910
batch 479, loss: 0.1978, instance_loss: 0.2792, weighted_loss: 0.2222, label: 2, bag_size: 2905
batch 499, loss: 0.8866, instance_loss: 0.6469, weighted_loss: 0.8147, label: 1, bag_size: 3885
batch 519, loss: 0.0548, instance_loss: 0.0810, weighted_loss: 0.0627, label: 2, bag_size: 4856
batch 539, loss: 0.3473, instance_loss: 0.6079, weighted_loss: 0.4255, label: 0, bag_size: 3245
batch 559, loss: 0.1193, instance_loss: 0.3498, weighted_loss: 0.1884, label: 2, bag_size: 3618
batch 579, loss: 0.0215, instance_loss: 0.1614, weighted_loss: 0.0635, label: 2, bag_size: 5138
batch 599, loss: 0.4340, instance_loss: 0.3047, weighted_loss: 0.3952, label: 0, bag_size: 4378
batch 619, loss: 1.2095, instance_loss: 0.6225, weighted_loss: 1.0334, label: 2, bag_size: 4571
batch 639, loss: 0.2222, instance_loss: 0.2969, weighted_loss: 0.2447, label: 2, bag_size: 2997
batch 659, loss: 1.1449, instance_loss: 0.7170, weighted_loss: 1.0166, label: 1, bag_size: 1364
batch 679, loss: 1.4712, instance_loss: 0.7865, weighted_loss: 1.2658, label: 1, bag_size: 3986
batch 699, loss: 0.6874, instance_loss: 0.6372, weighted_loss: 0.6723, label: 1, bag_size: 3755
batch 719, loss: 1.3420, instance_loss: 1.1905, weighted_loss: 1.2965, label: 0, bag_size: 1904
batch 739, loss: 1.3229, instance_loss: 0.6340, weighted_loss: 1.1162, label: 0, bag_size: 5125


class 0 clustering acc 0.9728187919463087: correct 17394/17880
class 1 clustering acc 0.2728187919463087: correct 1626/5960
Epoch: 19, train_loss: 0.6830, train_clustering_loss:  0.5881, train_error: 0.2926
class 0: acc 0.7410358565737052, correct 186/251
class 1: acc 0.5708333333333333, correct 137/240
class 2: acc 0.8031496062992126, correct 204/254

Val Set, val_loss: 0.7923, val_error: 0.2979, auc: 0.8752
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.23404255319148937: correct 176/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5677, instance_loss: 0.4681, weighted_loss: 0.5378, label: 1, bag_size: 3225
batch 39, loss: 0.3194, instance_loss: 0.4730, weighted_loss: 0.3654, label: 1, bag_size: 3050
batch 59, loss: 0.2197, instance_loss: 0.3074, weighted_loss: 0.2460, label: 0, bag_size: 4734
batch 79, loss: 0.0366, instance_loss: 0.2554, weighted_loss: 0.1023, label: 0, bag_size: 996
batch 99, loss: 0.3404, instance_loss: 0.6597, weighted_loss: 0.4362, label: 0, bag_size: 2195
batch 119, loss: 0.6084, instance_loss: 0.9428, weighted_loss: 0.7087, label: 0, bag_size: 5017
batch 139, loss: 0.1482, instance_loss: 0.2782, weighted_loss: 0.1872, label: 0, bag_size: 3443
batch 159, loss: 0.5346, instance_loss: 1.9444, weighted_loss: 0.9575, label: 1, bag_size: 6025
batch 179, loss: 0.4564, instance_loss: 0.5679, weighted_loss: 0.4899, label: 1, bag_size: 5276
batch 199, loss: 0.3262, instance_loss: 0.4769, weighted_loss: 0.3714, label: 0, bag_size: 7595
batch 219, loss: 1.3109, instance_loss: 0.7690, weighted_loss: 1.1483, label: 0, bag_size: 3070
batch 239, loss: 2.2531, instance_loss: 1.1648, weighted_loss: 1.9266, label: 0, bag_size: 1904
batch 259, loss: 1.0542, instance_loss: 0.4955, weighted_loss: 0.8866, label: 1, bag_size: 4438
batch 279, loss: 0.0475, instance_loss: 0.3100, weighted_loss: 0.1262, label: 1, bag_size: 3367
batch 299, loss: 1.0414, instance_loss: 0.7839, weighted_loss: 0.9642, label: 2, bag_size: 5307
batch 319, loss: 0.0509, instance_loss: 0.1658, weighted_loss: 0.0853, label: 0, bag_size: 3103
batch 339, loss: 0.5942, instance_loss: 0.3986, weighted_loss: 0.5356, label: 2, bag_size: 2501
batch 359, loss: 0.8314, instance_loss: 0.8307, weighted_loss: 0.8312, label: 2, bag_size: 4910
batch 379, loss: 0.4214, instance_loss: 0.5350, weighted_loss: 0.4555, label: 2, bag_size: 6298
batch 399, loss: 1.3596, instance_loss: 0.9183, weighted_loss: 1.2272, label: 1, bag_size: 3261
batch 419, loss: 0.0707, instance_loss: 0.0677, weighted_loss: 0.0698, label: 2, bag_size: 657
batch 439, loss: 0.1352, instance_loss: 0.3759, weighted_loss: 0.2074, label: 2, bag_size: 3396
batch 459, loss: 1.1190, instance_loss: 0.7675, weighted_loss: 1.0136, label: 0, bag_size: 1695
batch 479, loss: 0.0490, instance_loss: 0.1319, weighted_loss: 0.0739, label: 2, bag_size: 3121
batch 499, loss: 0.7007, instance_loss: 0.5808, weighted_loss: 0.6648, label: 1, bag_size: 4346
batch 519, loss: 0.0246, instance_loss: 0.0477, weighted_loss: 0.0316, label: 2, bag_size: 2997
batch 539, loss: 0.0125, instance_loss: 0.0275, weighted_loss: 0.0170, label: 2, bag_size: 3415
batch 559, loss: 0.0748, instance_loss: 0.1566, weighted_loss: 0.0993, label: 0, bag_size: 3443
batch 579, loss: 0.0876, instance_loss: 0.1618, weighted_loss: 0.1098, label: 0, bag_size: 2873
batch 599, loss: 2.7467, instance_loss: 1.3482, weighted_loss: 2.3272, label: 1, bag_size: 2852
batch 619, loss: 1.0743, instance_loss: 0.9122, weighted_loss: 1.0256, label: 2, bag_size: 4179
batch 639, loss: 0.7351, instance_loss: 0.6826, weighted_loss: 0.7194, label: 1, bag_size: 1371
batch 659, loss: 0.7127, instance_loss: 0.5583, weighted_loss: 0.6664, label: 1, bag_size: 3823
batch 679, loss: 0.9048, instance_loss: 0.6805, weighted_loss: 0.8375, label: 1, bag_size: 3991
batch 699, loss: 0.0747, instance_loss: 0.2539, weighted_loss: 0.1284, label: 0, bag_size: 3038
batch 719, loss: 0.1294, instance_loss: 0.1945, weighted_loss: 0.1489, label: 2, bag_size: 4569
batch 739, loss: 0.1272, instance_loss: 0.4331, weighted_loss: 0.2190, label: 2, bag_size: 3618


class 0 clustering acc 0.9745525727069351: correct 17425/17880
class 1 clustering acc 0.2808724832214765: correct 1674/5960
Epoch: 20, train_loss: 0.6296, train_clustering_loss:  0.5691, train_error: 0.2725
class 0: acc 0.7647058823529411, correct 169/221
class 1: acc 0.6431226765799256, correct 173/269
class 2: acc 0.7843137254901961, correct 200/255

Val Set, val_loss: 1.1522, val_error: 0.4681, auc: 0.8456
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.19680851063829788: correct 148/752
class 0: acc 0.36538461538461536, correct 19/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2124, instance_loss: 0.3860, weighted_loss: 0.2645, label: 1, bag_size: 210
batch 39, loss: 1.5087, instance_loss: 0.7339, weighted_loss: 1.2763, label: 2, bag_size: 3274
batch 59, loss: 0.4739, instance_loss: 0.9299, weighted_loss: 0.6107, label: 2, bag_size: 3607
batch 79, loss: 0.6429, instance_loss: 0.3458, weighted_loss: 0.5537, label: 0, bag_size: 4157
batch 99, loss: 1.1889, instance_loss: 0.5880, weighted_loss: 1.0086, label: 0, bag_size: 5484
batch 119, loss: 0.2789, instance_loss: 0.5992, weighted_loss: 0.3750, label: 1, bag_size: 3050
batch 139, loss: 0.3204, instance_loss: 0.5086, weighted_loss: 0.3769, label: 1, bag_size: 5728
batch 159, loss: 0.8267, instance_loss: 0.6682, weighted_loss: 0.7792, label: 0, bag_size: 909
batch 179, loss: 0.1287, instance_loss: 0.3026, weighted_loss: 0.1809, label: 2, bag_size: 5037
batch 199, loss: 0.1921, instance_loss: 0.3953, weighted_loss: 0.2531, label: 2, bag_size: 4132
batch 219, loss: 0.0387, instance_loss: 0.0812, weighted_loss: 0.0515, label: 2, bag_size: 4088
batch 239, loss: 0.2911, instance_loss: 0.4444, weighted_loss: 0.3371, label: 0, bag_size: 1049
batch 259, loss: 0.3887, instance_loss: 0.1753, weighted_loss: 0.3247, label: 2, bag_size: 3121
batch 279, loss: 0.6079, instance_loss: 0.6660, weighted_loss: 0.6253, label: 0, bag_size: 4337
batch 299, loss: 0.5285, instance_loss: 0.4529, weighted_loss: 0.5059, label: 1, bag_size: 3396
batch 319, loss: 2.9506, instance_loss: 1.1892, weighted_loss: 2.4222, label: 0, bag_size: 2597
batch 339, loss: 0.0906, instance_loss: 0.8100, weighted_loss: 0.3064, label: 1, bag_size: 3425
batch 359, loss: 0.1015, instance_loss: 0.2669, weighted_loss: 0.1511, label: 0, bag_size: 5570
batch 379, loss: 1.2834, instance_loss: 0.8022, weighted_loss: 1.1390, label: 1, bag_size: 3619
batch 399, loss: 0.0571, instance_loss: 0.4679, weighted_loss: 0.1803, label: 0, bag_size: 3219
batch 419, loss: 1.5957, instance_loss: 0.8543, weighted_loss: 1.3733, label: 2, bag_size: 361
batch 439, loss: 0.0508, instance_loss: 0.4540, weighted_loss: 0.1717, label: 1, bag_size: 3337
batch 459, loss: 0.1716, instance_loss: 0.2108, weighted_loss: 0.1834, label: 0, bag_size: 3666
batch 479, loss: 0.3648, instance_loss: 0.4407, weighted_loss: 0.3876, label: 0, bag_size: 3594
batch 499, loss: 2.1540, instance_loss: 0.9595, weighted_loss: 1.7956, label: 0, bag_size: 5017
batch 519, loss: 0.0657, instance_loss: 0.0942, weighted_loss: 0.0742, label: 2, bag_size: 4745
batch 539, loss: 0.0561, instance_loss: 0.2249, weighted_loss: 0.1067, label: 2, bag_size: 4302
batch 559, loss: 0.6996, instance_loss: 0.5535, weighted_loss: 0.6558, label: 2, bag_size: 5307
batch 579, loss: 0.1898, instance_loss: 0.4545, weighted_loss: 0.2692, label: 2, bag_size: 3397
batch 599, loss: 0.2184, instance_loss: 0.5343, weighted_loss: 0.3132, label: 0, bag_size: 4251
batch 619, loss: 0.0291, instance_loss: 0.0321, weighted_loss: 0.0300, label: 2, bag_size: 2254
batch 639, loss: 0.2265, instance_loss: 0.7801, weighted_loss: 0.3926, label: 1, bag_size: 4181
batch 659, loss: 0.1524, instance_loss: 0.1500, weighted_loss: 0.1517, label: 0, bag_size: 4707
batch 679, loss: 0.0490, instance_loss: 0.0751, weighted_loss: 0.0568, label: 2, bag_size: 2997
batch 699, loss: 0.1406, instance_loss: 0.3132, weighted_loss: 0.1924, label: 0, bag_size: 2479
batch 719, loss: 1.1626, instance_loss: 0.8676, weighted_loss: 1.0741, label: 1, bag_size: 1854
batch 739, loss: 0.3794, instance_loss: 0.5043, weighted_loss: 0.4169, label: 1, bag_size: 1042


class 0 clustering acc 0.9733780760626398: correct 17404/17880
class 1 clustering acc 0.3436241610738255: correct 2048/5960
Epoch: 21, train_loss: 0.6201, train_clustering_loss:  0.5529, train_error: 0.2617
class 0: acc 0.7976653696498055, correct 205/257
class 1: acc 0.6111111111111112, correct 143/234
class 2: acc 0.7952755905511811, correct 202/254

Val Set, val_loss: 0.6493, val_error: 0.2447, auc: 0.8848
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.3377659574468085: correct 254/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2346, instance_loss: 0.9178, weighted_loss: 1.1396, label: 2, bag_size: 1513
batch 39, loss: 0.0310, instance_loss: 0.3439, weighted_loss: 0.1249, label: 2, bag_size: 6148
batch 59, loss: 0.2000, instance_loss: 0.4127, weighted_loss: 0.2638, label: 2, bag_size: 4302
batch 79, loss: 0.2022, instance_loss: 0.2900, weighted_loss: 0.2286, label: 0, bag_size: 4721
batch 99, loss: 1.1787, instance_loss: 0.8998, weighted_loss: 1.0951, label: 1, bag_size: 4187
batch 119, loss: 1.5137, instance_loss: 0.8709, weighted_loss: 1.3209, label: 0, bag_size: 2915
batch 139, loss: 0.1096, instance_loss: 0.2275, weighted_loss: 0.1450, label: 0, bag_size: 6863
batch 159, loss: 0.1584, instance_loss: 0.3827, weighted_loss: 0.2257, label: 0, bag_size: 3920
batch 179, loss: 2.2891, instance_loss: 0.8172, weighted_loss: 1.8476, label: 2, bag_size: 4241
batch 199, loss: 1.6035, instance_loss: 0.7901, weighted_loss: 1.3595, label: 2, bag_size: 909
batch 219, loss: 0.4683, instance_loss: 0.3430, weighted_loss: 0.4307, label: 0, bag_size: 2190
batch 239, loss: 0.0157, instance_loss: 0.0409, weighted_loss: 0.0233, label: 2, bag_size: 4745
batch 259, loss: 0.0492, instance_loss: 0.1889, weighted_loss: 0.0911, label: 0, bag_size: 6765
batch 279, loss: 0.3443, instance_loss: 0.5509, weighted_loss: 0.4063, label: 1, bag_size: 3184
batch 299, loss: 0.1477, instance_loss: 0.5241, weighted_loss: 0.2606, label: 2, bag_size: 4132
batch 319, loss: 0.1069, instance_loss: 0.5785, weighted_loss: 0.2484, label: 0, bag_size: 3219
batch 339, loss: 0.0820, instance_loss: 0.2797, weighted_loss: 0.1413, label: 0, bag_size: 471
batch 359, loss: 0.2164, instance_loss: 0.4640, weighted_loss: 0.2907, label: 0, bag_size: 4229
batch 379, loss: 1.6162, instance_loss: 1.0950, weighted_loss: 1.4598, label: 0, bag_size: 1365
batch 399, loss: 0.1026, instance_loss: 0.2625, weighted_loss: 0.1506, label: 0, bag_size: 1662
batch 419, loss: 2.2425, instance_loss: 1.3522, weighted_loss: 1.9754, label: 0, bag_size: 5330
batch 439, loss: 0.8643, instance_loss: 0.8373, weighted_loss: 0.8562, label: 2, bag_size: 1050
batch 459, loss: 0.5888, instance_loss: 0.7952, weighted_loss: 0.6507, label: 2, bag_size: 2486
batch 479, loss: 0.1931, instance_loss: 0.5426, weighted_loss: 0.2979, label: 0, bag_size: 4416
batch 499, loss: 0.4831, instance_loss: 0.4928, weighted_loss: 0.4860, label: 1, bag_size: 758
batch 519, loss: 0.1653, instance_loss: 0.4572, weighted_loss: 0.2529, label: 2, bag_size: 3174
batch 539, loss: 0.5700, instance_loss: 0.5310, weighted_loss: 0.5583, label: 0, bag_size: 4416
batch 559, loss: 0.0731, instance_loss: 0.2825, weighted_loss: 0.1359, label: 2, bag_size: 4745
batch 579, loss: 0.1971, instance_loss: 0.3453, weighted_loss: 0.2415, label: 2, bag_size: 2905
batch 599, loss: 0.6274, instance_loss: 0.3722, weighted_loss: 0.5508, label: 0, bag_size: 4351
batch 619, loss: 0.8133, instance_loss: 0.6943, weighted_loss: 0.7776, label: 1, bag_size: 7176
batch 639, loss: 0.0325, instance_loss: 0.2861, weighted_loss: 0.1086, label: 1, bag_size: 3337
batch 659, loss: 1.3503, instance_loss: 0.6321, weighted_loss: 1.1348, label: 1, bag_size: 3482
batch 679, loss: 0.0670, instance_loss: 0.4337, weighted_loss: 0.1770, label: 0, bag_size: 577
batch 699, loss: 0.6212, instance_loss: 0.5102, weighted_loss: 0.5879, label: 0, bag_size: 3662
batch 719, loss: 0.1908, instance_loss: 0.3017, weighted_loss: 0.2241, label: 0, bag_size: 2824
batch 739, loss: 0.0283, instance_loss: 0.3075, weighted_loss: 0.1120, label: 2, bag_size: 3810


class 0 clustering acc 0.9718120805369127: correct 17376/17880
class 1 clustering acc 0.3226510067114094: correct 1923/5960
Epoch: 22, train_loss: 0.6337, train_clustering_loss:  0.5610, train_error: 0.2658
class 0: acc 0.7450199203187251, correct 187/251
class 1: acc 0.6693877551020408, correct 164/245
class 2: acc 0.7871485943775101, correct 196/249

Val Set, val_loss: 0.7854, val_error: 0.3085, auc: 0.8700
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.2699468085106383: correct 203/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6606, instance_loss: 0.5600, weighted_loss: 0.6304, label: 2, bag_size: 3112
batch 39, loss: 1.3770, instance_loss: 0.4704, weighted_loss: 1.1051, label: 0, bag_size: 4145
batch 59, loss: 0.4466, instance_loss: 0.5082, weighted_loss: 0.4651, label: 0, bag_size: 3664
batch 79, loss: 0.2165, instance_loss: 0.4984, weighted_loss: 0.3011, label: 2, bag_size: 3080
batch 99, loss: 0.2093, instance_loss: 0.4705, weighted_loss: 0.2877, label: 1, bag_size: 4346
batch 119, loss: 0.0693, instance_loss: 0.2344, weighted_loss: 0.1188, label: 2, bag_size: 3497
batch 139, loss: 0.6680, instance_loss: 0.6569, weighted_loss: 0.6647, label: 0, bag_size: 640
batch 159, loss: 1.4823, instance_loss: 0.7933, weighted_loss: 1.2756, label: 1, bag_size: 3261
batch 179, loss: 0.6760, instance_loss: 1.1184, weighted_loss: 0.8087, label: 0, bag_size: 2044
batch 199, loss: 0.0304, instance_loss: 0.1609, weighted_loss: 0.0696, label: 0, bag_size: 855
batch 219, loss: 0.1614, instance_loss: 0.3827, weighted_loss: 0.2278, label: 1, bag_size: 9099
batch 239, loss: 1.0041, instance_loss: 0.8270, weighted_loss: 0.9510, label: 2, bag_size: 724
batch 259, loss: 0.6657, instance_loss: 0.4976, weighted_loss: 0.6153, label: 0, bag_size: 5840
batch 279, loss: 0.9193, instance_loss: 0.6349, weighted_loss: 0.8340, label: 0, bag_size: 1795
batch 299, loss: 0.0319, instance_loss: 0.0817, weighted_loss: 0.0468, label: 2, bag_size: 3415
batch 319, loss: 0.0569, instance_loss: 0.6373, weighted_loss: 0.2310, label: 1, bag_size: 5086
batch 339, loss: 0.1194, instance_loss: 0.5700, weighted_loss: 0.2546, label: 0, bag_size: 5487
batch 359, loss: 1.2462, instance_loss: 0.8141, weighted_loss: 1.1166, label: 1, bag_size: 4395
batch 379, loss: 0.5891, instance_loss: 0.4779, weighted_loss: 0.5557, label: 2, bag_size: 4096
batch 399, loss: 0.2001, instance_loss: 0.4464, weighted_loss: 0.2740, label: 1, bag_size: 3761
batch 419, loss: 0.7038, instance_loss: 0.4654, weighted_loss: 0.6323, label: 1, bag_size: 3225
batch 439, loss: 1.6441, instance_loss: 1.0126, weighted_loss: 1.4547, label: 1, bag_size: 1595
batch 459, loss: 0.6491, instance_loss: 0.4622, weighted_loss: 0.5930, label: 0, bag_size: 999
batch 479, loss: 0.1598, instance_loss: 0.1275, weighted_loss: 0.1501, label: 2, bag_size: 1094
batch 499, loss: 0.2518, instance_loss: 1.0172, weighted_loss: 0.4814, label: 1, bag_size: 5003
batch 519, loss: 0.3209, instance_loss: 0.5595, weighted_loss: 0.3925, label: 1, bag_size: 2182
batch 539, loss: 0.9315, instance_loss: 0.7052, weighted_loss: 0.8636, label: 1, bag_size: 4824
batch 559, loss: 1.1417, instance_loss: 0.6975, weighted_loss: 1.0084, label: 0, bag_size: 4122
batch 579, loss: 0.4209, instance_loss: 0.6325, weighted_loss: 0.4844, label: 2, bag_size: 3778
batch 599, loss: 0.4686, instance_loss: 0.2515, weighted_loss: 0.4035, label: 2, bag_size: 4691
batch 619, loss: 1.5535, instance_loss: 0.8232, weighted_loss: 1.3344, label: 2, bag_size: 223
batch 639, loss: 0.0518, instance_loss: 0.2107, weighted_loss: 0.0995, label: 0, bag_size: 855
batch 659, loss: 0.1649, instance_loss: 0.2632, weighted_loss: 0.1944, label: 0, bag_size: 4909
batch 679, loss: 0.7407, instance_loss: 0.6660, weighted_loss: 0.7183, label: 2, bag_size: 4241
batch 699, loss: 0.0350, instance_loss: 0.3475, weighted_loss: 0.1288, label: 1, bag_size: 2493
batch 719, loss: 1.5156, instance_loss: 1.0199, weighted_loss: 1.3669, label: 0, bag_size: 1782
batch 739, loss: 0.1296, instance_loss: 0.1409, weighted_loss: 0.1330, label: 2, bag_size: 2313


class 0 clustering acc 0.9720917225950783: correct 17381/17880
class 1 clustering acc 0.31543624161073824: correct 1880/5960
Epoch: 23, train_loss: 0.6432, train_clustering_loss:  0.5577, train_error: 0.2872
class 0: acc 0.7689393939393939, correct 203/264
class 1: acc 0.5517241379310345, correct 128/232
class 2: acc 0.8032128514056225, correct 200/249

Val Set, val_loss: 0.6700, val_error: 0.2447, auc: 0.8816
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.32845744680851063: correct 247/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2441, instance_loss: 0.4777, weighted_loss: 0.3142, label: 1, bag_size: 3156
batch 39, loss: 1.3470, instance_loss: 1.0257, weighted_loss: 1.2506, label: 0, bag_size: 12971
batch 59, loss: 3.2431, instance_loss: 1.5356, weighted_loss: 2.7308, label: 0, bag_size: 3830
batch 79, loss: 0.1353, instance_loss: 0.2977, weighted_loss: 0.1840, label: 0, bag_size: 5003
batch 99, loss: 0.6155, instance_loss: 0.5738, weighted_loss: 0.6030, label: 0, bag_size: 5368
batch 119, loss: 0.2856, instance_loss: 0.1358, weighted_loss: 0.2406, label: 2, bag_size: 2561
batch 139, loss: 0.0519, instance_loss: 0.1594, weighted_loss: 0.0841, label: 0, bag_size: 2873
batch 159, loss: 0.0803, instance_loss: 0.1341, weighted_loss: 0.0965, label: 2, bag_size: 4569
batch 179, loss: 0.5460, instance_loss: 0.7006, weighted_loss: 0.5924, label: 1, bag_size: 4705
batch 199, loss: 0.8056, instance_loss: 0.7824, weighted_loss: 0.7987, label: 1, bag_size: 2831
batch 219, loss: 0.1162, instance_loss: 0.3085, weighted_loss: 0.1739, label: 1, bag_size: 5728
batch 239, loss: 0.5555, instance_loss: 0.6649, weighted_loss: 0.5883, label: 0, bag_size: 2607
batch 259, loss: 0.1799, instance_loss: 0.3778, weighted_loss: 0.2393, label: 2, bag_size: 4555
batch 279, loss: 0.8392, instance_loss: 0.7714, weighted_loss: 0.8189, label: 2, bag_size: 4132
batch 299, loss: 0.0879, instance_loss: 0.3694, weighted_loss: 0.1724, label: 1, bag_size: 3471
batch 319, loss: 0.0386, instance_loss: 0.3063, weighted_loss: 0.1189, label: 1, bag_size: 758
batch 339, loss: 0.5044, instance_loss: 0.3407, weighted_loss: 0.4553, label: 1, bag_size: 1854
batch 359, loss: 0.9108, instance_loss: 0.4941, weighted_loss: 0.7858, label: 1, bag_size: 1854
batch 379, loss: 0.0078, instance_loss: 0.5226, weighted_loss: 0.1623, label: 2, bag_size: 4497
batch 399, loss: 0.5941, instance_loss: 0.5604, weighted_loss: 0.5840, label: 1, bag_size: 578
batch 419, loss: 0.7941, instance_loss: 0.5525, weighted_loss: 0.7216, label: 1, bag_size: 3106
batch 439, loss: 0.1419, instance_loss: 0.2544, weighted_loss: 0.1756, label: 0, bag_size: 1744
batch 459, loss: 0.5482, instance_loss: 0.6815, weighted_loss: 0.5882, label: 2, bag_size: 4162
batch 479, loss: 1.2163, instance_loss: 0.8337, weighted_loss: 1.1015, label: 1, bag_size: 1364
batch 499, loss: 0.1336, instance_loss: 0.5279, weighted_loss: 0.2519, label: 0, bag_size: 1245
batch 519, loss: 0.9558, instance_loss: 0.6597, weighted_loss: 0.8670, label: 1, bag_size: 2642
batch 539, loss: 0.2050, instance_loss: 0.4843, weighted_loss: 0.2888, label: 1, bag_size: 582
batch 559, loss: 0.1722, instance_loss: 0.4018, weighted_loss: 0.2411, label: 1, bag_size: 7135
batch 579, loss: 1.3093, instance_loss: 0.8501, weighted_loss: 1.1715, label: 0, bag_size: 1141
batch 599, loss: 0.1824, instance_loss: 0.3930, weighted_loss: 0.2456, label: 0, bag_size: 7330
batch 619, loss: 0.2872, instance_loss: 0.5022, weighted_loss: 0.3517, label: 0, bag_size: 5953
batch 639, loss: 0.0930, instance_loss: 0.2684, weighted_loss: 0.1457, label: 2, bag_size: 4487
batch 659, loss: 0.0432, instance_loss: 0.1235, weighted_loss: 0.0673, label: 0, bag_size: 3348
batch 679, loss: 2.2267, instance_loss: 1.0088, weighted_loss: 1.8613, label: 1, bag_size: 1558
batch 699, loss: 0.6449, instance_loss: 0.5279, weighted_loss: 0.6098, label: 2, bag_size: 4372
batch 719, loss: 0.5309, instance_loss: 0.3358, weighted_loss: 0.4724, label: 0, bag_size: 4157
batch 739, loss: 0.0933, instance_loss: 0.4382, weighted_loss: 0.1968, label: 1, bag_size: 758


class 0 clustering acc 0.9761185682326622: correct 17453/17880
class 1 clustering acc 0.3290268456375839: correct 1961/5960
Epoch: 24, train_loss: 0.6278, train_clustering_loss:  0.5405, train_error: 0.2752
class 0: acc 0.7727272727272727, correct 187/242
class 1: acc 0.6212121212121212, correct 164/264
class 2: acc 0.7907949790794979, correct 189/239

Val Set, val_loss: 0.6571, val_error: 0.2447, auc: 0.8873
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.3470744680851064: correct 261/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0630, instance_loss: 0.2157, weighted_loss: 0.1088, label: 0, bag_size: 4344
batch 39, loss: 1.8082, instance_loss: 1.0357, weighted_loss: 1.5765, label: 2, bag_size: 1513
batch 59, loss: 0.0537, instance_loss: 0.2123, weighted_loss: 0.1013, label: 0, bag_size: 3872
batch 79, loss: 0.5346, instance_loss: 0.6096, weighted_loss: 0.5571, label: 0, bag_size: 609
batch 99, loss: 0.6694, instance_loss: 0.7455, weighted_loss: 0.6922, label: 2, bag_size: 5072
batch 119, loss: 0.3602, instance_loss: 0.7881, weighted_loss: 0.4886, label: 1, bag_size: 5833
batch 139, loss: 0.4338, instance_loss: 0.8229, weighted_loss: 0.5505, label: 0, bag_size: 1245
batch 159, loss: 0.1606, instance_loss: 0.2625, weighted_loss: 0.1912, label: 0, bag_size: 6440
batch 179, loss: 2.7663, instance_loss: 1.0834, weighted_loss: 2.2615, label: 1, bag_size: 1670
batch 199, loss: 0.2831, instance_loss: 0.5186, weighted_loss: 0.3537, label: 1, bag_size: 425
batch 219, loss: 0.0801, instance_loss: 0.1224, weighted_loss: 0.0928, label: 2, bag_size: 2905
batch 239, loss: 0.0935, instance_loss: 0.4098, weighted_loss: 0.1884, label: 1, bag_size: 10941
batch 259, loss: 0.2201, instance_loss: 0.3863, weighted_loss: 0.2700, label: 2, bag_size: 3396
batch 279, loss: 0.7345, instance_loss: 0.5886, weighted_loss: 0.6908, label: 1, bag_size: 1161
batch 299, loss: 0.6746, instance_loss: 0.5817, weighted_loss: 0.6468, label: 0, bag_size: 3191
batch 319, loss: 0.3980, instance_loss: 0.3002, weighted_loss: 0.3687, label: 0, bag_size: 5526
batch 339, loss: 2.2719, instance_loss: 2.4414, weighted_loss: 2.3227, label: 0, bag_size: 434
batch 359, loss: 0.0360, instance_loss: 0.2218, weighted_loss: 0.0917, label: 0, bag_size: 4083
batch 379, loss: 2.0366, instance_loss: 0.9269, weighted_loss: 1.7037, label: 0, bag_size: 4725
batch 399, loss: 0.6504, instance_loss: 0.3797, weighted_loss: 0.5692, label: 0, bag_size: 3075
batch 419, loss: 0.0921, instance_loss: 0.2906, weighted_loss: 0.1516, label: 0, bag_size: 3741
batch 439, loss: 1.4493, instance_loss: 0.8808, weighted_loss: 1.2788, label: 1, bag_size: 1860
batch 459, loss: 0.1126, instance_loss: 0.2868, weighted_loss: 0.1649, label: 0, bag_size: 2705
batch 479, loss: 0.0958, instance_loss: 0.2319, weighted_loss: 0.1366, label: 0, bag_size: 2873
batch 499, loss: 1.0202, instance_loss: 0.9167, weighted_loss: 0.9891, label: 1, bag_size: 3422
batch 519, loss: 4.3663, instance_loss: 1.7669, weighted_loss: 3.5865, label: 0, bag_size: 4605
batch 539, loss: 0.9303, instance_loss: 0.8348, weighted_loss: 0.9017, label: 1, bag_size: 3991
batch 559, loss: 0.4909, instance_loss: 0.6095, weighted_loss: 0.5265, label: 1, bag_size: 4119
batch 579, loss: 0.9016, instance_loss: 0.7018, weighted_loss: 0.8417, label: 1, bag_size: 1500
batch 599, loss: 0.4777, instance_loss: 0.7041, weighted_loss: 0.5456, label: 2, bag_size: 6594
batch 619, loss: 0.0465, instance_loss: 0.1354, weighted_loss: 0.0732, label: 0, bag_size: 2705
batch 639, loss: 1.6695, instance_loss: 1.0865, weighted_loss: 1.4946, label: 1, bag_size: 3823
batch 659, loss: 0.4701, instance_loss: 0.5727, weighted_loss: 0.5009, label: 2, bag_size: 4535
batch 679, loss: 0.2960, instance_loss: 0.5936, weighted_loss: 0.3852, label: 1, bag_size: 14449
batch 699, loss: 0.2431, instance_loss: 0.4135, weighted_loss: 0.2943, label: 0, bag_size: 4479
batch 719, loss: 0.1214, instance_loss: 0.3441, weighted_loss: 0.1882, label: 1, bag_size: 2092
batch 739, loss: 0.0549, instance_loss: 0.6263, weighted_loss: 0.2263, label: 1, bag_size: 4134


class 0 clustering acc 0.9730425055928411: correct 17398/17880
class 1 clustering acc 0.3023489932885906: correct 1802/5960
Epoch: 25, train_loss: 0.6413, train_clustering_loss:  0.5745, train_error: 0.2725
class 0: acc 0.7662835249042146, correct 200/261
class 1: acc 0.6200873362445415, correct 142/229
class 2: acc 0.7843137254901961, correct 200/255

Val Set, val_loss: 0.6765, val_error: 0.2872, auc: 0.8793
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.27925531914893614: correct 210/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0105, instance_loss: 0.8353, weighted_loss: 0.9579, label: 0, bag_size: 1695
batch 39, loss: 0.8158, instance_loss: 0.7190, weighted_loss: 0.7868, label: 1, bag_size: 2751
batch 59, loss: 0.0644, instance_loss: 0.1976, weighted_loss: 0.1043, label: 0, bag_size: 3986
batch 79, loss: 0.1579, instance_loss: 0.3145, weighted_loss: 0.2049, label: 0, bag_size: 3367
batch 99, loss: 1.2753, instance_loss: 0.7520, weighted_loss: 1.1183, label: 0, bag_size: 272
batch 119, loss: 0.2189, instance_loss: 0.2501, weighted_loss: 0.2283, label: 2, bag_size: 3112
batch 139, loss: 0.0443, instance_loss: 0.0596, weighted_loss: 0.0489, label: 2, bag_size: 2254
batch 159, loss: 0.4865, instance_loss: 0.4918, weighted_loss: 0.4881, label: 0, bag_size: 4460
batch 179, loss: 0.3616, instance_loss: 0.1138, weighted_loss: 0.2873, label: 2, bag_size: 4043
batch 199, loss: 1.8645, instance_loss: 0.9643, weighted_loss: 1.5945, label: 0, bag_size: 4032
batch 219, loss: 0.7394, instance_loss: 0.4210, weighted_loss: 0.6438, label: 2, bag_size: 3112
batch 239, loss: 0.4816, instance_loss: 0.6036, weighted_loss: 0.5182, label: 0, bag_size: 3690
batch 259, loss: 0.4217, instance_loss: 0.1262, weighted_loss: 0.3331, label: 1, bag_size: 9099
batch 279, loss: 0.9961, instance_loss: 1.0797, weighted_loss: 1.0212, label: 1, bag_size: 3821
batch 299, loss: 0.0428, instance_loss: 0.0983, weighted_loss: 0.0594, label: 2, bag_size: 4043
batch 319, loss: 1.0423, instance_loss: 0.9174, weighted_loss: 1.0048, label: 2, bag_size: 4342
batch 339, loss: 0.0180, instance_loss: 0.1123, weighted_loss: 0.0463, label: 2, bag_size: 2483
batch 359, loss: 1.0858, instance_loss: 0.5932, weighted_loss: 0.9380, label: 2, bag_size: 5307
batch 379, loss: 0.1888, instance_loss: 0.3548, weighted_loss: 0.2386, label: 2, bag_size: 3176
batch 399, loss: 0.3855, instance_loss: 0.5739, weighted_loss: 0.4420, label: 2, bag_size: 4132
batch 419, loss: 0.1203, instance_loss: 0.2135, weighted_loss: 0.1483, label: 2, bag_size: 2905
batch 439, loss: 0.5828, instance_loss: 0.6000, weighted_loss: 0.5880, label: 1, bag_size: 1410
batch 459, loss: 1.8915, instance_loss: 1.1531, weighted_loss: 1.6700, label: 1, bag_size: 3791
batch 479, loss: 0.4319, instance_loss: 0.4322, weighted_loss: 0.4320, label: 0, bag_size: 5656
batch 499, loss: 0.4441, instance_loss: 0.6705, weighted_loss: 0.5121, label: 1, bag_size: 2905
batch 519, loss: 0.0741, instance_loss: 0.2445, weighted_loss: 0.1252, label: 2, bag_size: 5924
batch 539, loss: 1.0833, instance_loss: 0.6945, weighted_loss: 0.9667, label: 0, bag_size: 4541
batch 559, loss: 0.1520, instance_loss: 0.4628, weighted_loss: 0.2453, label: 1, bag_size: 368
batch 579, loss: 4.0403, instance_loss: 1.3829, weighted_loss: 3.2431, label: 0, bag_size: 4605
batch 599, loss: 0.0979, instance_loss: 0.4788, weighted_loss: 0.2122, label: 1, bag_size: 874
batch 619, loss: 0.0918, instance_loss: 0.2877, weighted_loss: 0.1506, label: 0, bag_size: 2019
batch 639, loss: 1.4004, instance_loss: 0.7025, weighted_loss: 1.1910, label: 0, bag_size: 3664
batch 659, loss: 1.1476, instance_loss: 0.7134, weighted_loss: 1.0173, label: 1, bag_size: 1500
batch 679, loss: 0.4315, instance_loss: 0.7589, weighted_loss: 0.5297, label: 1, bag_size: 4898
batch 699, loss: 1.5622, instance_loss: 0.9356, weighted_loss: 1.3743, label: 2, bag_size: 4316
batch 719, loss: 0.3168, instance_loss: 0.5211, weighted_loss: 0.3781, label: 1, bag_size: 2919
batch 739, loss: 0.1043, instance_loss: 0.3528, weighted_loss: 0.1789, label: 1, bag_size: 3983


class 0 clustering acc 0.9723154362416108: correct 17385/17880
class 1 clustering acc 0.26359060402684564: correct 1571/5960
Epoch: 26, train_loss: 0.6724, train_clustering_loss:  0.5815, train_error: 0.2940
class 0: acc 0.748, correct 187/250
class 1: acc 0.6061776061776062, correct 157/259
class 2: acc 0.7711864406779662, correct 182/236

Val Set, val_loss: 0.6150, val_error: 0.2872, auc: 0.8853
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.3191489361702128: correct 240/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9210, instance_loss: 0.8097, weighted_loss: 0.8876, label: 1, bag_size: 6165
batch 39, loss: 0.5229, instance_loss: 0.6669, weighted_loss: 0.5661, label: 1, bag_size: 5760
batch 59, loss: 0.5444, instance_loss: 0.6419, weighted_loss: 0.5736, label: 1, bag_size: 1197
batch 79, loss: 1.1474, instance_loss: 0.4583, weighted_loss: 0.9407, label: 0, bag_size: 5098
batch 99, loss: 0.1868, instance_loss: 0.4000, weighted_loss: 0.2507, label: 1, bag_size: 3493
batch 119, loss: 0.0251, instance_loss: 0.1086, weighted_loss: 0.0501, label: 2, bag_size: 3121
batch 139, loss: 1.3491, instance_loss: 1.2317, weighted_loss: 1.3139, label: 1, bag_size: 936
batch 159, loss: 3.1009, instance_loss: 0.9598, weighted_loss: 2.4586, label: 2, bag_size: 2031
batch 179, loss: 0.3415, instance_loss: 0.4185, weighted_loss: 0.3646, label: 0, bag_size: 3864
batch 199, loss: 0.8966, instance_loss: 0.6918, weighted_loss: 0.8351, label: 2, bag_size: 1050
batch 219, loss: 0.1019, instance_loss: 0.2976, weighted_loss: 0.1606, label: 0, bag_size: 2756
batch 239, loss: 0.9765, instance_loss: 0.4804, weighted_loss: 0.8277, label: 0, bag_size: 5023
batch 259, loss: 0.0043, instance_loss: 0.4752, weighted_loss: 0.1456, label: 1, bag_size: 7279
batch 279, loss: 0.0291, instance_loss: 0.0860, weighted_loss: 0.0462, label: 2, bag_size: 4775
batch 299, loss: 0.0298, instance_loss: 0.1307, weighted_loss: 0.0601, label: 0, bag_size: 3437
batch 319, loss: 0.9721, instance_loss: 0.8075, weighted_loss: 0.9228, label: 1, bag_size: 2998
batch 339, loss: 0.0075, instance_loss: 0.2719, weighted_loss: 0.0868, label: 1, bag_size: 3333
batch 359, loss: 0.6891, instance_loss: 0.8319, weighted_loss: 0.7319, label: 1, bag_size: 582
batch 379, loss: 0.3059, instance_loss: 0.2432, weighted_loss: 0.2871, label: 0, bag_size: 6252
batch 399, loss: 2.7462, instance_loss: 0.9728, weighted_loss: 2.2142, label: 0, bag_size: 3830
batch 419, loss: 0.3340, instance_loss: 0.8281, weighted_loss: 0.4822, label: 1, bag_size: 5118
batch 439, loss: 0.1223, instance_loss: 0.2324, weighted_loss: 0.1554, label: 0, bag_size: 1495
batch 459, loss: 0.1811, instance_loss: 0.2562, weighted_loss: 0.2036, label: 0, bag_size: 4178
batch 479, loss: 1.1955, instance_loss: 1.0476, weighted_loss: 1.1511, label: 1, bag_size: 3596
batch 499, loss: 0.0893, instance_loss: 0.1209, weighted_loss: 0.0988, label: 2, bag_size: 1094
batch 519, loss: 0.5298, instance_loss: 0.6491, weighted_loss: 0.5656, label: 1, bag_size: 3475
batch 539, loss: 0.5293, instance_loss: 0.6529, weighted_loss: 0.5664, label: 1, bag_size: 2182
batch 559, loss: 2.1590, instance_loss: 1.0922, weighted_loss: 1.8389, label: 0, bag_size: 1774
batch 579, loss: 0.1105, instance_loss: 0.4184, weighted_loss: 0.2029, label: 1, bag_size: 4898
batch 599, loss: 1.4903, instance_loss: 0.9213, weighted_loss: 1.3196, label: 2, bag_size: 728
batch 619, loss: 3.9702, instance_loss: 1.6145, weighted_loss: 3.2635, label: 2, bag_size: 5307
batch 639, loss: 0.3065, instance_loss: 0.4916, weighted_loss: 0.3620, label: 2, bag_size: 3778
batch 659, loss: 0.0621, instance_loss: 0.1348, weighted_loss: 0.0839, label: 2, bag_size: 3176
batch 679, loss: 0.1257, instance_loss: 0.2827, weighted_loss: 0.1728, label: 0, bag_size: 2756
batch 699, loss: 0.8706, instance_loss: 0.6898, weighted_loss: 0.8163, label: 1, bag_size: 2642
batch 719, loss: 0.7409, instance_loss: 1.0806, weighted_loss: 0.8428, label: 1, bag_size: 6689
batch 739, loss: 0.5360, instance_loss: 0.6009, weighted_loss: 0.5555, label: 1, bag_size: 2472


class 0 clustering acc 0.9715883668903803: correct 17372/17880
class 1 clustering acc 0.29765100671140937: correct 1774/5960
Epoch: 27, train_loss: 0.6197, train_clustering_loss:  0.5642, train_error: 0.2765
class 0: acc 0.757085020242915, correct 187/247
class 1: acc 0.6264591439688716, correct 161/257
class 2: acc 0.7925311203319502, correct 191/241

Val Set, val_loss: 0.7444, val_error: 0.2660, auc: 0.8583
class 0 clustering acc 0.9791666666666666: correct 2209/2256
class 1 clustering acc 0.15558510638297873: correct 117/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2646, instance_loss: 0.5350, weighted_loss: 0.3457, label: 1, bag_size: 779
batch 39, loss: 0.3509, instance_loss: 0.5533, weighted_loss: 0.4116, label: 0, bag_size: 2927
batch 59, loss: 0.9993, instance_loss: 1.0450, weighted_loss: 1.0130, label: 1, bag_size: 3821
batch 79, loss: 0.4004, instance_loss: 0.3801, weighted_loss: 0.3943, label: 2, bag_size: 4096
batch 99, loss: 0.0199, instance_loss: 0.1074, weighted_loss: 0.0461, label: 2, bag_size: 5138
batch 119, loss: 0.0368, instance_loss: 0.0581, weighted_loss: 0.0432, label: 2, bag_size: 2997
batch 139, loss: 0.0343, instance_loss: 0.3298, weighted_loss: 0.1229, label: 0, bag_size: 4918
batch 159, loss: 0.1940, instance_loss: 0.2543, weighted_loss: 0.2121, label: 2, bag_size: 4569
batch 179, loss: 0.3215, instance_loss: 0.6137, weighted_loss: 0.4092, label: 1, bag_size: 5072
batch 199, loss: 0.8537, instance_loss: 0.7530, weighted_loss: 0.8235, label: 2, bag_size: 5307
batch 219, loss: 0.0311, instance_loss: 0.6306, weighted_loss: 0.2110, label: 1, bag_size: 4027
batch 239, loss: 0.0587, instance_loss: 1.3436, weighted_loss: 0.4441, label: 1, bag_size: 6717
batch 259, loss: 0.0283, instance_loss: 0.1790, weighted_loss: 0.0735, label: 0, bag_size: 5646
batch 279, loss: 0.0402, instance_loss: 0.0795, weighted_loss: 0.0520, label: 2, bag_size: 2905
batch 299, loss: 0.0714, instance_loss: 0.3300, weighted_loss: 0.1489, label: 0, bag_size: 3741
batch 319, loss: 1.5040, instance_loss: 0.9572, weighted_loss: 1.3399, label: 2, bag_size: 552
batch 339, loss: 1.4844, instance_loss: 0.6150, weighted_loss: 1.2236, label: 0, bag_size: 4228
batch 359, loss: 0.0075, instance_loss: 0.1753, weighted_loss: 0.0578, label: 2, bag_size: 4497
batch 379, loss: 1.1987, instance_loss: 0.8572, weighted_loss: 1.0962, label: 1, bag_size: 4705
batch 399, loss: 0.1227, instance_loss: 0.4833, weighted_loss: 0.2309, label: 0, bag_size: 6285
batch 419, loss: 0.8058, instance_loss: 0.7392, weighted_loss: 0.7858, label: 1, bag_size: 5276
batch 439, loss: 1.1247, instance_loss: 1.1383, weighted_loss: 1.1288, label: 2, bag_size: 4342
batch 459, loss: 0.3734, instance_loss: 0.3958, weighted_loss: 0.3801, label: 0, bag_size: 3571
batch 479, loss: 0.2151, instance_loss: 0.7329, weighted_loss: 0.3704, label: 1, bag_size: 4184
batch 499, loss: 1.3673, instance_loss: 0.9428, weighted_loss: 1.2399, label: 1, bag_size: 574
batch 519, loss: 0.0029, instance_loss: 1.6454, weighted_loss: 0.4957, label: 0, bag_size: 1910
batch 539, loss: 0.0293, instance_loss: 0.1025, weighted_loss: 0.0512, label: 2, bag_size: 2254
batch 559, loss: 0.0719, instance_loss: 0.3080, weighted_loss: 0.1428, label: 2, bag_size: 3080
batch 579, loss: 1.0959, instance_loss: 0.6450, weighted_loss: 0.9606, label: 0, bag_size: 5023
batch 599, loss: 0.0330, instance_loss: 0.2479, weighted_loss: 0.0975, label: 2, bag_size: 3497
batch 619, loss: 0.5369, instance_loss: 0.7535, weighted_loss: 0.6019, label: 2, bag_size: 22464
batch 639, loss: 0.8879, instance_loss: 0.7412, weighted_loss: 0.8439, label: 2, bag_size: 3274
batch 659, loss: 1.0678, instance_loss: 0.5620, weighted_loss: 0.9161, label: 2, bag_size: 3112
batch 679, loss: 0.0655, instance_loss: 0.3051, weighted_loss: 0.1374, label: 2, bag_size: 3497
batch 699, loss: 0.0075, instance_loss: 0.4675, weighted_loss: 0.1455, label: 1, bag_size: 5026
batch 719, loss: 0.0167, instance_loss: 0.1327, weighted_loss: 0.0515, label: 0, bag_size: 4458
batch 739, loss: 0.0747, instance_loss: 0.2474, weighted_loss: 0.1265, label: 2, bag_size: 2209


class 0 clustering acc 0.9739932885906041: correct 17415/17880
class 1 clustering acc 0.350503355704698: correct 2089/5960
Epoch: 28, train_loss: 0.5566, train_clustering_loss:  0.5367, train_error: 0.2403
class 0: acc 0.7923076923076923, correct 206/260
class 1: acc 0.6071428571428571, correct 136/224
class 2: acc 0.8582375478927203, correct 224/261

Val Set, val_loss: 0.6236, val_error: 0.2660, auc: 0.8865
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.3816489361702128: correct 287/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0741, instance_loss: 0.3695, weighted_loss: 0.1627, label: 1, bag_size: 10941
batch 39, loss: 0.8688, instance_loss: 0.8003, weighted_loss: 0.8483, label: 0, bag_size: 5017
batch 59, loss: 0.3590, instance_loss: 0.1339, weighted_loss: 0.2915, label: 2, bag_size: 4691
batch 79, loss: 0.0992, instance_loss: 0.2942, weighted_loss: 0.1577, label: 1, bag_size: 2919
batch 99, loss: 0.8743, instance_loss: 0.6895, weighted_loss: 0.8189, label: 0, bag_size: 5330
batch 119, loss: 0.9424, instance_loss: 0.8577, weighted_loss: 0.9170, label: 0, bag_size: 15388
batch 139, loss: 0.2416, instance_loss: 0.2842, weighted_loss: 0.2544, label: 2, bag_size: 3172
batch 159, loss: 0.6318, instance_loss: 0.5428, weighted_loss: 0.6051, label: 1, bag_size: 3986
batch 179, loss: 0.3180, instance_loss: 0.4833, weighted_loss: 0.3676, label: 2, bag_size: 3778
batch 199, loss: 2.5811, instance_loss: 0.8972, weighted_loss: 2.0759, label: 2, bag_size: 5307
batch 219, loss: 0.7941, instance_loss: 0.7231, weighted_loss: 0.7728, label: 1, bag_size: 3422
batch 239, loss: 0.6109, instance_loss: 0.6437, weighted_loss: 0.6207, label: 2, bag_size: 3112
batch 259, loss: 0.8297, instance_loss: 0.4342, weighted_loss: 0.7110, label: 0, bag_size: 3662
batch 279, loss: 0.0230, instance_loss: 0.2251, weighted_loss: 0.0836, label: 0, bag_size: 4606
batch 299, loss: 0.1257, instance_loss: 0.3260, weighted_loss: 0.1858, label: 2, bag_size: 3227
batch 319, loss: 0.1024, instance_loss: 0.4578, weighted_loss: 0.2090, label: 0, bag_size: 5953
batch 339, loss: 0.4499, instance_loss: 0.5438, weighted_loss: 0.4781, label: 2, bag_size: 1050
batch 359, loss: 0.4202, instance_loss: 0.7162, weighted_loss: 0.5090, label: 1, bag_size: 209
batch 379, loss: 0.1183, instance_loss: 0.1877, weighted_loss: 0.1391, label: 2, bag_size: 3176
batch 399, loss: 0.0136, instance_loss: 0.1878, weighted_loss: 0.0659, label: 1, bag_size: 3127
batch 419, loss: 0.4059, instance_loss: 0.4665, weighted_loss: 0.4241, label: 0, bag_size: 5108
batch 439, loss: 0.1826, instance_loss: 0.2787, weighted_loss: 0.2115, label: 0, bag_size: 6015
batch 459, loss: 0.1211, instance_loss: 0.5291, weighted_loss: 0.2435, label: 2, bag_size: 4132
batch 479, loss: 0.0001, instance_loss: 1.1274, weighted_loss: 0.3383, label: 0, bag_size: 2231
batch 499, loss: 0.0026, instance_loss: 0.5124, weighted_loss: 0.1556, label: 1, bag_size: 3677
batch 519, loss: 0.1526, instance_loss: 0.3121, weighted_loss: 0.2004, label: 0, bag_size: 1417
batch 539, loss: 0.6782, instance_loss: 0.4927, weighted_loss: 0.6225, label: 1, bag_size: 832
batch 559, loss: 0.6502, instance_loss: 0.6461, weighted_loss: 0.6490, label: 2, bag_size: 4535
batch 579, loss: 0.2689, instance_loss: 0.4436, weighted_loss: 0.3213, label: 2, bag_size: 4162
batch 599, loss: 0.4269, instance_loss: 0.3696, weighted_loss: 0.4097, label: 1, bag_size: 1906
batch 619, loss: 0.1179, instance_loss: 0.2324, weighted_loss: 0.1522, label: 0, bag_size: 1399
batch 639, loss: 0.2398, instance_loss: 0.4028, weighted_loss: 0.2887, label: 0, bag_size: 6863
batch 659, loss: 0.1476, instance_loss: 0.4333, weighted_loss: 0.2333, label: 2, bag_size: 5017
batch 679, loss: 0.0182, instance_loss: 0.0715, weighted_loss: 0.0342, label: 2, bag_size: 4856
batch 699, loss: 0.0354, instance_loss: 0.2513, weighted_loss: 0.1002, label: 2, bag_size: 3810
batch 719, loss: 0.2593, instance_loss: 0.6259, weighted_loss: 0.3693, label: 1, bag_size: 2302
batch 739, loss: 0.0606, instance_loss: 0.0983, weighted_loss: 0.0719, label: 2, bag_size: 4088


class 0 clustering acc 0.9691834451901566: correct 17329/17880
class 1 clustering acc 0.3318791946308725: correct 1978/5960
Epoch: 29, train_loss: 0.5982, train_clustering_loss:  0.5585, train_error: 0.2671
class 0: acc 0.7786561264822134, correct 197/253
class 1: acc 0.6150793650793651, correct 155/252
class 2: acc 0.8083333333333333, correct 194/240

Val Set, val_loss: 0.6794, val_error: 0.2872, auc: 0.8932
class 0 clustering acc 0.9703014184397163: correct 2189/2256
class 1 clustering acc 0.28856382978723405: correct 217/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3641, instance_loss: 0.4174, weighted_loss: 0.3800, label: 2, bag_size: 4372
batch 39, loss: 0.0072, instance_loss: 0.2161, weighted_loss: 0.0699, label: 1, bag_size: 259
batch 59, loss: 0.0527, instance_loss: 0.0936, weighted_loss: 0.0650, label: 2, bag_size: 6001
batch 79, loss: 0.3407, instance_loss: 0.2669, weighted_loss: 0.3185, label: 0, bag_size: 6252
batch 99, loss: 1.0615, instance_loss: 0.7653, weighted_loss: 0.9726, label: 1, bag_size: 3533
batch 119, loss: 0.1008, instance_loss: 0.3989, weighted_loss: 0.1902, label: 2, bag_size: 5017
batch 139, loss: 0.8345, instance_loss: 0.9053, weighted_loss: 0.8558, label: 1, bag_size: 1364
batch 159, loss: 0.5756, instance_loss: 0.6609, weighted_loss: 0.6012, label: 0, bag_size: 2392
batch 179, loss: 1.0737, instance_loss: 0.5837, weighted_loss: 0.9267, label: 1, bag_size: 3438
batch 199, loss: 0.0515, instance_loss: 0.1116, weighted_loss: 0.0696, label: 2, bag_size: 4088
batch 219, loss: 0.3087, instance_loss: 0.2731, weighted_loss: 0.2980, label: 0, bag_size: 5871
batch 239, loss: 1.0215, instance_loss: 0.7369, weighted_loss: 0.9361, label: 1, bag_size: 2671
batch 259, loss: 0.2712, instance_loss: 0.3664, weighted_loss: 0.2998, label: 0, bag_size: 2257
batch 279, loss: 0.0370, instance_loss: 0.0776, weighted_loss: 0.0492, label: 2, bag_size: 6001
batch 299, loss: 0.2039, instance_loss: 0.2053, weighted_loss: 0.2043, label: 2, bag_size: 4788
batch 319, loss: 0.3185, instance_loss: 0.5258, weighted_loss: 0.3807, label: 0, bag_size: 1417
batch 339, loss: 0.1932, instance_loss: 0.3138, weighted_loss: 0.2294, label: 0, bag_size: 3367
batch 359, loss: 0.1786, instance_loss: 0.4292, weighted_loss: 0.2538, label: 1, bag_size: 2731
batch 379, loss: 0.1155, instance_loss: 0.2324, weighted_loss: 0.1506, label: 2, bag_size: 4043
batch 399, loss: 0.6226, instance_loss: 0.4771, weighted_loss: 0.5789, label: 0, bag_size: 2671
batch 419, loss: 0.3747, instance_loss: 0.5209, weighted_loss: 0.4186, label: 0, bag_size: 4416
batch 439, loss: 0.1970, instance_loss: 0.2980, weighted_loss: 0.2273, label: 0, bag_size: 6440
batch 459, loss: 0.1678, instance_loss: 0.2531, weighted_loss: 0.1934, label: 0, bag_size: 6440
batch 479, loss: 0.2134, instance_loss: 0.3659, weighted_loss: 0.2592, label: 0, bag_size: 4347
batch 499, loss: 0.0289, instance_loss: 0.0930, weighted_loss: 0.0481, label: 0, bag_size: 3727
batch 519, loss: 0.1090, instance_loss: 0.1749, weighted_loss: 0.1288, label: 2, bag_size: 4775
batch 539, loss: 0.0435, instance_loss: 0.2572, weighted_loss: 0.1076, label: 0, bag_size: 2853
batch 559, loss: 0.2792, instance_loss: 0.6408, weighted_loss: 0.3877, label: 1, bag_size: 582
batch 579, loss: 0.1958, instance_loss: 0.3080, weighted_loss: 0.2295, label: 0, bag_size: 4242
batch 599, loss: 0.0768, instance_loss: 0.1274, weighted_loss: 0.0920, label: 0, bag_size: 5757
batch 619, loss: 1.3648, instance_loss: 0.5377, weighted_loss: 1.1167, label: 2, bag_size: 4241
batch 639, loss: 0.0768, instance_loss: 0.1974, weighted_loss: 0.1130, label: 0, bag_size: 3443
batch 659, loss: 0.0219, instance_loss: 0.0994, weighted_loss: 0.0452, label: 0, bag_size: 1825
batch 679, loss: 1.1955, instance_loss: 1.0403, weighted_loss: 1.1489, label: 1, bag_size: 936
batch 699, loss: 1.7336, instance_loss: 0.9185, weighted_loss: 1.4891, label: 0, bag_size: 3382
batch 719, loss: 0.1563, instance_loss: 0.2955, weighted_loss: 0.1980, label: 2, bag_size: 3121
batch 739, loss: 0.0380, instance_loss: 0.3193, weighted_loss: 0.1224, label: 1, bag_size: 259


class 0 clustering acc 0.970413870246085: correct 17351/17880
class 1 clustering acc 0.32869127516778524: correct 1959/5960
Epoch: 30, train_loss: 0.6340, train_clustering_loss:  0.5581, train_error: 0.2792
class 0: acc 0.7837837837837838, correct 203/259
class 1: acc 0.5912698412698413, correct 149/252
class 2: acc 0.7905982905982906, correct 185/234

Val Set, val_loss: 0.5921, val_error: 0.2872, auc: 0.8923
class 0 clustering acc 0.9601063829787234: correct 2166/2256
class 1 clustering acc 0.4175531914893617: correct 314/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.596255 --> 0.592120).  Saving model ...


batch 19, loss: 0.2663, instance_loss: 0.3259, weighted_loss: 0.2842, label: 2, bag_size: 3327
batch 39, loss: 0.0946, instance_loss: 0.1379, weighted_loss: 0.1076, label: 2, bag_size: 6026
batch 59, loss: 0.0797, instance_loss: 0.1032, weighted_loss: 0.0868, label: 2, bag_size: 2254
batch 79, loss: 0.3467, instance_loss: 0.2048, weighted_loss: 0.3041, label: 0, bag_size: 5413
batch 99, loss: 0.2722, instance_loss: 0.1518, weighted_loss: 0.2361, label: 2, bag_size: 3172
batch 119, loss: 0.1834, instance_loss: 0.2553, weighted_loss: 0.2050, label: 2, bag_size: 3497
batch 139, loss: 0.0381, instance_loss: 0.1786, weighted_loss: 0.0802, label: 0, bag_size: 1825
batch 159, loss: 0.0396, instance_loss: 0.1058, weighted_loss: 0.0594, label: 2, bag_size: 6026
batch 179, loss: 0.3204, instance_loss: 0.5929, weighted_loss: 0.4022, label: 1, bag_size: 1595
batch 199, loss: 1.0248, instance_loss: 0.9222, weighted_loss: 0.9940, label: 1, bag_size: 5167
batch 219, loss: 0.0430, instance_loss: 0.3100, weighted_loss: 0.1231, label: 1, bag_size: 3337
batch 239, loss: 0.0186, instance_loss: 0.1130, weighted_loss: 0.0469, label: 2, bag_size: 4745
batch 259, loss: 0.1113, instance_loss: 0.3215, weighted_loss: 0.1744, label: 1, bag_size: 3337
batch 279, loss: 1.0771, instance_loss: 1.5371, weighted_loss: 1.2151, label: 1, bag_size: 1604
batch 299, loss: 1.5556, instance_loss: 0.7432, weighted_loss: 1.3119, label: 1, bag_size: 296
batch 319, loss: 0.1390, instance_loss: 0.2827, weighted_loss: 0.1821, label: 2, bag_size: 6644
batch 339, loss: 0.0424, instance_loss: 0.1722, weighted_loss: 0.0813, label: 0, bag_size: 1744
batch 359, loss: 0.0074, instance_loss: 0.0468, weighted_loss: 0.0193, label: 0, bag_size: 5337
batch 379, loss: 0.0552, instance_loss: 0.4576, weighted_loss: 0.1759, label: 1, bag_size: 8482
batch 399, loss: 0.1683, instance_loss: 0.2350, weighted_loss: 0.1883, label: 2, bag_size: 3112
batch 419, loss: 0.1363, instance_loss: 0.2167, weighted_loss: 0.1604, label: 0, bag_size: 2545
batch 439, loss: 0.5546, instance_loss: 0.6027, weighted_loss: 0.5691, label: 1, bag_size: 3156
batch 459, loss: 0.0353, instance_loss: 0.1573, weighted_loss: 0.0719, label: 0, bag_size: 3754
batch 479, loss: 0.0918, instance_loss: 0.4519, weighted_loss: 0.1998, label: 0, bag_size: 4403
batch 499, loss: 0.9890, instance_loss: 0.5993, weighted_loss: 0.8721, label: 1, bag_size: 6942
batch 519, loss: 0.9561, instance_loss: 0.9679, weighted_loss: 0.9596, label: 0, bag_size: 4398
batch 539, loss: 1.7989, instance_loss: 0.9237, weighted_loss: 1.5364, label: 1, bag_size: 1045
batch 559, loss: 0.3505, instance_loss: 0.6386, weighted_loss: 0.4369, label: 2, bag_size: 4535
batch 579, loss: 0.0618, instance_loss: 0.2847, weighted_loss: 0.1286, label: 1, bag_size: 4184
batch 599, loss: 0.1148, instance_loss: 0.3807, weighted_loss: 0.1946, label: 1, bag_size: 5072
batch 619, loss: 0.7805, instance_loss: 0.6441, weighted_loss: 0.7396, label: 2, bag_size: 4372
batch 639, loss: 0.5781, instance_loss: 0.6050, weighted_loss: 0.5862, label: 0, bag_size: 2608
batch 659, loss: 0.0327, instance_loss: 0.1739, weighted_loss: 0.0751, label: 2, bag_size: 3497
batch 679, loss: 0.7438, instance_loss: 0.6046, weighted_loss: 0.7020, label: 1, bag_size: 3482
batch 699, loss: 2.7211, instance_loss: 1.4337, weighted_loss: 2.3349, label: 0, bag_size: 4337
batch 719, loss: 1.9503, instance_loss: 0.8556, weighted_loss: 1.6219, label: 0, bag_size: 6630
batch 739, loss: 0.3755, instance_loss: 0.3676, weighted_loss: 0.3732, label: 0, bag_size: 1373


class 0 clustering acc 0.9677293064876957: correct 17303/17880
class 1 clustering acc 0.348489932885906: correct 2077/5960
Epoch: 31, train_loss: 0.6013, train_clustering_loss:  0.5385, train_error: 0.2483
class 0: acc 0.7807017543859649, correct 178/228
class 1: acc 0.6555555555555556, correct 177/270
class 2: acc 0.8299595141700404, correct 205/247

Val Set, val_loss: 0.6330, val_error: 0.2340, auc: 0.8862
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.40425531914893614: correct 304/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4206, instance_loss: 0.7825, weighted_loss: 1.2292, label: 1, bag_size: 3508
batch 39, loss: 0.0397, instance_loss: 0.1439, weighted_loss: 0.0710, label: 2, bag_size: 3121
batch 59, loss: 1.9160, instance_loss: 1.1367, weighted_loss: 1.6822, label: 0, bag_size: 621
batch 79, loss: 1.0209, instance_loss: 1.0662, weighted_loss: 1.0345, label: 1, bag_size: 3184
batch 99, loss: 0.4084, instance_loss: 0.4388, weighted_loss: 0.4175, label: 1, bag_size: 2302
batch 119, loss: 0.0033, instance_loss: 0.3341, weighted_loss: 0.1025, label: 1, bag_size: 4067
batch 139, loss: 0.0788, instance_loss: 0.1496, weighted_loss: 0.1000, label: 2, bag_size: 3497
batch 159, loss: 0.8835, instance_loss: 0.6981, weighted_loss: 0.8279, label: 0, bag_size: 4018
batch 179, loss: 1.3117, instance_loss: 0.5755, weighted_loss: 1.0908, label: 0, bag_size: 7056
batch 199, loss: 0.1082, instance_loss: 0.2338, weighted_loss: 0.1459, label: 2, bag_size: 5924
batch 219, loss: 0.0368, instance_loss: 0.1839, weighted_loss: 0.0809, label: 0, bag_size: 5953
batch 239, loss: 0.3076, instance_loss: 0.5676, weighted_loss: 0.3856, label: 2, bag_size: 22464
batch 259, loss: 0.3642, instance_loss: 0.2788, weighted_loss: 0.3386, label: 0, bag_size: 4707
batch 279, loss: 0.0376, instance_loss: 0.1089, weighted_loss: 0.0590, label: 0, bag_size: 6182
batch 299, loss: 1.0787, instance_loss: 0.4858, weighted_loss: 0.9009, label: 0, bag_size: 1611
batch 319, loss: 0.0063, instance_loss: 0.0212, weighted_loss: 0.0108, label: 2, bag_size: 3415
batch 339, loss: 0.6427, instance_loss: 0.5006, weighted_loss: 0.6001, label: 0, bag_size: 3310
batch 359, loss: 1.5610, instance_loss: 1.1457, weighted_loss: 1.4364, label: 2, bag_size: 4342
batch 379, loss: 0.0060, instance_loss: 0.1559, weighted_loss: 0.0510, label: 1, bag_size: 7279
batch 399, loss: 0.0156, instance_loss: 0.3121, weighted_loss: 0.1045, label: 0, bag_size: 3319
batch 419, loss: 0.1960, instance_loss: 0.3921, weighted_loss: 0.2548, label: 2, bag_size: 5017
batch 439, loss: 0.0714, instance_loss: 0.1208, weighted_loss: 0.0862, label: 2, bag_size: 2254
batch 459, loss: 0.1157, instance_loss: 0.4154, weighted_loss: 0.2056, label: 2, bag_size: 3396
batch 479, loss: 1.3943, instance_loss: 0.7745, weighted_loss: 1.2083, label: 1, bag_size: 3422
batch 499, loss: 0.6659, instance_loss: 0.9860, weighted_loss: 0.7619, label: 1, bag_size: 5512
batch 519, loss: 0.3528, instance_loss: 0.7401, weighted_loss: 0.4690, label: 2, bag_size: 724
batch 539, loss: 0.2821, instance_loss: 0.4701, weighted_loss: 0.3385, label: 2, bag_size: 5037
batch 559, loss: 0.1396, instance_loss: 0.0960, weighted_loss: 0.1265, label: 0, bag_size: 4178
batch 579, loss: 2.4424, instance_loss: 1.1026, weighted_loss: 2.0405, label: 2, bag_size: 1513
batch 599, loss: 0.0570, instance_loss: 0.2334, weighted_loss: 0.1099, label: 0, bag_size: 4678
batch 619, loss: 1.5368, instance_loss: 1.5514, weighted_loss: 1.5412, label: 1, bag_size: 936
batch 639, loss: 1.2862, instance_loss: 1.1978, weighted_loss: 1.2597, label: 1, bag_size: 936
batch 659, loss: 0.7120, instance_loss: 0.8210, weighted_loss: 0.7447, label: 2, bag_size: 4910
batch 679, loss: 4.1203, instance_loss: 1.7568, weighted_loss: 3.4112, label: 0, bag_size: 35080
batch 699, loss: 0.2312, instance_loss: 0.2618, weighted_loss: 0.2404, label: 2, bag_size: 4096
batch 719, loss: 3.0937, instance_loss: 1.4889, weighted_loss: 2.6122, label: 1, bag_size: 3016
batch 739, loss: 1.1445, instance_loss: 0.7254, weighted_loss: 1.0188, label: 1, bag_size: 700


class 0 clustering acc 0.9708053691275168: correct 17358/17880
class 1 clustering acc 0.4053691275167785: correct 2416/5960
Epoch: 32, train_loss: 0.5555, train_clustering_loss:  0.5219, train_error: 0.2322
class 0: acc 0.775, correct 186/240
class 1: acc 0.6607142857142857, correct 148/224
class 2: acc 0.8469750889679716, correct 238/281

Val Set, val_loss: 0.9779, val_error: 0.3723, auc: 0.8688
class 0 clustering acc 0.9459219858156028: correct 2134/2256
class 1 clustering acc 0.2845744680851064: correct 214/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0001, instance_loss: 0.1404, weighted_loss: 0.0422, label: 0, bag_size: 2231
batch 39, loss: 0.1362, instance_loss: 0.3366, weighted_loss: 0.1963, label: 2, bag_size: 3227
batch 59, loss: 0.6840, instance_loss: 0.2880, weighted_loss: 0.5652, label: 0, bag_size: 4794
batch 79, loss: 0.0456, instance_loss: 0.1533, weighted_loss: 0.0779, label: 2, bag_size: 4856
batch 99, loss: 0.3337, instance_loss: 0.3714, weighted_loss: 0.3450, label: 0, bag_size: 3864
batch 119, loss: 0.4149, instance_loss: 0.7986, weighted_loss: 0.5300, label: 1, bag_size: 1221
batch 139, loss: 0.5032, instance_loss: 0.4774, weighted_loss: 0.4955, label: 0, bag_size: 1655
batch 159, loss: 0.2869, instance_loss: 0.6503, weighted_loss: 0.3959, label: 1, bag_size: 1066
batch 179, loss: 0.4430, instance_loss: 0.5193, weighted_loss: 0.4659, label: 1, bag_size: 2319
batch 199, loss: 0.5357, instance_loss: 0.7267, weighted_loss: 0.5930, label: 1, bag_size: 2671
batch 219, loss: 0.9406, instance_loss: 0.7871, weighted_loss: 0.8946, label: 1, bag_size: 3422
batch 239, loss: 0.7387, instance_loss: 0.8321, weighted_loss: 0.7667, label: 0, bag_size: 1795
batch 259, loss: 0.7928, instance_loss: 0.8783, weighted_loss: 0.8185, label: 2, bag_size: 1050
batch 279, loss: 0.4146, instance_loss: 0.3891, weighted_loss: 0.4069, label: 1, bag_size: 1410
batch 299, loss: 0.0014, instance_loss: 0.3151, weighted_loss: 0.0955, label: 1, bag_size: 3172
batch 319, loss: 3.9401, instance_loss: 1.5917, weighted_loss: 3.2356, label: 1, bag_size: 5205
batch 339, loss: 0.5653, instance_loss: 0.6349, weighted_loss: 0.5862, label: 1, bag_size: 3640
batch 359, loss: 0.1724, instance_loss: 0.4672, weighted_loss: 0.2608, label: 1, bag_size: 5072
batch 379, loss: 3.1523, instance_loss: 1.2639, weighted_loss: 2.5858, label: 0, bag_size: 4725
batch 399, loss: 0.0130, instance_loss: 0.9181, weighted_loss: 0.2845, label: 0, bag_size: 4485
batch 419, loss: 0.0233, instance_loss: 0.0381, weighted_loss: 0.0277, label: 2, bag_size: 2483
batch 439, loss: 1.0354, instance_loss: 0.8475, weighted_loss: 0.9790, label: 1, bag_size: 296
batch 459, loss: 0.1627, instance_loss: 0.2418, weighted_loss: 0.1865, label: 0, bag_size: 7927
batch 479, loss: 0.0634, instance_loss: 0.1424, weighted_loss: 0.0871, label: 0, bag_size: 1947
batch 499, loss: 0.0825, instance_loss: 0.1493, weighted_loss: 0.1026, label: 2, bag_size: 2905
batch 519, loss: 0.2600, instance_loss: 0.4994, weighted_loss: 0.3318, label: 2, bag_size: 3227
batch 539, loss: 0.2141, instance_loss: 0.4555, weighted_loss: 0.2865, label: 1, bag_size: 596
batch 559, loss: 2.8500, instance_loss: 1.5870, weighted_loss: 2.4711, label: 1, bag_size: 5423
batch 579, loss: 0.1498, instance_loss: 0.4743, weighted_loss: 0.2471, label: 1, bag_size: 5718
batch 599, loss: 0.2419, instance_loss: 0.1360, weighted_loss: 0.2101, label: 2, bag_size: 4788
batch 619, loss: 0.5059, instance_loss: 0.6858, weighted_loss: 0.5599, label: 0, bag_size: 3297
batch 639, loss: 0.2001, instance_loss: 0.4671, weighted_loss: 0.2802, label: 1, bag_size: 3333
batch 659, loss: 0.0272, instance_loss: 0.5362, weighted_loss: 0.1799, label: 0, bag_size: 4070
batch 679, loss: 0.0993, instance_loss: 0.4710, weighted_loss: 0.2108, label: 0, bag_size: 1245
batch 699, loss: 0.2941, instance_loss: 0.5362, weighted_loss: 0.3667, label: 1, bag_size: 6689
batch 719, loss: 2.4461, instance_loss: 1.3312, weighted_loss: 2.1116, label: 2, bag_size: 4316
batch 739, loss: 0.2563, instance_loss: 0.5935, weighted_loss: 0.3574, label: 2, bag_size: 6644


class 0 clustering acc 0.967337807606264: correct 17296/17880
class 1 clustering acc 0.3409395973154362: correct 2032/5960
Epoch: 33, train_loss: 0.6016, train_clustering_loss:  0.5592, train_error: 0.2470
class 0: acc 0.782051282051282, correct 183/234
class 1: acc 0.6640926640926641, correct 172/259
class 2: acc 0.8174603174603174, correct 206/252

Val Set, val_loss: 0.6317, val_error: 0.2660, auc: 0.8798
class 0 clustering acc 0.9459219858156028: correct 2134/2256
class 1 clustering acc 0.4574468085106383: correct 344/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0598, instance_loss: 0.1395, weighted_loss: 0.0837, label: 0, bag_size: 4997
batch 39, loss: 0.8667, instance_loss: 0.6784, weighted_loss: 0.8102, label: 1, bag_size: 5402
batch 59, loss: 0.1133, instance_loss: 0.2245, weighted_loss: 0.1466, label: 0, bag_size: 1087
batch 79, loss: 0.6846, instance_loss: 0.8998, weighted_loss: 0.7492, label: 2, bag_size: 3274
batch 99, loss: 0.0072, instance_loss: 0.3045, weighted_loss: 0.0964, label: 0, bag_size: 4582
batch 119, loss: 0.5019, instance_loss: 0.3190, weighted_loss: 0.4471, label: 0, bag_size: 1373
batch 139, loss: 0.2101, instance_loss: 0.2554, weighted_loss: 0.2237, label: 0, bag_size: 2927
batch 159, loss: 0.0417, instance_loss: 0.3134, weighted_loss: 0.1232, label: 1, bag_size: 6277
batch 179, loss: 0.4431, instance_loss: 0.7555, weighted_loss: 0.5368, label: 2, bag_size: 22464
batch 199, loss: 0.2749, instance_loss: 0.1928, weighted_loss: 0.2503, label: 2, bag_size: 4691
batch 219, loss: 0.5352, instance_loss: 0.5072, weighted_loss: 0.5268, label: 2, bag_size: 5406
batch 239, loss: 1.0525, instance_loss: 0.6368, weighted_loss: 0.9278, label: 0, bag_size: 5871
batch 259, loss: 1.4991, instance_loss: 1.0728, weighted_loss: 1.3713, label: 1, bag_size: 2425
batch 279, loss: 0.1553, instance_loss: 0.2309, weighted_loss: 0.1780, label: 0, bag_size: 4347
batch 299, loss: 0.6313, instance_loss: 0.5341, weighted_loss: 0.6021, label: 1, bag_size: 3640
batch 319, loss: 0.2619, instance_loss: 0.3224, weighted_loss: 0.2800, label: 0, bag_size: 1174
batch 339, loss: 3.2907, instance_loss: 1.2733, weighted_loss: 2.6855, label: 1, bag_size: 32
batch 359, loss: 0.3214, instance_loss: 0.4604, weighted_loss: 0.3631, label: 2, bag_size: 5037
batch 379, loss: 3.4816, instance_loss: 1.1083, weighted_loss: 2.7696, label: 0, bag_size: 3316
batch 399, loss: 0.1216, instance_loss: 0.2995, weighted_loss: 0.1750, label: 0, bag_size: 614
batch 419, loss: 1.0156, instance_loss: 1.0259, weighted_loss: 1.0187, label: 0, bag_size: 621
batch 439, loss: 0.0812, instance_loss: 0.2157, weighted_loss: 0.1216, label: 0, bag_size: 5459
batch 459, loss: 0.1070, instance_loss: 0.4053, weighted_loss: 0.1965, label: 1, bag_size: 6475
batch 479, loss: 0.0848, instance_loss: 0.2915, weighted_loss: 0.1468, label: 0, bag_size: 4994
batch 499, loss: 0.0787, instance_loss: 0.3521, weighted_loss: 0.1607, label: 0, bag_size: 3872
batch 519, loss: 0.8545, instance_loss: 0.7362, weighted_loss: 0.8190, label: 2, bag_size: 4342
batch 539, loss: 0.4342, instance_loss: 0.2949, weighted_loss: 0.3924, label: 2, bag_size: 2031
batch 559, loss: 0.1223, instance_loss: 0.2129, weighted_loss: 0.1495, label: 0, bag_size: 420
batch 579, loss: 0.1336, instance_loss: 0.2993, weighted_loss: 0.1833, label: 0, bag_size: 5375
batch 599, loss: 0.1222, instance_loss: 0.4809, weighted_loss: 0.2298, label: 2, bag_size: 3080
batch 619, loss: 0.6374, instance_loss: 0.6205, weighted_loss: 0.6323, label: 1, bag_size: 6942
batch 639, loss: 0.1608, instance_loss: 0.2978, weighted_loss: 0.2019, label: 1, bag_size: 9099
batch 659, loss: 0.0203, instance_loss: 0.0530, weighted_loss: 0.0301, label: 2, bag_size: 657
batch 679, loss: 1.7566, instance_loss: 1.1871, weighted_loss: 1.5858, label: 1, bag_size: 5402
batch 699, loss: 1.0527, instance_loss: 0.7885, weighted_loss: 0.9735, label: 1, bag_size: 817
batch 719, loss: 0.0191, instance_loss: 0.0937, weighted_loss: 0.0415, label: 0, bag_size: 1485
batch 739, loss: 0.0345, instance_loss: 0.0900, weighted_loss: 0.0512, label: 2, bag_size: 2997


class 0 clustering acc 0.9732102908277405: correct 17401/17880
class 1 clustering acc 0.3231543624161074: correct 1926/5960
Epoch: 34, train_loss: 0.5989, train_clustering_loss:  0.5510, train_error: 0.2389
class 0: acc 0.810077519379845, correct 209/258
class 1: acc 0.6706827309236948, correct 167/249
class 2: acc 0.8025210084033614, correct 191/238

Val Set, val_loss: 0.6527, val_error: 0.2553, auc: 0.8916
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.4109042553191489: correct 309/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0736, instance_loss: 0.3773, weighted_loss: 0.1647, label: 2, bag_size: 3227
batch 39, loss: 0.8170, instance_loss: 1.0234, weighted_loss: 0.8789, label: 0, bag_size: 1782
batch 59, loss: 0.0000, instance_loss: 0.4276, weighted_loss: 0.1283, label: 0, bag_size: 1709
batch 79, loss: 0.2683, instance_loss: 0.2401, weighted_loss: 0.2599, label: 2, bag_size: 88
batch 99, loss: 2.3605, instance_loss: 1.1232, weighted_loss: 1.9893, label: 2, bag_size: 1513
batch 119, loss: 0.1526, instance_loss: 0.2663, weighted_loss: 0.1867, label: 2, bag_size: 4096
batch 139, loss: 0.0351, instance_loss: 0.0941, weighted_loss: 0.0528, label: 0, bag_size: 1647
batch 159, loss: 2.3281, instance_loss: 0.6336, weighted_loss: 1.8197, label: 0, bag_size: 3402
batch 179, loss: 0.7285, instance_loss: 0.8019, weighted_loss: 0.7505, label: 1, bag_size: 11974
batch 199, loss: 1.1177, instance_loss: 0.7183, weighted_loss: 0.9979, label: 0, bag_size: 3709
batch 219, loss: 0.0103, instance_loss: 0.2885, weighted_loss: 0.0938, label: 1, bag_size: 3761
batch 239, loss: 3.8678, instance_loss: 3.0997, weighted_loss: 3.6374, label: 0, bag_size: 2736
batch 259, loss: 1.3933, instance_loss: 0.6791, weighted_loss: 1.1791, label: 1, bag_size: 1906
batch 279, loss: 0.2365, instance_loss: 0.3110, weighted_loss: 0.2589, label: 1, bag_size: 5728
batch 299, loss: 0.0106, instance_loss: 0.3413, weighted_loss: 0.1098, label: 0, bag_size: 5487
batch 319, loss: 1.4681, instance_loss: 0.7256, weighted_loss: 1.2454, label: 0, bag_size: 3402
batch 339, loss: 0.1692, instance_loss: 0.3971, weighted_loss: 0.2375, label: 0, bag_size: 5036
batch 359, loss: 0.0929, instance_loss: 0.1739, weighted_loss: 0.1172, label: 0, bag_size: 3924
batch 379, loss: 0.0337, instance_loss: 0.2549, weighted_loss: 0.1001, label: 1, bag_size: 3265
batch 399, loss: 0.2854, instance_loss: 0.5068, weighted_loss: 0.3518, label: 1, bag_size: 5276
batch 419, loss: 0.4754, instance_loss: 0.6143, weighted_loss: 0.5171, label: 0, bag_size: 3310
batch 439, loss: 0.1743, instance_loss: 0.3244, weighted_loss: 0.2193, label: 0, bag_size: 3690
batch 459, loss: 0.0752, instance_loss: 0.1152, weighted_loss: 0.0872, label: 0, bag_size: 4760
batch 479, loss: 0.3072, instance_loss: 0.2487, weighted_loss: 0.2897, label: 2, bag_size: 4487
batch 499, loss: 0.3224, instance_loss: 0.7850, weighted_loss: 0.4612, label: 2, bag_size: 6594
batch 519, loss: 0.0577, instance_loss: 0.4431, weighted_loss: 0.1733, label: 1, bag_size: 7135
batch 539, loss: 0.0001, instance_loss: 0.7014, weighted_loss: 0.2105, label: 0, bag_size: 1709
batch 559, loss: 0.0039, instance_loss: 0.1560, weighted_loss: 0.0495, label: 1, bag_size: 8802
batch 579, loss: 0.0583, instance_loss: 0.3119, weighted_loss: 0.1344, label: 2, bag_size: 4555
batch 599, loss: 0.1787, instance_loss: 0.3329, weighted_loss: 0.2249, label: 2, bag_size: 2481
batch 619, loss: 0.0870, instance_loss: 0.1053, weighted_loss: 0.0925, label: 2, bag_size: 3210
batch 639, loss: 0.2516, instance_loss: 0.4577, weighted_loss: 0.3134, label: 2, bag_size: 6594
batch 659, loss: 0.0482, instance_loss: 0.1301, weighted_loss: 0.0728, label: 2, bag_size: 3210
batch 679, loss: 0.0204, instance_loss: 0.1588, weighted_loss: 0.0619, label: 0, bag_size: 4644
batch 699, loss: 0.8739, instance_loss: 0.3557, weighted_loss: 0.7184, label: 0, bag_size: 5867
batch 719, loss: 0.2223, instance_loss: 0.2733, weighted_loss: 0.2376, label: 0, bag_size: 3155
batch 739, loss: 0.1218, instance_loss: 0.4029, weighted_loss: 0.2061, label: 1, bag_size: 4346


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.38036912751677854: correct 2267/5960
Epoch: 35, train_loss: 0.5698, train_clustering_loss:  0.5353, train_error: 0.2537
class 0: acc 0.8127490039840638, correct 204/251
class 1: acc 0.5958333333333333, correct 143/240
class 2: acc 0.8228346456692913, correct 209/254

Val Set, val_loss: 0.5738, val_error: 0.2340, auc: 0.8993
class 0 clustering acc 0.9539007092198581: correct 2152/2256
class 1 clustering acc 0.4747340425531915: correct 357/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.592120 --> 0.573751).  Saving model ...


batch 19, loss: 0.9643, instance_loss: 0.8720, weighted_loss: 0.9366, label: 1, bag_size: 1595
batch 39, loss: 0.3084, instance_loss: 0.3469, weighted_loss: 0.3200, label: 2, bag_size: 597
batch 59, loss: 0.0402, instance_loss: 0.1422, weighted_loss: 0.0708, label: 0, bag_size: 1744
batch 79, loss: 1.1833, instance_loss: 0.8065, weighted_loss: 1.0703, label: 1, bag_size: 1860
batch 99, loss: 0.5525, instance_loss: 0.8340, weighted_loss: 0.6369, label: 1, bag_size: 782
batch 119, loss: 0.1679, instance_loss: 0.3704, weighted_loss: 0.2287, label: 1, bag_size: 4595
batch 139, loss: 0.1185, instance_loss: 0.6131, weighted_loss: 0.2669, label: 2, bag_size: 2770
batch 159, loss: 0.0425, instance_loss: 0.2958, weighted_loss: 0.1185, label: 0, bag_size: 5570
batch 179, loss: 2.2391, instance_loss: 1.2072, weighted_loss: 1.9295, label: 1, bag_size: 1307
batch 199, loss: 0.0380, instance_loss: 0.0671, weighted_loss: 0.0467, label: 2, bag_size: 2997
batch 219, loss: 0.2806, instance_loss: 0.7820, weighted_loss: 0.4310, label: 1, bag_size: 5833
batch 239, loss: 1.4968, instance_loss: 0.8355, weighted_loss: 1.2984, label: 2, bag_size: 3274
batch 259, loss: 0.0043, instance_loss: 0.0278, weighted_loss: 0.0114, label: 2, bag_size: 657
batch 279, loss: 3.2550, instance_loss: 1.7640, weighted_loss: 2.8077, label: 1, bag_size: 3399
batch 299, loss: 0.3583, instance_loss: 0.8485, weighted_loss: 0.5054, label: 0, bag_size: 3871
batch 319, loss: 1.1303, instance_loss: 0.7793, weighted_loss: 1.0250, label: 0, bag_size: 3070
batch 339, loss: 0.6379, instance_loss: 0.3452, weighted_loss: 0.5501, label: 2, bag_size: 88
batch 359, loss: 0.4033, instance_loss: 0.6337, weighted_loss: 0.4724, label: 1, bag_size: 2743
batch 379, loss: 0.4319, instance_loss: 0.6854, weighted_loss: 0.5079, label: 2, bag_size: 3174
batch 399, loss: 0.0200, instance_loss: 0.0990, weighted_loss: 0.0437, label: 2, bag_size: 4775
batch 419, loss: 0.1923, instance_loss: 0.4353, weighted_loss: 0.2652, label: 2, bag_size: 3746
batch 439, loss: 0.2813, instance_loss: 0.4317, weighted_loss: 0.3264, label: 2, bag_size: 3746
batch 459, loss: 0.0522, instance_loss: 0.2286, weighted_loss: 0.1051, label: 1, bag_size: 3156
batch 479, loss: 0.1067, instance_loss: 0.1770, weighted_loss: 0.1278, label: 0, bag_size: 2293
batch 499, loss: 2.0759, instance_loss: 3.4277, weighted_loss: 2.4814, label: 0, bag_size: 2736
batch 519, loss: 0.8142, instance_loss: 0.8717, weighted_loss: 0.8315, label: 1, bag_size: 7176
batch 539, loss: 0.0517, instance_loss: 0.3246, weighted_loss: 0.1336, label: 1, bag_size: 1023
batch 559, loss: 0.1586, instance_loss: 0.5548, weighted_loss: 0.2775, label: 2, bag_size: 3604
batch 579, loss: 0.4729, instance_loss: 0.8638, weighted_loss: 0.5902, label: 2, bag_size: 724
batch 599, loss: 0.6695, instance_loss: 0.5524, weighted_loss: 0.6343, label: 2, bag_size: 552
batch 619, loss: 0.6248, instance_loss: 0.7957, weighted_loss: 0.6761, label: 1, bag_size: 2671
batch 639, loss: 0.2989, instance_loss: 0.4862, weighted_loss: 0.3551, label: 1, bag_size: 1394
batch 659, loss: 0.0371, instance_loss: 0.2735, weighted_loss: 0.1080, label: 0, bag_size: 921
batch 679, loss: 0.0662, instance_loss: 0.5821, weighted_loss: 0.2210, label: 0, bag_size: 3601
batch 699, loss: 0.2236, instance_loss: 0.2972, weighted_loss: 0.2457, label: 0, bag_size: 1049
batch 719, loss: 1.2427, instance_loss: 1.0107, weighted_loss: 1.1731, label: 2, bag_size: 3604
batch 739, loss: 0.3074, instance_loss: 0.7592, weighted_loss: 0.4430, label: 0, bag_size: 4841


class 0 clustering acc 0.971420581655481: correct 17369/17880
class 1 clustering acc 0.3615771812080537: correct 2155/5960
Epoch: 36, train_loss: 0.5474, train_clustering_loss:  0.5365, train_error: 0.2416
class 0: acc 0.7711864406779662, correct 182/236
class 1: acc 0.6575875486381323, correct 169/257
class 2: acc 0.8492063492063492, correct 214/252

Val Set, val_loss: 0.8205, val_error: 0.3085, auc: 0.8837
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.300531914893617: correct 226/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1609, instance_loss: 0.4111, weighted_loss: 0.2359, label: 2, bag_size: 3618
batch 39, loss: 2.1268, instance_loss: 0.8401, weighted_loss: 1.7408, label: 1, bag_size: 1608
batch 59, loss: 0.8866, instance_loss: 0.7784, weighted_loss: 0.8542, label: 0, bag_size: 13540
batch 79, loss: 0.0827, instance_loss: 0.4080, weighted_loss: 0.1803, label: 2, bag_size: 3607
batch 99, loss: 0.4648, instance_loss: 0.6202, weighted_loss: 0.5114, label: 1, bag_size: 2182
batch 119, loss: 1.1571, instance_loss: 0.7161, weighted_loss: 1.0248, label: 2, bag_size: 2561
batch 139, loss: 0.0534, instance_loss: 0.2751, weighted_loss: 0.1199, label: 2, bag_size: 4555
batch 159, loss: 0.5634, instance_loss: 0.5318, weighted_loss: 0.5540, label: 1, bag_size: 3106
batch 179, loss: 0.5889, instance_loss: 0.4698, weighted_loss: 0.5532, label: 0, bag_size: 4865
batch 199, loss: 0.2244, instance_loss: 0.3998, weighted_loss: 0.2770, label: 0, bag_size: 3533
batch 219, loss: 0.8481, instance_loss: 0.3345, weighted_loss: 0.6940, label: 0, bag_size: 5125
batch 239, loss: 0.1520, instance_loss: 0.7145, weighted_loss: 0.3208, label: 0, bag_size: 1933
batch 259, loss: 0.0466, instance_loss: 0.4251, weighted_loss: 0.1602, label: 1, bag_size: 3221
batch 279, loss: 0.0733, instance_loss: 0.1905, weighted_loss: 0.1084, label: 2, bag_size: 4555
batch 299, loss: 2.0443, instance_loss: 0.9944, weighted_loss: 1.7293, label: 2, bag_size: 3475
batch 319, loss: 0.2004, instance_loss: 0.3612, weighted_loss: 0.2486, label: 2, bag_size: 4132
batch 339, loss: 0.0277, instance_loss: 0.1062, weighted_loss: 0.0512, label: 2, bag_size: 5138
batch 359, loss: 0.0275, instance_loss: 0.1815, weighted_loss: 0.0737, label: 0, bag_size: 4015
batch 379, loss: 0.0125, instance_loss: 0.1954, weighted_loss: 0.0674, label: 0, bag_size: 6182
batch 399, loss: 0.0374, instance_loss: 0.1204, weighted_loss: 0.0623, label: 0, bag_size: 4242
batch 419, loss: 0.6859, instance_loss: 0.7707, weighted_loss: 0.7113, label: 2, bag_size: 4910
batch 439, loss: 0.0145, instance_loss: 0.3427, weighted_loss: 0.1129, label: 2, bag_size: 4497
batch 459, loss: 0.1863, instance_loss: 0.3327, weighted_loss: 0.2302, label: 0, bag_size: 702
batch 479, loss: 0.0807, instance_loss: 0.3167, weighted_loss: 0.1515, label: 0, bag_size: 3924
batch 499, loss: 0.0517, instance_loss: 0.4554, weighted_loss: 0.1728, label: 2, bag_size: 4497
batch 519, loss: 0.1767, instance_loss: 0.4496, weighted_loss: 0.2586, label: 0, bag_size: 1601
batch 539, loss: 0.1501, instance_loss: 0.3446, weighted_loss: 0.2085, label: 0, bag_size: 4997
batch 559, loss: 0.0371, instance_loss: 0.3997, weighted_loss: 0.1459, label: 1, bag_size: 3755
batch 579, loss: 0.0132, instance_loss: 0.4907, weighted_loss: 0.1564, label: 2, bag_size: 4497
batch 599, loss: 0.5746, instance_loss: 0.5910, weighted_loss: 0.5795, label: 0, bag_size: 640
batch 619, loss: 0.3119, instance_loss: 0.4976, weighted_loss: 0.3676, label: 2, bag_size: 4569
batch 639, loss: 4.6774, instance_loss: 2.3085, weighted_loss: 3.9667, label: 1, bag_size: 3399
batch 659, loss: 0.2491, instance_loss: 0.4073, weighted_loss: 0.2966, label: 2, bag_size: 3121
batch 679, loss: 0.0238, instance_loss: 1.0024, weighted_loss: 0.3174, label: 0, bag_size: 1645
batch 699, loss: 0.9294, instance_loss: 0.6601, weighted_loss: 0.8486, label: 1, bag_size: 4784
batch 719, loss: 0.2940, instance_loss: 0.5115, weighted_loss: 0.3593, label: 0, bag_size: 5893
batch 739, loss: 0.0808, instance_loss: 0.1862, weighted_loss: 0.1124, label: 2, bag_size: 4096


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.3939597315436242: correct 2348/5960
Epoch: 37, train_loss: 0.5484, train_clustering_loss:  0.5309, train_error: 0.2336
class 0: acc 0.8023255813953488, correct 207/258
class 1: acc 0.64, correct 144/225
class 2: acc 0.8396946564885496, correct 220/262

Val Set, val_loss: 0.8984, val_error: 0.3511, auc: 0.8744
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.2978723404255319: correct 224/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0429, instance_loss: 0.1237, weighted_loss: 0.0671, label: 2, bag_size: 6644
batch 39, loss: 0.2425, instance_loss: 0.4697, weighted_loss: 0.3107, label: 1, bag_size: 1599
batch 59, loss: 0.0890, instance_loss: 0.1517, weighted_loss: 0.1078, label: 2, bag_size: 4788
batch 79, loss: 0.0024, instance_loss: 0.3915, weighted_loss: 0.1191, label: 0, bag_size: 2306
batch 99, loss: 0.0953, instance_loss: 0.2970, weighted_loss: 0.1558, label: 2, bag_size: 4140
batch 119, loss: 0.7602, instance_loss: 0.7913, weighted_loss: 0.7695, label: 1, bag_size: 1371
batch 139, loss: 0.3692, instance_loss: 0.5746, weighted_loss: 0.4308, label: 2, bag_size: 4535
batch 159, loss: 0.1096, instance_loss: 0.2792, weighted_loss: 0.1605, label: 1, bag_size: 2493
batch 179, loss: 0.4806, instance_loss: 0.5993, weighted_loss: 0.5162, label: 2, bag_size: 5924
batch 199, loss: 1.4595, instance_loss: 1.2813, weighted_loss: 1.4060, label: 1, bag_size: 7176
batch 219, loss: 0.0707, instance_loss: 0.2054, weighted_loss: 0.1111, label: 0, bag_size: 2824
batch 239, loss: 0.9899, instance_loss: 1.0568, weighted_loss: 1.0099, label: 1, bag_size: 4940
batch 259, loss: 0.7521, instance_loss: 0.8181, weighted_loss: 0.7719, label: 1, bag_size: 3991
batch 279, loss: 0.2034, instance_loss: 0.3950, weighted_loss: 0.2609, label: 0, bag_size: 909
batch 299, loss: 0.4383, instance_loss: 0.5780, weighted_loss: 0.4802, label: 2, bag_size: 3080
batch 319, loss: 0.0546, instance_loss: 0.2216, weighted_loss: 0.1047, label: 2, bag_size: 5011
batch 339, loss: 0.0778, instance_loss: 0.0706, weighted_loss: 0.0756, label: 2, bag_size: 4788
batch 359, loss: 0.6443, instance_loss: 0.7879, weighted_loss: 0.6874, label: 0, bag_size: 3038
batch 379, loss: 1.3754, instance_loss: 1.1325, weighted_loss: 1.3026, label: 1, bag_size: 4824
batch 399, loss: 1.0650, instance_loss: 0.7102, weighted_loss: 0.9586, label: 0, bag_size: 421
batch 419, loss: 0.1457, instance_loss: 0.1284, weighted_loss: 0.1405, label: 2, bag_size: 4056
batch 439, loss: 0.0485, instance_loss: 0.2015, weighted_loss: 0.0944, label: 2, bag_size: 3227
batch 459, loss: 0.1441, instance_loss: 0.6702, weighted_loss: 0.3019, label: 2, bag_size: 3604
batch 479, loss: 0.5018, instance_loss: 0.6448, weighted_loss: 0.5447, label: 2, bag_size: 5017
batch 499, loss: 1.1900, instance_loss: 0.5152, weighted_loss: 0.9876, label: 2, bag_size: 2031
batch 519, loss: 0.0017, instance_loss: 0.3514, weighted_loss: 0.1066, label: 1, bag_size: 4534
batch 539, loss: 0.3546, instance_loss: 0.4797, weighted_loss: 0.3921, label: 2, bag_size: 3396
batch 559, loss: 1.2362, instance_loss: 0.8691, weighted_loss: 1.1261, label: 1, bag_size: 1860
batch 579, loss: 0.0283, instance_loss: 0.3849, weighted_loss: 0.1353, label: 1, bag_size: 7279
batch 599, loss: 0.0251, instance_loss: 0.0528, weighted_loss: 0.0334, label: 2, bag_size: 4856
batch 619, loss: 0.6146, instance_loss: 0.6181, weighted_loss: 0.6157, label: 0, bag_size: 4161
batch 639, loss: 0.0540, instance_loss: 0.3409, weighted_loss: 0.1401, label: 1, bag_size: 7135
batch 659, loss: 0.0023, instance_loss: 0.1021, weighted_loss: 0.0322, label: 1, bag_size: 3534
batch 679, loss: 0.2980, instance_loss: 0.4013, weighted_loss: 0.3290, label: 0, bag_size: 3936
batch 699, loss: 0.1941, instance_loss: 0.2281, weighted_loss: 0.2043, label: 2, bag_size: 3546
batch 719, loss: 0.7260, instance_loss: 0.4691, weighted_loss: 0.6490, label: 1, bag_size: 3225
batch 739, loss: 0.0185, instance_loss: 0.2574, weighted_loss: 0.0902, label: 0, bag_size: 3920


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.3459731543624161: correct 2062/5960
Epoch: 38, train_loss: 0.5470, train_clustering_loss:  0.5373, train_error: 0.2242
class 0: acc 0.7866108786610879, correct 188/239
class 1: acc 0.6814516129032258, correct 169/248
class 2: acc 0.8565891472868217, correct 221/258

Val Set, val_loss: 0.5973, val_error: 0.2128, auc: 0.9048
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.37898936170212766: correct 285/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4171, instance_loss: 0.7215, weighted_loss: 0.5084, label: 2, bag_size: 4535
batch 39, loss: 0.0767, instance_loss: 0.2194, weighted_loss: 0.1195, label: 0, bag_size: 5437
batch 59, loss: 0.0106, instance_loss: 0.0551, weighted_loss: 0.0239, label: 2, bag_size: 4745
batch 79, loss: 0.2176, instance_loss: 0.3521, weighted_loss: 0.2580, label: 0, bag_size: 4721
batch 99, loss: 1.1256, instance_loss: 1.4857, weighted_loss: 1.2336, label: 1, bag_size: 5833
batch 119, loss: 0.6502, instance_loss: 0.7382, weighted_loss: 0.6766, label: 2, bag_size: 22464
batch 139, loss: 0.3614, instance_loss: 0.7803, weighted_loss: 0.4871, label: 1, bag_size: 6243
batch 159, loss: 0.0157, instance_loss: 1.3247, weighted_loss: 0.4084, label: 0, bag_size: 1645
batch 179, loss: 0.4604, instance_loss: 0.2264, weighted_loss: 0.3902, label: 2, bag_size: 3327
batch 199, loss: 0.1375, instance_loss: 0.1669, weighted_loss: 0.1463, label: 2, bag_size: 3176
batch 219, loss: 0.4212, instance_loss: 0.7107, weighted_loss: 0.5081, label: 1, bag_size: 712
batch 239, loss: 0.0756, instance_loss: 0.4751, weighted_loss: 0.1954, label: 1, bag_size: 4184
batch 259, loss: 0.3454, instance_loss: 0.8363, weighted_loss: 0.4926, label: 2, bag_size: 1050
batch 279, loss: 1.7897, instance_loss: 0.9621, weighted_loss: 1.5414, label: 0, bag_size: 4719
batch 299, loss: 0.1547, instance_loss: 0.5378, weighted_loss: 0.2696, label: 1, bag_size: 5072
batch 319, loss: 0.4725, instance_loss: 0.6622, weighted_loss: 0.5294, label: 1, bag_size: 3991
batch 339, loss: 0.5706, instance_loss: 0.6613, weighted_loss: 0.5978, label: 0, bag_size: 4310
batch 359, loss: 0.4434, instance_loss: 0.5821, weighted_loss: 0.4850, label: 1, bag_size: 1599
batch 379, loss: 0.7798, instance_loss: 0.8594, weighted_loss: 0.8037, label: 1, bag_size: 2743
batch 399, loss: 0.2052, instance_loss: 2.2202, weighted_loss: 0.8097, label: 0, bag_size: 1981
batch 419, loss: 0.0810, instance_loss: 0.3157, weighted_loss: 0.1514, label: 0, bag_size: 4242
batch 439, loss: 0.0228, instance_loss: 0.2585, weighted_loss: 0.0935, label: 1, bag_size: 3337
batch 459, loss: 1.9146, instance_loss: 1.2821, weighted_loss: 1.7248, label: 1, bag_size: 1558
batch 479, loss: 0.0766, instance_loss: 0.2213, weighted_loss: 0.1200, label: 0, bag_size: 3924
batch 499, loss: 0.1639, instance_loss: 0.2929, weighted_loss: 0.2026, label: 0, bag_size: 3789
batch 519, loss: 0.3900, instance_loss: 0.4483, weighted_loss: 0.4075, label: 0, bag_size: 4337
batch 539, loss: 0.1789, instance_loss: 0.2561, weighted_loss: 0.2021, label: 0, bag_size: 4228
batch 559, loss: 0.5275, instance_loss: 0.4347, weighted_loss: 0.4996, label: 0, bag_size: 5848
batch 579, loss: 0.0233, instance_loss: 0.0970, weighted_loss: 0.0454, label: 2, bag_size: 6148
batch 599, loss: 0.1529, instance_loss: 0.8153, weighted_loss: 0.3517, label: 1, bag_size: 5696
batch 619, loss: 0.2282, instance_loss: 0.3521, weighted_loss: 0.2654, label: 2, bag_size: 3080
batch 639, loss: 0.4754, instance_loss: 0.7466, weighted_loss: 0.5568, label: 2, bag_size: 4342
batch 659, loss: 0.0307, instance_loss: 0.1558, weighted_loss: 0.0682, label: 0, bag_size: 6440
batch 679, loss: 0.0027, instance_loss: 0.1037, weighted_loss: 0.0330, label: 0, bag_size: 1140
batch 699, loss: 0.1853, instance_loss: 0.3053, weighted_loss: 0.2213, label: 2, bag_size: 2501
batch 719, loss: 0.0661, instance_loss: 0.1431, weighted_loss: 0.0892, label: 2, bag_size: 3176
batch 739, loss: 0.2976, instance_loss: 0.3300, weighted_loss: 0.3074, label: 2, bag_size: 4096


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.4045302013422819: correct 2411/5960
Epoch: 39, train_loss: 0.5131, train_clustering_loss:  0.5291, train_error: 0.2201
class 0: acc 0.8045977011494253, correct 210/261
class 1: acc 0.625, correct 135/216
class 2: acc 0.8805970149253731, correct 236/268

Val Set, val_loss: 0.5754, val_error: 0.2447, auc: 0.9029
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.4401595744680851: correct 331/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2391, instance_loss: 0.3270, weighted_loss: 0.2655, label: 0, bag_size: 5375
batch 39, loss: 0.7735, instance_loss: 0.7242, weighted_loss: 0.7587, label: 0, bag_size: 1352
batch 59, loss: 0.2101, instance_loss: 0.2762, weighted_loss: 0.2300, label: 0, bag_size: 4946
batch 79, loss: 0.2032, instance_loss: 0.2229, weighted_loss: 0.2091, label: 0, bag_size: 4524
batch 99, loss: 1.2724, instance_loss: 1.2534, weighted_loss: 1.2667, label: 2, bag_size: 3475
batch 119, loss: 0.0961, instance_loss: 0.2245, weighted_loss: 0.1346, label: 2, bag_size: 3778
batch 139, loss: 0.1299, instance_loss: 0.2065, weighted_loss: 0.1529, label: 2, bag_size: 3210
batch 159, loss: 0.3573, instance_loss: 0.3253, weighted_loss: 0.3477, label: 0, bag_size: 5526
batch 179, loss: 0.7223, instance_loss: 0.4072, weighted_loss: 0.6278, label: 0, bag_size: 5098
batch 199, loss: 0.0709, instance_loss: 0.2026, weighted_loss: 0.1104, label: 0, bag_size: 4544
batch 219, loss: 0.5471, instance_loss: 0.6038, weighted_loss: 0.5641, label: 0, bag_size: 1782
batch 239, loss: 0.0462, instance_loss: 0.0524, weighted_loss: 0.0480, label: 2, bag_size: 4691
batch 259, loss: 0.0515, instance_loss: 0.3656, weighted_loss: 0.1457, label: 0, bag_size: 6182
batch 279, loss: 0.0731, instance_loss: 0.4444, weighted_loss: 0.1845, label: 1, bag_size: 3126
batch 299, loss: 0.7080, instance_loss: 0.6918, weighted_loss: 0.7032, label: 1, bag_size: 3991
batch 319, loss: 0.2056, instance_loss: 0.1242, weighted_loss: 0.1812, label: 2, bag_size: 2561
batch 339, loss: 0.3391, instance_loss: 0.4568, weighted_loss: 0.3744, label: 1, bag_size: 6152
batch 359, loss: 1.1947, instance_loss: 0.6805, weighted_loss: 1.0404, label: 1, bag_size: 6241
batch 379, loss: 1.9408, instance_loss: 0.9364, weighted_loss: 1.6395, label: 2, bag_size: 223
batch 399, loss: 3.0744, instance_loss: 1.0288, weighted_loss: 2.4607, label: 2, bag_size: 4241
batch 419, loss: 0.1939, instance_loss: 0.2001, weighted_loss: 0.1958, label: 2, bag_size: 2481
batch 439, loss: 2.1140, instance_loss: 1.1169, weighted_loss: 1.8149, label: 2, bag_size: 4316
batch 459, loss: 0.4706, instance_loss: 0.4338, weighted_loss: 0.4596, label: 0, bag_size: 1662
batch 479, loss: 0.0670, instance_loss: 0.3548, weighted_loss: 0.1533, label: 0, bag_size: 2195
batch 499, loss: 0.1026, instance_loss: 0.1114, weighted_loss: 0.1053, label: 2, bag_size: 88
batch 519, loss: 0.7401, instance_loss: 0.5933, weighted_loss: 0.6961, label: 0, bag_size: 4922
batch 539, loss: 0.8028, instance_loss: 0.9797, weighted_loss: 0.8559, label: 1, bag_size: 2472
batch 559, loss: 0.4072, instance_loss: 0.4836, weighted_loss: 0.4301, label: 1, bag_size: 2919
batch 579, loss: 1.5284, instance_loss: 0.9889, weighted_loss: 1.3666, label: 2, bag_size: 22464
batch 599, loss: 0.3485, instance_loss: 0.5034, weighted_loss: 0.3950, label: 1, bag_size: 3391
batch 619, loss: 0.9649, instance_loss: 0.7554, weighted_loss: 0.9021, label: 0, bag_size: 3475
batch 639, loss: 0.0198, instance_loss: 0.1743, weighted_loss: 0.0662, label: 0, bag_size: 2019
batch 659, loss: 0.9206, instance_loss: 0.6335, weighted_loss: 0.8345, label: 1, bag_size: 2319
batch 679, loss: 0.3795, instance_loss: 0.6885, weighted_loss: 0.4722, label: 1, bag_size: 2753
batch 699, loss: 0.6651, instance_loss: 0.8259, weighted_loss: 0.7134, label: 1, bag_size: 4184
batch 719, loss: 0.5779, instance_loss: 0.6690, weighted_loss: 0.6052, label: 2, bag_size: 22464
batch 739, loss: 0.2186, instance_loss: 0.9555, weighted_loss: 0.4396, label: 1, bag_size: 4898


class 0 clustering acc 0.9669463087248322: correct 17289/17880
class 1 clustering acc 0.3624161073825503: correct 2160/5960
Epoch: 40, train_loss: 0.5814, train_clustering_loss:  0.5440, train_error: 0.2389
class 0: acc 0.807843137254902, correct 206/255
class 1: acc 0.6299559471365639, correct 143/227
class 2: acc 0.8288973384030418, correct 218/263

Val Set, val_loss: 0.6164, val_error: 0.2660, auc: 0.8956
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.44680851063829785: correct 336/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0192, instance_loss: 0.1375, weighted_loss: 0.0547, label: 2, bag_size: 3121
batch 39, loss: 0.7027, instance_loss: 0.4339, weighted_loss: 0.6221, label: 0, bag_size: 3662
batch 59, loss: 0.4951, instance_loss: 0.5421, weighted_loss: 0.5092, label: 2, bag_size: 6298
batch 79, loss: 0.8980, instance_loss: 0.7292, weighted_loss: 0.8473, label: 2, bag_size: 909
batch 99, loss: 0.0204, instance_loss: 0.5651, weighted_loss: 0.1838, label: 1, bag_size: 4898
batch 119, loss: 0.0319, instance_loss: 0.1768, weighted_loss: 0.0754, label: 0, bag_size: 3924
batch 139, loss: 0.2542, instance_loss: 0.5048, weighted_loss: 0.3294, label: 1, bag_size: 1599
batch 159, loss: 0.5921, instance_loss: 0.5119, weighted_loss: 0.5680, label: 2, bag_size: 4096
batch 179, loss: 0.2261, instance_loss: 0.4062, weighted_loss: 0.2801, label: 2, bag_size: 3396
batch 199, loss: 0.2630, instance_loss: 0.4106, weighted_loss: 0.3073, label: 0, bag_size: 3904
batch 219, loss: 1.6430, instance_loss: 1.4589, weighted_loss: 1.5878, label: 1, bag_size: 1477
batch 239, loss: 0.0594, instance_loss: 0.1375, weighted_loss: 0.0828, label: 2, bag_size: 3121
batch 259, loss: 2.0435, instance_loss: 0.7671, weighted_loss: 1.6606, label: 0, bag_size: 5023
batch 279, loss: 2.8585, instance_loss: 1.6267, weighted_loss: 2.4889, label: 0, bag_size: 557
batch 299, loss: 0.0872, instance_loss: 0.2309, weighted_loss: 0.1303, label: 0, bag_size: 3406
batch 319, loss: 0.0249, instance_loss: 1.2646, weighted_loss: 0.3968, label: 0, bag_size: 4083
batch 339, loss: 2.4791, instance_loss: 1.5522, weighted_loss: 2.2010, label: 0, bag_size: 4509
batch 359, loss: 0.5293, instance_loss: 0.5280, weighted_loss: 0.5289, label: 2, bag_size: 3778
batch 379, loss: 0.5768, instance_loss: 0.5166, weighted_loss: 0.5587, label: 2, bag_size: 552
batch 399, loss: 0.0160, instance_loss: 0.0506, weighted_loss: 0.0264, label: 2, bag_size: 4856
batch 419, loss: 1.0187, instance_loss: 0.6616, weighted_loss: 0.9115, label: 2, bag_size: 5406
batch 439, loss: 0.1117, instance_loss: 0.3301, weighted_loss: 0.1772, label: 0, bag_size: 1485
batch 459, loss: 0.0704, instance_loss: 0.5280, weighted_loss: 0.2077, label: 0, bag_size: 6285
batch 479, loss: 0.5206, instance_loss: 0.6928, weighted_loss: 0.5722, label: 1, bag_size: 4784
batch 499, loss: 0.2012, instance_loss: 0.2959, weighted_loss: 0.2296, label: 2, bag_size: 2501
batch 519, loss: 0.1171, instance_loss: 0.4041, weighted_loss: 0.2032, label: 2, bag_size: 4140
batch 539, loss: 0.2363, instance_loss: 0.2865, weighted_loss: 0.2514, label: 0, bag_size: 3370
batch 559, loss: 0.3281, instance_loss: 0.6024, weighted_loss: 0.4104, label: 2, bag_size: 4535
batch 579, loss: 0.0200, instance_loss: 0.0449, weighted_loss: 0.0275, label: 2, bag_size: 4691
batch 599, loss: 0.0213, instance_loss: 0.4260, weighted_loss: 0.1428, label: 1, bag_size: 4027
batch 619, loss: 0.1143, instance_loss: 0.2891, weighted_loss: 0.1667, label: 2, bag_size: 3746
batch 639, loss: 0.0550, instance_loss: 0.1991, weighted_loss: 0.0982, label: 1, bag_size: 4595
batch 659, loss: 0.0863, instance_loss: 0.2139, weighted_loss: 0.1246, label: 0, bag_size: 4760
batch 679, loss: 0.3779, instance_loss: 0.5450, weighted_loss: 0.4280, label: 2, bag_size: 5426
batch 699, loss: 0.1469, instance_loss: 0.4301, weighted_loss: 0.2319, label: 0, bag_size: 1097
batch 719, loss: 0.2199, instance_loss: 0.8190, weighted_loss: 0.3996, label: 0, bag_size: 4808
batch 739, loss: 1.5107, instance_loss: 0.6709, weighted_loss: 1.2587, label: 2, bag_size: 5406


class 0 clustering acc 0.9713087248322148: correct 17367/17880
class 1 clustering acc 0.3775167785234899: correct 2250/5960
Epoch: 41, train_loss: 0.5730, train_clustering_loss:  0.5292, train_error: 0.2255
class 0: acc 0.8, correct 184/230
class 1: acc 0.6194690265486725, correct 140/226
class 2: acc 0.8754325259515571, correct 253/289

Val Set, val_loss: 0.5989, val_error: 0.2447, auc: 0.9035
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.2327127659574468: correct 175/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1640, instance_loss: 0.3439, weighted_loss: 0.2180, label: 2, bag_size: 4162
batch 39, loss: 0.6167, instance_loss: 0.5239, weighted_loss: 0.5889, label: 0, bag_size: 4201
batch 59, loss: 1.7887, instance_loss: 1.3870, weighted_loss: 1.6682, label: 0, bag_size: 12971
batch 79, loss: 0.0056, instance_loss: 0.0410, weighted_loss: 0.0162, label: 2, bag_size: 6148
batch 99, loss: 0.1092, instance_loss: 0.3374, weighted_loss: 0.1777, label: 1, bag_size: 3296
batch 119, loss: 1.6774, instance_loss: 1.4438, weighted_loss: 1.6073, label: 0, bag_size: 1774
batch 139, loss: 0.0665, instance_loss: 0.3982, weighted_loss: 0.1660, label: 0, bag_size: 667
batch 159, loss: 0.0444, instance_loss: 0.2754, weighted_loss: 0.1137, label: 2, bag_size: 5924
batch 179, loss: 0.0504, instance_loss: 0.2152, weighted_loss: 0.0998, label: 0, bag_size: 873
batch 199, loss: 0.0296, instance_loss: 0.2194, weighted_loss: 0.0865, label: 2, bag_size: 2209
batch 219, loss: 0.1744, instance_loss: 0.5700, weighted_loss: 0.2931, label: 0, bag_size: 4894
batch 239, loss: 0.2480, instance_loss: 0.6199, weighted_loss: 0.3596, label: 1, bag_size: 3437
batch 259, loss: 0.1879, instance_loss: 0.4345, weighted_loss: 0.2619, label: 1, bag_size: 6243
batch 279, loss: 1.0595, instance_loss: 0.7197, weighted_loss: 0.9576, label: 0, bag_size: 5526
batch 299, loss: 0.1609, instance_loss: 0.5521, weighted_loss: 0.2783, label: 2, bag_size: 3227
batch 319, loss: 0.9045, instance_loss: 0.8926, weighted_loss: 0.9010, label: 1, bag_size: 4612
batch 339, loss: 1.4747, instance_loss: 1.1267, weighted_loss: 1.3703, label: 2, bag_size: 4342
batch 359, loss: 1.0568, instance_loss: 0.4664, weighted_loss: 0.8796, label: 1, bag_size: 4373
batch 379, loss: 4.2309, instance_loss: 1.4266, weighted_loss: 3.3896, label: 0, bag_size: 603
batch 399, loss: 1.4463, instance_loss: 0.8600, weighted_loss: 1.2704, label: 1, bag_size: 1250
batch 419, loss: 0.6430, instance_loss: 0.6437, weighted_loss: 0.6432, label: 1, bag_size: 11974
batch 439, loss: 0.1410, instance_loss: 0.5427, weighted_loss: 0.2615, label: 1, bag_size: 8482
batch 459, loss: 0.1909, instance_loss: 0.2959, weighted_loss: 0.2224, label: 0, bag_size: 5992
batch 479, loss: 0.3915, instance_loss: 0.4384, weighted_loss: 0.4056, label: 0, bag_size: 3864
batch 499, loss: 0.0127, instance_loss: 0.2061, weighted_loss: 0.0707, label: 0, bag_size: 829
batch 519, loss: 0.0695, instance_loss: 0.2383, weighted_loss: 0.1202, label: 2, bag_size: 4302
batch 539, loss: 0.0446, instance_loss: 0.1306, weighted_loss: 0.0704, label: 0, bag_size: 1399
batch 559, loss: 0.0085, instance_loss: 0.1057, weighted_loss: 0.0376, label: 1, bag_size: 259
batch 579, loss: 0.0864, instance_loss: 0.2235, weighted_loss: 0.1276, label: 1, bag_size: 2092
batch 599, loss: 0.0329, instance_loss: 0.0605, weighted_loss: 0.0412, label: 2, bag_size: 6026
batch 619, loss: 1.2831, instance_loss: 0.9069, weighted_loss: 1.1702, label: 1, bag_size: 5880
batch 639, loss: 0.0906, instance_loss: 0.2652, weighted_loss: 0.1430, label: 0, bag_size: 4458
batch 659, loss: 0.0801, instance_loss: 0.2938, weighted_loss: 0.1442, label: 2, bag_size: 5138
batch 679, loss: 0.1651, instance_loss: 0.3343, weighted_loss: 0.2159, label: 0, bag_size: 3701
batch 699, loss: 0.3142, instance_loss: 0.6770, weighted_loss: 0.4230, label: 2, bag_size: 1050
batch 719, loss: 0.3861, instance_loss: 0.3877, weighted_loss: 0.3866, label: 1, bag_size: 2859
batch 739, loss: 0.6282, instance_loss: 1.1873, weighted_loss: 0.7959, label: 1, bag_size: 3533


class 0 clustering acc 0.973434004474273: correct 17405/17880
class 1 clustering acc 0.3773489932885906: correct 2249/5960
Epoch: 42, train_loss: 0.5427, train_clustering_loss:  0.5173, train_error: 0.2174
class 0: acc 0.78125, correct 175/224
class 1: acc 0.7346153846153847, correct 191/260
class 2: acc 0.8314176245210728, correct 217/261

Val Set, val_loss: 0.7003, val_error: 0.2660, auc: 0.9031
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.27393617021276595: correct 206/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3453, instance_loss: 1.1526, weighted_loss: 1.2875, label: 1, bag_size: 2927
batch 39, loss: 0.1915, instance_loss: 0.2744, weighted_loss: 0.2164, label: 2, bag_size: 4555
batch 59, loss: 0.0492, instance_loss: 0.0986, weighted_loss: 0.0640, label: 2, bag_size: 2905
batch 79, loss: 0.1629, instance_loss: 0.5281, weighted_loss: 0.2725, label: 0, bag_size: 2257
batch 99, loss: 0.0602, instance_loss: 0.3650, weighted_loss: 0.1516, label: 0, bag_size: 5953
batch 119, loss: 0.5010, instance_loss: 0.5029, weighted_loss: 0.5016, label: 2, bag_size: 3746
batch 139, loss: 0.2081, instance_loss: 0.3063, weighted_loss: 0.2375, label: 0, bag_size: 4531
batch 159, loss: 1.1185, instance_loss: 1.2762, weighted_loss: 1.1658, label: 1, bag_size: 3995
batch 179, loss: 0.2192, instance_loss: 1.5008, weighted_loss: 0.6037, label: 1, bag_size: 3995
batch 199, loss: 0.1310, instance_loss: 0.3193, weighted_loss: 0.1875, label: 2, bag_size: 3174
batch 219, loss: 0.3079, instance_loss: 0.3060, weighted_loss: 0.3073, label: 0, bag_size: 272
batch 239, loss: 0.6196, instance_loss: 0.4565, weighted_loss: 0.5706, label: 0, bag_size: 272
batch 259, loss: 1.1112, instance_loss: 0.9768, weighted_loss: 1.0709, label: 2, bag_size: 5307
batch 279, loss: 0.0000, instance_loss: 0.3903, weighted_loss: 0.1171, label: 1, bag_size: 6277
batch 299, loss: 1.9082, instance_loss: 1.0750, weighted_loss: 1.6582, label: 0, bag_size: 19216
batch 319, loss: 0.6356, instance_loss: 0.5698, weighted_loss: 0.6158, label: 2, bag_size: 4096
batch 339, loss: 3.2962, instance_loss: 1.0549, weighted_loss: 2.6238, label: 0, bag_size: 3419
batch 359, loss: 0.0355, instance_loss: 0.0457, weighted_loss: 0.0386, label: 2, bag_size: 4788
batch 379, loss: 0.1718, instance_loss: 0.2244, weighted_loss: 0.1876, label: 0, bag_size: 4909
batch 399, loss: 0.1701, instance_loss: 0.7154, weighted_loss: 0.3337, label: 1, bag_size: 683
batch 419, loss: 0.0867, instance_loss: 0.2385, weighted_loss: 0.1322, label: 0, bag_size: 3872
batch 439, loss: 0.1719, instance_loss: 0.3834, weighted_loss: 0.2353, label: 2, bag_size: 3746
batch 459, loss: 0.5719, instance_loss: 0.6323, weighted_loss: 0.5900, label: 1, bag_size: 4067
batch 479, loss: 0.6401, instance_loss: 0.6844, weighted_loss: 0.6534, label: 1, bag_size: 1599
batch 499, loss: 0.0108, instance_loss: 0.1138, weighted_loss: 0.0417, label: 2, bag_size: 3397
batch 519, loss: 0.2796, instance_loss: 0.4222, weighted_loss: 0.3224, label: 2, bag_size: 3174
batch 539, loss: 0.0828, instance_loss: 0.2094, weighted_loss: 0.1208, label: 0, bag_size: 1176
batch 559, loss: 0.2251, instance_loss: 0.1888, weighted_loss: 0.2142, label: 2, bag_size: 4569
batch 579, loss: 0.0210, instance_loss: 0.0279, weighted_loss: 0.0231, label: 2, bag_size: 657
batch 599, loss: 0.0000, instance_loss: 0.3404, weighted_loss: 0.1021, label: 1, bag_size: 5462
batch 619, loss: 0.6551, instance_loss: 1.0077, weighted_loss: 0.7609, label: 1, bag_size: 2905
batch 639, loss: 0.7127, instance_loss: 0.4464, weighted_loss: 0.6328, label: 1, bag_size: 4708
batch 659, loss: 0.0164, instance_loss: 0.4344, weighted_loss: 0.1418, label: 1, bag_size: 4134
batch 679, loss: 0.0047, instance_loss: 0.0968, weighted_loss: 0.0323, label: 0, bag_size: 1825
batch 699, loss: 0.1256, instance_loss: 0.2650, weighted_loss: 0.1674, label: 0, bag_size: 3367
batch 719, loss: 0.0203, instance_loss: 0.0895, weighted_loss: 0.0411, label: 0, bag_size: 3601
batch 739, loss: 0.0679, instance_loss: 0.2407, weighted_loss: 0.1197, label: 2, bag_size: 4745


class 0 clustering acc 0.9699664429530201: correct 17343/17880
class 1 clustering acc 0.3731543624161074: correct 2224/5960
Epoch: 43, train_loss: 0.5722, train_clustering_loss:  0.5336, train_error: 0.2403
class 0: acc 0.7918367346938775, correct 194/245
class 1: acc 0.6300813008130082, correct 155/246
class 2: acc 0.8543307086614174, correct 217/254

Val Set, val_loss: 0.6038, val_error: 0.2553, auc: 0.8911
class 0 clustering acc 0.9401595744680851: correct 2121/2256
class 1 clustering acc 0.47606382978723405: correct 358/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6314, instance_loss: 0.6009, weighted_loss: 0.6222, label: 1, bag_size: 3438
batch 39, loss: 0.3810, instance_loss: 0.3796, weighted_loss: 0.3806, label: 2, bag_size: 3172
batch 59, loss: 0.0028, instance_loss: 0.5768, weighted_loss: 0.1750, label: 1, bag_size: 4134
batch 79, loss: 0.0081, instance_loss: 0.1851, weighted_loss: 0.0612, label: 0, bag_size: 3816
batch 99, loss: 1.6611, instance_loss: 1.0384, weighted_loss: 1.4743, label: 2, bag_size: 1513
batch 119, loss: 2.0325, instance_loss: 1.0050, weighted_loss: 1.7243, label: 1, bag_size: 3823
batch 139, loss: 0.1453, instance_loss: 0.3117, weighted_loss: 0.1952, label: 0, bag_size: 3376
batch 159, loss: 0.7155, instance_loss: 1.1907, weighted_loss: 0.8580, label: 2, bag_size: 4571
batch 179, loss: 0.1805, instance_loss: 0.4143, weighted_loss: 0.2507, label: 0, bag_size: 4894
batch 199, loss: 0.0547, instance_loss: 0.0584, weighted_loss: 0.0558, label: 2, bag_size: 2997
batch 219, loss: 0.0304, instance_loss: 0.3864, weighted_loss: 0.1372, label: 1, bag_size: 3437
batch 239, loss: 1.0615, instance_loss: 0.5786, weighted_loss: 0.9166, label: 0, bag_size: 3915
batch 259, loss: 0.0339, instance_loss: 0.1164, weighted_loss: 0.0587, label: 1, bag_size: 3534
batch 279, loss: 0.4850, instance_loss: 0.8304, weighted_loss: 0.5886, label: 0, bag_size: 5108
batch 299, loss: 1.6597, instance_loss: 0.5128, weighted_loss: 1.3157, label: 0, bag_size: 5867
batch 319, loss: 0.2407, instance_loss: 0.9945, weighted_loss: 0.4668, label: 1, bag_size: 3425
batch 339, loss: 2.2281, instance_loss: 0.9249, weighted_loss: 1.8371, label: 0, bag_size: 2597
batch 359, loss: 1.0472, instance_loss: 0.7030, weighted_loss: 0.9439, label: 1, bag_size: 5197
batch 379, loss: 0.8128, instance_loss: 0.9926, weighted_loss: 0.8667, label: 2, bag_size: 728
batch 399, loss: 0.2158, instance_loss: 0.4849, weighted_loss: 0.2965, label: 1, bag_size: 2122
batch 419, loss: 0.5200, instance_loss: 0.5642, weighted_loss: 0.5333, label: 2, bag_size: 5637
batch 439, loss: 0.4923, instance_loss: 0.6286, weighted_loss: 0.5332, label: 1, bag_size: 8632
batch 459, loss: 0.1080, instance_loss: 0.4670, weighted_loss: 0.2157, label: 0, bag_size: 5953
batch 479, loss: 1.4788, instance_loss: 0.9359, weighted_loss: 1.3159, label: 1, bag_size: 3475
batch 499, loss: 0.0360, instance_loss: 0.4347, weighted_loss: 0.1556, label: 2, bag_size: 4497
batch 519, loss: 0.0532, instance_loss: 0.4233, weighted_loss: 0.1642, label: 1, bag_size: 5718
batch 539, loss: 0.0247, instance_loss: 0.1604, weighted_loss: 0.0654, label: 2, bag_size: 3497
batch 559, loss: 1.0896, instance_loss: 0.7679, weighted_loss: 0.9931, label: 1, bag_size: 6315
batch 579, loss: 0.0695, instance_loss: 0.2296, weighted_loss: 0.1175, label: 1, bag_size: 1023
batch 599, loss: 1.4054, instance_loss: 1.0750, weighted_loss: 1.3063, label: 2, bag_size: 7607
batch 619, loss: 0.3009, instance_loss: 0.6095, weighted_loss: 0.3935, label: 1, bag_size: 3755
batch 639, loss: 0.6414, instance_loss: 0.7276, weighted_loss: 0.6673, label: 1, bag_size: 2472
batch 659, loss: 2.3494, instance_loss: 2.1855, weighted_loss: 2.3002, label: 0, bag_size: 434
batch 679, loss: 1.1760, instance_loss: 0.6915, weighted_loss: 1.0307, label: 1, bag_size: 3508
batch 699, loss: 1.3736, instance_loss: 0.6387, weighted_loss: 1.1532, label: 0, bag_size: 3382
batch 719, loss: 0.0915, instance_loss: 0.1742, weighted_loss: 0.1163, label: 0, bag_size: 3649
batch 739, loss: 1.2397, instance_loss: 1.2634, weighted_loss: 1.2468, label: 1, bag_size: 2248


class 0 clustering acc 0.9689597315436241: correct 17325/17880
class 1 clustering acc 0.38859060402684564: correct 2316/5960
Epoch: 44, train_loss: 0.5587, train_clustering_loss:  0.5361, train_error: 0.2510
class 0: acc 0.7327586206896551, correct 170/232
class 1: acc 0.6806083650190115, correct 179/263
class 2: acc 0.836, correct 209/250

Val Set, val_loss: 0.6042, val_error: 0.2660, auc: 0.9008
class 0 clustering acc 0.9454787234042553: correct 2133/2256
class 1 clustering acc 0.45345744680851063: correct 341/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.2642, instance_loss: 1.1742, weighted_loss: 1.9372, label: 2, bag_size: 1513
batch 39, loss: 0.0574, instance_loss: 0.3240, weighted_loss: 0.1374, label: 1, bag_size: 5026
batch 59, loss: 0.0417, instance_loss: 0.0755, weighted_loss: 0.0519, label: 2, bag_size: 3415
batch 79, loss: 0.0352, instance_loss: 0.4255, weighted_loss: 0.1523, label: 1, bag_size: 779
batch 99, loss: 0.7374, instance_loss: 0.5675, weighted_loss: 0.6864, label: 2, bag_size: 5637
batch 119, loss: 0.7838, instance_loss: 0.6518, weighted_loss: 0.7442, label: 0, bag_size: 7315
batch 139, loss: 0.0232, instance_loss: 0.2014, weighted_loss: 0.0767, label: 0, bag_size: 1485
batch 159, loss: 2.4880, instance_loss: 1.4435, weighted_loss: 2.1747, label: 1, bag_size: 3261
batch 179, loss: 0.0807, instance_loss: 0.2425, weighted_loss: 0.1292, label: 0, bag_size: 7177
batch 199, loss: 0.0261, instance_loss: 0.0587, weighted_loss: 0.0359, label: 2, bag_size: 6148
batch 219, loss: 0.9105, instance_loss: 1.2465, weighted_loss: 1.0113, label: 1, bag_size: 3619
batch 239, loss: 0.9832, instance_loss: 0.6475, weighted_loss: 0.8825, label: 0, bag_size: 8611
batch 259, loss: 0.2884, instance_loss: 0.5094, weighted_loss: 0.3547, label: 1, bag_size: 14449
batch 279, loss: 0.7052, instance_loss: 0.5467, weighted_loss: 0.6577, label: 1, bag_size: 1500
batch 299, loss: 0.0610, instance_loss: 0.1939, weighted_loss: 0.1009, label: 0, bag_size: 3924
batch 319, loss: 0.1545, instance_loss: 0.2547, weighted_loss: 0.1845, label: 1, bag_size: 800
batch 339, loss: 0.7957, instance_loss: 0.7209, weighted_loss: 0.7733, label: 0, bag_size: 1170
batch 359, loss: 0.1992, instance_loss: 0.4098, weighted_loss: 0.2624, label: 1, bag_size: 1197
batch 379, loss: 1.0124, instance_loss: 0.4249, weighted_loss: 0.8362, label: 1, bag_size: 3225
batch 399, loss: 1.4347, instance_loss: 0.6274, weighted_loss: 1.1925, label: 1, bag_size: 832
batch 419, loss: 0.2604, instance_loss: 0.5466, weighted_loss: 0.3463, label: 2, bag_size: 3618
batch 439, loss: 0.0054, instance_loss: 0.8812, weighted_loss: 0.2681, label: 1, bag_size: 5086
batch 459, loss: 0.0154, instance_loss: 0.1258, weighted_loss: 0.0485, label: 1, bag_size: 3493
batch 479, loss: 0.0885, instance_loss: 0.4215, weighted_loss: 0.1884, label: 1, bag_size: 5718
batch 499, loss: 0.0834, instance_loss: 0.3865, weighted_loss: 0.1743, label: 1, bag_size: 3050
batch 519, loss: 0.0996, instance_loss: 0.2501, weighted_loss: 0.1447, label: 0, bag_size: 1385
batch 539, loss: 1.4837, instance_loss: 1.2191, weighted_loss: 1.4043, label: 2, bag_size: 4179
batch 559, loss: 0.0086, instance_loss: 0.0774, weighted_loss: 0.0293, label: 0, bag_size: 1132
batch 579, loss: 0.2637, instance_loss: 0.6351, weighted_loss: 0.3751, label: 1, bag_size: 3398
batch 599, loss: 0.0170, instance_loss: 0.0695, weighted_loss: 0.0328, label: 2, bag_size: 6148
batch 619, loss: 0.0028, instance_loss: 1.1055, weighted_loss: 0.3336, label: 0, bag_size: 2028
batch 639, loss: 0.9272, instance_loss: 1.0685, weighted_loss: 0.9696, label: 2, bag_size: 4179
batch 659, loss: 0.0384, instance_loss: 0.1728, weighted_loss: 0.0787, label: 0, bag_size: 3443
batch 679, loss: 1.1622, instance_loss: 0.9098, weighted_loss: 1.0865, label: 1, bag_size: 817
batch 699, loss: 0.0413, instance_loss: 0.2999, weighted_loss: 0.1189, label: 1, bag_size: 3051
batch 719, loss: 0.9093, instance_loss: 0.8529, weighted_loss: 0.8924, label: 2, bag_size: 3604
batch 739, loss: 0.1153, instance_loss: 0.3388, weighted_loss: 0.1823, label: 0, bag_size: 3864


class 0 clustering acc 0.9714765100671141: correct 17370/17880
class 1 clustering acc 0.4406040268456376: correct 2626/5960
Epoch: 45, train_loss: 0.4431, train_clustering_loss:  0.4835, train_error: 0.1852
class 0: acc 0.8615384615384616, correct 224/260
class 1: acc 0.7258687258687259, correct 188/259
class 2: acc 0.8628318584070797, correct 195/226

Val Set, val_loss: 0.5928, val_error: 0.2234, auc: 0.9058
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.4002659574468085: correct 301/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8004, instance_loss: 0.8030, weighted_loss: 0.8012, label: 2, bag_size: 552
batch 39, loss: 0.1829, instance_loss: 0.2731, weighted_loss: 0.2099, label: 0, bag_size: 5368
batch 59, loss: 0.0859, instance_loss: 0.0857, weighted_loss: 0.0858, label: 0, bag_size: 6863
batch 79, loss: 0.0043, instance_loss: 0.0339, weighted_loss: 0.0132, label: 2, bag_size: 2483
batch 99, loss: 0.0530, instance_loss: 0.1696, weighted_loss: 0.0880, label: 2, bag_size: 3327
batch 119, loss: 0.1848, instance_loss: 0.4442, weighted_loss: 0.2626, label: 2, bag_size: 3604
batch 139, loss: 1.2536, instance_loss: 0.6183, weighted_loss: 1.0630, label: 2, bag_size: 2031
batch 159, loss: 1.3224, instance_loss: 0.8461, weighted_loss: 1.1795, label: 1, bag_size: 817
batch 179, loss: 0.0595, instance_loss: 0.1443, weighted_loss: 0.0849, label: 2, bag_size: 6148
batch 199, loss: 0.2045, instance_loss: 0.2213, weighted_loss: 0.2095, label: 0, bag_size: 3789
batch 219, loss: 0.2665, instance_loss: 0.5843, weighted_loss: 0.3618, label: 2, bag_size: 4569
batch 239, loss: 0.2401, instance_loss: 0.3523, weighted_loss: 0.2738, label: 0, bag_size: 4584
batch 259, loss: 0.0750, instance_loss: 0.4078, weighted_loss: 0.1748, label: 1, bag_size: 3398
batch 279, loss: 0.2445, instance_loss: 0.7395, weighted_loss: 0.3930, label: 1, bag_size: 2248
batch 299, loss: 0.2742, instance_loss: 0.3831, weighted_loss: 0.3068, label: 2, bag_size: 4096
batch 319, loss: 2.5477, instance_loss: 0.1962, weighted_loss: 1.8423, label: 0, bag_size: 5125
batch 339, loss: 0.8432, instance_loss: 0.3222, weighted_loss: 0.6869, label: 0, bag_size: 4647
batch 359, loss: 0.1689, instance_loss: 0.5298, weighted_loss: 0.2772, label: 1, bag_size: 1394
batch 379, loss: 0.1263, instance_loss: 0.3880, weighted_loss: 0.2048, label: 1, bag_size: 1807
batch 399, loss: 0.3474, instance_loss: 0.8183, weighted_loss: 0.4887, label: 2, bag_size: 728
batch 419, loss: 0.1395, instance_loss: 0.4095, weighted_loss: 0.2205, label: 2, bag_size: 3227
batch 439, loss: 1.1333, instance_loss: 0.7733, weighted_loss: 1.0253, label: 0, bag_size: 11663
batch 459, loss: 0.4300, instance_loss: 0.4954, weighted_loss: 0.4496, label: 2, bag_size: 4162
batch 479, loss: 0.0657, instance_loss: 0.0561, weighted_loss: 0.0628, label: 2, bag_size: 1094
batch 499, loss: 0.0017, instance_loss: 1.5543, weighted_loss: 0.4675, label: 0, bag_size: 1910
batch 519, loss: 0.4993, instance_loss: 0.6518, weighted_loss: 0.5450, label: 1, bag_size: 5276
batch 539, loss: 0.0021, instance_loss: 0.5374, weighted_loss: 0.1627, label: 1, bag_size: 3172
batch 559, loss: 0.0154, instance_loss: 0.0313, weighted_loss: 0.0202, label: 2, bag_size: 2313
batch 579, loss: 1.1249, instance_loss: 0.9627, weighted_loss: 1.0762, label: 1, bag_size: 4184
batch 599, loss: 0.0254, instance_loss: 0.3004, weighted_loss: 0.1079, label: 2, bag_size: 3810
batch 619, loss: 0.4166, instance_loss: 1.1307, weighted_loss: 0.6309, label: 1, bag_size: 3437
batch 639, loss: 2.0631, instance_loss: 0.9171, weighted_loss: 1.7193, label: 1, bag_size: 5880
batch 659, loss: 0.0550, instance_loss: 0.2573, weighted_loss: 0.1157, label: 1, bag_size: 2796
batch 679, loss: 0.6573, instance_loss: 0.7492, weighted_loss: 0.6848, label: 1, bag_size: 2747
batch 699, loss: 3.5966, instance_loss: 1.6553, weighted_loss: 3.0142, label: 0, bag_size: 1774
batch 719, loss: 0.1736, instance_loss: 0.3619, weighted_loss: 0.2301, label: 2, bag_size: 2481
batch 739, loss: 0.1354, instance_loss: 0.4223, weighted_loss: 0.2214, label: 0, bag_size: 4347


class 0 clustering acc 0.969407158836689: correct 17333/17880
class 1 clustering acc 0.4033557046979866: correct 2404/5960
Epoch: 46, train_loss: 0.4914, train_clustering_loss:  0.5126, train_error: 0.1987
class 0: acc 0.819672131147541, correct 200/244
class 1: acc 0.708502024291498, correct 175/247
class 2: acc 0.8740157480314961, correct 222/254

Val Set, val_loss: 0.6083, val_error: 0.2340, auc: 0.9035
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.3191489361702128: correct 240/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0500, instance_loss: 0.2647, weighted_loss: 0.1144, label: 2, bag_size: 4140
batch 39, loss: 0.0296, instance_loss: 0.1296, weighted_loss: 0.0596, label: 0, bag_size: 3103
batch 59, loss: 0.1705, instance_loss: 0.3808, weighted_loss: 0.2336, label: 0, bag_size: 4734
batch 79, loss: 1.0958, instance_loss: 0.6739, weighted_loss: 0.9692, label: 0, bag_size: 3075
batch 99, loss: 0.0192, instance_loss: 0.1745, weighted_loss: 0.0658, label: 0, bag_size: 5570
batch 119, loss: 0.3632, instance_loss: 0.6652, weighted_loss: 0.4538, label: 1, bag_size: 440
batch 139, loss: 0.0246, instance_loss: 0.1422, weighted_loss: 0.0599, label: 0, bag_size: 5782
batch 159, loss: 0.0357, instance_loss: 0.2579, weighted_loss: 0.1024, label: 0, bag_size: 5646
batch 179, loss: 0.4390, instance_loss: 0.6081, weighted_loss: 0.4897, label: 0, bag_size: 1695
batch 199, loss: 0.5997, instance_loss: 0.7929, weighted_loss: 0.6576, label: 2, bag_size: 5924
batch 219, loss: 0.8341, instance_loss: 0.7466, weighted_loss: 0.8078, label: 2, bag_size: 4571
batch 239, loss: 0.2650, instance_loss: 0.4017, weighted_loss: 0.3060, label: 0, bag_size: 2094
batch 259, loss: 0.5182, instance_loss: 0.4518, weighted_loss: 0.4983, label: 2, bag_size: 88
batch 279, loss: 0.6102, instance_loss: 0.6638, weighted_loss: 0.6263, label: 0, bag_size: 2153
batch 299, loss: 1.1453, instance_loss: 0.9961, weighted_loss: 1.1005, label: 1, bag_size: 6243
batch 319, loss: 0.0520, instance_loss: 0.4108, weighted_loss: 0.1597, label: 1, bag_size: 4027
batch 339, loss: 0.3624, instance_loss: 0.4489, weighted_loss: 0.3884, label: 2, bag_size: 6298
batch 359, loss: 0.8940, instance_loss: 0.6794, weighted_loss: 0.8296, label: 1, bag_size: 1607
batch 379, loss: 0.0513, instance_loss: 0.4096, weighted_loss: 0.1588, label: 1, bag_size: 2731
batch 399, loss: 0.1270, instance_loss: 0.3819, weighted_loss: 0.2035, label: 1, bag_size: 4184
batch 419, loss: 0.1855, instance_loss: 0.8340, weighted_loss: 0.3801, label: 0, bag_size: 4808
batch 439, loss: 0.1134, instance_loss: 0.3522, weighted_loss: 0.1850, label: 0, bag_size: 2286
batch 459, loss: 0.0771, instance_loss: 0.1135, weighted_loss: 0.0880, label: 2, bag_size: 1094
batch 479, loss: 1.5903, instance_loss: 1.2134, weighted_loss: 1.4773, label: 1, bag_size: 936
batch 499, loss: 0.2022, instance_loss: 0.1283, weighted_loss: 0.1801, label: 0, bag_size: 5125
batch 519, loss: 0.1351, instance_loss: 0.4727, weighted_loss: 0.2364, label: 1, bag_size: 3050
batch 539, loss: 0.4086, instance_loss: 0.5083, weighted_loss: 0.4385, label: 1, bag_size: 2642
batch 559, loss: 0.6165, instance_loss: 0.5720, weighted_loss: 0.6032, label: 1, bag_size: 1712
batch 579, loss: 0.0017, instance_loss: 0.2188, weighted_loss: 0.0668, label: 0, bag_size: 4403
batch 599, loss: 0.5384, instance_loss: 0.4917, weighted_loss: 0.5244, label: 2, bag_size: 4241
batch 619, loss: 0.2203, instance_loss: 0.4010, weighted_loss: 0.2745, label: 1, bag_size: 4119
batch 639, loss: 0.0230, instance_loss: 0.1411, weighted_loss: 0.0584, label: 2, bag_size: 3810
batch 659, loss: 0.3926, instance_loss: 0.7108, weighted_loss: 0.4880, label: 0, bag_size: 4479
batch 679, loss: 0.1155, instance_loss: 0.2842, weighted_loss: 0.1661, label: 2, bag_size: 3210
batch 699, loss: 0.0234, instance_loss: 0.1327, weighted_loss: 0.0562, label: 0, bag_size: 4865
batch 719, loss: 1.9885, instance_loss: 0.8476, weighted_loss: 1.6463, label: 1, bag_size: 5880
batch 739, loss: 0.3481, instance_loss: 0.4939, weighted_loss: 0.3918, label: 2, bag_size: 3396


class 0 clustering acc 0.9710290827740492: correct 17362/17880
class 1 clustering acc 0.4008389261744966: correct 2389/5960
Epoch: 47, train_loss: 0.5227, train_clustering_loss:  0.5165, train_error: 0.2107
class 0: acc 0.8134328358208955, correct 218/268
class 1: acc 0.6875, correct 165/240
class 2: acc 0.8649789029535865, correct 205/237

Val Set, val_loss: 0.5944, val_error: 0.1915, auc: 0.9020
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.36436170212765956: correct 274/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3273, instance_loss: 0.5765, weighted_loss: 0.4021, label: 2, bag_size: 4535
batch 39, loss: 0.3356, instance_loss: 0.6064, weighted_loss: 0.4168, label: 1, bag_size: 1221
batch 59, loss: 0.4100, instance_loss: 0.9612, weighted_loss: 0.5753, label: 1, bag_size: 2905
batch 79, loss: 1.0706, instance_loss: 0.7573, weighted_loss: 0.9766, label: 1, bag_size: 2751
batch 99, loss: 0.4629, instance_loss: 0.6023, weighted_loss: 0.5047, label: 0, bag_size: 2153
batch 119, loss: 0.9190, instance_loss: 0.5800, weighted_loss: 0.8173, label: 0, bag_size: 893
batch 139, loss: 0.0171, instance_loss: 0.0963, weighted_loss: 0.0408, label: 0, bag_size: 5337
batch 159, loss: 0.0629, instance_loss: 0.3390, weighted_loss: 0.1457, label: 0, bag_size: 4678
batch 179, loss: 0.1686, instance_loss: 0.3958, weighted_loss: 0.2367, label: 2, bag_size: 3227
batch 199, loss: 0.0670, instance_loss: 0.2182, weighted_loss: 0.1123, label: 2, bag_size: 4056
batch 219, loss: 0.0313, instance_loss: 0.1559, weighted_loss: 0.0687, label: 0, bag_size: 4325
batch 239, loss: 0.0964, instance_loss: 0.1038, weighted_loss: 0.0986, label: 0, bag_size: 1373
batch 259, loss: 0.0830, instance_loss: 0.3477, weighted_loss: 0.1624, label: 2, bag_size: 5914
batch 279, loss: 0.1431, instance_loss: 0.2924, weighted_loss: 0.1879, label: 2, bag_size: 3112
batch 299, loss: 0.4674, instance_loss: 0.7504, weighted_loss: 0.5523, label: 1, bag_size: 4940
batch 319, loss: 0.2130, instance_loss: 0.5555, weighted_loss: 0.3158, label: 1, bag_size: 3558
batch 339, loss: 0.0201, instance_loss: 0.1748, weighted_loss: 0.0665, label: 0, bag_size: 2897
batch 359, loss: 0.1432, instance_loss: 0.4646, weighted_loss: 0.2396, label: 0, bag_size: 4147
batch 379, loss: 0.3373, instance_loss: 0.3809, weighted_loss: 0.3503, label: 0, bag_size: 2257
batch 399, loss: 0.9968, instance_loss: 0.7797, weighted_loss: 0.9316, label: 1, bag_size: 869
batch 419, loss: 0.0724, instance_loss: 0.2981, weighted_loss: 0.1401, label: 0, bag_size: 3339
batch 439, loss: 0.6500, instance_loss: 0.7528, weighted_loss: 0.6808, label: 0, bag_size: 1755
batch 459, loss: 0.0980, instance_loss: 0.1356, weighted_loss: 0.1093, label: 0, bag_size: 4797
batch 479, loss: 0.1037, instance_loss: 0.3499, weighted_loss: 0.1775, label: 2, bag_size: 3607
batch 499, loss: 2.3594, instance_loss: 0.6451, weighted_loss: 1.8451, label: 2, bag_size: 2770
batch 519, loss: 1.3203, instance_loss: 0.9243, weighted_loss: 1.2015, label: 2, bag_size: 3475
batch 539, loss: 0.5749, instance_loss: 0.5870, weighted_loss: 0.5785, label: 1, bag_size: 4438
batch 559, loss: 1.1267, instance_loss: 0.6386, weighted_loss: 0.9803, label: 1, bag_size: 5402
batch 579, loss: 0.0883, instance_loss: 0.1698, weighted_loss: 0.1128, label: 2, bag_size: 5924
batch 599, loss: 1.0181, instance_loss: 0.5875, weighted_loss: 0.8889, label: 2, bag_size: 5406
batch 619, loss: 0.5544, instance_loss: 0.7295, weighted_loss: 0.6069, label: 1, bag_size: 2945
batch 639, loss: 0.2460, instance_loss: 0.3429, weighted_loss: 0.2751, label: 2, bag_size: 3396
batch 659, loss: 1.6780, instance_loss: 0.9154, weighted_loss: 1.4492, label: 1, bag_size: 1313
batch 679, loss: 0.3197, instance_loss: 0.3801, weighted_loss: 0.3378, label: 1, bag_size: 800
batch 699, loss: 0.1773, instance_loss: 0.2877, weighted_loss: 0.2104, label: 1, bag_size: 800
batch 719, loss: 0.5597, instance_loss: 0.6421, weighted_loss: 0.5845, label: 2, bag_size: 3778
batch 739, loss: 1.0805, instance_loss: 0.7549, weighted_loss: 0.9828, label: 1, bag_size: 32


class 0 clustering acc 0.9705257270693513: correct 17353/17880
class 1 clustering acc 0.3447986577181208: correct 2055/5960
Epoch: 48, train_loss: 0.5971, train_clustering_loss:  0.5535, train_error: 0.2389
class 0: acc 0.8, correct 208/260
class 1: acc 0.6571428571428571, correct 161/245
class 2: acc 0.825, correct 198/240

Val Set, val_loss: 0.9077, val_error: 0.3723, auc: 0.8779
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.2154255319148936: correct 162/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3919, instance_loss: 0.6038, weighted_loss: 0.4555, label: 2, bag_size: 4535
batch 39, loss: 1.6748, instance_loss: 0.9239, weighted_loss: 1.4495, label: 0, bag_size: 14432
batch 59, loss: 0.3153, instance_loss: 0.7667, weighted_loss: 0.4507, label: 2, bag_size: 223
batch 79, loss: 0.4323, instance_loss: 0.5971, weighted_loss: 0.4818, label: 2, bag_size: 5426
batch 99, loss: 0.2017, instance_loss: 0.1775, weighted_loss: 0.1944, label: 2, bag_size: 3678
batch 119, loss: 0.0420, instance_loss: 0.5150, weighted_loss: 0.1839, label: 1, bag_size: 455
batch 139, loss: 0.1382, instance_loss: 0.7406, weighted_loss: 0.3189, label: 1, bag_size: 3558
batch 159, loss: 0.6150, instance_loss: 0.7697, weighted_loss: 0.6614, label: 0, bag_size: 5330
batch 179, loss: 0.8354, instance_loss: 0.5658, weighted_loss: 0.7545, label: 1, bag_size: 209
batch 199, loss: 0.0629, instance_loss: 0.2135, weighted_loss: 0.1081, label: 2, bag_size: 2483
batch 219, loss: 0.5384, instance_loss: 0.4683, weighted_loss: 0.5174, label: 1, bag_size: 11768
batch 239, loss: 0.1043, instance_loss: 0.3135, weighted_loss: 0.1670, label: 2, bag_size: 5017
batch 259, loss: 0.1031, instance_loss: 0.2426, weighted_loss: 0.1449, label: 0, bag_size: 2094
batch 279, loss: 0.0490, instance_loss: 0.2273, weighted_loss: 0.1025, label: 0, bag_size: 1174
batch 299, loss: 0.1071, instance_loss: 0.1855, weighted_loss: 0.1306, label: 2, bag_size: 3327
batch 319, loss: 0.1747, instance_loss: 0.4082, weighted_loss: 0.2447, label: 2, bag_size: 3746
batch 339, loss: 0.2897, instance_loss: 0.6355, weighted_loss: 0.3934, label: 1, bag_size: 5072
batch 359, loss: 0.6298, instance_loss: 0.8092, weighted_loss: 0.6836, label: 0, bag_size: 3701
batch 379, loss: 3.2887, instance_loss: 1.9428, weighted_loss: 2.8849, label: 1, bag_size: 1549
batch 399, loss: 0.0989, instance_loss: 0.4223, weighted_loss: 0.1959, label: 2, bag_size: 5011
batch 419, loss: 0.3893, instance_loss: 0.6132, weighted_loss: 0.4565, label: 2, bag_size: 5307
batch 439, loss: 0.1110, instance_loss: 0.5768, weighted_loss: 0.2508, label: 1, bag_size: 683
batch 459, loss: 0.1812, instance_loss: 0.4174, weighted_loss: 0.2521, label: 1, bag_size: 1197
batch 479, loss: 0.0099, instance_loss: 0.0506, weighted_loss: 0.0221, label: 2, bag_size: 657
batch 499, loss: 0.0819, instance_loss: 0.2725, weighted_loss: 0.1391, label: 0, bag_size: 1018
batch 519, loss: 0.0591, instance_loss: 0.2263, weighted_loss: 0.1093, label: 2, bag_size: 3210
batch 539, loss: 0.7228, instance_loss: 0.4934, weighted_loss: 0.6540, label: 1, bag_size: 6993
batch 559, loss: 0.7460, instance_loss: 0.7677, weighted_loss: 0.7525, label: 1, bag_size: 4200
batch 579, loss: 1.0814, instance_loss: 1.1815, weighted_loss: 1.1114, label: 2, bag_size: 724
batch 599, loss: 0.5276, instance_loss: 0.7177, weighted_loss: 0.5846, label: 0, bag_size: 4337
batch 619, loss: 0.0052, instance_loss: 0.0407, weighted_loss: 0.0159, label: 2, bag_size: 4856
batch 639, loss: 0.2257, instance_loss: 0.6847, weighted_loss: 0.3634, label: 0, bag_size: 5519
batch 659, loss: 1.1742, instance_loss: 0.6998, weighted_loss: 1.0319, label: 1, bag_size: 2751
batch 679, loss: 0.1123, instance_loss: 0.2346, weighted_loss: 0.1490, label: 0, bag_size: 5992
batch 699, loss: 0.1412, instance_loss: 0.3833, weighted_loss: 0.2138, label: 2, bag_size: 2481
batch 719, loss: 0.3310, instance_loss: 0.6901, weighted_loss: 0.4387, label: 2, bag_size: 2486
batch 739, loss: 0.0215, instance_loss: 0.1250, weighted_loss: 0.0526, label: 0, bag_size: 5782


class 0 clustering acc 0.9679530201342282: correct 17307/17880
class 1 clustering acc 0.37718120805369126: correct 2248/5960
Epoch: 49, train_loss: 0.5139, train_clustering_loss:  0.5373, train_error: 0.2188
class 0: acc 0.7741935483870968, correct 192/248
class 1: acc 0.7269230769230769, correct 189/260
class 2: acc 0.8481012658227848, correct 201/237

Val Set, val_loss: 0.5919, val_error: 0.2553, auc: 0.9021
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.4348404255319149: correct 327/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0446, instance_loss: 0.3571, weighted_loss: 0.1383, label: 2, bag_size: 3810
batch 39, loss: 2.7434, instance_loss: 0.9242, weighted_loss: 2.1976, label: 0, bag_size: 4145
batch 59, loss: 0.1802, instance_loss: 0.3226, weighted_loss: 0.2229, label: 0, bag_size: 5413
batch 79, loss: 0.0068, instance_loss: 0.1041, weighted_loss: 0.0360, label: 0, bag_size: 5500
batch 99, loss: 0.2229, instance_loss: 0.4623, weighted_loss: 0.2947, label: 2, bag_size: 4535
batch 119, loss: 0.0280, instance_loss: 0.1273, weighted_loss: 0.0578, label: 0, bag_size: 4229
batch 139, loss: 0.1770, instance_loss: 0.3477, weighted_loss: 0.2282, label: 2, bag_size: 4140
batch 159, loss: 0.5437, instance_loss: 1.0673, weighted_loss: 0.7007, label: 2, bag_size: 5426
batch 179, loss: 0.0390, instance_loss: 0.1591, weighted_loss: 0.0750, label: 0, bag_size: 2545
batch 199, loss: 1.2160, instance_loss: 1.2393, weighted_loss: 1.2230, label: 1, bag_size: 2229
batch 219, loss: 0.4734, instance_loss: 0.4235, weighted_loss: 0.4585, label: 2, bag_size: 2561
batch 239, loss: 0.4417, instance_loss: 0.5616, weighted_loss: 0.4776, label: 2, bag_size: 3174
batch 259, loss: 0.7703, instance_loss: 0.5408, weighted_loss: 0.7015, label: 0, bag_size: 4707
batch 279, loss: 1.6782, instance_loss: 0.5500, weighted_loss: 1.3398, label: 0, bag_size: 3387
batch 299, loss: 0.1491, instance_loss: 0.6107, weighted_loss: 0.2876, label: 1, bag_size: 440
batch 319, loss: 0.6805, instance_loss: 0.6706, weighted_loss: 0.6775, label: 1, bag_size: 5512
batch 339, loss: 0.0000, instance_loss: 0.8764, weighted_loss: 0.2629, label: 0, bag_size: 1814
batch 359, loss: 0.3345, instance_loss: 0.4808, weighted_loss: 0.3784, label: 0, bag_size: 4905
batch 379, loss: 0.3209, instance_loss: 0.5721, weighted_loss: 0.3963, label: 2, bag_size: 5307
batch 399, loss: 0.4170, instance_loss: 0.5641, weighted_loss: 0.4611, label: 2, bag_size: 4535
batch 419, loss: 0.8597, instance_loss: 0.3833, weighted_loss: 0.7167, label: 2, bag_size: 4788
batch 439, loss: 1.0338, instance_loss: 0.8222, weighted_loss: 0.9703, label: 1, bag_size: 1580
batch 459, loss: 0.3937, instance_loss: 0.5766, weighted_loss: 0.4486, label: 1, bag_size: 3640
batch 479, loss: 0.0641, instance_loss: 0.1601, weighted_loss: 0.0929, label: 2, bag_size: 3415
batch 499, loss: 0.4654, instance_loss: 0.5465, weighted_loss: 0.4898, label: 2, bag_size: 3274
batch 519, loss: 0.6991, instance_loss: 0.6097, weighted_loss: 0.6723, label: 2, bag_size: 3112
batch 539, loss: 0.0011, instance_loss: 1.8870, weighted_loss: 0.5669, label: 0, bag_size: 2231
batch 559, loss: 0.0932, instance_loss: 0.2612, weighted_loss: 0.1436, label: 0, bag_size: 6440
batch 579, loss: 1.4651, instance_loss: 0.8118, weighted_loss: 1.2691, label: 1, bag_size: 4145
batch 599, loss: 0.0323, instance_loss: 0.1716, weighted_loss: 0.0741, label: 0, bag_size: 667
batch 619, loss: 1.8128, instance_loss: 0.9492, weighted_loss: 1.5537, label: 1, bag_size: 1595
batch 639, loss: 0.7522, instance_loss: 0.7394, weighted_loss: 0.7484, label: 1, bag_size: 5167
batch 659, loss: 0.0701, instance_loss: 0.2004, weighted_loss: 0.1091, label: 0, bag_size: 6015
batch 679, loss: 0.3693, instance_loss: 0.3070, weighted_loss: 0.3506, label: 1, bag_size: 19265
batch 699, loss: 0.6513, instance_loss: 0.6607, weighted_loss: 0.6541, label: 1, bag_size: 4705
batch 719, loss: 1.3321, instance_loss: 0.9292, weighted_loss: 1.2112, label: 0, bag_size: 436
batch 739, loss: 0.0007, instance_loss: 0.1035, weighted_loss: 0.0316, label: 1, bag_size: 3983


class 0 clustering acc 0.9662192393736018: correct 17276/17880
class 1 clustering acc 0.34446308724832214: correct 2053/5960
Epoch: 50, train_loss: 0.5352, train_clustering_loss:  0.5454, train_error: 0.2282
class 0: acc 0.7792207792207793, correct 180/231
class 1: acc 0.7194244604316546, correct 200/278
class 2: acc 0.826271186440678, correct 195/236

Val Set, val_loss: 0.6399, val_error: 0.2553, auc: 0.8951
class 0 clustering acc 0.975177304964539: correct 2200/2256
class 1 clustering acc 0.3404255319148936: correct 256/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0605, instance_loss: 0.2706, weighted_loss: 0.1235, label: 1, bag_size: 3050
batch 39, loss: 0.0834, instance_loss: 0.2299, weighted_loss: 0.1274, label: 0, bag_size: 6971
batch 59, loss: 0.4167, instance_loss: 0.6138, weighted_loss: 0.4759, label: 2, bag_size: 6644
batch 79, loss: 1.1349, instance_loss: 0.9070, weighted_loss: 1.0666, label: 1, bag_size: 1122
batch 99, loss: 0.1076, instance_loss: 0.4295, weighted_loss: 0.2042, label: 1, bag_size: 5385
batch 119, loss: 0.0147, instance_loss: 0.5182, weighted_loss: 0.1657, label: 1, bag_size: 4134
batch 139, loss: 0.0228, instance_loss: 0.1726, weighted_loss: 0.0677, label: 0, bag_size: 4344
batch 159, loss: 0.5196, instance_loss: 0.8319, weighted_loss: 0.6133, label: 1, bag_size: 2905
batch 179, loss: 0.9960, instance_loss: 0.5151, weighted_loss: 0.8518, label: 0, bag_size: 1373
batch 199, loss: 0.1663, instance_loss: 0.4622, weighted_loss: 0.2551, label: 0, bag_size: 4300
batch 219, loss: 0.2558, instance_loss: 0.3494, weighted_loss: 0.2839, label: 0, bag_size: 2671
batch 239, loss: 0.2997, instance_loss: 0.4544, weighted_loss: 0.3461, label: 2, bag_size: 4241
batch 259, loss: 1.6887, instance_loss: 0.6314, weighted_loss: 1.3715, label: 0, bag_size: 7219
batch 279, loss: 0.0828, instance_loss: 0.2024, weighted_loss: 0.1187, label: 2, bag_size: 657
batch 299, loss: 0.0130, instance_loss: 0.1688, weighted_loss: 0.0597, label: 1, bag_size: 3471
batch 319, loss: 0.0081, instance_loss: 0.0523, weighted_loss: 0.0213, label: 2, bag_size: 6148
batch 339, loss: 2.3805, instance_loss: 1.1341, weighted_loss: 2.0066, label: 0, bag_size: 1365
batch 359, loss: 0.0267, instance_loss: 0.2574, weighted_loss: 0.0959, label: 1, bag_size: 582
batch 379, loss: 0.0388, instance_loss: 0.1279, weighted_loss: 0.0655, label: 2, bag_size: 2905
batch 399, loss: 0.3223, instance_loss: 0.4192, weighted_loss: 0.3514, label: 1, bag_size: 1906
batch 419, loss: 0.0508, instance_loss: 0.2062, weighted_loss: 0.0974, label: 2, bag_size: 5924
batch 439, loss: 0.0434, instance_loss: 0.1243, weighted_loss: 0.0677, label: 0, bag_size: 6863
batch 459, loss: 0.1780, instance_loss: 0.1964, weighted_loss: 0.1835, label: 2, bag_size: 2501
batch 479, loss: 0.2914, instance_loss: 0.7541, weighted_loss: 0.4302, label: 1, bag_size: 5118
batch 499, loss: 0.0449, instance_loss: 0.0941, weighted_loss: 0.0597, label: 0, bag_size: 4292
batch 519, loss: 0.1050, instance_loss: 0.4951, weighted_loss: 0.2220, label: 1, bag_size: 1023
batch 539, loss: 0.0222, instance_loss: 0.0957, weighted_loss: 0.0443, label: 0, bag_size: 2487
batch 559, loss: 0.4668, instance_loss: 0.4141, weighted_loss: 0.4510, label: 0, bag_size: 5125
batch 579, loss: 1.3631, instance_loss: 0.9770, weighted_loss: 1.2473, label: 1, bag_size: 1558
batch 599, loss: 0.7077, instance_loss: 0.5484, weighted_loss: 0.6599, label: 0, bag_size: 3701
batch 619, loss: 0.0147, instance_loss: 0.0512, weighted_loss: 0.0256, label: 0, bag_size: 3443
batch 639, loss: 0.0603, instance_loss: 0.3382, weighted_loss: 0.1437, label: 2, bag_size: 4372
batch 659, loss: 0.7265, instance_loss: 1.0477, weighted_loss: 0.8229, label: 1, bag_size: 6689
batch 679, loss: 0.0382, instance_loss: 0.0978, weighted_loss: 0.0561, label: 2, bag_size: 2997
batch 699, loss: 0.0447, instance_loss: 0.1753, weighted_loss: 0.0839, label: 0, bag_size: 5526
batch 719, loss: 0.1530, instance_loss: 0.1751, weighted_loss: 0.1596, label: 2, bag_size: 597
batch 739, loss: 1.2337, instance_loss: 0.8222, weighted_loss: 1.1102, label: 1, bag_size: 3106


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.3959731543624161: correct 2360/5960
Epoch: 51, train_loss: 0.5061, train_clustering_loss:  0.5156, train_error: 0.2067
class 0: acc 0.7976653696498055, correct 205/257
class 1: acc 0.6887966804979253, correct 166/241
class 2: acc 0.8906882591093117, correct 220/247

Val Set, val_loss: 0.5798, val_error: 0.2447, auc: 0.8985
class 0 clustering acc 0.9499113475177305: correct 2143/2256
class 1 clustering acc 0.46941489361702127: correct 353/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.7126, instance_loss: 0.7049, weighted_loss: 0.7103, label: 1, bag_size: 4940
batch 39, loss: 0.2796, instance_loss: 0.3929, weighted_loss: 0.3136, label: 1, bag_size: 4373
batch 59, loss: 0.0517, instance_loss: 0.2267, weighted_loss: 0.1042, label: 2, bag_size: 2561
batch 79, loss: 0.8513, instance_loss: 0.6674, weighted_loss: 0.7962, label: 0, bag_size: 2428
batch 99, loss: 2.8585, instance_loss: 1.2118, weighted_loss: 2.3645, label: 2, bag_size: 3475
batch 119, loss: 0.1196, instance_loss: 0.4433, weighted_loss: 0.2167, label: 0, bag_size: 1904
batch 139, loss: 0.1657, instance_loss: 0.3333, weighted_loss: 0.2160, label: 2, bag_size: 4132
batch 159, loss: 0.0623, instance_loss: 0.2037, weighted_loss: 0.1048, label: 2, bag_size: 5138
batch 179, loss: 1.0677, instance_loss: 0.8915, weighted_loss: 1.0148, label: 0, bag_size: 2195
batch 199, loss: 0.3266, instance_loss: 0.5014, weighted_loss: 0.3791, label: 2, bag_size: 5037
batch 219, loss: 0.3085, instance_loss: 0.4899, weighted_loss: 0.3629, label: 2, bag_size: 3778
batch 239, loss: 0.4975, instance_loss: 0.5432, weighted_loss: 0.5112, label: 2, bag_size: 3210
batch 259, loss: 0.4556, instance_loss: 0.6592, weighted_loss: 0.5167, label: 2, bag_size: 4140
batch 279, loss: 0.0166, instance_loss: 0.1765, weighted_loss: 0.0645, label: 2, bag_size: 2209
batch 299, loss: 0.0311, instance_loss: 0.3538, weighted_loss: 0.1279, label: 0, bag_size: 2306
batch 319, loss: 0.0190, instance_loss: 0.0751, weighted_loss: 0.0359, label: 2, bag_size: 3497
batch 339, loss: 0.6922, instance_loss: 0.6433, weighted_loss: 0.6775, label: 0, bag_size: 3709
batch 359, loss: 0.5856, instance_loss: 0.4775, weighted_loss: 0.5532, label: 2, bag_size: 5406
batch 379, loss: 0.9409, instance_loss: 0.7272, weighted_loss: 0.8768, label: 2, bag_size: 552
batch 399, loss: 0.0237, instance_loss: 0.1530, weighted_loss: 0.0625, label: 0, bag_size: 4831
batch 419, loss: 0.0174, instance_loss: 0.0472, weighted_loss: 0.0263, label: 2, bag_size: 3415
batch 439, loss: 0.0183, instance_loss: 0.0514, weighted_loss: 0.0282, label: 2, bag_size: 2209
batch 459, loss: 0.0180, instance_loss: 0.1367, weighted_loss: 0.0536, label: 0, bag_size: 471
batch 479, loss: 0.6386, instance_loss: 0.5071, weighted_loss: 0.5991, label: 0, bag_size: 6223
batch 499, loss: 0.4054, instance_loss: 0.4058, weighted_loss: 0.4055, label: 0, bag_size: 5108
batch 519, loss: 1.0606, instance_loss: 0.8861, weighted_loss: 1.0083, label: 1, bag_size: 2998
batch 539, loss: 0.4164, instance_loss: 0.5977, weighted_loss: 0.4708, label: 2, bag_size: 4535
batch 559, loss: 0.0589, instance_loss: 0.1026, weighted_loss: 0.0720, label: 2, bag_size: 4691
batch 579, loss: 0.0843, instance_loss: 0.2830, weighted_loss: 0.1439, label: 0, bag_size: 5236
batch 599, loss: 0.0203, instance_loss: 0.7836, weighted_loss: 0.2493, label: 1, bag_size: 5086
batch 619, loss: 0.2864, instance_loss: 0.7372, weighted_loss: 0.4216, label: 2, bag_size: 5037
batch 639, loss: 0.1865, instance_loss: 0.4648, weighted_loss: 0.2700, label: 1, bag_size: 2472
batch 659, loss: 0.3952, instance_loss: 0.3890, weighted_loss: 0.3934, label: 2, bag_size: 2031
batch 679, loss: 0.5273, instance_loss: 0.5730, weighted_loss: 0.5410, label: 0, bag_size: 1492
batch 699, loss: 2.5197, instance_loss: 1.3085, weighted_loss: 2.1563, label: 1, bag_size: 1608
batch 719, loss: 0.1237, instance_loss: 0.3324, weighted_loss: 0.1863, label: 2, bag_size: 5017
batch 739, loss: 0.0098, instance_loss: 0.1283, weighted_loss: 0.0454, label: 0, bag_size: 4165


class 0 clustering acc 0.9682326621923938: correct 17312/17880
class 1 clustering acc 0.3808724832214765: correct 2270/5960
Epoch: 52, train_loss: 0.5185, train_clustering_loss:  0.5203, train_error: 0.2107
class 0: acc 0.7811158798283262, correct 182/233
class 1: acc 0.735632183908046, correct 192/261
class 2: acc 0.852589641434263, correct 214/251

Val Set, val_loss: 0.6399, val_error: 0.2553, auc: 0.9054
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.32313829787234044: correct 243/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0188, instance_loss: 0.2088, weighted_loss: 0.0758, label: 0, bag_size: 6765
batch 39, loss: 0.2686, instance_loss: 0.6475, weighted_loss: 0.3822, label: 2, bag_size: 5011
batch 59, loss: 1.0160, instance_loss: 0.8421, weighted_loss: 0.9638, label: 1, bag_size: 1595
batch 79, loss: 0.0572, instance_loss: 0.6237, weighted_loss: 0.2272, label: 1, bag_size: 3126
batch 99, loss: 1.0899, instance_loss: 0.8668, weighted_loss: 1.0230, label: 1, bag_size: 1045
batch 119, loss: 0.0072, instance_loss: 0.1265, weighted_loss: 0.0430, label: 1, bag_size: 712
batch 139, loss: 0.0195, instance_loss: 0.1364, weighted_loss: 0.0546, label: 0, bag_size: 1399
batch 159, loss: 0.1038, instance_loss: 0.3175, weighted_loss: 0.1679, label: 2, bag_size: 5011
batch 179, loss: 2.0542, instance_loss: 1.2334, weighted_loss: 1.8079, label: 0, bag_size: 1289
batch 199, loss: 0.0999, instance_loss: 0.1597, weighted_loss: 0.1178, label: 1, bag_size: 596
batch 219, loss: 0.5375, instance_loss: 0.6342, weighted_loss: 0.5665, label: 1, bag_size: 2156
batch 239, loss: 1.8908, instance_loss: 1.1586, weighted_loss: 1.6711, label: 1, bag_size: 2614
batch 259, loss: 0.0992, instance_loss: 0.3395, weighted_loss: 0.1713, label: 0, bag_size: 4544
batch 279, loss: 1.2231, instance_loss: 1.3841, weighted_loss: 1.2714, label: 1, bag_size: 3184
batch 299, loss: 0.0473, instance_loss: 0.2256, weighted_loss: 0.1008, label: 2, bag_size: 2770
batch 319, loss: 0.5105, instance_loss: 0.4916, weighted_loss: 0.5048, label: 1, bag_size: 4812
batch 339, loss: 0.0260, instance_loss: 0.1062, weighted_loss: 0.0500, label: 0, bag_size: 4721
batch 359, loss: 0.0511, instance_loss: 0.1641, weighted_loss: 0.0850, label: 2, bag_size: 4745
batch 379, loss: 0.2131, instance_loss: 0.4578, weighted_loss: 0.2865, label: 0, bag_size: 2153
batch 399, loss: 0.7862, instance_loss: 0.6205, weighted_loss: 0.7365, label: 1, bag_size: 1500
batch 419, loss: 0.0100, instance_loss: 0.4706, weighted_loss: 0.1482, label: 1, bag_size: 4027
batch 439, loss: 0.0941, instance_loss: 0.4861, weighted_loss: 0.2117, label: 2, bag_size: 6594
batch 459, loss: 0.0032, instance_loss: 0.0533, weighted_loss: 0.0182, label: 0, bag_size: 4644
batch 479, loss: 2.4344, instance_loss: 1.0267, weighted_loss: 2.0121, label: 0, bag_size: 7504
batch 499, loss: 1.7580, instance_loss: 0.9640, weighted_loss: 1.5198, label: 2, bag_size: 4316
batch 519, loss: 0.0074, instance_loss: 0.3749, weighted_loss: 0.1177, label: 1, bag_size: 6475
batch 539, loss: 0.8849, instance_loss: 0.6891, weighted_loss: 0.8262, label: 1, bag_size: 3823
batch 559, loss: 0.1058, instance_loss: 0.1625, weighted_loss: 0.1228, label: 2, bag_size: 1094
batch 579, loss: 0.4911, instance_loss: 0.4862, weighted_loss: 0.4896, label: 0, bag_size: 3397
batch 599, loss: 0.0230, instance_loss: 0.0915, weighted_loss: 0.0436, label: 2, bag_size: 4745
batch 619, loss: 0.0468, instance_loss: 0.2444, weighted_loss: 0.1061, label: 1, bag_size: 10941
batch 639, loss: 0.6816, instance_loss: 0.6352, weighted_loss: 0.6677, label: 1, bag_size: 4940
batch 659, loss: 0.0650, instance_loss: 1.2821, weighted_loss: 0.4301, label: 0, bag_size: 4479
batch 679, loss: 0.1085, instance_loss: 0.1567, weighted_loss: 0.1229, label: 2, bag_size: 4056
batch 699, loss: 0.0000, instance_loss: 0.2370, weighted_loss: 0.0711, label: 1, bag_size: 4067
batch 719, loss: 0.3514, instance_loss: 0.2738, weighted_loss: 0.3281, label: 2, bag_size: 597
batch 739, loss: 0.7916, instance_loss: 0.5892, weighted_loss: 0.7308, label: 0, bag_size: 4547


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.3706375838926175: correct 2209/5960
Epoch: 53, train_loss: 0.5494, train_clustering_loss:  0.5429, train_error: 0.2215
class 0: acc 0.7759336099585062, correct 187/241
class 1: acc 0.6988847583643123, correct 188/269
class 2: acc 0.8723404255319149, correct 205/235

Val Set, val_loss: 0.5662, val_error: 0.2128, auc: 0.9082
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.39095744680851063: correct 294/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.573751 --> 0.566246).  Saving model ...


batch 19, loss: 0.6320, instance_loss: 1.1104, weighted_loss: 0.7755, label: 2, bag_size: 3604
batch 39, loss: 0.4036, instance_loss: 0.4541, weighted_loss: 0.4188, label: 2, bag_size: 5637
batch 59, loss: 1.5216, instance_loss: 0.9154, weighted_loss: 1.3397, label: 1, bag_size: 3322
batch 79, loss: 0.0201, instance_loss: 0.2686, weighted_loss: 0.0946, label: 1, bag_size: 2493
batch 99, loss: 0.1242, instance_loss: 0.3272, weighted_loss: 0.1851, label: 0, bag_size: 4894
batch 119, loss: 0.0259, instance_loss: 0.1034, weighted_loss: 0.0492, label: 0, bag_size: 1233
batch 139, loss: 0.8574, instance_loss: 0.9275, weighted_loss: 0.8784, label: 1, bag_size: 6025
batch 159, loss: 0.0779, instance_loss: 0.2998, weighted_loss: 0.1445, label: 2, bag_size: 3227
batch 179, loss: 1.3953, instance_loss: 1.0670, weighted_loss: 1.2968, label: 1, bag_size: 2013
batch 199, loss: 0.0099, instance_loss: 0.0407, weighted_loss: 0.0191, label: 2, bag_size: 6026
batch 219, loss: 0.9928, instance_loss: 0.7747, weighted_loss: 0.9274, label: 0, bag_size: 14432
batch 239, loss: 0.0559, instance_loss: 0.1553, weighted_loss: 0.0857, label: 2, bag_size: 3415
batch 259, loss: 0.0092, instance_loss: 0.0933, weighted_loss: 0.0344, label: 2, bag_size: 3497
batch 279, loss: 0.0301, instance_loss: 0.3895, weighted_loss: 0.1379, label: 0, bag_size: 577
batch 299, loss: 0.6222, instance_loss: 0.6141, weighted_loss: 0.6198, label: 1, bag_size: 1500
batch 319, loss: 1.2543, instance_loss: 0.8699, weighted_loss: 1.1390, label: 1, bag_size: 3482
batch 339, loss: 1.1430, instance_loss: 1.0200, weighted_loss: 1.1061, label: 2, bag_size: 4571
batch 359, loss: 0.3559, instance_loss: 0.5850, weighted_loss: 0.4247, label: 0, bag_size: 5585
batch 379, loss: 0.0525, instance_loss: 0.2080, weighted_loss: 0.0991, label: 0, bag_size: 1194
batch 399, loss: 0.0361, instance_loss: 0.2049, weighted_loss: 0.0867, label: 2, bag_size: 3546
batch 419, loss: 0.2176, instance_loss: 0.4154, weighted_loss: 0.2769, label: 0, bag_size: 789
batch 439, loss: 0.0273, instance_loss: 0.2332, weighted_loss: 0.0891, label: 1, bag_size: 1394
batch 459, loss: 0.1725, instance_loss: 0.4714, weighted_loss: 0.2622, label: 1, bag_size: 3398
batch 479, loss: 0.0451, instance_loss: 0.2709, weighted_loss: 0.1128, label: 2, bag_size: 4192
batch 499, loss: 0.0639, instance_loss: 0.2181, weighted_loss: 0.1102, label: 0, bag_size: 2479
batch 519, loss: 0.5387, instance_loss: 0.5702, weighted_loss: 0.5482, label: 0, bag_size: 3701
batch 539, loss: 0.3175, instance_loss: 0.3831, weighted_loss: 0.3372, label: 2, bag_size: 5037
batch 559, loss: 0.3397, instance_loss: 0.7500, weighted_loss: 0.4628, label: 2, bag_size: 724
batch 579, loss: 0.0300, instance_loss: 0.2156, weighted_loss: 0.0857, label: 0, bag_size: 1744
batch 599, loss: 0.0789, instance_loss: 0.4446, weighted_loss: 0.1886, label: 0, bag_size: 2841
batch 619, loss: 0.4951, instance_loss: 0.5985, weighted_loss: 0.5261, label: 1, bag_size: 3746
batch 639, loss: 0.7468, instance_loss: 0.7286, weighted_loss: 0.7413, label: 1, bag_size: 2013
batch 659, loss: 0.1442, instance_loss: 0.2669, weighted_loss: 0.1810, label: 1, bag_size: 596
batch 679, loss: 0.8083, instance_loss: 0.9848, weighted_loss: 0.8613, label: 1, bag_size: 2744
batch 699, loss: 0.3333, instance_loss: 0.3730, weighted_loss: 0.3452, label: 2, bag_size: 1222
batch 719, loss: 0.6973, instance_loss: 0.5262, weighted_loss: 0.6460, label: 1, bag_size: 209
batch 739, loss: 0.0495, instance_loss: 0.2362, weighted_loss: 0.1055, label: 1, bag_size: 3051


class 0 clustering acc 0.9704697986577181: correct 17352/17880
class 1 clustering acc 0.4204697986577181: correct 2506/5960
Epoch: 54, train_loss: 0.4698, train_clustering_loss:  0.5117, train_error: 0.1678
class 0: acc 0.8682170542635659, correct 224/258
class 1: acc 0.7155172413793104, correct 166/232
class 2: acc 0.9019607843137255, correct 230/255

Val Set, val_loss: 0.5855, val_error: 0.1809, auc: 0.9072
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.4228723404255319: correct 318/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2723, instance_loss: 0.4077, weighted_loss: 0.3129, label: 1, bag_size: 209
batch 39, loss: 0.7935, instance_loss: 0.4599, weighted_loss: 0.6934, label: 1, bag_size: 800
batch 59, loss: 0.0523, instance_loss: 0.1792, weighted_loss: 0.0904, label: 0, bag_size: 4531
batch 79, loss: 0.0035, instance_loss: 0.0782, weighted_loss: 0.0259, label: 1, bag_size: 259
batch 99, loss: 0.0137, instance_loss: 0.2034, weighted_loss: 0.0706, label: 0, bag_size: 3920
batch 119, loss: 0.0578, instance_loss: 0.2091, weighted_loss: 0.1032, label: 2, bag_size: 5011
batch 139, loss: 0.0162, instance_loss: 0.2038, weighted_loss: 0.0724, label: 0, bag_size: 4606
batch 159, loss: 0.0303, instance_loss: 0.1240, weighted_loss: 0.0584, label: 2, bag_size: 3415
batch 179, loss: 0.0446, instance_loss: 0.3151, weighted_loss: 0.1257, label: 1, bag_size: 3051
batch 199, loss: 0.0854, instance_loss: 0.3162, weighted_loss: 0.1547, label: 2, bag_size: 5017
batch 219, loss: 0.2239, instance_loss: 0.2093, weighted_loss: 0.2195, label: 2, bag_size: 597
batch 239, loss: 2.8916, instance_loss: 0.7863, weighted_loss: 2.2600, label: 2, bag_size: 2561
batch 259, loss: 1.9881, instance_loss: 1.0804, weighted_loss: 1.7158, label: 1, bag_size: 1250
batch 279, loss: 0.0403, instance_loss: 0.2355, weighted_loss: 0.0989, label: 2, bag_size: 3397
batch 299, loss: 1.8102, instance_loss: 1.0113, weighted_loss: 1.5705, label: 1, bag_size: 4705
batch 319, loss: 0.1769, instance_loss: 0.9067, weighted_loss: 0.3959, label: 2, bag_size: 361
batch 339, loss: 0.0616, instance_loss: 0.6101, weighted_loss: 0.2261, label: 2, bag_size: 361
batch 359, loss: 1.2273, instance_loss: 0.9667, weighted_loss: 1.1491, label: 1, bag_size: 3396
batch 379, loss: 1.0313, instance_loss: 1.0043, weighted_loss: 1.0232, label: 1, bag_size: 2927
batch 399, loss: 1.0566, instance_loss: 0.9558, weighted_loss: 1.0264, label: 2, bag_size: 2770
batch 419, loss: 3.0859, instance_loss: 1.1688, weighted_loss: 2.5108, label: 0, bag_size: 2217
batch 439, loss: 0.1334, instance_loss: 0.4940, weighted_loss: 0.2415, label: 0, bag_size: 1245
batch 459, loss: 0.1007, instance_loss: 0.1841, weighted_loss: 0.1257, label: 2, bag_size: 4555
batch 479, loss: 2.8014, instance_loss: 1.4624, weighted_loss: 2.3997, label: 1, bag_size: 4258
batch 499, loss: 0.0105, instance_loss: 0.1315, weighted_loss: 0.0468, label: 0, bag_size: 1812
batch 519, loss: 0.8158, instance_loss: 1.0090, weighted_loss: 0.8738, label: 1, bag_size: 6243
batch 539, loss: 0.1383, instance_loss: 0.3696, weighted_loss: 0.2077, label: 1, bag_size: 3885
batch 559, loss: 0.8168, instance_loss: 0.8732, weighted_loss: 0.8337, label: 1, bag_size: 5833
batch 579, loss: 0.0149, instance_loss: 0.1031, weighted_loss: 0.0413, label: 0, bag_size: 2824
batch 599, loss: 0.5825, instance_loss: 0.6094, weighted_loss: 0.5906, label: 2, bag_size: 1222
batch 619, loss: 0.2761, instance_loss: 0.3364, weighted_loss: 0.2942, label: 0, bag_size: 5413
batch 639, loss: 0.6456, instance_loss: 0.6148, weighted_loss: 0.6364, label: 1, bag_size: 4940
batch 659, loss: 0.0070, instance_loss: 0.5448, weighted_loss: 0.1683, label: 1, bag_size: 5086
batch 679, loss: 0.0708, instance_loss: 0.2547, weighted_loss: 0.1260, label: 0, bag_size: 1233
batch 699, loss: 0.3616, instance_loss: 0.4054, weighted_loss: 0.3747, label: 0, bag_size: 4524
batch 719, loss: 1.0806, instance_loss: 0.7120, weighted_loss: 0.9700, label: 1, bag_size: 578
batch 739, loss: 0.8445, instance_loss: 0.9777, weighted_loss: 0.8845, label: 2, bag_size: 1050


class 0 clustering acc 0.9692953020134228: correct 17331/17880
class 1 clustering acc 0.41996644295302016: correct 2503/5960
Epoch: 55, train_loss: 0.4933, train_clustering_loss:  0.5063, train_error: 0.2174
class 0: acc 0.823045267489712, correct 200/243
class 1: acc 0.6653543307086615, correct 169/254
class 2: acc 0.8629032258064516, correct 214/248

Val Set, val_loss: 0.5448, val_error: 0.2128, auc: 0.9092
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.44680851063829785: correct 336/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.566246 --> 0.544796).  Saving model ...


batch 19, loss: 0.0249, instance_loss: 0.4212, weighted_loss: 0.1438, label: 2, bag_size: 4497
batch 39, loss: 0.2206, instance_loss: 0.4469, weighted_loss: 0.2885, label: 0, bag_size: 16741
batch 59, loss: 2.7793, instance_loss: 1.2991, weighted_loss: 2.3352, label: 1, bag_size: 6942
batch 79, loss: 0.8634, instance_loss: 0.8423, weighted_loss: 0.8571, label: 1, bag_size: 8632
batch 99, loss: 0.0211, instance_loss: 0.1484, weighted_loss: 0.0593, label: 2, bag_size: 2209
batch 119, loss: 0.0623, instance_loss: 0.3697, weighted_loss: 0.1545, label: 2, bag_size: 3227
batch 139, loss: 0.4113, instance_loss: 0.5206, weighted_loss: 0.4441, label: 1, bag_size: 4438
batch 159, loss: 0.0007, instance_loss: 0.3461, weighted_loss: 0.1043, label: 1, bag_size: 7279
batch 179, loss: 3.4990, instance_loss: 1.4091, weighted_loss: 2.8720, label: 0, bag_size: 1071
batch 199, loss: 0.3076, instance_loss: 0.6070, weighted_loss: 0.3974, label: 1, bag_size: 3821
batch 219, loss: 0.2362, instance_loss: 0.4026, weighted_loss: 0.2861, label: 2, bag_size: 4302
batch 239, loss: 0.0000, instance_loss: 1.8181, weighted_loss: 0.5454, label: 0, bag_size: 1709
batch 259, loss: 0.1267, instance_loss: 0.3132, weighted_loss: 0.1826, label: 0, bag_size: 3294
batch 279, loss: 0.0157, instance_loss: 0.0624, weighted_loss: 0.0297, label: 0, bag_size: 471
batch 299, loss: 0.0095, instance_loss: 0.9052, weighted_loss: 0.2782, label: 0, bag_size: 2028
batch 319, loss: 1.4141, instance_loss: 1.1942, weighted_loss: 1.3481, label: 1, bag_size: 2425
batch 339, loss: 1.3759, instance_loss: 0.8054, weighted_loss: 1.2047, label: 1, bag_size: 3644
batch 359, loss: 0.1797, instance_loss: 0.2450, weighted_loss: 0.1993, label: 0, bag_size: 921
batch 379, loss: 0.4681, instance_loss: 0.6348, weighted_loss: 0.5182, label: 2, bag_size: 3174
batch 399, loss: 0.1397, instance_loss: 0.3533, weighted_loss: 0.2037, label: 0, bag_size: 2927
batch 419, loss: 1.4751, instance_loss: 0.8339, weighted_loss: 1.2828, label: 2, bag_size: 909
batch 439, loss: 2.1658, instance_loss: 1.1564, weighted_loss: 1.8630, label: 0, bag_size: 436
batch 459, loss: 2.6496, instance_loss: 1.5822, weighted_loss: 2.3294, label: 1, bag_size: 7176
batch 479, loss: 0.5435, instance_loss: 0.6147, weighted_loss: 0.5649, label: 1, bag_size: 1906
batch 499, loss: 0.2428, instance_loss: 0.3440, weighted_loss: 0.2731, label: 0, bag_size: 3341
batch 519, loss: 1.3031, instance_loss: 0.7767, weighted_loss: 1.1452, label: 0, bag_size: 5023
batch 539, loss: 0.0115, instance_loss: 0.0247, weighted_loss: 0.0154, label: 2, bag_size: 2997
batch 559, loss: 0.0661, instance_loss: 0.1930, weighted_loss: 0.1042, label: 0, bag_size: 471
batch 579, loss: 0.1176, instance_loss: 0.3394, weighted_loss: 0.1841, label: 0, bag_size: 7595
batch 599, loss: 0.0587, instance_loss: 0.3415, weighted_loss: 0.1435, label: 0, bag_size: 3397
batch 619, loss: 0.1586, instance_loss: 0.2768, weighted_loss: 0.1940, label: 2, bag_size: 3397
batch 639, loss: 0.0577, instance_loss: 0.2080, weighted_loss: 0.1028, label: 2, bag_size: 3227
batch 659, loss: 0.5270, instance_loss: 0.5212, weighted_loss: 0.5253, label: 0, bag_size: 4909
batch 679, loss: 0.1083, instance_loss: 0.2177, weighted_loss: 0.1411, label: 2, bag_size: 3396
batch 699, loss: 0.8327, instance_loss: 0.9864, weighted_loss: 0.8788, label: 1, bag_size: 4467
batch 719, loss: 0.5496, instance_loss: 0.4652, weighted_loss: 0.5243, label: 0, bag_size: 2915
batch 739, loss: 0.2369, instance_loss: 0.6908, weighted_loss: 0.3731, label: 1, bag_size: 6689


class 0 clustering acc 0.9680648769574944: correct 17309/17880
class 1 clustering acc 0.4140939597315436: correct 2468/5960
Epoch: 56, train_loss: 0.5143, train_clustering_loss:  0.5189, train_error: 0.2013
class 0: acc 0.810077519379845, correct 209/258
class 1: acc 0.6887966804979253, correct 166/241
class 2: acc 0.8943089430894309, correct 220/246

Val Set, val_loss: 0.6078, val_error: 0.2660, auc: 0.8997
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.3058510638297872: correct 230/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0090, instance_loss: 0.5708, weighted_loss: 0.1775, label: 1, bag_size: 5760
batch 39, loss: 0.0090, instance_loss: 0.0994, weighted_loss: 0.0361, label: 2, bag_size: 4745
batch 59, loss: 0.1833, instance_loss: 0.4873, weighted_loss: 0.2745, label: 2, bag_size: 4569
batch 79, loss: 0.2391, instance_loss: 0.5302, weighted_loss: 0.3264, label: 0, bag_size: 3245
batch 99, loss: 2.6483, instance_loss: 1.2929, weighted_loss: 2.2417, label: 2, bag_size: 4241
batch 119, loss: 0.0057, instance_loss: 0.0823, weighted_loss: 0.0287, label: 0, bag_size: 3438
batch 139, loss: 0.6557, instance_loss: 0.7286, weighted_loss: 0.6776, label: 2, bag_size: 1050
batch 159, loss: 0.0490, instance_loss: 0.3063, weighted_loss: 0.1262, label: 1, bag_size: 3497
batch 179, loss: 3.2373, instance_loss: 1.0355, weighted_loss: 2.5768, label: 1, bag_size: 32
batch 199, loss: 0.0529, instance_loss: 0.2742, weighted_loss: 0.1193, label: 0, bag_size: 3437
batch 219, loss: 0.0003, instance_loss: 2.1468, weighted_loss: 0.6442, label: 0, bag_size: 2231
batch 239, loss: 1.2367, instance_loss: 0.7362, weighted_loss: 1.0865, label: 2, bag_size: 909
batch 259, loss: 0.0068, instance_loss: 0.0475, weighted_loss: 0.0190, label: 2, bag_size: 2254
batch 279, loss: 0.0001, instance_loss: 0.4413, weighted_loss: 0.1324, label: 1, bag_size: 5760
batch 299, loss: 0.8215, instance_loss: 0.8591, weighted_loss: 0.8328, label: 1, bag_size: 3604
batch 319, loss: 0.1115, instance_loss: 0.1154, weighted_loss: 0.1127, label: 0, bag_size: 5282
batch 339, loss: 0.0266, instance_loss: 0.2063, weighted_loss: 0.0805, label: 0, bag_size: 4994
batch 359, loss: 0.5555, instance_loss: 0.8024, weighted_loss: 0.6296, label: 1, bag_size: 2927
batch 379, loss: 0.2642, instance_loss: 0.3666, weighted_loss: 0.2949, label: 0, bag_size: 4251
batch 399, loss: 0.5977, instance_loss: 0.5978, weighted_loss: 0.5977, label: 2, bag_size: 1222
batch 419, loss: 0.4878, instance_loss: 0.6616, weighted_loss: 0.5400, label: 2, bag_size: 4316
batch 439, loss: 0.0086, instance_loss: 0.6491, weighted_loss: 0.2008, label: 1, bag_size: 3043
batch 459, loss: 0.0082, instance_loss: 0.0720, weighted_loss: 0.0273, label: 0, bag_size: 2873
batch 479, loss: 0.2972, instance_loss: 0.4442, weighted_loss: 0.3413, label: 0, bag_size: 4909
batch 499, loss: 0.2146, instance_loss: 0.3585, weighted_loss: 0.2578, label: 2, bag_size: 6298
batch 519, loss: 2.6835, instance_loss: 1.0561, weighted_loss: 2.1953, label: 0, bag_size: 603
batch 539, loss: 0.1902, instance_loss: 0.5101, weighted_loss: 0.2862, label: 1, bag_size: 6717
batch 559, loss: 0.3059, instance_loss: 0.5859, weighted_loss: 0.3899, label: 1, bag_size: 3357
batch 579, loss: 0.6716, instance_loss: 0.8993, weighted_loss: 0.7399, label: 1, bag_size: 4940
batch 599, loss: 0.0013, instance_loss: 0.1436, weighted_loss: 0.0440, label: 1, bag_size: 3265
batch 619, loss: 0.1548, instance_loss: 0.5557, weighted_loss: 0.2751, label: 1, bag_size: 1197
batch 639, loss: 0.1014, instance_loss: 0.2147, weighted_loss: 0.1354, label: 2, bag_size: 4555
batch 659, loss: 0.0101, instance_loss: 0.0395, weighted_loss: 0.0189, label: 2, bag_size: 6026
batch 679, loss: 0.0000, instance_loss: 0.4933, weighted_loss: 0.1480, label: 1, bag_size: 5462
batch 699, loss: 0.2097, instance_loss: 0.5757, weighted_loss: 0.3195, label: 1, bag_size: 3296
batch 719, loss: 0.2470, instance_loss: 0.8436, weighted_loss: 0.4260, label: 2, bag_size: 361
batch 739, loss: 0.0730, instance_loss: 0.1967, weighted_loss: 0.1102, label: 0, bag_size: 1762


class 0 clustering acc 0.9716442953020135: correct 17373/17880
class 1 clustering acc 0.40486577181208055: correct 2413/5960
Epoch: 57, train_loss: 0.4804, train_clustering_loss:  0.5063, train_error: 0.1812
class 0: acc 0.8273092369477911, correct 206/249
class 1: acc 0.7375, correct 177/240
class 2: acc 0.88671875, correct 227/256

Val Set, val_loss: 0.5955, val_error: 0.2340, auc: 0.9023
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.3390957446808511: correct 255/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0160, instance_loss: 0.2681, weighted_loss: 0.0916, label: 1, bag_size: 3493
batch 39, loss: 0.0344, instance_loss: 0.1393, weighted_loss: 0.0659, label: 2, bag_size: 4555
batch 59, loss: 1.9498, instance_loss: 0.9744, weighted_loss: 1.6572, label: 1, bag_size: 5880
batch 79, loss: 1.1730, instance_loss: 0.7504, weighted_loss: 1.0462, label: 2, bag_size: 1050
batch 99, loss: 0.1727, instance_loss: 0.5206, weighted_loss: 0.2770, label: 1, bag_size: 5003
batch 119, loss: 0.0208, instance_loss: 0.0790, weighted_loss: 0.0382, label: 0, bag_size: 6138
batch 139, loss: 0.5722, instance_loss: 0.4537, weighted_loss: 0.5367, label: 0, bag_size: 3904
batch 159, loss: 0.0238, instance_loss: 0.1098, weighted_loss: 0.0496, label: 0, bag_size: 3406
batch 179, loss: 1.3176, instance_loss: 0.9273, weighted_loss: 1.2005, label: 2, bag_size: 4316
batch 199, loss: 0.0062, instance_loss: 0.0345, weighted_loss: 0.0147, label: 2, bag_size: 6001
batch 219, loss: 0.2562, instance_loss: 0.6096, weighted_loss: 0.3622, label: 2, bag_size: 5037
batch 239, loss: 0.8329, instance_loss: 0.5865, weighted_loss: 0.7590, label: 2, bag_size: 4788
batch 259, loss: 0.0123, instance_loss: 0.5300, weighted_loss: 0.1676, label: 1, bag_size: 683
batch 279, loss: 0.3811, instance_loss: 0.5587, weighted_loss: 0.4344, label: 2, bag_size: 3604
batch 299, loss: 0.3089, instance_loss: 0.4261, weighted_loss: 0.3441, label: 2, bag_size: 3112
batch 319, loss: 0.8439, instance_loss: 0.5608, weighted_loss: 0.7590, label: 0, bag_size: 3038
batch 339, loss: 0.1050, instance_loss: 0.2657, weighted_loss: 0.1532, label: 2, bag_size: 5011
batch 359, loss: 0.3595, instance_loss: 0.1684, weighted_loss: 0.3022, label: 0, bag_size: 4524
batch 379, loss: 0.3278, instance_loss: 0.4661, weighted_loss: 0.3693, label: 2, bag_size: 4140
batch 399, loss: 0.9065, instance_loss: 0.8642, weighted_loss: 0.8938, label: 0, bag_size: 436
batch 419, loss: 0.4954, instance_loss: 0.5758, weighted_loss: 0.5196, label: 0, bag_size: 3701
batch 439, loss: 0.1518, instance_loss: 0.1858, weighted_loss: 0.1620, label: 2, bag_size: 4162
batch 459, loss: 0.1373, instance_loss: 0.4484, weighted_loss: 0.2306, label: 0, bag_size: 598
batch 479, loss: 0.3623, instance_loss: 0.4184, weighted_loss: 0.3792, label: 2, bag_size: 6594
batch 499, loss: 0.0758, instance_loss: 0.4646, weighted_loss: 0.1925, label: 1, bag_size: 5718
batch 519, loss: 0.2436, instance_loss: 0.3808, weighted_loss: 0.2848, label: 0, bag_size: 5340
batch 539, loss: 0.0065, instance_loss: 0.0531, weighted_loss: 0.0204, label: 2, bag_size: 657
batch 559, loss: 0.1160, instance_loss: 0.3928, weighted_loss: 0.1990, label: 2, bag_size: 4571
batch 579, loss: 0.2654, instance_loss: 0.1519, weighted_loss: 0.2314, label: 2, bag_size: 2561
batch 599, loss: 0.3715, instance_loss: 0.4552, weighted_loss: 0.3966, label: 2, bag_size: 3778
batch 619, loss: 0.1797, instance_loss: 0.4443, weighted_loss: 0.2591, label: 1, bag_size: 2122
batch 639, loss: 0.0781, instance_loss: 0.3687, weighted_loss: 0.1653, label: 0, bag_size: 3245
batch 659, loss: 0.4337, instance_loss: 0.5146, weighted_loss: 0.4580, label: 0, bag_size: 4416
batch 679, loss: 0.1576, instance_loss: 0.2152, weighted_loss: 0.1749, label: 2, bag_size: 3172
batch 699, loss: 2.1278, instance_loss: 1.5469, weighted_loss: 1.9535, label: 1, bag_size: 1604
batch 719, loss: 0.4843, instance_loss: 0.2206, weighted_loss: 0.4052, label: 2, bag_size: 3026
batch 739, loss: 0.8930, instance_loss: 0.5368, weighted_loss: 0.7861, label: 1, bag_size: 628


class 0 clustering acc 0.9689038031319911: correct 17324/17880
class 1 clustering acc 0.41996644295302016: correct 2503/5960
Epoch: 58, train_loss: 0.5081, train_clustering_loss:  0.5190, train_error: 0.2054
class 0: acc 0.7974683544303798, correct 189/237
class 1: acc 0.6652360515021459, correct 155/233
class 2: acc 0.9018181818181819, correct 248/275

Val Set, val_loss: 0.6148, val_error: 0.2340, auc: 0.9065
class 0 clustering acc 0.9849290780141844: correct 2222/2256
class 1 clustering acc 0.2712765957446808: correct 204/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0668, instance_loss: 0.3996, weighted_loss: 0.1666, label: 0, bag_size: 7927
batch 39, loss: 0.2850, instance_loss: 0.4101, weighted_loss: 0.3225, label: 0, bag_size: 5340
batch 59, loss: 0.0322, instance_loss: 0.3599, weighted_loss: 0.1305, label: 0, bag_size: 2853
batch 79, loss: 0.4065, instance_loss: 0.6298, weighted_loss: 0.4735, label: 2, bag_size: 5426
batch 99, loss: 0.5161, instance_loss: 0.4761, weighted_loss: 0.5041, label: 2, bag_size: 4096
batch 119, loss: 0.0556, instance_loss: 0.2075, weighted_loss: 0.1012, label: 0, bag_size: 13540
batch 139, loss: 0.2652, instance_loss: 0.5623, weighted_loss: 0.3544, label: 2, bag_size: 5406
batch 159, loss: 0.0099, instance_loss: 0.0724, weighted_loss: 0.0286, label: 2, bag_size: 4043
batch 179, loss: 0.0713, instance_loss: 0.3653, weighted_loss: 0.1595, label: 1, bag_size: 1197
batch 199, loss: 0.0009, instance_loss: 0.1939, weighted_loss: 0.0588, label: 1, bag_size: 3127
batch 219, loss: 0.1849, instance_loss: 0.5002, weighted_loss: 0.2795, label: 0, bag_size: 2841
batch 239, loss: 0.1969, instance_loss: 0.3410, weighted_loss: 0.2402, label: 0, bag_size: 4719
batch 259, loss: 0.1608, instance_loss: 0.1961, weighted_loss: 0.1713, label: 0, bag_size: 4794
batch 279, loss: 0.0672, instance_loss: 0.2421, weighted_loss: 0.1196, label: 2, bag_size: 4162
batch 299, loss: 0.0272, instance_loss: 0.1227, weighted_loss: 0.0559, label: 0, bag_size: 3649
batch 319, loss: 0.4227, instance_loss: 0.4660, weighted_loss: 0.4357, label: 1, bag_size: 2945
batch 339, loss: 0.4074, instance_loss: 0.5410, weighted_loss: 0.4475, label: 2, bag_size: 6594
batch 359, loss: 0.0938, instance_loss: 0.3690, weighted_loss: 0.1763, label: 0, bag_size: 6015
batch 379, loss: 0.0299, instance_loss: 0.3771, weighted_loss: 0.1340, label: 1, bag_size: 475
batch 399, loss: 0.0104, instance_loss: 0.2015, weighted_loss: 0.0678, label: 1, bag_size: 1807
batch 419, loss: 0.0216, instance_loss: 0.3420, weighted_loss: 0.1177, label: 2, bag_size: 2770
batch 439, loss: 2.8244, instance_loss: 1.2974, weighted_loss: 2.3663, label: 1, bag_size: 3261
batch 459, loss: 0.0343, instance_loss: 0.1257, weighted_loss: 0.0617, label: 2, bag_size: 3210
batch 479, loss: 0.0478, instance_loss: 0.2366, weighted_loss: 0.1045, label: 2, bag_size: 5011
batch 499, loss: 0.0173, instance_loss: 0.0709, weighted_loss: 0.0334, label: 2, bag_size: 4088
batch 519, loss: 0.0013, instance_loss: 0.1259, weighted_loss: 0.0387, label: 1, bag_size: 4595
batch 539, loss: 0.2861, instance_loss: 0.2928, weighted_loss: 0.2881, label: 1, bag_size: 368
batch 559, loss: 0.0000, instance_loss: 0.1317, weighted_loss: 0.0395, label: 1, bag_size: 4181
batch 579, loss: 0.0217, instance_loss: 0.1115, weighted_loss: 0.0486, label: 2, bag_size: 2481
batch 599, loss: 0.2136, instance_loss: 0.3307, weighted_loss: 0.2488, label: 2, bag_size: 4535
batch 619, loss: 0.4339, instance_loss: 0.6571, weighted_loss: 0.5009, label: 1, bag_size: 3640
batch 639, loss: 2.6666, instance_loss: 1.6512, weighted_loss: 2.3619, label: 1, bag_size: 3261
batch 659, loss: 1.6808, instance_loss: 0.9104, weighted_loss: 1.4497, label: 0, bag_size: 20234
batch 679, loss: 0.1498, instance_loss: 0.3459, weighted_loss: 0.2086, label: 2, bag_size: 3080
batch 699, loss: 0.0412, instance_loss: 0.4516, weighted_loss: 0.1644, label: 1, bag_size: 3221
batch 719, loss: 0.9854, instance_loss: 0.7885, weighted_loss: 0.9263, label: 0, bag_size: 1543
batch 739, loss: 0.2889, instance_loss: 0.6976, weighted_loss: 0.4115, label: 2, bag_size: 223


class 0 clustering acc 0.9715324384787472: correct 17371/17880
class 1 clustering acc 0.4602348993288591: correct 2743/5960
Epoch: 59, train_loss: 0.4455, train_clustering_loss:  0.4909, train_error: 0.1785
class 0: acc 0.8149606299212598, correct 207/254
class 1: acc 0.7564102564102564, correct 177/234
class 2: acc 0.8871595330739299, correct 228/257

Val Set, val_loss: 0.6543, val_error: 0.2340, auc: 0.9030
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.30186170212765956: correct 227/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0017, instance_loss: 0.7766, weighted_loss: 0.2342, label: 0, bag_size: 3920
batch 39, loss: 0.6340, instance_loss: 0.8146, weighted_loss: 0.6882, label: 2, bag_size: 22464
batch 59, loss: 1.1895, instance_loss: 0.8279, weighted_loss: 1.0810, label: 1, bag_size: 3422
batch 79, loss: 1.3045, instance_loss: 1.1050, weighted_loss: 1.2447, label: 1, bag_size: 8632
batch 99, loss: 1.4063, instance_loss: 0.9989, weighted_loss: 1.2841, label: 2, bag_size: 4316
batch 119, loss: 0.8749, instance_loss: 0.8288, weighted_loss: 0.8611, label: 1, bag_size: 817
batch 139, loss: 0.2301, instance_loss: 0.4410, weighted_loss: 0.2933, label: 1, bag_size: 3367
batch 159, loss: 0.0003, instance_loss: 0.2932, weighted_loss: 0.0882, label: 1, bag_size: 3677
batch 179, loss: 0.0001, instance_loss: 0.4312, weighted_loss: 0.1294, label: 1, bag_size: 3172
batch 199, loss: 0.0135, instance_loss: 0.1130, weighted_loss: 0.0434, label: 2, bag_size: 6148
batch 219, loss: 0.4857, instance_loss: 0.4694, weighted_loss: 0.4808, label: 2, bag_size: 3176
batch 239, loss: 0.2484, instance_loss: 0.3156, weighted_loss: 0.2686, label: 1, bag_size: 3391
batch 259, loss: 0.0075, instance_loss: 0.0667, weighted_loss: 0.0252, label: 2, bag_size: 3415
batch 279, loss: 0.5713, instance_loss: 0.6328, weighted_loss: 0.5897, label: 2, bag_size: 552
batch 299, loss: 0.5595, instance_loss: 0.7523, weighted_loss: 0.6173, label: 2, bag_size: 552
batch 319, loss: 0.2252, instance_loss: 0.8078, weighted_loss: 0.4000, label: 2, bag_size: 223
batch 339, loss: 0.2117, instance_loss: 0.6452, weighted_loss: 0.3418, label: 2, bag_size: 724
batch 359, loss: 0.8827, instance_loss: 0.7354, weighted_loss: 0.8385, label: 1, bag_size: 4708
batch 379, loss: 0.1047, instance_loss: 0.3605, weighted_loss: 0.1814, label: 0, bag_size: 2610
batch 399, loss: 0.2618, instance_loss: 0.6120, weighted_loss: 0.3668, label: 2, bag_size: 3778
batch 419, loss: 2.8051, instance_loss: 2.0992, weighted_loss: 2.5934, label: 1, bag_size: 5205
batch 439, loss: 0.0964, instance_loss: 0.2633, weighted_loss: 0.1465, label: 0, bag_size: 3777
batch 459, loss: 0.0000, instance_loss: 0.3105, weighted_loss: 0.0931, label: 1, bag_size: 6277
batch 479, loss: 0.0168, instance_loss: 0.1085, weighted_loss: 0.0443, label: 2, bag_size: 3497
batch 499, loss: 0.0535, instance_loss: 0.4237, weighted_loss: 0.1645, label: 1, bag_size: 8482
batch 519, loss: 0.7243, instance_loss: 0.6186, weighted_loss: 0.6926, label: 2, bag_size: 1222
batch 539, loss: 0.0390, instance_loss: 0.1742, weighted_loss: 0.0796, label: 0, bag_size: 4606
batch 559, loss: 0.0075, instance_loss: 0.0922, weighted_loss: 0.0329, label: 0, bag_size: 829
batch 579, loss: 0.0429, instance_loss: 0.2024, weighted_loss: 0.0907, label: 2, bag_size: 4555
batch 599, loss: 0.0163, instance_loss: 0.1297, weighted_loss: 0.0503, label: 0, bag_size: 3924
batch 619, loss: 0.0146, instance_loss: 0.0961, weighted_loss: 0.0391, label: 2, bag_size: 4569
batch 639, loss: 0.0982, instance_loss: 0.3391, weighted_loss: 0.1704, label: 0, bag_size: 5260
batch 659, loss: 0.7200, instance_loss: 0.3730, weighted_loss: 0.6159, label: 2, bag_size: 2031
batch 679, loss: 1.7200, instance_loss: 1.4975, weighted_loss: 1.6532, label: 0, bag_size: 1755
batch 699, loss: 0.0177, instance_loss: 0.1473, weighted_loss: 0.0566, label: 0, bag_size: 5039
batch 719, loss: 0.3287, instance_loss: 0.3621, weighted_loss: 0.3387, label: 0, bag_size: 1492
batch 739, loss: 0.1010, instance_loss: 0.1381, weighted_loss: 0.1121, label: 2, bag_size: 5914


class 0 clustering acc 0.9671140939597316: correct 17292/17880
class 1 clustering acc 0.42701342281879195: correct 2545/5960
Epoch: 60, train_loss: 0.4788, train_clustering_loss:  0.5139, train_error: 0.1866
class 0: acc 0.825, correct 198/240
class 1: acc 0.708, correct 177/250
class 2: acc 0.9058823529411765, correct 231/255

Val Set, val_loss: 0.5913, val_error: 0.2660, auc: 0.9017
class 0 clustering acc 0.9609929078014184: correct 2168/2256
class 1 clustering acc 0.37367021276595747: correct 281/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1236, instance_loss: 0.2120, weighted_loss: 0.1501, label: 0, bag_size: 1194
batch 39, loss: 0.0218, instance_loss: 0.6094, weighted_loss: 0.1981, label: 0, bag_size: 3920
batch 59, loss: 0.6879, instance_loss: 0.6712, weighted_loss: 0.6829, label: 2, bag_size: 3778
batch 79, loss: 0.0202, instance_loss: 0.0880, weighted_loss: 0.0406, label: 2, bag_size: 4088
batch 99, loss: 0.0273, instance_loss: 0.1412, weighted_loss: 0.0615, label: 2, bag_size: 6644
batch 119, loss: 0.3889, instance_loss: 0.8040, weighted_loss: 0.5134, label: 1, bag_size: 4824
batch 139, loss: 0.0098, instance_loss: 0.0478, weighted_loss: 0.0212, label: 2, bag_size: 4856
batch 159, loss: 0.0001, instance_loss: 0.2109, weighted_loss: 0.0633, label: 1, bag_size: 2009
batch 179, loss: 0.1580, instance_loss: 0.3744, weighted_loss: 0.2230, label: 1, bag_size: 5728
batch 199, loss: 0.0449, instance_loss: 0.1097, weighted_loss: 0.0643, label: 2, bag_size: 4856
batch 219, loss: 0.2932, instance_loss: 0.5334, weighted_loss: 0.3653, label: 1, bag_size: 4119
batch 239, loss: 0.2863, instance_loss: 0.4457, weighted_loss: 0.3342, label: 2, bag_size: 3112
batch 259, loss: 0.0267, instance_loss: 0.1151, weighted_loss: 0.0533, label: 0, bag_size: 5992
batch 279, loss: 0.0151, instance_loss: 1.3976, weighted_loss: 0.4298, label: 1, bag_size: 4067
batch 299, loss: 0.2012, instance_loss: 0.5303, weighted_loss: 0.2999, label: 2, bag_size: 3607
batch 319, loss: 0.0627, instance_loss: 0.2223, weighted_loss: 0.1106, label: 0, bag_size: 3741
batch 339, loss: 0.0008, instance_loss: 0.2529, weighted_loss: 0.0765, label: 1, bag_size: 2009
batch 359, loss: 0.5748, instance_loss: 0.5984, weighted_loss: 0.5819, label: 1, bag_size: 4438
batch 379, loss: 0.4693, instance_loss: 0.5551, weighted_loss: 0.4950, label: 1, bag_size: 2865
batch 399, loss: 0.0211, instance_loss: 0.1484, weighted_loss: 0.0593, label: 0, bag_size: 1640
batch 419, loss: 0.1453, instance_loss: 0.2932, weighted_loss: 0.1897, label: 0, bag_size: 5413
batch 439, loss: 0.2984, instance_loss: 1.1244, weighted_loss: 0.5462, label: 1, bag_size: 3995
batch 459, loss: 0.2902, instance_loss: 0.1851, weighted_loss: 0.2586, label: 0, bag_size: 8611
batch 479, loss: 0.2900, instance_loss: 0.3004, weighted_loss: 0.2931, label: 0, bag_size: 2850
batch 499, loss: 0.0614, instance_loss: 0.1032, weighted_loss: 0.0740, label: 0, bag_size: 4524
batch 519, loss: 1.2511, instance_loss: 0.8982, weighted_loss: 1.1452, label: 0, bag_size: 1289
batch 539, loss: 0.0003, instance_loss: 0.0921, weighted_loss: 0.0278, label: 0, bag_size: 4403
batch 559, loss: 0.0005, instance_loss: 0.3844, weighted_loss: 0.1157, label: 0, bag_size: 5003
batch 579, loss: 0.0117, instance_loss: 0.0539, weighted_loss: 0.0244, label: 0, bag_size: 5459
batch 599, loss: 0.3030, instance_loss: 0.4971, weighted_loss: 0.3612, label: 1, bag_size: 368
batch 619, loss: 0.9436, instance_loss: 0.5215, weighted_loss: 0.8170, label: 2, bag_size: 5637
batch 639, loss: 0.0883, instance_loss: 0.3305, weighted_loss: 0.1609, label: 2, bag_size: 5037
batch 659, loss: 0.0557, instance_loss: 0.1147, weighted_loss: 0.0734, label: 2, bag_size: 3176
batch 679, loss: 0.0229, instance_loss: 0.1128, weighted_loss: 0.0498, label: 2, bag_size: 4775
batch 699, loss: 0.0569, instance_loss: 0.3040, weighted_loss: 0.1310, label: 1, bag_size: 712
batch 719, loss: 0.4728, instance_loss: 0.6646, weighted_loss: 0.5304, label: 1, bag_size: 4694
batch 739, loss: 1.5329, instance_loss: 1.1456, weighted_loss: 1.4167, label: 1, bag_size: 4200


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.4355704697986577: correct 2596/5960
Epoch: 61, train_loss: 0.5034, train_clustering_loss:  0.5007, train_error: 0.2148
class 0: acc 0.8070866141732284, correct 205/254
class 1: acc 0.6848739495798319, correct 163/238
class 2: acc 0.857707509881423, correct 217/253

Val Set, val_loss: 0.5289, val_error: 0.1915, auc: 0.9133
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.37898936170212766: correct 285/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.544796 --> 0.528875).  Saving model ...


batch 19, loss: 0.0166, instance_loss: 0.0808, weighted_loss: 0.0358, label: 0, bag_size: 1399
batch 39, loss: 0.3893, instance_loss: 0.4860, weighted_loss: 0.4183, label: 1, bag_size: 3482
batch 59, loss: 0.5018, instance_loss: 0.6879, weighted_loss: 0.5576, label: 2, bag_size: 5924
batch 79, loss: 0.2767, instance_loss: 0.6800, weighted_loss: 0.3977, label: 2, bag_size: 728
batch 99, loss: 0.8099, instance_loss: 0.5750, weighted_loss: 0.7395, label: 0, bag_size: 2850
batch 119, loss: 0.0225, instance_loss: 0.2509, weighted_loss: 0.0910, label: 1, bag_size: 1807
batch 139, loss: 0.0110, instance_loss: 0.1242, weighted_loss: 0.0449, label: 1, bag_size: 1023
batch 159, loss: 0.3445, instance_loss: 0.2940, weighted_loss: 0.3293, label: 2, bag_size: 6644
batch 179, loss: 0.1312, instance_loss: 0.1164, weighted_loss: 0.1268, label: 2, bag_size: 4056
batch 199, loss: 0.2011, instance_loss: 0.2916, weighted_loss: 0.2283, label: 2, bag_size: 6644
batch 219, loss: 0.6035, instance_loss: 0.7421, weighted_loss: 0.6451, label: 0, bag_size: 313
batch 239, loss: 4.0269, instance_loss: 1.4489, weighted_loss: 3.2535, label: 2, bag_size: 1513
batch 259, loss: 0.8177, instance_loss: 1.0913, weighted_loss: 0.8998, label: 0, bag_size: 3419
batch 279, loss: 0.0380, instance_loss: 0.2377, weighted_loss: 0.0979, label: 0, bag_size: 4282
batch 299, loss: 0.8271, instance_loss: 0.4067, weighted_loss: 0.7010, label: 2, bag_size: 2031
batch 319, loss: 0.0204, instance_loss: 0.1196, weighted_loss: 0.0501, label: 0, bag_size: 6927
batch 339, loss: 0.0013, instance_loss: 0.4400, weighted_loss: 0.1329, label: 1, bag_size: 3677
batch 359, loss: 1.5888, instance_loss: 1.2055, weighted_loss: 1.4738, label: 1, bag_size: 1712
batch 379, loss: 0.0360, instance_loss: 0.1712, weighted_loss: 0.0766, label: 0, bag_size: 2897
batch 399, loss: 0.0024, instance_loss: 0.5539, weighted_loss: 0.1679, label: 0, bag_size: 1910
batch 419, loss: 0.0042, instance_loss: 0.2163, weighted_loss: 0.0678, label: 1, bag_size: 3337
batch 439, loss: 1.2904, instance_loss: 1.2967, weighted_loss: 1.2923, label: 0, bag_size: 5950
batch 459, loss: 0.5639, instance_loss: 0.7439, weighted_loss: 0.6179, label: 1, bag_size: 3460
batch 479, loss: 0.3160, instance_loss: 0.5747, weighted_loss: 0.3936, label: 1, bag_size: 475
batch 499, loss: 0.1523, instance_loss: 0.5459, weighted_loss: 0.2704, label: 2, bag_size: 552
batch 519, loss: 0.2236, instance_loss: 0.5945, weighted_loss: 0.3349, label: 1, bag_size: 6243
batch 539, loss: 0.0140, instance_loss: 0.0597, weighted_loss: 0.0277, label: 2, bag_size: 6644
batch 559, loss: 0.0697, instance_loss: 0.4064, weighted_loss: 0.1707, label: 2, bag_size: 4571
batch 579, loss: 0.2824, instance_loss: 0.3858, weighted_loss: 0.3134, label: 2, bag_size: 3327
batch 599, loss: 0.0080, instance_loss: 0.2572, weighted_loss: 0.0827, label: 1, bag_size: 3983
batch 619, loss: 0.0280, instance_loss: 0.0848, weighted_loss: 0.0450, label: 2, bag_size: 6026
batch 639, loss: 0.0069, instance_loss: 0.2323, weighted_loss: 0.0745, label: 1, bag_size: 2493
batch 659, loss: 0.8027, instance_loss: 0.7996, weighted_loss: 0.8018, label: 1, bag_size: 3813
batch 679, loss: 0.1853, instance_loss: 0.4355, weighted_loss: 0.2603, label: 0, bag_size: 5375
batch 699, loss: 0.1814, instance_loss: 0.7897, weighted_loss: 0.3639, label: 1, bag_size: 1604
batch 719, loss: 0.2895, instance_loss: 0.5443, weighted_loss: 0.3659, label: 1, bag_size: 2643
batch 739, loss: 0.0153, instance_loss: 0.1872, weighted_loss: 0.0669, label: 2, bag_size: 4192


class 0 clustering acc 0.9710290827740492: correct 17362/17880
class 1 clustering acc 0.44345637583892616: correct 2643/5960
Epoch: 62, train_loss: 0.4274, train_clustering_loss:  0.4849, train_error: 0.1624
class 0: acc 0.8398268398268398, correct 194/231
class 1: acc 0.7489711934156379, correct 182/243
class 2: acc 0.915129151291513, correct 248/271

Val Set, val_loss: 0.6773, val_error: 0.2872, auc: 0.8999
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.4015957446808511: correct 302/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0117, instance_loss: 0.1100, weighted_loss: 0.0412, label: 0, bag_size: 2545
batch 39, loss: 0.2634, instance_loss: 0.3014, weighted_loss: 0.2748, label: 0, bag_size: 3191
batch 59, loss: 0.7307, instance_loss: 0.5132, weighted_loss: 0.6654, label: 1, bag_size: 2319
batch 79, loss: 0.0641, instance_loss: 0.1247, weighted_loss: 0.0823, label: 2, bag_size: 4856
batch 99, loss: 1.3033, instance_loss: 0.7057, weighted_loss: 1.1240, label: 1, bag_size: 3106
batch 119, loss: 0.0427, instance_loss: 0.4704, weighted_loss: 0.1710, label: 1, bag_size: 5718
batch 139, loss: 0.3938, instance_loss: 0.2910, weighted_loss: 0.3630, label: 1, bag_size: 19265
batch 159, loss: 1.0094, instance_loss: 0.8885, weighted_loss: 0.9731, label: 1, bag_size: 1712
batch 179, loss: 0.2173, instance_loss: 0.3839, weighted_loss: 0.2673, label: 0, bag_size: 609
batch 199, loss: 0.1088, instance_loss: 0.2740, weighted_loss: 0.1584, label: 2, bag_size: 4140
batch 219, loss: 0.0422, instance_loss: 0.2057, weighted_loss: 0.0912, label: 2, bag_size: 3121
batch 239, loss: 1.6588, instance_loss: 0.6525, weighted_loss: 1.3569, label: 1, bag_size: 296
batch 259, loss: 0.0000, instance_loss: 1.7006, weighted_loss: 0.5102, label: 0, bag_size: 1709
batch 279, loss: 0.1652, instance_loss: 0.3715, weighted_loss: 0.2271, label: 2, bag_size: 5017
batch 299, loss: 0.0496, instance_loss: 0.2096, weighted_loss: 0.0976, label: 2, bag_size: 4788
batch 319, loss: 0.5043, instance_loss: 0.6503, weighted_loss: 0.5481, label: 1, bag_size: 4940
batch 339, loss: 0.0167, instance_loss: 0.0671, weighted_loss: 0.0319, label: 2, bag_size: 4056
batch 359, loss: 0.0104, instance_loss: 0.1976, weighted_loss: 0.0666, label: 1, bag_size: 596
batch 379, loss: 0.0206, instance_loss: 0.0719, weighted_loss: 0.0360, label: 2, bag_size: 2481
batch 399, loss: 0.0096, instance_loss: 0.0617, weighted_loss: 0.0252, label: 2, bag_size: 3497
batch 419, loss: 0.1446, instance_loss: 0.2098, weighted_loss: 0.1642, label: 2, bag_size: 3026
batch 439, loss: 2.3570, instance_loss: 1.0503, weighted_loss: 1.9650, label: 0, bag_size: 22822
batch 459, loss: 0.9636, instance_loss: 0.7382, weighted_loss: 0.8960, label: 2, bag_size: 4571
batch 479, loss: 0.6055, instance_loss: 0.7615, weighted_loss: 0.6523, label: 2, bag_size: 22464
batch 499, loss: 0.0238, instance_loss: 0.2751, weighted_loss: 0.0991, label: 1, bag_size: 1394
batch 519, loss: 0.3722, instance_loss: 0.3513, weighted_loss: 0.3659, label: 0, bag_size: 3571
batch 539, loss: 0.1306, instance_loss: 0.5022, weighted_loss: 0.2421, label: 0, bag_size: 3648
batch 559, loss: 1.1755, instance_loss: 0.5525, weighted_loss: 0.9886, label: 1, bag_size: 6993
batch 579, loss: 0.4251, instance_loss: 0.6327, weighted_loss: 0.4874, label: 2, bag_size: 5072
batch 599, loss: 0.0039, instance_loss: 0.1256, weighted_loss: 0.0404, label: 0, bag_size: 1245
batch 619, loss: 0.0000, instance_loss: 0.2713, weighted_loss: 0.0814, label: 1, bag_size: 6277
batch 639, loss: 0.0859, instance_loss: 0.2059, weighted_loss: 0.1219, label: 1, bag_size: 5728
batch 659, loss: 0.0377, instance_loss: 0.4062, weighted_loss: 0.1482, label: 2, bag_size: 6148
batch 679, loss: 0.1081, instance_loss: 1.5576, weighted_loss: 0.5429, label: 0, bag_size: 2028
batch 699, loss: 0.8452, instance_loss: 0.7923, weighted_loss: 0.8293, label: 1, bag_size: 3106
batch 719, loss: 0.0780, instance_loss: 0.2146, weighted_loss: 0.1189, label: 1, bag_size: 3396
batch 739, loss: 0.1757, instance_loss: 0.3768, weighted_loss: 0.2360, label: 2, bag_size: 4569


class 0 clustering acc 0.9639261744966443: correct 17235/17880
class 1 clustering acc 0.4629194630872483: correct 2759/5960
Epoch: 63, train_loss: 0.4586, train_clustering_loss:  0.5003, train_error: 0.1946
class 0: acc 0.8155737704918032, correct 199/244
class 1: acc 0.72, correct 180/250
class 2: acc 0.8804780876494024, correct 221/251

Val Set, val_loss: 0.5993, val_error: 0.2872, auc: 0.8983
class 0 clustering acc 0.9445921985815603: correct 2131/2256
class 1 clustering acc 0.5066489361702128: correct 381/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4806, instance_loss: 0.5867, weighted_loss: 0.5124, label: 2, bag_size: 1222
batch 39, loss: 0.9950, instance_loss: 0.7959, weighted_loss: 0.9353, label: 1, bag_size: 2919
batch 59, loss: 0.9677, instance_loss: 0.5398, weighted_loss: 0.8394, label: 1, bag_size: 296
batch 79, loss: 3.3599, instance_loss: 1.3945, weighted_loss: 2.7702, label: 2, bag_size: 4179
batch 99, loss: 0.2146, instance_loss: 0.3894, weighted_loss: 0.2670, label: 2, bag_size: 5924
batch 119, loss: 0.6294, instance_loss: 0.4887, weighted_loss: 0.5872, label: 0, bag_size: 2853
batch 139, loss: 0.5047, instance_loss: 0.4519, weighted_loss: 0.4889, label: 1, bag_size: 628
batch 159, loss: 0.2146, instance_loss: 0.3855, weighted_loss: 0.2659, label: 0, bag_size: 2139
batch 179, loss: 0.0552, instance_loss: 0.4469, weighted_loss: 0.1727, label: 1, bag_size: 5718
batch 199, loss: 0.0838, instance_loss: 0.3199, weighted_loss: 0.1547, label: 1, bag_size: 3471
batch 219, loss: 0.6528, instance_loss: 0.8037, weighted_loss: 0.6981, label: 2, bag_size: 1050
batch 239, loss: 1.4359, instance_loss: 1.0082, weighted_loss: 1.3076, label: 0, bag_size: 1795
batch 259, loss: 1.6999, instance_loss: 0.7465, weighted_loss: 1.4138, label: 0, bag_size: 2190
batch 279, loss: 0.2930, instance_loss: 0.8694, weighted_loss: 0.4659, label: 1, bag_size: 3821
batch 299, loss: 0.3655, instance_loss: 0.3150, weighted_loss: 0.3504, label: 2, bag_size: 88
batch 319, loss: 1.5756, instance_loss: 1.3822, weighted_loss: 1.5176, label: 1, bag_size: 8632
batch 339, loss: 0.3282, instance_loss: 0.5432, weighted_loss: 0.3927, label: 0, bag_size: 3033
batch 359, loss: 0.2313, instance_loss: 0.9116, weighted_loss: 0.4354, label: 1, bag_size: 5385
batch 379, loss: 1.3556, instance_loss: 0.9550, weighted_loss: 1.2354, label: 1, bag_size: 8632
batch 399, loss: 0.2998, instance_loss: 0.5951, weighted_loss: 0.3884, label: 1, bag_size: 4784
batch 419, loss: 0.1404, instance_loss: 0.3551, weighted_loss: 0.2049, label: 2, bag_size: 3618
batch 439, loss: 0.0696, instance_loss: 0.1895, weighted_loss: 0.1056, label: 2, bag_size: 6001
batch 459, loss: 0.2766, instance_loss: 0.4406, weighted_loss: 0.3258, label: 2, bag_size: 4302
batch 479, loss: 0.7138, instance_loss: 1.2459, weighted_loss: 0.8734, label: 2, bag_size: 7607
batch 499, loss: 0.6175, instance_loss: 0.4052, weighted_loss: 0.5538, label: 2, bag_size: 2031
batch 519, loss: 0.7947, instance_loss: 0.8699, weighted_loss: 0.8172, label: 2, bag_size: 22464
batch 539, loss: 3.9515, instance_loss: 1.7736, weighted_loss: 3.2982, label: 0, bag_size: 557
batch 559, loss: 0.8911, instance_loss: 1.1936, weighted_loss: 0.9818, label: 1, bag_size: 6689
batch 579, loss: 0.0589, instance_loss: 0.3333, weighted_loss: 0.1412, label: 0, bag_size: 420
batch 599, loss: 0.0893, instance_loss: 0.2100, weighted_loss: 0.1255, label: 0, bag_size: 4242
batch 619, loss: 0.1046, instance_loss: 0.2210, weighted_loss: 0.1395, label: 2, bag_size: 2481
batch 639, loss: 0.0059, instance_loss: 0.5607, weighted_loss: 0.1723, label: 2, bag_size: 7607
batch 659, loss: 0.2422, instance_loss: 0.4003, weighted_loss: 0.2896, label: 0, bag_size: 6797
batch 679, loss: 0.2586, instance_loss: 0.6830, weighted_loss: 0.3859, label: 0, bag_size: 4494
batch 699, loss: 0.4528, instance_loss: 0.4761, weighted_loss: 0.4598, label: 2, bag_size: 6594
batch 719, loss: 0.7174, instance_loss: 0.3619, weighted_loss: 0.6108, label: 0, bag_size: 5871
batch 739, loss: 0.2316, instance_loss: 1.8907, weighted_loss: 0.7293, label: 2, bag_size: 5426


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.4109060402684564: correct 2449/5960
Epoch: 64, train_loss: 0.5499, train_clustering_loss:  0.5273, train_error: 0.2268
class 0: acc 0.8046875, correct 206/256
class 1: acc 0.6514522821576764, correct 157/241
class 2: acc 0.8588709677419355, correct 213/248

Val Set, val_loss: 0.6454, val_error: 0.2447, auc: 0.8951
class 0 clustering acc 0.9547872340425532: correct 2154/2256
class 1 clustering acc 0.39228723404255317: correct 295/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0111, instance_loss: 0.2187, weighted_loss: 0.0734, label: 1, bag_size: 440
batch 39, loss: 1.3778, instance_loss: 0.9697, weighted_loss: 1.2554, label: 2, bag_size: 3475
batch 59, loss: 1.6002, instance_loss: 0.6553, weighted_loss: 1.3167, label: 0, bag_size: 4146
batch 79, loss: 0.0844, instance_loss: 0.2260, weighted_loss: 0.1269, label: 0, bag_size: 3864
batch 99, loss: 0.0297, instance_loss: 0.4451, weighted_loss: 0.1543, label: 1, bag_size: 7135
batch 119, loss: 0.2012, instance_loss: 0.5758, weighted_loss: 0.3136, label: 1, bag_size: 1327
batch 139, loss: 0.2787, instance_loss: 0.4683, weighted_loss: 0.3356, label: 2, bag_size: 5017
batch 159, loss: 0.2992, instance_loss: 0.3915, weighted_loss: 0.3269, label: 1, bag_size: 574
batch 179, loss: 1.6438, instance_loss: 2.2063, weighted_loss: 1.8125, label: 0, bag_size: 2069
batch 199, loss: 0.0726, instance_loss: 0.2378, weighted_loss: 0.1222, label: 0, bag_size: 2286
batch 219, loss: 0.9414, instance_loss: 1.0521, weighted_loss: 0.9746, label: 2, bag_size: 22464
batch 239, loss: 1.2889, instance_loss: 1.0186, weighted_loss: 1.2078, label: 1, bag_size: 4145
batch 259, loss: 0.6025, instance_loss: 0.7070, weighted_loss: 0.6338, label: 1, bag_size: 6152
batch 279, loss: 0.1348, instance_loss: 0.6102, weighted_loss: 0.2774, label: 1, bag_size: 5696
batch 299, loss: 0.0117, instance_loss: 0.3664, weighted_loss: 0.1181, label: 1, bag_size: 440
batch 319, loss: 0.4786, instance_loss: 0.6600, weighted_loss: 0.5330, label: 1, bag_size: 782
batch 339, loss: 0.0342, instance_loss: 0.8069, weighted_loss: 0.2660, label: 1, bag_size: 5086
batch 359, loss: 0.0052, instance_loss: 0.1904, weighted_loss: 0.0608, label: 1, bag_size: 3051
batch 379, loss: 0.0792, instance_loss: 0.1905, weighted_loss: 0.1126, label: 2, bag_size: 3172
batch 399, loss: 0.0533, instance_loss: 0.1380, weighted_loss: 0.0787, label: 1, bag_size: 1023
batch 419, loss: 0.2540, instance_loss: 0.4666, weighted_loss: 0.3178, label: 1, bag_size: 2182
batch 439, loss: 0.0010, instance_loss: 0.4005, weighted_loss: 0.1208, label: 1, bag_size: 3611
batch 459, loss: 0.3361, instance_loss: 0.5539, weighted_loss: 0.4015, label: 2, bag_size: 3227
batch 479, loss: 1.1214, instance_loss: 1.0353, weighted_loss: 1.0956, label: 1, bag_size: 5402
batch 499, loss: 1.0098, instance_loss: 0.9018, weighted_loss: 0.9774, label: 1, bag_size: 3438
batch 519, loss: 0.5316, instance_loss: 0.5365, weighted_loss: 0.5331, label: 2, bag_size: 3210
batch 539, loss: 0.0705, instance_loss: 0.1969, weighted_loss: 0.1084, label: 2, bag_size: 3396
batch 559, loss: 0.0300, instance_loss: 0.1096, weighted_loss: 0.0539, label: 0, bag_size: 7169
batch 579, loss: 0.0636, instance_loss: 0.1377, weighted_loss: 0.0858, label: 0, bag_size: 4760
batch 599, loss: 0.1393, instance_loss: 0.3454, weighted_loss: 0.2011, label: 1, bag_size: 4119
batch 619, loss: 0.1366, instance_loss: 0.1646, weighted_loss: 0.1450, label: 2, bag_size: 1094
batch 639, loss: 0.2518, instance_loss: 0.3291, weighted_loss: 0.2750, label: 2, bag_size: 4571
batch 659, loss: 0.1424, instance_loss: 0.2233, weighted_loss: 0.1667, label: 2, bag_size: 3327
batch 679, loss: 0.2241, instance_loss: 0.1607, weighted_loss: 0.2051, label: 0, bag_size: 5867
batch 699, loss: 0.0409, instance_loss: 0.2252, weighted_loss: 0.0962, label: 0, bag_size: 3367
batch 719, loss: 0.2676, instance_loss: 0.1846, weighted_loss: 0.2427, label: 2, bag_size: 2031
batch 739, loss: 0.0166, instance_loss: 0.1240, weighted_loss: 0.0488, label: 0, bag_size: 2019


class 0 clustering acc 0.9673937360178971: correct 17297/17880
class 1 clustering acc 0.42634228187919465: correct 2541/5960
Epoch: 65, train_loss: 0.4966, train_clustering_loss:  0.5071, train_error: 0.1839
class 0: acc 0.8299595141700404, correct 205/247
class 1: acc 0.7350746268656716, correct 197/268
class 2: acc 0.8956521739130435, correct 206/230

Val Set, val_loss: 0.6061, val_error: 0.2447, auc: 0.9057
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.449468085106383: correct 338/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0541, instance_loss: 0.1414, weighted_loss: 0.0803, label: 0, bag_size: 5823
batch 39, loss: 1.0171, instance_loss: 0.9749, weighted_loss: 1.0044, label: 1, bag_size: 6315
batch 59, loss: 0.0292, instance_loss: 0.7894, weighted_loss: 0.2573, label: 2, bag_size: 4745
batch 79, loss: 0.0348, instance_loss: 0.4639, weighted_loss: 0.1635, label: 1, bag_size: 5718
batch 99, loss: 0.9523, instance_loss: 1.0841, weighted_loss: 0.9918, label: 2, bag_size: 361
batch 119, loss: 0.1019, instance_loss: 0.1399, weighted_loss: 0.1133, label: 2, bag_size: 2501
batch 139, loss: 0.0901, instance_loss: 0.2979, weighted_loss: 0.1525, label: 2, bag_size: 2561
batch 159, loss: 0.0719, instance_loss: 0.0928, weighted_loss: 0.0782, label: 2, bag_size: 597
batch 179, loss: 0.5154, instance_loss: 0.8271, weighted_loss: 0.6089, label: 2, bag_size: 4241
batch 199, loss: 0.1023, instance_loss: 0.3509, weighted_loss: 0.1769, label: 0, bag_size: 622
batch 219, loss: 0.0248, instance_loss: 0.1175, weighted_loss: 0.0526, label: 2, bag_size: 2313
batch 239, loss: 0.0478, instance_loss: 0.1365, weighted_loss: 0.0744, label: 2, bag_size: 2313
batch 259, loss: 0.3272, instance_loss: 0.7963, weighted_loss: 0.4680, label: 2, bag_size: 724
batch 279, loss: 0.3330, instance_loss: 0.5329, weighted_loss: 0.3930, label: 0, bag_size: 4541
batch 299, loss: 0.0114, instance_loss: 0.0989, weighted_loss: 0.0376, label: 0, bag_size: 598
batch 319, loss: 1.2333, instance_loss: 1.0695, weighted_loss: 1.1842, label: 1, bag_size: 3533
batch 339, loss: 1.3999, instance_loss: 0.6259, weighted_loss: 1.1677, label: 0, bag_size: 3382
batch 359, loss: 0.1906, instance_loss: 0.8033, weighted_loss: 0.3744, label: 0, bag_size: 2069
batch 379, loss: 0.0654, instance_loss: 0.1486, weighted_loss: 0.0904, label: 0, bag_size: 4865
batch 399, loss: 0.0162, instance_loss: 0.1362, weighted_loss: 0.0522, label: 2, bag_size: 4691
batch 419, loss: 0.3203, instance_loss: 0.2871, weighted_loss: 0.3104, label: 2, bag_size: 4056
batch 439, loss: 0.2736, instance_loss: 0.4991, weighted_loss: 0.3412, label: 1, bag_size: 2302
batch 459, loss: 1.1526, instance_loss: 1.1200, weighted_loss: 1.1428, label: 0, bag_size: 5330
batch 479, loss: 0.3362, instance_loss: 0.4096, weighted_loss: 0.3582, label: 1, bag_size: 2859
batch 499, loss: 0.4288, instance_loss: 0.6157, weighted_loss: 0.4848, label: 1, bag_size: 4467
batch 519, loss: 0.0555, instance_loss: 0.8120, weighted_loss: 0.2824, label: 1, bag_size: 6475
batch 539, loss: 0.3286, instance_loss: 0.6341, weighted_loss: 0.4202, label: 1, bag_size: 2998
batch 559, loss: 0.0315, instance_loss: 0.2105, weighted_loss: 0.0852, label: 1, bag_size: 712
batch 579, loss: 0.1642, instance_loss: 0.2560, weighted_loss: 0.1917, label: 2, bag_size: 3176
batch 599, loss: 0.6011, instance_loss: 0.4221, weighted_loss: 0.5474, label: 2, bag_size: 5637
batch 619, loss: 1.7782, instance_loss: 1.2985, weighted_loss: 1.6343, label: 1, bag_size: 5167
batch 639, loss: 0.5356, instance_loss: 0.4290, weighted_loss: 0.5036, label: 0, bag_size: 272
batch 659, loss: 0.4163, instance_loss: 0.7951, weighted_loss: 0.5299, label: 2, bag_size: 5072
batch 679, loss: 0.0077, instance_loss: 0.1102, weighted_loss: 0.0385, label: 0, bag_size: 4458
batch 699, loss: 0.9478, instance_loss: 0.9312, weighted_loss: 0.9429, label: 1, bag_size: 4694
batch 719, loss: 0.3228, instance_loss: 0.6570, weighted_loss: 0.4231, label: 1, bag_size: 4467
batch 739, loss: 0.0079, instance_loss: 0.1431, weighted_loss: 0.0484, label: 1, bag_size: 3051


class 0 clustering acc 0.9672818791946308: correct 17295/17880
class 1 clustering acc 0.46308724832214765: correct 2760/5960
Epoch: 66, train_loss: 0.4278, train_clustering_loss:  0.4871, train_error: 0.1745
class 0: acc 0.8392156862745098, correct 214/255
class 1: acc 0.7459677419354839, correct 185/248
class 2: acc 0.8925619834710744, correct 216/242

Val Set, val_loss: 0.6657, val_error: 0.2234, auc: 0.9070
class 0 clustering acc 0.9685283687943262: correct 2185/2256
class 1 clustering acc 0.42021276595744683: correct 316/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0199, instance_loss: 0.0945, weighted_loss: 0.0422, label: 1, bag_size: 4595
batch 39, loss: 0.0163, instance_loss: 0.0818, weighted_loss: 0.0359, label: 2, bag_size: 4088
batch 59, loss: 0.0375, instance_loss: 0.3237, weighted_loss: 0.1234, label: 0, bag_size: 3872
batch 79, loss: 0.2316, instance_loss: 0.2645, weighted_loss: 0.2415, label: 2, bag_size: 2031
batch 99, loss: 1.3288, instance_loss: 1.0847, weighted_loss: 1.2555, label: 1, bag_size: 32
batch 119, loss: 0.5550, instance_loss: 0.7396, weighted_loss: 0.6104, label: 0, bag_size: 3586
batch 139, loss: 0.5484, instance_loss: 0.7646, weighted_loss: 0.6133, label: 2, bag_size: 552
batch 159, loss: 0.5422, instance_loss: 0.5908, weighted_loss: 0.5568, label: 2, bag_size: 2031
batch 179, loss: 0.0284, instance_loss: 0.3122, weighted_loss: 0.1135, label: 0, bag_size: 1601
batch 199, loss: 0.0000, instance_loss: 0.2604, weighted_loss: 0.0781, label: 0, bag_size: 5487
batch 219, loss: 0.1431, instance_loss: 0.3707, weighted_loss: 0.2114, label: 0, bag_size: 4242
batch 239, loss: 0.0000, instance_loss: 0.7223, weighted_loss: 0.2167, label: 0, bag_size: 2028
batch 259, loss: 0.0277, instance_loss: 0.1720, weighted_loss: 0.0710, label: 2, bag_size: 4372
batch 279, loss: 0.0877, instance_loss: 0.2640, weighted_loss: 0.1406, label: 0, bag_size: 2189
batch 299, loss: 0.0016, instance_loss: 0.0520, weighted_loss: 0.0167, label: 0, bag_size: 1825
batch 319, loss: 0.0272, instance_loss: 0.2025, weighted_loss: 0.0798, label: 0, bag_size: 622
batch 339, loss: 0.0711, instance_loss: 0.2457, weighted_loss: 0.1235, label: 2, bag_size: 4192
batch 359, loss: 0.0235, instance_loss: 0.2069, weighted_loss: 0.0785, label: 1, bag_size: 596
batch 379, loss: 1.7187, instance_loss: 0.8081, weighted_loss: 1.4455, label: 0, bag_size: 4719
batch 399, loss: 0.0023, instance_loss: 0.3189, weighted_loss: 0.0973, label: 1, bag_size: 7279
batch 419, loss: 0.2393, instance_loss: 0.3251, weighted_loss: 0.2650, label: 0, bag_size: 4479
batch 439, loss: 0.0487, instance_loss: 0.1650, weighted_loss: 0.0836, label: 2, bag_size: 4555
batch 459, loss: 0.3429, instance_loss: 0.4223, weighted_loss: 0.3667, label: 0, bag_size: 3155
batch 479, loss: 0.0248, instance_loss: 0.1380, weighted_loss: 0.0588, label: 0, bag_size: 4506
batch 499, loss: 0.0317, instance_loss: 0.1313, weighted_loss: 0.0616, label: 2, bag_size: 6148
batch 519, loss: 0.5643, instance_loss: 0.7061, weighted_loss: 0.6068, label: 1, bag_size: 3422
batch 539, loss: 0.7991, instance_loss: 0.9245, weighted_loss: 0.8367, label: 1, bag_size: 2744
batch 559, loss: 0.0068, instance_loss: 0.1119, weighted_loss: 0.0383, label: 0, bag_size: 855
batch 579, loss: 0.0767, instance_loss: 0.2392, weighted_loss: 0.1255, label: 0, bag_size: 1270
batch 599, loss: 0.7679, instance_loss: 0.9921, weighted_loss: 0.8351, label: 1, bag_size: 4824
batch 619, loss: 0.1343, instance_loss: 0.2940, weighted_loss: 0.1822, label: 2, bag_size: 4487
batch 639, loss: 0.3270, instance_loss: 0.4234, weighted_loss: 0.3559, label: 0, bag_size: 3033
batch 659, loss: 0.0382, instance_loss: 0.2649, weighted_loss: 0.1062, label: 1, bag_size: 5026
batch 679, loss: 0.0707, instance_loss: 0.1429, weighted_loss: 0.0924, label: 2, bag_size: 2313
batch 699, loss: 0.3592, instance_loss: 0.3413, weighted_loss: 0.3539, label: 1, bag_size: 1161
batch 719, loss: 0.0073, instance_loss: 0.0749, weighted_loss: 0.0276, label: 2, bag_size: 3497
batch 739, loss: 0.5796, instance_loss: 0.8083, weighted_loss: 0.6482, label: 2, bag_size: 3274


class 0 clustering acc 0.9675615212527964: correct 17300/17880
class 1 clustering acc 0.45100671140939597: correct 2688/5960
Epoch: 67, train_loss: 0.4716, train_clustering_loss:  0.5015, train_error: 0.1866
class 0: acc 0.8134920634920635, correct 205/252
class 1: acc 0.7117903930131004, correct 163/229
class 2: acc 0.9015151515151515, correct 238/264

Val Set, val_loss: 0.5714, val_error: 0.2553, auc: 0.9045
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.46808510638297873: correct 352/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0245, instance_loss: 0.0931, weighted_loss: 0.0451, label: 2, bag_size: 3678
batch 39, loss: 0.6130, instance_loss: 0.6373, weighted_loss: 0.6203, label: 1, bag_size: 3746
batch 59, loss: 0.0066, instance_loss: 0.1892, weighted_loss: 0.0614, label: 0, bag_size: 2824
batch 79, loss: 1.1131, instance_loss: 0.7749, weighted_loss: 1.0117, label: 1, bag_size: 3533
batch 99, loss: 0.0531, instance_loss: 0.1793, weighted_loss: 0.0910, label: 0, bag_size: 2705
batch 119, loss: 0.4213, instance_loss: 0.5161, weighted_loss: 0.4498, label: 1, bag_size: 869
batch 139, loss: 0.0452, instance_loss: 0.1944, weighted_loss: 0.0900, label: 0, bag_size: 5915
batch 159, loss: 0.0775, instance_loss: 0.2376, weighted_loss: 0.1255, label: 0, bag_size: 6927
batch 179, loss: 0.0055, instance_loss: 0.4170, weighted_loss: 0.1289, label: 1, bag_size: 455
batch 199, loss: 0.0304, instance_loss: 0.1193, weighted_loss: 0.0571, label: 0, bag_size: 4178
batch 219, loss: 0.1230, instance_loss: 0.3768, weighted_loss: 0.1992, label: 2, bag_size: 4302
batch 239, loss: 0.0277, instance_loss: 0.1354, weighted_loss: 0.0600, label: 2, bag_size: 3810
batch 259, loss: 0.0305, instance_loss: 1.1046, weighted_loss: 0.3527, label: 1, bag_size: 5084
batch 279, loss: 1.7612, instance_loss: 1.5521, weighted_loss: 1.6985, label: 1, bag_size: 5205
batch 299, loss: 0.0101, instance_loss: 0.0424, weighted_loss: 0.0198, label: 2, bag_size: 5914
batch 319, loss: 0.3077, instance_loss: 0.5046, weighted_loss: 0.3668, label: 1, bag_size: 2182
batch 339, loss: 0.1130, instance_loss: 0.2663, weighted_loss: 0.1590, label: 2, bag_size: 5924
batch 359, loss: 0.0488, instance_loss: 0.5058, weighted_loss: 0.1859, label: 0, bag_size: 2853
batch 379, loss: 0.1090, instance_loss: 0.2395, weighted_loss: 0.1482, label: 2, bag_size: 4140
batch 399, loss: 0.0251, instance_loss: 0.2044, weighted_loss: 0.0789, label: 0, bag_size: 2824
batch 419, loss: 0.0570, instance_loss: 0.1271, weighted_loss: 0.0780, label: 2, bag_size: 3210
batch 439, loss: 0.0080, instance_loss: 0.2865, weighted_loss: 0.0916, label: 0, bag_size: 6285
batch 459, loss: 0.0187, instance_loss: 0.1585, weighted_loss: 0.0607, label: 0, bag_size: 3533
batch 479, loss: 0.0909, instance_loss: 0.2453, weighted_loss: 0.1372, label: 0, bag_size: 3789
batch 499, loss: 3.5068, instance_loss: 1.4512, weighted_loss: 2.8901, label: 1, bag_size: 5880
batch 519, loss: 0.0085, instance_loss: 0.3085, weighted_loss: 0.0985, label: 0, bag_size: 3920
batch 539, loss: 0.0088, instance_loss: 0.1526, weighted_loss: 0.0520, label: 2, bag_size: 4497
batch 559, loss: 0.3782, instance_loss: 1.0820, weighted_loss: 0.5893, label: 2, bag_size: 7607
batch 579, loss: 0.2167, instance_loss: 0.2864, weighted_loss: 0.2376, label: 2, bag_size: 4132
batch 599, loss: 0.5263, instance_loss: 0.6023, weighted_loss: 0.5491, label: 1, bag_size: 3225
batch 619, loss: 0.4317, instance_loss: 0.6320, weighted_loss: 0.4918, label: 1, bag_size: 1528
batch 639, loss: 0.1596, instance_loss: 0.3856, weighted_loss: 0.2274, label: 2, bag_size: 3227
batch 659, loss: 0.4537, instance_loss: 0.6218, weighted_loss: 0.5041, label: 0, bag_size: 1417
batch 679, loss: 0.0002, instance_loss: 0.6953, weighted_loss: 0.2087, label: 0, bag_size: 2044
batch 699, loss: 0.4900, instance_loss: 0.7173, weighted_loss: 0.5582, label: 1, bag_size: 2642
batch 719, loss: 0.7290, instance_loss: 0.7728, weighted_loss: 0.7421, label: 1, bag_size: 869
batch 739, loss: 0.0424, instance_loss: 0.3527, weighted_loss: 0.1355, label: 2, bag_size: 3607


class 0 clustering acc 0.9639821029082773: correct 17236/17880
class 1 clustering acc 0.43791946308724833: correct 2610/5960
Epoch: 68, train_loss: 0.4622, train_clustering_loss:  0.5175, train_error: 0.1919
class 0: acc 0.8178438661710037, correct 220/269
class 1: acc 0.753968253968254, correct 190/252
class 2: acc 0.8571428571428571, correct 192/224

Val Set, val_loss: 0.6681, val_error: 0.2447, auc: 0.8939
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.3723404255319149: correct 280/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0339, instance_loss: 0.2605, weighted_loss: 0.1019, label: 2, bag_size: 4497
batch 39, loss: 0.1594, instance_loss: 0.3767, weighted_loss: 0.2246, label: 0, bag_size: 1141
batch 59, loss: 0.0611, instance_loss: 0.2442, weighted_loss: 0.1161, label: 1, bag_size: 2796
batch 79, loss: 0.0084, instance_loss: 0.0320, weighted_loss: 0.0155, label: 2, bag_size: 6001
batch 99, loss: 0.0798, instance_loss: 0.2543, weighted_loss: 0.1322, label: 2, bag_size: 5924
batch 119, loss: 0.0077, instance_loss: 0.1708, weighted_loss: 0.0566, label: 0, bag_size: 4070
batch 139, loss: 0.1364, instance_loss: 0.2210, weighted_loss: 0.1618, label: 2, bag_size: 3026
batch 159, loss: 3.5709, instance_loss: 1.9519, weighted_loss: 3.0852, label: 0, bag_size: 11663
batch 179, loss: 0.8302, instance_loss: 0.8557, weighted_loss: 0.8379, label: 0, bag_size: 20234
batch 199, loss: 0.2340, instance_loss: 0.2925, weighted_loss: 0.2516, label: 2, bag_size: 3604
batch 219, loss: 1.8652, instance_loss: 0.9977, weighted_loss: 1.6050, label: 1, bag_size: 2852
batch 239, loss: 0.0093, instance_loss: 0.5896, weighted_loss: 0.1834, label: 0, bag_size: 3298
batch 259, loss: 0.3397, instance_loss: 0.9187, weighted_loss: 0.5134, label: 2, bag_size: 7607
batch 279, loss: 0.9511, instance_loss: 1.0901, weighted_loss: 0.9928, label: 2, bag_size: 223
batch 299, loss: 0.0229, instance_loss: 0.2654, weighted_loss: 0.0956, label: 2, bag_size: 2770
batch 319, loss: 0.0104, instance_loss: 0.3429, weighted_loss: 0.1101, label: 1, bag_size: 3337
batch 339, loss: 0.7420, instance_loss: 0.4354, weighted_loss: 0.6500, label: 1, bag_size: 6993
batch 359, loss: 0.0185, instance_loss: 0.2060, weighted_loss: 0.0747, label: 2, bag_size: 3607
batch 379, loss: 0.6036, instance_loss: 0.5498, weighted_loss: 0.5875, label: 0, bag_size: 1562
batch 399, loss: 1.2678, instance_loss: 0.5230, weighted_loss: 1.0444, label: 1, bag_size: 296
batch 419, loss: 0.1589, instance_loss: 0.4173, weighted_loss: 0.2364, label: 2, bag_size: 3227
batch 439, loss: 0.0193, instance_loss: 0.0968, weighted_loss: 0.0425, label: 2, bag_size: 3415
batch 459, loss: 0.0264, instance_loss: 0.1654, weighted_loss: 0.0681, label: 2, bag_size: 3210
batch 479, loss: 0.7767, instance_loss: 0.5518, weighted_loss: 0.7092, label: 1, bag_size: 578
batch 499, loss: 0.0007, instance_loss: 0.2916, weighted_loss: 0.0880, label: 1, bag_size: 3677
batch 519, loss: 0.0024, instance_loss: 0.6108, weighted_loss: 0.1849, label: 2, bag_size: 4691
batch 539, loss: 0.7747, instance_loss: 0.5978, weighted_loss: 0.7216, label: 2, bag_size: 2501
batch 559, loss: 0.1337, instance_loss: 0.2932, weighted_loss: 0.1816, label: 0, bag_size: 4018
batch 579, loss: 0.3141, instance_loss: 0.4114, weighted_loss: 0.3433, label: 0, bag_size: 5368
batch 599, loss: 0.7379, instance_loss: 0.5344, weighted_loss: 0.6769, label: 0, bag_size: 893
batch 619, loss: 0.0389, instance_loss: 0.2348, weighted_loss: 0.0977, label: 2, bag_size: 3121
batch 639, loss: 0.1329, instance_loss: 0.3156, weighted_loss: 0.1877, label: 1, bag_size: 3109
batch 659, loss: 0.0371, instance_loss: 0.2523, weighted_loss: 0.1017, label: 1, bag_size: 425
batch 679, loss: 0.5055, instance_loss: 1.7625, weighted_loss: 0.8826, label: 1, bag_size: 6241
batch 699, loss: 0.2548, instance_loss: 0.4053, weighted_loss: 0.3000, label: 1, bag_size: 1528
batch 719, loss: 0.3698, instance_loss: 0.5716, weighted_loss: 0.4303, label: 1, bag_size: 4200
batch 739, loss: 0.0244, instance_loss: 0.0880, weighted_loss: 0.0435, label: 2, bag_size: 4056


class 0 clustering acc 0.969407158836689: correct 17333/17880
class 1 clustering acc 0.437248322147651: correct 2606/5960
Epoch: 69, train_loss: 0.4736, train_clustering_loss:  0.5019, train_error: 0.2000
class 0: acc 0.828125, correct 212/256
class 1: acc 0.7047244094488189, correct 179/254
class 2: acc 0.8723404255319149, correct 205/235

Val Set, val_loss: 0.6047, val_error: 0.2234, auc: 0.9079
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.4109042553191489: correct 309/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0126, instance_loss: 0.0765, weighted_loss: 0.0318, label: 0, bag_size: 3727
batch 39, loss: 2.2431, instance_loss: 0.8525, weighted_loss: 1.8259, label: 1, bag_size: 3475
batch 59, loss: 0.5546, instance_loss: 0.6650, weighted_loss: 0.5877, label: 2, bag_size: 3475
batch 79, loss: 0.0121, instance_loss: 0.0710, weighted_loss: 0.0298, label: 2, bag_size: 2483
batch 99, loss: 0.1086, instance_loss: 0.3156, weighted_loss: 0.1707, label: 0, bag_size: 4325
batch 119, loss: 0.4708, instance_loss: 0.6291, weighted_loss: 0.5183, label: 1, bag_size: 2751
batch 139, loss: 0.0072, instance_loss: 0.2522, weighted_loss: 0.0807, label: 1, bag_size: 2731
batch 159, loss: 0.0483, instance_loss: 0.3881, weighted_loss: 0.1502, label: 1, bag_size: 6992
batch 179, loss: 1.6909, instance_loss: 0.6332, weighted_loss: 1.3736, label: 0, bag_size: 3475
batch 199, loss: 0.3088, instance_loss: 0.4821, weighted_loss: 0.3608, label: 1, bag_size: 3619
batch 219, loss: 0.0107, instance_loss: 0.0574, weighted_loss: 0.0247, label: 2, bag_size: 6026
batch 239, loss: 0.2199, instance_loss: 0.7879, weighted_loss: 0.3903, label: 0, bag_size: 5330
batch 259, loss: 0.0525, instance_loss: 0.2734, weighted_loss: 0.1188, label: 2, bag_size: 5011
batch 279, loss: 1.1225, instance_loss: 1.0226, weighted_loss: 1.0925, label: 1, bag_size: 4612
batch 299, loss: 0.0180, instance_loss: 0.1593, weighted_loss: 0.0604, label: 0, bag_size: 1006
batch 319, loss: 0.2867, instance_loss: 0.3842, weighted_loss: 0.3160, label: 1, bag_size: 2753
batch 339, loss: 1.1049, instance_loss: 0.5804, weighted_loss: 0.9476, label: 1, bag_size: 2248
batch 359, loss: 0.6562, instance_loss: 0.6926, weighted_loss: 0.6671, label: 0, bag_size: 16741
batch 379, loss: 0.8205, instance_loss: 0.4028, weighted_loss: 0.6952, label: 1, bag_size: 19265
batch 399, loss: 0.0696, instance_loss: 0.1937, weighted_loss: 0.1068, label: 2, bag_size: 4555
batch 419, loss: 0.0002, instance_loss: 0.4917, weighted_loss: 0.1477, label: 1, bag_size: 4134
batch 439, loss: 1.3518, instance_loss: 0.5140, weighted_loss: 1.1004, label: 2, bag_size: 3327
batch 459, loss: 0.2314, instance_loss: 0.5045, weighted_loss: 0.3133, label: 1, bag_size: 4438
batch 479, loss: 0.6000, instance_loss: 0.6815, weighted_loss: 0.6244, label: 1, bag_size: 5402
batch 499, loss: 0.0163, instance_loss: 0.5314, weighted_loss: 0.1708, label: 1, bag_size: 582
batch 519, loss: 0.2211, instance_loss: 0.5201, weighted_loss: 0.3108, label: 1, bag_size: 2642
batch 539, loss: 0.2523, instance_loss: 0.2727, weighted_loss: 0.2584, label: 0, bag_size: 4584
batch 559, loss: 0.5529, instance_loss: 0.8164, weighted_loss: 0.6320, label: 1, bag_size: 2671
batch 579, loss: 0.0001, instance_loss: 0.1155, weighted_loss: 0.0347, label: 1, bag_size: 4067
batch 599, loss: 0.0078, instance_loss: 0.0353, weighted_loss: 0.0161, label: 2, bag_size: 2483
batch 619, loss: 0.5878, instance_loss: 0.5372, weighted_loss: 0.5726, label: 2, bag_size: 4096
batch 639, loss: 0.0381, instance_loss: 0.1295, weighted_loss: 0.0655, label: 0, bag_size: 3617
batch 659, loss: 0.0548, instance_loss: 0.1244, weighted_loss: 0.0757, label: 0, bag_size: 4178
batch 679, loss: 0.3844, instance_loss: 0.4364, weighted_loss: 0.4000, label: 1, bag_size: 4898
batch 699, loss: 0.0394, instance_loss: 0.1253, weighted_loss: 0.0652, label: 0, bag_size: 3741
batch 719, loss: 0.6478, instance_loss: 0.6449, weighted_loss: 0.6469, label: 2, bag_size: 4241
batch 739, loss: 0.3733, instance_loss: 0.5113, weighted_loss: 0.4147, label: 0, bag_size: 16741


class 0 clustering acc 0.971420581655481: correct 17369/17880
class 1 clustering acc 0.45302013422818793: correct 2700/5960
Epoch: 70, train_loss: 0.4435, train_clustering_loss:  0.4888, train_error: 0.1772
class 0: acc 0.84375, correct 216/256
class 1: acc 0.7490196078431373, correct 191/255
class 2: acc 0.8803418803418803, correct 206/234

Val Set, val_loss: 0.7311, val_error: 0.1809, auc: 0.8720
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.4375: correct 329/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.1790, instance_loss: 1.7718, weighted_loss: 2.0568, label: 1, bag_size: 3438
batch 39, loss: 0.0375, instance_loss: 0.1898, weighted_loss: 0.0832, label: 0, bag_size: 3793
batch 59, loss: 0.0048, instance_loss: 0.0825, weighted_loss: 0.0281, label: 0, bag_size: 4857
batch 79, loss: 3.1265, instance_loss: 0.8573, weighted_loss: 2.4457, label: 0, bag_size: 4717
batch 99, loss: 0.2078, instance_loss: 0.2948, weighted_loss: 0.2339, label: 0, bag_size: 3525
batch 119, loss: 0.3867, instance_loss: 0.4022, weighted_loss: 0.3914, label: 1, bag_size: 3367
batch 139, loss: 0.1361, instance_loss: 0.2951, weighted_loss: 0.1838, label: 0, bag_size: 702
batch 159, loss: 0.0147, instance_loss: 0.1292, weighted_loss: 0.0490, label: 2, bag_size: 2313
batch 179, loss: 0.0035, instance_loss: 0.0586, weighted_loss: 0.0200, label: 2, bag_size: 5138
batch 199, loss: 0.0919, instance_loss: 0.5278, weighted_loss: 0.2226, label: 1, bag_size: 440
batch 219, loss: 1.1409, instance_loss: 0.9551, weighted_loss: 1.0852, label: 2, bag_size: 5406
batch 239, loss: 1.0399, instance_loss: 0.7908, weighted_loss: 0.9652, label: 0, bag_size: 436
batch 259, loss: 0.0606, instance_loss: 0.2521, weighted_loss: 0.1181, label: 2, bag_size: 2770
batch 279, loss: 0.0979, instance_loss: 0.2329, weighted_loss: 0.1384, label: 2, bag_size: 5037
batch 299, loss: 0.1385, instance_loss: 0.3995, weighted_loss: 0.2168, label: 1, bag_size: 475
batch 319, loss: 0.0268, instance_loss: 0.3102, weighted_loss: 0.1118, label: 1, bag_size: 9099
batch 339, loss: 0.1162, instance_loss: 0.3717, weighted_loss: 0.1929, label: 0, bag_size: 7595
batch 359, loss: 0.6046, instance_loss: 0.9070, weighted_loss: 0.6953, label: 1, bag_size: 3640
batch 379, loss: 0.6651, instance_loss: 0.7448, weighted_loss: 0.6890, label: 0, bag_size: 20234
batch 399, loss: 1.5908, instance_loss: 0.7457, weighted_loss: 1.3373, label: 0, bag_size: 3382
batch 419, loss: 0.0061, instance_loss: 0.1022, weighted_loss: 0.0350, label: 2, bag_size: 3121
batch 439, loss: 2.3475, instance_loss: 1.0444, weighted_loss: 1.9566, label: 0, bag_size: 35080
batch 459, loss: 1.4197, instance_loss: 1.4830, weighted_loss: 1.4387, label: 0, bag_size: 621
batch 479, loss: 2.2699, instance_loss: 1.3210, weighted_loss: 1.9853, label: 1, bag_size: 4145
batch 499, loss: 0.0593, instance_loss: 0.6161, weighted_loss: 0.2264, label: 2, bag_size: 223
batch 519, loss: 0.0323, instance_loss: 0.1024, weighted_loss: 0.0534, label: 2, bag_size: 4088
batch 539, loss: 0.2832, instance_loss: 0.3681, weighted_loss: 0.3087, label: 2, bag_size: 597
batch 559, loss: 0.1361, instance_loss: 0.7049, weighted_loss: 0.3068, label: 2, bag_size: 728
batch 579, loss: 1.2846, instance_loss: 1.1356, weighted_loss: 1.2399, label: 1, bag_size: 4200
batch 599, loss: 0.5055, instance_loss: 0.6326, weighted_loss: 0.5436, label: 1, bag_size: 1906
batch 619, loss: 0.0506, instance_loss: 0.2310, weighted_loss: 0.1047, label: 0, bag_size: 855
batch 639, loss: 0.2411, instance_loss: 0.4468, weighted_loss: 0.3028, label: 2, bag_size: 2486
batch 659, loss: 0.5815, instance_loss: 0.6655, weighted_loss: 0.6067, label: 1, bag_size: 2865
batch 679, loss: 0.0133, instance_loss: 0.0663, weighted_loss: 0.0292, label: 0, bag_size: 3437
batch 699, loss: 1.0344, instance_loss: 0.7893, weighted_loss: 0.9609, label: 1, bag_size: 3106
batch 719, loss: 0.0073, instance_loss: 0.0632, weighted_loss: 0.0241, label: 0, bag_size: 5757
batch 739, loss: 0.0253, instance_loss: 0.1028, weighted_loss: 0.0485, label: 0, bag_size: 6797


class 0 clustering acc 0.9710290827740492: correct 17362/17880
class 1 clustering acc 0.4513422818791946: correct 2690/5960
Epoch: 71, train_loss: 0.4694, train_clustering_loss:  0.4998, train_error: 0.1879
class 0: acc 0.8306451612903226, correct 206/248
class 1: acc 0.669683257918552, correct 148/221
class 2: acc 0.9094202898550725, correct 251/276

Val Set, val_loss: 0.6447, val_error: 0.2553, auc: 0.8937
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.4454787234042553: correct 335/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3435, instance_loss: 0.4388, weighted_loss: 0.3721, label: 0, bag_size: 1495
batch 39, loss: 0.0131, instance_loss: 0.0703, weighted_loss: 0.0303, label: 2, bag_size: 3497
batch 59, loss: 0.8226, instance_loss: 0.7827, weighted_loss: 0.8106, label: 2, bag_size: 4535
batch 79, loss: 2.1350, instance_loss: 1.3909, weighted_loss: 1.9118, label: 1, bag_size: 3837
batch 99, loss: 0.1178, instance_loss: 0.3016, weighted_loss: 0.1729, label: 2, bag_size: 4192
batch 119, loss: 2.3294, instance_loss: 0.7290, weighted_loss: 1.8493, label: 2, bag_size: 2770
batch 139, loss: 0.3350, instance_loss: 0.5444, weighted_loss: 0.3978, label: 1, bag_size: 4184
batch 159, loss: 0.0001, instance_loss: 0.1273, weighted_loss: 0.0382, label: 1, bag_size: 5760
batch 179, loss: 0.0120, instance_loss: 0.2101, weighted_loss: 0.0714, label: 1, bag_size: 314
batch 199, loss: 2.0419, instance_loss: 1.0903, weighted_loss: 1.7565, label: 1, bag_size: 5880
batch 219, loss: 0.5866, instance_loss: 0.6193, weighted_loss: 0.5964, label: 0, bag_size: 5375
batch 239, loss: 0.5820, instance_loss: 0.5274, weighted_loss: 0.5657, label: 1, bag_size: 2743
batch 259, loss: 0.1012, instance_loss: 0.3465, weighted_loss: 0.1748, label: 1, bag_size: 1807
batch 279, loss: 1.3689, instance_loss: 1.0098, weighted_loss: 1.2612, label: 2, bag_size: 4316
batch 299, loss: 0.5351, instance_loss: 0.7599, weighted_loss: 0.6026, label: 2, bag_size: 1050
batch 319, loss: 0.3778, instance_loss: 0.2830, weighted_loss: 0.3494, label: 2, bag_size: 2561
batch 339, loss: 0.0038, instance_loss: 0.0631, weighted_loss: 0.0216, label: 2, bag_size: 657
batch 359, loss: 0.4793, instance_loss: 0.4305, weighted_loss: 0.4646, label: 2, bag_size: 4096
batch 379, loss: 0.0690, instance_loss: 0.2380, weighted_loss: 0.1197, label: 0, bag_size: 1174
batch 399, loss: 0.0911, instance_loss: 0.3153, weighted_loss: 0.1583, label: 0, bag_size: 3289
batch 419, loss: 0.0389, instance_loss: 0.1708, weighted_loss: 0.0784, label: 0, bag_size: 4332
batch 439, loss: 0.0337, instance_loss: 0.1499, weighted_loss: 0.0686, label: 2, bag_size: 6644
batch 459, loss: 0.4508, instance_loss: 0.9501, weighted_loss: 0.6006, label: 2, bag_size: 223
batch 479, loss: 0.0194, instance_loss: 0.0674, weighted_loss: 0.0338, label: 0, bag_size: 3872
batch 499, loss: 1.0523, instance_loss: 0.7674, weighted_loss: 0.9669, label: 2, bag_size: 4910
batch 519, loss: 0.5827, instance_loss: 0.4273, weighted_loss: 0.5361, label: 2, bag_size: 597
batch 539, loss: 0.7071, instance_loss: 0.3210, weighted_loss: 0.5913, label: 0, bag_size: 4146
batch 559, loss: 0.0066, instance_loss: 0.1770, weighted_loss: 0.0577, label: 1, bag_size: 3127
batch 579, loss: 0.4304, instance_loss: 0.5762, weighted_loss: 0.4742, label: 0, bag_size: 6252
batch 599, loss: 0.0024, instance_loss: 0.2354, weighted_loss: 0.0723, label: 1, bag_size: 2493
batch 619, loss: 0.0246, instance_loss: 0.2839, weighted_loss: 0.1024, label: 2, bag_size: 88
batch 639, loss: 0.5632, instance_loss: 0.6947, weighted_loss: 0.6027, label: 0, bag_size: 313
batch 659, loss: 0.0128, instance_loss: 0.1002, weighted_loss: 0.0390, label: 0, bag_size: 5036
batch 679, loss: 0.0096, instance_loss: 0.6446, weighted_loss: 0.2001, label: 1, bag_size: 3677
batch 699, loss: 0.5786, instance_loss: 0.6152, weighted_loss: 0.5896, label: 1, bag_size: 1528
batch 719, loss: 0.2977, instance_loss: 0.4812, weighted_loss: 0.3528, label: 2, bag_size: 2486
batch 739, loss: 0.1046, instance_loss: 0.4737, weighted_loss: 0.2154, label: 0, bag_size: 3219


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.4437919463087248: correct 2645/5960
Epoch: 72, train_loss: 0.4765, train_clustering_loss:  0.5000, train_error: 0.2000
class 0: acc 0.8346456692913385, correct 212/254
class 1: acc 0.6867469879518072, correct 171/249
class 2: acc 0.8801652892561983, correct 213/242

Val Set, val_loss: 0.6818, val_error: 0.2553, auc: 0.9092
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.47606382978723405: correct 358/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.2018, instance_loss: 0.8552, weighted_loss: 1.0978, label: 0, bag_size: 1755
batch 39, loss: 1.1376, instance_loss: 0.8723, weighted_loss: 1.0580, label: 1, bag_size: 2747
batch 59, loss: 1.1610, instance_loss: 0.6214, weighted_loss: 0.9991, label: 2, bag_size: 4096
batch 79, loss: 0.2923, instance_loss: 0.4289, weighted_loss: 0.3333, label: 2, bag_size: 4132
batch 99, loss: 0.1801, instance_loss: 0.5193, weighted_loss: 0.2818, label: 1, bag_size: 6152
batch 119, loss: 0.5551, instance_loss: 0.8193, weighted_loss: 0.6343, label: 2, bag_size: 4571
batch 139, loss: 0.0721, instance_loss: 0.1231, weighted_loss: 0.0874, label: 0, bag_size: 4831
batch 159, loss: 0.4479, instance_loss: 0.3311, weighted_loss: 0.4128, label: 0, bag_size: 3224
batch 179, loss: 1.8961, instance_loss: 0.9857, weighted_loss: 1.6230, label: 1, bag_size: 2614
batch 199, loss: 0.1040, instance_loss: 0.2285, weighted_loss: 0.1414, label: 2, bag_size: 3174
batch 219, loss: 0.8108, instance_loss: 0.5955, weighted_loss: 0.7462, label: 2, bag_size: 5072
batch 239, loss: 0.0267, instance_loss: 0.2902, weighted_loss: 0.1058, label: 2, bag_size: 2770
batch 259, loss: 0.0106, instance_loss: 0.0899, weighted_loss: 0.0344, label: 2, bag_size: 4569
batch 279, loss: 0.5971, instance_loss: 0.3282, weighted_loss: 0.5164, label: 1, bag_size: 2945
batch 299, loss: 0.2758, instance_loss: 0.2632, weighted_loss: 0.2720, label: 2, bag_size: 4096
batch 319, loss: 0.6637, instance_loss: 0.7591, weighted_loss: 0.6923, label: 1, bag_size: 3746
batch 339, loss: 0.0915, instance_loss: 0.2823, weighted_loss: 0.1488, label: 0, bag_size: 5036
batch 359, loss: 0.0000, instance_loss: 0.0198, weighted_loss: 0.0059, label: 1, bag_size: 5018
batch 379, loss: 1.4132, instance_loss: 0.9764, weighted_loss: 1.2821, label: 2, bag_size: 1513
batch 399, loss: 0.0611, instance_loss: 0.2647, weighted_loss: 0.1222, label: 2, bag_size: 3174
batch 419, loss: 0.0123, instance_loss: 0.1059, weighted_loss: 0.0404, label: 2, bag_size: 4775
batch 439, loss: 0.0282, instance_loss: 0.3654, weighted_loss: 0.1293, label: 1, bag_size: 3265
batch 459, loss: 0.1116, instance_loss: 0.3425, weighted_loss: 0.1809, label: 2, bag_size: 6644
batch 479, loss: 0.0073, instance_loss: 0.0955, weighted_loss: 0.0338, label: 2, bag_size: 3415
batch 499, loss: 0.0483, instance_loss: 0.4436, weighted_loss: 0.1669, label: 1, bag_size: 4395
batch 519, loss: 1.2551, instance_loss: 0.7819, weighted_loss: 1.1131, label: 2, bag_size: 5037
batch 539, loss: 0.0091, instance_loss: 0.0836, weighted_loss: 0.0314, label: 0, bag_size: 1640
batch 559, loss: 0.0037, instance_loss: 0.2863, weighted_loss: 0.0885, label: 0, bag_size: 5837
batch 579, loss: 0.0081, instance_loss: 0.2759, weighted_loss: 0.0884, label: 1, bag_size: 3127
batch 599, loss: 0.0378, instance_loss: 0.1150, weighted_loss: 0.0609, label: 0, bag_size: 2094
batch 619, loss: 0.0027, instance_loss: 0.5429, weighted_loss: 0.1647, label: 0, bag_size: 4918
batch 639, loss: 0.9619, instance_loss: 0.5314, weighted_loss: 0.8328, label: 1, bag_size: 296
batch 659, loss: 0.4657, instance_loss: 0.6406, weighted_loss: 0.5182, label: 1, bag_size: 3813
batch 679, loss: 0.0386, instance_loss: 0.1775, weighted_loss: 0.0803, label: 0, bag_size: 1233
batch 699, loss: 0.0642, instance_loss: 0.4023, weighted_loss: 0.1656, label: 1, bag_size: 3357
batch 719, loss: 0.8820, instance_loss: 0.7191, weighted_loss: 0.8331, label: 0, bag_size: 2392
batch 739, loss: 0.0541, instance_loss: 0.2869, weighted_loss: 0.1239, label: 1, bag_size: 3813


class 0 clustering acc 0.9693512304250559: correct 17332/17880
class 1 clustering acc 0.43859060402684563: correct 2614/5960
Epoch: 73, train_loss: 0.4584, train_clustering_loss:  0.4987, train_error: 0.1839
class 0: acc 0.8070175438596491, correct 184/228
class 1: acc 0.7604562737642585, correct 200/263
class 2: acc 0.8818897637795275, correct 224/254

Val Set, val_loss: 0.8596, val_error: 0.3723, auc: 0.9171
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.32180851063829785: correct 242/752
class 0: acc 0.5192307692307693, correct 27/52
class 1: acc 0.9666666666666667, correct 29/30
class 2: acc 0.25, correct 3/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1014, instance_loss: 0.3458, weighted_loss: 0.1747, label: 0, bag_size: 4229
batch 39, loss: 0.0311, instance_loss: 0.0861, weighted_loss: 0.0476, label: 0, bag_size: 4544
batch 59, loss: 0.0000, instance_loss: 0.0616, weighted_loss: 0.0185, label: 1, bag_size: 5018
batch 79, loss: 0.0338, instance_loss: 0.8334, weighted_loss: 0.2737, label: 2, bag_size: 5426
batch 99, loss: 0.2627, instance_loss: 0.2667, weighted_loss: 0.2639, label: 0, bag_size: 2850
batch 119, loss: 0.4829, instance_loss: 0.6026, weighted_loss: 0.5188, label: 2, bag_size: 6298
batch 139, loss: 0.7330, instance_loss: 0.6342, weighted_loss: 0.7034, label: 0, bag_size: 4547
batch 159, loss: 0.1093, instance_loss: 0.2498, weighted_loss: 0.1514, label: 0, bag_size: 3864
batch 179, loss: 0.0547, instance_loss: 0.2217, weighted_loss: 0.1048, label: 0, bag_size: 1204
batch 199, loss: 0.0193, instance_loss: 0.4006, weighted_loss: 0.1337, label: 1, bag_size: 6717
batch 219, loss: 0.0245, instance_loss: 0.0934, weighted_loss: 0.0452, label: 2, bag_size: 5914
batch 239, loss: 0.4283, instance_loss: 0.4007, weighted_loss: 0.4200, label: 2, bag_size: 2770
batch 259, loss: 0.1062, instance_loss: 0.3769, weighted_loss: 0.1874, label: 2, bag_size: 3327
batch 279, loss: 0.0121, instance_loss: 0.4203, weighted_loss: 0.1346, label: 1, bag_size: 4534
batch 299, loss: 0.6193, instance_loss: 0.8862, weighted_loss: 0.6993, label: 1, bag_size: 817
batch 319, loss: 2.7889, instance_loss: 1.2360, weighted_loss: 2.3231, label: 0, bag_size: 4639
batch 339, loss: 0.1480, instance_loss: 0.3566, weighted_loss: 0.2106, label: 0, bag_size: 3155
batch 359, loss: 0.0013, instance_loss: 0.6537, weighted_loss: 0.1970, label: 1, bag_size: 3611
batch 379, loss: 0.0112, instance_loss: 0.0489, weighted_loss: 0.0225, label: 2, bag_size: 2905
batch 399, loss: 0.3227, instance_loss: 0.5119, weighted_loss: 0.3795, label: 2, bag_size: 3746
batch 419, loss: 1.0024, instance_loss: 0.7259, weighted_loss: 0.9195, label: 0, bag_size: 7315
batch 439, loss: 0.5124, instance_loss: 0.4755, weighted_loss: 0.5013, label: 2, bag_size: 2031
batch 459, loss: 0.0056, instance_loss: 0.0944, weighted_loss: 0.0323, label: 1, bag_size: 1023
batch 479, loss: 0.0787, instance_loss: 0.3224, weighted_loss: 0.1518, label: 0, bag_size: 1018
batch 499, loss: 0.2805, instance_loss: 0.5998, weighted_loss: 0.3763, label: 2, bag_size: 728
batch 519, loss: 0.0105, instance_loss: 0.1802, weighted_loss: 0.0614, label: 0, bag_size: 4494
batch 539, loss: 0.4712, instance_loss: 0.3196, weighted_loss: 0.4257, label: 1, bag_size: 368
batch 559, loss: 0.1703, instance_loss: 0.6351, weighted_loss: 0.3097, label: 2, bag_size: 7607
batch 579, loss: 0.2551, instance_loss: 0.2990, weighted_loss: 0.2683, label: 2, bag_size: 4162
batch 599, loss: 0.7552, instance_loss: 0.8947, weighted_loss: 0.7970, label: 2, bag_size: 4179
batch 619, loss: 0.0050, instance_loss: 0.0506, weighted_loss: 0.0187, label: 0, bag_size: 5500
batch 639, loss: 0.0266, instance_loss: 0.4935, weighted_loss: 0.1667, label: 0, bag_size: 1006
batch 659, loss: 0.4191, instance_loss: 0.4806, weighted_loss: 0.4375, label: 0, bag_size: 5373
batch 679, loss: 0.5699, instance_loss: 0.3494, weighted_loss: 0.5037, label: 2, bag_size: 5637
batch 699, loss: 0.0168, instance_loss: 0.1717, weighted_loss: 0.0633, label: 1, bag_size: 210
batch 719, loss: 0.0794, instance_loss: 0.1227, weighted_loss: 0.0924, label: 2, bag_size: 597
batch 739, loss: 1.0450, instance_loss: 0.8975, weighted_loss: 1.0007, label: 1, bag_size: 5340


class 0 clustering acc 0.9697986577181208: correct 17340/17880
class 1 clustering acc 0.5149328859060402: correct 3069/5960
Epoch: 74, train_loss: 0.3786, train_clustering_loss:  0.4674, train_error: 0.1638
class 0: acc 0.8467741935483871, correct 210/248
class 1: acc 0.7467248908296943, correct 171/229
class 2: acc 0.9029850746268657, correct 242/268

Val Set, val_loss: 0.5553, val_error: 0.2234, auc: 0.9117
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.48271276595744683: correct 363/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.6519, instance_loss: 0.6647, weighted_loss: 1.3558, label: 1, bag_size: 296
batch 39, loss: 0.0258, instance_loss: 0.1412, weighted_loss: 0.0604, label: 0, bag_size: 921
batch 59, loss: 0.0479, instance_loss: 0.1570, weighted_loss: 0.0806, label: 1, bag_size: 1023
batch 79, loss: 0.0002, instance_loss: 0.3742, weighted_loss: 0.1124, label: 0, bag_size: 2306
batch 99, loss: 0.0835, instance_loss: 0.6349, weighted_loss: 0.2489, label: 2, bag_size: 7607
batch 119, loss: 0.5532, instance_loss: 0.6167, weighted_loss: 0.5723, label: 0, bag_size: 7315
batch 139, loss: 0.1729, instance_loss: 0.5860, weighted_loss: 0.2969, label: 1, bag_size: 4395
batch 159, loss: 0.4684, instance_loss: 0.4368, weighted_loss: 0.4590, label: 2, bag_size: 1513
batch 179, loss: 0.0567, instance_loss: 0.1309, weighted_loss: 0.0789, label: 2, bag_size: 2997
batch 199, loss: 0.4408, instance_loss: 0.4449, weighted_loss: 0.4420, label: 2, bag_size: 1222
batch 219, loss: 0.0212, instance_loss: 0.2433, weighted_loss: 0.0878, label: 2, bag_size: 4569
batch 239, loss: 0.1077, instance_loss: 0.3933, weighted_loss: 0.1934, label: 2, bag_size: 3172
batch 259, loss: 0.4994, instance_loss: 0.4973, weighted_loss: 0.4988, label: 0, bag_size: 855
batch 279, loss: 0.0360, instance_loss: 0.3987, weighted_loss: 0.1448, label: 1, bag_size: 4253
batch 299, loss: 0.3774, instance_loss: 0.6908, weighted_loss: 0.4714, label: 0, bag_size: 2153
batch 319, loss: 0.0037, instance_loss: 0.3736, weighted_loss: 0.1147, label: 1, bag_size: 3043
batch 339, loss: 0.0240, instance_loss: 0.4786, weighted_loss: 0.1604, label: 1, bag_size: 4027
batch 359, loss: 0.0113, instance_loss: 0.3160, weighted_loss: 0.1027, label: 1, bag_size: 3437
batch 379, loss: 1.2516, instance_loss: 1.0929, weighted_loss: 1.2040, label: 0, bag_size: 15105
batch 399, loss: 2.3825, instance_loss: 1.4345, weighted_loss: 2.0981, label: 0, bag_size: 3419
batch 419, loss: 0.2953, instance_loss: 0.7412, weighted_loss: 0.4290, label: 0, bag_size: 13540
batch 439, loss: 0.0067, instance_loss: 0.0960, weighted_loss: 0.0335, label: 0, bag_size: 4741
batch 459, loss: 0.0704, instance_loss: 0.5414, weighted_loss: 0.2117, label: 1, bag_size: 3437
batch 479, loss: 2.5902, instance_loss: 0.9853, weighted_loss: 2.1087, label: 2, bag_size: 909
batch 499, loss: 2.0536, instance_loss: 1.1060, weighted_loss: 1.7693, label: 1, bag_size: 2852
batch 519, loss: 0.1649, instance_loss: 0.3164, weighted_loss: 0.2103, label: 0, bag_size: 4524
batch 539, loss: 0.1335, instance_loss: 0.2124, weighted_loss: 0.1571, label: 2, bag_size: 6644
batch 559, loss: 0.2314, instance_loss: 0.3364, weighted_loss: 0.2629, label: 2, bag_size: 552
batch 579, loss: 0.0028, instance_loss: 0.2010, weighted_loss: 0.0622, label: 0, bag_size: 1399
batch 599, loss: 0.0633, instance_loss: 0.1994, weighted_loss: 0.1042, label: 2, bag_size: 4555
batch 619, loss: 0.3458, instance_loss: 0.5969, weighted_loss: 0.4211, label: 2, bag_size: 7607
batch 639, loss: 0.0466, instance_loss: 0.2374, weighted_loss: 0.1038, label: 0, bag_size: 4282
batch 659, loss: 0.2904, instance_loss: 0.6507, weighted_loss: 0.3985, label: 1, bag_size: 2905
batch 679, loss: 0.0533, instance_loss: 0.1823, weighted_loss: 0.0920, label: 2, bag_size: 4569
batch 699, loss: 3.3700, instance_loss: 1.6304, weighted_loss: 2.8481, label: 0, bag_size: 3316
batch 719, loss: 0.2530, instance_loss: 0.3212, weighted_loss: 0.2735, label: 2, bag_size: 6298
batch 739, loss: 0.0510, instance_loss: 0.1945, weighted_loss: 0.0940, label: 2, bag_size: 3121


class 0 clustering acc 0.9659955257270694: correct 17272/17880
class 1 clustering acc 0.44546979865771813: correct 2655/5960
Epoch: 75, train_loss: 0.4584, train_clustering_loss:  0.4970, train_error: 0.1852
class 0: acc 0.831275720164609, correct 202/243
class 1: acc 0.698744769874477, correct 167/239
class 2: acc 0.9049429657794676, correct 238/263

Val Set, val_loss: 0.5979, val_error: 0.2340, auc: 0.9103
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.39095744680851063: correct 294/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3377, instance_loss: 0.8740, weighted_loss: 0.4986, label: 1, bag_size: 2905
batch 39, loss: 0.3292, instance_loss: 0.4580, weighted_loss: 0.3678, label: 1, bag_size: 1221
batch 59, loss: 0.9564, instance_loss: 0.8669, weighted_loss: 0.9295, label: 2, bag_size: 88
batch 79, loss: 0.2903, instance_loss: 0.2723, weighted_loss: 0.2849, label: 2, bag_size: 597
batch 99, loss: 0.0271, instance_loss: 0.3023, weighted_loss: 0.1096, label: 1, bag_size: 2796
batch 119, loss: 0.1075, instance_loss: 0.1624, weighted_loss: 0.1240, label: 2, bag_size: 4745
batch 139, loss: 1.1263, instance_loss: 0.8819, weighted_loss: 1.0530, label: 2, bag_size: 4316
batch 159, loss: 0.0047, instance_loss: 0.3222, weighted_loss: 0.1000, label: 2, bag_size: 4497
batch 179, loss: 0.6858, instance_loss: 0.6510, weighted_loss: 0.6753, label: 2, bag_size: 2486
batch 199, loss: 0.6278, instance_loss: 0.4910, weighted_loss: 0.5868, label: 2, bag_size: 3746
batch 219, loss: 0.2889, instance_loss: 0.6433, weighted_loss: 0.3952, label: 1, bag_size: 6025
batch 239, loss: 0.5760, instance_loss: 0.4738, weighted_loss: 0.5453, label: 0, bag_size: 999
batch 259, loss: 0.2010, instance_loss: 0.4563, weighted_loss: 0.2776, label: 0, bag_size: 5375
batch 279, loss: 1.2141, instance_loss: 0.6940, weighted_loss: 1.0581, label: 1, bag_size: 2013
batch 299, loss: 0.0938, instance_loss: 0.4420, weighted_loss: 0.1983, label: 0, bag_size: 2610
batch 319, loss: 0.0286, instance_loss: 0.1200, weighted_loss: 0.0560, label: 0, bag_size: 1947
batch 339, loss: 0.1925, instance_loss: 0.4749, weighted_loss: 0.2772, label: 2, bag_size: 3397
batch 359, loss: 0.5337, instance_loss: 0.5840, weighted_loss: 0.5488, label: 2, bag_size: 3274
batch 379, loss: 0.2104, instance_loss: 0.2386, weighted_loss: 0.2189, label: 2, bag_size: 2031
batch 399, loss: 1.9101, instance_loss: 1.3712, weighted_loss: 1.7484, label: 1, bag_size: 7176
batch 419, loss: 0.2025, instance_loss: 0.3141, weighted_loss: 0.2360, label: 0, bag_size: 4460
batch 439, loss: 0.0089, instance_loss: 0.1235, weighted_loss: 0.0433, label: 2, bag_size: 5138
batch 459, loss: 0.0747, instance_loss: 0.2862, weighted_loss: 0.1382, label: 2, bag_size: 4569
batch 479, loss: 0.2806, instance_loss: 0.4319, weighted_loss: 0.3260, label: 1, bag_size: 209
batch 499, loss: 0.0183, instance_loss: 0.0708, weighted_loss: 0.0340, label: 2, bag_size: 4088
batch 519, loss: 0.0337, instance_loss: 0.2905, weighted_loss: 0.1107, label: 2, bag_size: 3604
batch 539, loss: 1.8342, instance_loss: 1.9068, weighted_loss: 1.8560, label: 0, bag_size: 12971
batch 559, loss: 0.0107, instance_loss: 0.4074, weighted_loss: 0.1297, label: 2, bag_size: 4691
batch 579, loss: 0.5352, instance_loss: 0.4054, weighted_loss: 0.4963, label: 0, bag_size: 3402
batch 599, loss: 0.9924, instance_loss: 0.4293, weighted_loss: 0.8235, label: 2, bag_size: 4487
batch 619, loss: 0.3547, instance_loss: 0.8205, weighted_loss: 0.4944, label: 0, bag_size: 13540
batch 639, loss: 0.0025, instance_loss: 0.0226, weighted_loss: 0.0085, label: 2, bag_size: 4788
batch 659, loss: 0.1030, instance_loss: 0.4864, weighted_loss: 0.2181, label: 1, bag_size: 3391
batch 679, loss: 0.0603, instance_loss: 0.3159, weighted_loss: 0.1370, label: 2, bag_size: 4569
batch 699, loss: 0.0466, instance_loss: 0.1861, weighted_loss: 0.0884, label: 2, bag_size: 2483
batch 719, loss: 0.2700, instance_loss: 0.4835, weighted_loss: 0.3340, label: 0, bag_size: 2824
batch 739, loss: 0.0250, instance_loss: 0.1144, weighted_loss: 0.0519, label: 0, bag_size: 2339


class 0 clustering acc 0.9680648769574944: correct 17309/17880
class 1 clustering acc 0.4533557046979866: correct 2702/5960
Epoch: 76, train_loss: 0.4759, train_clustering_loss:  0.5033, train_error: 0.1866
class 0: acc 0.8064516129032258, correct 200/248
class 1: acc 0.7424892703862661, correct 173/233
class 2: acc 0.8825757575757576, correct 233/264

Val Set, val_loss: 0.5955, val_error: 0.2340, auc: 0.8995
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.43617021276595747: correct 328/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1539, instance_loss: 0.2373, weighted_loss: 0.1789, label: 2, bag_size: 3397
batch 39, loss: 0.1806, instance_loss: 0.4354, weighted_loss: 0.2570, label: 2, bag_size: 5924
batch 59, loss: 0.0597, instance_loss: 0.2862, weighted_loss: 0.1276, label: 2, bag_size: 3607
batch 79, loss: 0.9269, instance_loss: 1.1458, weighted_loss: 0.9926, label: 2, bag_size: 724
batch 99, loss: 0.5327, instance_loss: 0.3990, weighted_loss: 0.4926, label: 0, bag_size: 4509
batch 119, loss: 0.0055, instance_loss: 0.1019, weighted_loss: 0.0344, label: 0, bag_size: 1194
batch 139, loss: 0.0501, instance_loss: 0.4429, weighted_loss: 0.1680, label: 1, bag_size: 2472
batch 159, loss: 0.0245, instance_loss: 0.1884, weighted_loss: 0.0737, label: 1, bag_size: 3885
batch 179, loss: 0.0107, instance_loss: 2.1028, weighted_loss: 0.6383, label: 0, bag_size: 1814
batch 199, loss: 1.6318, instance_loss: 0.7601, weighted_loss: 1.3703, label: 2, bag_size: 3026
batch 219, loss: 0.0211, instance_loss: 0.0751, weighted_loss: 0.0373, label: 0, bag_size: 3924
batch 239, loss: 0.0417, instance_loss: 0.3131, weighted_loss: 0.1231, label: 1, bag_size: 6992
batch 259, loss: 1.4355, instance_loss: 1.3759, weighted_loss: 1.4176, label: 1, bag_size: 4694
batch 279, loss: 0.1858, instance_loss: 0.5215, weighted_loss: 0.2865, label: 2, bag_size: 552
batch 299, loss: 0.0269, instance_loss: 0.1546, weighted_loss: 0.0652, label: 2, bag_size: 4192
batch 319, loss: 1.6331, instance_loss: 0.7509, weighted_loss: 1.3685, label: 0, bag_size: 4719
batch 339, loss: 0.0167, instance_loss: 0.3740, weighted_loss: 0.1239, label: 1, bag_size: 455
batch 359, loss: 0.0080, instance_loss: 0.0665, weighted_loss: 0.0255, label: 0, bag_size: 1640
batch 379, loss: 0.0494, instance_loss: 0.2218, weighted_loss: 0.1011, label: 2, bag_size: 4691
batch 399, loss: 1.5422, instance_loss: 0.4787, weighted_loss: 1.2231, label: 1, bag_size: 3791
batch 419, loss: 0.0580, instance_loss: 0.3359, weighted_loss: 0.1413, label: 1, bag_size: 782
batch 439, loss: 0.1279, instance_loss: 0.3183, weighted_loss: 0.1851, label: 2, bag_size: 3546
batch 459, loss: 0.0085, instance_loss: 0.2926, weighted_loss: 0.0937, label: 1, bag_size: 455
batch 479, loss: 0.7668, instance_loss: 0.5381, weighted_loss: 0.6982, label: 2, bag_size: 2031
batch 499, loss: 0.1127, instance_loss: 0.3565, weighted_loss: 0.1858, label: 1, bag_size: 1595
batch 519, loss: 0.5486, instance_loss: 0.3877, weighted_loss: 0.5003, label: 1, bag_size: 578
batch 539, loss: 0.1024, instance_loss: 0.4699, weighted_loss: 0.2126, label: 1, bag_size: 5195
batch 559, loss: 1.7604, instance_loss: 0.9593, weighted_loss: 1.5201, label: 2, bag_size: 7607
batch 579, loss: 0.5373, instance_loss: 0.4671, weighted_loss: 0.5162, label: 1, bag_size: 3357
batch 599, loss: 3.5540, instance_loss: 1.5043, weighted_loss: 2.9390, label: 0, bag_size: 4032
batch 619, loss: 0.5984, instance_loss: 0.7587, weighted_loss: 0.6465, label: 2, bag_size: 5406
batch 639, loss: 0.7212, instance_loss: 0.7241, weighted_loss: 0.7220, label: 0, bag_size: 3341
batch 659, loss: 0.0000, instance_loss: 0.5846, weighted_loss: 0.1754, label: 0, bag_size: 5487
batch 679, loss: 0.1638, instance_loss: 0.4037, weighted_loss: 0.2357, label: 0, bag_size: 4509
batch 699, loss: 0.0329, instance_loss: 0.2929, weighted_loss: 0.1109, label: 0, bag_size: 4922
batch 719, loss: 0.0533, instance_loss: 0.3083, weighted_loss: 0.1298, label: 2, bag_size: 2486
batch 739, loss: 0.1362, instance_loss: 0.6430, weighted_loss: 0.2882, label: 1, bag_size: 314


class 0 clustering acc 0.963255033557047: correct 17223/17880
class 1 clustering acc 0.4738255033557047: correct 2824/5960
Epoch: 77, train_loss: 0.4282, train_clustering_loss:  0.4939, train_error: 0.1718
class 0: acc 0.8306451612903226, correct 206/248
class 1: acc 0.7756653992395437, correct 204/263
class 2: acc 0.8846153846153846, correct 207/234

Val Set, val_loss: 0.5818, val_error: 0.2234, auc: 0.9149
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.4973404255319149: correct 374/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1423, instance_loss: 0.7128, weighted_loss: 0.3135, label: 1, bag_size: 2919
batch 39, loss: 0.6254, instance_loss: 0.8637, weighted_loss: 0.6969, label: 2, bag_size: 4316
batch 59, loss: 0.3441, instance_loss: 0.4629, weighted_loss: 0.3798, label: 2, bag_size: 597
batch 79, loss: 0.8842, instance_loss: 0.8883, weighted_loss: 0.8854, label: 1, bag_size: 3508
batch 99, loss: 0.4880, instance_loss: 0.6088, weighted_loss: 0.5243, label: 0, bag_size: 11663
batch 119, loss: 0.0441, instance_loss: 0.1687, weighted_loss: 0.0815, label: 2, bag_size: 4096
batch 139, loss: 0.0778, instance_loss: 0.2206, weighted_loss: 0.1206, label: 2, bag_size: 4788
batch 159, loss: 0.0093, instance_loss: 0.3844, weighted_loss: 0.1218, label: 1, bag_size: 2643
batch 179, loss: 0.1511, instance_loss: 0.3852, weighted_loss: 0.2213, label: 0, bag_size: 1204
batch 199, loss: 0.5009, instance_loss: 0.4710, weighted_loss: 0.4919, label: 0, bag_size: 3155
batch 219, loss: 0.0046, instance_loss: 0.3137, weighted_loss: 0.0973, label: 1, bag_size: 2009
batch 239, loss: 0.1229, instance_loss: 0.3972, weighted_loss: 0.2052, label: 0, bag_size: 420
batch 259, loss: 0.4856, instance_loss: 0.9259, weighted_loss: 0.6177, label: 2, bag_size: 4910
batch 279, loss: 0.0307, instance_loss: 0.1811, weighted_loss: 0.0759, label: 0, bag_size: 5950
batch 299, loss: 0.0068, instance_loss: 0.4384, weighted_loss: 0.1363, label: 2, bag_size: 3607
batch 319, loss: 0.1193, instance_loss: 0.3626, weighted_loss: 0.1923, label: 2, bag_size: 6594
batch 339, loss: 0.0032, instance_loss: 0.0992, weighted_loss: 0.0320, label: 0, bag_size: 873
batch 359, loss: 0.1028, instance_loss: 0.2561, weighted_loss: 0.1488, label: 0, bag_size: 3986
batch 379, loss: 0.0944, instance_loss: 0.2677, weighted_loss: 0.1464, label: 2, bag_size: 4569
batch 399, loss: 0.0788, instance_loss: 0.1996, weighted_loss: 0.1150, label: 0, bag_size: 3883
batch 419, loss: 2.1150, instance_loss: 1.7934, weighted_loss: 2.0185, label: 1, bag_size: 3184
batch 439, loss: 0.2026, instance_loss: 0.7796, weighted_loss: 0.3757, label: 1, bag_size: 5728
batch 459, loss: 0.5623, instance_loss: 1.0733, weighted_loss: 0.7156, label: 1, bag_size: 6165
batch 479, loss: 0.2669, instance_loss: 0.5796, weighted_loss: 0.3607, label: 2, bag_size: 3546
batch 499, loss: 0.7929, instance_loss: 0.4449, weighted_loss: 0.6885, label: 1, bag_size: 296
batch 519, loss: 0.0848, instance_loss: 0.1976, weighted_loss: 0.1186, label: 0, bag_size: 5098
batch 539, loss: 0.0265, instance_loss: 0.6141, weighted_loss: 0.2028, label: 0, bag_size: 4529
batch 559, loss: 1.7183, instance_loss: 1.3968, weighted_loss: 1.6218, label: 1, bag_size: 4258
batch 579, loss: 1.8686, instance_loss: 1.2751, weighted_loss: 1.6905, label: 1, bag_size: 2927
batch 599, loss: 0.0028, instance_loss: 0.0237, weighted_loss: 0.0090, label: 0, bag_size: 5006
batch 619, loss: 0.0019, instance_loss: 0.0465, weighted_loss: 0.0152, label: 0, bag_size: 3438
batch 639, loss: 0.0000, instance_loss: 0.1403, weighted_loss: 0.0421, label: 1, bag_size: 4067
batch 659, loss: 0.2617, instance_loss: 0.4315, weighted_loss: 0.3127, label: 0, bag_size: 3247
batch 679, loss: 0.3908, instance_loss: 0.5517, weighted_loss: 0.4391, label: 1, bag_size: 574
batch 699, loss: 0.1500, instance_loss: 0.3947, weighted_loss: 0.2234, label: 0, bag_size: 5108
batch 719, loss: 0.0197, instance_loss: 0.1838, weighted_loss: 0.0689, label: 0, bag_size: 1233
batch 739, loss: 2.1862, instance_loss: 1.2977, weighted_loss: 1.9196, label: 2, bag_size: 3475


class 0 clustering acc 0.9692953020134228: correct 17331/17880
class 1 clustering acc 0.4761744966442953: correct 2838/5960
Epoch: 78, train_loss: 0.3982, train_clustering_loss:  0.4752, train_error: 0.1732
class 0: acc 0.8122448979591836, correct 199/245
class 1: acc 0.7416666666666667, correct 178/240
class 2: acc 0.9192307692307692, correct 239/260

Val Set, val_loss: 0.6586, val_error: 0.2660, auc: 0.9065
class 0 clustering acc 0.9295212765957447: correct 2097/2256
class 1 clustering acc 0.5186170212765957: correct 390/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0170, instance_loss: 0.0777, weighted_loss: 0.0352, label: 0, bag_size: 3533
batch 39, loss: 0.0117, instance_loss: 1.1752, weighted_loss: 0.3607, label: 1, bag_size: 3425
batch 59, loss: 0.4688, instance_loss: 0.5143, weighted_loss: 0.4825, label: 0, bag_size: 768
batch 79, loss: 1.0521, instance_loss: 0.4335, weighted_loss: 0.8665, label: 2, bag_size: 4788
batch 99, loss: 0.0133, instance_loss: 0.1760, weighted_loss: 0.0621, label: 2, bag_size: 4856
batch 119, loss: 0.1702, instance_loss: 0.3609, weighted_loss: 0.2274, label: 2, bag_size: 3604
batch 139, loss: 0.1375, instance_loss: 0.1989, weighted_loss: 0.1559, label: 2, bag_size: 4555
batch 159, loss: 0.5030, instance_loss: 0.4367, weighted_loss: 0.4831, label: 2, bag_size: 4487
batch 179, loss: 0.0476, instance_loss: 0.3582, weighted_loss: 0.1408, label: 1, bag_size: 3534
batch 199, loss: 0.1859, instance_loss: 0.7790, weighted_loss: 0.3638, label: 0, bag_size: 4070
batch 219, loss: 1.0114, instance_loss: 0.9480, weighted_loss: 0.9924, label: 1, bag_size: 3422
batch 239, loss: 0.0000, instance_loss: 1.6511, weighted_loss: 0.4953, label: 0, bag_size: 2231
batch 259, loss: 0.0867, instance_loss: 0.3197, weighted_loss: 0.1566, label: 1, bag_size: 832
batch 279, loss: 0.1139, instance_loss: 0.2786, weighted_loss: 0.1633, label: 2, bag_size: 3746
batch 299, loss: 0.3502, instance_loss: 0.4729, weighted_loss: 0.3870, label: 1, bag_size: 832
batch 319, loss: 0.0005, instance_loss: 0.6648, weighted_loss: 0.1998, label: 0, bag_size: 1808
batch 339, loss: 0.0518, instance_loss: 0.3078, weighted_loss: 0.1286, label: 1, bag_size: 758
batch 359, loss: 0.4786, instance_loss: 0.6553, weighted_loss: 0.5316, label: 2, bag_size: 22464
batch 379, loss: 0.1060, instance_loss: 0.5075, weighted_loss: 0.2265, label: 1, bag_size: 4027
batch 399, loss: 0.0636, instance_loss: 0.2654, weighted_loss: 0.1242, label: 2, bag_size: 5011
batch 419, loss: 1.0818, instance_loss: 0.9173, weighted_loss: 1.0324, label: 0, bag_size: 1944
batch 439, loss: 0.0000, instance_loss: 0.0296, weighted_loss: 0.0089, label: 1, bag_size: 4181
batch 459, loss: 0.0125, instance_loss: 0.4464, weighted_loss: 0.1427, label: 1, bag_size: 3296
batch 479, loss: 0.1363, instance_loss: 0.2670, weighted_loss: 0.1755, label: 0, bag_size: 6797
batch 499, loss: 0.0290, instance_loss: 0.1669, weighted_loss: 0.0704, label: 0, bag_size: 471
batch 519, loss: 0.0706, instance_loss: 0.2340, weighted_loss: 0.1196, label: 2, bag_size: 4535
batch 539, loss: 0.2993, instance_loss: 0.4241, weighted_loss: 0.3367, label: 0, bag_size: 999
batch 559, loss: 0.0207, instance_loss: 0.1548, weighted_loss: 0.0610, label: 2, bag_size: 3810
batch 579, loss: 0.0067, instance_loss: 0.1679, weighted_loss: 0.0551, label: 2, bag_size: 3607
batch 599, loss: 0.0727, instance_loss: 0.1652, weighted_loss: 0.1005, label: 0, bag_size: 4524
batch 619, loss: 0.1933, instance_loss: 0.9158, weighted_loss: 0.4100, label: 1, bag_size: 5195
batch 639, loss: 2.4908, instance_loss: 1.3113, weighted_loss: 2.1370, label: 0, bag_size: 603
batch 659, loss: 1.0032, instance_loss: 0.6458, weighted_loss: 0.8960, label: 2, bag_size: 4487
batch 679, loss: 0.3706, instance_loss: 0.5129, weighted_loss: 0.4133, label: 2, bag_size: 4487
batch 699, loss: 0.4005, instance_loss: 0.5441, weighted_loss: 0.4436, label: 0, bag_size: 2610
batch 719, loss: 0.0116, instance_loss: 0.5020, weighted_loss: 0.1588, label: 1, bag_size: 3611
batch 739, loss: 2.6919, instance_loss: 0.9328, weighted_loss: 2.1642, label: 2, bag_size: 2561


class 0 clustering acc 0.9680089485458613: correct 17308/17880
class 1 clustering acc 0.4716442953020134: correct 2811/5960
Epoch: 79, train_loss: 0.4207, train_clustering_loss:  0.4863, train_error: 0.1664
class 0: acc 0.856, correct 214/250
class 1: acc 0.752895752895753, correct 195/259
class 2: acc 0.8983050847457628, correct 212/236

Val Set, val_loss: 0.7436, val_error: 0.3191, auc: 0.8980
class 0 clustering acc 0.9703014184397163: correct 2189/2256
class 1 clustering acc 0.3896276595744681: correct 293/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0456, instance_loss: 0.0987, weighted_loss: 0.0615, label: 2, bag_size: 4745
batch 39, loss: 1.9900, instance_loss: 0.7752, weighted_loss: 1.6255, label: 1, bag_size: 3016
batch 59, loss: 0.0000, instance_loss: 0.3621, weighted_loss: 0.1087, label: 1, bag_size: 3156
batch 79, loss: 0.0175, instance_loss: 0.2926, weighted_loss: 0.1001, label: 0, bag_size: 4865
batch 99, loss: 0.5674, instance_loss: 0.4225, weighted_loss: 0.5239, label: 0, bag_size: 3224
batch 119, loss: 0.1096, instance_loss: 0.3687, weighted_loss: 0.1874, label: 2, bag_size: 3618
batch 139, loss: 0.3881, instance_loss: 0.4032, weighted_loss: 0.3926, label: 0, bag_size: 673
batch 159, loss: 0.0047, instance_loss: 0.1735, weighted_loss: 0.0553, label: 0, bag_size: 1245
batch 179, loss: 0.0089, instance_loss: 0.0545, weighted_loss: 0.0226, label: 2, bag_size: 4088
batch 199, loss: 1.6855, instance_loss: 1.2115, weighted_loss: 1.5433, label: 2, bag_size: 223
batch 219, loss: 3.0491, instance_loss: 1.4882, weighted_loss: 2.5808, label: 1, bag_size: 3823
batch 239, loss: 0.0245, instance_loss: 0.0787, weighted_loss: 0.0407, label: 0, bag_size: 6971
batch 259, loss: 0.0484, instance_loss: 0.1921, weighted_loss: 0.0915, label: 2, bag_size: 2481
batch 279, loss: 0.0235, instance_loss: 0.2212, weighted_loss: 0.0829, label: 0, bag_size: 3289
batch 299, loss: 0.3617, instance_loss: 0.4317, weighted_loss: 0.3827, label: 0, bag_size: 3936
batch 319, loss: 0.9272, instance_loss: 0.7683, weighted_loss: 0.8796, label: 1, bag_size: 2747
batch 339, loss: 2.2292, instance_loss: 0.9701, weighted_loss: 1.8515, label: 1, bag_size: 32
batch 359, loss: 0.9333, instance_loss: 0.8580, weighted_loss: 0.9107, label: 1, bag_size: 2747
batch 379, loss: 0.0013, instance_loss: 0.2501, weighted_loss: 0.0759, label: 1, bag_size: 3425
batch 399, loss: 0.0098, instance_loss: 0.0912, weighted_loss: 0.0342, label: 2, bag_size: 4691
batch 419, loss: 0.3217, instance_loss: 0.3110, weighted_loss: 0.3185, label: 0, bag_size: 2671
batch 439, loss: 0.1767, instance_loss: 0.5098, weighted_loss: 0.2767, label: 0, bag_size: 2826
batch 459, loss: 0.8965, instance_loss: 0.4770, weighted_loss: 0.7707, label: 0, bag_size: 4717
batch 479, loss: 0.0286, instance_loss: 0.8128, weighted_loss: 0.2639, label: 2, bag_size: 7607
batch 499, loss: 0.0182, instance_loss: 0.2394, weighted_loss: 0.0846, label: 2, bag_size: 5914
batch 519, loss: 0.1983, instance_loss: 0.2690, weighted_loss: 0.2195, label: 1, bag_size: 758
batch 539, loss: 0.2460, instance_loss: 0.3681, weighted_loss: 0.2826, label: 0, bag_size: 5915
batch 559, loss: 0.6331, instance_loss: 0.6471, weighted_loss: 0.6373, label: 1, bag_size: 5696
batch 579, loss: 0.0004, instance_loss: 1.3442, weighted_loss: 0.4036, label: 0, bag_size: 1709
batch 599, loss: 0.0446, instance_loss: 0.1207, weighted_loss: 0.0674, label: 2, bag_size: 4569
batch 619, loss: 0.5232, instance_loss: 0.6787, weighted_loss: 0.5698, label: 2, bag_size: 1050
batch 639, loss: 0.9136, instance_loss: 0.9863, weighted_loss: 0.9354, label: 1, bag_size: 3322
batch 659, loss: 0.4587, instance_loss: 0.4701, weighted_loss: 0.4621, label: 2, bag_size: 6298
batch 679, loss: 0.8470, instance_loss: 0.7906, weighted_loss: 0.8301, label: 1, bag_size: 5276
batch 699, loss: 0.0077, instance_loss: 0.3330, weighted_loss: 0.1053, label: 1, bag_size: 3493
batch 719, loss: 0.0261, instance_loss: 0.2202, weighted_loss: 0.0844, label: 2, bag_size: 4192
batch 739, loss: 0.1193, instance_loss: 0.4845, weighted_loss: 0.2289, label: 1, bag_size: 2302


class 0 clustering acc 0.9691275167785235: correct 17328/17880
class 1 clustering acc 0.4798657718120805: correct 2860/5960
Epoch: 80, train_loss: 0.4189, train_clustering_loss:  0.4717, train_error: 0.1839
class 0: acc 0.8185328185328186, correct 212/259
class 1: acc 0.7192982456140351, correct 164/228
class 2: acc 0.8992248062015504, correct 232/258

Val Set, val_loss: 0.6754, val_error: 0.2553, auc: 0.9086
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.3670212765957447: correct 276/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0731, instance_loss: 0.3839, weighted_loss: 0.1663, label: 1, bag_size: 5385
batch 39, loss: 0.1465, instance_loss: 0.1775, weighted_loss: 0.1558, label: 0, bag_size: 5526
batch 59, loss: 2.4600, instance_loss: 0.9701, weighted_loss: 2.0131, label: 0, bag_size: 2217
batch 79, loss: 0.0009, instance_loss: 0.1282, weighted_loss: 0.0391, label: 2, bag_size: 3607
batch 99, loss: 3.9496, instance_loss: 1.3868, weighted_loss: 3.1808, label: 0, bag_size: 557
batch 119, loss: 0.7229, instance_loss: 0.6055, weighted_loss: 0.6877, label: 0, bag_size: 2915
batch 139, loss: 0.0050, instance_loss: 0.1927, weighted_loss: 0.0613, label: 0, bag_size: 3319
batch 159, loss: 2.1395, instance_loss: 0.9338, weighted_loss: 1.7778, label: 0, bag_size: 2217
batch 179, loss: 0.1503, instance_loss: 0.8808, weighted_loss: 0.3695, label: 2, bag_size: 728
batch 199, loss: 0.0250, instance_loss: 0.3497, weighted_loss: 0.1224, label: 1, bag_size: 3493
batch 219, loss: 0.0000, instance_loss: 0.1038, weighted_loss: 0.0311, label: 2, bag_size: 6148
batch 239, loss: 0.0165, instance_loss: 0.0966, weighted_loss: 0.0406, label: 2, bag_size: 6026
batch 259, loss: 0.1038, instance_loss: 0.7554, weighted_loss: 0.2993, label: 2, bag_size: 88
batch 279, loss: 0.7604, instance_loss: 0.7812, weighted_loss: 0.7667, label: 1, bag_size: 4200
batch 299, loss: 1.0111, instance_loss: 0.5362, weighted_loss: 0.8686, label: 2, bag_size: 4096
batch 319, loss: 0.2926, instance_loss: 0.3852, weighted_loss: 0.3204, label: 2, bag_size: 3080
batch 339, loss: 0.0969, instance_loss: 0.3254, weighted_loss: 0.1654, label: 1, bag_size: 700
batch 359, loss: 0.0016, instance_loss: 0.2159, weighted_loss: 0.0659, label: 1, bag_size: 2009
batch 379, loss: 0.1659, instance_loss: 0.2699, weighted_loss: 0.1971, label: 2, bag_size: 2501
batch 399, loss: 0.0315, instance_loss: 0.1379, weighted_loss: 0.0634, label: 0, bag_size: 5570
batch 419, loss: 0.0262, instance_loss: 0.1100, weighted_loss: 0.0514, label: 2, bag_size: 4056
batch 439, loss: 1.5826, instance_loss: 0.7759, weighted_loss: 1.3406, label: 1, bag_size: 14449
batch 459, loss: 0.0162, instance_loss: 0.1697, weighted_loss: 0.0623, label: 0, bag_size: 2705
batch 479, loss: 1.3061, instance_loss: 0.8731, weighted_loss: 1.1762, label: 1, bag_size: 2751
batch 499, loss: 0.1863, instance_loss: 0.2309, weighted_loss: 0.1997, label: 0, bag_size: 4300
batch 519, loss: 0.0365, instance_loss: 0.1094, weighted_loss: 0.0584, label: 2, bag_size: 6644
batch 539, loss: 0.3148, instance_loss: 0.3602, weighted_loss: 0.3284, label: 1, bag_size: 1410
batch 559, loss: 0.0763, instance_loss: 0.2776, weighted_loss: 0.1367, label: 0, bag_size: 4282
batch 579, loss: 0.0127, instance_loss: 0.0717, weighted_loss: 0.0304, label: 0, bag_size: 3406
batch 599, loss: 2.4025, instance_loss: 1.0318, weighted_loss: 1.9912, label: 0, bag_size: 3387
batch 619, loss: 1.5097, instance_loss: 1.0313, weighted_loss: 1.3662, label: 1, bag_size: 4784
batch 639, loss: 0.0245, instance_loss: 0.0872, weighted_loss: 0.0433, label: 2, bag_size: 4745
batch 659, loss: 0.0855, instance_loss: 0.3892, weighted_loss: 0.1766, label: 0, bag_size: 1270
batch 679, loss: 0.0880, instance_loss: 0.3288, weighted_loss: 0.1603, label: 1, bag_size: 758
batch 699, loss: 0.0140, instance_loss: 0.0959, weighted_loss: 0.0386, label: 0, bag_size: 4524
batch 719, loss: 0.0149, instance_loss: 0.0984, weighted_loss: 0.0399, label: 2, bag_size: 5011
batch 739, loss: 0.4548, instance_loss: 1.6602, weighted_loss: 0.8164, label: 1, bag_size: 1364


class 0 clustering acc 0.9695190156599552: correct 17335/17880
class 1 clustering acc 0.4691275167785235: correct 2796/5960
Epoch: 81, train_loss: 0.4069, train_clustering_loss:  0.4759, train_error: 0.1570
class 0: acc 0.8333333333333334, correct 210/252
class 1: acc 0.759656652360515, correct 177/233
class 2: acc 0.926923076923077, correct 241/260

Val Set, val_loss: 0.8432, val_error: 0.2766, auc: 0.8834
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.41356382978723405: correct 311/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.1915, ROC AUC: 0.9133
Test error: 0.1596, ROC AUC: 0.8899
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.3304, instance_loss: 0.6494, weighted_loss: 0.4261, label: 1, bag_size: 2744
batch 39, loss: 0.9542, instance_loss: 0.7667, weighted_loss: 0.8979, label: 0, bag_size: 2853
batch 59, loss: 0.8982, instance_loss: 0.7218, weighted_loss: 0.8453, label: 2, bag_size: 3112
batch 79, loss: 1.8702, instance_loss: 1.0720, weighted_loss: 1.6307, label: 2, bag_size: 5072
batch 99, loss: 2.1726, instance_loss: 0.7663, weighted_loss: 1.7507, label: 1, bag_size: 5340
batch 119, loss: 2.1852, instance_loss: 0.6623, weighted_loss: 1.7283, label: 0, bag_size: 6182
batch 139, loss: 0.9662, instance_loss: 0.7460, weighted_loss: 0.9001, label: 1, bag_size: 3422
batch 159, loss: 1.0419, instance_loss: 0.7161, weighted_loss: 0.9442, label: 0, bag_size: 5526
batch 179, loss: 1.3222, instance_loss: 0.8106, weighted_loss: 1.1687, label: 0, bag_size: 2824
batch 199, loss: 0.9930, instance_loss: 0.7174, weighted_loss: 0.9103, label: 2, bag_size: 3112
batch 219, loss: 2.4342, instance_loss: 1.2349, weighted_loss: 2.0744, label: 2, bag_size: 4179
batch 239, loss: 1.3888, instance_loss: 0.7743, weighted_loss: 1.2045, label: 0, bag_size: 3438
batch 259, loss: 0.7602, instance_loss: 0.7146, weighted_loss: 0.7465, label: 2, bag_size: 6001
batch 279, loss: 0.6859, instance_loss: 0.6848, weighted_loss: 0.6856, label: 2, bag_size: 1513
batch 299, loss: 0.3802, instance_loss: 0.5508, weighted_loss: 0.4313, label: 0, bag_size: 3038
batch 319, loss: 0.7877, instance_loss: 0.7567, weighted_loss: 0.7784, label: 2, bag_size: 4555
batch 339, loss: 1.4136, instance_loss: 0.8776, weighted_loss: 1.2528, label: 1, bag_size: 1854
batch 359, loss: 0.5762, instance_loss: 0.6202, weighted_loss: 0.5894, label: 1, bag_size: 14449
batch 379, loss: 0.7124, instance_loss: 0.6243, weighted_loss: 0.6860, label: 0, bag_size: 4531
batch 399, loss: 0.5740, instance_loss: 0.5912, weighted_loss: 0.5792, label: 1, bag_size: 1045
batch 419, loss: 1.0709, instance_loss: 0.8018, weighted_loss: 0.9902, label: 2, bag_size: 4140
batch 439, loss: 1.8741, instance_loss: 0.8426, weighted_loss: 1.5646, label: 2, bag_size: 728
batch 459, loss: 0.3871, instance_loss: 0.6358, weighted_loss: 0.4617, label: 2, bag_size: 4372
batch 479, loss: 1.2496, instance_loss: 0.8015, weighted_loss: 1.1152, label: 0, bag_size: 436
batch 499, loss: 1.6356, instance_loss: 0.8050, weighted_loss: 1.3864, label: 1, bag_size: 14449
batch 519, loss: 0.9960, instance_loss: 0.6207, weighted_loss: 0.8834, label: 0, bag_size: 4274
batch 539, loss: 0.7155, instance_loss: 0.7216, weighted_loss: 0.7173, label: 0, bag_size: 5899
batch 559, loss: 1.1586, instance_loss: 0.8563, weighted_loss: 1.0679, label: 1, bag_size: 1161
batch 579, loss: 0.5868, instance_loss: 0.6284, weighted_loss: 0.5992, label: 0, bag_size: 1373
batch 599, loss: 1.1393, instance_loss: 0.6041, weighted_loss: 0.9788, label: 0, bag_size: 4524
batch 619, loss: 0.8860, instance_loss: 0.6410, weighted_loss: 0.8125, label: 0, bag_size: 6927
batch 639, loss: 1.2408, instance_loss: 0.7746, weighted_loss: 1.1009, label: 1, bag_size: 2642
batch 659, loss: 0.0969, instance_loss: 0.2127, weighted_loss: 0.1316, label: 0, bag_size: 1709
batch 679, loss: 0.2866, instance_loss: 0.4414, weighted_loss: 0.3331, label: 2, bag_size: 4788
batch 699, loss: 0.2781, instance_loss: 0.4214, weighted_loss: 0.3211, label: 2, bag_size: 88
batch 719, loss: 0.8547, instance_loss: 0.7084, weighted_loss: 0.8108, label: 1, bag_size: 4467
batch 739, loss: 0.7521, instance_loss: 0.5790, weighted_loss: 0.7002, label: 0, bag_size: 6445


class 0 clustering acc 0.9973154362416108: correct 17832/17880
class 1 clustering acc 0.009228187919463088: correct 55/5960
Epoch: 0, train_loss: 0.9956, train_clustering_loss:  0.7112, train_error: 0.4765
class 0: acc 0.49809885931558934, correct 131/263
class 1: acc 0.4686192468619247, correct 112/239
class 2: acc 0.6049382716049383, correct 147/243

Val Set, val_loss: 0.7863, val_error: 0.2979, auc: 0.8027
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.25, correct 3/12
Validation loss decreased (inf --> 0.786267).  Saving model ...


batch 19, loss: 0.9379, instance_loss: 0.8558, weighted_loss: 0.9133, label: 2, bag_size: 6298
batch 39, loss: 0.6065, instance_loss: 0.8449, weighted_loss: 0.6780, label: 2, bag_size: 3810
batch 59, loss: 1.0144, instance_loss: 0.6187, weighted_loss: 0.8957, label: 1, bag_size: 1964
batch 79, loss: 0.5897, instance_loss: 0.7333, weighted_loss: 0.6328, label: 0, bag_size: 4083
batch 99, loss: 0.5738, instance_loss: 0.7918, weighted_loss: 0.6392, label: 0, bag_size: 2853
batch 119, loss: 1.2212, instance_loss: 0.7370, weighted_loss: 1.0759, label: 1, bag_size: 296
batch 139, loss: 1.0997, instance_loss: 0.8157, weighted_loss: 1.0145, label: 2, bag_size: 3604
batch 159, loss: 1.5962, instance_loss: 0.8540, weighted_loss: 1.3735, label: 0, bag_size: 2618
batch 179, loss: 0.4849, instance_loss: 0.4083, weighted_loss: 0.4619, label: 1, bag_size: 5532
batch 199, loss: 0.2314, instance_loss: 0.5411, weighted_loss: 0.3243, label: 2, bag_size: 5037
batch 219, loss: 0.3803, instance_loss: 0.4959, weighted_loss: 0.4150, label: 1, bag_size: 4192
batch 239, loss: 0.3360, instance_loss: 0.5000, weighted_loss: 0.3852, label: 2, bag_size: 2422
batch 259, loss: 0.4655, instance_loss: 0.4889, weighted_loss: 0.4725, label: 1, bag_size: 2156
batch 279, loss: 0.8570, instance_loss: 0.5920, weighted_loss: 0.7775, label: 1, bag_size: 4824
batch 299, loss: 0.6967, instance_loss: 0.8098, weighted_loss: 0.7306, label: 0, bag_size: 3601
batch 319, loss: 0.5349, instance_loss: 0.5912, weighted_loss: 0.5518, label: 0, bag_size: 3294
batch 339, loss: 0.5805, instance_loss: 0.8753, weighted_loss: 0.6690, label: 2, bag_size: 6148
batch 359, loss: 1.5266, instance_loss: 1.0248, weighted_loss: 1.3760, label: 2, bag_size: 1543
batch 379, loss: 1.3066, instance_loss: 0.9147, weighted_loss: 1.1891, label: 0, bag_size: 3904
batch 399, loss: 0.6730, instance_loss: 0.5529, weighted_loss: 0.6369, label: 2, bag_size: 4342
batch 419, loss: 0.3390, instance_loss: 0.6466, weighted_loss: 0.4313, label: 2, bag_size: 4497
batch 439, loss: 1.7416, instance_loss: 0.8781, weighted_loss: 1.4825, label: 2, bag_size: 4291
batch 459, loss: 0.7895, instance_loss: 0.5390, weighted_loss: 0.7144, label: 1, bag_size: 5167
batch 479, loss: 0.7220, instance_loss: 0.4645, weighted_loss: 0.6447, label: 1, bag_size: 3534
batch 499, loss: 1.9626, instance_loss: 0.9144, weighted_loss: 1.6482, label: 2, bag_size: 3475
batch 519, loss: 0.2121, instance_loss: 0.4487, weighted_loss: 0.2831, label: 2, bag_size: 4223
batch 539, loss: 0.2465, instance_loss: 0.4404, weighted_loss: 0.3047, label: 1, bag_size: 2092
batch 559, loss: 0.2376, instance_loss: 0.4867, weighted_loss: 0.3123, label: 0, bag_size: 1655
batch 579, loss: 0.1504, instance_loss: 0.3763, weighted_loss: 0.2182, label: 0, bag_size: 4783
batch 599, loss: 0.7757, instance_loss: 0.5365, weighted_loss: 0.7040, label: 0, bag_size: 4105
batch 619, loss: 0.9562, instance_loss: 0.5936, weighted_loss: 0.8474, label: 1, bag_size: 4784
batch 639, loss: 0.0965, instance_loss: 0.3706, weighted_loss: 0.1787, label: 1, bag_size: 3425
batch 659, loss: 1.5124, instance_loss: 0.9690, weighted_loss: 1.3494, label: 2, bag_size: 4342
batch 679, loss: 0.5461, instance_loss: 0.6162, weighted_loss: 0.5671, label: 1, bag_size: 4119
batch 699, loss: 1.3499, instance_loss: 1.0167, weighted_loss: 1.2499, label: 2, bag_size: 3604
batch 719, loss: 1.1166, instance_loss: 0.7935, weighted_loss: 1.0197, label: 1, bag_size: 3100
batch 739, loss: 0.6635, instance_loss: 0.6018, weighted_loss: 0.6450, label: 1, bag_size: 2998


class 0 clustering acc 0.9957494407158837: correct 17804/17880
class 1 clustering acc 0.020134228187919462: correct 120/5960
Epoch: 1, train_loss: 0.9023, train_clustering_loss:  0.6860, train_error: 0.4000
class 0: acc 0.5813008130081301, correct 143/246
class 1: acc 0.5789473684210527, correct 154/266
class 2: acc 0.6437768240343348, correct 150/233

Val Set, val_loss: 0.9072, val_error: 0.4255, auc: 0.7909
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3263, instance_loss: 0.6558, weighted_loss: 0.4252, label: 2, bag_size: 2049
batch 39, loss: 0.8710, instance_loss: 0.8901, weighted_loss: 0.8767, label: 0, bag_size: 2824
batch 59, loss: 0.2870, instance_loss: 0.4977, weighted_loss: 0.3502, label: 2, bag_size: 2483
batch 79, loss: 0.3438, instance_loss: 0.4594, weighted_loss: 0.3785, label: 1, bag_size: 800
batch 99, loss: 1.6140, instance_loss: 0.9786, weighted_loss: 1.4234, label: 2, bag_size: 4342
batch 119, loss: 0.5281, instance_loss: 0.5425, weighted_loss: 0.5324, label: 0, bag_size: 6765
batch 139, loss: 0.7136, instance_loss: 0.4860, weighted_loss: 0.6453, label: 2, bag_size: 4088
batch 159, loss: 0.4871, instance_loss: 0.6965, weighted_loss: 0.5499, label: 2, bag_size: 4372
batch 179, loss: 0.2164, instance_loss: 0.3935, weighted_loss: 0.2695, label: 1, bag_size: 1836
batch 199, loss: 0.1117, instance_loss: 0.4444, weighted_loss: 0.2115, label: 2, bag_size: 4056
batch 219, loss: 0.1535, instance_loss: 0.4257, weighted_loss: 0.2351, label: 0, bag_size: 2019
batch 239, loss: 0.5288, instance_loss: 0.5884, weighted_loss: 0.5466, label: 1, bag_size: 3755
batch 259, loss: 0.7427, instance_loss: 0.7008, weighted_loss: 0.7301, label: 0, bag_size: 15388
batch 279, loss: 2.0619, instance_loss: 0.9873, weighted_loss: 1.7395, label: 1, bag_size: 4258
batch 299, loss: 0.1985, instance_loss: 0.6600, weighted_loss: 0.3369, label: 1, bag_size: 3460
batch 319, loss: 0.2091, instance_loss: 0.4023, weighted_loss: 0.2670, label: 1, bag_size: 2767
batch 339, loss: 1.1287, instance_loss: 0.7359, weighted_loss: 1.0108, label: 0, bag_size: 2153
batch 359, loss: 0.8198, instance_loss: 0.6877, weighted_loss: 0.7802, label: 1, bag_size: 7176
batch 379, loss: 0.0567, instance_loss: 0.4895, weighted_loss: 0.1865, label: 2, bag_size: 4856
batch 399, loss: 0.2494, instance_loss: 0.7300, weighted_loss: 0.3936, label: 1, bag_size: 5026
batch 419, loss: 0.2744, instance_loss: 0.6766, weighted_loss: 0.3950, label: 0, bag_size: 855
batch 439, loss: 0.3372, instance_loss: 0.5698, weighted_loss: 0.4070, label: 2, bag_size: 5017
batch 459, loss: 0.8205, instance_loss: 0.8865, weighted_loss: 0.8403, label: 2, bag_size: 4302
batch 479, loss: 0.7677, instance_loss: 0.6097, weighted_loss: 0.7203, label: 1, bag_size: 4960
batch 499, loss: 0.6796, instance_loss: 0.6522, weighted_loss: 0.6714, label: 0, bag_size: 1034
batch 519, loss: 0.7182, instance_loss: 0.6436, weighted_loss: 0.6958, label: 1, bag_size: 4373
batch 539, loss: 0.6681, instance_loss: 0.5890, weighted_loss: 0.6443, label: 1, bag_size: 3296
batch 559, loss: 0.2326, instance_loss: 0.4128, weighted_loss: 0.2867, label: 2, bag_size: 2905
batch 579, loss: 0.9460, instance_loss: 0.6117, weighted_loss: 0.8457, label: 2, bag_size: 3534
batch 599, loss: 0.8126, instance_loss: 0.7101, weighted_loss: 0.7818, label: 1, bag_size: 3106
batch 619, loss: 1.5278, instance_loss: 0.8598, weighted_loss: 1.3274, label: 1, bag_size: 1580
batch 639, loss: 0.3814, instance_loss: 0.5265, weighted_loss: 0.4249, label: 0, bag_size: 5373
batch 659, loss: 2.1402, instance_loss: 0.9855, weighted_loss: 1.7938, label: 1, bag_size: 5035
batch 679, loss: 0.1448, instance_loss: 0.3675, weighted_loss: 0.2116, label: 2, bag_size: 5637
batch 699, loss: 0.8430, instance_loss: 0.7665, weighted_loss: 0.8200, label: 1, bag_size: 5412
batch 719, loss: 0.4558, instance_loss: 0.4181, weighted_loss: 0.4444, label: 2, bag_size: 4096
batch 739, loss: 0.1150, instance_loss: 0.4038, weighted_loss: 0.2016, label: 1, bag_size: 4134


class 0 clustering acc 0.9946308724832215: correct 17784/17880
class 1 clustering acc 0.024328859060402684: correct 145/5960
Epoch: 2, train_loss: 0.8000, train_clustering_loss:  0.6686, train_error: 0.3369
class 0: acc 0.6639004149377593, correct 160/241
class 1: acc 0.5427350427350427, correct 127/234
class 2: acc 0.7666666666666667, correct 207/270

Val Set, val_loss: 1.0042, val_error: 0.4787, auc: 0.7535
class 0 clustering acc 0.9964539007092199: correct 2248/2256
class 1 clustering acc 0.0199468085106383: correct 15/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4029, instance_loss: 0.5953, weighted_loss: 0.4606, label: 1, bag_size: 4119
batch 39, loss: 0.5602, instance_loss: 0.5496, weighted_loss: 0.5570, label: 1, bag_size: 4438
batch 59, loss: 1.0498, instance_loss: 0.6924, weighted_loss: 0.9425, label: 1, bag_size: 2083
batch 79, loss: 0.2242, instance_loss: 0.2305, weighted_loss: 0.2261, label: 0, bag_size: 5226
batch 99, loss: 0.3511, instance_loss: 0.5731, weighted_loss: 0.4177, label: 2, bag_size: 3396
batch 119, loss: 1.5246, instance_loss: 0.9237, weighted_loss: 1.3443, label: 0, bag_size: 2896
batch 139, loss: 0.4107, instance_loss: 0.7144, weighted_loss: 0.5018, label: 0, bag_size: 4479
batch 159, loss: 0.6450, instance_loss: 0.6343, weighted_loss: 0.6418, label: 0, bag_size: 4274
batch 179, loss: 0.3677, instance_loss: 0.6320, weighted_loss: 0.4470, label: 2, bag_size: 4291
batch 199, loss: 1.0784, instance_loss: 0.9119, weighted_loss: 1.0284, label: 1, bag_size: 455
batch 219, loss: 0.3539, instance_loss: 0.5506, weighted_loss: 0.4129, label: 0, bag_size: 3408
batch 239, loss: 1.0852, instance_loss: 0.8566, weighted_loss: 1.0166, label: 1, bag_size: 4346
batch 259, loss: 0.2318, instance_loss: 0.4438, weighted_loss: 0.2954, label: 0, bag_size: 3797
batch 279, loss: 1.1965, instance_loss: 0.9494, weighted_loss: 1.1224, label: 0, bag_size: 2044
batch 299, loss: 0.3191, instance_loss: 0.4526, weighted_loss: 0.3591, label: 0, bag_size: 6015
batch 319, loss: 0.2260, instance_loss: 0.3152, weighted_loss: 0.2528, label: 2, bag_size: 2501
batch 339, loss: 0.1120, instance_loss: 0.7441, weighted_loss: 0.3016, label: 2, bag_size: 6148
batch 359, loss: 0.5629, instance_loss: 0.5301, weighted_loss: 0.5531, label: 1, bag_size: 4960
batch 379, loss: 0.8260, instance_loss: 1.1230, weighted_loss: 0.9151, label: 2, bag_size: 6644
batch 399, loss: 1.8333, instance_loss: 0.7861, weighted_loss: 1.5191, label: 1, bag_size: 5197
batch 419, loss: 0.4134, instance_loss: 0.5773, weighted_loss: 0.4626, label: 0, bag_size: 2927
batch 439, loss: 0.2753, instance_loss: 0.5864, weighted_loss: 0.3686, label: 2, bag_size: 4487
batch 459, loss: 0.1946, instance_loss: 0.5016, weighted_loss: 0.2867, label: 1, bag_size: 5018
batch 479, loss: 0.7496, instance_loss: 0.6161, weighted_loss: 0.7095, label: 2, bag_size: 3534
batch 499, loss: 0.0767, instance_loss: 0.3258, weighted_loss: 0.1514, label: 0, bag_size: 2019
batch 519, loss: 0.6172, instance_loss: 0.4323, weighted_loss: 0.5618, label: 1, bag_size: 3604
batch 539, loss: 2.6668, instance_loss: 1.1439, weighted_loss: 2.2099, label: 0, bag_size: 3316
batch 559, loss: 1.3405, instance_loss: 0.6615, weighted_loss: 1.1368, label: 1, bag_size: 3644
batch 579, loss: 1.0303, instance_loss: 0.7941, weighted_loss: 0.9594, label: 2, bag_size: 3778
batch 599, loss: 0.6390, instance_loss: 0.6429, weighted_loss: 0.6402, label: 0, bag_size: 3833
batch 619, loss: 0.3202, instance_loss: 0.4360, weighted_loss: 0.3550, label: 0, bag_size: 4458
batch 639, loss: 0.6959, instance_loss: 0.5638, weighted_loss: 0.6562, label: 0, bag_size: 4147
batch 659, loss: 0.0434, instance_loss: 0.2825, weighted_loss: 0.1151, label: 2, bag_size: 3121
batch 679, loss: 0.2799, instance_loss: 0.3535, weighted_loss: 0.3020, label: 2, bag_size: 4691
batch 699, loss: 1.0918, instance_loss: 0.9373, weighted_loss: 1.0454, label: 0, bag_size: 4460
batch 719, loss: 1.4209, instance_loss: 0.7505, weighted_loss: 1.2198, label: 1, bag_size: 5205
batch 739, loss: 0.8435, instance_loss: 0.5788, weighted_loss: 0.7641, label: 1, bag_size: 2744


class 0 clustering acc 0.9912192393736018: correct 17723/17880
class 1 clustering acc 0.07449664429530202: correct 444/5960
Epoch: 3, train_loss: 0.8011, train_clustering_loss:  0.6487, train_error: 0.3597
class 0: acc 0.6184738955823293, correct 154/249
class 1: acc 0.5447154471544715, correct 134/246
class 2: acc 0.756, correct 189/250

Val Set, val_loss: 0.8742, val_error: 0.4362, auc: 0.7548
class 0 clustering acc 0.9995567375886525: correct 2255/2256
class 1 clustering acc 0.0199468085106383: correct 15/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6022, instance_loss: 0.6615, weighted_loss: 0.6200, label: 0, bag_size: 4721
batch 39, loss: 0.8313, instance_loss: 0.6696, weighted_loss: 0.7828, label: 1, bag_size: 4824
batch 59, loss: 0.7792, instance_loss: 0.7389, weighted_loss: 0.7671, label: 2, bag_size: 5743
batch 79, loss: 0.0020, instance_loss: 0.0706, weighted_loss: 0.0226, label: 0, bag_size: 1106
batch 99, loss: 0.7608, instance_loss: 0.5993, weighted_loss: 0.7124, label: 2, bag_size: 3534
batch 119, loss: 0.0525, instance_loss: 0.3750, weighted_loss: 0.1493, label: 2, bag_size: 2561
batch 139, loss: 0.8251, instance_loss: 0.8387, weighted_loss: 0.8292, label: 2, bag_size: 2486
batch 159, loss: 1.0402, instance_loss: 0.9944, weighted_loss: 1.0265, label: 1, bag_size: 2751
batch 179, loss: 0.0001, instance_loss: 0.0769, weighted_loss: 0.0231, label: 0, bag_size: 5487
batch 199, loss: 0.1759, instance_loss: 0.2953, weighted_loss: 0.2117, label: 0, bag_size: 4935
batch 219, loss: 0.0693, instance_loss: 0.3567, weighted_loss: 0.1555, label: 2, bag_size: 1094
batch 239, loss: 0.7682, instance_loss: 0.7247, weighted_loss: 0.7552, label: 2, bag_size: 3172
batch 259, loss: 0.1234, instance_loss: 0.5169, weighted_loss: 0.2414, label: 0, bag_size: 2306
batch 279, loss: 0.4506, instance_loss: 0.4723, weighted_loss: 0.4571, label: 0, bag_size: 4378
batch 299, loss: 0.3300, instance_loss: 0.2770, weighted_loss: 0.3141, label: 0, bag_size: 3936
batch 319, loss: 1.8336, instance_loss: 1.0362, weighted_loss: 1.5944, label: 1, bag_size: 5880
batch 339, loss: 0.5397, instance_loss: 0.4379, weighted_loss: 0.5092, label: 0, bag_size: 3530
batch 359, loss: 0.3363, instance_loss: 0.4315, weighted_loss: 0.3649, label: 0, bag_size: 2378
batch 379, loss: 2.0455, instance_loss: 0.9689, weighted_loss: 1.7225, label: 1, bag_size: 1307
batch 399, loss: 2.6184, instance_loss: 0.9817, weighted_loss: 2.1274, label: 2, bag_size: 3475
batch 419, loss: 0.0361, instance_loss: 0.1351, weighted_loss: 0.0658, label: 0, bag_size: 1744
batch 439, loss: 0.3028, instance_loss: 0.5849, weighted_loss: 0.3874, label: 2, bag_size: 4978
batch 459, loss: 0.1223, instance_loss: 0.3009, weighted_loss: 0.1759, label: 2, bag_size: 2422
batch 479, loss: 0.2605, instance_loss: 0.6496, weighted_loss: 0.3772, label: 1, bag_size: 4027
batch 499, loss: 0.6551, instance_loss: 0.6964, weighted_loss: 0.6675, label: 1, bag_size: 1510
batch 519, loss: 0.7991, instance_loss: 0.7702, weighted_loss: 0.7905, label: 1, bag_size: 6152
batch 539, loss: 0.4244, instance_loss: 0.5458, weighted_loss: 0.4608, label: 0, bag_size: 1194
batch 559, loss: 0.9034, instance_loss: 0.7065, weighted_loss: 0.8443, label: 1, bag_size: 2859
batch 579, loss: 0.5580, instance_loss: 0.5548, weighted_loss: 0.5570, label: 1, bag_size: 683
batch 599, loss: 0.2572, instance_loss: 0.4463, weighted_loss: 0.3140, label: 1, bag_size: 8482
batch 619, loss: 0.1953, instance_loss: 0.4900, weighted_loss: 0.2837, label: 0, bag_size: 2139
batch 639, loss: 0.4426, instance_loss: 0.6280, weighted_loss: 0.4982, label: 0, bag_size: 4228
batch 659, loss: 0.5151, instance_loss: 0.7518, weighted_loss: 0.5861, label: 1, bag_size: 2796
batch 679, loss: 2.3906, instance_loss: 0.9481, weighted_loss: 1.9578, label: 0, bag_size: 1755
batch 699, loss: 1.3478, instance_loss: 0.8000, weighted_loss: 1.1835, label: 1, bag_size: 3438
batch 719, loss: 1.4435, instance_loss: 1.1399, weighted_loss: 1.3524, label: 0, bag_size: 1289
batch 739, loss: 1.9917, instance_loss: 1.0013, weighted_loss: 1.6946, label: 2, bag_size: 5406


class 0 clustering acc 0.986241610738255: correct 17634/17880
class 1 clustering acc 0.1261744966442953: correct 752/5960
Epoch: 4, train_loss: 0.7780, train_clustering_loss:  0.6350, train_error: 0.3302
class 0: acc 0.7414448669201521, correct 195/263
class 1: acc 0.484304932735426, correct 108/223
class 2: acc 0.7567567567567568, correct 196/259

Val Set, val_loss: 0.8889, val_error: 0.3617, auc: 0.7626
class 0 clustering acc 0.9915780141843972: correct 2237/2256
class 1 clustering acc 0.0625: correct 47/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2961, instance_loss: 0.9440, weighted_loss: 1.1905, label: 1, bag_size: 2229
batch 39, loss: 0.5188, instance_loss: 0.4774, weighted_loss: 0.5064, label: 1, bag_size: 5118
batch 59, loss: 1.3273, instance_loss: 0.6373, weighted_loss: 1.1203, label: 2, bag_size: 5307
batch 79, loss: 0.1866, instance_loss: 0.4106, weighted_loss: 0.2538, label: 1, bag_size: 596
batch 99, loss: 0.2788, instance_loss: 0.6745, weighted_loss: 0.3975, label: 2, bag_size: 3112
batch 119, loss: 0.5940, instance_loss: 0.6628, weighted_loss: 0.6146, label: 0, bag_size: 5330
batch 139, loss: 0.4468, instance_loss: 0.4742, weighted_loss: 0.4550, label: 1, bag_size: 3475
batch 159, loss: 1.1719, instance_loss: 0.9091, weighted_loss: 1.0930, label: 2, bag_size: 3026
batch 179, loss: 0.4635, instance_loss: 0.5055, weighted_loss: 0.4761, label: 0, bag_size: 4105
batch 199, loss: 0.0906, instance_loss: 0.3915, weighted_loss: 0.1809, label: 2, bag_size: 3327
batch 219, loss: 0.1062, instance_loss: 0.1929, weighted_loss: 0.1322, label: 2, bag_size: 4223
batch 239, loss: 3.4095, instance_loss: 1.3442, weighted_loss: 2.7899, label: 1, bag_size: 4290
batch 259, loss: 0.0686, instance_loss: 0.3252, weighted_loss: 0.1456, label: 1, bag_size: 874
batch 279, loss: 1.4412, instance_loss: 1.1194, weighted_loss: 1.3447, label: 2, bag_size: 4342
batch 299, loss: 0.2916, instance_loss: 0.5357, weighted_loss: 0.3648, label: 0, bag_size: 420
batch 319, loss: 1.9343, instance_loss: 1.0292, weighted_loss: 1.6628, label: 0, bag_size: 5840
batch 339, loss: 0.4984, instance_loss: 0.8350, weighted_loss: 0.5994, label: 0, bag_size: 3662
batch 359, loss: 0.0747, instance_loss: 0.3286, weighted_loss: 0.1509, label: 1, bag_size: 5018
batch 379, loss: 0.2335, instance_loss: 0.4788, weighted_loss: 0.3071, label: 2, bag_size: 3497
batch 399, loss: 0.4492, instance_loss: 0.5098, weighted_loss: 0.4674, label: 1, bag_size: 1394
batch 419, loss: 1.2547, instance_loss: 0.8137, weighted_loss: 1.1224, label: 1, bag_size: 2743
batch 439, loss: 0.3816, instance_loss: 0.7659, weighted_loss: 0.4969, label: 0, bag_size: 1140
batch 459, loss: 0.0456, instance_loss: 0.1759, weighted_loss: 0.0847, label: 2, bag_size: 3397
batch 479, loss: 0.1600, instance_loss: 0.4678, weighted_loss: 0.2524, label: 0, bag_size: 5337
batch 499, loss: 1.4782, instance_loss: 0.7126, weighted_loss: 1.2485, label: 2, bag_size: 4291
batch 519, loss: 1.8445, instance_loss: 0.8138, weighted_loss: 1.5353, label: 2, bag_size: 3274
batch 539, loss: 0.4941, instance_loss: 0.6125, weighted_loss: 0.5297, label: 0, bag_size: 2306
batch 559, loss: 0.2185, instance_loss: 0.4556, weighted_loss: 0.2896, label: 2, bag_size: 4487
batch 579, loss: 0.9857, instance_loss: 0.7810, weighted_loss: 0.9243, label: 0, bag_size: 3224
batch 599, loss: 0.1882, instance_loss: 0.4174, weighted_loss: 0.2569, label: 0, bag_size: 4857
batch 619, loss: 0.1162, instance_loss: 0.3835, weighted_loss: 0.1964, label: 1, bag_size: 4184
batch 639, loss: 0.1684, instance_loss: 0.1686, weighted_loss: 0.1685, label: 1, bag_size: 5229
batch 659, loss: 0.5642, instance_loss: 0.5230, weighted_loss: 0.5519, label: 1, bag_size: 3221
batch 679, loss: 0.3867, instance_loss: 0.4927, weighted_loss: 0.4185, label: 1, bag_size: 2731
batch 699, loss: 0.3605, instance_loss: 0.6951, weighted_loss: 0.4609, label: 2, bag_size: 6001
batch 719, loss: 0.5019, instance_loss: 0.4331, weighted_loss: 0.4813, label: 1, bag_size: 1599
batch 739, loss: 0.7608, instance_loss: 0.8093, weighted_loss: 0.7753, label: 2, bag_size: 22464


class 0 clustering acc 0.9828299776286353: correct 17573/17880
class 1 clustering acc 0.13238255033557048: correct 789/5960
Epoch: 5, train_loss: 0.7444, train_clustering_loss:  0.6350, train_error: 0.3275
class 0: acc 0.6411483253588517, correct 134/209
class 1: acc 0.635036496350365, correct 174/274
class 2: acc 0.7366412213740458, correct 193/262

Val Set, val_loss: 0.9834, val_error: 0.4894, auc: 0.7781
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.10106382978723404: correct 76/752
class 0: acc 0.38461538461538464, correct 20/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6161, instance_loss: 0.7240, weighted_loss: 0.6485, label: 0, bag_size: 4531
batch 39, loss: 0.4108, instance_loss: 0.4451, weighted_loss: 0.4211, label: 2, bag_size: 4088
batch 59, loss: 1.8501, instance_loss: 0.8561, weighted_loss: 1.5519, label: 2, bag_size: 705
batch 79, loss: 0.4826, instance_loss: 0.5889, weighted_loss: 0.5145, label: 0, bag_size: 2927
batch 99, loss: 0.7395, instance_loss: 0.5380, weighted_loss: 0.6790, label: 0, bag_size: 3155
batch 119, loss: 1.4545, instance_loss: 0.8986, weighted_loss: 1.2877, label: 1, bag_size: 832
batch 139, loss: 0.1160, instance_loss: 0.2070, weighted_loss: 0.1433, label: 2, bag_size: 2905
batch 159, loss: 0.2874, instance_loss: 0.5940, weighted_loss: 0.3794, label: 0, bag_size: 1545
batch 179, loss: 1.4706, instance_loss: 0.8693, weighted_loss: 1.2902, label: 1, bag_size: 1250
batch 199, loss: 0.0756, instance_loss: 0.2723, weighted_loss: 0.1346, label: 2, bag_size: 3678
batch 219, loss: 0.9296, instance_loss: 0.6187, weighted_loss: 0.8363, label: 1, bag_size: 4069
batch 239, loss: 0.4323, instance_loss: 0.5280, weighted_loss: 0.4610, label: 2, bag_size: 597
batch 259, loss: 0.7537, instance_loss: 0.8177, weighted_loss: 0.7729, label: 0, bag_size: 667
batch 279, loss: 0.3244, instance_loss: 0.3215, weighted_loss: 0.3235, label: 1, bag_size: 2767
batch 299, loss: 0.2648, instance_loss: 0.4306, weighted_loss: 0.3146, label: 2, bag_size: 3810
batch 319, loss: 0.3349, instance_loss: 0.4027, weighted_loss: 0.3552, label: 2, bag_size: 2483
batch 339, loss: 1.0829, instance_loss: 0.6671, weighted_loss: 0.9581, label: 1, bag_size: 4069
batch 359, loss: 0.1629, instance_loss: 0.3468, weighted_loss: 0.2181, label: 2, bag_size: 4978
batch 379, loss: 0.3412, instance_loss: 0.4949, weighted_loss: 0.3873, label: 0, bag_size: 5260
batch 399, loss: 1.0628, instance_loss: 0.8544, weighted_loss: 1.0003, label: 1, bag_size: 1307
batch 419, loss: 0.3092, instance_loss: 0.3443, weighted_loss: 0.3197, label: 1, bag_size: 5512
batch 439, loss: 0.7375, instance_loss: 0.8787, weighted_loss: 0.7799, label: 1, bag_size: 10399
batch 459, loss: 0.4852, instance_loss: 0.9015, weighted_loss: 0.6101, label: 0, bag_size: 7330
batch 479, loss: 0.3823, instance_loss: 0.5350, weighted_loss: 0.4281, label: 0, bag_size: 2579
batch 499, loss: 0.8498, instance_loss: 0.5090, weighted_loss: 0.7475, label: 0, bag_size: 3915
batch 519, loss: 0.1027, instance_loss: 0.2005, weighted_loss: 0.1320, label: 2, bag_size: 4088
batch 539, loss: 0.3526, instance_loss: 0.4910, weighted_loss: 0.3941, label: 1, bag_size: 3837
batch 559, loss: 0.8018, instance_loss: 0.8797, weighted_loss: 0.8252, label: 0, bag_size: 2232
batch 579, loss: 0.3441, instance_loss: 0.6009, weighted_loss: 0.4212, label: 2, bag_size: 6594
batch 599, loss: 4.6329, instance_loss: 1.8289, weighted_loss: 3.7917, label: 0, bag_size: 434
batch 619, loss: 0.2068, instance_loss: 0.3139, weighted_loss: 0.2390, label: 2, bag_size: 4223
batch 639, loss: 0.8835, instance_loss: 0.7616, weighted_loss: 0.8470, label: 0, bag_size: 4865
batch 659, loss: 0.1361, instance_loss: 0.4530, weighted_loss: 0.2311, label: 0, bag_size: 1233
batch 679, loss: 0.3338, instance_loss: 0.5120, weighted_loss: 0.3873, label: 1, bag_size: 4578
batch 699, loss: 0.9760, instance_loss: 0.8101, weighted_loss: 0.9262, label: 2, bag_size: 3227
batch 719, loss: 0.7485, instance_loss: 0.7062, weighted_loss: 0.7358, label: 1, bag_size: 4869
batch 739, loss: 1.5095, instance_loss: 0.7920, weighted_loss: 1.2943, label: 1, bag_size: 5035


class 0 clustering acc 0.9850671140939598: correct 17613/17880
class 1 clustering acc 0.14194630872483222: correct 846/5960
Epoch: 6, train_loss: 0.7180, train_clustering_loss:  0.6228, train_error: 0.3101
class 0: acc 0.7213114754098361, correct 176/244
class 1: acc 0.5483870967741935, correct 136/248
class 2: acc 0.7984189723320159, correct 202/253

Val Set, val_loss: 0.8396, val_error: 0.3511, auc: 0.7667
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.13430851063829788: correct 101/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0970, instance_loss: 0.1834, weighted_loss: 0.1229, label: 0, bag_size: 3741
batch 39, loss: 0.2569, instance_loss: 0.3268, weighted_loss: 0.2779, label: 2, bag_size: 3026
batch 59, loss: 0.0030, instance_loss: 0.1071, weighted_loss: 0.0343, label: 0, bag_size: 5053
batch 79, loss: 0.2190, instance_loss: 0.4868, weighted_loss: 0.2993, label: 1, bag_size: 758
batch 99, loss: 0.6296, instance_loss: 0.5582, weighted_loss: 0.6082, label: 2, bag_size: 6298
batch 119, loss: 0.1606, instance_loss: 0.3598, weighted_loss: 0.2204, label: 2, bag_size: 4192
batch 139, loss: 0.4813, instance_loss: 0.4657, weighted_loss: 0.4766, label: 2, bag_size: 4569
batch 159, loss: 0.2351, instance_loss: 0.2703, weighted_loss: 0.2457, label: 1, bag_size: 2870
batch 179, loss: 0.4278, instance_loss: 0.5181, weighted_loss: 0.4549, label: 2, bag_size: 3534
batch 199, loss: 1.3891, instance_loss: 0.7844, weighted_loss: 1.2077, label: 1, bag_size: 5011
batch 219, loss: 0.1470, instance_loss: 0.3633, weighted_loss: 0.2119, label: 2, bag_size: 4140
batch 239, loss: 0.1238, instance_loss: 0.3608, weighted_loss: 0.1949, label: 2, bag_size: 4569
batch 259, loss: 0.9594, instance_loss: 0.8605, weighted_loss: 0.9297, label: 0, bag_size: 609
batch 279, loss: 1.7073, instance_loss: 0.9199, weighted_loss: 1.4711, label: 0, bag_size: 4921
batch 299, loss: 1.6408, instance_loss: 0.6957, weighted_loss: 1.3572, label: 2, bag_size: 6298
batch 319, loss: 0.3675, instance_loss: 0.6616, weighted_loss: 0.4558, label: 2, bag_size: 5072
batch 339, loss: 0.1418, instance_loss: 0.2170, weighted_loss: 0.1644, label: 2, bag_size: 4096
batch 359, loss: 3.3300, instance_loss: 1.6029, weighted_loss: 2.8119, label: 1, bag_size: 2852
batch 379, loss: 0.0627, instance_loss: 0.2785, weighted_loss: 0.1275, label: 0, bag_size: 6182
batch 399, loss: 0.3903, instance_loss: 0.3668, weighted_loss: 0.3832, label: 1, bag_size: 4599
batch 419, loss: 0.4750, instance_loss: 0.8551, weighted_loss: 0.5890, label: 0, bag_size: 6015
batch 439, loss: 0.7024, instance_loss: 0.5618, weighted_loss: 0.6602, label: 1, bag_size: 4187
batch 459, loss: 0.1974, instance_loss: 0.4792, weighted_loss: 0.2819, label: 1, bag_size: 6315
batch 479, loss: 1.2317, instance_loss: 0.6854, weighted_loss: 1.0678, label: 1, bag_size: 2643
batch 499, loss: 1.5753, instance_loss: 0.7620, weighted_loss: 1.3313, label: 1, bag_size: 2083
batch 519, loss: 0.1238, instance_loss: 0.2468, weighted_loss: 0.1607, label: 0, bag_size: 3986
batch 539, loss: 0.1124, instance_loss: 0.3341, weighted_loss: 0.1789, label: 2, bag_size: 3210
batch 559, loss: 2.1760, instance_loss: 1.0334, weighted_loss: 1.8332, label: 0, bag_size: 3341
batch 579, loss: 0.6215, instance_loss: 0.6102, weighted_loss: 0.6181, label: 2, bag_size: 6298
batch 599, loss: 1.0338, instance_loss: 0.8105, weighted_loss: 0.9668, label: 1, bag_size: 2921
batch 619, loss: 0.3554, instance_loss: 0.4711, weighted_loss: 0.3901, label: 0, bag_size: 702
batch 639, loss: 0.0723, instance_loss: 0.2033, weighted_loss: 0.1116, label: 2, bag_size: 3121
batch 659, loss: 1.3708, instance_loss: 1.1394, weighted_loss: 1.3014, label: 0, bag_size: 1289
batch 679, loss: 1.4288, instance_loss: 0.9708, weighted_loss: 1.2914, label: 1, bag_size: 1558
batch 699, loss: 1.0990, instance_loss: 0.6492, weighted_loss: 0.9640, label: 0, bag_size: 4808
batch 719, loss: 0.6022, instance_loss: 0.6618, weighted_loss: 0.6201, label: 0, bag_size: 1204
batch 739, loss: 0.0477, instance_loss: 0.2658, weighted_loss: 0.1131, label: 1, bag_size: 2796


class 0 clustering acc 0.9848434004474272: correct 17609/17880
class 1 clustering acc 0.17583892617449665: correct 1048/5960
Epoch: 7, train_loss: 0.7357, train_clustering_loss:  0.6203, train_error: 0.3302
class 0: acc 0.6550218340611353, correct 150/229
class 1: acc 0.5691056910569106, correct 140/246
class 2: acc 0.774074074074074, correct 209/270

Val Set, val_loss: 0.9593, val_error: 0.3936, auc: 0.7695
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.10904255319148937: correct 82/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2271, instance_loss: 0.3410, weighted_loss: 0.2612, label: 2, bag_size: 5406
batch 39, loss: 0.2834, instance_loss: 0.7022, weighted_loss: 0.4091, label: 0, bag_size: 2927
batch 59, loss: 0.1807, instance_loss: 0.4306, weighted_loss: 0.2557, label: 2, bag_size: 3497
batch 79, loss: 0.5691, instance_loss: 0.5655, weighted_loss: 0.5680, label: 1, bag_size: 2744
batch 99, loss: 0.0601, instance_loss: 0.1820, weighted_loss: 0.0967, label: 0, bag_size: 4857
batch 119, loss: 0.3749, instance_loss: 0.4991, weighted_loss: 0.4121, label: 1, bag_size: 2494
batch 139, loss: 0.5903, instance_loss: 0.7478, weighted_loss: 0.6376, label: 2, bag_size: 2486
batch 159, loss: 0.0816, instance_loss: 0.4888, weighted_loss: 0.2038, label: 2, bag_size: 2313
batch 179, loss: 0.9521, instance_loss: 0.8154, weighted_loss: 0.9111, label: 2, bag_size: 5406
batch 199, loss: 2.7791, instance_loss: 0.9740, weighted_loss: 2.2376, label: 0, bag_size: 5867
batch 219, loss: 1.0746, instance_loss: 0.5839, weighted_loss: 0.9274, label: 2, bag_size: 1103
batch 239, loss: 0.2850, instance_loss: 0.5233, weighted_loss: 0.3565, label: 1, bag_size: 3357
batch 259, loss: 0.2485, instance_loss: 0.3475, weighted_loss: 0.2782, label: 2, bag_size: 3678
batch 279, loss: 0.2245, instance_loss: 0.3193, weighted_loss: 0.2529, label: 0, bag_size: 4855
batch 299, loss: 0.5376, instance_loss: 0.5804, weighted_loss: 0.5504, label: 1, bag_size: 6025
batch 319, loss: 0.2154, instance_loss: 0.9133, weighted_loss: 0.4247, label: 1, bag_size: 20666
batch 339, loss: 0.4890, instance_loss: 0.5853, weighted_loss: 0.5179, label: 0, bag_size: 11663
batch 359, loss: 0.6962, instance_loss: 0.6876, weighted_loss: 0.6936, label: 1, bag_size: 4644
batch 379, loss: 0.4725, instance_loss: 0.3679, weighted_loss: 0.4411, label: 0, bag_size: 5413
batch 399, loss: 0.3898, instance_loss: 0.4759, weighted_loss: 0.4157, label: 2, bag_size: 4569
batch 419, loss: 0.1608, instance_loss: 0.2622, weighted_loss: 0.1912, label: 2, bag_size: 3397
batch 439, loss: 1.1452, instance_loss: 0.8832, weighted_loss: 1.0666, label: 2, bag_size: 5743
batch 459, loss: 0.7693, instance_loss: 0.4124, weighted_loss: 0.6623, label: 2, bag_size: 705
batch 479, loss: 1.3945, instance_loss: 0.6901, weighted_loss: 1.1832, label: 0, bag_size: 4450
batch 499, loss: 0.1476, instance_loss: 0.3905, weighted_loss: 0.2205, label: 0, bag_size: 1611
batch 519, loss: 0.8117, instance_loss: 0.6744, weighted_loss: 0.7705, label: 0, bag_size: 3664
batch 539, loss: 0.3548, instance_loss: 0.5081, weighted_loss: 0.4008, label: 0, bag_size: 3793
batch 559, loss: 1.2709, instance_loss: 0.7219, weighted_loss: 1.1062, label: 0, bag_size: 1025
batch 579, loss: 0.4191, instance_loss: 0.6842, weighted_loss: 0.4986, label: 0, bag_size: 3648
batch 599, loss: 0.4296, instance_loss: 0.7412, weighted_loss: 0.5231, label: 2, bag_size: 3607
batch 619, loss: 0.0831, instance_loss: 0.2969, weighted_loss: 0.1472, label: 0, bag_size: 6221
batch 639, loss: 0.3902, instance_loss: 0.5030, weighted_loss: 0.4241, label: 0, bag_size: 1625
batch 659, loss: 0.0805, instance_loss: 0.5571, weighted_loss: 0.2235, label: 1, bag_size: 4027
batch 679, loss: 0.9235, instance_loss: 0.8583, weighted_loss: 0.9040, label: 2, bag_size: 2486
batch 699, loss: 2.2933, instance_loss: 1.1369, weighted_loss: 1.9464, label: 2, bag_size: 4316
batch 719, loss: 0.3017, instance_loss: 0.4476, weighted_loss: 0.3454, label: 2, bag_size: 2313
batch 739, loss: 0.6994, instance_loss: 0.5018, weighted_loss: 0.6401, label: 2, bag_size: 4096


class 0 clustering acc 0.9803691275167785: correct 17529/17880
class 1 clustering acc 0.175: correct 1043/5960
Epoch: 8, train_loss: 0.7517, train_clustering_loss:  0.6248, train_error: 0.3248
class 0: acc 0.744, correct 186/250
class 1: acc 0.5703125, correct 146/256
class 2: acc 0.7154811715481172, correct 171/239

Val Set, val_loss: 0.9458, val_error: 0.3830, auc: 0.7735
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.23404255319148937: correct 176/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.6777, instance_loss: 1.0192, weighted_loss: 1.4802, label: 1, bag_size: 2643
batch 39, loss: 0.2721, instance_loss: 0.3501, weighted_loss: 0.2955, label: 0, bag_size: 3188
batch 59, loss: 1.6418, instance_loss: 1.2662, weighted_loss: 1.5291, label: 1, bag_size: 20666
batch 79, loss: 0.4261, instance_loss: 0.4362, weighted_loss: 0.4291, label: 0, bag_size: 7177
batch 99, loss: 0.1972, instance_loss: 0.4019, weighted_loss: 0.2586, label: 0, bag_size: 4227
batch 119, loss: 0.5384, instance_loss: 0.5891, weighted_loss: 0.5536, label: 1, bag_size: 3422
batch 139, loss: 0.6829, instance_loss: 0.5934, weighted_loss: 0.6561, label: 0, bag_size: 1140
batch 159, loss: 0.5423, instance_loss: 0.4313, weighted_loss: 0.5090, label: 0, bag_size: 5526
batch 179, loss: 0.5550, instance_loss: 0.6554, weighted_loss: 0.5851, label: 2, bag_size: 3174
batch 199, loss: 1.0768, instance_loss: 0.9982, weighted_loss: 1.0532, label: 1, bag_size: 4869
batch 219, loss: 1.2584, instance_loss: 0.8084, weighted_loss: 1.1234, label: 0, bag_size: 4572
batch 239, loss: 0.7525, instance_loss: 0.7851, weighted_loss: 0.7622, label: 0, bag_size: 1543
batch 259, loss: 0.6091, instance_loss: 0.5657, weighted_loss: 0.5961, label: 2, bag_size: 5406
batch 279, loss: 0.3180, instance_loss: 0.4701, weighted_loss: 0.3636, label: 2, bag_size: 2359
batch 299, loss: 0.4383, instance_loss: 0.7652, weighted_loss: 0.5364, label: 2, bag_size: 4192
batch 319, loss: 0.5292, instance_loss: 0.6219, weighted_loss: 0.5570, label: 0, bag_size: 4719
batch 339, loss: 0.2476, instance_loss: 0.5474, weighted_loss: 0.3375, label: 1, bag_size: 3493
batch 359, loss: 1.0555, instance_loss: 0.9853, weighted_loss: 1.0344, label: 1, bag_size: 7176
batch 379, loss: 0.5625, instance_loss: 0.5092, weighted_loss: 0.5465, label: 2, bag_size: 2501
batch 399, loss: 0.3288, instance_loss: 0.4240, weighted_loss: 0.3574, label: 2, bag_size: 4096
batch 419, loss: 0.5045, instance_loss: 0.6074, weighted_loss: 0.5353, label: 0, bag_size: 3164
batch 439, loss: 0.9113, instance_loss: 0.8942, weighted_loss: 0.9062, label: 2, bag_size: 3604
batch 459, loss: 0.3055, instance_loss: 0.3975, weighted_loss: 0.3331, label: 0, bag_size: 5368
batch 479, loss: 0.0002, instance_loss: 0.0296, weighted_loss: 0.0090, label: 0, bag_size: 3445
batch 499, loss: 2.6469, instance_loss: 1.1650, weighted_loss: 2.2023, label: 1, bag_size: 3791
batch 519, loss: 0.5810, instance_loss: 0.4000, weighted_loss: 0.5267, label: 2, bag_size: 2501
batch 539, loss: 2.7420, instance_loss: 1.2013, weighted_loss: 2.2798, label: 2, bag_size: 4179
batch 559, loss: 0.6187, instance_loss: 0.6878, weighted_loss: 0.6395, label: 1, bag_size: 3786
batch 579, loss: 0.5825, instance_loss: 0.8329, weighted_loss: 0.6577, label: 1, bag_size: 3265
batch 599, loss: 0.7058, instance_loss: 0.7328, weighted_loss: 0.7139, label: 1, bag_size: 4644
batch 619, loss: 0.3589, instance_loss: 0.5095, weighted_loss: 0.4041, label: 0, bag_size: 4325
batch 639, loss: 1.0124, instance_loss: 0.8433, weighted_loss: 0.9616, label: 0, bag_size: 5646
batch 659, loss: 3.9256, instance_loss: 1.2423, weighted_loss: 3.1206, label: 2, bag_size: 728
batch 679, loss: 2.4677, instance_loss: 1.0656, weighted_loss: 2.0470, label: 2, bag_size: 728
batch 699, loss: 2.7324, instance_loss: 1.2531, weighted_loss: 2.2886, label: 1, bag_size: 1964
batch 719, loss: 1.0620, instance_loss: 0.8599, weighted_loss: 1.0014, label: 0, bag_size: 768
batch 739, loss: 0.6885, instance_loss: 0.6951, weighted_loss: 0.6905, label: 0, bag_size: 999


class 0 clustering acc 0.9764541387024609: correct 17459/17880
class 1 clustering acc 0.2134228187919463: correct 1272/5960
Epoch: 9, train_loss: 0.6636, train_clustering_loss:  0.6087, train_error: 0.2564
class 0: acc 0.7808764940239044, correct 196/251
class 1: acc 0.6692015209125475, correct 176/263
class 2: acc 0.7878787878787878, correct 182/231

Val Set, val_loss: 0.8383, val_error: 0.3511, auc: 0.8044
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.09973404255319149: correct 75/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2068, instance_loss: 0.5838, weighted_loss: 0.3199, label: 1, bag_size: 5385
batch 39, loss: 2.1696, instance_loss: 0.9333, weighted_loss: 1.7987, label: 0, bag_size: 877
batch 59, loss: 1.6667, instance_loss: 0.8626, weighted_loss: 1.4255, label: 1, bag_size: 4467
batch 79, loss: 0.2999, instance_loss: 0.4198, weighted_loss: 0.3359, label: 2, bag_size: 3210
batch 99, loss: 0.0601, instance_loss: 0.2105, weighted_loss: 0.1052, label: 2, bag_size: 4788
batch 119, loss: 0.7858, instance_loss: 0.6678, weighted_loss: 0.7504, label: 0, bag_size: 6249
batch 139, loss: 0.1284, instance_loss: 0.3592, weighted_loss: 0.1977, label: 0, bag_size: 4070
batch 159, loss: 0.4208, instance_loss: 0.7130, weighted_loss: 0.5084, label: 0, bag_size: 14070
batch 179, loss: 0.0437, instance_loss: 0.2191, weighted_loss: 0.0963, label: 0, bag_size: 1744
batch 199, loss: 0.9754, instance_loss: 0.7070, weighted_loss: 0.8949, label: 0, bag_size: 6249
batch 219, loss: 0.3371, instance_loss: 0.4877, weighted_loss: 0.3823, label: 0, bag_size: 5893
batch 239, loss: 0.3275, instance_loss: 0.7559, weighted_loss: 0.4560, label: 1, bag_size: 5385
batch 259, loss: 0.8272, instance_loss: 0.6780, weighted_loss: 0.7825, label: 0, bag_size: 6927
batch 279, loss: 0.0011, instance_loss: 0.2185, weighted_loss: 0.0663, label: 0, bag_size: 2306
batch 299, loss: 1.2055, instance_loss: 0.7540, weighted_loss: 1.0700, label: 1, bag_size: 3106
batch 319, loss: 0.0813, instance_loss: 0.2885, weighted_loss: 0.1434, label: 2, bag_size: 3285
batch 339, loss: 0.2308, instance_loss: 0.1720, weighted_loss: 0.2132, label: 2, bag_size: 2422
batch 359, loss: 0.3784, instance_loss: 0.5648, weighted_loss: 0.4343, label: 1, bag_size: 4119
batch 379, loss: 1.6130, instance_loss: 1.1088, weighted_loss: 1.4618, label: 2, bag_size: 2813
batch 399, loss: 0.4621, instance_loss: 0.6325, weighted_loss: 0.5132, label: 2, bag_size: 3534
batch 419, loss: 0.4376, instance_loss: 0.7437, weighted_loss: 0.5294, label: 0, bag_size: 7927
batch 439, loss: 1.5460, instance_loss: 1.1941, weighted_loss: 1.4404, label: 2, bag_size: 4241
batch 459, loss: 0.2378, instance_loss: 0.4129, weighted_loss: 0.2903, label: 2, bag_size: 2313
batch 479, loss: 0.2938, instance_loss: 0.4702, weighted_loss: 0.3467, label: 2, bag_size: 6148
batch 499, loss: 0.0554, instance_loss: 0.2360, weighted_loss: 0.1096, label: 2, bag_size: 3285
batch 519, loss: 0.1722, instance_loss: 0.4820, weighted_loss: 0.2651, label: 2, bag_size: 614
batch 539, loss: 0.0181, instance_loss: 0.3159, weighted_loss: 0.1075, label: 2, bag_size: 5138
batch 559, loss: 0.2997, instance_loss: 0.4267, weighted_loss: 0.3378, label: 1, bag_size: 800
batch 579, loss: 1.9165, instance_loss: 1.2243, weighted_loss: 1.7088, label: 0, bag_size: 893
batch 599, loss: 0.3641, instance_loss: 0.6061, weighted_loss: 0.4367, label: 0, bag_size: 4604
batch 619, loss: 0.6634, instance_loss: 0.4074, weighted_loss: 0.5866, label: 2, bag_size: 1103
batch 639, loss: 0.1067, instance_loss: 0.4657, weighted_loss: 0.2144, label: 0, bag_size: 4721
batch 659, loss: 0.1247, instance_loss: 0.3910, weighted_loss: 0.2046, label: 0, bag_size: 1018
batch 679, loss: 0.0003, instance_loss: 0.2851, weighted_loss: 0.0858, label: 0, bag_size: 2306
batch 699, loss: 0.0294, instance_loss: 0.4903, weighted_loss: 0.1677, label: 1, bag_size: 4578
batch 719, loss: 0.6718, instance_loss: 0.9549, weighted_loss: 0.7567, label: 1, bag_size: 2229
batch 739, loss: 1.2829, instance_loss: 1.0043, weighted_loss: 1.1993, label: 0, bag_size: 4201


class 0 clustering acc 0.9781879194630873: correct 17490/17880
class 1 clustering acc 0.2041946308724832: correct 1217/5960
Epoch: 10, train_loss: 0.6554, train_clustering_loss:  0.6115, train_error: 0.2819
class 0: acc 0.7241379310344828, correct 168/232
class 1: acc 0.6220472440944882, correct 158/254
class 2: acc 0.806949806949807, correct 209/259

Val Set, val_loss: 1.0218, val_error: 0.3830, auc: 0.7803
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.1023936170212766: correct 77/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2738, instance_loss: 0.3562, weighted_loss: 0.2985, label: 1, bag_size: 3156
batch 39, loss: 2.3103, instance_loss: 1.2172, weighted_loss: 1.9823, label: 1, bag_size: 869
batch 59, loss: 1.0557, instance_loss: 0.8108, weighted_loss: 0.9822, label: 0, bag_size: 1018
batch 79, loss: 0.2268, instance_loss: 0.2530, weighted_loss: 0.2347, label: 2, bag_size: 4056
batch 99, loss: 0.1039, instance_loss: 0.4564, weighted_loss: 0.2096, label: 2, bag_size: 4192
batch 119, loss: 0.2487, instance_loss: 0.6285, weighted_loss: 0.3627, label: 0, bag_size: 5036
batch 139, loss: 0.4219, instance_loss: 0.1892, weighted_loss: 0.3521, label: 2, bag_size: 2422
batch 159, loss: 1.7879, instance_loss: 1.1457, weighted_loss: 1.5952, label: 2, bag_size: 5072
batch 179, loss: 0.0939, instance_loss: 0.7803, weighted_loss: 0.2998, label: 0, bag_size: 3920
batch 199, loss: 0.4474, instance_loss: 0.7646, weighted_loss: 0.5426, label: 2, bag_size: 4291
batch 219, loss: 0.2560, instance_loss: 0.3152, weighted_loss: 0.2738, label: 2, bag_size: 4203
batch 239, loss: 1.5266, instance_loss: 1.0998, weighted_loss: 1.3985, label: 2, bag_size: 5072
batch 259, loss: 0.3743, instance_loss: 0.8596, weighted_loss: 0.5199, label: 1, bag_size: 2229
batch 279, loss: 0.1191, instance_loss: 0.4546, weighted_loss: 0.2198, label: 1, bag_size: 796
batch 299, loss: 0.4254, instance_loss: 0.4758, weighted_loss: 0.4405, label: 2, bag_size: 3121
batch 319, loss: 0.6510, instance_loss: 0.6387, weighted_loss: 0.6473, label: 0, bag_size: 2392
batch 339, loss: 0.6375, instance_loss: 0.4235, weighted_loss: 0.5733, label: 2, bag_size: 597
batch 359, loss: 0.1086, instance_loss: 0.5999, weighted_loss: 0.2560, label: 1, bag_size: 2453
batch 379, loss: 0.4842, instance_loss: 0.5656, weighted_loss: 0.5086, label: 1, bag_size: 578
batch 399, loss: 1.2580, instance_loss: 0.7275, weighted_loss: 1.0988, label: 2, bag_size: 705
batch 419, loss: 0.2018, instance_loss: 0.5992, weighted_loss: 0.3210, label: 2, bag_size: 5637
batch 439, loss: 0.0296, instance_loss: 0.1853, weighted_loss: 0.0763, label: 0, bag_size: 7595
batch 459, loss: 0.2150, instance_loss: 0.3924, weighted_loss: 0.2682, label: 0, bag_size: 598
batch 479, loss: 0.6472, instance_loss: 1.0008, weighted_loss: 0.7533, label: 1, bag_size: 2013
batch 499, loss: 0.6692, instance_loss: 0.8126, weighted_loss: 0.7122, label: 2, bag_size: 3618
batch 519, loss: 1.5638, instance_loss: 0.9510, weighted_loss: 1.3799, label: 2, bag_size: 724
batch 539, loss: 0.1725, instance_loss: 0.4062, weighted_loss: 0.2426, label: 0, bag_size: 4905
batch 559, loss: 1.3980, instance_loss: 1.0612, weighted_loss: 1.2970, label: 1, bag_size: 3791
batch 579, loss: 0.9286, instance_loss: 0.5263, weighted_loss: 0.8079, label: 2, bag_size: 3210
batch 599, loss: 1.3256, instance_loss: 0.8978, weighted_loss: 1.1973, label: 1, bag_size: 2927
batch 619, loss: 1.5425, instance_loss: 0.7809, weighted_loss: 1.3140, label: 1, bag_size: 2671
batch 639, loss: 1.1795, instance_loss: 0.8017, weighted_loss: 1.0662, label: 1, bag_size: 2743
batch 659, loss: 0.3588, instance_loss: 0.3777, weighted_loss: 0.3645, label: 0, bag_size: 3370
batch 679, loss: 0.2337, instance_loss: 0.4029, weighted_loss: 0.2845, label: 0, bag_size: 3924
batch 699, loss: 0.3464, instance_loss: 0.7561, weighted_loss: 0.4693, label: 1, bag_size: 3611
batch 719, loss: 0.1340, instance_loss: 0.2985, weighted_loss: 0.1833, label: 0, bag_size: 2286
batch 739, loss: 0.2211, instance_loss: 0.3835, weighted_loss: 0.2698, label: 0, bag_size: 4161


class 0 clustering acc 0.9772371364653244: correct 17473/17880
class 1 clustering acc 0.24446308724832214: correct 1457/5960
Epoch: 11, train_loss: 0.6997, train_clustering_loss:  0.6030, train_error: 0.2886
class 0: acc 0.7773584905660378, correct 206/265
class 1: acc 0.6032388663967612, correct 149/247
class 2: acc 0.7510729613733905, correct 175/233

Val Set, val_loss: 0.8641, val_error: 0.3511, auc: 0.7953
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.3098404255319149: correct 233/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4275, instance_loss: 0.5640, weighted_loss: 0.4685, label: 1, bag_size: 10941
batch 39, loss: 0.0990, instance_loss: 0.1053, weighted_loss: 0.1009, label: 2, bag_size: 3026
batch 59, loss: 0.8874, instance_loss: 0.7599, weighted_loss: 0.8492, label: 1, bag_size: 5873
batch 79, loss: 0.1408, instance_loss: 0.3819, weighted_loss: 0.2132, label: 0, bag_size: 3038
batch 99, loss: 1.3406, instance_loss: 0.6385, weighted_loss: 1.1300, label: 0, bag_size: 3864
batch 119, loss: 0.6329, instance_loss: 0.7611, weighted_loss: 0.6714, label: 1, bag_size: 5412
batch 139, loss: 0.2012, instance_loss: 0.3557, weighted_loss: 0.2476, label: 2, bag_size: 3678
batch 159, loss: 0.0536, instance_loss: 0.2807, weighted_loss: 0.1218, label: 2, bag_size: 3327
batch 179, loss: 0.1986, instance_loss: 0.4662, weighted_loss: 0.2789, label: 0, bag_size: 4827
batch 199, loss: 1.7217, instance_loss: 0.8402, weighted_loss: 1.4572, label: 1, bag_size: 1608
batch 219, loss: 1.7291, instance_loss: 0.7326, weighted_loss: 1.4302, label: 2, bag_size: 1543
batch 239, loss: 2.4294, instance_loss: 0.9966, weighted_loss: 1.9995, label: 1, bag_size: 2013
batch 259, loss: 1.3065, instance_loss: 1.0679, weighted_loss: 1.2349, label: 1, bag_size: 1580
batch 279, loss: 0.4291, instance_loss: 0.3804, weighted_loss: 0.4145, label: 1, bag_size: 2753
batch 299, loss: 0.2092, instance_loss: 0.4848, weighted_loss: 0.2919, label: 0, bag_size: 3188
batch 319, loss: 0.4291, instance_loss: 0.5026, weighted_loss: 0.4511, label: 1, bag_size: 2731
batch 339, loss: 1.2505, instance_loss: 0.9505, weighted_loss: 1.1605, label: 2, bag_size: 1513
batch 359, loss: 0.9811, instance_loss: 0.6475, weighted_loss: 0.8810, label: 1, bag_size: 5572
batch 379, loss: 0.3445, instance_loss: 0.5249, weighted_loss: 0.3986, label: 1, bag_size: 5086
batch 399, loss: 0.6161, instance_loss: 0.8264, weighted_loss: 0.6792, label: 1, bag_size: 4644
batch 419, loss: 0.1848, instance_loss: 0.3658, weighted_loss: 0.2391, label: 0, bag_size: 5260
batch 439, loss: 2.8059, instance_loss: 1.1672, weighted_loss: 2.3143, label: 1, bag_size: 4145
batch 459, loss: 0.2449, instance_loss: 0.5856, weighted_loss: 0.3471, label: 0, bag_size: 1662
batch 479, loss: 0.3021, instance_loss: 0.3174, weighted_loss: 0.3067, label: 1, bag_size: 5532
batch 499, loss: 0.8420, instance_loss: 0.9175, weighted_loss: 0.8646, label: 1, bag_size: 4824
batch 519, loss: 0.2968, instance_loss: 0.3706, weighted_loss: 0.3189, label: 0, bag_size: 5915
batch 539, loss: 0.0557, instance_loss: 0.1659, weighted_loss: 0.0888, label: 2, bag_size: 4856
batch 559, loss: 0.4728, instance_loss: 0.6235, weighted_loss: 0.5180, label: 0, bag_size: 2392
batch 579, loss: 1.0569, instance_loss: 0.7828, weighted_loss: 0.9747, label: 1, bag_size: 1500
batch 599, loss: 0.0771, instance_loss: 0.3584, weighted_loss: 0.1615, label: 2, bag_size: 5017
batch 619, loss: 0.2803, instance_loss: 0.6045, weighted_loss: 0.3775, label: 2, bag_size: 6594
batch 639, loss: 1.3228, instance_loss: 1.0022, weighted_loss: 1.2266, label: 1, bag_size: 2859
batch 659, loss: 2.0023, instance_loss: 0.9114, weighted_loss: 1.6750, label: 1, bag_size: 5167
batch 679, loss: 0.7556, instance_loss: 0.6767, weighted_loss: 0.7320, label: 0, bag_size: 1025
batch 699, loss: 1.0188, instance_loss: 0.6362, weighted_loss: 0.9040, label: 1, bag_size: 1250
batch 719, loss: 0.1806, instance_loss: 0.2131, weighted_loss: 0.1904, label: 2, bag_size: 1103
batch 739, loss: 0.6108, instance_loss: 0.5943, weighted_loss: 0.6058, label: 0, bag_size: 5893


class 0 clustering acc 0.9721476510067114: correct 17382/17880
class 1 clustering acc 0.28003355704697985: correct 1669/5960
Epoch: 12, train_loss: 0.6619, train_clustering_loss:  0.5834, train_error: 0.2685
class 0: acc 0.7622950819672131, correct 186/244
class 1: acc 0.601593625498008, correct 151/251
class 2: acc 0.832, correct 208/250

Val Set, val_loss: 0.9486, val_error: 0.3936, auc: 0.7922
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.11569148936170212: correct 87/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.5635, instance_loss: 0.3955, weighted_loss: 0.5131, label: 0, bag_size: 5036
batch 39, loss: 0.5781, instance_loss: 0.5998, weighted_loss: 0.5846, label: 0, bag_size: 3532
batch 59, loss: 0.7540, instance_loss: 0.3453, weighted_loss: 0.6314, label: 2, bag_size: 2422
batch 79, loss: 0.7030, instance_loss: 0.7175, weighted_loss: 0.7074, label: 0, bag_size: 1373
batch 99, loss: 0.0735, instance_loss: 0.2726, weighted_loss: 0.1332, label: 0, bag_size: 1710
batch 119, loss: 0.0641, instance_loss: 0.1266, weighted_loss: 0.0828, label: 2, bag_size: 2481
batch 139, loss: 0.1040, instance_loss: 0.5398, weighted_loss: 0.2347, label: 1, bag_size: 3677
batch 159, loss: 0.4645, instance_loss: 0.7278, weighted_loss: 0.5435, label: 1, bag_size: 2865
batch 179, loss: 1.5457, instance_loss: 1.2134, weighted_loss: 1.4460, label: 0, bag_size: 5330
batch 199, loss: 0.0029, instance_loss: 0.2619, weighted_loss: 0.0806, label: 0, bag_size: 1981
batch 219, loss: 0.0865, instance_loss: 0.2437, weighted_loss: 0.1336, label: 1, bag_size: 596
batch 239, loss: 0.2514, instance_loss: 0.4852, weighted_loss: 0.3215, label: 1, bag_size: 5086
batch 259, loss: 0.0551, instance_loss: 0.0782, weighted_loss: 0.0621, label: 2, bag_size: 4088
batch 279, loss: 0.5076, instance_loss: 0.5458, weighted_loss: 0.5191, label: 2, bag_size: 3227
batch 299, loss: 0.1426, instance_loss: 0.3760, weighted_loss: 0.2126, label: 2, bag_size: 3778
batch 319, loss: 0.5893, instance_loss: 0.8277, weighted_loss: 0.6608, label: 1, bag_size: 4940
batch 339, loss: 0.5780, instance_loss: 0.7048, weighted_loss: 0.6161, label: 1, bag_size: 2921
batch 359, loss: 1.6855, instance_loss: 1.0960, weighted_loss: 1.5086, label: 1, bag_size: 1307
batch 379, loss: 0.0132, instance_loss: 0.3533, weighted_loss: 0.1152, label: 2, bag_size: 4497
batch 399, loss: 0.0469, instance_loss: 0.2068, weighted_loss: 0.0948, label: 0, bag_size: 5337
batch 419, loss: 0.4228, instance_loss: 0.5881, weighted_loss: 0.4724, label: 1, bag_size: 578
batch 439, loss: 1.8112, instance_loss: 1.1964, weighted_loss: 1.6267, label: 1, bag_size: 11974
batch 459, loss: 0.3948, instance_loss: 0.5026, weighted_loss: 0.4271, label: 2, bag_size: 3607
batch 479, loss: 0.6281, instance_loss: 0.8197, weighted_loss: 0.6856, label: 2, bag_size: 4571
batch 499, loss: 1.5342, instance_loss: 0.9059, weighted_loss: 1.3457, label: 2, bag_size: 724
batch 519, loss: 2.0329, instance_loss: 0.9211, weighted_loss: 1.6993, label: 1, bag_size: 1510
batch 539, loss: 0.6367, instance_loss: 0.7691, weighted_loss: 0.6765, label: 2, bag_size: 4342
batch 559, loss: 1.0344, instance_loss: 1.0876, weighted_loss: 1.0503, label: 2, bag_size: 4241
batch 579, loss: 1.8941, instance_loss: 0.9771, weighted_loss: 1.6190, label: 1, bag_size: 32
batch 599, loss: 0.1257, instance_loss: 0.3560, weighted_loss: 0.1948, label: 0, bag_size: 1647
batch 619, loss: 0.1750, instance_loss: 0.1651, weighted_loss: 0.1720, label: 2, bag_size: 4569
batch 639, loss: 0.1536, instance_loss: 0.4724, weighted_loss: 0.2492, label: 0, bag_size: 4379
batch 659, loss: 0.4382, instance_loss: 0.4824, weighted_loss: 0.4514, label: 1, bag_size: 800
batch 679, loss: 1.7091, instance_loss: 1.1372, weighted_loss: 1.5375, label: 2, bag_size: 4342
batch 699, loss: 0.6587, instance_loss: 0.6098, weighted_loss: 0.6440, label: 1, bag_size: 2055
batch 719, loss: 0.3140, instance_loss: 0.4066, weighted_loss: 0.3418, label: 2, bag_size: 5637
batch 739, loss: 0.3001, instance_loss: 0.4120, weighted_loss: 0.3336, label: 2, bag_size: 5011


class 0 clustering acc 0.9761744966442953: correct 17454/17880
class 1 clustering acc 0.263255033557047: correct 1569/5960
Epoch: 13, train_loss: 0.6542, train_clustering_loss:  0.5898, train_error: 0.2644
class 0: acc 0.7457627118644068, correct 176/236
class 1: acc 0.6475409836065574, correct 158/244
class 2: acc 0.8075471698113208, correct 214/265

Val Set, val_loss: 1.0135, val_error: 0.3936, auc: 0.7956
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.09042553191489362: correct 68/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5042, instance_loss: 0.5255, weighted_loss: 0.5106, label: 0, bag_size: 3789
batch 39, loss: 0.6476, instance_loss: 0.6100, weighted_loss: 0.6364, label: 1, bag_size: 4373
batch 59, loss: 0.1164, instance_loss: 0.2063, weighted_loss: 0.1433, label: 2, bag_size: 1094
batch 79, loss: 0.1630, instance_loss: 0.5304, weighted_loss: 0.2732, label: 2, bag_size: 4555
batch 99, loss: 0.1296, instance_loss: 0.2399, weighted_loss: 0.1627, label: 2, bag_size: 2313
batch 119, loss: 0.1100, instance_loss: 0.2437, weighted_loss: 0.1501, label: 0, bag_size: 3348
batch 139, loss: 0.3760, instance_loss: 0.4148, weighted_loss: 0.3876, label: 2, bag_size: 3172
batch 159, loss: 0.3713, instance_loss: 0.3633, weighted_loss: 0.3689, label: 1, bag_size: 1599
batch 179, loss: 0.0038, instance_loss: 0.0126, weighted_loss: 0.0065, label: 0, bag_size: 5003
batch 199, loss: 0.8624, instance_loss: 0.8181, weighted_loss: 0.8491, label: 0, bag_size: 4460
batch 219, loss: 0.8506, instance_loss: 0.6343, weighted_loss: 0.7857, label: 0, bag_size: 5526
batch 239, loss: 0.4453, instance_loss: 0.5128, weighted_loss: 0.4655, label: 2, bag_size: 6644
batch 259, loss: 0.0541, instance_loss: 0.7906, weighted_loss: 0.2751, label: 1, bag_size: 3677
batch 279, loss: 0.3175, instance_loss: 0.5982, weighted_loss: 0.4017, label: 0, bag_size: 4347
batch 299, loss: 1.0858, instance_loss: 0.7322, weighted_loss: 0.9797, label: 0, bag_size: 8866
batch 319, loss: 1.1723, instance_loss: 1.1139, weighted_loss: 1.1548, label: 1, bag_size: 936
batch 339, loss: 0.5526, instance_loss: 0.7846, weighted_loss: 0.6222, label: 2, bag_size: 2813
batch 359, loss: 1.1631, instance_loss: 0.9966, weighted_loss: 1.1131, label: 0, bag_size: 1071
batch 379, loss: 0.2766, instance_loss: 0.2518, weighted_loss: 0.2691, label: 2, bag_size: 597
batch 399, loss: 0.3678, instance_loss: 0.5923, weighted_loss: 0.4351, label: 2, bag_size: 5072
batch 419, loss: 0.1365, instance_loss: 0.4918, weighted_loss: 0.2431, label: 0, bag_size: 5992
batch 439, loss: 0.1828, instance_loss: 0.5059, weighted_loss: 0.2798, label: 1, bag_size: 3534
batch 459, loss: 0.0251, instance_loss: 0.3718, weighted_loss: 0.1291, label: 1, bag_size: 5026
batch 479, loss: 1.5140, instance_loss: 0.8059, weighted_loss: 1.3016, label: 2, bag_size: 3475
batch 499, loss: 0.1273, instance_loss: 0.2312, weighted_loss: 0.1585, label: 1, bag_size: 1410
batch 519, loss: 0.8720, instance_loss: 0.6035, weighted_loss: 0.7915, label: 2, bag_size: 4487
batch 539, loss: 1.8205, instance_loss: 1.0681, weighted_loss: 1.5948, label: 0, bag_size: 1018
batch 559, loss: 0.0531, instance_loss: 0.2859, weighted_loss: 0.1229, label: 0, bag_size: 4905
batch 579, loss: 0.3768, instance_loss: 0.4627, weighted_loss: 0.4025, label: 2, bag_size: 5637
batch 599, loss: 0.8157, instance_loss: 0.7521, weighted_loss: 0.7967, label: 2, bag_size: 4316
batch 619, loss: 0.3772, instance_loss: 0.6141, weighted_loss: 0.4483, label: 2, bag_size: 5072
batch 639, loss: 0.5252, instance_loss: 0.5863, weighted_loss: 0.5435, label: 1, bag_size: 2870
batch 659, loss: 0.0441, instance_loss: 0.0994, weighted_loss: 0.0607, label: 2, bag_size: 6001
batch 679, loss: 1.4615, instance_loss: 1.0565, weighted_loss: 1.3400, label: 1, bag_size: 869
batch 699, loss: 0.2607, instance_loss: 0.5800, weighted_loss: 0.3565, label: 0, bag_size: 6015
batch 719, loss: 0.3831, instance_loss: 0.9056, weighted_loss: 0.5399, label: 1, bag_size: 10941
batch 739, loss: 0.2251, instance_loss: 0.3177, weighted_loss: 0.2529, label: 0, bag_size: 5041


class 0 clustering acc 0.974496644295302: correct 17424/17880
class 1 clustering acc 0.275: correct 1639/5960
Epoch: 14, train_loss: 0.6625, train_clustering_loss:  0.5909, train_error: 0.2899
class 0: acc 0.6877828054298643, correct 152/221
class 1: acc 0.6332046332046332, correct 164/259
class 2: acc 0.8037735849056604, correct 213/265

Val Set, val_loss: 0.9471, val_error: 0.4149, auc: 0.7789
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.2074468085106383: correct 156/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3559, instance_loss: 0.3236, weighted_loss: 0.3462, label: 2, bag_size: 2561
batch 39, loss: 1.5564, instance_loss: 0.9792, weighted_loss: 1.3832, label: 1, bag_size: 5402
batch 59, loss: 0.4679, instance_loss: 0.7151, weighted_loss: 0.5421, label: 1, bag_size: 578
batch 79, loss: 0.1524, instance_loss: 0.5123, weighted_loss: 0.2603, label: 1, bag_size: 5340
batch 99, loss: 0.1563, instance_loss: 0.4750, weighted_loss: 0.2519, label: 2, bag_size: 3604
batch 119, loss: 0.1535, instance_loss: 0.3238, weighted_loss: 0.2046, label: 1, bag_size: 2009
batch 139, loss: 0.0574, instance_loss: 0.3926, weighted_loss: 0.1580, label: 0, bag_size: 855
batch 159, loss: 0.6199, instance_loss: 0.4219, weighted_loss: 0.5605, label: 2, bag_size: 3026
batch 179, loss: 2.5639, instance_loss: 1.5351, weighted_loss: 2.2553, label: 1, bag_size: 3399
batch 199, loss: 0.2392, instance_loss: 0.6668, weighted_loss: 0.3675, label: 2, bag_size: 2770
batch 219, loss: 0.0327, instance_loss: 0.2191, weighted_loss: 0.0887, label: 0, bag_size: 1825
batch 239, loss: 0.4575, instance_loss: 0.7491, weighted_loss: 0.5450, label: 2, bag_size: 5637
batch 259, loss: 0.0725, instance_loss: 0.1958, weighted_loss: 0.1095, label: 2, bag_size: 4856
batch 279, loss: 0.6561, instance_loss: 0.7013, weighted_loss: 0.6696, label: 1, bag_size: 4940
batch 299, loss: 0.3020, instance_loss: 0.5176, weighted_loss: 0.3666, label: 0, bag_size: 5915
batch 319, loss: 1.2001, instance_loss: 0.7713, weighted_loss: 1.0714, label: 1, bag_size: 2744
batch 339, loss: 0.8306, instance_loss: 0.5102, weighted_loss: 0.7345, label: 2, bag_size: 4096
batch 359, loss: 0.3118, instance_loss: 0.4788, weighted_loss: 0.3619, label: 1, bag_size: 683
batch 379, loss: 0.2442, instance_loss: 0.5555, weighted_loss: 0.3376, label: 2, bag_size: 4372
batch 399, loss: 0.2467, instance_loss: 0.5288, weighted_loss: 0.3314, label: 2, bag_size: 3778
batch 419, loss: 0.3104, instance_loss: 0.3754, weighted_loss: 0.3299, label: 2, bag_size: 2049
batch 439, loss: 0.0475, instance_loss: 0.1844, weighted_loss: 0.0886, label: 2, bag_size: 3497
batch 459, loss: 0.1163, instance_loss: 0.4282, weighted_loss: 0.2099, label: 0, bag_size: 4251
batch 479, loss: 0.5883, instance_loss: 0.6222, weighted_loss: 0.5985, label: 1, bag_size: 5118
batch 499, loss: 0.0497, instance_loss: 0.4056, weighted_loss: 0.1565, label: 0, bag_size: 3754
batch 519, loss: 0.8434, instance_loss: 0.5538, weighted_loss: 0.7565, label: 1, bag_size: 5167
batch 539, loss: 0.6446, instance_loss: 0.6106, weighted_loss: 0.6344, label: 0, bag_size: 622
batch 559, loss: 0.5339, instance_loss: 0.4802, weighted_loss: 0.5178, label: 1, bag_size: 5572
batch 579, loss: 0.2323, instance_loss: 0.4163, weighted_loss: 0.2875, label: 0, bag_size: 1662
batch 599, loss: 0.1148, instance_loss: 0.3180, weighted_loss: 0.1757, label: 2, bag_size: 4223
batch 619, loss: 0.5990, instance_loss: 0.6491, weighted_loss: 0.6140, label: 2, bag_size: 4569
batch 639, loss: 0.4343, instance_loss: 0.6092, weighted_loss: 0.4868, label: 1, bag_size: 5718
batch 659, loss: 0.0007, instance_loss: 0.1089, weighted_loss: 0.0331, label: 1, bag_size: 5018
batch 679, loss: 0.3432, instance_loss: 1.3141, weighted_loss: 0.6345, label: 0, bag_size: 4070
batch 699, loss: 1.8765, instance_loss: 0.8420, weighted_loss: 1.5662, label: 1, bag_size: 4467
batch 719, loss: 0.2672, instance_loss: 0.4216, weighted_loss: 0.3135, label: 1, bag_size: 4644
batch 739, loss: 1.3331, instance_loss: 0.9948, weighted_loss: 1.2316, label: 2, bag_size: 2486


class 0 clustering acc 0.9761744966442953: correct 17454/17880
class 1 clustering acc 0.23104026845637585: correct 1377/5960
Epoch: 15, train_loss: 0.6878, train_clustering_loss:  0.6001, train_error: 0.2859
class 0: acc 0.7431906614785992, correct 191/257
class 1: acc 0.6640625, correct 170/256
class 2: acc 0.7370689655172413, correct 171/232

Val Set, val_loss: 0.8666, val_error: 0.3511, auc: 0.8011
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.2859042553191489: correct 215/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0176, instance_loss: 0.1414, weighted_loss: 0.0548, label: 0, bag_size: 4644
batch 39, loss: 0.2194, instance_loss: 0.4274, weighted_loss: 0.2818, label: 0, bag_size: 5373
batch 59, loss: 0.4716, instance_loss: 0.4465, weighted_loss: 0.4641, label: 2, bag_size: 3227
batch 79, loss: 2.2894, instance_loss: 0.9610, weighted_loss: 1.8909, label: 0, bag_size: 4032
batch 99, loss: 0.5768, instance_loss: 0.3149, weighted_loss: 0.4983, label: 2, bag_size: 4223
batch 119, loss: 2.0023, instance_loss: 1.2323, weighted_loss: 1.7713, label: 1, bag_size: 3837
batch 139, loss: 0.0457, instance_loss: 0.1753, weighted_loss: 0.0846, label: 2, bag_size: 5138
batch 159, loss: 0.1975, instance_loss: 0.4313, weighted_loss: 0.2676, label: 1, bag_size: 3367
batch 179, loss: 0.1199, instance_loss: 0.2289, weighted_loss: 0.1526, label: 1, bag_size: 425
batch 199, loss: 0.1570, instance_loss: 0.1782, weighted_loss: 0.1633, label: 2, bag_size: 4223
batch 219, loss: 0.4678, instance_loss: 0.3822, weighted_loss: 0.4421, label: 2, bag_size: 1103
batch 239, loss: 0.0491, instance_loss: 0.3738, weighted_loss: 0.1465, label: 1, bag_size: 1836
batch 259, loss: 0.2012, instance_loss: 0.5685, weighted_loss: 0.3114, label: 1, bag_size: 779
batch 279, loss: 2.5977, instance_loss: 0.8259, weighted_loss: 2.0662, label: 0, bag_size: 5867
batch 299, loss: 0.3775, instance_loss: 0.5049, weighted_loss: 0.4157, label: 0, bag_size: 3833
batch 319, loss: 0.1244, instance_loss: 0.2293, weighted_loss: 0.1558, label: 2, bag_size: 4223
batch 339, loss: 0.2024, instance_loss: 0.3147, weighted_loss: 0.2361, label: 2, bag_size: 4691
batch 359, loss: 0.2302, instance_loss: 0.6026, weighted_loss: 0.3420, label: 0, bag_size: 2232
batch 379, loss: 0.0401, instance_loss: 0.1936, weighted_loss: 0.0862, label: 0, bag_size: 3348
batch 399, loss: 0.1569, instance_loss: 0.6481, weighted_loss: 0.3043, label: 1, bag_size: 3558
batch 419, loss: 0.6700, instance_loss: 0.5933, weighted_loss: 0.6470, label: 0, bag_size: 1662
batch 439, loss: 0.5426, instance_loss: 0.9563, weighted_loss: 0.6667, label: 2, bag_size: 4571
batch 459, loss: 0.0630, instance_loss: 0.4038, weighted_loss: 0.1652, label: 0, bag_size: 1170
batch 479, loss: 1.8135, instance_loss: 0.5980, weighted_loss: 1.4488, label: 0, bag_size: 3601
batch 499, loss: 1.2294, instance_loss: 0.7211, weighted_loss: 1.0769, label: 2, bag_size: 5307
batch 519, loss: 2.9519, instance_loss: 1.1814, weighted_loss: 2.4208, label: 0, bag_size: 3830
batch 539, loss: 0.8573, instance_loss: 0.6529, weighted_loss: 0.7960, label: 0, bag_size: 6249
batch 559, loss: 0.2239, instance_loss: 0.5646, weighted_loss: 0.3261, label: 1, bag_size: 5385
batch 579, loss: 0.6369, instance_loss: 0.6719, weighted_loss: 0.6474, label: 1, bag_size: 2859
batch 599, loss: 0.1070, instance_loss: 0.1435, weighted_loss: 0.1180, label: 2, bag_size: 2501
batch 619, loss: 0.4284, instance_loss: 0.6955, weighted_loss: 0.5085, label: 0, bag_size: 4070
batch 639, loss: 0.1282, instance_loss: 0.6280, weighted_loss: 0.2782, label: 1, bag_size: 3156
batch 659, loss: 0.1940, instance_loss: 0.3946, weighted_loss: 0.2542, label: 2, bag_size: 3121
batch 679, loss: 0.1159, instance_loss: 0.4051, weighted_loss: 0.2027, label: 2, bag_size: 3210
batch 699, loss: 1.0282, instance_loss: 0.6964, weighted_loss: 0.9286, label: 2, bag_size: 1543
batch 719, loss: 0.0686, instance_loss: 0.1121, weighted_loss: 0.0816, label: 2, bag_size: 4775
batch 739, loss: 1.7808, instance_loss: 0.5606, weighted_loss: 1.4148, label: 0, bag_size: 5837


class 0 clustering acc 0.9771812080536912: correct 17472/17880
class 1 clustering acc 0.2598993288590604: correct 1549/5960
Epoch: 16, train_loss: 0.6180, train_clustering_loss:  0.5836, train_error: 0.2550
class 0: acc 0.7824427480916031, correct 205/262
class 1: acc 0.6170212765957447, correct 145/235
class 2: acc 0.8266129032258065, correct 205/248

Val Set, val_loss: 1.0936, val_error: 0.4255, auc: 0.7679
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.0797872340425532: correct 60/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0837, instance_loss: 0.1761, weighted_loss: 0.1114, label: 2, bag_size: 4203
batch 39, loss: 0.0018, instance_loss: 0.2019, weighted_loss: 0.0618, label: 1, bag_size: 4134
batch 59, loss: 0.0889, instance_loss: 0.0766, weighted_loss: 0.0852, label: 2, bag_size: 4691
batch 79, loss: 0.0690, instance_loss: 0.3698, weighted_loss: 0.1592, label: 1, bag_size: 3127
batch 99, loss: 0.7724, instance_loss: 0.7031, weighted_loss: 0.7516, label: 1, bag_size: 4960
batch 119, loss: 0.0156, instance_loss: 0.1730, weighted_loss: 0.0628, label: 0, bag_size: 1399
batch 139, loss: 0.2610, instance_loss: 0.4012, weighted_loss: 0.3031, label: 2, bag_size: 6644
batch 159, loss: 1.8038, instance_loss: 0.8526, weighted_loss: 1.5184, label: 0, bag_size: 6630
batch 179, loss: 0.2144, instance_loss: 0.6891, weighted_loss: 0.3568, label: 0, bag_size: 2479
batch 199, loss: 0.0802, instance_loss: 0.3364, weighted_loss: 0.1571, label: 1, bag_size: 596
batch 219, loss: 0.4919, instance_loss: 0.3347, weighted_loss: 0.4448, label: 2, bag_size: 1103
batch 239, loss: 1.7591, instance_loss: 1.1196, weighted_loss: 1.5672, label: 1, bag_size: 4612
batch 259, loss: 0.4258, instance_loss: 0.5594, weighted_loss: 0.4659, label: 0, bag_size: 4161
batch 279, loss: 0.3252, instance_loss: 0.8753, weighted_loss: 0.4902, label: 0, bag_size: 3298
batch 299, loss: 0.5997, instance_loss: 0.5953, weighted_loss: 0.5984, label: 2, bag_size: 3778
batch 319, loss: 0.1976, instance_loss: 0.3652, weighted_loss: 0.2479, label: 2, bag_size: 2359
batch 339, loss: 0.4104, instance_loss: 0.5294, weighted_loss: 0.4461, label: 0, bag_size: 1373
batch 359, loss: 0.5037, instance_loss: 0.4045, weighted_loss: 0.4739, label: 0, bag_size: 5036
batch 379, loss: 2.2577, instance_loss: 1.4295, weighted_loss: 2.0092, label: 0, bag_size: 3341
batch 399, loss: 1.0425, instance_loss: 0.7599, weighted_loss: 0.9577, label: 0, bag_size: 3904
batch 419, loss: 0.8420, instance_loss: 0.5930, weighted_loss: 0.7673, label: 2, bag_size: 5072
batch 439, loss: 0.0916, instance_loss: 0.3143, weighted_loss: 0.1584, label: 0, bag_size: 3443
batch 459, loss: 0.9467, instance_loss: 0.4968, weighted_loss: 0.8117, label: 0, bag_size: 2354
batch 479, loss: 1.7370, instance_loss: 0.9698, weighted_loss: 1.5068, label: 1, bag_size: 2013
batch 499, loss: 1.0316, instance_loss: 0.6436, weighted_loss: 0.9152, label: 2, bag_size: 614
batch 519, loss: 0.1580, instance_loss: 0.1835, weighted_loss: 0.1657, label: 2, bag_size: 4088
batch 539, loss: 0.1973, instance_loss: 0.3772, weighted_loss: 0.2513, label: 2, bag_size: 4192
batch 559, loss: 0.1287, instance_loss: 0.3492, weighted_loss: 0.1949, label: 1, bag_size: 796
batch 579, loss: 0.0146, instance_loss: 0.3509, weighted_loss: 0.1155, label: 0, bag_size: 4570
batch 599, loss: 0.0433, instance_loss: 0.3369, weighted_loss: 0.1314, label: 0, bag_size: 3797
batch 619, loss: 0.0155, instance_loss: 0.3119, weighted_loss: 0.1044, label: 0, bag_size: 3525
batch 639, loss: 1.6346, instance_loss: 1.2923, weighted_loss: 1.5319, label: 1, bag_size: 2927
batch 659, loss: 0.3874, instance_loss: 0.4252, weighted_loss: 0.3987, label: 1, bag_size: 4373
batch 679, loss: 0.0287, instance_loss: 0.2608, weighted_loss: 0.0983, label: 1, bag_size: 2453
batch 699, loss: 1.0743, instance_loss: 0.9106, weighted_loss: 1.0252, label: 1, bag_size: 1712
batch 719, loss: 0.6986, instance_loss: 0.7821, weighted_loss: 0.7236, label: 1, bag_size: 5276
batch 739, loss: 0.0299, instance_loss: 0.3069, weighted_loss: 0.1130, label: 1, bag_size: 6992


class 0 clustering acc 0.9714765100671141: correct 17370/17880
class 1 clustering acc 0.3052013422818792: correct 1819/5960
Epoch: 17, train_loss: 0.5828, train_clustering_loss:  0.5644, train_error: 0.2389
class 0: acc 0.8249027237354085, correct 212/257
class 1: acc 0.6336206896551724, correct 147/232
class 2: acc 0.8125, correct 208/256

Val Set, val_loss: 1.0023, val_error: 0.4149, auc: 0.7813
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.19148936170212766: correct 144/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0016, instance_loss: 0.6509, weighted_loss: 0.1964, label: 0, bag_size: 2306
batch 39, loss: 0.1836, instance_loss: 0.5700, weighted_loss: 0.2995, label: 1, bag_size: 3493
batch 59, loss: 0.1045, instance_loss: 0.1749, weighted_loss: 0.1256, label: 2, bag_size: 2481
batch 79, loss: 0.5361, instance_loss: 0.6012, weighted_loss: 0.5556, label: 2, bag_size: 4571
batch 99, loss: 0.7577, instance_loss: 0.6111, weighted_loss: 0.7137, label: 2, bag_size: 3227
batch 119, loss: 0.0212, instance_loss: 0.2911, weighted_loss: 0.1022, label: 0, bag_size: 4914
batch 139, loss: 1.4071, instance_loss: 0.7588, weighted_loss: 1.2126, label: 1, bag_size: 1607
batch 159, loss: 0.2477, instance_loss: 0.4669, weighted_loss: 0.3135, label: 2, bag_size: 4162
batch 179, loss: 0.1550, instance_loss: 0.1789, weighted_loss: 0.1622, label: 2, bag_size: 2501
batch 199, loss: 4.8762, instance_loss: 1.7472, weighted_loss: 3.9375, label: 2, bag_size: 728
batch 219, loss: 0.0812, instance_loss: 0.3284, weighted_loss: 0.1554, label: 0, bag_size: 4092
batch 239, loss: 0.3878, instance_loss: 0.6470, weighted_loss: 0.4656, label: 1, bag_size: 4119
batch 259, loss: 1.2734, instance_loss: 0.8823, weighted_loss: 1.1560, label: 1, bag_size: 5197
batch 279, loss: 0.2550, instance_loss: 0.3378, weighted_loss: 0.2798, label: 2, bag_size: 2422
batch 299, loss: 0.8928, instance_loss: 0.7422, weighted_loss: 0.8476, label: 2, bag_size: 5307
batch 319, loss: 0.4476, instance_loss: 0.5247, weighted_loss: 0.4707, label: 0, bag_size: 2378
batch 339, loss: 1.3243, instance_loss: 0.7821, weighted_loss: 1.1616, label: 2, bag_size: 6298
batch 359, loss: 0.4231, instance_loss: 0.6407, weighted_loss: 0.4884, label: 1, bag_size: 14449
batch 379, loss: 0.5435, instance_loss: 0.4517, weighted_loss: 0.5160, label: 0, bag_size: 4946
batch 399, loss: 0.5567, instance_loss: 0.5730, weighted_loss: 0.5616, label: 1, bag_size: 4960
batch 419, loss: 0.0728, instance_loss: 0.3719, weighted_loss: 0.1625, label: 0, bag_size: 4606
batch 439, loss: 1.5415, instance_loss: 1.1036, weighted_loss: 1.4102, label: 2, bag_size: 2326
batch 459, loss: 1.3132, instance_loss: 0.6412, weighted_loss: 1.1116, label: 0, bag_size: 3316
batch 479, loss: 2.1017, instance_loss: 1.2911, weighted_loss: 1.8585, label: 1, bag_size: 5011
batch 499, loss: 0.2251, instance_loss: 0.4955, weighted_loss: 0.3062, label: 2, bag_size: 5637
batch 519, loss: 0.1361, instance_loss: 0.5356, weighted_loss: 0.2560, label: 0, bag_size: 3983
batch 539, loss: 0.1360, instance_loss: 0.1960, weighted_loss: 0.1540, label: 2, bag_size: 2481
batch 559, loss: 0.4750, instance_loss: 0.4604, weighted_loss: 0.4707, label: 0, bag_size: 4604
batch 579, loss: 0.2530, instance_loss: 0.6145, weighted_loss: 0.3615, label: 1, bag_size: 4119
batch 599, loss: 1.2341, instance_loss: 1.2161, weighted_loss: 1.2287, label: 0, bag_size: 313
batch 619, loss: 0.3987, instance_loss: 0.7447, weighted_loss: 0.5025, label: 2, bag_size: 2486
batch 639, loss: 0.6001, instance_loss: 0.6658, weighted_loss: 0.6198, label: 1, bag_size: 3184
batch 659, loss: 0.1999, instance_loss: 1.0300, weighted_loss: 0.4489, label: 0, bag_size: 889
batch 679, loss: 0.9673, instance_loss: 0.6893, weighted_loss: 0.8839, label: 1, bag_size: 2743
batch 699, loss: 0.2961, instance_loss: 0.4567, weighted_loss: 0.3443, label: 0, bag_size: 5340
batch 719, loss: 1.0186, instance_loss: 0.7058, weighted_loss: 0.9248, label: 0, bag_size: 1543
batch 739, loss: 0.3034, instance_loss: 0.5249, weighted_loss: 0.3698, label: 0, bag_size: 6445


class 0 clustering acc 0.9744407158836689: correct 17423/17880
class 1 clustering acc 0.26711409395973157: correct 1592/5960
Epoch: 18, train_loss: 0.6311, train_clustering_loss:  0.5904, train_error: 0.2711
class 0: acc 0.7604562737642585, correct 200/263
class 1: acc 0.6626984126984127, correct 167/252
class 2: acc 0.7652173913043478, correct 176/230

Val Set, val_loss: 0.8572, val_error: 0.3085, auc: 0.7891
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.2473404255319149: correct 186/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.5408, instance_loss: 0.6181, weighted_loss: 0.5640, label: 1, bag_size: 3050
batch 39, loss: 1.8854, instance_loss: 0.8775, weighted_loss: 1.5830, label: 2, bag_size: 223
batch 59, loss: 0.2042, instance_loss: 0.7243, weighted_loss: 0.3602, label: 1, bag_size: 6315
batch 79, loss: 0.0511, instance_loss: 0.5324, weighted_loss: 0.1955, label: 0, bag_size: 5282
batch 99, loss: 1.1332, instance_loss: 0.8190, weighted_loss: 1.0390, label: 1, bag_size: 2671
batch 119, loss: 0.1041, instance_loss: 0.3936, weighted_loss: 0.1909, label: 0, bag_size: 667
batch 139, loss: 0.0471, instance_loss: 0.1875, weighted_loss: 0.0893, label: 2, bag_size: 88
batch 159, loss: 0.0266, instance_loss: 0.1555, weighted_loss: 0.0653, label: 2, bag_size: 4372
batch 179, loss: 0.1670, instance_loss: 0.1515, weighted_loss: 0.1624, label: 2, bag_size: 4223
batch 199, loss: 0.2038, instance_loss: 0.4938, weighted_loss: 0.2908, label: 0, bag_size: 3793
batch 219, loss: 1.2922, instance_loss: 0.9115, weighted_loss: 1.1780, label: 0, bag_size: 313
batch 239, loss: 0.4664, instance_loss: 0.4886, weighted_loss: 0.4731, label: 2, bag_size: 597
batch 259, loss: 0.8920, instance_loss: 0.5682, weighted_loss: 0.7948, label: 0, bag_size: 4201
batch 279, loss: 0.0277, instance_loss: 0.3896, weighted_loss: 0.1362, label: 1, bag_size: 3221
batch 299, loss: 0.2180, instance_loss: 0.5299, weighted_loss: 0.3116, label: 1, bag_size: 5385
batch 319, loss: 0.0291, instance_loss: 0.3784, weighted_loss: 0.1339, label: 1, bag_size: 3221
batch 339, loss: 0.6014, instance_loss: 0.3286, weighted_loss: 0.5195, label: 0, bag_size: 3475
batch 359, loss: 0.7192, instance_loss: 0.5713, weighted_loss: 0.6748, label: 0, bag_size: 4946
batch 379, loss: 0.0073, instance_loss: 0.3632, weighted_loss: 0.1141, label: 0, bag_size: 8088
batch 399, loss: 0.3139, instance_loss: 0.1369, weighted_loss: 0.2608, label: 0, bag_size: 5108
batch 419, loss: 0.0887, instance_loss: 0.4763, weighted_loss: 0.2050, label: 1, bag_size: 3156
batch 439, loss: 0.0328, instance_loss: 0.1011, weighted_loss: 0.0533, label: 2, bag_size: 3415
batch 459, loss: 0.0340, instance_loss: 0.2448, weighted_loss: 0.0972, label: 2, bag_size: 2770
batch 479, loss: 2.1727, instance_loss: 0.8868, weighted_loss: 1.7869, label: 2, bag_size: 223
batch 499, loss: 0.6347, instance_loss: 0.6937, weighted_loss: 0.6524, label: 1, bag_size: 578
batch 519, loss: 0.2649, instance_loss: 0.6396, weighted_loss: 0.3773, label: 2, bag_size: 3604
batch 539, loss: 2.2006, instance_loss: 1.3632, weighted_loss: 1.9494, label: 0, bag_size: 1774
batch 559, loss: 0.1178, instance_loss: 0.1317, weighted_loss: 0.1220, label: 2, bag_size: 4788
batch 579, loss: 0.2619, instance_loss: 0.4376, weighted_loss: 0.3146, label: 2, bag_size: 614
batch 599, loss: 0.1705, instance_loss: 0.3337, weighted_loss: 0.2195, label: 0, bag_size: 2983
batch 619, loss: 0.0499, instance_loss: 0.8413, weighted_loss: 0.2873, label: 2, bag_size: 4497
batch 639, loss: 1.5413, instance_loss: 0.6023, weighted_loss: 1.2596, label: 2, bag_size: 5406
batch 659, loss: 0.0088, instance_loss: 0.3203, weighted_loss: 0.1022, label: 1, bag_size: 2009
batch 679, loss: 2.1370, instance_loss: 1.1152, weighted_loss: 1.8304, label: 1, bag_size: 4145
batch 699, loss: 0.4652, instance_loss: 0.6459, weighted_loss: 0.5195, label: 1, bag_size: 3755
batch 719, loss: 0.6703, instance_loss: 0.5496, weighted_loss: 0.6341, label: 0, bag_size: 1655
batch 739, loss: 0.1599, instance_loss: 0.6575, weighted_loss: 0.3092, label: 0, bag_size: 4403


class 0 clustering acc 0.9758948545861298: correct 17449/17880
class 1 clustering acc 0.30906040268456375: correct 1842/5960
Epoch: 19, train_loss: 0.5939, train_clustering_loss:  0.5573, train_error: 0.2550
class 0: acc 0.7905138339920948, correct 200/253
class 1: acc 0.5966386554621849, correct 142/238
class 2: acc 0.8385826771653543, correct 213/254

Val Set, val_loss: 1.0582, val_error: 0.4681, auc: 0.7544
class 0 clustering acc 0.9596631205673759: correct 2165/2256
class 1 clustering acc 0.11303191489361702: correct 85/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0219, instance_loss: 0.1863, weighted_loss: 0.0712, label: 1, bag_size: 425
batch 39, loss: 1.6582, instance_loss: 0.7580, weighted_loss: 1.3881, label: 1, bag_size: 6241
batch 59, loss: 0.0061, instance_loss: 0.2022, weighted_loss: 0.0649, label: 0, bag_size: 6182
batch 79, loss: 0.5801, instance_loss: 0.5790, weighted_loss: 0.5797, label: 0, bag_size: 8866
batch 99, loss: 0.9937, instance_loss: 0.7744, weighted_loss: 0.9279, label: 0, bag_size: 3709
batch 119, loss: 0.1450, instance_loss: 0.4787, weighted_loss: 0.2451, label: 0, bag_size: 1662
batch 139, loss: 0.1319, instance_loss: 0.4147, weighted_loss: 0.2167, label: 0, bag_size: 4227
batch 159, loss: 2.7073, instance_loss: 1.9827, weighted_loss: 2.4899, label: 1, bag_size: 1549
batch 179, loss: 0.3077, instance_loss: 0.4784, weighted_loss: 0.3589, label: 1, bag_size: 6689
batch 199, loss: 2.1384, instance_loss: 1.1350, weighted_loss: 1.8374, label: 0, bag_size: 609
batch 219, loss: 0.2789, instance_loss: 0.5646, weighted_loss: 0.3646, label: 0, bag_size: 3339
batch 239, loss: 0.1627, instance_loss: 0.5153, weighted_loss: 0.2685, label: 0, bag_size: 4092
batch 259, loss: 0.1601, instance_loss: 0.9391, weighted_loss: 0.3938, label: 1, bag_size: 2472
batch 279, loss: 0.0913, instance_loss: 0.3455, weighted_loss: 0.1675, label: 1, bag_size: 3156
batch 299, loss: 0.4892, instance_loss: 0.4736, weighted_loss: 0.4845, label: 2, bag_size: 3534
batch 319, loss: 0.0421, instance_loss: 0.3849, weighted_loss: 0.1450, label: 0, bag_size: 1352
batch 339, loss: 1.8561, instance_loss: 0.6875, weighted_loss: 1.5055, label: 2, bag_size: 4487
batch 359, loss: 0.0507, instance_loss: 0.1587, weighted_loss: 0.0831, label: 2, bag_size: 2770
batch 379, loss: 1.1047, instance_loss: 0.6975, weighted_loss: 0.9825, label: 2, bag_size: 6298
batch 399, loss: 1.3347, instance_loss: 0.8112, weighted_loss: 1.1777, label: 1, bag_size: 3261
batch 419, loss: 0.2796, instance_loss: 0.2733, weighted_loss: 0.2777, label: 2, bag_size: 2561
batch 439, loss: 0.0807, instance_loss: 0.1884, weighted_loss: 0.1130, label: 2, bag_size: 3396
batch 459, loss: 0.2207, instance_loss: 0.5548, weighted_loss: 0.3209, label: 0, bag_size: 6440
batch 479, loss: 0.3025, instance_loss: 0.6278, weighted_loss: 0.4001, label: 0, bag_size: 2479
batch 499, loss: 0.5255, instance_loss: 0.5952, weighted_loss: 0.5464, label: 1, bag_size: 4346
batch 519, loss: 0.0656, instance_loss: 0.2546, weighted_loss: 0.1223, label: 2, bag_size: 3810
batch 539, loss: 0.0603, instance_loss: 0.2417, weighted_loss: 0.1147, label: 2, bag_size: 4302
batch 559, loss: 0.0681, instance_loss: 0.4365, weighted_loss: 0.1786, label: 0, bag_size: 4227
batch 579, loss: 1.2919, instance_loss: 0.8267, weighted_loss: 1.1523, label: 0, bag_size: 16741
batch 599, loss: 1.2208, instance_loss: 0.7789, weighted_loss: 1.0882, label: 1, bag_size: 3424
batch 619, loss: 1.5986, instance_loss: 0.9130, weighted_loss: 1.3929, label: 2, bag_size: 1543
batch 639, loss: 0.0156, instance_loss: 0.1960, weighted_loss: 0.0697, label: 1, bag_size: 4253
batch 659, loss: 0.0073, instance_loss: 0.2096, weighted_loss: 0.0680, label: 1, bag_size: 3221
batch 679, loss: 0.8264, instance_loss: 0.6707, weighted_loss: 0.7797, label: 1, bag_size: 1500
batch 699, loss: 0.0836, instance_loss: 0.5857, weighted_loss: 0.2343, label: 0, bag_size: 3297
batch 719, loss: 0.0312, instance_loss: 0.0902, weighted_loss: 0.0489, label: 2, bag_size: 1094
batch 739, loss: 0.1634, instance_loss: 0.1539, weighted_loss: 0.1605, label: 2, bag_size: 4788


class 0 clustering acc 0.9743288590604027: correct 17421/17880
class 1 clustering acc 0.2634228187919463: correct 1570/5960
Epoch: 20, train_loss: 0.6275, train_clustering_loss:  0.5866, train_error: 0.2604
class 0: acc 0.746606334841629, correct 165/221
class 1: acc 0.6703703703703704, correct 181/270
class 2: acc 0.8070866141732284, correct 205/254

Val Set, val_loss: 0.8574, val_error: 0.3191, auc: 0.8018
class 0 clustering acc 0.9574468085106383: correct 2160/2256
class 1 clustering acc 0.13164893617021275: correct 99/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.6308, instance_loss: 0.3821, weighted_loss: 0.5562, label: 1, bag_size: 210
batch 39, loss: 0.1145, instance_loss: 0.2089, weighted_loss: 0.1428, label: 2, bag_size: 4203
batch 59, loss: 0.0789, instance_loss: 0.3559, weighted_loss: 0.1620, label: 2, bag_size: 3607
batch 79, loss: 1.1275, instance_loss: 0.6854, weighted_loss: 0.9949, label: 0, bag_size: 6249
batch 99, loss: 0.0000, instance_loss: 0.0887, weighted_loss: 0.0266, label: 0, bag_size: 5902
batch 119, loss: 2.0568, instance_loss: 0.8560, weighted_loss: 1.6966, label: 1, bag_size: 6241
batch 139, loss: 0.4610, instance_loss: 0.3766, weighted_loss: 0.4357, label: 2, bag_size: 3227
batch 159, loss: 0.3465, instance_loss: 0.6354, weighted_loss: 0.4332, label: 0, bag_size: 909
batch 179, loss: 0.0525, instance_loss: 0.2625, weighted_loss: 0.1155, label: 2, bag_size: 5037
batch 199, loss: 0.0362, instance_loss: 0.0449, weighted_loss: 0.0388, label: 2, bag_size: 3583
batch 219, loss: 0.3180, instance_loss: 0.5854, weighted_loss: 0.3982, label: 2, bag_size: 4291
batch 239, loss: 0.2772, instance_loss: 0.4628, weighted_loss: 0.3329, label: 0, bag_size: 3885
batch 259, loss: 0.1978, instance_loss: 0.5571, weighted_loss: 0.3056, label: 0, bag_size: 5260
batch 279, loss: 0.1259, instance_loss: 0.6121, weighted_loss: 0.2718, label: 0, bag_size: 14070
batch 299, loss: 0.9497, instance_loss: 0.7021, weighted_loss: 0.8754, label: 1, bag_size: 2744
batch 319, loss: 3.8077, instance_loss: 1.5091, weighted_loss: 3.1181, label: 0, bag_size: 18038
batch 339, loss: 0.0009, instance_loss: 0.1396, weighted_loss: 0.0425, label: 1, bag_size: 5229
batch 359, loss: 0.7176, instance_loss: 0.5751, weighted_loss: 0.6748, label: 0, bag_size: 4717
batch 379, loss: 0.1205, instance_loss: 0.5803, weighted_loss: 0.2584, label: 1, bag_size: 3127
batch 399, loss: 1.0052, instance_loss: 0.8228, weighted_loss: 0.9505, label: 0, bag_size: 14791
batch 419, loss: 0.7524, instance_loss: 0.6918, weighted_loss: 0.7342, label: 2, bag_size: 4179
batch 439, loss: 1.9735, instance_loss: 0.9242, weighted_loss: 1.6587, label: 1, bag_size: 3475
batch 459, loss: 1.0874, instance_loss: 0.5104, weighted_loss: 0.9143, label: 0, bag_size: 3864
batch 479, loss: 0.0285, instance_loss: 0.5020, weighted_loss: 0.1706, label: 0, bag_size: 4506
batch 499, loss: 0.8254, instance_loss: 0.7347, weighted_loss: 0.7982, label: 0, bag_size: 1662
batch 519, loss: 0.0079, instance_loss: 0.0416, weighted_loss: 0.0180, label: 2, bag_size: 6148
batch 539, loss: 0.0456, instance_loss: 0.2792, weighted_loss: 0.1157, label: 2, bag_size: 4302
batch 559, loss: 0.6419, instance_loss: 0.5069, weighted_loss: 0.6014, label: 2, bag_size: 3534
batch 579, loss: 1.7073, instance_loss: 0.4594, weighted_loss: 1.3330, label: 2, bag_size: 5307
batch 599, loss: 0.1456, instance_loss: 0.3452, weighted_loss: 0.2055, label: 0, bag_size: 4165
batch 619, loss: 1.2781, instance_loss: 0.6199, weighted_loss: 1.0807, label: 2, bag_size: 1513
batch 639, loss: 2.3033, instance_loss: 1.0755, weighted_loss: 1.9350, label: 1, bag_size: 2013
batch 659, loss: 0.3122, instance_loss: 0.3509, weighted_loss: 0.3238, label: 0, bag_size: 5893
batch 679, loss: 0.1316, instance_loss: 0.2853, weighted_loss: 0.1777, label: 2, bag_size: 3810
batch 699, loss: 1.2578, instance_loss: 1.1590, weighted_loss: 1.2282, label: 0, bag_size: 19216
batch 719, loss: 0.9992, instance_loss: 0.8340, weighted_loss: 0.9497, label: 1, bag_size: 1854
batch 739, loss: 0.6601, instance_loss: 0.6976, weighted_loss: 0.6714, label: 1, bag_size: 6025


class 0 clustering acc 0.9707494407158836: correct 17357/17880
class 1 clustering acc 0.2848993288590604: correct 1698/5960
Epoch: 21, train_loss: 0.6399, train_clustering_loss:  0.5797, train_error: 0.2752
class 0: acc 0.748062015503876, correct 193/258
class 1: acc 0.6092436974789915, correct 145/238
class 2: acc 0.8112449799196787, correct 202/249

Val Set, val_loss: 1.0651, val_error: 0.4043, auc: 0.7382
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.17287234042553193: correct 130/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.16666666666666666, correct 2/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.3128, instance_loss: 0.3820, weighted_loss: 0.3335, label: 2, bag_size: 2359
batch 39, loss: 1.0658, instance_loss: 0.8837, weighted_loss: 1.0112, label: 2, bag_size: 5743
batch 59, loss: 0.3737, instance_loss: 0.5908, weighted_loss: 0.4388, label: 2, bag_size: 4302
batch 79, loss: 0.2699, instance_loss: 0.4525, weighted_loss: 0.3247, label: 0, bag_size: 3376
batch 99, loss: 0.1286, instance_loss: 0.4732, weighted_loss: 0.2320, label: 1, bag_size: 3460
batch 119, loss: 0.5556, instance_loss: 0.5736, weighted_loss: 0.5610, label: 0, bag_size: 4544
batch 139, loss: 0.0000, instance_loss: 0.1126, weighted_loss: 0.0338, label: 0, bag_size: 1106
batch 159, loss: 0.8152, instance_loss: 0.6484, weighted_loss: 0.7652, label: 0, bag_size: 2501
batch 179, loss: 0.1834, instance_loss: 0.4608, weighted_loss: 0.2666, label: 2, bag_size: 3121
batch 199, loss: 0.0515, instance_loss: 0.1624, weighted_loss: 0.0847, label: 2, bag_size: 2483
batch 219, loss: 0.0488, instance_loss: 0.2753, weighted_loss: 0.1167, label: 0, bag_size: 2290
batch 239, loss: 0.0295, instance_loss: 0.1195, weighted_loss: 0.0565, label: 2, bag_size: 6148
batch 259, loss: 0.1822, instance_loss: 0.3580, weighted_loss: 0.2350, label: 0, bag_size: 4797
batch 279, loss: 2.0470, instance_loss: 1.4750, weighted_loss: 1.8754, label: 1, bag_size: 2852
batch 299, loss: 0.0687, instance_loss: 0.1962, weighted_loss: 0.1069, label: 2, bag_size: 3415
batch 319, loss: 1.1163, instance_loss: 0.8177, weighted_loss: 1.0267, label: 0, bag_size: 14791
batch 339, loss: 0.1937, instance_loss: 0.2361, weighted_loss: 0.2064, label: 0, bag_size: 5041
batch 359, loss: 0.1204, instance_loss: 0.2546, weighted_loss: 0.1607, label: 0, bag_size: 3936
batch 379, loss: 2.8005, instance_loss: 1.5225, weighted_loss: 2.4171, label: 0, bag_size: 1365
batch 399, loss: 0.3163, instance_loss: 0.7172, weighted_loss: 0.4366, label: 0, bag_size: 1492
batch 419, loss: 0.3269, instance_loss: 1.0964, weighted_loss: 0.5577, label: 0, bag_size: 5330
batch 439, loss: 0.0451, instance_loss: 0.0714, weighted_loss: 0.0530, label: 2, bag_size: 4056
batch 459, loss: 0.0681, instance_loss: 0.1291, weighted_loss: 0.0864, label: 2, bag_size: 4192
batch 479, loss: 0.3395, instance_loss: 0.4391, weighted_loss: 0.3694, label: 0, bag_size: 4351
batch 499, loss: 0.2134, instance_loss: 0.4764, weighted_loss: 0.2923, label: 1, bag_size: 758
batch 519, loss: 0.0303, instance_loss: 0.0858, weighted_loss: 0.0469, label: 2, bag_size: 3415
batch 539, loss: 1.1273, instance_loss: 0.7331, weighted_loss: 1.0090, label: 0, bag_size: 4351
batch 559, loss: 0.1503, instance_loss: 0.2799, weighted_loss: 0.1891, label: 2, bag_size: 88
batch 579, loss: 1.6231, instance_loss: 0.8354, weighted_loss: 1.3868, label: 2, bag_size: 223
batch 599, loss: 0.4840, instance_loss: 0.6278, weighted_loss: 0.5271, label: 0, bag_size: 1611
batch 619, loss: 0.3670, instance_loss: 0.4795, weighted_loss: 0.4007, label: 1, bag_size: 3126
batch 639, loss: 1.0877, instance_loss: 0.6597, weighted_loss: 0.9593, label: 1, bag_size: 3475
batch 659, loss: 0.0078, instance_loss: 0.1957, weighted_loss: 0.0642, label: 1, bag_size: 3761
batch 679, loss: 0.0397, instance_loss: 0.4230, weighted_loss: 0.1547, label: 0, bag_size: 5170
batch 699, loss: 1.0807, instance_loss: 0.8910, weighted_loss: 1.0238, label: 0, bag_size: 2069
batch 719, loss: 3.9055, instance_loss: 1.6391, weighted_loss: 3.2256, label: 0, bag_size: 3750
batch 739, loss: 0.0896, instance_loss: 0.1547, weighted_loss: 0.1091, label: 2, bag_size: 3210


class 0 clustering acc 0.9739932885906041: correct 17415/17880
class 1 clustering acc 0.31291946308724833: correct 1865/5960
Epoch: 22, train_loss: 0.6005, train_clustering_loss:  0.5566, train_error: 0.2456
class 0: acc 0.7550200803212851, correct 188/249
class 1: acc 0.6680672268907563, correct 159/238
class 2: acc 0.8333333333333334, correct 215/258

Val Set, val_loss: 1.2817, val_error: 0.5106, auc: 0.7632
class 0 clustering acc 0.9304078014184397: correct 2099/2256
class 1 clustering acc 0.11436170212765957: correct 86/752
class 0: acc 0.36538461538461536, correct 19/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2094, instance_loss: 0.3396, weighted_loss: 0.2485, label: 2, bag_size: 4140
batch 39, loss: 0.7033, instance_loss: 0.5808, weighted_loss: 0.6666, label: 0, bag_size: 4648
batch 59, loss: 0.1612, instance_loss: 0.4819, weighted_loss: 0.2574, label: 0, bag_size: 3219
batch 79, loss: 0.0162, instance_loss: 0.0798, weighted_loss: 0.0353, label: 2, bag_size: 3285
batch 99, loss: 0.4904, instance_loss: 0.5943, weighted_loss: 0.5216, label: 1, bag_size: 4346
batch 119, loss: 0.0341, instance_loss: 0.1953, weighted_loss: 0.0825, label: 2, bag_size: 3497
batch 139, loss: 0.1774, instance_loss: 0.2849, weighted_loss: 0.2096, label: 0, bag_size: 873
batch 159, loss: 2.4975, instance_loss: 1.0035, weighted_loss: 2.0493, label: 1, bag_size: 3261
batch 179, loss: 0.0876, instance_loss: 0.2287, weighted_loss: 0.1300, label: 0, bag_size: 4741
batch 199, loss: 0.9136, instance_loss: 0.8019, weighted_loss: 0.8801, label: 0, bag_size: 4274
batch 219, loss: 1.2415, instance_loss: 0.8081, weighted_loss: 1.1115, label: 1, bag_size: 3786
batch 239, loss: 6.1985, instance_loss: 2.8463, weighted_loss: 5.1928, label: 2, bag_size: 2049
batch 259, loss: 3.0508, instance_loss: 1.3341, weighted_loss: 2.5358, label: 0, bag_size: 3830
batch 279, loss: 0.0740, instance_loss: 0.3173, weighted_loss: 0.1470, label: 0, bag_size: 7330
batch 299, loss: 0.3746, instance_loss: 0.4662, weighted_loss: 0.4021, label: 2, bag_size: 4302
batch 319, loss: 0.0038, instance_loss: 0.3142, weighted_loss: 0.0969, label: 1, bag_size: 5760
batch 339, loss: 0.0026, instance_loss: 0.4107, weighted_loss: 0.1250, label: 0, bag_size: 5487
batch 359, loss: 0.5828, instance_loss: 0.5479, weighted_loss: 0.5724, label: 1, bag_size: 10399
batch 379, loss: 0.2062, instance_loss: 0.3942, weighted_loss: 0.2626, label: 2, bag_size: 4978
batch 399, loss: 0.5542, instance_loss: 0.6811, weighted_loss: 0.5923, label: 1, bag_size: 19265
batch 419, loss: 0.0346, instance_loss: 0.2321, weighted_loss: 0.0938, label: 1, bag_size: 425
batch 439, loss: 0.3616, instance_loss: 0.6638, weighted_loss: 0.4523, label: 1, bag_size: 4869
batch 459, loss: 0.1427, instance_loss: 0.5385, weighted_loss: 0.2614, label: 0, bag_size: 4229
batch 479, loss: 0.1205, instance_loss: 0.1516, weighted_loss: 0.1298, label: 2, bag_size: 4775
batch 499, loss: 0.3896, instance_loss: 0.6615, weighted_loss: 0.4712, label: 1, bag_size: 8482
batch 519, loss: 0.6531, instance_loss: 0.6975, weighted_loss: 0.6664, label: 1, bag_size: 5412
batch 539, loss: 0.0706, instance_loss: 0.3016, weighted_loss: 0.1399, label: 1, bag_size: 8802
batch 559, loss: 0.0568, instance_loss: 0.3425, weighted_loss: 0.1425, label: 0, bag_size: 855
batch 579, loss: 0.1865, instance_loss: 0.4348, weighted_loss: 0.2610, label: 2, bag_size: 3778
batch 599, loss: 0.2297, instance_loss: 0.1993, weighted_loss: 0.2206, label: 2, bag_size: 4691
batch 619, loss: 0.0232, instance_loss: 0.1560, weighted_loss: 0.0631, label: 2, bag_size: 88
batch 639, loss: 0.4023, instance_loss: 0.5757, weighted_loss: 0.4543, label: 0, bag_size: 4274
batch 659, loss: 0.2808, instance_loss: 0.5859, weighted_loss: 0.3724, label: 0, bag_size: 3701
batch 679, loss: 0.0890, instance_loss: 0.3312, weighted_loss: 0.1617, label: 0, bag_size: 598
batch 699, loss: 0.3963, instance_loss: 0.6115, weighted_loss: 0.4609, label: 1, bag_size: 1807
batch 719, loss: 1.4909, instance_loss: 0.8249, weighted_loss: 1.2911, label: 0, bag_size: 1647
batch 739, loss: 0.0247, instance_loss: 0.2280, weighted_loss: 0.0857, label: 2, bag_size: 5138


class 0 clustering acc 0.9723713646532438: correct 17386/17880
class 1 clustering acc 0.2771812080536913: correct 1652/5960
Epoch: 23, train_loss: 0.6323, train_clustering_loss:  0.5905, train_error: 0.2604
class 0: acc 0.769811320754717, correct 204/265
class 1: acc 0.6538461538461539, correct 153/234
class 2: acc 0.7886178861788617, correct 194/246

Val Set, val_loss: 1.1584, val_error: 0.4574, auc: 0.7571
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.13962765957446807: correct 105/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 1.0886, instance_loss: 0.6584, weighted_loss: 0.9595, label: 1, bag_size: 1327
batch 39, loss: 0.0859, instance_loss: 0.2566, weighted_loss: 0.1371, label: 0, bag_size: 4783
batch 59, loss: 0.3416, instance_loss: 0.5218, weighted_loss: 0.3957, label: 0, bag_size: 7177
batch 79, loss: 0.1593, instance_loss: 0.4218, weighted_loss: 0.2380, label: 0, bag_size: 4455
batch 99, loss: 0.1312, instance_loss: 0.3609, weighted_loss: 0.2001, label: 0, bag_size: 1233
batch 119, loss: 0.1419, instance_loss: 0.5051, weighted_loss: 0.2509, label: 2, bag_size: 4372
batch 139, loss: 3.2201, instance_loss: 2.3250, weighted_loss: 2.9516, label: 0, bag_size: 2736
batch 159, loss: 0.1646, instance_loss: 0.1156, weighted_loss: 0.1499, label: 2, bag_size: 1094
batch 179, loss: 1.0887, instance_loss: 0.7598, weighted_loss: 0.9900, label: 1, bag_size: 1510
batch 199, loss: 1.3284, instance_loss: 0.8794, weighted_loss: 1.1937, label: 1, bag_size: 1097
batch 219, loss: 0.3421, instance_loss: 0.6353, weighted_loss: 0.4301, label: 2, bag_size: 3618
batch 239, loss: 3.4180, instance_loss: 1.0214, weighted_loss: 2.6990, label: 0, bag_size: 5017
batch 259, loss: 0.9141, instance_loss: 0.8294, weighted_loss: 0.8887, label: 2, bag_size: 724
batch 279, loss: 0.0544, instance_loss: 0.1438, weighted_loss: 0.0813, label: 2, bag_size: 3415
batch 299, loss: 0.3973, instance_loss: 0.6053, weighted_loss: 0.4597, label: 1, bag_size: 2998
batch 319, loss: 0.0509, instance_loss: 0.2362, weighted_loss: 0.1065, label: 1, bag_size: 758
batch 339, loss: 0.6881, instance_loss: 0.7158, weighted_loss: 0.6964, label: 1, bag_size: 1854
batch 359, loss: 0.7976, instance_loss: 0.7047, weighted_loss: 0.7697, label: 1, bag_size: 1854
batch 379, loss: 0.0699, instance_loss: 0.1886, weighted_loss: 0.1055, label: 2, bag_size: 5011
batch 399, loss: 0.0244, instance_loss: 0.2442, weighted_loss: 0.0903, label: 1, bag_size: 3677
batch 419, loss: 0.5068, instance_loss: 0.5730, weighted_loss: 0.5266, label: 1, bag_size: 2962
batch 439, loss: 0.0400, instance_loss: 0.3311, weighted_loss: 0.1273, label: 0, bag_size: 2094
batch 459, loss: 0.8862, instance_loss: 0.3857, weighted_loss: 0.7361, label: 2, bag_size: 705
batch 479, loss: 0.0059, instance_loss: 0.2066, weighted_loss: 0.0661, label: 1, bag_size: 2009
batch 499, loss: 0.1712, instance_loss: 0.4600, weighted_loss: 0.2578, label: 0, bag_size: 4178
batch 519, loss: 0.1721, instance_loss: 0.5066, weighted_loss: 0.2725, label: 1, bag_size: 3519
batch 539, loss: 0.0431, instance_loss: 0.4122, weighted_loss: 0.1538, label: 1, bag_size: 582
batch 559, loss: 0.0976, instance_loss: 0.3300, weighted_loss: 0.1673, label: 1, bag_size: 3991
batch 579, loss: 0.0365, instance_loss: 0.3743, weighted_loss: 0.1378, label: 0, bag_size: 5006
batch 599, loss: 0.2036, instance_loss: 0.4252, weighted_loss: 0.2701, label: 0, bag_size: 3525
batch 619, loss: 0.0000, instance_loss: 0.1987, weighted_loss: 0.0596, label: 0, bag_size: 1132
batch 639, loss: 1.6799, instance_loss: 1.1359, weighted_loss: 1.5167, label: 2, bag_size: 3475
batch 659, loss: 1.2086, instance_loss: 0.9894, weighted_loss: 1.1429, label: 0, bag_size: 4479
batch 679, loss: 1.5150, instance_loss: 1.1122, weighted_loss: 1.3942, label: 1, bag_size: 5118
batch 699, loss: 1.6354, instance_loss: 1.0953, weighted_loss: 1.4734, label: 2, bag_size: 3274
batch 719, loss: 0.4474, instance_loss: 0.4771, weighted_loss: 0.4563, label: 0, bag_size: 6249
batch 739, loss: 0.0793, instance_loss: 0.2790, weighted_loss: 0.1392, label: 1, bag_size: 758


class 0 clustering acc 0.9761744966442953: correct 17454/17880
class 1 clustering acc 0.3092281879194631: correct 1843/5960
Epoch: 24, train_loss: 0.5892, train_clustering_loss:  0.5601, train_error: 0.2470
class 0: acc 0.7764227642276422, correct 191/246
class 1: acc 0.6984732824427481, correct 183/262
class 2: acc 0.7890295358649789, correct 187/237

Val Set, val_loss: 0.9078, val_error: 0.3723, auc: 0.7817
class 0 clustering acc 0.9410460992907801: correct 2123/2256
class 1 clustering acc 0.36569148936170215: correct 275/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.25, correct 3/12
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0461, instance_loss: 0.2718, weighted_loss: 0.1138, label: 0, bag_size: 3983
batch 39, loss: 0.2211, instance_loss: 0.3089, weighted_loss: 0.2474, label: 2, bag_size: 2359
batch 59, loss: 0.0262, instance_loss: 0.0824, weighted_loss: 0.0431, label: 0, bag_size: 4015
batch 79, loss: 1.0978, instance_loss: 0.4185, weighted_loss: 0.8940, label: 0, bag_size: 5867
batch 99, loss: 0.1501, instance_loss: 0.3512, weighted_loss: 0.2105, label: 2, bag_size: 5924
batch 119, loss: 0.5178, instance_loss: 0.9310, weighted_loss: 0.6418, label: 1, bag_size: 5728
batch 139, loss: 0.7994, instance_loss: 0.7328, weighted_loss: 0.7794, label: 0, bag_size: 4178
batch 159, loss: 0.6134, instance_loss: 0.6988, weighted_loss: 0.6390, label: 0, bag_size: 313
batch 179, loss: 0.5488, instance_loss: 0.7078, weighted_loss: 0.5965, label: 1, bag_size: 1599
batch 199, loss: 0.2622, instance_loss: 0.4584, weighted_loss: 0.3210, label: 1, bag_size: 796
batch 219, loss: 1.0095, instance_loss: 0.6377, weighted_loss: 0.8979, label: 2, bag_size: 4179
batch 239, loss: 0.3687, instance_loss: 0.4295, weighted_loss: 0.3869, label: 1, bag_size: 700
batch 259, loss: 0.1206, instance_loss: 0.3132, weighted_loss: 0.1784, label: 2, bag_size: 3396
batch 279, loss: 0.3584, instance_loss: 0.4809, weighted_loss: 0.3952, label: 1, bag_size: 2945
batch 299, loss: 0.0000, instance_loss: 1.1547, weighted_loss: 0.3464, label: 0, bag_size: 1709
batch 319, loss: 1.7856, instance_loss: 1.2845, weighted_loss: 1.6352, label: 0, bag_size: 2044
batch 339, loss: 0.0995, instance_loss: 0.2870, weighted_loss: 0.1558, label: 0, bag_size: 3319
batch 359, loss: 0.4361, instance_loss: 0.6062, weighted_loss: 0.4872, label: 0, bag_size: 2232
batch 379, loss: 0.0278, instance_loss: 0.1606, weighted_loss: 0.0676, label: 0, bag_size: 4196
batch 399, loss: 0.1230, instance_loss: 0.2382, weighted_loss: 0.1576, label: 0, bag_size: 4405
batch 419, loss: 4.0930, instance_loss: 1.4133, weighted_loss: 3.2891, label: 0, bag_size: 2896
batch 439, loss: 0.4621, instance_loss: 0.7031, weighted_loss: 0.5344, label: 1, bag_size: 4784
batch 459, loss: 0.0559, instance_loss: 0.8435, weighted_loss: 0.2922, label: 0, bag_size: 1055
batch 479, loss: 0.1546, instance_loss: 0.4087, weighted_loss: 0.2308, label: 0, bag_size: 16741
batch 499, loss: 0.2456, instance_loss: 0.4869, weighted_loss: 0.3180, label: 1, bag_size: 2859
batch 519, loss: 5.3902, instance_loss: 2.2432, weighted_loss: 4.4461, label: 0, bag_size: 1886
batch 539, loss: 1.1998, instance_loss: 0.8990, weighted_loss: 1.1095, label: 1, bag_size: 1500
batch 559, loss: 0.4472, instance_loss: 0.5248, weighted_loss: 0.4705, label: 1, bag_size: 6156
batch 579, loss: 1.0029, instance_loss: 0.8883, weighted_loss: 0.9685, label: 1, bag_size: 4395
batch 599, loss: 0.1485, instance_loss: 0.2895, weighted_loss: 0.1908, label: 2, bag_size: 3397
batch 619, loss: 0.0000, instance_loss: 0.7891, weighted_loss: 0.2367, label: 0, bag_size: 1055
batch 639, loss: 0.0125, instance_loss: 0.4548, weighted_loss: 0.1452, label: 1, bag_size: 3221
batch 659, loss: 0.7019, instance_loss: 0.3502, weighted_loss: 0.5964, label: 2, bag_size: 5914
batch 679, loss: 0.0555, instance_loss: 0.6166, weighted_loss: 0.2238, label: 1, bag_size: 14449
batch 699, loss: 0.0000, instance_loss: 0.0124, weighted_loss: 0.0037, label: 0, bag_size: 5003
batch 719, loss: 1.2170, instance_loss: 0.6590, weighted_loss: 1.0496, label: 1, bag_size: 3100
batch 739, loss: 0.5145, instance_loss: 0.6546, weighted_loss: 0.5565, label: 1, bag_size: 4806


class 0 clustering acc 0.9736577181208054: correct 17409/17880
class 1 clustering acc 0.31359060402684563: correct 1869/5960
Epoch: 25, train_loss: 0.5601, train_clustering_loss:  0.5628, train_error: 0.2295
class 0: acc 0.823076923076923, correct 214/260
class 1: acc 0.6452991452991453, correct 151/234
class 2: acc 0.8326693227091634, correct 209/251

Val Set, val_loss: 1.0605, val_error: 0.3830, auc: 0.7853
class 0 clustering acc 0.9539007092198581: correct 2152/2256
class 1 clustering acc 0.1595744680851064: correct 120/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2516, instance_loss: 0.5922, weighted_loss: 0.3538, label: 0, bag_size: 6440
batch 39, loss: 0.1087, instance_loss: 0.3255, weighted_loss: 0.1737, label: 1, bag_size: 796
batch 59, loss: 0.4538, instance_loss: 0.4998, weighted_loss: 0.4676, label: 0, bag_size: 3070
batch 79, loss: 0.1822, instance_loss: 0.6085, weighted_loss: 0.3101, label: 0, bag_size: 2038
batch 99, loss: 0.2418, instance_loss: 0.4291, weighted_loss: 0.2980, label: 0, bag_size: 5226
batch 119, loss: 0.0626, instance_loss: 0.1542, weighted_loss: 0.0901, label: 2, bag_size: 4140
batch 139, loss: 1.0933, instance_loss: 0.9383, weighted_loss: 1.0468, label: 2, bag_size: 1513
batch 159, loss: 0.0866, instance_loss: 0.4870, weighted_loss: 0.2067, label: 0, bag_size: 3182
batch 179, loss: 0.4289, instance_loss: 0.7629, weighted_loss: 0.5291, label: 2, bag_size: 2486
batch 199, loss: 0.6107, instance_loss: 0.2372, weighted_loss: 0.4986, label: 0, bag_size: 4808
batch 219, loss: 0.3433, instance_loss: 0.5449, weighted_loss: 0.4038, label: 2, bag_size: 4140
batch 239, loss: 0.0941, instance_loss: 0.4149, weighted_loss: 0.1903, label: 0, bag_size: 966
batch 259, loss: 0.8121, instance_loss: 0.5928, weighted_loss: 0.7463, label: 1, bag_size: 3786
batch 279, loss: 0.9085, instance_loss: 0.7905, weighted_loss: 0.8731, label: 1, bag_size: 2671
batch 299, loss: 0.1524, instance_loss: 0.2659, weighted_loss: 0.1864, label: 2, bag_size: 4569
batch 319, loss: 1.2975, instance_loss: 1.1248, weighted_loss: 1.2457, label: 2, bag_size: 4342
batch 339, loss: 0.0347, instance_loss: 0.0930, weighted_loss: 0.0522, label: 2, bag_size: 2483
batch 359, loss: 0.8233, instance_loss: 0.6439, weighted_loss: 0.7694, label: 2, bag_size: 3534
batch 379, loss: 0.4739, instance_loss: 0.3186, weighted_loss: 0.4273, label: 2, bag_size: 3172
batch 399, loss: 0.0481, instance_loss: 0.0973, weighted_loss: 0.0629, label: 2, bag_size: 3415
batch 419, loss: 2.7620, instance_loss: 1.1337, weighted_loss: 2.2735, label: 2, bag_size: 223
batch 439, loss: 0.7737, instance_loss: 0.6557, weighted_loss: 0.7383, label: 1, bag_size: 296
batch 459, loss: 2.6076, instance_loss: 1.2297, weighted_loss: 2.1943, label: 1, bag_size: 5035
batch 479, loss: 2.1189, instance_loss: 0.8076, weighted_loss: 1.7255, label: 0, bag_size: 3711
batch 499, loss: 3.1821, instance_loss: 1.1938, weighted_loss: 2.5856, label: 1, bag_size: 4258
batch 519, loss: 0.0083, instance_loss: 0.1727, weighted_loss: 0.0576, label: 2, bag_size: 4497
batch 539, loss: 0.0000, instance_loss: 0.1904, weighted_loss: 0.0571, label: 0, bag_size: 5053
batch 559, loss: 0.0516, instance_loss: 0.4255, weighted_loss: 0.1637, label: 1, bag_size: 3425
batch 579, loss: 1.3620, instance_loss: 0.8929, weighted_loss: 1.2212, label: 0, bag_size: 6630
batch 599, loss: 0.3193, instance_loss: 0.3325, weighted_loss: 0.3233, label: 1, bag_size: 874
batch 619, loss: 0.1800, instance_loss: 0.5165, weighted_loss: 0.2809, label: 0, bag_size: 386
batch 639, loss: 0.1263, instance_loss: 0.4380, weighted_loss: 0.2198, label: 0, bag_size: 3219
batch 659, loss: 1.6816, instance_loss: 0.9081, weighted_loss: 1.4496, label: 1, bag_size: 4395
batch 679, loss: 1.8427, instance_loss: 1.0082, weighted_loss: 1.5924, label: 1, bag_size: 3016
batch 699, loss: 0.1299, instance_loss: 0.1595, weighted_loss: 0.1388, label: 2, bag_size: 1103
batch 719, loss: 0.2911, instance_loss: 0.6534, weighted_loss: 0.3998, label: 1, bag_size: 2919
batch 739, loss: 0.0909, instance_loss: 0.5802, weighted_loss: 0.2377, label: 1, bag_size: 3611


class 0 clustering acc 0.9718680089485459: correct 17377/17880
class 1 clustering acc 0.3098993288590604: correct 1847/5960
Epoch: 26, train_loss: 0.5900, train_clustering_loss:  0.5825, train_error: 0.2577
class 0: acc 0.7368421052631579, correct 182/247
class 1: acc 0.7104247104247104, correct 184/259
class 2: acc 0.7824267782426778, correct 187/239

Val Set, val_loss: 1.0148, val_error: 0.3617, auc: 0.7781
class 0 clustering acc 0.9525709219858156: correct 2149/2256
class 1 clustering acc 0.2992021276595745: correct 225/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.16666666666666666, correct 2/12
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.5858, instance_loss: 0.6409, weighted_loss: 0.6023, label: 1, bag_size: 6165
batch 39, loss: 0.4773, instance_loss: 0.5471, weighted_loss: 0.4983, label: 1, bag_size: 3640
batch 59, loss: 0.8454, instance_loss: 0.9834, weighted_loss: 0.8868, label: 1, bag_size: 11974
batch 79, loss: 0.6971, instance_loss: 0.4883, weighted_loss: 0.6344, label: 0, bag_size: 5098
batch 99, loss: 0.9734, instance_loss: 0.7056, weighted_loss: 0.8931, label: 1, bag_size: 3109
batch 119, loss: 0.1264, instance_loss: 0.3137, weighted_loss: 0.1826, label: 0, bag_size: 5260
batch 139, loss: 2.1179, instance_loss: 1.6559, weighted_loss: 1.9793, label: 1, bag_size: 936
batch 159, loss: 0.2083, instance_loss: 0.1778, weighted_loss: 0.1992, label: 2, bag_size: 3210
batch 179, loss: 0.2481, instance_loss: 0.4761, weighted_loss: 0.3165, label: 0, bag_size: 702
batch 199, loss: 0.0088, instance_loss: 0.0525, weighted_loss: 0.0219, label: 2, bag_size: 4056
batch 219, loss: 0.0414, instance_loss: 0.2442, weighted_loss: 0.1022, label: 0, bag_size: 4994
batch 239, loss: 0.0386, instance_loss: 0.1457, weighted_loss: 0.0707, label: 0, bag_size: 3443
batch 259, loss: 0.5559, instance_loss: 0.5985, weighted_loss: 0.5687, label: 1, bag_size: 2122
batch 279, loss: 0.0657, instance_loss: 0.0927, weighted_loss: 0.0738, label: 2, bag_size: 2905
batch 299, loss: 0.0221, instance_loss: 0.4492, weighted_loss: 0.1502, label: 0, bag_size: 577
batch 319, loss: 0.0633, instance_loss: 0.9387, weighted_loss: 0.3259, label: 1, bag_size: 314
batch 339, loss: 0.2307, instance_loss: 0.4144, weighted_loss: 0.2858, label: 1, bag_size: 3493
batch 359, loss: 0.0629, instance_loss: 0.3094, weighted_loss: 0.1369, label: 1, bag_size: 582
batch 379, loss: 0.0345, instance_loss: 0.4000, weighted_loss: 0.1441, label: 0, bag_size: 6138
batch 399, loss: 0.1185, instance_loss: 0.3754, weighted_loss: 0.1956, label: 0, bag_size: 7177
batch 419, loss: 0.6147, instance_loss: 0.5499, weighted_loss: 0.5953, label: 1, bag_size: 5512
batch 439, loss: 1.6496, instance_loss: 0.8296, weighted_loss: 1.4036, label: 0, bag_size: 5837
batch 459, loss: 0.0301, instance_loss: 0.9474, weighted_loss: 0.3053, label: 0, bag_size: 1933
batch 479, loss: 0.0083, instance_loss: 0.2751, weighted_loss: 0.0883, label: 1, bag_size: 2643
batch 499, loss: 0.1604, instance_loss: 0.2812, weighted_loss: 0.1966, label: 2, bag_size: 4775
batch 519, loss: 0.0185, instance_loss: 0.4680, weighted_loss: 0.1534, label: 1, bag_size: 1542
batch 539, loss: 0.6972, instance_loss: 0.7259, weighted_loss: 0.7058, label: 1, bag_size: 5412
batch 559, loss: 3.3701, instance_loss: 1.2206, weighted_loss: 2.7252, label: 0, bag_size: 1755
batch 579, loss: 1.1204, instance_loss: 0.8106, weighted_loss: 1.0275, label: 1, bag_size: 3016
batch 599, loss: 1.2769, instance_loss: 0.7343, weighted_loss: 1.1142, label: 2, bag_size: 6298
batch 619, loss: 1.2336, instance_loss: 0.7525, weighted_loss: 1.0893, label: 2, bag_size: 3534
batch 639, loss: 0.3678, instance_loss: 0.5752, weighted_loss: 0.4300, label: 2, bag_size: 3778
batch 659, loss: 0.1033, instance_loss: 0.1921, weighted_loss: 0.1299, label: 2, bag_size: 3172
batch 679, loss: 0.2269, instance_loss: 0.4209, weighted_loss: 0.2851, label: 0, bag_size: 4994
batch 699, loss: 0.0134, instance_loss: 0.3267, weighted_loss: 0.1074, label: 1, bag_size: 3338
batch 719, loss: 0.2728, instance_loss: 0.5575, weighted_loss: 0.3582, label: 1, bag_size: 4192
batch 739, loss: 1.0884, instance_loss: 0.9605, weighted_loss: 1.0500, label: 1, bag_size: 1307


class 0 clustering acc 0.9694630872483222: correct 17334/17880
class 1 clustering acc 0.29899328859060403: correct 1782/5960
Epoch: 27, train_loss: 0.5984, train_clustering_loss:  0.5885, train_error: 0.2483
class 0: acc 0.7983870967741935, correct 198/248
class 1: acc 0.6846153846153846, correct 178/260
class 2: acc 0.7763713080168776, correct 184/237

Val Set, val_loss: 0.8983, val_error: 0.3511, auc: 0.8017
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.057180851063829786: correct 43/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1585, instance_loss: 0.5543, weighted_loss: 0.2772, label: 1, bag_size: 10941
batch 39, loss: 0.5803, instance_loss: 0.6965, weighted_loss: 0.6152, label: 0, bag_size: 3915
batch 59, loss: 0.9692, instance_loss: 0.7593, weighted_loss: 0.9062, label: 1, bag_size: 2671
batch 79, loss: 0.2493, instance_loss: 0.3639, weighted_loss: 0.2837, label: 2, bag_size: 4978
batch 99, loss: 0.2443, instance_loss: 0.4503, weighted_loss: 0.3061, label: 2, bag_size: 614
batch 119, loss: 0.1123, instance_loss: 0.4222, weighted_loss: 0.2053, label: 2, bag_size: 3810
batch 139, loss: 0.0000, instance_loss: 0.1790, weighted_loss: 0.0537, label: 0, bag_size: 4918
batch 159, loss: 0.0315, instance_loss: 0.0996, weighted_loss: 0.0519, label: 2, bag_size: 1094
batch 179, loss: 0.0560, instance_loss: 0.4014, weighted_loss: 0.1596, label: 1, bag_size: 1836
batch 199, loss: 0.3557, instance_loss: 0.3892, weighted_loss: 0.3657, label: 2, bag_size: 3534
batch 219, loss: 0.0672, instance_loss: 0.5727, weighted_loss: 0.2188, label: 1, bag_size: 2453
batch 239, loss: 0.4496, instance_loss: 0.6773, weighted_loss: 0.5179, label: 1, bag_size: 3396
batch 259, loss: 0.0891, instance_loss: 0.4793, weighted_loss: 0.2061, label: 0, bag_size: 1170
batch 279, loss: 3.7771, instance_loss: 1.0739, weighted_loss: 2.9661, label: 2, bag_size: 223
batch 299, loss: 2.9678, instance_loss: 1.1430, weighted_loss: 2.4204, label: 0, bag_size: 2896
batch 319, loss: 0.3218, instance_loss: 0.2835, weighted_loss: 0.3103, label: 2, bag_size: 2501
batch 339, loss: 0.5526, instance_loss: 0.6816, weighted_loss: 0.5913, label: 0, bag_size: 3904
batch 359, loss: 0.0477, instance_loss: 0.1178, weighted_loss: 0.0687, label: 2, bag_size: 5011
batch 379, loss: 1.4161, instance_loss: 0.6997, weighted_loss: 1.2012, label: 1, bag_size: 1510
batch 399, loss: 0.0343, instance_loss: 0.7736, weighted_loss: 0.2561, label: 0, bag_size: 889
batch 419, loss: 0.4948, instance_loss: 0.7754, weighted_loss: 0.5790, label: 1, bag_size: 6689
batch 439, loss: 1.4521, instance_loss: 1.0564, weighted_loss: 1.3334, label: 2, bag_size: 4342
batch 459, loss: 0.0553, instance_loss: 0.3270, weighted_loss: 0.1368, label: 0, bag_size: 4721
batch 479, loss: 1.8404, instance_loss: 1.0794, weighted_loss: 1.6121, label: 1, bag_size: 5072
batch 499, loss: 0.0738, instance_loss: 0.2283, weighted_loss: 0.1202, label: 1, bag_size: 862
batch 519, loss: 0.0566, instance_loss: 0.2209, weighted_loss: 0.1059, label: 0, bag_size: 5282
batch 539, loss: 1.9524, instance_loss: 1.0026, weighted_loss: 1.6675, label: 2, bag_size: 1513
batch 559, loss: 0.0331, instance_loss: 0.1411, weighted_loss: 0.0655, label: 2, bag_size: 3285
batch 579, loss: 0.0598, instance_loss: 0.2746, weighted_loss: 0.1242, label: 0, bag_size: 3443
batch 599, loss: 0.0407, instance_loss: 0.2445, weighted_loss: 0.1018, label: 2, bag_size: 3497
batch 619, loss: 0.9473, instance_loss: 0.9329, weighted_loss: 0.9430, label: 2, bag_size: 4571
batch 639, loss: 0.0507, instance_loss: 0.2086, weighted_loss: 0.0981, label: 2, bag_size: 4203
batch 659, loss: 0.1474, instance_loss: 0.3221, weighted_loss: 0.1998, label: 2, bag_size: 4140
batch 679, loss: 0.0507, instance_loss: 0.3965, weighted_loss: 0.1544, label: 2, bag_size: 3497
batch 699, loss: 1.0813, instance_loss: 0.7254, weighted_loss: 0.9745, label: 1, bag_size: 3786
batch 719, loss: 0.3378, instance_loss: 0.4344, weighted_loss: 0.3668, label: 0, bag_size: 2608
batch 739, loss: 0.2297, instance_loss: 0.3668, weighted_loss: 0.2709, label: 2, bag_size: 6704


class 0 clustering acc 0.979586129753915: correct 17515/17880
class 1 clustering acc 0.32600671140939597: correct 1943/5960
Epoch: 28, train_loss: 0.5626, train_clustering_loss:  0.5488, train_error: 0.2349
class 0: acc 0.8113207547169812, correct 215/265
class 1: acc 0.6289592760180995, correct 139/221
class 2: acc 0.833976833976834, correct 216/259

Val Set, val_loss: 0.9706, val_error: 0.3191, auc: 0.7960
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.17819148936170212: correct 134/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1655, instance_loss: 0.3156, weighted_loss: 0.2105, label: 1, bag_size: 700
batch 39, loss: 0.4797, instance_loss: 0.5061, weighted_loss: 0.4876, label: 0, bag_size: 1662
batch 59, loss: 0.0433, instance_loss: 0.0630, weighted_loss: 0.0492, label: 2, bag_size: 4691
batch 79, loss: 0.3356, instance_loss: 0.5778, weighted_loss: 0.4083, label: 1, bag_size: 2919
batch 99, loss: 1.6198, instance_loss: 1.3408, weighted_loss: 1.5361, label: 0, bag_size: 5330
batch 119, loss: 1.3548, instance_loss: 0.9226, weighted_loss: 1.2251, label: 0, bag_size: 15388
batch 139, loss: 2.2883, instance_loss: 0.9082, weighted_loss: 1.8742, label: 2, bag_size: 909
batch 159, loss: 0.4308, instance_loss: 0.3257, weighted_loss: 0.3993, label: 1, bag_size: 2878
batch 179, loss: 0.2037, instance_loss: 0.3059, weighted_loss: 0.2344, label: 2, bag_size: 3778
batch 199, loss: 0.6969, instance_loss: 0.5174, weighted_loss: 0.6431, label: 2, bag_size: 3534
batch 219, loss: 0.8365, instance_loss: 0.6794, weighted_loss: 0.7894, label: 1, bag_size: 2859
batch 239, loss: 0.3461, instance_loss: 0.4530, weighted_loss: 0.3782, label: 2, bag_size: 4140
batch 259, loss: 0.1503, instance_loss: 0.1786, weighted_loss: 0.1588, label: 0, bag_size: 2873
batch 279, loss: 0.1899, instance_loss: 0.6433, weighted_loss: 0.3259, label: 0, bag_size: 4485
batch 299, loss: 0.4950, instance_loss: 0.3200, weighted_loss: 0.4425, label: 2, bag_size: 3546
batch 319, loss: 0.0088, instance_loss: 0.1722, weighted_loss: 0.0578, label: 0, bag_size: 1132
batch 339, loss: 0.0334, instance_loss: 0.0555, weighted_loss: 0.0400, label: 2, bag_size: 4056
batch 359, loss: 0.1579, instance_loss: 0.3120, weighted_loss: 0.2041, label: 1, bag_size: 1410
batch 379, loss: 0.4836, instance_loss: 0.6025, weighted_loss: 0.5193, label: 2, bag_size: 3172
batch 399, loss: 0.1345, instance_loss: 0.5034, weighted_loss: 0.2452, label: 1, bag_size: 5385
batch 419, loss: 0.1914, instance_loss: 0.2423, weighted_loss: 0.2067, label: 0, bag_size: 5108
batch 439, loss: 2.7098, instance_loss: 1.1025, weighted_loss: 2.2276, label: 0, bag_size: 4572
batch 459, loss: 0.0324, instance_loss: 0.0825, weighted_loss: 0.0474, label: 2, bag_size: 3415
batch 479, loss: 0.0044, instance_loss: 0.6154, weighted_loss: 0.1877, label: 0, bag_size: 2231
batch 499, loss: 0.0011, instance_loss: 0.3153, weighted_loss: 0.0954, label: 1, bag_size: 3677
batch 519, loss: 0.3033, instance_loss: 0.4812, weighted_loss: 0.3567, label: 0, bag_size: 1417
batch 539, loss: 0.2959, instance_loss: 0.5354, weighted_loss: 0.3677, label: 1, bag_size: 3422
batch 559, loss: 0.2761, instance_loss: 0.4072, weighted_loss: 0.3154, label: 2, bag_size: 5914
batch 579, loss: 0.3448, instance_loss: 0.2538, weighted_loss: 0.3175, label: 2, bag_size: 705
batch 599, loss: 0.0818, instance_loss: 0.3597, weighted_loss: 0.1652, label: 1, bag_size: 3337
batch 619, loss: 0.1061, instance_loss: 0.4518, weighted_loss: 0.2098, label: 0, bag_size: 6015
batch 639, loss: 3.6893, instance_loss: 1.6329, weighted_loss: 3.0724, label: 0, bag_size: 7504
batch 659, loss: 0.2138, instance_loss: 0.5690, weighted_loss: 0.3203, label: 2, bag_size: 5017
batch 679, loss: 0.0402, instance_loss: 0.0804, weighted_loss: 0.0523, label: 2, bag_size: 4856
batch 699, loss: 0.6883, instance_loss: 0.4889, weighted_loss: 0.6285, label: 2, bag_size: 5406
batch 719, loss: 0.0142, instance_loss: 0.1832, weighted_loss: 0.0649, label: 1, bag_size: 4290
batch 739, loss: 0.5765, instance_loss: 0.5397, weighted_loss: 0.5654, label: 2, bag_size: 4291


class 0 clustering acc 0.9728187919463087: correct 17394/17880
class 1 clustering acc 0.35956375838926175: correct 2143/5960
Epoch: 29, train_loss: 0.5658, train_clustering_loss:  0.5458, train_error: 0.2389
class 0: acc 0.7747035573122529, correct 196/253
class 1: acc 0.6842105263157895, correct 169/247
class 2: acc 0.8244897959183674, correct 202/245

Val Set, val_loss: 1.0464, val_error: 0.3830, auc: 0.7868
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.18085106382978725: correct 136/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 29 out of 20


batch 19, loss: 1.2081, instance_loss: 0.7171, weighted_loss: 1.0608, label: 2, bag_size: 3274
batch 39, loss: 0.0164, instance_loss: 0.6412, weighted_loss: 0.2039, label: 1, bag_size: 5026
batch 59, loss: 0.0411, instance_loss: 0.1312, weighted_loss: 0.0681, label: 2, bag_size: 6001
batch 79, loss: 0.0096, instance_loss: 0.2826, weighted_loss: 0.0915, label: 0, bag_size: 6138
batch 99, loss: 0.6258, instance_loss: 0.7058, weighted_loss: 0.6498, label: 1, bag_size: 3533
batch 119, loss: 0.1052, instance_loss: 0.2763, weighted_loss: 0.1565, label: 2, bag_size: 5017
batch 139, loss: 0.0092, instance_loss: 0.3977, weighted_loss: 0.1258, label: 1, bag_size: 2009
batch 159, loss: 0.1434, instance_loss: 0.6428, weighted_loss: 0.2932, label: 0, bag_size: 4479
batch 179, loss: 0.7259, instance_loss: 0.7073, weighted_loss: 0.7204, label: 1, bag_size: 2747
batch 199, loss: 1.2486, instance_loss: 0.8452, weighted_loss: 1.1276, label: 2, bag_size: 4291
batch 219, loss: 0.1732, instance_loss: 0.2844, weighted_loss: 0.2066, label: 0, bag_size: 829
batch 239, loss: 0.5410, instance_loss: 0.9166, weighted_loss: 0.6537, label: 1, bag_size: 2905
batch 259, loss: 0.3193, instance_loss: 0.3545, weighted_loss: 0.3299, label: 0, bag_size: 1782
batch 279, loss: 0.8481, instance_loss: 0.5880, weighted_loss: 0.7701, label: 2, bag_size: 5637
batch 299, loss: 0.1264, instance_loss: 0.3967, weighted_loss: 0.2075, label: 2, bag_size: 3327
batch 319, loss: 0.0998, instance_loss: 0.4815, weighted_loss: 0.2143, label: 0, bag_size: 1417
batch 339, loss: 0.0810, instance_loss: 0.4782, weighted_loss: 0.2001, label: 0, bag_size: 2038
batch 359, loss: 0.8786, instance_loss: 1.5183, weighted_loss: 1.0705, label: 1, bag_size: 3791
batch 379, loss: 0.4670, instance_loss: 0.6567, weighted_loss: 0.5239, label: 2, bag_size: 2486
batch 399, loss: 1.8506, instance_loss: 1.1484, weighted_loss: 1.6399, label: 0, bag_size: 4626
batch 419, loss: 0.0777, instance_loss: 0.4893, weighted_loss: 0.2012, label: 0, bag_size: 4351
batch 439, loss: 1.3312, instance_loss: 1.1365, weighted_loss: 1.2728, label: 0, bag_size: 313
batch 459, loss: 1.4188, instance_loss: 1.0548, weighted_loss: 1.3096, label: 0, bag_size: 313
batch 479, loss: 1.3052, instance_loss: 0.6645, weighted_loss: 1.1130, label: 0, bag_size: 3382
batch 499, loss: 0.0003, instance_loss: 0.1971, weighted_loss: 0.0593, label: 0, bag_size: 855
batch 519, loss: 0.1594, instance_loss: 0.2349, weighted_loss: 0.1820, label: 2, bag_size: 2905
batch 539, loss: 0.1651, instance_loss: 0.4974, weighted_loss: 0.2648, label: 0, bag_size: 5368
batch 559, loss: 0.0245, instance_loss: 0.2609, weighted_loss: 0.0955, label: 1, bag_size: 874
batch 579, loss: 0.6031, instance_loss: 0.4859, weighted_loss: 0.5679, label: 0, bag_size: 11663
batch 599, loss: 0.4541, instance_loss: 0.4005, weighted_loss: 0.4380, label: 0, bag_size: 5413
batch 619, loss: 0.0620, instance_loss: 0.1820, weighted_loss: 0.0980, label: 2, bag_size: 3121
batch 639, loss: 0.5198, instance_loss: 0.4260, weighted_loss: 0.4916, label: 0, bag_size: 4122
batch 659, loss: 0.5203, instance_loss: 0.4436, weighted_loss: 0.4973, label: 0, bag_size: 5656
batch 679, loss: 0.7344, instance_loss: 0.8767, weighted_loss: 0.7771, label: 1, bag_size: 5412
batch 699, loss: 0.6864, instance_loss: 0.4812, weighted_loss: 0.6248, label: 0, bag_size: 5848
batch 719, loss: 0.1548, instance_loss: 0.3695, weighted_loss: 0.2192, label: 0, bag_size: 5260
batch 739, loss: 0.0419, instance_loss: 0.2393, weighted_loss: 0.1011, label: 1, bag_size: 5026


class 0 clustering acc 0.9743847874720358: correct 17422/17880
class 1 clustering acc 0.31644295302013425: correct 1886/5960
Epoch: 30, train_loss: 0.5523, train_clustering_loss:  0.5613, train_error: 0.2362
class 0: acc 0.7868217054263565, correct 203/258
class 1: acc 0.6877470355731226, correct 174/253
class 2: acc 0.8205128205128205, correct 192/234

Val Set, val_loss: 0.9533, val_error: 0.2872, auc: 0.8007
class 0 clustering acc 0.9601063829787234: correct 2166/2256
class 1 clustering acc 0.23404255319148937: correct 176/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.1427, instance_loss: 0.1307, weighted_loss: 0.1391, label: 2, bag_size: 3112
batch 39, loss: 2.0397, instance_loss: 0.9057, weighted_loss: 1.6995, label: 2, bag_size: 728
batch 59, loss: 2.7197, instance_loss: 1.2301, weighted_loss: 2.2728, label: 2, bag_size: 1513
batch 79, loss: 0.7971, instance_loss: 0.6933, weighted_loss: 0.7659, label: 0, bag_size: 3341
batch 99, loss: 1.9282, instance_loss: 0.9968, weighted_loss: 1.6488, label: 2, bag_size: 909
batch 119, loss: 0.0446, instance_loss: 0.2379, weighted_loss: 0.1026, label: 2, bag_size: 3497
batch 139, loss: 1.0948, instance_loss: 0.8884, weighted_loss: 1.0329, label: 0, bag_size: 5656
batch 159, loss: 3.1018, instance_loss: 1.1341, weighted_loss: 2.5115, label: 2, bag_size: 728
batch 179, loss: 0.2336, instance_loss: 0.5476, weighted_loss: 0.3278, label: 1, bag_size: 4869
batch 199, loss: 0.8607, instance_loss: 0.6244, weighted_loss: 0.7898, label: 1, bag_size: 832
batch 219, loss: 0.4934, instance_loss: 0.6951, weighted_loss: 0.5539, label: 1, bag_size: 3475
batch 239, loss: 0.0106, instance_loss: 0.1377, weighted_loss: 0.0487, label: 2, bag_size: 88
batch 259, loss: 0.2178, instance_loss: 0.6815, weighted_loss: 0.3569, label: 1, bag_size: 3475
batch 279, loss: 0.6850, instance_loss: 0.6684, weighted_loss: 0.6800, label: 1, bag_size: 4812
batch 299, loss: 3.7630, instance_loss: 1.3780, weighted_loss: 3.0475, label: 1, bag_size: 7176
batch 319, loss: 0.2524, instance_loss: 0.4785, weighted_loss: 0.3203, label: 2, bag_size: 6594
batch 339, loss: 0.1424, instance_loss: 0.2755, weighted_loss: 0.1823, label: 0, bag_size: 2094
batch 359, loss: 0.1870, instance_loss: 0.3943, weighted_loss: 0.2492, label: 0, bag_size: 4997
batch 379, loss: 0.8874, instance_loss: 0.6126, weighted_loss: 0.8049, label: 1, bag_size: 4467
batch 399, loss: 0.0843, instance_loss: 0.2822, weighted_loss: 0.1437, label: 2, bag_size: 4140
batch 419, loss: 0.3190, instance_loss: 0.6103, weighted_loss: 0.4064, label: 1, bag_size: 4119
batch 439, loss: 1.0437, instance_loss: 0.8477, weighted_loss: 0.9849, label: 1, bag_size: 1327
batch 459, loss: 0.0810, instance_loss: 0.2504, weighted_loss: 0.1318, label: 0, bag_size: 3406
batch 479, loss: 0.5702, instance_loss: 0.5783, weighted_loss: 0.5726, label: 0, bag_size: 3793
batch 499, loss: 0.5539, instance_loss: 0.4193, weighted_loss: 0.5135, label: 2, bag_size: 3227
batch 519, loss: 0.3492, instance_loss: 0.5391, weighted_loss: 0.4062, label: 0, bag_size: 1762
batch 539, loss: 0.1715, instance_loss: 0.4035, weighted_loss: 0.2411, label: 1, bag_size: 712
batch 559, loss: 0.4605, instance_loss: 0.4675, weighted_loss: 0.4626, label: 2, bag_size: 5914
batch 579, loss: 0.8817, instance_loss: 0.7282, weighted_loss: 0.8357, label: 1, bag_size: 5072
batch 599, loss: 0.5466, instance_loss: 0.6017, weighted_loss: 0.5631, label: 1, bag_size: 2671
batch 619, loss: 1.3154, instance_loss: 0.8648, weighted_loss: 1.1803, label: 2, bag_size: 3274
batch 639, loss: 0.1365, instance_loss: 0.4606, weighted_loss: 0.2337, label: 0, bag_size: 5992
batch 659, loss: 0.1002, instance_loss: 0.4169, weighted_loss: 0.1952, label: 2, bag_size: 3497
batch 679, loss: 0.0108, instance_loss: 0.4785, weighted_loss: 0.1511, label: 1, bag_size: 3761
batch 699, loss: 0.1964, instance_loss: 0.7196, weighted_loss: 0.3533, label: 0, bag_size: 14070
batch 719, loss: 0.2306, instance_loss: 0.5454, weighted_loss: 0.3250, label: 0, bag_size: 4531
batch 739, loss: 1.0579, instance_loss: 0.7613, weighted_loss: 0.9689, label: 0, bag_size: 14432


class 0 clustering acc 0.9747762863534676: correct 17429/17880
class 1 clustering acc 0.2954697986577181: correct 1761/5960
Epoch: 31, train_loss: 0.6148, train_clustering_loss:  0.5784, train_error: 0.2617
class 0: acc 0.7456896551724138, correct 173/232
class 1: acc 0.6830188679245283, correct 181/265
class 2: acc 0.7903225806451613, correct 196/248

Val Set, val_loss: 1.0523, val_error: 0.3298, auc: 0.7981
class 0 clustering acc 0.9454787234042553: correct 2133/2256
class 1 clustering acc 0.25: correct 188/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.5666, instance_loss: 0.8448, weighted_loss: 0.6501, label: 1, bag_size: 3534
batch 39, loss: 0.2020, instance_loss: 0.3565, weighted_loss: 0.2483, label: 0, bag_size: 3334
batch 59, loss: 0.0000, instance_loss: 0.1166, weighted_loss: 0.0350, label: 0, bag_size: 1087
batch 79, loss: 2.1639, instance_loss: 1.5570, weighted_loss: 1.9818, label: 1, bag_size: 2852
batch 99, loss: 0.4487, instance_loss: 0.6701, weighted_loss: 0.5151, label: 1, bag_size: 2302
batch 119, loss: 1.0055, instance_loss: 0.7512, weighted_loss: 0.9292, label: 1, bag_size: 5276
batch 139, loss: 0.1135, instance_loss: 0.3178, weighted_loss: 0.1748, label: 2, bag_size: 3497
batch 159, loss: 0.0240, instance_loss: 0.2575, weighted_loss: 0.0941, label: 0, bag_size: 4292
batch 179, loss: 0.9193, instance_loss: 0.9482, weighted_loss: 0.9279, label: 0, bag_size: 1289
batch 199, loss: 0.0156, instance_loss: 0.2902, weighted_loss: 0.0980, label: 2, bag_size: 4497
batch 219, loss: 0.0284, instance_loss: 0.2688, weighted_loss: 0.1005, label: 0, bag_size: 1132
batch 239, loss: 0.2594, instance_loss: 0.5584, weighted_loss: 0.3491, label: 2, bag_size: 2813
batch 259, loss: 0.0079, instance_loss: 0.1366, weighted_loss: 0.0465, label: 0, bag_size: 4994
batch 279, loss: 0.1519, instance_loss: 0.2789, weighted_loss: 0.1900, label: 0, bag_size: 4734
batch 299, loss: 0.0112, instance_loss: 0.2242, weighted_loss: 0.0751, label: 0, bag_size: 4070
batch 319, loss: 0.0305, instance_loss: 0.0867, weighted_loss: 0.0474, label: 2, bag_size: 3583
batch 339, loss: 0.3095, instance_loss: 0.3536, weighted_loss: 0.3227, label: 0, bag_size: 3789
batch 359, loss: 0.8640, instance_loss: 0.9460, weighted_loss: 0.8886, label: 2, bag_size: 4342
batch 379, loss: 0.5512, instance_loss: 0.7104, weighted_loss: 0.5990, label: 1, bag_size: 2122
batch 399, loss: 1.9841, instance_loss: 0.8076, weighted_loss: 1.6311, label: 0, bag_size: 2189
batch 419, loss: 0.2640, instance_loss: 0.3095, weighted_loss: 0.2776, label: 2, bag_size: 3497
batch 439, loss: 1.0896, instance_loss: 0.7674, weighted_loss: 0.9929, label: 2, bag_size: 1513
batch 459, loss: 0.1295, instance_loss: 0.2211, weighted_loss: 0.1570, label: 2, bag_size: 3396
batch 479, loss: 0.7781, instance_loss: 0.7041, weighted_loss: 0.7559, label: 1, bag_size: 2859
batch 499, loss: 0.1015, instance_loss: 0.3848, weighted_loss: 0.1865, label: 1, bag_size: 6243
batch 519, loss: 0.2673, instance_loss: 0.4468, weighted_loss: 0.3211, label: 2, bag_size: 2049
batch 539, loss: 0.1260, instance_loss: 0.3598, weighted_loss: 0.1961, label: 2, bag_size: 5037
batch 559, loss: 0.2145, instance_loss: 0.9924, weighted_loss: 0.4479, label: 0, bag_size: 1933
batch 579, loss: 0.2637, instance_loss: 0.2842, weighted_loss: 0.2698, label: 2, bag_size: 2359
batch 599, loss: 0.7244, instance_loss: 0.6432, weighted_loss: 0.7000, label: 0, bag_size: 4946
batch 619, loss: 1.2145, instance_loss: 1.2680, weighted_loss: 1.2305, label: 1, bag_size: 936
batch 639, loss: 2.2219, instance_loss: 1.8860, weighted_loss: 2.1211, label: 1, bag_size: 936
batch 659, loss: 0.0150, instance_loss: 0.1920, weighted_loss: 0.0681, label: 2, bag_size: 2770
batch 679, loss: 0.5441, instance_loss: 1.4226, weighted_loss: 0.8077, label: 0, bag_size: 3367
batch 699, loss: 0.0099, instance_loss: 0.2715, weighted_loss: 0.0884, label: 2, bag_size: 614
batch 719, loss: 1.3281, instance_loss: 1.1035, weighted_loss: 1.2607, label: 1, bag_size: 2055
batch 739, loss: 2.3050, instance_loss: 1.2406, weighted_loss: 1.9857, label: 1, bag_size: 1712


class 0 clustering acc 0.9722595078299776: correct 17384/17880
class 1 clustering acc 0.362248322147651: correct 2159/5960
Epoch: 32, train_loss: 0.5258, train_clustering_loss:  0.5423, train_error: 0.2161
class 0: acc 0.8242677824267782, correct 197/239
class 1: acc 0.65625, correct 147/224
class 2: acc 0.851063829787234, correct 240/282

Val Set, val_loss: 1.1294, val_error: 0.3830, auc: 0.7964
class 0 clustering acc 0.9295212765957447: correct 2097/2256
class 1 clustering acc 0.27925531914893614: correct 210/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0095, instance_loss: 1.0970, weighted_loss: 0.3357, label: 0, bag_size: 2231
batch 39, loss: 0.2237, instance_loss: 0.1747, weighted_loss: 0.2090, label: 2, bag_size: 3546
batch 59, loss: 0.0598, instance_loss: 0.4761, weighted_loss: 0.1847, label: 0, bag_size: 4865
batch 79, loss: 0.1202, instance_loss: 0.4964, weighted_loss: 0.2330, label: 2, bag_size: 3604
batch 99, loss: 0.0110, instance_loss: 0.5010, weighted_loss: 0.1580, label: 0, bag_size: 5519
batch 119, loss: 1.1362, instance_loss: 1.1747, weighted_loss: 1.1478, label: 1, bag_size: 5880
batch 139, loss: 0.4563, instance_loss: 0.5674, weighted_loss: 0.4896, label: 0, bag_size: 272
batch 159, loss: 0.0247, instance_loss: 0.3117, weighted_loss: 0.1108, label: 1, bag_size: 4599
batch 179, loss: 0.4171, instance_loss: 0.5151, weighted_loss: 0.4465, label: 1, bag_size: 6817
batch 199, loss: 0.3141, instance_loss: 0.8305, weighted_loss: 0.4690, label: 1, bag_size: 2905
batch 219, loss: 0.5021, instance_loss: 0.6556, weighted_loss: 0.5482, label: 1, bag_size: 2859
batch 239, loss: 0.1022, instance_loss: 0.6462, weighted_loss: 0.2654, label: 0, bag_size: 2195
batch 259, loss: 0.0478, instance_loss: 0.0734, weighted_loss: 0.0555, label: 2, bag_size: 3678
batch 279, loss: 1.1844, instance_loss: 0.7557, weighted_loss: 1.0558, label: 1, bag_size: 296
batch 299, loss: 0.7853, instance_loss: 0.5993, weighted_loss: 0.7295, label: 1, bag_size: 2743
batch 319, loss: 0.6106, instance_loss: 0.4629, weighted_loss: 0.5663, label: 1, bag_size: 3050
batch 339, loss: 4.3773, instance_loss: 1.8201, weighted_loss: 3.6101, label: 1, bag_size: 2425
batch 359, loss: 0.0306, instance_loss: 0.2289, weighted_loss: 0.0901, label: 1, bag_size: 1836
batch 379, loss: 0.0024, instance_loss: 0.2741, weighted_loss: 0.0839, label: 0, bag_size: 4196
batch 399, loss: 0.1804, instance_loss: 0.3382, weighted_loss: 0.2278, label: 0, bag_size: 4827
batch 419, loss: 1.0626, instance_loss: 0.6351, weighted_loss: 0.9343, label: 2, bag_size: 2326
batch 439, loss: 2.0641, instance_loss: 1.2579, weighted_loss: 1.8222, label: 1, bag_size: 7176
batch 459, loss: 0.3055, instance_loss: 0.3213, weighted_loss: 0.3102, label: 0, bag_size: 5871
batch 479, loss: 2.0994, instance_loss: 1.1717, weighted_loss: 1.8211, label: 0, bag_size: 5023
batch 499, loss: 1.3857, instance_loss: 0.9101, weighted_loss: 1.2430, label: 2, bag_size: 4179
batch 519, loss: 0.3568, instance_loss: 0.3640, weighted_loss: 0.3590, label: 2, bag_size: 3546
batch 539, loss: 0.0001, instance_loss: 0.0167, weighted_loss: 0.0051, label: 1, bag_size: 5462
batch 559, loss: 3.0173, instance_loss: 1.4124, weighted_loss: 2.5358, label: 1, bag_size: 2425
batch 579, loss: 0.0565, instance_loss: 0.4640, weighted_loss: 0.1787, label: 1, bag_size: 6513
batch 599, loss: 0.0411, instance_loss: 0.0976, weighted_loss: 0.0580, label: 2, bag_size: 3327
batch 619, loss: 0.5350, instance_loss: 0.7160, weighted_loss: 0.5893, label: 0, bag_size: 622
batch 639, loss: 0.0847, instance_loss: 0.3108, weighted_loss: 0.1525, label: 1, bag_size: 3493
batch 659, loss: 1.4158, instance_loss: 1.0827, weighted_loss: 1.3158, label: 0, bag_size: 7056
batch 679, loss: 1.2608, instance_loss: 0.7767, weighted_loss: 1.1156, label: 0, bag_size: 4178
batch 699, loss: 1.1252, instance_loss: 0.8941, weighted_loss: 1.0559, label: 1, bag_size: 1595
batch 719, loss: 0.2780, instance_loss: 0.2318, weighted_loss: 0.2641, label: 2, bag_size: 1103
batch 739, loss: 0.2657, instance_loss: 0.4586, weighted_loss: 0.3236, label: 2, bag_size: 6594


class 0 clustering acc 0.9697986577181208: correct 17340/17880
class 1 clustering acc 0.3427852348993289: correct 2043/5960
Epoch: 33, train_loss: 0.5509, train_clustering_loss:  0.5510, train_error: 0.2403
class 0: acc 0.7339055793991416, correct 171/233
class 1: acc 0.7241379310344828, correct 189/261
class 2: acc 0.8207171314741036, correct 206/251

Val Set, val_loss: 1.0471, val_error: 0.2872, auc: 0.8221
class 0 clustering acc 0.950354609929078: correct 2144/2256
class 1 clustering acc 0.3683510638297872: correct 277/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.7407, instance_loss: 0.6301, weighted_loss: 0.7075, label: 0, bag_size: 4921
batch 39, loss: 0.2158, instance_loss: 0.5131, weighted_loss: 0.3050, label: 1, bag_size: 5084
batch 59, loss: 0.0591, instance_loss: 0.1393, weighted_loss: 0.0831, label: 0, bag_size: 2019
batch 79, loss: 0.0949, instance_loss: 0.2464, weighted_loss: 0.1404, label: 2, bag_size: 4203
batch 99, loss: 0.1384, instance_loss: 0.4836, weighted_loss: 0.2420, label: 0, bag_size: 5377
batch 119, loss: 0.2397, instance_loss: 0.4654, weighted_loss: 0.3074, label: 0, bag_size: 2830
batch 139, loss: 0.2987, instance_loss: 0.3863, weighted_loss: 0.3250, label: 0, bag_size: 3915
batch 159, loss: 0.8422, instance_loss: 0.2918, weighted_loss: 0.6771, label: 1, bag_size: 5167
batch 179, loss: 0.5209, instance_loss: 0.9169, weighted_loss: 0.6397, label: 2, bag_size: 4571
batch 199, loss: 0.1913, instance_loss: 0.1685, weighted_loss: 0.1844, label: 2, bag_size: 4691
batch 219, loss: 0.4043, instance_loss: 0.5292, weighted_loss: 0.4418, label: 2, bag_size: 22464
batch 239, loss: 0.3954, instance_loss: 0.5365, weighted_loss: 0.4377, label: 0, bag_size: 829
batch 259, loss: 0.4842, instance_loss: 0.5355, weighted_loss: 0.4996, label: 1, bag_size: 3184
batch 279, loss: 1.2422, instance_loss: 0.5978, weighted_loss: 1.0489, label: 0, bag_size: 3382
batch 299, loss: 3.1155, instance_loss: 1.4257, weighted_loss: 2.6086, label: 1, bag_size: 2425
batch 319, loss: 0.4020, instance_loss: 0.5842, weighted_loss: 0.4567, label: 0, bag_size: 4524
batch 339, loss: 0.3126, instance_loss: 0.8450, weighted_loss: 0.4723, label: 1, bag_size: 3986
batch 359, loss: 0.2382, instance_loss: 0.4197, weighted_loss: 0.2926, label: 2, bag_size: 5037
batch 379, loss: 0.0246, instance_loss: 0.4107, weighted_loss: 0.1404, label: 0, bag_size: 1204
batch 399, loss: 0.0059, instance_loss: 0.2347, weighted_loss: 0.0746, label: 0, bag_size: 3438
batch 419, loss: 0.0000, instance_loss: 0.2065, weighted_loss: 0.0619, label: 0, bag_size: 1087
batch 439, loss: 0.6392, instance_loss: 1.0764, weighted_loss: 0.7703, label: 0, bag_size: 2232
batch 459, loss: 0.0653, instance_loss: 0.4138, weighted_loss: 0.1698, label: 1, bag_size: 4644
batch 479, loss: 0.0366, instance_loss: 0.5579, weighted_loss: 0.1930, label: 0, bag_size: 3539
batch 499, loss: 0.0384, instance_loss: 0.4281, weighted_loss: 0.1553, label: 0, bag_size: 7330
batch 519, loss: 1.2632, instance_loss: 1.2253, weighted_loss: 1.2518, label: 2, bag_size: 4342
batch 539, loss: 0.2467, instance_loss: 0.2136, weighted_loss: 0.2367, label: 2, bag_size: 3210
batch 559, loss: 2.8485, instance_loss: 1.5971, weighted_loss: 2.4731, label: 0, bag_size: 557
batch 579, loss: 0.0012, instance_loss: 0.1480, weighted_loss: 0.0452, label: 0, bag_size: 1710
batch 599, loss: 0.0077, instance_loss: 0.0801, weighted_loss: 0.0294, label: 2, bag_size: 3285
batch 619, loss: 0.1753, instance_loss: 0.1695, weighted_loss: 0.1736, label: 2, bag_size: 3227
batch 639, loss: 1.2179, instance_loss: 0.8080, weighted_loss: 1.0949, label: 1, bag_size: 3786
batch 659, loss: 0.7216, instance_loss: 0.7964, weighted_loss: 0.7441, label: 2, bag_size: 2561
batch 679, loss: 0.3800, instance_loss: 0.8976, weighted_loss: 0.5353, label: 1, bag_size: 2865
batch 699, loss: 0.1492, instance_loss: 0.5330, weighted_loss: 0.2644, label: 1, bag_size: 5340
batch 719, loss: 0.0164, instance_loss: 0.3225, weighted_loss: 0.1082, label: 0, bag_size: 2853
batch 739, loss: 0.0686, instance_loss: 0.4647, weighted_loss: 0.1874, label: 2, bag_size: 3810


class 0 clustering acc 0.9743847874720358: correct 17422/17880
class 1 clustering acc 0.3263422818791946: correct 1945/5960
Epoch: 34, train_loss: 0.5777, train_clustering_loss:  0.5578, train_error: 0.2430
class 0: acc 0.75390625, correct 193/256
class 1: acc 0.7, correct 175/250
class 2: acc 0.8200836820083682, correct 196/239

Val Set, val_loss: 1.0355, val_error: 0.3404, auc: 0.8147
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.30851063829787234: correct 232/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.4060, instance_loss: 0.5972, weighted_loss: 0.4634, label: 2, bag_size: 3546
batch 39, loss: 0.2458, instance_loss: 0.3593, weighted_loss: 0.2798, label: 0, bag_size: 1647
batch 59, loss: 0.9950, instance_loss: 0.6086, weighted_loss: 0.8791, label: 0, bag_size: 5526
batch 79, loss: 2.1011, instance_loss: 1.3979, weighted_loss: 1.8901, label: 2, bag_size: 4241
batch 99, loss: 0.3065, instance_loss: 0.3250, weighted_loss: 0.3120, label: 2, bag_size: 2359
batch 119, loss: 0.0350, instance_loss: 0.0800, weighted_loss: 0.0485, label: 2, bag_size: 4978
batch 139, loss: 0.1911, instance_loss: 0.4328, weighted_loss: 0.2636, label: 0, bag_size: 3793
batch 159, loss: 0.0853, instance_loss: 0.3680, weighted_loss: 0.1701, label: 0, bag_size: 4734
batch 179, loss: 1.9569, instance_loss: 0.9206, weighted_loss: 1.6460, label: 1, bag_size: 3438
batch 199, loss: 0.0926, instance_loss: 0.3523, weighted_loss: 0.1705, label: 0, bag_size: 3247
batch 219, loss: 0.3364, instance_loss: 0.3362, weighted_loss: 0.3364, label: 1, bag_size: 19265
batch 239, loss: 0.9050, instance_loss: 1.1910, weighted_loss: 0.9908, label: 0, bag_size: 1904
batch 259, loss: 0.1713, instance_loss: 0.4794, weighted_loss: 0.2637, label: 1, bag_size: 2731
batch 279, loss: 0.5533, instance_loss: 0.2315, weighted_loss: 0.4568, label: 2, bag_size: 3227
batch 299, loss: 0.0000, instance_loss: 0.2105, weighted_loss: 0.0631, label: 0, bag_size: 5487
batch 319, loss: 0.0454, instance_loss: 0.2422, weighted_loss: 0.1044, label: 0, bag_size: 4734
batch 339, loss: 0.3357, instance_loss: 0.8111, weighted_loss: 0.4783, label: 0, bag_size: 6015
batch 359, loss: 0.3138, instance_loss: 0.5943, weighted_loss: 0.3979, label: 0, bag_size: 3294
batch 379, loss: 3.3236, instance_loss: 1.7196, weighted_loss: 2.8424, label: 1, bag_size: 5423
batch 399, loss: 0.3885, instance_loss: 0.6442, weighted_loss: 0.4652, label: 1, bag_size: 6689
batch 419, loss: 0.1180, instance_loss: 0.5021, weighted_loss: 0.2332, label: 0, bag_size: 3789
batch 439, loss: 0.2837, instance_loss: 0.4058, weighted_loss: 0.3204, label: 0, bag_size: 3864
batch 459, loss: 1.2401, instance_loss: 0.6537, weighted_loss: 1.0642, label: 0, bag_size: 2579
batch 479, loss: 1.9660, instance_loss: 1.2137, weighted_loss: 1.7403, label: 2, bag_size: 3475
batch 499, loss: 0.1087, instance_loss: 0.1523, weighted_loss: 0.1218, label: 2, bag_size: 3397
batch 519, loss: 0.7083, instance_loss: 0.7374, weighted_loss: 0.7170, label: 1, bag_size: 6689
batch 539, loss: 0.1449, instance_loss: 0.2287, weighted_loss: 0.1700, label: 0, bag_size: 5526
batch 559, loss: 0.2516, instance_loss: 0.6906, weighted_loss: 0.3833, label: 1, bag_size: 1595
batch 579, loss: 0.6089, instance_loss: 0.5988, weighted_loss: 0.6058, label: 2, bag_size: 724
batch 599, loss: 0.1405, instance_loss: 0.1577, weighted_loss: 0.1457, label: 2, bag_size: 2481
batch 619, loss: 1.6475, instance_loss: 0.7916, weighted_loss: 1.3907, label: 2, bag_size: 5072
batch 639, loss: 0.1481, instance_loss: 0.1752, weighted_loss: 0.1562, label: 2, bag_size: 3397
batch 659, loss: 0.2372, instance_loss: 0.5107, weighted_loss: 0.3192, label: 2, bag_size: 5072
batch 679, loss: 1.4760, instance_loss: 0.5905, weighted_loss: 1.2104, label: 0, bag_size: 23335
batch 699, loss: 0.0000, instance_loss: 0.1181, weighted_loss: 0.0355, label: 0, bag_size: 3920
batch 719, loss: 0.2344, instance_loss: 0.4315, weighted_loss: 0.2936, label: 0, bag_size: 1018
batch 739, loss: 0.4978, instance_loss: 0.6255, weighted_loss: 0.5361, label: 1, bag_size: 4346


class 0 clustering acc 0.9732662192393736: correct 17402/17880
class 1 clustering acc 0.36140939597315436: correct 2154/5960
Epoch: 35, train_loss: 0.5632, train_clustering_loss:  0.5447, train_error: 0.2282
class 0: acc 0.7782258064516129, correct 193/248
class 1: acc 0.6929460580912863, correct 167/241
class 2: acc 0.83984375, correct 215/256

Val Set, val_loss: 1.2602, val_error: 0.3617, auc: 0.7944
class 0 clustering acc 0.9556737588652482: correct 2156/2256
class 1 clustering acc 0.33643617021276595: correct 253/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.6841, instance_loss: 0.8381, weighted_loss: 0.7303, label: 1, bag_size: 4869
batch 39, loss: 0.0171, instance_loss: 0.0592, weighted_loss: 0.0297, label: 2, bag_size: 4856
batch 59, loss: 0.0315, instance_loss: 0.4094, weighted_loss: 0.1449, label: 0, bag_size: 2094
batch 79, loss: 1.4062, instance_loss: 0.7397, weighted_loss: 1.2063, label: 1, bag_size: 4784
batch 99, loss: 0.0133, instance_loss: 0.7407, weighted_loss: 0.2315, label: 1, bag_size: 1542
batch 119, loss: 2.4320, instance_loss: 1.5089, weighted_loss: 2.1551, label: 1, bag_size: 1964
batch 139, loss: 1.8522, instance_loss: 1.0760, weighted_loss: 1.6194, label: 2, bag_size: 4316
batch 159, loss: 2.2126, instance_loss: 0.8155, weighted_loss: 1.7935, label: 0, bag_size: 4717
batch 179, loss: 1.1441, instance_loss: 0.8880, weighted_loss: 1.0673, label: 1, bag_size: 5873
batch 199, loss: 0.0530, instance_loss: 0.2340, weighted_loss: 0.1073, label: 2, bag_size: 3810
batch 219, loss: 0.0854, instance_loss: 0.4116, weighted_loss: 0.1833, label: 1, bag_size: 5728
batch 239, loss: 0.1791, instance_loss: 0.2905, weighted_loss: 0.2125, label: 2, bag_size: 4203
batch 259, loss: 0.0601, instance_loss: 0.2761, weighted_loss: 0.1249, label: 2, bag_size: 2561
batch 279, loss: 1.0277, instance_loss: 1.2102, weighted_loss: 1.0824, label: 1, bag_size: 779
batch 299, loss: 0.0102, instance_loss: 0.1699, weighted_loss: 0.0581, label: 0, bag_size: 2705
batch 319, loss: 0.9330, instance_loss: 0.5756, weighted_loss: 0.8258, label: 0, bag_size: 1018
batch 339, loss: 2.0654, instance_loss: 1.1432, weighted_loss: 1.7887, label: 2, bag_size: 4241
batch 359, loss: 0.0300, instance_loss: 0.4914, weighted_loss: 0.1684, label: 1, bag_size: 3265
batch 379, loss: 0.6046, instance_loss: 0.4641, weighted_loss: 0.5624, label: 2, bag_size: 3174
batch 399, loss: 1.4829, instance_loss: 0.5187, weighted_loss: 1.1936, label: 2, bag_size: 705
batch 419, loss: 0.0285, instance_loss: 0.1842, weighted_loss: 0.0752, label: 2, bag_size: 2422
batch 439, loss: 0.0326, instance_loss: 0.1784, weighted_loss: 0.0763, label: 2, bag_size: 2422
batch 459, loss: 0.4086, instance_loss: 0.6452, weighted_loss: 0.4796, label: 1, bag_size: 1327
batch 479, loss: 0.2812, instance_loss: 0.4260, weighted_loss: 0.3247, label: 0, bag_size: 2306
batch 499, loss: 0.1695, instance_loss: 0.4494, weighted_loss: 0.2534, label: 0, bag_size: 1904
batch 519, loss: 0.2218, instance_loss: 0.3246, weighted_loss: 0.2527, label: 1, bag_size: 3126
batch 539, loss: 0.1807, instance_loss: 0.4738, weighted_loss: 0.2686, label: 1, bag_size: 1221
batch 559, loss: 0.1740, instance_loss: 0.5450, weighted_loss: 0.2853, label: 2, bag_size: 3604
batch 579, loss: 0.1206, instance_loss: 0.2050, weighted_loss: 0.1459, label: 2, bag_size: 2049
batch 599, loss: 0.1423, instance_loss: 0.1703, weighted_loss: 0.1507, label: 2, bag_size: 2501
batch 619, loss: 0.3841, instance_loss: 0.7467, weighted_loss: 0.4929, label: 1, bag_size: 2905
batch 639, loss: 0.2943, instance_loss: 0.5116, weighted_loss: 0.3595, label: 1, bag_size: 4812
batch 659, loss: 0.0828, instance_loss: 0.3969, weighted_loss: 0.1770, label: 0, bag_size: 4922
batch 679, loss: 0.4619, instance_loss: 1.3017, weighted_loss: 0.7138, label: 0, bag_size: 5634
batch 699, loss: 0.2040, instance_loss: 0.6914, weighted_loss: 0.3502, label: 0, bag_size: 3885
batch 719, loss: 0.7024, instance_loss: 1.0113, weighted_loss: 0.7951, label: 2, bag_size: 3604
batch 739, loss: 1.3162, instance_loss: 1.1437, weighted_loss: 1.2644, label: 0, bag_size: 3191


class 0 clustering acc 0.9719798657718121: correct 17379/17880
class 1 clustering acc 0.32365771812080535: correct 1929/5960
Epoch: 36, train_loss: 0.5869, train_clustering_loss:  0.5589, train_error: 0.2228
class 0: acc 0.8, correct 188/235
class 1: acc 0.70703125, correct 181/256
class 2: acc 0.8267716535433071, correct 210/254

Val Set, val_loss: 1.0924, val_error: 0.3404, auc: 0.8156
class 0 clustering acc 0.9587765957446809: correct 2163/2256
class 1 clustering acc 0.1356382978723404: correct 102/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 36 out of 20


batch 19, loss: 1.3294, instance_loss: 0.2327, weighted_loss: 1.0004, label: 2, bag_size: 4788
batch 39, loss: 0.3881, instance_loss: 0.6447, weighted_loss: 0.4651, label: 1, bag_size: 2156
batch 59, loss: 1.0730, instance_loss: 0.9297, weighted_loss: 1.0300, label: 0, bag_size: 768
batch 79, loss: 0.3400, instance_loss: 0.5912, weighted_loss: 0.4154, label: 2, bag_size: 3607
batch 99, loss: 0.7674, instance_loss: 0.8810, weighted_loss: 0.8015, label: 1, bag_size: 5412
batch 119, loss: 0.1588, instance_loss: 0.4951, weighted_loss: 0.2597, label: 2, bag_size: 4372
batch 139, loss: 1.0255, instance_loss: 0.8425, weighted_loss: 0.9706, label: 2, bag_size: 724
batch 159, loss: 0.0869, instance_loss: 0.5305, weighted_loss: 0.2200, label: 1, bag_size: 2962
batch 179, loss: 0.4229, instance_loss: 0.5083, weighted_loss: 0.4486, label: 0, bag_size: 4529
batch 199, loss: 0.1350, instance_loss: 0.4255, weighted_loss: 0.2221, label: 0, bag_size: 5236
batch 219, loss: 0.0061, instance_loss: 0.3651, weighted_loss: 0.1138, label: 0, bag_size: 4403
batch 239, loss: 0.0000, instance_loss: 0.1344, weighted_loss: 0.0403, label: 0, bag_size: 3038
batch 259, loss: 1.1524, instance_loss: 0.9373, weighted_loss: 1.0879, label: 1, bag_size: 1161
batch 279, loss: 0.7698, instance_loss: 0.8039, weighted_loss: 0.7800, label: 2, bag_size: 724
batch 299, loss: 0.0531, instance_loss: 0.2277, weighted_loss: 0.1055, label: 2, bag_size: 6644
batch 319, loss: 0.0136, instance_loss: 0.0787, weighted_loss: 0.0331, label: 2, bag_size: 3415
batch 339, loss: 0.1585, instance_loss: 0.4102, weighted_loss: 0.2340, label: 2, bag_size: 614
batch 359, loss: 0.0340, instance_loss: 0.3604, weighted_loss: 0.1319, label: 0, bag_size: 5899
batch 379, loss: 0.1509, instance_loss: 0.3060, weighted_loss: 0.1974, label: 0, bag_size: 4734
batch 399, loss: 0.1727, instance_loss: 0.4122, weighted_loss: 0.2445, label: 0, bag_size: 11663
batch 419, loss: 0.0268, instance_loss: 0.2433, weighted_loss: 0.0917, label: 2, bag_size: 2770
batch 439, loss: 0.1004, instance_loss: 0.1258, weighted_loss: 0.1080, label: 2, bag_size: 5011
batch 459, loss: 0.3361, instance_loss: 0.5318, weighted_loss: 0.3948, label: 0, bag_size: 4450
batch 479, loss: 0.0550, instance_loss: 0.2280, weighted_loss: 0.1069, label: 0, bag_size: 3294
batch 499, loss: 0.1120, instance_loss: 0.1795, weighted_loss: 0.1322, label: 2, bag_size: 5011
batch 519, loss: 0.2837, instance_loss: 0.3999, weighted_loss: 0.3185, label: 0, bag_size: 4092
batch 539, loss: 1.6893, instance_loss: 0.7514, weighted_loss: 1.4079, label: 0, bag_size: 4921
batch 559, loss: 0.3046, instance_loss: 0.6262, weighted_loss: 0.4011, label: 1, bag_size: 3755
batch 579, loss: 0.0870, instance_loss: 0.1572, weighted_loss: 0.1081, label: 2, bag_size: 5011
batch 599, loss: 0.0263, instance_loss: 0.1003, weighted_loss: 0.0485, label: 0, bag_size: 873
batch 619, loss: 0.0917, instance_loss: 0.2378, weighted_loss: 0.1355, label: 2, bag_size: 6273
batch 639, loss: 0.2535, instance_loss: 0.7392, weighted_loss: 0.3992, label: 1, bag_size: 779
batch 659, loss: 0.4185, instance_loss: 0.4546, weighted_loss: 0.4294, label: 0, bag_size: 3334
batch 679, loss: 0.1235, instance_loss: 0.2046, weighted_loss: 0.1478, label: 0, bag_size: 3641
batch 699, loss: 0.2759, instance_loss: 0.6070, weighted_loss: 0.3752, label: 1, bag_size: 2870
batch 719, loss: 0.0149, instance_loss: 0.3338, weighted_loss: 0.1105, label: 0, bag_size: 3268
batch 739, loss: 0.0564, instance_loss: 0.2037, weighted_loss: 0.1006, label: 2, bag_size: 4978


class 0 clustering acc 0.9714765100671141: correct 17370/17880
class 1 clustering acc 0.338255033557047: correct 2016/5960
Epoch: 37, train_loss: 0.5375, train_clustering_loss:  0.5611, train_error: 0.2389
class 0: acc 0.7976653696498055, correct 205/257
class 1: acc 0.68, correct 153/225
class 2: acc 0.7946768060836502, correct 209/263

Val Set, val_loss: 1.2780, val_error: 0.4149, auc: 0.7860
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.2526595744680851: correct 190/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0778, instance_loss: 0.2635, weighted_loss: 0.1335, label: 2, bag_size: 6594
batch 39, loss: 0.0610, instance_loss: 0.6264, weighted_loss: 0.2306, label: 1, bag_size: 4027
batch 59, loss: 0.1049, instance_loss: 0.2540, weighted_loss: 0.1496, label: 2, bag_size: 3327
batch 79, loss: 0.0235, instance_loss: 0.3563, weighted_loss: 0.1233, label: 0, bag_size: 4744
batch 99, loss: 0.0333, instance_loss: 0.1140, weighted_loss: 0.0575, label: 2, bag_size: 4555
batch 119, loss: 2.2874, instance_loss: 1.0068, weighted_loss: 1.9032, label: 1, bag_size: 3100
batch 139, loss: 0.0704, instance_loss: 0.1368, weighted_loss: 0.0903, label: 2, bag_size: 5914
batch 159, loss: 0.2566, instance_loss: 0.5876, weighted_loss: 0.3559, label: 1, bag_size: 1807
batch 179, loss: 0.0038, instance_loss: 0.4031, weighted_loss: 0.1236, label: 2, bag_size: 4497
batch 199, loss: 0.0467, instance_loss: 0.1400, weighted_loss: 0.0747, label: 1, bag_size: 3126
batch 219, loss: 4.5419, instance_loss: 1.9803, weighted_loss: 3.7735, label: 0, bag_size: 3750
batch 239, loss: 0.6062, instance_loss: 0.9235, weighted_loss: 0.7014, label: 1, bag_size: 4940
batch 259, loss: 0.6413, instance_loss: 0.6635, weighted_loss: 0.6480, label: 1, bag_size: 1500
batch 279, loss: 0.1552, instance_loss: 0.4928, weighted_loss: 0.2565, label: 0, bag_size: 909
batch 299, loss: 0.0136, instance_loss: 0.0666, weighted_loss: 0.0295, label: 2, bag_size: 3285
batch 319, loss: 0.0208, instance_loss: 0.0825, weighted_loss: 0.0393, label: 2, bag_size: 1094
batch 339, loss: 0.0526, instance_loss: 0.2219, weighted_loss: 0.1033, label: 2, bag_size: 3327
batch 359, loss: 0.1345, instance_loss: 0.2575, weighted_loss: 0.1714, label: 0, bag_size: 3690
batch 379, loss: 0.0040, instance_loss: 0.2613, weighted_loss: 0.0812, label: 1, bag_size: 8802
batch 399, loss: 1.3202, instance_loss: 0.6500, weighted_loss: 1.1191, label: 0, bag_size: 13770
batch 419, loss: 0.6462, instance_loss: 0.3870, weighted_loss: 0.5684, label: 2, bag_size: 3026
batch 439, loss: 0.0720, instance_loss: 0.1919, weighted_loss: 0.1079, label: 2, bag_size: 3546
batch 459, loss: 0.2048, instance_loss: 0.6088, weighted_loss: 0.3260, label: 2, bag_size: 3604
batch 479, loss: 0.1328, instance_loss: 0.3130, weighted_loss: 0.1868, label: 2, bag_size: 5017
batch 499, loss: 0.1013, instance_loss: 0.1279, weighted_loss: 0.1093, label: 2, bag_size: 3210
batch 519, loss: 0.2067, instance_loss: 0.5272, weighted_loss: 0.3029, label: 1, bag_size: 2865
batch 539, loss: 0.1361, instance_loss: 0.3362, weighted_loss: 0.1962, label: 2, bag_size: 3396
batch 559, loss: 1.4885, instance_loss: 0.7524, weighted_loss: 1.2676, label: 1, bag_size: 3106
batch 579, loss: 0.5355, instance_loss: 0.7670, weighted_loss: 0.6050, label: 1, bag_size: 2744
batch 599, loss: 0.0371, instance_loss: 0.1159, weighted_loss: 0.0607, label: 2, bag_size: 4856
batch 619, loss: 0.0974, instance_loss: 0.2372, weighted_loss: 0.1394, label: 0, bag_size: 2873
batch 639, loss: 0.2570, instance_loss: 0.4499, weighted_loss: 0.3149, label: 1, bag_size: 3991
batch 659, loss: 0.0071, instance_loss: 0.1527, weighted_loss: 0.0507, label: 1, bag_size: 1023
batch 679, loss: 2.7333, instance_loss: 1.1067, weighted_loss: 2.2453, label: 0, bag_size: 20234
batch 699, loss: 0.0448, instance_loss: 0.1903, weighted_loss: 0.0885, label: 2, bag_size: 3080
batch 719, loss: 0.7874, instance_loss: 0.9282, weighted_loss: 0.8296, label: 1, bag_size: 2751
batch 739, loss: 1.0157, instance_loss: 0.6639, weighted_loss: 0.9101, label: 0, bag_size: 2501


class 0 clustering acc 0.9717561521252797: correct 17375/17880
class 1 clustering acc 0.37466442953020135: correct 2233/5960
Epoch: 38, train_loss: 0.5033, train_clustering_loss:  0.5295, train_error: 0.2188
class 0: acc 0.7932489451476793, correct 188/237
class 1: acc 0.6827309236947792, correct 170/249
class 2: acc 0.8648648648648649, correct 224/259

Val Set, val_loss: 1.2144, val_error: 0.3936, auc: 0.7941
class 0 clustering acc 0.9423758865248227: correct 2126/2256
class 1 clustering acc 0.1356382978723404: correct 102/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1898, instance_loss: 0.1788, weighted_loss: 0.1865, label: 2, bag_size: 2313
batch 39, loss: 0.1345, instance_loss: 0.3334, weighted_loss: 0.1942, label: 0, bag_size: 3664
batch 59, loss: 0.0504, instance_loss: 0.2590, weighted_loss: 0.1130, label: 2, bag_size: 88
batch 79, loss: 0.5880, instance_loss: 0.5049, weighted_loss: 0.5631, label: 0, bag_size: 3376
batch 99, loss: 0.1328, instance_loss: 0.7011, weighted_loss: 0.3033, label: 1, bag_size: 5728
batch 119, loss: 0.8208, instance_loss: 1.0093, weighted_loss: 0.8773, label: 2, bag_size: 2813
batch 139, loss: 0.6391, instance_loss: 0.6357, weighted_loss: 0.6381, label: 1, bag_size: 4438
batch 159, loss: 0.0160, instance_loss: 0.1668, weighted_loss: 0.0612, label: 0, bag_size: 3641
batch 179, loss: 0.2399, instance_loss: 0.3514, weighted_loss: 0.2734, label: 2, bag_size: 3112
batch 199, loss: 0.0764, instance_loss: 0.0502, weighted_loss: 0.0685, label: 2, bag_size: 3172
batch 219, loss: 0.0342, instance_loss: 0.3984, weighted_loss: 0.1434, label: 1, bag_size: 712
batch 239, loss: 1.1885, instance_loss: 0.9572, weighted_loss: 1.1191, label: 1, bag_size: 5072
batch 259, loss: 0.0911, instance_loss: 0.1355, weighted_loss: 0.1044, label: 2, bag_size: 4056
batch 279, loss: 1.2704, instance_loss: 0.9927, weighted_loss: 1.1871, label: 0, bag_size: 3164
batch 299, loss: 0.0079, instance_loss: 0.2065, weighted_loss: 0.0675, label: 1, bag_size: 1836
batch 319, loss: 1.5534, instance_loss: 0.9042, weighted_loss: 1.3586, label: 1, bag_size: 1500
batch 339, loss: 0.0161, instance_loss: 0.2353, weighted_loss: 0.0818, label: 0, bag_size: 3530
batch 359, loss: 0.0112, instance_loss: 0.4422, weighted_loss: 0.1405, label: 1, bag_size: 4027
batch 379, loss: 0.0115, instance_loss: 0.4264, weighted_loss: 0.1360, label: 1, bag_size: 3265
batch 399, loss: 0.7672, instance_loss: 0.7016, weighted_loss: 0.7475, label: 0, bag_size: 4541
batch 419, loss: 0.1391, instance_loss: 0.3385, weighted_loss: 0.1989, label: 0, bag_size: 11663
batch 439, loss: 0.1208, instance_loss: 0.8031, weighted_loss: 0.3255, label: 1, bag_size: 3475
batch 459, loss: 0.6026, instance_loss: 0.7584, weighted_loss: 0.6494, label: 1, bag_size: 5118
batch 479, loss: 0.3235, instance_loss: 0.3103, weighted_loss: 0.3195, label: 0, bag_size: 3294
batch 499, loss: 1.5480, instance_loss: 1.2371, weighted_loss: 1.4547, label: 1, bag_size: 1580
batch 519, loss: 0.0966, instance_loss: 0.3531, weighted_loss: 0.1735, label: 0, bag_size: 14070
batch 539, loss: 0.6998, instance_loss: 0.7743, weighted_loss: 0.7221, label: 0, bag_size: 3904
batch 559, loss: 0.3244, instance_loss: 0.3473, weighted_loss: 0.3313, label: 0, bag_size: 1373
batch 579, loss: 0.5861, instance_loss: 0.8019, weighted_loss: 0.6508, label: 2, bag_size: 5743
batch 599, loss: 0.0164, instance_loss: 0.0696, weighted_loss: 0.0323, label: 1, bag_size: 758
batch 619, loss: 0.0240, instance_loss: 0.1148, weighted_loss: 0.0513, label: 2, bag_size: 3285
batch 639, loss: 0.0744, instance_loss: 0.1483, weighted_loss: 0.0966, label: 2, bag_size: 2481
batch 659, loss: 0.2828, instance_loss: 0.7922, weighted_loss: 0.4356, label: 0, bag_size: 313
batch 679, loss: 0.7498, instance_loss: 0.5075, weighted_loss: 0.6771, label: 0, bag_size: 4245
batch 699, loss: 0.0279, instance_loss: 0.2784, weighted_loss: 0.1030, label: 2, bag_size: 4487
batch 719, loss: 0.0436, instance_loss: 0.0603, weighted_loss: 0.0486, label: 2, bag_size: 3172
batch 739, loss: 0.2183, instance_loss: 0.3123, weighted_loss: 0.2465, label: 2, bag_size: 614


class 0 clustering acc 0.9736017897091722: correct 17408/17880
class 1 clustering acc 0.4231543624161074: correct 2522/5960
Epoch: 39, train_loss: 0.4951, train_clustering_loss:  0.5076, train_error: 0.2121
class 0: acc 0.8269230769230769, correct 215/260
class 1: acc 0.6772727272727272, correct 149/220
class 2: acc 0.8415094339622642, correct 223/265

Val Set, val_loss: 0.9997, val_error: 0.3298, auc: 0.8209
class 0 clustering acc 0.9481382978723404: correct 2139/2256
class 1 clustering acc 0.32313829787234044: correct 243/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0037, instance_loss: 0.0918, weighted_loss: 0.0302, label: 0, bag_size: 1710
batch 39, loss: 0.0106, instance_loss: 0.2029, weighted_loss: 0.0683, label: 0, bag_size: 4914
batch 59, loss: 0.0688, instance_loss: 0.3440, weighted_loss: 0.1514, label: 0, bag_size: 4147
batch 79, loss: 0.0080, instance_loss: 0.0317, weighted_loss: 0.0151, label: 0, bag_size: 3816
batch 99, loss: 0.5271, instance_loss: 0.3676, weighted_loss: 0.4793, label: 2, bag_size: 6644
batch 119, loss: 0.6096, instance_loss: 0.5170, weighted_loss: 0.5818, label: 2, bag_size: 3778
batch 139, loss: 0.7411, instance_loss: 1.0777, weighted_loss: 0.8421, label: 2, bag_size: 5072
batch 159, loss: 0.1527, instance_loss: 0.3114, weighted_loss: 0.2003, label: 0, bag_size: 2756
batch 179, loss: 1.1260, instance_loss: 0.6861, weighted_loss: 0.9940, label: 0, bag_size: 5098
batch 199, loss: 0.0014, instance_loss: 0.3944, weighted_loss: 0.1193, label: 0, bag_size: 8088
batch 219, loss: 0.1344, instance_loss: 0.3230, weighted_loss: 0.1910, label: 0, bag_size: 1647
batch 239, loss: 0.0088, instance_loss: 0.0190, weighted_loss: 0.0119, label: 2, bag_size: 4691
batch 259, loss: 0.1654, instance_loss: 0.4663, weighted_loss: 0.2557, label: 0, bag_size: 4734
batch 279, loss: 1.4400, instance_loss: 1.1306, weighted_loss: 1.3472, label: 1, bag_size: 2642
batch 299, loss: 0.7329, instance_loss: 0.8602, weighted_loss: 0.7711, label: 1, bag_size: 1500
batch 319, loss: 0.0073, instance_loss: 0.3106, weighted_loss: 0.0983, label: 2, bag_size: 4372
batch 339, loss: 0.0422, instance_loss: 0.3172, weighted_loss: 0.1247, label: 1, bag_size: 7135
batch 359, loss: 0.1471, instance_loss: 0.3831, weighted_loss: 0.2179, label: 1, bag_size: 596
batch 379, loss: 0.0153, instance_loss: 0.0969, weighted_loss: 0.0398, label: 2, bag_size: 88
batch 399, loss: 0.0072, instance_loss: 0.1212, weighted_loss: 0.0414, label: 2, bag_size: 3121
batch 419, loss: 0.0796, instance_loss: 0.1090, weighted_loss: 0.0884, label: 2, bag_size: 2481
batch 439, loss: 0.0703, instance_loss: 0.0949, weighted_loss: 0.0777, label: 2, bag_size: 1103
batch 459, loss: 0.0134, instance_loss: 0.2335, weighted_loss: 0.0794, label: 0, bag_size: 3443
batch 479, loss: 0.1943, instance_loss: 0.3836, weighted_loss: 0.2511, label: 0, bag_size: 3709
batch 499, loss: 0.0193, instance_loss: 0.0813, weighted_loss: 0.0379, label: 2, bag_size: 4056
batch 519, loss: 0.0698, instance_loss: 0.3886, weighted_loss: 0.1654, label: 0, bag_size: 4227
batch 539, loss: 1.0077, instance_loss: 1.1813, weighted_loss: 1.0598, label: 1, bag_size: 1307
batch 559, loss: 0.4079, instance_loss: 0.8462, weighted_loss: 0.5394, label: 1, bag_size: 4612
batch 579, loss: 0.4676, instance_loss: 0.8043, weighted_loss: 0.5686, label: 2, bag_size: 4571
batch 599, loss: 0.2451, instance_loss: 0.6752, weighted_loss: 0.3741, label: 1, bag_size: 782
batch 619, loss: 0.0609, instance_loss: 0.4054, weighted_loss: 0.1642, label: 0, bag_size: 4584
batch 639, loss: 0.3346, instance_loss: 0.5918, weighted_loss: 0.4118, label: 0, bag_size: 386
batch 659, loss: 0.8297, instance_loss: 0.9170, weighted_loss: 0.8559, label: 1, bag_size: 5197
batch 679, loss: 0.4852, instance_loss: 0.5974, weighted_loss: 0.5189, label: 1, bag_size: 3225
batch 699, loss: 2.1276, instance_loss: 1.3514, weighted_loss: 1.8947, label: 1, bag_size: 5072
batch 719, loss: 0.6737, instance_loss: 0.8056, weighted_loss: 0.7133, label: 2, bag_size: 4571
batch 739, loss: 4.0890, instance_loss: 2.4678, weighted_loss: 3.6026, label: 1, bag_size: 3016


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.43338926174496645: correct 2583/5960
Epoch: 40, train_loss: 0.5036, train_clustering_loss:  0.5166, train_error: 0.2027
class 0: acc 0.8532818532818532, correct 221/259
class 1: acc 0.6832579185520362, correct 151/221
class 2: acc 0.8377358490566038, correct 222/265

Val Set, val_loss: 1.2158, val_error: 0.4043, auc: 0.7979
class 0 clustering acc 0.9370567375886525: correct 2114/2256
class 1 clustering acc 0.35771276595744683: correct 269/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.16666666666666666, correct 5/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.1026, instance_loss: 0.2569, weighted_loss: 0.1489, label: 0, bag_size: 5260
batch 39, loss: 0.4840, instance_loss: 0.6640, weighted_loss: 0.5380, label: 0, bag_size: 2069
batch 59, loss: 0.6597, instance_loss: 0.5392, weighted_loss: 0.6236, label: 2, bag_size: 6298
batch 79, loss: 0.0126, instance_loss: 0.0579, weighted_loss: 0.0262, label: 2, bag_size: 2483
batch 99, loss: 1.4773, instance_loss: 1.5359, weighted_loss: 1.4949, label: 1, bag_size: 3016
batch 119, loss: 0.2479, instance_loss: 0.5268, weighted_loss: 0.3316, label: 0, bag_size: 3294
batch 139, loss: 0.0142, instance_loss: 0.7210, weighted_loss: 0.2263, label: 1, bag_size: 4027
batch 159, loss: 0.1150, instance_loss: 0.6612, weighted_loss: 0.2788, label: 2, bag_size: 4978
batch 179, loss: 0.1661, instance_loss: 0.1876, weighted_loss: 0.1725, label: 2, bag_size: 597
batch 199, loss: 0.3678, instance_loss: 0.6594, weighted_loss: 0.4553, label: 0, bag_size: 640
batch 219, loss: 0.0829, instance_loss: 0.5364, weighted_loss: 0.2190, label: 1, bag_size: 475
batch 239, loss: 0.1977, instance_loss: 0.4596, weighted_loss: 0.2762, label: 0, bag_size: 5260
batch 259, loss: 0.0257, instance_loss: 0.3736, weighted_loss: 0.1300, label: 0, bag_size: 4922
batch 279, loss: 0.0000, instance_loss: 0.0011, weighted_loss: 0.0003, label: 0, bag_size: 4582
batch 299, loss: 0.5343, instance_loss: 0.3576, weighted_loss: 0.4813, label: 0, bag_size: 3639
batch 319, loss: 0.3978, instance_loss: 0.6627, weighted_loss: 0.4772, label: 0, bag_size: 2915
batch 339, loss: 0.0552, instance_loss: 0.3130, weighted_loss: 0.1325, label: 0, bag_size: 667
batch 359, loss: 0.1890, instance_loss: 0.3893, weighted_loss: 0.2490, label: 2, bag_size: 3778
batch 379, loss: 0.2931, instance_loss: 0.2231, weighted_loss: 0.2721, label: 2, bag_size: 2501
batch 399, loss: 0.0285, instance_loss: 0.0536, weighted_loss: 0.0360, label: 2, bag_size: 4856
batch 419, loss: 0.3241, instance_loss: 0.6421, weighted_loss: 0.4195, label: 2, bag_size: 5072
batch 439, loss: 3.5385, instance_loss: 1.3316, weighted_loss: 2.8764, label: 0, bag_size: 2853
batch 459, loss: 0.0929, instance_loss: 0.6886, weighted_loss: 0.2716, label: 0, bag_size: 889
batch 479, loss: 0.3293, instance_loss: 0.5210, weighted_loss: 0.3868, label: 1, bag_size: 2870
batch 499, loss: 0.0392, instance_loss: 0.2864, weighted_loss: 0.1134, label: 2, bag_size: 4487
batch 519, loss: 0.0394, instance_loss: 0.1337, weighted_loss: 0.0677, label: 2, bag_size: 4555
batch 539, loss: 0.1544, instance_loss: 0.4053, weighted_loss: 0.2297, label: 0, bag_size: 3370
batch 559, loss: 0.0470, instance_loss: 0.1524, weighted_loss: 0.0786, label: 2, bag_size: 5914
batch 579, loss: 0.0337, instance_loss: 0.0494, weighted_loss: 0.0384, label: 2, bag_size: 4691
batch 599, loss: 0.0729, instance_loss: 0.4743, weighted_loss: 0.1933, label: 1, bag_size: 2453
batch 619, loss: 0.0316, instance_loss: 0.1377, weighted_loss: 0.0634, label: 2, bag_size: 2422
batch 639, loss: 2.2276, instance_loss: 1.1482, weighted_loss: 1.9038, label: 1, bag_size: 1964
batch 659, loss: 0.9471, instance_loss: 0.6011, weighted_loss: 0.8433, label: 0, bag_size: 2579
batch 679, loss: 0.0728, instance_loss: 0.5198, weighted_loss: 0.2069, label: 2, bag_size: 3810
batch 699, loss: 0.0458, instance_loss: 0.4515, weighted_loss: 0.1675, label: 0, bag_size: 3408
batch 719, loss: 0.0630, instance_loss: 0.2369, weighted_loss: 0.1152, label: 0, bag_size: 2791
batch 739, loss: 1.2512, instance_loss: 1.0351, weighted_loss: 1.1863, label: 2, bag_size: 22464


class 0 clustering acc 0.9758389261744966: correct 17448/17880
class 1 clustering acc 0.3914429530201342: correct 2333/5960
Epoch: 41, train_loss: 0.4961, train_clustering_loss:  0.5128, train_error: 0.2067
class 0: acc 0.8008474576271186, correct 189/236
class 1: acc 0.6785714285714286, correct 152/224
class 2: acc 0.8771929824561403, correct 250/285

Val Set, val_loss: 1.1845, val_error: 0.3723, auc: 0.7924
class 0 clustering acc 0.9539007092198581: correct 2152/2256
class 1 clustering acc 0.10372340425531915: correct 78/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0560, instance_loss: 0.2858, weighted_loss: 0.1249, label: 2, bag_size: 4291
batch 39, loss: 0.4579, instance_loss: 0.4281, weighted_loss: 0.4490, label: 0, bag_size: 4310
batch 59, loss: 0.0096, instance_loss: 0.1607, weighted_loss: 0.0549, label: 0, bag_size: 4458
batch 79, loss: 1.6581, instance_loss: 1.1333, weighted_loss: 1.5006, label: 2, bag_size: 4241
batch 99, loss: 0.0038, instance_loss: 0.0476, weighted_loss: 0.0169, label: 1, bag_size: 460
batch 119, loss: 1.8758, instance_loss: 1.1526, weighted_loss: 1.6588, label: 0, bag_size: 1755
batch 139, loss: 2.4226, instance_loss: 0.9160, weighted_loss: 1.9706, label: 0, bag_size: 2559
batch 159, loss: 0.0066, instance_loss: 0.3397, weighted_loss: 0.1065, label: 2, bag_size: 4497
batch 179, loss: 0.0486, instance_loss: 0.3739, weighted_loss: 0.1462, label: 0, bag_size: 5831
batch 199, loss: 0.0247, instance_loss: 0.1830, weighted_loss: 0.0722, label: 2, bag_size: 6704
batch 219, loss: 0.1471, instance_loss: 0.8722, weighted_loss: 0.3647, label: 0, bag_size: 4894
batch 239, loss: 0.2213, instance_loss: 0.7141, weighted_loss: 0.3692, label: 1, bag_size: 3821
batch 259, loss: 0.4992, instance_loss: 0.6351, weighted_loss: 0.5400, label: 1, bag_size: 4438
batch 279, loss: 0.2339, instance_loss: 0.4774, weighted_loss: 0.3070, label: 0, bag_size: 2756
batch 299, loss: 0.2513, instance_loss: 0.3596, weighted_loss: 0.2838, label: 2, bag_size: 3546
batch 319, loss: 0.7772, instance_loss: 0.8562, weighted_loss: 0.8009, label: 1, bag_size: 4612
batch 339, loss: 1.4405, instance_loss: 1.1443, weighted_loss: 1.3516, label: 2, bag_size: 4342
batch 359, loss: 0.2772, instance_loss: 0.5248, weighted_loss: 0.3515, label: 1, bag_size: 4373
batch 379, loss: 3.4826, instance_loss: 0.9238, weighted_loss: 2.7149, label: 0, bag_size: 35080
batch 399, loss: 1.3816, instance_loss: 0.7162, weighted_loss: 1.1820, label: 1, bag_size: 3885
batch 419, loss: 1.4340, instance_loss: 1.1363, weighted_loss: 1.3447, label: 1, bag_size: 3438
batch 439, loss: 0.5412, instance_loss: 0.5608, weighted_loss: 0.5471, label: 1, bag_size: 4467
batch 459, loss: 0.2360, instance_loss: 1.1464, weighted_loss: 0.5091, label: 0, bag_size: 2824
batch 479, loss: 0.2507, instance_loss: 0.4647, weighted_loss: 0.3149, label: 0, bag_size: 702
batch 499, loss: 0.0200, instance_loss: 0.1984, weighted_loss: 0.0735, label: 0, bag_size: 1744
batch 519, loss: 0.0220, instance_loss: 0.0852, weighted_loss: 0.0410, label: 2, bag_size: 4302
batch 539, loss: 0.0006, instance_loss: 0.1875, weighted_loss: 0.0567, label: 0, bag_size: 8088
batch 559, loss: 0.0057, instance_loss: 0.0894, weighted_loss: 0.0308, label: 1, bag_size: 259
batch 579, loss: 0.4715, instance_loss: 0.5155, weighted_loss: 0.4847, label: 1, bag_size: 3100
batch 599, loss: 2.4883, instance_loss: 1.0067, weighted_loss: 2.0438, label: 2, bag_size: 728
batch 619, loss: 0.4873, instance_loss: 0.5854, weighted_loss: 0.5168, label: 1, bag_size: 3127
batch 639, loss: 0.0048, instance_loss: 0.1500, weighted_loss: 0.0483, label: 0, bag_size: 1399
batch 659, loss: 0.7307, instance_loss: 0.4977, weighted_loss: 0.6608, label: 2, bag_size: 614
batch 679, loss: 0.4059, instance_loss: 0.4005, weighted_loss: 0.4043, label: 0, bag_size: 4460
batch 699, loss: 0.0091, instance_loss: 0.0972, weighted_loss: 0.0355, label: 2, bag_size: 4056
batch 719, loss: 0.6341, instance_loss: 0.8819, weighted_loss: 0.7085, label: 1, bag_size: 1608
batch 739, loss: 0.1063, instance_loss: 0.5870, weighted_loss: 0.2505, label: 1, bag_size: 3533


class 0 clustering acc 0.9692953020134228: correct 17331/17880
class 1 clustering acc 0.35889261744966444: correct 2139/5960
Epoch: 42, train_loss: 0.4945, train_clustering_loss:  0.5376, train_error: 0.1919
class 0: acc 0.7965367965367965, correct 184/231
class 1: acc 0.7777777777777778, correct 203/261
class 2: acc 0.849802371541502, correct 215/253

Val Set, val_loss: 1.4416, val_error: 0.5000, auc: 0.7852
class 0 clustering acc 0.9574468085106383: correct 2160/2256
class 1 clustering acc 0.11835106382978723: correct 89/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 42 out of 20


batch 19, loss: 3.4693, instance_loss: 1.6834, weighted_loss: 2.9335, label: 1, bag_size: 2727
batch 39, loss: 0.5731, instance_loss: 0.6894, weighted_loss: 0.6080, label: 2, bag_size: 724
batch 59, loss: 0.6536, instance_loss: 0.7320, weighted_loss: 0.6771, label: 2, bag_size: 223
batch 79, loss: 0.0478, instance_loss: 0.5936, weighted_loss: 0.2115, label: 0, bag_size: 1352
batch 99, loss: 0.0482, instance_loss: 0.3208, weighted_loss: 0.1300, label: 0, bag_size: 1132
batch 119, loss: 0.0792, instance_loss: 0.2456, weighted_loss: 0.1291, label: 2, bag_size: 2422
batch 139, loss: 0.1578, instance_loss: 0.6193, weighted_loss: 0.2962, label: 1, bag_size: 4119
batch 159, loss: 1.5257, instance_loss: 0.6895, weighted_loss: 1.2748, label: 1, bag_size: 4187
batch 179, loss: 0.1632, instance_loss: 0.4011, weighted_loss: 0.2346, label: 1, bag_size: 1394
batch 199, loss: 0.3580, instance_loss: 0.4608, weighted_loss: 0.3888, label: 2, bag_size: 3174
batch 219, loss: 2.3617, instance_loss: 1.1233, weighted_loss: 1.9902, label: 0, bag_size: 5017
batch 239, loss: 0.0553, instance_loss: 0.3183, weighted_loss: 0.1342, label: 0, bag_size: 5226
batch 259, loss: 0.6454, instance_loss: 0.5476, weighted_loss: 0.6161, label: 2, bag_size: 3534
batch 279, loss: 1.4937, instance_loss: 0.5449, weighted_loss: 1.2091, label: 1, bag_size: 5167
batch 299, loss: 1.1522, instance_loss: 0.6885, weighted_loss: 1.0131, label: 0, bag_size: 3709
batch 319, loss: 0.0384, instance_loss: 0.1861, weighted_loss: 0.0827, label: 2, bag_size: 4978
batch 339, loss: 0.1447, instance_loss: 0.3501, weighted_loss: 0.2063, label: 0, bag_size: 3038
batch 359, loss: 0.1176, instance_loss: 0.5328, weighted_loss: 0.2422, label: 2, bag_size: 3327
batch 379, loss: 0.0347, instance_loss: 0.4049, weighted_loss: 0.1457, label: 0, bag_size: 3701
batch 399, loss: 0.6386, instance_loss: 0.5098, weighted_loss: 0.6000, label: 1, bag_size: 2302
batch 419, loss: 0.0123, instance_loss: 0.1343, weighted_loss: 0.0489, label: 0, bag_size: 4015
batch 439, loss: 0.6652, instance_loss: 0.8633, weighted_loss: 0.7246, label: 2, bag_size: 5743
batch 459, loss: 0.7523, instance_loss: 0.8017, weighted_loss: 0.7671, label: 1, bag_size: 5276
batch 479, loss: 0.0130, instance_loss: 0.6373, weighted_loss: 0.2003, label: 1, bag_size: 4027
batch 499, loss: 1.0852, instance_loss: 0.7648, weighted_loss: 0.9891, label: 2, bag_size: 5307
batch 519, loss: 0.2825, instance_loss: 0.2878, weighted_loss: 0.2841, label: 2, bag_size: 3174
batch 539, loss: 0.0704, instance_loss: 0.3541, weighted_loss: 0.1555, label: 0, bag_size: 3797
batch 559, loss: 0.0405, instance_loss: 0.0898, weighted_loss: 0.0553, label: 2, bag_size: 4775
batch 579, loss: 0.2268, instance_loss: 0.1798, weighted_loss: 0.2127, label: 2, bag_size: 2561
batch 599, loss: 0.0980, instance_loss: 0.3606, weighted_loss: 0.1768, label: 2, bag_size: 3618
batch 619, loss: 2.1030, instance_loss: 1.5331, weighted_loss: 1.9320, label: 1, bag_size: 4258
batch 639, loss: 0.0741, instance_loss: 0.3366, weighted_loss: 0.1528, label: 1, bag_size: 3051
batch 659, loss: 0.6775, instance_loss: 0.7193, weighted_loss: 0.6900, label: 1, bag_size: 4806
batch 679, loss: 0.5699, instance_loss: 0.7619, weighted_loss: 0.6275, label: 0, bag_size: 5656
batch 699, loss: 0.0515, instance_loss: 0.4132, weighted_loss: 0.1600, label: 0, bag_size: 2038
batch 719, loss: 0.0870, instance_loss: 0.8229, weighted_loss: 0.3077, label: 0, bag_size: 5634
batch 739, loss: 0.0252, instance_loss: 0.1285, weighted_loss: 0.0562, label: 2, bag_size: 6148


class 0 clustering acc 0.970917225950783: correct 17360/17880
class 1 clustering acc 0.36946308724832216: correct 2202/5960
Epoch: 43, train_loss: 0.5272, train_clustering_loss:  0.5335, train_error: 0.2107
class 0: acc 0.8225806451612904, correct 204/248
class 1: acc 0.68, correct 170/250
class 2: acc 0.8663967611336032, correct 214/247

Val Set, val_loss: 1.2000, val_error: 0.3404, auc: 0.7929
class 0 clustering acc 0.93572695035461: correct 2111/2256
class 1 clustering acc 0.39228723404255317: correct 295/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.3422, instance_loss: 0.7917, weighted_loss: 0.4771, label: 1, bag_size: 2747
batch 39, loss: 1.7419, instance_loss: 0.8410, weighted_loss: 1.4716, label: 2, bag_size: 909
batch 59, loss: 1.0634, instance_loss: 0.7109, weighted_loss: 0.9576, label: 1, bag_size: 4806
batch 79, loss: 0.2753, instance_loss: 0.5206, weighted_loss: 0.3489, label: 0, bag_size: 4378
batch 99, loss: 0.2119, instance_loss: 0.2329, weighted_loss: 0.2182, label: 2, bag_size: 2359
batch 119, loss: 0.0057, instance_loss: 0.3509, weighted_loss: 0.1093, label: 1, bag_size: 3221
batch 139, loss: 0.2456, instance_loss: 0.3258, weighted_loss: 0.2697, label: 0, bag_size: 8611
batch 159, loss: 0.0372, instance_loss: 0.2684, weighted_loss: 0.1065, label: 2, bag_size: 5924
batch 179, loss: 0.0992, instance_loss: 0.3898, weighted_loss: 0.1863, label: 0, bag_size: 4894
batch 199, loss: 0.0287, instance_loss: 0.1113, weighted_loss: 0.0535, label: 2, bag_size: 3810
batch 219, loss: 0.3371, instance_loss: 0.9244, weighted_loss: 0.5133, label: 1, bag_size: 3821
batch 239, loss: 0.2362, instance_loss: 0.8021, weighted_loss: 0.4060, label: 0, bag_size: 2293
batch 259, loss: 0.0024, instance_loss: 0.1234, weighted_loss: 0.0387, label: 1, bag_size: 1023
batch 279, loss: 1.5312, instance_loss: 0.3569, weighted_loss: 1.1789, label: 0, bag_size: 5108
batch 299, loss: 0.0000, instance_loss: 0.2489, weighted_loss: 0.0747, label: 0, bag_size: 3920
batch 319, loss: 0.0000, instance_loss: 0.1789, weighted_loss: 0.0537, label: 1, bag_size: 5229
batch 339, loss: 0.0597, instance_loss: 0.2894, weighted_loss: 0.1286, label: 0, bag_size: 5782
batch 359, loss: 1.6793, instance_loss: 0.9064, weighted_loss: 1.4474, label: 1, bag_size: 5197
batch 379, loss: 1.0649, instance_loss: 0.4805, weighted_loss: 0.8896, label: 2, bag_size: 6298
batch 399, loss: 0.2201, instance_loss: 1.1294, weighted_loss: 0.4929, label: 1, bag_size: 5205
batch 419, loss: 0.2461, instance_loss: 0.3814, weighted_loss: 0.2867, label: 2, bag_size: 5637
batch 439, loss: 0.1120, instance_loss: 0.5829, weighted_loss: 0.2533, label: 1, bag_size: 2229
batch 459, loss: 0.0009, instance_loss: 0.3192, weighted_loss: 0.0964, label: 0, bag_size: 1132
batch 479, loss: 0.0069, instance_loss: 0.8368, weighted_loss: 0.2559, label: 1, bag_size: 1542
batch 499, loss: 0.1335, instance_loss: 0.2382, weighted_loss: 0.1649, label: 2, bag_size: 5011
batch 519, loss: 0.0168, instance_loss: 0.7383, weighted_loss: 0.2332, label: 1, bag_size: 6513
batch 539, loss: 0.0214, instance_loss: 0.0997, weighted_loss: 0.0449, label: 2, bag_size: 3497
batch 559, loss: 0.5288, instance_loss: 0.8339, weighted_loss: 0.6204, label: 1, bag_size: 4824
batch 579, loss: 0.1953, instance_loss: 0.3383, weighted_loss: 0.2382, label: 1, bag_size: 1221
batch 599, loss: 0.2246, instance_loss: 0.3446, weighted_loss: 0.2606, label: 2, bag_size: 4162
batch 619, loss: 0.6204, instance_loss: 0.8766, weighted_loss: 0.6973, label: 1, bag_size: 3755
batch 639, loss: 1.3385, instance_loss: 0.9778, weighted_loss: 1.2303, label: 1, bag_size: 1307
batch 659, loss: 0.0758, instance_loss: 0.6097, weighted_loss: 0.2360, label: 0, bag_size: 3319
batch 679, loss: 0.1073, instance_loss: 0.5830, weighted_loss: 0.2500, label: 1, bag_size: 3534
batch 699, loss: 0.2079, instance_loss: 0.4007, weighted_loss: 0.2657, label: 0, bag_size: 5848
batch 719, loss: 0.6413, instance_loss: 0.8105, weighted_loss: 0.6921, label: 0, bag_size: 3155
batch 739, loss: 0.6853, instance_loss: 0.7165, weighted_loss: 0.6946, label: 1, bag_size: 3367


class 0 clustering acc 0.9690156599552573: correct 17326/17880
class 1 clustering acc 0.3775167785234899: correct 2250/5960
Epoch: 44, train_loss: 0.5075, train_clustering_loss:  0.5505, train_error: 0.2134
class 0: acc 0.8275862068965517, correct 192/232
class 1: acc 0.7065637065637066, correct 183/259
class 2: acc 0.8307086614173228, correct 211/254

Val Set, val_loss: 1.1144, val_error: 0.3085, auc: 0.8121
class 0 clustering acc 0.9370567375886525: correct 2114/2256
class 1 clustering acc 0.38563829787234044: correct 290/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.2865, instance_loss: 0.3524, weighted_loss: 0.3062, label: 2, bag_size: 2359
batch 39, loss: 0.1035, instance_loss: 0.4877, weighted_loss: 0.2187, label: 1, bag_size: 2731
batch 59, loss: 0.0617, instance_loss: 0.1093, weighted_loss: 0.0760, label: 2, bag_size: 3583
batch 79, loss: 0.3298, instance_loss: 0.7071, weighted_loss: 0.4430, label: 1, bag_size: 10941
batch 99, loss: 0.1890, instance_loss: 0.3187, weighted_loss: 0.2279, label: 2, bag_size: 5637
batch 119, loss: 0.0035, instance_loss: 0.2641, weighted_loss: 0.0817, label: 0, bag_size: 4300
batch 139, loss: 0.0304, instance_loss: 0.2757, weighted_loss: 0.1040, label: 0, bag_size: 2853
batch 159, loss: 2.7243, instance_loss: 1.1309, weighted_loss: 2.2463, label: 1, bag_size: 3261
batch 179, loss: 0.0678, instance_loss: 1.2370, weighted_loss: 0.4186, label: 0, bag_size: 1981
batch 199, loss: 1.7769, instance_loss: 1.2570, weighted_loss: 1.6210, label: 2, bag_size: 4241
batch 219, loss: 1.3310, instance_loss: 1.2235, weighted_loss: 1.2987, label: 1, bag_size: 6993
batch 239, loss: 0.0239, instance_loss: 0.3750, weighted_loss: 0.1292, label: 0, bag_size: 4570
batch 259, loss: 0.0395, instance_loss: 0.6330, weighted_loss: 0.2175, label: 1, bag_size: 14449
batch 279, loss: 1.0558, instance_loss: 0.9119, weighted_loss: 1.0126, label: 1, bag_size: 4395
batch 299, loss: 0.2057, instance_loss: 0.3977, weighted_loss: 0.2633, label: 0, bag_size: 3294
batch 319, loss: 0.4005, instance_loss: 0.4911, weighted_loss: 0.4277, label: 1, bag_size: 800
batch 339, loss: 0.1518, instance_loss: 0.3680, weighted_loss: 0.2167, label: 0, bag_size: 2897
batch 359, loss: 1.0500, instance_loss: 1.0792, weighted_loss: 1.0588, label: 1, bag_size: 11974
batch 379, loss: 0.1033, instance_loss: 0.3825, weighted_loss: 0.1871, label: 1, bag_size: 425
batch 399, loss: 0.6087, instance_loss: 0.7659, weighted_loss: 0.6559, label: 1, bag_size: 3422
batch 419, loss: 0.5072, instance_loss: 0.2438, weighted_loss: 0.4282, label: 2, bag_size: 4788
batch 439, loss: 0.1576, instance_loss: 0.6295, weighted_loss: 0.2992, label: 1, bag_size: 5760
batch 459, loss: 1.1115, instance_loss: 0.5045, weighted_loss: 0.9294, label: 1, bag_size: 3109
batch 479, loss: 0.0167, instance_loss: 0.6416, weighted_loss: 0.2041, label: 1, bag_size: 6513
batch 499, loss: 0.9261, instance_loss: 0.6874, weighted_loss: 0.8545, label: 1, bag_size: 6241
batch 519, loss: 0.0398, instance_loss: 0.6080, weighted_loss: 0.2103, label: 0, bag_size: 3533
batch 539, loss: 0.0682, instance_loss: 0.1897, weighted_loss: 0.1047, label: 2, bag_size: 2422
batch 559, loss: 0.0279, instance_loss: 0.1573, weighted_loss: 0.0667, label: 0, bag_size: 3368
batch 579, loss: 1.8381, instance_loss: 1.2167, weighted_loss: 1.6517, label: 1, bag_size: 1371
batch 599, loss: 0.3123, instance_loss: 0.4516, weighted_loss: 0.3541, label: 2, bag_size: 5743
batch 619, loss: 0.0565, instance_loss: 0.3529, weighted_loss: 0.1454, label: 0, bag_size: 3339
batch 639, loss: 0.2965, instance_loss: 0.5157, weighted_loss: 0.3622, label: 2, bag_size: 1543
batch 659, loss: 0.8616, instance_loss: 0.4187, weighted_loss: 0.7287, label: 0, bag_size: 4122
batch 679, loss: 0.2220, instance_loss: 0.7193, weighted_loss: 0.3712, label: 1, bag_size: 5340
batch 699, loss: 0.5242, instance_loss: 0.8389, weighted_loss: 0.6186, label: 1, bag_size: 2751
batch 719, loss: 0.2557, instance_loss: 0.8918, weighted_loss: 0.4465, label: 2, bag_size: 3604
batch 739, loss: 0.0521, instance_loss: 1.1034, weighted_loss: 0.3675, label: 0, bag_size: 5519


class 0 clustering acc 0.9671140939597316: correct 17292/17880
class 1 clustering acc 0.3788590604026846: correct 2258/5960
Epoch: 45, train_loss: 0.4952, train_clustering_loss:  0.5344, train_error: 0.2121
class 0: acc 0.8108108108108109, correct 210/259
class 1: acc 0.708171206225681, correct 182/257
class 2: acc 0.851528384279476, correct 195/229

Val Set, val_loss: 1.1219, val_error: 0.3830, auc: 0.7964
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.1502659574468085: correct 113/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.1430, instance_loss: 0.2627, weighted_loss: 0.1789, label: 2, bag_size: 2501
batch 39, loss: 0.0093, instance_loss: 0.2323, weighted_loss: 0.0762, label: 0, bag_size: 1233
batch 59, loss: 0.0000, instance_loss: 0.3018, weighted_loss: 0.0905, label: 0, bag_size: 1106
batch 79, loss: 0.0082, instance_loss: 0.0624, weighted_loss: 0.0244, label: 2, bag_size: 2483
batch 99, loss: 0.2724, instance_loss: 0.1587, weighted_loss: 0.2383, label: 2, bag_size: 3112
batch 119, loss: 0.1970, instance_loss: 0.6283, weighted_loss: 0.3264, label: 2, bag_size: 3604
batch 139, loss: 0.4986, instance_loss: 0.2421, weighted_loss: 0.4216, label: 2, bag_size: 3210
batch 159, loss: 0.4459, instance_loss: 0.7087, weighted_loss: 0.5247, label: 1, bag_size: 5340
batch 179, loss: 0.4648, instance_loss: 0.3457, weighted_loss: 0.4291, label: 2, bag_size: 5743
batch 199, loss: 2.0551, instance_loss: 0.8845, weighted_loss: 1.7039, label: 1, bag_size: 1580
batch 219, loss: 0.1629, instance_loss: 0.2861, weighted_loss: 0.1998, label: 2, bag_size: 6273
batch 239, loss: 0.0037, instance_loss: 0.1205, weighted_loss: 0.0388, label: 0, bag_size: 3901
batch 259, loss: 1.8576, instance_loss: 0.8304, weighted_loss: 1.5494, label: 1, bag_size: 1371
batch 279, loss: 0.7212, instance_loss: 0.5344, weighted_loss: 0.6652, label: 1, bag_size: 3367
batch 299, loss: 0.2174, instance_loss: 0.4399, weighted_loss: 0.2841, label: 2, bag_size: 4978
batch 319, loss: 0.0018, instance_loss: 0.1850, weighted_loss: 0.0568, label: 0, bag_size: 4403
batch 339, loss: 0.5680, instance_loss: 0.4659, weighted_loss: 0.5374, label: 0, bag_size: 3113
batch 359, loss: 0.2880, instance_loss: 0.7958, weighted_loss: 0.4403, label: 1, bag_size: 4812
batch 379, loss: 0.0007, instance_loss: 0.2464, weighted_loss: 0.0744, label: 1, bag_size: 2254
batch 399, loss: 0.4463, instance_loss: 0.4570, weighted_loss: 0.4495, label: 2, bag_size: 6298
batch 419, loss: 0.2599, instance_loss: 0.3278, weighted_loss: 0.2802, label: 2, bag_size: 3546
batch 439, loss: 0.0090, instance_loss: 0.2086, weighted_loss: 0.0689, label: 0, bag_size: 4458
batch 459, loss: 0.4403, instance_loss: 0.2930, weighted_loss: 0.3961, label: 2, bag_size: 705
batch 479, loss: 0.0479, instance_loss: 0.1942, weighted_loss: 0.0918, label: 2, bag_size: 4162
batch 499, loss: 0.0467, instance_loss: 0.4658, weighted_loss: 0.1725, label: 0, bag_size: 5282
batch 519, loss: 0.3247, instance_loss: 0.8207, weighted_loss: 0.4735, label: 1, bag_size: 6689
batch 539, loss: 0.8592, instance_loss: 0.6772, weighted_loss: 0.8046, label: 1, bag_size: 2743
batch 559, loss: 0.1208, instance_loss: 0.3287, weighted_loss: 0.1832, label: 2, bag_size: 4978
batch 579, loss: 1.8561, instance_loss: 1.2152, weighted_loss: 1.6638, label: 1, bag_size: 5072
batch 599, loss: 0.0345, instance_loss: 0.1227, weighted_loss: 0.0610, label: 2, bag_size: 3210
batch 619, loss: 0.2768, instance_loss: 1.0229, weighted_loss: 0.5006, label: 1, bag_size: 3821
batch 639, loss: 0.0216, instance_loss: 0.4730, weighted_loss: 0.1570, label: 1, bag_size: 3127
batch 659, loss: 3.9093, instance_loss: 1.8183, weighted_loss: 3.2820, label: 1, bag_size: 3159
batch 679, loss: 0.8719, instance_loss: 0.8118, weighted_loss: 0.8539, label: 1, bag_size: 32
batch 699, loss: 4.5941, instance_loss: 1.6908, weighted_loss: 3.7231, label: 0, bag_size: 1755
batch 719, loss: 0.4848, instance_loss: 0.4344, weighted_loss: 0.4697, label: 2, bag_size: 2481
batch 739, loss: 1.4157, instance_loss: 0.9046, weighted_loss: 1.2624, label: 0, bag_size: 3382


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.3719798657718121: correct 2217/5960
Epoch: 46, train_loss: 0.5026, train_clustering_loss:  0.5381, train_error: 0.2094
class 0: acc 0.8065843621399177, correct 196/243
class 1: acc 0.6963562753036437, correct 172/247
class 2: acc 0.8666666666666667, correct 221/255

Val Set, val_loss: 1.0450, val_error: 0.3298, auc: 0.7916
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.17154255319148937: correct 129/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 46 out of 20


batch 19, loss: 0.0413, instance_loss: 0.1534, weighted_loss: 0.0749, label: 2, bag_size: 4555
batch 39, loss: 0.4300, instance_loss: 1.0913, weighted_loss: 0.6284, label: 0, bag_size: 1352
batch 59, loss: 0.4791, instance_loss: 0.4288, weighted_loss: 0.4640, label: 0, bag_size: 4935
batch 79, loss: 0.1445, instance_loss: 0.1795, weighted_loss: 0.1550, label: 0, bag_size: 4405
batch 99, loss: 2.4109, instance_loss: 1.0156, weighted_loss: 1.9923, label: 0, bag_size: 4717
batch 119, loss: 0.0355, instance_loss: 0.4626, weighted_loss: 0.1636, label: 1, bag_size: 3471
batch 139, loss: 0.6960, instance_loss: 0.5167, weighted_loss: 0.6423, label: 0, bag_size: 4719
batch 159, loss: 0.2154, instance_loss: 0.6466, weighted_loss: 0.3448, label: 0, bag_size: 1170
batch 179, loss: 0.1573, instance_loss: 0.3321, weighted_loss: 0.2098, label: 0, bag_size: 6440
batch 199, loss: 0.0100, instance_loss: 0.3360, weighted_loss: 0.1078, label: 2, bag_size: 4497
batch 219, loss: 0.3604, instance_loss: 0.5030, weighted_loss: 0.4032, label: 2, bag_size: 5924
batch 239, loss: 0.2866, instance_loss: 0.4190, weighted_loss: 0.3263, label: 0, bag_size: 3525
batch 259, loss: 0.8059, instance_loss: 0.9058, weighted_loss: 0.8359, label: 2, bag_size: 4241
batch 279, loss: 0.3285, instance_loss: 0.8468, weighted_loss: 0.4840, label: 0, bag_size: 2069
batch 299, loss: 0.9825, instance_loss: 0.7179, weighted_loss: 0.9032, label: 1, bag_size: 4438
batch 319, loss: 0.0198, instance_loss: 0.3814, weighted_loss: 0.1283, label: 1, bag_size: 2453
batch 339, loss: 0.0181, instance_loss: 0.2901, weighted_loss: 0.0997, label: 2, bag_size: 3607
batch 359, loss: 0.0187, instance_loss: 0.8285, weighted_loss: 0.2617, label: 1, bag_size: 4134
batch 379, loss: 2.1147, instance_loss: 1.6277, weighted_loss: 1.9686, label: 1, bag_size: 3791
batch 399, loss: 0.7086, instance_loss: 0.9802, weighted_loss: 0.7901, label: 1, bag_size: 5072
batch 419, loss: 0.2350, instance_loss: 0.1990, weighted_loss: 0.2242, label: 0, bag_size: 2791
batch 439, loss: 0.1218, instance_loss: 0.2016, weighted_loss: 0.1458, label: 0, bag_size: 4242
batch 459, loss: 0.0954, instance_loss: 0.2658, weighted_loss: 0.1465, label: 2, bag_size: 4162
batch 479, loss: 2.3844, instance_loss: 1.6303, weighted_loss: 2.1582, label: 1, bag_size: 936
batch 499, loss: 0.0015, instance_loss: 0.1388, weighted_loss: 0.0427, label: 0, bag_size: 4403
batch 519, loss: 0.0798, instance_loss: 0.3147, weighted_loss: 0.1503, label: 1, bag_size: 425
batch 539, loss: 0.1027, instance_loss: 0.4045, weighted_loss: 0.1933, label: 1, bag_size: 3519
batch 559, loss: 0.3584, instance_loss: 0.4021, weighted_loss: 0.3715, label: 1, bag_size: 3604
batch 579, loss: 0.3766, instance_loss: 0.4627, weighted_loss: 0.4024, label: 0, bag_size: 5526
batch 599, loss: 0.0169, instance_loss: 0.1599, weighted_loss: 0.0598, label: 2, bag_size: 3121
batch 619, loss: 0.3301, instance_loss: 0.5421, weighted_loss: 0.3937, label: 1, bag_size: 6156
batch 639, loss: 0.3739, instance_loss: 0.4063, weighted_loss: 0.3836, label: 2, bag_size: 5406
batch 659, loss: 0.0000, instance_loss: 0.0070, weighted_loss: 0.0021, label: 0, bag_size: 5003
batch 679, loss: 1.2029, instance_loss: 1.2818, weighted_loss: 1.2266, label: 2, bag_size: 4571
batch 699, loss: 0.0101, instance_loss: 0.6025, weighted_loss: 0.1878, label: 0, bag_size: 4529
batch 719, loss: 0.0720, instance_loss: 0.4985, weighted_loss: 0.1999, label: 1, bag_size: 3127
batch 739, loss: 1.0561, instance_loss: 0.6146, weighted_loss: 0.9236, label: 2, bag_size: 597


class 0 clustering acc 0.9713087248322148: correct 17367/17880
class 1 clustering acc 0.3697986577181208: correct 2204/5960
Epoch: 47, train_loss: 0.5140, train_clustering_loss:  0.5397, train_error: 0.2121
class 0: acc 0.8246268656716418, correct 221/268
class 1: acc 0.6791666666666667, correct 163/240
class 2: acc 0.8565400843881856, correct 203/237

Val Set, val_loss: 0.9428, val_error: 0.2979, auc: 0.8223
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.29654255319148937: correct 223/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 47 out of 20


batch 19, loss: 0.0378, instance_loss: 0.1505, weighted_loss: 0.0716, label: 2, bag_size: 5914
batch 39, loss: 0.8727, instance_loss: 1.2061, weighted_loss: 0.9727, label: 1, bag_size: 5880
batch 59, loss: 1.6979, instance_loss: 1.3658, weighted_loss: 1.5982, label: 1, bag_size: 4258
batch 79, loss: 0.0337, instance_loss: 0.2011, weighted_loss: 0.0839, label: 1, bag_size: 796
batch 99, loss: 0.6189, instance_loss: 1.0252, weighted_loss: 0.7408, label: 0, bag_size: 2069
batch 119, loss: 0.1910, instance_loss: 0.4412, weighted_loss: 0.2661, label: 0, bag_size: 789
batch 139, loss: 0.0516, instance_loss: 0.3455, weighted_loss: 0.1398, label: 0, bag_size: 4997
batch 159, loss: 0.4017, instance_loss: 0.4470, weighted_loss: 0.4153, label: 0, bag_size: 4946
batch 179, loss: 0.1002, instance_loss: 0.1971, weighted_loss: 0.1292, label: 2, bag_size: 3546
batch 199, loss: 0.1706, instance_loss: 0.2481, weighted_loss: 0.1939, label: 2, bag_size: 3026
batch 219, loss: 0.0942, instance_loss: 0.5961, weighted_loss: 0.2448, label: 0, bag_size: 2392
batch 239, loss: 0.0641, instance_loss: 0.4484, weighted_loss: 0.1794, label: 0, bag_size: 2830
batch 259, loss: 0.2980, instance_loss: 0.2891, weighted_loss: 0.2953, label: 2, bag_size: 4096
batch 279, loss: 0.2607, instance_loss: 0.2924, weighted_loss: 0.2702, label: 2, bag_size: 4140
batch 299, loss: 0.1554, instance_loss: 0.5346, weighted_loss: 0.2692, label: 1, bag_size: 4940
batch 319, loss: 0.0890, instance_loss: 0.2967, weighted_loss: 0.1513, label: 1, bag_size: 683
batch 339, loss: 0.1388, instance_loss: 0.5129, weighted_loss: 0.2510, label: 0, bag_size: 4614
batch 359, loss: 0.0706, instance_loss: 0.6800, weighted_loss: 0.2534, label: 0, bag_size: 3298
batch 379, loss: 0.1614, instance_loss: 0.4402, weighted_loss: 0.2450, label: 0, bag_size: 1352
batch 399, loss: 0.0258, instance_loss: 0.2845, weighted_loss: 0.1034, label: 1, bag_size: 2870
batch 419, loss: 0.0035, instance_loss: 0.0933, weighted_loss: 0.0305, label: 0, bag_size: 5029
batch 439, loss: 0.4187, instance_loss: 0.5256, weighted_loss: 0.4507, label: 1, bag_size: 2796
batch 459, loss: 0.4412, instance_loss: 0.5316, weighted_loss: 0.4683, label: 0, bag_size: 3752
batch 479, loss: 0.0917, instance_loss: 0.4580, weighted_loss: 0.2016, label: 1, bag_size: 2092
batch 499, loss: 1.1436, instance_loss: 1.0271, weighted_loss: 1.1086, label: 2, bag_size: 4316
batch 519, loss: 0.0949, instance_loss: 0.2367, weighted_loss: 0.1375, label: 2, bag_size: 6644
batch 539, loss: 0.6503, instance_loss: 0.9326, weighted_loss: 0.7350, label: 1, bag_size: 2472
batch 559, loss: 0.1867, instance_loss: 0.3793, weighted_loss: 0.2445, label: 1, bag_size: 2865
batch 579, loss: 0.0828, instance_loss: 0.1308, weighted_loss: 0.0972, label: 2, bag_size: 5011
batch 599, loss: 1.0283, instance_loss: 0.8187, weighted_loss: 0.9654, label: 2, bag_size: 22464
batch 619, loss: 1.2862, instance_loss: 0.6436, weighted_loss: 1.0934, label: 1, bag_size: 5572
batch 639, loss: 0.3056, instance_loss: 0.2058, weighted_loss: 0.2757, label: 2, bag_size: 597
batch 659, loss: 0.8830, instance_loss: 0.4641, weighted_loss: 0.7573, label: 1, bag_size: 3296
batch 679, loss: 0.4078, instance_loss: 0.5042, weighted_loss: 0.4367, label: 1, bag_size: 800
batch 699, loss: 0.5313, instance_loss: 0.4912, weighted_loss: 0.5193, label: 1, bag_size: 800
batch 719, loss: 0.1271, instance_loss: 0.3387, weighted_loss: 0.1906, label: 2, bag_size: 3778
batch 739, loss: 0.0960, instance_loss: 0.8182, weighted_loss: 0.3127, label: 1, bag_size: 3986


class 0 clustering acc 0.96834451901566: correct 17314/17880
class 1 clustering acc 0.4224832214765101: correct 2518/5960
Epoch: 48, train_loss: 0.4405, train_clustering_loss:  0.5111, train_error: 0.1812
class 0: acc 0.8461538461538461, correct 220/260
class 1: acc 0.7357723577235772, correct 181/246
class 2: acc 0.8744769874476988, correct 209/239

Val Set, val_loss: 1.3530, val_error: 0.4255, auc: 0.7969
class 0 clustering acc 0.9481382978723404: correct 2139/2256
class 1 clustering acc 0.11569148936170212: correct 87/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 48 out of 20


batch 19, loss: 0.0115, instance_loss: 0.0890, weighted_loss: 0.0347, label: 2, bag_size: 5914
batch 39, loss: 0.0020, instance_loss: 0.2569, weighted_loss: 0.0785, label: 0, bag_size: 6765
batch 59, loss: 0.0032, instance_loss: 0.1958, weighted_loss: 0.0610, label: 2, bag_size: 88
batch 79, loss: 0.8162, instance_loss: 0.6767, weighted_loss: 0.7744, label: 2, bag_size: 5426
batch 99, loss: 0.2787, instance_loss: 0.1897, weighted_loss: 0.2520, label: 2, bag_size: 4223
batch 119, loss: 0.0866, instance_loss: 0.4902, weighted_loss: 0.2077, label: 1, bag_size: 5086
batch 139, loss: 0.0519, instance_loss: 0.2815, weighted_loss: 0.1208, label: 1, bag_size: 683
batch 159, loss: 0.2087, instance_loss: 0.7751, weighted_loss: 0.3786, label: 0, bag_size: 5330
batch 179, loss: 0.1009, instance_loss: 0.2665, weighted_loss: 0.1506, label: 1, bag_size: 1410
batch 199, loss: 0.0059, instance_loss: 0.0517, weighted_loss: 0.0196, label: 2, bag_size: 2483
batch 219, loss: 0.0134, instance_loss: 0.1749, weighted_loss: 0.0618, label: 1, bag_size: 259
batch 239, loss: 0.2522, instance_loss: 0.4643, weighted_loss: 0.3158, label: 2, bag_size: 5017
batch 259, loss: 0.1833, instance_loss: 0.5485, weighted_loss: 0.2929, label: 0, bag_size: 3525
batch 279, loss: 0.0582, instance_loss: 0.3998, weighted_loss: 0.1607, label: 0, bag_size: 4524
batch 299, loss: 0.1899, instance_loss: 0.4656, weighted_loss: 0.2726, label: 2, bag_size: 3112
batch 319, loss: 0.0957, instance_loss: 0.1648, weighted_loss: 0.1164, label: 2, bag_size: 2422
batch 339, loss: 0.0054, instance_loss: 0.2679, weighted_loss: 0.0841, label: 1, bag_size: 1836
batch 359, loss: 0.3291, instance_loss: 0.6230, weighted_loss: 0.4173, label: 0, bag_size: 4460
batch 379, loss: 0.7475, instance_loss: 0.9230, weighted_loss: 0.8002, label: 1, bag_size: 3644
batch 399, loss: 0.0120, instance_loss: 0.0809, weighted_loss: 0.0326, label: 2, bag_size: 4569
batch 419, loss: 0.1196, instance_loss: 0.2842, weighted_loss: 0.1690, label: 2, bag_size: 3534
batch 439, loss: 0.9404, instance_loss: 0.9797, weighted_loss: 0.9522, label: 1, bag_size: 2302
batch 459, loss: 0.3452, instance_loss: 0.8084, weighted_loss: 0.4842, label: 1, bag_size: 11974
batch 479, loss: 0.0431, instance_loss: 0.3900, weighted_loss: 0.1472, label: 2, bag_size: 2561
batch 499, loss: 0.7075, instance_loss: 0.5292, weighted_loss: 0.6540, label: 0, bag_size: 1049
batch 519, loss: 0.2529, instance_loss: 0.5275, weighted_loss: 0.3353, label: 2, bag_size: 5072
batch 539, loss: 0.0000, instance_loss: 0.2858, weighted_loss: 0.0857, label: 1, bag_size: 6277
batch 559, loss: 0.0387, instance_loss: 0.3572, weighted_loss: 0.1343, label: 1, bag_size: 6315
batch 579, loss: 6.6122, instance_loss: 1.5933, weighted_loss: 5.1065, label: 2, bag_size: 2049
batch 599, loss: 0.0377, instance_loss: 0.4299, weighted_loss: 0.1553, label: 0, bag_size: 14070
batch 619, loss: 0.2186, instance_loss: 0.3561, weighted_loss: 0.2599, label: 2, bag_size: 3604
batch 639, loss: 0.9984, instance_loss: 0.9710, weighted_loss: 0.9902, label: 0, bag_size: 3841
batch 659, loss: 0.1207, instance_loss: 0.3559, weighted_loss: 0.1912, label: 1, bag_size: 796
batch 679, loss: 0.0842, instance_loss: 0.9702, weighted_loss: 0.3500, label: 0, bag_size: 2824
batch 699, loss: 0.6203, instance_loss: 0.4695, weighted_loss: 0.5751, label: 2, bag_size: 2481
batch 719, loss: 0.1450, instance_loss: 0.3638, weighted_loss: 0.2106, label: 2, bag_size: 2486
batch 739, loss: 1.1772, instance_loss: 0.9982, weighted_loss: 1.1235, label: 0, bag_size: 4719


class 0 clustering acc 0.9676733780760627: correct 17302/17880
class 1 clustering acc 0.37348993288590604: correct 2226/5960
Epoch: 49, train_loss: 0.4882, train_clustering_loss:  0.5554, train_error: 0.1946
class 0: acc 0.8112449799196787, correct 202/249
class 1: acc 0.7644787644787645, correct 198/259
class 2: acc 0.8438818565400844, correct 200/237

Val Set, val_loss: 1.0095, val_error: 0.3298, auc: 0.8053
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.20345744680851063: correct 153/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 49 out of 20


batch 19, loss: 1.0094, instance_loss: 0.7400, weighted_loss: 0.9285, label: 2, bag_size: 5406
batch 39, loss: 0.9726, instance_loss: 0.9225, weighted_loss: 0.9576, label: 0, bag_size: 4648
batch 59, loss: 0.4610, instance_loss: 0.9090, weighted_loss: 0.5954, label: 0, bag_size: 3341
batch 79, loss: 0.0269, instance_loss: 0.1400, weighted_loss: 0.0608, label: 0, bag_size: 5500
batch 99, loss: 0.0334, instance_loss: 0.1505, weighted_loss: 0.0685, label: 2, bag_size: 2313
batch 119, loss: 0.0559, instance_loss: 0.4139, weighted_loss: 0.1633, label: 0, bag_size: 3936
batch 139, loss: 0.0516, instance_loss: 0.2059, weighted_loss: 0.0979, label: 2, bag_size: 4555
batch 159, loss: 0.7780, instance_loss: 0.7626, weighted_loss: 0.7734, label: 2, bag_size: 5426
batch 179, loss: 0.1121, instance_loss: 0.2950, weighted_loss: 0.1670, label: 1, bag_size: 2796
batch 199, loss: 1.6107, instance_loss: 1.2063, weighted_loss: 1.4894, label: 1, bag_size: 3508
batch 219, loss: 0.0870, instance_loss: 0.3402, weighted_loss: 0.1630, label: 2, bag_size: 4372
batch 239, loss: 0.9619, instance_loss: 0.4783, weighted_loss: 0.8168, label: 2, bag_size: 3174
batch 259, loss: 0.6429, instance_loss: 0.5457, weighted_loss: 0.6138, label: 0, bag_size: 4994
batch 279, loss: 0.0664, instance_loss: 0.2852, weighted_loss: 0.1320, label: 0, bag_size: 6863
batch 299, loss: 0.0865, instance_loss: 0.7360, weighted_loss: 0.2814, label: 1, bag_size: 3471
batch 319, loss: 0.0735, instance_loss: 0.4768, weighted_loss: 0.1945, label: 1, bag_size: 6243
batch 339, loss: 0.2348, instance_loss: 0.2954, weighted_loss: 0.2530, label: 0, bag_size: 4855
batch 359, loss: 0.2912, instance_loss: 0.7593, weighted_loss: 0.4316, label: 0, bag_size: 1944
batch 379, loss: 0.6589, instance_loss: 0.6020, weighted_loss: 0.6418, label: 2, bag_size: 3534
batch 399, loss: 0.0221, instance_loss: 0.1830, weighted_loss: 0.0703, label: 2, bag_size: 5914
batch 419, loss: 0.2336, instance_loss: 0.4422, weighted_loss: 0.2962, label: 2, bag_size: 3327
batch 439, loss: 0.0751, instance_loss: 0.2937, weighted_loss: 0.1407, label: 1, bag_size: 4599
batch 459, loss: 2.4873, instance_loss: 1.5730, weighted_loss: 2.2130, label: 1, bag_size: 2425
batch 479, loss: 0.2196, instance_loss: 0.3123, weighted_loss: 0.2474, label: 2, bag_size: 3583
batch 499, loss: 0.0137, instance_loss: 0.2628, weighted_loss: 0.0884, label: 2, bag_size: 4203
batch 519, loss: 0.4049, instance_loss: 0.4900, weighted_loss: 0.4304, label: 2, bag_size: 4140
batch 539, loss: 0.0466, instance_loss: 1.0476, weighted_loss: 0.3469, label: 0, bag_size: 2231
batch 559, loss: 0.6408, instance_loss: 1.0657, weighted_loss: 0.7683, label: 0, bag_size: 313
batch 579, loss: 0.0202, instance_loss: 0.6896, weighted_loss: 0.2210, label: 1, bag_size: 5833
batch 599, loss: 1.1501, instance_loss: 0.6064, weighted_loss: 0.9870, label: 0, bag_size: 2559
batch 619, loss: 0.9227, instance_loss: 0.5573, weighted_loss: 0.8131, label: 1, bag_size: 1500
batch 639, loss: 0.5456, instance_loss: 0.8092, weighted_loss: 0.6247, label: 1, bag_size: 832
batch 659, loss: 2.4639, instance_loss: 0.8980, weighted_loss: 1.9941, label: 0, bag_size: 2597
batch 679, loss: 1.6293, instance_loss: 0.7182, weighted_loss: 1.3560, label: 1, bag_size: 2859
batch 699, loss: 0.1483, instance_loss: 0.4607, weighted_loss: 0.2420, label: 1, bag_size: 1510
batch 719, loss: 0.0072, instance_loss: 0.2714, weighted_loss: 0.0865, label: 0, bag_size: 4831
batch 739, loss: 0.0133, instance_loss: 0.3522, weighted_loss: 0.1150, label: 1, bag_size: 3611


class 0 clustering acc 0.9682885906040268: correct 17313/17880
class 1 clustering acc 0.3763422818791946: correct 2243/5960
Epoch: 50, train_loss: 0.4824, train_clustering_loss:  0.5321, train_error: 0.1973
class 0: acc 0.8154506437768241, correct 190/233
class 1: acc 0.7306273062730627, correct 198/271
class 2: acc 0.8713692946058091, correct 210/241

Val Set, val_loss: 1.1210, val_error: 0.4255, auc: 0.7729
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.12101063829787234: correct 91/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 50 out of 20


batch 19, loss: 0.3077, instance_loss: 0.6519, weighted_loss: 0.4109, label: 1, bag_size: 6241
batch 39, loss: 0.0026, instance_loss: 0.2483, weighted_loss: 0.0763, label: 0, bag_size: 3754
batch 59, loss: 0.1422, instance_loss: 0.2770, weighted_loss: 0.1826, label: 2, bag_size: 6594
batch 79, loss: 0.0442, instance_loss: 0.3729, weighted_loss: 0.1428, label: 1, bag_size: 4578
batch 99, loss: 0.0767, instance_loss: 0.7584, weighted_loss: 0.2812, label: 1, bag_size: 3403
batch 119, loss: 1.4444, instance_loss: 0.8054, weighted_loss: 1.2527, label: 1, bag_size: 4806
batch 139, loss: 0.0173, instance_loss: 0.4748, weighted_loss: 0.1545, label: 0, bag_size: 3983
batch 159, loss: 0.6146, instance_loss: 1.0503, weighted_loss: 0.7454, label: 1, bag_size: 4258
batch 179, loss: 0.5185, instance_loss: 0.6859, weighted_loss: 0.5687, label: 0, bag_size: 2830
batch 199, loss: 0.2480, instance_loss: 0.5901, weighted_loss: 0.3506, label: 0, bag_size: 673
batch 219, loss: 0.8067, instance_loss: 1.0071, weighted_loss: 0.8668, label: 0, bag_size: 4626
batch 239, loss: 0.0146, instance_loss: 0.1811, weighted_loss: 0.0646, label: 2, bag_size: 3121
batch 259, loss: 0.0251, instance_loss: 0.3467, weighted_loss: 0.1216, label: 0, bag_size: 5353
batch 279, loss: 1.8837, instance_loss: 0.4315, weighted_loss: 1.4480, label: 2, bag_size: 2561
batch 299, loss: 0.3378, instance_loss: 0.7779, weighted_loss: 0.4698, label: 1, bag_size: 2998
batch 319, loss: 0.3197, instance_loss: 0.4377, weighted_loss: 0.3551, label: 2, bag_size: 5743
batch 339, loss: 1.5803, instance_loss: 1.0335, weighted_loss: 1.4162, label: 0, bag_size: 1365
batch 359, loss: 0.7044, instance_loss: 0.5863, weighted_loss: 0.6690, label: 1, bag_size: 874
batch 379, loss: 1.1065, instance_loss: 0.7185, weighted_loss: 0.9901, label: 2, bag_size: 223
batch 399, loss: 0.6010, instance_loss: 0.4952, weighted_loss: 0.5693, label: 1, bag_size: 2731
batch 419, loss: 0.2917, instance_loss: 0.5264, weighted_loss: 0.3621, label: 2, bag_size: 5011
batch 439, loss: 3.2705, instance_loss: 1.3586, weighted_loss: 2.6969, label: 0, bag_size: 7504
batch 459, loss: 0.4536, instance_loss: 0.4215, weighted_loss: 0.4439, label: 2, bag_size: 4487
batch 479, loss: 1.0706, instance_loss: 0.8722, weighted_loss: 1.0111, label: 1, bag_size: 5512
batch 499, loss: 0.1622, instance_loss: 0.4527, weighted_loss: 0.2494, label: 0, bag_size: 1625
batch 519, loss: 0.0854, instance_loss: 0.2731, weighted_loss: 0.1417, label: 1, bag_size: 1221
batch 539, loss: 0.0974, instance_loss: 0.4091, weighted_loss: 0.1909, label: 0, bag_size: 2487
batch 559, loss: 0.0119, instance_loss: 0.3847, weighted_loss: 0.1237, label: 0, bag_size: 4403
batch 579, loss: 0.5833, instance_loss: 0.5804, weighted_loss: 0.5824, label: 1, bag_size: 5118
batch 599, loss: 0.6797, instance_loss: 0.5847, weighted_loss: 0.6512, label: 0, bag_size: 4460
batch 619, loss: 0.6893, instance_loss: 0.7321, weighted_loss: 0.7022, label: 0, bag_size: 4122
batch 639, loss: 2.0939, instance_loss: 0.6800, weighted_loss: 1.6697, label: 2, bag_size: 3274
batch 659, loss: 0.3142, instance_loss: 1.0863, weighted_loss: 0.5459, label: 1, bag_size: 4192
batch 679, loss: 0.0308, instance_loss: 0.2735, weighted_loss: 0.1036, label: 2, bag_size: 3810
batch 699, loss: 0.1305, instance_loss: 0.2250, weighted_loss: 0.1589, label: 0, bag_size: 4707
batch 719, loss: 0.3206, instance_loss: 0.1983, weighted_loss: 0.2839, label: 2, bag_size: 597
batch 739, loss: 0.1713, instance_loss: 0.6323, weighted_loss: 0.3096, label: 1, bag_size: 2962


class 0 clustering acc 0.9706935123042506: correct 17356/17880
class 1 clustering acc 0.38221476510067115: correct 2278/5960
Epoch: 51, train_loss: 0.5034, train_clustering_loss:  0.5330, train_error: 0.2027
class 0: acc 0.810077519379845, correct 209/258
class 1: acc 0.7364016736401674, correct 176/239
class 2: acc 0.842741935483871, correct 209/248

Val Set, val_loss: 1.0704, val_error: 0.3511, auc: 0.7864
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.32313829787234044: correct 243/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 51 out of 20
Early stopping
Val error: 0.2979, ROC AUC: 0.8027
Test error: 0.2766, ROC AUC: 0.8474
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.2855, instance_loss: 0.6659, weighted_loss: 0.3996, label: 1, bag_size: 6717
batch 39, loss: 1.2009, instance_loss: 0.7722, weighted_loss: 1.0723, label: 0, bag_size: 6430
batch 59, loss: 1.2234, instance_loss: 0.8019, weighted_loss: 1.0970, label: 2, bag_size: 2209
batch 79, loss: 0.7233, instance_loss: 0.7987, weighted_loss: 0.7459, label: 2, bag_size: 2031
batch 99, loss: 2.5478, instance_loss: 0.7940, weighted_loss: 2.0217, label: 1, bag_size: 1580
batch 119, loss: 2.0579, instance_loss: 0.6822, weighted_loss: 1.6452, label: 0, bag_size: 2231
batch 139, loss: 0.6311, instance_loss: 0.7642, weighted_loss: 0.6710, label: 1, bag_size: 2753
batch 159, loss: 1.0825, instance_loss: 0.7787, weighted_loss: 0.9913, label: 0, bag_size: 1106
batch 179, loss: 1.2755, instance_loss: 0.8555, weighted_loss: 1.1495, label: 0, bag_size: 477
batch 199, loss: 1.2609, instance_loss: 0.9507, weighted_loss: 1.1678, label: 2, bag_size: 2209
batch 219, loss: 0.4881, instance_loss: 0.5978, weighted_loss: 0.5210, label: 2, bag_size: 4088
batch 239, loss: 1.6959, instance_loss: 0.8336, weighted_loss: 1.4372, label: 0, bag_size: 5036
batch 259, loss: 1.0327, instance_loss: 0.6667, weighted_loss: 0.9229, label: 2, bag_size: 4302
batch 279, loss: 0.3930, instance_loss: 0.5826, weighted_loss: 0.4499, label: 2, bag_size: 2561
batch 299, loss: 0.5830, instance_loss: 0.6536, weighted_loss: 0.6041, label: 0, bag_size: 2825
batch 319, loss: 1.8224, instance_loss: 0.9883, weighted_loss: 1.5722, label: 2, bag_size: 4316
batch 339, loss: 2.2263, instance_loss: 0.8507, weighted_loss: 1.8136, label: 1, bag_size: 3322
batch 359, loss: 0.5545, instance_loss: 0.5880, weighted_loss: 0.5645, label: 1, bag_size: 5756
batch 379, loss: 1.2840, instance_loss: 0.8268, weighted_loss: 1.1469, label: 0, bag_size: 4572
batch 399, loss: 0.3112, instance_loss: 0.5121, weighted_loss: 0.3715, label: 1, bag_size: 4599
batch 419, loss: 0.6080, instance_loss: 0.8296, weighted_loss: 0.6745, label: 2, bag_size: 2770
batch 439, loss: 0.4165, instance_loss: 0.6801, weighted_loss: 0.4956, label: 2, bag_size: 4569
batch 459, loss: 0.9410, instance_loss: 0.7480, weighted_loss: 0.8831, label: 2, bag_size: 6644
batch 479, loss: 0.9070, instance_loss: 0.8335, weighted_loss: 0.8850, label: 0, bag_size: 4379
batch 499, loss: 1.6146, instance_loss: 0.6083, weighted_loss: 1.3127, label: 1, bag_size: 5756
batch 519, loss: 0.8275, instance_loss: 0.6120, weighted_loss: 0.7628, label: 0, bag_size: 3443
batch 539, loss: 0.5464, instance_loss: 0.6155, weighted_loss: 0.5672, label: 2, bag_size: 4241
batch 559, loss: 0.3581, instance_loss: 0.4748, weighted_loss: 0.3931, label: 1, bag_size: 4898
batch 579, loss: 0.8781, instance_loss: 0.5814, weighted_loss: 0.7891, label: 0, bag_size: 2712
batch 599, loss: 0.4759, instance_loss: 0.5208, weighted_loss: 0.4894, label: 0, bag_size: 3871
batch 619, loss: 0.5936, instance_loss: 0.5064, weighted_loss: 0.5675, label: 0, bag_size: 3348
batch 639, loss: 0.6462, instance_loss: 0.4932, weighted_loss: 0.6003, label: 1, bag_size: 2878
batch 659, loss: 0.8186, instance_loss: 0.8276, weighted_loss: 0.8213, label: 0, bag_size: 4760
batch 679, loss: 1.0665, instance_loss: 0.5171, weighted_loss: 0.9016, label: 1, bag_size: 5728
batch 699, loss: 0.7164, instance_loss: 0.5986, weighted_loss: 0.6811, label: 2, bag_size: 2905
batch 719, loss: 0.8980, instance_loss: 0.5990, weighted_loss: 0.8083, label: 1, bag_size: 1197
batch 739, loss: 1.8563, instance_loss: 0.7248, weighted_loss: 1.5169, label: 0, bag_size: 4347


class 0 clustering acc 0.99748322147651: correct 17835/17880
class 1 clustering acc 0.011073825503355705: correct 66/5960
Epoch: 0, train_loss: 1.0323, train_clustering_loss:  0.7205, train_error: 0.4685
class 0: acc 0.484251968503937, correct 123/254
class 1: acc 0.46311475409836067, correct 113/244
class 2: acc 0.6477732793522267, correct 160/247

Val Set, val_loss: 0.9409, val_error: 0.5106, auc: 0.7491
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.006648936170212766: correct 5/752
class 0: acc 0.34615384615384615, correct 18/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (inf --> 0.940949).  Saving model ...


batch 19, loss: 1.6883, instance_loss: 0.8911, weighted_loss: 1.4491, label: 2, bag_size: 6298
batch 39, loss: 0.1439, instance_loss: 0.3700, weighted_loss: 0.2117, label: 2, bag_size: 4910
batch 59, loss: 0.7847, instance_loss: 0.7081, weighted_loss: 0.7617, label: 1, bag_size: 2229
batch 79, loss: 0.8231, instance_loss: 0.8365, weighted_loss: 0.8271, label: 0, bag_size: 3156
batch 99, loss: 0.4819, instance_loss: 0.6651, weighted_loss: 0.5369, label: 0, bag_size: 6430
batch 119, loss: 2.0915, instance_loss: 0.9682, weighted_loss: 1.7545, label: 1, bag_size: 2747
batch 139, loss: 0.8573, instance_loss: 0.6214, weighted_loss: 0.7865, label: 2, bag_size: 3778
batch 159, loss: 0.6722, instance_loss: 0.7966, weighted_loss: 0.7095, label: 0, bag_size: 3594
batch 179, loss: 0.3528, instance_loss: 0.3744, weighted_loss: 0.3593, label: 1, bag_size: 2809
batch 199, loss: 0.2442, instance_loss: 0.3897, weighted_loss: 0.2878, label: 2, bag_size: 5017
batch 219, loss: 0.8611, instance_loss: 0.6133, weighted_loss: 0.7868, label: 1, bag_size: 2921
batch 239, loss: 0.8523, instance_loss: 1.1816, weighted_loss: 0.9511, label: 2, bag_size: 4745
batch 259, loss: 0.5273, instance_loss: 0.5000, weighted_loss: 0.5191, label: 1, bag_size: 1029
batch 279, loss: 0.9031, instance_loss: 0.5512, weighted_loss: 0.7976, label: 1, bag_size: 5276
batch 299, loss: 1.1863, instance_loss: 0.7880, weighted_loss: 1.0668, label: 0, bag_size: 3113
batch 319, loss: 0.5700, instance_loss: 0.5837, weighted_loss: 0.5741, label: 0, bag_size: 3294
batch 339, loss: 0.6435, instance_loss: 0.5579, weighted_loss: 0.6178, label: 2, bag_size: 4088
batch 359, loss: 0.8775, instance_loss: 0.5982, weighted_loss: 0.7937, label: 2, bag_size: 705
batch 379, loss: 0.6948, instance_loss: 0.7214, weighted_loss: 0.7028, label: 0, bag_size: 4831
batch 399, loss: 0.2608, instance_loss: 0.5263, weighted_loss: 0.3405, label: 2, bag_size: 5037
batch 419, loss: 1.6227, instance_loss: 1.0016, weighted_loss: 1.4364, label: 2, bag_size: 4571
batch 439, loss: 0.5206, instance_loss: 0.5923, weighted_loss: 0.5421, label: 2, bag_size: 4775
batch 459, loss: 1.4759, instance_loss: 0.7904, weighted_loss: 1.2702, label: 1, bag_size: 11974
batch 479, loss: 1.7494, instance_loss: 1.0729, weighted_loss: 1.5465, label: 1, bag_size: 4181
batch 499, loss: 1.3271, instance_loss: 0.8671, weighted_loss: 1.1891, label: 2, bag_size: 724
batch 519, loss: 1.4076, instance_loss: 0.8155, weighted_loss: 1.2300, label: 2, bag_size: 1050
batch 539, loss: 0.2987, instance_loss: 0.4321, weighted_loss: 0.3387, label: 1, bag_size: 2092
batch 559, loss: 0.5601, instance_loss: 0.5244, weighted_loss: 0.5494, label: 0, bag_size: 5915
batch 579, loss: 0.6283, instance_loss: 0.5294, weighted_loss: 0.5987, label: 0, bag_size: 4274
batch 599, loss: 0.8639, instance_loss: 0.6486, weighted_loss: 0.7993, label: 0, bag_size: 3382
batch 619, loss: 1.7999, instance_loss: 0.8998, weighted_loss: 1.5299, label: 1, bag_size: 869
batch 639, loss: 0.6540, instance_loss: 0.6191, weighted_loss: 0.6435, label: 1, bag_size: 5229
batch 659, loss: 0.8470, instance_loss: 0.8011, weighted_loss: 0.8332, label: 2, bag_size: 4691
batch 679, loss: 0.9116, instance_loss: 0.4434, weighted_loss: 0.7712, label: 0, bag_size: 5950
batch 699, loss: 0.7653, instance_loss: 0.6877, weighted_loss: 0.7420, label: 2, bag_size: 614
batch 719, loss: 1.3283, instance_loss: 0.7971, weighted_loss: 1.1689, label: 1, bag_size: 3100
batch 739, loss: 0.7630, instance_loss: 0.7569, weighted_loss: 0.7612, label: 1, bag_size: 6025


class 0 clustering acc 0.9957494407158837: correct 17804/17880
class 1 clustering acc 0.03271812080536913: correct 195/5960
Epoch: 1, train_loss: 0.9324, train_clustering_loss:  0.6806, train_error: 0.4282
class 0: acc 0.5910931174089069, correct 146/247
class 1: acc 0.49624060150375937, correct 132/266
class 2: acc 0.6379310344827587, correct 148/232

Val Set, val_loss: 1.1419, val_error: 0.6277, auc: 0.7903
class 0 clustering acc 0.9995567375886525: correct 2255/2256
class 1 clustering acc 0.006648936170212766: correct 5/752
class 0: acc 0.21153846153846154, correct 11/52
class 1: acc 0.4, correct 12/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2092, instance_loss: 0.4052, weighted_loss: 0.2680, label: 2, bag_size: 4555
batch 39, loss: 1.2127, instance_loss: 0.8438, weighted_loss: 1.1021, label: 0, bag_size: 477
batch 59, loss: 0.4267, instance_loss: 0.6656, weighted_loss: 0.4984, label: 2, bag_size: 3094
batch 79, loss: 0.3013, instance_loss: 0.3546, weighted_loss: 0.3173, label: 1, bag_size: 5412
batch 99, loss: 0.8025, instance_loss: 0.6593, weighted_loss: 0.7595, label: 2, bag_size: 4691
batch 119, loss: 0.9750, instance_loss: 0.9442, weighted_loss: 0.9658, label: 0, bag_size: 4797
batch 139, loss: 0.3925, instance_loss: 0.3790, weighted_loss: 0.3884, label: 2, bag_size: 1094
batch 159, loss: 0.7435, instance_loss: 0.6865, weighted_loss: 0.7264, label: 2, bag_size: 6644
batch 179, loss: 0.6018, instance_loss: 0.5972, weighted_loss: 0.6004, label: 1, bag_size: 2905
batch 199, loss: 2.8507, instance_loss: 0.9964, weighted_loss: 2.2944, label: 2, bag_size: 223
batch 219, loss: 0.3667, instance_loss: 0.4625, weighted_loss: 0.3954, label: 0, bag_size: 4165
batch 239, loss: 0.6614, instance_loss: 0.6805, weighted_loss: 0.6671, label: 1, bag_size: 4184
batch 259, loss: 1.1322, instance_loss: 0.8148, weighted_loss: 1.0370, label: 0, bag_size: 8611
batch 279, loss: 0.7254, instance_loss: 0.5024, weighted_loss: 0.6585, label: 1, bag_size: 2865
batch 299, loss: 0.2102, instance_loss: 0.3273, weighted_loss: 0.2453, label: 1, bag_size: 3460
batch 319, loss: 1.2090, instance_loss: 0.6962, weighted_loss: 1.0552, label: 1, bag_size: 4467
batch 339, loss: 0.5222, instance_loss: 0.7229, weighted_loss: 0.5824, label: 0, bag_size: 4700
batch 359, loss: 1.4174, instance_loss: 0.9643, weighted_loss: 1.2815, label: 1, bag_size: 5205
batch 379, loss: 0.3119, instance_loss: 0.7113, weighted_loss: 0.4317, label: 2, bag_size: 4978
batch 399, loss: 0.1935, instance_loss: 0.3680, weighted_loss: 0.2459, label: 1, bag_size: 2731
batch 419, loss: 1.7442, instance_loss: 0.8854, weighted_loss: 1.4866, label: 0, bag_size: 5023
batch 439, loss: 0.9534, instance_loss: 0.7008, weighted_loss: 0.8777, label: 2, bag_size: 3778
batch 459, loss: 0.7241, instance_loss: 0.6420, weighted_loss: 0.6995, label: 2, bag_size: 3583
batch 479, loss: 1.2561, instance_loss: 0.7421, weighted_loss: 1.1019, label: 1, bag_size: 1860
batch 499, loss: 1.4317, instance_loss: 0.8839, weighted_loss: 1.2674, label: 0, bag_size: 436
batch 519, loss: 1.4127, instance_loss: 0.7514, weighted_loss: 1.2143, label: 1, bag_size: 4373
batch 539, loss: 0.3238, instance_loss: 0.3327, weighted_loss: 0.3265, label: 1, bag_size: 2878
batch 559, loss: 0.1991, instance_loss: 0.3096, weighted_loss: 0.2322, label: 2, bag_size: 1094
batch 579, loss: 1.3830, instance_loss: 0.6920, weighted_loss: 1.1757, label: 2, bag_size: 5307
batch 599, loss: 1.0132, instance_loss: 0.6181, weighted_loss: 0.8946, label: 1, bag_size: 4784
batch 619, loss: 0.7181, instance_loss: 0.5903, weighted_loss: 0.6797, label: 0, bag_size: 2983
batch 639, loss: 0.6847, instance_loss: 0.7318, weighted_loss: 0.6989, label: 0, bag_size: 2232
batch 659, loss: 2.2753, instance_loss: 0.9239, weighted_loss: 1.8699, label: 1, bag_size: 5035
batch 679, loss: 0.1368, instance_loss: 0.5865, weighted_loss: 0.2717, label: 2, bag_size: 6001
batch 699, loss: 0.9047, instance_loss: 0.5539, weighted_loss: 0.7995, label: 1, bag_size: 2643
batch 719, loss: 0.8640, instance_loss: 0.9032, weighted_loss: 0.8757, label: 2, bag_size: 4241
batch 739, loss: 1.3549, instance_loss: 0.7526, weighted_loss: 1.1742, label: 1, bag_size: 4806


class 0 clustering acc 0.9919463087248322: correct 17736/17880
class 1 clustering acc 0.06090604026845638: correct 363/5960
Epoch: 2, train_loss: 0.8684, train_clustering_loss:  0.6554, train_error: 0.3879
class 0: acc 0.5932203389830508, correct 140/236
class 1: acc 0.51440329218107, correct 125/243
class 2: acc 0.7180451127819549, correct 191/266

Val Set, val_loss: 0.8668, val_error: 0.3830, auc: 0.8217
class 0 clustering acc 0.9968971631205674: correct 2249/2256
class 1 clustering acc 0.009308510638297872: correct 7/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.940949 --> 0.866837).  Saving model ...


batch 19, loss: 2.8046, instance_loss: 1.0723, weighted_loss: 2.2849, label: 0, bag_size: 4605
batch 39, loss: 0.8812, instance_loss: 0.5499, weighted_loss: 0.7818, label: 1, bag_size: 4438
batch 59, loss: 1.1315, instance_loss: 0.5890, weighted_loss: 0.9687, label: 1, bag_size: 628
batch 79, loss: 0.3632, instance_loss: 0.5101, weighted_loss: 0.4073, label: 0, bag_size: 1655
batch 99, loss: 0.2639, instance_loss: 0.5361, weighted_loss: 0.3456, label: 2, bag_size: 5138
batch 119, loss: 0.3275, instance_loss: 0.7097, weighted_loss: 0.4422, label: 0, bag_size: 4458
batch 139, loss: 0.1552, instance_loss: 0.3934, weighted_loss: 0.2267, label: 0, bag_size: 5003
batch 159, loss: 0.1976, instance_loss: 0.2959, weighted_loss: 0.2271, label: 0, bag_size: 3443
batch 179, loss: 1.1789, instance_loss: 0.8348, weighted_loss: 1.0757, label: 2, bag_size: 1222
batch 199, loss: 1.7221, instance_loss: 0.9591, weighted_loss: 1.4932, label: 1, bag_size: 3265
batch 219, loss: 1.0773, instance_loss: 0.5518, weighted_loss: 0.9196, label: 0, bag_size: 7056
batch 239, loss: 1.1289, instance_loss: 0.7393, weighted_loss: 1.0120, label: 1, bag_size: 210
batch 259, loss: 0.2704, instance_loss: 0.3628, weighted_loss: 0.2981, label: 0, bag_size: 5108
batch 279, loss: 1.2767, instance_loss: 0.4693, weighted_loss: 1.0345, label: 0, bag_size: 4220
batch 299, loss: 0.4252, instance_loss: 0.4166, weighted_loss: 0.4227, label: 0, bag_size: 3915
batch 319, loss: 0.1349, instance_loss: 0.6961, weighted_loss: 0.3032, label: 2, bag_size: 4140
batch 339, loss: 0.0167, instance_loss: 0.2865, weighted_loss: 0.0977, label: 2, bag_size: 4088
batch 359, loss: 0.5586, instance_loss: 0.4887, weighted_loss: 0.5376, label: 1, bag_size: 4960
batch 379, loss: 0.2155, instance_loss: 0.3301, weighted_loss: 0.2499, label: 2, bag_size: 2254
batch 399, loss: 1.4612, instance_loss: 0.9934, weighted_loss: 1.3208, label: 1, bag_size: 4290
batch 419, loss: 0.5073, instance_loss: 0.5845, weighted_loss: 0.5305, label: 0, bag_size: 3367
batch 439, loss: 2.8703, instance_loss: 0.8508, weighted_loss: 2.2645, label: 2, bag_size: 552
batch 459, loss: 0.6208, instance_loss: 0.7210, weighted_loss: 0.6508, label: 1, bag_size: 3184
batch 479, loss: 1.5216, instance_loss: 0.7766, weighted_loss: 1.2981, label: 2, bag_size: 5307
batch 499, loss: 0.4786, instance_loss: 0.5065, weighted_loss: 0.4870, label: 0, bag_size: 4165
batch 519, loss: 0.5355, instance_loss: 0.5903, weighted_loss: 0.5519, label: 1, bag_size: 3604
batch 539, loss: 0.6296, instance_loss: 0.6499, weighted_loss: 0.6357, label: 0, bag_size: 5226
batch 559, loss: 0.7170, instance_loss: 0.4904, weighted_loss: 0.6491, label: 1, bag_size: 3471
batch 579, loss: 0.7197, instance_loss: 0.6033, weighted_loss: 0.6848, label: 2, bag_size: 4096
batch 599, loss: 0.6100, instance_loss: 0.5667, weighted_loss: 0.5970, label: 0, bag_size: 4146
batch 619, loss: 0.6922, instance_loss: 0.6651, weighted_loss: 0.6841, label: 0, bag_size: 3886
batch 639, loss: 0.9640, instance_loss: 0.8289, weighted_loss: 0.9235, label: 0, bag_size: 2392
batch 659, loss: 0.7473, instance_loss: 0.5368, weighted_loss: 0.6841, label: 2, bag_size: 2326
batch 679, loss: 1.1055, instance_loss: 0.6324, weighted_loss: 0.9636, label: 2, bag_size: 597
batch 699, loss: 0.8806, instance_loss: 0.6203, weighted_loss: 0.8025, label: 0, bag_size: 4909
batch 719, loss: 0.6373, instance_loss: 0.5264, weighted_loss: 0.6041, label: 1, bag_size: 2744
batch 739, loss: 0.9940, instance_loss: 0.7780, weighted_loss: 0.9292, label: 1, bag_size: 6717


class 0 clustering acc 0.9901565995525727: correct 17704/17880
class 1 clustering acc 0.07281879194630872: correct 434/5960
Epoch: 3, train_loss: 0.8369, train_clustering_loss:  0.6531, train_error: 0.3651
class 0: acc 0.6506024096385542, correct 162/249
class 1: acc 0.5368852459016393, correct 131/244
class 2: acc 0.7142857142857143, correct 180/252

Val Set, val_loss: 0.7267, val_error: 0.2872, auc: 0.8688
class 0 clustering acc 0.9902482269503546: correct 2234/2256
class 1 clustering acc 0.034574468085106384: correct 26/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.866837 --> 0.726724).  Saving model ...


batch 19, loss: 0.2823, instance_loss: 0.4600, weighted_loss: 0.3356, label: 0, bag_size: 4570
batch 39, loss: 0.6007, instance_loss: 0.5795, weighted_loss: 0.5944, label: 1, bag_size: 5276
batch 59, loss: 0.2547, instance_loss: 0.4974, weighted_loss: 0.3275, label: 2, bag_size: 4291
batch 79, loss: 0.7065, instance_loss: 0.7648, weighted_loss: 0.7240, label: 0, bag_size: 1744
batch 99, loss: 0.6890, instance_loss: 0.5793, weighted_loss: 0.6561, label: 2, bag_size: 5307
batch 119, loss: 0.2736, instance_loss: 0.5721, weighted_loss: 0.3632, label: 2, bag_size: 2049
batch 139, loss: 0.3199, instance_loss: 0.3588, weighted_loss: 0.3316, label: 2, bag_size: 4043
batch 159, loss: 1.3885, instance_loss: 0.8336, weighted_loss: 1.2221, label: 1, bag_size: 832
batch 179, loss: 0.4216, instance_loss: 0.5965, weighted_loss: 0.4741, label: 0, bag_size: 1825
batch 199, loss: 0.1295, instance_loss: 0.2687, weighted_loss: 0.1713, label: 0, bag_size: 2601
batch 219, loss: 0.1782, instance_loss: 0.3678, weighted_loss: 0.2351, label: 2, bag_size: 5924
batch 239, loss: 0.1171, instance_loss: 0.2385, weighted_loss: 0.1535, label: 2, bag_size: 2481
batch 259, loss: 0.1580, instance_loss: 0.4365, weighted_loss: 0.2415, label: 0, bag_size: 2884
batch 279, loss: 0.2199, instance_loss: 0.3427, weighted_loss: 0.2567, label: 0, bag_size: 1485
batch 299, loss: 2.1042, instance_loss: 0.6236, weighted_loss: 1.6600, label: 0, bag_size: 20234
batch 319, loss: 0.6334, instance_loss: 0.7462, weighted_loss: 0.6672, label: 1, bag_size: 6156
batch 339, loss: 0.3273, instance_loss: 0.4142, weighted_loss: 0.3534, label: 0, bag_size: 7169
batch 359, loss: 0.4304, instance_loss: 0.4514, weighted_loss: 0.4367, label: 0, bag_size: 2767
batch 379, loss: 2.1300, instance_loss: 1.2118, weighted_loss: 1.8545, label: 1, bag_size: 3995
batch 399, loss: 1.1054, instance_loss: 0.7763, weighted_loss: 1.0066, label: 2, bag_size: 724
batch 419, loss: 0.4153, instance_loss: 0.5453, weighted_loss: 0.4543, label: 0, bag_size: 829
batch 439, loss: 1.1725, instance_loss: 0.6346, weighted_loss: 1.0111, label: 2, bag_size: 3026
batch 459, loss: 0.3822, instance_loss: 0.3603, weighted_loss: 0.3756, label: 2, bag_size: 705
batch 479, loss: 0.2618, instance_loss: 0.4781, weighted_loss: 0.3267, label: 1, bag_size: 5364
batch 499, loss: 1.2385, instance_loss: 0.9877, weighted_loss: 1.1632, label: 1, bag_size: 936
batch 519, loss: 1.0423, instance_loss: 0.9076, weighted_loss: 1.0019, label: 1, bag_size: 4824
batch 539, loss: 0.2522, instance_loss: 0.4403, weighted_loss: 0.3087, label: 0, bag_size: 4325
batch 559, loss: 0.3569, instance_loss: 0.3047, weighted_loss: 0.3412, label: 1, bag_size: 3051
batch 579, loss: 0.0517, instance_loss: 0.1216, weighted_loss: 0.0727, label: 1, bag_size: 3677
batch 599, loss: 0.1743, instance_loss: 0.1944, weighted_loss: 0.1803, label: 1, bag_size: 4595
batch 619, loss: 1.5861, instance_loss: 0.9874, weighted_loss: 1.4065, label: 0, bag_size: 1795
batch 639, loss: 0.1784, instance_loss: 0.4836, weighted_loss: 0.2700, label: 0, bag_size: 3319
batch 659, loss: 2.6873, instance_loss: 1.1766, weighted_loss: 2.2340, label: 0, bag_size: 18038
batch 679, loss: 0.2149, instance_loss: 0.3960, weighted_loss: 0.2693, label: 0, bag_size: 6015
batch 699, loss: 0.9227, instance_loss: 0.8614, weighted_loss: 0.9043, label: 1, bag_size: 3619
batch 719, loss: 0.2403, instance_loss: 0.5073, weighted_loss: 0.3204, label: 0, bag_size: 4070
batch 739, loss: 1.4353, instance_loss: 0.9110, weighted_loss: 1.2780, label: 2, bag_size: 5426


class 0 clustering acc 0.9855145413870247: correct 17621/17880
class 1 clustering acc 0.1412751677852349: correct 842/5960
Epoch: 4, train_loss: 0.7549, train_clustering_loss:  0.6215, train_error: 0.3181
class 0: acc 0.7748091603053435, correct 203/262
class 1: acc 0.48444444444444446, correct 109/225
class 2: acc 0.7596899224806202, correct 196/258

Val Set, val_loss: 0.6771, val_error: 0.2979, auc: 0.8682
class 0 clustering acc 0.9835992907801419: correct 2219/2256
class 1 clustering acc 0.08643617021276596: correct 65/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.726724 --> 0.677131).  Saving model ...


batch 19, loss: 0.9988, instance_loss: 0.6823, weighted_loss: 0.9039, label: 0, bag_size: 4531
batch 39, loss: 1.0880, instance_loss: 0.8079, weighted_loss: 1.0040, label: 1, bag_size: 3322
batch 59, loss: 0.0318, instance_loss: 0.1991, weighted_loss: 0.0820, label: 2, bag_size: 4203
batch 79, loss: 1.4916, instance_loss: 0.9257, weighted_loss: 1.3218, label: 1, bag_size: 7176
batch 99, loss: 0.1885, instance_loss: 0.2955, weighted_loss: 0.2206, label: 2, bag_size: 2209
batch 119, loss: 0.3572, instance_loss: 0.6043, weighted_loss: 0.4313, label: 0, bag_size: 3690
batch 139, loss: 1.2524, instance_loss: 0.9067, weighted_loss: 1.1487, label: 1, bag_size: 782
batch 159, loss: 1.8390, instance_loss: 1.0860, weighted_loss: 1.6131, label: 2, bag_size: 1050
batch 179, loss: 0.4651, instance_loss: 0.4712, weighted_loss: 0.4669, label: 0, bag_size: 3382
batch 199, loss: 0.3549, instance_loss: 0.6697, weighted_loss: 0.4493, label: 2, bag_size: 3618
batch 219, loss: 0.0657, instance_loss: 0.1570, weighted_loss: 0.0931, label: 2, bag_size: 2422
batch 239, loss: 1.0349, instance_loss: 0.6731, weighted_loss: 0.9263, label: 1, bag_size: 683
batch 259, loss: 0.4236, instance_loss: 0.4589, weighted_loss: 0.4342, label: 1, bag_size: 3357
batch 279, loss: 0.1821, instance_loss: 0.6439, weighted_loss: 0.3206, label: 2, bag_size: 5037
batch 299, loss: 0.4745, instance_loss: 0.5757, weighted_loss: 0.5048, label: 0, bag_size: 6971
batch 319, loss: 0.4733, instance_loss: 0.6205, weighted_loss: 0.5175, label: 0, bag_size: 1006
batch 339, loss: 1.6561, instance_loss: 0.6059, weighted_loss: 1.3411, label: 0, bag_size: 19216
batch 359, loss: 0.9453, instance_loss: 0.6178, weighted_loss: 0.8470, label: 1, bag_size: 3184
batch 379, loss: 0.2084, instance_loss: 0.4288, weighted_loss: 0.2745, label: 2, bag_size: 3396
batch 399, loss: 2.1473, instance_loss: 1.6105, weighted_loss: 1.9863, label: 1, bag_size: 1604
batch 419, loss: 0.0465, instance_loss: 0.5073, weighted_loss: 0.1847, label: 1, bag_size: 5760
batch 439, loss: 0.4188, instance_loss: 0.3737, weighted_loss: 0.4053, label: 2, bag_size: 4241
batch 459, loss: 2.5701, instance_loss: 0.9043, weighted_loss: 2.0704, label: 2, bag_size: 3274
batch 479, loss: 0.3780, instance_loss: 0.5300, weighted_loss: 0.4236, label: 0, bag_size: 1194
batch 499, loss: 0.9356, instance_loss: 0.7071, weighted_loss: 0.8671, label: 2, bag_size: 1222
batch 519, loss: 0.6400, instance_loss: 0.6369, weighted_loss: 0.6391, label: 2, bag_size: 6594
batch 539, loss: 0.3085, instance_loss: 0.5036, weighted_loss: 0.3671, label: 0, bag_size: 2884
batch 559, loss: 1.9945, instance_loss: 0.9635, weighted_loss: 1.6852, label: 2, bag_size: 552
batch 579, loss: 1.5052, instance_loss: 1.3245, weighted_loss: 1.4510, label: 0, bag_size: 1601
batch 599, loss: 1.2024, instance_loss: 1.0097, weighted_loss: 1.1446, label: 0, bag_size: 4865
batch 619, loss: 1.0056, instance_loss: 0.7413, weighted_loss: 0.9263, label: 1, bag_size: 3821
batch 639, loss: 0.0332, instance_loss: 0.2632, weighted_loss: 0.1022, label: 1, bag_size: 3172
batch 659, loss: 0.3467, instance_loss: 0.2990, weighted_loss: 0.3324, label: 1, bag_size: 2945
batch 679, loss: 0.7773, instance_loss: 0.6880, weighted_loss: 0.7505, label: 1, bag_size: 3391
batch 699, loss: 0.3043, instance_loss: 0.4491, weighted_loss: 0.3477, label: 2, bag_size: 4302
batch 719, loss: 0.0876, instance_loss: 0.2013, weighted_loss: 0.1217, label: 1, bag_size: 5364
batch 739, loss: 0.2283, instance_loss: 0.5793, weighted_loss: 0.3336, label: 2, bag_size: 3810


class 0 clustering acc 0.9849552572706936: correct 17611/17880
class 1 clustering acc 0.13926174496644295: correct 830/5960
Epoch: 5, train_loss: 0.7712, train_clustering_loss:  0.6260, train_error: 0.3369
class 0: acc 0.6497695852534562, correct 141/217
class 1: acc 0.5842696629213483, correct 156/267
class 2: acc 0.7547892720306514, correct 197/261

Val Set, val_loss: 0.7911, val_error: 0.3936, auc: 0.8257
class 0 clustering acc 0.9778368794326241: correct 2206/2256
class 1 clustering acc 0.07712765957446809: correct 58/752
class 0: acc 0.4230769230769231, correct 22/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.1773, instance_loss: 0.9657, weighted_loss: 1.8138, label: 0, bag_size: 4572
batch 39, loss: 0.4525, instance_loss: 0.6905, weighted_loss: 0.5239, label: 2, bag_size: 4569
batch 59, loss: 1.0648, instance_loss: 0.8970, weighted_loss: 1.0145, label: 2, bag_size: 1222
batch 79, loss: 0.7529, instance_loss: 0.6068, weighted_loss: 0.7091, label: 0, bag_size: 3367
batch 99, loss: 0.3042, instance_loss: 0.4892, weighted_loss: 0.3597, label: 0, bag_size: 3649
batch 119, loss: 1.0964, instance_loss: 0.6402, weighted_loss: 0.9595, label: 1, bag_size: 2122
batch 139, loss: 0.6385, instance_loss: 0.3501, weighted_loss: 0.5519, label: 2, bag_size: 1094
batch 159, loss: 0.5310, instance_loss: 0.6709, weighted_loss: 0.5730, label: 0, bag_size: 3820
batch 179, loss: 0.9184, instance_loss: 0.7683, weighted_loss: 0.8734, label: 1, bag_size: 3644
batch 199, loss: 1.2593, instance_loss: 0.8528, weighted_loss: 1.1373, label: 2, bag_size: 4179
batch 219, loss: 0.7811, instance_loss: 0.5538, weighted_loss: 0.7129, label: 1, bag_size: 5340
batch 239, loss: 0.2961, instance_loss: 0.4240, weighted_loss: 0.3345, label: 2, bag_size: 4978
batch 259, loss: 0.2940, instance_loss: 0.8597, weighted_loss: 0.4637, label: 0, bag_size: 1140
batch 279, loss: 0.3896, instance_loss: 0.4213, weighted_loss: 0.3991, label: 1, bag_size: 2744
batch 299, loss: 0.0671, instance_loss: 0.1888, weighted_loss: 0.1036, label: 2, bag_size: 4910
batch 319, loss: 0.2616, instance_loss: 0.3635, weighted_loss: 0.2922, label: 2, bag_size: 3094
batch 339, loss: 0.6466, instance_loss: 0.5237, weighted_loss: 0.6097, label: 1, bag_size: 5340
batch 359, loss: 0.1641, instance_loss: 0.4000, weighted_loss: 0.2349, label: 2, bag_size: 4535
batch 379, loss: 0.7985, instance_loss: 0.7455, weighted_loss: 0.7826, label: 2, bag_size: 3172
batch 399, loss: 1.1507, instance_loss: 0.7774, weighted_loss: 1.0387, label: 1, bag_size: 1307
batch 419, loss: 0.0783, instance_loss: 0.3289, weighted_loss: 0.1535, label: 1, bag_size: 6243
batch 439, loss: 0.5129, instance_loss: 0.5621, weighted_loss: 0.5276, label: 1, bag_size: 2919
batch 459, loss: 0.0603, instance_loss: 0.2105, weighted_loss: 0.1054, label: 2, bag_size: 3176
batch 479, loss: 0.1376, instance_loss: 0.5392, weighted_loss: 0.2580, label: 0, bag_size: 4841
batch 499, loss: 0.3502, instance_loss: 0.5631, weighted_loss: 0.4141, label: 0, bag_size: 4071
batch 519, loss: 0.0826, instance_loss: 0.0670, weighted_loss: 0.0779, label: 2, bag_size: 1094
batch 539, loss: 1.4813, instance_loss: 0.8101, weighted_loss: 1.2799, label: 1, bag_size: 3837
batch 559, loss: 1.0913, instance_loss: 0.9225, weighted_loss: 1.0407, label: 0, bag_size: 1352
batch 579, loss: 0.1910, instance_loss: 0.4586, weighted_loss: 0.2713, label: 2, bag_size: 4372
batch 599, loss: 0.6327, instance_loss: 0.6141, weighted_loss: 0.6271, label: 0, bag_size: 4711
batch 619, loss: 0.0079, instance_loss: 0.2308, weighted_loss: 0.0748, label: 2, bag_size: 2422
batch 639, loss: 0.8498, instance_loss: 0.6844, weighted_loss: 0.8002, label: 0, bag_size: 5526
batch 659, loss: 1.1387, instance_loss: 0.8762, weighted_loss: 1.0599, label: 0, bag_size: 3310
batch 679, loss: 1.8962, instance_loss: 0.4319, weighted_loss: 1.4569, label: 1, bag_size: 6277
batch 699, loss: 1.4583, instance_loss: 0.6706, weighted_loss: 1.2220, label: 1, bag_size: 3296
batch 719, loss: 0.2890, instance_loss: 0.3922, weighted_loss: 0.3199, label: 1, bag_size: 10399
batch 739, loss: 2.3596, instance_loss: 0.9450, weighted_loss: 1.9353, label: 1, bag_size: 5035


class 0 clustering acc 0.985178970917226: correct 17615/17880
class 1 clustering acc 0.17718120805369128: correct 1056/5960
Epoch: 6, train_loss: 0.7377, train_clustering_loss:  0.6107, train_error: 0.3221
class 0: acc 0.7257383966244726, correct 172/237
class 1: acc 0.5703125, correct 146/256
class 2: acc 0.7420634920634921, correct 187/252

Val Set, val_loss: 0.6894, val_error: 0.3298, auc: 0.8496
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.10106382978723404: correct 76/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4427, instance_loss: 0.5509, weighted_loss: 0.4751, label: 0, bag_size: 4242
batch 39, loss: 0.1176, instance_loss: 0.3602, weighted_loss: 0.1904, label: 2, bag_size: 6148
batch 59, loss: 0.0491, instance_loss: 0.4519, weighted_loss: 0.1699, label: 0, bag_size: 1981
batch 79, loss: 0.8023, instance_loss: 0.6935, weighted_loss: 0.7697, label: 1, bag_size: 11768
batch 99, loss: 0.1178, instance_loss: 0.3272, weighted_loss: 0.1806, label: 2, bag_size: 6273
batch 119, loss: 1.2350, instance_loss: 0.7575, weighted_loss: 1.0917, label: 2, bag_size: 2486
batch 139, loss: 0.4889, instance_loss: 0.5239, weighted_loss: 0.4994, label: 2, bag_size: 4569
batch 159, loss: 0.5533, instance_loss: 0.4962, weighted_loss: 0.5362, label: 1, bag_size: 3106
batch 179, loss: 1.0246, instance_loss: 0.5113, weighted_loss: 0.8706, label: 2, bag_size: 5307
batch 199, loss: 1.2621, instance_loss: 0.8644, weighted_loss: 1.1428, label: 1, bag_size: 1066
batch 219, loss: 0.2126, instance_loss: 0.3254, weighted_loss: 0.2465, label: 2, bag_size: 2770
batch 239, loss: 0.2940, instance_loss: 0.3127, weighted_loss: 0.2997, label: 2, bag_size: 4043
batch 259, loss: 1.3917, instance_loss: 0.7117, weighted_loss: 1.1877, label: 0, bag_size: 5867
batch 279, loss: 0.2699, instance_loss: 0.5603, weighted_loss: 0.3570, label: 0, bag_size: 3727
batch 299, loss: 0.3060, instance_loss: 0.3524, weighted_loss: 0.3199, label: 2, bag_size: 6273
batch 319, loss: 0.3233, instance_loss: 0.4705, weighted_loss: 0.3674, label: 2, bag_size: 5406
batch 339, loss: 0.8106, instance_loss: 0.8724, weighted_loss: 0.8291, label: 2, bag_size: 4241
batch 359, loss: 1.2875, instance_loss: 1.0111, weighted_loss: 1.2046, label: 1, bag_size: 5276
batch 379, loss: 0.1208, instance_loss: 0.5351, weighted_loss: 0.2451, label: 0, bag_size: 2231
batch 399, loss: 0.5766, instance_loss: 0.5998, weighted_loss: 0.5835, label: 1, bag_size: 1066
batch 419, loss: 0.5708, instance_loss: 0.5300, weighted_loss: 0.5586, label: 0, bag_size: 3915
batch 439, loss: 0.8881, instance_loss: 0.7748, weighted_loss: 0.8541, label: 1, bag_size: 5873
batch 459, loss: 0.1561, instance_loss: 0.4622, weighted_loss: 0.2479, label: 1, bag_size: 4067
batch 479, loss: 1.7277, instance_loss: 0.9039, weighted_loss: 1.4805, label: 1, bag_size: 4694
batch 499, loss: 1.3783, instance_loss: 0.6969, weighted_loss: 1.1739, label: 1, bag_size: 628
batch 519, loss: 0.3281, instance_loss: 0.5477, weighted_loss: 0.3940, label: 0, bag_size: 4122
batch 539, loss: 0.2270, instance_loss: 0.3437, weighted_loss: 0.2620, label: 2, bag_size: 2997
batch 559, loss: 0.0863, instance_loss: 0.2711, weighted_loss: 0.1418, label: 0, bag_size: 6797
batch 579, loss: 0.0905, instance_loss: 0.2364, weighted_loss: 0.1342, label: 2, bag_size: 6273
batch 599, loss: 0.7798, instance_loss: 0.4571, weighted_loss: 0.6830, label: 1, bag_size: 10399
batch 619, loss: 0.3421, instance_loss: 0.5124, weighted_loss: 0.3932, label: 0, bag_size: 3539
batch 639, loss: 0.1532, instance_loss: 0.2847, weighted_loss: 0.1927, label: 2, bag_size: 2481
batch 659, loss: 0.2355, instance_loss: 0.5014, weighted_loss: 0.3153, label: 0, bag_size: 4070
batch 679, loss: 3.3767, instance_loss: 1.0303, weighted_loss: 2.6727, label: 1, bag_size: 1558
batch 699, loss: 1.1365, instance_loss: 0.9024, weighted_loss: 1.0663, label: 0, bag_size: 2501
batch 719, loss: 0.6932, instance_loss: 0.6864, weighted_loss: 0.6912, label: 0, bag_size: 3666
batch 739, loss: 0.2324, instance_loss: 0.3473, weighted_loss: 0.2669, label: 0, bag_size: 5782


class 0 clustering acc 0.9817114093959731: correct 17553/17880
class 1 clustering acc 0.16476510067114095: correct 982/5960
Epoch: 7, train_loss: 0.7804, train_clustering_loss:  0.6327, train_error: 0.3342
class 0: acc 0.670995670995671, correct 155/231
class 1: acc 0.563265306122449, correct 138/245
class 2: acc 0.7546468401486989, correct 203/269

Val Set, val_loss: 0.6020, val_error: 0.2660, auc: 0.9079
class 0 clustering acc 0.9955673758865248: correct 2246/2256
class 1 clustering acc 0.05186170212765957: correct 39/752
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.677131 --> 0.601988).  Saving model ...


batch 19, loss: 0.3240, instance_loss: 0.4598, weighted_loss: 0.3647, label: 2, bag_size: 5426
batch 39, loss: 1.0330, instance_loss: 0.6771, weighted_loss: 0.9263, label: 0, bag_size: 3367
batch 59, loss: 0.5102, instance_loss: 0.6224, weighted_loss: 0.5439, label: 2, bag_size: 3396
batch 79, loss: 0.8164, instance_loss: 0.6889, weighted_loss: 0.7782, label: 1, bag_size: 6717
batch 99, loss: 0.1900, instance_loss: 0.2362, weighted_loss: 0.2039, label: 0, bag_size: 4865
batch 119, loss: 0.2033, instance_loss: 0.5535, weighted_loss: 0.3084, label: 1, bag_size: 3333
batch 139, loss: 0.4782, instance_loss: 0.6408, weighted_loss: 0.5270, label: 2, bag_size: 4043
batch 159, loss: 0.8230, instance_loss: 0.6795, weighted_loss: 0.7800, label: 2, bag_size: 5743
batch 179, loss: 1.0033, instance_loss: 0.7413, weighted_loss: 0.9247, label: 2, bag_size: 5426
batch 199, loss: 0.1565, instance_loss: 0.3946, weighted_loss: 0.2279, label: 0, bag_size: 2791
batch 219, loss: 0.3498, instance_loss: 0.5152, weighted_loss: 0.3994, label: 2, bag_size: 6704
batch 239, loss: 0.8926, instance_loss: 0.6798, weighted_loss: 0.8288, label: 1, bag_size: 1510
batch 259, loss: 0.0709, instance_loss: 0.4629, weighted_loss: 0.1885, label: 2, bag_size: 6148
batch 279, loss: 0.6961, instance_loss: 0.6997, weighted_loss: 0.6972, label: 0, bag_size: 1562
batch 299, loss: 1.9654, instance_loss: 1.1525, weighted_loss: 1.7215, label: 1, bag_size: 3399
batch 319, loss: 0.3547, instance_loss: 0.3255, weighted_loss: 0.3460, label: 1, bag_size: 3746
batch 339, loss: 0.5287, instance_loss: 0.6888, weighted_loss: 0.5768, label: 0, bag_size: 2841
batch 359, loss: 0.3691, instance_loss: 0.3069, weighted_loss: 0.3505, label: 1, bag_size: 6475
batch 379, loss: 0.6879, instance_loss: 0.7499, weighted_loss: 0.7065, label: 0, bag_size: 4794
batch 399, loss: 0.5403, instance_loss: 0.5696, weighted_loss: 0.5491, label: 2, bag_size: 4569
batch 419, loss: 1.9448, instance_loss: 0.8500, weighted_loss: 1.6164, label: 2, bag_size: 3274
batch 439, loss: 0.9605, instance_loss: 0.7723, weighted_loss: 0.9040, label: 2, bag_size: 4291
batch 459, loss: 1.8835, instance_loss: 0.9465, weighted_loss: 1.6024, label: 2, bag_size: 7607
batch 479, loss: 0.8052, instance_loss: 0.8332, weighted_loss: 0.8136, label: 0, bag_size: 3743
batch 499, loss: 0.3757, instance_loss: 0.5149, weighted_loss: 0.4174, label: 0, bag_size: 4416
batch 519, loss: 0.2006, instance_loss: 0.3288, weighted_loss: 0.2391, label: 0, bag_size: 4547
batch 539, loss: 0.1252, instance_loss: 0.3976, weighted_loss: 0.2069, label: 0, bag_size: 2069
batch 559, loss: 0.1482, instance_loss: 0.5572, weighted_loss: 0.2709, label: 0, bag_size: 4734
batch 579, loss: 1.8341, instance_loss: 1.0618, weighted_loss: 1.6024, label: 0, bag_size: 3750
batch 599, loss: 0.5839, instance_loss: 0.8737, weighted_loss: 0.6708, label: 2, bag_size: 3607
batch 619, loss: 0.3521, instance_loss: 0.4668, weighted_loss: 0.3865, label: 0, bag_size: 5459
batch 639, loss: 0.9196, instance_loss: 0.5458, weighted_loss: 0.8075, label: 0, bag_size: 4018
batch 659, loss: 0.4689, instance_loss: 0.5484, weighted_loss: 0.4928, label: 1, bag_size: 3009
batch 679, loss: 0.5088, instance_loss: 0.3596, weighted_loss: 0.4640, label: 2, bag_size: 4043
batch 699, loss: 0.8537, instance_loss: 0.5481, weighted_loss: 0.7621, label: 2, bag_size: 3546
batch 719, loss: 0.6627, instance_loss: 1.0049, weighted_loss: 0.7653, label: 2, bag_size: 4241
batch 739, loss: 1.2344, instance_loss: 1.1662, weighted_loss: 1.2139, label: 2, bag_size: 4241


class 0 clustering acc 0.9808724832214765: correct 17538/17880
class 1 clustering acc 0.16174496644295303: correct 964/5960
Epoch: 8, train_loss: 0.7050, train_clustering_loss:  0.6217, train_error: 0.2993
class 0: acc 0.7764705882352941, correct 198/255
class 1: acc 0.6186770428015564, correct 159/257
class 2: acc 0.7081545064377682, correct 165/233

Val Set, val_loss: 0.6425, val_error: 0.3085, auc: 0.8784
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.21941489361702127: correct 165/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3178, instance_loss: 0.9428, weighted_loss: 0.5053, label: 1, bag_size: 6513
batch 39, loss: 0.0892, instance_loss: 0.2348, weighted_loss: 0.1329, label: 0, bag_size: 4994
batch 59, loss: 2.7700, instance_loss: 1.1123, weighted_loss: 2.2727, label: 1, bag_size: 12936
batch 79, loss: 2.2912, instance_loss: 1.3318, weighted_loss: 2.0034, label: 0, bag_size: 5840
batch 99, loss: 0.2713, instance_loss: 0.2828, weighted_loss: 0.2747, label: 0, bag_size: 3304
batch 119, loss: 0.2491, instance_loss: 0.5410, weighted_loss: 0.3367, label: 1, bag_size: 2753
batch 139, loss: 0.7597, instance_loss: 0.5683, weighted_loss: 0.7023, label: 2, bag_size: 4241
batch 159, loss: 1.3254, instance_loss: 0.8669, weighted_loss: 1.1878, label: 0, bag_size: 622
batch 179, loss: 0.2678, instance_loss: 0.4204, weighted_loss: 0.3136, label: 2, bag_size: 3174
batch 199, loss: 0.9012, instance_loss: 0.6940, weighted_loss: 0.8390, label: 1, bag_size: 10399
batch 219, loss: 0.2718, instance_loss: 0.4917, weighted_loss: 0.3378, label: 0, bag_size: 1018
batch 239, loss: 0.0890, instance_loss: 0.2489, weighted_loss: 0.1370, label: 0, bag_size: 2873
batch 259, loss: 0.0610, instance_loss: 0.1308, weighted_loss: 0.0819, label: 2, bag_size: 2997
batch 279, loss: 0.3575, instance_loss: 0.7876, weighted_loss: 0.4865, label: 2, bag_size: 3299
batch 299, loss: 0.6941, instance_loss: 0.9022, weighted_loss: 0.7565, label: 2, bag_size: 4192
batch 319, loss: 0.1876, instance_loss: 0.3993, weighted_loss: 0.2511, label: 0, bag_size: 5459
batch 339, loss: 1.5395, instance_loss: 1.0249, weighted_loss: 1.3852, label: 1, bag_size: 667
batch 359, loss: 1.5393, instance_loss: 1.3013, weighted_loss: 1.4679, label: 1, bag_size: 5205
batch 379, loss: 0.3643, instance_loss: 0.4947, weighted_loss: 0.4034, label: 2, bag_size: 4140
batch 399, loss: 1.5812, instance_loss: 1.5007, weighted_loss: 1.5571, label: 2, bag_size: 4241
batch 419, loss: 0.4097, instance_loss: 0.4839, weighted_loss: 0.4319, label: 0, bag_size: 16741
batch 439, loss: 0.3963, instance_loss: 0.5001, weighted_loss: 0.4274, label: 2, bag_size: 3778
batch 459, loss: 0.6741, instance_loss: 0.5737, weighted_loss: 0.6440, label: 0, bag_size: 3648
batch 479, loss: 0.0650, instance_loss: 0.2646, weighted_loss: 0.1249, label: 0, bag_size: 3406
batch 499, loss: 0.5121, instance_loss: 0.7121, weighted_loss: 0.5721, label: 1, bag_size: 3475
batch 519, loss: 0.3819, instance_loss: 0.5184, weighted_loss: 0.4228, label: 2, bag_size: 4140
batch 539, loss: 0.0176, instance_loss: 0.0941, weighted_loss: 0.0406, label: 2, bag_size: 4088
batch 559, loss: 0.2240, instance_loss: 0.5289, weighted_loss: 0.3155, label: 1, bag_size: 2731
batch 579, loss: 0.5348, instance_loss: 0.6273, weighted_loss: 0.5625, label: 1, bag_size: 3640
batch 599, loss: 0.4313, instance_loss: 0.6236, weighted_loss: 0.4890, label: 1, bag_size: 4644
batch 619, loss: 0.1927, instance_loss: 0.7810, weighted_loss: 0.3692, label: 0, bag_size: 4479
batch 639, loss: 1.4786, instance_loss: 1.1861, weighted_loss: 1.3908, label: 0, bag_size: 313
batch 659, loss: 2.9815, instance_loss: 1.2583, weighted_loss: 2.4646, label: 2, bag_size: 728
batch 679, loss: 1.8573, instance_loss: 1.0075, weighted_loss: 1.6024, label: 2, bag_size: 728
batch 699, loss: 1.0409, instance_loss: 1.2707, weighted_loss: 1.1099, label: 1, bag_size: 2229
batch 719, loss: 0.1826, instance_loss: 0.3531, weighted_loss: 0.2338, label: 0, bag_size: 3741
batch 739, loss: 0.2269, instance_loss: 0.3088, weighted_loss: 0.2515, label: 0, bag_size: 5006


class 0 clustering acc 0.9797539149888144: correct 17518/17880
class 1 clustering acc 0.19161073825503355: correct 1142/5960
Epoch: 9, train_loss: 0.7326, train_clustering_loss:  0.6172, train_error: 0.3141
class 0: acc 0.7250996015936255, correct 182/251
class 1: acc 0.5905511811023622, correct 150/254
class 2: acc 0.7458333333333333, correct 179/240

Val Set, val_loss: 0.6259, val_error: 0.2660, auc: 0.8786
class 0 clustering acc 0.9884751773049646: correct 2230/2256
class 1 clustering acc 0.22872340425531915: correct 172/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.9189, instance_loss: 1.1127, weighted_loss: 1.6771, label: 1, bag_size: 5880
batch 39, loss: 0.2584, instance_loss: 0.5231, weighted_loss: 0.3378, label: 0, bag_size: 6927
batch 59, loss: 0.9188, instance_loss: 0.7870, weighted_loss: 0.8793, label: 1, bag_size: 5003
batch 79, loss: 0.1056, instance_loss: 0.2221, weighted_loss: 0.1406, label: 2, bag_size: 2997
batch 99, loss: 0.6981, instance_loss: 0.6768, weighted_loss: 0.6917, label: 1, bag_size: 5728
batch 119, loss: 1.9439, instance_loss: 0.9688, weighted_loss: 1.6514, label: 0, bag_size: 3675
batch 139, loss: 0.7719, instance_loss: 0.6530, weighted_loss: 0.7362, label: 0, bag_size: 4351
batch 159, loss: 0.1039, instance_loss: 0.3083, weighted_loss: 0.1653, label: 0, bag_size: 3408
batch 179, loss: 0.2991, instance_loss: 0.3481, weighted_loss: 0.3138, label: 0, bag_size: 829
batch 199, loss: 1.5480, instance_loss: 0.6510, weighted_loss: 1.2789, label: 0, bag_size: 3675
batch 219, loss: 0.3687, instance_loss: 0.4415, weighted_loss: 0.3906, label: 0, bag_size: 3793
batch 239, loss: 1.9253, instance_loss: 0.9861, weighted_loss: 1.6436, label: 1, bag_size: 5880
batch 259, loss: 0.1543, instance_loss: 0.3082, weighted_loss: 0.2005, label: 0, bag_size: 3348
batch 279, loss: 0.3142, instance_loss: 0.5533, weighted_loss: 0.3859, label: 0, bag_size: 2884
batch 299, loss: 1.1250, instance_loss: 0.7732, weighted_loss: 1.0194, label: 1, bag_size: 4784
batch 319, loss: 0.3068, instance_loss: 0.3043, weighted_loss: 0.3061, label: 2, bag_size: 3327
batch 339, loss: 1.0673, instance_loss: 0.6282, weighted_loss: 0.9356, label: 2, bag_size: 705
batch 359, loss: 4.2652, instance_loss: 1.3041, weighted_loss: 3.3769, label: 0, bag_size: 4605
batch 379, loss: 1.0090, instance_loss: 0.3530, weighted_loss: 0.8122, label: 2, bag_size: 3210
batch 399, loss: 1.3739, instance_loss: 0.5385, weighted_loss: 1.1233, label: 2, bag_size: 5307
batch 419, loss: 0.3690, instance_loss: 0.3732, weighted_loss: 0.3703, label: 0, bag_size: 4827
batch 439, loss: 2.2944, instance_loss: 0.9032, weighted_loss: 1.8770, label: 2, bag_size: 223
batch 459, loss: 1.7192, instance_loss: 1.3325, weighted_loss: 1.6032, label: 2, bag_size: 4241
batch 479, loss: 0.0391, instance_loss: 0.1946, weighted_loss: 0.0857, label: 2, bag_size: 4088
batch 499, loss: 0.3469, instance_loss: 0.4244, weighted_loss: 0.3702, label: 2, bag_size: 3327
batch 519, loss: 0.1995, instance_loss: 0.4214, weighted_loss: 0.2661, label: 2, bag_size: 2313
batch 539, loss: 0.2113, instance_loss: 0.1381, weighted_loss: 0.1893, label: 2, bag_size: 4056
batch 559, loss: 0.4302, instance_loss: 0.6456, weighted_loss: 0.4948, label: 1, bag_size: 5412
batch 579, loss: 1.4344, instance_loss: 0.9875, weighted_loss: 1.3003, label: 0, bag_size: 4541
batch 599, loss: 0.4886, instance_loss: 0.4885, weighted_loss: 0.4886, label: 2, bag_size: 3172
batch 619, loss: 0.1820, instance_loss: 0.5667, weighted_loss: 0.2974, label: 2, bag_size: 6704
batch 639, loss: 0.0922, instance_loss: 0.4059, weighted_loss: 0.1863, label: 0, bag_size: 4570
batch 659, loss: 0.1888, instance_loss: 0.3073, weighted_loss: 0.2243, label: 0, bag_size: 5041
batch 679, loss: 0.4202, instance_loss: 0.5540, weighted_loss: 0.4603, label: 0, bag_size: 2884
batch 699, loss: 0.1126, instance_loss: 0.3294, weighted_loss: 0.1776, label: 1, bag_size: 6277
batch 719, loss: 0.1011, instance_loss: 0.2480, weighted_loss: 0.1452, label: 1, bag_size: 2796
batch 739, loss: 0.4639, instance_loss: 0.6868, weighted_loss: 0.5307, label: 0, bag_size: 1234


class 0 clustering acc 0.9824944071588367: correct 17567/17880
class 1 clustering acc 0.20067114093959731: correct 1196/5960
Epoch: 10, train_loss: 0.6999, train_clustering_loss:  0.6038, train_error: 0.2872
class 0: acc 0.782051282051282, correct 183/234
class 1: acc 0.6284584980237155, correct 159/253
class 2: acc 0.7325581395348837, correct 189/258

Val Set, val_loss: 0.6675, val_error: 0.3404, auc: 0.8683
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.26595744680851063: correct 200/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2437, instance_loss: 0.3871, weighted_loss: 0.2867, label: 1, bag_size: 3156
batch 39, loss: 2.0458, instance_loss: 1.3323, weighted_loss: 1.8317, label: 1, bag_size: 869
batch 59, loss: 0.0349, instance_loss: 0.4030, weighted_loss: 0.1453, label: 0, bag_size: 855
batch 79, loss: 2.4265, instance_loss: 1.0746, weighted_loss: 2.0210, label: 2, bag_size: 223
batch 99, loss: 0.1649, instance_loss: 0.4309, weighted_loss: 0.2447, label: 2, bag_size: 4192
batch 119, loss: 2.6943, instance_loss: 1.0236, weighted_loss: 2.1931, label: 0, bag_size: 35080
batch 139, loss: 1.5011, instance_loss: 0.8108, weighted_loss: 1.2940, label: 2, bag_size: 705
batch 159, loss: 1.0199, instance_loss: 0.8083, weighted_loss: 0.9564, label: 2, bag_size: 5406
batch 179, loss: 1.2778, instance_loss: 0.6822, weighted_loss: 1.0991, label: 0, bag_size: 15388
batch 199, loss: 1.2563, instance_loss: 0.8669, weighted_loss: 1.1395, label: 2, bag_size: 1222
batch 219, loss: 0.0989, instance_loss: 0.3133, weighted_loss: 0.1632, label: 2, bag_size: 3397
batch 239, loss: 1.5149, instance_loss: 0.9285, weighted_loss: 1.3390, label: 2, bag_size: 5406
batch 259, loss: 0.3663, instance_loss: 0.5192, weighted_loss: 0.4122, label: 0, bag_size: 5146
batch 279, loss: 0.8086, instance_loss: 0.8603, weighted_loss: 0.8241, label: 1, bag_size: 3986
batch 299, loss: 1.4009, instance_loss: 1.0231, weighted_loss: 1.2876, label: 2, bag_size: 2326
batch 319, loss: 0.5937, instance_loss: 0.6051, weighted_loss: 0.5971, label: 0, bag_size: 1762
batch 339, loss: 0.4753, instance_loss: 0.6390, weighted_loss: 0.5244, label: 2, bag_size: 4978
batch 359, loss: 0.3994, instance_loss: 0.4823, weighted_loss: 0.4243, label: 1, bag_size: 3009
batch 379, loss: 0.2482, instance_loss: 0.2951, weighted_loss: 0.2622, label: 1, bag_size: 4684
batch 399, loss: 1.6946, instance_loss: 0.8741, weighted_loss: 1.4484, label: 2, bag_size: 7607
batch 419, loss: 0.2761, instance_loss: 0.3820, weighted_loss: 0.3079, label: 2, bag_size: 4302
batch 439, loss: 0.1652, instance_loss: 0.3841, weighted_loss: 0.2309, label: 0, bag_size: 1170
batch 459, loss: 0.9858, instance_loss: 0.9043, weighted_loss: 0.9614, label: 2, bag_size: 2326
batch 479, loss: 0.5463, instance_loss: 0.4399, weighted_loss: 0.5144, label: 0, bag_size: 5373
batch 499, loss: 0.8950, instance_loss: 0.8340, weighted_loss: 0.8767, label: 1, bag_size: 1528
batch 519, loss: 0.7304, instance_loss: 0.5001, weighted_loss: 0.6613, label: 2, bag_size: 1103
batch 539, loss: 2.6216, instance_loss: 0.9488, weighted_loss: 2.1198, label: 0, bag_size: 2217
batch 559, loss: 1.4025, instance_loss: 0.8683, weighted_loss: 1.2422, label: 1, bag_size: 3475
batch 579, loss: 0.1593, instance_loss: 0.1791, weighted_loss: 0.1653, label: 2, bag_size: 2997
batch 599, loss: 1.3248, instance_loss: 1.2377, weighted_loss: 1.2986, label: 1, bag_size: 4258
batch 619, loss: 0.3791, instance_loss: 0.5343, weighted_loss: 0.4257, label: 1, bag_size: 368
batch 639, loss: 0.2857, instance_loss: 0.6418, weighted_loss: 0.3925, label: 1, bag_size: 5760
batch 659, loss: 0.1028, instance_loss: 0.3856, weighted_loss: 0.1876, label: 0, bag_size: 3437
batch 679, loss: 0.4798, instance_loss: 0.4401, weighted_loss: 0.4679, label: 0, bag_size: 23335
batch 699, loss: 1.6741, instance_loss: 1.1080, weighted_loss: 1.5043, label: 1, bag_size: 2831
batch 719, loss: 0.3265, instance_loss: 0.4138, weighted_loss: 0.3527, label: 0, bag_size: 3525
batch 739, loss: 0.1671, instance_loss: 0.3128, weighted_loss: 0.2108, label: 0, bag_size: 4604


class 0 clustering acc 0.9797539149888144: correct 17518/17880
class 1 clustering acc 0.23657718120805368: correct 1410/5960
Epoch: 11, train_loss: 0.7123, train_clustering_loss:  0.5995, train_error: 0.3154
class 0: acc 0.758364312267658, correct 204/269
class 1: acc 0.5416666666666666, correct 130/240
class 2: acc 0.7457627118644068, correct 176/236

Val Set, val_loss: 0.5544, val_error: 0.2660, auc: 0.9086
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.4029255319148936: correct 303/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.601988 --> 0.554405).  Saving model ...


batch 19, loss: 0.1653, instance_loss: 0.2662, weighted_loss: 0.1956, label: 1, bag_size: 10941
batch 39, loss: 1.3628, instance_loss: 0.9279, weighted_loss: 1.2323, label: 2, bag_size: 1050
batch 59, loss: 0.3071, instance_loss: 0.9275, weighted_loss: 0.4932, label: 1, bag_size: 3995
batch 79, loss: 0.0530, instance_loss: 0.2250, weighted_loss: 0.1046, label: 0, bag_size: 5413
batch 99, loss: 0.0426, instance_loss: 0.2977, weighted_loss: 0.1191, label: 0, bag_size: 966
batch 119, loss: 1.0389, instance_loss: 0.9458, weighted_loss: 1.0110, label: 1, bag_size: 3596
batch 139, loss: 0.7313, instance_loss: 0.7312, weighted_loss: 0.7313, label: 2, bag_size: 4179
batch 159, loss: 0.2847, instance_loss: 0.6992, weighted_loss: 0.4091, label: 2, bag_size: 3618
batch 179, loss: 0.3754, instance_loss: 0.4321, weighted_loss: 0.3924, label: 0, bag_size: 4201
batch 199, loss: 0.2219, instance_loss: 0.4818, weighted_loss: 0.2999, label: 1, bag_size: 425
batch 219, loss: 1.7831, instance_loss: 0.6277, weighted_loss: 1.4365, label: 2, bag_size: 705
batch 239, loss: 3.7345, instance_loss: 1.4467, weighted_loss: 3.0482, label: 0, bag_size: 1886
batch 259, loss: 0.6625, instance_loss: 0.4549, weighted_loss: 0.6002, label: 0, bag_size: 3789
batch 279, loss: 0.1644, instance_loss: 0.2687, weighted_loss: 0.1957, label: 1, bag_size: 209
batch 299, loss: 0.1321, instance_loss: 0.4704, weighted_loss: 0.2336, label: 0, bag_size: 4994
batch 319, loss: 0.0782, instance_loss: 0.4132, weighted_loss: 0.1787, label: 1, bag_size: 3337
batch 339, loss: 1.8115, instance_loss: 0.4167, weighted_loss: 1.3931, label: 2, bag_size: 2561
batch 359, loss: 1.0911, instance_loss: 0.5957, weighted_loss: 0.9425, label: 1, bag_size: 574
batch 379, loss: 0.5580, instance_loss: 0.5930, weighted_loss: 0.5685, label: 1, bag_size: 3640
batch 399, loss: 0.3196, instance_loss: 0.3399, weighted_loss: 0.3257, label: 1, bag_size: 6475
batch 419, loss: 0.4219, instance_loss: 0.3123, weighted_loss: 0.3890, label: 2, bag_size: 3172
batch 439, loss: 0.5946, instance_loss: 0.5523, weighted_loss: 0.5819, label: 1, bag_size: 3422
batch 459, loss: 0.4135, instance_loss: 0.7424, weighted_loss: 0.5122, label: 0, bag_size: 272
batch 479, loss: 0.0445, instance_loss: 0.3026, weighted_loss: 0.1219, label: 1, bag_size: 3367
batch 499, loss: 0.7607, instance_loss: 0.7402, weighted_loss: 0.7546, label: 1, bag_size: 5276
batch 519, loss: 0.2000, instance_loss: 0.4201, weighted_loss: 0.2660, label: 0, bag_size: 2339
batch 539, loss: 0.3004, instance_loss: 0.4304, weighted_loss: 0.3394, label: 2, bag_size: 614
batch 559, loss: 0.2423, instance_loss: 0.5080, weighted_loss: 0.3220, label: 0, bag_size: 1762
batch 579, loss: 0.8115, instance_loss: 0.6763, weighted_loss: 0.7709, label: 1, bag_size: 4395
batch 599, loss: 0.1828, instance_loss: 0.4067, weighted_loss: 0.2500, label: 2, bag_size: 3396
batch 619, loss: 0.0625, instance_loss: 0.3342, weighted_loss: 0.1440, label: 2, bag_size: 4372
batch 639, loss: 0.5801, instance_loss: 0.7102, weighted_loss: 0.6191, label: 1, bag_size: 3050
batch 659, loss: 0.8108, instance_loss: 0.6226, weighted_loss: 0.7544, label: 1, bag_size: 3396
batch 679, loss: 0.1411, instance_loss: 0.4268, weighted_loss: 0.2268, label: 0, bag_size: 4734
batch 699, loss: 0.4087, instance_loss: 0.6186, weighted_loss: 0.4717, label: 1, bag_size: 3644
batch 719, loss: 0.1294, instance_loss: 0.3489, weighted_loss: 0.1953, label: 2, bag_size: 6704
batch 739, loss: 0.2736, instance_loss: 0.3538, weighted_loss: 0.2977, label: 0, bag_size: 3793


class 0 clustering acc 0.9738814317673378: correct 17413/17880
class 1 clustering acc 0.2570469798657718: correct 1532/5960
Epoch: 12, train_loss: 0.6583, train_clustering_loss:  0.5929, train_error: 0.2658
class 0: acc 0.7663934426229508, correct 187/244
class 1: acc 0.6614173228346457, correct 168/254
class 2: acc 0.7773279352226721, correct 192/247

Val Set, val_loss: 0.7312, val_error: 0.3404, auc: 0.8728
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.17952127659574468: correct 135/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 3.7638, instance_loss: 1.7129, weighted_loss: 3.1486, label: 0, bag_size: 3711
batch 39, loss: 0.4718, instance_loss: 0.5441, weighted_loss: 0.4935, label: 0, bag_size: 6445
batch 59, loss: 0.1130, instance_loss: 0.1435, weighted_loss: 0.1221, label: 2, bag_size: 4745
batch 79, loss: 0.4073, instance_loss: 0.4970, weighted_loss: 0.4342, label: 0, bag_size: 2712
batch 99, loss: 0.1124, instance_loss: 0.4156, weighted_loss: 0.2033, label: 0, bag_size: 5634
batch 119, loss: 0.0026, instance_loss: 0.3823, weighted_loss: 0.1165, label: 2, bag_size: 5037
batch 139, loss: 0.8053, instance_loss: 0.8278, weighted_loss: 0.8121, label: 1, bag_size: 4684
batch 159, loss: 1.7268, instance_loss: 0.8582, weighted_loss: 1.4662, label: 1, bag_size: 2743
batch 179, loss: 0.2273, instance_loss: 0.2945, weighted_loss: 0.2475, label: 0, bag_size: 3690
batch 199, loss: 0.0445, instance_loss: 0.2039, weighted_loss: 0.0923, label: 0, bag_size: 6221
batch 219, loss: 0.9274, instance_loss: 0.6227, weighted_loss: 0.8360, label: 1, bag_size: 7176
batch 239, loss: 0.3817, instance_loss: 0.5077, weighted_loss: 0.4195, label: 1, bag_size: 3640
batch 259, loss: 0.0330, instance_loss: 0.1095, weighted_loss: 0.0560, label: 2, bag_size: 4569
batch 279, loss: 1.2979, instance_loss: 0.6091, weighted_loss: 1.0912, label: 1, bag_size: 3296
batch 299, loss: 0.1122, instance_loss: 0.1799, weighted_loss: 0.1325, label: 2, bag_size: 2313
batch 319, loss: 0.9716, instance_loss: 0.7074, weighted_loss: 0.8923, label: 1, bag_size: 3823
batch 339, loss: 0.0603, instance_loss: 0.2313, weighted_loss: 0.1116, label: 1, bag_size: 758
batch 359, loss: 1.4697, instance_loss: 1.0529, weighted_loss: 1.3447, label: 1, bag_size: 1307
batch 379, loss: 1.1701, instance_loss: 0.8028, weighted_loss: 1.0599, label: 2, bag_size: 4571
batch 399, loss: 0.1604, instance_loss: 0.3186, weighted_loss: 0.2079, label: 0, bag_size: 1194
batch 419, loss: 0.2459, instance_loss: 0.5988, weighted_loss: 0.3518, label: 1, bag_size: 4684
batch 439, loss: 0.3637, instance_loss: 0.5732, weighted_loss: 0.4266, label: 1, bag_size: 1221
batch 459, loss: 0.3647, instance_loss: 0.7888, weighted_loss: 0.4920, label: 2, bag_size: 3607
batch 479, loss: 0.2738, instance_loss: 0.2702, weighted_loss: 0.2727, label: 2, bag_size: 3210
batch 499, loss: 0.5938, instance_loss: 0.3813, weighted_loss: 0.5300, label: 2, bag_size: 1103
batch 519, loss: 1.8443, instance_loss: 1.5995, weighted_loss: 1.7708, label: 1, bag_size: 936
batch 539, loss: 0.0846, instance_loss: 0.4572, weighted_loss: 0.1964, label: 2, bag_size: 5037
batch 559, loss: 0.8076, instance_loss: 0.8895, weighted_loss: 0.8321, label: 2, bag_size: 4291
batch 579, loss: 2.1593, instance_loss: 0.5885, weighted_loss: 1.6881, label: 1, bag_size: 5167
batch 599, loss: 1.4278, instance_loss: 0.7028, weighted_loss: 1.2103, label: 0, bag_size: 2153
batch 619, loss: 0.1755, instance_loss: 0.2853, weighted_loss: 0.2085, label: 2, bag_size: 5924
batch 639, loss: 2.4578, instance_loss: 1.0869, weighted_loss: 2.0465, label: 0, bag_size: 1365
batch 659, loss: 1.0456, instance_loss: 0.9283, weighted_loss: 1.0104, label: 1, bag_size: 5412
batch 679, loss: 0.3916, instance_loss: 0.1846, weighted_loss: 0.3295, label: 2, bag_size: 4691
batch 699, loss: 0.1743, instance_loss: 0.3778, weighted_loss: 0.2353, label: 1, bag_size: 582
batch 719, loss: 0.0535, instance_loss: 0.0838, weighted_loss: 0.0626, label: 2, bag_size: 6001
batch 739, loss: 1.2069, instance_loss: 0.8485, weighted_loss: 1.0994, label: 2, bag_size: 2813


class 0 clustering acc 0.9749440715883669: correct 17432/17880
class 1 clustering acc 0.273993288590604: correct 1633/5960
Epoch: 13, train_loss: 0.6887, train_clustering_loss:  0.5923, train_error: 0.3007
class 0: acc 0.7344398340248963, correct 177/241
class 1: acc 0.5941422594142259, correct 142/239
class 2: acc 0.7622641509433963, correct 202/265

Val Set, val_loss: 0.6833, val_error: 0.3404, auc: 0.8729
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.13829787234042554: correct 104/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3925, instance_loss: 0.5820, weighted_loss: 0.4493, label: 0, bag_size: 4378
batch 39, loss: 0.7293, instance_loss: 0.5787, weighted_loss: 0.6842, label: 1, bag_size: 4373
batch 59, loss: 0.1235, instance_loss: 0.3545, weighted_loss: 0.1928, label: 2, bag_size: 5924
batch 79, loss: 2.4895, instance_loss: 1.0812, weighted_loss: 2.0670, label: 2, bag_size: 4316
batch 99, loss: 1.5132, instance_loss: 0.8669, weighted_loss: 1.3193, label: 2, bag_size: 5743
batch 119, loss: 1.8178, instance_loss: 0.9253, weighted_loss: 1.5501, label: 0, bag_size: 1695
batch 139, loss: 1.5212, instance_loss: 1.0854, weighted_loss: 1.3905, label: 2, bag_size: 4342
batch 159, loss: 0.0091, instance_loss: 0.1574, weighted_loss: 0.0536, label: 1, bag_size: 5364
batch 179, loss: 0.2694, instance_loss: 0.4345, weighted_loss: 0.3190, label: 0, bag_size: 4455
batch 199, loss: 0.5168, instance_loss: 0.4832, weighted_loss: 0.5067, label: 0, bag_size: 4909
batch 219, loss: 0.9441, instance_loss: 1.1236, weighted_loss: 0.9979, label: 0, bag_size: 1106
batch 239, loss: 0.1407, instance_loss: 0.0767, weighted_loss: 0.1215, label: 2, bag_size: 2254
batch 259, loss: 0.1737, instance_loss: 0.4641, weighted_loss: 0.2608, label: 1, bag_size: 4684
batch 279, loss: 0.5381, instance_loss: 0.6318, weighted_loss: 0.5662, label: 0, bag_size: 5890
batch 299, loss: 1.5803, instance_loss: 1.0103, weighted_loss: 1.4093, label: 0, bag_size: 3341
batch 319, loss: 0.1608, instance_loss: 0.4778, weighted_loss: 0.2559, label: 1, bag_size: 2643
batch 339, loss: 0.4463, instance_loss: 0.3787, weighted_loss: 0.4260, label: 2, bag_size: 3210
batch 359, loss: 1.4553, instance_loss: 1.6973, weighted_loss: 1.5279, label: 0, bag_size: 11141
batch 379, loss: 0.0485, instance_loss: 0.1149, weighted_loss: 0.0684, label: 2, bag_size: 5138
batch 399, loss: 0.6116, instance_loss: 0.6339, weighted_loss: 0.6183, label: 2, bag_size: 5406
batch 419, loss: 1.3640, instance_loss: 0.9148, weighted_loss: 1.2293, label: 0, bag_size: 22822
batch 439, loss: 0.5910, instance_loss: 0.5245, weighted_loss: 0.5710, label: 1, bag_size: 4119
batch 459, loss: 0.4016, instance_loss: 0.5998, weighted_loss: 0.4611, label: 1, bag_size: 2731
batch 479, loss: 1.1424, instance_loss: 0.7488, weighted_loss: 1.0243, label: 2, bag_size: 724
batch 499, loss: 0.0948, instance_loss: 0.4304, weighted_loss: 0.1955, label: 1, bag_size: 5385
batch 519, loss: 1.2957, instance_loss: 0.8497, weighted_loss: 1.1619, label: 2, bag_size: 552
batch 539, loss: 0.9617, instance_loss: 0.7685, weighted_loss: 0.9037, label: 0, bag_size: 5041
batch 559, loss: 2.7996, instance_loss: 1.0785, weighted_loss: 2.2832, label: 0, bag_size: 2217
batch 579, loss: 0.2430, instance_loss: 0.3273, weighted_loss: 0.2683, label: 2, bag_size: 4302
batch 599, loss: 0.1479, instance_loss: 0.1395, weighted_loss: 0.1454, label: 2, bag_size: 3546
batch 619, loss: 0.1471, instance_loss: 0.3007, weighted_loss: 0.1932, label: 2, bag_size: 2031
batch 639, loss: 0.7373, instance_loss: 0.6663, weighted_loss: 0.7160, label: 1, bag_size: 3106
batch 659, loss: 0.2273, instance_loss: 0.1905, weighted_loss: 0.2162, label: 2, bag_size: 3583
batch 679, loss: 1.8895, instance_loss: 1.1599, weighted_loss: 1.6706, label: 1, bag_size: 869
batch 699, loss: 0.1117, instance_loss: 0.3188, weighted_loss: 0.1738, label: 0, bag_size: 3694
batch 719, loss: 0.4122, instance_loss: 0.5108, weighted_loss: 0.4417, label: 1, bag_size: 10941
batch 739, loss: 0.1048, instance_loss: 0.4327, weighted_loss: 0.2032, label: 0, bag_size: 4744


class 0 clustering acc 0.9765100671140939: correct 17460/17880
class 1 clustering acc 0.2436241610738255: correct 1452/5960
Epoch: 14, train_loss: 0.6865, train_clustering_loss:  0.5933, train_error: 0.3114
class 0: acc 0.65625, correct 147/224
class 1: acc 0.6317829457364341, correct 163/258
class 2: acc 0.7718631178707225, correct 203/263

Val Set, val_loss: 0.7286, val_error: 0.3085, auc: 0.8652
class 0 clustering acc 0.9813829787234043: correct 2214/2256
class 1 clustering acc 0.16489361702127658: correct 124/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1581, instance_loss: 0.2189, weighted_loss: 0.1763, label: 2, bag_size: 2049
batch 39, loss: 0.1093, instance_loss: 0.8185, weighted_loss: 0.3221, label: 1, bag_size: 3172
batch 59, loss: 0.3937, instance_loss: 0.6832, weighted_loss: 0.4806, label: 1, bag_size: 4684
batch 79, loss: 1.3750, instance_loss: 1.2175, weighted_loss: 1.3277, label: 1, bag_size: 1580
batch 99, loss: 0.2569, instance_loss: 0.4172, weighted_loss: 0.3050, label: 2, bag_size: 3778
batch 119, loss: 1.4486, instance_loss: 0.8185, weighted_loss: 1.2596, label: 1, bag_size: 628
batch 139, loss: 0.1821, instance_loss: 0.3722, weighted_loss: 0.2391, label: 0, bag_size: 5170
batch 159, loss: 0.0451, instance_loss: 0.4030, weighted_loss: 0.1524, label: 2, bag_size: 6148
batch 179, loss: 1.6089, instance_loss: 1.5871, weighted_loss: 1.6023, label: 1, bag_size: 3399
batch 199, loss: 0.4698, instance_loss: 0.5507, weighted_loss: 0.4941, label: 2, bag_size: 3227
batch 219, loss: 0.0000, instance_loss: 0.0001, weighted_loss: 0.0000, label: 0, bag_size: 4582
batch 239, loss: 0.1710, instance_loss: 0.4157, weighted_loss: 0.2444, label: 2, bag_size: 4302
batch 259, loss: 0.3738, instance_loss: 0.5136, weighted_loss: 0.4158, label: 2, bag_size: 614
batch 279, loss: 0.3543, instance_loss: 0.4667, weighted_loss: 0.3880, label: 1, bag_size: 3221
batch 299, loss: 0.0601, instance_loss: 0.2894, weighted_loss: 0.1289, label: 0, bag_size: 2339
batch 319, loss: 0.9382, instance_loss: 0.6338, weighted_loss: 0.8469, label: 1, bag_size: 6717
batch 339, loss: 0.2358, instance_loss: 0.1434, weighted_loss: 0.2081, label: 2, bag_size: 4056
batch 359, loss: 0.0040, instance_loss: 0.2538, weighted_loss: 0.0789, label: 1, bag_size: 3677
batch 379, loss: 0.2511, instance_loss: 0.8905, weighted_loss: 0.4429, label: 2, bag_size: 6644
batch 399, loss: 0.0564, instance_loss: 0.2874, weighted_loss: 0.1257, label: 2, bag_size: 2313
batch 419, loss: 0.0680, instance_loss: 0.2731, weighted_loss: 0.1295, label: 2, bag_size: 4555
batch 439, loss: 0.1020, instance_loss: 0.3114, weighted_loss: 0.1648, label: 2, bag_size: 3396
batch 459, loss: 0.1143, instance_loss: 0.7623, weighted_loss: 0.3087, label: 0, bag_size: 4529
batch 479, loss: 0.2767, instance_loss: 0.5912, weighted_loss: 0.3710, label: 1, bag_size: 5118
batch 499, loss: 1.2557, instance_loss: 1.0212, weighted_loss: 1.1853, label: 0, bag_size: 1289
batch 519, loss: 1.5861, instance_loss: 0.9583, weighted_loss: 1.3978, label: 1, bag_size: 11974
batch 539, loss: 0.7080, instance_loss: 0.6525, weighted_loss: 0.6913, label: 0, bag_size: 789
batch 559, loss: 0.7380, instance_loss: 0.5817, weighted_loss: 0.6911, label: 1, bag_size: 574
batch 579, loss: 0.3748, instance_loss: 0.6047, weighted_loss: 0.4438, label: 0, bag_size: 5893
batch 599, loss: 0.0488, instance_loss: 0.2640, weighted_loss: 0.1133, label: 2, bag_size: 2422
batch 619, loss: 0.8930, instance_loss: 0.6836, weighted_loss: 0.8302, label: 2, bag_size: 4569
batch 639, loss: 0.0448, instance_loss: 0.2251, weighted_loss: 0.0989, label: 1, bag_size: 2453
batch 659, loss: 0.8032, instance_loss: 1.2825, weighted_loss: 0.9469, label: 1, bag_size: 3184
batch 679, loss: 1.6613, instance_loss: 1.1226, weighted_loss: 1.4997, label: 0, bag_size: 4351
batch 699, loss: 0.3880, instance_loss: 0.4554, weighted_loss: 0.4083, label: 1, bag_size: 1197
batch 719, loss: 0.2406, instance_loss: 0.1406, weighted_loss: 0.2106, label: 1, bag_size: 6475
batch 739, loss: 0.9772, instance_loss: 0.8874, weighted_loss: 0.9502, label: 2, bag_size: 2486


class 0 clustering acc 0.9772371364653244: correct 17473/17880
class 1 clustering acc 0.31208053691275167: correct 1860/5960
Epoch: 15, train_loss: 0.6193, train_clustering_loss:  0.5637, train_error: 0.2470
class 0: acc 0.7821011673151751, correct 201/257
class 1: acc 0.6987951807228916, correct 174/249
class 2: acc 0.7782426778242678, correct 186/239

Val Set, val_loss: 0.6404, val_error: 0.2979, auc: 0.8910
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.39893617021276595: correct 300/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1034, instance_loss: 0.2883, weighted_loss: 0.1588, label: 0, bag_size: 4332
batch 39, loss: 0.4459, instance_loss: 0.8797, weighted_loss: 0.5760, label: 0, bag_size: 2232
batch 59, loss: 0.0019, instance_loss: 0.0739, weighted_loss: 0.0235, label: 1, bag_size: 5462
batch 79, loss: 0.0386, instance_loss: 0.1669, weighted_loss: 0.0771, label: 0, bag_size: 4808
batch 99, loss: 0.0496, instance_loss: 0.3428, weighted_loss: 0.1376, label: 2, bag_size: 2422
batch 119, loss: 1.3447, instance_loss: 0.8943, weighted_loss: 1.2096, label: 1, bag_size: 3837
batch 139, loss: 0.5101, instance_loss: 0.7054, weighted_loss: 0.5687, label: 2, bag_size: 4535
batch 159, loss: 0.1180, instance_loss: 0.2491, weighted_loss: 0.1573, label: 1, bag_size: 3367
batch 179, loss: 0.0864, instance_loss: 0.2481, weighted_loss: 0.1349, label: 1, bag_size: 3761
batch 199, loss: 0.0700, instance_loss: 0.2187, weighted_loss: 0.1146, label: 2, bag_size: 2422
batch 219, loss: 0.6013, instance_loss: 0.7586, weighted_loss: 0.6485, label: 2, bag_size: 6704
batch 239, loss: 0.2188, instance_loss: 0.3059, weighted_loss: 0.2450, label: 1, bag_size: 368
batch 259, loss: 0.2129, instance_loss: 0.5969, weighted_loss: 0.3281, label: 1, bag_size: 779
batch 279, loss: 0.2471, instance_loss: 0.3119, weighted_loss: 0.2665, label: 0, bag_size: 2791
batch 299, loss: 0.4210, instance_loss: 0.7655, weighted_loss: 0.5244, label: 0, bag_size: 4146
batch 319, loss: 0.0314, instance_loss: 0.3008, weighted_loss: 0.1122, label: 2, bag_size: 2422
batch 339, loss: 0.0444, instance_loss: 0.6703, weighted_loss: 0.2321, label: 2, bag_size: 5017
batch 359, loss: 0.4602, instance_loss: 0.6678, weighted_loss: 0.5225, label: 0, bag_size: 1352
batch 379, loss: 1.8172, instance_loss: 0.8570, weighted_loss: 1.5291, label: 0, bag_size: 1695
batch 399, loss: 0.7538, instance_loss: 0.8109, weighted_loss: 0.7709, label: 1, bag_size: 578
batch 419, loss: 0.2203, instance_loss: 0.5125, weighted_loss: 0.3080, label: 0, bag_size: 5893
batch 439, loss: 0.1338, instance_loss: 0.1868, weighted_loss: 0.1497, label: 2, bag_size: 3210
batch 459, loss: 0.3005, instance_loss: 0.2945, weighted_loss: 0.2987, label: 0, bag_size: 2897
batch 479, loss: 0.1527, instance_loss: 0.1766, weighted_loss: 0.1599, label: 0, bag_size: 3113
batch 499, loss: 0.0208, instance_loss: 0.1745, weighted_loss: 0.0669, label: 2, bag_size: 4203
batch 519, loss: 0.0877, instance_loss: 0.3001, weighted_loss: 0.1514, label: 0, bag_size: 1132
batch 539, loss: 1.9861, instance_loss: 0.7752, weighted_loss: 1.6228, label: 0, bag_size: 3675
batch 559, loss: 2.4733, instance_loss: 1.2745, weighted_loss: 2.1137, label: 1, bag_size: 1964
batch 579, loss: 0.4064, instance_loss: 0.5828, weighted_loss: 0.4593, label: 1, bag_size: 3051
batch 599, loss: 0.1067, instance_loss: 0.4706, weighted_loss: 0.2159, label: 2, bag_size: 4140
batch 619, loss: 0.9355, instance_loss: 0.8711, weighted_loss: 0.9162, label: 0, bag_size: 4351
batch 639, loss: 0.0110, instance_loss: 0.3490, weighted_loss: 0.1124, label: 1, bag_size: 3156
batch 659, loss: 1.5882, instance_loss: 0.9259, weighted_loss: 1.3895, label: 2, bag_size: 2326
batch 679, loss: 0.1179, instance_loss: 0.3064, weighted_loss: 0.1745, label: 2, bag_size: 3810
batch 699, loss: 1.7799, instance_loss: 0.6382, weighted_loss: 1.4374, label: 2, bag_size: 705
batch 719, loss: 0.2636, instance_loss: 0.4410, weighted_loss: 0.3168, label: 2, bag_size: 5011
batch 739, loss: 0.1413, instance_loss: 0.5174, weighted_loss: 0.2541, label: 0, bag_size: 5902


class 0 clustering acc 0.9721476510067114: correct 17382/17880
class 1 clustering acc 0.313255033557047: correct 1867/5960
Epoch: 16, train_loss: 0.6154, train_clustering_loss:  0.5709, train_error: 0.2550
class 0: acc 0.78515625, correct 201/256
class 1: acc 0.6554621848739496, correct 156/238
class 2: acc 0.7888446215139442, correct 198/251

Val Set, val_loss: 0.6366, val_error: 0.2872, auc: 0.8774
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.3962765957446808: correct 298/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2135, instance_loss: 0.2357, weighted_loss: 0.2202, label: 2, bag_size: 3397
batch 39, loss: 0.6564, instance_loss: 0.7108, weighted_loss: 0.6727, label: 1, bag_size: 4940
batch 59, loss: 0.2925, instance_loss: 0.2333, weighted_loss: 0.2747, label: 2, bag_size: 597
batch 79, loss: 0.6733, instance_loss: 0.7047, weighted_loss: 0.6827, label: 1, bag_size: 3534
batch 99, loss: 0.8468, instance_loss: 0.5750, weighted_loss: 0.7652, label: 1, bag_size: 4960
batch 119, loss: 0.0322, instance_loss: 0.1675, weighted_loss: 0.0728, label: 0, bag_size: 3986
batch 139, loss: 0.1107, instance_loss: 0.1392, weighted_loss: 0.1192, label: 2, bag_size: 2254
batch 159, loss: 0.1688, instance_loss: 0.6512, weighted_loss: 0.3135, label: 0, bag_size: 4544
batch 179, loss: 0.7719, instance_loss: 0.7240, weighted_loss: 0.7575, label: 2, bag_size: 2326
batch 199, loss: 1.5319, instance_loss: 1.0068, weighted_loss: 1.3744, label: 1, bag_size: 7176
batch 219, loss: 0.0868, instance_loss: 0.3779, weighted_loss: 0.1742, label: 2, bag_size: 6704
batch 239, loss: 0.1952, instance_loss: 0.3315, weighted_loss: 0.2361, label: 1, bag_size: 259
batch 259, loss: 0.6040, instance_loss: 0.7037, weighted_loss: 0.6339, label: 0, bag_size: 4604
batch 279, loss: 1.1742, instance_loss: 1.0851, weighted_loss: 1.1474, label: 0, bag_size: 4398
batch 299, loss: 0.5573, instance_loss: 0.3462, weighted_loss: 0.4939, label: 2, bag_size: 4096
batch 319, loss: 0.1729, instance_loss: 0.6114, weighted_loss: 0.3045, label: 2, bag_size: 3299
batch 339, loss: 0.4661, instance_loss: 0.5008, weighted_loss: 0.4765, label: 0, bag_size: 2712
batch 359, loss: 2.6973, instance_loss: 1.0962, weighted_loss: 2.2170, label: 0, bag_size: 35080
batch 379, loss: 0.0193, instance_loss: 0.2082, weighted_loss: 0.0760, label: 0, bag_size: 6797
batch 399, loss: 0.3024, instance_loss: 0.3778, weighted_loss: 0.3250, label: 0, bag_size: 4831
batch 419, loss: 1.5119, instance_loss: 0.6472, weighted_loss: 1.2525, label: 2, bag_size: 2031
batch 439, loss: 1.4386, instance_loss: 0.7159, weighted_loss: 1.2217, label: 0, bag_size: 5017
batch 459, loss: 0.0948, instance_loss: 0.2898, weighted_loss: 0.1533, label: 0, bag_size: 13540
batch 479, loss: 0.3669, instance_loss: 0.3148, weighted_loss: 0.3513, label: 0, bag_size: 5373
batch 499, loss: 0.4304, instance_loss: 0.3575, weighted_loss: 0.4086, label: 2, bag_size: 3026
batch 519, loss: 0.1765, instance_loss: 0.1880, weighted_loss: 0.1799, label: 2, bag_size: 1094
batch 539, loss: 0.5166, instance_loss: 0.7043, weighted_loss: 0.5729, label: 2, bag_size: 4192
batch 559, loss: 0.8754, instance_loss: 0.9667, weighted_loss: 0.9028, label: 1, bag_size: 3986
batch 579, loss: 0.4043, instance_loss: 0.3892, weighted_loss: 0.3998, label: 0, bag_size: 640
batch 599, loss: 0.2722, instance_loss: 0.1347, weighted_loss: 0.2309, label: 0, bag_size: 5108
batch 619, loss: 1.5417, instance_loss: 0.9030, weighted_loss: 1.3501, label: 2, bag_size: 4241
batch 639, loss: 1.8147, instance_loss: 1.6394, weighted_loss: 1.7621, label: 1, bag_size: 4258
batch 659, loss: 0.3819, instance_loss: 0.4827, weighted_loss: 0.4122, label: 1, bag_size: 4373
batch 679, loss: 0.0057, instance_loss: 0.3008, weighted_loss: 0.0942, label: 1, bag_size: 4111
batch 699, loss: 0.7847, instance_loss: 0.4151, weighted_loss: 0.6738, label: 1, bag_size: 1712
batch 719, loss: 0.1792, instance_loss: 0.1729, weighted_loss: 0.1773, label: 1, bag_size: 7135
batch 739, loss: 0.0938, instance_loss: 0.1586, weighted_loss: 0.1132, label: 1, bag_size: 6992


class 0 clustering acc 0.9722035794183446: correct 17383/17880
class 1 clustering acc 0.3192953020134228: correct 1903/5960
Epoch: 17, train_loss: 0.6591, train_clustering_loss:  0.5765, train_error: 0.2805
class 0: acc 0.7575757575757576, correct 200/264
class 1: acc 0.631578947368421, correct 144/228
class 2: acc 0.758893280632411, correct 192/253

Val Set, val_loss: 0.6859, val_error: 0.2872, auc: 0.8736
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.36569148936170215: correct 275/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.4606, instance_loss: 0.4826, weighted_loss: 0.4672, label: 0, bag_size: 2884
batch 39, loss: 1.0020, instance_loss: 0.6001, weighted_loss: 0.8814, label: 1, bag_size: 19265
batch 59, loss: 0.0204, instance_loss: 0.2785, weighted_loss: 0.0978, label: 2, bag_size: 5037
batch 79, loss: 0.2093, instance_loss: 0.1476, weighted_loss: 0.1908, label: 2, bag_size: 3210
batch 99, loss: 0.0062, instance_loss: 0.0231, weighted_loss: 0.0113, label: 1, bag_size: 5462
batch 119, loss: 0.2278, instance_loss: 0.1858, weighted_loss: 0.2152, label: 0, bag_size: 471
batch 139, loss: 0.0193, instance_loss: 0.2170, weighted_loss: 0.0786, label: 1, bag_size: 4134
batch 159, loss: 0.1916, instance_loss: 0.3417, weighted_loss: 0.2367, label: 2, bag_size: 5011
batch 179, loss: 0.0583, instance_loss: 0.3256, weighted_loss: 0.1385, label: 2, bag_size: 4140
batch 199, loss: 0.3598, instance_loss: 0.5161, weighted_loss: 0.4067, label: 2, bag_size: 4569
batch 219, loss: 0.2980, instance_loss: 0.3357, weighted_loss: 0.3093, label: 0, bag_size: 2559
batch 239, loss: 0.0710, instance_loss: 0.2887, weighted_loss: 0.1363, label: 0, bag_size: 5950
batch 259, loss: 0.0430, instance_loss: 0.4408, weighted_loss: 0.1623, label: 1, bag_size: 4290
batch 279, loss: 0.5446, instance_loss: 0.4216, weighted_loss: 0.5077, label: 2, bag_size: 705
batch 299, loss: 0.0234, instance_loss: 0.1950, weighted_loss: 0.0749, label: 2, bag_size: 4203
batch 319, loss: 0.0969, instance_loss: 0.2071, weighted_loss: 0.1300, label: 0, bag_size: 2767
batch 339, loss: 0.9076, instance_loss: 0.5668, weighted_loss: 0.8054, label: 2, bag_size: 6298
batch 359, loss: 0.9745, instance_loss: 0.4688, weighted_loss: 0.8228, label: 1, bag_size: 5756
batch 379, loss: 0.4076, instance_loss: 0.3598, weighted_loss: 0.3933, label: 0, bag_size: 4325
batch 399, loss: 0.9007, instance_loss: 0.6802, weighted_loss: 0.8345, label: 1, bag_size: 1860
batch 419, loss: 0.2251, instance_loss: 0.3068, weighted_loss: 0.2496, label: 0, bag_size: 3533
batch 439, loss: 0.0111, instance_loss: 0.1898, weighted_loss: 0.0647, label: 2, bag_size: 4141
batch 459, loss: 0.0547, instance_loss: 0.1873, weighted_loss: 0.0945, label: 0, bag_size: 5226
batch 479, loss: 0.1505, instance_loss: 0.2540, weighted_loss: 0.1815, label: 0, bag_size: 1234
batch 499, loss: 0.2110, instance_loss: 0.4125, weighted_loss: 0.2714, label: 2, bag_size: 4302
batch 519, loss: 1.7404, instance_loss: 0.9779, weighted_loss: 1.5116, label: 0, bag_size: 2579
batch 539, loss: 0.0097, instance_loss: 0.3012, weighted_loss: 0.0971, label: 2, bag_size: 5037
batch 559, loss: 0.1810, instance_loss: 0.1356, weighted_loss: 0.1674, label: 2, bag_size: 3172
batch 579, loss: 3.0740, instance_loss: 1.5548, weighted_loss: 2.6182, label: 0, bag_size: 4605
batch 599, loss: 1.8260, instance_loss: 1.0043, weighted_loss: 1.5795, label: 0, bag_size: 4032
batch 619, loss: 0.4632, instance_loss: 0.2256, weighted_loss: 0.3919, label: 2, bag_size: 4043
batch 639, loss: 0.0789, instance_loss: 0.5847, weighted_loss: 0.2306, label: 1, bag_size: 4067
batch 659, loss: 0.5082, instance_loss: 0.7341, weighted_loss: 0.5759, label: 0, bag_size: 889
batch 679, loss: 2.4224, instance_loss: 1.0356, weighted_loss: 2.0063, label: 1, bag_size: 5423
batch 699, loss: 0.0881, instance_loss: 0.1913, weighted_loss: 0.1190, label: 0, bag_size: 5337
batch 719, loss: 0.3303, instance_loss: 0.4192, weighted_loss: 0.3569, label: 0, bag_size: 2873
batch 739, loss: 0.3759, instance_loss: 0.4691, weighted_loss: 0.4039, label: 0, bag_size: 4347


class 0 clustering acc 0.969910514541387: correct 17342/17880
class 1 clustering acc 0.30251677852348996: correct 1803/5960
Epoch: 18, train_loss: 0.6541, train_clustering_loss:  0.5861, train_error: 0.2819
class 0: acc 0.7843866171003717, correct 211/269
class 1: acc 0.6008230452674898, correct 146/243
class 2: acc 0.7639484978540773, correct 178/233

Val Set, val_loss: 0.5878, val_error: 0.2766, auc: 0.8976
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.3882978723404255: correct 292/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.5453, instance_loss: 1.0712, weighted_loss: 1.4031, label: 1, bag_size: 4708
batch 39, loss: 0.1081, instance_loss: 0.2211, weighted_loss: 0.1420, label: 2, bag_size: 4775
batch 59, loss: 0.0956, instance_loss: 0.3218, weighted_loss: 0.1634, label: 1, bag_size: 4067
batch 79, loss: 0.0642, instance_loss: 0.3276, weighted_loss: 0.1432, label: 0, bag_size: 4131
batch 99, loss: 0.5013, instance_loss: 0.5473, weighted_loss: 0.5151, label: 1, bag_size: 368
batch 119, loss: 1.5664, instance_loss: 0.9626, weighted_loss: 1.3853, label: 0, bag_size: 5259
batch 139, loss: 1.9877, instance_loss: 1.0814, weighted_loss: 1.7158, label: 2, bag_size: 361
batch 159, loss: 0.1669, instance_loss: 0.4039, weighted_loss: 0.2380, label: 2, bag_size: 6644
batch 179, loss: 0.0012, instance_loss: 0.1371, weighted_loss: 0.0420, label: 2, bag_size: 2422
batch 199, loss: 1.5754, instance_loss: 1.4887, weighted_loss: 1.5494, label: 0, bag_size: 2069
batch 219, loss: 0.9181, instance_loss: 0.9625, weighted_loss: 0.9314, label: 0, bag_size: 4032
batch 239, loss: 0.4099, instance_loss: 0.4409, weighted_loss: 0.4192, label: 2, bag_size: 4978
batch 259, loss: 0.0661, instance_loss: 0.3448, weighted_loss: 0.1497, label: 0, bag_size: 1234
batch 279, loss: 0.4961, instance_loss: 0.5236, weighted_loss: 0.5043, label: 1, bag_size: 2945
batch 299, loss: 1.9931, instance_loss: 0.9797, weighted_loss: 1.6891, label: 1, bag_size: 5880
batch 319, loss: 0.4772, instance_loss: 0.5824, weighted_loss: 0.5088, label: 1, bag_size: 2945
batch 339, loss: 0.6548, instance_loss: 0.5974, weighted_loss: 0.6376, label: 0, bag_size: 1373
batch 359, loss: 0.3775, instance_loss: 0.4623, weighted_loss: 0.4029, label: 0, bag_size: 4325
batch 379, loss: 0.5669, instance_loss: 1.3577, weighted_loss: 0.8041, label: 0, bag_size: 2028
batch 399, loss: 0.0207, instance_loss: 0.2370, weighted_loss: 0.0856, label: 0, bag_size: 4147
batch 419, loss: 0.0369, instance_loss: 0.2449, weighted_loss: 0.0993, label: 1, bag_size: 3156
batch 439, loss: 0.2801, instance_loss: 0.3545, weighted_loss: 0.3024, label: 2, bag_size: 3174
batch 459, loss: 0.4088, instance_loss: 0.3418, weighted_loss: 0.3887, label: 2, bag_size: 3227
batch 479, loss: 0.1706, instance_loss: 0.4230, weighted_loss: 0.2463, label: 2, bag_size: 4162
batch 499, loss: 2.3865, instance_loss: 1.2356, weighted_loss: 2.0412, label: 1, bag_size: 1250
batch 519, loss: 0.4051, instance_loss: 0.3182, weighted_loss: 0.3790, label: 2, bag_size: 614
batch 539, loss: 0.0047, instance_loss: 0.3323, weighted_loss: 0.1029, label: 0, bag_size: 4083
batch 559, loss: 0.5284, instance_loss: 0.7773, weighted_loss: 0.6031, label: 1, bag_size: 3519
batch 579, loss: 0.1079, instance_loss: 0.1507, weighted_loss: 0.1207, label: 2, bag_size: 2313
batch 599, loss: 0.1813, instance_loss: 0.6144, weighted_loss: 0.3112, label: 0, bag_size: 2853
batch 619, loss: 0.5324, instance_loss: 0.5380, weighted_loss: 0.5341, label: 2, bag_size: 5072
batch 639, loss: 0.9441, instance_loss: 0.8240, weighted_loss: 0.9081, label: 2, bag_size: 5426
batch 659, loss: 1.0089, instance_loss: 0.6856, weighted_loss: 0.9119, label: 1, bag_size: 2083
batch 679, loss: 0.7043, instance_loss: 0.7112, weighted_loss: 0.7064, label: 1, bag_size: 3422
batch 699, loss: 1.6016, instance_loss: 1.1019, weighted_loss: 1.4517, label: 1, bag_size: 3322
batch 719, loss: 0.1230, instance_loss: 0.3150, weighted_loss: 0.1806, label: 0, bag_size: 5915
batch 739, loss: 0.3545, instance_loss: 0.3713, weighted_loss: 0.3595, label: 0, bag_size: 6863


class 0 clustering acc 0.9733221476510067: correct 17403/17880
class 1 clustering acc 0.28573825503355704: correct 1703/5960
Epoch: 19, train_loss: 0.6468, train_clustering_loss:  0.5821, train_error: 0.2792
class 0: acc 0.792, correct 198/250
class 1: acc 0.5826446280991735, correct 141/242
class 2: acc 0.782608695652174, correct 198/253

Val Set, val_loss: 0.7692, val_error: 0.3830, auc: 0.8767
class 0 clustering acc 0.9902482269503546: correct 2234/2256
class 1 clustering acc 0.10106382978723404: correct 76/752
class 0: acc 0.46153846153846156, correct 24/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2312, instance_loss: 0.4389, weighted_loss: 0.2936, label: 1, bag_size: 3761
batch 39, loss: 3.0505, instance_loss: 1.3401, weighted_loss: 2.5374, label: 1, bag_size: 32
batch 59, loss: 0.2650, instance_loss: 0.6071, weighted_loss: 0.3676, label: 0, bag_size: 2231
batch 79, loss: 0.2289, instance_loss: 0.5622, weighted_loss: 0.3289, label: 0, bag_size: 3341
batch 99, loss: 0.6243, instance_loss: 0.4761, weighted_loss: 0.5798, label: 2, bag_size: 4241
batch 119, loss: 0.4390, instance_loss: 0.5994, weighted_loss: 0.4871, label: 0, bag_size: 272
batch 139, loss: 0.3028, instance_loss: 0.2625, weighted_loss: 0.2907, label: 0, bag_size: 3304
batch 159, loss: 0.2895, instance_loss: 0.5318, weighted_loss: 0.3622, label: 1, bag_size: 1042
batch 179, loss: 0.0932, instance_loss: 0.3682, weighted_loss: 0.1757, label: 1, bag_size: 4192
batch 199, loss: 2.1476, instance_loss: 0.8367, weighted_loss: 1.7544, label: 0, bag_size: 5867
batch 219, loss: 0.3633, instance_loss: 0.3903, weighted_loss: 0.3714, label: 0, bag_size: 5041
batch 239, loss: 1.0615, instance_loss: 0.7041, weighted_loss: 0.9543, label: 0, bag_size: 2559
batch 259, loss: 0.7180, instance_loss: 0.9854, weighted_loss: 0.7982, label: 1, bag_size: 2472
batch 279, loss: 0.6661, instance_loss: 0.6400, weighted_loss: 0.6583, label: 1, bag_size: 1327
batch 299, loss: 3.1276, instance_loss: 0.8564, weighted_loss: 2.4463, label: 2, bag_size: 5307
batch 319, loss: 0.4441, instance_loss: 0.3772, weighted_loss: 0.4240, label: 0, bag_size: 702
batch 339, loss: 1.5945, instance_loss: 1.0320, weighted_loss: 1.4258, label: 2, bag_size: 552
batch 359, loss: 0.5630, instance_loss: 0.4047, weighted_loss: 0.5155, label: 2, bag_size: 3227
batch 379, loss: 0.8745, instance_loss: 0.5810, weighted_loss: 0.7865, label: 2, bag_size: 6298
batch 399, loss: 1.0443, instance_loss: 0.7686, weighted_loss: 0.9616, label: 1, bag_size: 3261
batch 419, loss: 0.4986, instance_loss: 0.4997, weighted_loss: 0.4990, label: 2, bag_size: 2049
batch 439, loss: 0.1404, instance_loss: 0.3046, weighted_loss: 0.1897, label: 2, bag_size: 5138
batch 459, loss: 0.0390, instance_loss: 0.5258, weighted_loss: 0.1851, label: 0, bag_size: 7595
batch 479, loss: 1.6727, instance_loss: 0.8633, weighted_loss: 1.4299, label: 2, bag_size: 2326
batch 499, loss: 1.3417, instance_loss: 0.8938, weighted_loss: 1.2073, label: 1, bag_size: 210
batch 519, loss: 0.9165, instance_loss: 0.5931, weighted_loss: 0.8195, label: 2, bag_size: 5426
batch 539, loss: 0.0520, instance_loss: 0.2417, weighted_loss: 0.1089, label: 2, bag_size: 3415
batch 559, loss: 0.1153, instance_loss: 0.1292, weighted_loss: 0.1195, label: 0, bag_size: 3304
batch 579, loss: 0.8624, instance_loss: 1.0526, weighted_loss: 0.9195, label: 0, bag_size: 4509
batch 599, loss: 0.1606, instance_loss: 0.3593, weighted_loss: 0.2202, label: 1, bag_size: 4192
batch 619, loss: 0.7094, instance_loss: 0.4113, weighted_loss: 0.6199, label: 2, bag_size: 705
batch 639, loss: 0.0688, instance_loss: 0.2778, weighted_loss: 0.1315, label: 1, bag_size: 4253
batch 659, loss: 0.1001, instance_loss: 0.3368, weighted_loss: 0.1711, label: 1, bag_size: 2945
batch 679, loss: 0.7030, instance_loss: 0.6552, weighted_loss: 0.6886, label: 1, bag_size: 4395
batch 699, loss: 1.5717, instance_loss: 0.8942, weighted_loss: 1.3685, label: 0, bag_size: 893
batch 719, loss: 0.1174, instance_loss: 0.4177, weighted_loss: 0.2075, label: 2, bag_size: 4497
batch 739, loss: 0.6081, instance_loss: 0.6049, weighted_loss: 0.6072, label: 1, bag_size: 2156


class 0 clustering acc 0.9746644295302014: correct 17427/17880
class 1 clustering acc 0.2557046979865772: correct 1524/5960
Epoch: 20, train_loss: 0.6578, train_clustering_loss:  0.5931, train_error: 0.2859
class 0: acc 0.7207207207207207, correct 160/222
class 1: acc 0.631578947368421, correct 168/266
class 2: acc 0.7937743190661478, correct 204/257

Val Set, val_loss: 0.8334, val_error: 0.3936, auc: 0.8716
class 0 clustering acc 0.987145390070922: correct 2227/2256
class 1 clustering acc 0.10106382978723404: correct 76/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 3.1456, instance_loss: 1.1304, weighted_loss: 2.5411, label: 1, bag_size: 12936
batch 39, loss: 0.5278, instance_loss: 0.4377, weighted_loss: 0.5007, label: 2, bag_size: 3397
batch 59, loss: 0.0922, instance_loss: 0.4549, weighted_loss: 0.2010, label: 2, bag_size: 3607
batch 79, loss: 1.1461, instance_loss: 0.7384, weighted_loss: 1.0238, label: 0, bag_size: 3675
batch 99, loss: 0.1924, instance_loss: 0.4751, weighted_loss: 0.2772, label: 0, bag_size: 3038
batch 119, loss: 3.0856, instance_loss: 1.0750, weighted_loss: 2.4824, label: 1, bag_size: 32
batch 139, loss: 0.3023, instance_loss: 0.4925, weighted_loss: 0.3594, label: 1, bag_size: 3109
batch 159, loss: 1.5552, instance_loss: 1.0170, weighted_loss: 1.3937, label: 0, bag_size: 1753
batch 179, loss: 0.1213, instance_loss: 0.2202, weighted_loss: 0.1510, label: 2, bag_size: 4691
batch 199, loss: 0.1947, instance_loss: 0.4363, weighted_loss: 0.2672, label: 2, bag_size: 4132
batch 219, loss: 1.0046, instance_loss: 0.8190, weighted_loss: 0.9489, label: 2, bag_size: 1222
batch 239, loss: 0.2923, instance_loss: 0.4480, weighted_loss: 0.3390, label: 0, bag_size: 3833
batch 259, loss: 0.5129, instance_loss: 0.3012, weighted_loss: 0.4494, label: 2, bag_size: 3172
batch 279, loss: 0.1554, instance_loss: 0.5273, weighted_loss: 0.2669, label: 0, bag_size: 3408
batch 299, loss: 1.4270, instance_loss: 1.2377, weighted_loss: 1.3702, label: 1, bag_size: 6717
batch 319, loss: 3.4015, instance_loss: 1.7681, weighted_loss: 2.9115, label: 0, bag_size: 12971
batch 339, loss: 0.0330, instance_loss: 0.4052, weighted_loss: 0.1447, label: 1, bag_size: 5084
batch 359, loss: 3.7578, instance_loss: 1.2088, weighted_loss: 2.9931, label: 0, bag_size: 557
batch 379, loss: 0.5315, instance_loss: 0.7641, weighted_loss: 0.6013, label: 1, bag_size: 1023
batch 399, loss: 0.1720, instance_loss: 0.2879, weighted_loss: 0.2067, label: 0, bag_size: 4105
batch 419, loss: 0.0181, instance_loss: 0.1384, weighted_loss: 0.0542, label: 2, bag_size: 4088
batch 439, loss: 0.7390, instance_loss: 0.7797, weighted_loss: 0.7512, label: 1, bag_size: 3475
batch 459, loss: 0.3264, instance_loss: 0.4963, weighted_loss: 0.3774, label: 0, bag_size: 966
batch 479, loss: 0.7580, instance_loss: 0.6553, weighted_loss: 0.7272, label: 0, bag_size: 3924
batch 499, loss: 0.6468, instance_loss: 0.6070, weighted_loss: 0.6349, label: 0, bag_size: 272
batch 519, loss: 0.3692, instance_loss: 0.3342, weighted_loss: 0.3587, label: 2, bag_size: 2905
batch 539, loss: 0.0206, instance_loss: 0.0842, weighted_loss: 0.0397, label: 2, bag_size: 3415
batch 559, loss: 1.7307, instance_loss: 0.7654, weighted_loss: 1.4411, label: 2, bag_size: 5307
batch 579, loss: 0.0006, instance_loss: 0.1306, weighted_loss: 0.0396, label: 2, bag_size: 4203
batch 599, loss: 0.6133, instance_loss: 0.5774, weighted_loss: 0.6025, label: 0, bag_size: 6223
batch 619, loss: 0.4935, instance_loss: 0.1544, weighted_loss: 0.3917, label: 2, bag_size: 2561
batch 639, loss: 3.0538, instance_loss: 1.7118, weighted_loss: 2.6512, label: 0, bag_size: 1886
batch 659, loss: 0.1801, instance_loss: 0.1332, weighted_loss: 0.1660, label: 0, bag_size: 3793
batch 679, loss: 0.6321, instance_loss: 0.3540, weighted_loss: 0.5487, label: 2, bag_size: 5426
batch 699, loss: 0.3927, instance_loss: 0.3285, weighted_loss: 0.3735, label: 2, bag_size: 3176
batch 719, loss: 0.7315, instance_loss: 0.8501, weighted_loss: 0.7670, label: 1, bag_size: 3322
batch 739, loss: 0.6705, instance_loss: 0.6925, weighted_loss: 0.6771, label: 1, bag_size: 302


class 0 clustering acc 0.9685123042505592: correct 17317/17880
class 1 clustering acc 0.3640939597315436: correct 2170/5960
Epoch: 21, train_loss: 0.5984, train_clustering_loss:  0.5562, train_error: 0.2523
class 0: acc 0.7837837837837838, correct 203/259
class 1: acc 0.6398305084745762, correct 151/236
class 2: acc 0.812, correct 203/250

Val Set, val_loss: 0.5514, val_error: 0.2234, auc: 0.9114
class 0 clustering acc 0.9902482269503546: correct 2234/2256
class 1 clustering acc 0.18617021276595744: correct 140/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.554405 --> 0.551362).  Saving model ...


batch 19, loss: 0.1464, instance_loss: 0.2571, weighted_loss: 0.1796, label: 2, bag_size: 3299
batch 39, loss: 0.5475, instance_loss: 0.5312, weighted_loss: 0.5426, label: 2, bag_size: 4291
batch 59, loss: 1.3593, instance_loss: 0.3242, weighted_loss: 1.0488, label: 2, bag_size: 3583
batch 79, loss: 0.0656, instance_loss: 0.2392, weighted_loss: 0.1177, label: 0, bag_size: 5831
batch 99, loss: 0.4654, instance_loss: 0.5448, weighted_loss: 0.4893, label: 1, bag_size: 3460
batch 119, loss: 0.0033, instance_loss: 0.3888, weighted_loss: 0.1190, label: 0, bag_size: 1645
batch 139, loss: 0.0028, instance_loss: 0.2486, weighted_loss: 0.0765, label: 0, bag_size: 1744
batch 159, loss: 0.0745, instance_loss: 0.3657, weighted_loss: 0.1619, label: 0, bag_size: 4721
batch 179, loss: 2.4545, instance_loss: 1.2307, weighted_loss: 2.0874, label: 2, bag_size: 2326
batch 199, loss: 0.5455, instance_loss: 0.6933, weighted_loss: 0.5898, label: 2, bag_size: 5472
batch 219, loss: 0.8048, instance_loss: 0.5316, weighted_loss: 0.7228, label: 0, bag_size: 2190
batch 239, loss: 0.0759, instance_loss: 0.0880, weighted_loss: 0.0795, label: 2, bag_size: 2905
batch 259, loss: 1.3411, instance_loss: 0.6007, weighted_loss: 1.1190, label: 0, bag_size: 4145
batch 279, loss: 0.1093, instance_loss: 0.2377, weighted_loss: 0.1478, label: 1, bag_size: 7135
batch 299, loss: 0.4701, instance_loss: 0.6742, weighted_loss: 0.5313, label: 2, bag_size: 3174
batch 319, loss: 0.2414, instance_loss: 0.3903, weighted_loss: 0.2861, label: 0, bag_size: 4105
batch 339, loss: 0.0183, instance_loss: 0.2931, weighted_loss: 0.1007, label: 0, bag_size: 921
batch 359, loss: 1.8792, instance_loss: 0.9494, weighted_loss: 1.6003, label: 0, bag_size: 20234
batch 379, loss: 0.1634, instance_loss: 0.3344, weighted_loss: 0.2147, label: 0, bag_size: 1812
batch 399, loss: 0.0102, instance_loss: 0.2884, weighted_loss: 0.0937, label: 0, bag_size: 4326
batch 419, loss: 0.2368, instance_loss: 0.2837, weighted_loss: 0.2508, label: 0, bag_size: 3690
batch 439, loss: 1.6277, instance_loss: 1.0655, weighted_loss: 1.4590, label: 2, bag_size: 4179
batch 459, loss: 0.5964, instance_loss: 0.6504, weighted_loss: 0.6126, label: 2, bag_size: 2486
batch 479, loss: 0.2574, instance_loss: 0.5649, weighted_loss: 0.3496, label: 0, bag_size: 6285
batch 499, loss: 1.2081, instance_loss: 1.1298, weighted_loss: 1.1847, label: 1, bag_size: 11768
batch 519, loss: 0.3411, instance_loss: 0.4293, weighted_loss: 0.3675, label: 2, bag_size: 3174
batch 539, loss: 0.2766, instance_loss: 0.5227, weighted_loss: 0.3505, label: 0, bag_size: 6285
batch 559, loss: 0.4262, instance_loss: 0.3474, weighted_loss: 0.4026, label: 2, bag_size: 2905
batch 579, loss: 0.0872, instance_loss: 0.2111, weighted_loss: 0.1244, label: 2, bag_size: 4775
batch 599, loss: 0.7182, instance_loss: 0.6258, weighted_loss: 0.6905, label: 0, bag_size: 4416
batch 619, loss: 0.6276, instance_loss: 0.6665, weighted_loss: 0.6393, label: 1, bag_size: 667
batch 639, loss: 0.2211, instance_loss: 0.6617, weighted_loss: 0.3533, label: 1, bag_size: 782
batch 659, loss: 0.5552, instance_loss: 0.5860, weighted_loss: 0.5645, label: 1, bag_size: 3403
batch 679, loss: 0.1316, instance_loss: 0.4016, weighted_loss: 0.2126, label: 0, bag_size: 4734
batch 699, loss: 0.0762, instance_loss: 0.4664, weighted_loss: 0.1933, label: 0, bag_size: 5899
batch 719, loss: 0.0481, instance_loss: 0.3762, weighted_loss: 0.1465, label: 0, bag_size: 1174
batch 739, loss: 0.0410, instance_loss: 0.0660, weighted_loss: 0.0485, label: 2, bag_size: 2997


class 0 clustering acc 0.9713646532438479: correct 17368/17880
class 1 clustering acc 0.3125838926174497: correct 1863/5960
Epoch: 22, train_loss: 0.6431, train_clustering_loss:  0.5714, train_error: 0.2792
class 0: acc 0.752, correct 188/250
class 1: acc 0.6516393442622951, correct 159/244
class 2: acc 0.7569721115537849, correct 190/251

Val Set, val_loss: 0.7340, val_error: 0.2979, auc: 0.8659
class 0 clustering acc 0.9747340425531915: correct 2199/2256
class 1 clustering acc 0.11170212765957446: correct 84/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1340, instance_loss: 0.2844, weighted_loss: 0.1791, label: 2, bag_size: 2770
batch 39, loss: 0.4069, instance_loss: 0.5584, weighted_loss: 0.4524, label: 0, bag_size: 999
batch 59, loss: 0.8360, instance_loss: 0.7254, weighted_loss: 0.8028, label: 0, bag_size: 14791
batch 79, loss: 0.0435, instance_loss: 0.1454, weighted_loss: 0.0741, label: 2, bag_size: 3327
batch 99, loss: 0.6808, instance_loss: 1.1361, weighted_loss: 0.8174, label: 1, bag_size: 20666
batch 119, loss: 0.1132, instance_loss: 0.1834, weighted_loss: 0.1342, label: 2, bag_size: 597
batch 139, loss: 0.3633, instance_loss: 0.4087, weighted_loss: 0.3769, label: 0, bag_size: 4228
batch 159, loss: 0.4460, instance_loss: 0.4525, weighted_loss: 0.4480, label: 1, bag_size: 712
batch 179, loss: 0.6941, instance_loss: 1.4015, weighted_loss: 0.9063, label: 0, bag_size: 1709
batch 199, loss: 0.1464, instance_loss: 0.3443, weighted_loss: 0.2057, label: 0, bag_size: 3443
batch 219, loss: 0.0545, instance_loss: 0.4744, weighted_loss: 0.1805, label: 1, bag_size: 3337
batch 239, loss: 0.1499, instance_loss: 0.4796, weighted_loss: 0.2488, label: 2, bag_size: 4555
batch 259, loss: 0.0789, instance_loss: 0.2027, weighted_loss: 0.1160, label: 0, bag_size: 1132
batch 279, loss: 0.0119, instance_loss: 0.1295, weighted_loss: 0.0472, label: 2, bag_size: 3176
batch 299, loss: 0.0326, instance_loss: 0.0629, weighted_loss: 0.0417, label: 2, bag_size: 3415
batch 319, loss: 1.2322, instance_loss: 0.7730, weighted_loss: 1.0944, label: 1, bag_size: 4200
batch 339, loss: 0.0258, instance_loss: 0.1282, weighted_loss: 0.0566, label: 0, bag_size: 1825
batch 359, loss: 0.2880, instance_loss: 0.6325, weighted_loss: 0.3914, label: 1, bag_size: 2919
batch 379, loss: 0.6408, instance_loss: 0.2990, weighted_loss: 0.5383, label: 2, bag_size: 3026
batch 399, loss: 0.2378, instance_loss: 0.2454, weighted_loss: 0.2401, label: 1, bag_size: 2254
batch 419, loss: 0.1107, instance_loss: 0.4488, weighted_loss: 0.2121, label: 1, bag_size: 3761
batch 439, loss: 0.5180, instance_loss: 0.6162, weighted_loss: 0.5475, label: 1, bag_size: 4395
batch 459, loss: 0.5386, instance_loss: 0.3944, weighted_loss: 0.4953, label: 0, bag_size: 3532
batch 479, loss: 0.1222, instance_loss: 0.3256, weighted_loss: 0.1832, label: 2, bag_size: 5011
batch 499, loss: 0.1807, instance_loss: 0.7099, weighted_loss: 0.3394, label: 1, bag_size: 5195
batch 519, loss: 1.4042, instance_loss: 0.8919, weighted_loss: 1.2505, label: 1, bag_size: 3596
batch 539, loss: 0.5107, instance_loss: 0.6432, weighted_loss: 0.5505, label: 1, bag_size: 3991
batch 559, loss: 2.3112, instance_loss: 0.9714, weighted_loss: 1.9092, label: 0, bag_size: 5023
batch 579, loss: 1.3490, instance_loss: 0.6406, weighted_loss: 1.1365, label: 2, bag_size: 4096
batch 599, loss: 1.0809, instance_loss: 0.5427, weighted_loss: 0.9195, label: 2, bag_size: 597
batch 619, loss: 3.0412, instance_loss: 1.2071, weighted_loss: 2.4909, label: 2, bag_size: 361
batch 639, loss: 0.0947, instance_loss: 0.2710, weighted_loss: 0.1476, label: 0, bag_size: 3443
batch 659, loss: 0.0012, instance_loss: 0.6142, weighted_loss: 0.1851, label: 0, bag_size: 1087
batch 679, loss: 1.0444, instance_loss: 0.6778, weighted_loss: 0.9344, label: 2, bag_size: 2326
batch 699, loss: 0.5195, instance_loss: 0.7307, weighted_loss: 0.5828, label: 1, bag_size: 5003
batch 719, loss: 0.0391, instance_loss: 0.1923, weighted_loss: 0.0850, label: 0, bag_size: 5038
batch 739, loss: 0.2774, instance_loss: 0.4966, weighted_loss: 0.3432, label: 2, bag_size: 4535


class 0 clustering acc 0.96834451901566: correct 17314/17880
class 1 clustering acc 0.36023489932885905: correct 2147/5960
Epoch: 23, train_loss: 0.5794, train_clustering_loss:  0.5569, train_error: 0.2322
class 0: acc 0.8250950570342205, correct 217/263
class 1: acc 0.6375545851528385, correct 146/229
class 2: acc 0.8260869565217391, correct 209/253

Val Set, val_loss: 0.6723, val_error: 0.3404, auc: 0.8925
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.15558510638297873: correct 117/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8989, instance_loss: 0.8656, weighted_loss: 0.8889, label: 1, bag_size: 1327
batch 39, loss: 0.0990, instance_loss: 0.4243, weighted_loss: 0.1966, label: 0, bag_size: 4274
batch 59, loss: 0.4184, instance_loss: 0.7158, weighted_loss: 0.5076, label: 0, bag_size: 5840
batch 79, loss: 1.2811, instance_loss: 0.8020, weighted_loss: 1.1374, label: 0, bag_size: 3397
batch 99, loss: 1.5032, instance_loss: 0.9569, weighted_loss: 1.3393, label: 0, bag_size: 3310
batch 119, loss: 0.1325, instance_loss: 0.3124, weighted_loss: 0.1865, label: 2, bag_size: 6644
batch 139, loss: 1.0206, instance_loss: 0.6129, weighted_loss: 0.8983, label: 0, bag_size: 4509
batch 159, loss: 0.0446, instance_loss: 0.3067, weighted_loss: 0.1233, label: 2, bag_size: 4497
batch 179, loss: 1.2093, instance_loss: 1.0707, weighted_loss: 1.1677, label: 1, bag_size: 936
batch 199, loss: 1.5369, instance_loss: 0.7037, weighted_loss: 1.2869, label: 1, bag_size: 1097
batch 219, loss: 0.1538, instance_loss: 0.2727, weighted_loss: 0.1894, label: 1, bag_size: 3109
batch 239, loss: 0.2329, instance_loss: 1.0093, weighted_loss: 0.4659, label: 0, bag_size: 3164
batch 259, loss: 0.2297, instance_loss: 0.2318, weighted_loss: 0.2303, label: 2, bag_size: 1103
batch 279, loss: 0.4623, instance_loss: 0.6441, weighted_loss: 0.5168, label: 2, bag_size: 3174
batch 299, loss: 0.0605, instance_loss: 0.1054, weighted_loss: 0.0740, label: 1, bag_size: 440
batch 319, loss: 0.4941, instance_loss: 0.7323, weighted_loss: 0.5656, label: 1, bag_size: 2919
batch 339, loss: 0.6046, instance_loss: 0.5730, weighted_loss: 0.5951, label: 1, bag_size: 1854
batch 359, loss: 0.6772, instance_loss: 0.5626, weighted_loss: 0.6428, label: 1, bag_size: 1854
batch 379, loss: 0.6301, instance_loss: 0.9826, weighted_loss: 0.7358, label: 2, bag_size: 4571
batch 399, loss: 0.8026, instance_loss: 0.4736, weighted_loss: 0.7039, label: 1, bag_size: 4262
batch 419, loss: 0.3008, instance_loss: 0.3953, weighted_loss: 0.3292, label: 1, bag_size: 2870
batch 439, loss: 0.0503, instance_loss: 0.2049, weighted_loss: 0.0967, label: 0, bag_size: 2290
batch 459, loss: 1.9530, instance_loss: 0.9140, weighted_loss: 1.6413, label: 2, bag_size: 7607
batch 479, loss: 1.0131, instance_loss: 0.7153, weighted_loss: 0.9238, label: 1, bag_size: 628
batch 499, loss: 0.1291, instance_loss: 0.4709, weighted_loss: 0.2317, label: 0, bag_size: 2852
batch 519, loss: 0.1280, instance_loss: 0.2610, weighted_loss: 0.1679, label: 1, bag_size: 596
batch 539, loss: 0.2202, instance_loss: 0.4880, weighted_loss: 0.3005, label: 1, bag_size: 3357
batch 559, loss: 0.5661, instance_loss: 0.9413, weighted_loss: 0.6786, label: 1, bag_size: 3497
batch 579, loss: 0.0817, instance_loss: 0.3960, weighted_loss: 0.1760, label: 0, bag_size: 4229
batch 599, loss: 0.8487, instance_loss: 0.4003, weighted_loss: 0.7142, label: 2, bag_size: 4241
batch 619, loss: 0.5320, instance_loss: 0.6160, weighted_loss: 0.5572, label: 0, bag_size: 5953
batch 639, loss: 0.3787, instance_loss: 0.4858, weighted_loss: 0.4109, label: 2, bag_size: 724
batch 659, loss: 0.0791, instance_loss: 0.3968, weighted_loss: 0.1744, label: 0, bag_size: 6440
batch 679, loss: 1.1337, instance_loss: 0.8205, weighted_loss: 1.0398, label: 1, bag_size: 3322
batch 699, loss: 1.7403, instance_loss: 0.9335, weighted_loss: 1.4983, label: 2, bag_size: 6594
batch 719, loss: 1.3272, instance_loss: 0.6811, weighted_loss: 1.1334, label: 0, bag_size: 3675
batch 739, loss: 0.3824, instance_loss: 0.7535, weighted_loss: 0.4937, label: 1, bag_size: 11768


class 0 clustering acc 0.9710290827740492: correct 17362/17880
class 1 clustering acc 0.3587248322147651: correct 2138/5960
Epoch: 24, train_loss: 0.5477, train_clustering_loss:  0.5447, train_error: 0.2362
class 0: acc 0.7787234042553192, correct 183/235
class 1: acc 0.7083333333333334, correct 187/264
class 2: acc 0.8089430894308943, correct 199/246

Val Set, val_loss: 0.6495, val_error: 0.2660, auc: 0.8633
class 0 clustering acc 0.9543439716312057: correct 2153/2256
class 1 clustering acc 0.40691489361702127: correct 306/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3802, instance_loss: 0.3597, weighted_loss: 0.3741, label: 0, bag_size: 2579
batch 39, loss: 0.5948, instance_loss: 0.8075, weighted_loss: 0.6586, label: 2, bag_size: 3299
batch 59, loss: 0.0300, instance_loss: 0.1160, weighted_loss: 0.0558, label: 2, bag_size: 3176
batch 79, loss: 0.0251, instance_loss: 0.1349, weighted_loss: 0.0580, label: 0, bag_size: 2791
batch 99, loss: 0.7397, instance_loss: 1.0043, weighted_loss: 0.8191, label: 2, bag_size: 22464
batch 119, loss: 1.4643, instance_loss: 0.8735, weighted_loss: 1.2870, label: 1, bag_size: 1313
batch 139, loss: 0.2172, instance_loss: 0.3899, weighted_loss: 0.2690, label: 0, bag_size: 2852
batch 159, loss: 1.4684, instance_loss: 0.7198, weighted_loss: 1.2439, label: 0, bag_size: 4032
batch 179, loss: 2.3060, instance_loss: 1.2559, weighted_loss: 1.9909, label: 1, bag_size: 1670
batch 199, loss: 0.0434, instance_loss: 0.2764, weighted_loss: 0.1133, label: 1, bag_size: 3333
batch 219, loss: 0.1861, instance_loss: 0.4046, weighted_loss: 0.2517, label: 2, bag_size: 4162
batch 239, loss: 0.3506, instance_loss: 0.5234, weighted_loss: 0.4024, label: 1, bag_size: 700
batch 259, loss: 0.3085, instance_loss: 0.4149, weighted_loss: 0.3404, label: 2, bag_size: 5138
batch 279, loss: 0.9109, instance_loss: 0.6854, weighted_loss: 0.8432, label: 1, bag_size: 5572
batch 299, loss: 0.1021, instance_loss: 0.2904, weighted_loss: 0.1586, label: 0, bag_size: 4760
batch 319, loss: 0.1903, instance_loss: 0.4893, weighted_loss: 0.2800, label: 0, bag_size: 4220
batch 339, loss: 0.0059, instance_loss: 0.0793, weighted_loss: 0.0279, label: 0, bag_size: 3438
batch 359, loss: 0.6582, instance_loss: 0.5261, weighted_loss: 0.6186, label: 0, bag_size: 1352
batch 379, loss: 0.0747, instance_loss: 0.1659, weighted_loss: 0.1020, label: 0, bag_size: 4855
batch 399, loss: 0.1642, instance_loss: 0.4233, weighted_loss: 0.2419, label: 0, bag_size: 5011
batch 419, loss: 0.0164, instance_loss: 0.4474, weighted_loss: 0.1457, label: 0, bag_size: 4458
batch 439, loss: 0.8244, instance_loss: 0.7715, weighted_loss: 0.8085, label: 1, bag_size: 4784
batch 459, loss: 0.1124, instance_loss: 0.3094, weighted_loss: 0.1715, label: 0, bag_size: 2705
batch 479, loss: 1.3317, instance_loss: 0.9163, weighted_loss: 1.2071, label: 0, bag_size: 4509
batch 499, loss: 0.5862, instance_loss: 0.6934, weighted_loss: 0.6184, label: 1, bag_size: 3050
batch 519, loss: 0.1128, instance_loss: 0.2607, weighted_loss: 0.1572, label: 0, bag_size: 1399
batch 539, loss: 0.7080, instance_loss: 0.6813, weighted_loss: 0.7000, label: 1, bag_size: 4395
batch 559, loss: 1.6944, instance_loss: 0.7212, weighted_loss: 1.4025, label: 0, bag_size: 6630
batch 579, loss: 1.2329, instance_loss: 0.8094, weighted_loss: 1.1059, label: 1, bag_size: 4612
batch 599, loss: 1.6648, instance_loss: 0.8482, weighted_loss: 1.4198, label: 2, bag_size: 3274
batch 619, loss: 0.0274, instance_loss: 0.3152, weighted_loss: 0.1138, label: 0, bag_size: 2705
batch 639, loss: 0.4217, instance_loss: 0.9058, weighted_loss: 0.5669, label: 1, bag_size: 2945
batch 659, loss: 1.0506, instance_loss: 0.7259, weighted_loss: 0.9532, label: 2, bag_size: 5743
batch 679, loss: 0.5782, instance_loss: 0.4529, weighted_loss: 0.5406, label: 1, bag_size: 5756
batch 699, loss: 0.0778, instance_loss: 0.2646, weighted_loss: 0.1338, label: 0, bag_size: 4455
batch 719, loss: 1.7124, instance_loss: 1.1690, weighted_loss: 1.5494, label: 1, bag_size: 3100
batch 739, loss: 1.8093, instance_loss: 1.3286, weighted_loss: 1.6651, label: 1, bag_size: 4940


class 0 clustering acc 0.9680648769574944: correct 17309/17880
class 1 clustering acc 0.38406040268456376: correct 2289/5960
Epoch: 25, train_loss: 0.5891, train_clustering_loss:  0.5450, train_error: 0.2389
class 0: acc 0.8106060606060606, correct 214/264
class 1: acc 0.64, correct 144/225
class 2: acc 0.81640625, correct 209/256

Val Set, val_loss: 0.5964, val_error: 0.2660, auc: 0.8984
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.38430851063829785: correct 289/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0250, instance_loss: 0.3071, weighted_loss: 0.1096, label: 0, bag_size: 7595
batch 39, loss: 0.3439, instance_loss: 0.6610, weighted_loss: 0.4391, label: 1, bag_size: 3986
batch 59, loss: 0.4958, instance_loss: 0.5391, weighted_loss: 0.5088, label: 0, bag_size: 4450
batch 79, loss: 0.0016, instance_loss: 0.0580, weighted_loss: 0.0186, label: 0, bag_size: 2306
batch 99, loss: 0.0301, instance_loss: 0.3549, weighted_loss: 0.1275, label: 0, bag_size: 1655
batch 119, loss: 0.1533, instance_loss: 0.3483, weighted_loss: 0.2118, label: 2, bag_size: 2770
batch 139, loss: 0.5498, instance_loss: 0.1650, weighted_loss: 0.4344, label: 2, bag_size: 2561
batch 159, loss: 1.2180, instance_loss: 0.9832, weighted_loss: 1.1475, label: 0, bag_size: 4460
batch 179, loss: 0.2126, instance_loss: 0.1701, weighted_loss: 0.1998, label: 2, bag_size: 4043
batch 199, loss: 0.8103, instance_loss: 0.7578, weighted_loss: 0.7945, label: 0, bag_size: 2501
batch 219, loss: 0.0633, instance_loss: 0.3068, weighted_loss: 0.1364, label: 2, bag_size: 2770
batch 239, loss: 0.1224, instance_loss: 0.2116, weighted_loss: 0.1492, label: 0, bag_size: 4092
batch 259, loss: 0.0680, instance_loss: 0.4217, weighted_loss: 0.1741, label: 1, bag_size: 3337
batch 279, loss: 0.5353, instance_loss: 0.5628, weighted_loss: 0.5436, label: 1, bag_size: 368
batch 299, loss: 0.4293, instance_loss: 0.2204, weighted_loss: 0.3667, label: 2, bag_size: 4569
batch 319, loss: 0.0231, instance_loss: 0.3736, weighted_loss: 0.1283, label: 2, bag_size: 5037
batch 339, loss: 0.9510, instance_loss: 0.7802, weighted_loss: 0.8998, label: 2, bag_size: 5472
batch 359, loss: 1.1174, instance_loss: 0.7158, weighted_loss: 0.9970, label: 2, bag_size: 5307
batch 379, loss: 0.0317, instance_loss: 0.1171, weighted_loss: 0.0573, label: 2, bag_size: 2481
batch 399, loss: 0.3406, instance_loss: 0.5546, weighted_loss: 0.4048, label: 2, bag_size: 4132
batch 419, loss: 0.1359, instance_loss: 0.4795, weighted_loss: 0.2390, label: 2, bag_size: 4162
batch 439, loss: 0.8981, instance_loss: 0.9201, weighted_loss: 0.9047, label: 1, bag_size: 2747
batch 459, loss: 2.5059, instance_loss: 1.1625, weighted_loss: 2.1028, label: 1, bag_size: 5035
batch 479, loss: 0.9452, instance_loss: 0.5081, weighted_loss: 0.8140, label: 0, bag_size: 4717
batch 499, loss: 0.0214, instance_loss: 0.2489, weighted_loss: 0.0896, label: 1, bag_size: 5229
batch 519, loss: 0.5986, instance_loss: 0.6381, weighted_loss: 0.6104, label: 2, bag_size: 4571
batch 539, loss: 0.0873, instance_loss: 0.7631, weighted_loss: 0.2901, label: 0, bag_size: 1981
batch 559, loss: 0.0128, instance_loss: 0.1340, weighted_loss: 0.0492, label: 1, bag_size: 5229
batch 579, loss: 0.2238, instance_loss: 0.6782, weighted_loss: 0.3601, label: 0, bag_size: 4544
batch 599, loss: 0.3535, instance_loss: 0.6762, weighted_loss: 0.4503, label: 1, bag_size: 3357
batch 619, loss: 1.8528, instance_loss: 1.4151, weighted_loss: 1.7215, label: 0, bag_size: 621
batch 639, loss: 1.6436, instance_loss: 1.0650, weighted_loss: 1.4700, label: 0, bag_size: 14791
batch 659, loss: 1.8131, instance_loss: 1.1760, weighted_loss: 1.6220, label: 1, bag_size: 4612
batch 679, loss: 1.4374, instance_loss: 1.5881, weighted_loss: 1.4826, label: 1, bag_size: 3016
batch 699, loss: 0.1635, instance_loss: 0.3021, weighted_loss: 0.2051, label: 2, bag_size: 6704
batch 719, loss: 0.4217, instance_loss: 0.4446, weighted_loss: 0.4286, label: 1, bag_size: 9099
batch 739, loss: 0.6367, instance_loss: 0.6378, weighted_loss: 0.6370, label: 1, bag_size: 4373


class 0 clustering acc 0.9695190156599552: correct 17335/17880
class 1 clustering acc 0.38808724832214764: correct 2313/5960
Epoch: 26, train_loss: 0.5409, train_clustering_loss:  0.5350, train_error: 0.2201
class 0: acc 0.7857142857142857, correct 198/252
class 1: acc 0.7248062015503876, correct 187/258
class 2: acc 0.8340425531914893, correct 196/235

Val Set, val_loss: 0.6551, val_error: 0.2872, auc: 0.8838
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.27925531914893614: correct 210/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1186, instance_loss: 0.2481, weighted_loss: 0.1574, label: 1, bag_size: 2945
batch 39, loss: 0.9242, instance_loss: 0.9064, weighted_loss: 0.9189, label: 1, bag_size: 7109
batch 59, loss: 0.1673, instance_loss: 0.3280, weighted_loss: 0.2155, label: 1, bag_size: 1221
batch 79, loss: 0.4596, instance_loss: 0.8662, weighted_loss: 0.5815, label: 0, bag_size: 7077
batch 99, loss: 2.2022, instance_loss: 1.0110, weighted_loss: 1.8448, label: 1, bag_size: 6241
batch 119, loss: 0.0958, instance_loss: 0.1535, weighted_loss: 0.1131, label: 2, bag_size: 3172
batch 139, loss: 0.1573, instance_loss: 0.5410, weighted_loss: 0.2724, label: 1, bag_size: 2182
batch 159, loss: 0.1828, instance_loss: 0.1983, weighted_loss: 0.1875, label: 2, bag_size: 3810
batch 179, loss: 0.0166, instance_loss: 0.5411, weighted_loss: 0.1739, label: 0, bag_size: 3539
batch 199, loss: 2.7484, instance_loss: 1.4082, weighted_loss: 2.3463, label: 2, bag_size: 4179
batch 219, loss: 0.2033, instance_loss: 0.2562, weighted_loss: 0.2192, label: 0, bag_size: 5526
batch 239, loss: 1.8802, instance_loss: 0.6685, weighted_loss: 1.5167, label: 0, bag_size: 5017
batch 259, loss: 0.4285, instance_loss: 0.4750, weighted_loss: 0.4424, label: 1, bag_size: 3127
batch 279, loss: 0.8054, instance_loss: 0.7592, weighted_loss: 0.7915, label: 2, bag_size: 7607
batch 299, loss: 0.0168, instance_loss: 0.2804, weighted_loss: 0.0959, label: 0, bag_size: 6182
batch 319, loss: 4.2032, instance_loss: 1.8772, weighted_loss: 3.5054, label: 1, bag_size: 1549
batch 339, loss: 1.8015, instance_loss: 0.8048, weighted_loss: 1.5025, label: 1, bag_size: 19265
batch 359, loss: 0.0003, instance_loss: 0.0514, weighted_loss: 0.0156, label: 1, bag_size: 3043
batch 379, loss: 0.0288, instance_loss: 0.1636, weighted_loss: 0.0692, label: 0, bag_size: 3530
batch 399, loss: 1.1095, instance_loss: 1.0095, weighted_loss: 1.0795, label: 0, bag_size: 5840
batch 419, loss: 0.7830, instance_loss: 0.6713, weighted_loss: 0.7495, label: 1, bag_size: 5118
batch 439, loss: 0.0561, instance_loss: 0.3629, weighted_loss: 0.1481, label: 0, bag_size: 5902
batch 459, loss: 0.0334, instance_loss: 0.3841, weighted_loss: 0.1386, label: 0, bag_size: 1245
batch 479, loss: 1.0176, instance_loss: 0.8688, weighted_loss: 0.9729, label: 1, bag_size: 4694
batch 499, loss: 0.3547, instance_loss: 0.4537, weighted_loss: 0.3844, label: 2, bag_size: 5011
batch 519, loss: 0.3832, instance_loss: 0.7077, weighted_loss: 0.4805, label: 1, bag_size: 4644
batch 539, loss: 0.2248, instance_loss: 0.5162, weighted_loss: 0.3122, label: 1, bag_size: 2643
batch 559, loss: 0.0609, instance_loss: 0.4111, weighted_loss: 0.1660, label: 0, bag_size: 6015
batch 579, loss: 1.6712, instance_loss: 1.6887, weighted_loss: 1.6765, label: 1, bag_size: 3016
batch 599, loss: 0.2109, instance_loss: 0.2167, weighted_loss: 0.2126, label: 2, bag_size: 6273
batch 619, loss: 2.7922, instance_loss: 1.1904, weighted_loss: 2.3117, label: 2, bag_size: 5307
batch 639, loss: 0.2216, instance_loss: 0.2307, weighted_loss: 0.2244, label: 2, bag_size: 4096
batch 659, loss: 0.0556, instance_loss: 0.1208, weighted_loss: 0.0752, label: 2, bag_size: 2481
batch 679, loss: 0.3469, instance_loss: 0.4039, weighted_loss: 0.3640, label: 0, bag_size: 5526
batch 699, loss: 0.2234, instance_loss: 0.4474, weighted_loss: 0.2906, label: 1, bag_size: 596
batch 719, loss: 0.3247, instance_loss: 0.5641, weighted_loss: 0.3965, label: 1, bag_size: 2921
batch 739, loss: 1.9322, instance_loss: 1.1556, weighted_loss: 1.6993, label: 1, bag_size: 1307


class 0 clustering acc 0.966834451901566: correct 17287/17880
class 1 clustering acc 0.3436241610738255: correct 2048/5960
Epoch: 27, train_loss: 0.5675, train_clustering_loss:  0.5555, train_error: 0.2309
class 0: acc 0.7918367346938775, correct 194/245
class 1: acc 0.7338403041825095, correct 193/263
class 2: acc 0.7848101265822784, correct 186/237

Val Set, val_loss: 0.7549, val_error: 0.3085, auc: 0.8810
class 0 clustering acc 0.9849290780141844: correct 2222/2256
class 1 clustering acc 0.14893617021276595: correct 112/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0886, instance_loss: 0.3297, weighted_loss: 0.1609, label: 1, bag_size: 10941
batch 39, loss: 0.0667, instance_loss: 0.2517, weighted_loss: 0.1222, label: 0, bag_size: 4071
batch 59, loss: 0.0060, instance_loss: 0.1777, weighted_loss: 0.0575, label: 1, bag_size: 1836
batch 79, loss: 0.3953, instance_loss: 0.2095, weighted_loss: 0.3395, label: 2, bag_size: 3026
batch 99, loss: 0.0313, instance_loss: 0.0596, weighted_loss: 0.0398, label: 2, bag_size: 2313
batch 119, loss: 0.7030, instance_loss: 0.3716, weighted_loss: 0.6036, label: 2, bag_size: 5426
batch 139, loss: 1.7976, instance_loss: 0.8987, weighted_loss: 1.5279, label: 0, bag_size: 1025
batch 159, loss: 0.1034, instance_loss: 0.4930, weighted_loss: 0.2203, label: 2, bag_size: 4497
batch 179, loss: 0.5123, instance_loss: 0.8442, weighted_loss: 0.6119, label: 1, bag_size: 2905
batch 199, loss: 0.8332, instance_loss: 0.4301, weighted_loss: 0.7122, label: 2, bag_size: 5307
batch 219, loss: 0.0029, instance_loss: 0.3655, weighted_loss: 0.1117, label: 1, bag_size: 4111
batch 239, loss: 0.0828, instance_loss: 0.5207, weighted_loss: 0.2142, label: 1, bag_size: 5195
batch 259, loss: 0.1508, instance_loss: 0.3604, weighted_loss: 0.2137, label: 0, bag_size: 2897
batch 279, loss: 0.2089, instance_loss: 0.5182, weighted_loss: 0.3017, label: 2, bag_size: 4162
batch 299, loss: 0.0052, instance_loss: 0.4720, weighted_loss: 0.1452, label: 0, bag_size: 4458
batch 319, loss: 0.0431, instance_loss: 0.3705, weighted_loss: 0.1413, label: 2, bag_size: 4140
batch 339, loss: 0.0850, instance_loss: 0.2730, weighted_loss: 0.1414, label: 0, bag_size: 4831
batch 359, loss: 0.7067, instance_loss: 0.7695, weighted_loss: 0.7255, label: 2, bag_size: 4571
batch 379, loss: 1.2622, instance_loss: 1.0038, weighted_loss: 1.1846, label: 1, bag_size: 936
batch 399, loss: 0.3182, instance_loss: 0.8716, weighted_loss: 0.4842, label: 0, bag_size: 889
batch 419, loss: 0.6041, instance_loss: 0.6027, weighted_loss: 0.6037, label: 1, bag_size: 3497
batch 439, loss: 0.0030, instance_loss: 0.2120, weighted_loss: 0.0657, label: 2, bag_size: 5037
batch 459, loss: 0.0080, instance_loss: 0.2210, weighted_loss: 0.0719, label: 0, bag_size: 4570
batch 479, loss: 0.0574, instance_loss: 0.2880, weighted_loss: 0.1266, label: 1, bag_size: 1836
batch 499, loss: 0.1445, instance_loss: 0.5210, weighted_loss: 0.2575, label: 1, bag_size: 862
batch 519, loss: 0.0871, instance_loss: 0.1646, weighted_loss: 0.1104, label: 0, bag_size: 4131
batch 539, loss: 0.2063, instance_loss: 0.1238, weighted_loss: 0.1816, label: 2, bag_size: 2561
batch 559, loss: 0.1700, instance_loss: 0.4152, weighted_loss: 0.2436, label: 2, bag_size: 3327
batch 579, loss: 1.6539, instance_loss: 0.9165, weighted_loss: 1.4327, label: 0, bag_size: 5017
batch 599, loss: 0.9190, instance_loss: 0.4725, weighted_loss: 0.7850, label: 2, bag_size: 597
batch 619, loss: 0.1972, instance_loss: 0.1753, weighted_loss: 0.1906, label: 2, bag_size: 3210
batch 639, loss: 0.3013, instance_loss: 0.3827, weighted_loss: 0.3258, label: 2, bag_size: 3397
batch 659, loss: 0.0548, instance_loss: 0.3198, weighted_loss: 0.1343, label: 2, bag_size: 2770
batch 679, loss: 0.8171, instance_loss: 0.3927, weighted_loss: 0.6898, label: 2, bag_size: 597
batch 699, loss: 0.0413, instance_loss: 0.2834, weighted_loss: 0.1139, label: 1, bag_size: 3337
batch 719, loss: 0.0498, instance_loss: 0.2807, weighted_loss: 0.1191, label: 0, bag_size: 5823
batch 739, loss: 0.4182, instance_loss: 0.1986, weighted_loss: 0.3523, label: 2, bag_size: 4788


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.39177852348993286: correct 2335/5960
Epoch: 28, train_loss: 0.5413, train_clustering_loss:  0.5396, train_error: 0.2349
class 0: acc 0.7834645669291339, correct 199/254
class 1: acc 0.6696428571428571, correct 150/224
class 2: acc 0.8277153558052435, correct 221/267

Val Set, val_loss: 0.8234, val_error: 0.3298, auc: 0.8637
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.21143617021276595: correct 159/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1042, instance_loss: 0.1822, weighted_loss: 0.1276, label: 1, bag_size: 700
batch 39, loss: 0.1809, instance_loss: 0.5123, weighted_loss: 0.2803, label: 0, bag_size: 272
batch 59, loss: 0.0420, instance_loss: 0.4047, weighted_loss: 0.1508, label: 2, bag_size: 5017
batch 79, loss: 0.2225, instance_loss: 0.4436, weighted_loss: 0.2888, label: 1, bag_size: 9099
batch 99, loss: 0.1331, instance_loss: 0.4617, weighted_loss: 0.2317, label: 0, bag_size: 3690
batch 119, loss: 0.6393, instance_loss: 0.6241, weighted_loss: 0.6348, label: 0, bag_size: 8611
batch 139, loss: 1.2489, instance_loss: 1.0723, weighted_loss: 1.1960, label: 2, bag_size: 4342
batch 159, loss: 0.9896, instance_loss: 1.1638, weighted_loss: 1.0419, label: 1, bag_size: 3422
batch 179, loss: 0.0277, instance_loss: 0.0860, weighted_loss: 0.0452, label: 2, bag_size: 2313
batch 199, loss: 1.6098, instance_loss: 0.8649, weighted_loss: 1.3864, label: 2, bag_size: 5307
batch 219, loss: 0.3216, instance_loss: 0.9803, weighted_loss: 0.5192, label: 1, bag_size: 3051
batch 239, loss: 0.0249, instance_loss: 0.0660, weighted_loss: 0.0372, label: 2, bag_size: 2770
batch 259, loss: 0.0215, instance_loss: 0.2863, weighted_loss: 0.1009, label: 0, bag_size: 5899
batch 279, loss: 0.0258, instance_loss: 0.2814, weighted_loss: 0.1025, label: 0, bag_size: 5236
batch 299, loss: 0.7462, instance_loss: 0.7101, weighted_loss: 0.7354, label: 1, bag_size: 3935
batch 319, loss: 0.3785, instance_loss: 0.5247, weighted_loss: 0.4224, label: 0, bag_size: 5953
batch 339, loss: 1.4530, instance_loss: 0.8791, weighted_loss: 1.2808, label: 2, bag_size: 223
batch 359, loss: 0.1066, instance_loss: 0.6185, weighted_loss: 0.2602, label: 1, bag_size: 5385
batch 379, loss: 0.2169, instance_loss: 0.2397, weighted_loss: 0.2238, label: 2, bag_size: 2481
batch 399, loss: 1.1503, instance_loss: 0.8057, weighted_loss: 1.0469, label: 1, bag_size: 5880
batch 419, loss: 0.1048, instance_loss: 0.9322, weighted_loss: 0.3530, label: 0, bag_size: 4147
batch 439, loss: 0.2920, instance_loss: 0.3911, weighted_loss: 0.3218, label: 0, bag_size: 1018
batch 459, loss: 0.2535, instance_loss: 0.3718, weighted_loss: 0.2890, label: 2, bag_size: 3174
batch 479, loss: 0.2947, instance_loss: 0.3710, weighted_loss: 0.3176, label: 0, bag_size: 8866
batch 499, loss: 0.7942, instance_loss: 0.6069, weighted_loss: 0.7380, label: 1, bag_size: 4262
batch 519, loss: 0.3156, instance_loss: 0.4812, weighted_loss: 0.3653, label: 0, bag_size: 1944
batch 539, loss: 0.1860, instance_loss: 0.4353, weighted_loss: 0.2608, label: 1, bag_size: 2753
batch 559, loss: 1.0629, instance_loss: 0.8743, weighted_loss: 1.0063, label: 2, bag_size: 5743
batch 579, loss: 1.0514, instance_loss: 0.9136, weighted_loss: 1.0101, label: 2, bag_size: 7607
batch 599, loss: 0.3769, instance_loss: 0.4544, weighted_loss: 0.4001, label: 1, bag_size: 3391
batch 619, loss: 0.1411, instance_loss: 0.8358, weighted_loss: 0.3495, label: 0, bag_size: 3694
batch 639, loss: 1.2030, instance_loss: 0.6822, weighted_loss: 1.0467, label: 0, bag_size: 4245
batch 659, loss: 0.0961, instance_loss: 0.2252, weighted_loss: 0.1348, label: 2, bag_size: 3778
batch 679, loss: 0.2708, instance_loss: 0.4447, weighted_loss: 0.3230, label: 2, bag_size: 4978
batch 699, loss: 0.0587, instance_loss: 0.2008, weighted_loss: 0.1013, label: 2, bag_size: 2997
batch 719, loss: 0.0746, instance_loss: 0.3357, weighted_loss: 0.1529, label: 1, bag_size: 683
batch 739, loss: 1.5046, instance_loss: 1.0139, weighted_loss: 1.3574, label: 2, bag_size: 1222


class 0 clustering acc 0.9639821029082773: correct 17236/17880
class 1 clustering acc 0.39546979865771814: correct 2357/5960
Epoch: 29, train_loss: 0.5394, train_clustering_loss:  0.5426, train_error: 0.2134
class 0: acc 0.7654320987654321, correct 186/243
class 1: acc 0.7154150197628458, correct 181/253
class 2: acc 0.8795180722891566, correct 219/249

Val Set, val_loss: 0.5690, val_error: 0.2660, auc: 0.9027
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.3058510638297872: correct 230/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0734, instance_loss: 0.3552, weighted_loss: 0.1579, label: 2, bag_size: 6594
batch 39, loss: 0.3161, instance_loss: 0.4275, weighted_loss: 0.3495, label: 1, bag_size: 2731
batch 59, loss: 0.1414, instance_loss: 0.2793, weighted_loss: 0.1828, label: 2, bag_size: 4302
batch 79, loss: 0.0170, instance_loss: 0.0906, weighted_loss: 0.0391, label: 0, bag_size: 3530
batch 99, loss: 0.4232, instance_loss: 0.5776, weighted_loss: 0.4695, label: 1, bag_size: 3746
batch 119, loss: 0.1166, instance_loss: 0.2460, weighted_loss: 0.1554, label: 2, bag_size: 3778
batch 139, loss: 0.6933, instance_loss: 0.5238, weighted_loss: 0.6424, label: 1, bag_size: 628
batch 159, loss: 0.0091, instance_loss: 0.1213, weighted_loss: 0.0427, label: 0, bag_size: 5003
batch 179, loss: 0.7115, instance_loss: 0.7081, weighted_loss: 0.7105, label: 1, bag_size: 3396
batch 199, loss: 0.0568, instance_loss: 0.1711, weighted_loss: 0.0911, label: 2, bag_size: 4775
batch 219, loss: 0.0651, instance_loss: 0.0840, weighted_loss: 0.0708, label: 0, bag_size: 4312
batch 239, loss: 0.2376, instance_loss: 0.4707, weighted_loss: 0.3075, label: 1, bag_size: 3425
batch 259, loss: 0.0787, instance_loss: 0.4106, weighted_loss: 0.1783, label: 0, bag_size: 4922
batch 279, loss: 0.0979, instance_loss: 0.2589, weighted_loss: 0.1462, label: 2, bag_size: 4302
batch 299, loss: 0.5297, instance_loss: 0.5500, weighted_loss: 0.5358, label: 2, bag_size: 3618
batch 319, loss: 0.7432, instance_loss: 0.7730, weighted_loss: 0.7521, label: 0, bag_size: 1944
batch 339, loss: 0.1708, instance_loss: 0.5909, weighted_loss: 0.2968, label: 0, bag_size: 2306
batch 359, loss: 2.5325, instance_loss: 1.3260, weighted_loss: 2.1706, label: 1, bag_size: 3791
batch 379, loss: 0.5154, instance_loss: 0.2651, weighted_loss: 0.4403, label: 2, bag_size: 4043
batch 399, loss: 0.2741, instance_loss: 0.5924, weighted_loss: 0.3696, label: 0, bag_size: 2038
batch 419, loss: 0.1168, instance_loss: 0.5532, weighted_loss: 0.2477, label: 0, bag_size: 6285
batch 439, loss: 1.1132, instance_loss: 1.0036, weighted_loss: 1.0803, label: 0, bag_size: 4032
batch 459, loss: 2.0085, instance_loss: 1.4062, weighted_loss: 1.8278, label: 0, bag_size: 4032
batch 479, loss: 1.1608, instance_loss: 0.9633, weighted_loss: 1.1015, label: 0, bag_size: 3475
batch 499, loss: 0.0623, instance_loss: 0.5302, weighted_loss: 0.2026, label: 0, bag_size: 5170
batch 519, loss: 0.0989, instance_loss: 0.1609, weighted_loss: 0.1175, label: 2, bag_size: 1094
batch 539, loss: 0.4797, instance_loss: 0.8375, weighted_loss: 0.5870, label: 0, bag_size: 3648
batch 559, loss: 0.3147, instance_loss: 0.6030, weighted_loss: 0.4012, label: 1, bag_size: 3357
batch 579, loss: 0.3943, instance_loss: 0.6498, weighted_loss: 0.4710, label: 0, bag_size: 2841
batch 599, loss: 0.1897, instance_loss: 0.3764, weighted_loss: 0.2457, label: 0, bag_size: 4794
batch 619, loss: 0.0770, instance_loss: 0.1431, weighted_loss: 0.0969, label: 2, bag_size: 2481
batch 639, loss: 0.0274, instance_loss: 0.0735, weighted_loss: 0.0412, label: 0, bag_size: 1845
batch 659, loss: 0.0002, instance_loss: 0.2905, weighted_loss: 0.0873, label: 0, bag_size: 3445
batch 679, loss: 0.0751, instance_loss: 0.5328, weighted_loss: 0.2124, label: 1, bag_size: 2643
batch 699, loss: 0.4864, instance_loss: 0.3352, weighted_loss: 0.4410, label: 0, bag_size: 5036
batch 719, loss: 1.8442, instance_loss: 0.9985, weighted_loss: 1.5905, label: 2, bag_size: 2326
batch 739, loss: 0.2970, instance_loss: 0.6511, weighted_loss: 0.4032, label: 1, bag_size: 2731


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.3813758389261745: correct 2273/5960
Epoch: 30, train_loss: 0.5681, train_clustering_loss:  0.5376, train_error: 0.2349
class 0: acc 0.803088803088803, correct 208/259
class 1: acc 0.7004048582995951, correct 173/247
class 2: acc 0.7907949790794979, correct 189/239

Val Set, val_loss: 0.6446, val_error: 0.2872, auc: 0.8821
class 0 clustering acc 0.9330673758865248: correct 2105/2256
class 1 clustering acc 0.5093085106382979: correct 383/752
class 0: acc 0.9423076923076923, correct 49/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1269, instance_loss: 0.2113, weighted_loss: 0.1522, label: 2, bag_size: 2209
batch 39, loss: 0.4766, instance_loss: 0.3186, weighted_loss: 0.4292, label: 2, bag_size: 4569
batch 59, loss: 1.0428, instance_loss: 0.1867, weighted_loss: 0.7860, label: 2, bag_size: 2561
batch 79, loss: 0.0061, instance_loss: 0.1368, weighted_loss: 0.0453, label: 0, bag_size: 6797
batch 99, loss: 0.6846, instance_loss: 0.8094, weighted_loss: 0.7220, label: 2, bag_size: 4342
batch 119, loss: 0.3944, instance_loss: 0.2402, weighted_loss: 0.3482, label: 2, bag_size: 597
batch 139, loss: 0.0000, instance_loss: 0.1758, weighted_loss: 0.0527, label: 0, bag_size: 3445
batch 159, loss: 0.5305, instance_loss: 0.3368, weighted_loss: 0.4724, label: 2, bag_size: 4569
batch 179, loss: 0.6545, instance_loss: 0.6059, weighted_loss: 0.6399, label: 1, bag_size: 10399
batch 199, loss: 0.4157, instance_loss: 0.5719, weighted_loss: 0.4625, label: 1, bag_size: 2122
batch 219, loss: 0.4411, instance_loss: 0.6019, weighted_loss: 0.4894, label: 1, bag_size: 3475
batch 239, loss: 0.1018, instance_loss: 0.1275, weighted_loss: 0.1095, label: 2, bag_size: 2905
batch 259, loss: 0.2563, instance_loss: 0.6253, weighted_loss: 0.3670, label: 1, bag_size: 3475
batch 279, loss: 0.6386, instance_loss: 0.5249, weighted_loss: 0.6045, label: 1, bag_size: 4812
batch 299, loss: 1.8205, instance_loss: 1.9053, weighted_loss: 1.8460, label: 1, bag_size: 5205
batch 319, loss: 0.1530, instance_loss: 0.2039, weighted_loss: 0.1682, label: 2, bag_size: 4372
batch 339, loss: 0.0453, instance_loss: 0.2242, weighted_loss: 0.0990, label: 0, bag_size: 2290
batch 359, loss: 0.0000, instance_loss: 0.0002, weighted_loss: 0.0001, label: 0, bag_size: 4918
batch 379, loss: 0.6183, instance_loss: 0.6680, weighted_loss: 0.6332, label: 1, bag_size: 1197
batch 399, loss: 0.0598, instance_loss: 0.2935, weighted_loss: 0.1299, label: 2, bag_size: 2770
batch 419, loss: 3.0808, instance_loss: 1.4175, weighted_loss: 2.5818, label: 0, bag_size: 4605
batch 439, loss: 1.3498, instance_loss: 1.0503, weighted_loss: 1.2599, label: 1, bag_size: 1327
batch 459, loss: 0.1700, instance_loss: 0.5543, weighted_loss: 0.2853, label: 0, bag_size: 4337
batch 479, loss: 0.8355, instance_loss: 1.4666, weighted_loss: 1.0248, label: 0, bag_size: 2069
batch 499, loss: 1.3503, instance_loss: 0.4758, weighted_loss: 1.0880, label: 1, bag_size: 3296
batch 519, loss: 0.0006, instance_loss: 0.9456, weighted_loss: 0.2841, label: 0, bag_size: 2618
batch 539, loss: 0.0121, instance_loss: 0.9515, weighted_loss: 0.2939, label: 1, bag_size: 2614
batch 559, loss: 0.5864, instance_loss: 0.6994, weighted_loss: 0.6203, label: 2, bag_size: 5743
batch 579, loss: 0.0054, instance_loss: 0.2235, weighted_loss: 0.0708, label: 1, bag_size: 1836
batch 599, loss: 0.1554, instance_loss: 0.3582, weighted_loss: 0.2162, label: 1, bag_size: 368
batch 619, loss: 0.6419, instance_loss: 0.7572, weighted_loss: 0.6765, label: 2, bag_size: 6594
batch 639, loss: 1.9548, instance_loss: 0.9298, weighted_loss: 1.6473, label: 0, bag_size: 22822
batch 659, loss: 0.3132, instance_loss: 0.3239, weighted_loss: 0.3164, label: 2, bag_size: 3396
batch 679, loss: 0.2458, instance_loss: 0.4683, weighted_loss: 0.3126, label: 1, bag_size: 3403
batch 699, loss: 0.7431, instance_loss: 0.9450, weighted_loss: 0.8037, label: 0, bag_size: 3408
batch 719, loss: 2.3697, instance_loss: 1.3895, weighted_loss: 2.0756, label: 0, bag_size: 4572
batch 739, loss: 0.0256, instance_loss: 0.2229, weighted_loss: 0.0848, label: 0, bag_size: 6765


class 0 clustering acc 0.9668903803131991: correct 17288/17880
class 1 clustering acc 0.36778523489932885: correct 2192/5960
Epoch: 31, train_loss: 0.5781, train_clustering_loss:  0.5555, train_error: 0.2483
class 0: acc 0.7748917748917749, correct 179/231
class 1: acc 0.7007575757575758, correct 185/264
class 2: acc 0.784, correct 196/250

Val Set, val_loss: 0.6140, val_error: 0.3191, auc: 0.8890
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.3537234042553192: correct 266/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0054, instance_loss: 0.0986, weighted_loss: 0.0333, label: 1, bag_size: 4181
batch 39, loss: 0.2219, instance_loss: 0.2349, weighted_loss: 0.2258, label: 2, bag_size: 3172
batch 59, loss: 0.1024, instance_loss: 0.2683, weighted_loss: 0.1522, label: 0, bag_size: 4251
batch 79, loss: 0.0809, instance_loss: 0.2265, weighted_loss: 0.1246, label: 1, bag_size: 7135
batch 99, loss: 0.1464, instance_loss: 0.5639, weighted_loss: 0.2717, label: 1, bag_size: 3558
batch 119, loss: 0.9756, instance_loss: 0.7707, weighted_loss: 0.9141, label: 1, bag_size: 3424
batch 139, loss: 0.2082, instance_loss: 0.2047, weighted_loss: 0.2072, label: 2, bag_size: 597
batch 159, loss: 1.5315, instance_loss: 0.8703, weighted_loss: 1.3331, label: 0, bag_size: 1071
batch 179, loss: 0.0254, instance_loss: 0.2469, weighted_loss: 0.0919, label: 0, bag_size: 4070
batch 199, loss: 0.7848, instance_loss: 0.8660, weighted_loss: 0.8092, label: 2, bag_size: 4571
batch 219, loss: 0.5076, instance_loss: 0.4971, weighted_loss: 0.5045, label: 0, bag_size: 5953
batch 239, loss: 0.1222, instance_loss: 0.1945, weighted_loss: 0.1439, label: 2, bag_size: 3210
batch 259, loss: 0.4252, instance_loss: 0.4477, weighted_loss: 0.4320, label: 0, bag_size: 5526
batch 279, loss: 0.0472, instance_loss: 0.2992, weighted_loss: 0.1228, label: 0, bag_size: 1495
batch 299, loss: 0.0875, instance_loss: 0.5303, weighted_loss: 0.2203, label: 0, bag_size: 4351
batch 319, loss: 0.0272, instance_loss: 0.1004, weighted_loss: 0.0492, label: 2, bag_size: 3415
batch 339, loss: 0.2437, instance_loss: 0.3829, weighted_loss: 0.2854, label: 0, bag_size: 4378
batch 359, loss: 0.0002, instance_loss: 0.1186, weighted_loss: 0.0357, label: 2, bag_size: 5037
batch 379, loss: 0.1137, instance_loss: 0.3755, weighted_loss: 0.1923, label: 1, bag_size: 3127
batch 399, loss: 3.6013, instance_loss: 2.2048, weighted_loss: 3.1823, label: 0, bag_size: 434
batch 419, loss: 0.4264, instance_loss: 0.4396, weighted_loss: 0.4304, label: 2, bag_size: 3396
batch 439, loss: 0.6877, instance_loss: 0.2896, weighted_loss: 0.5682, label: 2, bag_size: 2561
batch 459, loss: 0.0865, instance_loss: 0.3257, weighted_loss: 0.1583, label: 2, bag_size: 4096
batch 479, loss: 0.4984, instance_loss: 0.9337, weighted_loss: 0.6290, label: 1, bag_size: 3051
batch 499, loss: 0.0815, instance_loss: 0.3991, weighted_loss: 0.1768, label: 1, bag_size: 6243
batch 519, loss: 0.0767, instance_loss: 0.2081, weighted_loss: 0.1161, label: 2, bag_size: 4555
batch 539, loss: 0.0005, instance_loss: 0.3146, weighted_loss: 0.0948, label: 2, bag_size: 5017
batch 559, loss: 0.1082, instance_loss: 0.6739, weighted_loss: 0.2779, label: 0, bag_size: 1245
batch 579, loss: 2.4497, instance_loss: 1.4329, weighted_loss: 2.1446, label: 2, bag_size: 3299
batch 599, loss: 0.3840, instance_loss: 0.3391, weighted_loss: 0.3705, label: 0, bag_size: 4325
batch 619, loss: 0.3870, instance_loss: 0.4978, weighted_loss: 0.4202, label: 1, bag_size: 2182
batch 639, loss: 0.4468, instance_loss: 0.6187, weighted_loss: 0.4984, label: 1, bag_size: 2182
batch 659, loss: 0.6543, instance_loss: 0.3402, weighted_loss: 0.5601, label: 2, bag_size: 3227
batch 679, loss: 0.1864, instance_loss: 0.9902, weighted_loss: 0.4275, label: 0, bag_size: 2293
batch 699, loss: 0.1440, instance_loss: 0.1514, weighted_loss: 0.1462, label: 2, bag_size: 3026
batch 719, loss: 0.4535, instance_loss: 0.5603, weighted_loss: 0.4856, label: 1, bag_size: 582
batch 739, loss: 0.9821, instance_loss: 0.7982, weighted_loss: 0.9269, label: 1, bag_size: 3604


class 0 clustering acc 0.9720357941834452: correct 17380/17880
class 1 clustering acc 0.3795302013422819: correct 2262/5960
Epoch: 32, train_loss: 0.5425, train_clustering_loss:  0.5344, train_error: 0.2094
class 0: acc 0.8025210084033614, correct 191/238
class 1: acc 0.6860986547085202, correct 153/223
class 2: acc 0.8626760563380281, correct 245/284

Val Set, val_loss: 0.6634, val_error: 0.3191, auc: 0.8841
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.22739361702127658: correct 171/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3816, instance_loss: 0.5726, weighted_loss: 0.4389, label: 0, bag_size: 8866
batch 39, loss: 0.6523, instance_loss: 0.6955, weighted_loss: 0.6652, label: 1, bag_size: 3935
batch 59, loss: 0.2955, instance_loss: 0.3889, weighted_loss: 0.3235, label: 0, bag_size: 5526
batch 79, loss: 0.5068, instance_loss: 0.4866, weighted_loss: 0.5007, label: 2, bag_size: 614
batch 99, loss: 0.1040, instance_loss: 0.3570, weighted_loss: 0.1799, label: 0, bag_size: 1947
batch 119, loss: 0.2295, instance_loss: 0.6200, weighted_loss: 0.3467, label: 1, bag_size: 6156
batch 139, loss: 0.2739, instance_loss: 0.6340, weighted_loss: 0.3819, label: 0, bag_size: 1904
batch 159, loss: 0.6827, instance_loss: 0.6617, weighted_loss: 0.6764, label: 1, bag_size: 1066
batch 179, loss: 0.7879, instance_loss: 0.9514, weighted_loss: 0.8370, label: 1, bag_size: 6817
batch 199, loss: 0.5266, instance_loss: 0.8450, weighted_loss: 0.6221, label: 1, bag_size: 2905
batch 219, loss: 0.2073, instance_loss: 0.6199, weighted_loss: 0.3311, label: 1, bag_size: 3051
batch 239, loss: 0.0423, instance_loss: 0.1679, weighted_loss: 0.0800, label: 2, bag_size: 3176
batch 259, loss: 1.5572, instance_loss: 1.1601, weighted_loss: 1.4380, label: 2, bag_size: 4179
batch 279, loss: 0.6593, instance_loss: 0.6724, weighted_loss: 0.6632, label: 1, bag_size: 2747
batch 299, loss: 2.7461, instance_loss: 1.0374, weighted_loss: 2.2335, label: 1, bag_size: 5423
batch 319, loss: 0.7670, instance_loss: 0.5449, weighted_loss: 0.7004, label: 1, bag_size: 4708
batch 339, loss: 0.1879, instance_loss: 0.4555, weighted_loss: 0.2682, label: 1, bag_size: 6315
batch 359, loss: 0.2460, instance_loss: 0.5993, weighted_loss: 0.3520, label: 1, bag_size: 2905
batch 379, loss: 0.1883, instance_loss: 0.2498, weighted_loss: 0.2067, label: 0, bag_size: 4855
batch 399, loss: 0.3635, instance_loss: 0.4643, weighted_loss: 0.3937, label: 0, bag_size: 4201
batch 419, loss: 0.1683, instance_loss: 0.6184, weighted_loss: 0.3033, label: 2, bag_size: 5472
batch 439, loss: 0.6723, instance_loss: 1.3717, weighted_loss: 0.8821, label: 1, bag_size: 5205
batch 459, loss: 0.6637, instance_loss: 1.4559, weighted_loss: 0.9013, label: 0, bag_size: 7927
batch 479, loss: 1.0096, instance_loss: 0.6137, weighted_loss: 0.8908, label: 0, bag_size: 5893
batch 499, loss: 0.2145, instance_loss: 0.3918, weighted_loss: 0.2677, label: 2, bag_size: 4162
batch 519, loss: 0.0020, instance_loss: 0.0564, weighted_loss: 0.0183, label: 1, bag_size: 460
batch 539, loss: 0.2176, instance_loss: 0.4189, weighted_loss: 0.2780, label: 1, bag_size: 3493
batch 559, loss: 0.3462, instance_loss: 0.7113, weighted_loss: 0.4557, label: 1, bag_size: 6315
batch 579, loss: 1.0637, instance_loss: 0.6852, weighted_loss: 0.9501, label: 1, bag_size: 5718
batch 599, loss: 0.1929, instance_loss: 0.2773, weighted_loss: 0.2182, label: 2, bag_size: 3618
batch 619, loss: 0.7445, instance_loss: 0.7558, weighted_loss: 0.7479, label: 0, bag_size: 789
batch 639, loss: 1.0270, instance_loss: 0.6735, weighted_loss: 0.9209, label: 1, bag_size: 19265
batch 659, loss: 0.0083, instance_loss: 0.2032, weighted_loss: 0.0668, label: 0, bag_size: 1611
batch 679, loss: 0.0619, instance_loss: 0.3315, weighted_loss: 0.1428, label: 0, bag_size: 2852
batch 699, loss: 0.0556, instance_loss: 0.1949, weighted_loss: 0.0974, label: 1, bag_size: 4869
batch 719, loss: 0.2139, instance_loss: 0.3287, weighted_loss: 0.2484, label: 2, bag_size: 6704
batch 739, loss: 0.0276, instance_loss: 0.1282, weighted_loss: 0.0577, label: 2, bag_size: 4372


class 0 clustering acc 0.9676733780760627: correct 17302/17880
class 1 clustering acc 0.3704697986577181: correct 2208/5960
Epoch: 33, train_loss: 0.5370, train_clustering_loss:  0.5410, train_error: 0.2282
class 0: acc 0.8, correct 184/230
class 1: acc 0.7083333333333334, correct 187/264
class 2: acc 0.8127490039840638, correct 204/251

Val Set, val_loss: 0.6237, val_error: 0.2979, auc: 0.9034
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.3390957446808511: correct 255/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0031, instance_loss: 0.2700, weighted_loss: 0.0831, label: 0, bag_size: 3727
batch 39, loss: 0.6240, instance_loss: 0.6897, weighted_loss: 0.6437, label: 1, bag_size: 2743
batch 59, loss: 0.0297, instance_loss: 0.5111, weighted_loss: 0.1741, label: 0, bag_size: 4165
batch 79, loss: 0.3612, instance_loss: 0.3529, weighted_loss: 0.3587, label: 2, bag_size: 3397
batch 99, loss: 0.3913, instance_loss: 0.3545, weighted_loss: 0.3802, label: 0, bag_size: 3639
batch 119, loss: 1.0645, instance_loss: 0.8810, weighted_loss: 1.0094, label: 0, bag_size: 877
batch 139, loss: 0.0291, instance_loss: 0.2349, weighted_loss: 0.0909, label: 0, bag_size: 4071
batch 159, loss: 0.5641, instance_loss: 0.7237, weighted_loss: 0.6119, label: 1, bag_size: 11974
batch 179, loss: 0.1328, instance_loss: 0.1039, weighted_loss: 0.1241, label: 2, bag_size: 3210
batch 199, loss: 0.0000, instance_loss: 0.2434, weighted_loss: 0.0731, label: 2, bag_size: 5017
batch 219, loss: 0.0057, instance_loss: 0.5407, weighted_loss: 0.1662, label: 2, bag_size: 2031
batch 239, loss: 0.0457, instance_loss: 0.2764, weighted_loss: 0.1149, label: 0, bag_size: 4312
batch 259, loss: 0.1780, instance_loss: 0.4927, weighted_loss: 0.2724, label: 1, bag_size: 6152
batch 279, loss: 1.5084, instance_loss: 0.8929, weighted_loss: 1.3238, label: 0, bag_size: 3475
batch 299, loss: 0.2149, instance_loss: 0.4348, weighted_loss: 0.2809, label: 1, bag_size: 6315
batch 319, loss: 0.3806, instance_loss: 0.8917, weighted_loss: 0.5339, label: 0, bag_size: 3871
batch 339, loss: 0.1980, instance_loss: 0.3131, weighted_loss: 0.2325, label: 1, bag_size: 2767
batch 359, loss: 0.2701, instance_loss: 0.3363, weighted_loss: 0.2899, label: 2, bag_size: 4691
batch 379, loss: 0.1217, instance_loss: 0.3308, weighted_loss: 0.1845, label: 0, bag_size: 3666
batch 399, loss: 0.0594, instance_loss: 0.2168, weighted_loss: 0.1066, label: 0, bag_size: 5036
batch 419, loss: 0.2197, instance_loss: 0.4062, weighted_loss: 0.2757, label: 0, bag_size: 4251
batch 439, loss: 0.9772, instance_loss: 0.8946, weighted_loss: 0.9524, label: 0, bag_size: 1352
batch 459, loss: 0.4528, instance_loss: 0.3704, weighted_loss: 0.4280, label: 1, bag_size: 6475
batch 479, loss: 0.2410, instance_loss: 0.3385, weighted_loss: 0.2703, label: 0, bag_size: 1640
batch 499, loss: 0.0788, instance_loss: 0.1642, weighted_loss: 0.1044, label: 2, bag_size: 3176
batch 519, loss: 0.0798, instance_loss: 0.1584, weighted_loss: 0.1034, label: 2, bag_size: 4691
batch 539, loss: 0.1141, instance_loss: 0.1857, weighted_loss: 0.1356, label: 2, bag_size: 2997
batch 559, loss: 0.0063, instance_loss: 0.1615, weighted_loss: 0.0529, label: 0, bag_size: 3754
batch 579, loss: 0.2262, instance_loss: 0.5310, weighted_loss: 0.3176, label: 0, bag_size: 5634
batch 599, loss: 0.0556, instance_loss: 0.2887, weighted_loss: 0.1255, label: 2, bag_size: 3327
batch 619, loss: 0.0001, instance_loss: 0.0700, weighted_loss: 0.0210, label: 1, bag_size: 5462
batch 639, loss: 0.1816, instance_loss: 0.4616, weighted_loss: 0.2656, label: 1, bag_size: 2731
batch 659, loss: 0.2322, instance_loss: 0.2146, weighted_loss: 0.2269, label: 2, bag_size: 2049
batch 679, loss: 1.0554, instance_loss: 0.8804, weighted_loss: 1.0029, label: 1, bag_size: 2743
batch 699, loss: 0.7176, instance_loss: 1.1098, weighted_loss: 0.8353, label: 1, bag_size: 1580
batch 719, loss: 0.0367, instance_loss: 0.1567, weighted_loss: 0.0727, label: 0, bag_size: 6430
batch 739, loss: 0.5856, instance_loss: 0.6744, weighted_loss: 0.6123, label: 2, bag_size: 5426


class 0 clustering acc 0.9673937360178971: correct 17297/17880
class 1 clustering acc 0.3691275167785235: correct 2200/5960
Epoch: 34, train_loss: 0.5700, train_clustering_loss:  0.5540, train_error: 0.2617
class 0: acc 0.7170542635658915, correct 185/258
class 1: acc 0.6867469879518072, correct 171/249
class 2: acc 0.8151260504201681, correct 194/238

Val Set, val_loss: 0.5540, val_error: 0.2766, auc: 0.9092
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.3949468085106383: correct 297/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0050, instance_loss: 0.0659, weighted_loss: 0.0233, label: 1, bag_size: 460
batch 39, loss: 0.6526, instance_loss: 0.7055, weighted_loss: 0.6685, label: 0, bag_size: 4122
batch 59, loss: 0.5122, instance_loss: 0.3726, weighted_loss: 0.4704, label: 0, bag_size: 622
batch 79, loss: 0.6136, instance_loss: 0.4585, weighted_loss: 0.5670, label: 2, bag_size: 4291
batch 99, loss: 0.1600, instance_loss: 0.5686, weighted_loss: 0.2826, label: 2, bag_size: 3299
batch 119, loss: 0.0597, instance_loss: 0.0864, weighted_loss: 0.0677, label: 2, bag_size: 3026
batch 139, loss: 0.2637, instance_loss: 1.1274, weighted_loss: 0.5228, label: 0, bag_size: 2069
batch 159, loss: 0.1078, instance_loss: 0.6116, weighted_loss: 0.2590, label: 0, bag_size: 4494
batch 179, loss: 0.3796, instance_loss: 0.5371, weighted_loss: 0.4268, label: 1, bag_size: 1197
batch 199, loss: 0.2585, instance_loss: 0.3555, weighted_loss: 0.2876, label: 0, bag_size: 2479
batch 219, loss: 0.0012, instance_loss: 0.1006, weighted_loss: 0.0310, label: 1, bag_size: 2254
batch 239, loss: 0.1107, instance_loss: 0.7525, weighted_loss: 0.3032, label: 0, bag_size: 667
batch 259, loss: 0.3142, instance_loss: 0.5991, weighted_loss: 0.3997, label: 1, bag_size: 3391
batch 279, loss: 0.4932, instance_loss: 0.6643, weighted_loss: 0.5445, label: 1, bag_size: 3109
batch 299, loss: 0.0102, instance_loss: 0.0568, weighted_loss: 0.0242, label: 0, bag_size: 1825
batch 319, loss: 0.1406, instance_loss: 0.6386, weighted_loss: 0.2900, label: 0, bag_size: 4494
batch 339, loss: 0.1826, instance_loss: 0.3147, weighted_loss: 0.2222, label: 0, bag_size: 3915
batch 359, loss: 0.1777, instance_loss: 0.3203, weighted_loss: 0.2205, label: 0, bag_size: 3294
batch 379, loss: 3.0370, instance_loss: 1.5471, weighted_loss: 2.5900, label: 1, bag_size: 2425
batch 399, loss: 0.1191, instance_loss: 0.2175, weighted_loss: 0.1486, label: 1, bag_size: 4192
batch 419, loss: 0.0669, instance_loss: 0.3786, weighted_loss: 0.1604, label: 0, bag_size: 4378
batch 439, loss: 0.3913, instance_loss: 0.6460, weighted_loss: 0.4677, label: 0, bag_size: 1270
batch 459, loss: 0.0582, instance_loss: 0.3247, weighted_loss: 0.1381, label: 0, bag_size: 4841
batch 479, loss: 0.6480, instance_loss: 0.6151, weighted_loss: 0.6381, label: 2, bag_size: 724
batch 499, loss: 0.5359, instance_loss: 0.4574, weighted_loss: 0.5123, label: 2, bag_size: 3274
batch 519, loss: 0.5354, instance_loss: 0.7091, weighted_loss: 0.5875, label: 1, bag_size: 3497
batch 539, loss: 0.5418, instance_loss: 0.4544, weighted_loss: 0.5156, label: 0, bag_size: 622
batch 559, loss: 0.7088, instance_loss: 0.9678, weighted_loss: 0.7865, label: 1, bag_size: 4869
batch 579, loss: 0.0928, instance_loss: 0.1390, weighted_loss: 0.1066, label: 2, bag_size: 1103
batch 599, loss: 0.0079, instance_loss: 0.1649, weighted_loss: 0.0550, label: 2, bag_size: 4141
batch 619, loss: 0.4997, instance_loss: 0.5952, weighted_loss: 0.5284, label: 2, bag_size: 2031
batch 639, loss: 1.2033, instance_loss: 0.8460, weighted_loss: 1.0961, label: 2, bag_size: 3274
batch 659, loss: 0.4209, instance_loss: 0.5753, weighted_loss: 0.4672, label: 2, bag_size: 5406
batch 679, loss: 0.0712, instance_loss: 0.4482, weighted_loss: 0.1843, label: 0, bag_size: 3648
batch 699, loss: 0.9919, instance_loss: 0.6178, weighted_loss: 0.8797, label: 0, bag_size: 15388
batch 719, loss: 0.6219, instance_loss: 0.5264, weighted_loss: 0.5933, label: 0, bag_size: 3155
batch 739, loss: 1.1304, instance_loss: 1.5560, weighted_loss: 1.2581, label: 1, bag_size: 20666


class 0 clustering acc 0.9679530201342282: correct 17307/17880
class 1 clustering acc 0.41191275167785235: correct 2455/5960
Epoch: 35, train_loss: 0.5039, train_clustering_loss:  0.5258, train_error: 0.2027
class 0: acc 0.836, correct 209/250
class 1: acc 0.7012448132780082, correct 169/241
class 2: acc 0.8503937007874016, correct 216/254

Val Set, val_loss: 0.5361, val_error: 0.2234, auc: 0.9149
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.4308510638297872: correct 324/752
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.551362 --> 0.536067).  Saving model ...


batch 19, loss: 0.6531, instance_loss: 0.6978, weighted_loss: 0.6665, label: 1, bag_size: 10399
batch 39, loss: 0.2757, instance_loss: 0.3550, weighted_loss: 0.2995, label: 2, bag_size: 4978
batch 59, loss: 0.1700, instance_loss: 0.1137, weighted_loss: 0.1531, label: 0, bag_size: 2290
batch 79, loss: 1.0322, instance_loss: 0.8998, weighted_loss: 0.9925, label: 1, bag_size: 869
batch 99, loss: 0.4421, instance_loss: 0.6025, weighted_loss: 0.4902, label: 1, bag_size: 4644
batch 119, loss: 2.4425, instance_loss: 1.1968, weighted_loss: 2.0688, label: 1, bag_size: 2229
batch 139, loss: 0.8145, instance_loss: 0.6391, weighted_loss: 0.7619, label: 2, bag_size: 3546
batch 159, loss: 4.0127, instance_loss: 1.7889, weighted_loss: 3.3456, label: 0, bag_size: 557
batch 179, loss: 0.0897, instance_loss: 1.0740, weighted_loss: 0.3850, label: 1, bag_size: 1604
batch 199, loss: 0.2160, instance_loss: 0.2440, weighted_loss: 0.2244, label: 2, bag_size: 5426
batch 219, loss: 1.3870, instance_loss: 0.8768, weighted_loss: 1.2339, label: 1, bag_size: 1313
batch 239, loss: 0.2226, instance_loss: 0.2110, weighted_loss: 0.2191, label: 2, bag_size: 3397
batch 259, loss: 0.2694, instance_loss: 0.2422, weighted_loss: 0.2612, label: 2, bag_size: 2049
batch 279, loss: 0.0175, instance_loss: 0.2498, weighted_loss: 0.0872, label: 1, bag_size: 10941
batch 299, loss: 0.0247, instance_loss: 0.4121, weighted_loss: 0.1409, label: 0, bag_size: 5992
batch 319, loss: 0.0006, instance_loss: 0.1627, weighted_loss: 0.0492, label: 0, bag_size: 855
batch 339, loss: 1.4717, instance_loss: 0.9203, weighted_loss: 1.3063, label: 2, bag_size: 223
batch 359, loss: 0.4444, instance_loss: 0.5957, weighted_loss: 0.4898, label: 1, bag_size: 4200
batch 379, loss: 0.2487, instance_loss: 0.3850, weighted_loss: 0.2896, label: 2, bag_size: 3174
batch 399, loss: 0.3883, instance_loss: 0.4764, weighted_loss: 0.4147, label: 2, bag_size: 7607
batch 419, loss: 0.0332, instance_loss: 0.1324, weighted_loss: 0.0629, label: 2, bag_size: 4745
batch 439, loss: 0.1132, instance_loss: 0.2011, weighted_loss: 0.1395, label: 2, bag_size: 4745
batch 459, loss: 0.5046, instance_loss: 0.7241, weighted_loss: 0.5704, label: 1, bag_size: 1327
batch 479, loss: 0.1787, instance_loss: 0.2854, weighted_loss: 0.2107, label: 0, bag_size: 2884
batch 499, loss: 0.0649, instance_loss: 0.4591, weighted_loss: 0.1831, label: 0, bag_size: 667
batch 519, loss: 0.5930, instance_loss: 0.8014, weighted_loss: 0.6556, label: 1, bag_size: 667
batch 539, loss: 2.8880, instance_loss: 1.6922, weighted_loss: 2.5293, label: 1, bag_size: 3159
batch 559, loss: 0.1772, instance_loss: 0.2405, weighted_loss: 0.1962, label: 2, bag_size: 3778
batch 579, loss: 0.1277, instance_loss: 0.2933, weighted_loss: 0.1774, label: 2, bag_size: 4555
batch 599, loss: 0.0104, instance_loss: 0.1886, weighted_loss: 0.0639, label: 2, bag_size: 4140
batch 619, loss: 0.4607, instance_loss: 0.9884, weighted_loss: 0.6190, label: 1, bag_size: 2905
batch 639, loss: 0.3950, instance_loss: 0.7561, weighted_loss: 0.5033, label: 1, bag_size: 4812
batch 659, loss: 0.1867, instance_loss: 0.6858, weighted_loss: 0.3365, label: 0, bag_size: 3268
batch 679, loss: 0.1172, instance_loss: 0.2084, weighted_loss: 0.1446, label: 0, bag_size: 4157
batch 699, loss: 0.3151, instance_loss: 0.4201, weighted_loss: 0.3466, label: 0, bag_size: 3833
batch 719, loss: 0.4827, instance_loss: 0.5681, weighted_loss: 0.5083, label: 2, bag_size: 614
batch 739, loss: 0.0246, instance_loss: 0.3385, weighted_loss: 0.1187, label: 0, bag_size: 3038


class 0 clustering acc 0.9691834451901566: correct 17329/17880
class 1 clustering acc 0.37214765100671143: correct 2218/5960
Epoch: 36, train_loss: 0.5458, train_clustering_loss:  0.5538, train_error: 0.2349
class 0: acc 0.7552742616033755, correct 179/237
class 1: acc 0.7051792828685259, correct 177/251
class 2: acc 0.8326848249027238, correct 214/257

Val Set, val_loss: 0.7842, val_error: 0.3191, auc: 0.8558
class 0 clustering acc 0.9286347517730497: correct 2095/2256
class 1 clustering acc 0.28058510638297873: correct 211/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3272, instance_loss: 0.6439, weighted_loss: 0.4222, label: 1, bag_size: 5728
batch 39, loss: 0.1665, instance_loss: 0.4889, weighted_loss: 0.2632, label: 1, bag_size: 1029
batch 59, loss: 0.4066, instance_loss: 0.3133, weighted_loss: 0.3786, label: 0, bag_size: 3741
batch 79, loss: 0.2524, instance_loss: 0.3829, weighted_loss: 0.2916, label: 2, bag_size: 3607
batch 99, loss: 0.1989, instance_loss: 0.8602, weighted_loss: 0.3973, label: 1, bag_size: 2643
batch 119, loss: 0.0818, instance_loss: 0.2716, weighted_loss: 0.1388, label: 2, bag_size: 6644
batch 139, loss: 0.2217, instance_loss: 0.2295, weighted_loss: 0.2240, label: 2, bag_size: 1103
batch 159, loss: 0.0240, instance_loss: 0.1236, weighted_loss: 0.0539, label: 1, bag_size: 2870
batch 179, loss: 0.0138, instance_loss: 0.6833, weighted_loss: 0.2147, label: 0, bag_size: 2044
batch 199, loss: 0.0048, instance_loss: 1.0715, weighted_loss: 0.3248, label: 0, bag_size: 1910
batch 219, loss: 0.1069, instance_loss: 0.3077, weighted_loss: 0.1671, label: 0, bag_size: 6863
batch 239, loss: 0.0118, instance_loss: 0.0997, weighted_loss: 0.0382, label: 0, bag_size: 2825
batch 259, loss: 1.0610, instance_loss: 0.8083, weighted_loss: 0.9852, label: 1, bag_size: 5572
batch 279, loss: 0.3140, instance_loss: 0.2938, weighted_loss: 0.3079, label: 2, bag_size: 1103
batch 299, loss: 0.0715, instance_loss: 0.1469, weighted_loss: 0.0941, label: 2, bag_size: 2254
batch 319, loss: 0.2316, instance_loss: 0.2354, weighted_loss: 0.2328, label: 2, bag_size: 3174
batch 339, loss: 0.3180, instance_loss: 0.3846, weighted_loss: 0.3380, label: 2, bag_size: 3026
batch 359, loss: 1.0487, instance_loss: 0.5235, weighted_loss: 0.8912, label: 2, bag_size: 4241
batch 379, loss: 0.2020, instance_loss: 0.2777, weighted_loss: 0.2247, label: 0, bag_size: 1495
batch 399, loss: 0.3378, instance_loss: 0.2545, weighted_loss: 0.3128, label: 0, bag_size: 2841
batch 419, loss: 0.4875, instance_loss: 0.3034, weighted_loss: 0.4323, label: 2, bag_size: 3227
batch 439, loss: 0.3598, instance_loss: 0.4900, weighted_loss: 0.3988, label: 2, bag_size: 2813
batch 459, loss: 0.5079, instance_loss: 0.5909, weighted_loss: 0.5328, label: 0, bag_size: 3743
batch 479, loss: 0.1327, instance_loss: 0.2613, weighted_loss: 0.1713, label: 0, bag_size: 3294
batch 499, loss: 0.7343, instance_loss: 1.0443, weighted_loss: 0.8273, label: 2, bag_size: 4571
batch 519, loss: 1.4470, instance_loss: 0.7362, weighted_loss: 1.2338, label: 0, bag_size: 2559
batch 539, loss: 0.0011, instance_loss: 0.1239, weighted_loss: 0.0379, label: 0, bag_size: 3727
batch 559, loss: 1.7440, instance_loss: 0.8676, weighted_loss: 1.4811, label: 1, bag_size: 3322
batch 579, loss: 0.6134, instance_loss: 0.5692, weighted_loss: 0.6002, label: 2, bag_size: 2813
batch 599, loss: 0.9812, instance_loss: 0.5433, weighted_loss: 0.8498, label: 0, bag_size: 4228
batch 619, loss: 0.5592, instance_loss: 0.7289, weighted_loss: 0.6102, label: 2, bag_size: 728
batch 639, loss: 0.1598, instance_loss: 0.2624, weighted_loss: 0.1906, label: 1, bag_size: 10941
batch 659, loss: 0.2106, instance_loss: 0.2135, weighted_loss: 0.2115, label: 2, bag_size: 3172
batch 679, loss: 0.0240, instance_loss: 0.5230, weighted_loss: 0.1737, label: 0, bag_size: 3820
batch 699, loss: 0.6554, instance_loss: 0.6596, weighted_loss: 0.6567, label: 1, bag_size: 3106
batch 719, loss: 0.1119, instance_loss: 0.3126, weighted_loss: 0.1721, label: 0, bag_size: 1883
batch 739, loss: 0.0619, instance_loss: 0.1441, weighted_loss: 0.0866, label: 2, bag_size: 3026


class 0 clustering acc 0.9653803131991051: correct 17261/17880
class 1 clustering acc 0.4191275167785235: correct 2498/5960
Epoch: 37, train_loss: 0.5334, train_clustering_loss:  0.5335, train_error: 0.2268
class 0: acc 0.8108108108108109, correct 210/259
class 1: acc 0.6502242152466368, correct 145/223
class 2: acc 0.8403041825095057, correct 221/263

Val Set, val_loss: 0.9308, val_error: 0.4255, auc: 0.8395
class 0 clustering acc 0.9397163120567376: correct 2120/2256
class 1 clustering acc 0.300531914893617: correct 226/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0384, instance_loss: 0.2340, weighted_loss: 0.0970, label: 2, bag_size: 4372
batch 39, loss: 0.5537, instance_loss: 0.8217, weighted_loss: 0.6341, label: 1, bag_size: 3009
batch 59, loss: 0.1880, instance_loss: 0.4062, weighted_loss: 0.2535, label: 2, bag_size: 3618
batch 79, loss: 0.0672, instance_loss: 0.6685, weighted_loss: 0.2476, label: 0, bag_size: 5646
batch 99, loss: 0.3842, instance_loss: 0.5952, weighted_loss: 0.4475, label: 2, bag_size: 4316
batch 119, loss: 2.3644, instance_loss: 1.4958, weighted_loss: 2.1038, label: 1, bag_size: 3100
batch 139, loss: 0.3603, instance_loss: 0.6568, weighted_loss: 0.4493, label: 2, bag_size: 5743
batch 159, loss: 0.2273, instance_loss: 0.4907, weighted_loss: 0.3063, label: 1, bag_size: 5003
batch 179, loss: 0.4564, instance_loss: 0.5687, weighted_loss: 0.4901, label: 2, bag_size: 5072
batch 199, loss: 0.5872, instance_loss: 0.9601, weighted_loss: 0.6990, label: 1, bag_size: 3986
batch 219, loss: 0.0407, instance_loss: 0.5630, weighted_loss: 0.1974, label: 0, bag_size: 1174
batch 239, loss: 1.6648, instance_loss: 0.9734, weighted_loss: 1.4574, label: 1, bag_size: 3823
batch 259, loss: 0.2308, instance_loss: 0.5275, weighted_loss: 0.3198, label: 1, bag_size: 2921
batch 279, loss: 1.5048, instance_loss: 0.9010, weighted_loss: 1.3236, label: 0, bag_size: 1753
batch 299, loss: 0.2590, instance_loss: 0.3744, weighted_loss: 0.2936, label: 2, bag_size: 3327
batch 319, loss: 0.1053, instance_loss: 0.3581, weighted_loss: 0.1812, label: 2, bag_size: 5924
batch 339, loss: 0.2495, instance_loss: 0.5131, weighted_loss: 0.3286, label: 2, bag_size: 3618
batch 359, loss: 2.8059, instance_loss: 1.1087, weighted_loss: 2.2967, label: 0, bag_size: 3419
batch 379, loss: 0.7655, instance_loss: 0.9596, weighted_loss: 0.8237, label: 1, bag_size: 3991
batch 399, loss: 0.1807, instance_loss: 0.3131, weighted_loss: 0.2204, label: 0, bag_size: 5353
batch 419, loss: 0.8545, instance_loss: 0.6227, weighted_loss: 0.7850, label: 2, bag_size: 1050
batch 439, loss: 0.1506, instance_loss: 0.4945, weighted_loss: 0.2538, label: 1, bag_size: 3519
batch 459, loss: 0.0625, instance_loss: 0.1722, weighted_loss: 0.0954, label: 2, bag_size: 614
batch 479, loss: 0.0893, instance_loss: 0.2313, weighted_loss: 0.1319, label: 2, bag_size: 3396
batch 499, loss: 0.1140, instance_loss: 0.1975, weighted_loss: 0.1390, label: 2, bag_size: 2997
batch 519, loss: 0.7186, instance_loss: 0.5995, weighted_loss: 0.6829, label: 1, bag_size: 2743
batch 539, loss: 0.0363, instance_loss: 0.1874, weighted_loss: 0.0816, label: 2, bag_size: 5138
batch 559, loss: 0.8565, instance_loss: 0.5570, weighted_loss: 0.7667, label: 1, bag_size: 4784
batch 579, loss: 0.0218, instance_loss: 0.2633, weighted_loss: 0.0942, label: 1, bag_size: 3127
batch 599, loss: 0.3307, instance_loss: 0.5107, weighted_loss: 0.3847, label: 2, bag_size: 4978
batch 619, loss: 0.0777, instance_loss: 0.2680, weighted_loss: 0.1348, label: 0, bag_size: 3525
batch 639, loss: 0.4893, instance_loss: 0.5465, weighted_loss: 0.5065, label: 1, bag_size: 1500
batch 659, loss: 0.2613, instance_loss: 0.6130, weighted_loss: 0.3668, label: 1, bag_size: 4119
batch 679, loss: 0.0011, instance_loss: 0.0690, weighted_loss: 0.0214, label: 0, bag_size: 4196
batch 699, loss: 2.0773, instance_loss: 1.4379, weighted_loss: 1.8855, label: 2, bag_size: 4910
batch 719, loss: 0.0246, instance_loss: 0.2359, weighted_loss: 0.0880, label: 1, bag_size: 3761
batch 739, loss: 0.0687, instance_loss: 0.4435, weighted_loss: 0.1812, label: 0, bag_size: 4721


class 0 clustering acc 0.9630313199105145: correct 17219/17880
class 1 clustering acc 0.41308724832214766: correct 2462/5960
Epoch: 38, train_loss: 0.5167, train_clustering_loss:  0.5302, train_error: 0.2121
class 0: acc 0.799163179916318, correct 191/239
class 1: acc 0.716, correct 179/250
class 2: acc 0.84765625, correct 217/256

Val Set, val_loss: 0.7368, val_error: 0.3404, auc: 0.8546
class 0 clustering acc 0.9556737588652482: correct 2156/2256
class 1 clustering acc 0.22606382978723405: correct 170/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8012, instance_loss: 0.7019, weighted_loss: 0.7714, label: 2, bag_size: 5743
batch 39, loss: 0.7317, instance_loss: 0.7042, weighted_loss: 0.7234, label: 0, bag_size: 4547
batch 59, loss: 0.3337, instance_loss: 0.3003, weighted_loss: 0.3237, label: 2, bag_size: 2905
batch 79, loss: 0.0318, instance_loss: 0.2375, weighted_loss: 0.0935, label: 0, bag_size: 5831
batch 99, loss: 0.0130, instance_loss: 0.2089, weighted_loss: 0.0717, label: 1, bag_size: 796
batch 119, loss: 0.1672, instance_loss: 0.1673, weighted_loss: 0.1673, label: 2, bag_size: 3210
batch 139, loss: 0.5262, instance_loss: 0.8459, weighted_loss: 0.6221, label: 1, bag_size: 4438
batch 159, loss: 0.6147, instance_loss: 0.6843, weighted_loss: 0.6356, label: 0, bag_size: 1052
batch 179, loss: 0.0546, instance_loss: 0.1115, weighted_loss: 0.0717, label: 2, bag_size: 2209
batch 199, loss: 0.1043, instance_loss: 0.2128, weighted_loss: 0.1368, label: 2, bag_size: 2481
batch 219, loss: 0.2189, instance_loss: 1.2669, weighted_loss: 0.5333, label: 1, bag_size: 2614
batch 239, loss: 0.0062, instance_loss: 0.1928, weighted_loss: 0.0622, label: 1, bag_size: 1836
batch 259, loss: 0.5467, instance_loss: 0.6285, weighted_loss: 0.5713, label: 2, bag_size: 223
batch 279, loss: 0.1894, instance_loss: 0.4524, weighted_loss: 0.2683, label: 0, bag_size: 16741
batch 299, loss: 0.7873, instance_loss: 0.5820, weighted_loss: 0.7257, label: 1, bag_size: 368
batch 319, loss: 0.3608, instance_loss: 0.5556, weighted_loss: 0.4193, label: 1, bag_size: 2921
batch 339, loss: 0.0110, instance_loss: 0.4422, weighted_loss: 0.1404, label: 0, bag_size: 7169
batch 359, loss: 0.0002, instance_loss: 0.1255, weighted_loss: 0.0378, label: 1, bag_size: 5364
batch 379, loss: 0.5541, instance_loss: 0.5507, weighted_loss: 0.5531, label: 1, bag_size: 3640
batch 399, loss: 0.5164, instance_loss: 0.3247, weighted_loss: 0.4589, label: 0, bag_size: 7177
batch 419, loss: 0.0289, instance_loss: 0.1416, weighted_loss: 0.0627, label: 0, bag_size: 2841
batch 439, loss: 2.1691, instance_loss: 1.4162, weighted_loss: 1.9432, label: 1, bag_size: 782
batch 459, loss: 0.5831, instance_loss: 0.8006, weighted_loss: 0.6484, label: 1, bag_size: 5118
batch 479, loss: 0.2884, instance_loss: 0.3378, weighted_loss: 0.3032, label: 0, bag_size: 3294
batch 499, loss: 0.3738, instance_loss: 0.4568, weighted_loss: 0.3987, label: 0, bag_size: 2983
batch 519, loss: 0.0183, instance_loss: 0.2039, weighted_loss: 0.0740, label: 0, bag_size: 3408
batch 539, loss: 0.0173, instance_loss: 0.1120, weighted_loss: 0.0457, label: 0, bag_size: 4831
batch 559, loss: 0.0894, instance_loss: 0.2920, weighted_loss: 0.1502, label: 0, bag_size: 2712
batch 579, loss: 0.0423, instance_loss: 0.1047, weighted_loss: 0.0610, label: 2, bag_size: 4745
batch 599, loss: 0.3911, instance_loss: 0.9773, weighted_loss: 0.5670, label: 1, bag_size: 11768
batch 619, loss: 0.0801, instance_loss: 0.1942, weighted_loss: 0.1143, label: 2, bag_size: 3327
batch 639, loss: 0.0006, instance_loss: 0.1094, weighted_loss: 0.0333, label: 2, bag_size: 5037
batch 659, loss: 1.6696, instance_loss: 1.1732, weighted_loss: 1.5207, label: 0, bag_size: 4032
batch 679, loss: 0.0858, instance_loss: 0.3183, weighted_loss: 0.1556, label: 0, bag_size: 598
batch 699, loss: 0.8792, instance_loss: 0.7919, weighted_loss: 0.8530, label: 2, bag_size: 552
batch 719, loss: 0.0476, instance_loss: 0.1215, weighted_loss: 0.0698, label: 2, bag_size: 2481
batch 739, loss: 0.1699, instance_loss: 0.2731, weighted_loss: 0.2009, label: 2, bag_size: 3026


class 0 clustering acc 0.9695749440715884: correct 17336/17880
class 1 clustering acc 0.41963087248322145: correct 2501/5960
Epoch: 39, train_loss: 0.5031, train_clustering_loss:  0.5195, train_error: 0.2027
class 0: acc 0.8416988416988417, correct 218/259
class 1: acc 0.6744186046511628, correct 145/215
class 2: acc 0.8523985239852399, correct 231/271

Val Set, val_loss: 0.5587, val_error: 0.2766, auc: 0.9103
class 0 clustering acc 0.9738475177304965: correct 2197/2256
class 1 clustering acc 0.37367021276595747: correct 281/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3904, instance_loss: 0.2967, weighted_loss: 0.3623, label: 0, bag_size: 5634
batch 39, loss: 0.1681, instance_loss: 0.2421, weighted_loss: 0.1903, label: 0, bag_size: 471
batch 59, loss: 0.2396, instance_loss: 0.2893, weighted_loss: 0.2545, label: 0, bag_size: 2392
batch 79, loss: 0.6360, instance_loss: 0.3072, weighted_loss: 0.5374, label: 0, bag_size: 13770
batch 99, loss: 0.1194, instance_loss: 0.1668, weighted_loss: 0.1336, label: 2, bag_size: 2254
batch 119, loss: 0.0938, instance_loss: 0.1716, weighted_loss: 0.1171, label: 2, bag_size: 2313
batch 139, loss: 0.5172, instance_loss: 0.5936, weighted_loss: 0.5401, label: 2, bag_size: 5406
batch 159, loss: 0.0008, instance_loss: 0.2314, weighted_loss: 0.0700, label: 0, bag_size: 4403
batch 179, loss: 0.3803, instance_loss: 0.8389, weighted_loss: 0.5179, label: 0, bag_size: 7077
batch 199, loss: 0.0582, instance_loss: 0.1707, weighted_loss: 0.0919, label: 0, bag_size: 3641
batch 219, loss: 0.0745, instance_loss: 0.1219, weighted_loss: 0.0887, label: 0, bag_size: 5038
batch 239, loss: 0.0000, instance_loss: 0.0678, weighted_loss: 0.0204, label: 2, bag_size: 5017
batch 259, loss: 0.0373, instance_loss: 0.3053, weighted_loss: 0.1177, label: 0, bag_size: 1495
batch 279, loss: 0.5684, instance_loss: 0.7203, weighted_loss: 0.6140, label: 1, bag_size: 2859
batch 299, loss: 0.7829, instance_loss: 0.7430, weighted_loss: 0.7709, label: 1, bag_size: 4395
batch 319, loss: 0.1280, instance_loss: 0.3596, weighted_loss: 0.1975, label: 2, bag_size: 6644
batch 339, loss: 0.9230, instance_loss: 1.0019, weighted_loss: 0.9467, label: 1, bag_size: 3424
batch 359, loss: 1.7363, instance_loss: 1.2165, weighted_loss: 1.5804, label: 1, bag_size: 2751
batch 379, loss: 0.7624, instance_loss: 0.6954, weighted_loss: 0.7423, label: 2, bag_size: 361
batch 399, loss: 2.7422, instance_loss: 1.1325, weighted_loss: 2.2593, label: 2, bag_size: 2326
batch 419, loss: 0.0270, instance_loss: 0.3382, weighted_loss: 0.1204, label: 2, bag_size: 5037
batch 439, loss: 0.1651, instance_loss: 0.3218, weighted_loss: 0.2121, label: 2, bag_size: 6704
batch 459, loss: 1.2386, instance_loss: 1.0359, weighted_loss: 1.1778, label: 0, bag_size: 5017
batch 479, loss: 1.5007, instance_loss: 0.6334, weighted_loss: 1.2405, label: 2, bag_size: 4241
batch 499, loss: 0.7926, instance_loss: 0.6879, weighted_loss: 0.7612, label: 2, bag_size: 223
batch 519, loss: 0.0356, instance_loss: 0.0967, weighted_loss: 0.0539, label: 0, bag_size: 3304
batch 539, loss: 1.3016, instance_loss: 1.2715, weighted_loss: 1.2925, label: 1, bag_size: 1307
batch 559, loss: 0.1958, instance_loss: 0.4849, weighted_loss: 0.2825, label: 1, bag_size: 9099
batch 579, loss: 0.2534, instance_loss: 0.3496, weighted_loss: 0.2823, label: 2, bag_size: 3210
batch 599, loss: 0.7277, instance_loss: 1.0822, weighted_loss: 0.8341, label: 1, bag_size: 782
batch 619, loss: 4.8489, instance_loss: 1.8744, weighted_loss: 3.9566, label: 0, bag_size: 603
batch 639, loss: 1.1506, instance_loss: 1.0409, weighted_loss: 1.1177, label: 0, bag_size: 621
batch 659, loss: 0.0091, instance_loss: 0.7173, weighted_loss: 0.2215, label: 1, bag_size: 4290
batch 679, loss: 0.0008, instance_loss: 0.2789, weighted_loss: 0.0842, label: 1, bag_size: 4578
batch 699, loss: 0.7176, instance_loss: 0.9280, weighted_loss: 0.7807, label: 1, bag_size: 2671
batch 719, loss: 0.4664, instance_loss: 0.7674, weighted_loss: 0.5567, label: 2, bag_size: 5406
batch 739, loss: 3.2766, instance_loss: 2.6434, weighted_loss: 3.0867, label: 1, bag_size: 3016


class 0 clustering acc 0.9628635346756153: correct 17216/17880
class 1 clustering acc 0.45167785234899327: correct 2692/5960
Epoch: 40, train_loss: 0.4575, train_clustering_loss:  0.5164, train_error: 0.2054
class 0: acc 0.859375, correct 220/256
class 1: acc 0.6986899563318777, correct 160/229
class 2: acc 0.8153846153846154, correct 212/260

Val Set, val_loss: 0.6732, val_error: 0.2872, auc: 0.9096
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.46675531914893614: correct 351/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1524, instance_loss: 0.1994, weighted_loss: 0.1665, label: 2, bag_size: 3172
batch 39, loss: 0.0120, instance_loss: 0.2586, weighted_loss: 0.0860, label: 0, bag_size: 5899
batch 59, loss: 0.2937, instance_loss: 0.3608, weighted_loss: 0.3139, label: 2, bag_size: 6298
batch 79, loss: 0.0252, instance_loss: 0.1235, weighted_loss: 0.0547, label: 2, bag_size: 3094
batch 99, loss: 0.5102, instance_loss: 1.3069, weighted_loss: 0.7492, label: 1, bag_size: 3016
batch 119, loss: 2.1185, instance_loss: 0.8860, weighted_loss: 1.7487, label: 0, bag_size: 3294
batch 139, loss: 0.8719, instance_loss: 0.7120, weighted_loss: 0.8239, label: 1, bag_size: 3009
batch 159, loss: 0.2021, instance_loss: 0.3603, weighted_loss: 0.2495, label: 2, bag_size: 3026
batch 179, loss: 0.0153, instance_loss: 0.0619, weighted_loss: 0.0293, label: 2, bag_size: 5138
batch 199, loss: 0.3604, instance_loss: 0.6983, weighted_loss: 0.4618, label: 0, bag_size: 2189
batch 219, loss: 0.4041, instance_loss: 0.6195, weighted_loss: 0.4687, label: 1, bag_size: 475
batch 239, loss: 0.1268, instance_loss: 0.1992, weighted_loss: 0.1485, label: 2, bag_size: 3172
batch 259, loss: 0.5196, instance_loss: 0.8066, weighted_loss: 0.6057, label: 0, bag_size: 3268
batch 279, loss: 0.0663, instance_loss: 0.3105, weighted_loss: 0.1395, label: 0, bag_size: 14070
batch 299, loss: 0.0978, instance_loss: 0.5611, weighted_loss: 0.2368, label: 0, bag_size: 420
batch 319, loss: 0.1407, instance_loss: 0.2373, weighted_loss: 0.1697, label: 0, bag_size: 1647
batch 339, loss: 0.0172, instance_loss: 0.3731, weighted_loss: 0.1240, label: 0, bag_size: 1140
batch 359, loss: 0.4405, instance_loss: 0.4085, weighted_loss: 0.4309, label: 2, bag_size: 4096
batch 379, loss: 0.1538, instance_loss: 0.4840, weighted_loss: 0.2528, label: 2, bag_size: 4140
batch 399, loss: 0.2226, instance_loss: 0.4521, weighted_loss: 0.2915, label: 2, bag_size: 614
batch 419, loss: 0.0007, instance_loss: 0.4919, weighted_loss: 0.1480, label: 2, bag_size: 2031
batch 439, loss: 0.2305, instance_loss: 0.4722, weighted_loss: 0.3030, label: 0, bag_size: 6430
batch 459, loss: 0.2727, instance_loss: 0.7574, weighted_loss: 0.4181, label: 0, bag_size: 889
batch 479, loss: 0.1313, instance_loss: 0.3417, weighted_loss: 0.1944, label: 1, bag_size: 2870
batch 499, loss: 0.7954, instance_loss: 0.7552, weighted_loss: 0.7833, label: 2, bag_size: 552
batch 519, loss: 0.5738, instance_loss: 0.6101, weighted_loss: 0.5847, label: 2, bag_size: 4316
batch 539, loss: 0.0528, instance_loss: 0.1692, weighted_loss: 0.0877, label: 0, bag_size: 3437
batch 559, loss: 0.4271, instance_loss: 0.5973, weighted_loss: 0.4782, label: 2, bag_size: 5743
batch 579, loss: 0.1318, instance_loss: 0.1524, weighted_loss: 0.1380, label: 2, bag_size: 597
batch 599, loss: 0.1958, instance_loss: 0.6657, weighted_loss: 0.3368, label: 1, bag_size: 3009
batch 619, loss: 0.5162, instance_loss: 0.3457, weighted_loss: 0.4651, label: 2, bag_size: 705
batch 639, loss: 2.3139, instance_loss: 1.9865, weighted_loss: 2.2157, label: 1, bag_size: 2229
batch 659, loss: 0.0098, instance_loss: 0.2841, weighted_loss: 0.0921, label: 0, bag_size: 4841
batch 679, loss: 0.0464, instance_loss: 0.0876, weighted_loss: 0.0587, label: 2, bag_size: 4910
batch 699, loss: 1.9956, instance_loss: 1.1100, weighted_loss: 1.7299, label: 0, bag_size: 7056
batch 719, loss: 0.3203, instance_loss: 0.3680, weighted_loss: 0.3346, label: 0, bag_size: 3571
batch 739, loss: 0.0015, instance_loss: 0.4143, weighted_loss: 0.1253, label: 2, bag_size: 2031


class 0 clustering acc 0.9633668903803132: correct 17225/17880
class 1 clustering acc 0.45536912751677855: correct 2714/5960
Epoch: 41, train_loss: 0.4932, train_clustering_loss:  0.5097, train_error: 0.1866
class 0: acc 0.7903930131004366, correct 181/229
class 1: acc 0.7212389380530974, correct 163/226
class 2: acc 0.903448275862069, correct 262/290

Val Set, val_loss: 0.7160, val_error: 0.2979, auc: 0.8802
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.3470744680851064: correct 261/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3670, instance_loss: 0.4836, weighted_loss: 0.4020, label: 2, bag_size: 1222
batch 39, loss: 0.9968, instance_loss: 0.5056, weighted_loss: 0.8494, label: 0, bag_size: 4647
batch 59, loss: 0.1632, instance_loss: 0.2456, weighted_loss: 0.1879, label: 0, bag_size: 3886
batch 79, loss: 0.3546, instance_loss: 0.3243, weighted_loss: 0.3455, label: 2, bag_size: 4291
batch 99, loss: 0.2854, instance_loss: 0.4637, weighted_loss: 0.3389, label: 1, bag_size: 2342
batch 119, loss: 0.0010, instance_loss: 0.3727, weighted_loss: 0.1125, label: 0, bag_size: 8088
batch 139, loss: 0.1010, instance_loss: 0.3313, weighted_loss: 0.1701, label: 0, bag_size: 3247
batch 159, loss: 0.2390, instance_loss: 0.2618, weighted_loss: 0.2458, label: 2, bag_size: 4571
batch 179, loss: 0.4160, instance_loss: 0.9510, weighted_loss: 0.5765, label: 0, bag_size: 3904
batch 199, loss: 1.0654, instance_loss: 0.5143, weighted_loss: 0.9001, label: 2, bag_size: 4788
batch 219, loss: 0.7919, instance_loss: 0.7150, weighted_loss: 0.7688, label: 0, bag_size: 4946
batch 239, loss: 0.6219, instance_loss: 0.7747, weighted_loss: 0.6678, label: 1, bag_size: 2671
batch 259, loss: 0.2085, instance_loss: 0.6607, weighted_loss: 0.3442, label: 1, bag_size: 2472
batch 279, loss: 0.0002, instance_loss: 0.3314, weighted_loss: 0.0996, label: 0, bag_size: 4403
batch 299, loss: 0.0004, instance_loss: 0.0411, weighted_loss: 0.0126, label: 1, bag_size: 460
batch 319, loss: 0.0004, instance_loss: 0.0337, weighted_loss: 0.0104, label: 1, bag_size: 259
batch 339, loss: 0.1505, instance_loss: 0.1946, weighted_loss: 0.1637, label: 2, bag_size: 4691
batch 359, loss: 0.2060, instance_loss: 0.5902, weighted_loss: 0.3213, label: 1, bag_size: 4373
batch 379, loss: 0.0992, instance_loss: 0.6103, weighted_loss: 0.2526, label: 0, bag_size: 4626
batch 399, loss: 0.0277, instance_loss: 0.5873, weighted_loss: 0.1955, label: 1, bag_size: 314
batch 419, loss: 0.1398, instance_loss: 0.4377, weighted_loss: 0.2292, label: 1, bag_size: 3619
batch 439, loss: 0.1805, instance_loss: 0.3310, weighted_loss: 0.2256, label: 1, bag_size: 1197
batch 459, loss: 0.3647, instance_loss: 0.7647, weighted_loss: 0.4847, label: 0, bag_size: 477
batch 479, loss: 0.0251, instance_loss: 0.5977, weighted_loss: 0.1969, label: 0, bag_size: 3539
batch 499, loss: 0.0156, instance_loss: 0.2286, weighted_loss: 0.0795, label: 0, bag_size: 829
batch 519, loss: 0.0657, instance_loss: 0.1332, weighted_loss: 0.0860, label: 2, bag_size: 3583
batch 539, loss: 0.0002, instance_loss: 0.0927, weighted_loss: 0.0280, label: 0, bag_size: 3641
batch 559, loss: 0.2233, instance_loss: 0.5829, weighted_loss: 0.3312, label: 1, bag_size: 1906
batch 579, loss: 1.8502, instance_loss: 0.8562, weighted_loss: 1.5520, label: 1, bag_size: 1371
batch 599, loss: 0.5644, instance_loss: 0.7437, weighted_loss: 0.6182, label: 2, bag_size: 4569
batch 619, loss: 0.1075, instance_loss: 0.2905, weighted_loss: 0.1624, label: 1, bag_size: 3534
batch 639, loss: 0.0176, instance_loss: 0.1952, weighted_loss: 0.0709, label: 0, bag_size: 3986
batch 659, loss: 0.2186, instance_loss: 0.3722, weighted_loss: 0.2646, label: 2, bag_size: 3026
batch 679, loss: 0.1655, instance_loss: 0.2202, weighted_loss: 0.1819, label: 0, bag_size: 4909
batch 699, loss: 3.4060, instance_loss: 1.8274, weighted_loss: 2.9324, label: 2, bag_size: 4179
batch 719, loss: 0.9162, instance_loss: 0.8952, weighted_loss: 0.9099, label: 1, bag_size: 2751
batch 739, loss: 0.1878, instance_loss: 0.4399, weighted_loss: 0.2635, label: 1, bag_size: 210


class 0 clustering acc 0.9650447427293065: correct 17255/17880
class 1 clustering acc 0.4174496644295302: correct 2488/5960
Epoch: 42, train_loss: 0.4794, train_clustering_loss:  0.5262, train_error: 0.1879
class 0: acc 0.8054298642533937, correct 178/221
class 1: acc 0.7709923664122137, correct 202/262
class 2: acc 0.8587786259541985, correct 225/262

Val Set, val_loss: 0.7311, val_error: 0.2979, auc: 0.8794
class 0 clustering acc 0.9778368794326241: correct 2206/2256
class 1 clustering acc 0.24468085106382978: correct 184/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1114, instance_loss: 1.5717, weighted_loss: 0.5494, label: 1, bag_size: 5084
batch 39, loss: 0.3025, instance_loss: 0.2223, weighted_loss: 0.2784, label: 2, bag_size: 1103
batch 59, loss: 0.0023, instance_loss: 0.1811, weighted_loss: 0.0559, label: 2, bag_size: 4775
batch 79, loss: 0.5143, instance_loss: 0.4025, weighted_loss: 0.4808, label: 0, bag_size: 702
batch 99, loss: 0.0630, instance_loss: 0.2949, weighted_loss: 0.1325, label: 0, bag_size: 5953
batch 119, loss: 1.7910, instance_loss: 0.7810, weighted_loss: 1.4880, label: 2, bag_size: 705
batch 139, loss: 0.0784, instance_loss: 0.2941, weighted_loss: 0.1431, label: 0, bag_size: 5950
batch 159, loss: 1.0888, instance_loss: 0.8983, weighted_loss: 1.0317, label: 1, bag_size: 5873
batch 179, loss: 0.6557, instance_loss: 0.9154, weighted_loss: 0.7336, label: 1, bag_size: 5873
batch 199, loss: 0.2161, instance_loss: 0.3726, weighted_loss: 0.2631, label: 2, bag_size: 3174
batch 219, loss: 0.2416, instance_loss: 0.9139, weighted_loss: 0.4433, label: 0, bag_size: 3164
batch 239, loss: 0.0231, instance_loss: 0.5526, weighted_loss: 0.1820, label: 0, bag_size: 1655
batch 259, loss: 0.2208, instance_loss: 0.2478, weighted_loss: 0.2289, label: 2, bag_size: 5307
batch 279, loss: 0.8100, instance_loss: 1.0202, weighted_loss: 0.8731, label: 1, bag_size: 11974
batch 299, loss: 1.3055, instance_loss: 0.5810, weighted_loss: 1.0882, label: 2, bag_size: 4241
batch 319, loss: 0.1066, instance_loss: 0.1704, weighted_loss: 0.1258, label: 2, bag_size: 3026
batch 339, loss: 0.4640, instance_loss: 0.3793, weighted_loss: 0.4386, label: 0, bag_size: 5413
batch 359, loss: 0.5382, instance_loss: 0.7713, weighted_loss: 0.6081, label: 2, bag_size: 3618
batch 379, loss: 0.0127, instance_loss: 0.1928, weighted_loss: 0.0668, label: 0, bag_size: 1087
batch 399, loss: 0.0200, instance_loss: 0.4522, weighted_loss: 0.1496, label: 1, bag_size: 3558
batch 419, loss: 0.2634, instance_loss: 0.2776, weighted_loss: 0.2677, label: 2, bag_size: 3176
batch 439, loss: 0.0211, instance_loss: 0.3544, weighted_loss: 0.1211, label: 2, bag_size: 4745
batch 459, loss: 0.9475, instance_loss: 1.0883, weighted_loss: 0.9897, label: 1, bag_size: 3424
batch 479, loss: 0.4221, instance_loss: 0.5821, weighted_loss: 0.4701, label: 1, bag_size: 3009
batch 499, loss: 0.0035, instance_loss: 0.0390, weighted_loss: 0.0141, label: 2, bag_size: 4203
batch 519, loss: 0.2293, instance_loss: 0.2394, weighted_loss: 0.2323, label: 2, bag_size: 3174
batch 539, loss: 1.5213, instance_loss: 0.4950, weighted_loss: 1.2134, label: 0, bag_size: 5108
batch 559, loss: 0.0423, instance_loss: 0.2451, weighted_loss: 0.1031, label: 2, bag_size: 4497
batch 579, loss: 0.1796, instance_loss: 0.2839, weighted_loss: 0.2109, label: 2, bag_size: 2049
batch 599, loss: 0.5925, instance_loss: 0.6384, weighted_loss: 0.6062, label: 1, bag_size: 2342
batch 619, loss: 0.1558, instance_loss: 0.5524, weighted_loss: 0.2748, label: 1, bag_size: 2865
batch 639, loss: 0.6905, instance_loss: 0.4675, weighted_loss: 0.6236, label: 1, bag_size: 1410
batch 659, loss: 0.3731, instance_loss: 0.8700, weighted_loss: 0.5221, label: 1, bag_size: 4940
batch 679, loss: 0.0304, instance_loss: 0.5112, weighted_loss: 0.1746, label: 0, bag_size: 3445
batch 699, loss: 0.0201, instance_loss: 0.2686, weighted_loss: 0.0947, label: 0, bag_size: 2306
batch 719, loss: 0.0916, instance_loss: 0.2738, weighted_loss: 0.1463, label: 0, bag_size: 4157
batch 739, loss: 0.4213, instance_loss: 0.3435, weighted_loss: 0.3980, label: 2, bag_size: 2905


class 0 clustering acc 0.9637024608501119: correct 17231/17880
class 1 clustering acc 0.4291946308724832: correct 2558/5960
Epoch: 43, train_loss: 0.4945, train_clustering_loss:  0.5363, train_error: 0.2054
class 0: acc 0.8244897959183674, correct 202/245
class 1: acc 0.6991869918699187, correct 172/246
class 2: acc 0.8582677165354331, correct 218/254

Val Set, val_loss: 0.6086, val_error: 0.2447, auc: 0.8958
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.3550531914893617: correct 267/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5490, instance_loss: 0.5650, weighted_loss: 0.5538, label: 1, bag_size: 3396
batch 39, loss: 0.9369, instance_loss: 0.8064, weighted_loss: 0.8977, label: 2, bag_size: 4342
batch 59, loss: 0.1419, instance_loss: 0.6555, weighted_loss: 0.2960, label: 1, bag_size: 4940
batch 79, loss: 0.0040, instance_loss: 0.3812, weighted_loss: 0.1172, label: 0, bag_size: 1485
batch 99, loss: 1.4149, instance_loss: 1.2961, weighted_loss: 1.3793, label: 2, bag_size: 3299
batch 119, loss: 0.5654, instance_loss: 0.5770, weighted_loss: 0.5688, label: 1, bag_size: 2945
batch 139, loss: 0.2856, instance_loss: 0.1805, weighted_loss: 0.2541, label: 0, bag_size: 873
batch 159, loss: 0.8229, instance_loss: 0.9520, weighted_loss: 0.8616, label: 2, bag_size: 5072
batch 179, loss: 0.4287, instance_loss: 0.6809, weighted_loss: 0.5044, label: 0, bag_size: 4946
batch 199, loss: 0.7304, instance_loss: 0.4396, weighted_loss: 0.6431, label: 2, bag_size: 5426
batch 219, loss: 0.4385, instance_loss: 0.8929, weighted_loss: 0.5748, label: 1, bag_size: 2671
batch 239, loss: 0.3717, instance_loss: 0.4712, weighted_loss: 0.4015, label: 0, bag_size: 5041
batch 259, loss: 0.3013, instance_loss: 0.5408, weighted_loss: 0.3732, label: 1, bag_size: 4119
batch 279, loss: 0.0079, instance_loss: 0.3463, weighted_loss: 0.1094, label: 0, bag_size: 4147
batch 299, loss: 1.5954, instance_loss: 0.9711, weighted_loss: 1.4081, label: 0, bag_size: 15388
batch 319, loss: 0.0003, instance_loss: 0.2333, weighted_loss: 0.0702, label: 1, bag_size: 3172
batch 339, loss: 0.0310, instance_loss: 0.3776, weighted_loss: 0.1350, label: 0, bag_size: 3339
batch 359, loss: 0.0069, instance_loss: 0.5342, weighted_loss: 0.1651, label: 1, bag_size: 4290
batch 379, loss: 0.6188, instance_loss: 0.7001, weighted_loss: 0.6432, label: 2, bag_size: 6298
batch 399, loss: 0.7442, instance_loss: 0.7812, weighted_loss: 0.7553, label: 1, bag_size: 2744
batch 419, loss: 0.1821, instance_loss: 0.2503, weighted_loss: 0.2026, label: 2, bag_size: 4302
batch 439, loss: 0.1993, instance_loss: 0.6694, weighted_loss: 0.3403, label: 0, bag_size: 4531
batch 459, loss: 0.0824, instance_loss: 0.4455, weighted_loss: 0.1913, label: 0, bag_size: 5953
batch 479, loss: 0.5348, instance_loss: 0.5592, weighted_loss: 0.5422, label: 1, bag_size: 4644
batch 499, loss: 0.7309, instance_loss: 0.8424, weighted_loss: 0.7644, label: 2, bag_size: 2813
batch 519, loss: 0.9691, instance_loss: 0.7620, weighted_loss: 0.9070, label: 1, bag_size: 5718
batch 539, loss: 0.4600, instance_loss: 0.3564, weighted_loss: 0.4289, label: 2, bag_size: 597
batch 559, loss: 0.7604, instance_loss: 0.7441, weighted_loss: 0.7555, label: 1, bag_size: 5276
batch 579, loss: 2.6094, instance_loss: 1.8763, weighted_loss: 2.3895, label: 1, bag_size: 3159
batch 599, loss: 0.0004, instance_loss: 0.2943, weighted_loss: 0.0886, label: 2, bag_size: 4569
batch 619, loss: 0.3251, instance_loss: 0.5844, weighted_loss: 0.4029, label: 1, bag_size: 4184
batch 639, loss: 0.8099, instance_loss: 0.7964, weighted_loss: 0.8058, label: 1, bag_size: 1307
batch 659, loss: 0.0050, instance_loss: 0.1286, weighted_loss: 0.0421, label: 0, bag_size: 3438
batch 679, loss: 0.0108, instance_loss: 0.2012, weighted_loss: 0.0679, label: 1, bag_size: 4181
batch 699, loss: 0.3033, instance_loss: 0.2817, weighted_loss: 0.2968, label: 0, bag_size: 5036
batch 719, loss: 0.0520, instance_loss: 0.1225, weighted_loss: 0.0732, label: 0, bag_size: 3649
batch 739, loss: 0.4893, instance_loss: 0.7470, weighted_loss: 0.5666, label: 1, bag_size: 3367


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.37785234899328857: correct 2252/5960
Epoch: 44, train_loss: 0.5224, train_clustering_loss:  0.5372, train_error: 0.2242
class 0: acc 0.7905982905982906, correct 185/234
class 1: acc 0.7198443579766537, correct 185/257
class 2: acc 0.8188976377952756, correct 208/254

Val Set, val_loss: 0.6519, val_error: 0.2660, auc: 0.9090
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.4720744680851064: correct 355/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.1726, instance_loss: 1.3203, weighted_loss: 1.2169, label: 2, bag_size: 3299
batch 39, loss: 0.1915, instance_loss: 0.6712, weighted_loss: 0.3354, label: 1, bag_size: 3391
batch 59, loss: 0.0434, instance_loss: 0.1375, weighted_loss: 0.0716, label: 2, bag_size: 3415
batch 79, loss: 0.0058, instance_loss: 0.4551, weighted_loss: 0.1406, label: 1, bag_size: 10941
batch 99, loss: 0.0746, instance_loss: 0.1325, weighted_loss: 0.0920, label: 2, bag_size: 6001
batch 119, loss: 0.7417, instance_loss: 0.5485, weighted_loss: 0.6837, label: 0, bag_size: 7315
batch 139, loss: 0.0545, instance_loss: 0.1498, weighted_loss: 0.0831, label: 0, bag_size: 6430
batch 159, loss: 0.3696, instance_loss: 0.4978, weighted_loss: 0.4081, label: 1, bag_size: 712
batch 179, loss: 0.0033, instance_loss: 0.1268, weighted_loss: 0.0404, label: 0, bag_size: 6221
batch 199, loss: 0.3029, instance_loss: 0.5736, weighted_loss: 0.3841, label: 2, bag_size: 4291
batch 219, loss: 0.0298, instance_loss: 0.2637, weighted_loss: 0.1000, label: 1, bag_size: 1023
batch 239, loss: 0.7893, instance_loss: 0.7076, weighted_loss: 0.7648, label: 0, bag_size: 640
batch 259, loss: 0.0864, instance_loss: 0.5289, weighted_loss: 0.2192, label: 1, bag_size: 5756
batch 279, loss: 0.0109, instance_loss: 0.1187, weighted_loss: 0.0433, label: 1, bag_size: 758
batch 299, loss: 0.3725, instance_loss: 0.3543, weighted_loss: 0.3670, label: 0, bag_size: 3294
batch 319, loss: 0.6245, instance_loss: 0.6032, weighted_loss: 0.6181, label: 1, bag_size: 5412
batch 339, loss: 0.0062, instance_loss: 0.5845, weighted_loss: 0.1797, label: 0, bag_size: 3920
batch 359, loss: 0.2007, instance_loss: 0.6205, weighted_loss: 0.3267, label: 1, bag_size: 1221
batch 379, loss: 0.0304, instance_loss: 0.4644, weighted_loss: 0.1606, label: 1, bag_size: 3761
batch 399, loss: 0.1683, instance_loss: 0.3923, weighted_loss: 0.2355, label: 1, bag_size: 2753
batch 419, loss: 0.2981, instance_loss: 0.5690, weighted_loss: 0.3794, label: 1, bag_size: 5728
batch 439, loss: 3.3060, instance_loss: 1.6862, weighted_loss: 2.8201, label: 1, bag_size: 2425
batch 459, loss: 0.9364, instance_loss: 0.6339, weighted_loss: 0.8457, label: 1, bag_size: 6241
batch 479, loss: 0.3105, instance_loss: 0.4624, weighted_loss: 0.3561, label: 1, bag_size: 5718
batch 499, loss: 3.1898, instance_loss: 0.9437, weighted_loss: 2.5160, label: 1, bag_size: 32
batch 519, loss: 1.7047, instance_loss: 1.0084, weighted_loss: 1.4958, label: 0, bag_size: 5098
batch 539, loss: 0.3187, instance_loss: 0.4250, weighted_loss: 0.3506, label: 2, bag_size: 705
batch 559, loss: 0.0068, instance_loss: 0.2689, weighted_loss: 0.0855, label: 0, bag_size: 3182
batch 579, loss: 1.2839, instance_loss: 1.2606, weighted_loss: 1.2769, label: 1, bag_size: 1371
batch 599, loss: 0.2559, instance_loss: 0.3882, weighted_loss: 0.2956, label: 2, bag_size: 4291
batch 619, loss: 0.1287, instance_loss: 0.7798, weighted_loss: 0.3241, label: 0, bag_size: 2257
batch 639, loss: 0.7712, instance_loss: 0.8211, weighted_loss: 0.7862, label: 2, bag_size: 361
batch 659, loss: 0.0666, instance_loss: 0.1761, weighted_loss: 0.0995, label: 0, bag_size: 1845
batch 679, loss: 1.3766, instance_loss: 1.2119, weighted_loss: 1.3272, label: 1, bag_size: 1580
batch 699, loss: 0.0155, instance_loss: 0.2781, weighted_loss: 0.0943, label: 1, bag_size: 3761
batch 719, loss: 0.3868, instance_loss: 0.4788, weighted_loss: 0.4144, label: 2, bag_size: 614
batch 739, loss: 0.0379, instance_loss: 0.1832, weighted_loss: 0.0815, label: 0, bag_size: 1947


class 0 clustering acc 0.9659395973154362: correct 17271/17880
class 1 clustering acc 0.4083892617449664: correct 2434/5960
Epoch: 45, train_loss: 0.5142, train_clustering_loss:  0.5377, train_error: 0.2148
class 0: acc 0.792156862745098, correct 202/255
class 1: acc 0.7230769230769231, correct 188/260
class 2: acc 0.8478260869565217, correct 195/230

Val Set, val_loss: 0.8878, val_error: 0.3298, auc: 0.8546
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.25: correct 188/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0188, instance_loss: 0.2207, weighted_loss: 0.0794, label: 2, bag_size: 4140
batch 39, loss: 1.8874, instance_loss: 0.6969, weighted_loss: 1.5302, label: 0, bag_size: 3310
batch 59, loss: 0.0009, instance_loss: 0.2854, weighted_loss: 0.0863, label: 0, bag_size: 1744
batch 79, loss: 0.1983, instance_loss: 0.4216, weighted_loss: 0.2653, label: 2, bag_size: 5472
batch 99, loss: 0.0385, instance_loss: 0.0951, weighted_loss: 0.0555, label: 2, bag_size: 2209
batch 119, loss: 0.3255, instance_loss: 0.4486, weighted_loss: 0.3625, label: 2, bag_size: 3778
batch 139, loss: 0.1492, instance_loss: 0.2582, weighted_loss: 0.1819, label: 2, bag_size: 2997
batch 159, loss: 0.4726, instance_loss: 0.7464, weighted_loss: 0.5547, label: 1, bag_size: 5011
batch 179, loss: 0.1264, instance_loss: 0.2214, weighted_loss: 0.1549, label: 2, bag_size: 4745
batch 199, loss: 0.2102, instance_loss: 0.6158, weighted_loss: 0.3319, label: 0, bag_size: 2983
batch 219, loss: 0.3991, instance_loss: 0.5798, weighted_loss: 0.4533, label: 2, bag_size: 728
batch 239, loss: 0.1569, instance_loss: 0.3054, weighted_loss: 0.2015, label: 0, bag_size: 2671
batch 259, loss: 0.0878, instance_loss: 0.4763, weighted_loss: 0.2043, label: 1, bag_size: 2092
batch 279, loss: 0.0258, instance_loss: 0.5587, weighted_loss: 0.1857, label: 1, bag_size: 3367
batch 299, loss: 0.6731, instance_loss: 0.5579, weighted_loss: 0.6385, label: 2, bag_size: 3026
batch 319, loss: 0.0097, instance_loss: 0.1597, weighted_loss: 0.0547, label: 0, bag_size: 6863
batch 339, loss: 0.0989, instance_loss: 0.4367, weighted_loss: 0.2003, label: 0, bag_size: 3289
batch 359, loss: 0.7299, instance_loss: 0.6844, weighted_loss: 0.7162, label: 1, bag_size: 4812
batch 379, loss: 1.5841, instance_loss: 1.1316, weighted_loss: 1.4484, label: 1, bag_size: 1122
batch 399, loss: 0.1401, instance_loss: 0.2159, weighted_loss: 0.1629, label: 2, bag_size: 6273
batch 419, loss: 0.4279, instance_loss: 0.6752, weighted_loss: 0.5021, label: 1, bag_size: 3935
batch 439, loss: 0.3011, instance_loss: 0.4571, weighted_loss: 0.3479, label: 0, bag_size: 2286
batch 459, loss: 2.0664, instance_loss: 1.3762, weighted_loss: 1.8593, label: 2, bag_size: 7607
batch 479, loss: 0.1327, instance_loss: 0.2767, weighted_loss: 0.1759, label: 2, bag_size: 5011
batch 499, loss: 0.0960, instance_loss: 0.3591, weighted_loss: 0.1749, label: 0, bag_size: 4131
batch 519, loss: 0.1681, instance_loss: 0.5318, weighted_loss: 0.2772, label: 1, bag_size: 3497
batch 539, loss: 1.8412, instance_loss: 0.9715, weighted_loss: 1.5803, label: 1, bag_size: 5423
batch 559, loss: 0.1784, instance_loss: 0.4114, weighted_loss: 0.2483, label: 2, bag_size: 4535
batch 579, loss: 0.0024, instance_loss: 0.1867, weighted_loss: 0.0577, label: 1, bag_size: 1836
batch 599, loss: 0.1442, instance_loss: 0.2281, weighted_loss: 0.1694, label: 2, bag_size: 2997
batch 619, loss: 0.7682, instance_loss: 0.8020, weighted_loss: 0.7783, label: 1, bag_size: 2671
batch 639, loss: 0.0917, instance_loss: 0.6674, weighted_loss: 0.2644, label: 1, bag_size: 3534
batch 659, loss: 0.4547, instance_loss: 0.5660, weighted_loss: 0.4881, label: 0, bag_size: 5373
batch 679, loss: 0.0363, instance_loss: 0.1922, weighted_loss: 0.0831, label: 1, bag_size: 5167
batch 699, loss: 0.0204, instance_loss: 0.3194, weighted_loss: 0.1101, label: 0, bag_size: 6015
batch 719, loss: 0.0009, instance_loss: 0.2052, weighted_loss: 0.0622, label: 2, bag_size: 4141
batch 739, loss: 1.4450, instance_loss: 0.9895, weighted_loss: 1.3083, label: 0, bag_size: 3475


class 0 clustering acc 0.9677293064876957: correct 17303/17880
class 1 clustering acc 0.4092281879194631: correct 2439/5960
Epoch: 46, train_loss: 0.5165, train_clustering_loss:  0.5207, train_error: 0.2148
class 0: acc 0.8065843621399177, correct 196/243
class 1: acc 0.6747967479674797, correct 166/246
class 2: acc 0.87109375, correct 223/256

Val Set, val_loss: 0.6458, val_error: 0.3085, auc: 0.8895
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.40425531914893614: correct 304/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.8600, instance_loss: 0.9090, weighted_loss: 1.5747, label: 2, bag_size: 4316
batch 39, loss: 0.7960, instance_loss: 0.4991, weighted_loss: 0.7069, label: 0, bag_size: 702
batch 59, loss: 0.1021, instance_loss: 0.3367, weighted_loss: 0.1725, label: 0, bag_size: 2601
batch 79, loss: 0.1874, instance_loss: 0.5740, weighted_loss: 0.3034, label: 0, bag_size: 5011
batch 99, loss: 3.7203, instance_loss: 1.7468, weighted_loss: 3.1283, label: 0, bag_size: 557
batch 119, loss: 0.1994, instance_loss: 0.6165, weighted_loss: 0.3245, label: 1, bag_size: 1042
batch 139, loss: 0.0017, instance_loss: 0.1646, weighted_loss: 0.0506, label: 0, bag_size: 5459
batch 159, loss: 0.0718, instance_loss: 0.2630, weighted_loss: 0.1291, label: 0, bag_size: 2897
batch 179, loss: 0.0048, instance_loss: 0.1933, weighted_loss: 0.0614, label: 0, bag_size: 7595
batch 199, loss: 1.1619, instance_loss: 0.8377, weighted_loss: 1.0646, label: 2, bag_size: 4571
batch 219, loss: 0.8649, instance_loss: 0.7625, weighted_loss: 0.8342, label: 2, bag_size: 22464
batch 239, loss: 0.1099, instance_loss: 0.1618, weighted_loss: 0.1255, label: 0, bag_size: 1018
batch 259, loss: 0.3727, instance_loss: 0.6033, weighted_loss: 0.4419, label: 2, bag_size: 223
batch 279, loss: 0.0066, instance_loss: 0.2134, weighted_loss: 0.0686, label: 0, bag_size: 5899
batch 299, loss: 0.5337, instance_loss: 0.7749, weighted_loss: 0.6061, label: 1, bag_size: 2472
batch 319, loss: 0.0048, instance_loss: 0.2883, weighted_loss: 0.0898, label: 1, bag_size: 4111
batch 339, loss: 0.0137, instance_loss: 0.1104, weighted_loss: 0.0427, label: 2, bag_size: 3607
batch 359, loss: 1.2532, instance_loss: 1.2105, weighted_loss: 1.2404, label: 1, bag_size: 4806
batch 379, loss: 4.7681, instance_loss: 1.9929, weighted_loss: 3.9355, label: 1, bag_size: 3791
batch 399, loss: 0.0035, instance_loss: 0.1124, weighted_loss: 0.0362, label: 1, bag_size: 1836
batch 419, loss: 0.3200, instance_loss: 0.4258, weighted_loss: 0.3518, label: 0, bag_size: 3571
batch 439, loss: 0.3619, instance_loss: 0.5482, weighted_loss: 0.4178, label: 0, bag_size: 2850
batch 459, loss: 0.1060, instance_loss: 0.2091, weighted_loss: 0.1369, label: 2, bag_size: 5011
batch 479, loss: 0.1545, instance_loss: 0.7089, weighted_loss: 0.3208, label: 1, bag_size: 2643
batch 499, loss: 0.0022, instance_loss: 0.0590, weighted_loss: 0.0192, label: 0, bag_size: 6863
batch 519, loss: 4.3071, instance_loss: 1.2346, weighted_loss: 3.3853, label: 1, bag_size: 32
batch 539, loss: 0.0076, instance_loss: 0.1745, weighted_loss: 0.0576, label: 1, bag_size: 596
batch 559, loss: 0.1212, instance_loss: 0.1997, weighted_loss: 0.1448, label: 1, bag_size: 3604
batch 579, loss: 0.2962, instance_loss: 0.9107, weighted_loss: 0.4805, label: 0, bag_size: 1106
batch 599, loss: 3.1331, instance_loss: 1.3388, weighted_loss: 2.5948, label: 2, bag_size: 2326
batch 619, loss: 0.7422, instance_loss: 0.9008, weighted_loss: 0.7898, label: 0, bag_size: 6630
batch 639, loss: 0.0916, instance_loss: 0.1097, weighted_loss: 0.0970, label: 2, bag_size: 2997
batch 659, loss: 0.0587, instance_loss: 0.1601, weighted_loss: 0.0891, label: 0, bag_size: 4455
batch 679, loss: 1.1758, instance_loss: 0.9366, weighted_loss: 1.1040, label: 2, bag_size: 5406
batch 699, loss: 0.7319, instance_loss: 1.0099, weighted_loss: 0.8153, label: 0, bag_size: 2044
batch 719, loss: 0.0449, instance_loss: 0.6398, weighted_loss: 0.2234, label: 1, bag_size: 3534
batch 739, loss: 0.0564, instance_loss: 0.2441, weighted_loss: 0.1127, label: 2, bag_size: 5138


class 0 clustering acc 0.9639261744966443: correct 17235/17880
class 1 clustering acc 0.4825503355704698: correct 2876/5960
Epoch: 47, train_loss: 0.4418, train_clustering_loss:  0.4962, train_error: 0.1745
class 0: acc 0.8597785977859779, correct 233/271
class 1: acc 0.7435897435897436, correct 174/234
class 2: acc 0.8666666666666667, correct 208/240

Val Set, val_loss: 0.7005, val_error: 0.2979, auc: 0.8814
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.28856382978723405: correct 217/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4658, instance_loss: 0.5491, weighted_loss: 0.4908, label: 2, bag_size: 5743
batch 39, loss: 0.1867, instance_loss: 0.4803, weighted_loss: 0.2748, label: 1, bag_size: 6156
batch 59, loss: 0.2090, instance_loss: 0.5142, weighted_loss: 0.3005, label: 1, bag_size: 2865
batch 79, loss: 0.7209, instance_loss: 0.8342, weighted_loss: 0.7549, label: 1, bag_size: 3986
batch 99, loss: 0.0125, instance_loss: 0.3501, weighted_loss: 0.1138, label: 0, bag_size: 5899
batch 119, loss: 1.2371, instance_loss: 0.8687, weighted_loss: 1.1266, label: 0, bag_size: 1808
batch 139, loss: 0.0000, instance_loss: 0.0918, weighted_loss: 0.0275, label: 0, bag_size: 4918
batch 159, loss: 0.1740, instance_loss: 0.1577, weighted_loss: 0.1691, label: 0, bag_size: 4325
batch 179, loss: 0.0014, instance_loss: 0.0501, weighted_loss: 0.0160, label: 1, bag_size: 460
batch 199, loss: 0.6279, instance_loss: 0.5978, weighted_loss: 0.6189, label: 2, bag_size: 1050
batch 219, loss: 0.1868, instance_loss: 0.2703, weighted_loss: 0.2119, label: 0, bag_size: 1762
batch 239, loss: 2.2429, instance_loss: 1.0498, weighted_loss: 1.8850, label: 0, bag_size: 877
batch 259, loss: 0.1254, instance_loss: 0.2152, weighted_loss: 0.1523, label: 2, bag_size: 4056
batch 279, loss: 0.0322, instance_loss: 0.1413, weighted_loss: 0.0649, label: 2, bag_size: 2770
batch 299, loss: 0.6755, instance_loss: 0.7063, weighted_loss: 0.6847, label: 1, bag_size: 3823
batch 319, loss: 0.0154, instance_loss: 0.1973, weighted_loss: 0.0699, label: 1, bag_size: 3677
batch 339, loss: 0.3561, instance_loss: 0.2278, weighted_loss: 0.3176, label: 0, bag_size: 4562
batch 359, loss: 0.0995, instance_loss: 0.6287, weighted_loss: 0.2582, label: 0, bag_size: 4398
batch 379, loss: 0.5786, instance_loss: 0.4133, weighted_loss: 0.5290, label: 0, bag_size: 702
batch 399, loss: 0.6713, instance_loss: 0.5485, weighted_loss: 0.6344, label: 1, bag_size: 3106
batch 419, loss: 0.7703, instance_loss: 0.4101, weighted_loss: 0.6622, label: 0, bag_size: 1782
batch 439, loss: 0.0384, instance_loss: 0.1354, weighted_loss: 0.0675, label: 0, bag_size: 5782
batch 459, loss: 0.0920, instance_loss: 0.1707, weighted_loss: 0.1156, label: 0, bag_size: 4648
batch 479, loss: 0.0233, instance_loss: 0.2311, weighted_loss: 0.0856, label: 2, bag_size: 3607
batch 499, loss: 0.3833, instance_loss: 0.3736, weighted_loss: 0.3804, label: 2, bag_size: 3546
batch 519, loss: 0.0590, instance_loss: 0.1204, weighted_loss: 0.0774, label: 2, bag_size: 2254
batch 539, loss: 0.2044, instance_loss: 0.8424, weighted_loss: 0.3958, label: 1, bag_size: 2472
batch 559, loss: 0.6241, instance_loss: 0.6277, weighted_loss: 0.6252, label: 1, bag_size: 2743
batch 579, loss: 0.4941, instance_loss: 0.5551, weighted_loss: 0.5124, label: 2, bag_size: 4571
batch 599, loss: 0.0040, instance_loss: 0.4629, weighted_loss: 0.1417, label: 2, bag_size: 2031
batch 619, loss: 0.4220, instance_loss: 2.1915, weighted_loss: 0.9529, label: 1, bag_size: 3016
batch 639, loss: 0.1961, instance_loss: 0.2712, weighted_loss: 0.2186, label: 2, bag_size: 5138
batch 659, loss: 0.0103, instance_loss: 0.2439, weighted_loss: 0.0804, label: 1, bag_size: 2878
batch 679, loss: 0.2886, instance_loss: 0.6423, weighted_loss: 0.3947, label: 1, bag_size: 2182
batch 699, loss: 0.4162, instance_loss: 0.4801, weighted_loss: 0.4353, label: 1, bag_size: 5412
batch 719, loss: 0.0500, instance_loss: 0.1338, weighted_loss: 0.0751, label: 2, bag_size: 2313
batch 739, loss: 0.0136, instance_loss: 0.0915, weighted_loss: 0.0370, label: 1, bag_size: 2767


class 0 clustering acc 0.9645973154362416: correct 17247/17880
class 1 clustering acc 0.4557046979865772: correct 2716/5960
Epoch: 48, train_loss: 0.4473, train_clustering_loss:  0.5083, train_error: 0.1705
class 0: acc 0.8484848484848485, correct 224/264
class 1: acc 0.7469879518072289, correct 186/249
class 2: acc 0.896551724137931, correct 208/232

Val Set, val_loss: 0.8939, val_error: 0.3511, auc: 0.8495
class 0 clustering acc 0.975177304964539: correct 2200/2256
class 1 clustering acc 0.2154255319148936: correct 162/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4876, instance_loss: 0.5776, weighted_loss: 0.5146, label: 2, bag_size: 5743
batch 39, loss: 0.0112, instance_loss: 0.1627, weighted_loss: 0.0567, label: 0, bag_size: 4797
batch 59, loss: 6.0049, instance_loss: 1.1537, weighted_loss: 4.5495, label: 2, bag_size: 361
batch 79, loss: 0.2252, instance_loss: 0.2608, weighted_loss: 0.2359, label: 2, bag_size: 4910
batch 99, loss: 0.0014, instance_loss: 0.1723, weighted_loss: 0.0527, label: 2, bag_size: 2422
batch 119, loss: 0.7779, instance_loss: 0.8276, weighted_loss: 0.7928, label: 1, bag_size: 3640
batch 139, loss: 0.0049, instance_loss: 0.2143, weighted_loss: 0.0677, label: 1, bag_size: 3677
batch 159, loss: 0.1182, instance_loss: 0.2619, weighted_loss: 0.1613, label: 0, bag_size: 3690
batch 179, loss: 0.0000, instance_loss: 0.0673, weighted_loss: 0.0202, label: 1, bag_size: 6277
batch 199, loss: 0.1051, instance_loss: 0.3467, weighted_loss: 0.1775, label: 2, bag_size: 5472
batch 219, loss: 0.3375, instance_loss: 0.6853, weighted_loss: 0.4418, label: 1, bag_size: 1906
batch 239, loss: 0.1896, instance_loss: 0.2898, weighted_loss: 0.2196, label: 2, bag_size: 3396
batch 259, loss: 0.1013, instance_loss: 0.3275, weighted_loss: 0.1692, label: 0, bag_size: 1018
batch 279, loss: 0.1672, instance_loss: 0.5323, weighted_loss: 0.2767, label: 0, bag_size: 3871
batch 299, loss: 0.0315, instance_loss: 0.1408, weighted_loss: 0.0643, label: 2, bag_size: 2209
batch 319, loss: 0.2739, instance_loss: 0.3494, weighted_loss: 0.2966, label: 2, bag_size: 705
batch 339, loss: 0.5484, instance_loss: 0.6066, weighted_loss: 0.5659, label: 1, bag_size: 2905
batch 359, loss: 0.2127, instance_loss: 0.2431, weighted_loss: 0.2218, label: 0, bag_size: 4909
batch 379, loss: 0.0608, instance_loss: 0.4476, weighted_loss: 0.1768, label: 1, bag_size: 3471
batch 399, loss: 0.0282, instance_loss: 0.1561, weighted_loss: 0.0666, label: 2, bag_size: 5924
batch 419, loss: 0.1625, instance_loss: 0.1292, weighted_loss: 0.1525, label: 2, bag_size: 5307
batch 439, loss: 0.1920, instance_loss: 0.4833, weighted_loss: 0.2794, label: 1, bag_size: 3558
batch 459, loss: 0.1958, instance_loss: 0.7438, weighted_loss: 0.3602, label: 1, bag_size: 1221
batch 479, loss: 0.1114, instance_loss: 0.2579, weighted_loss: 0.1553, label: 2, bag_size: 2049
batch 499, loss: 0.7519, instance_loss: 0.4875, weighted_loss: 0.6726, label: 0, bag_size: 1744
batch 519, loss: 0.3854, instance_loss: 0.5107, weighted_loss: 0.4230, label: 2, bag_size: 5406
batch 539, loss: 1.4570, instance_loss: 1.1729, weighted_loss: 1.3717, label: 1, bag_size: 1964
batch 559, loss: 0.0009, instance_loss: 0.3801, weighted_loss: 0.1146, label: 1, bag_size: 4067
batch 579, loss: 0.1218, instance_loss: 0.2205, weighted_loss: 0.1514, label: 2, bag_size: 4555
batch 599, loss: 0.2122, instance_loss: 0.6668, weighted_loss: 0.3486, label: 0, bag_size: 3408
batch 619, loss: 0.0330, instance_loss: 0.2219, weighted_loss: 0.0897, label: 2, bag_size: 614
batch 639, loss: 0.1825, instance_loss: 0.5294, weighted_loss: 0.2866, label: 0, bag_size: 3033
batch 659, loss: 0.3701, instance_loss: 0.7635, weighted_loss: 0.4882, label: 1, bag_size: 3986
batch 679, loss: 0.0708, instance_loss: 0.6200, weighted_loss: 0.2356, label: 0, bag_size: 477
batch 699, loss: 0.0141, instance_loss: 0.3300, weighted_loss: 0.1089, label: 2, bag_size: 5037
batch 719, loss: 0.0730, instance_loss: 0.3365, weighted_loss: 0.1521, label: 2, bag_size: 2486
batch 739, loss: 0.0134, instance_loss: 0.3333, weighted_loss: 0.1094, label: 0, bag_size: 5459


class 0 clustering acc 0.9642058165548099: correct 17240/17880
class 1 clustering acc 0.3818791946308725: correct 2276/5960
Epoch: 49, train_loss: 0.5183, train_clustering_loss:  0.5551, train_error: 0.2067
class 0: acc 0.8152610441767069, correct 203/249
class 1: acc 0.7192307692307692, correct 187/260
class 2: acc 0.8516949152542372, correct 201/236

Val Set, val_loss: 0.6750, val_error: 0.2553, auc: 0.8841
class 0 clustering acc 0.9827127659574468: correct 2217/2256
class 1 clustering acc 0.21409574468085107: correct 161/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.6169, instance_loss: 0.4973, weighted_loss: 0.5810, label: 2, bag_size: 5426
batch 39, loss: 0.1613, instance_loss: 0.3538, weighted_loss: 0.2190, label: 0, bag_size: 999
batch 59, loss: 0.0038, instance_loss: 0.1942, weighted_loss: 0.0609, label: 0, bag_size: 6797
batch 79, loss: 1.1130, instance_loss: 0.4521, weighted_loss: 0.9147, label: 0, bag_size: 4935
batch 99, loss: 0.7045, instance_loss: 0.6193, weighted_loss: 0.6790, label: 2, bag_size: 5743
batch 119, loss: 1.4248, instance_loss: 1.2811, weighted_loss: 1.3817, label: 0, bag_size: 20234
batch 139, loss: 2.2865, instance_loss: 1.0628, weighted_loss: 1.9194, label: 2, bag_size: 4316
batch 159, loss: 0.0544, instance_loss: 0.1222, weighted_loss: 0.0748, label: 2, bag_size: 4910
batch 179, loss: 0.5130, instance_loss: 0.3400, weighted_loss: 0.4611, label: 0, bag_size: 5782
batch 199, loss: 0.0256, instance_loss: 0.3390, weighted_loss: 0.1196, label: 1, bag_size: 2796
batch 219, loss: 0.1376, instance_loss: 0.3113, weighted_loss: 0.1897, label: 2, bag_size: 6644
batch 239, loss: 0.5012, instance_loss: 0.5574, weighted_loss: 0.5181, label: 2, bag_size: 3174
batch 259, loss: 0.7880, instance_loss: 0.5344, weighted_loss: 0.7119, label: 0, bag_size: 5526
batch 279, loss: 0.1705, instance_loss: 0.3155, weighted_loss: 0.2140, label: 0, bag_size: 4015
batch 299, loss: 0.4079, instance_loss: 0.5547, weighted_loss: 0.4519, label: 1, bag_size: 1042
batch 319, loss: 0.0639, instance_loss: 0.8791, weighted_loss: 0.3085, label: 1, bag_size: 6243
batch 339, loss: 0.2166, instance_loss: 0.4684, weighted_loss: 0.2922, label: 0, bag_size: 1562
batch 359, loss: 0.3249, instance_loss: 0.4176, weighted_loss: 0.3527, label: 0, bag_size: 4905
batch 379, loss: 0.8743, instance_loss: 1.0459, weighted_loss: 0.9258, label: 2, bag_size: 5307
batch 399, loss: 0.4232, instance_loss: 0.3746, weighted_loss: 0.4086, label: 2, bag_size: 5743
batch 419, loss: 0.3020, instance_loss: 0.3956, weighted_loss: 0.3301, label: 2, bag_size: 3618
batch 439, loss: 0.4187, instance_loss: 0.4038, weighted_loss: 0.4142, label: 1, bag_size: 1066
batch 459, loss: 0.1510, instance_loss: 0.8496, weighted_loss: 0.3606, label: 1, bag_size: 6315
batch 479, loss: 0.0444, instance_loss: 0.1485, weighted_loss: 0.0756, label: 2, bag_size: 3415
batch 499, loss: 0.2775, instance_loss: 0.3596, weighted_loss: 0.3021, label: 2, bag_size: 3397
batch 519, loss: 0.0647, instance_loss: 0.1728, weighted_loss: 0.0972, label: 2, bag_size: 2770
batch 539, loss: 0.6704, instance_loss: 0.8879, weighted_loss: 0.7356, label: 0, bag_size: 8866
batch 559, loss: 1.4344, instance_loss: 1.1889, weighted_loss: 1.3608, label: 0, bag_size: 4032
batch 579, loss: 0.0303, instance_loss: 0.2051, weighted_loss: 0.0827, label: 1, bag_size: 425
batch 599, loss: 0.0093, instance_loss: 0.2229, weighted_loss: 0.0734, label: 0, bag_size: 3247
batch 619, loss: 0.3221, instance_loss: 0.6313, weighted_loss: 0.4149, label: 1, bag_size: 4395
batch 639, loss: 0.0387, instance_loss: 0.3670, weighted_loss: 0.1372, label: 1, bag_size: 2122
batch 659, loss: 0.0276, instance_loss: 1.3141, weighted_loss: 0.4135, label: 0, bag_size: 2028
batch 679, loss: 0.8783, instance_loss: 0.8477, weighted_loss: 0.8691, label: 1, bag_size: 3050
batch 699, loss: 0.3455, instance_loss: 0.5243, weighted_loss: 0.3992, label: 1, bag_size: 5412
batch 719, loss: 0.3185, instance_loss: 0.4948, weighted_loss: 0.3714, label: 0, bag_size: 5036
batch 739, loss: 1.1483, instance_loss: 0.8041, weighted_loss: 1.0451, label: 1, bag_size: 2831


class 0 clustering acc 0.9662751677852349: correct 17277/17880
class 1 clustering acc 0.3790268456375839: correct 2259/5960
Epoch: 50, train_loss: 0.4696, train_clustering_loss:  0.5429, train_error: 0.2000
class 0: acc 0.8035714285714286, correct 180/224
class 1: acc 0.7678571428571429, correct 215/280
class 2: acc 0.8340248962655602, correct 201/241

Val Set, val_loss: 0.9059, val_error: 0.3085, auc: 0.8573
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.16090425531914893: correct 121/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.1822, instance_loss: 0.7440, weighted_loss: 1.0507, label: 1, bag_size: 32
batch 39, loss: 2.0640, instance_loss: 1.3046, weighted_loss: 1.8362, label: 0, bag_size: 1289
batch 59, loss: 0.0941, instance_loss: 0.3368, weighted_loss: 0.1669, label: 2, bag_size: 4372
batch 79, loss: 0.0057, instance_loss: 0.6800, weighted_loss: 0.2080, label: 1, bag_size: 6277
batch 99, loss: 2.2960, instance_loss: 1.0728, weighted_loss: 1.9291, label: 1, bag_size: 6993
batch 119, loss: 0.4645, instance_loss: 0.6197, weighted_loss: 0.5111, label: 1, bag_size: 3823
batch 139, loss: 2.8690, instance_loss: 1.0886, weighted_loss: 2.3348, label: 0, bag_size: 2579
batch 159, loss: 0.0502, instance_loss: 0.3299, weighted_loss: 0.1341, label: 1, bag_size: 2865
batch 179, loss: 1.1550, instance_loss: 0.8589, weighted_loss: 1.0662, label: 0, bag_size: 877
batch 199, loss: 1.1042, instance_loss: 0.6947, weighted_loss: 0.9814, label: 0, bag_size: 5375
batch 219, loss: 0.0659, instance_loss: 0.3004, weighted_loss: 0.1363, label: 0, bag_size: 2038
batch 239, loss: 0.0420, instance_loss: 0.1632, weighted_loss: 0.0783, label: 2, bag_size: 2481
batch 259, loss: 0.7012, instance_loss: 0.4612, weighted_loss: 0.6292, label: 0, bag_size: 2608
batch 279, loss: 0.3311, instance_loss: 0.3434, weighted_loss: 0.3348, label: 2, bag_size: 2049
batch 299, loss: 1.4213, instance_loss: 0.7918, weighted_loss: 1.2325, label: 1, bag_size: 6025
batch 319, loss: 0.4892, instance_loss: 0.6030, weighted_loss: 0.5233, label: 2, bag_size: 4291
batch 339, loss: 0.0419, instance_loss: 0.2184, weighted_loss: 0.0948, label: 0, bag_size: 1812
batch 359, loss: 0.5270, instance_loss: 0.6195, weighted_loss: 0.5548, label: 1, bag_size: 3357
batch 379, loss: 0.5485, instance_loss: 0.6104, weighted_loss: 0.5670, label: 2, bag_size: 4162
batch 399, loss: 0.2511, instance_loss: 0.4833, weighted_loss: 0.3207, label: 1, bag_size: 3391
batch 419, loss: 0.3705, instance_loss: 0.3348, weighted_loss: 0.3598, label: 2, bag_size: 4571
batch 439, loss: 0.8835, instance_loss: 0.7536, weighted_loss: 0.8445, label: 0, bag_size: 4245
batch 459, loss: 0.3771, instance_loss: 0.5711, weighted_loss: 0.4353, label: 2, bag_size: 552
batch 479, loss: 0.5375, instance_loss: 0.7041, weighted_loss: 0.5875, label: 1, bag_size: 5118
batch 499, loss: 0.5792, instance_loss: 0.5148, weighted_loss: 0.5599, label: 0, bag_size: 4018
batch 519, loss: 2.1986, instance_loss: 1.3976, weighted_loss: 1.9583, label: 1, bag_size: 3159
batch 539, loss: 0.0071, instance_loss: 0.3516, weighted_loss: 0.1104, label: 0, bag_size: 3298
batch 559, loss: 0.1847, instance_loss: 0.3839, weighted_loss: 0.2445, label: 0, bag_size: 6863
batch 579, loss: 0.1130, instance_loss: 0.2917, weighted_loss: 0.1667, label: 1, bag_size: 3322
batch 599, loss: 0.3213, instance_loss: 0.3320, weighted_loss: 0.3245, label: 0, bag_size: 4909
batch 619, loss: 0.0183, instance_loss: 0.1650, weighted_loss: 0.0623, label: 0, bag_size: 1845
batch 639, loss: 0.2874, instance_loss: 0.7407, weighted_loss: 0.4234, label: 2, bag_size: 6594
batch 659, loss: 0.1054, instance_loss: 0.3934, weighted_loss: 0.1918, label: 1, bag_size: 2921
batch 679, loss: 1.2457, instance_loss: 0.7075, weighted_loss: 1.0843, label: 2, bag_size: 5426
batch 699, loss: 0.1628, instance_loss: 0.6862, weighted_loss: 0.3198, label: 0, bag_size: 3075
batch 719, loss: 0.1729, instance_loss: 0.4642, weighted_loss: 0.2603, label: 2, bag_size: 4978
batch 739, loss: 0.1134, instance_loss: 0.4584, weighted_loss: 0.2169, label: 1, bag_size: 3007


class 0 clustering acc 0.9651565995525727: correct 17257/17880
class 1 clustering acc 0.45922818791946307: correct 2737/5960
Epoch: 51, train_loss: 0.4631, train_clustering_loss:  0.5068, train_error: 0.1799
class 0: acc 0.8132295719844358, correct 209/257
class 1: acc 0.7676348547717843, correct 185/241
class 2: acc 0.8785425101214575, correct 217/247

Val Set, val_loss: 0.6181, val_error: 0.2447, auc: 0.8917
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.4454787234042553: correct 335/752
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4151, instance_loss: 0.7898, weighted_loss: 0.5275, label: 1, bag_size: 3823
batch 39, loss: 0.5700, instance_loss: 0.6818, weighted_loss: 0.6036, label: 1, bag_size: 6817
batch 59, loss: 0.0675, instance_loss: 0.1911, weighted_loss: 0.1046, label: 2, bag_size: 6644
batch 79, loss: 0.6826, instance_loss: 0.4464, weighted_loss: 0.6118, label: 0, bag_size: 19216
batch 99, loss: 0.0648, instance_loss: 0.1865, weighted_loss: 0.1013, label: 2, bag_size: 2254
batch 119, loss: 1.3122, instance_loss: 0.9451, weighted_loss: 1.2020, label: 0, bag_size: 2559
batch 139, loss: 0.1881, instance_loss: 0.2995, weighted_loss: 0.2215, label: 2, bag_size: 3174
batch 159, loss: 0.0126, instance_loss: 0.0985, weighted_loss: 0.0384, label: 2, bag_size: 2313
batch 179, loss: 1.7572, instance_loss: 0.6273, weighted_loss: 1.4182, label: 2, bag_size: 4241
batch 199, loss: 0.0994, instance_loss: 0.2262, weighted_loss: 0.1375, label: 2, bag_size: 4691
batch 219, loss: 0.7777, instance_loss: 0.5593, weighted_loss: 0.7122, label: 2, bag_size: 4096
batch 239, loss: 0.6420, instance_loss: 0.6489, weighted_loss: 0.6441, label: 2, bag_size: 5406
batch 259, loss: 1.1651, instance_loss: 0.9945, weighted_loss: 1.1139, label: 2, bag_size: 4316
batch 279, loss: 0.1158, instance_loss: 0.1849, weighted_loss: 0.1365, label: 2, bag_size: 4788
batch 299, loss: 0.0010, instance_loss: 0.1510, weighted_loss: 0.0460, label: 0, bag_size: 5646
batch 319, loss: 0.3035, instance_loss: 0.3433, weighted_loss: 0.3155, label: 2, bag_size: 597
batch 339, loss: 0.2887, instance_loss: 0.4361, weighted_loss: 0.3329, label: 0, bag_size: 2479
batch 359, loss: 0.7770, instance_loss: 0.6935, weighted_loss: 0.7520, label: 2, bag_size: 2031
batch 379, loss: 0.0957, instance_loss: 0.4277, weighted_loss: 0.1953, label: 2, bag_size: 4140
batch 399, loss: 0.8338, instance_loss: 0.6907, weighted_loss: 0.7909, label: 0, bag_size: 436
batch 419, loss: 0.0407, instance_loss: 0.1352, weighted_loss: 0.0690, label: 2, bag_size: 3415
batch 439, loss: 0.0965, instance_loss: 0.1837, weighted_loss: 0.1227, label: 2, bag_size: 4788
batch 459, loss: 0.0237, instance_loss: 0.1431, weighted_loss: 0.0596, label: 0, bag_size: 3188
batch 479, loss: 0.0127, instance_loss: 0.1739, weighted_loss: 0.0611, label: 0, bag_size: 2487
batch 499, loss: 0.0049, instance_loss: 0.1895, weighted_loss: 0.0603, label: 0, bag_size: 4147
batch 519, loss: 2.7788, instance_loss: 1.2806, weighted_loss: 2.3294, label: 1, bag_size: 1549
batch 539, loss: 1.4016, instance_loss: 0.8065, weighted_loss: 1.2231, label: 2, bag_size: 5743
batch 559, loss: 0.0206, instance_loss: 0.4626, weighted_loss: 0.1532, label: 2, bag_size: 5017
batch 579, loss: 0.0446, instance_loss: 0.2715, weighted_loss: 0.1127, label: 0, bag_size: 5282
batch 599, loss: 3.2759, instance_loss: 1.6876, weighted_loss: 2.7994, label: 1, bag_size: 2425
batch 619, loss: 0.0380, instance_loss: 0.3107, weighted_loss: 0.1198, label: 2, bag_size: 5017
batch 639, loss: 0.6249, instance_loss: 0.7446, weighted_loss: 0.6608, label: 1, bag_size: 1307
batch 659, loss: 0.3507, instance_loss: 0.3415, weighted_loss: 0.3479, label: 2, bag_size: 3810
batch 679, loss: 0.0235, instance_loss: 0.2964, weighted_loss: 0.1054, label: 0, bag_size: 3666
batch 699, loss: 0.0546, instance_loss: 0.4633, weighted_loss: 0.1772, label: 1, bag_size: 1029
batch 719, loss: 0.0787, instance_loss: 0.2268, weighted_loss: 0.1231, label: 2, bag_size: 3396
batch 739, loss: 0.1095, instance_loss: 0.3600, weighted_loss: 0.1847, label: 0, bag_size: 3797


class 0 clustering acc 0.9659955257270694: correct 17272/17880
class 1 clustering acc 0.38338926174496646: correct 2285/5960
Epoch: 52, train_loss: 0.5019, train_clustering_loss:  0.5420, train_error: 0.2081
class 0: acc 0.7899159663865546, correct 188/238
class 1: acc 0.7307692307692307, correct 190/260
class 2: acc 0.8582995951417004, correct 212/247

Val Set, val_loss: 0.7709, val_error: 0.3404, auc: 0.8761
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.26728723404255317: correct 201/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.9132, instance_loss: 0.4048, weighted_loss: 0.7607, label: 0, bag_size: 4145
batch 39, loss: 0.3504, instance_loss: 0.4795, weighted_loss: 0.3891, label: 2, bag_size: 5924
batch 59, loss: 0.0003, instance_loss: 0.5159, weighted_loss: 0.1550, label: 1, bag_size: 10399
batch 79, loss: 1.2227, instance_loss: 0.7992, weighted_loss: 1.0957, label: 1, bag_size: 2859
batch 99, loss: 0.3673, instance_loss: 1.0048, weighted_loss: 0.5585, label: 1, bag_size: 2614
batch 119, loss: 0.0054, instance_loss: 0.8440, weighted_loss: 0.2570, label: 1, bag_size: 2614
batch 139, loss: 0.0663, instance_loss: 0.4827, weighted_loss: 0.1912, label: 0, bag_size: 3694
batch 159, loss: 0.4203, instance_loss: 0.4289, weighted_loss: 0.4229, label: 2, bag_size: 5924
batch 179, loss: 0.1629, instance_loss: 0.6209, weighted_loss: 0.3003, label: 0, bag_size: 2428
batch 199, loss: 0.0437, instance_loss: 0.3843, weighted_loss: 0.1459, label: 1, bag_size: 3493
batch 219, loss: 0.3821, instance_loss: 0.6898, weighted_loss: 0.4744, label: 1, bag_size: 1528
batch 239, loss: 0.2672, instance_loss: 0.4566, weighted_loss: 0.3241, label: 1, bag_size: 5340
batch 259, loss: 1.7065, instance_loss: 1.1912, weighted_loss: 1.5519, label: 0, bag_size: 2028
batch 279, loss: 0.9460, instance_loss: 0.7928, weighted_loss: 0.9000, label: 1, bag_size: 5276
batch 299, loss: 0.1668, instance_loss: 0.2687, weighted_loss: 0.1974, label: 2, bag_size: 3546
batch 319, loss: 0.0722, instance_loss: 0.1586, weighted_loss: 0.0981, label: 1, bag_size: 6992
batch 339, loss: 0.0019, instance_loss: 0.0754, weighted_loss: 0.0240, label: 0, bag_size: 5831
batch 359, loss: 0.0162, instance_loss: 0.2290, weighted_loss: 0.0800, label: 2, bag_size: 4088
batch 379, loss: 0.0027, instance_loss: 0.1774, weighted_loss: 0.0551, label: 0, bag_size: 5899
batch 399, loss: 1.2540, instance_loss: 0.9818, weighted_loss: 1.1723, label: 1, bag_size: 4612
batch 419, loss: 0.0001, instance_loss: 0.1035, weighted_loss: 0.0311, label: 1, bag_size: 4111
batch 439, loss: 0.7588, instance_loss: 0.4067, weighted_loss: 0.6532, label: 2, bag_size: 3274
batch 459, loss: 0.0304, instance_loss: 0.5868, weighted_loss: 0.1974, label: 0, bag_size: 3648
batch 479, loss: 0.0647, instance_loss: 0.2806, weighted_loss: 0.1295, label: 0, bag_size: 3662
batch 499, loss: 0.0635, instance_loss: 0.1889, weighted_loss: 0.1011, label: 2, bag_size: 6704
batch 519, loss: 0.0343, instance_loss: 0.3758, weighted_loss: 0.1368, label: 1, bag_size: 3007
batch 539, loss: 1.3779, instance_loss: 0.7062, weighted_loss: 1.1764, label: 1, bag_size: 2945
batch 559, loss: 0.4133, instance_loss: 0.4925, weighted_loss: 0.4370, label: 2, bag_size: 5011
batch 579, loss: 0.0526, instance_loss: 0.3256, weighted_loss: 0.1345, label: 0, bag_size: 4332
batch 599, loss: 0.0655, instance_loss: 0.1235, weighted_loss: 0.0829, label: 2, bag_size: 2905
batch 619, loss: 0.0640, instance_loss: 0.3091, weighted_loss: 0.1375, label: 1, bag_size: 700
batch 639, loss: 0.1210, instance_loss: 0.4478, weighted_loss: 0.2190, label: 1, bag_size: 3221
batch 659, loss: 0.0476, instance_loss: 0.1508, weighted_loss: 0.0786, label: 0, bag_size: 4455
batch 679, loss: 0.5909, instance_loss: 0.7330, weighted_loss: 0.6335, label: 2, bag_size: 1050
batch 699, loss: 0.0269, instance_loss: 0.2150, weighted_loss: 0.0833, label: 1, bag_size: 7135
batch 719, loss: 0.2985, instance_loss: 0.6299, weighted_loss: 0.3979, label: 2, bag_size: 4978
batch 739, loss: 0.0181, instance_loss: 0.3518, weighted_loss: 0.1183, label: 0, bag_size: 4347


class 0 clustering acc 0.9681767337807606: correct 17311/17880
class 1 clustering acc 0.4280201342281879: correct 2551/5960
Epoch: 53, train_loss: 0.4675, train_clustering_loss:  0.5132, train_error: 0.1799
class 0: acc 0.7907949790794979, correct 189/239
class 1: acc 0.7854545454545454, correct 216/275
class 2: acc 0.8917748917748918, correct 206/231

Val Set, val_loss: 0.6102, val_error: 0.2021, auc: 0.8961
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.3696808510638298: correct 278/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3812, instance_loss: 0.4528, weighted_loss: 0.4027, label: 2, bag_size: 3778
batch 39, loss: 0.1725, instance_loss: 0.2061, weighted_loss: 0.1825, label: 2, bag_size: 6001
batch 59, loss: 0.2209, instance_loss: 0.4398, weighted_loss: 0.2866, label: 1, bag_size: 4184
batch 79, loss: 0.4268, instance_loss: 0.6076, weighted_loss: 0.4810, label: 1, bag_size: 5003
batch 99, loss: 0.2876, instance_loss: 0.5400, weighted_loss: 0.3633, label: 0, bag_size: 4946
batch 119, loss: 0.1871, instance_loss: 0.3075, weighted_loss: 0.2232, label: 0, bag_size: 3789
batch 139, loss: 0.1140, instance_loss: 0.3826, weighted_loss: 0.1946, label: 1, bag_size: 440
batch 159, loss: 0.0014, instance_loss: 0.0827, weighted_loss: 0.0258, label: 1, bag_size: 460
batch 179, loss: 0.0497, instance_loss: 0.1603, weighted_loss: 0.0829, label: 0, bag_size: 2545
batch 199, loss: 0.6066, instance_loss: 0.4291, weighted_loss: 0.5534, label: 2, bag_size: 4569
batch 219, loss: 0.0044, instance_loss: 0.1818, weighted_loss: 0.0576, label: 0, bag_size: 4797
batch 239, loss: 0.0796, instance_loss: 0.1720, weighted_loss: 0.1073, label: 2, bag_size: 3415
batch 259, loss: 0.2407, instance_loss: 0.2882, weighted_loss: 0.2549, label: 2, bag_size: 597
batch 279, loss: 0.0177, instance_loss: 0.2113, weighted_loss: 0.0758, label: 0, bag_size: 4734
batch 299, loss: 0.0059, instance_loss: 0.1374, weighted_loss: 0.0454, label: 1, bag_size: 758
batch 319, loss: 0.2367, instance_loss: 0.5128, weighted_loss: 0.3195, label: 1, bag_size: 3403
batch 339, loss: 0.5422, instance_loss: 0.7460, weighted_loss: 0.6033, label: 2, bag_size: 5072
batch 359, loss: 0.7500, instance_loss: 0.5754, weighted_loss: 0.6976, label: 0, bag_size: 4245
batch 379, loss: 0.0876, instance_loss: 0.1189, weighted_loss: 0.0970, label: 0, bag_size: 4325
batch 399, loss: 0.0864, instance_loss: 0.3361, weighted_loss: 0.1613, label: 2, bag_size: 4910
batch 419, loss: 0.4393, instance_loss: 0.3805, weighted_loss: 0.4216, label: 0, bag_size: 4282
batch 439, loss: 1.4497, instance_loss: 0.7120, weighted_loss: 1.2284, label: 1, bag_size: 4812
batch 459, loss: 1.4320, instance_loss: 0.9505, weighted_loss: 1.2876, label: 1, bag_size: 1371
batch 479, loss: 0.1252, instance_loss: 0.3911, weighted_loss: 0.2049, label: 2, bag_size: 4192
batch 499, loss: 0.0087, instance_loss: 0.1916, weighted_loss: 0.0636, label: 2, bag_size: 3176
batch 519, loss: 0.7449, instance_loss: 0.4691, weighted_loss: 0.6622, label: 0, bag_size: 4909
batch 539, loss: 0.0639, instance_loss: 0.1714, weighted_loss: 0.0962, label: 2, bag_size: 4691
batch 559, loss: 0.0399, instance_loss: 0.1652, weighted_loss: 0.0775, label: 2, bag_size: 4555
batch 579, loss: 0.0047, instance_loss: 0.1815, weighted_loss: 0.0577, label: 0, bag_size: 2290
batch 599, loss: 0.2230, instance_loss: 0.5397, weighted_loss: 0.3180, label: 0, bag_size: 3525
batch 619, loss: 2.2281, instance_loss: 1.3300, weighted_loss: 1.9587, label: 1, bag_size: 3837
batch 639, loss: 0.3037, instance_loss: 0.1997, weighted_loss: 0.2725, label: 0, bag_size: 2545
batch 659, loss: 0.0570, instance_loss: 0.4517, weighted_loss: 0.1754, label: 1, bag_size: 3493
batch 679, loss: 0.9508, instance_loss: 1.2104, weighted_loss: 1.0287, label: 1, bag_size: 4467
batch 699, loss: 0.0534, instance_loss: 0.1707, weighted_loss: 0.0886, label: 2, bag_size: 1094
batch 719, loss: 0.0418, instance_loss: 0.5178, weighted_loss: 0.1846, label: 1, bag_size: 5385
batch 739, loss: 1.2089, instance_loss: 1.0456, weighted_loss: 1.1599, label: 1, bag_size: 832


class 0 clustering acc 0.9657718120805369: correct 17268/17880
class 1 clustering acc 0.4802013422818792: correct 2862/5960
Epoch: 54, train_loss: 0.4227, train_clustering_loss:  0.4899, train_error: 0.1638
class 0: acc 0.8764478764478765, correct 227/259
class 1: acc 0.7222222222222222, correct 169/234
class 2: acc 0.9007936507936508, correct 227/252

Val Set, val_loss: 0.6632, val_error: 0.2447, auc: 0.8848
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.3962765957446808: correct 298/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0170, instance_loss: 0.5169, weighted_loss: 0.1669, label: 1, bag_size: 5385
batch 39, loss: 1.2328, instance_loss: 0.7203, weighted_loss: 1.0791, label: 1, bag_size: 5412
batch 59, loss: 0.0949, instance_loss: 0.3612, weighted_loss: 0.1748, label: 0, bag_size: 5950
batch 79, loss: 0.1050, instance_loss: 0.3815, weighted_loss: 0.1879, label: 1, bag_size: 2731
batch 99, loss: 0.0283, instance_loss: 0.3647, weighted_loss: 0.1292, label: 0, bag_size: 4721
batch 119, loss: 0.0886, instance_loss: 0.3543, weighted_loss: 0.1683, label: 2, bag_size: 5924
batch 139, loss: 0.0035, instance_loss: 0.1757, weighted_loss: 0.0551, label: 0, bag_size: 5236
batch 159, loss: 0.0846, instance_loss: 0.1629, weighted_loss: 0.1081, label: 2, bag_size: 3415
batch 179, loss: 0.5843, instance_loss: 0.6496, weighted_loss: 0.6039, label: 1, bag_size: 832
batch 199, loss: 0.1732, instance_loss: 0.2446, weighted_loss: 0.1946, label: 2, bag_size: 3396
batch 219, loss: 0.2268, instance_loss: 0.4590, weighted_loss: 0.2964, label: 2, bag_size: 4978
batch 239, loss: 0.1583, instance_loss: 0.2522, weighted_loss: 0.1865, label: 2, bag_size: 6644
batch 259, loss: 0.2405, instance_loss: 0.6455, weighted_loss: 0.3620, label: 1, bag_size: 1250
batch 279, loss: 0.0002, instance_loss: 0.1861, weighted_loss: 0.0559, label: 2, bag_size: 4203
batch 299, loss: 0.8722, instance_loss: 0.5529, weighted_loss: 0.7764, label: 1, bag_size: 5412
batch 319, loss: 0.0026, instance_loss: 0.1831, weighted_loss: 0.0568, label: 2, bag_size: 4088
batch 339, loss: 0.0021, instance_loss: 0.1735, weighted_loss: 0.0535, label: 2, bag_size: 4088
batch 359, loss: 0.9039, instance_loss: 0.7083, weighted_loss: 0.8452, label: 1, bag_size: 6717
batch 379, loss: 0.1259, instance_loss: 0.9581, weighted_loss: 0.3755, label: 1, bag_size: 5084
batch 399, loss: 0.6342, instance_loss: 0.4462, weighted_loss: 0.5778, label: 2, bag_size: 3546
batch 419, loss: 3.2084, instance_loss: 0.8329, weighted_loss: 2.4958, label: 0, bag_size: 2217
batch 439, loss: 0.0217, instance_loss: 0.1867, weighted_loss: 0.0712, label: 0, bag_size: 2852
batch 459, loss: 0.1810, instance_loss: 0.3076, weighted_loss: 0.2190, label: 2, bag_size: 1103
batch 479, loss: 0.0209, instance_loss: 0.4091, weighted_loss: 0.1373, label: 1, bag_size: 455
batch 499, loss: 0.0000, instance_loss: 0.0366, weighted_loss: 0.0110, label: 0, bag_size: 4582
batch 519, loss: 0.3583, instance_loss: 0.7406, weighted_loss: 0.4730, label: 1, bag_size: 2472
batch 539, loss: 0.6081, instance_loss: 0.6467, weighted_loss: 0.6197, label: 1, bag_size: 1250
batch 559, loss: 0.5898, instance_loss: 0.7021, weighted_loss: 0.6235, label: 1, bag_size: 1313
batch 579, loss: 0.0203, instance_loss: 0.2484, weighted_loss: 0.0888, label: 0, bag_size: 1174
batch 599, loss: 0.0007, instance_loss: 0.1635, weighted_loss: 0.0495, label: 2, bag_size: 4569
batch 619, loss: 0.0132, instance_loss: 0.2264, weighted_loss: 0.0771, label: 0, bag_size: 6797
batch 639, loss: 0.7415, instance_loss: 0.7619, weighted_loss: 0.7476, label: 1, bag_size: 3823
batch 659, loss: 0.4668, instance_loss: 0.7369, weighted_loss: 0.5478, label: 1, bag_size: 4200
batch 679, loss: 0.5030, instance_loss: 0.4969, weighted_loss: 0.5012, label: 0, bag_size: 3789
batch 699, loss: 1.0070, instance_loss: 0.5722, weighted_loss: 0.8765, label: 0, bag_size: 13770
batch 719, loss: 0.2160, instance_loss: 0.4805, weighted_loss: 0.2953, label: 1, bag_size: 4262
batch 739, loss: 0.3745, instance_loss: 0.9292, weighted_loss: 0.5409, label: 2, bag_size: 4179


class 0 clustering acc 0.9670581655480984: correct 17291/17880
class 1 clustering acc 0.4065436241610738: correct 2423/5960
Epoch: 55, train_loss: 0.4814, train_clustering_loss:  0.5176, train_error: 0.2094
class 0: acc 0.8099173553719008, correct 196/242
class 1: acc 0.7120622568093385, correct 183/257
class 2: acc 0.8536585365853658, correct 210/246

Val Set, val_loss: 0.6484, val_error: 0.2766, auc: 0.8865
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.35771276595744683: correct 269/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.2234, ROC AUC: 0.9149
Test error: 0.2660, ROC AUC: 0.8780
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.3111, instance_loss: 0.6381, weighted_loss: 0.4092, label: 1, bag_size: 3482
batch 39, loss: 1.8255, instance_loss: 0.7990, weighted_loss: 1.5176, label: 0, bag_size: 3871
batch 59, loss: 1.3619, instance_loss: 0.8157, weighted_loss: 1.1981, label: 2, bag_size: 4316
batch 79, loss: 1.1734, instance_loss: 0.7895, weighted_loss: 1.0583, label: 2, bag_size: 5924
batch 99, loss: 2.2299, instance_loss: 0.8617, weighted_loss: 1.8194, label: 1, bag_size: 5011
batch 119, loss: 1.9111, instance_loss: 0.7923, weighted_loss: 1.5754, label: 0, bag_size: 3402
batch 139, loss: 1.6822, instance_loss: 0.8912, weighted_loss: 1.4449, label: 1, bag_size: 2751
batch 159, loss: 0.9229, instance_loss: 0.7923, weighted_loss: 0.8837, label: 0, bag_size: 4326
batch 179, loss: 1.7012, instance_loss: 0.8293, weighted_loss: 1.4396, label: 0, bag_size: 7219
batch 199, loss: 1.8071, instance_loss: 0.8933, weighted_loss: 1.5329, label: 2, bag_size: 4316
batch 219, loss: 1.2944, instance_loss: 0.8764, weighted_loss: 1.1690, label: 2, bag_size: 1050
batch 239, loss: 1.4690, instance_loss: 0.9458, weighted_loss: 1.3120, label: 0, bag_size: 3711
batch 259, loss: 0.7096, instance_loss: 0.6816, weighted_loss: 0.7012, label: 2, bag_size: 2031
batch 279, loss: 0.6864, instance_loss: 0.6604, weighted_loss: 0.6786, label: 2, bag_size: 1513
batch 299, loss: 0.4727, instance_loss: 0.5857, weighted_loss: 0.5066, label: 0, bag_size: 4841
batch 319, loss: 0.7204, instance_loss: 0.6645, weighted_loss: 0.7037, label: 2, bag_size: 2501
batch 339, loss: 1.5042, instance_loss: 0.8697, weighted_loss: 1.3139, label: 1, bag_size: 4346
batch 359, loss: 1.3788, instance_loss: 0.7341, weighted_loss: 1.1854, label: 1, bag_size: 14449
batch 379, loss: 2.5407, instance_loss: 0.7052, weighted_loss: 1.9901, label: 1, bag_size: 3534
batch 399, loss: 0.3387, instance_loss: 0.4200, weighted_loss: 0.3631, label: 1, bag_size: 4599
batch 419, loss: 2.9499, instance_loss: 1.0439, weighted_loss: 2.3781, label: 2, bag_size: 552
batch 439, loss: 0.3403, instance_loss: 0.5803, weighted_loss: 0.4123, label: 2, bag_size: 6026
batch 459, loss: 0.8160, instance_loss: 0.6901, weighted_loss: 0.7782, label: 2, bag_size: 3299
batch 479, loss: 1.7192, instance_loss: 0.9265, weighted_loss: 1.4814, label: 0, bag_size: 1420
batch 499, loss: 0.7754, instance_loss: 0.5682, weighted_loss: 0.7132, label: 1, bag_size: 4705
batch 519, loss: 0.4649, instance_loss: 0.6379, weighted_loss: 0.5168, label: 0, bag_size: 4783
batch 539, loss: 0.9200, instance_loss: 0.6898, weighted_loss: 0.8509, label: 0, bag_size: 2873
batch 559, loss: 1.2163, instance_loss: 0.8665, weighted_loss: 1.1114, label: 1, bag_size: 1161
batch 579, loss: 0.7373, instance_loss: 0.6892, weighted_loss: 0.7229, label: 0, bag_size: 1373
batch 599, loss: 0.7452, instance_loss: 0.6702, weighted_loss: 0.7227, label: 0, bag_size: 2826
batch 619, loss: 0.6152, instance_loss: 0.6387, weighted_loss: 0.6222, label: 0, bag_size: 3348
batch 639, loss: 0.3494, instance_loss: 0.4874, weighted_loss: 0.3908, label: 1, bag_size: 460
batch 659, loss: 0.7132, instance_loss: 0.6730, weighted_loss: 0.7011, label: 0, bag_size: 3983
batch 679, loss: 0.5765, instance_loss: 0.6347, weighted_loss: 0.5940, label: 2, bag_size: 3546
batch 699, loss: 0.4229, instance_loss: 0.8041, weighted_loss: 0.5373, label: 2, bag_size: 4241
batch 719, loss: 1.0136, instance_loss: 0.6982, weighted_loss: 0.9190, label: 1, bag_size: 2744
batch 739, loss: 0.5523, instance_loss: 0.6069, weighted_loss: 0.5687, label: 0, bag_size: 3219


class 0 clustering acc 0.998489932885906: correct 17853/17880
class 1 clustering acc 0.0025167785234899327: correct 15/5960
Epoch: 0, train_loss: 1.0446, train_clustering_loss:  0.7315, train_error: 0.5101
class 0: acc 0.44, correct 110/250
class 1: acc 0.448, correct 112/250
class 2: acc 0.5836734693877551, correct 143/245

Val Set, val_loss: 0.9034, val_error: 0.4681, auc: 0.7326
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.014627659574468085: correct 11/752
class 0: acc 0.5, correct 26/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.3333333333333333, correct 4/12
Validation loss decreased (inf --> 0.903399).  Saving model ...


batch 19, loss: 0.8453, instance_loss: 1.0403, weighted_loss: 0.9038, label: 2, bag_size: 3607
batch 39, loss: 0.6725, instance_loss: 0.7527, weighted_loss: 0.6966, label: 2, bag_size: 22464
batch 59, loss: 0.9011, instance_loss: 0.5816, weighted_loss: 0.8053, label: 1, bag_size: 11974
batch 79, loss: 1.7802, instance_loss: 0.8262, weighted_loss: 1.4940, label: 0, bag_size: 4605
batch 99, loss: 0.9855, instance_loss: 0.7244, weighted_loss: 0.9072, label: 0, bag_size: 3871
batch 119, loss: 1.5917, instance_loss: 0.6564, weighted_loss: 1.3111, label: 1, bag_size: 19265
batch 139, loss: 0.5390, instance_loss: 0.8206, weighted_loss: 0.6235, label: 2, bag_size: 5472
batch 159, loss: 0.4005, instance_loss: 0.5987, weighted_loss: 0.4599, label: 0, bag_size: 4398
batch 179, loss: 0.1070, instance_loss: 0.3185, weighted_loss: 0.1705, label: 1, bag_size: 2809
batch 199, loss: 0.7367, instance_loss: 0.6531, weighted_loss: 0.7116, label: 2, bag_size: 909
batch 219, loss: 0.6005, instance_loss: 0.5246, weighted_loss: 0.5777, label: 1, bag_size: 4869
batch 239, loss: 0.8284, instance_loss: 0.6138, weighted_loss: 0.7640, label: 2, bag_size: 3678
batch 259, loss: 0.6846, instance_loss: 0.7169, weighted_loss: 0.6943, label: 2, bag_size: 3618
batch 279, loss: 0.5342, instance_loss: 0.5356, weighted_loss: 0.5346, label: 1, bag_size: 3184
batch 299, loss: 1.5790, instance_loss: 0.9601, weighted_loss: 1.3933, label: 0, bag_size: 3675
batch 319, loss: 0.7202, instance_loss: 0.7433, weighted_loss: 0.7271, label: 0, bag_size: 4332
batch 339, loss: 1.9877, instance_loss: 0.9282, weighted_loss: 1.6698, label: 2, bag_size: 1050
batch 359, loss: 0.3724, instance_loss: 0.4343, weighted_loss: 0.3910, label: 2, bag_size: 4056
batch 379, loss: 1.6729, instance_loss: 0.9154, weighted_loss: 1.4456, label: 0, bag_size: 434
batch 399, loss: 0.4622, instance_loss: 0.6153, weighted_loss: 0.5081, label: 2, bag_size: 3172
batch 419, loss: 1.1838, instance_loss: 0.8991, weighted_loss: 1.0984, label: 2, bag_size: 1222
batch 439, loss: 0.8260, instance_loss: 0.8614, weighted_loss: 0.8366, label: 2, bag_size: 6148
batch 459, loss: 0.1922, instance_loss: 0.3981, weighted_loss: 0.2539, label: 1, bag_size: 4578
batch 479, loss: 0.3612, instance_loss: 0.4354, weighted_loss: 0.3834, label: 1, bag_size: 5003
batch 499, loss: 0.3307, instance_loss: 0.4594, weighted_loss: 0.3693, label: 2, bag_size: 2254
batch 519, loss: 0.3052, instance_loss: 0.6140, weighted_loss: 0.3978, label: 2, bag_size: 5138
batch 539, loss: 0.2730, instance_loss: 0.4575, weighted_loss: 0.3284, label: 1, bag_size: 2092
batch 559, loss: 0.8852, instance_loss: 0.7712, weighted_loss: 0.8510, label: 0, bag_size: 3268
batch 579, loss: 0.8925, instance_loss: 0.9398, weighted_loss: 0.9067, label: 0, bag_size: 1886
batch 599, loss: 1.1706, instance_loss: 1.0022, weighted_loss: 1.1201, label: 0, bag_size: 4196
batch 619, loss: 1.7998, instance_loss: 0.9519, weighted_loss: 1.5455, label: 1, bag_size: 869
batch 639, loss: 0.1929, instance_loss: 0.4228, weighted_loss: 0.2618, label: 1, bag_size: 368
batch 659, loss: 0.8148, instance_loss: 0.7936, weighted_loss: 0.8084, label: 2, bag_size: 3172
batch 679, loss: 0.3986, instance_loss: 0.4020, weighted_loss: 0.3997, label: 1, bag_size: 1221
batch 699, loss: 0.4861, instance_loss: 0.7609, weighted_loss: 0.5686, label: 2, bag_size: 4141
batch 719, loss: 1.2678, instance_loss: 0.7351, weighted_loss: 1.1080, label: 1, bag_size: 3100
batch 739, loss: 0.9773, instance_loss: 0.6701, weighted_loss: 0.8852, label: 1, bag_size: 3644


class 0 clustering acc 0.9982662192393736: correct 17849/17880
class 1 clustering acc 0.019798657718120807: correct 118/5960
Epoch: 1, train_loss: 0.9070, train_clustering_loss:  0.6784, train_error: 0.4027
class 0: acc 0.5104602510460251, correct 122/239
class 1: acc 0.6240601503759399, correct 166/266
class 2: acc 0.6541666666666667, correct 157/240

Val Set, val_loss: 1.1152, val_error: 0.5957, auc: 0.7682
class 0 clustering acc 0.9929078014184397: correct 2240/2256
class 1 clustering acc 0.03723404255319149: correct 28/752
class 0: acc 0.19230769230769232, correct 10/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7564, instance_loss: 0.7772, weighted_loss: 1.4626, label: 2, bag_size: 3475
batch 39, loss: 0.9429, instance_loss: 0.7725, weighted_loss: 0.8918, label: 0, bag_size: 7219
batch 59, loss: 0.2207, instance_loss: 0.4480, weighted_loss: 0.2888, label: 2, bag_size: 3121
batch 79, loss: 0.5091, instance_loss: 0.6768, weighted_loss: 0.5594, label: 1, bag_size: 800
batch 99, loss: 0.5684, instance_loss: 0.7528, weighted_loss: 0.6237, label: 2, bag_size: 3172
batch 119, loss: 2.0171, instance_loss: 1.0164, weighted_loss: 1.7169, label: 0, bag_size: 14432
batch 139, loss: 2.5276, instance_loss: 0.9716, weighted_loss: 2.0608, label: 2, bag_size: 223
batch 159, loss: 0.7114, instance_loss: 0.6943, weighted_loss: 0.7063, label: 2, bag_size: 3299
batch 179, loss: 1.0778, instance_loss: 0.7102, weighted_loss: 0.9675, label: 1, bag_size: 5693
batch 199, loss: 0.2069, instance_loss: 0.4206, weighted_loss: 0.2710, label: 2, bag_size: 3026
batch 219, loss: 0.5763, instance_loss: 0.5907, weighted_loss: 0.5806, label: 0, bag_size: 4460
batch 239, loss: 1.1554, instance_loss: 0.7319, weighted_loss: 1.0283, label: 1, bag_size: 3813
batch 259, loss: 0.2671, instance_loss: 0.5394, weighted_loss: 0.3488, label: 0, bag_size: 873
batch 279, loss: 0.5150, instance_loss: 0.4985, weighted_loss: 0.5101, label: 1, bag_size: 2905
batch 299, loss: 0.4235, instance_loss: 0.4400, weighted_loss: 0.4285, label: 1, bag_size: 4812
batch 319, loss: 0.3363, instance_loss: 0.3395, weighted_loss: 0.3372, label: 1, bag_size: 3761
batch 339, loss: 0.2989, instance_loss: 0.5308, weighted_loss: 0.3685, label: 0, bag_size: 1647
batch 359, loss: 0.9298, instance_loss: 0.7738, weighted_loss: 0.8830, label: 1, bag_size: 2859
batch 379, loss: 0.2129, instance_loss: 0.4183, weighted_loss: 0.2745, label: 2, bag_size: 4141
batch 399, loss: 1.2243, instance_loss: 0.8143, weighted_loss: 1.1013, label: 1, bag_size: 9099
batch 419, loss: 1.8210, instance_loss: 0.5547, weighted_loss: 1.4411, label: 0, bag_size: 3070
batch 439, loss: 1.2479, instance_loss: 0.8862, weighted_loss: 1.1394, label: 2, bag_size: 5472
batch 459, loss: 0.6430, instance_loss: 0.9274, weighted_loss: 0.7283, label: 2, bag_size: 3810
batch 479, loss: 1.2604, instance_loss: 0.7270, weighted_loss: 1.1004, label: 1, bag_size: 1860
batch 499, loss: 0.6528, instance_loss: 0.5225, weighted_loss: 0.6137, label: 0, bag_size: 3586
batch 519, loss: 1.4570, instance_loss: 0.8404, weighted_loss: 1.2720, label: 1, bag_size: 2831
batch 539, loss: 0.1824, instance_loss: 0.4328, weighted_loss: 0.2575, label: 1, bag_size: 460
batch 559, loss: 1.7161, instance_loss: 0.9110, weighted_loss: 1.4745, label: 2, bag_size: 223
batch 579, loss: 1.0314, instance_loss: 0.6312, weighted_loss: 0.9113, label: 2, bag_size: 3534
batch 599, loss: 0.4173, instance_loss: 0.6684, weighted_loss: 0.4926, label: 1, bag_size: 3007
batch 619, loss: 0.4333, instance_loss: 0.6099, weighted_loss: 0.4863, label: 0, bag_size: 2853
batch 639, loss: 0.7350, instance_loss: 0.7186, weighted_loss: 0.7301, label: 1, bag_size: 6156
batch 659, loss: 1.4325, instance_loss: 0.9072, weighted_loss: 1.2749, label: 1, bag_size: 3391
batch 679, loss: 0.2147, instance_loss: 0.3763, weighted_loss: 0.2632, label: 2, bag_size: 5406
batch 699, loss: 1.4115, instance_loss: 1.0080, weighted_loss: 1.2905, label: 1, bag_size: 5756
batch 719, loss: 0.4788, instance_loss: 0.4958, weighted_loss: 0.4839, label: 2, bag_size: 3396
batch 739, loss: 1.4533, instance_loss: 0.7513, weighted_loss: 1.2427, label: 1, bag_size: 4806


class 0 clustering acc 0.9958053691275168: correct 17805/17880
class 1 clustering acc 0.03875838926174496: correct 231/5960
Epoch: 2, train_loss: 0.8858, train_clustering_loss:  0.6674, train_error: 0.3919
class 0: acc 0.602510460251046, correct 144/239
class 1: acc 0.5173913043478261, correct 119/230
class 2: acc 0.6884057971014492, correct 190/276

Val Set, val_loss: 0.9967, val_error: 0.4362, auc: 0.8010
class 0 clustering acc 0.9964539007092199: correct 2248/2256
class 1 clustering acc 0.023936170212765957: correct 18/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0192, instance_loss: 0.7548, weighted_loss: 0.9399, label: 1, bag_size: 1023
batch 39, loss: 1.2128, instance_loss: 0.8660, weighted_loss: 1.1088, label: 1, bag_size: 2472
batch 59, loss: 1.2510, instance_loss: 0.6037, weighted_loss: 1.0568, label: 1, bag_size: 2083
batch 79, loss: 0.2329, instance_loss: 0.4088, weighted_loss: 0.2856, label: 0, bag_size: 3443
batch 99, loss: 0.1232, instance_loss: 0.2108, weighted_loss: 0.1495, label: 2, bag_size: 4691
batch 119, loss: 0.2518, instance_loss: 0.5179, weighted_loss: 0.3316, label: 0, bag_size: 2286
batch 139, loss: 0.8517, instance_loss: 0.5023, weighted_loss: 0.7469, label: 0, bag_size: 4946
batch 159, loss: 0.2048, instance_loss: 0.2761, weighted_loss: 0.2262, label: 0, bag_size: 5029
batch 179, loss: 0.8811, instance_loss: 1.3851, weighted_loss: 1.0323, label: 2, bag_size: 6148
batch 199, loss: 1.6935, instance_loss: 0.9361, weighted_loss: 1.4662, label: 1, bag_size: 5402
batch 219, loss: 0.1117, instance_loss: 0.6031, weighted_loss: 0.2591, label: 0, bag_size: 4070
batch 239, loss: 1.1857, instance_loss: 0.8192, weighted_loss: 1.0757, label: 1, bag_size: 210
batch 259, loss: 0.1345, instance_loss: 0.3775, weighted_loss: 0.2074, label: 0, bag_size: 2019
batch 279, loss: 1.5655, instance_loss: 0.8155, weighted_loss: 1.3405, label: 0, bag_size: 11141
batch 299, loss: 0.5744, instance_loss: 0.5298, weighted_loss: 0.5611, label: 0, bag_size: 2927
batch 319, loss: 0.0810, instance_loss: 0.5313, weighted_loss: 0.2161, label: 2, bag_size: 4487
batch 339, loss: 0.8150, instance_loss: 0.7051, weighted_loss: 0.7820, label: 2, bag_size: 1050
batch 359, loss: 0.7293, instance_loss: 0.6414, weighted_loss: 0.7029, label: 1, bag_size: 4960
batch 379, loss: 0.2994, instance_loss: 0.5656, weighted_loss: 0.3793, label: 2, bag_size: 6644
batch 399, loss: 0.7917, instance_loss: 0.6822, weighted_loss: 0.7589, label: 1, bag_size: 3983
batch 419, loss: 1.6311, instance_loss: 0.8871, weighted_loss: 1.4079, label: 0, bag_size: 35080
batch 439, loss: 0.8877, instance_loss: 0.5931, weighted_loss: 0.7993, label: 2, bag_size: 2049
batch 459, loss: 0.5097, instance_loss: 0.8256, weighted_loss: 0.6045, label: 1, bag_size: 3640
batch 479, loss: 1.1120, instance_loss: 0.7654, weighted_loss: 1.0080, label: 2, bag_size: 3534
batch 499, loss: 0.6050, instance_loss: 0.5106, weighted_loss: 0.5767, label: 0, bag_size: 4460
batch 519, loss: 0.7831, instance_loss: 0.6005, weighted_loss: 0.7284, label: 1, bag_size: 1712
batch 539, loss: 0.9874, instance_loss: 0.7844, weighted_loss: 0.9265, label: 0, bag_size: 2257
batch 559, loss: 1.2761, instance_loss: 0.7376, weighted_loss: 1.1145, label: 1, bag_size: 3644
batch 579, loss: 0.1703, instance_loss: 0.4192, weighted_loss: 0.2449, label: 2, bag_size: 3497
batch 599, loss: 0.4513, instance_loss: 0.4978, weighted_loss: 0.4653, label: 0, bag_size: 2190
batch 619, loss: 2.5379, instance_loss: 1.4404, weighted_loss: 2.2086, label: 0, bag_size: 1886
batch 639, loss: 0.5354, instance_loss: 0.5873, weighted_loss: 0.5510, label: 0, bag_size: 4529
batch 659, loss: 2.6324, instance_loss: 1.2272, weighted_loss: 2.2108, label: 0, bag_size: 5259
batch 679, loss: 1.0725, instance_loss: 0.8331, weighted_loss: 1.0007, label: 2, bag_size: 4342
batch 699, loss: 1.3726, instance_loss: 0.9282, weighted_loss: 1.2393, label: 0, bag_size: 3182
batch 719, loss: 2.1351, instance_loss: 0.9610, weighted_loss: 1.7829, label: 1, bag_size: 32
batch 739, loss: 1.0117, instance_loss: 0.5749, weighted_loss: 0.8806, label: 1, bag_size: 3403


class 0 clustering acc 0.9922259507829978: correct 17741/17880
class 1 clustering acc 0.05536912751677853: correct 330/5960
Epoch: 3, train_loss: 0.8388, train_clustering_loss:  0.6544, train_error: 0.3597
class 0: acc 0.7110266159695817, correct 187/263
class 1: acc 0.5241935483870968, correct 130/248
class 2: acc 0.6837606837606838, correct 160/234

Val Set, val_loss: 0.7960, val_error: 0.3723, auc: 0.8085
class 0 clustering acc 0.9986702127659575: correct 2253/2256
class 1 clustering acc 0.023936170212765957: correct 18/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.903399 --> 0.795977).  Saving model ...


batch 19, loss: 1.0925, instance_loss: 0.7471, weighted_loss: 0.9889, label: 0, bag_size: 3904
batch 39, loss: 3.1584, instance_loss: 1.2044, weighted_loss: 2.5722, label: 1, bag_size: 4067
batch 59, loss: 0.3359, instance_loss: 0.7919, weighted_loss: 0.4727, label: 2, bag_size: 4535
batch 79, loss: 1.1725, instance_loss: 0.7835, weighted_loss: 1.0558, label: 0, bag_size: 1543
batch 99, loss: 1.3245, instance_loss: 0.8119, weighted_loss: 1.1707, label: 2, bag_size: 3534
batch 119, loss: 0.1250, instance_loss: 0.1653, weighted_loss: 0.1371, label: 2, bag_size: 2561
batch 139, loss: 1.0967, instance_loss: 0.7934, weighted_loss: 1.0057, label: 2, bag_size: 2486
batch 159, loss: 0.4884, instance_loss: 0.5542, weighted_loss: 0.5081, label: 1, bag_size: 3493
batch 179, loss: 0.5374, instance_loss: 0.5869, weighted_loss: 0.5523, label: 0, bag_size: 1812
batch 199, loss: 0.0096, instance_loss: 0.0839, weighted_loss: 0.0319, label: 0, bag_size: 6182
batch 219, loss: 1.7295, instance_loss: 1.0608, weighted_loss: 1.5289, label: 2, bag_size: 361
batch 239, loss: 0.4565, instance_loss: 0.5342, weighted_loss: 0.4798, label: 0, bag_size: 7330
batch 259, loss: 0.2496, instance_loss: 0.3776, weighted_loss: 0.2880, label: 0, bag_size: 4634
batch 279, loss: 0.9456, instance_loss: 1.0176, weighted_loss: 0.9672, label: 0, bag_size: 421
batch 299, loss: 0.5460, instance_loss: 0.3993, weighted_loss: 0.5020, label: 0, bag_size: 3532
batch 319, loss: 0.5864, instance_loss: 0.4146, weighted_loss: 0.5349, label: 1, bag_size: 6993
batch 339, loss: 0.8310, instance_loss: 0.4929, weighted_loss: 0.7296, label: 0, bag_size: 4201
batch 359, loss: 0.9681, instance_loss: 0.6695, weighted_loss: 0.8785, label: 0, bag_size: 4647
batch 379, loss: 2.8215, instance_loss: 1.9275, weighted_loss: 2.5533, label: 1, bag_size: 3995
batch 399, loss: 0.1720, instance_loss: 0.1622, weighted_loss: 0.1691, label: 2, bag_size: 2254
batch 419, loss: 0.1277, instance_loss: 0.3555, weighted_loss: 0.1960, label: 0, bag_size: 3649
batch 439, loss: 0.3798, instance_loss: 0.2350, weighted_loss: 0.3364, label: 2, bag_size: 4856
batch 459, loss: 0.4925, instance_loss: 0.3846, weighted_loss: 0.4602, label: 2, bag_size: 3678
batch 479, loss: 0.2740, instance_loss: 0.4561, weighted_loss: 0.3287, label: 1, bag_size: 4027
batch 499, loss: 0.9082, instance_loss: 0.6861, weighted_loss: 0.8416, label: 1, bag_size: 4705
batch 519, loss: 0.6061, instance_loss: 0.7402, weighted_loss: 0.6463, label: 1, bag_size: 6315
batch 539, loss: 0.2371, instance_loss: 0.4311, weighted_loss: 0.2953, label: 0, bag_size: 5500
batch 559, loss: 1.7212, instance_loss: 0.8305, weighted_loss: 1.4540, label: 1, bag_size: 1313
batch 579, loss: 1.0253, instance_loss: 0.5909, weighted_loss: 0.8950, label: 1, bag_size: 5197
batch 599, loss: 0.4498, instance_loss: 0.5213, weighted_loss: 0.4713, label: 1, bag_size: 6277
batch 619, loss: 0.7952, instance_loss: 0.6001, weighted_loss: 0.7367, label: 0, bag_size: 5915
batch 639, loss: 0.2109, instance_loss: 0.4219, weighted_loss: 0.2742, label: 0, bag_size: 5036
batch 659, loss: 1.2842, instance_loss: 0.7124, weighted_loss: 1.1126, label: 1, bag_size: 3534
batch 679, loss: 0.9244, instance_loss: 1.1211, weighted_loss: 0.9834, label: 1, bag_size: 2229
batch 699, loss: 0.9963, instance_loss: 0.6955, weighted_loss: 0.9061, label: 1, bag_size: 4467
batch 719, loss: 0.2107, instance_loss: 0.5164, weighted_loss: 0.3024, label: 0, bag_size: 1611
batch 739, loss: 1.8273, instance_loss: 1.2183, weighted_loss: 1.6446, label: 2, bag_size: 4571


class 0 clustering acc 0.9901565995525727: correct 17704/17880
class 1 clustering acc 0.08439597315436241: correct 503/5960
Epoch: 4, train_loss: 0.8110, train_clustering_loss:  0.6431, train_error: 0.3557
class 0: acc 0.6818181818181818, correct 180/264
class 1: acc 0.5181818181818182, correct 114/220
class 2: acc 0.7126436781609196, correct 186/261

Val Set, val_loss: 0.7647, val_error: 0.3298, auc: 0.8179
class 0 clustering acc 0.9960106382978723: correct 2247/2256
class 1 clustering acc 0.04521276595744681: correct 34/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.795977 --> 0.764669).  Saving model ...


batch 19, loss: 1.0933, instance_loss: 0.7236, weighted_loss: 0.9824, label: 1, bag_size: 3619
batch 39, loss: 1.0909, instance_loss: 0.6785, weighted_loss: 0.9672, label: 1, bag_size: 1558
batch 59, loss: 0.6882, instance_loss: 0.6221, weighted_loss: 0.6684, label: 2, bag_size: 5307
batch 79, loss: 0.6035, instance_loss: 0.4733, weighted_loss: 0.5644, label: 1, bag_size: 2156
batch 99, loss: 1.7552, instance_loss: 0.9180, weighted_loss: 1.5041, label: 2, bag_size: 4316
batch 119, loss: 1.5281, instance_loss: 1.2692, weighted_loss: 1.4504, label: 0, bag_size: 2231
batch 139, loss: 0.2353, instance_loss: 0.4190, weighted_loss: 0.2904, label: 1, bag_size: 3337
batch 159, loss: 0.2480, instance_loss: 0.5300, weighted_loss: 0.3326, label: 2, bag_size: 5138
batch 179, loss: 0.1442, instance_loss: 0.3212, weighted_loss: 0.1973, label: 0, bag_size: 4196
batch 199, loss: 0.2467, instance_loss: 0.6020, weighted_loss: 0.3533, label: 2, bag_size: 2770
batch 219, loss: 0.3143, instance_loss: 0.5997, weighted_loss: 0.3999, label: 2, bag_size: 4978
batch 239, loss: 0.7092, instance_loss: 0.5198, weighted_loss: 0.6524, label: 1, bag_size: 3983
batch 259, loss: 0.4002, instance_loss: 0.4049, weighted_loss: 0.4016, label: 1, bag_size: 2055
batch 279, loss: 0.4694, instance_loss: 0.5607, weighted_loss: 0.4968, label: 2, bag_size: 3172
batch 299, loss: 1.0389, instance_loss: 1.2696, weighted_loss: 1.1081, label: 0, bag_size: 2428
batch 319, loss: 0.4525, instance_loss: 0.5027, weighted_loss: 0.4676, label: 0, bag_size: 2852
batch 339, loss: 0.2330, instance_loss: 0.6181, weighted_loss: 0.3485, label: 0, bag_size: 1341
batch 359, loss: 0.9858, instance_loss: 0.6371, weighted_loss: 0.8812, label: 1, bag_size: 4200
batch 379, loss: 1.6522, instance_loss: 0.8435, weighted_loss: 1.4096, label: 2, bag_size: 4342
batch 399, loss: 1.5654, instance_loss: 1.1164, weighted_loss: 1.4307, label: 1, bag_size: 1604
batch 419, loss: 0.6592, instance_loss: 0.5062, weighted_loss: 0.6133, label: 1, bag_size: 2865
batch 439, loss: 0.7881, instance_loss: 0.9758, weighted_loss: 0.8444, label: 0, bag_size: 5585
batch 459, loss: 0.0645, instance_loss: 0.2086, weighted_loss: 0.1077, label: 2, bag_size: 3397
batch 479, loss: 0.2225, instance_loss: 0.4791, weighted_loss: 0.2995, label: 0, bag_size: 3727
batch 499, loss: 0.2012, instance_loss: 0.6119, weighted_loss: 0.3244, label: 2, bag_size: 6148
batch 519, loss: 1.7356, instance_loss: 0.7139, weighted_loss: 1.4291, label: 2, bag_size: 3274
batch 539, loss: 0.3244, instance_loss: 0.4581, weighted_loss: 0.3645, label: 0, bag_size: 4634
batch 559, loss: 0.4899, instance_loss: 0.4130, weighted_loss: 0.4668, label: 2, bag_size: 2049
batch 579, loss: 0.9547, instance_loss: 0.7842, weighted_loss: 0.9035, label: 0, bag_size: 3743
batch 599, loss: 0.7244, instance_loss: 0.5933, weighted_loss: 0.6851, label: 0, bag_size: 4018
batch 619, loss: 0.5620, instance_loss: 0.4907, weighted_loss: 0.5406, label: 1, bag_size: 1854
batch 639, loss: 0.0549, instance_loss: 0.3619, weighted_loss: 0.1470, label: 1, bag_size: 3425
batch 659, loss: 0.5109, instance_loss: 0.4153, weighted_loss: 0.4822, label: 1, bag_size: 3221
batch 679, loss: 0.2198, instance_loss: 0.2581, weighted_loss: 0.2313, label: 1, bag_size: 5026
batch 699, loss: 1.9686, instance_loss: 0.8527, weighted_loss: 1.6338, label: 2, bag_size: 2031
batch 719, loss: 0.4569, instance_loss: 0.3681, weighted_loss: 0.4303, label: 1, bag_size: 1599
batch 739, loss: 0.6224, instance_loss: 0.4395, weighted_loss: 0.5675, label: 2, bag_size: 5924


class 0 clustering acc 0.9838366890380313: correct 17591/17880
class 1 clustering acc 0.1226510067114094: correct 731/5960
Epoch: 5, train_loss: 0.7741, train_clustering_loss:  0.6329, train_error: 0.3383
class 0: acc 0.6078431372549019, correct 124/204
class 1: acc 0.635036496350365, correct 174/274
class 2: acc 0.7303370786516854, correct 195/267

Val Set, val_loss: 1.0278, val_error: 0.4362, auc: 0.8007
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.03723404255319149: correct 28/752
class 0: acc 0.34615384615384615, correct 18/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3923, instance_loss: 0.3216, weighted_loss: 0.3711, label: 1, bag_size: 3534
batch 39, loss: 2.6826, instance_loss: 1.3171, weighted_loss: 2.2729, label: 2, bag_size: 223
batch 59, loss: 1.0370, instance_loss: 0.7600, weighted_loss: 0.9539, label: 2, bag_size: 3746
batch 79, loss: 2.7678, instance_loss: 1.1463, weighted_loss: 2.2813, label: 0, bag_size: 35080
batch 99, loss: 0.3677, instance_loss: 0.6937, weighted_loss: 0.4655, label: 0, bag_size: 673
batch 119, loss: 0.6798, instance_loss: 0.6758, weighted_loss: 0.6786, label: 1, bag_size: 3225
batch 139, loss: 2.4651, instance_loss: 1.0958, weighted_loss: 2.0544, label: 2, bag_size: 223
batch 159, loss: 3.7053, instance_loss: 1.4003, weighted_loss: 3.0138, label: 0, bag_size: 18038
batch 179, loss: 1.1941, instance_loss: 0.6426, weighted_loss: 1.0286, label: 1, bag_size: 4684
batch 199, loss: 0.3367, instance_loss: 0.3841, weighted_loss: 0.3509, label: 2, bag_size: 5914
batch 219, loss: 0.5569, instance_loss: 0.4394, weighted_loss: 0.5217, label: 1, bag_size: 5340
batch 239, loss: 0.3136, instance_loss: 0.4737, weighted_loss: 0.3616, label: 2, bag_size: 5037
batch 259, loss: 0.1540, instance_loss: 0.1939, weighted_loss: 0.1660, label: 0, bag_size: 4403
batch 279, loss: 1.1266, instance_loss: 0.9963, weighted_loss: 1.0875, label: 1, bag_size: 32
batch 299, loss: 1.3777, instance_loss: 1.1213, weighted_loss: 1.3008, label: 2, bag_size: 22464
batch 319, loss: 0.2014, instance_loss: 0.4071, weighted_loss: 0.2631, label: 2, bag_size: 3121
batch 339, loss: 0.5986, instance_loss: 0.6510, weighted_loss: 0.6144, label: 1, bag_size: 5340
batch 359, loss: 0.1820, instance_loss: 0.1597, weighted_loss: 0.1753, label: 2, bag_size: 4856
batch 379, loss: 0.8024, instance_loss: 0.3892, weighted_loss: 0.6784, label: 0, bag_size: 4245
batch 399, loss: 0.9762, instance_loss: 0.7197, weighted_loss: 0.8992, label: 1, bag_size: 1307
batch 419, loss: 0.3448, instance_loss: 0.4214, weighted_loss: 0.3678, label: 1, bag_size: 5118
batch 439, loss: 0.8788, instance_loss: 0.7036, weighted_loss: 0.8262, label: 1, bag_size: 5926
batch 459, loss: 0.7533, instance_loss: 0.5831, weighted_loss: 0.7022, label: 0, bag_size: 2153
batch 479, loss: 0.2826, instance_loss: 0.4427, weighted_loss: 0.3306, label: 0, bag_size: 4344
batch 499, loss: 0.7765, instance_loss: 0.5026, weighted_loss: 0.6943, label: 0, bag_size: 3915
batch 519, loss: 3.7035, instance_loss: 1.2605, weighted_loss: 2.9706, label: 2, bag_size: 223
batch 539, loss: 0.3885, instance_loss: 0.5554, weighted_loss: 0.4386, label: 1, bag_size: 475
batch 559, loss: 0.3585, instance_loss: 0.4880, weighted_loss: 0.3974, label: 0, bag_size: 2545
batch 579, loss: 0.5333, instance_loss: 0.6118, weighted_loss: 0.5568, label: 2, bag_size: 6594
batch 599, loss: 0.2611, instance_loss: 0.4462, weighted_loss: 0.3166, label: 0, bag_size: 5036
batch 619, loss: 0.4638, instance_loss: 0.6245, weighted_loss: 0.5120, label: 2, bag_size: 4978
batch 639, loss: 0.7399, instance_loss: 0.9522, weighted_loss: 0.8036, label: 0, bag_size: 4529
batch 659, loss: 0.8956, instance_loss: 0.6356, weighted_loss: 0.8176, label: 0, bag_size: 1055
batch 679, loss: 0.4128, instance_loss: 0.5859, weighted_loss: 0.4647, label: 1, bag_size: 2767
batch 699, loss: 0.1251, instance_loss: 0.3990, weighted_loss: 0.2073, label: 2, bag_size: 2209
batch 719, loss: 0.5861, instance_loss: 0.4865, weighted_loss: 0.5562, label: 1, bag_size: 4395
batch 739, loss: 0.5421, instance_loss: 0.5238, weighted_loss: 0.5366, label: 1, bag_size: 3391


class 0 clustering acc 0.9880313199105145: correct 17666/17880
class 1 clustering acc 0.10134228187919463: correct 604/5960
Epoch: 6, train_loss: 0.7760, train_clustering_loss:  0.6339, train_error: 0.3356
class 0: acc 0.6504065040650406, correct 160/246
class 1: acc 0.6334661354581673, correct 159/251
class 2: acc 0.7096774193548387, correct 176/248

Val Set, val_loss: 0.7025, val_error: 0.2979, auc: 0.8352
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.19547872340425532: correct 147/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.764669 --> 0.702464).  Saving model ...


batch 19, loss: 0.4949, instance_loss: 0.4794, weighted_loss: 0.4902, label: 0, bag_size: 3885
batch 39, loss: 0.2072, instance_loss: 0.5936, weighted_loss: 0.3231, label: 2, bag_size: 5138
batch 59, loss: 1.1421, instance_loss: 0.8501, weighted_loss: 1.0545, label: 0, bag_size: 893
batch 79, loss: 1.1908, instance_loss: 0.9124, weighted_loss: 1.1073, label: 1, bag_size: 5926
batch 99, loss: 0.7583, instance_loss: 0.5853, weighted_loss: 0.7064, label: 2, bag_size: 6298
batch 119, loss: 0.2138, instance_loss: 0.4195, weighted_loss: 0.2755, label: 2, bag_size: 3174
batch 139, loss: 1.2241, instance_loss: 0.9503, weighted_loss: 1.1419, label: 2, bag_size: 2486
batch 159, loss: 0.5273, instance_loss: 0.6620, weighted_loss: 0.5677, label: 1, bag_size: 6475
batch 179, loss: 0.5941, instance_loss: 0.5082, weighted_loss: 0.5683, label: 2, bag_size: 3534
batch 199, loss: 0.3363, instance_loss: 0.4356, weighted_loss: 0.3661, label: 0, bag_size: 1233
batch 219, loss: 1.4189, instance_loss: 0.7384, weighted_loss: 1.2148, label: 2, bag_size: 552
batch 239, loss: 1.1258, instance_loss: 0.9201, weighted_loss: 1.0641, label: 2, bag_size: 2486
batch 259, loss: 0.6040, instance_loss: 0.6334, weighted_loss: 0.6128, label: 0, bag_size: 4808
batch 279, loss: 1.1262, instance_loss: 0.5058, weighted_loss: 0.9401, label: 0, bag_size: 7077
batch 299, loss: 1.4859, instance_loss: 0.7693, weighted_loss: 1.2709, label: 2, bag_size: 6298
batch 319, loss: 0.0358, instance_loss: 0.4906, weighted_loss: 0.1722, label: 2, bag_size: 4497
batch 339, loss: 0.1220, instance_loss: 0.3095, weighted_loss: 0.1782, label: 2, bag_size: 3396
batch 359, loss: 4.1190, instance_loss: 1.6092, weighted_loss: 3.3661, label: 1, bag_size: 4067
batch 379, loss: 2.3086, instance_loss: 1.0546, weighted_loss: 1.9324, label: 0, bag_size: 3402
batch 399, loss: 0.2615, instance_loss: 0.4745, weighted_loss: 0.3254, label: 0, bag_size: 1233
batch 419, loss: 0.3983, instance_loss: 0.5535, weighted_loss: 0.4448, label: 0, bag_size: 2927
batch 439, loss: 0.8391, instance_loss: 0.5769, weighted_loss: 0.7605, label: 1, bag_size: 4187
batch 459, loss: 1.8880, instance_loss: 0.9995, weighted_loss: 1.6215, label: 1, bag_size: 2425
batch 479, loss: 0.9297, instance_loss: 0.6177, weighted_loss: 0.8361, label: 1, bag_size: 2182
batch 499, loss: 1.6927, instance_loss: 0.7275, weighted_loss: 1.4031, label: 1, bag_size: 2083
batch 519, loss: 0.3537, instance_loss: 0.3845, weighted_loss: 0.3629, label: 0, bag_size: 6015
batch 539, loss: 0.4638, instance_loss: 0.8127, weighted_loss: 0.5685, label: 2, bag_size: 4571
batch 559, loss: 2.3989, instance_loss: 1.1749, weighted_loss: 2.0317, label: 0, bag_size: 3419
batch 579, loss: 0.5840, instance_loss: 0.6570, weighted_loss: 0.6059, label: 2, bag_size: 6298
batch 599, loss: 1.2761, instance_loss: 0.6170, weighted_loss: 1.0784, label: 1, bag_size: 4395
batch 619, loss: 0.2833, instance_loss: 0.5500, weighted_loss: 0.3633, label: 0, bag_size: 1782
batch 639, loss: 0.0425, instance_loss: 0.6948, weighted_loss: 0.2382, label: 0, bag_size: 1140
batch 659, loss: 0.0793, instance_loss: 0.4755, weighted_loss: 0.1981, label: 0, bag_size: 1611
batch 679, loss: 0.8907, instance_loss: 0.6895, weighted_loss: 0.8303, label: 1, bag_size: 1558
batch 699, loss: 0.9778, instance_loss: 0.5671, weighted_loss: 0.8546, label: 0, bag_size: 4562
batch 719, loss: 1.0488, instance_loss: 0.7419, weighted_loss: 0.9567, label: 0, bag_size: 1352
batch 739, loss: 1.0934, instance_loss: 0.7687, weighted_loss: 0.9960, label: 1, bag_size: 1023


class 0 clustering acc 0.9873042505592842: correct 17653/17880
class 1 clustering acc 0.12701342281879194: correct 757/5960
Epoch: 7, train_loss: 0.7745, train_clustering_loss:  0.6389, train_error: 0.3570
class 0: acc 0.6569037656903766, correct 157/239
class 1: acc 0.551440329218107, correct 134/243
class 2: acc 0.714828897338403, correct 188/263

Val Set, val_loss: 0.7088, val_error: 0.3723, auc: 0.8359
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.02127659574468085: correct 16/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.16666666666666666, correct 2/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9886, instance_loss: 1.1078, weighted_loss: 1.0243, label: 2, bag_size: 4571
batch 39, loss: 2.9928, instance_loss: 1.2674, weighted_loss: 2.4752, label: 0, bag_size: 35080
batch 59, loss: 0.4178, instance_loss: 0.2845, weighted_loss: 0.3778, label: 2, bag_size: 3094
batch 79, loss: 0.7724, instance_loss: 0.4585, weighted_loss: 0.6782, label: 1, bag_size: 3482
batch 99, loss: 0.6463, instance_loss: 0.4120, weighted_loss: 0.5760, label: 0, bag_size: 4018
batch 119, loss: 0.0216, instance_loss: 0.0977, weighted_loss: 0.0444, label: 1, bag_size: 5462
batch 139, loss: 0.1661, instance_loss: 0.5624, weighted_loss: 0.2850, label: 2, bag_size: 4192
batch 159, loss: 0.1703, instance_loss: 0.5058, weighted_loss: 0.2710, label: 2, bag_size: 3778
batch 179, loss: 0.6406, instance_loss: 0.6845, weighted_loss: 0.6538, label: 2, bag_size: 22464
batch 199, loss: 0.3704, instance_loss: 0.4803, weighted_loss: 0.4034, label: 0, bag_size: 2791
batch 219, loss: 0.1973, instance_loss: 0.4402, weighted_loss: 0.2701, label: 2, bag_size: 4555
batch 239, loss: 0.5472, instance_loss: 0.5908, weighted_loss: 0.5603, label: 1, bag_size: 14449
batch 259, loss: 0.2159, instance_loss: 0.3966, weighted_loss: 0.2701, label: 2, bag_size: 5914
batch 279, loss: 3.7757, instance_loss: 1.7207, weighted_loss: 3.1592, label: 0, bag_size: 2392
batch 299, loss: 1.0456, instance_loss: 0.7324, weighted_loss: 0.9517, label: 1, bag_size: 6025
batch 319, loss: 1.3550, instance_loss: 1.1045, weighted_loss: 1.2798, label: 1, bag_size: 1477
batch 339, loss: 0.2804, instance_loss: 0.4332, weighted_loss: 0.3262, label: 0, bag_size: 2094
batch 359, loss: 1.3442, instance_loss: 0.8238, weighted_loss: 1.1880, label: 1, bag_size: 782
batch 379, loss: 1.8866, instance_loss: 0.8392, weighted_loss: 1.5724, label: 0, bag_size: 3341
batch 399, loss: 0.7430, instance_loss: 0.9594, weighted_loss: 0.8079, label: 2, bag_size: 2486
batch 419, loss: 0.0343, instance_loss: 0.1517, weighted_loss: 0.0695, label: 2, bag_size: 3397
batch 439, loss: 0.7465, instance_loss: 0.8372, weighted_loss: 0.7737, label: 2, bag_size: 4535
batch 459, loss: 1.2904, instance_loss: 0.7523, weighted_loss: 1.1290, label: 2, bag_size: 3746
batch 479, loss: 0.5411, instance_loss: 0.6009, weighted_loss: 0.5591, label: 0, bag_size: 3694
batch 499, loss: 0.4550, instance_loss: 0.5532, weighted_loss: 0.4844, label: 0, bag_size: 6285
batch 519, loss: 0.3107, instance_loss: 0.4026, weighted_loss: 0.3383, label: 0, bag_size: 999
batch 539, loss: 0.3523, instance_loss: 0.4780, weighted_loss: 0.3900, label: 0, bag_size: 3864
batch 559, loss: 1.1697, instance_loss: 0.7948, weighted_loss: 1.0572, label: 0, bag_size: 1025
batch 579, loss: 0.4872, instance_loss: 0.4349, weighted_loss: 0.4715, label: 0, bag_size: 3754
batch 599, loss: 0.2560, instance_loss: 0.6674, weighted_loss: 0.3794, label: 2, bag_size: 3607
batch 619, loss: 0.8548, instance_loss: 0.5962, weighted_loss: 0.7772, label: 0, bag_size: 4541
batch 639, loss: 2.4707, instance_loss: 1.0312, weighted_loss: 2.0389, label: 0, bag_size: 1753
batch 659, loss: 0.9889, instance_loss: 0.6432, weighted_loss: 0.8852, label: 1, bag_size: 5718
batch 679, loss: 0.1333, instance_loss: 0.5059, weighted_loss: 0.2450, label: 2, bag_size: 4192
batch 699, loss: 0.0224, instance_loss: 0.0814, weighted_loss: 0.0401, label: 2, bag_size: 3285
batch 719, loss: 0.2640, instance_loss: 0.5539, weighted_loss: 0.3510, label: 2, bag_size: 3778
batch 739, loss: 0.4569, instance_loss: 0.5029, weighted_loss: 0.4707, label: 2, bag_size: 3396


class 0 clustering acc 0.9902684563758389: correct 17706/17880
class 1 clustering acc 0.10771812080536913: correct 642/5960
Epoch: 8, train_loss: 0.7446, train_clustering_loss:  0.6275, train_error: 0.3342
class 0: acc 0.6705882352941176, correct 171/255
class 1: acc 0.59765625, correct 153/256
class 2: acc 0.7350427350427351, correct 172/234

Val Set, val_loss: 0.6893, val_error: 0.2872, auc: 0.8514
class 0 clustering acc 0.9942375886524822: correct 2243/2256
class 1 clustering acc 0.14361702127659576: correct 108/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.702464 --> 0.689321).  Saving model ...


batch 19, loss: 1.5007, instance_loss: 1.1319, weighted_loss: 1.3900, label: 1, bag_size: 2182
batch 39, loss: 0.2672, instance_loss: 0.4561, weighted_loss: 0.3239, label: 0, bag_size: 1052
batch 59, loss: 2.7107, instance_loss: 1.1727, weighted_loss: 2.2493, label: 1, bag_size: 12936
batch 79, loss: 0.2365, instance_loss: 0.3840, weighted_loss: 0.2807, label: 0, bag_size: 2825
batch 99, loss: 0.1229, instance_loss: 0.3872, weighted_loss: 0.2022, label: 0, bag_size: 1647
batch 119, loss: 1.0876, instance_loss: 0.7146, weighted_loss: 0.9757, label: 1, bag_size: 2751
batch 139, loss: 0.4749, instance_loss: 0.4348, weighted_loss: 0.4629, label: 0, bag_size: 6863
batch 159, loss: 0.7043, instance_loss: 0.6813, weighted_loss: 0.6974, label: 0, bag_size: 4741
batch 179, loss: 0.0758, instance_loss: 0.1938, weighted_loss: 0.1112, label: 2, bag_size: 3415
batch 199, loss: 0.9721, instance_loss: 0.6102, weighted_loss: 0.8635, label: 1, bag_size: 4395
batch 219, loss: 0.3816, instance_loss: 0.5767, weighted_loss: 0.4402, label: 1, bag_size: 4119
batch 239, loss: 0.2990, instance_loss: 0.4888, weighted_loss: 0.3559, label: 0, bag_size: 5893
batch 259, loss: 1.5182, instance_loss: 1.1398, weighted_loss: 1.4047, label: 2, bag_size: 4571
batch 279, loss: 0.1523, instance_loss: 0.2140, weighted_loss: 0.1708, label: 2, bag_size: 2359
batch 299, loss: 0.4082, instance_loss: 0.5988, weighted_loss: 0.4654, label: 2, bag_size: 3174
batch 319, loss: 1.7787, instance_loss: 0.8635, weighted_loss: 1.5042, label: 1, bag_size: 2013
batch 339, loss: 0.6145, instance_loss: 0.5298, weighted_loss: 0.5891, label: 1, bag_size: 2342
batch 359, loss: 0.8451, instance_loss: 0.7498, weighted_loss: 0.8165, label: 1, bag_size: 2859
batch 379, loss: 0.1587, instance_loss: 0.5460, weighted_loss: 0.2749, label: 2, bag_size: 4487
batch 399, loss: 0.5470, instance_loss: 0.7310, weighted_loss: 0.6022, label: 2, bag_size: 3778
batch 419, loss: 0.6595, instance_loss: 0.5885, weighted_loss: 0.6382, label: 0, bag_size: 3268
batch 439, loss: 0.1449, instance_loss: 0.6378, weighted_loss: 0.2927, label: 2, bag_size: 5472
batch 459, loss: 1.3077, instance_loss: 0.6675, weighted_loss: 1.1157, label: 0, bag_size: 13770
batch 479, loss: 0.1728, instance_loss: 0.4661, weighted_loss: 0.2608, label: 0, bag_size: 14070
batch 499, loss: 0.3173, instance_loss: 0.5401, weighted_loss: 0.3841, label: 1, bag_size: 3586
batch 519, loss: 0.0401, instance_loss: 0.2349, weighted_loss: 0.0985, label: 2, bag_size: 4487
batch 539, loss: 1.6891, instance_loss: 0.9564, weighted_loss: 1.4693, label: 2, bag_size: 1050
batch 559, loss: 0.7857, instance_loss: 0.6963, weighted_loss: 0.7589, label: 1, bag_size: 9099
batch 579, loss: 0.5067, instance_loss: 0.5795, weighted_loss: 0.5285, label: 1, bag_size: 455
batch 599, loss: 1.3152, instance_loss: 0.9982, weighted_loss: 1.2201, label: 1, bag_size: 782
batch 619, loss: 0.3977, instance_loss: 0.3812, weighted_loss: 0.3927, label: 0, bag_size: 2487
batch 639, loss: 0.5032, instance_loss: 0.6814, weighted_loss: 0.5566, label: 0, bag_size: 1170
batch 659, loss: 0.1615, instance_loss: 0.2231, weighted_loss: 0.1800, label: 2, bag_size: 6026
batch 679, loss: 2.1613, instance_loss: 0.8841, weighted_loss: 1.7781, label: 2, bag_size: 728
batch 699, loss: 1.7239, instance_loss: 0.8618, weighted_loss: 1.4653, label: 1, bag_size: 11974
batch 719, loss: 0.6659, instance_loss: 0.6389, weighted_loss: 0.6578, label: 0, bag_size: 4242
batch 739, loss: 0.9880, instance_loss: 0.6953, weighted_loss: 0.9002, label: 0, bag_size: 1141


class 0 clustering acc 0.9812080536912752: correct 17544/17880
class 1 clustering acc 0.19328859060402684: correct 1152/5960
Epoch: 9, train_loss: 0.7144, train_clustering_loss:  0.6041, train_error: 0.3020
class 0: acc 0.7698412698412699, correct 194/252
class 1: acc 0.6287878787878788, correct 166/264
class 2: acc 0.6986899563318777, correct 160/229

Val Set, val_loss: 0.6886, val_error: 0.3298, auc: 0.8529
class 0 clustering acc 0.9946808510638298: correct 2244/2256
class 1 clustering acc 0.16356382978723405: correct 123/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (0.689321 --> 0.688645).  Saving model ...


batch 19, loss: 0.7832, instance_loss: 0.6547, weighted_loss: 0.7447, label: 1, bag_size: 209
batch 39, loss: 2.3447, instance_loss: 1.0843, weighted_loss: 1.9666, label: 0, bag_size: 877
batch 59, loss: 0.6927, instance_loss: 0.8027, weighted_loss: 0.7257, label: 1, bag_size: 2122
batch 79, loss: 0.7523, instance_loss: 0.5551, weighted_loss: 0.6931, label: 2, bag_size: 2813
batch 99, loss: 0.1104, instance_loss: 0.1197, weighted_loss: 0.1132, label: 2, bag_size: 3546
batch 119, loss: 0.1614, instance_loss: 0.5167, weighted_loss: 0.2680, label: 0, bag_size: 7169
batch 139, loss: 0.3821, instance_loss: 0.4820, weighted_loss: 0.4121, label: 0, bag_size: 4416
batch 159, loss: 0.3457, instance_loss: 0.5671, weighted_loss: 0.4121, label: 0, bag_size: 1097
batch 179, loss: 0.1655, instance_loss: 0.3490, weighted_loss: 0.2205, label: 0, bag_size: 3649
batch 199, loss: 0.1812, instance_loss: 0.4243, weighted_loss: 0.2542, label: 0, bag_size: 7169
batch 219, loss: 0.6570, instance_loss: 0.4318, weighted_loss: 0.5895, label: 0, bag_size: 3188
batch 239, loss: 1.2024, instance_loss: 0.7815, weighted_loss: 1.0761, label: 1, bag_size: 1122
batch 259, loss: 0.2834, instance_loss: 0.3548, weighted_loss: 0.3048, label: 0, bag_size: 3348
batch 279, loss: 0.1616, instance_loss: 0.2095, weighted_loss: 0.1760, label: 0, bag_size: 4634
batch 299, loss: 1.0643, instance_loss: 0.5918, weighted_loss: 0.9225, label: 1, bag_size: 3106
batch 319, loss: 0.4910, instance_loss: 0.3744, weighted_loss: 0.4560, label: 2, bag_size: 1103
batch 339, loss: 0.1856, instance_loss: 0.2547, weighted_loss: 0.2063, label: 2, bag_size: 3678
batch 359, loss: 0.7962, instance_loss: 0.7848, weighted_loss: 0.7928, label: 1, bag_size: 1023
batch 379, loss: 0.0722, instance_loss: 0.0442, weighted_loss: 0.0638, label: 2, bag_size: 1094
batch 399, loss: 0.7357, instance_loss: 0.5992, weighted_loss: 0.6947, label: 2, bag_size: 3534
batch 419, loss: 0.3754, instance_loss: 0.6278, weighted_loss: 0.4511, label: 0, bag_size: 3601
batch 439, loss: 0.7856, instance_loss: 0.5011, weighted_loss: 0.7002, label: 2, bag_size: 3026
batch 459, loss: 0.1765, instance_loss: 0.5003, weighted_loss: 0.2736, label: 2, bag_size: 3778
batch 479, loss: 1.8791, instance_loss: 0.9870, weighted_loss: 1.6114, label: 2, bag_size: 1050
batch 499, loss: 0.5800, instance_loss: 0.4470, weighted_loss: 0.5401, label: 2, bag_size: 1103
batch 519, loss: 0.2649, instance_loss: 0.6634, weighted_loss: 0.3844, label: 2, bag_size: 5017
batch 539, loss: 0.2961, instance_loss: 0.3755, weighted_loss: 0.3199, label: 2, bag_size: 597
batch 559, loss: 0.3541, instance_loss: 0.5780, weighted_loss: 0.4213, label: 1, bag_size: 800
batch 579, loss: 1.0186, instance_loss: 0.9171, weighted_loss: 0.9881, label: 0, bag_size: 789
batch 599, loss: 0.3640, instance_loss: 0.6041, weighted_loss: 0.4360, label: 0, bag_size: 2139
batch 619, loss: 0.0945, instance_loss: 0.3296, weighted_loss: 0.1650, label: 2, bag_size: 4555
batch 639, loss: 1.1428, instance_loss: 0.7656, weighted_loss: 1.0297, label: 0, bag_size: 3904
batch 659, loss: 0.8122, instance_loss: 0.9925, weighted_loss: 0.8663, label: 0, bag_size: 3245
batch 679, loss: 0.4646, instance_loss: 0.3389, weighted_loss: 0.4269, label: 0, bag_size: 4634
batch 699, loss: 0.2898, instance_loss: 0.3709, weighted_loss: 0.3141, label: 1, bag_size: 2254
batch 719, loss: 0.3608, instance_loss: 0.5200, weighted_loss: 0.4086, label: 1, bag_size: 1197
batch 739, loss: 0.7403, instance_loss: 0.4632, weighted_loss: 0.6572, label: 0, bag_size: 3533


class 0 clustering acc 0.9786912751677852: correct 17499/17880
class 1 clustering acc 0.22550335570469798: correct 1344/5960
Epoch: 10, train_loss: 0.6743, train_clustering_loss:  0.5960, train_error: 0.2658
class 0: acc 0.7629310344827587, correct 177/232
class 1: acc 0.6328125, correct 162/256
class 2: acc 0.8093385214007782, correct 208/257

Val Set, val_loss: 0.7394, val_error: 0.3085, auc: 0.8592
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.17553191489361702: correct 132/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3650, instance_loss: 0.4344, weighted_loss: 0.3858, label: 1, bag_size: 3156
batch 39, loss: 1.7311, instance_loss: 1.1893, weighted_loss: 1.5686, label: 1, bag_size: 869
batch 59, loss: 0.4260, instance_loss: 0.4055, weighted_loss: 0.4198, label: 0, bag_size: 3245
batch 79, loss: 0.8632, instance_loss: 0.3108, weighted_loss: 0.6975, label: 2, bag_size: 3026
batch 99, loss: 0.6096, instance_loss: 0.8073, weighted_loss: 0.6689, label: 2, bag_size: 3174
batch 119, loss: 0.0965, instance_loss: 0.2887, weighted_loss: 0.1542, label: 0, bag_size: 3901
batch 139, loss: 0.0917, instance_loss: 0.2020, weighted_loss: 0.1248, label: 2, bag_size: 3678
batch 159, loss: 0.0541, instance_loss: 0.5389, weighted_loss: 0.1995, label: 2, bag_size: 4497
batch 179, loss: 0.5670, instance_loss: 0.4230, weighted_loss: 0.5238, label: 0, bag_size: 3571
batch 199, loss: 0.0392, instance_loss: 0.1715, weighted_loss: 0.0789, label: 2, bag_size: 6148
batch 219, loss: 0.0763, instance_loss: 0.2002, weighted_loss: 0.1135, label: 2, bag_size: 4203
batch 239, loss: 0.0778, instance_loss: 0.7926, weighted_loss: 0.2923, label: 2, bag_size: 4497
batch 259, loss: 0.7695, instance_loss: 0.7584, weighted_loss: 0.7662, label: 1, bag_size: 3619
batch 279, loss: 0.0144, instance_loss: 0.2375, weighted_loss: 0.0813, label: 1, bag_size: 5462
batch 299, loss: 2.0399, instance_loss: 0.8963, weighted_loss: 1.6968, label: 0, bag_size: 5259
batch 319, loss: 1.1169, instance_loss: 0.7125, weighted_loss: 0.9956, label: 0, bag_size: 4678
batch 339, loss: 0.3058, instance_loss: 0.7386, weighted_loss: 0.4356, label: 2, bag_size: 5037
batch 359, loss: 0.8586, instance_loss: 0.4180, weighted_loss: 0.7264, label: 1, bag_size: 5718
batch 379, loss: 0.0324, instance_loss: 0.2626, weighted_loss: 0.1015, label: 1, bag_size: 3677
batch 399, loss: 0.6816, instance_loss: 0.7075, weighted_loss: 0.6893, label: 2, bag_size: 3746
batch 419, loss: 0.5104, instance_loss: 0.5666, weighted_loss: 0.5272, label: 2, bag_size: 5406
batch 439, loss: 1.9050, instance_loss: 1.1061, weighted_loss: 1.6653, label: 0, bag_size: 609
batch 459, loss: 0.1940, instance_loss: 0.3384, weighted_loss: 0.2373, label: 0, bag_size: 5899
batch 479, loss: 0.2442, instance_loss: 0.3544, weighted_loss: 0.2773, label: 1, bag_size: 4595
batch 499, loss: 1.6932, instance_loss: 1.5162, weighted_loss: 1.6401, label: 2, bag_size: 4910
batch 519, loss: 0.1895, instance_loss: 0.1803, weighted_loss: 0.1868, label: 2, bag_size: 657
batch 539, loss: 2.9069, instance_loss: 1.3996, weighted_loss: 2.4547, label: 0, bag_size: 2217
batch 559, loss: 0.2566, instance_loss: 0.5401, weighted_loss: 0.3416, label: 1, bag_size: 2731
batch 579, loss: 1.2770, instance_loss: 0.9583, weighted_loss: 1.1814, label: 2, bag_size: 2813
batch 599, loss: 0.0348, instance_loss: 0.2266, weighted_loss: 0.0924, label: 1, bag_size: 1836
batch 619, loss: 1.1988, instance_loss: 0.8740, weighted_loss: 1.1014, label: 1, bag_size: 2671
batch 639, loss: 0.5329, instance_loss: 0.6206, weighted_loss: 0.5592, label: 1, bag_size: 2865
batch 659, loss: 0.0391, instance_loss: 0.1799, weighted_loss: 0.0813, label: 0, bag_size: 4918
batch 679, loss: 0.8864, instance_loss: 0.5621, weighted_loss: 0.7891, label: 0, bag_size: 3397
batch 699, loss: 2.4457, instance_loss: 1.3077, weighted_loss: 2.1043, label: 1, bag_size: 3261
batch 719, loss: 0.2155, instance_loss: 0.3696, weighted_loss: 0.2617, label: 0, bag_size: 1018
batch 739, loss: 4.2614, instance_loss: 2.1819, weighted_loss: 3.6375, label: 0, bag_size: 2736


class 0 clustering acc 0.9809843400447428: correct 17540/17880
class 1 clustering acc 0.22013422818791947: correct 1312/5960
Epoch: 11, train_loss: 0.6925, train_clustering_loss:  0.5937, train_error: 0.3020
class 0: acc 0.75, correct 195/260
class 1: acc 0.6395348837209303, correct 165/258
class 2: acc 0.7048458149779736, correct 160/227

Val Set, val_loss: 0.6568, val_error: 0.2979, auc: 0.8685
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.4029255319148936: correct 303/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.688645 --> 0.656765).  Saving model ...


batch 19, loss: 2.4522, instance_loss: 1.3850, weighted_loss: 2.1320, label: 1, bag_size: 3399
batch 39, loss: 0.1369, instance_loss: 0.3756, weighted_loss: 0.2085, label: 2, bag_size: 5138
batch 59, loss: 0.0900, instance_loss: 0.6599, weighted_loss: 0.2610, label: 1, bag_size: 1604
batch 79, loss: 0.2779, instance_loss: 0.3813, weighted_loss: 0.3089, label: 0, bag_size: 4292
batch 99, loss: 0.4383, instance_loss: 0.2343, weighted_loss: 0.3771, label: 0, bag_size: 5041
batch 119, loss: 1.8938, instance_loss: 1.4179, weighted_loss: 1.7510, label: 1, bag_size: 936
batch 139, loss: 0.1149, instance_loss: 0.2799, weighted_loss: 0.1644, label: 2, bag_size: 4223
batch 159, loss: 0.0542, instance_loss: 0.4163, weighted_loss: 0.1628, label: 2, bag_size: 2770
batch 179, loss: 0.1221, instance_loss: 0.2093, weighted_loss: 0.1482, label: 0, bag_size: 4606
batch 199, loss: 1.6385, instance_loss: 1.2192, weighted_loss: 1.5127, label: 1, bag_size: 6942
batch 219, loss: 1.8078, instance_loss: 0.7554, weighted_loss: 1.4921, label: 2, bag_size: 4056
batch 239, loss: 0.3408, instance_loss: 0.3737, weighted_loss: 0.3507, label: 1, bag_size: 4595
batch 259, loss: 2.2821, instance_loss: 0.9955, weighted_loss: 1.8962, label: 0, bag_size: 4378
batch 279, loss: 0.2932, instance_loss: 0.3744, weighted_loss: 0.3176, label: 1, bag_size: 2767
batch 299, loss: 0.3046, instance_loss: 0.4377, weighted_loss: 0.3445, label: 0, bag_size: 5041
batch 319, loss: 0.1037, instance_loss: 0.5754, weighted_loss: 0.2452, label: 1, bag_size: 5026
batch 339, loss: 1.6145, instance_loss: 0.9037, weighted_loss: 1.4013, label: 2, bag_size: 1513
batch 359, loss: 0.5591, instance_loss: 0.6415, weighted_loss: 0.5838, label: 1, bag_size: 2945
batch 379, loss: 0.4924, instance_loss: 0.9319, weighted_loss: 0.6243, label: 1, bag_size: 3172
batch 399, loss: 2.1283, instance_loss: 1.0080, weighted_loss: 1.7922, label: 1, bag_size: 1542
batch 419, loss: 0.4821, instance_loss: 0.3308, weighted_loss: 0.4367, label: 0, bag_size: 4245
batch 439, loss: 2.6658, instance_loss: 1.0122, weighted_loss: 2.1697, label: 1, bag_size: 1608
batch 459, loss: 0.7309, instance_loss: 0.5203, weighted_loss: 0.6677, label: 0, bag_size: 4450
batch 479, loss: 0.0674, instance_loss: 0.3436, weighted_loss: 0.1503, label: 1, bag_size: 2809
batch 499, loss: 1.2322, instance_loss: 1.1753, weighted_loss: 1.2151, label: 1, bag_size: 4067
batch 519, loss: 0.3056, instance_loss: 0.4351, weighted_loss: 0.3445, label: 0, bag_size: 4092
batch 539, loss: 0.0849, instance_loss: 0.4362, weighted_loss: 0.1903, label: 2, bag_size: 4141
batch 559, loss: 0.9301, instance_loss: 0.6358, weighted_loss: 0.8418, label: 0, bag_size: 4678
batch 579, loss: 0.4438, instance_loss: 0.7350, weighted_loss: 0.5312, label: 1, bag_size: 4869
batch 599, loss: 0.0768, instance_loss: 0.1502, weighted_loss: 0.0988, label: 2, bag_size: 3094
batch 619, loss: 0.0995, instance_loss: 0.3690, weighted_loss: 0.1804, label: 2, bag_size: 6594
batch 639, loss: 0.3154, instance_loss: 0.4936, weighted_loss: 0.3688, label: 1, bag_size: 596
batch 659, loss: 1.1582, instance_loss: 0.8565, weighted_loss: 1.0677, label: 1, bag_size: 4708
batch 679, loss: 1.1985, instance_loss: 0.8767, weighted_loss: 1.1019, label: 0, bag_size: 1025
batch 699, loss: 0.3569, instance_loss: 0.3315, weighted_loss: 0.3492, label: 1, bag_size: 4262
batch 719, loss: 0.0943, instance_loss: 0.3080, weighted_loss: 0.1584, label: 2, bag_size: 4555
batch 739, loss: 1.3402, instance_loss: 1.4990, weighted_loss: 1.3879, label: 0, bag_size: 5015


class 0 clustering acc 0.97751677852349: correct 17478/17880
class 1 clustering acc 0.24765100671140938: correct 1476/5960
Epoch: 12, train_loss: 0.6473, train_clustering_loss:  0.5811, train_error: 0.2658
class 0: acc 0.775, correct 186/240
class 1: acc 0.6561264822134387, correct 166/253
class 2: acc 0.7738095238095238, correct 195/252

Val Set, val_loss: 0.7232, val_error: 0.2766, auc: 0.8618
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.1901595744680851: correct 143/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0621, instance_loss: 0.4873, weighted_loss: 0.1896, label: 0, bag_size: 1825
batch 39, loss: 1.9857, instance_loss: 1.1710, weighted_loss: 1.7413, label: 0, bag_size: 3664
batch 59, loss: 1.3708, instance_loss: 0.5512, weighted_loss: 1.1250, label: 2, bag_size: 3678
batch 79, loss: 1.0161, instance_loss: 0.7395, weighted_loss: 0.9331, label: 0, bag_size: 1373
batch 99, loss: 0.0812, instance_loss: 0.2722, weighted_loss: 0.1385, label: 0, bag_size: 3530
batch 119, loss: 0.4342, instance_loss: 0.5149, weighted_loss: 0.4584, label: 2, bag_size: 3172
batch 139, loss: 0.0993, instance_loss: 0.2496, weighted_loss: 0.1444, label: 1, bag_size: 3558
batch 159, loss: 3.7534, instance_loss: 1.8534, weighted_loss: 3.1834, label: 1, bag_size: 2727
batch 179, loss: 0.0326, instance_loss: 0.7671, weighted_loss: 0.2530, label: 0, bag_size: 2231
batch 199, loss: 1.1233, instance_loss: 0.9955, weighted_loss: 1.0849, label: 0, bag_size: 1808
batch 219, loss: 0.2645, instance_loss: 0.2975, weighted_loss: 0.2744, label: 1, bag_size: 2156
batch 239, loss: 0.0427, instance_loss: 0.2566, weighted_loss: 0.1069, label: 1, bag_size: 3172
batch 259, loss: 2.3685, instance_loss: 1.0875, weighted_loss: 1.9842, label: 2, bag_size: 223
batch 279, loss: 0.1243, instance_loss: 0.3394, weighted_loss: 0.1888, label: 2, bag_size: 2209
batch 299, loss: 0.0337, instance_loss: 0.1688, weighted_loss: 0.0742, label: 2, bag_size: 3497
batch 319, loss: 0.6146, instance_loss: 0.7035, weighted_loss: 0.6412, label: 1, bag_size: 6165
batch 339, loss: 0.5049, instance_loss: 0.9273, weighted_loss: 0.6316, label: 1, bag_size: 10399
batch 359, loss: 1.6869, instance_loss: 0.9341, weighted_loss: 1.4611, label: 1, bag_size: 1307
batch 379, loss: 0.8752, instance_loss: 0.9615, weighted_loss: 0.9011, label: 2, bag_size: 1222
batch 399, loss: 0.0670, instance_loss: 0.2167, weighted_loss: 0.1119, label: 0, bag_size: 3727
batch 419, loss: 0.2491, instance_loss: 0.6756, weighted_loss: 0.3771, label: 1, bag_size: 3558
batch 439, loss: 0.2435, instance_loss: 0.7610, weighted_loss: 0.3988, label: 1, bag_size: 5385
batch 459, loss: 0.1742, instance_loss: 0.5398, weighted_loss: 0.2839, label: 2, bag_size: 3607
batch 479, loss: 0.0560, instance_loss: 0.0814, weighted_loss: 0.0637, label: 2, bag_size: 4569
batch 499, loss: 0.0708, instance_loss: 0.0843, weighted_loss: 0.0748, label: 2, bag_size: 657
batch 519, loss: 0.4673, instance_loss: 0.5576, weighted_loss: 0.4944, label: 1, bag_size: 4705
batch 539, loss: 0.2160, instance_loss: 0.3968, weighted_loss: 0.2702, label: 2, bag_size: 3172
batch 559, loss: 0.4146, instance_loss: 0.7040, weighted_loss: 0.5014, label: 2, bag_size: 4535
batch 579, loss: 0.2426, instance_loss: 0.3800, weighted_loss: 0.2838, label: 1, bag_size: 3050
batch 599, loss: 1.3182, instance_loss: 0.6112, weighted_loss: 1.1061, label: 0, bag_size: 4707
batch 619, loss: 0.1490, instance_loss: 0.2927, weighted_loss: 0.1921, label: 2, bag_size: 4162
batch 639, loss: 1.0570, instance_loss: 0.3508, weighted_loss: 0.8451, label: 0, bag_size: 5656
batch 659, loss: 0.8241, instance_loss: 0.7942, weighted_loss: 0.8151, label: 1, bag_size: 800
batch 679, loss: 0.5248, instance_loss: 0.3386, weighted_loss: 0.4689, label: 2, bag_size: 3172
batch 699, loss: 0.7836, instance_loss: 0.5996, weighted_loss: 0.7284, label: 1, bag_size: 574
batch 719, loss: 0.5829, instance_loss: 0.6386, weighted_loss: 0.5996, label: 2, bag_size: 5406
batch 739, loss: 0.0457, instance_loss: 0.0707, weighted_loss: 0.0532, label: 2, bag_size: 4775


class 0 clustering acc 0.9766219239373601: correct 17462/17880
class 1 clustering acc 0.31342281879194633: correct 1868/5960
Epoch: 13, train_loss: 0.6558, train_clustering_loss:  0.5696, train_error: 0.2846
class 0: acc 0.7260869565217392, correct 167/230
class 1: acc 0.6477732793522267, correct 160/247
class 2: acc 0.7686567164179104, correct 206/268

Val Set, val_loss: 0.6596, val_error: 0.2660, auc: 0.8847
class 0 clustering acc 0.9831560283687943: correct 2218/2256
class 1 clustering acc 0.18218085106382978: correct 137/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0611, instance_loss: 0.2092, weighted_loss: 0.1055, label: 0, bag_size: 1485
batch 39, loss: 1.0214, instance_loss: 0.7342, weighted_loss: 0.9352, label: 1, bag_size: 2831
batch 59, loss: 2.4389, instance_loss: 0.9806, weighted_loss: 2.0014, label: 2, bag_size: 361
batch 79, loss: 0.0784, instance_loss: 0.0769, weighted_loss: 0.0779, label: 2, bag_size: 2501
batch 99, loss: 0.3188, instance_loss: 0.5851, weighted_loss: 0.3987, label: 2, bag_size: 3778
batch 119, loss: 0.0923, instance_loss: 0.2703, weighted_loss: 0.1457, label: 0, bag_size: 4744
batch 139, loss: 0.2898, instance_loss: 0.5189, weighted_loss: 0.3585, label: 0, bag_size: 2195
batch 159, loss: 0.2371, instance_loss: 0.4190, weighted_loss: 0.2917, label: 1, bag_size: 1599
batch 179, loss: 0.3082, instance_loss: 0.4508, weighted_loss: 0.3510, label: 0, bag_size: 4325
batch 199, loss: 0.3963, instance_loss: 0.6753, weighted_loss: 0.4800, label: 0, bag_size: 3182
batch 219, loss: 0.4931, instance_loss: 0.6377, weighted_loss: 0.5365, label: 0, bag_size: 3864
batch 239, loss: 0.2575, instance_loss: 0.5412, weighted_loss: 0.3426, label: 2, bag_size: 6644
batch 259, loss: 0.0499, instance_loss: 0.1939, weighted_loss: 0.0931, label: 1, bag_size: 3558
batch 279, loss: 1.1975, instance_loss: 0.6707, weighted_loss: 1.0395, label: 0, bag_size: 4105
batch 299, loss: 0.1854, instance_loss: 0.3606, weighted_loss: 0.2380, label: 0, bag_size: 3690
batch 319, loss: 0.4675, instance_loss: 0.3352, weighted_loss: 0.4278, label: 1, bag_size: 5756
batch 339, loss: 0.1858, instance_loss: 0.1312, weighted_loss: 0.1694, label: 2, bag_size: 1094
batch 359, loss: 0.0655, instance_loss: 0.2023, weighted_loss: 0.1066, label: 0, bag_size: 4857
batch 379, loss: 0.0434, instance_loss: 0.2923, weighted_loss: 0.1181, label: 2, bag_size: 5037
batch 399, loss: 0.0206, instance_loss: 0.4795, weighted_loss: 0.1583, label: 2, bag_size: 4497
batch 419, loss: 0.5574, instance_loss: 0.8447, weighted_loss: 0.6436, label: 0, bag_size: 1652
batch 439, loss: 0.9165, instance_loss: 0.4440, weighted_loss: 0.7747, label: 1, bag_size: 6717
batch 459, loss: 0.0279, instance_loss: 0.1971, weighted_loss: 0.0787, label: 1, bag_size: 259
batch 479, loss: 0.0163, instance_loss: 0.0312, weighted_loss: 0.0208, label: 2, bag_size: 2254
batch 499, loss: 0.1991, instance_loss: 0.2545, weighted_loss: 0.2157, label: 1, bag_size: 2753
batch 519, loss: 0.1044, instance_loss: 0.1136, weighted_loss: 0.1071, label: 2, bag_size: 2049
batch 539, loss: 1.9265, instance_loss: 1.6278, weighted_loss: 1.8369, label: 0, bag_size: 3245
batch 559, loss: 2.2868, instance_loss: 1.4432, weighted_loss: 2.0337, label: 0, bag_size: 2217
batch 579, loss: 0.6399, instance_loss: 0.8927, weighted_loss: 0.7157, label: 2, bag_size: 5406
batch 599, loss: 0.0583, instance_loss: 0.1210, weighted_loss: 0.0771, label: 2, bag_size: 3285
batch 619, loss: 0.0382, instance_loss: 0.5374, weighted_loss: 0.1879, label: 2, bag_size: 4497
batch 639, loss: 0.2563, instance_loss: 0.4933, weighted_loss: 0.3274, label: 1, bag_size: 6475
batch 659, loss: 0.0894, instance_loss: 0.4351, weighted_loss: 0.1931, label: 2, bag_size: 3810
batch 679, loss: 1.5276, instance_loss: 0.9166, weighted_loss: 1.3443, label: 1, bag_size: 869
batch 699, loss: 0.0478, instance_loss: 0.1029, weighted_loss: 0.0643, label: 1, bag_size: 2796
batch 719, loss: 0.0742, instance_loss: 0.2794, weighted_loss: 0.1358, label: 1, bag_size: 10941
batch 739, loss: 0.2551, instance_loss: 0.2712, weighted_loss: 0.2599, label: 0, bag_size: 2884


class 0 clustering acc 0.9733780760626398: correct 17404/17880
class 1 clustering acc 0.33691275167785234: correct 2008/5960
Epoch: 14, train_loss: 0.6229, train_clustering_loss:  0.5470, train_error: 0.2523
class 0: acc 0.7733333333333333, correct 174/225
class 1: acc 0.6911196911196911, correct 179/259
class 2: acc 0.7816091954022989, correct 204/261

Val Set, val_loss: 0.7270, val_error: 0.2979, auc: 0.8843
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.28856382978723405: correct 217/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1675, instance_loss: 0.0638, weighted_loss: 0.1364, label: 2, bag_size: 2561
batch 39, loss: 3.4211, instance_loss: 1.2514, weighted_loss: 2.7702, label: 1, bag_size: 4258
batch 59, loss: 0.0935, instance_loss: 0.9378, weighted_loss: 0.3468, label: 1, bag_size: 3677
batch 79, loss: 0.8335, instance_loss: 0.6840, weighted_loss: 0.7887, label: 1, bag_size: 1066
batch 99, loss: 0.1900, instance_loss: 0.4833, weighted_loss: 0.2780, label: 2, bag_size: 5472
batch 119, loss: 0.0523, instance_loss: 0.2537, weighted_loss: 0.1127, label: 1, bag_size: 2009
batch 139, loss: 3.1954, instance_loss: 1.7299, weighted_loss: 2.7558, label: 0, bag_size: 455
batch 159, loss: 0.4618, instance_loss: 0.3373, weighted_loss: 0.4245, label: 2, bag_size: 5914
batch 179, loss: 0.7337, instance_loss: 0.5480, weighted_loss: 0.6780, label: 1, bag_size: 1042
batch 199, loss: 0.3031, instance_loss: 0.4385, weighted_loss: 0.3437, label: 2, bag_size: 6704
batch 219, loss: 0.1662, instance_loss: 0.4104, weighted_loss: 0.2394, label: 0, bag_size: 5570
batch 239, loss: 1.4260, instance_loss: 0.8320, weighted_loss: 1.2478, label: 2, bag_size: 5406
batch 259, loss: 0.1303, instance_loss: 0.4826, weighted_loss: 0.2360, label: 2, bag_size: 4141
batch 279, loss: 0.9538, instance_loss: 0.8242, weighted_loss: 0.9149, label: 1, bag_size: 6165
batch 299, loss: 0.1528, instance_loss: 0.2725, weighted_loss: 0.1887, label: 0, bag_size: 4092
batch 319, loss: 0.3826, instance_loss: 0.6333, weighted_loss: 0.4578, label: 1, bag_size: 3403
batch 339, loss: 0.1711, instance_loss: 0.3338, weighted_loss: 0.2199, label: 2, bag_size: 3396
batch 359, loss: 0.8643, instance_loss: 0.8901, weighted_loss: 0.8721, label: 1, bag_size: 6817
batch 379, loss: 0.9574, instance_loss: 1.0544, weighted_loss: 0.9865, label: 2, bag_size: 3299
batch 399, loss: 0.0479, instance_loss: 0.0897, weighted_loss: 0.0604, label: 2, bag_size: 3497
batch 419, loss: 1.4831, instance_loss: 1.0351, weighted_loss: 1.3487, label: 2, bag_size: 3475
batch 439, loss: 0.4565, instance_loss: 0.7980, weighted_loss: 0.5589, label: 2, bag_size: 4342
batch 459, loss: 0.4634, instance_loss: 0.4978, weighted_loss: 0.4737, label: 0, bag_size: 4909
batch 479, loss: 0.5101, instance_loss: 0.5517, weighted_loss: 0.5225, label: 1, bag_size: 3322
batch 499, loss: 1.8480, instance_loss: 0.7880, weighted_loss: 1.5300, label: 0, bag_size: 7056
batch 519, loss: 1.0678, instance_loss: 0.6491, weighted_loss: 0.9422, label: 1, bag_size: 4708
batch 539, loss: 0.0347, instance_loss: 1.5311, weighted_loss: 0.4836, label: 0, bag_size: 1709
batch 559, loss: 0.0771, instance_loss: 0.1827, weighted_loss: 0.1088, label: 1, bag_size: 4898
batch 579, loss: 0.3359, instance_loss: 0.3543, weighted_loss: 0.3414, label: 0, bag_size: 4450
batch 599, loss: 0.2007, instance_loss: 0.4158, weighted_loss: 0.2652, label: 2, bag_size: 4978
batch 619, loss: 1.7203, instance_loss: 1.0589, weighted_loss: 1.5219, label: 2, bag_size: 2486
batch 639, loss: 0.1487, instance_loss: 0.6956, weighted_loss: 0.3128, label: 1, bag_size: 6513
batch 659, loss: 0.3770, instance_loss: 0.3389, weighted_loss: 0.3656, label: 1, bag_size: 3640
batch 679, loss: 1.0686, instance_loss: 0.6350, weighted_loss: 0.9385, label: 0, bag_size: 4416
batch 699, loss: 1.0219, instance_loss: 0.8958, weighted_loss: 0.9841, label: 1, bag_size: 2744
batch 719, loss: 1.1263, instance_loss: 0.7429, weighted_loss: 1.0113, label: 1, bag_size: 782
batch 739, loss: 0.4032, instance_loss: 0.5541, weighted_loss: 0.4485, label: 2, bag_size: 4192


class 0 clustering acc 0.9782997762863535: correct 17492/17880
class 1 clustering acc 0.26610738255033556: correct 1586/5960
Epoch: 15, train_loss: 0.6431, train_clustering_loss:  0.5734, train_error: 0.2698
class 0: acc 0.782258064516129, correct 194/248
class 1: acc 0.6525096525096525, correct 169/259
class 2: acc 0.7605042016806722, correct 181/238

Val Set, val_loss: 0.6067, val_error: 0.3191, auc: 0.8846
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.39095744680851063: correct 294/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.656765 --> 0.606727).  Saving model ...


batch 19, loss: 0.1298, instance_loss: 0.2310, weighted_loss: 0.1601, label: 0, bag_size: 3594
batch 39, loss: 0.3469, instance_loss: 0.5171, weighted_loss: 0.3980, label: 1, bag_size: 6156
batch 59, loss: 0.2547, instance_loss: 0.4164, weighted_loss: 0.3032, label: 2, bag_size: 2209
batch 79, loss: 0.5975, instance_loss: 0.3887, weighted_loss: 0.5349, label: 0, bag_size: 4614
batch 99, loss: 0.3596, instance_loss: 0.5729, weighted_loss: 0.4236, label: 2, bag_size: 4978
batch 119, loss: 1.3866, instance_loss: 1.0348, weighted_loss: 1.2811, label: 1, bag_size: 475
batch 139, loss: 0.7661, instance_loss: 0.4560, weighted_loss: 0.6731, label: 2, bag_size: 597
batch 159, loss: 0.1625, instance_loss: 0.3774, weighted_loss: 0.2270, label: 1, bag_size: 3156
batch 179, loss: 0.6221, instance_loss: 0.6045, weighted_loss: 0.6168, label: 1, bag_size: 3126
batch 199, loss: 0.5440, instance_loss: 0.8174, weighted_loss: 0.6260, label: 2, bag_size: 4978
batch 219, loss: 0.2086, instance_loss: 0.4389, weighted_loss: 0.2777, label: 2, bag_size: 4555
batch 239, loss: 0.8244, instance_loss: 0.8316, weighted_loss: 0.8266, label: 1, bag_size: 2671
batch 259, loss: 1.5438, instance_loss: 1.0786, weighted_loss: 1.4042, label: 1, bag_size: 3399
batch 279, loss: 0.1609, instance_loss: 0.2268, weighted_loss: 0.1807, label: 0, bag_size: 2791
batch 299, loss: 0.6347, instance_loss: 0.3741, weighted_loss: 0.5565, label: 0, bag_size: 2190
batch 319, loss: 0.4366, instance_loss: 0.5779, weighted_loss: 0.4790, label: 2, bag_size: 4978
batch 339, loss: 1.2383, instance_loss: 0.9044, weighted_loss: 1.1381, label: 2, bag_size: 2326
batch 359, loss: 0.0958, instance_loss: 0.2410, weighted_loss: 0.1394, label: 0, bag_size: 2545
batch 379, loss: 0.1099, instance_loss: 0.2764, weighted_loss: 0.1598, label: 0, bag_size: 4744
batch 399, loss: 1.3021, instance_loss: 1.0252, weighted_loss: 1.2190, label: 1, bag_size: 2302
batch 419, loss: 1.4572, instance_loss: 0.5394, weighted_loss: 1.1819, label: 0, bag_size: 4450
batch 439, loss: 0.0913, instance_loss: 0.1190, weighted_loss: 0.0996, label: 2, bag_size: 4569
batch 459, loss: 1.1110, instance_loss: 0.6799, weighted_loss: 0.9817, label: 0, bag_size: 5867
batch 479, loss: 0.5334, instance_loss: 0.5506, weighted_loss: 0.5386, label: 0, bag_size: 3675
batch 499, loss: 3.5676, instance_loss: 1.2868, weighted_loss: 2.8834, label: 2, bag_size: 5307
batch 519, loss: 0.1548, instance_loss: 0.5974, weighted_loss: 0.2876, label: 0, bag_size: 1245
batch 539, loss: 0.4040, instance_loss: 0.4757, weighted_loss: 0.4255, label: 0, bag_size: 7169
batch 559, loss: 1.1375, instance_loss: 0.7991, weighted_loss: 1.0360, label: 1, bag_size: 1122
batch 579, loss: 1.8376, instance_loss: 0.9567, weighted_loss: 1.5733, label: 1, bag_size: 1313
batch 599, loss: 0.4164, instance_loss: 0.4844, weighted_loss: 0.4368, label: 2, bag_size: 4487
batch 619, loss: 0.3350, instance_loss: 0.4324, weighted_loss: 0.3642, label: 0, bag_size: 4416
batch 639, loss: 0.0318, instance_loss: 0.2328, weighted_loss: 0.0921, label: 1, bag_size: 3156
batch 659, loss: 1.9063, instance_loss: 1.3524, weighted_loss: 1.7401, label: 0, bag_size: 5259
batch 679, loss: 0.6771, instance_loss: 0.5262, weighted_loss: 0.6318, label: 2, bag_size: 2813
batch 699, loss: 0.1801, instance_loss: 0.1788, weighted_loss: 0.1798, label: 2, bag_size: 4056
batch 719, loss: 1.6284, instance_loss: 0.7049, weighted_loss: 1.3514, label: 2, bag_size: 705
batch 739, loss: 0.5284, instance_loss: 0.5027, weighted_loss: 0.5207, label: 0, bag_size: 1495


class 0 clustering acc 0.9742729306487695: correct 17420/17880
class 1 clustering acc 0.2961409395973154: correct 1765/5960
Epoch: 16, train_loss: 0.6984, train_clustering_loss:  0.5828, train_error: 0.2805
class 0: acc 0.7798507462686567, correct 209/268
class 1: acc 0.5905172413793104, correct 137/232
class 2: acc 0.7755102040816326, correct 190/245

Val Set, val_loss: 0.8242, val_error: 0.2979, auc: 0.8739
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.20877659574468085: correct 157/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0447, instance_loss: 0.1762, weighted_loss: 0.0842, label: 2, bag_size: 4203
batch 39, loss: 1.0986, instance_loss: 0.7190, weighted_loss: 0.9847, label: 1, bag_size: 4806
batch 59, loss: 1.8777, instance_loss: 1.1641, weighted_loss: 1.6636, label: 2, bag_size: 2326
batch 79, loss: 0.0955, instance_loss: 0.1253, weighted_loss: 0.1044, label: 1, bag_size: 7279
batch 99, loss: 0.9330, instance_loss: 0.7719, weighted_loss: 0.8847, label: 1, bag_size: 4960
batch 119, loss: 0.1529, instance_loss: 0.2896, weighted_loss: 0.1939, label: 0, bag_size: 4531
batch 139, loss: 0.3510, instance_loss: 0.4262, weighted_loss: 0.3735, label: 2, bag_size: 6644
batch 159, loss: 1.3799, instance_loss: 1.5119, weighted_loss: 1.4195, label: 1, bag_size: 8632
batch 179, loss: 0.2504, instance_loss: 0.5270, weighted_loss: 0.3334, label: 0, bag_size: 1744
batch 199, loss: 0.3752, instance_loss: 0.5095, weighted_loss: 0.4155, label: 1, bag_size: 5728
batch 219, loss: 0.1531, instance_loss: 0.3738, weighted_loss: 0.2193, label: 2, bag_size: 4555
batch 239, loss: 1.1353, instance_loss: 0.8772, weighted_loss: 1.0579, label: 1, bag_size: 4612
batch 259, loss: 6.2160, instance_loss: 2.4061, weighted_loss: 5.0730, label: 0, bag_size: 2736
batch 279, loss: 0.2852, instance_loss: 0.3661, weighted_loss: 0.3095, label: 0, bag_size: 4894
batch 299, loss: 0.7990, instance_loss: 0.6599, weighted_loss: 0.7573, label: 2, bag_size: 3497
batch 319, loss: 0.3210, instance_loss: 0.3209, weighted_loss: 0.3210, label: 2, bag_size: 2359
batch 339, loss: 1.0053, instance_loss: 0.6178, weighted_loss: 0.8891, label: 0, bag_size: 1373
batch 359, loss: 0.0625, instance_loss: 0.2044, weighted_loss: 0.1051, label: 0, bag_size: 3901
batch 379, loss: 2.7982, instance_loss: 1.3648, weighted_loss: 2.3682, label: 0, bag_size: 3419
batch 399, loss: 3.4281, instance_loss: 2.3461, weighted_loss: 3.1035, label: 0, bag_size: 434
batch 419, loss: 0.1374, instance_loss: 0.6246, weighted_loss: 0.2836, label: 2, bag_size: 4497
batch 439, loss: 0.0693, instance_loss: 0.1806, weighted_loss: 0.1027, label: 0, bag_size: 3103
batch 459, loss: 0.7329, instance_loss: 0.5808, weighted_loss: 0.6873, label: 0, bag_size: 11663
batch 479, loss: 1.1307, instance_loss: 0.5982, weighted_loss: 0.9710, label: 1, bag_size: 4595
batch 499, loss: 0.2395, instance_loss: 0.5629, weighted_loss: 0.3365, label: 2, bag_size: 5017
batch 519, loss: 2.0194, instance_loss: 1.0351, weighted_loss: 1.7241, label: 2, bag_size: 223
batch 539, loss: 0.2953, instance_loss: 0.6352, weighted_loss: 0.3973, label: 2, bag_size: 3174
batch 559, loss: 0.5687, instance_loss: 0.5564, weighted_loss: 0.5650, label: 1, bag_size: 3109
batch 579, loss: 0.5398, instance_loss: 0.4128, weighted_loss: 0.5017, label: 0, bag_size: 2189
batch 599, loss: 0.0367, instance_loss: 0.1165, weighted_loss: 0.0607, label: 0, bag_size: 2019
batch 619, loss: 0.0433, instance_loss: 0.3035, weighted_loss: 0.1214, label: 0, bag_size: 667
batch 639, loss: 0.0283, instance_loss: 0.2045, weighted_loss: 0.0811, label: 1, bag_size: 1836
batch 659, loss: 1.4539, instance_loss: 0.7827, weighted_loss: 1.2525, label: 1, bag_size: 1097
batch 679, loss: 0.6129, instance_loss: 0.3953, weighted_loss: 0.5476, label: 1, bag_size: 5718
batch 699, loss: 0.2551, instance_loss: 0.3366, weighted_loss: 0.2796, label: 1, bag_size: 700
batch 719, loss: 0.8342, instance_loss: 0.6236, weighted_loss: 0.7710, label: 1, bag_size: 6152
batch 739, loss: 0.9927, instance_loss: 0.5623, weighted_loss: 0.8636, label: 1, bag_size: 1860


class 0 clustering acc 0.9703579418344519: correct 17350/17880
class 1 clustering acc 0.33221476510067116: correct 1980/5960
Epoch: 17, train_loss: 0.6802, train_clustering_loss:  0.5797, train_error: 0.2872
class 0: acc 0.7451737451737451, correct 193/259
class 1: acc 0.6398305084745762, correct 151/236
class 2: acc 0.748, correct 187/250

Val Set, val_loss: 0.6533, val_error: 0.2979, auc: 0.8771
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.26861702127659576: correct 202/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2750, instance_loss: 0.2449, weighted_loss: 0.2660, label: 0, bag_size: 4634
batch 39, loss: 0.4770, instance_loss: 0.5718, weighted_loss: 0.5054, label: 1, bag_size: 5833
batch 59, loss: 0.0927, instance_loss: 0.1573, weighted_loss: 0.1120, label: 2, bag_size: 3176
batch 79, loss: 0.0343, instance_loss: 0.0597, weighted_loss: 0.0419, label: 2, bag_size: 4569
batch 99, loss: 0.0873, instance_loss: 0.1812, weighted_loss: 0.1155, label: 2, bag_size: 2209
batch 119, loss: 0.1150, instance_loss: 0.2063, weighted_loss: 0.1424, label: 0, bag_size: 8088
batch 139, loss: 1.1665, instance_loss: 0.7808, weighted_loss: 1.0508, label: 1, bag_size: 1607
batch 159, loss: 0.0539, instance_loss: 0.2494, weighted_loss: 0.1125, label: 2, bag_size: 4745
batch 179, loss: 0.2009, instance_loss: 0.5279, weighted_loss: 0.2990, label: 2, bag_size: 4487
batch 199, loss: 0.1026, instance_loss: 0.0761, weighted_loss: 0.0947, label: 2, bag_size: 6026
batch 219, loss: 0.1334, instance_loss: 0.2175, weighted_loss: 0.1586, label: 0, bag_size: 4326
batch 239, loss: 0.4221, instance_loss: 0.4567, weighted_loss: 0.4325, label: 1, bag_size: 1221
batch 259, loss: 0.1094, instance_loss: 0.3661, weighted_loss: 0.1864, label: 1, bag_size: 3611
batch 279, loss: 0.7731, instance_loss: 0.4067, weighted_loss: 0.6632, label: 2, bag_size: 3678
batch 299, loss: 0.3724, instance_loss: 0.5023, weighted_loss: 0.4114, label: 2, bag_size: 5307
batch 319, loss: 0.8112, instance_loss: 0.4116, weighted_loss: 0.6914, label: 0, bag_size: 4647
batch 339, loss: 1.1819, instance_loss: 1.0464, weighted_loss: 1.1413, label: 2, bag_size: 6298
batch 359, loss: 0.4046, instance_loss: 0.5572, weighted_loss: 0.4504, label: 1, bag_size: 14449
batch 379, loss: 0.9377, instance_loss: 0.6311, weighted_loss: 0.8457, label: 0, bag_size: 6223
batch 399, loss: 0.5269, instance_loss: 0.5828, weighted_loss: 0.5437, label: 1, bag_size: 4960
batch 419, loss: 0.1193, instance_loss: 0.2626, weighted_loss: 0.1622, label: 0, bag_size: 2767
batch 439, loss: 0.4844, instance_loss: 0.3588, weighted_loss: 0.4467, label: 2, bag_size: 4241
batch 459, loss: 0.3195, instance_loss: 0.2791, weighted_loss: 0.3074, label: 0, bag_size: 3156
batch 479, loss: 0.2858, instance_loss: 0.3189, weighted_loss: 0.2957, label: 0, bag_size: 3310
batch 499, loss: 0.8696, instance_loss: 0.9282, weighted_loss: 0.8872, label: 2, bag_size: 5406
batch 519, loss: 0.2619, instance_loss: 0.3243, weighted_loss: 0.2806, label: 0, bag_size: 4794
batch 539, loss: 0.5848, instance_loss: 0.4656, weighted_loss: 0.5490, label: 2, bag_size: 3172
batch 559, loss: 0.2415, instance_loss: 0.3269, weighted_loss: 0.2671, label: 0, bag_size: 2139
batch 579, loss: 0.3352, instance_loss: 0.6069, weighted_loss: 0.4167, label: 1, bag_size: 1023
batch 599, loss: 2.0712, instance_loss: 0.9571, weighted_loss: 1.7369, label: 0, bag_size: 4032
batch 619, loss: 1.1069, instance_loss: 1.0334, weighted_loss: 1.0849, label: 2, bag_size: 2486
batch 639, loss: 1.8574, instance_loss: 1.3241, weighted_loss: 1.6974, label: 1, bag_size: 2425
batch 659, loss: 0.2531, instance_loss: 0.4734, weighted_loss: 0.3191, label: 0, bag_size: 1417
batch 679, loss: 0.4108, instance_loss: 0.4314, weighted_loss: 0.4169, label: 1, bag_size: 2865
batch 699, loss: 0.3083, instance_loss: 0.4723, weighted_loss: 0.3575, label: 0, bag_size: 4997
batch 719, loss: 0.1957, instance_loss: 0.3116, weighted_loss: 0.2304, label: 0, bag_size: 5893
batch 739, loss: 0.6793, instance_loss: 1.0220, weighted_loss: 0.7821, label: 0, bag_size: 3219


class 0 clustering acc 0.9722035794183446: correct 17383/17880
class 1 clustering acc 0.2827181208053691: correct 1685/5960
Epoch: 18, train_loss: 0.6585, train_clustering_loss:  0.5793, train_error: 0.2886
class 0: acc 0.7886792452830189, correct 209/265
class 1: acc 0.6216216216216216, correct 161/259
class 2: acc 0.7239819004524887, correct 160/221

Val Set, val_loss: 0.7038, val_error: 0.2553, auc: 0.8808
class 0 clustering acc 0.9720744680851063: correct 2193/2256
class 1 clustering acc 0.34441489361702127: correct 259/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0817, instance_loss: 0.3156, weighted_loss: 0.1519, label: 1, bag_size: 3333
batch 39, loss: 0.0555, instance_loss: 0.2045, weighted_loss: 0.1002, label: 2, bag_size: 6148
batch 59, loss: 0.8541, instance_loss: 0.6672, weighted_loss: 0.7981, label: 1, bag_size: 4200
batch 79, loss: 2.1526, instance_loss: 1.2490, weighted_loss: 1.8816, label: 0, bag_size: 4921
batch 99, loss: 1.3478, instance_loss: 0.9496, weighted_loss: 1.2284, label: 1, bag_size: 2671
batch 119, loss: 2.2022, instance_loss: 1.4518, weighted_loss: 1.9771, label: 0, bag_size: 1904
batch 139, loss: 1.9720, instance_loss: 1.4466, weighted_loss: 1.8144, label: 2, bag_size: 4241
batch 159, loss: 0.1871, instance_loss: 0.5303, weighted_loss: 0.2900, label: 2, bag_size: 3299
batch 179, loss: 0.1272, instance_loss: 0.2358, weighted_loss: 0.1598, label: 2, bag_size: 4978
batch 199, loss: 0.1865, instance_loss: 0.4408, weighted_loss: 0.2628, label: 0, bag_size: 3864
batch 219, loss: 1.5237, instance_loss: 0.8044, weighted_loss: 1.3079, label: 0, bag_size: 4032
batch 239, loss: 0.4014, instance_loss: 0.7003, weighted_loss: 0.4910, label: 2, bag_size: 5037
batch 259, loss: 0.5810, instance_loss: 0.4434, weighted_loss: 0.5397, label: 0, bag_size: 3533
batch 279, loss: 0.0159, instance_loss: 0.2434, weighted_loss: 0.0841, label: 1, bag_size: 3221
batch 299, loss: 0.3982, instance_loss: 0.4546, weighted_loss: 0.4151, label: 1, bag_size: 209
batch 319, loss: 0.8400, instance_loss: 0.8261, weighted_loss: 0.8358, label: 1, bag_size: 3823
batch 339, loss: 0.0478, instance_loss: 0.1771, weighted_loss: 0.0866, label: 0, bag_size: 4855
batch 359, loss: 0.5815, instance_loss: 0.4357, weighted_loss: 0.5377, label: 0, bag_size: 6223
batch 379, loss: 0.3953, instance_loss: 0.9829, weighted_loss: 0.5716, label: 1, bag_size: 4181
batch 399, loss: 0.2379, instance_loss: 0.2525, weighted_loss: 0.2423, label: 0, bag_size: 3797
batch 419, loss: 1.1965, instance_loss: 0.9816, weighted_loss: 1.1320, label: 1, bag_size: 1327
batch 439, loss: 0.0955, instance_loss: 0.1119, weighted_loss: 0.1004, label: 2, bag_size: 3583
batch 459, loss: 0.4129, instance_loss: 0.4493, weighted_loss: 0.4238, label: 2, bag_size: 6704
batch 479, loss: 0.1330, instance_loss: 0.1177, weighted_loss: 0.1284, label: 2, bag_size: 88
batch 499, loss: 0.0838, instance_loss: 0.4335, weighted_loss: 0.1887, label: 1, bag_size: 3677
batch 519, loss: 0.0654, instance_loss: 0.3411, weighted_loss: 0.1481, label: 2, bag_size: 4141
batch 539, loss: 0.4433, instance_loss: 0.7414, weighted_loss: 0.5327, label: 1, bag_size: 6156
batch 559, loss: 0.3080, instance_loss: 0.2722, weighted_loss: 0.2973, label: 2, bag_size: 3546
batch 579, loss: 0.0842, instance_loss: 0.3347, weighted_loss: 0.1593, label: 2, bag_size: 5017
batch 599, loss: 0.0263, instance_loss: 0.1174, weighted_loss: 0.0536, label: 0, bag_size: 6430
batch 619, loss: 0.7889, instance_loss: 0.6031, weighted_loss: 0.7332, label: 2, bag_size: 7607
batch 639, loss: 0.7019, instance_loss: 0.8610, weighted_loss: 0.7496, label: 2, bag_size: 22464
batch 659, loss: 0.0083, instance_loss: 0.4007, weighted_loss: 0.1260, label: 1, bag_size: 2009
batch 679, loss: 2.1109, instance_loss: 0.9709, weighted_loss: 1.7689, label: 1, bag_size: 1608
batch 699, loss: 1.1785, instance_loss: 0.8359, weighted_loss: 1.0757, label: 1, bag_size: 3813
batch 719, loss: 2.4688, instance_loss: 1.2550, weighted_loss: 2.1047, label: 0, bag_size: 5017
batch 739, loss: 0.3491, instance_loss: 0.5550, weighted_loss: 0.4108, label: 0, bag_size: 2756


class 0 clustering acc 0.9700223713646532: correct 17344/17880
class 1 clustering acc 0.33506711409395973: correct 1997/5960
Epoch: 19, train_loss: 0.6260, train_clustering_loss:  0.5641, train_error: 0.2752
class 0: acc 0.752, correct 188/250
class 1: acc 0.634453781512605, correct 151/238
class 2: acc 0.7821011673151751, correct 201/257

Val Set, val_loss: 0.8306, val_error: 0.3404, auc: 0.8637
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.19680851063829788: correct 148/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4578, instance_loss: 0.4621, weighted_loss: 0.4591, label: 1, bag_size: 1029
batch 39, loss: 0.4685, instance_loss: 0.4883, weighted_loss: 0.4744, label: 1, bag_size: 1029
batch 59, loss: 2.0610, instance_loss: 1.4225, weighted_loss: 1.8694, label: 0, bag_size: 3402
batch 79, loss: 0.1094, instance_loss: 0.2046, weighted_loss: 0.1380, label: 0, bag_size: 3690
batch 99, loss: 0.0431, instance_loss: 0.3465, weighted_loss: 0.1341, label: 0, bag_size: 667
batch 119, loss: 1.1707, instance_loss: 0.7641, weighted_loss: 1.0487, label: 0, bag_size: 3841
batch 139, loss: 0.0820, instance_loss: 0.2247, weighted_loss: 0.1249, label: 0, bag_size: 1647
batch 159, loss: 0.8417, instance_loss: 1.2660, weighted_loss: 0.9690, label: 1, bag_size: 1549
batch 179, loss: 0.7020, instance_loss: 0.9547, weighted_loss: 0.7778, label: 1, bag_size: 3424
batch 199, loss: 0.3675, instance_loss: 0.4594, weighted_loss: 0.3951, label: 0, bag_size: 4808
batch 219, loss: 0.3064, instance_loss: 0.4812, weighted_loss: 0.3588, label: 0, bag_size: 3245
batch 239, loss: 0.1360, instance_loss: 0.2524, weighted_loss: 0.1710, label: 0, bag_size: 4326
batch 259, loss: 2.2036, instance_loss: 1.4155, weighted_loss: 1.9672, label: 1, bag_size: 1307
batch 279, loss: 1.7017, instance_loss: 1.1984, weighted_loss: 1.5507, label: 1, bag_size: 1327
batch 299, loss: 0.6250, instance_loss: 0.5901, weighted_loss: 0.6145, label: 2, bag_size: 3534
batch 319, loss: 1.0524, instance_loss: 0.6886, weighted_loss: 0.9433, label: 0, bag_size: 2915
batch 339, loss: 0.3297, instance_loss: 0.3313, weighted_loss: 0.3302, label: 2, bag_size: 2049
batch 359, loss: 0.3893, instance_loss: 0.6751, weighted_loss: 0.4750, label: 2, bag_size: 6704
batch 379, loss: 0.0014, instance_loss: 0.4784, weighted_loss: 0.1445, label: 2, bag_size: 3607
batch 399, loss: 0.4867, instance_loss: 0.5723, weighted_loss: 0.5124, label: 1, bag_size: 1045
batch 419, loss: 1.5455, instance_loss: 0.6573, weighted_loss: 1.2791, label: 2, bag_size: 2561
batch 439, loss: 0.1482, instance_loss: 0.3017, weighted_loss: 0.1943, label: 2, bag_size: 4691
batch 459, loss: 0.9819, instance_loss: 0.9355, weighted_loss: 0.9680, label: 0, bag_size: 313
batch 479, loss: 1.9310, instance_loss: 0.8542, weighted_loss: 1.6080, label: 0, bag_size: 4245
batch 499, loss: 0.4816, instance_loss: 0.3747, weighted_loss: 0.4495, label: 1, bag_size: 210
batch 519, loss: 0.4010, instance_loss: 0.7622, weighted_loss: 0.5093, label: 2, bag_size: 22464
batch 539, loss: 0.0828, instance_loss: 0.2270, weighted_loss: 0.1260, label: 2, bag_size: 4302
batch 559, loss: 0.0465, instance_loss: 0.2841, weighted_loss: 0.1178, label: 0, bag_size: 1647
batch 579, loss: 0.3321, instance_loss: 0.5500, weighted_loss: 0.3975, label: 0, bag_size: 3164
batch 599, loss: 0.0645, instance_loss: 0.2570, weighted_loss: 0.1222, label: 1, bag_size: 8802
batch 619, loss: 0.2343, instance_loss: 0.1763, weighted_loss: 0.2169, label: 2, bag_size: 4056
batch 639, loss: 0.0977, instance_loss: 0.2084, weighted_loss: 0.1309, label: 1, bag_size: 4253
batch 659, loss: 0.0785, instance_loss: 0.4048, weighted_loss: 0.1764, label: 1, bag_size: 3221
batch 679, loss: 0.3482, instance_loss: 0.6828, weighted_loss: 0.4485, label: 1, bag_size: 4869
batch 699, loss: 1.2286, instance_loss: 0.6832, weighted_loss: 1.0650, label: 0, bag_size: 3191
batch 719, loss: 1.8768, instance_loss: 0.9527, weighted_loss: 1.5995, label: 2, bag_size: 361
batch 739, loss: 0.4039, instance_loss: 0.3617, weighted_loss: 0.3913, label: 2, bag_size: 3546


class 0 clustering acc 0.9713646532438479: correct 17368/17880
class 1 clustering acc 0.31409395973154364: correct 1872/5960
Epoch: 20, train_loss: 0.6210, train_clustering_loss:  0.5648, train_error: 0.2658
class 0: acc 0.7847533632286996, correct 175/223
class 1: acc 0.6417910447761194, correct 172/268
class 2: acc 0.7874015748031497, correct 200/254

Val Set, val_loss: 0.8529, val_error: 0.2979, auc: 0.8852
class 0 clustering acc 0.9831560283687943: correct 2218/2256
class 1 clustering acc 0.1356382978723404: correct 102/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.1693, instance_loss: 1.3260, weighted_loss: 1.9163, label: 1, bag_size: 12936
batch 39, loss: 0.1206, instance_loss: 0.2508, weighted_loss: 0.1597, label: 2, bag_size: 4203
batch 59, loss: 0.1191, instance_loss: 0.3709, weighted_loss: 0.1946, label: 1, bag_size: 3398
batch 79, loss: 0.0933, instance_loss: 0.3033, weighted_loss: 0.1563, label: 0, bag_size: 7169
batch 99, loss: 0.0282, instance_loss: 0.0813, weighted_loss: 0.0442, label: 0, bag_size: 5902
batch 119, loss: 2.4535, instance_loss: 1.1439, weighted_loss: 2.0607, label: 1, bag_size: 1313
batch 139, loss: 0.1394, instance_loss: 0.2312, weighted_loss: 0.1669, label: 2, bag_size: 2209
batch 159, loss: 2.2332, instance_loss: 1.2434, weighted_loss: 1.9362, label: 0, bag_size: 5330
batch 179, loss: 1.5251, instance_loss: 0.8120, weighted_loss: 1.3112, label: 2, bag_size: 909
batch 199, loss: 0.1551, instance_loss: 0.1483, weighted_loss: 0.1530, label: 2, bag_size: 3583
batch 219, loss: 0.0788, instance_loss: 0.1330, weighted_loss: 0.0950, label: 2, bag_size: 6148
batch 239, loss: 0.1734, instance_loss: 0.3083, weighted_loss: 0.2139, label: 0, bag_size: 2290
batch 259, loss: 0.1003, instance_loss: 0.2187, weighted_loss: 0.1358, label: 0, bag_size: 3247
batch 279, loss: 0.1027, instance_loss: 0.3430, weighted_loss: 0.1748, label: 0, bag_size: 1097
batch 299, loss: 0.5467, instance_loss: 0.6172, weighted_loss: 0.5679, label: 1, bag_size: 3403
batch 319, loss: 3.4330, instance_loss: 1.8779, weighted_loss: 2.9664, label: 1, bag_size: 3159
batch 339, loss: 0.1014, instance_loss: 0.2681, weighted_loss: 0.1514, label: 1, bag_size: 3425
batch 359, loss: 0.0642, instance_loss: 0.2079, weighted_loss: 0.1073, label: 0, bag_size: 3406
batch 379, loss: 0.0324, instance_loss: 0.2097, weighted_loss: 0.0855, label: 1, bag_size: 7279
batch 399, loss: 0.0554, instance_loss: 0.1930, weighted_loss: 0.0967, label: 0, bag_size: 3936
batch 419, loss: 0.8582, instance_loss: 0.7533, weighted_loss: 0.8267, label: 2, bag_size: 1050
batch 439, loss: 0.3043, instance_loss: 0.5707, weighted_loss: 0.3842, label: 1, bag_size: 3586
batch 459, loss: 0.2868, instance_loss: 0.5584, weighted_loss: 0.3683, label: 0, bag_size: 2257
batch 479, loss: 0.1639, instance_loss: 0.2249, weighted_loss: 0.1822, label: 0, bag_size: 4455
batch 499, loss: 1.3282, instance_loss: 0.8536, weighted_loss: 1.1858, label: 0, bag_size: 3841
batch 519, loss: 0.2894, instance_loss: 0.3728, weighted_loss: 0.3144, label: 2, bag_size: 5743
batch 539, loss: 0.0513, instance_loss: 0.2540, weighted_loss: 0.1121, label: 2, bag_size: 3810
batch 559, loss: 0.4623, instance_loss: 0.4081, weighted_loss: 0.4460, label: 2, bag_size: 3534
batch 579, loss: 1.7872, instance_loss: 0.7844, weighted_loss: 1.4864, label: 2, bag_size: 5307
batch 599, loss: 0.1830, instance_loss: 0.3335, weighted_loss: 0.2282, label: 0, bag_size: 386
batch 619, loss: 2.0835, instance_loss: 1.0669, weighted_loss: 1.7785, label: 2, bag_size: 1513
batch 639, loss: 0.3865, instance_loss: 0.5959, weighted_loss: 0.4493, label: 1, bag_size: 5195
batch 659, loss: 0.0829, instance_loss: 0.2827, weighted_loss: 0.1429, label: 0, bag_size: 3188
batch 679, loss: 0.6217, instance_loss: 0.7548, weighted_loss: 0.6616, label: 2, bag_size: 22464
batch 699, loss: 1.6189, instance_loss: 0.5648, weighted_loss: 1.3027, label: 0, bag_size: 3387
batch 719, loss: 1.1431, instance_loss: 0.8496, weighted_loss: 1.0550, label: 1, bag_size: 4346
batch 739, loss: 0.1004, instance_loss: 0.3325, weighted_loss: 0.1700, label: 1, bag_size: 3471


class 0 clustering acc 0.9695190156599552: correct 17335/17880
class 1 clustering acc 0.3447986577181208: correct 2055/5960
Epoch: 21, train_loss: 0.6169, train_clustering_loss:  0.5582, train_error: 0.2617
class 0: acc 0.7886792452830189, correct 209/265
class 1: acc 0.6223175965665236, correct 145/233
class 2: acc 0.7935222672064778, correct 196/247

Val Set, val_loss: 0.6170, val_error: 0.2340, auc: 0.9036
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.3976063829787234: correct 299/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1593, instance_loss: 0.2593, weighted_loss: 0.1893, label: 2, bag_size: 2359
batch 39, loss: 0.7044, instance_loss: 0.8693, weighted_loss: 0.7538, label: 2, bag_size: 4535
batch 59, loss: 0.4885, instance_loss: 0.8478, weighted_loss: 0.5963, label: 2, bag_size: 3810
batch 79, loss: 0.2573, instance_loss: 0.3270, weighted_loss: 0.2782, label: 0, bag_size: 4228
batch 99, loss: 0.1224, instance_loss: 0.4189, weighted_loss: 0.2113, label: 1, bag_size: 4812
batch 119, loss: 0.0657, instance_loss: 0.2407, weighted_loss: 0.1182, label: 1, bag_size: 2796
batch 139, loss: 0.1405, instance_loss: 0.3320, weighted_loss: 0.1980, label: 0, bag_size: 3793
batch 159, loss: 0.8068, instance_loss: 0.9871, weighted_loss: 0.8609, label: 0, bag_size: 8611
batch 179, loss: 1.2931, instance_loss: 0.7898, weighted_loss: 1.1421, label: 0, bag_size: 5259
batch 199, loss: 0.0775, instance_loss: 0.2529, weighted_loss: 0.1301, label: 2, bag_size: 3121
batch 219, loss: 0.1440, instance_loss: 0.2128, weighted_loss: 0.1646, label: 0, bag_size: 5871
batch 239, loss: 0.6361, instance_loss: 0.4959, weighted_loss: 0.5941, label: 2, bag_size: 5743
batch 259, loss: 0.0653, instance_loss: 0.1949, weighted_loss: 0.1042, label: 0, bag_size: 6765
batch 279, loss: 0.0197, instance_loss: 0.2816, weighted_loss: 0.0983, label: 1, bag_size: 4067
batch 299, loss: 0.7905, instance_loss: 0.4054, weighted_loss: 0.6750, label: 2, bag_size: 3583
batch 319, loss: 0.1003, instance_loss: 0.2456, weighted_loss: 0.1439, label: 0, bag_size: 3936
batch 339, loss: 0.0862, instance_loss: 0.2472, weighted_loss: 0.1345, label: 0, bag_size: 1545
batch 359, loss: 0.3983, instance_loss: 0.4139, weighted_loss: 0.4030, label: 0, bag_size: 3532
batch 379, loss: 0.2807, instance_loss: 0.5485, weighted_loss: 0.3611, label: 0, bag_size: 5377
batch 399, loss: 0.4600, instance_loss: 0.3641, weighted_loss: 0.4312, label: 0, bag_size: 3156
batch 419, loss: 0.0875, instance_loss: 0.8433, weighted_loss: 0.3142, label: 0, bag_size: 2231
batch 439, loss: 0.0943, instance_loss: 0.1633, weighted_loss: 0.1150, label: 2, bag_size: 4223
batch 459, loss: 0.1383, instance_loss: 0.3209, weighted_loss: 0.1931, label: 2, bag_size: 4192
batch 479, loss: 0.7345, instance_loss: 0.7525, weighted_loss: 0.7399, label: 0, bag_size: 889
batch 499, loss: 1.7379, instance_loss: 1.3717, weighted_loss: 1.6280, label: 1, bag_size: 5696
batch 519, loss: 0.0356, instance_loss: 0.0791, weighted_loss: 0.0487, label: 2, bag_size: 3415
batch 539, loss: 0.2256, instance_loss: 0.5446, weighted_loss: 0.3213, label: 0, bag_size: 889
batch 559, loss: 2.1002, instance_loss: 1.2074, weighted_loss: 1.8324, label: 2, bag_size: 4241
batch 579, loss: 0.1267, instance_loss: 0.1945, weighted_loss: 0.1470, label: 2, bag_size: 88
batch 599, loss: 0.6747, instance_loss: 0.8382, weighted_loss: 0.7238, label: 0, bag_size: 6285
batch 619, loss: 0.2820, instance_loss: 0.4581, weighted_loss: 0.3348, label: 1, bag_size: 2342
batch 639, loss: 0.0512, instance_loss: 0.2146, weighted_loss: 0.1002, label: 1, bag_size: 3337
batch 659, loss: 0.0694, instance_loss: 0.1687, weighted_loss: 0.0991, label: 1, bag_size: 3050
batch 679, loss: 0.4825, instance_loss: 1.0796, weighted_loss: 0.6616, label: 0, bag_size: 577
batch 699, loss: 1.2114, instance_loss: 0.5608, weighted_loss: 1.0162, label: 0, bag_size: 4719
batch 719, loss: 0.7383, instance_loss: 1.0674, weighted_loss: 0.8370, label: 0, bag_size: 477
batch 739, loss: 0.3835, instance_loss: 0.7530, weighted_loss: 0.4943, label: 2, bag_size: 4571


class 0 clustering acc 0.9662192393736018: correct 17276/17880
class 1 clustering acc 0.3436241610738255: correct 2048/5960
Epoch: 22, train_loss: 0.6454, train_clustering_loss:  0.5678, train_error: 0.2658
class 0: acc 0.7701612903225806, correct 191/248
class 1: acc 0.6398305084745762, correct 151/236
class 2: acc 0.7854406130268199, correct 205/261

Val Set, val_loss: 0.8101, val_error: 0.2979, auc: 0.8903
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.20877659574468085: correct 157/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9513, instance_loss: 0.6401, weighted_loss: 0.8579, label: 2, bag_size: 552
batch 39, loss: 0.5246, instance_loss: 0.3004, weighted_loss: 0.4573, label: 0, bag_size: 3752
batch 59, loss: 0.4166, instance_loss: 0.3048, weighted_loss: 0.3831, label: 0, bag_size: 4547
batch 79, loss: 0.2069, instance_loss: 0.2744, weighted_loss: 0.2271, label: 2, bag_size: 1103
batch 99, loss: 1.4296, instance_loss: 1.3994, weighted_loss: 1.4205, label: 1, bag_size: 20666
batch 119, loss: 0.7127, instance_loss: 0.8993, weighted_loss: 0.7687, label: 2, bag_size: 4342
batch 139, loss: 0.0314, instance_loss: 0.4365, weighted_loss: 0.1529, label: 0, bag_size: 3319
batch 159, loss: 1.3804, instance_loss: 0.9879, weighted_loss: 1.2626, label: 1, bag_size: 1045
batch 179, loss: 0.4619, instance_loss: 0.3306, weighted_loss: 0.4225, label: 0, bag_size: 4865
batch 199, loss: 0.0682, instance_loss: 0.1937, weighted_loss: 0.1059, label: 0, bag_size: 4783
batch 219, loss: 0.9726, instance_loss: 0.5864, weighted_loss: 0.8567, label: 1, bag_size: 9099
batch 239, loss: 1.7782, instance_loss: 1.1144, weighted_loss: 1.5790, label: 2, bag_size: 3475
batch 259, loss: 0.1728, instance_loss: 0.6060, weighted_loss: 0.3027, label: 0, bag_size: 1245
batch 279, loss: 0.2563, instance_loss: 0.3321, weighted_loss: 0.2790, label: 0, bag_size: 4161
batch 299, loss: 0.1098, instance_loss: 0.2852, weighted_loss: 0.1625, label: 2, bag_size: 4302
batch 319, loss: 0.0654, instance_loss: 0.2022, weighted_loss: 0.1064, label: 1, bag_size: 5086
batch 339, loss: 0.0554, instance_loss: 0.2096, weighted_loss: 0.1016, label: 0, bag_size: 1812
batch 359, loss: 0.5397, instance_loss: 0.6239, weighted_loss: 0.5650, label: 1, bag_size: 5926
batch 379, loss: 0.0227, instance_loss: 0.0729, weighted_loss: 0.0378, label: 2, bag_size: 4856
batch 399, loss: 0.2449, instance_loss: 0.3536, weighted_loss: 0.2775, label: 1, bag_size: 425
batch 419, loss: 0.0974, instance_loss: 0.2449, weighted_loss: 0.1417, label: 1, bag_size: 3126
batch 439, loss: 0.2350, instance_loss: 0.7002, weighted_loss: 0.3746, label: 1, bag_size: 2921
batch 459, loss: 0.0466, instance_loss: 0.2210, weighted_loss: 0.0989, label: 0, bag_size: 5039
batch 479, loss: 0.5080, instance_loss: 0.2965, weighted_loss: 0.4446, label: 2, bag_size: 705
batch 499, loss: 1.3034, instance_loss: 0.8522, weighted_loss: 1.1680, label: 1, bag_size: 3438
batch 519, loss: 1.8842, instance_loss: 1.5290, weighted_loss: 1.7776, label: 1, bag_size: 936
batch 539, loss: 0.0484, instance_loss: 0.3686, weighted_loss: 0.1444, label: 1, bag_size: 7135
batch 559, loss: 0.0000, instance_loss: 0.9909, weighted_loss: 0.2973, label: 0, bag_size: 2028
batch 579, loss: 0.0252, instance_loss: 0.0984, weighted_loss: 0.0472, label: 2, bag_size: 3497
batch 599, loss: 2.8944, instance_loss: 1.2145, weighted_loss: 2.3905, label: 2, bag_size: 2326
batch 619, loss: 0.8123, instance_loss: 1.1815, weighted_loss: 0.9230, label: 2, bag_size: 4241
batch 639, loss: 0.0309, instance_loss: 0.1671, weighted_loss: 0.0718, label: 0, bag_size: 4783
batch 659, loss: 0.0450, instance_loss: 0.1674, weighted_loss: 0.0817, label: 0, bag_size: 1006
batch 679, loss: 0.1188, instance_loss: 0.2447, weighted_loss: 0.1566, label: 0, bag_size: 5899
batch 699, loss: 0.6006, instance_loss: 0.5127, weighted_loss: 0.5742, label: 1, bag_size: 2122
batch 719, loss: 0.5630, instance_loss: 0.3777, weighted_loss: 0.5074, label: 0, bag_size: 4544
batch 739, loss: 0.0791, instance_loss: 0.1824, weighted_loss: 0.1101, label: 2, bag_size: 597


class 0 clustering acc 0.9722595078299776: correct 17384/17880
class 1 clustering acc 0.34312080536912754: correct 2045/5960
Epoch: 23, train_loss: 0.5753, train_clustering_loss:  0.5500, train_error: 0.2309
class 0: acc 0.8022813688212928, correct 211/263
class 1: acc 0.6666666666666666, correct 152/228
class 2: acc 0.8267716535433071, correct 210/254

Val Set, val_loss: 0.7025, val_error: 0.2660, auc: 0.9054
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.30186170212765956: correct 227/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8892, instance_loss: 0.7982, weighted_loss: 0.8619, label: 1, bag_size: 1607
batch 39, loss: 4.7157, instance_loss: 1.8801, weighted_loss: 3.8651, label: 0, bag_size: 1886
batch 59, loss: 0.0483, instance_loss: 0.1091, weighted_loss: 0.0665, label: 0, bag_size: 2825
batch 79, loss: 0.2179, instance_loss: 0.3306, weighted_loss: 0.2517, label: 0, bag_size: 1762
batch 99, loss: 0.0013, instance_loss: 0.7848, weighted_loss: 0.2363, label: 0, bag_size: 1055
batch 119, loss: 0.0810, instance_loss: 0.3416, weighted_loss: 0.1591, label: 2, bag_size: 3299
batch 139, loss: 0.6197, instance_loss: 0.6266, weighted_loss: 0.6218, label: 0, bag_size: 3164
batch 159, loss: 2.6106, instance_loss: 1.1008, weighted_loss: 2.1577, label: 2, bag_size: 361
batch 179, loss: 0.3880, instance_loss: 0.4004, weighted_loss: 0.3917, label: 1, bag_size: 1510
batch 199, loss: 0.5603, instance_loss: 0.4479, weighted_loss: 0.5266, label: 1, bag_size: 712
batch 219, loss: 2.0775, instance_loss: 1.2013, weighted_loss: 1.8147, label: 2, bag_size: 4910
batch 239, loss: 0.3322, instance_loss: 0.2524, weighted_loss: 0.3083, label: 0, bag_size: 702
batch 259, loss: 0.0326, instance_loss: 0.0768, weighted_loss: 0.0459, label: 2, bag_size: 657
batch 279, loss: 0.3825, instance_loss: 0.3893, weighted_loss: 0.3846, label: 2, bag_size: 3583
batch 299, loss: 0.9750, instance_loss: 0.8390, weighted_loss: 0.9342, label: 1, bag_size: 2998
batch 319, loss: 0.8225, instance_loss: 0.9596, weighted_loss: 0.8636, label: 1, bag_size: 5926
batch 339, loss: 0.5634, instance_loss: 0.4854, weighted_loss: 0.5400, label: 1, bag_size: 4346
batch 359, loss: 0.5100, instance_loss: 0.4285, weighted_loss: 0.4856, label: 1, bag_size: 4346
batch 379, loss: 0.0355, instance_loss: 0.1186, weighted_loss: 0.0604, label: 2, bag_size: 4775
batch 399, loss: 0.7941, instance_loss: 0.3691, weighted_loss: 0.6666, label: 1, bag_size: 3558
batch 419, loss: 0.2865, instance_loss: 0.4065, weighted_loss: 0.3225, label: 1, bag_size: 6475
batch 439, loss: 0.0262, instance_loss: 0.1700, weighted_loss: 0.0693, label: 0, bag_size: 829
batch 459, loss: 0.4057, instance_loss: 0.4478, weighted_loss: 0.4183, label: 2, bag_size: 3746
batch 479, loss: 0.0023, instance_loss: 0.3736, weighted_loss: 0.1137, label: 1, bag_size: 2009
batch 499, loss: 0.1837, instance_loss: 0.6840, weighted_loss: 0.3338, label: 0, bag_size: 1933
batch 519, loss: 0.1988, instance_loss: 0.0886, weighted_loss: 0.1657, label: 2, bag_size: 4788
batch 539, loss: 0.4020, instance_loss: 0.5535, weighted_loss: 0.4474, label: 1, bag_size: 2055
batch 559, loss: 0.5857, instance_loss: 0.8736, weighted_loss: 0.6721, label: 1, bag_size: 6689
batch 579, loss: 0.1303, instance_loss: 0.2704, weighted_loss: 0.1724, label: 0, bag_size: 5437
batch 599, loss: 0.3368, instance_loss: 0.5603, weighted_loss: 0.4039, label: 0, bag_size: 5011
batch 619, loss: 0.3583, instance_loss: 0.1515, weighted_loss: 0.2962, label: 0, bag_size: 7177
batch 639, loss: 0.0285, instance_loss: 0.0696, weighted_loss: 0.0408, label: 2, bag_size: 2254
batch 659, loss: 0.2915, instance_loss: 0.8177, weighted_loss: 0.4494, label: 0, bag_size: 5646
batch 679, loss: 0.4833, instance_loss: 0.8760, weighted_loss: 0.6011, label: 1, bag_size: 3322
batch 699, loss: 0.9393, instance_loss: 0.7692, weighted_loss: 0.8883, label: 2, bag_size: 3274
batch 719, loss: 0.0558, instance_loss: 0.1763, weighted_loss: 0.0919, label: 0, bag_size: 7169
batch 739, loss: 0.4722, instance_loss: 0.5417, weighted_loss: 0.4930, label: 1, bag_size: 5926


class 0 clustering acc 0.9662751677852349: correct 17277/17880
class 1 clustering acc 0.3691275167785235: correct 2200/5960
Epoch: 24, train_loss: 0.6216, train_clustering_loss:  0.5513, train_error: 0.2523
class 0: acc 0.8008130081300813, correct 197/246
class 1: acc 0.676923076923077, correct 176/260
class 2: acc 0.7698744769874477, correct 184/239

Val Set, val_loss: 0.6310, val_error: 0.2553, auc: 0.9053
class 0 clustering acc 0.9778368794326241: correct 2206/2256
class 1 clustering acc 0.3324468085106383: correct 250/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0643, instance_loss: 0.1324, weighted_loss: 0.0847, label: 0, bag_size: 4794
batch 39, loss: 0.1883, instance_loss: 0.2546, weighted_loss: 0.2082, label: 2, bag_size: 2359
batch 59, loss: 0.2214, instance_loss: 0.3130, weighted_loss: 0.2489, label: 0, bag_size: 2153
batch 79, loss: 0.0531, instance_loss: 0.1860, weighted_loss: 0.0930, label: 0, bag_size: 2791
batch 99, loss: 1.2450, instance_loss: 0.9059, weighted_loss: 1.1432, label: 2, bag_size: 7607
batch 119, loss: 0.1969, instance_loss: 0.2893, weighted_loss: 0.2246, label: 2, bag_size: 3227
batch 139, loss: 0.1675, instance_loss: 0.6583, weighted_loss: 0.3147, label: 0, bag_size: 1933
batch 159, loss: 2.1682, instance_loss: 1.1450, weighted_loss: 1.8613, label: 0, bag_size: 4032
batch 179, loss: 0.3180, instance_loss: 0.4818, weighted_loss: 0.3671, label: 1, bag_size: 1599
batch 199, loss: 0.0064, instance_loss: 0.3504, weighted_loss: 0.1096, label: 1, bag_size: 5462
batch 219, loss: 0.1163, instance_loss: 0.1544, weighted_loss: 0.1277, label: 2, bag_size: 88
batch 239, loss: 0.0033, instance_loss: 0.6167, weighted_loss: 0.1873, label: 1, bag_size: 10941
batch 259, loss: 0.0326, instance_loss: 0.0547, weighted_loss: 0.0392, label: 2, bag_size: 4691
batch 279, loss: 0.4003, instance_loss: 0.6705, weighted_loss: 0.4814, label: 1, bag_size: 1161
batch 299, loss: 0.0943, instance_loss: 0.3483, weighted_loss: 0.1705, label: 0, bag_size: 3983
batch 319, loss: 1.6907, instance_loss: 1.4160, weighted_loss: 1.6083, label: 0, bag_size: 11141
batch 339, loss: 0.1348, instance_loss: 0.3737, weighted_loss: 0.2064, label: 0, bag_size: 4711
batch 359, loss: 0.9291, instance_loss: 0.3239, weighted_loss: 0.7475, label: 0, bag_size: 5146
batch 379, loss: 0.0754, instance_loss: 0.2586, weighted_loss: 0.1304, label: 0, bag_size: 3777
batch 399, loss: 0.0429, instance_loss: 0.1249, weighted_loss: 0.0675, label: 0, bag_size: 2607
batch 419, loss: 0.8205, instance_loss: 0.6919, weighted_loss: 0.7819, label: 0, bag_size: 2286
batch 439, loss: 1.1056, instance_loss: 0.6980, weighted_loss: 0.9833, label: 1, bag_size: 3106
batch 459, loss: 0.3218, instance_loss: 0.3472, weighted_loss: 0.3294, label: 0, bag_size: 5992
batch 479, loss: 0.2251, instance_loss: 0.5621, weighted_loss: 0.3262, label: 0, bag_size: 3164
batch 499, loss: 0.2059, instance_loss: 0.4302, weighted_loss: 0.2732, label: 1, bag_size: 596
batch 519, loss: 1.9390, instance_loss: 1.2253, weighted_loss: 1.7249, label: 1, bag_size: 8632
batch 539, loss: 0.3724, instance_loss: 0.6268, weighted_loss: 0.4487, label: 1, bag_size: 4869
batch 559, loss: 0.1544, instance_loss: 0.5262, weighted_loss: 0.2659, label: 1, bag_size: 5195
batch 579, loss: 0.2285, instance_loss: 0.3503, weighted_loss: 0.2650, label: 1, bag_size: 758
batch 599, loss: 0.0906, instance_loss: 0.1969, weighted_loss: 0.1225, label: 2, bag_size: 3397
batch 619, loss: 0.0618, instance_loss: 0.1505, weighted_loss: 0.0884, label: 0, bag_size: 5992
batch 639, loss: 0.2067, instance_loss: 0.5411, weighted_loss: 0.3070, label: 1, bag_size: 3221
batch 659, loss: 0.5718, instance_loss: 0.6658, weighted_loss: 0.6000, label: 2, bag_size: 614
batch 679, loss: 0.2562, instance_loss: 0.5200, weighted_loss: 0.3353, label: 1, bag_size: 14449
batch 699, loss: 0.1784, instance_loss: 0.2927, weighted_loss: 0.2127, label: 0, bag_size: 4325
batch 719, loss: 0.3250, instance_loss: 0.5612, weighted_loss: 0.3959, label: 1, bag_size: 4253
batch 739, loss: 0.6382, instance_loss: 0.8356, weighted_loss: 0.6974, label: 1, bag_size: 4940


class 0 clustering acc 0.9702460850111857: correct 17348/17880
class 1 clustering acc 0.35788590604026843: correct 2133/5960
Epoch: 25, train_loss: 0.6047, train_clustering_loss:  0.5462, train_error: 0.2470
class 0: acc 0.7843137254901961, correct 200/255
class 1: acc 0.6709401709401709, correct 157/234
class 2: acc 0.796875, correct 204/256

Val Set, val_loss: 0.7488, val_error: 0.2553, auc: 0.8969
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.33643617021276595: correct 253/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.3923, instance_loss: 0.9601, weighted_loss: 1.2626, label: 0, bag_size: 313
batch 39, loss: 0.0012, instance_loss: 0.1318, weighted_loss: 0.0404, label: 1, bag_size: 5462
batch 59, loss: 1.0224, instance_loss: 0.6413, weighted_loss: 0.9081, label: 0, bag_size: 4572
batch 79, loss: 0.1656, instance_loss: 0.3826, weighted_loss: 0.2307, label: 0, bag_size: 4479
batch 99, loss: 0.3704, instance_loss: 0.5342, weighted_loss: 0.4195, label: 0, bag_size: 4922
batch 119, loss: 1.0945, instance_loss: 0.6769, weighted_loss: 0.9692, label: 2, bag_size: 552
batch 139, loss: 1.1004, instance_loss: 0.7651, weighted_loss: 0.9998, label: 2, bag_size: 1513
batch 159, loss: 2.2813, instance_loss: 1.1074, weighted_loss: 1.9292, label: 0, bag_size: 3830
batch 179, loss: 1.0030, instance_loss: 0.8599, weighted_loss: 0.9601, label: 2, bag_size: 2486
batch 199, loss: 0.4807, instance_loss: 0.4381, weighted_loss: 0.4679, label: 0, bag_size: 4562
batch 219, loss: 1.2348, instance_loss: 0.7252, weighted_loss: 1.0819, label: 2, bag_size: 552
batch 239, loss: 1.2047, instance_loss: 0.7198, weighted_loss: 1.0593, label: 0, bag_size: 1492
batch 259, loss: 0.4880, instance_loss: 0.4888, weighted_loss: 0.4882, label: 1, bag_size: 9099
batch 279, loss: 1.2368, instance_loss: 0.9992, weighted_loss: 1.1655, label: 1, bag_size: 2671
batch 299, loss: 0.3412, instance_loss: 0.6575, weighted_loss: 0.4361, label: 2, bag_size: 2486
batch 319, loss: 0.1583, instance_loss: 0.1619, weighted_loss: 0.1594, label: 2, bag_size: 3172
batch 339, loss: 0.0314, instance_loss: 0.0615, weighted_loss: 0.0404, label: 2, bag_size: 3121
batch 359, loss: 0.2448, instance_loss: 0.1806, weighted_loss: 0.2255, label: 2, bag_size: 3534
batch 379, loss: 0.2527, instance_loss: 0.3167, weighted_loss: 0.2719, label: 0, bag_size: 4700
batch 399, loss: 0.1750, instance_loss: 0.3237, weighted_loss: 0.2197, label: 2, bag_size: 3583
batch 419, loss: 0.0685, instance_loss: 0.3049, weighted_loss: 0.1394, label: 2, bag_size: 88
batch 439, loss: 0.4659, instance_loss: 0.3958, weighted_loss: 0.4449, label: 1, bag_size: 19265
batch 459, loss: 0.2471, instance_loss: 0.5122, weighted_loss: 0.3267, label: 1, bag_size: 3391
batch 479, loss: 1.1941, instance_loss: 0.3940, weighted_loss: 0.9541, label: 0, bag_size: 4717
batch 499, loss: 0.8697, instance_loss: 0.8834, weighted_loss: 0.8738, label: 1, bag_size: 2905
batch 519, loss: 0.3735, instance_loss: 0.5345, weighted_loss: 0.4218, label: 2, bag_size: 1222
batch 539, loss: 1.7368, instance_loss: 0.8412, weighted_loss: 1.4681, label: 0, bag_size: 893
batch 559, loss: 0.4798, instance_loss: 0.5323, weighted_loss: 0.4955, label: 1, bag_size: 368
batch 579, loss: 1.7250, instance_loss: 1.0731, weighted_loss: 1.5294, label: 1, bag_size: 8632
batch 599, loss: 0.4582, instance_loss: 0.7159, weighted_loss: 0.5355, label: 1, bag_size: 582
batch 619, loss: 0.2765, instance_loss: 0.4150, weighted_loss: 0.3181, label: 0, bag_size: 5953
batch 639, loss: 1.7592, instance_loss: 0.8571, weighted_loss: 1.4886, label: 0, bag_size: 4547
batch 659, loss: 0.6254, instance_loss: 0.7000, weighted_loss: 0.6478, label: 1, bag_size: 10399
batch 679, loss: 0.7031, instance_loss: 0.6619, weighted_loss: 0.6908, label: 1, bag_size: 5572
batch 699, loss: 0.1332, instance_loss: 0.2556, weighted_loss: 0.1699, label: 2, bag_size: 4555
batch 719, loss: 0.2138, instance_loss: 0.6988, weighted_loss: 0.3593, label: 1, bag_size: 2919
batch 739, loss: 1.5956, instance_loss: 0.8503, weighted_loss: 1.3720, label: 1, bag_size: 1097


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.3587248322147651: correct 2138/5960
Epoch: 26, train_loss: 0.6062, train_clustering_loss:  0.5550, train_error: 0.2470
class 0: acc 0.7751004016064257, correct 193/249
class 1: acc 0.694980694980695, correct 180/259
class 2: acc 0.7932489451476793, correct 188/237

Val Set, val_loss: 0.6159, val_error: 0.2021, auc: 0.9084
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.363031914893617: correct 273/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7407, instance_loss: 0.5879, weighted_loss: 0.6949, label: 1, bag_size: 3823
batch 39, loss: 0.0046, instance_loss: 0.1335, weighted_loss: 0.0433, label: 1, bag_size: 5760
batch 59, loss: 0.0933, instance_loss: 0.2670, weighted_loss: 0.1454, label: 1, bag_size: 5385
batch 79, loss: 0.0578, instance_loss: 0.1951, weighted_loss: 0.0990, label: 0, bag_size: 5337
batch 99, loss: 0.0104, instance_loss: 0.3293, weighted_loss: 0.1061, label: 1, bag_size: 3338
batch 119, loss: 0.1833, instance_loss: 0.2888, weighted_loss: 0.2150, label: 0, bag_size: 3247
batch 139, loss: 0.4754, instance_loss: 0.3756, weighted_loss: 0.4455, label: 1, bag_size: 5756
batch 159, loss: 0.7788, instance_loss: 0.7708, weighted_loss: 0.7764, label: 2, bag_size: 2813
batch 179, loss: 0.4122, instance_loss: 0.5572, weighted_loss: 0.4557, label: 0, bag_size: 1782
batch 199, loss: 0.0823, instance_loss: 0.1070, weighted_loss: 0.0897, label: 2, bag_size: 4223
batch 219, loss: 0.0443, instance_loss: 0.1980, weighted_loss: 0.0904, label: 0, bag_size: 5015
batch 239, loss: 0.2156, instance_loss: 0.3025, weighted_loss: 0.2416, label: 0, bag_size: 1353
batch 259, loss: 0.7843, instance_loss: 0.7339, weighted_loss: 0.7692, label: 1, bag_size: 3482
batch 279, loss: 1.8805, instance_loss: 1.0754, weighted_loss: 1.6390, label: 2, bag_size: 4179
batch 299, loss: 0.0573, instance_loss: 0.2194, weighted_loss: 0.1059, label: 0, bag_size: 3437
batch 319, loss: 0.1991, instance_loss: 0.9958, weighted_loss: 0.4381, label: 1, bag_size: 314
batch 339, loss: 0.1092, instance_loss: 0.5231, weighted_loss: 0.2334, label: 1, bag_size: 5833
batch 359, loss: 0.7388, instance_loss: 0.8160, weighted_loss: 0.7619, label: 1, bag_size: 2055
batch 379, loss: 0.0090, instance_loss: 0.6611, weighted_loss: 0.2046, label: 0, bag_size: 4485
batch 399, loss: 0.0915, instance_loss: 0.1815, weighted_loss: 0.1185, label: 0, bag_size: 2825
batch 419, loss: 0.7942, instance_loss: 0.6707, weighted_loss: 0.7571, label: 1, bag_size: 5118
batch 439, loss: 0.1857, instance_loss: 0.2692, weighted_loss: 0.2107, label: 0, bag_size: 1495
batch 459, loss: 0.0774, instance_loss: 0.2013, weighted_loss: 0.1146, label: 0, bag_size: 4282
batch 479, loss: 0.3247, instance_loss: 0.4832, weighted_loss: 0.3723, label: 1, bag_size: 2182
batch 499, loss: 0.8683, instance_loss: 0.5385, weighted_loss: 0.7694, label: 2, bag_size: 705
batch 519, loss: 1.6117, instance_loss: 1.1639, weighted_loss: 1.4774, label: 1, bag_size: 3791
batch 539, loss: 0.9427, instance_loss: 0.8537, weighted_loss: 0.9160, label: 1, bag_size: 936
batch 559, loss: 0.6951, instance_loss: 0.8491, weighted_loss: 0.7413, label: 1, bag_size: 2229
batch 579, loss: 0.6858, instance_loss: 0.6365, weighted_loss: 0.6710, label: 1, bag_size: 5572
batch 599, loss: 1.3788, instance_loss: 0.7172, weighted_loss: 1.1803, label: 2, bag_size: 6298
batch 619, loss: 0.8744, instance_loss: 0.5191, weighted_loss: 0.7678, label: 2, bag_size: 3534
batch 639, loss: 0.0344, instance_loss: 0.1345, weighted_loss: 0.0645, label: 2, bag_size: 3497
batch 659, loss: 0.3616, instance_loss: 0.3726, weighted_loss: 0.3649, label: 0, bag_size: 7330
batch 679, loss: 0.2309, instance_loss: 0.5860, weighted_loss: 0.3374, label: 0, bag_size: 5015
batch 699, loss: 0.0320, instance_loss: 0.1025, weighted_loss: 0.0531, label: 2, bag_size: 4788
batch 719, loss: 3.2999, instance_loss: 1.5439, weighted_loss: 2.7731, label: 1, bag_size: 1595
batch 739, loss: 2.0385, instance_loss: 1.0140, weighted_loss: 1.7312, label: 1, bag_size: 1307


class 0 clustering acc 0.9681208053691275: correct 17310/17880
class 1 clustering acc 0.3036912751677852: correct 1810/5960
Epoch: 27, train_loss: 0.6434, train_clustering_loss:  0.5747, train_error: 0.2779
class 0: acc 0.7791164658634538, correct 194/249
class 1: acc 0.62890625, correct 161/256
class 2: acc 0.7625, correct 183/240

Val Set, val_loss: 1.0100, val_error: 0.4468, auc: 0.8545
class 0 clustering acc 0.9676418439716312: correct 2183/2256
class 1 clustering acc 0.22606382978723405: correct 170/752
class 0: acc 0.46153846153846156, correct 24/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0113, instance_loss: 0.2777, weighted_loss: 0.0912, label: 1, bag_size: 10941
batch 39, loss: 0.4246, instance_loss: 0.3380, weighted_loss: 0.3986, label: 0, bag_size: 3915
batch 59, loss: 0.8528, instance_loss: 0.7133, weighted_loss: 0.8109, label: 1, bag_size: 5072
batch 79, loss: 0.0241, instance_loss: 0.1305, weighted_loss: 0.0560, label: 2, bag_size: 4856
batch 99, loss: 0.1451, instance_loss: 0.2877, weighted_loss: 0.1878, label: 2, bag_size: 5017
batch 119, loss: 0.5946, instance_loss: 0.9172, weighted_loss: 0.6914, label: 2, bag_size: 22464
batch 139, loss: 0.0756, instance_loss: 0.2043, weighted_loss: 0.1142, label: 0, bag_size: 1194
batch 159, loss: 1.5938, instance_loss: 0.7477, weighted_loss: 1.3400, label: 2, bag_size: 361
batch 179, loss: 0.8784, instance_loss: 0.9238, weighted_loss: 0.8920, label: 1, bag_size: 5693
batch 199, loss: 0.4185, instance_loss: 0.2490, weighted_loss: 0.3676, label: 2, bag_size: 3534
batch 219, loss: 0.9153, instance_loss: 0.8554, weighted_loss: 0.8974, label: 1, bag_size: 5718
batch 239, loss: 1.1256, instance_loss: 0.8419, weighted_loss: 1.0405, label: 1, bag_size: 3438
batch 259, loss: 0.8139, instance_loss: 0.6032, weighted_loss: 0.7507, label: 0, bag_size: 5867
batch 279, loss: 0.2289, instance_loss: 0.1928, weighted_loss: 0.2181, label: 2, bag_size: 88
batch 299, loss: 0.6326, instance_loss: 0.7223, weighted_loss: 0.6595, label: 0, bag_size: 2286
batch 319, loss: 0.5795, instance_loss: 0.6050, weighted_loss: 0.5872, label: 2, bag_size: 4487
batch 339, loss: 3.7859, instance_loss: 2.1845, weighted_loss: 3.3055, label: 0, bag_size: 434
batch 359, loss: 0.0548, instance_loss: 0.0904, weighted_loss: 0.0655, label: 2, bag_size: 4775
batch 379, loss: 0.4665, instance_loss: 0.6006, weighted_loss: 0.5067, label: 1, bag_size: 1510
batch 399, loss: 0.0908, instance_loss: 0.3557, weighted_loss: 0.1702, label: 0, bag_size: 1417
batch 419, loss: 1.3120, instance_loss: 1.3349, weighted_loss: 1.3189, label: 1, bag_size: 3424
batch 439, loss: 0.4718, instance_loss: 0.2469, weighted_loss: 0.4044, label: 2, bag_size: 3172
batch 459, loss: 0.1951, instance_loss: 0.3800, weighted_loss: 0.2506, label: 0, bag_size: 3904
batch 479, loss: 1.6360, instance_loss: 1.1177, weighted_loss: 1.4805, label: 1, bag_size: 5072
batch 499, loss: 1.2826, instance_loss: 1.0630, weighted_loss: 1.2167, label: 1, bag_size: 574
batch 519, loss: 2.2324, instance_loss: 0.9078, weighted_loss: 1.8350, label: 0, bag_size: 4921
batch 539, loss: 0.6951, instance_loss: 0.5163, weighted_loss: 0.6415, label: 2, bag_size: 1513
batch 559, loss: 0.1454, instance_loss: 0.2002, weighted_loss: 0.1618, label: 2, bag_size: 1103
batch 579, loss: 0.0537, instance_loss: 0.1301, weighted_loss: 0.0766, label: 0, bag_size: 3103
batch 599, loss: 0.5678, instance_loss: 0.8463, weighted_loss: 0.6514, label: 2, bag_size: 4342
batch 619, loss: 0.0736, instance_loss: 0.1259, weighted_loss: 0.0893, label: 2, bag_size: 4569
batch 639, loss: 0.0785, instance_loss: 0.1899, weighted_loss: 0.1119, label: 2, bag_size: 4203
batch 659, loss: 0.8498, instance_loss: 0.5485, weighted_loss: 0.7594, label: 2, bag_size: 552
batch 679, loss: 0.6372, instance_loss: 0.9472, weighted_loss: 0.7302, label: 2, bag_size: 4342
batch 699, loss: 0.0281, instance_loss: 0.3230, weighted_loss: 0.1166, label: 1, bag_size: 5026
batch 719, loss: 0.2082, instance_loss: 0.2851, weighted_loss: 0.2313, label: 0, bag_size: 2841
batch 739, loss: 0.3730, instance_loss: 0.3277, weighted_loss: 0.3594, label: 2, bag_size: 3080


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.3820469798657718: correct 2277/5960
Epoch: 28, train_loss: 0.6009, train_clustering_loss:  0.5362, train_error: 0.2725
class 0: acc 0.8015267175572519, correct 210/262
class 1: acc 0.57847533632287, correct 129/223
class 2: acc 0.7807692307692308, correct 203/260

Val Set, val_loss: 0.6878, val_error: 0.2447, auc: 0.8918
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.2859042553191489: correct 215/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2026, instance_loss: 0.3108, weighted_loss: 0.2351, label: 1, bag_size: 700
batch 39, loss: 0.3938, instance_loss: 0.4468, weighted_loss: 0.4097, label: 0, bag_size: 4450
batch 59, loss: 1.4962, instance_loss: 0.7362, weighted_loss: 1.2682, label: 2, bag_size: 2326
batch 79, loss: 0.1300, instance_loss: 0.4607, weighted_loss: 0.2292, label: 1, bag_size: 2919
batch 99, loss: 0.0161, instance_loss: 0.8412, weighted_loss: 0.2636, label: 0, bag_size: 2231
batch 119, loss: 0.0443, instance_loss: 0.3240, weighted_loss: 0.1282, label: 0, bag_size: 873
batch 139, loss: 0.3310, instance_loss: 0.4699, weighted_loss: 0.3726, label: 0, bag_size: 3334
batch 159, loss: 1.7396, instance_loss: 1.3160, weighted_loss: 1.6125, label: 1, bag_size: 1608
batch 179, loss: 0.1270, instance_loss: 0.3898, weighted_loss: 0.2058, label: 2, bag_size: 3497
batch 199, loss: 0.5691, instance_loss: 0.6276, weighted_loss: 0.5867, label: 2, bag_size: 3534
batch 219, loss: 0.3762, instance_loss: 0.5340, weighted_loss: 0.4236, label: 1, bag_size: 596
batch 239, loss: 1.5079, instance_loss: 0.8058, weighted_loss: 1.2973, label: 2, bag_size: 552
batch 259, loss: 0.7455, instance_loss: 0.6397, weighted_loss: 0.7138, label: 0, bag_size: 4719
batch 279, loss: 0.0997, instance_loss: 0.1919, weighted_loss: 0.1273, label: 0, bag_size: 3113
batch 299, loss: 0.0789, instance_loss: 0.1488, weighted_loss: 0.0999, label: 2, bag_size: 3327
batch 319, loss: 0.2439, instance_loss: 0.3373, weighted_loss: 0.2719, label: 0, bag_size: 7177
batch 339, loss: 0.0770, instance_loss: 0.1395, weighted_loss: 0.0958, label: 2, bag_size: 4223
batch 359, loss: 0.4157, instance_loss: 0.4800, weighted_loss: 0.4350, label: 1, bag_size: 2753
batch 379, loss: 0.1301, instance_loss: 0.1570, weighted_loss: 0.1382, label: 0, bag_size: 4700
batch 399, loss: 0.8211, instance_loss: 0.6796, weighted_loss: 0.7786, label: 1, bag_size: 1122
batch 419, loss: 0.3217, instance_loss: 0.4482, weighted_loss: 0.3596, label: 0, bag_size: 3797
batch 439, loss: 0.3144, instance_loss: 0.5581, weighted_loss: 0.3875, label: 1, bag_size: 4119
batch 459, loss: 0.0503, instance_loss: 0.0597, weighted_loss: 0.0531, label: 2, bag_size: 3583
batch 479, loss: 0.0086, instance_loss: 0.3172, weighted_loss: 0.1012, label: 0, bag_size: 4494
batch 499, loss: 1.0065, instance_loss: 1.1233, weighted_loss: 1.0415, label: 1, bag_size: 2302
batch 519, loss: 1.6435, instance_loss: 0.8538, weighted_loss: 1.4066, label: 0, bag_size: 14218
batch 539, loss: 0.9801, instance_loss: 0.7955, weighted_loss: 0.9247, label: 1, bag_size: 2751
batch 559, loss: 0.3238, instance_loss: 0.3620, weighted_loss: 0.3352, label: 2, bag_size: 614
batch 579, loss: 0.3715, instance_loss: 0.3980, weighted_loss: 0.3794, label: 2, bag_size: 3746
batch 599, loss: 0.4521, instance_loss: 0.4995, weighted_loss: 0.4663, label: 1, bag_size: 3786
batch 619, loss: 0.0110, instance_loss: 0.5997, weighted_loss: 0.1876, label: 1, bag_size: 4181
batch 639, loss: 0.1555, instance_loss: 0.3313, weighted_loss: 0.2082, label: 0, bag_size: 3793
batch 659, loss: 0.0203, instance_loss: 0.0802, weighted_loss: 0.0383, label: 2, bag_size: 3094
batch 679, loss: 0.0526, instance_loss: 0.2832, weighted_loss: 0.1218, label: 2, bag_size: 4141
batch 699, loss: 0.4506, instance_loss: 0.8111, weighted_loss: 0.5587, label: 2, bag_size: 4571
batch 719, loss: 0.1477, instance_loss: 0.2971, weighted_loss: 0.1925, label: 1, bag_size: 3983
batch 739, loss: 0.0350, instance_loss: 0.1172, weighted_loss: 0.0597, label: 2, bag_size: 6148


class 0 clustering acc 0.9720917225950783: correct 17381/17880
class 1 clustering acc 0.374496644295302: correct 2232/5960
Epoch: 29, train_loss: 0.5835, train_clustering_loss:  0.5358, train_error: 0.2416
class 0: acc 0.7896825396825397, correct 199/252
class 1: acc 0.7023809523809523, correct 177/252
class 2: acc 0.7842323651452282, correct 189/241

Val Set, val_loss: 0.8120, val_error: 0.3085, auc: 0.8766
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.35106382978723405: correct 264/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.9070, instance_loss: 0.6303, weighted_loss: 0.8240, label: 2, bag_size: 3274
batch 39, loss: 0.0151, instance_loss: 0.1739, weighted_loss: 0.0627, label: 1, bag_size: 259
batch 59, loss: 0.1149, instance_loss: 0.1401, weighted_loss: 0.1225, label: 2, bag_size: 2031
batch 79, loss: 0.0831, instance_loss: 0.6686, weighted_loss: 0.2588, label: 0, bag_size: 4485
batch 99, loss: 0.6130, instance_loss: 0.8831, weighted_loss: 0.6941, label: 1, bag_size: 1477
batch 119, loss: 0.0336, instance_loss: 0.1724, weighted_loss: 0.0752, label: 2, bag_size: 3094
batch 139, loss: 0.0048, instance_loss: 0.3796, weighted_loss: 0.1172, label: 1, bag_size: 2009
batch 159, loss: 0.3998, instance_loss: 0.3926, weighted_loss: 0.3976, label: 0, bag_size: 4946
batch 179, loss: 1.3234, instance_loss: 0.4665, weighted_loss: 1.0663, label: 1, bag_size: 4708
batch 199, loss: 0.0244, instance_loss: 0.1653, weighted_loss: 0.0667, label: 2, bag_size: 6148
batch 219, loss: 0.2351, instance_loss: 0.4795, weighted_loss: 0.3084, label: 0, bag_size: 7927
batch 239, loss: 1.1990, instance_loss: 1.0886, weighted_loss: 1.1659, label: 1, bag_size: 5693
batch 259, loss: 0.0719, instance_loss: 0.2680, weighted_loss: 0.1307, label: 0, bag_size: 5029
batch 279, loss: 0.9574, instance_loss: 0.8769, weighted_loss: 0.9332, label: 2, bag_size: 5406
batch 299, loss: 0.0804, instance_loss: 0.1761, weighted_loss: 0.1091, label: 2, bag_size: 2770
batch 319, loss: 0.6921, instance_loss: 0.7169, weighted_loss: 0.6995, label: 0, bag_size: 14218
batch 339, loss: 0.2331, instance_loss: 0.5410, weighted_loss: 0.3255, label: 0, bag_size: 4479
batch 359, loss: 0.1009, instance_loss: 0.2828, weighted_loss: 0.1554, label: 1, bag_size: 2731
batch 379, loss: 0.2541, instance_loss: 0.3180, weighted_loss: 0.2733, label: 2, bag_size: 4192
batch 399, loss: 0.4666, instance_loss: 0.4928, weighted_loss: 0.4744, label: 0, bag_size: 6927
batch 419, loss: 0.4071, instance_loss: 0.6376, weighted_loss: 0.4762, label: 0, bag_size: 889
batch 439, loss: 2.2623, instance_loss: 1.0843, weighted_loss: 1.9089, label: 0, bag_size: 4032
batch 459, loss: 2.3313, instance_loss: 1.1358, weighted_loss: 1.9726, label: 0, bag_size: 4032
batch 479, loss: 0.0003, instance_loss: 0.7377, weighted_loss: 0.2215, label: 0, bag_size: 1814
batch 499, loss: 2.3012, instance_loss: 1.0827, weighted_loss: 1.9356, label: 0, bag_size: 455
batch 519, loss: 1.7745, instance_loss: 1.4118, weighted_loss: 1.6657, label: 2, bag_size: 4179
batch 539, loss: 2.4485, instance_loss: 0.9206, weighted_loss: 1.9901, label: 0, bag_size: 13770
batch 559, loss: 0.3765, instance_loss: 0.4368, weighted_loss: 0.3946, label: 1, bag_size: 2055
batch 579, loss: 0.3828, instance_loss: 0.4402, weighted_loss: 0.4000, label: 0, bag_size: 2094
batch 599, loss: 0.4756, instance_loss: 0.6945, weighted_loss: 0.5413, label: 0, bag_size: 3341
batch 619, loss: 0.0013, instance_loss: 0.0963, weighted_loss: 0.0298, label: 0, bag_size: 1140
batch 639, loss: 0.0172, instance_loss: 0.1506, weighted_loss: 0.0572, label: 0, bag_size: 1647
batch 659, loss: 0.0004, instance_loss: 0.0721, weighted_loss: 0.0219, label: 0, bag_size: 3445
batch 679, loss: 0.3230, instance_loss: 0.7717, weighted_loss: 0.4576, label: 1, bag_size: 5756
batch 699, loss: 1.0875, instance_loss: 0.4456, weighted_loss: 0.8950, label: 0, bag_size: 3475
batch 719, loss: 0.4588, instance_loss: 0.3233, weighted_loss: 0.4182, label: 0, bag_size: 4245
batch 739, loss: 0.0571, instance_loss: 0.2371, weighted_loss: 0.1111, label: 1, bag_size: 259


class 0 clustering acc 0.9680648769574944: correct 17309/17880
class 1 clustering acc 0.3562080536912752: correct 2123/5960
Epoch: 30, train_loss: 0.5789, train_clustering_loss:  0.5555, train_error: 0.2550
class 0: acc 0.8252788104089219, correct 222/269
class 1: acc 0.6437246963562753, correct 159/247
class 2: acc 0.759825327510917, correct 174/229

Val Set, val_loss: 0.6089, val_error: 0.2447, auc: 0.9127
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.40558510638297873: correct 305/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.7993, instance_loss: 0.8466, weighted_loss: 0.8135, label: 2, bag_size: 4316
batch 39, loss: 0.0526, instance_loss: 0.1252, weighted_loss: 0.0744, label: 2, bag_size: 6026
batch 59, loss: 1.0679, instance_loss: 0.9302, weighted_loss: 1.0266, label: 2, bag_size: 1513
batch 79, loss: 3.0336, instance_loss: 1.3989, weighted_loss: 2.5432, label: 0, bag_size: 3419
batch 99, loss: 1.9100, instance_loss: 1.2663, weighted_loss: 1.7169, label: 0, bag_size: 1795
batch 119, loss: 1.2723, instance_loss: 1.3890, weighted_loss: 1.3073, label: 2, bag_size: 4342
batch 139, loss: 0.0002, instance_loss: 0.1752, weighted_loss: 0.0527, label: 0, bag_size: 3445
batch 159, loss: 0.0787, instance_loss: 0.1554, weighted_loss: 0.1017, label: 2, bag_size: 6026
batch 179, loss: 0.5145, instance_loss: 0.5604, weighted_loss: 0.5283, label: 1, bag_size: 2921
batch 199, loss: 0.1007, instance_loss: 0.2706, weighted_loss: 0.1517, label: 1, bag_size: 3051
batch 219, loss: 0.3299, instance_loss: 0.4635, weighted_loss: 0.3700, label: 1, bag_size: 3586
batch 239, loss: 0.3101, instance_loss: 0.8664, weighted_loss: 0.4770, label: 2, bag_size: 4241
batch 259, loss: 0.2819, instance_loss: 0.3803, weighted_loss: 0.3114, label: 1, bag_size: 3586
batch 279, loss: 2.2064, instance_loss: 1.3357, weighted_loss: 1.9452, label: 1, bag_size: 4187
batch 299, loss: 0.5992, instance_loss: 0.6186, weighted_loss: 0.6050, label: 1, bag_size: 2859
batch 319, loss: 0.2563, instance_loss: 0.4939, weighted_loss: 0.3276, label: 2, bag_size: 6594
batch 339, loss: 0.0031, instance_loss: 0.2099, weighted_loss: 0.0651, label: 0, bag_size: 829
batch 359, loss: 0.0466, instance_loss: 0.1781, weighted_loss: 0.0861, label: 0, bag_size: 855
batch 379, loss: 1.1370, instance_loss: 0.9450, weighted_loss: 1.0794, label: 1, bag_size: 2744
batch 399, loss: 0.9677, instance_loss: 0.5467, weighted_loss: 0.8414, label: 2, bag_size: 552
batch 419, loss: 0.1139, instance_loss: 0.5332, weighted_loss: 0.2397, label: 1, bag_size: 1023
batch 439, loss: 1.1573, instance_loss: 0.9954, weighted_loss: 1.1087, label: 1, bag_size: 1607
batch 459, loss: 0.8143, instance_loss: 0.9015, weighted_loss: 0.8405, label: 0, bag_size: 1289
batch 479, loss: 0.3683, instance_loss: 0.4499, weighted_loss: 0.3928, label: 0, bag_size: 3864
batch 499, loss: 0.1605, instance_loss: 0.2934, weighted_loss: 0.2004, label: 2, bag_size: 2209
batch 519, loss: 0.0347, instance_loss: 0.1455, weighted_loss: 0.0680, label: 0, bag_size: 4147
batch 539, loss: 0.6651, instance_loss: 0.7564, weighted_loss: 0.6925, label: 1, bag_size: 5340
batch 559, loss: 0.4273, instance_loss: 0.3483, weighted_loss: 0.4036, label: 2, bag_size: 614
batch 579, loss: 0.3446, instance_loss: 0.3498, weighted_loss: 0.3462, label: 1, bag_size: 4184
batch 599, loss: 0.4517, instance_loss: 0.4823, weighted_loss: 0.4609, label: 1, bag_size: 2671
batch 619, loss: 1.0580, instance_loss: 0.9700, weighted_loss: 1.0316, label: 2, bag_size: 3274
batch 639, loss: 0.3221, instance_loss: 0.5919, weighted_loss: 0.4030, label: 0, bag_size: 1652
batch 659, loss: 0.7956, instance_loss: 0.8888, weighted_loss: 0.8236, label: 2, bag_size: 4342
batch 679, loss: 0.4417, instance_loss: 0.3745, weighted_loss: 0.4216, label: 1, bag_size: 3225
batch 699, loss: 0.1690, instance_loss: 0.4458, weighted_loss: 0.2520, label: 0, bag_size: 1097
batch 719, loss: 0.3097, instance_loss: 0.3724, weighted_loss: 0.3285, label: 1, bag_size: 3534
batch 739, loss: 0.4474, instance_loss: 0.6166, weighted_loss: 0.4981, label: 0, bag_size: 1373


class 0 clustering acc 0.9710850111856824: correct 17363/17880
class 1 clustering acc 0.35906040268456374: correct 2140/5960
Epoch: 31, train_loss: 0.6037, train_clustering_loss:  0.5534, train_error: 0.2537
class 0: acc 0.774468085106383, correct 182/235
class 1: acc 0.6917293233082706, correct 184/266
class 2: acc 0.7786885245901639, correct 190/244

Val Set, val_loss: 0.5939, val_error: 0.2447, auc: 0.9101
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.3484042553191489: correct 262/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.606727 --> 0.593877).  Saving model ...


batch 19, loss: 0.0010, instance_loss: 0.3159, weighted_loss: 0.0955, label: 1, bag_size: 6717
batch 39, loss: 0.0288, instance_loss: 0.0578, weighted_loss: 0.0375, label: 0, bag_size: 3247
batch 59, loss: 0.0188, instance_loss: 0.0659, weighted_loss: 0.0329, label: 0, bag_size: 3855
batch 79, loss: 0.0043, instance_loss: 0.4290, weighted_loss: 0.1317, label: 1, bag_size: 4067
batch 99, loss: 0.6255, instance_loss: 0.5472, weighted_loss: 0.6020, label: 1, bag_size: 4373
batch 119, loss: 0.3478, instance_loss: 0.5294, weighted_loss: 0.4023, label: 1, bag_size: 6152
batch 139, loss: 0.7985, instance_loss: 0.9845, weighted_loss: 0.8543, label: 2, bag_size: 4342
batch 159, loss: 1.2160, instance_loss: 0.9080, weighted_loss: 1.1236, label: 0, bag_size: 8866
batch 179, loss: 0.0460, instance_loss: 0.3178, weighted_loss: 0.1276, label: 0, bag_size: 1611
batch 199, loss: 0.9994, instance_loss: 0.7417, weighted_loss: 0.9221, label: 2, bag_size: 1222
batch 219, loss: 0.2995, instance_loss: 0.2913, weighted_loss: 0.2970, label: 0, bag_size: 7177
batch 239, loss: 0.0441, instance_loss: 0.0705, weighted_loss: 0.0520, label: 2, bag_size: 4569
batch 259, loss: 0.2477, instance_loss: 0.3054, weighted_loss: 0.2650, label: 0, bag_size: 5015
batch 279, loss: 0.0369, instance_loss: 0.0667, weighted_loss: 0.0459, label: 0, bag_size: 4734
batch 299, loss: 0.5209, instance_loss: 0.5560, weighted_loss: 0.5314, label: 0, bag_size: 4416
batch 319, loss: 0.0496, instance_loss: 0.0927, weighted_loss: 0.0625, label: 2, bag_size: 4302
batch 339, loss: 0.0221, instance_loss: 0.1616, weighted_loss: 0.0639, label: 0, bag_size: 1485
batch 359, loss: 0.3232, instance_loss: 0.2304, weighted_loss: 0.2954, label: 2, bag_size: 3172
batch 379, loss: 0.2065, instance_loss: 0.4720, weighted_loss: 0.2861, label: 1, bag_size: 1410
batch 399, loss: 0.1590, instance_loss: 0.3242, weighted_loss: 0.2086, label: 0, bag_size: 4379
batch 419, loss: 1.4145, instance_loss: 1.0557, weighted_loss: 1.3069, label: 2, bag_size: 4342
batch 439, loss: 0.8388, instance_loss: 0.6043, weighted_loss: 0.7684, label: 2, bag_size: 1513
batch 459, loss: 0.1008, instance_loss: 0.1800, weighted_loss: 0.1246, label: 2, bag_size: 4691
batch 479, loss: 2.3257, instance_loss: 1.0785, weighted_loss: 1.9515, label: 1, bag_size: 1313
batch 499, loss: 0.7477, instance_loss: 0.9117, weighted_loss: 0.7969, label: 1, bag_size: 5512
batch 519, loss: 1.1639, instance_loss: 0.9314, weighted_loss: 1.0942, label: 2, bag_size: 3475
batch 539, loss: 1.8290, instance_loss: 0.8711, weighted_loss: 1.5416, label: 2, bag_size: 909
batch 559, loss: 0.5036, instance_loss: 0.4651, weighted_loss: 0.4920, label: 0, bag_size: 4282
batch 579, loss: 0.1615, instance_loss: 0.2286, weighted_loss: 0.1817, label: 2, bag_size: 2359
batch 599, loss: 0.5343, instance_loss: 0.5209, weighted_loss: 0.5303, label: 0, bag_size: 6223
batch 619, loss: 0.6986, instance_loss: 0.5795, weighted_loss: 0.6629, label: 1, bag_size: 800
batch 639, loss: 0.1980, instance_loss: 0.5876, weighted_loss: 0.3148, label: 1, bag_size: 5756
batch 659, loss: 0.2600, instance_loss: 0.2201, weighted_loss: 0.2480, label: 2, bag_size: 6704
batch 679, loss: 0.1486, instance_loss: 0.3417, weighted_loss: 0.2065, label: 0, bag_size: 4626
batch 699, loss: 0.0590, instance_loss: 0.2302, weighted_loss: 0.1103, label: 2, bag_size: 5017
batch 719, loss: 1.0716, instance_loss: 1.1675, weighted_loss: 1.1004, label: 1, bag_size: 3016
batch 739, loss: 0.2930, instance_loss: 0.7892, weighted_loss: 0.4419, label: 1, bag_size: 1712


class 0 clustering acc 0.9686800894854586: correct 17320/17880
class 1 clustering acc 0.40302013422818794: correct 2402/5960
Epoch: 32, train_loss: 0.5499, train_clustering_loss:  0.5289, train_error: 0.2228
class 0: acc 0.8271604938271605, correct 201/243
class 1: acc 0.6146788990825688, correct 134/218
class 2: acc 0.8591549295774648, correct 244/284

Val Set, val_loss: 1.2717, val_error: 0.4894, auc: 0.8440
class 0 clustering acc 0.910904255319149: correct 2055/2256
class 1 clustering acc 0.2127659574468085: correct 160/752
class 0: acc 0.5192307692307693, correct 27/52
class 1: acc 0.3, correct 9/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4221, instance_loss: 0.7343, weighted_loss: 0.5157, label: 0, bag_size: 4494
batch 39, loss: 0.1795, instance_loss: 0.2885, weighted_loss: 0.2122, label: 2, bag_size: 3327
batch 59, loss: 0.2330, instance_loss: 0.4796, weighted_loss: 0.3070, label: 0, bag_size: 4529
batch 79, loss: 0.4001, instance_loss: 0.6764, weighted_loss: 0.4830, label: 2, bag_size: 5472
batch 99, loss: 0.1427, instance_loss: 0.5041, weighted_loss: 0.2511, label: 0, bag_size: 1782
batch 119, loss: 1.1108, instance_loss: 1.0153, weighted_loss: 1.0821, label: 1, bag_size: 11974
batch 139, loss: 0.1560, instance_loss: 0.3402, weighted_loss: 0.2113, label: 0, bag_size: 1662
batch 159, loss: 0.0662, instance_loss: 0.1920, weighted_loss: 0.1040, label: 0, bag_size: 1233
batch 179, loss: 0.7399, instance_loss: 0.8454, weighted_loss: 0.7715, label: 1, bag_size: 2831
batch 199, loss: 0.8258, instance_loss: 0.9648, weighted_loss: 0.8675, label: 1, bag_size: 5693
batch 219, loss: 1.8897, instance_loss: 1.2140, weighted_loss: 1.6870, label: 1, bag_size: 1313
batch 239, loss: 0.3745, instance_loss: 0.3431, weighted_loss: 0.3651, label: 0, bag_size: 4161
batch 259, loss: 0.4803, instance_loss: 0.4362, weighted_loss: 0.4671, label: 2, bag_size: 4223
batch 279, loss: 0.6990, instance_loss: 0.5140, weighted_loss: 0.6435, label: 1, bag_size: 19265
batch 299, loss: 0.3865, instance_loss: 0.4564, weighted_loss: 0.4075, label: 1, bag_size: 2865
batch 319, loss: 0.0832, instance_loss: 0.3800, weighted_loss: 0.1723, label: 1, bag_size: 3333
batch 339, loss: 0.3524, instance_loss: 0.4568, weighted_loss: 0.3837, label: 1, bag_size: 3640
batch 359, loss: 1.0197, instance_loss: 0.5998, weighted_loss: 0.8938, label: 1, bag_size: 2671
batch 379, loss: 0.9085, instance_loss: 0.3253, weighted_loss: 0.7335, label: 0, bag_size: 3777
batch 399, loss: 0.0273, instance_loss: 0.1582, weighted_loss: 0.0666, label: 0, bag_size: 4606
batch 419, loss: 0.4410, instance_loss: 0.2873, weighted_loss: 0.3949, label: 2, bag_size: 4241
batch 439, loss: 0.4757, instance_loss: 0.6656, weighted_loss: 0.5327, label: 1, bag_size: 2859
batch 459, loss: 0.3468, instance_loss: 0.5449, weighted_loss: 0.4062, label: 0, bag_size: 4300
batch 479, loss: 0.9652, instance_loss: 1.2076, weighted_loss: 1.0379, label: 0, bag_size: 1052
batch 499, loss: 0.1935, instance_loss: 0.2000, weighted_loss: 0.1955, label: 2, bag_size: 88
batch 519, loss: 0.1914, instance_loss: 0.1800, weighted_loss: 0.1880, label: 2, bag_size: 3327
batch 539, loss: 0.0848, instance_loss: 0.1878, weighted_loss: 0.1157, label: 2, bag_size: 3618
batch 559, loss: 2.2341, instance_loss: 1.4439, weighted_loss: 1.9971, label: 1, bag_size: 5423
batch 579, loss: 1.0426, instance_loss: 1.0588, weighted_loss: 1.0475, label: 1, bag_size: 4694
batch 599, loss: 0.0496, instance_loss: 0.3708, weighted_loss: 0.1460, label: 2, bag_size: 2770
batch 619, loss: 0.0037, instance_loss: 2.1286, weighted_loss: 0.6412, label: 0, bag_size: 1709
batch 639, loss: 0.3173, instance_loss: 0.4580, weighted_loss: 0.3595, label: 1, bag_size: 2342
batch 659, loss: 0.1381, instance_loss: 0.4184, weighted_loss: 0.2222, label: 0, bag_size: 4351
batch 679, loss: 0.1603, instance_loss: 0.7101, weighted_loss: 0.3252, label: 0, bag_size: 1933
batch 699, loss: 1.3050, instance_loss: 0.8349, weighted_loss: 1.1640, label: 1, bag_size: 1595
batch 719, loss: 0.2539, instance_loss: 0.5151, weighted_loss: 0.3323, label: 2, bag_size: 4555
batch 739, loss: 0.2626, instance_loss: 0.6674, weighted_loss: 0.3840, label: 2, bag_size: 6594


class 0 clustering acc 0.9681767337807606: correct 17311/17880
class 1 clustering acc 0.36023489932885905: correct 2147/5960
Epoch: 33, train_loss: 0.5814, train_clustering_loss:  0.5447, train_error: 0.2322
class 0: acc 0.7854077253218884, correct 183/233
class 1: acc 0.6730769230769231, correct 175/260
class 2: acc 0.8492063492063492, correct 214/252

Val Set, val_loss: 0.7352, val_error: 0.2660, auc: 0.8958
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.300531914893617: correct 226/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0001, instance_loss: 0.2037, weighted_loss: 0.0611, label: 0, bag_size: 7077
batch 39, loss: 2.8844, instance_loss: 1.4989, weighted_loss: 2.4687, label: 1, bag_size: 2727
batch 59, loss: 0.4306, instance_loss: 0.4726, weighted_loss: 0.4432, label: 0, bag_size: 4460
batch 79, loss: 0.0346, instance_loss: 0.1311, weighted_loss: 0.0635, label: 2, bag_size: 4203
batch 99, loss: 3.3677, instance_loss: 1.2994, weighted_loss: 2.7472, label: 0, bag_size: 557
batch 119, loss: 3.2313, instance_loss: 1.2400, weighted_loss: 2.6339, label: 0, bag_size: 603
batch 139, loss: 0.3926, instance_loss: 0.3869, weighted_loss: 0.3909, label: 0, bag_size: 3915
batch 159, loss: 0.0492, instance_loss: 0.1354, weighted_loss: 0.0750, label: 1, bag_size: 4578
batch 179, loss: 0.0180, instance_loss: 0.0812, weighted_loss: 0.0369, label: 2, bag_size: 4569
batch 199, loss: 1.3620, instance_loss: 0.9408, weighted_loss: 1.2356, label: 2, bag_size: 2326
batch 219, loss: 0.0433, instance_loss: 0.1567, weighted_loss: 0.0773, label: 2, bag_size: 5924
batch 239, loss: 0.6013, instance_loss: 0.9499, weighted_loss: 0.7059, label: 0, bag_size: 7927
batch 259, loss: 2.5918, instance_loss: 1.6167, weighted_loss: 2.2993, label: 1, bag_size: 2425
batch 279, loss: 0.0085, instance_loss: 1.8468, weighted_loss: 0.5600, label: 0, bag_size: 1814
batch 299, loss: 0.5984, instance_loss: 0.4042, weighted_loss: 0.5401, label: 1, bag_size: 3640
batch 319, loss: 0.0937, instance_loss: 0.9035, weighted_loss: 0.3366, label: 0, bag_size: 2826
batch 339, loss: 0.8770, instance_loss: 0.4289, weighted_loss: 0.7426, label: 1, bag_size: 6241
batch 359, loss: 2.3981, instance_loss: 1.2436, weighted_loss: 2.0518, label: 2, bag_size: 909
batch 379, loss: 0.2907, instance_loss: 0.5381, weighted_loss: 0.3649, label: 0, bag_size: 1352
batch 399, loss: 3.5126, instance_loss: 1.8593, weighted_loss: 3.0166, label: 0, bag_size: 3711
batch 419, loss: 0.1008, instance_loss: 0.1983, weighted_loss: 0.1300, label: 0, bag_size: 3855
batch 439, loss: 0.1129, instance_loss: 0.4122, weighted_loss: 0.2027, label: 0, bag_size: 2545
batch 459, loss: 0.3606, instance_loss: 0.9936, weighted_loss: 0.5505, label: 1, bag_size: 1542
batch 479, loss: 1.1846, instance_loss: 0.6515, weighted_loss: 1.0246, label: 0, bag_size: 4122
batch 499, loss: 0.9790, instance_loss: 1.0587, weighted_loss: 1.0029, label: 0, bag_size: 2153
batch 519, loss: 0.2818, instance_loss: 0.2554, weighted_loss: 0.2739, label: 2, bag_size: 3172
batch 539, loss: 0.8717, instance_loss: 1.0348, weighted_loss: 0.9206, label: 2, bag_size: 2813
batch 559, loss: 0.2983, instance_loss: 1.0298, weighted_loss: 0.5178, label: 0, bag_size: 4337
batch 579, loss: 0.0560, instance_loss: 0.2831, weighted_loss: 0.1241, label: 0, bag_size: 3530
batch 599, loss: 0.1389, instance_loss: 0.1849, weighted_loss: 0.1527, label: 2, bag_size: 1103
batch 619, loss: 0.0200, instance_loss: 0.0377, weighted_loss: 0.0253, label: 2, bag_size: 2209
batch 639, loss: 0.5280, instance_loss: 0.6215, weighted_loss: 0.5561, label: 1, bag_size: 9099
batch 659, loss: 0.8558, instance_loss: 0.3036, weighted_loss: 0.6902, label: 2, bag_size: 2561
batch 679, loss: 2.6160, instance_loss: 1.2458, weighted_loss: 2.2050, label: 1, bag_size: 2727
batch 699, loss: 0.7633, instance_loss: 0.7414, weighted_loss: 0.7567, label: 1, bag_size: 5011
batch 719, loss: 0.0273, instance_loss: 0.1769, weighted_loss: 0.0722, label: 0, bag_size: 3871
batch 739, loss: 0.7990, instance_loss: 0.8837, weighted_loss: 0.8244, label: 2, bag_size: 22464


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.3875838926174497: correct 2310/5960
Epoch: 34, train_loss: 0.5544, train_clustering_loss:  0.5312, train_error: 0.2389
class 0: acc 0.8087649402390438, correct 203/251
class 1: acc 0.6837944664031621, correct 173/253
class 2: acc 0.7925311203319502, correct 191/241

Val Set, val_loss: 0.7221, val_error: 0.2766, auc: 0.8980
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.2925531914893617: correct 220/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7, correct 21/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1650, instance_loss: 0.2495, weighted_loss: 0.1904, label: 2, bag_size: 3327
batch 39, loss: 0.1336, instance_loss: 0.2087, weighted_loss: 0.1561, label: 0, bag_size: 4544
batch 59, loss: 0.0848, instance_loss: 0.2223, weighted_loss: 0.1261, label: 0, bag_size: 4741
batch 79, loss: 0.2343, instance_loss: 0.1912, weighted_loss: 0.2214, label: 2, bag_size: 3026
batch 99, loss: 0.1766, instance_loss: 0.2380, weighted_loss: 0.1950, label: 2, bag_size: 2359
batch 119, loss: 0.0118, instance_loss: 0.0658, weighted_loss: 0.0280, label: 2, bag_size: 4856
batch 139, loss: 0.0314, instance_loss: 0.2547, weighted_loss: 0.0984, label: 0, bag_size: 966
batch 159, loss: 0.1563, instance_loss: 0.3701, weighted_loss: 0.2204, label: 0, bag_size: 2601
batch 179, loss: 0.9142, instance_loss: 1.0750, weighted_loss: 0.9624, label: 1, bag_size: 2744
batch 199, loss: 0.0000, instance_loss: 0.5726, weighted_loss: 0.1718, label: 0, bag_size: 1106
batch 219, loss: 0.8730, instance_loss: 0.7543, weighted_loss: 0.8374, label: 1, bag_size: 6241
batch 239, loss: 0.2670, instance_loss: 0.3509, weighted_loss: 0.2922, label: 0, bag_size: 272
batch 259, loss: 0.8794, instance_loss: 0.6590, weighted_loss: 0.8133, label: 1, bag_size: 3786
batch 279, loss: 0.0666, instance_loss: 0.1023, weighted_loss: 0.0773, label: 2, bag_size: 2209
batch 299, loss: 0.0287, instance_loss: 0.2816, weighted_loss: 0.1046, label: 0, bag_size: 1812
batch 319, loss: 0.1051, instance_loss: 0.2413, weighted_loss: 0.1460, label: 0, bag_size: 2601
batch 339, loss: 0.2082, instance_loss: 0.6517, weighted_loss: 0.3413, label: 0, bag_size: 2927
batch 359, loss: 0.0718, instance_loss: 0.3206, weighted_loss: 0.1464, label: 0, bag_size: 4332
batch 379, loss: 0.3854, instance_loss: 0.6299, weighted_loss: 0.4587, label: 1, bag_size: 3265
batch 399, loss: 0.7792, instance_loss: 0.7580, weighted_loss: 0.7728, label: 1, bag_size: 3424
batch 419, loss: 0.0307, instance_loss: 0.3801, weighted_loss: 0.1355, label: 0, bag_size: 1485
batch 439, loss: 1.5429, instance_loss: 0.8662, weighted_loss: 1.3399, label: 0, bag_size: 1492
batch 459, loss: 0.0700, instance_loss: 0.2038, weighted_loss: 0.1101, label: 0, bag_size: 4344
batch 479, loss: 0.0279, instance_loss: 0.0903, weighted_loss: 0.0466, label: 2, bag_size: 2254
batch 499, loss: 0.0264, instance_loss: 0.1612, weighted_loss: 0.0668, label: 2, bag_size: 3397
batch 519, loss: 0.5219, instance_loss: 0.4734, weighted_loss: 0.5073, label: 1, bag_size: 6689
batch 539, loss: 0.1573, instance_loss: 0.1937, weighted_loss: 0.1682, label: 0, bag_size: 4741
batch 559, loss: 0.2659, instance_loss: 0.5819, weighted_loss: 0.3607, label: 1, bag_size: 3991
batch 579, loss: 0.0208, instance_loss: 0.0327, weighted_loss: 0.0244, label: 2, bag_size: 657
batch 599, loss: 0.0610, instance_loss: 0.1419, weighted_loss: 0.0853, label: 2, bag_size: 3176
batch 619, loss: 0.0685, instance_loss: 0.5896, weighted_loss: 0.2248, label: 2, bag_size: 4497
batch 639, loss: 0.0458, instance_loss: 0.1432, weighted_loss: 0.0750, label: 2, bag_size: 3397
batch 659, loss: 0.0158, instance_loss: 0.2758, weighted_loss: 0.0938, label: 2, bag_size: 4497
batch 679, loss: 0.0179, instance_loss: 0.0819, weighted_loss: 0.0371, label: 0, bag_size: 4644
batch 699, loss: 0.8355, instance_loss: 0.4746, weighted_loss: 0.7272, label: 0, bag_size: 3571
batch 719, loss: 0.1010, instance_loss: 0.1969, weighted_loss: 0.1297, label: 0, bag_size: 3344
batch 739, loss: 0.3099, instance_loss: 0.4364, weighted_loss: 0.3479, label: 1, bag_size: 210


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.4147651006711409: correct 2472/5960
Epoch: 35, train_loss: 0.5287, train_clustering_loss:  0.5186, train_error: 0.2215
class 0: acc 0.7932489451476793, correct 188/237
class 1: acc 0.6895161290322581, correct 171/248
class 2: acc 0.85, correct 221/260

Val Set, val_loss: 0.6013, val_error: 0.2553, auc: 0.9036
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.37898936170212766: correct 285/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7760, instance_loss: 0.6005, weighted_loss: 0.7234, label: 1, bag_size: 4395
batch 39, loss: 0.1407, instance_loss: 0.3074, weighted_loss: 0.1907, label: 2, bag_size: 5037
batch 59, loss: 0.0058, instance_loss: 0.1081, weighted_loss: 0.0365, label: 0, bag_size: 829
batch 79, loss: 0.5298, instance_loss: 0.5118, weighted_loss: 0.5244, label: 1, bag_size: 3106
batch 99, loss: 0.1591, instance_loss: 0.4250, weighted_loss: 0.2389, label: 1, bag_size: 782
batch 119, loss: 1.2994, instance_loss: 0.8722, weighted_loss: 1.1713, label: 1, bag_size: 11974
batch 139, loss: 0.0344, instance_loss: 0.0969, weighted_loss: 0.0532, label: 2, bag_size: 3285
batch 159, loss: 0.0831, instance_loss: 0.1686, weighted_loss: 0.1087, label: 0, bag_size: 3406
batch 179, loss: 0.0257, instance_loss: 0.6408, weighted_loss: 0.2102, label: 1, bag_size: 1604
batch 199, loss: 0.6051, instance_loss: 1.3344, weighted_loss: 0.8239, label: 2, bag_size: 22464
batch 219, loss: 0.3252, instance_loss: 0.5960, weighted_loss: 0.4065, label: 2, bag_size: 3227
batch 239, loss: 0.0998, instance_loss: 0.2552, weighted_loss: 0.1465, label: 2, bag_size: 4203
batch 259, loss: 0.0266, instance_loss: 0.0770, weighted_loss: 0.0417, label: 2, bag_size: 2561
batch 279, loss: 3.1050, instance_loss: 1.7238, weighted_loss: 2.6907, label: 1, bag_size: 3399
batch 299, loss: 3.4317, instance_loss: 1.5731, weighted_loss: 2.8741, label: 0, bag_size: 2896
batch 319, loss: 0.1295, instance_loss: 0.8592, weighted_loss: 0.3484, label: 0, bag_size: 3245
batch 339, loss: 0.2445, instance_loss: 0.2936, weighted_loss: 0.2592, label: 2, bag_size: 3026
batch 359, loss: 0.0432, instance_loss: 0.4676, weighted_loss: 0.1705, label: 1, bag_size: 455
batch 379, loss: 0.2529, instance_loss: 0.2573, weighted_loss: 0.2542, label: 2, bag_size: 3415
batch 399, loss: 0.4678, instance_loss: 0.5103, weighted_loss: 0.4805, label: 2, bag_size: 3746
batch 419, loss: 0.2566, instance_loss: 0.1582, weighted_loss: 0.2270, label: 2, bag_size: 3678
batch 439, loss: 0.0882, instance_loss: 0.0511, weighted_loss: 0.0771, label: 2, bag_size: 3678
batch 459, loss: 0.7282, instance_loss: 0.7030, weighted_loss: 0.7206, label: 1, bag_size: 1607
batch 479, loss: 0.0203, instance_loss: 0.0572, weighted_loss: 0.0313, label: 0, bag_size: 4634
batch 499, loss: 0.2467, instance_loss: 0.1937, weighted_loss: 0.2308, label: 0, bag_size: 272
batch 519, loss: 0.2693, instance_loss: 0.3520, weighted_loss: 0.2941, label: 1, bag_size: 2342
batch 539, loss: 0.0729, instance_loss: 0.4325, weighted_loss: 0.1808, label: 1, bag_size: 3127
batch 559, loss: 0.2015, instance_loss: 0.4211, weighted_loss: 0.2674, label: 2, bag_size: 5472
batch 579, loss: 1.2942, instance_loss: 1.0699, weighted_loss: 1.2269, label: 2, bag_size: 3475
batch 599, loss: 1.0506, instance_loss: 0.5063, weighted_loss: 0.8873, label: 2, bag_size: 4487
batch 619, loss: 0.8672, instance_loss: 0.8695, weighted_loss: 0.8679, label: 1, bag_size: 5693
batch 639, loss: 1.5309, instance_loss: 1.1858, weighted_loss: 1.4273, label: 1, bag_size: 4187
batch 659, loss: 0.6081, instance_loss: 0.3491, weighted_loss: 0.5304, label: 0, bag_size: 1353
batch 679, loss: 0.4665, instance_loss: 0.4185, weighted_loss: 0.4521, label: 0, bag_size: 2378
batch 699, loss: 0.1552, instance_loss: 0.2491, weighted_loss: 0.1834, label: 0, bag_size: 2290
batch 719, loss: 0.4799, instance_loss: 0.6239, weighted_loss: 0.5231, label: 2, bag_size: 5472
batch 739, loss: 0.6242, instance_loss: 0.5558, weighted_loss: 0.6037, label: 0, bag_size: 4220


class 0 clustering acc 0.9700782997762863: correct 17345/17880
class 1 clustering acc 0.364261744966443: correct 2171/5960
Epoch: 36, train_loss: 0.5943, train_clustering_loss:  0.5434, train_error: 0.2456
class 0: acc 0.7531914893617021, correct 177/235
class 1: acc 0.7019607843137254, correct 179/255
class 2: acc 0.807843137254902, correct 206/255

Val Set, val_loss: 0.8459, val_error: 0.3936, auc: 0.8819
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.25398936170212766: correct 191/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3368, instance_loss: 0.3622, weighted_loss: 0.3444, label: 2, bag_size: 3546
batch 39, loss: 0.3917, instance_loss: 0.4965, weighted_loss: 0.4231, label: 2, bag_size: 3618
batch 59, loss: 0.1344, instance_loss: 0.2468, weighted_loss: 0.1681, label: 0, bag_size: 4242
batch 79, loss: 0.0001, instance_loss: 0.3053, weighted_loss: 0.0917, label: 2, bag_size: 3607
batch 99, loss: 2.4081, instance_loss: 1.6807, weighted_loss: 2.1899, label: 1, bag_size: 936
batch 119, loss: 1.2645, instance_loss: 0.9621, weighted_loss: 1.1738, label: 2, bag_size: 3299
batch 139, loss: 0.0356, instance_loss: 0.1004, weighted_loss: 0.0550, label: 2, bag_size: 657
batch 159, loss: 0.0769, instance_loss: 0.3708, weighted_loss: 0.1651, label: 1, bag_size: 4644
batch 179, loss: 3.1080, instance_loss: 1.4623, weighted_loss: 2.6143, label: 0, bag_size: 1071
batch 199, loss: 0.0315, instance_loss: 0.2024, weighted_loss: 0.0828, label: 0, bag_size: 3289
batch 219, loss: 0.1618, instance_loss: 0.3309, weighted_loss: 0.2125, label: 0, bag_size: 2756
batch 239, loss: 0.0032, instance_loss: 0.4297, weighted_loss: 0.1311, label: 0, bag_size: 4841
batch 259, loss: 0.5515, instance_loss: 0.8790, weighted_loss: 0.6497, label: 1, bag_size: 1161
batch 279, loss: 0.0150, instance_loss: 0.0754, weighted_loss: 0.0331, label: 2, bag_size: 657
batch 299, loss: 0.1661, instance_loss: 0.3329, weighted_loss: 0.2161, label: 2, bag_size: 6644
batch 319, loss: 0.2490, instance_loss: 0.2100, weighted_loss: 0.2373, label: 2, bag_size: 3583
batch 339, loss: 0.0643, instance_loss: 0.2702, weighted_loss: 0.1261, label: 2, bag_size: 5017
batch 359, loss: 0.0334, instance_loss: 0.1088, weighted_loss: 0.0560, label: 0, bag_size: 2873
batch 379, loss: 0.1105, instance_loss: 0.1272, weighted_loss: 0.1155, label: 0, bag_size: 4734
batch 399, loss: 0.0719, instance_loss: 0.1132, weighted_loss: 0.0843, label: 0, bag_size: 2094
batch 419, loss: 0.1684, instance_loss: 0.2191, weighted_loss: 0.1836, label: 2, bag_size: 6704
batch 439, loss: 0.0561, instance_loss: 0.0891, weighted_loss: 0.0660, label: 2, bag_size: 4775
batch 459, loss: 0.0005, instance_loss: 1.4414, weighted_loss: 0.4328, label: 0, bag_size: 1645
batch 479, loss: 0.1297, instance_loss: 0.3003, weighted_loss: 0.1809, label: 0, bag_size: 4332
batch 499, loss: 0.0270, instance_loss: 0.1016, weighted_loss: 0.0494, label: 2, bag_size: 4775
batch 519, loss: 0.0443, instance_loss: 0.0886, weighted_loss: 0.0576, label: 0, bag_size: 4326
batch 539, loss: 0.0680, instance_loss: 0.3947, weighted_loss: 0.1660, label: 0, bag_size: 7077
batch 559, loss: 1.3510, instance_loss: 0.9207, weighted_loss: 1.2219, label: 1, bag_size: 3813
batch 579, loss: 0.0291, instance_loss: 0.0633, weighted_loss: 0.0393, label: 2, bag_size: 4775
batch 599, loss: 0.0019, instance_loss: 0.3939, weighted_loss: 0.1195, label: 0, bag_size: 3319
batch 619, loss: 0.5911, instance_loss: 0.6917, weighted_loss: 0.6213, label: 2, bag_size: 728
batch 639, loss: 2.6898, instance_loss: 1.5127, weighted_loss: 2.3366, label: 1, bag_size: 3399
batch 659, loss: 0.2150, instance_loss: 0.1640, weighted_loss: 0.1997, label: 0, bag_size: 3247
batch 679, loss: 0.9142, instance_loss: 0.5472, weighted_loss: 0.8041, label: 0, bag_size: 18038
batch 699, loss: 0.0714, instance_loss: 0.1917, weighted_loss: 0.1075, label: 1, bag_size: 6475
batch 719, loss: 0.1776, instance_loss: 0.3015, weighted_loss: 0.2148, label: 0, bag_size: 702
batch 739, loss: 0.0216, instance_loss: 0.0602, weighted_loss: 0.0332, label: 2, bag_size: 4856


class 0 clustering acc 0.9680648769574944: correct 17309/17880
class 1 clustering acc 0.4053691275167785: correct 2416/5960
Epoch: 37, train_loss: 0.5395, train_clustering_loss:  0.5225, train_error: 0.2309
class 0: acc 0.7937743190661478, correct 204/257
class 1: acc 0.6441441441441441, correct 143/222
class 2: acc 0.849624060150376, correct 226/266

Val Set, val_loss: 0.6871, val_error: 0.2872, auc: 0.9021
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.3351063829787234: correct 252/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1494, instance_loss: 0.4426, weighted_loss: 0.2373, label: 2, bag_size: 6594
batch 39, loss: 0.4954, instance_loss: 0.9088, weighted_loss: 0.6194, label: 1, bag_size: 4027
batch 59, loss: 0.0349, instance_loss: 0.1783, weighted_loss: 0.0780, label: 2, bag_size: 2770
batch 79, loss: 0.0319, instance_loss: 0.1029, weighted_loss: 0.0532, label: 0, bag_size: 7595
batch 99, loss: 0.1345, instance_loss: 0.1734, weighted_loss: 0.1462, label: 2, bag_size: 2501
batch 119, loss: 0.6924, instance_loss: 0.5698, weighted_loss: 0.6556, label: 1, bag_size: 4253
batch 139, loss: 0.0084, instance_loss: 0.0919, weighted_loss: 0.0335, label: 2, bag_size: 614
batch 159, loss: 0.2453, instance_loss: 0.4295, weighted_loss: 0.3006, label: 1, bag_size: 2122
batch 179, loss: 0.6120, instance_loss: 0.7320, weighted_loss: 0.6480, label: 2, bag_size: 1222
batch 199, loss: 1.3403, instance_loss: 0.4788, weighted_loss: 1.0819, label: 1, bag_size: 3109
batch 219, loss: 0.2573, instance_loss: 0.6701, weighted_loss: 0.3811, label: 0, bag_size: 477
batch 239, loss: 0.4900, instance_loss: 0.9238, weighted_loss: 0.6202, label: 1, bag_size: 4940
batch 259, loss: 0.1750, instance_loss: 0.3345, weighted_loss: 0.2229, label: 1, bag_size: 4869
batch 279, loss: 2.1716, instance_loss: 1.3208, weighted_loss: 1.9163, label: 0, bag_size: 5330
batch 299, loss: 0.3348, instance_loss: 0.3193, weighted_loss: 0.3301, label: 2, bag_size: 1103
batch 319, loss: 0.8358, instance_loss: 0.7344, weighted_loss: 0.8054, label: 2, bag_size: 361
batch 339, loss: 0.0232, instance_loss: 0.0966, weighted_loss: 0.0452, label: 2, bag_size: 2770
batch 359, loss: 0.2008, instance_loss: 0.3981, weighted_loss: 0.2600, label: 0, bag_size: 1625
batch 379, loss: 0.8289, instance_loss: 0.5090, weighted_loss: 0.7329, label: 1, bag_size: 7135
batch 399, loss: 2.6565, instance_loss: 1.5828, weighted_loss: 2.3343, label: 0, bag_size: 768
batch 419, loss: 0.0292, instance_loss: 0.1888, weighted_loss: 0.0771, label: 2, bag_size: 5138
batch 439, loss: 0.0959, instance_loss: 0.2408, weighted_loss: 0.1394, label: 2, bag_size: 3327
batch 459, loss: 0.2302, instance_loss: 0.6009, weighted_loss: 0.3414, label: 2, bag_size: 5472
batch 479, loss: 0.0186, instance_loss: 0.4269, weighted_loss: 0.1411, label: 2, bag_size: 3094
batch 499, loss: 0.8098, instance_loss: 0.8316, weighted_loss: 0.8164, label: 2, bag_size: 2813
batch 519, loss: 1.9027, instance_loss: 1.2386, weighted_loss: 1.7035, label: 1, bag_size: 2727
batch 539, loss: 0.1067, instance_loss: 0.1743, weighted_loss: 0.1270, label: 2, bag_size: 4691
batch 559, loss: 0.8411, instance_loss: 0.6384, weighted_loss: 0.7803, label: 1, bag_size: 3106
batch 579, loss: 0.4067, instance_loss: 0.5508, weighted_loss: 0.4499, label: 1, bag_size: 3482
batch 599, loss: 0.2435, instance_loss: 0.5884, weighted_loss: 0.3470, label: 2, bag_size: 4141
batch 619, loss: 0.1052, instance_loss: 0.2820, weighted_loss: 0.1582, label: 0, bag_size: 4405
batch 639, loss: 0.4167, instance_loss: 0.2398, weighted_loss: 0.3637, label: 1, bag_size: 3991
batch 659, loss: 0.0006, instance_loss: 0.3420, weighted_loss: 0.1030, label: 1, bag_size: 6717
batch 679, loss: 0.2853, instance_loss: 0.5141, weighted_loss: 0.3539, label: 0, bag_size: 20234
batch 699, loss: 0.2439, instance_loss: 0.3471, weighted_loss: 0.2749, label: 2, bag_size: 3112
batch 719, loss: 0.0813, instance_loss: 0.4313, weighted_loss: 0.1863, label: 1, bag_size: 3126
batch 739, loss: 0.5180, instance_loss: 0.5409, weighted_loss: 0.5249, label: 0, bag_size: 8611


class 0 clustering acc 0.9677852348993289: correct 17304/17880
class 1 clustering acc 0.38540268456375837: correct 2297/5960
Epoch: 38, train_loss: 0.5368, train_clustering_loss:  0.5315, train_error: 0.2188
class 0: acc 0.799163179916318, correct 191/239
class 1: acc 0.6827309236947792, correct 170/249
class 2: acc 0.8599221789883269, correct 221/257

Val Set, val_loss: 0.7083, val_error: 0.2447, auc: 0.9032
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.3550531914893617: correct 267/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0507, instance_loss: 0.2529, weighted_loss: 0.1114, label: 2, bag_size: 614
batch 39, loss: 0.0890, instance_loss: 0.1820, weighted_loss: 0.1169, label: 0, bag_size: 999
batch 59, loss: 2.2027, instance_loss: 1.4297, weighted_loss: 1.9708, label: 2, bag_size: 4241
batch 79, loss: 1.5204, instance_loss: 0.6110, weighted_loss: 1.2476, label: 0, bag_size: 4228
batch 99, loss: 0.0978, instance_loss: 0.2214, weighted_loss: 0.1349, label: 2, bag_size: 3227
batch 119, loss: 0.1569, instance_loss: 0.3573, weighted_loss: 0.2170, label: 2, bag_size: 4569
batch 139, loss: 0.1095, instance_loss: 0.5281, weighted_loss: 0.2351, label: 1, bag_size: 2472
batch 159, loss: 3.4091, instance_loss: 1.4014, weighted_loss: 2.8068, label: 0, bag_size: 18038
batch 179, loss: 1.4196, instance_loss: 1.1261, weighted_loss: 1.3315, label: 2, bag_size: 4316
batch 199, loss: 0.6031, instance_loss: 0.5821, weighted_loss: 0.5968, label: 0, bag_size: 4700
batch 219, loss: 0.4417, instance_loss: 0.4435, weighted_loss: 0.4422, label: 1, bag_size: 5340
batch 239, loss: 0.3159, instance_loss: 0.2946, weighted_loss: 0.3095, label: 1, bag_size: 4184
batch 259, loss: 0.0537, instance_loss: 0.1201, weighted_loss: 0.0736, label: 2, bag_size: 4223
batch 279, loss: 0.0639, instance_loss: 0.4930, weighted_loss: 0.1926, label: 0, bag_size: 3539
batch 299, loss: 0.7088, instance_loss: 0.6182, weighted_loss: 0.6817, label: 1, bag_size: 2671
batch 319, loss: 0.1586, instance_loss: 0.2695, weighted_loss: 0.1919, label: 1, bag_size: 4869
batch 339, loss: 0.3458, instance_loss: 0.3890, weighted_loss: 0.3587, label: 0, bag_size: 4201
batch 359, loss: 0.0573, instance_loss: 0.5924, weighted_loss: 0.2178, label: 1, bag_size: 4027
batch 379, loss: 0.0020, instance_loss: 0.4109, weighted_loss: 0.1247, label: 1, bag_size: 455
batch 399, loss: 0.0000, instance_loss: 0.2355, weighted_loss: 0.0707, label: 0, bag_size: 5053
batch 419, loss: 0.0269, instance_loss: 0.0712, weighted_loss: 0.0402, label: 0, bag_size: 2094
batch 439, loss: 0.1706, instance_loss: 0.2620, weighted_loss: 0.1980, label: 1, bag_size: 3586
batch 459, loss: 0.0140, instance_loss: 0.8271, weighted_loss: 0.2580, label: 1, bag_size: 3322
batch 479, loss: 0.0468, instance_loss: 0.1343, weighted_loss: 0.0730, label: 0, bag_size: 4332
batch 499, loss: 0.0359, instance_loss: 0.2558, weighted_loss: 0.1019, label: 0, bag_size: 2853
batch 519, loss: 0.0882, instance_loss: 0.2018, weighted_loss: 0.1223, label: 0, bag_size: 1097
batch 539, loss: 3.8834, instance_loss: 2.0736, weighted_loss: 3.3404, label: 0, bag_size: 434
batch 559, loss: 0.5191, instance_loss: 0.3932, weighted_loss: 0.4813, label: 0, bag_size: 1373
batch 579, loss: 0.6336, instance_loss: 0.6091, weighted_loss: 0.6263, label: 2, bag_size: 4535
batch 599, loss: 0.1461, instance_loss: 0.3866, weighted_loss: 0.2183, label: 1, bag_size: 5696
batch 619, loss: 0.2983, instance_loss: 0.2544, weighted_loss: 0.2852, label: 2, bag_size: 1103
batch 639, loss: 0.2706, instance_loss: 0.2870, weighted_loss: 0.2755, label: 2, bag_size: 3176
batch 659, loss: 2.9229, instance_loss: 1.0819, weighted_loss: 2.3706, label: 0, bag_size: 4032
batch 679, loss: 0.0405, instance_loss: 0.0963, weighted_loss: 0.0572, label: 0, bag_size: 2873
batch 699, loss: 0.1853, instance_loss: 0.2550, weighted_loss: 0.2062, label: 2, bag_size: 2049
batch 719, loss: 0.0826, instance_loss: 0.1237, weighted_loss: 0.0950, label: 0, bag_size: 7330
batch 739, loss: 0.0089, instance_loss: 0.1315, weighted_loss: 0.0457, label: 2, bag_size: 4856


class 0 clustering acc 0.9646532438478748: correct 17248/17880
class 1 clustering acc 0.40503355704697985: correct 2414/5960
Epoch: 39, train_loss: 0.5587, train_clustering_loss:  0.5270, train_error: 0.2403
class 0: acc 0.8029197080291971, correct 220/274
class 1: acc 0.6244131455399061, correct 133/213
class 2: acc 0.8255813953488372, correct 213/258

Val Set, val_loss: 0.6000, val_error: 0.2447, auc: 0.9057
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.4002659574468085: correct 301/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0447, instance_loss: 0.1984, weighted_loss: 0.0908, label: 0, bag_size: 3530
batch 39, loss: 0.1241, instance_loss: 0.1556, weighted_loss: 0.1336, label: 0, bag_size: 6015
batch 59, loss: 0.0079, instance_loss: 0.1126, weighted_loss: 0.0393, label: 0, bag_size: 4529
batch 79, loss: 0.0505, instance_loss: 0.2152, weighted_loss: 0.0999, label: 0, bag_size: 5353
batch 99, loss: 0.3978, instance_loss: 0.3575, weighted_loss: 0.3857, label: 2, bag_size: 6644
batch 119, loss: 0.0171, instance_loss: 0.1453, weighted_loss: 0.0555, label: 2, bag_size: 3497
batch 139, loss: 0.0601, instance_loss: 0.5868, weighted_loss: 0.2181, label: 2, bag_size: 4497
batch 159, loss: 1.5006, instance_loss: 0.9273, weighted_loss: 1.3286, label: 0, bag_size: 3033
batch 179, loss: 0.0402, instance_loss: 0.1443, weighted_loss: 0.0714, label: 0, bag_size: 5337
batch 199, loss: 0.0020, instance_loss: 0.3862, weighted_loss: 0.1172, label: 1, bag_size: 4181
batch 219, loss: 0.0151, instance_loss: 0.1260, weighted_loss: 0.0483, label: 0, bag_size: 1399
batch 239, loss: 1.5848, instance_loss: 0.9347, weighted_loss: 1.3898, label: 2, bag_size: 2326
batch 259, loss: 0.3149, instance_loss: 0.1876, weighted_loss: 0.2767, label: 0, bag_size: 4734
batch 279, loss: 1.3330, instance_loss: 1.0172, weighted_loss: 1.2382, label: 1, bag_size: 3935
batch 299, loss: 0.0602, instance_loss: 0.3253, weighted_loss: 0.1397, label: 1, bag_size: 4869
batch 319, loss: 0.1388, instance_loss: 0.3210, weighted_loss: 0.1935, label: 2, bag_size: 3299
batch 339, loss: 0.6963, instance_loss: 0.8206, weighted_loss: 0.7336, label: 1, bag_size: 5276
batch 359, loss: 0.5262, instance_loss: 0.7624, weighted_loss: 0.5971, label: 1, bag_size: 5728
batch 379, loss: 1.3732, instance_loss: 1.3359, weighted_loss: 1.3620, label: 2, bag_size: 4241
batch 399, loss: 0.0000, instance_loss: 0.5550, weighted_loss: 0.1665, label: 0, bag_size: 3709
batch 419, loss: 0.0626, instance_loss: 0.1322, weighted_loss: 0.0835, label: 2, bag_size: 3176
batch 439, loss: 0.0628, instance_loss: 0.1692, weighted_loss: 0.0947, label: 2, bag_size: 4555
batch 459, loss: 0.1186, instance_loss: 0.2327, weighted_loss: 0.1528, label: 0, bag_size: 3103
batch 479, loss: 0.1484, instance_loss: 0.4463, weighted_loss: 0.2378, label: 0, bag_size: 5585
batch 499, loss: 0.4014, instance_loss: 0.2453, weighted_loss: 0.3545, label: 2, bag_size: 3026
batch 519, loss: 0.1918, instance_loss: 0.5183, weighted_loss: 0.2897, label: 0, bag_size: 3986
batch 539, loss: 2.6403, instance_loss: 1.6003, weighted_loss: 2.3283, label: 1, bag_size: 1307
batch 559, loss: 1.7689, instance_loss: 0.8248, weighted_loss: 1.4857, label: 1, bag_size: 2919
batch 579, loss: 0.0872, instance_loss: 0.2204, weighted_loss: 0.1272, label: 2, bag_size: 4569
batch 599, loss: 0.1413, instance_loss: 0.1915, weighted_loss: 0.1563, label: 1, bag_size: 3337
batch 619, loss: 0.6805, instance_loss: 0.6117, weighted_loss: 0.6598, label: 0, bag_size: 4584
batch 639, loss: 0.2723, instance_loss: 0.5095, weighted_loss: 0.3435, label: 0, bag_size: 5953
batch 659, loss: 0.3928, instance_loss: 0.5746, weighted_loss: 0.4473, label: 1, bag_size: 3611
batch 679, loss: 0.8605, instance_loss: 0.8613, weighted_loss: 0.8607, label: 1, bag_size: 3986
batch 699, loss: 0.8131, instance_loss: 0.7223, weighted_loss: 0.7859, label: 1, bag_size: 4184
batch 719, loss: 0.1118, instance_loss: 0.2705, weighted_loss: 0.1594, label: 2, bag_size: 4569
batch 739, loss: 0.7514, instance_loss: 0.5932, weighted_loss: 0.7039, label: 1, bag_size: 5572


class 0 clustering acc 0.9641498881431767: correct 17239/17880
class 1 clustering acc 0.4058724832214765: correct 2419/5960
Epoch: 40, train_loss: 0.5486, train_clustering_loss:  0.5365, train_error: 0.2309
class 0: acc 0.796, correct 199/250
class 1: acc 0.6652173913043479, correct 153/230
class 2: acc 0.8339622641509434, correct 221/265

Val Set, val_loss: 0.6064, val_error: 0.3085, auc: 0.9015
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.449468085106383: correct 338/752
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.26666666666666666, correct 8/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3103, instance_loss: 0.5583, weighted_loss: 0.3847, label: 0, bag_size: 4245
batch 39, loss: 0.4668, instance_loss: 0.5068, weighted_loss: 0.4788, label: 0, bag_size: 4719
batch 59, loss: 0.0002, instance_loss: 0.2788, weighted_loss: 0.0838, label: 2, bag_size: 3607
batch 79, loss: 0.0347, instance_loss: 0.1209, weighted_loss: 0.0606, label: 2, bag_size: 3121
batch 99, loss: 0.2727, instance_loss: 0.2894, weighted_loss: 0.2777, label: 1, bag_size: 5572
batch 119, loss: 0.1293, instance_loss: 0.2903, weighted_loss: 0.1776, label: 0, bag_size: 4332
batch 139, loss: 1.7986, instance_loss: 0.9529, weighted_loss: 1.5449, label: 1, bag_size: 5718
batch 159, loss: 0.0187, instance_loss: 0.0919, weighted_loss: 0.0407, label: 2, bag_size: 4856
batch 179, loss: 0.0824, instance_loss: 0.2316, weighted_loss: 0.1272, label: 2, bag_size: 5037
batch 199, loss: 0.8260, instance_loss: 0.7536, weighted_loss: 0.8043, label: 0, bag_size: 436
batch 219, loss: 0.4183, instance_loss: 0.8419, weighted_loss: 0.5454, label: 1, bag_size: 475
batch 239, loss: 1.2758, instance_loss: 0.9629, weighted_loss: 1.1819, label: 0, bag_size: 4245
batch 259, loss: 1.3851, instance_loss: 0.5731, weighted_loss: 1.1415, label: 0, bag_size: 1353
batch 279, loss: 0.0977, instance_loss: 0.4006, weighted_loss: 0.1886, label: 0, bag_size: 420
batch 299, loss: 0.0245, instance_loss: 0.2380, weighted_loss: 0.0885, label: 0, bag_size: 3754
batch 319, loss: 0.7337, instance_loss: 0.4676, weighted_loss: 0.6539, label: 0, bag_size: 5146
batch 339, loss: 0.1245, instance_loss: 0.8403, weighted_loss: 0.3392, label: 0, bag_size: 1904
batch 359, loss: 0.0545, instance_loss: 0.1564, weighted_loss: 0.0851, label: 2, bag_size: 3497
batch 379, loss: 0.2404, instance_loss: 0.4790, weighted_loss: 0.3119, label: 2, bag_size: 4487
batch 399, loss: 0.1117, instance_loss: 0.2622, weighted_loss: 0.1568, label: 2, bag_size: 4141
batch 419, loss: 0.0538, instance_loss: 0.2762, weighted_loss: 0.1205, label: 2, bag_size: 4497
batch 439, loss: 0.1198, instance_loss: 0.4646, weighted_loss: 0.2232, label: 0, bag_size: 3871
batch 459, loss: 0.0822, instance_loss: 0.2247, weighted_loss: 0.1250, label: 0, bag_size: 1417
batch 479, loss: 0.0437, instance_loss: 0.1442, weighted_loss: 0.0739, label: 1, bag_size: 6475
batch 499, loss: 0.2602, instance_loss: 0.3051, weighted_loss: 0.2736, label: 2, bag_size: 2049
batch 519, loss: 0.1428, instance_loss: 0.2108, weighted_loss: 0.1632, label: 2, bag_size: 2501
batch 539, loss: 0.0000, instance_loss: 0.1698, weighted_loss: 0.0509, label: 0, bag_size: 4918
batch 559, loss: 0.0624, instance_loss: 0.1730, weighted_loss: 0.0956, label: 2, bag_size: 614
batch 579, loss: 0.7739, instance_loss: 0.6907, weighted_loss: 0.7489, label: 2, bag_size: 2326
batch 599, loss: 1.3648, instance_loss: 0.8867, weighted_loss: 1.2214, label: 1, bag_size: 5718
batch 619, loss: 0.0479, instance_loss: 0.0997, weighted_loss: 0.0634, label: 2, bag_size: 3678
batch 639, loss: 0.0004, instance_loss: 0.0962, weighted_loss: 0.0292, label: 1, bag_size: 2493
batch 659, loss: 0.0501, instance_loss: 0.1567, weighted_loss: 0.0821, label: 0, bag_size: 4344
batch 679, loss: 0.2854, instance_loss: 0.8547, weighted_loss: 0.4562, label: 2, bag_size: 22464
batch 699, loss: 0.2683, instance_loss: 0.8765, weighted_loss: 0.4508, label: 0, bag_size: 4070
batch 719, loss: 0.2270, instance_loss: 0.1655, weighted_loss: 0.2086, label: 0, bag_size: 3376
batch 739, loss: 0.2223, instance_loss: 0.3754, weighted_loss: 0.2682, label: 2, bag_size: 5924


class 0 clustering acc 0.9676174496644295: correct 17301/17880
class 1 clustering acc 0.4248322147651007: correct 2532/5960
Epoch: 41, train_loss: 0.5304, train_clustering_loss:  0.5142, train_error: 0.2161
class 0: acc 0.7982456140350878, correct 182/228
class 1: acc 0.6680672268907563, correct 159/238
class 2: acc 0.8709677419354839, correct 243/279

Val Set, val_loss: 0.6688, val_error: 0.2872, auc: 0.9083
class 0 clustering acc 0.975177304964539: correct 2200/2256
class 1 clustering acc 0.35771276595744683: correct 269/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0168, instance_loss: 0.0675, weighted_loss: 0.0320, label: 2, bag_size: 6148
batch 39, loss: 0.1289, instance_loss: 0.3117, weighted_loss: 0.1838, label: 0, bag_size: 2677
batch 59, loss: 0.3547, instance_loss: 0.5857, weighted_loss: 0.4240, label: 0, bag_size: 5373
batch 79, loss: 0.2002, instance_loss: 0.4474, weighted_loss: 0.2744, label: 2, bag_size: 4535
batch 99, loss: 0.0695, instance_loss: 0.0696, weighted_loss: 0.0695, label: 2, bag_size: 4788
batch 119, loss: 1.2415, instance_loss: 1.0639, weighted_loss: 1.1883, label: 1, bag_size: 2229
batch 139, loss: 0.2409, instance_loss: 0.2499, weighted_loss: 0.2436, label: 0, bag_size: 4092
batch 159, loss: 0.4717, instance_loss: 0.5563, weighted_loss: 0.4971, label: 2, bag_size: 1222
batch 179, loss: 0.1544, instance_loss: 0.6230, weighted_loss: 0.2949, label: 0, bag_size: 4831
batch 199, loss: 0.1977, instance_loss: 0.2057, weighted_loss: 0.2001, label: 2, bag_size: 3080
batch 219, loss: 0.2237, instance_loss: 0.2677, weighted_loss: 0.2369, label: 0, bag_size: 4251
batch 239, loss: 0.3335, instance_loss: 0.5282, weighted_loss: 0.3919, label: 1, bag_size: 3437
batch 259, loss: 0.0850, instance_loss: 0.5531, weighted_loss: 0.2255, label: 1, bag_size: 2472
batch 279, loss: 0.8011, instance_loss: 0.9856, weighted_loss: 0.8564, label: 0, bag_size: 3033
batch 299, loss: 0.1819, instance_loss: 0.3193, weighted_loss: 0.2231, label: 2, bag_size: 3327
batch 319, loss: 2.0772, instance_loss: 1.4887, weighted_loss: 1.9007, label: 1, bag_size: 4612
batch 339, loss: 0.2356, instance_loss: 0.2422, weighted_loss: 0.2376, label: 2, bag_size: 3172
batch 359, loss: 3.0138, instance_loss: 1.4342, weighted_loss: 2.5399, label: 1, bag_size: 1097
batch 379, loss: 0.2803, instance_loss: 0.3686, weighted_loss: 0.3068, label: 0, bag_size: 2671
batch 399, loss: 0.0739, instance_loss: 0.3559, weighted_loss: 0.1585, label: 1, bag_size: 3885
batch 419, loss: 0.6779, instance_loss: 0.7304, weighted_loss: 0.6937, label: 1, bag_size: 4467
batch 439, loss: 0.3768, instance_loss: 0.3558, weighted_loss: 0.3705, label: 1, bag_size: 2122
batch 459, loss: 0.8428, instance_loss: 0.7906, weighted_loss: 0.8271, label: 0, bag_size: 7219
batch 479, loss: 0.5559, instance_loss: 1.7082, weighted_loss: 0.9016, label: 0, bag_size: 1782
batch 499, loss: 0.0581, instance_loss: 0.1517, weighted_loss: 0.0862, label: 0, bag_size: 3649
batch 519, loss: 0.0109, instance_loss: 0.0691, weighted_loss: 0.0284, label: 2, bag_size: 3810
batch 539, loss: 0.0442, instance_loss: 0.8134, weighted_loss: 0.2749, label: 1, bag_size: 4181
batch 559, loss: 0.0045, instance_loss: 0.1083, weighted_loss: 0.0357, label: 1, bag_size: 259
batch 579, loss: 0.6739, instance_loss: 0.5099, weighted_loss: 0.6247, label: 1, bag_size: 3100
batch 599, loss: 0.0786, instance_loss: 0.1542, weighted_loss: 0.1013, label: 2, bag_size: 6026
batch 619, loss: 0.5320, instance_loss: 0.5220, weighted_loss: 0.5290, label: 1, bag_size: 3396
batch 639, loss: 0.1188, instance_loss: 0.4298, weighted_loss: 0.2121, label: 0, bag_size: 4531
batch 659, loss: 0.1804, instance_loss: 0.4240, weighted_loss: 0.2535, label: 2, bag_size: 5017
batch 679, loss: 0.0190, instance_loss: 0.4318, weighted_loss: 0.1429, label: 0, bag_size: 3182
batch 699, loss: 0.1535, instance_loss: 0.2630, weighted_loss: 0.1863, label: 2, bag_size: 4223
batch 719, loss: 0.9184, instance_loss: 0.7530, weighted_loss: 0.8688, label: 1, bag_size: 6942
batch 739, loss: 1.1159, instance_loss: 1.0254, weighted_loss: 1.0888, label: 1, bag_size: 1477


class 0 clustering acc 0.9676174496644295: correct 17301/17880
class 1 clustering acc 0.3860738255033557: correct 2301/5960
Epoch: 42, train_loss: 0.5391, train_clustering_loss:  0.5365, train_error: 0.2148
class 0: acc 0.7913043478260869, correct 182/230
class 1: acc 0.6961538461538461, correct 181/260
class 2: acc 0.8705882352941177, correct 222/255

Val Set, val_loss: 1.0579, val_error: 0.5000, auc: 0.8669
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.1848404255319149: correct 139/752
class 0: acc 0.2692307692307692, correct 14/52
class 1: acc 0.7, correct 21/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0084, instance_loss: 0.0698, weighted_loss: 0.0268, label: 1, bag_size: 3425
batch 39, loss: 0.0547, instance_loss: 0.1066, weighted_loss: 0.0702, label: 2, bag_size: 657
batch 59, loss: 0.1240, instance_loss: 0.3170, weighted_loss: 0.1819, label: 2, bag_size: 88
batch 79, loss: 0.1880, instance_loss: 0.8717, weighted_loss: 0.3931, label: 0, bag_size: 2232
batch 99, loss: 0.5039, instance_loss: 0.4334, weighted_loss: 0.4827, label: 0, bag_size: 7177
batch 119, loss: 0.8435, instance_loss: 0.3572, weighted_loss: 0.6976, label: 2, bag_size: 3678
batch 139, loss: 0.2196, instance_loss: 0.2112, weighted_loss: 0.2171, label: 1, bag_size: 1221
batch 159, loss: 1.8728, instance_loss: 1.1831, weighted_loss: 1.6659, label: 1, bag_size: 5873
batch 179, loss: 1.1991, instance_loss: 0.7917, weighted_loss: 1.0769, label: 1, bag_size: 5873
batch 199, loss: 0.1493, instance_loss: 0.2192, weighted_loss: 0.1702, label: 2, bag_size: 3415
batch 219, loss: 0.3971, instance_loss: 0.4688, weighted_loss: 0.4186, label: 0, bag_size: 4922
batch 239, loss: 0.0538, instance_loss: 0.2807, weighted_loss: 0.1218, label: 0, bag_size: 3443
batch 259, loss: 0.3629, instance_loss: 0.3623, weighted_loss: 0.3627, label: 2, bag_size: 3534
batch 279, loss: 0.0270, instance_loss: 0.5206, weighted_loss: 0.1751, label: 1, bag_size: 4578
batch 299, loss: 0.0909, instance_loss: 0.5029, weighted_loss: 0.2145, label: 0, bag_size: 5585
batch 319, loss: 0.0390, instance_loss: 0.1287, weighted_loss: 0.0659, label: 2, bag_size: 4856
batch 339, loss: 0.3620, instance_loss: 0.3051, weighted_loss: 0.3449, label: 0, bag_size: 4292
batch 359, loss: 0.0723, instance_loss: 0.1784, weighted_loss: 0.1041, label: 2, bag_size: 2770
batch 379, loss: 0.0333, instance_loss: 0.2517, weighted_loss: 0.0988, label: 0, bag_size: 1006
batch 399, loss: 0.4408, instance_loss: 0.9421, weighted_loss: 0.5912, label: 1, bag_size: 6817
batch 419, loss: 0.6965, instance_loss: 0.7989, weighted_loss: 0.7272, label: 0, bag_size: 2153
batch 439, loss: 0.1175, instance_loss: 0.5693, weighted_loss: 0.2531, label: 2, bag_size: 4535
batch 459, loss: 0.6822, instance_loss: 1.0074, weighted_loss: 0.7798, label: 1, bag_size: 6152
batch 479, loss: 0.0507, instance_loss: 0.4088, weighted_loss: 0.1581, label: 1, bag_size: 4027
batch 499, loss: 1.2482, instance_loss: 0.7538, weighted_loss: 1.0999, label: 2, bag_size: 5307
batch 519, loss: 0.0321, instance_loss: 0.0753, weighted_loss: 0.0450, label: 2, bag_size: 3415
batch 539, loss: 0.0424, instance_loss: 0.0929, weighted_loss: 0.0575, label: 0, bag_size: 2019
batch 559, loss: 0.7329, instance_loss: 0.4851, weighted_loss: 0.6585, label: 2, bag_size: 705
batch 579, loss: 0.1132, instance_loss: 0.0891, weighted_loss: 0.1060, label: 2, bag_size: 2561
batch 599, loss: 0.2279, instance_loss: 0.6083, weighted_loss: 0.3420, label: 2, bag_size: 4910
batch 619, loss: 1.2670, instance_loss: 1.5792, weighted_loss: 1.3607, label: 1, bag_size: 2927
batch 639, loss: 0.4847, instance_loss: 0.5680, weighted_loss: 0.5097, label: 1, bag_size: 667
batch 659, loss: 0.1404, instance_loss: 0.4954, weighted_loss: 0.2469, label: 1, bag_size: 4940
batch 679, loss: 0.0000, instance_loss: 0.0875, weighted_loss: 0.0262, label: 0, bag_size: 3445
batch 699, loss: 0.2430, instance_loss: 0.4949, weighted_loss: 0.3186, label: 0, bag_size: 4479
batch 719, loss: 0.2350, instance_loss: 0.3091, weighted_loss: 0.2572, label: 0, bag_size: 2378
batch 739, loss: 1.1500, instance_loss: 0.8925, weighted_loss: 1.0728, label: 2, bag_size: 5743


class 0 clustering acc 0.9662192393736018: correct 17276/17880
class 1 clustering acc 0.41124161073825505: correct 2451/5960
Epoch: 43, train_loss: 0.4862, train_clustering_loss:  0.5195, train_error: 0.2081
class 0: acc 0.804, correct 201/250
class 1: acc 0.7096774193548387, correct 176/248
class 2: acc 0.8623481781376519, correct 213/247

Val Set, val_loss: 0.5432, val_error: 0.2660, auc: 0.9140
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.3949468085106383: correct 297/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.593877 --> 0.543172).  Saving model ...


batch 19, loss: 0.8101, instance_loss: 0.6294, weighted_loss: 0.7559, label: 1, bag_size: 4708
batch 39, loss: 1.0513, instance_loss: 1.1378, weighted_loss: 1.0772, label: 0, bag_size: 1795
batch 59, loss: 0.3579, instance_loss: 0.9616, weighted_loss: 0.5390, label: 1, bag_size: 4940
batch 79, loss: 2.6129, instance_loss: 1.3518, weighted_loss: 2.2346, label: 0, bag_size: 421
batch 99, loss: 0.1798, instance_loss: 0.1979, weighted_loss: 0.1852, label: 2, bag_size: 2359
batch 119, loss: 0.0265, instance_loss: 0.4906, weighted_loss: 0.1657, label: 1, bag_size: 3221
batch 139, loss: 0.0068, instance_loss: 0.1116, weighted_loss: 0.0383, label: 0, bag_size: 1034
batch 159, loss: 0.4060, instance_loss: 0.4185, weighted_loss: 0.4097, label: 2, bag_size: 7607
batch 179, loss: 0.0971, instance_loss: 0.2165, weighted_loss: 0.1329, label: 0, bag_size: 4251
batch 199, loss: 0.2323, instance_loss: 0.8686, weighted_loss: 0.4232, label: 2, bag_size: 22464
batch 219, loss: 0.0207, instance_loss: 0.5505, weighted_loss: 0.1796, label: 1, bag_size: 3437
batch 239, loss: 0.1105, instance_loss: 0.2441, weighted_loss: 0.1506, label: 0, bag_size: 5041
batch 259, loss: 0.2642, instance_loss: 0.7271, weighted_loss: 0.4031, label: 1, bag_size: 6717
batch 279, loss: 0.1854, instance_loss: 0.3810, weighted_loss: 0.2440, label: 0, bag_size: 3797
batch 299, loss: 0.4362, instance_loss: 0.3920, weighted_loss: 0.4229, label: 0, bag_size: 3571
batch 319, loss: 0.0037, instance_loss: 0.1199, weighted_loss: 0.0386, label: 1, bag_size: 3425
batch 339, loss: 3.4138, instance_loss: 1.8169, weighted_loss: 2.9347, label: 1, bag_size: 3159
batch 359, loss: 0.0106, instance_loss: 0.1590, weighted_loss: 0.0551, label: 1, bag_size: 3983
batch 379, loss: 0.8086, instance_loss: 0.7679, weighted_loss: 0.7964, label: 2, bag_size: 6298
batch 399, loss: 0.0104, instance_loss: 0.4415, weighted_loss: 0.1398, label: 1, bag_size: 3051
batch 419, loss: 0.7246, instance_loss: 0.4815, weighted_loss: 0.6517, label: 2, bag_size: 5406
batch 439, loss: 0.4145, instance_loss: 0.6352, weighted_loss: 0.4807, label: 1, bag_size: 3619
batch 459, loss: 0.3324, instance_loss: 0.4742, weighted_loss: 0.3749, label: 0, bag_size: 7177
batch 479, loss: 1.5932, instance_loss: 0.9202, weighted_loss: 1.3913, label: 1, bag_size: 3791
batch 499, loss: 0.1518, instance_loss: 0.2753, weighted_loss: 0.1889, label: 2, bag_size: 4775
batch 519, loss: 0.3850, instance_loss: 0.8420, weighted_loss: 0.5221, label: 1, bag_size: 3596
batch 539, loss: 0.3326, instance_loss: 0.5793, weighted_loss: 0.4066, label: 2, bag_size: 4342
batch 559, loss: 0.0005, instance_loss: 0.1035, weighted_loss: 0.0314, label: 1, bag_size: 4067
batch 579, loss: 0.0801, instance_loss: 0.4614, weighted_loss: 0.1945, label: 1, bag_size: 3127
batch 599, loss: 0.0375, instance_loss: 0.1261, weighted_loss: 0.0641, label: 2, bag_size: 4745
batch 619, loss: 0.7100, instance_loss: 0.7121, weighted_loss: 0.7106, label: 1, bag_size: 3813
batch 639, loss: 1.5511, instance_loss: 1.5234, weighted_loss: 1.5427, label: 1, bag_size: 3995
batch 659, loss: 0.3511, instance_loss: 0.4262, weighted_loss: 0.3736, label: 0, bag_size: 4711
batch 679, loss: 0.0382, instance_loss: 0.3727, weighted_loss: 0.1386, label: 1, bag_size: 5003
batch 699, loss: 0.1534, instance_loss: 0.2387, weighted_loss: 0.1790, label: 0, bag_size: 3475
batch 719, loss: 0.1222, instance_loss: 0.3041, weighted_loss: 0.1768, label: 0, bag_size: 673
batch 739, loss: 0.0464, instance_loss: 0.5185, weighted_loss: 0.1880, label: 1, bag_size: 2809


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.3946308724832215: correct 2352/5960
Epoch: 44, train_loss: 0.5164, train_clustering_loss:  0.5321, train_error: 0.2121
class 0: acc 0.8151260504201681, correct 194/238
class 1: acc 0.6968503937007874, correct 177/254
class 2: acc 0.8537549407114624, correct 216/253

Val Set, val_loss: 0.7008, val_error: 0.3191, auc: 0.9114
class 0 clustering acc 0.9507978723404256: correct 2145/2256
class 1 clustering acc 0.425531914893617: correct 320/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1279, instance_loss: 0.2276, weighted_loss: 0.1578, label: 2, bag_size: 2359
batch 39, loss: 0.6660, instance_loss: 0.4937, weighted_loss: 0.6143, label: 1, bag_size: 3786
batch 59, loss: 0.1646, instance_loss: 0.2199, weighted_loss: 0.1812, label: 2, bag_size: 4302
batch 79, loss: 0.0071, instance_loss: 0.2613, weighted_loss: 0.0834, label: 1, bag_size: 10941
batch 99, loss: 0.4211, instance_loss: 0.5068, weighted_loss: 0.4468, label: 2, bag_size: 5406
batch 119, loss: 0.4348, instance_loss: 0.3972, weighted_loss: 0.4235, label: 0, bag_size: 4310
batch 139, loss: 0.0514, instance_loss: 0.2316, weighted_loss: 0.1054, label: 0, bag_size: 3871
batch 159, loss: 1.7439, instance_loss: 1.1548, weighted_loss: 1.5672, label: 1, bag_size: 1045
batch 179, loss: 0.3687, instance_loss: 1.0316, weighted_loss: 0.5676, label: 0, bag_size: 1808
batch 199, loss: 0.2215, instance_loss: 0.6120, weighted_loss: 0.3387, label: 2, bag_size: 4535
batch 219, loss: 0.0006, instance_loss: 0.0888, weighted_loss: 0.0271, label: 1, bag_size: 7279
batch 239, loss: 0.3775, instance_loss: 0.7073, weighted_loss: 0.4764, label: 0, bag_size: 2189
batch 259, loss: 0.3204, instance_loss: 0.5595, weighted_loss: 0.3921, label: 1, bag_size: 14449
batch 279, loss: 0.0734, instance_loss: 0.3854, weighted_loss: 0.1670, label: 1, bag_size: 10399
batch 299, loss: 0.1235, instance_loss: 0.2149, weighted_loss: 0.1509, label: 0, bag_size: 4332
batch 319, loss: 0.3305, instance_loss: 0.3159, weighted_loss: 0.3261, label: 1, bag_size: 800
batch 339, loss: 0.0000, instance_loss: 0.0358, weighted_loss: 0.0108, label: 0, bag_size: 3920
batch 359, loss: 0.0001, instance_loss: 0.1621, weighted_loss: 0.0487, label: 1, bag_size: 6277
batch 379, loss: 0.4972, instance_loss: 0.3938, weighted_loss: 0.4662, label: 1, bag_size: 1029
batch 399, loss: 0.9061, instance_loss: 0.8375, weighted_loss: 0.8855, label: 1, bag_size: 2751
batch 419, loss: 0.3676, instance_loss: 0.3187, weighted_loss: 0.3530, label: 2, bag_size: 3546
batch 439, loss: 0.0015, instance_loss: 0.1225, weighted_loss: 0.0378, label: 1, bag_size: 5086
batch 459, loss: 0.2794, instance_loss: 0.4874, weighted_loss: 0.3418, label: 1, bag_size: 3935
batch 479, loss: 0.6374, instance_loss: 1.1660, weighted_loss: 0.7960, label: 1, bag_size: 3596
batch 499, loss: 0.3230, instance_loss: 0.3838, weighted_loss: 0.3412, label: 1, bag_size: 1029
batch 519, loss: 0.1907, instance_loss: 0.3166, weighted_loss: 0.2285, label: 0, bag_size: 5340
batch 539, loss: 0.0190, instance_loss: 0.0797, weighted_loss: 0.0372, label: 2, bag_size: 4056
batch 559, loss: 0.0006, instance_loss: 1.2102, weighted_loss: 0.3635, label: 0, bag_size: 1981
batch 579, loss: 2.8424, instance_loss: 1.5158, weighted_loss: 2.4444, label: 1, bag_size: 1371
batch 599, loss: 0.2680, instance_loss: 0.4769, weighted_loss: 0.3307, label: 2, bag_size: 4535
batch 619, loss: 2.7715, instance_loss: 0.7651, weighted_loss: 2.1696, label: 0, bag_size: 4719
batch 639, loss: 0.2265, instance_loss: 0.2870, weighted_loss: 0.2447, label: 2, bag_size: 4056
batch 659, loss: 0.0187, instance_loss: 0.2452, weighted_loss: 0.0867, label: 0, bag_size: 1647
batch 679, loss: 0.4557, instance_loss: 0.7481, weighted_loss: 0.5434, label: 1, bag_size: 1066
batch 699, loss: 0.0708, instance_loss: 0.3031, weighted_loss: 0.1405, label: 1, bag_size: 3126
batch 719, loss: 0.5064, instance_loss: 0.8364, weighted_loss: 0.6054, label: 2, bag_size: 5472
batch 739, loss: 0.2294, instance_loss: 1.0510, weighted_loss: 0.4759, label: 0, bag_size: 1782


class 0 clustering acc 0.96582774049217: correct 17269/17880
class 1 clustering acc 0.46996644295302015: correct 2801/5960
Epoch: 45, train_loss: 0.4508, train_clustering_loss:  0.4841, train_error: 0.1906
class 0: acc 0.8352941176470589, correct 213/255
class 1: acc 0.7315175097276264, correct 188/257
class 2: acc 0.8669527896995708, correct 202/233

Val Set, val_loss: 0.7103, val_error: 0.3085, auc: 0.8941
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.3776595744680851: correct 284/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3700, instance_loss: 0.5431, weighted_loss: 0.4219, label: 2, bag_size: 4487
batch 39, loss: 0.0000, instance_loss: 0.8740, weighted_loss: 0.2622, label: 0, bag_size: 1055
batch 59, loss: 0.6658, instance_loss: 0.5615, weighted_loss: 0.6345, label: 0, bag_size: 1543
batch 79, loss: 0.7785, instance_loss: 0.5482, weighted_loss: 0.7094, label: 2, bag_size: 4241
batch 99, loss: 0.4562, instance_loss: 0.7966, weighted_loss: 0.5583, label: 2, bag_size: 4316
batch 119, loss: 0.0872, instance_loss: 0.4902, weighted_loss: 0.2081, label: 2, bag_size: 5472
batch 139, loss: 0.8641, instance_loss: 0.9067, weighted_loss: 0.8769, label: 2, bag_size: 2813
batch 159, loss: 0.7083, instance_loss: 0.9859, weighted_loss: 0.7916, label: 1, bag_size: 5011
batch 179, loss: 0.2633, instance_loss: 0.4549, weighted_loss: 0.3208, label: 2, bag_size: 4535
batch 199, loss: 0.0188, instance_loss: 0.4265, weighted_loss: 0.1411, label: 0, bag_size: 2853
batch 219, loss: 0.7231, instance_loss: 0.8315, weighted_loss: 0.7556, label: 2, bag_size: 728
batch 239, loss: 0.4390, instance_loss: 0.4397, weighted_loss: 0.4392, label: 0, bag_size: 2830
batch 259, loss: 1.1350, instance_loss: 1.2476, weighted_loss: 1.1688, label: 1, bag_size: 1371
batch 279, loss: 0.0440, instance_loss: 0.3136, weighted_loss: 0.1249, label: 1, bag_size: 2809
batch 299, loss: 0.0290, instance_loss: 0.0822, weighted_loss: 0.0449, label: 2, bag_size: 4856
batch 319, loss: 0.0294, instance_loss: 0.2062, weighted_loss: 0.0824, label: 0, bag_size: 2756
batch 339, loss: 0.1448, instance_loss: 0.2528, weighted_loss: 0.1772, label: 0, bag_size: 1385
batch 359, loss: 0.6062, instance_loss: 0.7476, weighted_loss: 0.6486, label: 1, bag_size: 4812
batch 379, loss: 1.5184, instance_loss: 1.0950, weighted_loss: 1.3914, label: 1, bag_size: 5205
batch 399, loss: 0.4859, instance_loss: 0.3926, weighted_loss: 0.4579, label: 2, bag_size: 6298
batch 419, loss: 0.1924, instance_loss: 0.2452, weighted_loss: 0.2082, label: 2, bag_size: 3327
batch 439, loss: 0.2215, instance_loss: 0.3464, weighted_loss: 0.2589, label: 0, bag_size: 1049
batch 459, loss: 0.2579, instance_loss: 0.2923, weighted_loss: 0.2682, label: 2, bag_size: 3746
batch 479, loss: 0.0865, instance_loss: 0.5296, weighted_loss: 0.2194, label: 2, bag_size: 4745
batch 499, loss: 1.3952, instance_loss: 0.8156, weighted_loss: 1.2213, label: 0, bag_size: 4921
batch 519, loss: 0.9121, instance_loss: 1.2954, weighted_loss: 1.0271, label: 1, bag_size: 3424
batch 539, loss: 1.2623, instance_loss: 0.7695, weighted_loss: 1.1144, label: 1, bag_size: 2865
batch 559, loss: 0.0289, instance_loss: 0.0889, weighted_loss: 0.0469, label: 2, bag_size: 4856
batch 579, loss: 0.3898, instance_loss: 0.5490, weighted_loss: 0.4376, label: 1, bag_size: 4184
batch 599, loss: 0.6106, instance_loss: 0.8824, weighted_loss: 0.6921, label: 2, bag_size: 4571
batch 619, loss: 0.0142, instance_loss: 0.4882, weighted_loss: 0.1564, label: 1, bag_size: 3437
batch 639, loss: 0.0129, instance_loss: 0.3146, weighted_loss: 0.1034, label: 1, bag_size: 7279
batch 659, loss: 0.1336, instance_loss: 0.3238, weighted_loss: 0.1907, label: 1, bag_size: 4595
batch 679, loss: 0.2183, instance_loss: 0.4109, weighted_loss: 0.2761, label: 1, bag_size: 3050
batch 699, loss: 2.3383, instance_loss: 1.3982, weighted_loss: 2.0563, label: 1, bag_size: 2229
batch 719, loss: 0.2734, instance_loss: 0.2879, weighted_loss: 0.2777, label: 2, bag_size: 3176
batch 739, loss: 0.0002, instance_loss: 1.2999, weighted_loss: 0.3901, label: 0, bag_size: 1814


class 0 clustering acc 0.9685682326621924: correct 17318/17880
class 1 clustering acc 0.4248322147651007: correct 2532/5960
Epoch: 46, train_loss: 0.4802, train_clustering_loss:  0.5124, train_error: 0.1973
class 0: acc 0.8163265306122449, correct 200/245
class 1: acc 0.7235772357723578, correct 178/246
class 2: acc 0.8661417322834646, correct 220/254

Val Set, val_loss: 0.7241, val_error: 0.2766, auc: 0.9111
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.34441489361702127: correct 259/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1831, instance_loss: 0.2203, weighted_loss: 0.1942, label: 2, bag_size: 2501
batch 39, loss: 0.9477, instance_loss: 0.8232, weighted_loss: 0.9103, label: 0, bag_size: 2915
batch 59, loss: 0.0000, instance_loss: 0.0759, weighted_loss: 0.0228, label: 0, bag_size: 6182
batch 79, loss: 0.0137, instance_loss: 0.2876, weighted_loss: 0.0959, label: 0, bag_size: 2607
batch 99, loss: 0.0621, instance_loss: 0.1433, weighted_loss: 0.0865, label: 0, bag_size: 3406
batch 119, loss: 0.2783, instance_loss: 0.6619, weighted_loss: 0.3934, label: 1, bag_size: 1549
batch 139, loss: 0.7401, instance_loss: 0.7589, weighted_loss: 0.7457, label: 1, bag_size: 2013
batch 159, loss: 1.0572, instance_loss: 0.8373, weighted_loss: 0.9913, label: 0, bag_size: 5867
batch 179, loss: 0.5101, instance_loss: 0.7080, weighted_loss: 0.5695, label: 0, bag_size: 313
batch 199, loss: 0.9062, instance_loss: 0.7422, weighted_loss: 0.8570, label: 2, bag_size: 1222
batch 219, loss: 1.0759, instance_loss: 0.9571, weighted_loss: 1.0403, label: 2, bag_size: 7607
batch 239, loss: 0.7409, instance_loss: 0.6261, weighted_loss: 0.7065, label: 0, bag_size: 4146
batch 259, loss: 0.0545, instance_loss: 0.1485, weighted_loss: 0.0827, label: 2, bag_size: 3026
batch 279, loss: 0.5274, instance_loss: 0.6097, weighted_loss: 0.5521, label: 0, bag_size: 4719
batch 299, loss: 0.1049, instance_loss: 0.6091, weighted_loss: 0.2562, label: 1, bag_size: 2472
batch 319, loss: 0.7711, instance_loss: 0.6300, weighted_loss: 0.7288, label: 1, bag_size: 5718
batch 339, loss: 0.0000, instance_loss: 0.1840, weighted_loss: 0.0552, label: 2, bag_size: 3607
batch 359, loss: 1.5913, instance_loss: 0.9853, weighted_loss: 1.4095, label: 1, bag_size: 4806
batch 379, loss: 0.1988, instance_loss: 0.5259, weighted_loss: 0.2969, label: 1, bag_size: 2731
batch 399, loss: 0.8442, instance_loss: 0.7044, weighted_loss: 0.8022, label: 1, bag_size: 5072
batch 419, loss: 0.1177, instance_loss: 0.1866, weighted_loss: 0.1384, label: 0, bag_size: 3376
batch 439, loss: 0.2714, instance_loss: 0.5238, weighted_loss: 0.3471, label: 0, bag_size: 3833
batch 459, loss: 0.6168, instance_loss: 0.4077, weighted_loss: 0.5541, label: 2, bag_size: 705
batch 479, loss: 0.3565, instance_loss: 0.5592, weighted_loss: 0.4173, label: 1, bag_size: 5756
batch 499, loss: 0.0233, instance_loss: 0.1521, weighted_loss: 0.0620, label: 0, bag_size: 2756
batch 519, loss: 0.3881, instance_loss: 0.4720, weighted_loss: 0.4133, label: 1, bag_size: 1029
batch 539, loss: 0.1420, instance_loss: 0.2843, weighted_loss: 0.1847, label: 2, bag_size: 4788
batch 559, loss: 0.3230, instance_loss: 0.4643, weighted_loss: 0.3654, label: 1, bag_size: 3604
batch 579, loss: 0.0530, instance_loss: 0.2485, weighted_loss: 0.1117, label: 0, bag_size: 3864
batch 599, loss: 0.5649, instance_loss: 0.6415, weighted_loss: 0.5878, label: 0, bag_size: 5259
batch 619, loss: 0.1812, instance_loss: 0.6741, weighted_loss: 0.3291, label: 1, bag_size: 5195
batch 639, loss: 0.1450, instance_loss: 0.6338, weighted_loss: 0.2916, label: 2, bag_size: 4571
batch 659, loss: 0.1670, instance_loss: 0.3701, weighted_loss: 0.2279, label: 0, bag_size: 4325
batch 679, loss: 0.0612, instance_loss: 0.1881, weighted_loss: 0.0992, label: 2, bag_size: 4569
batch 699, loss: 1.1685, instance_loss: 1.0020, weighted_loss: 1.1185, label: 0, bag_size: 1071
batch 719, loss: 0.3968, instance_loss: 0.4922, weighted_loss: 0.4254, label: 1, bag_size: 3396
batch 739, loss: 0.1548, instance_loss: 0.3077, weighted_loss: 0.2006, label: 2, bag_size: 5037


class 0 clustering acc 0.9657158836689038: correct 17267/17880
class 1 clustering acc 0.4008389261744966: correct 2389/5960
Epoch: 47, train_loss: 0.5223, train_clustering_loss:  0.5369, train_error: 0.2228
class 0: acc 0.8097014925373134, correct 217/268
class 1: acc 0.679324894514768, correct 161/237
class 2: acc 0.8375, correct 201/240

Val Set, val_loss: 0.7360, val_error: 0.2872, auc: 0.8708
class 0 clustering acc 0.9525709219858156: correct 2149/2256
class 1 clustering acc 0.39893617021276595: correct 300/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0370, instance_loss: 0.2434, weighted_loss: 0.0989, label: 2, bag_size: 614
batch 39, loss: 0.9731, instance_loss: 0.4251, weighted_loss: 0.8087, label: 1, bag_size: 6993
batch 59, loss: 0.3495, instance_loss: 0.3308, weighted_loss: 0.3439, label: 1, bag_size: 2905
batch 79, loss: 0.0002, instance_loss: 0.2121, weighted_loss: 0.0637, label: 1, bag_size: 5462
batch 99, loss: 0.9721, instance_loss: 0.6510, weighted_loss: 0.8758, label: 0, bag_size: 1543
batch 119, loss: 0.0314, instance_loss: 0.3231, weighted_loss: 0.1189, label: 0, bag_size: 3297
batch 139, loss: 0.0327, instance_loss: 0.2339, weighted_loss: 0.0930, label: 0, bag_size: 855
batch 159, loss: 0.2068, instance_loss: 0.3912, weighted_loss: 0.2621, label: 0, bag_size: 6223
batch 179, loss: 0.1620, instance_loss: 0.2665, weighted_loss: 0.1933, label: 2, bag_size: 3327
batch 199, loss: 0.0370, instance_loss: 0.1235, weighted_loss: 0.0630, label: 2, bag_size: 5138
batch 219, loss: 0.0426, instance_loss: 0.2129, weighted_loss: 0.0937, label: 0, bag_size: 4678
batch 239, loss: 3.3744, instance_loss: 1.2356, weighted_loss: 2.7327, label: 0, bag_size: 603
batch 259, loss: 0.1573, instance_loss: 0.2604, weighted_loss: 0.1883, label: 2, bag_size: 3396
batch 279, loss: 0.5253, instance_loss: 0.5143, weighted_loss: 0.5220, label: 2, bag_size: 552
batch 299, loss: 0.9996, instance_loss: 0.7309, weighted_loss: 0.9190, label: 1, bag_size: 6165
batch 319, loss: 0.8208, instance_loss: 0.7021, weighted_loss: 0.7852, label: 1, bag_size: 5197
batch 339, loss: 1.7056, instance_loss: 1.1394, weighted_loss: 1.5358, label: 0, bag_size: 15388
batch 359, loss: 0.0428, instance_loss: 0.2434, weighted_loss: 0.1030, label: 0, bag_size: 4894
batch 379, loss: 0.1542, instance_loss: 0.9868, weighted_loss: 0.4040, label: 0, bag_size: 2232
batch 399, loss: 0.0135, instance_loss: 0.1471, weighted_loss: 0.0535, label: 1, bag_size: 3007
batch 419, loss: 1.5024, instance_loss: 1.2498, weighted_loss: 1.4267, label: 0, bag_size: 1755
batch 439, loss: 0.5969, instance_loss: 0.8298, weighted_loss: 0.6667, label: 1, bag_size: 1023
batch 459, loss: 0.0272, instance_loss: 0.1501, weighted_loss: 0.0641, label: 0, bag_size: 2610
batch 479, loss: 0.0658, instance_loss: 0.2070, weighted_loss: 0.1082, label: 1, bag_size: 2092
batch 499, loss: 0.0062, instance_loss: 0.0569, weighted_loss: 0.0214, label: 2, bag_size: 3285
batch 519, loss: 0.1197, instance_loss: 0.2218, weighted_loss: 0.1504, label: 2, bag_size: 6644
batch 539, loss: 0.9482, instance_loss: 0.9853, weighted_loss: 0.9593, label: 1, bag_size: 1307
batch 559, loss: 2.9090, instance_loss: 1.3878, weighted_loss: 2.4526, label: 1, bag_size: 2727
batch 579, loss: 0.4700, instance_loss: 0.5995, weighted_loss: 0.5089, label: 2, bag_size: 1222
batch 599, loss: 0.1209, instance_loss: 0.2065, weighted_loss: 0.1466, label: 2, bag_size: 5924
batch 619, loss: 0.1386, instance_loss: 0.3693, weighted_loss: 0.2078, label: 1, bag_size: 4898
batch 639, loss: 0.0335, instance_loss: 0.1183, weighted_loss: 0.0589, label: 2, bag_size: 4691
batch 659, loss: 0.0123, instance_loss: 0.1845, weighted_loss: 0.0640, label: 1, bag_size: 460
batch 679, loss: 0.5121, instance_loss: 0.4873, weighted_loss: 0.5047, label: 1, bag_size: 800
batch 699, loss: 0.4989, instance_loss: 0.4452, weighted_loss: 0.4828, label: 1, bag_size: 800
batch 719, loss: 0.0143, instance_loss: 0.0925, weighted_loss: 0.0378, label: 2, bag_size: 3497
batch 739, loss: 0.1835, instance_loss: 0.6088, weighted_loss: 0.3111, label: 1, bag_size: 2859


class 0 clustering acc 0.9620246085011186: correct 17201/17880
class 1 clustering acc 0.44345637583892616: correct 2643/5960
Epoch: 48, train_loss: 0.5092, train_clustering_loss:  0.5166, train_error: 0.2148
class 0: acc 0.7984496124031008, correct 206/258
class 1: acc 0.6848739495798319, correct 163/238
class 2: acc 0.8674698795180723, correct 216/249

Val Set, val_loss: 0.6199, val_error: 0.2553, auc: 0.9036
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.3617021276595745: correct 272/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2793, instance_loss: 0.2576, weighted_loss: 0.2728, label: 2, bag_size: 614
batch 39, loss: 0.9492, instance_loss: 0.6470, weighted_loss: 0.8586, label: 0, bag_size: 14432
batch 59, loss: 2.3873, instance_loss: 1.3480, weighted_loss: 2.0755, label: 2, bag_size: 4241
batch 79, loss: 0.1241, instance_loss: 0.2009, weighted_loss: 0.1471, label: 2, bag_size: 3210
batch 99, loss: 0.0946, instance_loss: 0.3545, weighted_loss: 0.1726, label: 2, bag_size: 4978
batch 119, loss: 0.0125, instance_loss: 0.5272, weighted_loss: 0.1669, label: 1, bag_size: 455
batch 139, loss: 1.1850, instance_loss: 1.0828, weighted_loss: 1.1544, label: 1, bag_size: 5197
batch 159, loss: 0.0005, instance_loss: 0.9745, weighted_loss: 0.2927, label: 0, bag_size: 2231
batch 179, loss: 0.1224, instance_loss: 0.3100, weighted_loss: 0.1787, label: 1, bag_size: 2254
batch 199, loss: 0.0169, instance_loss: 0.1091, weighted_loss: 0.0446, label: 2, bag_size: 3121
batch 219, loss: 0.4770, instance_loss: 0.3357, weighted_loss: 0.4346, label: 1, bag_size: 11768
batch 239, loss: 0.0593, instance_loss: 0.1311, weighted_loss: 0.0808, label: 2, bag_size: 3094
batch 259, loss: 1.4780, instance_loss: 1.1521, weighted_loss: 1.3802, label: 0, bag_size: 4146
batch 279, loss: 0.0118, instance_loss: 0.4830, weighted_loss: 0.1531, label: 0, bag_size: 2826
batch 299, loss: 1.0644, instance_loss: 1.0614, weighted_loss: 1.0635, label: 2, bag_size: 4316
batch 319, loss: 0.0257, instance_loss: 0.1308, weighted_loss: 0.0572, label: 2, bag_size: 3678
batch 339, loss: 0.7711, instance_loss: 0.7319, weighted_loss: 0.7593, label: 1, bag_size: 2671
batch 359, loss: 0.0098, instance_loss: 0.1765, weighted_loss: 0.0598, label: 0, bag_size: 3182
batch 379, loss: 0.0327, instance_loss: 0.5027, weighted_loss: 0.1737, label: 1, bag_size: 314
batch 399, loss: 0.1790, instance_loss: 0.4397, weighted_loss: 0.2572, label: 2, bag_size: 4162
batch 419, loss: 0.1757, instance_loss: 0.1761, weighted_loss: 0.1758, label: 2, bag_size: 3534
batch 439, loss: 2.0909, instance_loss: 1.4293, weighted_loss: 1.8924, label: 1, bag_size: 6817
batch 459, loss: 0.0133, instance_loss: 0.2567, weighted_loss: 0.0864, label: 1, bag_size: 5385
batch 479, loss: 0.1689, instance_loss: 0.2765, weighted_loss: 0.2012, label: 2, bag_size: 2561
batch 499, loss: 0.6355, instance_loss: 0.8134, weighted_loss: 0.6889, label: 0, bag_size: 3155
batch 519, loss: 0.0359, instance_loss: 0.3605, weighted_loss: 0.1333, label: 2, bag_size: 4497
batch 539, loss: 1.0641, instance_loss: 0.8467, weighted_loss: 0.9989, label: 1, bag_size: 1122
batch 559, loss: 2.4402, instance_loss: 1.1683, weighted_loss: 2.0586, label: 1, bag_size: 2425
batch 579, loss: 0.8405, instance_loss: 0.9899, weighted_loss: 0.8853, label: 2, bag_size: 3475
batch 599, loss: 0.0424, instance_loss: 0.2351, weighted_loss: 0.1002, label: 0, bag_size: 1097
batch 619, loss: 0.3795, instance_loss: 0.4206, weighted_loss: 0.3918, label: 2, bag_size: 5472
batch 639, loss: 0.0009, instance_loss: 0.7561, weighted_loss: 0.2275, label: 0, bag_size: 1645
batch 659, loss: 0.3344, instance_loss: 0.3416, weighted_loss: 0.3366, label: 1, bag_size: 3109
batch 679, loss: 0.8316, instance_loss: 0.6541, weighted_loss: 0.7783, label: 0, bag_size: 7219
batch 699, loss: 0.3157, instance_loss: 0.3473, weighted_loss: 0.3252, label: 2, bag_size: 3176
batch 719, loss: 0.0829, instance_loss: 0.2790, weighted_loss: 0.1417, label: 2, bag_size: 4192
batch 739, loss: 0.1016, instance_loss: 0.5315, weighted_loss: 0.2306, label: 1, bag_size: 2013


class 0 clustering acc 0.966834451901566: correct 17287/17880
class 1 clustering acc 0.3932885906040268: correct 2344/5960
Epoch: 49, train_loss: 0.5070, train_clustering_loss:  0.5336, train_error: 0.2188
class 0: acc 0.808, correct 202/250
class 1: acc 0.70703125, correct 181/256
class 2: acc 0.8326359832635983, correct 199/239

Val Set, val_loss: 0.8193, val_error: 0.3298, auc: 0.8929
class 0 clustering acc 0.9552304964539007: correct 2155/2256
class 1 clustering acc 0.26595744680851063: correct 200/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6730, instance_loss: 1.1004, weighted_loss: 0.8012, label: 2, bag_size: 4571
batch 39, loss: 0.1999, instance_loss: 0.6937, weighted_loss: 0.3481, label: 0, bag_size: 3752
batch 59, loss: 1.9853, instance_loss: 1.2017, weighted_loss: 1.7502, label: 0, bag_size: 3419
batch 79, loss: 0.0143, instance_loss: 0.3126, weighted_loss: 0.1038, label: 0, bag_size: 5170
batch 99, loss: 0.1609, instance_loss: 0.2469, weighted_loss: 0.1867, label: 2, bag_size: 614
batch 119, loss: 0.1663, instance_loss: 0.4016, weighted_loss: 0.2369, label: 0, bag_size: 3532
batch 139, loss: 0.1563, instance_loss: 0.2750, weighted_loss: 0.1919, label: 2, bag_size: 2501
batch 159, loss: 0.0942, instance_loss: 0.2034, weighted_loss: 0.1270, label: 2, bag_size: 3210
batch 179, loss: 0.0420, instance_loss: 0.2903, weighted_loss: 0.1165, label: 1, bag_size: 1023
batch 199, loss: 0.2630, instance_loss: 0.3930, weighted_loss: 0.3020, label: 1, bag_size: 1197
batch 219, loss: 1.2110, instance_loss: 0.9513, weighted_loss: 1.1330, label: 2, bag_size: 3299
batch 239, loss: 0.0363, instance_loss: 0.0857, weighted_loss: 0.0511, label: 2, bag_size: 3415
batch 259, loss: 0.6943, instance_loss: 0.9946, weighted_loss: 0.7844, label: 0, bag_size: 5015
batch 279, loss: 0.0001, instance_loss: 0.1468, weighted_loss: 0.0442, label: 0, bag_size: 4403
batch 299, loss: 0.0288, instance_loss: 0.2850, weighted_loss: 0.1056, label: 1, bag_size: 3471
batch 319, loss: 0.3313, instance_loss: 0.6533, weighted_loss: 0.4279, label: 1, bag_size: 5512
batch 339, loss: 4.9776, instance_loss: 1.8257, weighted_loss: 4.0320, label: 0, bag_size: 2392
batch 359, loss: 0.1759, instance_loss: 0.2140, weighted_loss: 0.1873, label: 0, bag_size: 4905
batch 379, loss: 0.4509, instance_loss: 0.4849, weighted_loss: 0.4611, label: 2, bag_size: 3534
batch 399, loss: 0.2183, instance_loss: 0.2565, weighted_loss: 0.2298, label: 2, bag_size: 614
batch 419, loss: 0.0370, instance_loss: 0.2120, weighted_loss: 0.0895, label: 2, bag_size: 2770
batch 439, loss: 0.0432, instance_loss: 0.2923, weighted_loss: 0.1179, label: 0, bag_size: 1233
batch 459, loss: 0.1213, instance_loss: 0.5063, weighted_loss: 0.2368, label: 1, bag_size: 3640
batch 479, loss: 0.0807, instance_loss: 0.2134, weighted_loss: 0.1205, label: 2, bag_size: 4302
batch 499, loss: 0.0135, instance_loss: 0.1117, weighted_loss: 0.0430, label: 2, bag_size: 4203
batch 519, loss: 0.6458, instance_loss: 0.6385, weighted_loss: 0.6436, label: 2, bag_size: 552
batch 539, loss: 0.1624, instance_loss: 1.1427, weighted_loss: 0.4565, label: 0, bag_size: 4494
batch 559, loss: 2.7603, instance_loss: 0.8945, weighted_loss: 2.2006, label: 0, bag_size: 4032
batch 579, loss: 0.0007, instance_loss: 0.1434, weighted_loss: 0.0435, label: 1, bag_size: 3338
batch 599, loss: 0.0498, instance_loss: 0.1457, weighted_loss: 0.0785, label: 0, bag_size: 4092
batch 619, loss: 0.1628, instance_loss: 0.2852, weighted_loss: 0.1995, label: 1, bag_size: 2921
batch 639, loss: 0.0454, instance_loss: 0.3279, weighted_loss: 0.1302, label: 1, bag_size: 3051
batch 659, loss: 0.9778, instance_loss: 0.5675, weighted_loss: 0.8547, label: 1, bag_size: 4119
batch 679, loss: 0.0621, instance_loss: 0.1183, weighted_loss: 0.0790, label: 1, bag_size: 596
batch 699, loss: 0.2968, instance_loss: 0.6117, weighted_loss: 0.3913, label: 1, bag_size: 1510
batch 719, loss: 0.1099, instance_loss: 0.2852, weighted_loss: 0.1625, label: 0, bag_size: 614
batch 739, loss: 1.0414, instance_loss: 0.8983, weighted_loss: 0.9985, label: 1, bag_size: 3261


class 0 clustering acc 0.9661073825503356: correct 17274/17880
class 1 clustering acc 0.437751677852349: correct 2609/5960
Epoch: 50, train_loss: 0.4490, train_clustering_loss:  0.5177, train_error: 0.1758
class 0: acc 0.8297872340425532, correct 195/235
class 1: acc 0.7575757575757576, correct 200/264
class 2: acc 0.8902439024390244, correct 219/246

Val Set, val_loss: 1.0018, val_error: 0.3617, auc: 0.8662
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.26728723404255317: correct 201/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.5009, instance_loss: 0.4963, weighted_loss: 1.1995, label: 1, bag_size: 1029
batch 39, loss: 0.7252, instance_loss: 1.0031, weighted_loss: 0.8085, label: 0, bag_size: 7056
batch 59, loss: 0.0998, instance_loss: 0.6406, weighted_loss: 0.2620, label: 2, bag_size: 6594
batch 79, loss: 0.1290, instance_loss: 0.3879, weighted_loss: 0.2067, label: 1, bag_size: 2254
batch 99, loss: 0.2594, instance_loss: 0.4469, weighted_loss: 0.3157, label: 1, bag_size: 1410
batch 119, loss: 0.8794, instance_loss: 1.1086, weighted_loss: 0.9482, label: 1, bag_size: 4940
batch 139, loss: 0.1890, instance_loss: 0.7280, weighted_loss: 0.3507, label: 0, bag_size: 4794
batch 159, loss: 0.1921, instance_loss: 1.0573, weighted_loss: 0.4516, label: 1, bag_size: 2927
batch 179, loss: 4.9658, instance_loss: 1.4398, weighted_loss: 3.9080, label: 0, bag_size: 603
batch 199, loss: 1.0024, instance_loss: 0.4437, weighted_loss: 0.8348, label: 0, bag_size: 6252
batch 219, loss: 0.0631, instance_loss: 0.4857, weighted_loss: 0.1898, label: 0, bag_size: 6927
batch 239, loss: 0.0002, instance_loss: 0.3073, weighted_loss: 0.0923, label: 0, bag_size: 1140
batch 259, loss: 0.0017, instance_loss: 0.1405, weighted_loss: 0.0434, label: 0, bag_size: 4458
batch 279, loss: 1.4355, instance_loss: 0.7598, weighted_loss: 1.2328, label: 2, bag_size: 2561
batch 299, loss: 0.6318, instance_loss: 0.6654, weighted_loss: 0.6419, label: 1, bag_size: 2998
batch 319, loss: 0.3562, instance_loss: 0.4606, weighted_loss: 0.3875, label: 2, bag_size: 4535
batch 339, loss: 0.1639, instance_loss: 0.5229, weighted_loss: 0.2716, label: 0, bag_size: 5377
batch 359, loss: 1.3825, instance_loss: 1.0668, weighted_loss: 1.2878, label: 1, bag_size: 2055
batch 379, loss: 0.1474, instance_loss: 0.3233, weighted_loss: 0.2002, label: 2, bag_size: 88
batch 399, loss: 0.8626, instance_loss: 0.5127, weighted_loss: 0.7576, label: 1, bag_size: 3786
batch 419, loss: 0.7601, instance_loss: 0.8198, weighted_loss: 0.7780, label: 2, bag_size: 1222
batch 439, loss: 0.0535, instance_loss: 0.2196, weighted_loss: 0.1033, label: 0, bag_size: 3793
batch 459, loss: 0.0747, instance_loss: 0.1011, weighted_loss: 0.0827, label: 2, bag_size: 2049
batch 479, loss: 0.0089, instance_loss: 0.5675, weighted_loss: 0.1764, label: 1, bag_size: 3322
batch 499, loss: 1.4607, instance_loss: 0.9501, weighted_loss: 1.3075, label: 0, bag_size: 1753
batch 519, loss: 1.6611, instance_loss: 0.5881, weighted_loss: 1.3392, label: 1, bag_size: 6993
batch 539, loss: 0.0181, instance_loss: 0.1519, weighted_loss: 0.0583, label: 0, bag_size: 1176
batch 559, loss: 0.1827, instance_loss: 0.3250, weighted_loss: 0.2254, label: 0, bag_size: 3690
batch 579, loss: 0.5520, instance_loss: 1.1112, weighted_loss: 0.7198, label: 1, bag_size: 1558
batch 599, loss: 0.0042, instance_loss: 0.2454, weighted_loss: 0.0766, label: 0, bag_size: 3182
batch 619, loss: 1.1738, instance_loss: 0.4275, weighted_loss: 0.9499, label: 0, bag_size: 3661
batch 639, loss: 0.8040, instance_loss: 0.4192, weighted_loss: 0.6885, label: 2, bag_size: 3274
batch 659, loss: 2.9497, instance_loss: 1.0915, weighted_loss: 2.3923, label: 1, bag_size: 1595
batch 679, loss: 0.4680, instance_loss: 1.1048, weighted_loss: 0.6590, label: 2, bag_size: 22464
batch 699, loss: 0.0419, instance_loss: 0.1433, weighted_loss: 0.0723, label: 0, bag_size: 3304
batch 719, loss: 0.0312, instance_loss: 0.1192, weighted_loss: 0.0576, label: 2, bag_size: 5037
batch 739, loss: 0.0080, instance_loss: 0.5502, weighted_loss: 0.1707, label: 1, bag_size: 4644


class 0 clustering acc 0.9689597315436241: correct 17325/17880
class 1 clustering acc 0.40939597315436244: correct 2440/5960
Epoch: 51, train_loss: 0.4812, train_clustering_loss:  0.5180, train_error: 0.2134
class 0: acc 0.8199233716475096, correct 214/261
class 1: acc 0.702928870292887, correct 168/239
class 2: acc 0.8326530612244898, correct 204/245

Val Set, val_loss: 0.5562, val_error: 0.2553, auc: 0.9137
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.4574468085106383: correct 344/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3065, instance_loss: 0.8142, weighted_loss: 0.4588, label: 1, bag_size: 4940
batch 39, loss: 1.0730, instance_loss: 0.8849, weighted_loss: 1.0166, label: 1, bag_size: 2831
batch 59, loss: 0.3136, instance_loss: 0.8027, weighted_loss: 0.4604, label: 2, bag_size: 3299
batch 79, loss: 0.8820, instance_loss: 1.4655, weighted_loss: 1.0570, label: 0, bag_size: 1341
batch 99, loss: 0.1445, instance_loss: 0.3287, weighted_loss: 0.1997, label: 2, bag_size: 6644
batch 119, loss: 2.5593, instance_loss: 1.2784, weighted_loss: 2.1750, label: 0, bag_size: 5017
batch 139, loss: 0.7462, instance_loss: 0.4753, weighted_loss: 0.6649, label: 2, bag_size: 3583
batch 159, loss: 0.1672, instance_loss: 0.2758, weighted_loss: 0.1998, label: 2, bag_size: 5017
batch 179, loss: 0.0711, instance_loss: 0.5451, weighted_loss: 0.2133, label: 0, bag_size: 667
batch 199, loss: 1.5992, instance_loss: 0.7666, weighted_loss: 1.3495, label: 2, bag_size: 909
batch 219, loss: 0.0144, instance_loss: 0.0894, weighted_loss: 0.0369, label: 2, bag_size: 3497
batch 239, loss: 0.2205, instance_loss: 0.5026, weighted_loss: 0.3051, label: 2, bag_size: 4497
batch 259, loss: 0.2787, instance_loss: 0.4012, weighted_loss: 0.3155, label: 2, bag_size: 2501
batch 279, loss: 0.1702, instance_loss: 0.3415, weighted_loss: 0.2215, label: 2, bag_size: 3080
batch 299, loss: 0.0279, instance_loss: 0.1439, weighted_loss: 0.0627, label: 0, bag_size: 7595
batch 319, loss: 1.5260, instance_loss: 1.2255, weighted_loss: 1.4358, label: 2, bag_size: 4342
batch 339, loss: 3.2888, instance_loss: 1.4408, weighted_loss: 2.7344, label: 0, bag_size: 7504
batch 359, loss: 0.1612, instance_loss: 0.2945, weighted_loss: 0.2012, label: 2, bag_size: 5924
batch 379, loss: 1.4765, instance_loss: 0.9209, weighted_loss: 1.3098, label: 2, bag_size: 4487
batch 399, loss: 0.1377, instance_loss: 0.3174, weighted_loss: 0.1916, label: 0, bag_size: 3586
batch 419, loss: 0.0195, instance_loss: 0.1048, weighted_loss: 0.0451, label: 2, bag_size: 4302
batch 439, loss: 0.2577, instance_loss: 0.4733, weighted_loss: 0.3224, label: 2, bag_size: 3080
batch 459, loss: 0.0028, instance_loss: 0.0270, weighted_loss: 0.0101, label: 0, bag_size: 1545
batch 479, loss: 0.0084, instance_loss: 0.0313, weighted_loss: 0.0153, label: 0, bag_size: 4165
batch 499, loss: 1.2911, instance_loss: 0.6238, weighted_loss: 1.0909, label: 0, bag_size: 3797
batch 519, loss: 0.0070, instance_loss: 0.6408, weighted_loss: 0.1971, label: 1, bag_size: 314
batch 539, loss: 0.6106, instance_loss: 0.5917, weighted_loss: 0.6049, label: 2, bag_size: 3778
batch 559, loss: 1.8689, instance_loss: 0.8953, weighted_loss: 1.5768, label: 2, bag_size: 909
batch 579, loss: 0.0715, instance_loss: 0.3379, weighted_loss: 0.1514, label: 0, bag_size: 1234
batch 599, loss: 0.0225, instance_loss: 0.4416, weighted_loss: 0.1483, label: 1, bag_size: 5086
batch 619, loss: 1.3775, instance_loss: 0.9704, weighted_loss: 1.2554, label: 2, bag_size: 909
batch 639, loss: 0.6268, instance_loss: 0.7799, weighted_loss: 0.6727, label: 1, bag_size: 3995
batch 659, loss: 0.3926, instance_loss: 0.7346, weighted_loss: 0.4952, label: 2, bag_size: 2813
batch 679, loss: 0.5493, instance_loss: 0.7737, weighted_loss: 0.6166, label: 0, bag_size: 1352
batch 699, loss: 0.3908, instance_loss: 0.4379, weighted_loss: 0.4050, label: 2, bag_size: 3618
batch 719, loss: 0.0668, instance_loss: 0.1426, weighted_loss: 0.0895, label: 2, bag_size: 3094
batch 739, loss: 0.4875, instance_loss: 0.4729, weighted_loss: 0.4831, label: 0, bag_size: 3701


class 0 clustering acc 0.9645413870246085: correct 17246/17880
class 1 clustering acc 0.4330536912751678: correct 2581/5960
Epoch: 52, train_loss: 0.4907, train_clustering_loss:  0.5152, train_error: 0.1960
class 0: acc 0.7991452991452992, correct 187/234
class 1: acc 0.754863813229572, correct 194/257
class 2: acc 0.8582677165354331, correct 218/254

Val Set, val_loss: 0.6380, val_error: 0.2660, auc: 0.9186
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.2845744680851064: correct 214/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6, correct 18/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0333, instance_loss: 0.2043, weighted_loss: 0.0846, label: 0, bag_size: 6765
batch 39, loss: 0.2873, instance_loss: 0.3075, weighted_loss: 0.2934, label: 2, bag_size: 4162
batch 59, loss: 0.6538, instance_loss: 0.4554, weighted_loss: 0.5943, label: 1, bag_size: 4395
batch 79, loss: 1.6149, instance_loss: 0.7880, weighted_loss: 1.3668, label: 1, bag_size: 3935
batch 99, loss: 0.2146, instance_loss: 0.2355, weighted_loss: 0.2208, label: 1, bag_size: 5340
batch 119, loss: 0.7014, instance_loss: 0.9118, weighted_loss: 0.7645, label: 1, bag_size: 2614
batch 139, loss: 0.0002, instance_loss: 0.0596, weighted_loss: 0.0180, label: 1, bag_size: 4181
batch 159, loss: 0.1023, instance_loss: 0.2380, weighted_loss: 0.1430, label: 2, bag_size: 4162
batch 179, loss: 0.0286, instance_loss: 0.3858, weighted_loss: 0.1358, label: 0, bag_size: 5632
batch 199, loss: 0.2279, instance_loss: 0.4652, weighted_loss: 0.2991, label: 2, bag_size: 3618
batch 219, loss: 0.2799, instance_loss: 0.9443, weighted_loss: 0.4792, label: 2, bag_size: 4910
batch 239, loss: 0.7844, instance_loss: 0.4157, weighted_loss: 0.6738, label: 1, bag_size: 4599
batch 259, loss: 0.7907, instance_loss: 0.4697, weighted_loss: 0.6944, label: 1, bag_size: 4119
batch 279, loss: 0.0000, instance_loss: 0.2535, weighted_loss: 0.0761, label: 1, bag_size: 4067
batch 299, loss: 0.0166, instance_loss: 0.0902, weighted_loss: 0.0386, label: 2, bag_size: 3285
batch 319, loss: 0.6374, instance_loss: 0.5021, weighted_loss: 0.5968, label: 1, bag_size: 3460
batch 339, loss: 0.1671, instance_loss: 0.2056, weighted_loss: 0.1787, label: 0, bag_size: 4228
batch 359, loss: 1.0315, instance_loss: 0.9223, weighted_loss: 0.9988, label: 2, bag_size: 5743
batch 379, loss: 1.1101, instance_loss: 0.7834, weighted_loss: 1.0121, label: 0, bag_size: 1543
batch 399, loss: 0.0001, instance_loss: 0.5586, weighted_loss: 0.1676, label: 1, bag_size: 10399
batch 419, loss: 0.0084, instance_loss: 0.2528, weighted_loss: 0.0817, label: 1, bag_size: 6513
batch 439, loss: 0.0796, instance_loss: 0.2163, weighted_loss: 0.1206, label: 2, bag_size: 3397
batch 459, loss: 0.0565, instance_loss: 0.2779, weighted_loss: 0.1229, label: 0, bag_size: 4644
batch 479, loss: 0.1039, instance_loss: 0.2134, weighted_loss: 0.1368, label: 0, bag_size: 3883
batch 499, loss: 0.0955, instance_loss: 0.1759, weighted_loss: 0.1196, label: 2, bag_size: 4555
batch 519, loss: 0.0015, instance_loss: 0.7641, weighted_loss: 0.2303, label: 1, bag_size: 1542
batch 539, loss: 0.1648, instance_loss: 0.4402, weighted_loss: 0.2474, label: 1, bag_size: 3221
batch 559, loss: 0.4919, instance_loss: 0.4031, weighted_loss: 0.4653, label: 2, bag_size: 705
batch 579, loss: 0.0000, instance_loss: 0.3242, weighted_loss: 0.0973, label: 0, bag_size: 3594
batch 599, loss: 0.2319, instance_loss: 0.6691, weighted_loss: 0.3631, label: 2, bag_size: 5743
batch 619, loss: 0.0157, instance_loss: 0.3689, weighted_loss: 0.1216, label: 1, bag_size: 10941
batch 639, loss: 1.0240, instance_loss: 0.9654, weighted_loss: 1.0064, label: 1, bag_size: 6165
batch 659, loss: 0.0674, instance_loss: 0.1832, weighted_loss: 0.1021, label: 0, bag_size: 4325
batch 679, loss: 0.0121, instance_loss: 0.0930, weighted_loss: 0.0363, label: 2, bag_size: 5138
batch 699, loss: 0.4440, instance_loss: 0.7827, weighted_loss: 0.5456, label: 1, bag_size: 6152
batch 719, loss: 0.2283, instance_loss: 0.5689, weighted_loss: 0.3305, label: 2, bag_size: 5037
batch 739, loss: 0.0054, instance_loss: 0.3314, weighted_loss: 0.1032, label: 0, bag_size: 3219


class 0 clustering acc 0.9681208053691275: correct 17310/17880
class 1 clustering acc 0.44798657718120805: correct 2670/5960
Epoch: 53, train_loss: 0.4369, train_clustering_loss:  0.4936, train_error: 0.1893
class 0: acc 0.8067226890756303, correct 192/238
class 1: acc 0.7366412213740458, correct 193/262
class 2: acc 0.8938775510204081, correct 219/245

Val Set, val_loss: 0.6945, val_error: 0.2660, auc: 0.9031
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.3337765957446808: correct 251/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0345, instance_loss: 0.1326, weighted_loss: 0.0640, label: 2, bag_size: 3094
batch 39, loss: 0.4161, instance_loss: 0.4017, weighted_loss: 0.4118, label: 2, bag_size: 5406
batch 59, loss: 1.1572, instance_loss: 0.8522, weighted_loss: 1.0657, label: 1, bag_size: 1854
batch 79, loss: 0.1337, instance_loss: 0.6273, weighted_loss: 0.2818, label: 1, bag_size: 2122
batch 99, loss: 0.0803, instance_loss: 0.3539, weighted_loss: 0.1624, label: 0, bag_size: 4251
batch 119, loss: 0.5794, instance_loss: 0.3967, weighted_loss: 0.5246, label: 0, bag_size: 4378
batch 139, loss: 1.1575, instance_loss: 1.5639, weighted_loss: 1.2794, label: 1, bag_size: 1549
batch 159, loss: 0.1352, instance_loss: 0.2051, weighted_loss: 0.1561, label: 2, bag_size: 3327
batch 179, loss: 1.2123, instance_loss: 1.5225, weighted_loss: 1.3054, label: 1, bag_size: 3619
batch 199, loss: 0.0364, instance_loss: 0.0702, weighted_loss: 0.0465, label: 2, bag_size: 6026
batch 219, loss: 0.8516, instance_loss: 0.9424, weighted_loss: 0.8789, label: 0, bag_size: 14432
batch 239, loss: 0.0887, instance_loss: 0.1477, weighted_loss: 0.1064, label: 2, bag_size: 4302
batch 259, loss: 0.1862, instance_loss: 0.6842, weighted_loss: 0.3356, label: 2, bag_size: 4342
batch 279, loss: 0.0105, instance_loss: 0.8490, weighted_loss: 0.2620, label: 0, bag_size: 577
batch 299, loss: 0.0392, instance_loss: 0.8722, weighted_loss: 0.2891, label: 1, bag_size: 10399
batch 319, loss: 0.1414, instance_loss: 0.3220, weighted_loss: 0.1956, label: 1, bag_size: 3050
batch 339, loss: 0.9799, instance_loss: 0.8574, weighted_loss: 0.9432, label: 2, bag_size: 7607
batch 359, loss: 1.5268, instance_loss: 0.5681, weighted_loss: 1.2392, label: 0, bag_size: 5526
batch 379, loss: 0.0161, instance_loss: 0.1184, weighted_loss: 0.0468, label: 0, bag_size: 5500
batch 399, loss: 0.4292, instance_loss: 0.2366, weighted_loss: 0.3714, label: 2, bag_size: 3112
batch 419, loss: 0.3174, instance_loss: 0.5141, weighted_loss: 0.3764, label: 0, bag_size: 622
batch 439, loss: 1.6454, instance_loss: 0.7023, weighted_loss: 1.3625, label: 1, bag_size: 4812
batch 459, loss: 1.2398, instance_loss: 0.8299, weighted_loss: 1.1169, label: 1, bag_size: 1371
batch 479, loss: 0.5332, instance_loss: 0.3699, weighted_loss: 0.4842, label: 2, bag_size: 3174
batch 499, loss: 3.2483, instance_loss: 1.9092, weighted_loss: 2.8465, label: 0, bag_size: 3387
batch 519, loss: 0.0186, instance_loss: 0.2156, weighted_loss: 0.0777, label: 0, bag_size: 3182
batch 539, loss: 2.1647, instance_loss: 0.9229, weighted_loss: 1.7921, label: 2, bag_size: 909
batch 559, loss: 0.3246, instance_loss: 0.5577, weighted_loss: 0.3945, label: 2, bag_size: 3475
batch 579, loss: 0.0089, instance_loss: 0.3352, weighted_loss: 0.1068, label: 0, bag_size: 829
batch 599, loss: 0.0538, instance_loss: 0.2599, weighted_loss: 0.1156, label: 0, bag_size: 1018
batch 619, loss: 1.5064, instance_loss: 0.8519, weighted_loss: 1.3100, label: 1, bag_size: 3837
batch 639, loss: 1.0420, instance_loss: 1.2391, weighted_loss: 1.1011, label: 1, bag_size: 1964
batch 659, loss: 0.3334, instance_loss: 0.5649, weighted_loss: 0.4029, label: 2, bag_size: 3618
batch 679, loss: 0.0987, instance_loss: 0.3553, weighted_loss: 0.1757, label: 1, bag_size: 3761
batch 699, loss: 0.3524, instance_loss: 0.6542, weighted_loss: 0.4429, label: 2, bag_size: 223
batch 719, loss: 0.3053, instance_loss: 0.3397, weighted_loss: 0.3156, label: 1, bag_size: 2753
batch 739, loss: 0.3081, instance_loss: 0.4097, weighted_loss: 0.3386, label: 1, bag_size: 3493


class 0 clustering acc 0.966331096196868: correct 17278/17880
class 1 clustering acc 0.4540268456375839: correct 2706/5960
Epoch: 54, train_loss: 0.4543, train_clustering_loss:  0.4975, train_error: 0.2067
class 0: acc 0.83203125, correct 213/256
class 1: acc 0.6666666666666666, correct 152/228
class 2: acc 0.8659003831417624, correct 226/261

Val Set, val_loss: 0.5436, val_error: 0.2553, auc: 0.9099
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.449468085106383: correct 338/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0726, instance_loss: 0.2271, weighted_loss: 0.1190, label: 1, bag_size: 2753
batch 39, loss: 0.4252, instance_loss: 0.4833, weighted_loss: 0.4426, label: 1, bag_size: 800
batch 59, loss: 0.3720, instance_loss: 0.3379, weighted_loss: 0.3618, label: 1, bag_size: 1221
batch 79, loss: 0.0011, instance_loss: 0.1313, weighted_loss: 0.0401, label: 1, bag_size: 259
batch 99, loss: 0.2963, instance_loss: 0.5661, weighted_loss: 0.3773, label: 0, bag_size: 8611
batch 119, loss: 0.0744, instance_loss: 0.1917, weighted_loss: 0.1096, label: 2, bag_size: 4162
batch 139, loss: 0.0995, instance_loss: 0.3010, weighted_loss: 0.1599, label: 0, bag_size: 3113
batch 159, loss: 0.1796, instance_loss: 0.4953, weighted_loss: 0.2743, label: 2, bag_size: 4302
batch 179, loss: 0.0179, instance_loss: 0.2050, weighted_loss: 0.0740, label: 1, bag_size: 3493
batch 199, loss: 0.0636, instance_loss: 0.4385, weighted_loss: 0.1761, label: 2, bag_size: 4342
batch 219, loss: 0.4461, instance_loss: 0.6554, weighted_loss: 0.5089, label: 2, bag_size: 5037
batch 239, loss: 0.3084, instance_loss: 0.5052, weighted_loss: 0.3674, label: 2, bag_size: 3299
batch 259, loss: 0.2466, instance_loss: 0.8840, weighted_loss: 0.4378, label: 1, bag_size: 3885
batch 279, loss: 0.3037, instance_loss: 0.5548, weighted_loss: 0.3790, label: 2, bag_size: 5307
batch 299, loss: 0.1635, instance_loss: 0.5568, weighted_loss: 0.2815, label: 1, bag_size: 1510
batch 319, loss: 1.0832, instance_loss: 1.0814, weighted_loss: 1.0827, label: 2, bag_size: 1050
batch 339, loss: 0.5041, instance_loss: 0.9018, weighted_loss: 0.6234, label: 2, bag_size: 1050
batch 359, loss: 0.0530, instance_loss: 0.3783, weighted_loss: 0.1506, label: 1, bag_size: 3403
batch 379, loss: 1.3035, instance_loss: 0.9950, weighted_loss: 1.2109, label: 1, bag_size: 2927
batch 399, loss: 0.1318, instance_loss: 0.3371, weighted_loss: 0.1934, label: 2, bag_size: 3285
batch 419, loss: 2.3908, instance_loss: 1.1156, weighted_loss: 2.0082, label: 0, bag_size: 2217
batch 439, loss: 0.0437, instance_loss: 0.5230, weighted_loss: 0.1875, label: 0, bag_size: 1933
batch 459, loss: 0.1458, instance_loss: 0.2823, weighted_loss: 0.1868, label: 2, bag_size: 657
batch 479, loss: 3.7027, instance_loss: 1.3388, weighted_loss: 2.9935, label: 1, bag_size: 4258
batch 499, loss: 0.1764, instance_loss: 0.2489, weighted_loss: 0.1982, label: 0, bag_size: 5570
batch 519, loss: 0.0335, instance_loss: 0.4586, weighted_loss: 0.1610, label: 1, bag_size: 2472
batch 539, loss: 0.0345, instance_loss: 0.3778, weighted_loss: 0.1375, label: 1, bag_size: 3677
batch 559, loss: 0.4319, instance_loss: 0.4149, weighted_loss: 0.4268, label: 2, bag_size: 3227
batch 579, loss: 0.3978, instance_loss: 0.6987, weighted_loss: 0.4881, label: 0, bag_size: 477
batch 599, loss: 1.0073, instance_loss: 0.9299, weighted_loss: 0.9841, label: 2, bag_size: 223
batch 619, loss: 1.7480, instance_loss: 1.3995, weighted_loss: 1.6435, label: 0, bag_size: 3419
batch 639, loss: 0.4756, instance_loss: 0.8492, weighted_loss: 0.5877, label: 1, bag_size: 4940
batch 659, loss: 0.1136, instance_loss: 0.2724, weighted_loss: 0.1612, label: 1, bag_size: 5086
batch 679, loss: 0.3026, instance_loss: 0.5046, weighted_loss: 0.3632, label: 0, bag_size: 4378
batch 699, loss: 0.2225, instance_loss: 0.4854, weighted_loss: 0.3014, label: 0, bag_size: 5353
batch 719, loss: 0.1269, instance_loss: 0.2290, weighted_loss: 0.1575, label: 1, bag_size: 3558
batch 739, loss: 0.2270, instance_loss: 0.3093, weighted_loss: 0.2517, label: 2, bag_size: 4223


class 0 clustering acc 0.9643736017897092: correct 17243/17880
class 1 clustering acc 0.34496644295302015: correct 2056/5960
Epoch: 55, train_loss: 0.5409, train_clustering_loss:  0.5682, train_error: 0.2027
class 0: acc 0.8114754098360656, correct 198/244
class 1: acc 0.7211155378486056, correct 181/251
class 2: acc 0.86, correct 215/250

Val Set, val_loss: 0.5724, val_error: 0.2128, auc: 0.9153
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.3949468085106383: correct 297/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0430, instance_loss: 0.1364, weighted_loss: 0.0711, label: 2, bag_size: 4775
batch 39, loss: 0.0773, instance_loss: 0.2484, weighted_loss: 0.1286, label: 0, bag_size: 2756
batch 59, loss: 0.0707, instance_loss: 0.2371, weighted_loss: 0.1206, label: 2, bag_size: 2209
batch 79, loss: 0.2458, instance_loss: 0.3796, weighted_loss: 0.2859, label: 1, bag_size: 1197
batch 99, loss: 0.2038, instance_loss: 0.2496, weighted_loss: 0.2175, label: 2, bag_size: 3080
batch 119, loss: 0.1415, instance_loss: 0.2799, weighted_loss: 0.1830, label: 2, bag_size: 3327
batch 139, loss: 0.8520, instance_loss: 0.9277, weighted_loss: 0.8747, label: 1, bag_size: 1307
batch 159, loss: 0.2640, instance_loss: 0.6698, weighted_loss: 0.3857, label: 1, bag_size: 3482
batch 179, loss: 1.2056, instance_loss: 1.1389, weighted_loss: 1.1856, label: 0, bag_size: 4018
batch 199, loss: 1.6030, instance_loss: 1.0293, weighted_loss: 1.4309, label: 1, bag_size: 5072
batch 219, loss: 0.0875, instance_loss: 0.2318, weighted_loss: 0.1308, label: 2, bag_size: 3810
batch 239, loss: 0.0645, instance_loss: 0.2126, weighted_loss: 0.1090, label: 0, bag_size: 4741
batch 259, loss: 0.0177, instance_loss: 0.1903, weighted_loss: 0.0695, label: 0, bag_size: 3294
batch 279, loss: 0.0576, instance_loss: 0.2325, weighted_loss: 0.1101, label: 0, bag_size: 1545
batch 299, loss: 0.0284, instance_loss: 0.4907, weighted_loss: 0.1671, label: 0, bag_size: 3245
batch 319, loss: 2.3000, instance_loss: 1.3049, weighted_loss: 2.0015, label: 1, bag_size: 2425
batch 339, loss: 0.0008, instance_loss: 0.6354, weighted_loss: 0.1912, label: 1, bag_size: 4684
batch 359, loss: 0.0231, instance_loss: 0.5646, weighted_loss: 0.1856, label: 0, bag_size: 4274
batch 379, loss: 0.0487, instance_loss: 0.1544, weighted_loss: 0.0804, label: 2, bag_size: 3415
batch 399, loss: 0.1450, instance_loss: 0.2482, weighted_loss: 0.1760, label: 0, bag_size: 3915
batch 419, loss: 0.0779, instance_loss: 0.2199, weighted_loss: 0.1205, label: 2, bag_size: 3121
batch 439, loss: 0.1312, instance_loss: 0.3581, weighted_loss: 0.1993, label: 0, bag_size: 614
batch 459, loss: 0.4374, instance_loss: 0.6807, weighted_loss: 0.5104, label: 1, bag_size: 2342
batch 479, loss: 1.4967, instance_loss: 0.6477, weighted_loss: 1.2420, label: 1, bag_size: 3786
batch 499, loss: 0.1460, instance_loss: 0.8092, weighted_loss: 0.3450, label: 0, bag_size: 996
batch 519, loss: 0.4357, instance_loss: 0.2444, weighted_loss: 0.3783, label: 0, bag_size: 1353
batch 539, loss: 0.1604, instance_loss: 0.7157, weighted_loss: 0.3270, label: 2, bag_size: 22464
batch 559, loss: 0.0000, instance_loss: 0.6940, weighted_loss: 0.2082, label: 0, bag_size: 2028
batch 579, loss: 0.3159, instance_loss: 0.4641, weighted_loss: 0.3604, label: 0, bag_size: 4808
batch 599, loss: 0.0023, instance_loss: 0.2376, weighted_loss: 0.0729, label: 0, bag_size: 3594
batch 619, loss: 0.0728, instance_loss: 0.2891, weighted_loss: 0.1377, label: 2, bag_size: 5307
batch 639, loss: 0.0550, instance_loss: 0.1762, weighted_loss: 0.0914, label: 2, bag_size: 3327
batch 659, loss: 0.0419, instance_loss: 0.3685, weighted_loss: 0.1399, label: 0, bag_size: 1006
batch 679, loss: 0.0895, instance_loss: 0.1876, weighted_loss: 0.1189, label: 2, bag_size: 4691
batch 699, loss: 1.7746, instance_loss: 1.4464, weighted_loss: 1.6761, label: 1, bag_size: 5205
batch 719, loss: 0.0172, instance_loss: 0.2009, weighted_loss: 0.0723, label: 1, bag_size: 2796
batch 739, loss: 0.0901, instance_loss: 0.3664, weighted_loss: 0.1729, label: 1, bag_size: 4869


class 0 clustering acc 0.9662751677852349: correct 17277/17880
class 1 clustering acc 0.41828859060402684: correct 2493/5960
Epoch: 56, train_loss: 0.4398, train_clustering_loss:  0.5160, train_error: 0.1893
class 0: acc 0.8464566929133859, correct 215/254
class 1: acc 0.7095435684647303, correct 171/241
class 2: acc 0.872, correct 218/250

Val Set, val_loss: 0.6457, val_error: 0.2340, auc: 0.9197
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.3976063829787234: correct 299/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0000, instance_loss: 0.2970, weighted_loss: 0.0891, label: 1, bag_size: 5760
batch 39, loss: 0.4855, instance_loss: 0.7947, weighted_loss: 0.5783, label: 2, bag_size: 5743
batch 59, loss: 0.4959, instance_loss: 0.7836, weighted_loss: 0.5822, label: 2, bag_size: 728
batch 79, loss: 0.2963, instance_loss: 0.3400, weighted_loss: 0.3094, label: 1, bag_size: 6156
batch 99, loss: 0.0687, instance_loss: 0.1519, weighted_loss: 0.0937, label: 2, bag_size: 5914
batch 119, loss: 0.4323, instance_loss: 0.3012, weighted_loss: 0.3930, label: 0, bag_size: 726
batch 139, loss: 0.0815, instance_loss: 0.1289, weighted_loss: 0.0957, label: 2, bag_size: 4223
batch 159, loss: 0.3234, instance_loss: 0.5838, weighted_loss: 0.4015, label: 1, bag_size: 4395
batch 179, loss: 1.2758, instance_loss: 0.8243, weighted_loss: 1.1403, label: 1, bag_size: 6241
batch 199, loss: 0.0234, instance_loss: 0.1552, weighted_loss: 0.0630, label: 0, bag_size: 3437
batch 219, loss: 0.0052, instance_loss: 0.7748, weighted_loss: 0.2361, label: 0, bag_size: 4494
batch 239, loss: 0.0424, instance_loss: 0.2359, weighted_loss: 0.1004, label: 2, bag_size: 3121
batch 259, loss: 0.4141, instance_loss: 0.5354, weighted_loss: 0.4505, label: 2, bag_size: 1513
batch 279, loss: 0.0001, instance_loss: 0.2040, weighted_loss: 0.0613, label: 1, bag_size: 5760
batch 299, loss: 0.6277, instance_loss: 0.6730, weighted_loss: 0.6413, label: 1, bag_size: 3604
batch 319, loss: 0.0860, instance_loss: 1.1170, weighted_loss: 0.3953, label: 0, bag_size: 1910
batch 339, loss: 0.4009, instance_loss: 0.4251, weighted_loss: 0.4082, label: 0, bag_size: 4122
batch 359, loss: 0.2222, instance_loss: 1.0878, weighted_loss: 0.4819, label: 1, bag_size: 2927
batch 379, loss: 0.1537, instance_loss: 0.3113, weighted_loss: 0.2010, label: 0, bag_size: 386
batch 399, loss: 0.6237, instance_loss: 0.8065, weighted_loss: 0.6785, label: 2, bag_size: 223
batch 419, loss: 0.0507, instance_loss: 0.1794, weighted_loss: 0.0893, label: 2, bag_size: 4555
batch 439, loss: 0.0006, instance_loss: 0.0843, weighted_loss: 0.0257, label: 1, bag_size: 3043
batch 459, loss: 0.4363, instance_loss: 0.7073, weighted_loss: 0.5176, label: 0, bag_size: 1655
batch 479, loss: 0.0046, instance_loss: 0.2548, weighted_loss: 0.0796, label: 0, bag_size: 1006
batch 499, loss: 0.0000, instance_loss: 0.2199, weighted_loss: 0.0660, label: 2, bag_size: 3607
batch 519, loss: 0.3380, instance_loss: 0.3273, weighted_loss: 0.3348, label: 0, bag_size: 2671
batch 539, loss: 0.7037, instance_loss: 0.5963, weighted_loss: 0.6715, label: 1, bag_size: 209
batch 559, loss: 0.1248, instance_loss: 0.4581, weighted_loss: 0.2248, label: 1, bag_size: 14449
batch 579, loss: 1.0054, instance_loss: 0.7140, weighted_loss: 0.9180, label: 1, bag_size: 6165
batch 599, loss: 0.0025, instance_loss: 0.3230, weighted_loss: 0.0986, label: 1, bag_size: 3265
batch 619, loss: 0.0000, instance_loss: 0.1418, weighted_loss: 0.0425, label: 1, bag_size: 6277
batch 639, loss: 0.0562, instance_loss: 0.1355, weighted_loss: 0.0799, label: 2, bag_size: 657
batch 659, loss: 0.0410, instance_loss: 0.1404, weighted_loss: 0.0708, label: 2, bag_size: 6026
batch 679, loss: 0.1109, instance_loss: 0.7939, weighted_loss: 0.3158, label: 2, bag_size: 4910
batch 699, loss: 0.4966, instance_loss: 0.3843, weighted_loss: 0.4629, label: 2, bag_size: 4788
batch 719, loss: 0.9423, instance_loss: 0.7700, weighted_loss: 0.8906, label: 2, bag_size: 1050
batch 739, loss: 0.5918, instance_loss: 1.0330, weighted_loss: 0.7242, label: 0, bag_size: 4398


class 0 clustering acc 0.9646532438478748: correct 17248/17880
class 1 clustering acc 0.40385906040268454: correct 2407/5960
Epoch: 57, train_loss: 0.4946, train_clustering_loss:  0.5362, train_error: 0.2000
class 0: acc 0.8228346456692913, correct 209/254
class 1: acc 0.7041666666666667, correct 169/240
class 2: acc 0.8685258964143426, correct 218/251

Val Set, val_loss: 0.7711, val_error: 0.3085, auc: 0.9001
class 0 clustering acc 0.9432624113475178: correct 2128/2256
class 1 clustering acc 0.29654255319148937: correct 223/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0978, weighted_loss: 0.0293, label: 1, bag_size: 3338
batch 39, loss: 0.0824, instance_loss: 0.1689, weighted_loss: 0.1083, label: 2, bag_size: 657
batch 59, loss: 0.0030, instance_loss: 0.1459, weighted_loss: 0.0459, label: 1, bag_size: 7279
batch 79, loss: 0.1388, instance_loss: 0.2030, weighted_loss: 0.1580, label: 2, bag_size: 4223
batch 99, loss: 0.6841, instance_loss: 0.6582, weighted_loss: 0.6763, label: 1, bag_size: 3438
batch 119, loss: 0.0928, instance_loss: 0.2402, weighted_loss: 0.1371, label: 0, bag_size: 5634
batch 139, loss: 0.9283, instance_loss: 0.6343, weighted_loss: 0.8401, label: 0, bag_size: 436
batch 159, loss: 0.0096, instance_loss: 0.1363, weighted_loss: 0.0476, label: 0, bag_size: 3754
batch 179, loss: 0.0287, instance_loss: 0.1378, weighted_loss: 0.0614, label: 2, bag_size: 4555
batch 199, loss: 0.0498, instance_loss: 0.1760, weighted_loss: 0.0877, label: 2, bag_size: 2031
batch 219, loss: 1.9190, instance_loss: 0.9356, weighted_loss: 1.6240, label: 2, bag_size: 909
batch 239, loss: 0.0623, instance_loss: 0.2525, weighted_loss: 0.1194, label: 2, bag_size: 2770
batch 259, loss: 0.9073, instance_loss: 0.6233, weighted_loss: 0.8221, label: 1, bag_size: 4373
batch 279, loss: 0.1189, instance_loss: 0.3596, weighted_loss: 0.1912, label: 2, bag_size: 5472
batch 299, loss: 0.2879, instance_loss: 0.5514, weighted_loss: 0.3669, label: 2, bag_size: 552
batch 319, loss: 0.3765, instance_loss: 0.4700, weighted_loss: 0.4045, label: 0, bag_size: 1625
batch 339, loss: 0.0351, instance_loss: 0.1885, weighted_loss: 0.0811, label: 2, bag_size: 4162
batch 359, loss: 0.0194, instance_loss: 0.2378, weighted_loss: 0.0849, label: 0, bag_size: 5353
batch 379, loss: 0.0808, instance_loss: 0.1877, weighted_loss: 0.1129, label: 2, bag_size: 2501
batch 399, loss: 0.1492, instance_loss: 0.5125, weighted_loss: 0.2582, label: 0, bag_size: 614
batch 419, loss: 0.0072, instance_loss: 0.2087, weighted_loss: 0.0677, label: 0, bag_size: 3182
batch 439, loss: 0.3063, instance_loss: 0.4138, weighted_loss: 0.3386, label: 2, bag_size: 3746
batch 459, loss: 0.0206, instance_loss: 0.4081, weighted_loss: 0.1368, label: 0, bag_size: 2139
batch 479, loss: 0.4178, instance_loss: 0.2648, weighted_loss: 0.3719, label: 2, bag_size: 3397
batch 499, loss: 1.0294, instance_loss: 0.9265, weighted_loss: 0.9985, label: 1, bag_size: 4694
batch 519, loss: 0.5589, instance_loss: 0.9847, weighted_loss: 0.6866, label: 0, bag_size: 4997
batch 539, loss: 0.0655, instance_loss: 0.1734, weighted_loss: 0.0979, label: 2, bag_size: 2561
batch 559, loss: 0.7123, instance_loss: 0.6247, weighted_loss: 0.6860, label: 2, bag_size: 7607
batch 579, loss: 0.3825, instance_loss: 0.7716, weighted_loss: 0.4992, label: 2, bag_size: 3299
batch 599, loss: 0.0346, instance_loss: 0.1282, weighted_loss: 0.0626, label: 2, bag_size: 3497
batch 619, loss: 1.3164, instance_loss: 0.8672, weighted_loss: 1.1817, label: 1, bag_size: 32
batch 639, loss: 0.2802, instance_loss: 0.3102, weighted_loss: 0.2892, label: 1, bag_size: 6156
batch 659, loss: 0.0776, instance_loss: 0.6501, weighted_loss: 0.2493, label: 0, bag_size: 889
batch 679, loss: 0.0618, instance_loss: 0.2488, weighted_loss: 0.1179, label: 0, bag_size: 3334
batch 699, loss: 2.8940, instance_loss: 1.4053, weighted_loss: 2.4474, label: 1, bag_size: 4187
batch 719, loss: 0.0940, instance_loss: 0.3558, weighted_loss: 0.1726, label: 2, bag_size: 3778
batch 739, loss: 0.0235, instance_loss: 0.2006, weighted_loss: 0.0766, label: 1, bag_size: 3009


class 0 clustering acc 0.964765100671141: correct 17250/17880
class 1 clustering acc 0.4313758389261745: correct 2571/5960
Epoch: 58, train_loss: 0.4348, train_clustering_loss:  0.5125, train_error: 0.1705
class 0: acc 0.8487394957983193, correct 202/238
class 1: acc 0.7302904564315352, correct 176/241
class 2: acc 0.9022556390977443, correct 240/266

Val Set, val_loss: 0.8674, val_error: 0.2979, auc: 0.8986
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.2726063829787234: correct 205/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.9333333333333333, correct 28/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0289, instance_loss: 0.2516, weighted_loss: 0.0957, label: 0, bag_size: 4300
batch 39, loss: 0.2792, instance_loss: 0.6008, weighted_loss: 0.3757, label: 0, bag_size: 4997
batch 59, loss: 0.4888, instance_loss: 0.3645, weighted_loss: 0.4515, label: 0, bag_size: 13770
batch 79, loss: 0.0767, instance_loss: 0.2214, weighted_loss: 0.1201, label: 2, bag_size: 3210
batch 99, loss: 0.0176, instance_loss: 0.0937, weighted_loss: 0.0404, label: 2, bag_size: 4856
batch 119, loss: 0.0175, instance_loss: 0.1536, weighted_loss: 0.0583, label: 0, bag_size: 4242
batch 139, loss: 0.0541, instance_loss: 0.2181, weighted_loss: 0.1033, label: 2, bag_size: 5924
batch 159, loss: 0.0826, instance_loss: 0.1646, weighted_loss: 0.1072, label: 2, bag_size: 4192
batch 179, loss: 0.0284, instance_loss: 0.1704, weighted_loss: 0.0710, label: 1, bag_size: 5385
batch 199, loss: 0.7371, instance_loss: 0.6864, weighted_loss: 0.7219, label: 1, bag_size: 1122
batch 219, loss: 0.0244, instance_loss: 0.2796, weighted_loss: 0.1010, label: 0, bag_size: 1018
batch 239, loss: 0.0348, instance_loss: 0.3767, weighted_loss: 0.1373, label: 0, bag_size: 3268
batch 259, loss: 0.0360, instance_loss: 0.1440, weighted_loss: 0.0684, label: 0, bag_size: 4529
batch 279, loss: 0.3088, instance_loss: 0.3272, weighted_loss: 0.3143, label: 2, bag_size: 3746
batch 299, loss: 0.2187, instance_loss: 0.4403, weighted_loss: 0.2852, label: 0, bag_size: 673
batch 319, loss: 0.0455, instance_loss: 0.2797, weighted_loss: 0.1158, label: 1, bag_size: 4898
batch 339, loss: 0.3504, instance_loss: 0.3010, weighted_loss: 0.3356, label: 2, bag_size: 3397
batch 359, loss: 2.9917, instance_loss: 1.0360, weighted_loss: 2.4050, label: 0, bag_size: 35080
batch 379, loss: 0.0003, instance_loss: 0.1941, weighted_loss: 0.0584, label: 1, bag_size: 2809
batch 399, loss: 1.5570, instance_loss: 1.1206, weighted_loss: 1.4261, label: 1, bag_size: 5205
batch 419, loss: 0.0051, instance_loss: 0.0507, weighted_loss: 0.0187, label: 2, bag_size: 3285
batch 439, loss: 0.6722, instance_loss: 0.9857, weighted_loss: 0.7662, label: 1, bag_size: 2614
batch 459, loss: 0.0493, instance_loss: 0.6669, weighted_loss: 0.2346, label: 2, bag_size: 4497
batch 479, loss: 0.2575, instance_loss: 0.4951, weighted_loss: 0.3288, label: 2, bag_size: 4162
batch 499, loss: 0.0508, instance_loss: 0.2388, weighted_loss: 0.1072, label: 2, bag_size: 6148
batch 519, loss: 0.0068, instance_loss: 0.3174, weighted_loss: 0.1000, label: 1, bag_size: 2493
batch 539, loss: 0.7594, instance_loss: 0.4983, weighted_loss: 0.6811, label: 1, bag_size: 368
batch 559, loss: 0.0908, instance_loss: 0.4887, weighted_loss: 0.2102, label: 1, bag_size: 4595
batch 579, loss: 0.1133, instance_loss: 0.1815, weighted_loss: 0.1338, label: 2, bag_size: 3176
batch 599, loss: 0.0190, instance_loss: 0.1055, weighted_loss: 0.0449, label: 2, bag_size: 614
batch 619, loss: 0.1791, instance_loss: 0.4640, weighted_loss: 0.2646, label: 1, bag_size: 3640
batch 639, loss: 1.3770, instance_loss: 1.1188, weighted_loss: 1.2995, label: 1, bag_size: 1045
batch 659, loss: 0.0100, instance_loss: 0.1968, weighted_loss: 0.0660, label: 0, bag_size: 4196
batch 679, loss: 0.0544, instance_loss: 0.1615, weighted_loss: 0.0866, label: 2, bag_size: 1103
batch 699, loss: 0.2638, instance_loss: 0.6367, weighted_loss: 0.3757, label: 1, bag_size: 1161
batch 719, loss: 0.1522, instance_loss: 0.5839, weighted_loss: 0.2817, label: 0, bag_size: 3539
batch 739, loss: 1.2780, instance_loss: 1.0167, weighted_loss: 1.1996, label: 2, bag_size: 4241


class 0 clustering acc 0.9661633109619687: correct 17275/17880
class 1 clustering acc 0.4302013422818792: correct 2564/5960
Epoch: 59, train_loss: 0.4642, train_clustering_loss:  0.5097, train_error: 0.1906
class 0: acc 0.8458498023715415, correct 214/253
class 1: acc 0.7025862068965517, correct 163/232
class 2: acc 0.8692307692307693, correct 226/260

Val Set, val_loss: 0.6724, val_error: 0.2979, auc: 0.9071
class 0 clustering acc 0.9791666666666666: correct 2209/2256
class 1 clustering acc 0.28058510638297873: correct 211/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2964, instance_loss: 0.8269, weighted_loss: 0.4555, label: 0, bag_size: 8611
batch 39, loss: 0.0341, instance_loss: 0.1944, weighted_loss: 0.0822, label: 2, bag_size: 4569
batch 59, loss: 1.0132, instance_loss: 0.8961, weighted_loss: 0.9781, label: 1, bag_size: 1313
batch 79, loss: 0.4247, instance_loss: 0.7083, weighted_loss: 0.5098, label: 1, bag_size: 3619
batch 99, loss: 0.0445, instance_loss: 0.2297, weighted_loss: 0.1001, label: 2, bag_size: 4555
batch 119, loss: 1.6091, instance_loss: 1.2318, weighted_loss: 1.4959, label: 1, bag_size: 5011
batch 139, loss: 0.9144, instance_loss: 0.8564, weighted_loss: 0.8970, label: 1, bag_size: 1327
batch 159, loss: 0.1459, instance_loss: 0.4039, weighted_loss: 0.2233, label: 1, bag_size: 2302
batch 179, loss: 1.5323, instance_loss: 0.5520, weighted_loss: 1.2382, label: 1, bag_size: 2865
batch 199, loss: 0.4097, instance_loss: 0.8370, weighted_loss: 0.5379, label: 2, bag_size: 4535
batch 219, loss: 0.2437, instance_loss: 0.2049, weighted_loss: 0.2320, label: 0, bag_size: 4700
batch 239, loss: 0.0175, instance_loss: 0.1836, weighted_loss: 0.0673, label: 1, bag_size: 3337
batch 259, loss: 0.0558, instance_loss: 0.1856, weighted_loss: 0.0947, label: 2, bag_size: 4302
batch 279, loss: 0.2358, instance_loss: 0.5268, weighted_loss: 0.3231, label: 2, bag_size: 4487
batch 299, loss: 0.3469, instance_loss: 0.4068, weighted_loss: 0.3649, label: 2, bag_size: 4487
batch 319, loss: 0.9161, instance_loss: 1.1044, weighted_loss: 0.9726, label: 2, bag_size: 4241
batch 339, loss: 0.4037, instance_loss: 0.8884, weighted_loss: 0.5491, label: 2, bag_size: 3475
batch 359, loss: 2.0034, instance_loss: 1.1815, weighted_loss: 1.7568, label: 1, bag_size: 667
batch 379, loss: 0.1152, instance_loss: 0.3802, weighted_loss: 0.1947, label: 0, bag_size: 4648
batch 399, loss: 0.0469, instance_loss: 0.1582, weighted_loss: 0.0803, label: 2, bag_size: 3497
batch 419, loss: 0.0725, instance_loss: 0.3034, weighted_loss: 0.1418, label: 1, bag_size: 3333
batch 439, loss: 0.6549, instance_loss: 0.3584, weighted_loss: 0.5660, label: 0, bag_size: 5890
batch 459, loss: 0.0023, instance_loss: 0.1382, weighted_loss: 0.0431, label: 1, bag_size: 4578
batch 479, loss: 0.1504, instance_loss: 0.9013, weighted_loss: 0.3757, label: 2, bag_size: 4342
batch 499, loss: 0.2721, instance_loss: 0.4618, weighted_loss: 0.3290, label: 1, bag_size: 2122
batch 519, loss: 0.2092, instance_loss: 0.6112, weighted_loss: 0.3298, label: 2, bag_size: 223
batch 539, loss: 0.3642, instance_loss: 0.3720, weighted_loss: 0.3666, label: 0, bag_size: 3113
batch 559, loss: 0.0455, instance_loss: 0.1897, weighted_loss: 0.0888, label: 0, bag_size: 3649
batch 579, loss: 0.0726, instance_loss: 0.1520, weighted_loss: 0.0964, label: 2, bag_size: 657
batch 599, loss: 0.0335, instance_loss: 0.0869, weighted_loss: 0.0495, label: 0, bag_size: 4332
batch 619, loss: 0.6831, instance_loss: 0.7675, weighted_loss: 0.7084, label: 2, bag_size: 361
batch 639, loss: 0.0389, instance_loss: 0.5660, weighted_loss: 0.1970, label: 0, bag_size: 4509
batch 659, loss: 0.1029, instance_loss: 0.2552, weighted_loss: 0.1486, label: 2, bag_size: 5924
batch 679, loss: 0.0196, instance_loss: 0.2094, weighted_loss: 0.0766, label: 1, bag_size: 3534
batch 699, loss: 0.0225, instance_loss: 0.1773, weighted_loss: 0.0690, label: 0, bag_size: 5006
batch 719, loss: 1.3908, instance_loss: 0.5475, weighted_loss: 1.1378, label: 0, bag_size: 3661
batch 739, loss: 0.0347, instance_loss: 0.1545, weighted_loss: 0.0706, label: 2, bag_size: 3396


class 0 clustering acc 0.9651006711409396: correct 17256/17880
class 1 clustering acc 0.4343959731543624: correct 2589/5960
Epoch: 60, train_loss: 0.4803, train_clustering_loss:  0.5139, train_error: 0.1919
class 0: acc 0.8078602620087336, correct 185/229
class 1: acc 0.7262357414448669, correct 191/263
class 2: acc 0.8932806324110671, correct 226/253

Val Set, val_loss: 0.6519, val_error: 0.2872, auc: 0.9040
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.42021276595744683: correct 316/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0687, instance_loss: 0.1362, weighted_loss: 0.0889, label: 0, bag_size: 5500
batch 39, loss: 0.7556, instance_loss: 0.9762, weighted_loss: 0.8218, label: 0, bag_size: 8611
batch 59, loss: 0.0191, instance_loss: 0.1363, weighted_loss: 0.0542, label: 2, bag_size: 3497
batch 79, loss: 0.0912, instance_loss: 0.2296, weighted_loss: 0.1327, label: 2, bag_size: 6148
batch 99, loss: 0.4752, instance_loss: 0.7363, weighted_loss: 0.5535, label: 2, bag_size: 6594
batch 119, loss: 0.0556, instance_loss: 0.1794, weighted_loss: 0.0927, label: 1, bag_size: 7135
batch 139, loss: 0.0287, instance_loss: 0.1634, weighted_loss: 0.0691, label: 2, bag_size: 4141
batch 159, loss: 0.0106, instance_loss: 0.1511, weighted_loss: 0.0528, label: 1, bag_size: 3009
batch 179, loss: 0.5696, instance_loss: 1.0858, weighted_loss: 0.7245, label: 2, bag_size: 4910
batch 199, loss: 0.0102, instance_loss: 0.1829, weighted_loss: 0.0620, label: 2, bag_size: 4141
batch 219, loss: 0.0042, instance_loss: 0.4299, weighted_loss: 0.1319, label: 1, bag_size: 5195
batch 239, loss: 2.3146, instance_loss: 1.1891, weighted_loss: 1.9769, label: 2, bag_size: 552
batch 259, loss: 2.0334, instance_loss: 0.9173, weighted_loss: 1.6986, label: 0, bag_size: 7219
batch 279, loss: 0.7547, instance_loss: 0.7556, weighted_loss: 0.7550, label: 1, bag_size: 5276
batch 299, loss: 0.0531, instance_loss: 0.2384, weighted_loss: 0.1087, label: 1, bag_size: 2092
batch 319, loss: 0.3258, instance_loss: 0.6025, weighted_loss: 0.4088, label: 0, bag_size: 2286
batch 339, loss: 0.0338, instance_loss: 0.2326, weighted_loss: 0.0934, label: 1, bag_size: 3009
batch 359, loss: 2.1268, instance_loss: 1.5931, weighted_loss: 1.9667, label: 1, bag_size: 1307
batch 379, loss: 0.0004, instance_loss: 0.4572, weighted_loss: 0.1374, label: 1, bag_size: 5229
batch 399, loss: 0.0649, instance_loss: 0.6627, weighted_loss: 0.2443, label: 0, bag_size: 3188
batch 419, loss: 0.6776, instance_loss: 1.1478, weighted_loss: 0.8186, label: 0, bag_size: 3419
batch 439, loss: 1.8467, instance_loss: 1.2527, weighted_loss: 1.6685, label: 1, bag_size: 5873
batch 459, loss: 0.1285, instance_loss: 0.5370, weighted_loss: 0.2510, label: 0, bag_size: 2189
batch 479, loss: 0.0103, instance_loss: 0.1677, weighted_loss: 0.0575, label: 0, bag_size: 1744
batch 499, loss: 0.0216, instance_loss: 0.3078, weighted_loss: 0.1074, label: 0, bag_size: 5353
batch 519, loss: 0.0512, instance_loss: 0.4285, weighted_loss: 0.1644, label: 0, bag_size: 5632
batch 539, loss: 0.0103, instance_loss: 0.3897, weighted_loss: 0.1241, label: 0, bag_size: 966
batch 559, loss: 0.0566, instance_loss: 0.2568, weighted_loss: 0.1166, label: 0, bag_size: 1762
batch 579, loss: 0.0146, instance_loss: 0.1270, weighted_loss: 0.0483, label: 0, bag_size: 2545
batch 599, loss: 0.1738, instance_loss: 0.3181, weighted_loss: 0.2171, label: 1, bag_size: 368
batch 619, loss: 0.0198, instance_loss: 0.1049, weighted_loss: 0.0453, label: 2, bag_size: 3210
batch 639, loss: 0.8458, instance_loss: 0.7648, weighted_loss: 0.8215, label: 2, bag_size: 909
batch 659, loss: 0.1151, instance_loss: 0.3578, weighted_loss: 0.1879, label: 0, bag_size: 2195
batch 679, loss: 0.5721, instance_loss: 0.6259, weighted_loss: 0.5883, label: 2, bag_size: 4179
batch 699, loss: 2.3476, instance_loss: 1.0445, weighted_loss: 1.9567, label: 1, bag_size: 2614
batch 719, loss: 0.0076, instance_loss: 0.5562, weighted_loss: 0.1722, label: 1, bag_size: 3596
batch 739, loss: 1.0049, instance_loss: 0.8251, weighted_loss: 0.9509, label: 1, bag_size: 4200


class 0 clustering acc 0.9646532438478748: correct 17248/17880
class 1 clustering acc 0.4471476510067114: correct 2665/5960
Epoch: 61, train_loss: 0.4409, train_clustering_loss:  0.5042, train_error: 0.1597
class 0: acc 0.8554216867469879, correct 213/249
class 1: acc 0.759493670886076, correct 180/237
class 2: acc 0.8996138996138996, correct 233/259

Val Set, val_loss: 0.5369, val_error: 0.2021, auc: 0.9291
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.3523936170212766: correct 265/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.543172 --> 0.536862).  Saving model ...


batch 19, loss: 0.0001, instance_loss: 0.1894, weighted_loss: 0.0569, label: 1, bag_size: 4181
batch 39, loss: 0.7055, instance_loss: 0.4405, weighted_loss: 0.6260, label: 1, bag_size: 3225
batch 59, loss: 0.8226, instance_loss: 0.6564, weighted_loss: 0.7727, label: 2, bag_size: 1222
batch 79, loss: 0.3372, instance_loss: 0.2623, weighted_loss: 0.3147, label: 2, bag_size: 6298
batch 99, loss: 0.0276, instance_loss: 0.1845, weighted_loss: 0.0747, label: 0, bag_size: 1744
batch 119, loss: 1.0345, instance_loss: 1.2523, weighted_loss: 1.0998, label: 1, bag_size: 5205
batch 139, loss: 0.0106, instance_loss: 0.2243, weighted_loss: 0.0747, label: 1, bag_size: 3127
batch 159, loss: 0.2899, instance_loss: 0.4175, weighted_loss: 0.3282, label: 2, bag_size: 6594
batch 179, loss: 0.1905, instance_loss: 0.6179, weighted_loss: 0.3188, label: 2, bag_size: 4978
batch 199, loss: 0.3554, instance_loss: 0.5044, weighted_loss: 0.4001, label: 2, bag_size: 6594
batch 219, loss: 0.6727, instance_loss: 0.3920, weighted_loss: 0.5885, label: 0, bag_size: 4614
batch 239, loss: 0.0937, instance_loss: 0.1936, weighted_loss: 0.1236, label: 2, bag_size: 2359
batch 259, loss: 0.4525, instance_loss: 0.2679, weighted_loss: 0.3971, label: 0, bag_size: 4292
batch 279, loss: 0.0329, instance_loss: 0.1130, weighted_loss: 0.0569, label: 0, bag_size: 4760
batch 299, loss: 0.0478, instance_loss: 0.2397, weighted_loss: 0.1054, label: 2, bag_size: 5924
batch 319, loss: 0.0292, instance_loss: 0.1241, weighted_loss: 0.0577, label: 0, bag_size: 2884
batch 339, loss: 1.4710, instance_loss: 0.8713, weighted_loss: 1.2911, label: 1, bag_size: 5197
batch 359, loss: 0.2385, instance_loss: 0.3799, weighted_loss: 0.2809, label: 1, bag_size: 3604
batch 379, loss: 3.2095, instance_loss: 1.6323, weighted_loss: 2.7363, label: 0, bag_size: 15388
batch 399, loss: 0.1922, instance_loss: 0.5628, weighted_loss: 0.3034, label: 0, bag_size: 4921
batch 419, loss: 0.3806, instance_loss: 0.3563, weighted_loss: 0.3733, label: 1, bag_size: 3586
batch 439, loss: 0.7810, instance_loss: 1.0197, weighted_loss: 0.8526, label: 1, bag_size: 2229
batch 459, loss: 0.3889, instance_loss: 0.5355, weighted_loss: 0.4329, label: 1, bag_size: 4960
batch 479, loss: 0.0031, instance_loss: 0.0980, weighted_loss: 0.0316, label: 1, bag_size: 2809
batch 499, loss: 0.1289, instance_loss: 0.2928, weighted_loss: 0.1781, label: 2, bag_size: 4487
batch 519, loss: 0.0894, instance_loss: 0.7783, weighted_loss: 0.2960, label: 1, bag_size: 2472
batch 539, loss: 0.1899, instance_loss: 0.6187, weighted_loss: 0.3185, label: 2, bag_size: 6594
batch 559, loss: 0.9139, instance_loss: 0.7833, weighted_loss: 0.8747, label: 2, bag_size: 7607
batch 579, loss: 0.7366, instance_loss: 0.8794, weighted_loss: 0.7794, label: 2, bag_size: 4316
batch 599, loss: 1.2017, instance_loss: 1.1040, weighted_loss: 1.1724, label: 1, bag_size: 1097
batch 619, loss: 0.0175, instance_loss: 0.0760, weighted_loss: 0.0351, label: 2, bag_size: 6026
batch 639, loss: 0.5286, instance_loss: 0.5043, weighted_loss: 0.5214, label: 1, bag_size: 2122
batch 659, loss: 0.1444, instance_loss: 1.0286, weighted_loss: 0.4097, label: 1, bag_size: 20666
batch 679, loss: 0.0155, instance_loss: 0.1963, weighted_loss: 0.0697, label: 0, bag_size: 3530
batch 699, loss: 1.0731, instance_loss: 0.7946, weighted_loss: 0.9895, label: 1, bag_size: 4187
batch 719, loss: 0.4933, instance_loss: 0.4642, weighted_loss: 0.4845, label: 1, bag_size: 5412
batch 739, loss: 0.1076, instance_loss: 0.2004, weighted_loss: 0.1355, label: 2, bag_size: 3415


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.43590604026845636: correct 2598/5960
Epoch: 62, train_loss: 0.4465, train_clustering_loss:  0.5052, train_error: 0.2013
class 0: acc 0.8051948051948052, correct 186/231
class 1: acc 0.7131474103585658, correct 179/251
class 2: acc 0.8745247148288974, correct 230/263

Val Set, val_loss: 0.5725, val_error: 0.2660, auc: 0.9130
class 0 clustering acc 0.9853723404255319: correct 2223/2256
class 1 clustering acc 0.3071808510638298: correct 231/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0285, instance_loss: 0.3386, weighted_loss: 0.1215, label: 1, bag_size: 1023
batch 39, loss: 0.2864, instance_loss: 0.4726, weighted_loss: 0.3422, label: 0, bag_size: 3983
batch 59, loss: 0.0372, instance_loss: 0.3234, weighted_loss: 0.1230, label: 1, bag_size: 3611
batch 79, loss: 0.0604, instance_loss: 0.1550, weighted_loss: 0.0888, label: 2, bag_size: 4141
batch 99, loss: 0.0531, instance_loss: 0.3487, weighted_loss: 0.1417, label: 1, bag_size: 4644
batch 119, loss: 1.3421, instance_loss: 0.9948, weighted_loss: 1.2379, label: 1, bag_size: 4694
batch 139, loss: 0.1108, instance_loss: 0.3396, weighted_loss: 0.1794, label: 1, bag_size: 596
batch 159, loss: 0.1177, instance_loss: 0.6396, weighted_loss: 0.2743, label: 1, bag_size: 1712
batch 179, loss: 0.0587, instance_loss: 0.1653, weighted_loss: 0.0907, label: 0, bag_size: 2791
batch 199, loss: 0.2510, instance_loss: 0.2165, weighted_loss: 0.2407, label: 2, bag_size: 2501
batch 219, loss: 0.1553, instance_loss: 0.4812, weighted_loss: 0.2531, label: 0, bag_size: 2428
batch 239, loss: 0.0685, instance_loss: 0.1684, weighted_loss: 0.0984, label: 1, bag_size: 3493
batch 259, loss: 0.0212, instance_loss: 0.1124, weighted_loss: 0.0485, label: 0, bag_size: 4741
batch 279, loss: 0.0152, instance_loss: 0.1075, weighted_loss: 0.0429, label: 2, bag_size: 3094
batch 299, loss: 0.0348, instance_loss: 0.1725, weighted_loss: 0.0761, label: 2, bag_size: 2770
batch 319, loss: 1.7358, instance_loss: 1.2372, weighted_loss: 1.5862, label: 1, bag_size: 6165
batch 339, loss: 0.0130, instance_loss: 0.0977, weighted_loss: 0.0384, label: 2, bag_size: 5138
batch 359, loss: 0.0807, instance_loss: 0.2679, weighted_loss: 0.1368, label: 2, bag_size: 3618
batch 379, loss: 0.3108, instance_loss: 0.4443, weighted_loss: 0.3509, label: 2, bag_size: 4241
batch 399, loss: 0.2955, instance_loss: 0.6292, weighted_loss: 0.3956, label: 2, bag_size: 4342
batch 419, loss: 0.1633, instance_loss: 0.2773, weighted_loss: 0.1975, label: 2, bag_size: 3778
batch 439, loss: 0.7798, instance_loss: 0.4689, weighted_loss: 0.6865, label: 0, bag_size: 11663
batch 459, loss: 0.9581, instance_loss: 0.9177, weighted_loss: 0.9460, label: 2, bag_size: 1222
batch 479, loss: 0.0341, instance_loss: 0.2508, weighted_loss: 0.0991, label: 2, bag_size: 4569
batch 499, loss: 0.6419, instance_loss: 0.3671, weighted_loss: 0.5595, label: 1, bag_size: 4812
batch 519, loss: 0.1765, instance_loss: 0.4770, weighted_loss: 0.2666, label: 0, bag_size: 3904
batch 539, loss: 0.0262, instance_loss: 0.1153, weighted_loss: 0.0529, label: 0, bag_size: 2705
batch 559, loss: 0.6814, instance_loss: 0.6625, weighted_loss: 0.6757, label: 1, bag_size: 4467
batch 579, loss: 0.0477, instance_loss: 0.1102, weighted_loss: 0.0664, label: 2, bag_size: 1094
batch 599, loss: 0.0225, instance_loss: 0.4499, weighted_loss: 0.1507, label: 0, bag_size: 1933
batch 619, loss: 0.0221, instance_loss: 0.3569, weighted_loss: 0.1226, label: 1, bag_size: 4578
batch 639, loss: 0.0829, instance_loss: 0.6035, weighted_loss: 0.2391, label: 2, bag_size: 4910
batch 659, loss: 0.3038, instance_loss: 0.4426, weighted_loss: 0.3455, label: 2, bag_size: 4535
batch 679, loss: 0.0202, instance_loss: 0.5073, weighted_loss: 0.1663, label: 0, bag_size: 3245
batch 699, loss: 0.0206, instance_loss: 0.3716, weighted_loss: 0.1259, label: 1, bag_size: 6475
batch 719, loss: 0.0322, instance_loss: 0.3805, weighted_loss: 0.1367, label: 1, bag_size: 3403
batch 739, loss: 1.1102, instance_loss: 0.8665, weighted_loss: 1.0371, label: 2, bag_size: 361


class 0 clustering acc 0.9693512304250559: correct 17332/17880
class 1 clustering acc 0.45100671140939597: correct 2688/5960
Epoch: 63, train_loss: 0.4226, train_clustering_loss:  0.4931, train_error: 0.1839
class 0: acc 0.852589641434263, correct 214/251
class 1: acc 0.75, correct 186/248
class 2: acc 0.8455284552845529, correct 208/246

Val Set, val_loss: 0.5716, val_error: 0.2234, auc: 0.9279
class 0 clustering acc 0.9703014184397163: correct 2189/2256
class 1 clustering acc 0.4454787234042553: correct 335/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5345, instance_loss: 0.8773, weighted_loss: 0.6374, label: 2, bag_size: 223
batch 39, loss: 0.0532, instance_loss: 0.2504, weighted_loss: 0.1124, label: 1, bag_size: 2919
batch 59, loss: 0.0150, instance_loss: 0.1659, weighted_loss: 0.0603, label: 1, bag_size: 3493
batch 79, loss: 0.0634, instance_loss: 0.2834, weighted_loss: 0.1294, label: 2, bag_size: 4056
batch 99, loss: 1.2091, instance_loss: 0.8423, weighted_loss: 1.0991, label: 2, bag_size: 1222
batch 119, loss: 1.8610, instance_loss: 0.6733, weighted_loss: 1.5047, label: 0, bag_size: 13770
batch 139, loss: 0.0006, instance_loss: 0.0623, weighted_loss: 0.0191, label: 1, bag_size: 5364
batch 159, loss: 0.1245, instance_loss: 0.3309, weighted_loss: 0.1864, label: 0, bag_size: 1647
batch 179, loss: 0.3133, instance_loss: 1.0242, weighted_loss: 0.5266, label: 1, bag_size: 3596
batch 199, loss: 1.0311, instance_loss: 0.8372, weighted_loss: 0.9730, label: 1, bag_size: 2998
batch 219, loss: 0.1220, instance_loss: 0.1975, weighted_loss: 0.1447, label: 2, bag_size: 4223
batch 239, loss: 0.3744, instance_loss: 0.5524, weighted_loss: 0.4278, label: 0, bag_size: 4509
batch 259, loss: 0.0059, instance_loss: 0.1316, weighted_loss: 0.0436, label: 0, bag_size: 5871
batch 279, loss: 1.0831, instance_loss: 0.8759, weighted_loss: 1.0209, label: 1, bag_size: 2671
batch 299, loss: 0.0646, instance_loss: 0.1651, weighted_loss: 0.0948, label: 2, bag_size: 3026
batch 319, loss: 0.5666, instance_loss: 0.8004, weighted_loss: 0.6368, label: 1, bag_size: 3619
batch 339, loss: 0.0149, instance_loss: 0.2938, weighted_loss: 0.0986, label: 0, bag_size: 2257
batch 359, loss: 0.3894, instance_loss: 0.4243, weighted_loss: 0.3998, label: 1, bag_size: 1410
batch 379, loss: 0.1110, instance_loss: 0.4526, weighted_loss: 0.2135, label: 1, bag_size: 1197
batch 399, loss: 0.1000, instance_loss: 0.2954, weighted_loss: 0.1586, label: 1, bag_size: 3007
batch 419, loss: 0.1806, instance_loss: 0.2937, weighted_loss: 0.2146, label: 2, bag_size: 3546
batch 439, loss: 0.8098, instance_loss: 0.4885, weighted_loss: 0.7134, label: 2, bag_size: 5406
batch 459, loss: 0.1226, instance_loss: 0.2768, weighted_loss: 0.1689, label: 2, bag_size: 3810
batch 479, loss: 0.2350, instance_loss: 0.3230, weighted_loss: 0.2614, label: 2, bag_size: 4745
batch 499, loss: 0.2652, instance_loss: 1.0342, weighted_loss: 0.4959, label: 2, bag_size: 2813
batch 519, loss: 0.0437, instance_loss: 0.2386, weighted_loss: 0.1022, label: 2, bag_size: 1094
batch 539, loss: 0.1308, instance_loss: 0.4061, weighted_loss: 0.2134, label: 0, bag_size: 420
batch 559, loss: 0.1383, instance_loss: 0.7628, weighted_loss: 0.3256, label: 1, bag_size: 4869
batch 579, loss: 0.1468, instance_loss: 0.6678, weighted_loss: 0.3031, label: 0, bag_size: 4337
batch 599, loss: 0.0945, instance_loss: 0.1545, weighted_loss: 0.1125, label: 0, bag_size: 2094
batch 619, loss: 0.0831, instance_loss: 0.1539, weighted_loss: 0.1044, label: 2, bag_size: 3176
batch 639, loss: 0.0449, instance_loss: 0.1702, weighted_loss: 0.0825, label: 2, bag_size: 4745
batch 659, loss: 0.0799, instance_loss: 0.1423, weighted_loss: 0.0986, label: 0, bag_size: 5413
batch 679, loss: 0.0453, instance_loss: 0.0589, weighted_loss: 0.0494, label: 0, bag_size: 9897
batch 699, loss: 0.3150, instance_loss: 0.1904, weighted_loss: 0.2776, label: 2, bag_size: 3397
batch 719, loss: 0.1620, instance_loss: 0.6251, weighted_loss: 0.3009, label: 0, bag_size: 7927
batch 739, loss: 0.3100, instance_loss: 0.2875, weighted_loss: 0.3033, label: 2, bag_size: 3210


class 0 clustering acc 0.9623042505592841: correct 17206/17880
class 1 clustering acc 0.44681208053691274: correct 2663/5960
Epoch: 64, train_loss: 0.4490, train_clustering_loss:  0.5135, train_error: 0.1866
class 0: acc 0.8117647058823529, correct 207/255
class 1: acc 0.7346938775510204, correct 180/245
class 2: acc 0.8938775510204081, correct 219/245

Val Set, val_loss: 0.6727, val_error: 0.2447, auc: 0.8985
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.37632978723404253: correct 283/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0958, instance_loss: 0.2962, weighted_loss: 0.1559, label: 1, bag_size: 3471
batch 39, loss: 0.1375, instance_loss: 0.2447, weighted_loss: 0.1697, label: 2, bag_size: 6644
batch 59, loss: 1.4572, instance_loss: 0.6920, weighted_loss: 1.2276, label: 0, bag_size: 2190
batch 79, loss: 0.0658, instance_loss: 0.6195, weighted_loss: 0.2319, label: 0, bag_size: 1782
batch 99, loss: 0.1796, instance_loss: 0.4852, weighted_loss: 0.2712, label: 1, bag_size: 6689
batch 119, loss: 0.0004, instance_loss: 0.1316, weighted_loss: 0.0397, label: 1, bag_size: 4134
batch 139, loss: 0.0491, instance_loss: 0.1547, weighted_loss: 0.0808, label: 2, bag_size: 3094
batch 159, loss: 0.6540, instance_loss: 0.5878, weighted_loss: 0.6342, label: 1, bag_size: 574
batch 179, loss: 0.0678, instance_loss: 0.3829, weighted_loss: 0.1623, label: 0, bag_size: 1883
batch 199, loss: 0.1062, instance_loss: 0.4036, weighted_loss: 0.1955, label: 0, bag_size: 3833
batch 219, loss: 0.2374, instance_loss: 0.5202, weighted_loss: 0.3222, label: 2, bag_size: 4569
batch 239, loss: 1.6747, instance_loss: 1.0432, weighted_loss: 1.4852, label: 1, bag_size: 6942
batch 259, loss: 0.2096, instance_loss: 0.6101, weighted_loss: 0.3298, label: 1, bag_size: 5276
batch 279, loss: 0.6575, instance_loss: 0.8386, weighted_loss: 0.7118, label: 1, bag_size: 4612
batch 299, loss: 0.0293, instance_loss: 0.1694, weighted_loss: 0.0714, label: 1, bag_size: 3471
batch 319, loss: 0.6056, instance_loss: 0.5260, weighted_loss: 0.5817, label: 1, bag_size: 782
batch 339, loss: 0.0011, instance_loss: 0.0705, weighted_loss: 0.0219, label: 1, bag_size: 5086
batch 359, loss: 0.0227, instance_loss: 0.1568, weighted_loss: 0.0629, label: 1, bag_size: 3493
batch 379, loss: 1.0945, instance_loss: 1.1368, weighted_loss: 1.1072, label: 0, bag_size: 1795
batch 399, loss: 0.0175, instance_loss: 0.1356, weighted_loss: 0.0529, label: 1, bag_size: 3127
batch 419, loss: 1.2344, instance_loss: 1.1332, weighted_loss: 1.2041, label: 1, bag_size: 936
batch 439, loss: 0.2474, instance_loss: 0.4827, weighted_loss: 0.3180, label: 1, bag_size: 712
batch 459, loss: 0.1195, instance_loss: 0.3672, weighted_loss: 0.1938, label: 2, bag_size: 3327
batch 479, loss: 3.5282, instance_loss: 1.4839, weighted_loss: 2.9149, label: 1, bag_size: 2727
batch 499, loss: 0.3857, instance_loss: 0.3440, weighted_loss: 0.3732, label: 1, bag_size: 4708
batch 519, loss: 0.0783, instance_loss: 0.4436, weighted_loss: 0.1879, label: 2, bag_size: 4497
batch 539, loss: 0.0859, instance_loss: 0.1118, weighted_loss: 0.0937, label: 2, bag_size: 4691
batch 559, loss: 0.8977, instance_loss: 0.7758, weighted_loss: 0.8611, label: 0, bag_size: 4647
batch 579, loss: 0.0408, instance_loss: 0.1309, weighted_loss: 0.0678, label: 0, bag_size: 4344
batch 599, loss: 0.0021, instance_loss: 0.4522, weighted_loss: 0.1371, label: 1, bag_size: 5195
batch 619, loss: 0.0391, instance_loss: 0.4969, weighted_loss: 0.1765, label: 2, bag_size: 4745
batch 639, loss: 0.2370, instance_loss: 0.3100, weighted_loss: 0.2589, label: 2, bag_size: 7607
batch 659, loss: 0.4339, instance_loss: 0.5387, weighted_loss: 0.4653, label: 2, bag_size: 4316
batch 679, loss: 0.1633, instance_loss: 0.3397, weighted_loss: 0.2162, label: 0, bag_size: 3571
batch 699, loss: 0.0316, instance_loss: 0.1958, weighted_loss: 0.0808, label: 0, bag_size: 4479
batch 719, loss: 0.1422, instance_loss: 0.3383, weighted_loss: 0.2010, label: 2, bag_size: 5924
batch 739, loss: 0.1081, instance_loss: 0.1720, weighted_loss: 0.1272, label: 0, bag_size: 5953


class 0 clustering acc 0.9672259507829978: correct 17294/17880
class 1 clustering acc 0.45033557046979866: correct 2684/5960
Epoch: 65, train_loss: 0.4158, train_clustering_loss:  0.5018, train_error: 0.1785
class 0: acc 0.83203125, correct 213/256
class 1: acc 0.754863813229572, correct 194/257
class 2: acc 0.8836206896551724, correct 205/232

Val Set, val_loss: 0.5342, val_error: 0.2447, auc: 0.9186
class 0 clustering acc 0.9472517730496454: correct 2137/2256
class 1 clustering acc 0.47074468085106386: correct 354/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.536862 --> 0.534185).  Saving model ...


batch 19, loss: 0.3256, instance_loss: 0.7090, weighted_loss: 0.4406, label: 0, bag_size: 2850
batch 39, loss: 0.5089, instance_loss: 0.9864, weighted_loss: 0.6521, label: 1, bag_size: 3184
batch 59, loss: 0.3085, instance_loss: 0.3619, weighted_loss: 0.3245, label: 2, bag_size: 5743
batch 79, loss: 0.1149, instance_loss: 0.8840, weighted_loss: 0.3456, label: 1, bag_size: 3596
batch 99, loss: 1.1064, instance_loss: 0.9477, weighted_loss: 1.0588, label: 2, bag_size: 1050
batch 119, loss: 0.7518, instance_loss: 0.2998, weighted_loss: 0.6162, label: 2, bag_size: 2049
batch 139, loss: 0.2893, instance_loss: 0.8029, weighted_loss: 0.4434, label: 2, bag_size: 3299
batch 159, loss: 0.0954, instance_loss: 0.3432, weighted_loss: 0.1698, label: 2, bag_size: 5037
batch 179, loss: 0.0811, instance_loss: 0.3511, weighted_loss: 0.1621, label: 2, bag_size: 5914
batch 199, loss: 0.0068, instance_loss: 1.4826, weighted_loss: 0.4495, label: 0, bag_size: 2044
batch 219, loss: 0.4295, instance_loss: 0.3600, weighted_loss: 0.4086, label: 2, bag_size: 597
batch 239, loss: 0.4289, instance_loss: 0.4108, weighted_loss: 0.4234, label: 2, bag_size: 597
batch 259, loss: 0.2997, instance_loss: 0.8075, weighted_loss: 0.4520, label: 2, bag_size: 3475
batch 279, loss: 0.5115, instance_loss: 0.9084, weighted_loss: 0.6306, label: 0, bag_size: 893
batch 299, loss: 0.0015, instance_loss: 0.0707, weighted_loss: 0.0223, label: 0, bag_size: 2139
batch 319, loss: 0.7106, instance_loss: 0.8715, weighted_loss: 0.7589, label: 1, bag_size: 1477
batch 339, loss: 0.8906, instance_loss: 0.7460, weighted_loss: 0.8472, label: 0, bag_size: 3475
batch 359, loss: 0.0256, instance_loss: 0.1842, weighted_loss: 0.0732, label: 0, bag_size: 1883
batch 379, loss: 2.2143, instance_loss: 1.2276, weighted_loss: 1.9183, label: 0, bag_size: 1071
batch 399, loss: 1.8820, instance_loss: 1.2197, weighted_loss: 1.6833, label: 2, bag_size: 2326
batch 419, loss: 0.0235, instance_loss: 0.1549, weighted_loss: 0.0629, label: 2, bag_size: 5138
batch 439, loss: 0.5986, instance_loss: 0.6812, weighted_loss: 0.6234, label: 1, bag_size: 4373
batch 459, loss: 0.0016, instance_loss: 0.6835, weighted_loss: 0.2062, label: 0, bag_size: 2231
batch 479, loss: 1.7024, instance_loss: 1.0066, weighted_loss: 1.4936, label: 1, bag_size: 6942
batch 499, loss: 0.5423, instance_loss: 0.9424, weighted_loss: 0.6623, label: 1, bag_size: 5205
batch 519, loss: 0.1485, instance_loss: 0.5598, weighted_loss: 0.2719, label: 1, bag_size: 4644
batch 539, loss: 0.0064, instance_loss: 0.8015, weighted_loss: 0.2449, label: 1, bag_size: 314
batch 559, loss: 1.6281, instance_loss: 0.9801, weighted_loss: 1.4337, label: 1, bag_size: 2614
batch 579, loss: 0.2115, instance_loss: 0.2487, weighted_loss: 0.2226, label: 0, bag_size: 4700
batch 599, loss: 0.2245, instance_loss: 0.4551, weighted_loss: 0.2937, label: 2, bag_size: 5406
batch 619, loss: 0.0117, instance_loss: 0.4678, weighted_loss: 0.1485, label: 1, bag_size: 3051
batch 639, loss: 0.1235, instance_loss: 0.5019, weighted_loss: 0.2370, label: 0, bag_size: 4922
batch 659, loss: 1.4046, instance_loss: 0.8177, weighted_loss: 1.2285, label: 2, bag_size: 7607
batch 679, loss: 0.2761, instance_loss: 0.2989, weighted_loss: 0.2830, label: 0, bag_size: 2841
batch 699, loss: 0.1824, instance_loss: 0.9527, weighted_loss: 0.4135, label: 1, bag_size: 3596
batch 719, loss: 0.4631, instance_loss: 0.4673, weighted_loss: 0.4644, label: 1, bag_size: 2767
batch 739, loss: 0.0926, instance_loss: 0.3262, weighted_loss: 0.1627, label: 1, bag_size: 3493


class 0 clustering acc 0.966834451901566: correct 17287/17880
class 1 clustering acc 0.43171140939597313: correct 2573/5960
Epoch: 66, train_loss: 0.4324, train_clustering_loss:  0.5101, train_error: 0.1893
class 0: acc 0.8301886792452831, correct 220/265
class 1: acc 0.7211155378486056, correct 181/251
class 2: acc 0.8864628820960698, correct 203/229

Val Set, val_loss: 0.6837, val_error: 0.2660, auc: 0.9142
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.4401595744680851: correct 331/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6, correct 18/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0151, instance_loss: 1.0461, weighted_loss: 1.0244, label: 1, bag_size: 11974
batch 39, loss: 0.0900, instance_loss: 0.4956, weighted_loss: 0.2117, label: 2, bag_size: 6148
batch 59, loss: 0.1303, instance_loss: 0.3931, weighted_loss: 0.2091, label: 0, bag_size: 2153
batch 79, loss: 0.0545, instance_loss: 0.4819, weighted_loss: 0.1827, label: 2, bag_size: 2813
batch 99, loss: 0.1529, instance_loss: 0.7325, weighted_loss: 0.3268, label: 1, bag_size: 2859
batch 119, loss: 0.0286, instance_loss: 0.2023, weighted_loss: 0.0807, label: 0, bag_size: 5036
batch 139, loss: 0.5366, instance_loss: 0.4130, weighted_loss: 0.4995, label: 2, bag_size: 4487
batch 159, loss: 0.1930, instance_loss: 0.5787, weighted_loss: 0.3087, label: 2, bag_size: 2813
batch 179, loss: 0.0370, instance_loss: 0.1355, weighted_loss: 0.0665, label: 0, bag_size: 4326
batch 199, loss: 0.0036, instance_loss: 0.1723, weighted_loss: 0.0542, label: 0, bag_size: 1812
batch 219, loss: 0.1683, instance_loss: 0.3232, weighted_loss: 0.2148, label: 0, bag_size: 2094
batch 239, loss: 1.8674, instance_loss: 0.7291, weighted_loss: 1.5259, label: 0, bag_size: 4719
batch 259, loss: 0.6561, instance_loss: 0.5611, weighted_loss: 0.6276, label: 2, bag_size: 3274
batch 279, loss: 0.0042, instance_loss: 0.0492, weighted_loss: 0.0177, label: 0, bag_size: 5036
batch 299, loss: 0.0000, instance_loss: 0.3031, weighted_loss: 0.0909, label: 0, bag_size: 3445
batch 319, loss: 0.9391, instance_loss: 1.5274, weighted_loss: 1.1156, label: 0, bag_size: 2044
batch 339, loss: 0.7079, instance_loss: 0.3441, weighted_loss: 0.5987, label: 2, bag_size: 3174
batch 359, loss: 0.2233, instance_loss: 0.3786, weighted_loss: 0.2699, label: 2, bag_size: 3618
batch 379, loss: 0.4553, instance_loss: 0.5449, weighted_loss: 0.4822, label: 1, bag_size: 6156
batch 399, loss: 0.1582, instance_loss: 0.4060, weighted_loss: 0.2326, label: 1, bag_size: 1410
batch 419, loss: 0.4519, instance_loss: 0.4932, weighted_loss: 0.4643, label: 0, bag_size: 1170
batch 439, loss: 0.0045, instance_loss: 0.0693, weighted_loss: 0.0239, label: 2, bag_size: 657
batch 459, loss: 0.0037, instance_loss: 0.3580, weighted_loss: 0.1100, label: 0, bag_size: 3344
batch 479, loss: 0.3510, instance_loss: 0.5183, weighted_loss: 0.4012, label: 0, bag_size: 3397
batch 499, loss: 0.1146, instance_loss: 0.2472, weighted_loss: 0.1544, label: 2, bag_size: 4535
batch 519, loss: 2.6501, instance_loss: 1.2136, weighted_loss: 2.2191, label: 1, bag_size: 1313
batch 539, loss: 0.0448, instance_loss: 0.2487, weighted_loss: 0.1060, label: 1, bag_size: 3761
batch 559, loss: 0.0402, instance_loss: 0.2618, weighted_loss: 0.1067, label: 0, bag_size: 4458
batch 579, loss: 0.0565, instance_loss: 0.7563, weighted_loss: 0.2664, label: 0, bag_size: 3743
batch 599, loss: 0.0021, instance_loss: 0.1866, weighted_loss: 0.0574, label: 1, bag_size: 8802
batch 619, loss: 0.0129, instance_loss: 0.0622, weighted_loss: 0.0277, label: 2, bag_size: 2254
batch 639, loss: 0.9360, instance_loss: 0.5808, weighted_loss: 0.8294, label: 0, bag_size: 3156
batch 659, loss: 0.7276, instance_loss: 0.6658, weighted_loss: 0.7090, label: 1, bag_size: 3786
batch 679, loss: 0.0160, instance_loss: 0.0982, weighted_loss: 0.0407, label: 2, bag_size: 4856
batch 699, loss: 0.1675, instance_loss: 0.5191, weighted_loss: 0.2730, label: 1, bag_size: 1161
batch 719, loss: 1.7047, instance_loss: 0.8409, weighted_loss: 1.4455, label: 2, bag_size: 2326
batch 739, loss: 0.0125, instance_loss: 0.0972, weighted_loss: 0.0379, label: 2, bag_size: 4203


class 0 clustering acc 0.9661633109619687: correct 17275/17880
class 1 clustering acc 0.4721476510067114: correct 2814/5960
Epoch: 67, train_loss: 0.4253, train_clustering_loss:  0.4908, train_error: 0.1530
class 0: acc 0.864, correct 216/250
class 1: acc 0.7606837606837606, correct 178/234
class 2: acc 0.9080459770114943, correct 237/261

Val Set, val_loss: 0.8394, val_error: 0.3191, auc: 0.9063
class 0 clustering acc 0.9370567375886525: correct 2114/2256
class 1 clustering acc 0.32978723404255317: correct 248/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.6, correct 18/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0757, instance_loss: 0.3999, weighted_loss: 0.1730, label: 2, bag_size: 4978
batch 39, loss: 1.2571, instance_loss: 1.0140, weighted_loss: 1.1842, label: 1, bag_size: 3837
batch 59, loss: 0.2381, instance_loss: 0.5557, weighted_loss: 0.3334, label: 0, bag_size: 477
batch 79, loss: 0.8853, instance_loss: 0.8234, weighted_loss: 0.8667, label: 1, bag_size: 1477
batch 99, loss: 0.5568, instance_loss: 0.2477, weighted_loss: 0.4640, label: 0, bag_size: 5992
batch 119, loss: 1.1027, instance_loss: 0.4955, weighted_loss: 0.9205, label: 1, bag_size: 3106
batch 139, loss: 0.0412, instance_loss: 0.4209, weighted_loss: 0.1551, label: 0, bag_size: 4707
batch 159, loss: 0.0528, instance_loss: 0.2662, weighted_loss: 0.1168, label: 0, bag_size: 2884
batch 179, loss: 0.0010, instance_loss: 0.2381, weighted_loss: 0.0721, label: 1, bag_size: 3172
batch 199, loss: 0.2203, instance_loss: 0.4005, weighted_loss: 0.2744, label: 0, bag_size: 4282
batch 219, loss: 0.0326, instance_loss: 0.1937, weighted_loss: 0.0809, label: 2, bag_size: 3810
batch 239, loss: 0.5000, instance_loss: 1.2629, weighted_loss: 0.7288, label: 2, bag_size: 4571
batch 259, loss: 1.0797, instance_loss: 0.9602, weighted_loss: 1.0439, label: 1, bag_size: 5402
batch 279, loss: 0.0144, instance_loss: 0.1746, weighted_loss: 0.0625, label: 1, bag_size: 3333
batch 299, loss: 0.0334, instance_loss: 0.1331, weighted_loss: 0.0633, label: 2, bag_size: 3396
batch 319, loss: 1.6335, instance_loss: 1.4011, weighted_loss: 1.5638, label: 1, bag_size: 936
batch 339, loss: 3.4790, instance_loss: 1.4042, weighted_loss: 2.8566, label: 2, bag_size: 1222
batch 359, loss: 1.2569, instance_loss: 0.3927, weighted_loss: 0.9976, label: 0, bag_size: 13770
batch 379, loss: 0.4263, instance_loss: 0.4016, weighted_loss: 0.4189, label: 2, bag_size: 2501
batch 399, loss: 0.3642, instance_loss: 1.0942, weighted_loss: 0.5832, label: 0, bag_size: 477
batch 419, loss: 0.0112, instance_loss: 0.2914, weighted_loss: 0.0952, label: 2, bag_size: 4497
batch 439, loss: 0.5986, instance_loss: 0.6676, weighted_loss: 0.6193, label: 0, bag_size: 1417
batch 459, loss: 0.0344, instance_loss: 0.1591, weighted_loss: 0.0718, label: 0, bag_size: 3289
batch 479, loss: 0.0386, instance_loss: 0.3886, weighted_loss: 0.1436, label: 0, bag_size: 2853
batch 499, loss: 0.0030, instance_loss: 0.0993, weighted_loss: 0.0318, label: 1, bag_size: 7279
batch 519, loss: 0.1926, instance_loss: 0.4979, weighted_loss: 0.2842, label: 0, bag_size: 8611
batch 539, loss: 0.0207, instance_loss: 0.1032, weighted_loss: 0.0454, label: 2, bag_size: 4775
batch 559, loss: 0.0269, instance_loss: 0.3850, weighted_loss: 0.1343, label: 2, bag_size: 4745
batch 579, loss: 0.2193, instance_loss: 0.1082, weighted_loss: 0.1860, label: 2, bag_size: 3583
batch 599, loss: 0.0026, instance_loss: 0.1376, weighted_loss: 0.0431, label: 1, bag_size: 3126
batch 619, loss: 0.1094, instance_loss: 0.3223, weighted_loss: 0.1733, label: 2, bag_size: 3227
batch 639, loss: 0.0950, instance_loss: 0.2268, weighted_loss: 0.1345, label: 2, bag_size: 3327
batch 659, loss: 0.5887, instance_loss: 0.7851, weighted_loss: 0.6476, label: 0, bag_size: 14218
batch 679, loss: 0.0411, instance_loss: 0.4609, weighted_loss: 0.1671, label: 0, bag_size: 4865
batch 699, loss: 0.1812, instance_loss: 0.2170, weighted_loss: 0.1919, label: 2, bag_size: 4788
batch 719, loss: 0.0516, instance_loss: 0.2043, weighted_loss: 0.0974, label: 1, bag_size: 3007
batch 739, loss: 0.6915, instance_loss: 0.9254, weighted_loss: 0.7616, label: 1, bag_size: 1371


class 0 clustering acc 0.966834451901566: correct 17287/17880
class 1 clustering acc 0.4842281879194631: correct 2886/5960
Epoch: 68, train_loss: 0.3829, train_clustering_loss:  0.4761, train_error: 0.1557
class 0: acc 0.8664122137404581, correct 227/262
class 1: acc 0.7547892720306514, correct 197/261
class 2: acc 0.9234234234234234, correct 205/222

Val Set, val_loss: 0.8447, val_error: 0.2766, auc: 0.9061
class 0 clustering acc 0.9445921985815603: correct 2131/2256
class 1 clustering acc 0.42686170212765956: correct 321/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0451, instance_loss: 0.2252, weighted_loss: 0.0991, label: 2, bag_size: 4775
batch 39, loss: 0.0237, instance_loss: 0.1703, weighted_loss: 0.0677, label: 0, bag_size: 5437
batch 59, loss: 0.8806, instance_loss: 0.4090, weighted_loss: 0.7392, label: 1, bag_size: 1221
batch 79, loss: 0.1072, instance_loss: 0.2482, weighted_loss: 0.1495, label: 2, bag_size: 5406
batch 99, loss: 0.7487, instance_loss: 0.5529, weighted_loss: 0.6900, label: 2, bag_size: 1222
batch 119, loss: 0.0304, instance_loss: 0.2955, weighted_loss: 0.1099, label: 0, bag_size: 4351
batch 139, loss: 0.2508, instance_loss: 0.2791, weighted_loss: 0.2593, label: 2, bag_size: 3778
batch 159, loss: 0.0954, instance_loss: 0.2842, weighted_loss: 0.1520, label: 0, bag_size: 1049
batch 179, loss: 0.0029, instance_loss: 0.1044, weighted_loss: 0.0334, label: 0, bag_size: 4196
batch 199, loss: 0.3335, instance_loss: 0.4578, weighted_loss: 0.3708, label: 2, bag_size: 5472
batch 219, loss: 0.0011, instance_loss: 0.1081, weighted_loss: 0.0332, label: 1, bag_size: 8802
batch 239, loss: 0.1295, instance_loss: 0.2527, weighted_loss: 0.1664, label: 0, bag_size: 2487
batch 259, loss: 0.0244, instance_loss: 0.1466, weighted_loss: 0.0611, label: 2, bag_size: 4745
batch 279, loss: 0.4524, instance_loss: 0.4853, weighted_loss: 0.4623, label: 2, bag_size: 4241
batch 299, loss: 0.0041, instance_loss: 0.0632, weighted_loss: 0.0219, label: 2, bag_size: 3285
batch 319, loss: 0.2503, instance_loss: 0.3840, weighted_loss: 0.2904, label: 1, bag_size: 3586
batch 339, loss: 0.5267, instance_loss: 0.9122, weighted_loss: 0.6423, label: 1, bag_size: 1122
batch 359, loss: 0.0975, instance_loss: 0.2117, weighted_loss: 0.1318, label: 1, bag_size: 3398
batch 379, loss: 0.0271, instance_loss: 0.1188, weighted_loss: 0.0546, label: 0, bag_size: 3901
batch 399, loss: 0.0138, instance_loss: 0.0784, weighted_loss: 0.0331, label: 1, bag_size: 3493
batch 419, loss: 0.0321, instance_loss: 0.1762, weighted_loss: 0.0753, label: 2, bag_size: 3327
batch 439, loss: 0.1366, instance_loss: 0.2116, weighted_loss: 0.1591, label: 2, bag_size: 4302
batch 459, loss: 0.2165, instance_loss: 0.5116, weighted_loss: 0.3050, label: 2, bag_size: 4497
batch 479, loss: 0.5450, instance_loss: 0.6936, weighted_loss: 0.5896, label: 1, bag_size: 2302
batch 499, loss: 0.8229, instance_loss: 0.6662, weighted_loss: 0.7759, label: 1, bag_size: 5197
batch 519, loss: 1.8130, instance_loss: 0.7731, weighted_loss: 1.5010, label: 2, bag_size: 2326
batch 539, loss: 0.3642, instance_loss: 0.3412, weighted_loss: 0.3573, label: 2, bag_size: 2049
batch 559, loss: 1.7078, instance_loss: 1.0362, weighted_loss: 1.5063, label: 0, bag_size: 8866
batch 579, loss: 0.0000, instance_loss: 0.3734, weighted_loss: 0.1120, label: 0, bag_size: 1055
batch 599, loss: 0.0255, instance_loss: 0.3201, weighted_loss: 0.1139, label: 0, bag_size: 3297
batch 619, loss: 0.2786, instance_loss: 0.3196, weighted_loss: 0.2909, label: 0, bag_size: 4245
batch 639, loss: 0.0568, instance_loss: 0.2074, weighted_loss: 0.1020, label: 2, bag_size: 3227
batch 659, loss: 0.0000, instance_loss: 0.0478, weighted_loss: 0.0143, label: 1, bag_size: 5462
batch 679, loss: 0.2069, instance_loss: 0.3795, weighted_loss: 0.2587, label: 1, bag_size: 2156
batch 699, loss: 0.2409, instance_loss: 0.2291, weighted_loss: 0.2374, label: 2, bag_size: 3227
batch 719, loss: 0.9415, instance_loss: 0.6858, weighted_loss: 0.8648, label: 1, bag_size: 4200
batch 739, loss: 0.0081, instance_loss: 0.1071, weighted_loss: 0.0378, label: 2, bag_size: 5138


class 0 clustering acc 0.964765100671141: correct 17250/17880
class 1 clustering acc 0.47365771812080537: correct 2823/5960
Epoch: 69, train_loss: 0.4214, train_clustering_loss:  0.4916, train_error: 0.1678
class 0: acc 0.8725099601593626, correct 219/251
class 1: acc 0.7587548638132295, correct 195/257
class 2: acc 0.869198312236287, correct 206/237

Val Set, val_loss: 0.8093, val_error: 0.3085, auc: 0.9043
class 0 clustering acc 0.9264184397163121: correct 2090/2256
class 1 clustering acc 0.3683510638297872: correct 277/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.6032, instance_loss: 1.2455, weighted_loss: 2.1959, label: 0, bag_size: 455
batch 39, loss: 0.6762, instance_loss: 1.5549, weighted_loss: 0.9398, label: 1, bag_size: 3791
batch 59, loss: 0.0610, instance_loss: 0.2325, weighted_loss: 0.1124, label: 2, bag_size: 6644
batch 79, loss: 0.0075, instance_loss: 0.1699, weighted_loss: 0.0562, label: 2, bag_size: 3121
batch 99, loss: 0.1273, instance_loss: 0.1410, weighted_loss: 0.1314, label: 0, bag_size: 4325
batch 119, loss: 0.6389, instance_loss: 0.4076, weighted_loss: 0.5695, label: 1, bag_size: 3109
batch 139, loss: 0.2780, instance_loss: 0.4431, weighted_loss: 0.3275, label: 1, bag_size: 3586
batch 159, loss: 0.5443, instance_loss: 0.9788, weighted_loss: 0.6747, label: 1, bag_size: 869
batch 179, loss: 0.1078, instance_loss: 0.2515, weighted_loss: 0.1509, label: 0, bag_size: 4584
batch 199, loss: 0.0465, instance_loss: 0.1482, weighted_loss: 0.0770, label: 1, bag_size: 7279
batch 219, loss: 0.0406, instance_loss: 0.2023, weighted_loss: 0.0891, label: 2, bag_size: 6026
batch 239, loss: 10.5088, instance_loss: 2.6976, weighted_loss: 8.1655, label: 0, bag_size: 2231
batch 259, loss: 1.4193, instance_loss: 0.9083, weighted_loss: 1.2660, label: 2, bag_size: 361
batch 279, loss: 0.5634, instance_loss: 0.8085, weighted_loss: 0.6369, label: 1, bag_size: 4612
batch 299, loss: 0.0944, instance_loss: 0.4092, weighted_loss: 0.1888, label: 0, bag_size: 2852
batch 319, loss: 0.7073, instance_loss: 0.3428, weighted_loss: 0.5979, label: 1, bag_size: 3333
batch 339, loss: 0.1175, instance_loss: 0.2969, weighted_loss: 0.1713, label: 1, bag_size: 2809
batch 359, loss: 0.0627, instance_loss: 0.2734, weighted_loss: 0.1259, label: 0, bag_size: 2756
batch 379, loss: 0.1710, instance_loss: 0.3763, weighted_loss: 0.2325, label: 1, bag_size: 596
batch 399, loss: 0.0264, instance_loss: 0.0972, weighted_loss: 0.0477, label: 2, bag_size: 657
batch 419, loss: 0.1466, instance_loss: 0.5858, weighted_loss: 0.2784, label: 1, bag_size: 4940
batch 439, loss: 0.9042, instance_loss: 1.0823, weighted_loss: 0.9576, label: 2, bag_size: 4316
batch 459, loss: 0.1108, instance_loss: 0.7514, weighted_loss: 0.3030, label: 1, bag_size: 2472
batch 479, loss: 0.0006, instance_loss: 0.2784, weighted_loss: 0.0839, label: 1, bag_size: 5229
batch 499, loss: 0.8704, instance_loss: 0.8324, weighted_loss: 0.8590, label: 1, bag_size: 2055
batch 519, loss: 0.0498, instance_loss: 0.1313, weighted_loss: 0.0742, label: 2, bag_size: 4788
batch 539, loss: 0.8206, instance_loss: 0.4512, weighted_loss: 0.7097, label: 0, bag_size: 2830
batch 559, loss: 1.0894, instance_loss: 0.9382, weighted_loss: 1.0440, label: 1, bag_size: 5693
batch 579, loss: 0.1684, instance_loss: 0.6662, weighted_loss: 0.3178, label: 1, bag_size: 6152
batch 599, loss: 0.2534, instance_loss: 0.2194, weighted_loss: 0.2432, label: 2, bag_size: 4241
batch 619, loss: 0.0111, instance_loss: 0.1089, weighted_loss: 0.0404, label: 2, bag_size: 4856
batch 639, loss: 0.0078, instance_loss: 0.0968, weighted_loss: 0.0345, label: 0, bag_size: 5282
batch 659, loss: 0.1483, instance_loss: 0.3452, weighted_loss: 0.2074, label: 0, bag_size: 4282
batch 679, loss: 0.0512, instance_loss: 0.3401, weighted_loss: 0.1378, label: 1, bag_size: 4898
batch 699, loss: 0.1177, instance_loss: 0.2852, weighted_loss: 0.1680, label: 0, bag_size: 2286
batch 719, loss: 0.0664, instance_loss: 0.2466, weighted_loss: 0.1204, label: 2, bag_size: 5914
batch 739, loss: 0.1407, instance_loss: 0.2662, weighted_loss: 0.1783, label: 0, bag_size: 2756


class 0 clustering acc 0.9670022371364653: correct 17290/17880
class 1 clustering acc 0.42063758389261746: correct 2507/5960
Epoch: 70, train_loss: 0.4635, train_clustering_loss:  0.5150, train_error: 0.1799
class 0: acc 0.8554216867469879, correct 213/249
class 1: acc 0.7176470588235294, correct 183/255
class 2: acc 0.8921161825726142, correct 215/241

Val Set, val_loss: 0.7778, val_error: 0.3404, auc: 0.9073
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.39893617021276595: correct 300/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0937, instance_loss: 0.3580, weighted_loss: 0.1730, label: 1, bag_size: 4708
batch 39, loss: 0.0198, instance_loss: 0.4130, weighted_loss: 0.1377, label: 0, bag_size: 3666
batch 59, loss: 0.0213, instance_loss: 0.1397, weighted_loss: 0.0568, label: 0, bag_size: 3038
batch 79, loss: 0.5221, instance_loss: 0.3515, weighted_loss: 0.4710, label: 0, bag_size: 3639
batch 99, loss: 2.6443, instance_loss: 1.2339, weighted_loss: 2.2212, label: 0, bag_size: 7504
batch 119, loss: 0.0000, instance_loss: 0.2914, weighted_loss: 0.0874, label: 1, bag_size: 3156
batch 139, loss: 0.0008, instance_loss: 1.0330, weighted_loss: 0.3104, label: 0, bag_size: 1645
batch 159, loss: 0.2674, instance_loss: 0.3109, weighted_loss: 0.2805, label: 2, bag_size: 597
batch 179, loss: 0.0898, instance_loss: 0.1910, weighted_loss: 0.1201, label: 2, bag_size: 5017
batch 199, loss: 0.0428, instance_loss: 0.3263, weighted_loss: 0.1278, label: 1, bag_size: 3471
batch 219, loss: 0.2677, instance_loss: 0.3344, weighted_loss: 0.2877, label: 2, bag_size: 5924
batch 239, loss: 0.1965, instance_loss: 0.5714, weighted_loss: 0.3090, label: 0, bag_size: 614
batch 259, loss: 0.0123, instance_loss: 0.0544, weighted_loss: 0.0249, label: 2, bag_size: 3285
batch 279, loss: 1.1420, instance_loss: 0.6156, weighted_loss: 0.9841, label: 2, bag_size: 909
batch 299, loss: 0.0110, instance_loss: 0.2096, weighted_loss: 0.0706, label: 1, bag_size: 2809
batch 319, loss: 0.0018, instance_loss: 0.0444, weighted_loss: 0.0146, label: 1, bag_size: 5026
batch 339, loss: 0.0627, instance_loss: 0.2356, weighted_loss: 0.1146, label: 0, bag_size: 4808
batch 359, loss: 0.1825, instance_loss: 0.3645, weighted_loss: 0.2371, label: 1, bag_size: 3640
batch 379, loss: 0.0717, instance_loss: 0.3075, weighted_loss: 0.1425, label: 0, bag_size: 4196
batch 399, loss: 0.1590, instance_loss: 0.4173, weighted_loss: 0.2365, label: 0, bag_size: 3475
batch 419, loss: 0.4842, instance_loss: 0.4385, weighted_loss: 0.4705, label: 0, bag_size: 4245
batch 439, loss: 0.0437, instance_loss: 0.5890, weighted_loss: 0.2073, label: 0, bag_size: 4626
batch 459, loss: 0.0353, instance_loss: 0.1146, weighted_loss: 0.0591, label: 0, bag_size: 3855
batch 479, loss: 2.6561, instance_loss: 1.2724, weighted_loss: 2.2410, label: 1, bag_size: 6942
batch 499, loss: 0.0632, instance_loss: 0.2214, weighted_loss: 0.1107, label: 2, bag_size: 4241
batch 519, loss: 0.0717, instance_loss: 0.1575, weighted_loss: 0.0974, label: 2, bag_size: 6148
batch 539, loss: 0.0519, instance_loss: 0.2372, weighted_loss: 0.1075, label: 2, bag_size: 5037
batch 559, loss: 0.1562, instance_loss: 0.3349, weighted_loss: 0.2098, label: 2, bag_size: 6298
batch 579, loss: 1.7091, instance_loss: 1.4306, weighted_loss: 1.6255, label: 1, bag_size: 4200
batch 599, loss: 1.4633, instance_loss: 0.7446, weighted_loss: 1.2477, label: 1, bag_size: 3786
batch 619, loss: 0.1136, instance_loss: 0.3839, weighted_loss: 0.1947, label: 0, bag_size: 3834
batch 639, loss: 0.2302, instance_loss: 0.2289, weighted_loss: 0.2298, label: 2, bag_size: 4192
batch 659, loss: 0.0000, instance_loss: 0.3357, weighted_loss: 0.1007, label: 1, bag_size: 5229
batch 679, loss: 0.0070, instance_loss: 0.1752, weighted_loss: 0.0575, label: 0, bag_size: 3437
batch 699, loss: 0.0491, instance_loss: 0.4574, weighted_loss: 0.1716, label: 1, bag_size: 6475
batch 719, loss: 0.1732, instance_loss: 1.0151, weighted_loss: 0.4258, label: 0, bag_size: 3341
batch 739, loss: 0.1763, instance_loss: 0.1634, weighted_loss: 0.1724, label: 0, bag_size: 5413


class 0 clustering acc 0.9615771812080537: correct 17193/17880
class 1 clustering acc 0.48976510067114093: correct 2919/5960
Epoch: 71, train_loss: 0.4079, train_clustering_loss:  0.4955, train_error: 0.1463
class 0: acc 0.8745098039215686, correct 223/255
class 1: acc 0.7488584474885844, correct 164/219
class 2: acc 0.9188191881918819, correct 249/271

Val Set, val_loss: 0.5687, val_error: 0.2447, auc: 0.9252
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.4654255319148936: correct 350/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1988, instance_loss: 0.4174, weighted_loss: 0.2644, label: 0, bag_size: 1495
batch 39, loss: 0.4070, instance_loss: 0.7504, weighted_loss: 0.5100, label: 2, bag_size: 4342
batch 59, loss: 0.2041, instance_loss: 0.1642, weighted_loss: 0.1921, label: 2, bag_size: 614
batch 79, loss: 0.2011, instance_loss: 0.4959, weighted_loss: 0.2896, label: 1, bag_size: 5532
batch 99, loss: 0.4274, instance_loss: 0.3046, weighted_loss: 0.3905, label: 2, bag_size: 3174
batch 119, loss: 0.0317, instance_loss: 0.1339, weighted_loss: 0.0623, label: 2, bag_size: 3285
batch 139, loss: 0.2526, instance_loss: 0.4494, weighted_loss: 0.3117, label: 1, bag_size: 4184
batch 159, loss: 1.5726, instance_loss: 0.8818, weighted_loss: 1.3653, label: 1, bag_size: 5423
batch 179, loss: 0.0313, instance_loss: 0.2860, weighted_loss: 0.1077, label: 1, bag_size: 3885
batch 199, loss: 0.1618, instance_loss: 0.4423, weighted_loss: 0.2460, label: 1, bag_size: 3396
batch 219, loss: 0.0238, instance_loss: 0.2383, weighted_loss: 0.0882, label: 0, bag_size: 3530
batch 239, loss: 0.0110, instance_loss: 0.4454, weighted_loss: 0.1413, label: 1, bag_size: 455
batch 259, loss: 1.3355, instance_loss: 1.7920, weighted_loss: 1.4725, label: 1, bag_size: 5205
batch 279, loss: 0.0269, instance_loss: 0.1087, weighted_loss: 0.0515, label: 2, bag_size: 4555
batch 299, loss: 0.0833, instance_loss: 0.1412, weighted_loss: 0.1007, label: 2, bag_size: 4223
batch 319, loss: 0.2447, instance_loss: 0.5557, weighted_loss: 0.3380, label: 2, bag_size: 3299
batch 339, loss: 0.2379, instance_loss: 0.2317, weighted_loss: 0.2361, label: 2, bag_size: 2561
batch 359, loss: 0.0026, instance_loss: 0.0343, weighted_loss: 0.0121, label: 2, bag_size: 4856
batch 379, loss: 0.4810, instance_loss: 0.8477, weighted_loss: 0.5910, label: 0, bag_size: 2826
batch 399, loss: 0.8810, instance_loss: 0.4255, weighted_loss: 0.7444, label: 0, bag_size: 5098
batch 419, loss: 0.1075, instance_loss: 0.5419, weighted_loss: 0.2378, label: 0, bag_size: 23335
batch 439, loss: 0.1233, instance_loss: 0.3818, weighted_loss: 0.2009, label: 2, bag_size: 6594
batch 459, loss: 0.7881, instance_loss: 0.8122, weighted_loss: 0.7953, label: 2, bag_size: 4241
batch 479, loss: 0.0905, instance_loss: 0.4131, weighted_loss: 0.1873, label: 0, bag_size: 2153
batch 499, loss: 0.1558, instance_loss: 0.2614, weighted_loss: 0.1875, label: 2, bag_size: 6704
batch 519, loss: 0.1016, instance_loss: 0.2332, weighted_loss: 0.1411, label: 2, bag_size: 5037
batch 539, loss: 1.6676, instance_loss: 0.7628, weighted_loss: 1.3962, label: 0, bag_size: 2190
batch 559, loss: 0.4684, instance_loss: 0.6272, weighted_loss: 0.5160, label: 1, bag_size: 209
batch 579, loss: 0.0127, instance_loss: 0.8790, weighted_loss: 0.2726, label: 0, bag_size: 4485
batch 599, loss: 0.1148, instance_loss: 0.4652, weighted_loss: 0.2199, label: 1, bag_size: 3403
batch 619, loss: 0.4437, instance_loss: 0.3730, weighted_loss: 0.4225, label: 2, bag_size: 3026
batch 639, loss: 0.6305, instance_loss: 0.3377, weighted_loss: 0.5427, label: 0, bag_size: 4614
batch 659, loss: 0.0038, instance_loss: 0.0462, weighted_loss: 0.0165, label: 0, bag_size: 1825
batch 679, loss: 0.4703, instance_loss: 0.6065, weighted_loss: 0.5112, label: 1, bag_size: 5197
batch 699, loss: 0.1324, instance_loss: 0.2351, weighted_loss: 0.1632, label: 2, bag_size: 3227
batch 719, loss: 0.0279, instance_loss: 0.0966, weighted_loss: 0.0485, label: 2, bag_size: 4192
batch 739, loss: 0.6721, instance_loss: 0.6956, weighted_loss: 0.6792, label: 0, bag_size: 3936


class 0 clustering acc 0.9649328859060403: correct 17253/17880
class 1 clustering acc 0.49899328859060404: correct 2974/5960
Epoch: 72, train_loss: 0.3830, train_clustering_loss:  0.4765, train_error: 0.1503
class 0: acc 0.8571428571428571, correct 216/252
class 1: acc 0.7848605577689243, correct 197/251
class 2: acc 0.9090909090909091, correct 220/242

Val Set, val_loss: 0.6830, val_error: 0.2660, auc: 0.9183
class 0 clustering acc 0.9570035460992907: correct 2159/2256
class 1 clustering acc 0.4654255319148936: correct 350/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0093, instance_loss: 0.1975, weighted_loss: 0.0658, label: 1, bag_size: 1023
batch 39, loss: 0.0333, instance_loss: 0.1757, weighted_loss: 0.0760, label: 1, bag_size: 3050
batch 59, loss: 0.0250, instance_loss: 0.1133, weighted_loss: 0.0515, label: 2, bag_size: 4856
batch 79, loss: 0.5946, instance_loss: 0.6091, weighted_loss: 0.5990, label: 2, bag_size: 3583
batch 99, loss: 0.0450, instance_loss: 0.2796, weighted_loss: 0.1154, label: 1, bag_size: 7135
batch 119, loss: 0.7669, instance_loss: 0.6064, weighted_loss: 0.7187, label: 2, bag_size: 7607
batch 139, loss: 0.2519, instance_loss: 0.3954, weighted_loss: 0.2950, label: 0, bag_size: 3586
batch 159, loss: 1.6823, instance_loss: 1.0852, weighted_loss: 1.5032, label: 0, bag_size: 1492
batch 179, loss: 0.3747, instance_loss: 0.5173, weighted_loss: 0.4175, label: 1, bag_size: 4599
batch 199, loss: 0.0364, instance_loss: 0.1273, weighted_loss: 0.0637, label: 2, bag_size: 3415
batch 219, loss: 0.0249, instance_loss: 0.1011, weighted_loss: 0.0478, label: 2, bag_size: 1094
batch 239, loss: 0.0149, instance_loss: 0.0674, weighted_loss: 0.0306, label: 2, bag_size: 3285
batch 259, loss: 0.9248, instance_loss: 0.8218, weighted_loss: 0.8939, label: 2, bag_size: 361
batch 279, loss: 0.0753, instance_loss: 0.2321, weighted_loss: 0.1223, label: 1, bag_size: 4898
batch 299, loss: 0.0067, instance_loss: 0.0370, weighted_loss: 0.0158, label: 2, bag_size: 4856
batch 319, loss: 1.2843, instance_loss: 1.4571, weighted_loss: 1.3361, label: 1, bag_size: 3837
batch 339, loss: 0.1644, instance_loss: 0.3199, weighted_loss: 0.2110, label: 0, bag_size: 2927
batch 359, loss: 0.1998, instance_loss: 0.3747, weighted_loss: 0.2523, label: 1, bag_size: 6315
batch 379, loss: 0.0507, instance_loss: 0.1492, weighted_loss: 0.0803, label: 2, bag_size: 2359
batch 399, loss: 0.0200, instance_loss: 0.0976, weighted_loss: 0.0433, label: 2, bag_size: 3415
batch 419, loss: 0.1380, instance_loss: 0.5793, weighted_loss: 0.2704, label: 2, bag_size: 4179
batch 439, loss: 0.0077, instance_loss: 0.5632, weighted_loss: 0.1743, label: 1, bag_size: 3265
batch 459, loss: 0.0514, instance_loss: 0.2304, weighted_loss: 0.1051, label: 2, bag_size: 6594
batch 479, loss: 0.0645, instance_loss: 0.1554, weighted_loss: 0.0918, label: 2, bag_size: 4302
batch 499, loss: 0.6958, instance_loss: 0.2284, weighted_loss: 0.5556, label: 1, bag_size: 758
batch 519, loss: 0.5451, instance_loss: 0.2769, weighted_loss: 0.4646, label: 2, bag_size: 3172
batch 539, loss: 0.0310, instance_loss: 0.3317, weighted_loss: 0.1212, label: 0, bag_size: 3188
batch 559, loss: 0.0010, instance_loss: 0.4090, weighted_loss: 0.1234, label: 0, bag_size: 5837
batch 579, loss: 0.1761, instance_loss: 0.6430, weighted_loss: 0.3162, label: 1, bag_size: 209
batch 599, loss: 0.3958, instance_loss: 0.9322, weighted_loss: 0.5567, label: 0, bag_size: 4146
batch 619, loss: 0.0356, instance_loss: 0.0926, weighted_loss: 0.0527, label: 0, bag_size: 1194
batch 639, loss: 0.1257, instance_loss: 0.4885, weighted_loss: 0.2345, label: 1, bag_size: 2859
batch 659, loss: 0.0141, instance_loss: 0.7833, weighted_loss: 0.2449, label: 1, bag_size: 20666
batch 679, loss: 1.3040, instance_loss: 0.9143, weighted_loss: 1.1871, label: 0, bag_size: 4378
batch 699, loss: 0.0001, instance_loss: 0.0830, weighted_loss: 0.0250, label: 1, bag_size: 3043
batch 719, loss: 0.2948, instance_loss: 0.4963, weighted_loss: 0.3552, label: 0, bag_size: 4946
batch 739, loss: 0.0226, instance_loss: 0.7903, weighted_loss: 0.2529, label: 1, bag_size: 20666


class 0 clustering acc 0.9652684563758389: correct 17259/17880
class 1 clustering acc 0.49714765100671143: correct 2963/5960
Epoch: 73, train_loss: 0.3837, train_clustering_loss:  0.4782, train_error: 0.1530
class 0: acc 0.8497854077253219, correct 198/233
class 1: acc 0.792, correct 198/250
class 2: acc 0.8969465648854962, correct 235/262

Val Set, val_loss: 0.6480, val_error: 0.2553, auc: 0.9164
class 0 clustering acc 0.9596631205673759: correct 2165/2256
class 1 clustering acc 0.4946808510638298: correct 372/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3340, instance_loss: 0.4547, weighted_loss: 0.3702, label: 0, bag_size: 3532
batch 39, loss: 0.0005, instance_loss: 0.1888, weighted_loss: 0.0570, label: 1, bag_size: 4181
batch 59, loss: 0.0000, instance_loss: 0.0271, weighted_loss: 0.0081, label: 1, bag_size: 5018
batch 79, loss: 0.1210, instance_loss: 0.2156, weighted_loss: 0.1494, label: 2, bag_size: 3210
batch 99, loss: 0.0335, instance_loss: 0.2099, weighted_loss: 0.0864, label: 0, bag_size: 1744
batch 119, loss: 0.0000, instance_loss: 0.1357, weighted_loss: 0.0407, label: 2, bag_size: 3607
batch 139, loss: 0.0008, instance_loss: 0.2005, weighted_loss: 0.0607, label: 0, bag_size: 3219
batch 159, loss: 0.0114, instance_loss: 0.0900, weighted_loss: 0.0350, label: 0, bag_size: 471
batch 179, loss: 0.1695, instance_loss: 0.5497, weighted_loss: 0.2836, label: 0, bag_size: 3070
batch 199, loss: 0.2955, instance_loss: 0.9371, weighted_loss: 0.4880, label: 1, bag_size: 3438
batch 219, loss: 0.0094, instance_loss: 0.0748, weighted_loss: 0.0290, label: 2, bag_size: 3396
batch 239, loss: 0.0064, instance_loss: 0.0527, weighted_loss: 0.0203, label: 2, bag_size: 3285
batch 259, loss: 0.3233, instance_loss: 0.7584, weighted_loss: 0.4538, label: 2, bag_size: 4316
batch 279, loss: 0.0000, instance_loss: 0.0458, weighted_loss: 0.0138, label: 1, bag_size: 4534
batch 299, loss: 1.4588, instance_loss: 1.1022, weighted_loss: 1.3518, label: 1, bag_size: 5011
batch 319, loss: 0.0080, instance_loss: 0.2411, weighted_loss: 0.0779, label: 0, bag_size: 5893
batch 339, loss: 0.0010, instance_loss: 0.3593, weighted_loss: 0.1085, label: 0, bag_size: 3344
batch 359, loss: 1.1201, instance_loss: 1.2987, weighted_loss: 1.1737, label: 1, bag_size: 3261
batch 379, loss: 0.0243, instance_loss: 0.3066, weighted_loss: 0.1090, label: 2, bag_size: 88
batch 399, loss: 0.0576, instance_loss: 0.0980, weighted_loss: 0.0697, label: 2, bag_size: 3678
batch 419, loss: 0.2544, instance_loss: 0.3614, weighted_loss: 0.2865, label: 0, bag_size: 4310
batch 439, loss: 0.2638, instance_loss: 0.5342, weighted_loss: 0.3449, label: 2, bag_size: 2813
batch 459, loss: 1.1479, instance_loss: 0.4617, weighted_loss: 0.9420, label: 1, bag_size: 6993
batch 479, loss: 0.0311, instance_loss: 0.3761, weighted_loss: 0.1346, label: 0, bag_size: 5373
batch 499, loss: 0.2845, instance_loss: 0.4578, weighted_loss: 0.3365, label: 2, bag_size: 6298
batch 519, loss: 0.0216, instance_loss: 0.0613, weighted_loss: 0.0335, label: 0, bag_size: 9897
batch 539, loss: 0.1694, instance_loss: 0.2627, weighted_loss: 0.1974, label: 1, bag_size: 368
batch 559, loss: 0.0648, instance_loss: 0.2012, weighted_loss: 0.1057, label: 2, bag_size: 4745
batch 579, loss: 0.0127, instance_loss: 0.0962, weighted_loss: 0.0378, label: 2, bag_size: 6148
batch 599, loss: 0.0103, instance_loss: 0.1704, weighted_loss: 0.0583, label: 2, bag_size: 4056
batch 619, loss: 0.0103, instance_loss: 0.1369, weighted_loss: 0.0483, label: 0, bag_size: 5170
batch 639, loss: 0.1232, instance_loss: 0.6127, weighted_loss: 0.2701, label: 0, bag_size: 2852
batch 659, loss: 0.0577, instance_loss: 0.7129, weighted_loss: 0.2542, label: 1, bag_size: 3508
batch 679, loss: 0.0995, instance_loss: 0.1173, weighted_loss: 0.1048, label: 2, bag_size: 3210
batch 699, loss: 2.5936, instance_loss: 1.3890, weighted_loss: 2.2322, label: 1, bag_size: 12936
batch 719, loss: 0.2577, instance_loss: 0.3814, weighted_loss: 0.2948, label: 2, bag_size: 5037
batch 739, loss: 1.3838, instance_loss: 1.0950, weighted_loss: 1.2972, label: 1, bag_size: 817


class 0 clustering acc 0.9673937360178971: correct 17297/17880
class 1 clustering acc 0.4924496644295302: correct 2935/5960
Epoch: 74, train_loss: 0.3966, train_clustering_loss:  0.4704, train_error: 0.1530
class 0: acc 0.8514056224899599, correct 212/249
class 1: acc 0.7445887445887446, correct 172/231
class 2: acc 0.9320754716981132, correct 247/265

Val Set, val_loss: 0.5354, val_error: 0.2872, auc: 0.9173
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.48936170212765956: correct 368/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0446, instance_loss: 0.2875, weighted_loss: 0.1174, label: 1, bag_size: 3493
batch 39, loss: 0.1902, instance_loss: 0.1316, weighted_loss: 0.1726, label: 0, bag_size: 1353
batch 59, loss: 1.1029, instance_loss: 0.6315, weighted_loss: 0.9615, label: 1, bag_size: 6993
batch 79, loss: 0.0021, instance_loss: 0.1212, weighted_loss: 0.0378, label: 0, bag_size: 7595
batch 99, loss: 0.0049, instance_loss: 0.0772, weighted_loss: 0.0266, label: 2, bag_size: 4745
batch 119, loss: 0.7500, instance_loss: 0.7483, weighted_loss: 0.7495, label: 0, bag_size: 4310
batch 139, loss: 0.1119, instance_loss: 0.3118, weighted_loss: 0.1719, label: 1, bag_size: 758
batch 159, loss: 0.1103, instance_loss: 0.2460, weighted_loss: 0.1510, label: 2, bag_size: 2359
batch 179, loss: 0.3621, instance_loss: 0.8732, weighted_loss: 0.5154, label: 2, bag_size: 22464
batch 199, loss: 0.2367, instance_loss: 0.6691, weighted_loss: 0.3664, label: 2, bag_size: 223
batch 219, loss: 0.1589, instance_loss: 0.6273, weighted_loss: 0.2994, label: 2, bag_size: 361
batch 239, loss: 0.0381, instance_loss: 0.0922, weighted_loss: 0.0543, label: 0, bag_size: 3334
batch 259, loss: 1.3638, instance_loss: 0.7660, weighted_loss: 1.1845, label: 0, bag_size: 3834
batch 279, loss: 0.3983, instance_loss: 0.7810, weighted_loss: 0.5131, label: 1, bag_size: 2083
batch 299, loss: 0.9963, instance_loss: 0.7186, weighted_loss: 0.9130, label: 0, bag_size: 4719
batch 319, loss: 0.0018, instance_loss: 0.1221, weighted_loss: 0.0379, label: 1, bag_size: 3043
batch 339, loss: 0.2315, instance_loss: 1.0259, weighted_loss: 0.4698, label: 1, bag_size: 5718
batch 359, loss: 0.0588, instance_loss: 0.3115, weighted_loss: 0.1346, label: 1, bag_size: 3437
batch 379, loss: 0.0247, instance_loss: 0.4266, weighted_loss: 0.1453, label: 0, bag_size: 4918
batch 399, loss: 0.3318, instance_loss: 0.2407, weighted_loss: 0.3045, label: 0, bag_size: 4292
batch 419, loss: 0.0166, instance_loss: 0.2841, weighted_loss: 0.0968, label: 0, bag_size: 4242
batch 439, loss: 0.0270, instance_loss: 0.1914, weighted_loss: 0.0763, label: 0, bag_size: 5757
batch 459, loss: 0.0240, instance_loss: 0.3362, weighted_loss: 0.1176, label: 1, bag_size: 3437
batch 479, loss: 0.5953, instance_loss: 0.3166, weighted_loss: 0.5117, label: 2, bag_size: 3121
batch 499, loss: 0.0002, instance_loss: 0.0924, weighted_loss: 0.0278, label: 1, bag_size: 8802
batch 519, loss: 0.0552, instance_loss: 0.1864, weighted_loss: 0.0945, label: 0, bag_size: 5353
batch 539, loss: 0.2803, instance_loss: 0.5620, weighted_loss: 0.3648, label: 2, bag_size: 6594
batch 559, loss: 0.9852, instance_loss: 0.7510, weighted_loss: 0.9150, label: 2, bag_size: 4487
batch 579, loss: 0.0232, instance_loss: 0.7003, weighted_loss: 0.2263, label: 1, bag_size: 4181
batch 599, loss: 0.0497, instance_loss: 0.1120, weighted_loss: 0.0684, label: 2, bag_size: 657
batch 619, loss: 0.0173, instance_loss: 0.1168, weighted_loss: 0.0472, label: 2, bag_size: 4745
batch 639, loss: 0.1220, instance_loss: 0.2532, weighted_loss: 0.1614, label: 0, bag_size: 4760
batch 659, loss: 0.1175, instance_loss: 0.4598, weighted_loss: 0.2202, label: 1, bag_size: 2905
batch 679, loss: 0.9117, instance_loss: 0.6662, weighted_loss: 0.8381, label: 2, bag_size: 361
batch 699, loss: 0.2902, instance_loss: 0.6201, weighted_loss: 0.3892, label: 0, bag_size: 1352
batch 719, loss: 0.0013, instance_loss: 0.1033, weighted_loss: 0.0319, label: 2, bag_size: 3607
batch 739, loss: 0.1212, instance_loss: 0.1935, weighted_loss: 0.1429, label: 0, bag_size: 3247


class 0 clustering acc 0.9643736017897092: correct 17243/17880
class 1 clustering acc 0.4666107382550336: correct 2781/5960
Epoch: 75, train_loss: 0.4218, train_clustering_loss:  0.4977, train_error: 0.1718
class 0: acc 0.8493723849372385, correct 203/239
class 1: acc 0.7341772151898734, correct 174/237
class 2: acc 0.8921933085501859, correct 240/269

Val Set, val_loss: 0.5574, val_error: 0.2553, auc: 0.9253
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.45611702127659576: correct 343/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3294, instance_loss: 0.7404, weighted_loss: 0.4527, label: 1, bag_size: 2905
batch 39, loss: 2.1329, instance_loss: 0.8575, weighted_loss: 1.7503, label: 1, bag_size: 6993
batch 59, loss: 0.0990, instance_loss: 0.1216, weighted_loss: 0.1058, label: 2, bag_size: 4223
batch 79, loss: 0.1897, instance_loss: 0.3042, weighted_loss: 0.2240, label: 2, bag_size: 5037
batch 99, loss: 0.3135, instance_loss: 0.2871, weighted_loss: 0.3056, label: 1, bag_size: 1221
batch 119, loss: 0.3313, instance_loss: 0.7903, weighted_loss: 0.4690, label: 2, bag_size: 5743
batch 139, loss: 0.0413, instance_loss: 0.1603, weighted_loss: 0.0770, label: 2, bag_size: 4555
batch 159, loss: 0.0548, instance_loss: 0.1321, weighted_loss: 0.0780, label: 2, bag_size: 4775
batch 179, loss: 0.1081, instance_loss: 0.3948, weighted_loss: 0.1941, label: 2, bag_size: 4192
batch 199, loss: 0.0846, instance_loss: 0.2169, weighted_loss: 0.1243, label: 2, bag_size: 3678
batch 219, loss: 0.5434, instance_loss: 1.3686, weighted_loss: 0.7909, label: 1, bag_size: 1549
batch 239, loss: 0.0469, instance_loss: 0.2065, weighted_loss: 0.0948, label: 0, bag_size: 5039
batch 259, loss: 0.0198, instance_loss: 0.1196, weighted_loss: 0.0497, label: 0, bag_size: 3530
batch 279, loss: 1.4133, instance_loss: 1.2808, weighted_loss: 1.3735, label: 1, bag_size: 1964
batch 299, loss: 0.0344, instance_loss: 0.1801, weighted_loss: 0.0781, label: 0, bag_size: 4648
batch 319, loss: 0.1383, instance_loss: 0.7085, weighted_loss: 0.3094, label: 0, bag_size: 1052
batch 339, loss: 0.8491, instance_loss: 0.5518, weighted_loss: 0.7599, label: 2, bag_size: 5307
batch 359, loss: 0.0330, instance_loss: 0.1484, weighted_loss: 0.0676, label: 2, bag_size: 4203
batch 379, loss: 0.0447, instance_loss: 0.5479, weighted_loss: 0.1956, label: 2, bag_size: 2813
batch 399, loss: 0.2195, instance_loss: 0.3084, weighted_loss: 0.2462, label: 1, bag_size: 3109
batch 419, loss: 2.3824, instance_loss: 1.0635, weighted_loss: 1.9867, label: 0, bag_size: 3830
batch 439, loss: 0.1484, instance_loss: 0.3416, weighted_loss: 0.2064, label: 2, bag_size: 5017
batch 459, loss: 0.2369, instance_loss: 0.5488, weighted_loss: 0.3305, label: 2, bag_size: 728
batch 479, loss: 0.1270, instance_loss: 0.3637, weighted_loss: 0.1980, label: 1, bag_size: 2753
batch 499, loss: 0.0329, instance_loss: 0.1055, weighted_loss: 0.0547, label: 2, bag_size: 6148
batch 519, loss: 0.1667, instance_loss: 0.2651, weighted_loss: 0.1962, label: 2, bag_size: 5472
batch 539, loss: 0.0609, instance_loss: 0.5041, weighted_loss: 0.1939, label: 0, bag_size: 5373
batch 559, loss: 1.1772, instance_loss: 0.9152, weighted_loss: 1.0986, label: 2, bag_size: 2326
batch 579, loss: 0.0552, instance_loss: 0.2289, weighted_loss: 0.1073, label: 0, bag_size: 2601
batch 599, loss: 0.0346, instance_loss: 0.1377, weighted_loss: 0.0655, label: 2, bag_size: 2254
batch 619, loss: 0.0141, instance_loss: 0.1767, weighted_loss: 0.0629, label: 0, bag_size: 4242
batch 639, loss: 0.0095, instance_loss: 0.1545, weighted_loss: 0.0530, label: 2, bag_size: 2770
batch 659, loss: 0.1192, instance_loss: 0.2459, weighted_loss: 0.1572, label: 1, bag_size: 3337
batch 679, loss: 0.3977, instance_loss: 0.5424, weighted_loss: 0.4411, label: 2, bag_size: 361
batch 699, loss: 0.0212, instance_loss: 0.1343, weighted_loss: 0.0552, label: 2, bag_size: 3121
batch 719, loss: 0.3928, instance_loss: 0.5754, weighted_loss: 0.4476, label: 0, bag_size: 477
batch 739, loss: 0.5329, instance_loss: 0.5485, weighted_loss: 0.5376, label: 0, bag_size: 4639


class 0 clustering acc 0.9671140939597316: correct 17292/17880
class 1 clustering acc 0.4847315436241611: correct 2889/5960
Epoch: 76, train_loss: 0.3867, train_clustering_loss:  0.4778, train_error: 0.1463
class 0: acc 0.8690476190476191, correct 219/252
class 1: acc 0.7478632478632479, correct 175/234
class 2: acc 0.9343629343629344, correct 242/259

Val Set, val_loss: 0.5457, val_error: 0.2234, auc: 0.9281
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.5053191489361702: correct 380/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0568, instance_loss: 0.4453, weighted_loss: 0.1733, label: 2, bag_size: 5307
batch 39, loss: 0.3391, instance_loss: 0.3197, weighted_loss: 0.3333, label: 2, bag_size: 1222
batch 59, loss: 0.0116, instance_loss: 0.2280, weighted_loss: 0.0765, label: 1, bag_size: 3398
batch 79, loss: 1.0131, instance_loss: 1.1248, weighted_loss: 1.0466, label: 2, bag_size: 3475
batch 99, loss: 0.0168, instance_loss: 0.8712, weighted_loss: 0.2731, label: 0, bag_size: 1904
batch 119, loss: 0.0295, instance_loss: 0.0990, weighted_loss: 0.0504, label: 0, bag_size: 5500
batch 139, loss: 0.0177, instance_loss: 1.0540, weighted_loss: 0.3286, label: 1, bag_size: 3995
batch 159, loss: 0.0719, instance_loss: 0.2566, weighted_loss: 0.1273, label: 1, bag_size: 3558
batch 179, loss: 6.2702, instance_loss: 1.7508, weighted_loss: 4.9144, label: 0, bag_size: 2392
batch 199, loss: 0.0433, instance_loss: 0.1692, weighted_loss: 0.0811, label: 2, bag_size: 3396
batch 219, loss: 0.0246, instance_loss: 0.1782, weighted_loss: 0.0707, label: 0, bag_size: 4332
batch 239, loss: 0.5594, instance_loss: 0.9080, weighted_loss: 0.6640, label: 1, bag_size: 869
batch 259, loss: 0.1442, instance_loss: 0.9928, weighted_loss: 0.3987, label: 1, bag_size: 3596
batch 279, loss: 0.0600, instance_loss: 0.3753, weighted_loss: 0.1546, label: 2, bag_size: 4487
batch 299, loss: 0.0405, instance_loss: 0.1281, weighted_loss: 0.0668, label: 2, bag_size: 3415
batch 319, loss: 1.0790, instance_loss: 0.8400, weighted_loss: 1.0073, label: 1, bag_size: 8632
batch 339, loss: 0.0090, instance_loss: 0.2465, weighted_loss: 0.0802, label: 1, bag_size: 3172
batch 359, loss: 0.5185, instance_loss: 0.7879, weighted_loss: 0.5993, label: 0, bag_size: 5023
batch 379, loss: 0.9613, instance_loss: 0.8024, weighted_loss: 0.9136, label: 2, bag_size: 2326
batch 399, loss: 0.1154, instance_loss: 0.6393, weighted_loss: 0.2726, label: 1, bag_size: 3791
batch 419, loss: 0.0816, instance_loss: 0.3232, weighted_loss: 0.1541, label: 1, bag_size: 782
batch 439, loss: 0.0696, instance_loss: 0.2150, weighted_loss: 0.1132, label: 2, bag_size: 3112
batch 459, loss: 0.0007, instance_loss: 0.1049, weighted_loss: 0.0319, label: 1, bag_size: 3172
batch 479, loss: 3.2420, instance_loss: 1.3259, weighted_loss: 2.6671, label: 2, bag_size: 2813
batch 499, loss: 0.0119, instance_loss: 0.3513, weighted_loss: 0.1137, label: 1, bag_size: 2921
batch 519, loss: 0.2683, instance_loss: 0.1817, weighted_loss: 0.2423, label: 1, bag_size: 3558
batch 539, loss: 0.0002, instance_loss: 0.0837, weighted_loss: 0.0252, label: 1, bag_size: 2493
batch 559, loss: 0.0135, instance_loss: 0.1308, weighted_loss: 0.0487, label: 2, bag_size: 4745
batch 579, loss: 0.0015, instance_loss: 0.0766, weighted_loss: 0.0240, label: 1, bag_size: 3043
batch 599, loss: 0.0920, instance_loss: 0.2744, weighted_loss: 0.1467, label: 0, bag_size: 4562
batch 619, loss: 0.0397, instance_loss: 0.3826, weighted_loss: 0.1426, label: 2, bag_size: 4497
batch 639, loss: 0.1375, instance_loss: 0.9034, weighted_loss: 0.3673, label: 0, bag_size: 996
batch 659, loss: 0.0014, instance_loss: 0.3493, weighted_loss: 0.1058, label: 0, bag_size: 1812
batch 679, loss: 0.0001, instance_loss: 0.1583, weighted_loss: 0.0476, label: 0, bag_size: 4403
batch 699, loss: 0.0145, instance_loss: 0.1665, weighted_loss: 0.0601, label: 0, bag_size: 1647
batch 719, loss: 0.0430, instance_loss: 0.1677, weighted_loss: 0.0804, label: 2, bag_size: 4192
batch 739, loss: 0.6251, instance_loss: 0.6115, weighted_loss: 0.6210, label: 1, bag_size: 4262


class 0 clustering acc 0.9653243847874721: correct 17260/17880
class 1 clustering acc 0.46426174496644296: correct 2767/5960
Epoch: 77, train_loss: 0.4179, train_clustering_loss:  0.4954, train_error: 0.1597
class 0: acc 0.8547717842323651, correct 206/241
class 1: acc 0.7814814814814814, correct 211/270
class 2: acc 0.8931623931623932, correct 209/234

Val Set, val_loss: 0.6377, val_error: 0.2340, auc: 0.9219
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.4800531914893617: correct 361/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0905, instance_loss: 0.1364, weighted_loss: 0.1043, label: 1, bag_size: 2919
batch 39, loss: 0.0296, instance_loss: 0.1526, weighted_loss: 0.0665, label: 2, bag_size: 4555
batch 59, loss: 0.0386, instance_loss: 0.1647, weighted_loss: 0.0764, label: 2, bag_size: 5037
batch 79, loss: 0.0029, instance_loss: 0.3520, weighted_loss: 0.1076, label: 1, bag_size: 5003
batch 99, loss: 0.0144, instance_loss: 0.0644, weighted_loss: 0.0294, label: 0, bag_size: 1049
batch 119, loss: 0.0015, instance_loss: 0.0253, weighted_loss: 0.0087, label: 2, bag_size: 4856
batch 139, loss: 0.0071, instance_loss: 0.0923, weighted_loss: 0.0327, label: 2, bag_size: 2770
batch 159, loss: 0.7091, instance_loss: 1.0059, weighted_loss: 0.7982, label: 1, bag_size: 936
batch 179, loss: 1.5470, instance_loss: 0.8297, weighted_loss: 1.3318, label: 0, bag_size: 3070
batch 199, loss: 0.0014, instance_loss: 0.4204, weighted_loss: 0.1271, label: 0, bag_size: 3344
batch 219, loss: 0.0610, instance_loss: 0.1600, weighted_loss: 0.0907, label: 1, bag_size: 3009
batch 239, loss: 0.1235, instance_loss: 0.8460, weighted_loss: 0.3403, label: 0, bag_size: 4337
batch 259, loss: 0.2145, instance_loss: 0.2905, weighted_loss: 0.2373, label: 2, bag_size: 6704
batch 279, loss: 0.1319, instance_loss: 0.9879, weighted_loss: 0.3887, label: 1, bag_size: 2229
batch 299, loss: 0.0088, instance_loss: 0.1646, weighted_loss: 0.0556, label: 1, bag_size: 3398
batch 319, loss: 0.0729, instance_loss: 0.1460, weighted_loss: 0.0949, label: 2, bag_size: 3397
batch 339, loss: 0.0063, instance_loss: 0.3912, weighted_loss: 0.1217, label: 0, bag_size: 4831
batch 359, loss: 1.7339, instance_loss: 0.9874, weighted_loss: 1.5099, label: 0, bag_size: 4572
batch 379, loss: 0.3999, instance_loss: 0.7744, weighted_loss: 0.5123, label: 2, bag_size: 728
batch 399, loss: 0.9572, instance_loss: 0.7975, weighted_loss: 0.9093, label: 0, bag_size: 5023
batch 419, loss: 1.2957, instance_loss: 0.8394, weighted_loss: 1.1588, label: 1, bag_size: 6152
batch 439, loss: 0.3450, instance_loss: 1.4394, weighted_loss: 0.6734, label: 2, bag_size: 4910
batch 459, loss: 0.1284, instance_loss: 0.6219, weighted_loss: 0.2764, label: 1, bag_size: 3823
batch 479, loss: 0.5738, instance_loss: 0.3260, weighted_loss: 0.4995, label: 2, bag_size: 3112
batch 499, loss: 0.1103, instance_loss: 0.6605, weighted_loss: 0.2754, label: 1, bag_size: 2859
batch 519, loss: 0.0263, instance_loss: 0.0678, weighted_loss: 0.0388, label: 0, bag_size: 5337
batch 539, loss: 0.0050, instance_loss: 0.0379, weighted_loss: 0.0148, label: 0, bag_size: 4857
batch 559, loss: 1.1260, instance_loss: 1.3047, weighted_loss: 1.1796, label: 1, bag_size: 4258
batch 579, loss: 0.6552, instance_loss: 1.5886, weighted_loss: 0.9352, label: 1, bag_size: 2927
batch 599, loss: 3.0387, instance_loss: 1.0934, weighted_loss: 2.4551, label: 0, bag_size: 3664
batch 619, loss: 0.2296, instance_loss: 0.2339, weighted_loss: 0.2309, label: 0, bag_size: 726
batch 639, loss: 0.1134, instance_loss: 0.4468, weighted_loss: 0.2134, label: 1, bag_size: 6152
batch 659, loss: 1.0630, instance_loss: 2.1871, weighted_loss: 1.4002, label: 0, bag_size: 2736
batch 679, loss: 0.5822, instance_loss: 0.7521, weighted_loss: 0.6332, label: 1, bag_size: 574
batch 699, loss: 0.8251, instance_loss: 0.5737, weighted_loss: 0.7497, label: 0, bag_size: 3797
batch 719, loss: 0.8467, instance_loss: 0.3680, weighted_loss: 0.7031, label: 0, bag_size: 4378
batch 739, loss: 0.1615, instance_loss: 0.2798, weighted_loss: 0.1970, label: 2, bag_size: 6644


class 0 clustering acc 0.9663870246085011: correct 17279/17880
class 1 clustering acc 0.48389261744966444: correct 2884/5960
Epoch: 78, train_loss: 0.4133, train_clustering_loss:  0.4799, train_error: 0.1624
class 0: acc 0.8483606557377049, correct 207/244
class 1: acc 0.7745901639344263, correct 189/244
class 2: acc 0.8871595330739299, correct 228/257

Val Set, val_loss: 0.6108, val_error: 0.2766, auc: 0.9167
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.4587765957446808: correct 345/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0134, instance_loss: 0.0809, weighted_loss: 0.0336, label: 0, bag_size: 3289
batch 39, loss: 0.0035, instance_loss: 0.0511, weighted_loss: 0.0177, label: 1, bag_size: 3425
batch 59, loss: 0.0618, instance_loss: 0.2553, weighted_loss: 0.1198, label: 0, bag_size: 13540
batch 79, loss: 0.0280, instance_loss: 0.3021, weighted_loss: 0.1103, label: 2, bag_size: 2770
batch 99, loss: 0.0557, instance_loss: 0.2125, weighted_loss: 0.1027, label: 2, bag_size: 4141
batch 119, loss: 0.2818, instance_loss: 0.4353, weighted_loss: 0.3278, label: 2, bag_size: 5472
batch 139, loss: 0.0056, instance_loss: 0.0607, weighted_loss: 0.0221, label: 2, bag_size: 657
batch 159, loss: 0.0171, instance_loss: 0.0893, weighted_loss: 0.0388, label: 2, bag_size: 2254
batch 179, loss: 0.0000, instance_loss: 0.5433, weighted_loss: 0.1630, label: 1, bag_size: 6717
batch 199, loss: 0.0964, instance_loss: 0.5151, weighted_loss: 0.2220, label: 0, bag_size: 4351
batch 219, loss: 0.3682, instance_loss: 0.4033, weighted_loss: 0.3787, label: 1, bag_size: 596
batch 239, loss: 0.0034, instance_loss: 0.8853, weighted_loss: 0.2680, label: 0, bag_size: 4494
batch 259, loss: 0.2735, instance_loss: 0.7524, weighted_loss: 0.4172, label: 1, bag_size: 2751
batch 279, loss: 0.0393, instance_loss: 0.1056, weighted_loss: 0.0592, label: 2, bag_size: 3678
batch 299, loss: 0.0319, instance_loss: 0.2482, weighted_loss: 0.0968, label: 1, bag_size: 425
batch 319, loss: 0.2731, instance_loss: 0.5164, weighted_loss: 0.3461, label: 0, bag_size: 789
batch 339, loss: 0.4064, instance_loss: 0.4991, weighted_loss: 0.4342, label: 1, bag_size: 5926
batch 359, loss: 0.0477, instance_loss: 0.2348, weighted_loss: 0.1039, label: 2, bag_size: 1094
batch 379, loss: 0.3636, instance_loss: 0.9797, weighted_loss: 0.5484, label: 1, bag_size: 5718
batch 399, loss: 0.2234, instance_loss: 0.2496, weighted_loss: 0.2313, label: 2, bag_size: 4162
batch 419, loss: 0.2179, instance_loss: 0.9679, weighted_loss: 0.4429, label: 0, bag_size: 1944
batch 439, loss: 1.1908, instance_loss: 0.7817, weighted_loss: 1.0681, label: 1, bag_size: 5195
batch 459, loss: 0.0342, instance_loss: 0.1389, weighted_loss: 0.0656, label: 2, bag_size: 4788
batch 479, loss: 0.1619, instance_loss: 0.2356, weighted_loss: 0.1840, label: 0, bag_size: 5413
batch 499, loss: 0.2268, instance_loss: 0.5181, weighted_loss: 0.3142, label: 0, bag_size: 1545
batch 519, loss: 0.0178, instance_loss: 0.1237, weighted_loss: 0.0496, label: 2, bag_size: 614
batch 539, loss: 0.0444, instance_loss: 0.1565, weighted_loss: 0.0780, label: 0, bag_size: 5039
batch 559, loss: 0.3384, instance_loss: 0.7449, weighted_loss: 0.4603, label: 2, bag_size: 4571
batch 579, loss: 0.0428, instance_loss: 0.1518, weighted_loss: 0.0755, label: 1, bag_size: 3398
batch 599, loss: 0.0188, instance_loss: 0.1538, weighted_loss: 0.0593, label: 0, bag_size: 5353
batch 619, loss: 0.0001, instance_loss: 0.0946, weighted_loss: 0.0285, label: 1, bag_size: 2493
batch 639, loss: 0.2024, instance_loss: 0.3147, weighted_loss: 0.2361, label: 0, bag_size: 2671
batch 659, loss: 0.0215, instance_loss: 0.1382, weighted_loss: 0.0565, label: 2, bag_size: 2254
batch 679, loss: 0.0202, instance_loss: 0.1775, weighted_loss: 0.0674, label: 2, bag_size: 2254
batch 699, loss: 0.0436, instance_loss: 0.1367, weighted_loss: 0.0715, label: 0, bag_size: 4648
batch 719, loss: 1.8749, instance_loss: 0.9432, weighted_loss: 1.5954, label: 1, bag_size: 3261
batch 739, loss: 0.2536, instance_loss: 0.4478, weighted_loss: 0.3119, label: 2, bag_size: 3299


class 0 clustering acc 0.96331096196868: correct 17224/17880
class 1 clustering acc 0.4798657718120805: correct 2860/5960
Epoch: 79, train_loss: 0.4117, train_clustering_loss:  0.4861, train_error: 0.1597
class 0: acc 0.8502024291497976, correct 210/247
class 1: acc 0.7674418604651163, correct 198/258
class 2: acc 0.9083333333333333, correct 218/240

Val Set, val_loss: 0.5538, val_error: 0.2128, auc: 0.9367
class 0 clustering acc 0.9716312056737588: correct 2192/2256
class 1 clustering acc 0.43351063829787234: correct 326/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1699, instance_loss: 0.7329, weighted_loss: 0.3388, label: 2, bag_size: 5743
batch 39, loss: 1.6786, instance_loss: 1.2019, weighted_loss: 1.5356, label: 1, bag_size: 3016
batch 59, loss: 0.0596, instance_loss: 0.5274, weighted_loss: 0.1999, label: 1, bag_size: 1607
batch 79, loss: 3.0023, instance_loss: 1.3752, weighted_loss: 2.5142, label: 0, bag_size: 1071
batch 99, loss: 0.0095, instance_loss: 0.0894, weighted_loss: 0.0335, label: 0, bag_size: 3443
batch 119, loss: 0.1277, instance_loss: 0.3172, weighted_loss: 0.1845, label: 2, bag_size: 3546
batch 139, loss: 0.0035, instance_loss: 0.1107, weighted_loss: 0.0356, label: 0, bag_size: 6138
batch 159, loss: 0.0170, instance_loss: 0.3231, weighted_loss: 0.1088, label: 0, bag_size: 1933
batch 179, loss: 0.0130, instance_loss: 0.3823, weighted_loss: 0.1238, label: 2, bag_size: 88
batch 199, loss: 1.7744, instance_loss: 0.8772, weighted_loss: 1.5052, label: 2, bag_size: 4241
batch 219, loss: 1.1419, instance_loss: 0.5133, weighted_loss: 0.9533, label: 1, bag_size: 3823
batch 239, loss: 0.4764, instance_loss: 0.3928, weighted_loss: 0.4513, label: 0, bag_size: 7056
batch 259, loss: 0.0759, instance_loss: 0.1926, weighted_loss: 0.1109, label: 2, bag_size: 3176
batch 279, loss: 0.0851, instance_loss: 0.2773, weighted_loss: 0.1428, label: 0, bag_size: 5098
batch 299, loss: 0.3881, instance_loss: 1.2549, weighted_loss: 0.6482, label: 0, bag_size: 20234
batch 319, loss: 0.0757, instance_loss: 0.2664, weighted_loss: 0.1329, label: 1, bag_size: 3050
batch 339, loss: 2.0439, instance_loss: 1.3801, weighted_loss: 1.8448, label: 1, bag_size: 6241
batch 359, loss: 0.0194, instance_loss: 0.1049, weighted_loss: 0.0450, label: 1, bag_size: 3050
batch 379, loss: 0.0120, instance_loss: 0.0656, weighted_loss: 0.0281, label: 1, bag_size: 3425
batch 399, loss: 0.7153, instance_loss: 0.8060, weighted_loss: 0.7425, label: 2, bag_size: 2326
batch 419, loss: 0.0327, instance_loss: 0.4091, weighted_loss: 0.1456, label: 0, bag_size: 6927
batch 439, loss: 1.5171, instance_loss: 1.1586, weighted_loss: 1.4096, label: 0, bag_size: 22822
batch 459, loss: 0.0365, instance_loss: 0.3544, weighted_loss: 0.1319, label: 0, bag_size: 3639
batch 479, loss: 0.0140, instance_loss: 0.0879, weighted_loss: 0.0362, label: 2, bag_size: 4745
batch 499, loss: 0.0178, instance_loss: 0.0789, weighted_loss: 0.0361, label: 2, bag_size: 3396
batch 519, loss: 0.3058, instance_loss: 0.6170, weighted_loss: 0.3991, label: 1, bag_size: 5926
batch 539, loss: 0.0696, instance_loss: 0.1539, weighted_loss: 0.0949, label: 0, bag_size: 3883
batch 559, loss: 0.1893, instance_loss: 0.1969, weighted_loss: 0.1916, label: 1, bag_size: 5696
batch 579, loss: 0.0233, instance_loss: 0.1632, weighted_loss: 0.0653, label: 0, bag_size: 4741
batch 599, loss: 0.4932, instance_loss: 0.8686, weighted_loss: 0.6058, label: 2, bag_size: 361
batch 619, loss: 0.5586, instance_loss: 0.2789, weighted_loss: 0.4747, label: 2, bag_size: 4223
batch 639, loss: 0.2265, instance_loss: 0.7546, weighted_loss: 0.3849, label: 1, bag_size: 1854
batch 659, loss: 0.0010, instance_loss: 0.1816, weighted_loss: 0.0551, label: 2, bag_size: 3607
batch 679, loss: 1.5691, instance_loss: 1.4182, weighted_loss: 1.5238, label: 1, bag_size: 3424
batch 699, loss: 0.3466, instance_loss: 0.6593, weighted_loss: 0.4404, label: 1, bag_size: 3935
batch 719, loss: 0.8890, instance_loss: 0.4229, weighted_loss: 0.7491, label: 2, bag_size: 3174
batch 739, loss: 1.2904, instance_loss: 1.3022, weighted_loss: 1.2940, label: 1, bag_size: 4373


class 0 clustering acc 0.9656040268456376: correct 17265/17880
class 1 clustering acc 0.5013422818791946: correct 2988/5960
Epoch: 80, train_loss: 0.3730, train_clustering_loss:  0.4810, train_error: 0.1450
class 0: acc 0.87109375, correct 223/256
class 1: acc 0.7608695652173914, correct 175/230
class 2: acc 0.9227799227799228, correct 239/259

Val Set, val_loss: 0.8302, val_error: 0.3085, auc: 0.9034
class 0 clustering acc 0.936613475177305: correct 2113/2256
class 1 clustering acc 0.449468085106383: correct 338/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0985, instance_loss: 0.1895, weighted_loss: 0.1258, label: 1, bag_size: 1410
batch 39, loss: 0.0618, instance_loss: 0.1026, weighted_loss: 0.0740, label: 0, bag_size: 3304
batch 59, loss: 0.5350, instance_loss: 0.7542, weighted_loss: 0.6008, label: 0, bag_size: 2217
batch 79, loss: 0.1041, instance_loss: 0.2976, weighted_loss: 0.1622, label: 1, bag_size: 2092
batch 99, loss: 0.0080, instance_loss: 0.1019, weighted_loss: 0.0362, label: 0, bag_size: 420
batch 119, loss: 0.0215, instance_loss: 0.2080, weighted_loss: 0.0775, label: 1, bag_size: 2796
batch 139, loss: 0.1041, instance_loss: 0.4009, weighted_loss: 0.1931, label: 0, bag_size: 4379
batch 159, loss: 1.5926, instance_loss: 0.9858, weighted_loss: 1.4105, label: 0, bag_size: 2217
batch 179, loss: 0.4210, instance_loss: 0.4097, weighted_loss: 0.4176, label: 2, bag_size: 6298
batch 199, loss: 0.0001, instance_loss: 0.2020, weighted_loss: 0.0607, label: 1, bag_size: 3338
batch 219, loss: 0.3818, instance_loss: 0.3071, weighted_loss: 0.3594, label: 2, bag_size: 4535
batch 239, loss: 0.0169, instance_loss: 0.1322, weighted_loss: 0.0515, label: 2, bag_size: 6026
batch 259, loss: 0.0719, instance_loss: 0.1949, weighted_loss: 0.1088, label: 2, bag_size: 4223
batch 279, loss: 2.0662, instance_loss: 0.9396, weighted_loss: 1.7283, label: 1, bag_size: 2425
batch 299, loss: 0.0067, instance_loss: 0.0745, weighted_loss: 0.0271, label: 2, bag_size: 4856
batch 319, loss: 0.4927, instance_loss: 0.2894, weighted_loss: 0.4317, label: 2, bag_size: 1103
batch 339, loss: 0.3223, instance_loss: 0.6250, weighted_loss: 0.4131, label: 1, bag_size: 1712
batch 359, loss: 0.0841, instance_loss: 0.3633, weighted_loss: 0.1679, label: 1, bag_size: 3009
batch 379, loss: 0.1437, instance_loss: 0.2781, weighted_loss: 0.1840, label: 2, bag_size: 2049
batch 399, loss: 0.1904, instance_loss: 0.1698, weighted_loss: 0.1842, label: 0, bag_size: 3406
batch 419, loss: 0.0397, instance_loss: 0.2174, weighted_loss: 0.0930, label: 2, bag_size: 5138
batch 439, loss: 1.1714, instance_loss: 0.8822, weighted_loss: 1.0846, label: 1, bag_size: 4705
batch 459, loss: 0.1291, instance_loss: 0.2588, weighted_loss: 0.1680, label: 0, bag_size: 5992
batch 479, loss: 0.0948, instance_loss: 0.3356, weighted_loss: 0.1670, label: 1, bag_size: 3109
batch 499, loss: 0.1700, instance_loss: 0.4346, weighted_loss: 0.2494, label: 0, bag_size: 6252
batch 519, loss: 0.0271, instance_loss: 0.1901, weighted_loss: 0.0760, label: 2, bag_size: 6594
batch 539, loss: 0.4301, instance_loss: 0.7754, weighted_loss: 0.5337, label: 1, bag_size: 667
batch 559, loss: 0.1002, instance_loss: 0.2117, weighted_loss: 0.1336, label: 0, bag_size: 4760
batch 579, loss: 0.0044, instance_loss: 0.0829, weighted_loss: 0.0280, label: 0, bag_size: 3754
batch 599, loss: 0.0577, instance_loss: 0.2742, weighted_loss: 0.1227, label: 0, bag_size: 1647
batch 619, loss: 0.0055, instance_loss: 0.2126, weighted_loss: 0.0676, label: 1, bag_size: 6475
batch 639, loss: 1.3609, instance_loss: 1.1147, weighted_loss: 1.2871, label: 2, bag_size: 4241
batch 659, loss: 0.0244, instance_loss: 0.5629, weighted_loss: 0.1860, label: 0, bag_size: 3743
batch 679, loss: 1.4436, instance_loss: 0.6467, weighted_loss: 1.2045, label: 1, bag_size: 5926
batch 699, loss: 0.0259, instance_loss: 0.2165, weighted_loss: 0.0831, label: 0, bag_size: 5353
batch 719, loss: 0.0677, instance_loss: 0.1558, weighted_loss: 0.0941, label: 2, bag_size: 4162
batch 739, loss: 0.0001, instance_loss: 0.1745, weighted_loss: 0.0524, label: 1, bag_size: 2009


class 0 clustering acc 0.9625838926174497: correct 17211/17880
class 1 clustering acc 0.47953020134228186: correct 2858/5960
Epoch: 81, train_loss: 0.3907, train_clustering_loss:  0.4917, train_error: 0.1597
class 0: acc 0.8658536585365854, correct 213/246
class 1: acc 0.7479674796747967, correct 184/246
class 2: acc 0.9051383399209486, correct 229/253

Val Set, val_loss: 0.6884, val_error: 0.2340, auc: 0.9160
class 0 clustering acc 0.9525709219858156: correct 2149/2256
class 1 clustering acc 0.49601063829787234: correct 373/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0289, weighted_loss: 0.0087, label: 1, bag_size: 2809
batch 39, loss: 0.0000, instance_loss: 0.0724, weighted_loss: 0.0218, label: 1, bag_size: 5385
batch 59, loss: 0.3809, instance_loss: 0.6683, weighted_loss: 0.4672, label: 0, bag_size: 1352
batch 79, loss: 0.2316, instance_loss: 0.2976, weighted_loss: 0.2514, label: 0, bag_size: 702
batch 99, loss: 1.3005, instance_loss: 0.6520, weighted_loss: 1.1059, label: 2, bag_size: 5406
batch 119, loss: 0.0911, instance_loss: 0.3479, weighted_loss: 0.1681, label: 2, bag_size: 1222
batch 139, loss: 0.0082, instance_loss: 0.0599, weighted_loss: 0.0237, label: 0, bag_size: 6765
batch 159, loss: 1.1113, instance_loss: 1.4590, weighted_loss: 1.2156, label: 1, bag_size: 2927
batch 179, loss: 0.1222, instance_loss: 0.1996, weighted_loss: 0.1454, label: 0, bag_size: 2094
batch 199, loss: 0.1141, instance_loss: 0.8105, weighted_loss: 0.3230, label: 0, bag_size: 4274
batch 219, loss: 0.0472, instance_loss: 0.1490, weighted_loss: 0.0777, label: 2, bag_size: 4203
batch 239, loss: 0.3916, instance_loss: 1.2676, weighted_loss: 0.6544, label: 1, bag_size: 5833
batch 259, loss: 0.5032, instance_loss: 0.6267, weighted_loss: 0.5403, label: 2, bag_size: 909
batch 279, loss: 0.1688, instance_loss: 0.3337, weighted_loss: 0.2183, label: 0, bag_size: 11663
batch 299, loss: 0.0242, instance_loss: 0.1907, weighted_loss: 0.0741, label: 2, bag_size: 3121
batch 319, loss: 0.3269, instance_loss: 0.6305, weighted_loss: 0.4180, label: 2, bag_size: 552
batch 339, loss: 0.0087, instance_loss: 0.3212, weighted_loss: 0.1024, label: 0, bag_size: 1399
batch 359, loss: 0.4547, instance_loss: 0.2719, weighted_loss: 0.3999, label: 2, bag_size: 3172
batch 379, loss: 0.0176, instance_loss: 0.1026, weighted_loss: 0.0431, label: 2, bag_size: 3583
batch 399, loss: 0.1067, instance_loss: 0.1962, weighted_loss: 0.1335, label: 2, bag_size: 3396
batch 419, loss: 0.0421, instance_loss: 0.4724, weighted_loss: 0.1712, label: 0, bag_size: 1245
batch 439, loss: 0.0158, instance_loss: 0.1643, weighted_loss: 0.0603, label: 2, bag_size: 3121
batch 459, loss: 0.2899, instance_loss: 0.9517, weighted_loss: 0.4884, label: 1, bag_size: 2751
batch 479, loss: 0.6233, instance_loss: 0.8755, weighted_loss: 0.6990, label: 2, bag_size: 3475
batch 499, loss: 0.4708, instance_loss: 1.0155, weighted_loss: 0.6342, label: 1, bag_size: 3619
batch 519, loss: 1.5328, instance_loss: 0.9370, weighted_loss: 1.3541, label: 0, bag_size: 421
batch 539, loss: 0.0255, instance_loss: 0.1309, weighted_loss: 0.0571, label: 2, bag_size: 614
batch 559, loss: 0.3413, instance_loss: 0.7164, weighted_loss: 0.4539, label: 2, bag_size: 361
batch 579, loss: 0.0457, instance_loss: 0.1877, weighted_loss: 0.0883, label: 2, bag_size: 5914
batch 599, loss: 0.1262, instance_loss: 0.4324, weighted_loss: 0.2180, label: 0, bag_size: 11663
batch 619, loss: 0.2155, instance_loss: 0.5941, weighted_loss: 0.3291, label: 1, bag_size: 11974
batch 639, loss: 0.1810, instance_loss: 0.2555, weighted_loss: 0.2034, label: 2, bag_size: 2501
batch 659, loss: 0.1284, instance_loss: 0.3118, weighted_loss: 0.1834, label: 2, bag_size: 4569
batch 679, loss: 0.4768, instance_loss: 0.2598, weighted_loss: 0.4117, label: 1, bag_size: 4708
batch 699, loss: 0.6199, instance_loss: 0.4565, weighted_loss: 0.5709, label: 0, bag_size: 5146
batch 719, loss: 0.0005, instance_loss: 0.2758, weighted_loss: 0.0831, label: 0, bag_size: 1812
batch 739, loss: 0.0299, instance_loss: 0.2109, weighted_loss: 0.0842, label: 0, bag_size: 4855


class 0 clustering acc 0.9639821029082773: correct 17236/17880
class 1 clustering acc 0.4825503355704698: correct 2876/5960
Epoch: 82, train_loss: 0.4153, train_clustering_loss:  0.4872, train_error: 0.1584
class 0: acc 0.8305084745762712, correct 196/236
class 1: acc 0.7992277992277992, correct 207/259
class 2: acc 0.896, correct 224/250

Val Set, val_loss: 0.7921, val_error: 0.2872, auc: 0.9108
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.41356382978723405: correct 311/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0125, instance_loss: 0.1325, weighted_loss: 0.0485, label: 1, bag_size: 4708
batch 39, loss: 0.3307, instance_loss: 0.3098, weighted_loss: 0.3244, label: 1, bag_size: 758
batch 59, loss: 0.4734, instance_loss: 0.7526, weighted_loss: 0.5571, label: 1, bag_size: 4373
batch 79, loss: 0.2707, instance_loss: 0.3627, weighted_loss: 0.2983, label: 2, bag_size: 3546
batch 99, loss: 0.2520, instance_loss: 0.8721, weighted_loss: 0.4380, label: 1, bag_size: 2927
batch 119, loss: 0.1109, instance_loss: 0.3839, weighted_loss: 0.1928, label: 0, bag_size: 4946
batch 139, loss: 2.2841, instance_loss: 1.1574, weighted_loss: 1.9461, label: 1, bag_size: 5873
batch 159, loss: 0.1362, instance_loss: 0.1635, weighted_loss: 0.1444, label: 2, bag_size: 4223
batch 179, loss: 0.1060, instance_loss: 0.3696, weighted_loss: 0.1851, label: 2, bag_size: 2561
batch 199, loss: 0.0460, instance_loss: 0.1272, weighted_loss: 0.0704, label: 1, bag_size: 1029
batch 219, loss: 0.2808, instance_loss: 0.6975, weighted_loss: 0.4058, label: 1, bag_size: 2302
batch 239, loss: 0.1401, instance_loss: 0.6222, weighted_loss: 0.2847, label: 2, bag_size: 4978
batch 259, loss: 0.0000, instance_loss: 0.1823, weighted_loss: 0.0547, label: 1, bag_size: 5760
batch 279, loss: 0.1218, instance_loss: 0.4669, weighted_loss: 0.2254, label: 0, bag_size: 1655
batch 299, loss: 0.1369, instance_loss: 1.2695, weighted_loss: 0.4766, label: 1, bag_size: 2927
batch 319, loss: 0.0195, instance_loss: 0.2203, weighted_loss: 0.0797, label: 0, bag_size: 1762
batch 339, loss: 0.0247, instance_loss: 0.1223, weighted_loss: 0.0540, label: 2, bag_size: 4788
batch 359, loss: 0.0038, instance_loss: 0.2065, weighted_loss: 0.0646, label: 1, bag_size: 3460
batch 379, loss: 1.1255, instance_loss: 1.2209, weighted_loss: 1.1541, label: 0, bag_size: 4922
batch 399, loss: 0.0145, instance_loss: 0.0815, weighted_loss: 0.0346, label: 2, bag_size: 5138
batch 419, loss: 0.0243, instance_loss: 0.4696, weighted_loss: 0.1579, label: 0, bag_size: 5170
batch 439, loss: 0.1740, instance_loss: 0.7466, weighted_loss: 0.3458, label: 1, bag_size: 2481
batch 459, loss: 0.0000, instance_loss: 0.2801, weighted_loss: 0.0840, label: 0, bag_size: 4403
batch 479, loss: 2.4137, instance_loss: 1.0315, weighted_loss: 1.9991, label: 2, bag_size: 3274
batch 499, loss: 0.0334, instance_loss: 0.1394, weighted_loss: 0.0652, label: 2, bag_size: 3415
batch 519, loss: 2.0827, instance_loss: 1.5158, weighted_loss: 1.9126, label: 1, bag_size: 4694
batch 539, loss: 0.3964, instance_loss: 0.5153, weighted_loss: 0.4321, label: 2, bag_size: 3274
batch 559, loss: 0.4851, instance_loss: 0.9582, weighted_loss: 0.6270, label: 2, bag_size: 1050
batch 579, loss: 0.0000, instance_loss: 0.1650, weighted_loss: 0.0495, label: 1, bag_size: 5462
batch 599, loss: 2.6712, instance_loss: 0.9287, weighted_loss: 2.1484, label: 1, bag_size: 4258
batch 619, loss: 1.3252, instance_loss: 0.4088, weighted_loss: 1.0503, label: 0, bag_size: 4310
batch 639, loss: 0.0057, instance_loss: 0.2965, weighted_loss: 0.0929, label: 0, bag_size: 4865
batch 659, loss: 0.1843, instance_loss: 0.6841, weighted_loss: 0.3342, label: 1, bag_size: 4806
batch 679, loss: 0.0040, instance_loss: 0.0931, weighted_loss: 0.0307, label: 1, bag_size: 2809
batch 699, loss: 0.0044, instance_loss: 0.3520, weighted_loss: 0.1087, label: 0, bag_size: 1034
batch 719, loss: 0.5611, instance_loss: 0.6491, weighted_loss: 0.5875, label: 0, bag_size: 8866
batch 739, loss: 3.2470, instance_loss: 1.1988, weighted_loss: 2.6325, label: 0, bag_size: 1753


class 0 clustering acc 0.9647091722595078: correct 17249/17880
class 1 clustering acc 0.4790268456375839: correct 2855/5960
Epoch: 83, train_loss: 0.3490, train_clustering_loss:  0.4857, train_error: 0.1342
class 0: acc 0.8755186721991701, correct 211/241
class 1: acc 0.8122605363984674, correct 212/261
class 2: acc 0.9135802469135802, correct 222/243

Val Set, val_loss: 0.5272, val_error: 0.2021, auc: 0.9308
class 0 clustering acc 0.9738475177304965: correct 2197/2256
class 1 clustering acc 0.4308510638297872: correct 324/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.534185 --> 0.527244).  Saving model ...


batch 19, loss: 0.0102, instance_loss: 0.8765, weighted_loss: 0.2701, label: 0, bag_size: 2232
batch 39, loss: 0.0523, instance_loss: 0.3455, weighted_loss: 0.1402, label: 0, bag_size: 3871
batch 59, loss: 0.3533, instance_loss: 0.9162, weighted_loss: 0.5221, label: 0, bag_size: 1795
batch 79, loss: 0.1680, instance_loss: 0.8221, weighted_loss: 0.3642, label: 2, bag_size: 909
batch 99, loss: 0.0044, instance_loss: 0.0711, weighted_loss: 0.0244, label: 0, bag_size: 3883
batch 119, loss: 0.0035, instance_loss: 0.1301, weighted_loss: 0.0415, label: 1, bag_size: 3425
batch 139, loss: 0.1433, instance_loss: 0.3025, weighted_loss: 0.1910, label: 2, bag_size: 5914
batch 159, loss: 0.0063, instance_loss: 0.2586, weighted_loss: 0.0820, label: 0, bag_size: 3319
batch 179, loss: 0.0001, instance_loss: 0.1983, weighted_loss: 0.0596, label: 0, bag_size: 3219
batch 199, loss: 1.7282, instance_loss: 1.0630, weighted_loss: 1.5286, label: 0, bag_size: 1755
batch 219, loss: 0.0006, instance_loss: 0.1049, weighted_loss: 0.0319, label: 1, bag_size: 259
batch 239, loss: 0.1844, instance_loss: 0.6004, weighted_loss: 0.3092, label: 0, bag_size: 3268
batch 259, loss: 0.0504, instance_loss: 0.1473, weighted_loss: 0.0794, label: 1, bag_size: 3050
batch 279, loss: 0.1971, instance_loss: 0.3581, weighted_loss: 0.2454, label: 1, bag_size: 3586
batch 299, loss: 0.2807, instance_loss: 0.6860, weighted_loss: 0.4023, label: 1, bag_size: 5197
batch 319, loss: 1.3255, instance_loss: 0.9806, weighted_loss: 1.2221, label: 1, bag_size: 2481
batch 339, loss: 0.0140, instance_loss: 0.1168, weighted_loss: 0.0448, label: 0, bag_size: 1762
batch 359, loss: 0.0487, instance_loss: 0.2746, weighted_loss: 0.1164, label: 0, bag_size: 7595
batch 379, loss: 0.0926, instance_loss: 0.9384, weighted_loss: 0.3463, label: 2, bag_size: 3475
batch 399, loss: 0.1319, instance_loss: 0.3668, weighted_loss: 0.2024, label: 2, bag_size: 3678
batch 419, loss: 0.1200, instance_loss: 0.4087, weighted_loss: 0.2066, label: 1, bag_size: 4346
batch 439, loss: 0.0242, instance_loss: 0.1565, weighted_loss: 0.0639, label: 0, bag_size: 3348
batch 459, loss: 0.0472, instance_loss: 0.2133, weighted_loss: 0.0970, label: 2, bag_size: 4555
batch 479, loss: 0.1940, instance_loss: 0.5949, weighted_loss: 0.3143, label: 0, bag_size: 4018
batch 499, loss: 0.0433, instance_loss: 0.7656, weighted_loss: 0.2600, label: 1, bag_size: 4262
batch 519, loss: 0.2924, instance_loss: 0.4936, weighted_loss: 0.3528, label: 2, bag_size: 3618
batch 539, loss: 0.4603, instance_loss: 0.4045, weighted_loss: 0.4435, label: 1, bag_size: 2905
batch 559, loss: 0.0146, instance_loss: 0.0915, weighted_loss: 0.0377, label: 0, bag_size: 4312
batch 579, loss: 0.2533, instance_loss: 0.2693, weighted_loss: 0.2581, label: 0, bag_size: 2677
batch 599, loss: 0.9601, instance_loss: 1.0147, weighted_loss: 0.9764, label: 1, bag_size: 4187
batch 619, loss: 1.8882, instance_loss: 0.8216, weighted_loss: 1.5682, label: 1, bag_size: 3460
batch 639, loss: 0.0001, instance_loss: 0.1894, weighted_loss: 0.0569, label: 0, bag_size: 4841
batch 659, loss: 0.1638, instance_loss: 0.3587, weighted_loss: 0.2223, label: 2, bag_size: 3778
batch 679, loss: 0.0095, instance_loss: 0.1725, weighted_loss: 0.0584, label: 2, bag_size: 4775
batch 699, loss: 1.0462, instance_loss: 0.7649, weighted_loss: 0.9618, label: 1, bag_size: 4694
batch 719, loss: 0.0484, instance_loss: 0.3287, weighted_loss: 0.1325, label: 0, bag_size: 3437
batch 739, loss: 0.0953, instance_loss: 0.2419, weighted_loss: 0.1393, label: 2, bag_size: 5017


class 0 clustering acc 0.9652125279642059: correct 17258/17880
class 1 clustering acc 0.4761744966442953: correct 2838/5960
Epoch: 84, train_loss: 0.3869, train_clustering_loss:  0.4857, train_error: 0.1584
class 0: acc 0.8673835125448028, correct 242/279
class 1: acc 0.7563025210084033, correct 180/238
class 2: acc 0.8991228070175439, correct 205/228

Val Set, val_loss: 0.6667, val_error: 0.2447, auc: 0.9132
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.41356382978723405: correct 311/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0161, instance_loss: 0.0644, weighted_loss: 0.0306, label: 0, bag_size: 4092
batch 39, loss: 0.0009, instance_loss: 0.2286, weighted_loss: 0.0692, label: 1, bag_size: 3156
batch 59, loss: 0.1113, instance_loss: 0.3466, weighted_loss: 0.1819, label: 1, bag_size: 2092
batch 79, loss: 0.0000, instance_loss: 0.0530, weighted_loss: 0.0159, label: 0, bag_size: 6182
batch 99, loss: 0.1237, instance_loss: 0.4956, weighted_loss: 0.2352, label: 0, bag_size: 11663
batch 119, loss: 1.9345, instance_loss: 1.6094, weighted_loss: 1.8370, label: 1, bag_size: 6165
batch 139, loss: 0.6697, instance_loss: 0.8049, weighted_loss: 0.7103, label: 1, bag_size: 4960
batch 159, loss: 0.2107, instance_loss: 0.2884, weighted_loss: 0.2340, label: 2, bag_size: 614
batch 179, loss: 0.0118, instance_loss: 0.1426, weighted_loss: 0.0510, label: 0, bag_size: 3443
batch 199, loss: 0.7629, instance_loss: 1.0551, weighted_loss: 0.8506, label: 2, bag_size: 4342
batch 219, loss: 0.0030, instance_loss: 0.0886, weighted_loss: 0.0287, label: 1, bag_size: 3172
batch 239, loss: 0.0152, instance_loss: 0.1064, weighted_loss: 0.0426, label: 2, bag_size: 3285
batch 259, loss: 1.9535, instance_loss: 1.2234, weighted_loss: 1.7345, label: 1, bag_size: 2425
batch 279, loss: 0.2458, instance_loss: 0.5753, weighted_loss: 0.3446, label: 1, bag_size: 1066
batch 299, loss: 0.1777, instance_loss: 0.3881, weighted_loss: 0.2408, label: 2, bag_size: 4162
batch 319, loss: 0.1676, instance_loss: 0.1930, weighted_loss: 0.1753, label: 2, bag_size: 3746
batch 339, loss: 1.2971, instance_loss: 1.4625, weighted_loss: 1.3467, label: 1, bag_size: 2927
batch 359, loss: 0.0714, instance_loss: 0.4470, weighted_loss: 0.1841, label: 2, bag_size: 4569
batch 379, loss: 0.0261, instance_loss: 0.1179, weighted_loss: 0.0536, label: 2, bag_size: 4302
batch 399, loss: 0.0423, instance_loss: 0.5734, weighted_loss: 0.2016, label: 0, bag_size: 2232
batch 419, loss: 0.0049, instance_loss: 0.1685, weighted_loss: 0.0540, label: 0, bag_size: 1485
batch 439, loss: 0.0075, instance_loss: 0.4507, weighted_loss: 0.1405, label: 1, bag_size: 4644
batch 459, loss: 0.7894, instance_loss: 1.2659, weighted_loss: 0.9323, label: 1, bag_size: 3184
batch 479, loss: 0.0030, instance_loss: 0.0520, weighted_loss: 0.0177, label: 2, bag_size: 2254
batch 499, loss: 0.0526, instance_loss: 0.1103, weighted_loss: 0.0699, label: 2, bag_size: 3227
batch 519, loss: 0.3199, instance_loss: 0.1835, weighted_loss: 0.2789, label: 2, bag_size: 3112
batch 539, loss: 0.9995, instance_loss: 1.5362, weighted_loss: 1.1605, label: 1, bag_size: 1608
batch 559, loss: 2.7571, instance_loss: 2.2839, weighted_loss: 2.6152, label: 1, bag_size: 1604
batch 579, loss: 0.0211, instance_loss: 0.2954, weighted_loss: 0.1034, label: 2, bag_size: 4497
batch 599, loss: 3.1613, instance_loss: 1.6562, weighted_loss: 2.7098, label: 0, bag_size: 1289
batch 619, loss: 0.0545, instance_loss: 0.3717, weighted_loss: 0.1497, label: 1, bag_size: 1595
batch 639, loss: 0.2043, instance_loss: 1.6083, weighted_loss: 0.6255, label: 2, bag_size: 4910
batch 659, loss: 0.0083, instance_loss: 0.0693, weighted_loss: 0.0266, label: 2, bag_size: 4775
batch 679, loss: 0.0950, instance_loss: 0.2157, weighted_loss: 0.1312, label: 2, bag_size: 3534
batch 699, loss: 0.0343, instance_loss: 0.2510, weighted_loss: 0.0993, label: 1, bag_size: 4595
batch 719, loss: 0.0183, instance_loss: 0.0800, weighted_loss: 0.0368, label: 2, bag_size: 6148
batch 739, loss: 0.4674, instance_loss: 0.6380, weighted_loss: 0.5186, label: 2, bag_size: 7607


class 0 clustering acc 0.9631431767337808: correct 17221/17880
class 1 clustering acc 0.5140939597315436: correct 3064/5960
Epoch: 85, train_loss: 0.3582, train_clustering_loss:  0.4671, train_error: 0.1396
class 0: acc 0.851063829787234, correct 200/235
class 1: acc 0.8089430894308943, correct 199/246
class 2: acc 0.9166666666666666, correct 242/264

Val Set, val_loss: 0.5348, val_error: 0.2021, auc: 0.9239
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.48271276595744683: correct 363/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1358, instance_loss: 0.2489, weighted_loss: 0.1697, label: 1, bag_size: 5340
batch 39, loss: 0.0473, instance_loss: 0.4126, weighted_loss: 0.1569, label: 0, bag_size: 3871
batch 59, loss: 0.0190, instance_loss: 0.5217, weighted_loss: 0.1698, label: 1, bag_size: 3885
batch 79, loss: 0.0011, instance_loss: 0.5846, weighted_loss: 0.1761, label: 1, bag_size: 3156
batch 99, loss: 0.7962, instance_loss: 0.9002, weighted_loss: 0.8274, label: 1, bag_size: 2481
batch 119, loss: 0.0109, instance_loss: 0.1163, weighted_loss: 0.0425, label: 1, bag_size: 3398
batch 139, loss: 0.0404, instance_loss: 0.2517, weighted_loss: 0.1038, label: 1, bag_size: 3225
batch 159, loss: 0.0112, instance_loss: 0.9625, weighted_loss: 0.2966, label: 1, bag_size: 20666
batch 179, loss: 0.0000, instance_loss: 0.0633, weighted_loss: 0.0190, label: 0, bag_size: 4083
batch 199, loss: 0.0376, instance_loss: 0.1677, weighted_loss: 0.0766, label: 0, bag_size: 5260
batch 219, loss: 1.1412, instance_loss: 0.6158, weighted_loss: 0.9836, label: 2, bag_size: 88
batch 239, loss: 0.2095, instance_loss: 0.2703, weighted_loss: 0.2277, label: 2, bag_size: 6704
batch 259, loss: 3.7930, instance_loss: 1.7530, weighted_loss: 3.1810, label: 1, bag_size: 3399
batch 279, loss: 0.0808, instance_loss: 0.2352, weighted_loss: 0.1271, label: 2, bag_size: 5138
batch 299, loss: 0.0234, instance_loss: 0.0986, weighted_loss: 0.0460, label: 2, bag_size: 4555
batch 319, loss: 0.8350, instance_loss: 0.9665, weighted_loss: 0.8745, label: 1, bag_size: 4467
batch 339, loss: 1.0092, instance_loss: 0.9479, weighted_loss: 0.9908, label: 2, bag_size: 552
batch 359, loss: 0.0501, instance_loss: 0.4021, weighted_loss: 0.1557, label: 1, bag_size: 4534
batch 379, loss: 0.1516, instance_loss: 0.3701, weighted_loss: 0.2172, label: 2, bag_size: 4141
batch 399, loss: 0.0165, instance_loss: 0.1116, weighted_loss: 0.0450, label: 0, bag_size: 3294
batch 419, loss: 0.1122, instance_loss: 0.1894, weighted_loss: 0.1354, label: 2, bag_size: 3678
batch 439, loss: 0.1522, instance_loss: 0.4892, weighted_loss: 0.2533, label: 1, bag_size: 4395
batch 459, loss: 0.0646, instance_loss: 0.2223, weighted_loss: 0.1120, label: 2, bag_size: 6644
batch 479, loss: 0.2523, instance_loss: 0.3198, weighted_loss: 0.2725, label: 1, bag_size: 3935
batch 499, loss: 0.0000, instance_loss: 0.1679, weighted_loss: 0.0504, label: 0, bag_size: 4918
batch 519, loss: 1.3070, instance_loss: 0.5340, weighted_loss: 1.0751, label: 1, bag_size: 2865
batch 539, loss: 0.0090, instance_loss: 1.0378, weighted_loss: 0.3177, label: 0, bag_size: 1808
batch 559, loss: 0.0056, instance_loss: 0.2219, weighted_loss: 0.0705, label: 0, bag_size: 4831
batch 579, loss: 0.0000, instance_loss: 0.1652, weighted_loss: 0.0496, label: 1, bag_size: 5018
batch 599, loss: 0.0267, instance_loss: 0.2282, weighted_loss: 0.0872, label: 0, bag_size: 4300
batch 619, loss: 0.0231, instance_loss: 0.4034, weighted_loss: 0.1372, label: 1, bag_size: 5756
batch 639, loss: 3.8227, instance_loss: 1.3777, weighted_loss: 3.0892, label: 0, bag_size: 1755
batch 659, loss: 0.0051, instance_loss: 0.1546, weighted_loss: 0.0499, label: 1, bag_size: 3127
batch 679, loss: 0.9600, instance_loss: 1.1244, weighted_loss: 1.0093, label: 1, bag_size: 1558
batch 699, loss: 0.3149, instance_loss: 0.8175, weighted_loss: 0.4656, label: 1, bag_size: 5402
batch 719, loss: 1.4089, instance_loss: 1.0495, weighted_loss: 1.3011, label: 0, bag_size: 1795
batch 739, loss: 0.1748, instance_loss: 0.4361, weighted_loss: 0.2532, label: 2, bag_size: 3778


class 0 clustering acc 0.9628635346756153: correct 17216/17880
class 1 clustering acc 0.4879194630872483: correct 2908/5960
Epoch: 86, train_loss: 0.3836, train_clustering_loss:  0.4832, train_error: 0.1624
class 0: acc 0.8555555555555555, correct 231/270
class 1: acc 0.751004016064257, correct 187/249
class 2: acc 0.911504424778761, correct 206/226

Val Set, val_loss: 0.4901, val_error: 0.2234, auc: 0.9283
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.4148936170212766: correct 312/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.527244 --> 0.490106).  Saving model ...


batch 19, loss: 0.0588, instance_loss: 0.3968, weighted_loss: 0.1602, label: 1, bag_size: 3640
batch 39, loss: 0.0867, instance_loss: 0.2768, weighted_loss: 0.1438, label: 2, bag_size: 3746
batch 59, loss: 0.1857, instance_loss: 0.3673, weighted_loss: 0.2402, label: 2, bag_size: 2031
batch 79, loss: 0.1405, instance_loss: 0.3116, weighted_loss: 0.1918, label: 1, bag_size: 700
batch 99, loss: 0.2049, instance_loss: 0.9973, weighted_loss: 0.4426, label: 1, bag_size: 3322
batch 119, loss: 0.0735, instance_loss: 0.3019, weighted_loss: 0.1420, label: 0, bag_size: 5098
batch 139, loss: 1.4957, instance_loss: 0.9003, weighted_loss: 1.3171, label: 2, bag_size: 728
batch 159, loss: 0.0607, instance_loss: 0.2434, weighted_loss: 0.1155, label: 0, bag_size: 2927
batch 179, loss: 0.1187, instance_loss: 0.7408, weighted_loss: 0.3053, label: 2, bag_size: 4571
batch 199, loss: 0.9507, instance_loss: 0.5437, weighted_loss: 0.8286, label: 2, bag_size: 3174
batch 219, loss: 0.2860, instance_loss: 0.7710, weighted_loss: 0.4315, label: 2, bag_size: 6298
batch 239, loss: 0.5080, instance_loss: 0.3931, weighted_loss: 0.4735, label: 2, bag_size: 2501
batch 259, loss: 0.1352, instance_loss: 0.2732, weighted_loss: 0.1766, label: 0, bag_size: 2671
batch 279, loss: 0.0145, instance_loss: 0.0893, weighted_loss: 0.0370, label: 2, bag_size: 3497
batch 299, loss: 0.2171, instance_loss: 0.2518, weighted_loss: 0.2275, label: 2, bag_size: 3415
batch 319, loss: 2.3878, instance_loss: 0.4978, weighted_loss: 1.8208, label: 2, bag_size: 3274
batch 339, loss: 0.2053, instance_loss: 0.7330, weighted_loss: 0.3636, label: 1, bag_size: 574
batch 359, loss: 0.0039, instance_loss: 0.2123, weighted_loss: 0.0665, label: 0, bag_size: 3188
batch 379, loss: 0.0498, instance_loss: 0.1400, weighted_loss: 0.0769, label: 2, bag_size: 4162
batch 399, loss: 0.9725, instance_loss: 1.1051, weighted_loss: 1.0123, label: 1, bag_size: 5072
batch 419, loss: 0.0152, instance_loss: 0.4258, weighted_loss: 0.1384, label: 1, bag_size: 1604
batch 439, loss: 0.0415, instance_loss: 0.2848, weighted_loss: 0.1145, label: 0, bag_size: 2610
batch 459, loss: 0.0151, instance_loss: 0.1091, weighted_loss: 0.0433, label: 0, bag_size: 3348
batch 479, loss: 0.0211, instance_loss: 0.1332, weighted_loss: 0.0547, label: 0, bag_size: 5340
batch 499, loss: 0.8772, instance_loss: 0.4826, weighted_loss: 0.7588, label: 2, bag_size: 3778
batch 519, loss: 0.0980, instance_loss: 0.4512, weighted_loss: 0.2040, label: 1, bag_size: 1066
batch 539, loss: 0.0472, instance_loss: 0.2463, weighted_loss: 0.1070, label: 1, bag_size: 3225
batch 559, loss: 0.0132, instance_loss: 0.1123, weighted_loss: 0.0429, label: 1, bag_size: 3983
batch 579, loss: 0.4708, instance_loss: 0.8673, weighted_loss: 0.5897, label: 0, bag_size: 8866
batch 599, loss: 1.5074, instance_loss: 1.6145, weighted_loss: 1.5395, label: 1, bag_size: 3791
batch 619, loss: 0.0012, instance_loss: 0.7181, weighted_loss: 0.2163, label: 0, bag_size: 2826
batch 639, loss: 0.0165, instance_loss: 0.1581, weighted_loss: 0.0590, label: 0, bag_size: 4831
batch 659, loss: 0.0866, instance_loss: 0.2208, weighted_loss: 0.1269, label: 1, bag_size: 3761
batch 679, loss: 0.3197, instance_loss: 0.6195, weighted_loss: 0.4097, label: 2, bag_size: 361
batch 699, loss: 0.6447, instance_loss: 0.7696, weighted_loss: 0.6822, label: 1, bag_size: 1097
batch 719, loss: 5.2358, instance_loss: 2.0712, weighted_loss: 4.2864, label: 1, bag_size: 3159
batch 739, loss: 0.8767, instance_loss: 0.7315, weighted_loss: 0.8331, label: 1, bag_size: 6817


class 0 clustering acc 0.9656040268456376: correct 17265/17880
class 1 clustering acc 0.46929530201342284: correct 2797/5960
Epoch: 87, train_loss: 0.3883, train_clustering_loss:  0.4808, train_error: 0.1584
class 0: acc 0.8401639344262295, correct 205/244
class 1: acc 0.8015873015873016, correct 202/252
class 2: acc 0.8835341365461847, correct 220/249

Val Set, val_loss: 0.6051, val_error: 0.2340, auc: 0.9071
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.4401595744680851: correct 331/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5689, instance_loss: 0.9450, weighted_loss: 1.3817, label: 1, bag_size: 1549
batch 39, loss: 0.0497, instance_loss: 0.2691, weighted_loss: 0.1155, label: 1, bag_size: 4898
batch 59, loss: 0.0409, instance_loss: 0.1821, weighted_loss: 0.0833, label: 1, bag_size: 3007
batch 79, loss: 1.4844, instance_loss: 1.0616, weighted_loss: 1.3575, label: 1, bag_size: 5423
batch 99, loss: 1.0912, instance_loss: 0.9183, weighted_loss: 1.0393, label: 2, bag_size: 2326
batch 119, loss: 0.1020, instance_loss: 1.1616, weighted_loss: 0.4199, label: 2, bag_size: 4910
batch 139, loss: 0.2082, instance_loss: 0.7244, weighted_loss: 0.3630, label: 1, bag_size: 4395
batch 159, loss: 0.0084, instance_loss: 0.1447, weighted_loss: 0.0493, label: 0, bag_size: 4857
batch 179, loss: 0.0157, instance_loss: 0.5857, weighted_loss: 0.1867, label: 0, bag_size: 3752
batch 199, loss: 0.0357, instance_loss: 0.1118, weighted_loss: 0.0585, label: 2, bag_size: 614
batch 219, loss: 0.0978, instance_loss: 0.3162, weighted_loss: 0.1633, label: 2, bag_size: 3026
batch 239, loss: 0.0727, instance_loss: 0.4406, weighted_loss: 0.1830, label: 0, bag_size: 3319
batch 259, loss: 0.2804, instance_loss: 0.5723, weighted_loss: 0.3680, label: 0, bag_size: 4228
batch 279, loss: 0.0088, instance_loss: 0.6385, weighted_loss: 0.1977, label: 0, bag_size: 3872
batch 299, loss: 0.0398, instance_loss: 0.3539, weighted_loss: 0.1340, label: 1, bag_size: 2302
batch 319, loss: 0.3686, instance_loss: 0.5680, weighted_loss: 0.4284, label: 2, bag_size: 4497
batch 339, loss: 0.1366, instance_loss: 0.8118, weighted_loss: 0.3391, label: 1, bag_size: 4395
batch 359, loss: 0.0124, instance_loss: 0.1735, weighted_loss: 0.0607, label: 0, bag_size: 855
batch 379, loss: 0.2896, instance_loss: 0.3692, weighted_loss: 0.3135, label: 2, bag_size: 3546
batch 399, loss: 0.0662, instance_loss: 0.5844, weighted_loss: 0.2216, label: 1, bag_size: 14449
batch 419, loss: 0.3702, instance_loss: 0.4391, weighted_loss: 0.3909, label: 2, bag_size: 6298
batch 439, loss: 0.0857, instance_loss: 1.0262, weighted_loss: 0.3679, label: 2, bag_size: 22464
batch 459, loss: 0.0235, instance_loss: 0.1632, weighted_loss: 0.0654, label: 2, bag_size: 4569
batch 479, loss: 0.0791, instance_loss: 0.5318, weighted_loss: 0.2149, label: 2, bag_size: 4978
batch 499, loss: 0.3140, instance_loss: 0.5396, weighted_loss: 0.3817, label: 2, bag_size: 4487
batch 519, loss: 1.4960, instance_loss: 1.2452, weighted_loss: 1.4208, label: 1, bag_size: 4612
batch 539, loss: 0.6307, instance_loss: 0.6416, weighted_loss: 0.6339, label: 2, bag_size: 1513
batch 559, loss: 2.5546, instance_loss: 1.0608, weighted_loss: 2.1065, label: 0, bag_size: 3830
batch 579, loss: 0.0110, instance_loss: 0.1259, weighted_loss: 0.0454, label: 1, bag_size: 5026
batch 599, loss: 0.0901, instance_loss: 0.2486, weighted_loss: 0.1376, label: 1, bag_size: 3460
batch 619, loss: 0.8133, instance_loss: 0.6883, weighted_loss: 0.7758, label: 0, bag_size: 609
batch 639, loss: 0.0304, instance_loss: 0.1292, weighted_loss: 0.0600, label: 2, bag_size: 6644
batch 659, loss: 0.6698, instance_loss: 1.8349, weighted_loss: 1.0193, label: 0, bag_size: 3341
batch 679, loss: 0.1275, instance_loss: 0.5290, weighted_loss: 0.2479, label: 2, bag_size: 3299
batch 699, loss: 0.0304, instance_loss: 0.1446, weighted_loss: 0.0646, label: 1, bag_size: 2092
batch 719, loss: 0.1379, instance_loss: 0.4086, weighted_loss: 0.2191, label: 0, bag_size: 471
batch 739, loss: 0.0131, instance_loss: 0.1667, weighted_loss: 0.0592, label: 0, bag_size: 3690


class 0 clustering acc 0.9628076062639821: correct 17215/17880
class 1 clustering acc 0.5172818791946309: correct 3083/5960
Epoch: 88, train_loss: 0.3822, train_clustering_loss:  0.4726, train_error: 0.1383
class 0: acc 0.8661087866108786, correct 207/239
class 1: acc 0.7792792792792793, correct 173/222
class 2: acc 0.9225352112676056, correct 262/284

Val Set, val_loss: 0.5643, val_error: 0.2340, auc: 0.9201
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.538563829787234: correct 405/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4745, instance_loss: 0.9641, weighted_loss: 0.6214, label: 1, bag_size: 5512
batch 39, loss: 0.8658, instance_loss: 0.5195, weighted_loss: 0.7619, label: 2, bag_size: 4241
batch 59, loss: 0.0043, instance_loss: 0.1403, weighted_loss: 0.0451, label: 2, bag_size: 3583
batch 79, loss: 0.8177, instance_loss: 0.9639, weighted_loss: 0.8616, label: 0, bag_size: 436
batch 99, loss: 0.7707, instance_loss: 0.9344, weighted_loss: 0.8198, label: 1, bag_size: 5011
batch 119, loss: 0.0814, instance_loss: 0.5348, weighted_loss: 0.2174, label: 0, bag_size: 4865
batch 139, loss: 0.0057, instance_loss: 0.7149, weighted_loss: 0.2185, label: 1, bag_size: 2472
batch 159, loss: 0.4071, instance_loss: 0.2565, weighted_loss: 0.3619, label: 2, bag_size: 2561
batch 179, loss: 0.0046, instance_loss: 0.1000, weighted_loss: 0.0332, label: 1, bag_size: 5026
batch 199, loss: 0.2927, instance_loss: 0.4583, weighted_loss: 0.3424, label: 1, bag_size: 5412
batch 219, loss: 0.7906, instance_loss: 0.9125, weighted_loss: 0.8272, label: 1, bag_size: 1712
batch 239, loss: 0.3616, instance_loss: 0.7001, weighted_loss: 0.4632, label: 0, bag_size: 5867
batch 259, loss: 0.2557, instance_loss: 0.2630, weighted_loss: 0.2579, label: 2, bag_size: 3746
batch 279, loss: 0.0000, instance_loss: 0.0180, weighted_loss: 0.0054, label: 0, bag_size: 4083
batch 299, loss: 0.8138, instance_loss: 1.5005, weighted_loss: 1.0198, label: 1, bag_size: 1558
batch 319, loss: 0.0179, instance_loss: 0.1558, weighted_loss: 0.0593, label: 0, bag_size: 471
batch 339, loss: 0.3403, instance_loss: 0.5390, weighted_loss: 0.3999, label: 0, bag_size: 4398
batch 359, loss: 0.0040, instance_loss: 0.1476, weighted_loss: 0.0471, label: 2, bag_size: 4788
batch 379, loss: 2.1424, instance_loss: 1.1182, weighted_loss: 1.8352, label: 1, bag_size: 3261
batch 399, loss: 0.1158, instance_loss: 0.2500, weighted_loss: 0.1561, label: 0, bag_size: 3297
batch 419, loss: 1.4020, instance_loss: 1.5773, weighted_loss: 1.4546, label: 1, bag_size: 8632
batch 439, loss: 0.1630, instance_loss: 0.3522, weighted_loss: 0.2197, label: 2, bag_size: 6644
batch 459, loss: 0.1317, instance_loss: 0.2056, weighted_loss: 0.1539, label: 2, bag_size: 2031
batch 479, loss: 0.0851, instance_loss: 0.7011, weighted_loss: 0.2699, label: 2, bag_size: 3475
batch 499, loss: 0.1220, instance_loss: 0.3473, weighted_loss: 0.1896, label: 0, bag_size: 3797
batch 519, loss: 0.4939, instance_loss: 0.7311, weighted_loss: 0.5650, label: 2, bag_size: 4342
batch 539, loss: 1.7332, instance_loss: 0.6949, weighted_loss: 1.4217, label: 0, bag_size: 4717
batch 559, loss: 0.1687, instance_loss: 0.2866, weighted_loss: 0.2041, label: 1, bag_size: 2905
batch 579, loss: 0.3480, instance_loss: 0.7046, weighted_loss: 0.4550, label: 2, bag_size: 909
batch 599, loss: 0.0539, instance_loss: 0.1279, weighted_loss: 0.0761, label: 2, bag_size: 4302
batch 619, loss: 0.1646, instance_loss: 0.3284, weighted_loss: 0.2137, label: 1, bag_size: 5532
batch 639, loss: 0.3841, instance_loss: 0.8759, weighted_loss: 0.5317, label: 1, bag_size: 5718
batch 659, loss: 0.0024, instance_loss: 0.1992, weighted_loss: 0.0614, label: 0, bag_size: 3182
batch 679, loss: 0.0189, instance_loss: 0.3139, weighted_loss: 0.1074, label: 0, bag_size: 1034
batch 699, loss: 0.0078, instance_loss: 0.2079, weighted_loss: 0.0678, label: 1, bag_size: 3460
batch 719, loss: 0.0287, instance_loss: 0.1527, weighted_loss: 0.0659, label: 1, bag_size: 2254
batch 739, loss: 0.5732, instance_loss: 1.0030, weighted_loss: 0.7021, label: 1, bag_size: 667


class 0 clustering acc 0.9578299776286353: correct 17126/17880
class 1 clustering acc 0.5325503355704698: correct 3174/5960
Epoch: 89, train_loss: 0.3613, train_clustering_loss:  0.4669, train_error: 0.1315
class 0: acc 0.884, correct 221/250
class 1: acc 0.7713004484304933, correct 172/223
class 2: acc 0.9338235294117647, correct 254/272

Val Set, val_loss: 0.8957, val_error: 0.2872, auc: 0.8883
class 0 clustering acc 0.9481382978723404: correct 2139/2256
class 1 clustering acc 0.3723404255319149: correct 280/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1978, instance_loss: 0.4515, weighted_loss: 0.2739, label: 1, bag_size: 11768
batch 39, loss: 0.8695, instance_loss: 0.9393, weighted_loss: 0.8904, label: 1, bag_size: 2831
batch 59, loss: 0.3805, instance_loss: 0.5350, weighted_loss: 0.4268, label: 2, bag_size: 5472
batch 79, loss: 0.0016, instance_loss: 0.1802, weighted_loss: 0.0552, label: 0, bag_size: 4251
batch 99, loss: 0.0340, instance_loss: 0.2446, weighted_loss: 0.0972, label: 2, bag_size: 3778
batch 119, loss: 0.0181, instance_loss: 0.1113, weighted_loss: 0.0461, label: 2, bag_size: 5017
batch 139, loss: 0.0276, instance_loss: 0.5142, weighted_loss: 0.1736, label: 1, bag_size: 6993
batch 159, loss: 0.0182, instance_loss: 0.0496, weighted_loss: 0.0276, label: 0, bag_size: 2791
batch 179, loss: 0.1302, instance_loss: 0.3180, weighted_loss: 0.1865, label: 2, bag_size: 6298
batch 199, loss: 1.5495, instance_loss: 1.2173, weighted_loss: 1.4498, label: 1, bag_size: 4187
batch 219, loss: 0.1241, instance_loss: 0.3721, weighted_loss: 0.1985, label: 2, bag_size: 1222
batch 239, loss: 0.0235, instance_loss: 0.1171, weighted_loss: 0.0516, label: 2, bag_size: 2359
batch 259, loss: 0.0068, instance_loss: 0.1407, weighted_loss: 0.0470, label: 2, bag_size: 4856
batch 279, loss: 0.0190, instance_loss: 0.1337, weighted_loss: 0.0534, label: 2, bag_size: 2359
batch 299, loss: 0.0897, instance_loss: 0.1925, weighted_loss: 0.1205, label: 2, bag_size: 3534
batch 319, loss: 0.1169, instance_loss: 0.3876, weighted_loss: 0.1981, label: 2, bag_size: 2326
batch 339, loss: 0.3648, instance_loss: 0.4283, weighted_loss: 0.3838, label: 0, bag_size: 5890
batch 359, loss: 3.2746, instance_loss: 1.6100, weighted_loss: 2.7752, label: 0, bag_size: 1289
batch 379, loss: 0.0315, instance_loss: 0.2111, weighted_loss: 0.0854, label: 0, bag_size: 4760
batch 399, loss: 0.0392, instance_loss: 0.1838, weighted_loss: 0.0826, label: 2, bag_size: 4141
batch 419, loss: 0.0487, instance_loss: 0.2316, weighted_loss: 0.1035, label: 1, bag_size: 5086
batch 439, loss: 0.0000, instance_loss: 0.0921, weighted_loss: 0.0277, label: 1, bag_size: 5018
batch 459, loss: 0.6001, instance_loss: 0.5541, weighted_loss: 0.5863, label: 2, bag_size: 1222
batch 479, loss: 0.4521, instance_loss: 0.5097, weighted_loss: 0.4693, label: 1, bag_size: 4119
batch 499, loss: 0.1877, instance_loss: 0.8313, weighted_loss: 0.3808, label: 0, bag_size: 889
batch 519, loss: 0.4444, instance_loss: 0.1783, weighted_loss: 0.3646, label: 2, bag_size: 614
batch 539, loss: 0.0583, instance_loss: 0.1464, weighted_loss: 0.0848, label: 0, bag_size: 4201
batch 559, loss: 0.0811, instance_loss: 0.5470, weighted_loss: 0.2208, label: 2, bag_size: 5743
batch 579, loss: 0.0603, instance_loss: 0.1467, weighted_loss: 0.0862, label: 1, bag_size: 2092
batch 599, loss: 0.0435, instance_loss: 0.4250, weighted_loss: 0.1580, label: 2, bag_size: 4978
batch 619, loss: 0.0051, instance_loss: 0.3100, weighted_loss: 0.0966, label: 1, bag_size: 2009
batch 639, loss: 0.4099, instance_loss: 0.6477, weighted_loss: 0.4812, label: 1, bag_size: 6942
batch 659, loss: 0.0492, instance_loss: 0.2354, weighted_loss: 0.1051, label: 1, bag_size: 3009
batch 679, loss: 0.1576, instance_loss: 0.7349, weighted_loss: 0.3308, label: 1, bag_size: 4373
batch 699, loss: 0.0692, instance_loss: 0.8963, weighted_loss: 0.3173, label: 2, bag_size: 909
batch 719, loss: 1.6904, instance_loss: 1.2445, weighted_loss: 1.5566, label: 0, bag_size: 1795
batch 739, loss: 0.0784, instance_loss: 0.0537, weighted_loss: 0.0710, label: 0, bag_size: 9897


class 0 clustering acc 0.9645973154362416: correct 17247/17880
class 1 clustering acc 0.4937919463087248: correct 2943/5960
Epoch: 90, train_loss: 0.3471, train_clustering_loss:  0.4791, train_error: 0.1356
class 0: acc 0.8577405857740585, correct 205/239
class 1: acc 0.8016194331983806, correct 198/247
class 2: acc 0.9305019305019305, correct 241/259

Val Set, val_loss: 0.6270, val_error: 0.2340, auc: 0.9077
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.488031914893617: correct 367/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0206, instance_loss: 0.3337, weighted_loss: 0.1146, label: 0, bag_size: 4997
batch 39, loss: 0.0728, instance_loss: 0.2411, weighted_loss: 0.1233, label: 1, bag_size: 5026
batch 59, loss: 1.3843, instance_loss: 0.6203, weighted_loss: 1.1551, label: 2, bag_size: 2326
batch 79, loss: 0.2575, instance_loss: 0.3838, weighted_loss: 0.2954, label: 2, bag_size: 2501
batch 99, loss: 0.6183, instance_loss: 0.7650, weighted_loss: 0.6623, label: 0, bag_size: 5259
batch 119, loss: 3.3698, instance_loss: 1.3941, weighted_loss: 2.7771, label: 0, bag_size: 4605
batch 139, loss: 0.0017, instance_loss: 0.0941, weighted_loss: 0.0294, label: 0, bag_size: 3754
batch 159, loss: 1.8094, instance_loss: 1.0906, weighted_loss: 1.5938, label: 0, bag_size: 436
batch 179, loss: 0.1020, instance_loss: 0.5628, weighted_loss: 0.2402, label: 1, bag_size: 3644
batch 199, loss: 1.0994, instance_loss: 1.8172, weighted_loss: 1.3147, label: 0, bag_size: 2232
batch 219, loss: 0.5249, instance_loss: 0.4561, weighted_loss: 0.5042, label: 2, bag_size: 5406
batch 239, loss: 0.0325, instance_loss: 0.2280, weighted_loss: 0.0912, label: 1, bag_size: 425
batch 259, loss: 0.0121, instance_loss: 0.3172, weighted_loss: 0.1036, label: 2, bag_size: 88
batch 279, loss: 1.4174, instance_loss: 0.8670, weighted_loss: 1.2523, label: 0, bag_size: 5023
batch 299, loss: 0.2585, instance_loss: 0.6062, weighted_loss: 0.3628, label: 1, bag_size: 3991
batch 319, loss: 0.0304, instance_loss: 0.3428, weighted_loss: 0.1241, label: 2, bag_size: 4487
batch 339, loss: 0.0004, instance_loss: 0.2217, weighted_loss: 0.0668, label: 0, bag_size: 4841
batch 359, loss: 0.0282, instance_loss: 0.1163, weighted_loss: 0.0546, label: 2, bag_size: 4745
batch 379, loss: 0.0294, instance_loss: 0.2888, weighted_loss: 0.1072, label: 0, bag_size: 1176
batch 399, loss: 0.0028, instance_loss: 0.0680, weighted_loss: 0.0224, label: 2, bag_size: 4856
batch 419, loss: 0.0532, instance_loss: 0.0930, weighted_loss: 0.0651, label: 2, bag_size: 2561
batch 439, loss: 0.3109, instance_loss: 0.4814, weighted_loss: 0.3621, label: 1, bag_size: 1221
batch 459, loss: 0.0823, instance_loss: 0.5173, weighted_loss: 0.2128, label: 0, bag_size: 16741
batch 479, loss: 0.0335, instance_loss: 0.1668, weighted_loss: 0.0735, label: 2, bag_size: 2770
batch 499, loss: 0.0110, instance_loss: 0.2260, weighted_loss: 0.0755, label: 0, bag_size: 4351
batch 519, loss: 0.0000, instance_loss: 0.0295, weighted_loss: 0.0089, label: 1, bag_size: 5018
batch 539, loss: 0.0241, instance_loss: 0.1352, weighted_loss: 0.0575, label: 2, bag_size: 1094
batch 559, loss: 0.0989, instance_loss: 0.1281, weighted_loss: 0.1076, label: 2, bag_size: 3397
batch 579, loss: 0.0776, instance_loss: 0.3137, weighted_loss: 0.1484, label: 0, bag_size: 8611
batch 599, loss: 0.0407, instance_loss: 0.3675, weighted_loss: 0.1388, label: 2, bag_size: 4535
batch 619, loss: 0.1255, instance_loss: 0.5735, weighted_loss: 0.2599, label: 2, bag_size: 2486
batch 639, loss: 0.0556, instance_loss: 0.2830, weighted_loss: 0.1238, label: 2, bag_size: 7607
batch 659, loss: 0.0191, instance_loss: 0.5867, weighted_loss: 0.1894, label: 0, bag_size: 4894
batch 679, loss: 5.4294, instance_loss: 0.7175, weighted_loss: 4.0158, label: 2, bag_size: 2561
batch 699, loss: 0.0202, instance_loss: 0.1953, weighted_loss: 0.0727, label: 1, bag_size: 3534
batch 719, loss: 0.7556, instance_loss: 1.0181, weighted_loss: 0.8344, label: 1, bag_size: 4806
batch 739, loss: 0.0000, instance_loss: 0.3879, weighted_loss: 0.1164, label: 0, bag_size: 1341


class 0 clustering acc 0.9614653243847875: correct 17191/17880
class 1 clustering acc 0.4708053691275168: correct 2806/5960
Epoch: 91, train_loss: 0.4168, train_clustering_loss:  0.5004, train_error: 0.1785
class 0: acc 0.8423076923076923, correct 219/260
class 1: acc 0.7521367521367521, correct 176/234
class 2: acc 0.8645418326693227, correct 217/251

Val Set, val_loss: 0.6819, val_error: 0.2340, auc: 0.9050
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.511968085106383: correct 385/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.7778, instance_loss: 0.5787, weighted_loss: 1.4180, label: 1, bag_size: 4812
batch 39, loss: 0.2061, instance_loss: 0.4655, weighted_loss: 0.2839, label: 1, bag_size: 4599
batch 59, loss: 2.0953, instance_loss: 1.1595, weighted_loss: 1.8146, label: 0, bag_size: 455
batch 79, loss: 0.0139, instance_loss: 0.0815, weighted_loss: 0.0342, label: 2, bag_size: 3415
batch 99, loss: 0.0770, instance_loss: 0.5253, weighted_loss: 0.2115, label: 1, bag_size: 3396
batch 119, loss: 0.0322, instance_loss: 0.2477, weighted_loss: 0.0969, label: 0, bag_size: 3690
batch 139, loss: 0.0266, instance_loss: 0.8407, weighted_loss: 0.2708, label: 2, bag_size: 909
batch 159, loss: 0.0002, instance_loss: 0.1759, weighted_loss: 0.0529, label: 1, bag_size: 3425
batch 179, loss: 0.4381, instance_loss: 1.1810, weighted_loss: 0.6610, label: 2, bag_size: 4910
batch 199, loss: 0.1288, instance_loss: 0.2168, weighted_loss: 0.1552, label: 2, bag_size: 3678
batch 219, loss: 0.1847, instance_loss: 0.5422, weighted_loss: 0.2919, label: 2, bag_size: 3299
batch 239, loss: 0.1408, instance_loss: 0.6538, weighted_loss: 0.2947, label: 0, bag_size: 2915
batch 259, loss: 0.4769, instance_loss: 1.1828, weighted_loss: 0.6887, label: 2, bag_size: 22464
batch 279, loss: 0.0784, instance_loss: 0.2238, weighted_loss: 0.1220, label: 0, bag_size: 4584
batch 299, loss: 0.8550, instance_loss: 0.6760, weighted_loss: 0.8013, label: 2, bag_size: 705
batch 319, loss: 0.1284, instance_loss: 0.3662, weighted_loss: 0.1997, label: 1, bag_size: 6156
batch 339, loss: 1.7990, instance_loss: 0.5247, weighted_loss: 1.4167, label: 1, bag_size: 2865
batch 359, loss: 0.0000, instance_loss: 0.5999, weighted_loss: 0.1800, label: 1, bag_size: 4067
batch 379, loss: 3.1385, instance_loss: 1.6925, weighted_loss: 2.7047, label: 1, bag_size: 3159
batch 399, loss: 0.1532, instance_loss: 0.1481, weighted_loss: 0.1517, label: 2, bag_size: 1103
batch 419, loss: 0.0865, instance_loss: 0.4972, weighted_loss: 0.2097, label: 1, bag_size: 6165
batch 439, loss: 0.0151, instance_loss: 0.2164, weighted_loss: 0.0755, label: 2, bag_size: 1094
batch 459, loss: 0.0113, instance_loss: 0.0959, weighted_loss: 0.0367, label: 2, bag_size: 3415
batch 479, loss: 0.0093, instance_loss: 0.1632, weighted_loss: 0.0555, label: 1, bag_size: 4253
batch 499, loss: 1.5623, instance_loss: 0.8727, weighted_loss: 1.3554, label: 0, bag_size: 4245
batch 519, loss: 0.1349, instance_loss: 0.5708, weighted_loss: 0.2657, label: 0, bag_size: 14218
batch 539, loss: 0.0000, instance_loss: 0.2014, weighted_loss: 0.0604, label: 1, bag_size: 5760
batch 559, loss: 0.0008, instance_loss: 0.0313, weighted_loss: 0.0100, label: 0, bag_size: 4857
batch 579, loss: 0.0100, instance_loss: 0.0909, weighted_loss: 0.0342, label: 2, bag_size: 3121
batch 599, loss: 2.3379, instance_loss: 1.1207, weighted_loss: 1.9727, label: 1, bag_size: 2425
batch 619, loss: 1.5427, instance_loss: 0.7139, weighted_loss: 1.2940, label: 1, bag_size: 3100
batch 639, loss: 0.0005, instance_loss: 0.3051, weighted_loss: 0.0919, label: 2, bag_size: 3094
batch 659, loss: 0.0323, instance_loss: 0.2275, weighted_loss: 0.0908, label: 0, bag_size: 1625
batch 679, loss: 0.7737, instance_loss: 1.5487, weighted_loss: 1.0062, label: 1, bag_size: 2744
batch 699, loss: 0.3237, instance_loss: 0.6129, weighted_loss: 0.4104, label: 2, bag_size: 4535
batch 719, loss: 0.0148, instance_loss: 0.1476, weighted_loss: 0.0547, label: 1, bag_size: 425
batch 739, loss: 0.0003, instance_loss: 0.0410, weighted_loss: 0.0125, label: 1, bag_size: 4599


class 0 clustering acc 0.9649328859060403: correct 17253/17880
class 1 clustering acc 0.46929530201342284: correct 2797/5960
Epoch: 92, train_loss: 0.3286, train_clustering_loss:  0.4764, train_error: 0.1235
class 0: acc 0.8734693877551021, correct 214/245
class 1: acc 0.8228346456692913, correct 209/254
class 2: acc 0.9349593495934959, correct 230/246

Val Set, val_loss: 1.1125, val_error: 0.3404, auc: 0.8765
class 0 clustering acc 0.9512411347517731: correct 2146/2256
class 1 clustering acc 0.44680851063829785: correct 336/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7740, instance_loss: 0.9727, weighted_loss: 0.8336, label: 2, bag_size: 5472
batch 39, loss: 0.0062, instance_loss: 0.0706, weighted_loss: 0.0255, label: 1, bag_size: 3983
batch 59, loss: 0.0169, instance_loss: 0.1232, weighted_loss: 0.0488, label: 2, bag_size: 4569
batch 79, loss: 0.0085, instance_loss: 0.1982, weighted_loss: 0.0654, label: 0, bag_size: 1097
batch 99, loss: 0.3293, instance_loss: 0.3371, weighted_loss: 0.3317, label: 2, bag_size: 4162
batch 119, loss: 0.1673, instance_loss: 0.2399, weighted_loss: 0.1891, label: 2, bag_size: 3546
batch 139, loss: 0.0068, instance_loss: 0.0671, weighted_loss: 0.0249, label: 2, bag_size: 2561
batch 159, loss: 0.0207, instance_loss: 0.3152, weighted_loss: 0.1091, label: 1, bag_size: 4262
batch 179, loss: 0.0025, instance_loss: 0.4653, weighted_loss: 0.1414, label: 0, bag_size: 4070
batch 199, loss: 0.0067, instance_loss: 0.1632, weighted_loss: 0.0537, label: 0, bag_size: 3182
batch 219, loss: 0.2637, instance_loss: 0.3481, weighted_loss: 0.2890, label: 2, bag_size: 4141
batch 239, loss: 0.0862, instance_loss: 0.2436, weighted_loss: 0.1334, label: 2, bag_size: 4141
batch 259, loss: 0.1464, instance_loss: 0.2451, weighted_loss: 0.1760, label: 2, bag_size: 3174
batch 279, loss: 0.0241, instance_loss: 0.4034, weighted_loss: 0.1379, label: 1, bag_size: 3126
batch 299, loss: 0.0934, instance_loss: 0.1889, weighted_loss: 0.1220, label: 2, bag_size: 3778
batch 319, loss: 0.0104, instance_loss: 0.3108, weighted_loss: 0.1006, label: 0, bag_size: 23335
batch 339, loss: 0.0868, instance_loss: 0.1726, weighted_loss: 0.1125, label: 2, bag_size: 3176
batch 359, loss: 0.0003, instance_loss: 0.0534, weighted_loss: 0.0163, label: 1, bag_size: 5026
batch 379, loss: 0.1564, instance_loss: 0.2541, weighted_loss: 0.1857, label: 2, bag_size: 3678
batch 399, loss: 0.1273, instance_loss: 0.1287, weighted_loss: 0.1277, label: 2, bag_size: 1103
batch 419, loss: 0.3187, instance_loss: 1.0472, weighted_loss: 0.5372, label: 0, bag_size: 4626
batch 439, loss: 0.0800, instance_loss: 0.3806, weighted_loss: 0.1702, label: 1, bag_size: 4262
batch 459, loss: 0.0000, instance_loss: 0.1328, weighted_loss: 0.0399, label: 0, bag_size: 3445
batch 479, loss: 0.2072, instance_loss: 0.7449, weighted_loss: 0.3685, label: 0, bag_size: 8611
batch 499, loss: 0.0176, instance_loss: 0.3662, weighted_loss: 0.1222, label: 0, bag_size: 4242
batch 519, loss: 0.8652, instance_loss: 0.7775, weighted_loss: 0.8389, label: 0, bag_size: 4310
batch 539, loss: 0.0191, instance_loss: 0.1077, weighted_loss: 0.0457, label: 0, bag_size: 5039
batch 559, loss: 0.9015, instance_loss: 0.4771, weighted_loss: 0.7742, label: 2, bag_size: 597
batch 579, loss: 0.4058, instance_loss: 0.9133, weighted_loss: 0.5580, label: 1, bag_size: 6241
batch 599, loss: 0.0103, instance_loss: 0.0925, weighted_loss: 0.0350, label: 1, bag_size: 5385
batch 619, loss: 0.3549, instance_loss: 0.4213, weighted_loss: 0.3748, label: 2, bag_size: 1513
batch 639, loss: 0.1919, instance_loss: 0.5529, weighted_loss: 0.3002, label: 2, bag_size: 3299
batch 659, loss: 0.0153, instance_loss: 0.2126, weighted_loss: 0.0745, label: 0, bag_size: 1744
batch 679, loss: 0.5508, instance_loss: 0.4315, weighted_loss: 0.5150, label: 1, bag_size: 6993
batch 699, loss: 0.0173, instance_loss: 0.0876, weighted_loss: 0.0384, label: 1, bag_size: 3050
batch 719, loss: 0.5677, instance_loss: 0.9718, weighted_loss: 0.6889, label: 1, bag_size: 1477
batch 739, loss: 2.1686, instance_loss: 0.9985, weighted_loss: 1.8176, label: 0, bag_size: 2915


class 0 clustering acc 0.9650447427293065: correct 17255/17880
class 1 clustering acc 0.5080536912751678: correct 3028/5960
Epoch: 93, train_loss: 0.3590, train_clustering_loss:  0.4706, train_error: 0.1329
class 0: acc 0.84, correct 189/225
class 1: acc 0.8434163701067615, correct 237/281
class 2: acc 0.9205020920502092, correct 220/239

Val Set, val_loss: 0.5485, val_error: 0.2234, auc: 0.9239
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.4321808510638298: correct 325/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.8192, instance_loss: 0.3887, weighted_loss: 0.6900, label: 0, bag_size: 4378
batch 39, loss: 0.0984, instance_loss: 0.4192, weighted_loss: 0.1946, label: 0, bag_size: 3797
batch 59, loss: 0.0518, instance_loss: 0.3643, weighted_loss: 0.1456, label: 0, bag_size: 1234
batch 79, loss: 0.0034, instance_loss: 0.1561, weighted_loss: 0.0492, label: 1, bag_size: 5385
batch 99, loss: 0.3948, instance_loss: 0.3887, weighted_loss: 0.3930, label: 2, bag_size: 4162
batch 119, loss: 0.0606, instance_loss: 0.1689, weighted_loss: 0.0931, label: 2, bag_size: 3678
batch 139, loss: 0.0000, instance_loss: 0.4832, weighted_loss: 0.1450, label: 1, bag_size: 1542
batch 159, loss: 0.4135, instance_loss: 0.3503, weighted_loss: 0.3945, label: 2, bag_size: 705
batch 179, loss: 0.2912, instance_loss: 0.6723, weighted_loss: 0.4055, label: 0, bag_size: 1562
batch 199, loss: 0.0569, instance_loss: 0.2940, weighted_loss: 0.1280, label: 1, bag_size: 5696
batch 219, loss: 0.2403, instance_loss: 0.3119, weighted_loss: 0.2618, label: 2, bag_size: 2501
batch 239, loss: 0.4427, instance_loss: 0.6485, weighted_loss: 0.5044, label: 1, bag_size: 3482
batch 259, loss: 0.0383, instance_loss: 0.1912, weighted_loss: 0.0842, label: 2, bag_size: 3396
batch 279, loss: 0.0000, instance_loss: 1.0563, weighted_loss: 0.3169, label: 0, bag_size: 1981
batch 299, loss: 0.0249, instance_loss: 0.1631, weighted_loss: 0.0664, label: 2, bag_size: 3396
batch 319, loss: 0.0039, instance_loss: 0.4514, weighted_loss: 0.1382, label: 0, bag_size: 5646
batch 339, loss: 0.0426, instance_loss: 0.3291, weighted_loss: 0.1285, label: 0, bag_size: 4242
batch 359, loss: 1.3168, instance_loss: 0.4774, weighted_loss: 1.0650, label: 2, bag_size: 1513
batch 379, loss: 0.5034, instance_loss: 0.8180, weighted_loss: 0.5978, label: 1, bag_size: 2744
batch 399, loss: 0.0000, instance_loss: 0.0906, weighted_loss: 0.0272, label: 1, bag_size: 1836
batch 419, loss: 0.0447, instance_loss: 0.7133, weighted_loss: 0.2452, label: 0, bag_size: 889
batch 439, loss: 0.1622, instance_loss: 0.6210, weighted_loss: 0.2999, label: 0, bag_size: 8611
batch 459, loss: 0.0986, instance_loss: 0.2715, weighted_loss: 0.1505, label: 2, bag_size: 3172
batch 479, loss: 0.0287, instance_loss: 0.1729, weighted_loss: 0.0719, label: 1, bag_size: 6475
batch 499, loss: 0.5069, instance_loss: 0.3396, weighted_loss: 0.4567, label: 1, bag_size: 1042
batch 519, loss: 0.0050, instance_loss: 0.1147, weighted_loss: 0.0379, label: 2, bag_size: 2561
batch 539, loss: 0.0426, instance_loss: 0.2309, weighted_loss: 0.0991, label: 2, bag_size: 3618
batch 559, loss: 1.0263, instance_loss: 0.7650, weighted_loss: 0.9479, label: 0, bag_size: 35080
batch 579, loss: 0.0690, instance_loss: 0.2075, weighted_loss: 0.1105, label: 2, bag_size: 614
batch 599, loss: 0.1167, instance_loss: 0.5519, weighted_loss: 0.2472, label: 0, bag_size: 4378
batch 619, loss: 0.0620, instance_loss: 0.1122, weighted_loss: 0.0771, label: 2, bag_size: 2049
batch 639, loss: 0.0004, instance_loss: 0.1814, weighted_loss: 0.0547, label: 1, bag_size: 3156
batch 659, loss: 0.0125, instance_loss: 0.1654, weighted_loss: 0.0584, label: 2, bag_size: 4203
batch 679, loss: 0.0069, instance_loss: 0.1513, weighted_loss: 0.0503, label: 2, bag_size: 4497
batch 699, loss: 0.0286, instance_loss: 0.1630, weighted_loss: 0.0689, label: 0, bag_size: 4325
batch 719, loss: 0.0319, instance_loss: 0.0624, weighted_loss: 0.0410, label: 2, bag_size: 4241
batch 739, loss: 0.0838, instance_loss: 0.5048, weighted_loss: 0.2101, label: 1, bag_size: 667


class 0 clustering acc 0.9643176733780761: correct 17242/17880
class 1 clustering acc 0.4988255033557047: correct 2973/5960
Epoch: 94, train_loss: 0.3621, train_clustering_loss:  0.4794, train_error: 0.1423
class 0: acc 0.8291666666666667, correct 199/240
class 1: acc 0.8211382113821138, correct 202/246
class 2: acc 0.918918918918919, correct 238/259

Val Set, val_loss: 0.5184, val_error: 0.2021, auc: 0.9255
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.38563829787234044: correct 290/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0288, instance_loss: 0.0522, weighted_loss: 0.0358, label: 2, bag_size: 614
batch 39, loss: 0.0006, instance_loss: 0.1726, weighted_loss: 0.0522, label: 1, bag_size: 3156
batch 59, loss: 0.0228, instance_loss: 0.1023, weighted_loss: 0.0467, label: 2, bag_size: 5037
batch 79, loss: 0.1057, instance_loss: 0.1212, weighted_loss: 0.1103, label: 2, bag_size: 5924
batch 99, loss: 0.0204, instance_loss: 0.1088, weighted_loss: 0.0469, label: 2, bag_size: 6026
batch 119, loss: 0.1007, instance_loss: 0.6335, weighted_loss: 0.2605, label: 0, bag_size: 1944
batch 139, loss: 0.0000, instance_loss: 0.3066, weighted_loss: 0.0920, label: 1, bag_size: 5229
batch 159, loss: 0.0583, instance_loss: 0.3534, weighted_loss: 0.1468, label: 1, bag_size: 2092
batch 179, loss: 0.0441, instance_loss: 0.4077, weighted_loss: 0.1532, label: 1, bag_size: 2122
batch 199, loss: 1.1562, instance_loss: 0.6001, weighted_loss: 0.9894, label: 2, bag_size: 2049
batch 219, loss: 0.0751, instance_loss: 0.3319, weighted_loss: 0.1521, label: 0, bag_size: 622
batch 239, loss: 0.0235, instance_loss: 0.0823, weighted_loss: 0.0411, label: 0, bag_size: 3103
batch 259, loss: 0.5840, instance_loss: 0.5561, weighted_loss: 0.5756, label: 2, bag_size: 3274
batch 279, loss: 0.0800, instance_loss: 0.2435, weighted_loss: 0.1290, label: 2, bag_size: 3397
batch 299, loss: 0.0656, instance_loss: 0.1812, weighted_loss: 0.1002, label: 1, bag_size: 712
batch 319, loss: 0.0169, instance_loss: 0.0829, weighted_loss: 0.0367, label: 2, bag_size: 3497
batch 339, loss: 0.0114, instance_loss: 0.3563, weighted_loss: 0.1148, label: 0, bag_size: 386
batch 359, loss: 0.0271, instance_loss: 0.0737, weighted_loss: 0.0411, label: 2, bag_size: 3397
batch 379, loss: 0.0706, instance_loss: 0.3858, weighted_loss: 0.1652, label: 0, bag_size: 5015
batch 399, loss: 0.0000, instance_loss: 0.2106, weighted_loss: 0.0632, label: 2, bag_size: 3607
batch 419, loss: 0.0941, instance_loss: 0.3503, weighted_loss: 0.1710, label: 2, bag_size: 3026
batch 439, loss: 0.0047, instance_loss: 0.2697, weighted_loss: 0.0842, label: 0, bag_size: 4161
batch 459, loss: 0.1692, instance_loss: 0.1876, weighted_loss: 0.1747, label: 0, bag_size: 3816
batch 479, loss: 0.0241, instance_loss: 0.1914, weighted_loss: 0.0743, label: 1, bag_size: 3127
batch 499, loss: 0.0530, instance_loss: 0.1667, weighted_loss: 0.0871, label: 1, bag_size: 3009
batch 519, loss: 0.0320, instance_loss: 0.1679, weighted_loss: 0.0728, label: 2, bag_size: 4555
batch 539, loss: 0.0000, instance_loss: 0.0848, weighted_loss: 0.0255, label: 1, bag_size: 5086
batch 559, loss: 0.0223, instance_loss: 0.1916, weighted_loss: 0.0731, label: 1, bag_size: 3337
batch 579, loss: 0.0048, instance_loss: 0.0705, weighted_loss: 0.0245, label: 0, bag_size: 4760
batch 599, loss: 0.3901, instance_loss: 0.6936, weighted_loss: 0.4811, label: 2, bag_size: 3274
batch 619, loss: 0.2157, instance_loss: 0.6564, weighted_loss: 0.3479, label: 2, bag_size: 2486
batch 639, loss: 0.0026, instance_loss: 0.2600, weighted_loss: 0.0798, label: 1, bag_size: 8802
batch 659, loss: 0.2441, instance_loss: 0.2354, weighted_loss: 0.2415, label: 1, bag_size: 210
batch 679, loss: 1.0491, instance_loss: 0.8579, weighted_loss: 0.9917, label: 2, bag_size: 361
batch 699, loss: 0.0694, instance_loss: 0.2870, weighted_loss: 0.1347, label: 2, bag_size: 4691
batch 719, loss: 0.0057, instance_loss: 0.2785, weighted_loss: 0.0875, label: 2, bag_size: 2770
batch 739, loss: 0.0071, instance_loss: 0.1674, weighted_loss: 0.0552, label: 1, bag_size: 4898


class 0 clustering acc 0.9653803131991051: correct 17261/17880
class 1 clustering acc 0.4969798657718121: correct 2962/5960
Epoch: 95, train_loss: 0.3320, train_clustering_loss:  0.4760, train_error: 0.1235
class 0: acc 0.8735632183908046, correct 228/261
class 1: acc 0.8313253012048193, correct 207/249
class 2: acc 0.9276595744680851, correct 218/235

Val Set, val_loss: 0.5887, val_error: 0.2340, auc: 0.9186
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.4933510638297872: correct 371/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.9705, instance_loss: 1.0443, weighted_loss: 1.6927, label: 0, bag_size: 22822
batch 39, loss: 0.0237, instance_loss: 0.3160, weighted_loss: 0.1113, label: 2, bag_size: 6148
batch 59, loss: 0.4780, instance_loss: 0.8061, weighted_loss: 0.5764, label: 1, bag_size: 1313
batch 79, loss: 0.8397, instance_loss: 1.4633, weighted_loss: 1.0268, label: 0, bag_size: 3419
batch 99, loss: 0.2843, instance_loss: 0.5645, weighted_loss: 0.3684, label: 1, bag_size: 3508
batch 119, loss: 0.0187, instance_loss: 0.2059, weighted_loss: 0.0749, label: 1, bag_size: 425
batch 139, loss: 0.0338, instance_loss: 0.3772, weighted_loss: 0.1368, label: 0, bag_size: 4719
batch 159, loss: 0.0411, instance_loss: 0.1423, weighted_loss: 0.0715, label: 0, bag_size: 5340
batch 179, loss: 0.5382, instance_loss: 0.7715, weighted_loss: 0.6082, label: 1, bag_size: 3391
batch 199, loss: 2.0783, instance_loss: 1.3379, weighted_loss: 1.8562, label: 0, bag_size: 1886
batch 219, loss: 0.0255, instance_loss: 0.2425, weighted_loss: 0.0906, label: 1, bag_size: 1029
batch 239, loss: 1.2091, instance_loss: 1.2630, weighted_loss: 1.2253, label: 0, bag_size: 4018
batch 259, loss: 0.0228, instance_loss: 0.1416, weighted_loss: 0.0585, label: 2, bag_size: 4203
batch 279, loss: 0.1098, instance_loss: 0.6107, weighted_loss: 0.2600, label: 2, bag_size: 4978
batch 299, loss: 0.0064, instance_loss: 0.1031, weighted_loss: 0.0354, label: 0, bag_size: 2290
batch 319, loss: 0.0128, instance_loss: 0.2498, weighted_loss: 0.0839, label: 0, bag_size: 2428
batch 339, loss: 0.0000, instance_loss: 0.4225, weighted_loss: 0.1267, label: 0, bag_size: 3594
batch 359, loss: 0.1469, instance_loss: 0.4338, weighted_loss: 0.2330, label: 1, bag_size: 2342
batch 379, loss: 0.0019, instance_loss: 0.0456, weighted_loss: 0.0150, label: 2, bag_size: 4856
batch 399, loss: 0.0036, instance_loss: 0.0797, weighted_loss: 0.0264, label: 0, bag_size: 1097
batch 419, loss: 0.0028, instance_loss: 0.0495, weighted_loss: 0.0168, label: 2, bag_size: 4856
batch 439, loss: 1.6514, instance_loss: 1.0392, weighted_loss: 1.4677, label: 0, bag_size: 3402
batch 459, loss: 2.4145, instance_loss: 1.0787, weighted_loss: 2.0138, label: 0, bag_size: 2896
batch 479, loss: 0.1455, instance_loss: 0.6225, weighted_loss: 0.2886, label: 0, bag_size: 4725
batch 499, loss: 0.0104, instance_loss: 0.5699, weighted_loss: 0.1782, label: 0, bag_size: 3743
batch 519, loss: 0.0193, instance_loss: 0.0562, weighted_loss: 0.0304, label: 2, bag_size: 3678
batch 539, loss: 0.0001, instance_loss: 0.6597, weighted_loss: 0.1979, label: 0, bag_size: 1140
batch 559, loss: 0.4539, instance_loss: 0.3749, weighted_loss: 0.4302, label: 0, bag_size: 4648
batch 579, loss: 0.0041, instance_loss: 0.0990, weighted_loss: 0.0325, label: 1, bag_size: 3172
batch 599, loss: 0.0017, instance_loss: 0.7632, weighted_loss: 0.2302, label: 0, bag_size: 1140
batch 619, loss: 0.1185, instance_loss: 0.5397, weighted_loss: 0.2448, label: 2, bag_size: 5307
batch 639, loss: 1.1624, instance_loss: 0.6076, weighted_loss: 0.9960, label: 2, bag_size: 3274
batch 659, loss: 0.0990, instance_loss: 0.2416, weighted_loss: 0.1418, label: 2, bag_size: 4691
batch 679, loss: 0.0082, instance_loss: 0.2173, weighted_loss: 0.0710, label: 0, bag_size: 4300
batch 699, loss: 0.3277, instance_loss: 0.6973, weighted_loss: 0.4386, label: 2, bag_size: 1513
batch 719, loss: 0.0246, instance_loss: 0.4257, weighted_loss: 0.1449, label: 2, bag_size: 4342
batch 739, loss: 0.0200, instance_loss: 0.1002, weighted_loss: 0.0441, label: 2, bag_size: 4192


class 0 clustering acc 0.9656040268456376: correct 17265/17880
class 1 clustering acc 0.49026845637583893: correct 2922/5960
Epoch: 96, train_loss: 0.3763, train_clustering_loss:  0.4763, train_error: 0.1490
class 0: acc 0.8326359832635983, correct 199/239
class 1: acc 0.7868852459016393, correct 192/244
class 2: acc 0.9274809160305344, correct 243/262

Val Set, val_loss: 0.8046, val_error: 0.2979, auc: 0.9048
class 0 clustering acc 0.9552304964539007: correct 2155/2256
class 1 clustering acc 0.43882978723404253: correct 330/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0682, instance_loss: 0.2112, weighted_loss: 0.1111, label: 1, bag_size: 1029
batch 39, loss: 0.0054, instance_loss: 0.0757, weighted_loss: 0.0265, label: 2, bag_size: 2209
batch 59, loss: 0.1121, instance_loss: 0.5208, weighted_loss: 0.2347, label: 0, bag_size: 313
batch 79, loss: 0.0293, instance_loss: 0.1501, weighted_loss: 0.0656, label: 2, bag_size: 1094
batch 99, loss: 3.2781, instance_loss: 1.7101, weighted_loss: 2.8077, label: 0, bag_size: 5259
batch 119, loss: 0.0132, instance_loss: 0.5235, weighted_loss: 0.1663, label: 0, bag_size: 3033
batch 139, loss: 1.4442, instance_loss: 0.4499, weighted_loss: 1.1459, label: 2, bag_size: 3112
batch 159, loss: 0.0139, instance_loss: 0.6363, weighted_loss: 0.2007, label: 0, bag_size: 966
batch 179, loss: 0.5058, instance_loss: 1.0868, weighted_loss: 0.6801, label: 0, bag_size: 3841
batch 199, loss: 0.1087, instance_loss: 0.3715, weighted_loss: 0.1876, label: 0, bag_size: 3191
batch 219, loss: 0.8130, instance_loss: 0.8256, weighted_loss: 0.8168, label: 1, bag_size: 4258
batch 239, loss: 0.1136, instance_loss: 0.3603, weighted_loss: 0.1876, label: 0, bag_size: 6430
batch 259, loss: 0.2400, instance_loss: 0.4708, weighted_loss: 0.3092, label: 0, bag_size: 3885
batch 279, loss: 0.0125, instance_loss: 0.0609, weighted_loss: 0.0270, label: 0, bag_size: 3406
batch 299, loss: 0.0183, instance_loss: 0.1251, weighted_loss: 0.0503, label: 2, bag_size: 3121
batch 319, loss: 0.0013, instance_loss: 0.2104, weighted_loss: 0.0641, label: 0, bag_size: 3245
batch 339, loss: 0.0538, instance_loss: 0.1420, weighted_loss: 0.0802, label: 2, bag_size: 3415
batch 359, loss: 0.2765, instance_loss: 0.3207, weighted_loss: 0.2898, label: 0, bag_size: 4398
batch 379, loss: 0.1067, instance_loss: 0.7515, weighted_loss: 0.3001, label: 1, bag_size: 32
batch 399, loss: 1.2739, instance_loss: 1.1071, weighted_loss: 1.2239, label: 1, bag_size: 1558
batch 419, loss: 0.0808, instance_loss: 0.6721, weighted_loss: 0.2582, label: 2, bag_size: 4342
batch 439, loss: 0.0188, instance_loss: 0.1964, weighted_loss: 0.0721, label: 0, bag_size: 873
batch 459, loss: 0.7964, instance_loss: 0.5520, weighted_loss: 0.7231, label: 0, bag_size: 3664
batch 479, loss: 0.4400, instance_loss: 0.7392, weighted_loss: 0.5298, label: 1, bag_size: 3619
batch 499, loss: 0.3199, instance_loss: 0.7563, weighted_loss: 0.4508, label: 1, bag_size: 869
batch 519, loss: 0.3899, instance_loss: 0.7480, weighted_loss: 0.4973, label: 1, bag_size: 2671
batch 539, loss: 0.0026, instance_loss: 0.2007, weighted_loss: 0.0620, label: 1, bag_size: 4578
batch 559, loss: 0.5890, instance_loss: 0.4453, weighted_loss: 0.5459, label: 2, bag_size: 597
batch 579, loss: 0.4621, instance_loss: 0.5481, weighted_loss: 0.4879, label: 0, bag_size: 4325
batch 599, loss: 0.0675, instance_loss: 0.1821, weighted_loss: 0.1019, label: 1, bag_size: 3007
batch 619, loss: 0.0055, instance_loss: 0.0693, weighted_loss: 0.0246, label: 2, bag_size: 4745
batch 639, loss: 0.0183, instance_loss: 0.2958, weighted_loss: 0.1015, label: 1, bag_size: 5003
batch 659, loss: 1.6099, instance_loss: 0.9837, weighted_loss: 1.4220, label: 0, bag_size: 3155
batch 679, loss: 0.0112, instance_loss: 0.4747, weighted_loss: 0.1503, label: 0, bag_size: 5585
batch 699, loss: 0.0091, instance_loss: 0.0994, weighted_loss: 0.0362, label: 2, bag_size: 3497
batch 719, loss: 0.0165, instance_loss: 0.1132, weighted_loss: 0.0455, label: 0, bag_size: 4326
batch 739, loss: 0.4083, instance_loss: 0.9874, weighted_loss: 0.5820, label: 1, bag_size: 6942


class 0 clustering acc 0.964821029082774: correct 17251/17880
class 1 clustering acc 0.4778523489932886: correct 2848/5960
Epoch: 97, train_loss: 0.3583, train_clustering_loss:  0.4871, train_error: 0.1275
class 0: acc 0.8458333333333333, correct 203/240
class 1: acc 0.8365019011406845, correct 220/263
class 2: acc 0.9380165289256198, correct 227/242

Val Set, val_loss: 0.8668, val_error: 0.3085, auc: 0.9132
class 0 clustering acc 0.9587765957446809: correct 2163/2256
class 1 clustering acc 0.42819148936170215: correct 322/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0364, instance_loss: 0.1704, weighted_loss: 0.0766, label: 2, bag_size: 6026
batch 39, loss: 0.0787, instance_loss: 0.1758, weighted_loss: 0.1079, label: 2, bag_size: 3415
batch 59, loss: 0.4737, instance_loss: 0.7676, weighted_loss: 0.5619, label: 2, bag_size: 3299
batch 79, loss: 0.0859, instance_loss: 0.8328, weighted_loss: 0.3100, label: 1, bag_size: 1510
batch 99, loss: 0.0210, instance_loss: 0.4316, weighted_loss: 0.1442, label: 2, bag_size: 4571
batch 119, loss: 0.0268, instance_loss: 0.0575, weighted_loss: 0.0360, label: 1, bag_size: 3398
batch 139, loss: 0.5058, instance_loss: 0.5205, weighted_loss: 0.5102, label: 2, bag_size: 1513
batch 159, loss: 0.0156, instance_loss: 0.1168, weighted_loss: 0.0460, label: 2, bag_size: 1094
batch 179, loss: 0.0000, instance_loss: 0.1464, weighted_loss: 0.0439, label: 0, bag_size: 3445
batch 199, loss: 0.0114, instance_loss: 0.5158, weighted_loss: 0.1627, label: 1, bag_size: 2472
batch 219, loss: 0.0072, instance_loss: 0.3095, weighted_loss: 0.0979, label: 2, bag_size: 3094
batch 239, loss: 0.3220, instance_loss: 0.2719, weighted_loss: 0.3069, label: 2, bag_size: 2031
batch 259, loss: 0.3749, instance_loss: 0.3999, weighted_loss: 0.3824, label: 2, bag_size: 3274
batch 279, loss: 0.0831, instance_loss: 0.5576, weighted_loss: 0.2255, label: 2, bag_size: 4342
batch 299, loss: 0.2251, instance_loss: 0.4905, weighted_loss: 0.3047, label: 0, bag_size: 1611
batch 319, loss: 0.0140, instance_loss: 0.8070, weighted_loss: 0.2519, label: 0, bag_size: 3033
batch 339, loss: 0.0194, instance_loss: 0.0470, weighted_loss: 0.0277, label: 0, bag_size: 9897
batch 359, loss: 0.0172, instance_loss: 0.1567, weighted_loss: 0.0590, label: 2, bag_size: 3778
batch 379, loss: 0.0198, instance_loss: 1.0647, weighted_loss: 0.3333, label: 0, bag_size: 1904
batch 399, loss: 0.0115, instance_loss: 0.0816, weighted_loss: 0.0325, label: 2, bag_size: 4192
batch 419, loss: 0.0410, instance_loss: 0.2689, weighted_loss: 0.1094, label: 0, bag_size: 4070
batch 439, loss: 0.1096, instance_loss: 0.4016, weighted_loss: 0.1972, label: 1, bag_size: 2302
batch 459, loss: 0.0548, instance_loss: 0.1299, weighted_loss: 0.0773, label: 2, bag_size: 614
batch 479, loss: 0.0828, instance_loss: 0.4854, weighted_loss: 0.2036, label: 0, bag_size: 1204
batch 499, loss: 0.0953, instance_loss: 0.1666, weighted_loss: 0.1167, label: 2, bag_size: 4203
batch 519, loss: 0.0030, instance_loss: 0.5067, weighted_loss: 0.1541, label: 1, bag_size: 3986
batch 539, loss: 0.3497, instance_loss: 0.4436, weighted_loss: 0.3778, label: 1, bag_size: 3391
batch 559, loss: 0.1458, instance_loss: 0.6255, weighted_loss: 0.2897, label: 1, bag_size: 1712
batch 579, loss: 0.0499, instance_loss: 0.2034, weighted_loss: 0.0959, label: 2, bag_size: 6704
batch 599, loss: 0.0589, instance_loss: 0.1899, weighted_loss: 0.0982, label: 2, bag_size: 2049
batch 619, loss: 0.0777, instance_loss: 0.2046, weighted_loss: 0.1158, label: 2, bag_size: 2501
batch 639, loss: 0.0423, instance_loss: 0.2188, weighted_loss: 0.0953, label: 1, bag_size: 3398
batch 659, loss: 0.5999, instance_loss: 0.9193, weighted_loss: 0.6958, label: 2, bag_size: 223
batch 679, loss: 0.3936, instance_loss: 0.9188, weighted_loss: 0.5512, label: 1, bag_size: 3016
batch 699, loss: 0.1644, instance_loss: 0.3771, weighted_loss: 0.2282, label: 1, bag_size: 5728
batch 719, loss: 0.0074, instance_loss: 0.0825, weighted_loss: 0.0299, label: 0, bag_size: 5459
batch 739, loss: 0.0372, instance_loss: 0.2219, weighted_loss: 0.0926, label: 0, bag_size: 4157


class 0 clustering acc 0.9690156599552573: correct 17326/17880
class 1 clustering acc 0.5243288590604027: correct 3125/5960
Epoch: 98, train_loss: 0.2911, train_clustering_loss:  0.4432, train_error: 0.1007
class 0: acc 0.9067796610169492, correct 214/236
class 1: acc 0.844106463878327, correct 222/263
class 2: acc 0.9512195121951219, correct 234/246

Val Set, val_loss: 0.6262, val_error: 0.2234, auc: 0.9317
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.4574468085106383: correct 344/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0276, instance_loss: 0.1837, weighted_loss: 0.0745, label: 2, bag_size: 2359
batch 39, loss: 0.1444, instance_loss: 0.5239, weighted_loss: 0.2582, label: 0, bag_size: 16741
batch 59, loss: 0.0074, instance_loss: 0.4146, weighted_loss: 0.1295, label: 1, bag_size: 6717
batch 79, loss: 0.0234, instance_loss: 0.2327, weighted_loss: 0.0862, label: 0, bag_size: 2841
batch 99, loss: 0.1733, instance_loss: 0.4650, weighted_loss: 0.2608, label: 1, bag_size: 1161
batch 119, loss: 0.0081, instance_loss: 0.0800, weighted_loss: 0.0297, label: 0, bag_size: 3816
batch 139, loss: 1.0780, instance_loss: 1.3005, weighted_loss: 1.1447, label: 2, bag_size: 3475
batch 159, loss: 0.0516, instance_loss: 0.2157, weighted_loss: 0.1008, label: 2, bag_size: 4141
batch 179, loss: 3.1805, instance_loss: 1.8576, weighted_loss: 2.7836, label: 0, bag_size: 1753
batch 199, loss: 0.0207, instance_loss: 0.1219, weighted_loss: 0.0511, label: 2, bag_size: 4788
batch 219, loss: 0.5671, instance_loss: 0.4239, weighted_loss: 0.5242, label: 1, bag_size: 368
batch 239, loss: 0.7563, instance_loss: 0.6543, weighted_loss: 0.7257, label: 2, bag_size: 4342
batch 259, loss: 0.0891, instance_loss: 0.1226, weighted_loss: 0.0991, label: 0, bag_size: 3304
batch 279, loss: 0.0656, instance_loss: 0.3810, weighted_loss: 0.1602, label: 2, bag_size: 4571
batch 299, loss: 0.0141, instance_loss: 0.3883, weighted_loss: 0.1264, label: 1, bag_size: 582
batch 319, loss: 0.4501, instance_loss: 1.0098, weighted_loss: 0.6180, label: 1, bag_size: 3640
batch 339, loss: 0.0112, instance_loss: 0.0398, weighted_loss: 0.0198, label: 0, bag_size: 3406
batch 359, loss: 0.0197, instance_loss: 0.0947, weighted_loss: 0.0422, label: 2, bag_size: 657
batch 379, loss: 0.0133, instance_loss: 0.1042, weighted_loss: 0.0406, label: 2, bag_size: 4302
batch 399, loss: 0.0371, instance_loss: 0.1347, weighted_loss: 0.0664, label: 2, bag_size: 4302
batch 419, loss: 0.0104, instance_loss: 0.1754, weighted_loss: 0.0599, label: 1, bag_size: 2254
batch 439, loss: 0.1485, instance_loss: 0.4634, weighted_loss: 0.2429, label: 0, bag_size: 5871
batch 459, loss: 0.3346, instance_loss: 0.5535, weighted_loss: 0.4003, label: 1, bag_size: 5926
batch 479, loss: 0.3366, instance_loss: 0.4973, weighted_loss: 0.3848, label: 1, bag_size: 209
batch 499, loss: 0.0335, instance_loss: 0.1661, weighted_loss: 0.0733, label: 0, bag_size: 3690
batch 519, loss: 0.0211, instance_loss: 0.1859, weighted_loss: 0.0706, label: 2, bag_size: 2209
batch 539, loss: 0.0002, instance_loss: 0.6806, weighted_loss: 0.2043, label: 1, bag_size: 3156
batch 559, loss: 0.0000, instance_loss: 0.0873, weighted_loss: 0.0262, label: 0, bag_size: 1106
batch 579, loss: 0.0026, instance_loss: 0.2476, weighted_loss: 0.0761, label: 1, bag_size: 3265
batch 599, loss: 0.4917, instance_loss: 0.5075, weighted_loss: 0.4964, label: 0, bag_size: 1647
batch 619, loss: 0.0781, instance_loss: 0.4285, weighted_loss: 0.1832, label: 2, bag_size: 4978
batch 639, loss: 0.1878, instance_loss: 0.3434, weighted_loss: 0.2345, label: 0, bag_size: 6252
batch 659, loss: 0.0674, instance_loss: 0.2995, weighted_loss: 0.1370, label: 0, bag_size: 2286
batch 679, loss: 0.0401, instance_loss: 0.3761, weighted_loss: 0.1409, label: 1, bag_size: 14449
batch 699, loss: 0.2541, instance_loss: 0.6465, weighted_loss: 0.3718, label: 1, bag_size: 6025
batch 719, loss: 0.0008, instance_loss: 0.3092, weighted_loss: 0.0933, label: 1, bag_size: 3611
batch 739, loss: 2.7419, instance_loss: 1.3638, weighted_loss: 2.3285, label: 1, bag_size: 1313


class 0 clustering acc 0.9659395973154362: correct 17271/17880
class 1 clustering acc 0.5140939597315436: correct 3064/5960
Epoch: 99, train_loss: 0.3368, train_clustering_loss:  0.4639, train_error: 0.1289
class 0: acc 0.8609022556390977, correct 229/266
class 1: acc 0.8415094339622642, correct 223/265
class 2: acc 0.9205607476635514, correct 197/214

Val Set, val_loss: 0.5465, val_error: 0.2021, auc: 0.9234
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.48404255319148937: correct 364/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0747, instance_loss: 0.4280, weighted_loss: 0.1807, label: 2, bag_size: 7607
batch 39, loss: 0.8348, instance_loss: 0.4155, weighted_loss: 0.7090, label: 1, bag_size: 3109
batch 59, loss: 0.0285, instance_loss: 0.1680, weighted_loss: 0.0704, label: 1, bag_size: 3109
batch 79, loss: 0.0054, instance_loss: 0.1124, weighted_loss: 0.0375, label: 0, bag_size: 3901
batch 99, loss: 0.0003, instance_loss: 0.6615, weighted_loss: 0.1987, label: 0, bag_size: 3182
batch 119, loss: 0.0176, instance_loss: 0.2327, weighted_loss: 0.0821, label: 2, bag_size: 6026
batch 139, loss: 0.6845, instance_loss: 0.5799, weighted_loss: 0.6531, label: 0, bag_size: 4997
batch 159, loss: 0.2495, instance_loss: 0.3159, weighted_loss: 0.2694, label: 2, bag_size: 3080
batch 179, loss: 1.0247, instance_loss: 0.8494, weighted_loss: 0.9721, label: 2, bag_size: 361
batch 199, loss: 0.0678, instance_loss: 0.3249, weighted_loss: 0.1449, label: 2, bag_size: 5406
batch 219, loss: 0.0006, instance_loss: 0.1816, weighted_loss: 0.0549, label: 1, bag_size: 6315
batch 239, loss: 0.0428, instance_loss: 0.1383, weighted_loss: 0.0714, label: 0, bag_size: 6430
batch 259, loss: 0.1495, instance_loss: 0.2691, weighted_loss: 0.1854, label: 2, bag_size: 4241
batch 279, loss: 0.0027, instance_loss: 0.0419, weighted_loss: 0.0144, label: 2, bag_size: 2254
batch 299, loss: 0.0438, instance_loss: 0.0750, weighted_loss: 0.0532, label: 0, bag_size: 4228
batch 319, loss: 0.0053, instance_loss: 0.0994, weighted_loss: 0.0335, label: 2, bag_size: 5138
batch 339, loss: 0.0151, instance_loss: 0.0801, weighted_loss: 0.0346, label: 0, bag_size: 4855
batch 359, loss: 1.7676, instance_loss: 1.2159, weighted_loss: 1.6021, label: 2, bag_size: 1050
batch 379, loss: 0.0670, instance_loss: 0.2663, weighted_loss: 0.1268, label: 0, bag_size: 2677
batch 399, loss: 0.0004, instance_loss: 0.3654, weighted_loss: 0.1099, label: 0, bag_size: 1106
batch 419, loss: 0.0020, instance_loss: 0.0313, weighted_loss: 0.0108, label: 2, bag_size: 3285
batch 439, loss: 0.9351, instance_loss: 1.0539, weighted_loss: 0.9707, label: 1, bag_size: 2481
batch 459, loss: 0.0260, instance_loss: 0.6821, weighted_loss: 0.2228, label: 2, bag_size: 22464
batch 479, loss: 0.3154, instance_loss: 0.7938, weighted_loss: 0.4589, label: 0, bag_size: 5867
batch 499, loss: 0.4520, instance_loss: 0.3615, weighted_loss: 0.4249, label: 1, bag_size: 368
batch 519, loss: 0.0145, instance_loss: 0.5391, weighted_loss: 0.1719, label: 1, bag_size: 3403
batch 539, loss: 0.0692, instance_loss: 0.7810, weighted_loss: 0.2827, label: 2, bag_size: 4910
batch 559, loss: 0.0000, instance_loss: 0.2144, weighted_loss: 0.0643, label: 0, bag_size: 1106
batch 579, loss: 0.0444, instance_loss: 0.4609, weighted_loss: 0.1693, label: 1, bag_size: 4253
batch 599, loss: 0.0054, instance_loss: 0.0665, weighted_loss: 0.0237, label: 0, bag_size: 4405
batch 619, loss: 0.1206, instance_loss: 0.3423, weighted_loss: 0.1871, label: 2, bag_size: 3546
batch 639, loss: 0.3465, instance_loss: 0.3736, weighted_loss: 0.3547, label: 0, bag_size: 4614
batch 659, loss: 0.0007, instance_loss: 0.0811, weighted_loss: 0.0248, label: 1, bag_size: 6475
batch 679, loss: 0.0017, instance_loss: 0.1795, weighted_loss: 0.0550, label: 0, bag_size: 5029
batch 699, loss: 0.0090, instance_loss: 0.0734, weighted_loss: 0.0283, label: 0, bag_size: 2767
batch 719, loss: 0.0261, instance_loss: 0.5947, weighted_loss: 0.1966, label: 1, bag_size: 2229
batch 739, loss: 0.0954, instance_loss: 0.1182, weighted_loss: 0.1022, label: 2, bag_size: 3227


class 0 clustering acc 0.9666107382550335: correct 17283/17880
class 1 clustering acc 0.4969798657718121: correct 2962/5960
Epoch: 100, train_loss: 0.2951, train_clustering_loss:  0.4656, train_error: 0.1074
class 0: acc 0.90625, correct 232/256
class 1: acc 0.8416988416988417, correct 218/259
class 2: acc 0.9347826086956522, correct 215/230

Val Set, val_loss: 0.5652, val_error: 0.1809, auc: 0.9344
class 0 clustering acc 0.9663120567375887: correct 2180/2256
class 1 clustering acc 0.5053191489361702: correct 380/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0186, instance_loss: 0.1369, weighted_loss: 0.0541, label: 0, bag_size: 1762
batch 39, loss: 0.0334, instance_loss: 0.5403, weighted_loss: 0.1855, label: 1, bag_size: 2122
batch 59, loss: 0.0228, instance_loss: 0.2645, weighted_loss: 0.0953, label: 0, bag_size: 3885
batch 79, loss: 0.0107, instance_loss: 0.0563, weighted_loss: 0.0244, label: 0, bag_size: 4570
batch 99, loss: 0.0000, instance_loss: 0.1735, weighted_loss: 0.0521, label: 1, bag_size: 3156
batch 119, loss: 0.5188, instance_loss: 0.8252, weighted_loss: 0.6108, label: 1, bag_size: 5118
batch 139, loss: 0.1305, instance_loss: 0.5714, weighted_loss: 0.2628, label: 1, bag_size: 1161
batch 159, loss: 0.0000, instance_loss: 0.0580, weighted_loss: 0.0174, label: 1, bag_size: 3172
batch 179, loss: 0.0393, instance_loss: 0.0993, weighted_loss: 0.0573, label: 2, bag_size: 3678
batch 199, loss: 0.3333, instance_loss: 0.3433, weighted_loss: 0.3363, label: 1, bag_size: 4184
batch 219, loss: 0.1174, instance_loss: 0.1777, weighted_loss: 0.1355, label: 2, bag_size: 6644
batch 239, loss: 0.2276, instance_loss: 0.6948, weighted_loss: 0.3677, label: 0, bag_size: 4450
batch 259, loss: 0.1636, instance_loss: 0.5633, weighted_loss: 0.2835, label: 0, bag_size: 4416
batch 279, loss: 0.2796, instance_loss: 0.6803, weighted_loss: 0.3998, label: 0, bag_size: 4245
batch 299, loss: 0.0337, instance_loss: 0.4016, weighted_loss: 0.1441, label: 1, bag_size: 3991
batch 319, loss: 0.0002, instance_loss: 0.0593, weighted_loss: 0.0179, label: 1, bag_size: 6315
batch 339, loss: 0.0074, instance_loss: 0.4370, weighted_loss: 0.1363, label: 1, bag_size: 5718
batch 359, loss: 0.0709, instance_loss: 0.5655, weighted_loss: 0.2193, label: 2, bag_size: 4179
batch 379, loss: 0.0429, instance_loss: 0.1617, weighted_loss: 0.0785, label: 2, bag_size: 5037
batch 399, loss: 0.0396, instance_loss: 0.3021, weighted_loss: 0.1183, label: 2, bag_size: 2209
batch 419, loss: 0.3115, instance_loss: 0.8023, weighted_loss: 0.4587, label: 0, bag_size: 4485
batch 439, loss: 0.0344, instance_loss: 0.1421, weighted_loss: 0.0667, label: 2, bag_size: 1103
batch 459, loss: 0.0107, instance_loss: 0.3784, weighted_loss: 0.1210, label: 0, bag_size: 6285
batch 479, loss: 0.0010, instance_loss: 0.0985, weighted_loss: 0.0303, label: 1, bag_size: 3460
batch 499, loss: 0.6502, instance_loss: 0.8191, weighted_loss: 0.7009, label: 0, bag_size: 3268
batch 519, loss: 0.0064, instance_loss: 0.4757, weighted_loss: 0.1472, label: 1, bag_size: 3051
batch 539, loss: 0.1070, instance_loss: 0.1513, weighted_loss: 0.1203, label: 1, bag_size: 758
batch 559, loss: 0.4036, instance_loss: 0.3053, weighted_loss: 0.3741, label: 0, bag_size: 5992
batch 579, loss: 0.4766, instance_loss: 0.6319, weighted_loss: 0.5232, label: 1, bag_size: 2055
batch 599, loss: 0.0121, instance_loss: 0.1199, weighted_loss: 0.0444, label: 2, bag_size: 5037
batch 619, loss: 0.0065, instance_loss: 0.4997, weighted_loss: 0.1545, label: 0, bag_size: 3370
batch 639, loss: 0.0000, instance_loss: 0.7472, weighted_loss: 0.2242, label: 0, bag_size: 3709
batch 659, loss: 0.8712, instance_loss: 0.9281, weighted_loss: 0.8883, label: 0, bag_size: 11141
batch 679, loss: 0.0017, instance_loss: 0.1931, weighted_loss: 0.0591, label: 1, bag_size: 3126
batch 699, loss: 0.0494, instance_loss: 0.9004, weighted_loss: 0.3047, label: 2, bag_size: 5017
batch 719, loss: 0.2032, instance_loss: 0.3818, weighted_loss: 0.2568, label: 2, bag_size: 4302
batch 739, loss: 0.0580, instance_loss: 0.2815, weighted_loss: 0.1250, label: 2, bag_size: 3618


class 0 clustering acc 0.9625279642058165: correct 17210/17880
class 1 clustering acc 0.5263422818791946: correct 3137/5960
Epoch: 101, train_loss: 0.2979, train_clustering_loss:  0.4620, train_error: 0.1114
class 0: acc 0.8701298701298701, correct 201/231
class 1: acc 0.8717948717948718, correct 238/273
class 2: acc 0.9253112033195021, correct 223/241

Val Set, val_loss: 0.6596, val_error: 0.2128, auc: 0.9245
class 0 clustering acc 0.9685283687943262: correct 2185/2256
class 1 clustering acc 0.41888297872340424: correct 315/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0434, weighted_loss: 0.0130, label: 1, bag_size: 6277
batch 39, loss: 2.2853, instance_loss: 1.1966, weighted_loss: 1.9587, label: 0, bag_size: 5017
batch 59, loss: 0.0886, instance_loss: 0.4749, weighted_loss: 0.2045, label: 0, bag_size: 2884
batch 79, loss: 0.0029, instance_loss: 0.0804, weighted_loss: 0.0262, label: 2, bag_size: 2254
batch 99, loss: 0.0597, instance_loss: 0.1754, weighted_loss: 0.0944, label: 2, bag_size: 5307
batch 119, loss: 0.1017, instance_loss: 0.0774, weighted_loss: 0.0944, label: 2, bag_size: 3583
batch 139, loss: 0.0130, instance_loss: 0.2594, weighted_loss: 0.0869, label: 1, bag_size: 4705
batch 159, loss: 0.0000, instance_loss: 0.3105, weighted_loss: 0.0932, label: 1, bag_size: 6277
batch 179, loss: 0.0111, instance_loss: 0.1512, weighted_loss: 0.0531, label: 2, bag_size: 2209
batch 199, loss: 0.0102, instance_loss: 0.3890, weighted_loss: 0.1238, label: 0, bag_size: 2428
batch 219, loss: 0.2159, instance_loss: 0.4952, weighted_loss: 0.2997, label: 2, bag_size: 6298
batch 239, loss: 1.4068, instance_loss: 1.4379, weighted_loss: 1.4161, label: 0, bag_size: 3675
batch 259, loss: 0.2075, instance_loss: 0.4402, weighted_loss: 0.2773, label: 2, bag_size: 4241
batch 279, loss: 1.0078, instance_loss: 1.0688, weighted_loss: 1.0261, label: 1, bag_size: 32
batch 299, loss: 0.2490, instance_loss: 0.5244, weighted_loss: 0.3316, label: 1, bag_size: 2671
batch 319, loss: 0.0035, instance_loss: 0.0953, weighted_loss: 0.0310, label: 0, bag_size: 5036
batch 339, loss: 0.0133, instance_loss: 0.5279, weighted_loss: 0.1677, label: 0, bag_size: 4894
batch 359, loss: 0.0959, instance_loss: 0.3433, weighted_loss: 0.1701, label: 2, bag_size: 2501
batch 379, loss: 0.0539, instance_loss: 0.2283, weighted_loss: 0.1062, label: 1, bag_size: 6689
batch 399, loss: 0.3523, instance_loss: 1.0791, weighted_loss: 0.5703, label: 1, bag_size: 6241
batch 419, loss: 0.3361, instance_loss: 0.3094, weighted_loss: 0.3281, label: 0, bag_size: 4379
batch 439, loss: 0.1040, instance_loss: 0.3417, weighted_loss: 0.1753, label: 2, bag_size: 3327
batch 459, loss: 0.0344, instance_loss: 0.2438, weighted_loss: 0.0972, label: 0, bag_size: 7330
batch 479, loss: 0.0149, instance_loss: 0.0708, weighted_loss: 0.0316, label: 2, bag_size: 2561
batch 499, loss: 0.0000, instance_loss: 0.0381, weighted_loss: 0.0114, label: 0, bag_size: 4918
batch 519, loss: 0.0301, instance_loss: 0.6435, weighted_loss: 0.2141, label: 1, bag_size: 2614
batch 539, loss: 0.0510, instance_loss: 0.5886, weighted_loss: 0.2123, label: 0, bag_size: 4922
batch 559, loss: 0.0128, instance_loss: 0.1561, weighted_loss: 0.0558, label: 2, bag_size: 4192
batch 579, loss: 0.0099, instance_loss: 0.1460, weighted_loss: 0.0507, label: 0, bag_size: 2767
batch 599, loss: 0.0730, instance_loss: 0.8384, weighted_loss: 0.3026, label: 1, bag_size: 3016
batch 619, loss: 0.0151, instance_loss: 0.2842, weighted_loss: 0.0958, label: 2, bag_size: 5037
batch 639, loss: 0.0342, instance_loss: 0.2856, weighted_loss: 0.1096, label: 2, bag_size: 5924
batch 659, loss: 0.2930, instance_loss: 1.2744, weighted_loss: 0.5874, label: 1, bag_size: 2927
batch 679, loss: 0.0170, instance_loss: 0.1666, weighted_loss: 0.0619, label: 0, bag_size: 3437
batch 699, loss: 0.8878, instance_loss: 0.8961, weighted_loss: 0.8903, label: 2, bag_size: 1050
batch 719, loss: 0.0185, instance_loss: 0.0704, weighted_loss: 0.0341, label: 2, bag_size: 3810
batch 739, loss: 0.2492, instance_loss: 0.6974, weighted_loss: 0.3836, label: 1, bag_size: 4346


class 0 clustering acc 0.9682326621923938: correct 17312/17880
class 1 clustering acc 0.5390939597315436: correct 3213/5960
Epoch: 102, train_loss: 0.3144, train_clustering_loss:  0.4505, train_error: 0.1235
class 0: acc 0.875, correct 203/232
class 1: acc 0.8228346456692913, correct 209/254
class 2: acc 0.9305019305019305, correct 241/259

Val Set, val_loss: 0.6960, val_error: 0.2234, auc: 0.9132
class 0 clustering acc 0.9419326241134752: correct 2125/2256
class 1 clustering acc 0.4122340425531915: correct 310/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0415, instance_loss: 0.1278, weighted_loss: 0.0674, label: 2, bag_size: 614
batch 39, loss: 0.0538, instance_loss: 0.0987, weighted_loss: 0.0673, label: 2, bag_size: 4223
batch 59, loss: 0.0001, instance_loss: 0.3495, weighted_loss: 0.1049, label: 1, bag_size: 4067
batch 79, loss: 0.4163, instance_loss: 0.2777, weighted_loss: 0.3747, label: 1, bag_size: 1042
batch 99, loss: 0.0029, instance_loss: 0.0567, weighted_loss: 0.0190, label: 2, bag_size: 2770
batch 119, loss: 0.6002, instance_loss: 0.2968, weighted_loss: 0.5092, label: 2, bag_size: 4241
batch 139, loss: 0.2517, instance_loss: 0.7091, weighted_loss: 0.3889, label: 0, bag_size: 421
batch 159, loss: 0.0012, instance_loss: 0.0434, weighted_loss: 0.0139, label: 2, bag_size: 6148
batch 179, loss: 1.0842, instance_loss: 0.7428, weighted_loss: 0.9818, label: 1, bag_size: 9099
batch 199, loss: 0.0420, instance_loss: 0.5182, weighted_loss: 0.1849, label: 0, bag_size: 2610
batch 219, loss: 0.0000, instance_loss: 0.4797, weighted_loss: 0.1439, label: 1, bag_size: 4684
batch 239, loss: 0.1231, instance_loss: 1.0124, weighted_loss: 0.3899, label: 0, bag_size: 577
batch 259, loss: 0.0089, instance_loss: 0.2623, weighted_loss: 0.0849, label: 0, bag_size: 5006
batch 279, loss: 0.0670, instance_loss: 0.3159, weighted_loss: 0.1417, label: 2, bag_size: 5924
batch 299, loss: 0.0655, instance_loss: 0.3194, weighted_loss: 0.1417, label: 0, bag_size: 3885
batch 319, loss: 0.1422, instance_loss: 0.3729, weighted_loss: 0.2114, label: 0, bag_size: 4220
batch 339, loss: 1.0247, instance_loss: 0.8705, weighted_loss: 0.9784, label: 0, bag_size: 877
batch 359, loss: 0.0018, instance_loss: 0.0469, weighted_loss: 0.0153, label: 0, bag_size: 6430
batch 379, loss: 0.0497, instance_loss: 0.2036, weighted_loss: 0.0959, label: 2, bag_size: 5914
batch 399, loss: 0.2038, instance_loss: 0.6270, weighted_loss: 0.3308, label: 2, bag_size: 728
batch 419, loss: 0.2162, instance_loss: 0.4887, weighted_loss: 0.2980, label: 2, bag_size: 6594
batch 439, loss: 0.1471, instance_loss: 0.4250, weighted_loss: 0.2305, label: 0, bag_size: 4921
batch 459, loss: 0.0026, instance_loss: 0.3969, weighted_loss: 0.1209, label: 0, bag_size: 1485
batch 479, loss: 0.1535, instance_loss: 0.2885, weighted_loss: 0.1940, label: 2, bag_size: 2501
batch 499, loss: 0.0004, instance_loss: 0.1006, weighted_loss: 0.0304, label: 0, bag_size: 7595
batch 519, loss: 0.6449, instance_loss: 0.4918, weighted_loss: 0.5990, label: 2, bag_size: 5472
batch 539, loss: 0.0355, instance_loss: 0.5256, weighted_loss: 0.1825, label: 0, bag_size: 7330
batch 559, loss: 0.1440, instance_loss: 0.2089, weighted_loss: 0.1635, label: 2, bag_size: 7607
batch 579, loss: 0.0973, instance_loss: 0.7165, weighted_loss: 0.2831, label: 1, bag_size: 1161
batch 599, loss: 0.6055, instance_loss: 0.6498, weighted_loss: 0.6188, label: 1, bag_size: 4705
batch 619, loss: 0.0696, instance_loss: 0.2432, weighted_loss: 0.1217, label: 2, bag_size: 3678
batch 639, loss: 1.1164, instance_loss: 0.9490, weighted_loss: 1.0662, label: 2, bag_size: 5743
batch 659, loss: 0.0305, instance_loss: 0.1755, weighted_loss: 0.0740, label: 2, bag_size: 3210
batch 679, loss: 0.1700, instance_loss: 0.2727, weighted_loss: 0.2008, label: 0, bag_size: 2428
batch 699, loss: 0.7278, instance_loss: 0.9298, weighted_loss: 0.7884, label: 0, bag_size: 2559
batch 719, loss: 0.0595, instance_loss: 0.2363, weighted_loss: 0.1125, label: 2, bag_size: 3396
batch 739, loss: 0.1368, instance_loss: 1.1170, weighted_loss: 0.4309, label: 0, bag_size: 1904


class 0 clustering acc 0.959675615212528: correct 17159/17880
class 1 clustering acc 0.5159395973154363: correct 3075/5960
Epoch: 103, train_loss: 0.3414, train_clustering_loss:  0.4674, train_error: 0.1356
class 0: acc 0.8531746031746031, correct 215/252
class 1: acc 0.7933884297520661, correct 192/242
class 2: acc 0.9442231075697212, correct 237/251

Val Set, val_loss: 0.7754, val_error: 0.3191, auc: 0.9130
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.3776595744680851: correct 284/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0903, weighted_loss: 0.0271, label: 0, bag_size: 1106
batch 39, loss: 0.0004, instance_loss: 0.3313, weighted_loss: 0.0997, label: 0, bag_size: 4403
batch 59, loss: 0.0005, instance_loss: 0.2041, weighted_loss: 0.0616, label: 1, bag_size: 3172
batch 79, loss: 0.0262, instance_loss: 0.1448, weighted_loss: 0.0618, label: 0, bag_size: 5036
batch 99, loss: 0.0289, instance_loss: 0.2105, weighted_loss: 0.0834, label: 2, bag_size: 4691
batch 119, loss: 0.6619, instance_loss: 0.5264, weighted_loss: 0.6213, label: 0, bag_size: 673
batch 139, loss: 0.2303, instance_loss: 1.2420, weighted_loss: 0.5338, label: 1, bag_size: 3016
batch 159, loss: 0.1630, instance_loss: 0.2157, weighted_loss: 0.1788, label: 2, bag_size: 1103
batch 179, loss: 0.0076, instance_loss: 0.1291, weighted_loss: 0.0440, label: 0, bag_size: 3348
batch 199, loss: 0.4490, instance_loss: 0.8151, weighted_loss: 0.5588, label: 1, bag_size: 3986
batch 219, loss: 0.0000, instance_loss: 0.0297, weighted_loss: 0.0089, label: 1, bag_size: 3338
batch 239, loss: 0.0046, instance_loss: 0.0895, weighted_loss: 0.0301, label: 2, bag_size: 2254
batch 259, loss: 0.0168, instance_loss: 0.1184, weighted_loss: 0.0473, label: 1, bag_size: 3493
batch 279, loss: 0.2588, instance_loss: 0.5423, weighted_loss: 0.3439, label: 2, bag_size: 1222
batch 299, loss: 0.0149, instance_loss: 0.1533, weighted_loss: 0.0564, label: 2, bag_size: 657
batch 319, loss: 0.1845, instance_loss: 0.3043, weighted_loss: 0.2205, label: 2, bag_size: 3210
batch 339, loss: 0.1478, instance_loss: 0.6862, weighted_loss: 0.3093, label: 1, bag_size: 2744
batch 359, loss: 0.5195, instance_loss: 1.0717, weighted_loss: 0.6852, label: 1, bag_size: 4200
batch 379, loss: 0.2199, instance_loss: 0.4421, weighted_loss: 0.2866, label: 1, bag_size: 209
batch 399, loss: 0.0318, instance_loss: 0.2702, weighted_loss: 0.1033, label: 1, bag_size: 6689
batch 419, loss: 2.6935, instance_loss: 1.3063, weighted_loss: 2.2774, label: 0, bag_size: 1886
batch 439, loss: 1.0137, instance_loss: 0.5169, weighted_loss: 0.8647, label: 2, bag_size: 4241
batch 459, loss: 0.2797, instance_loss: 0.5691, weighted_loss: 0.3666, label: 0, bag_size: 16741
batch 479, loss: 0.0701, instance_loss: 0.3563, weighted_loss: 0.1560, label: 0, bag_size: 2853
batch 499, loss: 0.4144, instance_loss: 0.5318, weighted_loss: 0.4496, label: 2, bag_size: 3274
batch 519, loss: 0.0142, instance_loss: 0.1090, weighted_loss: 0.0426, label: 0, bag_size: 2019
batch 539, loss: 0.2244, instance_loss: 0.2289, weighted_loss: 0.2258, label: 1, bag_size: 3337
batch 559, loss: 0.0841, instance_loss: 0.2814, weighted_loss: 0.1433, label: 2, bag_size: 4162
batch 579, loss: 0.0004, instance_loss: 0.4650, weighted_loss: 0.1398, label: 1, bag_size: 3437
batch 599, loss: 0.0599, instance_loss: 0.3817, weighted_loss: 0.1564, label: 1, bag_size: 4599
batch 619, loss: 0.0000, instance_loss: 0.0596, weighted_loss: 0.0179, label: 0, bag_size: 1814
batch 639, loss: 0.1152, instance_loss: 0.3650, weighted_loss: 0.1901, label: 0, bag_size: 7595
batch 659, loss: 0.0019, instance_loss: 0.3914, weighted_loss: 0.1187, label: 2, bag_size: 5037
batch 679, loss: 0.3621, instance_loss: 0.4298, weighted_loss: 0.3824, label: 0, bag_size: 4220
batch 699, loss: 0.0413, instance_loss: 0.1525, weighted_loss: 0.0747, label: 2, bag_size: 3227
batch 719, loss: 0.5379, instance_loss: 1.2031, weighted_loss: 0.7375, label: 0, bag_size: 1944
batch 739, loss: 0.0117, instance_loss: 0.1249, weighted_loss: 0.0457, label: 0, bag_size: 2756


class 0 clustering acc 0.9623601789709172: correct 17207/17880
class 1 clustering acc 0.5357382550335571: correct 3193/5960
Epoch: 104, train_loss: 0.3402, train_clustering_loss:  0.4553, train_error: 0.1289
class 0: acc 0.868995633187773, correct 199/229
class 1: acc 0.825925925925926, correct 223/270
class 2: acc 0.9227642276422764, correct 227/246

Val Set, val_loss: 0.8347, val_error: 0.2766, auc: 0.9001
class 0 clustering acc 0.9556737588652482: correct 2156/2256
class 1 clustering acc 0.425531914893617: correct 320/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.7510, instance_loss: 0.5259, weighted_loss: 1.3835, label: 0, bag_size: 1353
batch 39, loss: 0.1053, instance_loss: 0.3553, weighted_loss: 0.1803, label: 0, bag_size: 5015
batch 59, loss: 0.0321, instance_loss: 0.1617, weighted_loss: 0.0710, label: 2, bag_size: 4569
batch 79, loss: 0.6164, instance_loss: 0.5541, weighted_loss: 0.5977, label: 0, bag_size: 7219
batch 99, loss: 0.0443, instance_loss: 0.2170, weighted_loss: 0.0961, label: 1, bag_size: 2731
batch 119, loss: 0.0081, instance_loss: 0.0640, weighted_loss: 0.0249, label: 2, bag_size: 2561
batch 139, loss: 2.1310, instance_loss: 0.8667, weighted_loss: 1.7517, label: 0, bag_size: 4639
batch 159, loss: 0.0068, instance_loss: 0.0670, weighted_loss: 0.0249, label: 2, bag_size: 3121
batch 179, loss: 0.5103, instance_loss: 0.8307, weighted_loss: 0.6064, label: 2, bag_size: 552
batch 199, loss: 0.0732, instance_loss: 0.2829, weighted_loss: 0.1361, label: 0, bag_size: 4220
batch 219, loss: 0.0640, instance_loss: 0.3311, weighted_loss: 0.1441, label: 1, bag_size: 3786
batch 239, loss: 1.1500, instance_loss: 0.3124, weighted_loss: 0.8987, label: 2, bag_size: 614
batch 259, loss: 0.0165, instance_loss: 0.5948, weighted_loss: 0.1900, label: 1, bag_size: 1542
batch 279, loss: 0.2146, instance_loss: 0.8964, weighted_loss: 0.4192, label: 2, bag_size: 4342
batch 299, loss: 0.0001, instance_loss: 0.3258, weighted_loss: 0.0978, label: 1, bag_size: 3265
batch 319, loss: 0.0486, instance_loss: 0.3660, weighted_loss: 0.1438, label: 2, bag_size: 4691
batch 339, loss: 0.0192, instance_loss: 0.7231, weighted_loss: 0.2303, label: 2, bag_size: 22464
batch 359, loss: 0.0627, instance_loss: 0.5625, weighted_loss: 0.2126, label: 1, bag_size: 5728
batch 379, loss: 0.2349, instance_loss: 0.1930, weighted_loss: 0.2223, label: 2, bag_size: 3026
batch 399, loss: 0.0896, instance_loss: 0.2707, weighted_loss: 0.1440, label: 2, bag_size: 597
batch 419, loss: 0.6376, instance_loss: 0.3024, weighted_loss: 0.5370, label: 0, bag_size: 4379
batch 439, loss: 0.7192, instance_loss: 0.5018, weighted_loss: 0.6540, label: 0, bag_size: 4122
batch 459, loss: 0.0098, instance_loss: 2.3727, weighted_loss: 0.7187, label: 1, bag_size: 3322
batch 479, loss: 0.0034, instance_loss: 0.4647, weighted_loss: 0.1418, label: 1, bag_size: 4684
batch 499, loss: 0.1258, instance_loss: 0.2010, weighted_loss: 0.1484, label: 0, bag_size: 6430
batch 519, loss: 0.0032, instance_loss: 0.1657, weighted_loss: 0.0520, label: 1, bag_size: 4534
batch 539, loss: 0.4804, instance_loss: 1.1017, weighted_loss: 0.6668, label: 1, bag_size: 4200
batch 559, loss: 0.5747, instance_loss: 0.3559, weighted_loss: 0.5090, label: 1, bag_size: 3586
batch 579, loss: 0.0708, instance_loss: 0.6228, weighted_loss: 0.2364, label: 0, bag_size: 5373
batch 599, loss: 0.2268, instance_loss: 0.3820, weighted_loss: 0.2734, label: 0, bag_size: 14070
batch 619, loss: 0.4204, instance_loss: 0.4031, weighted_loss: 0.4152, label: 1, bag_size: 4684
batch 639, loss: 0.1277, instance_loss: 0.2257, weighted_loss: 0.1571, label: 1, bag_size: 6156
batch 659, loss: 0.5045, instance_loss: 0.8361, weighted_loss: 0.6040, label: 1, bag_size: 2614
batch 679, loss: 0.5783, instance_loss: 0.2578, weighted_loss: 0.4822, label: 0, bag_size: 6223
batch 699, loss: 0.0003, instance_loss: 0.2490, weighted_loss: 0.0749, label: 0, bag_size: 4403
batch 719, loss: 0.8615, instance_loss: 0.8745, weighted_loss: 0.8654, label: 1, bag_size: 3399
batch 739, loss: 0.1653, instance_loss: 0.7485, weighted_loss: 0.3403, label: 1, bag_size: 3508


class 0 clustering acc 0.95917225950783: correct 17150/17880
class 1 clustering acc 0.50251677852349: correct 2995/5960
Epoch: 105, train_loss: 0.3534, train_clustering_loss:  0.4861, train_error: 0.1275
class 0: acc 0.8940677966101694, correct 211/236
class 1: acc 0.8068181818181818, correct 213/264
class 2: acc 0.9224489795918367, correct 226/245

Val Set, val_loss: 0.7078, val_error: 0.2872, auc: 0.9087
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.375: correct 282/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.5482, instance_loss: 0.6340, weighted_loss: 0.5739, label: 1, bag_size: 1510
batch 39, loss: 0.0188, instance_loss: 0.3153, weighted_loss: 0.1078, label: 1, bag_size: 8802
batch 59, loss: 0.0527, instance_loss: 0.2268, weighted_loss: 0.1049, label: 2, bag_size: 3397
batch 79, loss: 0.8051, instance_loss: 0.4341, weighted_loss: 0.6938, label: 1, bag_size: 5532
batch 99, loss: 0.0823, instance_loss: 0.5939, weighted_loss: 0.2358, label: 1, bag_size: 3482
batch 119, loss: 0.0796, instance_loss: 0.2346, weighted_loss: 0.1261, label: 2, bag_size: 3396
batch 139, loss: 0.0201, instance_loss: 0.6521, weighted_loss: 0.2097, label: 2, bag_size: 4571
batch 159, loss: 0.2814, instance_loss: 0.9216, weighted_loss: 0.4735, label: 1, bag_size: 5833
batch 179, loss: 0.3825, instance_loss: 0.4823, weighted_loss: 0.4124, label: 2, bag_size: 3778
batch 199, loss: 0.0084, instance_loss: 0.2602, weighted_loss: 0.0839, label: 2, bag_size: 2561
batch 219, loss: 0.1656, instance_loss: 0.4983, weighted_loss: 0.2654, label: 1, bag_size: 5926
batch 239, loss: 0.4367, instance_loss: 0.9706, weighted_loss: 0.5969, label: 1, bag_size: 1122
batch 259, loss: 0.1310, instance_loss: 0.4757, weighted_loss: 0.2344, label: 2, bag_size: 5743
batch 279, loss: 0.5428, instance_loss: 0.9528, weighted_loss: 0.6658, label: 1, bag_size: 4806
batch 299, loss: 0.7412, instance_loss: 1.0967, weighted_loss: 0.8478, label: 1, bag_size: 4258
batch 319, loss: 0.7103, instance_loss: 1.1739, weighted_loss: 0.8494, label: 1, bag_size: 5011
batch 339, loss: 0.2418, instance_loss: 0.4346, weighted_loss: 0.2996, label: 2, bag_size: 4141
batch 359, loss: 0.1128, instance_loss: 0.5847, weighted_loss: 0.2543, label: 2, bag_size: 552
batch 379, loss: 0.0838, instance_loss: 0.5281, weighted_loss: 0.2171, label: 2, bag_size: 2486
batch 399, loss: 0.0098, instance_loss: 0.1553, weighted_loss: 0.0534, label: 0, bag_size: 5437
batch 419, loss: 0.0063, instance_loss: 0.1314, weighted_loss: 0.0439, label: 1, bag_size: 3534
batch 439, loss: 2.3355, instance_loss: 1.1885, weighted_loss: 1.9914, label: 1, bag_size: 3399
batch 459, loss: 0.9496, instance_loss: 0.8562, weighted_loss: 0.9216, label: 2, bag_size: 705
batch 479, loss: 0.9901, instance_loss: 1.4878, weighted_loss: 1.1394, label: 1, bag_size: 3016
batch 499, loss: 0.1097, instance_loss: 0.2712, weighted_loss: 0.1581, label: 2, bag_size: 3327
batch 519, loss: 0.0282, instance_loss: 0.1744, weighted_loss: 0.0721, label: 2, bag_size: 3094
batch 539, loss: 0.0311, instance_loss: 0.2307, weighted_loss: 0.0910, label: 0, bag_size: 4529
batch 559, loss: 0.0131, instance_loss: 0.1269, weighted_loss: 0.0472, label: 2, bag_size: 4192
batch 579, loss: 0.0071, instance_loss: 0.3970, weighted_loss: 0.1240, label: 0, bag_size: 3033
batch 599, loss: 2.5946, instance_loss: 0.8476, weighted_loss: 2.0705, label: 1, bag_size: 2865
batch 619, loss: 0.0019, instance_loss: 0.3763, weighted_loss: 0.1142, label: 1, bag_size: 314
batch 639, loss: 0.0231, instance_loss: 0.1141, weighted_loss: 0.0504, label: 2, bag_size: 4856
batch 659, loss: 0.1721, instance_loss: 0.2400, weighted_loss: 0.1925, label: 2, bag_size: 3678
batch 679, loss: 0.0791, instance_loss: 0.3362, weighted_loss: 0.1562, label: 2, bag_size: 4487
batch 699, loss: 0.0492, instance_loss: 0.1577, weighted_loss: 0.0817, label: 2, bag_size: 4555
batch 719, loss: 0.2582, instance_loss: 0.7456, weighted_loss: 0.4045, label: 1, bag_size: 4960
batch 739, loss: 0.6626, instance_loss: 0.2701, weighted_loss: 0.5448, label: 2, bag_size: 2031


class 0 clustering acc 0.9639261744966443: correct 17235/17880
class 1 clustering acc 0.5469798657718121: correct 3260/5960
Epoch: 106, train_loss: 0.3011, train_clustering_loss:  0.4481, train_error: 0.1195
class 0: acc 0.8924302788844621, correct 224/251
class 1: acc 0.8268398268398268, correct 191/231
class 2: acc 0.9163498098859315, correct 241/263

Val Set, val_loss: 0.6290, val_error: 0.2447, auc: 0.9206
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.4654255319148936: correct 350/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.2234, ROC AUC: 0.9283
Test error: 0.2340, ROC AUC: 0.9322
class 0: acc 0.9230769230769231, correct 48/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.75, correct 9/12

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.2428, instance_loss: 0.6397, weighted_loss: 0.3619, label: 1, bag_size: 209
batch 39, loss: 1.1423, instance_loss: 0.8037, weighted_loss: 1.0407, label: 0, bag_size: 1485
batch 59, loss: 0.9825, instance_loss: 0.7169, weighted_loss: 0.9028, label: 2, bag_size: 2770
batch 79, loss: 1.4019, instance_loss: 0.8151, weighted_loss: 1.2259, label: 2, bag_size: 4571
batch 99, loss: 1.7248, instance_loss: 0.7461, weighted_loss: 1.4312, label: 1, bag_size: 4599
batch 119, loss: 2.0538, instance_loss: 0.7736, weighted_loss: 1.6697, label: 0, bag_size: 4325
batch 139, loss: 1.2190, instance_loss: 0.8976, weighted_loss: 1.1226, label: 1, bag_size: 32
batch 159, loss: 1.3420, instance_loss: 0.7961, weighted_loss: 1.1782, label: 0, bag_size: 4639
batch 179, loss: 1.6691, instance_loss: 0.8915, weighted_loss: 1.4358, label: 0, bag_size: 3754
batch 199, loss: 1.0639, instance_loss: 0.8142, weighted_loss: 0.9890, label: 2, bag_size: 2770
batch 219, loss: 0.7160, instance_loss: 0.7427, weighted_loss: 0.7240, label: 2, bag_size: 3746
batch 239, loss: 1.6344, instance_loss: 0.8671, weighted_loss: 1.4042, label: 0, bag_size: 5036
batch 259, loss: 0.8039, instance_loss: 0.6033, weighted_loss: 0.7438, label: 2, bag_size: 5426
batch 279, loss: 0.3335, instance_loss: 0.5732, weighted_loss: 0.4054, label: 2, bag_size: 4372
batch 299, loss: 0.5073, instance_loss: 0.7187, weighted_loss: 0.5707, label: 0, bag_size: 3297
batch 319, loss: 0.9605, instance_loss: 0.8174, weighted_loss: 0.9176, label: 2, bag_size: 4140
batch 339, loss: 1.7433, instance_loss: 0.8970, weighted_loss: 1.4894, label: 1, bag_size: 1854
batch 359, loss: 0.0741, instance_loss: 0.4295, weighted_loss: 0.1807, label: 1, bag_size: 3043
batch 379, loss: 1.4856, instance_loss: 0.7811, weighted_loss: 1.2743, label: 0, bag_size: 4605
batch 399, loss: 0.7766, instance_loss: 0.5713, weighted_loss: 0.7150, label: 1, bag_size: 2614
batch 419, loss: 2.5960, instance_loss: 1.1393, weighted_loss: 2.1590, label: 2, bag_size: 4316
batch 439, loss: 0.3485, instance_loss: 0.7205, weighted_loss: 0.4601, label: 2, bag_size: 4569
batch 459, loss: 0.5770, instance_loss: 0.6272, weighted_loss: 0.5921, label: 2, bag_size: 3299
batch 479, loss: 0.7744, instance_loss: 0.8722, weighted_loss: 0.8037, label: 0, bag_size: 4379
batch 499, loss: 0.7755, instance_loss: 0.6366, weighted_loss: 0.7338, label: 1, bag_size: 3357
batch 519, loss: 1.1563, instance_loss: 0.7130, weighted_loss: 1.0233, label: 0, bag_size: 3841
batch 539, loss: 1.1985, instance_loss: 0.7012, weighted_loss: 1.0493, label: 0, bag_size: 4604
batch 559, loss: 0.9519, instance_loss: 0.7079, weighted_loss: 0.8787, label: 1, bag_size: 3823
batch 579, loss: 1.1352, instance_loss: 0.6332, weighted_loss: 0.9846, label: 0, bag_size: 3475
batch 599, loss: 0.4682, instance_loss: 0.5299, weighted_loss: 0.4867, label: 0, bag_size: 1174
batch 619, loss: 0.7513, instance_loss: 0.5991, weighted_loss: 0.7057, label: 0, bag_size: 3915
batch 639, loss: 1.5370, instance_loss: 0.8134, weighted_loss: 1.3199, label: 1, bag_size: 5833
batch 659, loss: 1.1187, instance_loss: 0.6588, weighted_loss: 0.9807, label: 0, bag_size: 4794
batch 679, loss: 0.5360, instance_loss: 0.6724, weighted_loss: 0.5769, label: 2, bag_size: 3227
batch 699, loss: 0.3340, instance_loss: 0.4092, weighted_loss: 0.3565, label: 2, bag_size: 88
batch 719, loss: 0.3591, instance_loss: 0.6958, weighted_loss: 0.4601, label: 1, bag_size: 5385
batch 739, loss: 0.6207, instance_loss: 0.6083, weighted_loss: 0.6170, label: 0, bag_size: 3219


class 0 clustering acc 0.9967561521252797: correct 17822/17880
class 1 clustering acc 0.006040268456375839: correct 36/5960
Epoch: 0, train_loss: 1.0010, train_clustering_loss:  0.7209, train_error: 0.5007
class 0: acc 0.44140625, correct 113/256
class 1: acc 0.46473029045643155, correct 112/241
class 2: acc 0.592741935483871, correct 147/248

Val Set, val_loss: 0.8308, val_error: 0.3298, auc: 0.8129
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (inf --> 0.830818).  Saving model ...


batch 19, loss: 0.1879, instance_loss: 0.4870, weighted_loss: 0.2776, label: 1, bag_size: 3398
batch 39, loss: 0.4382, instance_loss: 0.8759, weighted_loss: 0.5695, label: 2, bag_size: 3810
batch 59, loss: 2.8382, instance_loss: 0.6051, weighted_loss: 2.1683, label: 1, bag_size: 5880
batch 79, loss: 0.4331, instance_loss: 0.6233, weighted_loss: 0.4902, label: 0, bag_size: 1647
batch 99, loss: 0.5025, instance_loss: 0.7285, weighted_loss: 0.5703, label: 0, bag_size: 1485
batch 119, loss: 0.5095, instance_loss: 0.5288, weighted_loss: 0.5153, label: 1, bag_size: 2254
batch 139, loss: 0.2987, instance_loss: 0.4056, weighted_loss: 0.3308, label: 2, bag_size: 5017
batch 159, loss: 0.6339, instance_loss: 0.6092, weighted_loss: 0.6265, label: 0, bag_size: 4479
batch 179, loss: 0.6946, instance_loss: 0.5964, weighted_loss: 0.6652, label: 1, bag_size: 2248
batch 199, loss: 0.1976, instance_loss: 0.3195, weighted_loss: 0.2342, label: 2, bag_size: 4141
batch 219, loss: 1.0469, instance_loss: 0.6059, weighted_loss: 0.9146, label: 1, bag_size: 4869
batch 239, loss: 1.5523, instance_loss: 0.8980, weighted_loss: 1.3560, label: 2, bag_size: 1543
batch 259, loss: 0.8653, instance_loss: 0.6598, weighted_loss: 0.8037, label: 1, bag_size: 1528
batch 279, loss: 0.7062, instance_loss: 0.6264, weighted_loss: 0.6822, label: 1, bag_size: 4824
batch 299, loss: 1.3363, instance_loss: 0.7865, weighted_loss: 1.1713, label: 0, bag_size: 4157
batch 319, loss: 0.8008, instance_loss: 0.6500, weighted_loss: 0.7556, label: 0, bag_size: 3924
batch 339, loss: 1.1528, instance_loss: 0.7930, weighted_loss: 1.0449, label: 2, bag_size: 3746
batch 359, loss: 1.5289, instance_loss: 0.8460, weighted_loss: 1.3240, label: 2, bag_size: 1050
batch 379, loss: 0.4972, instance_loss: 0.5329, weighted_loss: 0.5079, label: 0, bag_size: 3319
batch 399, loss: 0.3545, instance_loss: 0.6485, weighted_loss: 0.4427, label: 2, bag_size: 5472
batch 419, loss: 0.4276, instance_loss: 0.3948, weighted_loss: 0.4178, label: 2, bag_size: 1094
batch 439, loss: 3.3273, instance_loss: 1.0635, weighted_loss: 2.6482, label: 2, bag_size: 223
batch 459, loss: 1.0491, instance_loss: 0.6135, weighted_loss: 0.9184, label: 1, bag_size: 4467
batch 479, loss: 1.1325, instance_loss: 0.7740, weighted_loss: 1.0250, label: 1, bag_size: 2229
batch 499, loss: 0.2224, instance_loss: 0.4069, weighted_loss: 0.2777, label: 2, bag_size: 2254
batch 519, loss: 0.4337, instance_loss: 0.5822, weighted_loss: 0.4782, label: 2, bag_size: 3678
batch 539, loss: 0.8909, instance_loss: 0.5620, weighted_loss: 0.7923, label: 1, bag_size: 1364
batch 559, loss: 0.9329, instance_loss: 0.7188, weighted_loss: 0.8686, label: 0, bag_size: 1904
batch 579, loss: 0.2182, instance_loss: 0.3901, weighted_loss: 0.2698, label: 0, bag_size: 5795
batch 599, loss: 0.6730, instance_loss: 0.5648, weighted_loss: 0.6405, label: 0, bag_size: 4725
batch 619, loss: 1.2991, instance_loss: 0.8574, weighted_loss: 1.1666, label: 1, bag_size: 869
batch 639, loss: 0.6856, instance_loss: 0.6602, weighted_loss: 0.6780, label: 1, bag_size: 2905
batch 659, loss: 0.0452, instance_loss: 0.4936, weighted_loss: 0.1797, label: 2, bag_size: 4141
batch 679, loss: 1.3905, instance_loss: 0.8448, weighted_loss: 1.2268, label: 0, bag_size: 1886
batch 699, loss: 1.7497, instance_loss: 1.1748, weighted_loss: 1.5772, label: 2, bag_size: 3604
batch 719, loss: 1.4380, instance_loss: 0.6671, weighted_loss: 1.2068, label: 1, bag_size: 2083
batch 739, loss: 1.1894, instance_loss: 0.6652, weighted_loss: 1.0321, label: 1, bag_size: 3644


class 0 clustering acc 0.9972035794183445: correct 17830/17880
class 1 clustering acc 0.015436241610738255: correct 92/5960
Epoch: 1, train_loss: 0.9157, train_clustering_loss:  0.6764, train_error: 0.4443
class 0: acc 0.540650406504065, correct 133/246
class 1: acc 0.5074626865671642, correct 136/268
class 2: acc 0.6277056277056277, correct 145/231

Val Set, val_loss: 1.3387, val_error: 0.6170, auc: 0.7648
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.17307692307692307, correct 9/52
class 1: acc 0.5, correct 15/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2038, instance_loss: 0.7214, weighted_loss: 0.3591, label: 2, bag_size: 2049
batch 39, loss: 1.2572, instance_loss: 0.7357, weighted_loss: 1.1007, label: 0, bag_size: 3754
batch 59, loss: 0.6517, instance_loss: 0.5422, weighted_loss: 0.6189, label: 2, bag_size: 2481
batch 79, loss: 1.0003, instance_loss: 0.6084, weighted_loss: 0.8827, label: 1, bag_size: 1510
batch 99, loss: 1.6654, instance_loss: 0.8288, weighted_loss: 1.4144, label: 2, bag_size: 5472
batch 119, loss: 0.6717, instance_loss: 0.6708, weighted_loss: 0.6715, label: 0, bag_size: 4918
batch 139, loss: 0.8852, instance_loss: 0.6367, weighted_loss: 0.8107, label: 2, bag_size: 705
batch 159, loss: 0.6517, instance_loss: 0.7258, weighted_loss: 0.6740, label: 2, bag_size: 3299
batch 179, loss: 1.2763, instance_loss: 0.7490, weighted_loss: 1.1181, label: 1, bag_size: 5693
batch 199, loss: 0.9764, instance_loss: 0.7925, weighted_loss: 0.9212, label: 2, bag_size: 5743
batch 219, loss: 0.4514, instance_loss: 0.5911, weighted_loss: 0.4933, label: 0, bag_size: 5953
batch 239, loss: 0.8105, instance_loss: 0.6478, weighted_loss: 0.7617, label: 1, bag_size: 3755
batch 259, loss: 1.1361, instance_loss: 0.5792, weighted_loss: 0.9691, label: 0, bag_size: 5831
batch 279, loss: 1.4992, instance_loss: 0.8625, weighted_loss: 1.3082, label: 1, bag_size: 2927
batch 299, loss: 1.3241, instance_loss: 0.7302, weighted_loss: 1.1459, label: 1, bag_size: 5873
batch 319, loss: 1.4346, instance_loss: 0.8082, weighted_loss: 1.2467, label: 1, bag_size: 2747
batch 339, loss: 1.6948, instance_loss: 0.7095, weighted_loss: 1.3992, label: 0, bag_size: 4245
batch 359, loss: 1.1742, instance_loss: 0.7092, weighted_loss: 1.0347, label: 1, bag_size: 3422
batch 379, loss: 0.2208, instance_loss: 0.4313, weighted_loss: 0.2840, label: 2, bag_size: 4856
batch 399, loss: 0.6239, instance_loss: 0.6064, weighted_loss: 0.6187, label: 1, bag_size: 1906
batch 419, loss: 0.5185, instance_loss: 0.5892, weighted_loss: 0.5397, label: 0, bag_size: 5519
batch 439, loss: 0.0410, instance_loss: 0.1666, weighted_loss: 0.0787, label: 2, bag_size: 5017
batch 459, loss: 0.2691, instance_loss: 0.3670, weighted_loss: 0.2985, label: 2, bag_size: 4910
batch 479, loss: 1.2525, instance_loss: 0.8235, weighted_loss: 1.1238, label: 1, bag_size: 4187
batch 499, loss: 1.4417, instance_loss: 1.0288, weighted_loss: 1.3178, label: 0, bag_size: 434
batch 519, loss: 0.5130, instance_loss: 0.6372, weighted_loss: 0.5503, label: 1, bag_size: 3983
batch 539, loss: 0.4368, instance_loss: 0.5036, weighted_loss: 0.4569, label: 1, bag_size: 2342
batch 559, loss: 0.4741, instance_loss: 0.5238, weighted_loss: 0.4890, label: 2, bag_size: 705
batch 579, loss: 0.7989, instance_loss: 0.5595, weighted_loss: 0.7271, label: 2, bag_size: 3534
batch 599, loss: 1.1132, instance_loss: 0.7846, weighted_loss: 1.0146, label: 1, bag_size: 4784
batch 619, loss: 0.6404, instance_loss: 0.5606, weighted_loss: 0.6164, label: 0, bag_size: 1233
batch 639, loss: 0.9042, instance_loss: 0.4965, weighted_loss: 0.7819, label: 0, bag_size: 2915
batch 659, loss: 2.3639, instance_loss: 1.3715, weighted_loss: 2.0662, label: 1, bag_size: 3475
batch 679, loss: 0.0673, instance_loss: 0.1678, weighted_loss: 0.0974, label: 2, bag_size: 2997
batch 699, loss: 1.0296, instance_loss: 0.9230, weighted_loss: 0.9976, label: 1, bag_size: 5756
batch 719, loss: 0.4315, instance_loss: 0.4379, weighted_loss: 0.4334, label: 2, bag_size: 4096
batch 739, loss: 0.8269, instance_loss: 0.7901, weighted_loss: 0.8159, label: 1, bag_size: 1327


class 0 clustering acc 0.9928970917225951: correct 17753/17880
class 1 clustering acc 0.056375838926174496: correct 336/5960
Epoch: 2, train_loss: 0.8456, train_clustering_loss:  0.6646, train_error: 0.3839
class 0: acc 0.5882352941176471, correct 140/238
class 1: acc 0.4851063829787234, correct 114/235
class 2: acc 0.7536764705882353, correct 205/272

Val Set, val_loss: 0.9002, val_error: 0.3830, auc: 0.8048
class 0 clustering acc 0.9951241134751773: correct 2245/2256
class 1 clustering acc 0.003989361702127659: correct 3/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9923, instance_loss: 0.6012, weighted_loss: 0.8750, label: 0, bag_size: 5373
batch 39, loss: 0.4629, instance_loss: 0.6312, weighted_loss: 0.5134, label: 1, bag_size: 5118
batch 59, loss: 0.0619, instance_loss: 0.4583, weighted_loss: 0.1808, label: 1, bag_size: 5364
batch 79, loss: 0.5177, instance_loss: 0.4229, weighted_loss: 0.4893, label: 0, bag_size: 3690
batch 99, loss: 0.6831, instance_loss: 0.6367, weighted_loss: 0.6692, label: 2, bag_size: 597
batch 119, loss: 0.2866, instance_loss: 0.4041, weighted_loss: 0.3219, label: 0, bag_size: 3741
batch 139, loss: 0.3341, instance_loss: 0.4822, weighted_loss: 0.3785, label: 0, bag_size: 4325
batch 159, loss: 0.9504, instance_loss: 0.4709, weighted_loss: 0.8066, label: 0, bag_size: 3841
batch 179, loss: 2.5654, instance_loss: 0.9186, weighted_loss: 2.0714, label: 2, bag_size: 223
batch 199, loss: 0.5908, instance_loss: 0.6471, weighted_loss: 0.6077, label: 1, bag_size: 5084
batch 219, loss: 0.2822, instance_loss: 0.5269, weighted_loss: 0.3556, label: 0, bag_size: 7056
batch 239, loss: 1.3369, instance_loss: 0.8753, weighted_loss: 1.1984, label: 1, bag_size: 3533
batch 259, loss: 0.2241, instance_loss: 0.4123, weighted_loss: 0.2806, label: 0, bag_size: 2019
batch 279, loss: 0.2695, instance_loss: 0.3290, weighted_loss: 0.2873, label: 0, bag_size: 5757
batch 299, loss: 0.3723, instance_loss: 0.4200, weighted_loss: 0.3866, label: 0, bag_size: 3901
batch 319, loss: 0.2623, instance_loss: 0.4303, weighted_loss: 0.3127, label: 2, bag_size: 1103
batch 339, loss: 0.3685, instance_loss: 0.6888, weighted_loss: 0.4646, label: 2, bag_size: 3746
batch 359, loss: 0.5651, instance_loss: 0.6751, weighted_loss: 0.5981, label: 1, bag_size: 3460
batch 379, loss: 0.5675, instance_loss: 0.7606, weighted_loss: 0.6254, label: 2, bag_size: 6644
batch 399, loss: 1.2940, instance_loss: 0.7990, weighted_loss: 1.1455, label: 1, bag_size: 6817
batch 419, loss: 0.2254, instance_loss: 0.4639, weighted_loss: 0.2970, label: 0, bag_size: 6015
batch 439, loss: 1.4589, instance_loss: 0.8428, weighted_loss: 1.2741, label: 2, bag_size: 724
batch 459, loss: 1.0893, instance_loss: 0.8656, weighted_loss: 1.0222, label: 1, bag_size: 4200
batch 479, loss: 0.6799, instance_loss: 0.5827, weighted_loss: 0.6507, label: 2, bag_size: 3534
batch 499, loss: 0.2774, instance_loss: 0.4417, weighted_loss: 0.3267, label: 0, bag_size: 5953
batch 519, loss: 1.2153, instance_loss: 0.6841, weighted_loss: 1.0559, label: 1, bag_size: 779
batch 539, loss: 0.4933, instance_loss: 0.6197, weighted_loss: 0.5312, label: 0, bag_size: 1947
batch 559, loss: 1.0060, instance_loss: 0.6301, weighted_loss: 0.8932, label: 1, bag_size: 3644
batch 579, loss: 0.6414, instance_loss: 0.6568, weighted_loss: 0.6460, label: 2, bag_size: 3396
batch 599, loss: 0.2445, instance_loss: 0.3907, weighted_loss: 0.2884, label: 0, bag_size: 1744
batch 619, loss: 0.3518, instance_loss: 0.3938, weighted_loss: 0.3644, label: 0, bag_size: 5795
batch 639, loss: 0.8617, instance_loss: 0.5422, weighted_loss: 0.7659, label: 0, bag_size: 4894
batch 659, loss: 0.9836, instance_loss: 0.5146, weighted_loss: 0.8429, label: 2, bag_size: 909
batch 679, loss: 0.8858, instance_loss: 0.4863, weighted_loss: 0.7660, label: 2, bag_size: 4691
batch 699, loss: 0.6639, instance_loss: 0.6526, weighted_loss: 0.6605, label: 0, bag_size: 3368
batch 719, loss: 0.8592, instance_loss: 0.6152, weighted_loss: 0.7860, label: 1, bag_size: 2747
batch 739, loss: 0.5292, instance_loss: 0.5493, weighted_loss: 0.5352, label: 1, bag_size: 209


class 0 clustering acc 0.9929530201342281: correct 17754/17880
class 1 clustering acc 0.061912751677852346: correct 369/5960
Epoch: 3, train_loss: 0.8439, train_clustering_loss:  0.6484, train_error: 0.3839
class 0: acc 0.6653225806451613, correct 165/248
class 1: acc 0.4959677419354839, correct 123/248
class 2: acc 0.6867469879518072, correct 171/249

Val Set, val_loss: 0.8381, val_error: 0.3723, auc: 0.8142
class 0 clustering acc 0.9964539007092199: correct 2248/2256
class 1 clustering acc 0.0013297872340425532: correct 1/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1492, instance_loss: 0.4984, weighted_loss: 0.2540, label: 0, bag_size: 873
batch 39, loss: 1.0283, instance_loss: 0.6633, weighted_loss: 0.9188, label: 1, bag_size: 4824
batch 59, loss: 0.0111, instance_loss: 0.1623, weighted_loss: 0.0564, label: 2, bag_size: 2422
batch 79, loss: 1.1258, instance_loss: 0.6684, weighted_loss: 0.9886, label: 0, bag_size: 4161
batch 99, loss: 0.4781, instance_loss: 0.3912, weighted_loss: 0.4520, label: 2, bag_size: 3534
batch 119, loss: 0.1486, instance_loss: 0.1724, weighted_loss: 0.1557, label: 2, bag_size: 2561
batch 139, loss: 0.0900, instance_loss: 0.1323, weighted_loss: 0.1027, label: 2, bag_size: 6026
batch 159, loss: 0.8098, instance_loss: 0.7492, weighted_loss: 0.7916, label: 1, bag_size: 667
batch 179, loss: 0.3361, instance_loss: 0.6524, weighted_loss: 0.4310, label: 0, bag_size: 726
batch 199, loss: 0.0450, instance_loss: 0.2257, weighted_loss: 0.0992, label: 0, bag_size: 3437
batch 219, loss: 0.5897, instance_loss: 0.8777, weighted_loss: 0.6761, label: 2, bag_size: 1222
batch 239, loss: 0.0607, instance_loss: 0.3038, weighted_loss: 0.1336, label: 2, bag_size: 2483
batch 259, loss: 0.1977, instance_loss: 0.3145, weighted_loss: 0.2327, label: 0, bag_size: 5041
batch 279, loss: 0.1778, instance_loss: 0.4447, weighted_loss: 0.2579, label: 0, bag_size: 1055
batch 299, loss: 0.4376, instance_loss: 0.4470, weighted_loss: 0.4404, label: 0, bag_size: 3532
batch 319, loss: 1.7091, instance_loss: 0.9243, weighted_loss: 1.4736, label: 1, bag_size: 1023
batch 339, loss: 0.8572, instance_loss: 0.7721, weighted_loss: 0.8317, label: 0, bag_size: 4485
batch 359, loss: 1.2406, instance_loss: 0.6943, weighted_loss: 1.0767, label: 0, bag_size: 3675
batch 379, loss: 0.8910, instance_loss: 0.7856, weighted_loss: 0.8594, label: 1, bag_size: 6243
batch 399, loss: 0.2140, instance_loss: 0.2675, weighted_loss: 0.2301, label: 2, bag_size: 2254
batch 419, loss: 0.6334, instance_loss: 0.6073, weighted_loss: 0.6256, label: 0, bag_size: 4146
batch 439, loss: 0.7425, instance_loss: 0.6269, weighted_loss: 0.7078, label: 2, bag_size: 614
batch 459, loss: 0.6546, instance_loss: 0.5578, weighted_loss: 0.6256, label: 2, bag_size: 1050
batch 479, loss: 1.1789, instance_loss: 0.7142, weighted_loss: 1.0395, label: 1, bag_size: 5718
batch 499, loss: 0.7125, instance_loss: 0.8546, weighted_loss: 0.7551, label: 1, bag_size: 14449
batch 519, loss: 1.0080, instance_loss: 0.8387, weighted_loss: 0.9572, label: 1, bag_size: 6152
batch 539, loss: 2.6283, instance_loss: 1.4286, weighted_loss: 2.2684, label: 0, bag_size: 455
batch 559, loss: 1.1069, instance_loss: 0.7763, weighted_loss: 1.0077, label: 1, bag_size: 2751
batch 579, loss: 4.2599, instance_loss: 1.1917, weighted_loss: 3.3394, label: 1, bag_size: 4290
batch 599, loss: 0.2349, instance_loss: 0.5937, weighted_loss: 0.3425, label: 1, bag_size: 5003
batch 619, loss: 0.5236, instance_loss: 0.5956, weighted_loss: 0.5452, label: 0, bag_size: 4015
batch 639, loss: 1.4812, instance_loss: 1.0522, weighted_loss: 1.3525, label: 0, bag_size: 436
batch 659, loss: 2.1558, instance_loss: 0.8036, weighted_loss: 1.7501, label: 0, bag_size: 4605
batch 679, loss: 0.5014, instance_loss: 0.6625, weighted_loss: 0.5497, label: 0, bag_size: 8088
batch 699, loss: 0.2688, instance_loss: 0.6337, weighted_loss: 0.3783, label: 1, bag_size: 5385
batch 719, loss: 0.5844, instance_loss: 0.5836, weighted_loss: 0.5842, label: 0, bag_size: 5632
batch 739, loss: 0.8522, instance_loss: 0.8851, weighted_loss: 0.8621, label: 2, bag_size: 3210


class 0 clustering acc 0.9864093959731544: correct 17637/17880
class 1 clustering acc 0.09983221476510067: correct 595/5960
Epoch: 4, train_loss: 0.8038, train_clustering_loss:  0.6414, train_error: 0.3570
class 0: acc 0.6976744186046512, correct 180/258
class 1: acc 0.4801762114537445, correct 109/227
class 2: acc 0.7307692307692307, correct 190/260

Val Set, val_loss: 0.8350, val_error: 0.3617, auc: 0.8240
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.006648936170212766: correct 5/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7646, instance_loss: 0.5935, weighted_loss: 0.7132, label: 1, bag_size: 2013
batch 39, loss: 1.0186, instance_loss: 0.6454, weighted_loss: 0.9067, label: 1, bag_size: 2481
batch 59, loss: 0.9964, instance_loss: 0.6237, weighted_loss: 0.8846, label: 2, bag_size: 5307
batch 79, loss: 0.8330, instance_loss: 0.6769, weighted_loss: 0.7862, label: 1, bag_size: 3126
batch 99, loss: 0.5216, instance_loss: 0.5720, weighted_loss: 0.5367, label: 2, bag_size: 2770
batch 119, loss: 1.4145, instance_loss: 0.7283, weighted_loss: 1.2086, label: 0, bag_size: 3402
batch 139, loss: 1.9894, instance_loss: 0.8560, weighted_loss: 1.6494, label: 1, bag_size: 3791
batch 159, loss: 0.5532, instance_loss: 0.5371, weighted_loss: 0.5484, label: 2, bag_size: 3678
batch 179, loss: 0.7896, instance_loss: 0.8011, weighted_loss: 0.7930, label: 0, bag_size: 4725
batch 199, loss: 1.6854, instance_loss: 1.3532, weighted_loss: 1.5857, label: 2, bag_size: 4910
batch 219, loss: 0.1169, instance_loss: 0.1485, weighted_loss: 0.1264, label: 2, bag_size: 4535
batch 239, loss: 1.1411, instance_loss: 0.6758, weighted_loss: 1.0015, label: 1, bag_size: 2319
batch 259, loss: 0.3296, instance_loss: 0.3995, weighted_loss: 0.3506, label: 1, bag_size: 582
batch 279, loss: 0.4633, instance_loss: 0.8165, weighted_loss: 0.5693, label: 2, bag_size: 5472
batch 299, loss: 0.6255, instance_loss: 0.5516, weighted_loss: 0.6033, label: 0, bag_size: 6971
batch 319, loss: 0.5969, instance_loss: 0.6620, weighted_loss: 0.6164, label: 0, bag_size: 2852
batch 339, loss: 0.6717, instance_loss: 0.7332, weighted_loss: 0.6901, label: 0, bag_size: 5899
batch 359, loss: 0.8291, instance_loss: 0.5786, weighted_loss: 0.7539, label: 1, bag_size: 4200
batch 379, loss: 0.2821, instance_loss: 0.3741, weighted_loss: 0.3097, label: 2, bag_size: 4691
batch 399, loss: 1.2420, instance_loss: 0.8316, weighted_loss: 1.1189, label: 1, bag_size: 1307
batch 419, loss: 0.1919, instance_loss: 0.5341, weighted_loss: 0.2946, label: 1, bag_size: 3172
batch 439, loss: 0.4984, instance_loss: 0.4857, weighted_loss: 0.4946, label: 0, bag_size: 5260
batch 459, loss: 0.0868, instance_loss: 0.1927, weighted_loss: 0.1186, label: 2, bag_size: 3397
batch 479, loss: 0.5966, instance_loss: 0.4208, weighted_loss: 0.5439, label: 0, bag_size: 4131
batch 499, loss: 0.8054, instance_loss: 0.6407, weighted_loss: 0.7560, label: 2, bag_size: 4291
batch 519, loss: 2.4644, instance_loss: 0.8591, weighted_loss: 1.9828, label: 2, bag_size: 3274
batch 539, loss: 0.3127, instance_loss: 0.4335, weighted_loss: 0.3490, label: 0, bag_size: 5041
batch 559, loss: 1.4324, instance_loss: 0.7423, weighted_loss: 1.2254, label: 2, bag_size: 724
batch 579, loss: 0.7664, instance_loss: 0.7018, weighted_loss: 0.7470, label: 0, bag_size: 1270
batch 599, loss: 0.5400, instance_loss: 0.6371, weighted_loss: 0.5691, label: 0, bag_size: 1625
batch 619, loss: 0.1449, instance_loss: 0.4313, weighted_loss: 0.2309, label: 1, bag_size: 3437
batch 639, loss: 0.4653, instance_loss: 0.3974, weighted_loss: 0.4449, label: 1, bag_size: 4534
batch 659, loss: 0.8201, instance_loss: 0.6342, weighted_loss: 0.7643, label: 1, bag_size: 4940
batch 679, loss: 0.4646, instance_loss: 0.5711, weighted_loss: 0.4966, label: 1, bag_size: 2731
batch 699, loss: 0.8301, instance_loss: 0.5060, weighted_loss: 0.7328, label: 2, bag_size: 5426
batch 719, loss: 0.2064, instance_loss: 0.4521, weighted_loss: 0.2801, label: 1, bag_size: 2453
batch 739, loss: 0.6669, instance_loss: 0.4730, weighted_loss: 0.6087, label: 2, bag_size: 22464


class 0 clustering acc 0.9847874720357942: correct 17608/17880
class 1 clustering acc 0.1256711409395973: correct 749/5960
Epoch: 5, train_loss: 0.7623, train_clustering_loss:  0.6260, train_error: 0.3356
class 0: acc 0.6179245283018868, correct 131/212
class 1: acc 0.6223021582733813, correct 173/278
class 2: acc 0.7490196078431373, correct 191/255

Val Set, val_loss: 0.9856, val_error: 0.4362, auc: 0.8136
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.10638297872340426: correct 80/752
class 0: acc 0.46153846153846156, correct 24/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2532, instance_loss: 0.6776, weighted_loss: 1.0805, label: 0, bag_size: 4719
batch 39, loss: 3.4752, instance_loss: 1.2269, weighted_loss: 2.8007, label: 2, bag_size: 361
batch 59, loss: 0.9934, instance_loss: 0.7828, weighted_loss: 0.9302, label: 2, bag_size: 4291
batch 79, loss: 0.3605, instance_loss: 0.4685, weighted_loss: 0.3929, label: 0, bag_size: 6015
batch 99, loss: 0.2538, instance_loss: 0.3149, weighted_loss: 0.2721, label: 0, bag_size: 3344
batch 119, loss: 1.0970, instance_loss: 0.8161, weighted_loss: 1.0127, label: 1, bag_size: 4708
batch 139, loss: 1.3669, instance_loss: 0.5635, weighted_loss: 1.1259, label: 2, bag_size: 705
batch 159, loss: 2.7790, instance_loss: 1.4188, weighted_loss: 2.3709, label: 0, bag_size: 4274
batch 179, loss: 1.3371, instance_loss: 0.9569, weighted_loss: 1.2230, label: 1, bag_size: 4684
batch 199, loss: 0.4058, instance_loss: 0.1711, weighted_loss: 0.3354, label: 2, bag_size: 4056
batch 219, loss: 1.0217, instance_loss: 0.6730, weighted_loss: 0.9171, label: 1, bag_size: 1045
batch 239, loss: 0.1590, instance_loss: 0.2089, weighted_loss: 0.1740, label: 2, bag_size: 4856
batch 259, loss: 1.1059, instance_loss: 0.7786, weighted_loss: 1.0077, label: 0, bag_size: 2428
batch 279, loss: 1.0308, instance_loss: 0.6726, weighted_loss: 0.9234, label: 1, bag_size: 2747
batch 299, loss: 0.5290, instance_loss: 0.8211, weighted_loss: 0.6166, label: 2, bag_size: 3810
batch 319, loss: 0.8323, instance_loss: 0.5646, weighted_loss: 0.7520, label: 2, bag_size: 2481
batch 339, loss: 1.1429, instance_loss: 0.7452, weighted_loss: 1.0236, label: 1, bag_size: 1045
batch 359, loss: 0.4963, instance_loss: 0.3253, weighted_loss: 0.4450, label: 2, bag_size: 614
batch 379, loss: 1.6328, instance_loss: 0.7930, weighted_loss: 1.3809, label: 2, bag_size: 3172
batch 399, loss: 0.6800, instance_loss: 0.5573, weighted_loss: 0.6432, label: 1, bag_size: 5512
batch 419, loss: 0.2788, instance_loss: 0.6000, weighted_loss: 0.3751, label: 1, bag_size: 1558
batch 439, loss: 0.3489, instance_loss: 0.7210, weighted_loss: 0.4605, label: 1, bag_size: 5696
batch 459, loss: 0.3261, instance_loss: 0.4646, weighted_loss: 0.3676, label: 0, bag_size: 2479
batch 479, loss: 0.1193, instance_loss: 0.3158, weighted_loss: 0.1782, label: 0, bag_size: 4741
batch 499, loss: 0.4388, instance_loss: 0.4964, weighted_loss: 0.4561, label: 0, bag_size: 2927
batch 519, loss: 1.4219, instance_loss: 0.6377, weighted_loss: 1.1866, label: 2, bag_size: 705
batch 539, loss: 1.2957, instance_loss: 1.1782, weighted_loss: 1.2604, label: 1, bag_size: 1477
batch 559, loss: 1.3070, instance_loss: 0.7436, weighted_loss: 1.1380, label: 0, bag_size: 3070
batch 579, loss: 0.3978, instance_loss: 0.5475, weighted_loss: 0.4427, label: 2, bag_size: 6594
batch 599, loss: 0.3784, instance_loss: 0.6819, weighted_loss: 0.4695, label: 0, bag_size: 614
batch 619, loss: 0.5211, instance_loss: 0.3811, weighted_loss: 0.4791, label: 2, bag_size: 4535
batch 639, loss: 2.4861, instance_loss: 1.7369, weighted_loss: 2.2613, label: 0, bag_size: 3341
batch 659, loss: 0.3515, instance_loss: 0.4704, weighted_loss: 0.3871, label: 0, bag_size: 2983
batch 679, loss: 0.5590, instance_loss: 0.4832, weighted_loss: 0.5363, label: 1, bag_size: 3403
batch 699, loss: 0.7588, instance_loss: 0.8228, weighted_loss: 0.7780, label: 2, bag_size: 3618
batch 719, loss: 0.8186, instance_loss: 0.5440, weighted_loss: 0.7362, label: 1, bag_size: 4395
batch 739, loss: 1.2582, instance_loss: 0.7931, weighted_loss: 1.1187, label: 1, bag_size: 3475


class 0 clustering acc 0.9854586129753915: correct 17620/17880
class 1 clustering acc 0.1197986577181208: correct 714/5960
Epoch: 6, train_loss: 0.7895, train_clustering_loss:  0.6419, train_error: 0.3463
class 0: acc 0.6929460580912863, correct 167/241
class 1: acc 0.5261044176706827, correct 131/249
class 2: acc 0.7411764705882353, correct 189/255

Val Set, val_loss: 0.8368, val_error: 0.3085, auc: 0.8343
class 0 clustering acc 0.9893617021276596: correct 2232/2256
class 1 clustering acc 0.03324468085106383: correct 25/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2997, instance_loss: 0.5225, weighted_loss: 0.3666, label: 0, bag_size: 11663
batch 39, loss: 0.4273, instance_loss: 0.2120, weighted_loss: 0.3627, label: 2, bag_size: 4056
batch 59, loss: 0.7500, instance_loss: 0.6959, weighted_loss: 0.7338, label: 0, bag_size: 3038
batch 79, loss: 0.1761, instance_loss: 0.7218, weighted_loss: 0.3398, label: 1, bag_size: 5696
batch 99, loss: 0.1026, instance_loss: 0.5817, weighted_loss: 0.2463, label: 2, bag_size: 3607
batch 119, loss: 0.0902, instance_loss: 0.1702, weighted_loss: 0.1142, label: 2, bag_size: 4043
batch 139, loss: 0.0577, instance_loss: 0.0818, weighted_loss: 0.0649, label: 2, bag_size: 6026
batch 159, loss: 0.1456, instance_loss: 0.2265, weighted_loss: 0.1699, label: 1, bag_size: 3007
batch 179, loss: 0.4835, instance_loss: 0.5955, weighted_loss: 0.5171, label: 2, bag_size: 3534
batch 199, loss: 0.9986, instance_loss: 0.7465, weighted_loss: 0.9230, label: 1, bag_size: 1066
batch 219, loss: 2.8600, instance_loss: 1.0694, weighted_loss: 2.3228, label: 2, bag_size: 4316
batch 239, loss: 0.0792, instance_loss: 0.1730, weighted_loss: 0.1073, label: 2, bag_size: 6026
batch 259, loss: 0.7331, instance_loss: 0.9183, weighted_loss: 0.7886, label: 0, bag_size: 1170
batch 279, loss: 0.9622, instance_loss: 0.7735, weighted_loss: 0.9056, label: 0, bag_size: 5098
batch 299, loss: 0.2698, instance_loss: 0.7154, weighted_loss: 0.4035, label: 2, bag_size: 3607
batch 319, loss: 0.1015, instance_loss: 0.2611, weighted_loss: 0.1494, label: 2, bag_size: 5924
batch 339, loss: 0.1374, instance_loss: 0.1981, weighted_loss: 0.1556, label: 2, bag_size: 4096
batch 359, loss: 3.1041, instance_loss: 1.5350, weighted_loss: 2.6334, label: 1, bag_size: 2852
batch 379, loss: 0.1326, instance_loss: 0.3277, weighted_loss: 0.1912, label: 0, bag_size: 4325
batch 399, loss: 0.3338, instance_loss: 0.5022, weighted_loss: 0.3843, label: 1, bag_size: 1066
batch 419, loss: 0.2058, instance_loss: 0.3734, weighted_loss: 0.2561, label: 0, bag_size: 3901
batch 439, loss: 1.9721, instance_loss: 1.5671, weighted_loss: 1.8506, label: 1, bag_size: 3995
batch 459, loss: 0.1383, instance_loss: 0.3779, weighted_loss: 0.2102, label: 1, bag_size: 5018
batch 479, loss: 0.8916, instance_loss: 0.6039, weighted_loss: 0.8053, label: 1, bag_size: 5412
batch 499, loss: 0.0762, instance_loss: 0.5485, weighted_loss: 0.2179, label: 1, bag_size: 5364
batch 519, loss: 0.5528, instance_loss: 0.6499, weighted_loss: 0.5820, label: 0, bag_size: 2257
batch 539, loss: 0.3986, instance_loss: 0.4667, weighted_loss: 0.4190, label: 2, bag_size: 3210
batch 559, loss: 0.4747, instance_loss: 0.6016, weighted_loss: 0.5128, label: 0, bag_size: 3690
batch 579, loss: 0.1118, instance_loss: 0.6199, weighted_loss: 0.2642, label: 2, bag_size: 3607
batch 599, loss: 1.4464, instance_loss: 0.6283, weighted_loss: 1.2010, label: 1, bag_size: 4395
batch 619, loss: 1.6060, instance_loss: 0.8542, weighted_loss: 1.3804, label: 0, bag_size: 5023
batch 639, loss: 1.8772, instance_loss: 0.8685, weighted_loss: 1.5746, label: 2, bag_size: 909
batch 659, loss: 0.4424, instance_loss: 0.3469, weighted_loss: 0.4138, label: 0, bag_size: 5632
batch 679, loss: 1.0400, instance_loss: 0.8171, weighted_loss: 0.9732, label: 1, bag_size: 3604
batch 699, loss: 0.4103, instance_loss: 0.5655, weighted_loss: 0.4569, label: 0, bag_size: 3920
batch 719, loss: 0.2016, instance_loss: 0.4295, weighted_loss: 0.2700, label: 0, bag_size: 921
batch 739, loss: 2.6604, instance_loss: 1.3354, weighted_loss: 2.2629, label: 0, bag_size: 1774


class 0 clustering acc 0.9848993288590604: correct 17610/17880
class 1 clustering acc 0.162248322147651: correct 967/5960
Epoch: 7, train_loss: 0.6899, train_clustering_loss:  0.6045, train_error: 0.3087
class 0: acc 0.7, correct 161/230
class 1: acc 0.5934959349593496, correct 146/246
class 2: acc 0.7732342007434945, correct 208/269

Val Set, val_loss: 0.7621, val_error: 0.2979, auc: 0.8318
class 0 clustering acc 0.9884751773049646: correct 2230/2256
class 1 clustering acc 0.1981382978723404: correct 149/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.830818 --> 0.762107).  Saving model ...


batch 19, loss: 0.2370, instance_loss: 0.2441, weighted_loss: 0.2391, label: 2, bag_size: 2031
batch 39, loss: 0.4303, instance_loss: 0.5798, weighted_loss: 0.4751, label: 0, bag_size: 6015
batch 59, loss: 0.1408, instance_loss: 0.3708, weighted_loss: 0.2098, label: 2, bag_size: 3497
batch 79, loss: 0.4922, instance_loss: 0.5918, weighted_loss: 0.5221, label: 1, bag_size: 209
batch 99, loss: 0.0658, instance_loss: 0.2732, weighted_loss: 0.1280, label: 0, bag_size: 1625
batch 119, loss: 0.7331, instance_loss: 0.6870, weighted_loss: 0.7193, label: 1, bag_size: 3126
batch 139, loss: 0.2829, instance_loss: 0.3847, weighted_loss: 0.3135, label: 2, bag_size: 4043
batch 159, loss: 0.1102, instance_loss: 0.1543, weighted_loss: 0.1234, label: 2, bag_size: 5914
batch 179, loss: 0.0605, instance_loss: 0.2112, weighted_loss: 0.1057, label: 2, bag_size: 2031
batch 199, loss: 0.7740, instance_loss: 0.4768, weighted_loss: 0.6849, label: 0, bag_size: 4614
batch 219, loss: 0.0760, instance_loss: 0.2539, weighted_loss: 0.1294, label: 2, bag_size: 3285
batch 239, loss: 0.0379, instance_loss: 0.4902, weighted_loss: 0.1736, label: 1, bag_size: 3043
batch 259, loss: 0.2889, instance_loss: 0.1519, weighted_loss: 0.2478, label: 2, bag_size: 4056
batch 279, loss: 0.4016, instance_loss: 0.4458, weighted_loss: 0.4149, label: 0, bag_size: 3777
batch 299, loss: 0.5421, instance_loss: 0.5457, weighted_loss: 0.5432, label: 1, bag_size: 6025
batch 319, loss: 2.1425, instance_loss: 0.8747, weighted_loss: 1.7621, label: 1, bag_size: 20666
batch 339, loss: 0.2983, instance_loss: 0.5220, weighted_loss: 0.3654, label: 0, bag_size: 2286
batch 359, loss: 1.7281, instance_loss: 0.8875, weighted_loss: 1.4759, label: 1, bag_size: 5035
batch 379, loss: 0.3550, instance_loss: 0.3764, weighted_loss: 0.3614, label: 0, bag_size: 4292
batch 399, loss: 0.2082, instance_loss: 0.4548, weighted_loss: 0.2822, label: 2, bag_size: 4569
batch 419, loss: 0.1487, instance_loss: 0.3170, weighted_loss: 0.1992, label: 2, bag_size: 3397
batch 439, loss: 0.0945, instance_loss: 0.1501, weighted_loss: 0.1112, label: 2, bag_size: 2422
batch 459, loss: 0.7668, instance_loss: 0.7176, weighted_loss: 0.7520, label: 2, bag_size: 4291
batch 479, loss: 1.1023, instance_loss: 0.7872, weighted_loss: 1.0077, label: 0, bag_size: 4922
batch 499, loss: 0.3062, instance_loss: 0.3949, weighted_loss: 0.3328, label: 0, bag_size: 4416
batch 519, loss: 0.8630, instance_loss: 0.8819, weighted_loss: 0.8687, label: 0, bag_size: 1141
batch 539, loss: 1.7342, instance_loss: 0.7603, weighted_loss: 1.4420, label: 0, bag_size: 3075
batch 559, loss: 0.0711, instance_loss: 0.1797, weighted_loss: 0.1036, label: 0, bag_size: 5500
batch 579, loss: 0.1658, instance_loss: 0.2655, weighted_loss: 0.1957, label: 0, bag_size: 6430
batch 599, loss: 0.9407, instance_loss: 0.5916, weighted_loss: 0.8360, label: 1, bag_size: 1371
batch 619, loss: 0.7387, instance_loss: 0.5535, weighted_loss: 0.6831, label: 0, bag_size: 4541
batch 639, loss: 1.1255, instance_loss: 0.6788, weighted_loss: 0.9915, label: 0, bag_size: 5330
batch 659, loss: 1.3316, instance_loss: 0.5202, weighted_loss: 1.0882, label: 1, bag_size: 5718
batch 679, loss: 0.0179, instance_loss: 0.0803, weighted_loss: 0.0366, label: 2, bag_size: 6026
batch 699, loss: 0.3887, instance_loss: 0.4736, weighted_loss: 0.4142, label: 2, bag_size: 6704
batch 719, loss: 0.1045, instance_loss: 0.1743, weighted_loss: 0.1254, label: 2, bag_size: 5914
batch 739, loss: 0.2781, instance_loss: 0.3688, weighted_loss: 0.3053, label: 2, bag_size: 5914


class 0 clustering acc 0.9815436241610739: correct 17550/17880
class 1 clustering acc 0.18506711409395973: correct 1103/5960
Epoch: 8, train_loss: 0.7051, train_clustering_loss:  0.6091, train_error: 0.3087
class 0: acc 0.7380952380952381, correct 186/252
class 1: acc 0.5852713178294574, correct 151/258
class 2: acc 0.7574468085106383, correct 178/235

Val Set, val_loss: 0.7594, val_error: 0.2872, auc: 0.8334
class 0 clustering acc 0.9911347517730497: correct 2236/2256
class 1 clustering acc 0.0625: correct 47/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.762107 --> 0.759410).  Saving model ...


batch 19, loss: 0.6445, instance_loss: 0.5908, weighted_loss: 0.6284, label: 1, bag_size: 5412
batch 39, loss: 1.1739, instance_loss: 0.5619, weighted_loss: 0.9903, label: 0, bag_size: 5017
batch 59, loss: 0.3948, instance_loss: 0.3595, weighted_loss: 0.3842, label: 1, bag_size: 210
batch 79, loss: 0.1768, instance_loss: 0.3945, weighted_loss: 0.2421, label: 0, bag_size: 2825
batch 99, loss: 0.3234, instance_loss: 0.3519, weighted_loss: 0.3320, label: 0, bag_size: 3864
batch 119, loss: 2.9644, instance_loss: 1.2722, weighted_loss: 2.4568, label: 1, bag_size: 32
batch 139, loss: 1.1438, instance_loss: 0.6493, weighted_loss: 0.9954, label: 0, bag_size: 5260
batch 159, loss: 0.7225, instance_loss: 0.4583, weighted_loss: 0.6432, label: 0, bag_size: 6797
batch 179, loss: 0.2979, instance_loss: 0.6357, weighted_loss: 0.3992, label: 2, bag_size: 4132
batch 199, loss: 0.5374, instance_loss: 0.7679, weighted_loss: 0.6066, label: 1, bag_size: 2921
batch 219, loss: 0.0985, instance_loss: 0.4785, weighted_loss: 0.2125, label: 0, bag_size: 4083
batch 239, loss: 0.0979, instance_loss: 0.9458, weighted_loss: 0.3523, label: 0, bag_size: 1341
batch 259, loss: 0.0700, instance_loss: 0.1059, weighted_loss: 0.0808, label: 2, bag_size: 3210
batch 279, loss: 0.1046, instance_loss: 0.2489, weighted_loss: 0.1479, label: 2, bag_size: 2359
batch 299, loss: 0.9317, instance_loss: 1.0979, weighted_loss: 0.9816, label: 2, bag_size: 2486
batch 319, loss: 0.1433, instance_loss: 0.5069, weighted_loss: 0.2524, label: 0, bag_size: 5029
batch 339, loss: 0.5178, instance_loss: 0.3188, weighted_loss: 0.4581, label: 1, bag_size: 2878
batch 359, loss: 0.8604, instance_loss: 0.7152, weighted_loss: 0.8168, label: 1, bag_size: 3422
batch 379, loss: 0.3271, instance_loss: 0.4499, weighted_loss: 0.3640, label: 2, bag_size: 1103
batch 399, loss: 0.0330, instance_loss: 0.2010, weighted_loss: 0.0834, label: 2, bag_size: 5914
batch 419, loss: 1.3042, instance_loss: 0.8552, weighted_loss: 1.1695, label: 0, bag_size: 1904
batch 439, loss: 0.2066, instance_loss: 0.5888, weighted_loss: 0.3212, label: 2, bag_size: 5017
batch 459, loss: 1.3154, instance_loss: 0.5640, weighted_loss: 1.0900, label: 0, bag_size: 4378
batch 479, loss: 0.8174, instance_loss: 0.4792, weighted_loss: 0.7159, label: 0, bag_size: 3639
batch 499, loss: 0.6440, instance_loss: 0.5381, weighted_loss: 0.6122, label: 1, bag_size: 3391
batch 519, loss: 0.4056, instance_loss: 0.3363, weighted_loss: 0.3848, label: 2, bag_size: 1103
batch 539, loss: 0.5722, instance_loss: 0.7372, weighted_loss: 0.6217, label: 2, bag_size: 3746
batch 559, loss: 0.5591, instance_loss: 0.4571, weighted_loss: 0.5285, label: 1, bag_size: 1906
batch 579, loss: 0.8917, instance_loss: 0.6891, weighted_loss: 0.8310, label: 1, bag_size: 2743
batch 599, loss: 1.7555, instance_loss: 0.7101, weighted_loss: 1.4418, label: 1, bag_size: 5035
batch 619, loss: 1.7857, instance_loss: 0.9076, weighted_loss: 1.5223, label: 0, bag_size: 4946
batch 639, loss: 0.2986, instance_loss: 0.4347, weighted_loss: 0.3394, label: 0, bag_size: 4634
batch 659, loss: 3.1640, instance_loss: 0.9701, weighted_loss: 2.5058, label: 2, bag_size: 728
batch 679, loss: 2.3641, instance_loss: 0.9650, weighted_loss: 1.9444, label: 2, bag_size: 728
batch 699, loss: 0.5440, instance_loss: 0.4519, weighted_loss: 0.5163, label: 1, bag_size: 4595
batch 719, loss: 0.6231, instance_loss: 0.5404, weighted_loss: 0.5983, label: 0, bag_size: 13540
batch 739, loss: 0.2474, instance_loss: 0.2872, weighted_loss: 0.2594, label: 0, bag_size: 3752


class 0 clustering acc 0.9822147651006712: correct 17562/17880
class 1 clustering acc 0.19546979865771813: correct 1165/5960
Epoch: 9, train_loss: 0.7085, train_clustering_loss:  0.5952, train_error: 0.3020
class 0: acc 0.7222222222222222, correct 182/252
class 1: acc 0.60546875, correct 155/256
class 2: acc 0.7721518987341772, correct 183/237

Val Set, val_loss: 0.7505, val_error: 0.2766, auc: 0.8364
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.2220744680851064: correct 167/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.759410 --> 0.750535).  Saving model ...


batch 19, loss: 0.5694, instance_loss: 0.8646, weighted_loss: 0.6579, label: 1, bag_size: 8482
batch 39, loss: 0.6270, instance_loss: 0.5895, weighted_loss: 0.6157, label: 0, bag_size: 2712
batch 59, loss: 0.9126, instance_loss: 0.6649, weighted_loss: 0.8383, label: 1, bag_size: 6277
batch 79, loss: 0.0580, instance_loss: 0.2001, weighted_loss: 0.1006, label: 2, bag_size: 3210
batch 99, loss: 0.1458, instance_loss: 0.3297, weighted_loss: 0.2009, label: 2, bag_size: 3227
batch 119, loss: 0.5898, instance_loss: 0.8270, weighted_loss: 0.6610, label: 0, bag_size: 4310
batch 139, loss: 0.8642, instance_loss: 0.8259, weighted_loss: 0.8527, label: 0, bag_size: 4351
batch 159, loss: 0.0709, instance_loss: 0.2349, weighted_loss: 0.1201, label: 0, bag_size: 3754
batch 179, loss: 1.2774, instance_loss: 0.7163, weighted_loss: 1.1090, label: 0, bag_size: 4146
batch 199, loss: 0.4582, instance_loss: 0.5343, weighted_loss: 0.4810, label: 0, bag_size: 4310
batch 219, loss: 0.3854, instance_loss: 0.4259, weighted_loss: 0.3975, label: 0, bag_size: 1883
batch 239, loss: 0.6310, instance_loss: 0.8762, weighted_loss: 0.7046, label: 1, bag_size: 3396
batch 259, loss: 0.7731, instance_loss: 0.5166, weighted_loss: 0.6962, label: 0, bag_size: 3915
batch 279, loss: 0.4345, instance_loss: 0.4915, weighted_loss: 0.4516, label: 0, bag_size: 5041
batch 299, loss: 1.9768, instance_loss: 1.2501, weighted_loss: 1.7588, label: 1, bag_size: 869
batch 319, loss: 0.6823, instance_loss: 0.4770, weighted_loss: 0.6207, label: 2, bag_size: 3112
batch 339, loss: 0.9865, instance_loss: 0.7526, weighted_loss: 0.9163, label: 2, bag_size: 1543
batch 359, loss: 0.4146, instance_loss: 0.3743, weighted_loss: 0.4026, label: 0, bag_size: 5373
batch 379, loss: 0.3730, instance_loss: 0.6634, weighted_loss: 0.4602, label: 2, bag_size: 5011
batch 399, loss: 0.5743, instance_loss: 0.5567, weighted_loss: 0.5690, label: 2, bag_size: 3534
batch 419, loss: 0.0938, instance_loss: 0.4329, weighted_loss: 0.1955, label: 0, bag_size: 4300
batch 439, loss: 1.5318, instance_loss: 0.9481, weighted_loss: 1.3567, label: 2, bag_size: 5743
batch 459, loss: 0.2065, instance_loss: 0.1896, weighted_loss: 0.2014, label: 2, bag_size: 5914
batch 479, loss: 0.6125, instance_loss: 0.8257, weighted_loss: 0.6765, label: 2, bag_size: 3746
batch 499, loss: 0.6450, instance_loss: 0.5233, weighted_loss: 0.6085, label: 2, bag_size: 3112
batch 519, loss: 0.1128, instance_loss: 0.4970, weighted_loss: 0.2281, label: 2, bag_size: 3778
batch 539, loss: 0.4054, instance_loss: 0.3969, weighted_loss: 0.4028, label: 2, bag_size: 4096
batch 559, loss: 1.1617, instance_loss: 0.9918, weighted_loss: 1.1108, label: 1, bag_size: 1510
batch 579, loss: 0.9808, instance_loss: 0.9114, weighted_loss: 0.9600, label: 0, bag_size: 4841
batch 599, loss: 0.2977, instance_loss: 0.3398, weighted_loss: 0.3103, label: 2, bag_size: 3176
batch 619, loss: 0.0268, instance_loss: 0.1313, weighted_loss: 0.0582, label: 2, bag_size: 3285
batch 639, loss: 0.0355, instance_loss: 0.3350, weighted_loss: 0.1254, label: 0, bag_size: 873
batch 659, loss: 0.5868, instance_loss: 1.0390, weighted_loss: 0.7224, label: 0, bag_size: 1352
batch 679, loss: 0.4440, instance_loss: 0.4562, weighted_loss: 0.4476, label: 0, bag_size: 5041
batch 699, loss: 0.3679, instance_loss: 0.5980, weighted_loss: 0.4369, label: 1, bag_size: 2122
batch 719, loss: 0.6213, instance_loss: 0.5625, weighted_loss: 0.6037, label: 1, bag_size: 2013
batch 739, loss: 0.1233, instance_loss: 0.3401, weighted_loss: 0.1883, label: 0, bag_size: 5236


class 0 clustering acc 0.9779082774049217: correct 17485/17880
class 1 clustering acc 0.2370805369127517: correct 1413/5960
Epoch: 10, train_loss: 0.6749, train_clustering_loss:  0.5870, train_error: 0.2752
class 0: acc 0.7445887445887446, correct 172/231
class 1: acc 0.6770428015564203, correct 174/257
class 2: acc 0.754863813229572, correct 194/257

Val Set, val_loss: 0.7637, val_error: 0.2979, auc: 0.8330
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.1702127659574468: correct 128/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7286, instance_loss: 0.7806, weighted_loss: 0.7442, label: 1, bag_size: 5532
batch 39, loss: 0.6588, instance_loss: 0.6466, weighted_loss: 0.6552, label: 1, bag_size: 4960
batch 59, loss: 1.3087, instance_loss: 1.1010, weighted_loss: 1.2464, label: 0, bag_size: 1782
batch 79, loss: 0.8437, instance_loss: 0.7669, weighted_loss: 0.8207, label: 2, bag_size: 5743
batch 99, loss: 0.7699, instance_loss: 1.3038, weighted_loss: 0.9301, label: 2, bag_size: 2486
batch 119, loss: 0.6402, instance_loss: 0.4974, weighted_loss: 0.5974, label: 0, bag_size: 5848
batch 139, loss: 0.8305, instance_loss: 0.6370, weighted_loss: 0.7725, label: 2, bag_size: 1543
batch 159, loss: 0.3089, instance_loss: 0.3961, weighted_loss: 0.3351, label: 2, bag_size: 5924
batch 179, loss: 0.7612, instance_loss: 0.5014, weighted_loss: 0.6833, label: 0, bag_size: 4562
batch 199, loss: 3.6441, instance_loss: 1.2029, weighted_loss: 2.9118, label: 2, bag_size: 223
batch 219, loss: 0.0053, instance_loss: 0.0609, weighted_loss: 0.0220, label: 2, bag_size: 4203
batch 239, loss: 0.7385, instance_loss: 0.6600, weighted_loss: 0.7150, label: 2, bag_size: 5924
batch 259, loss: 0.2390, instance_loss: 0.4178, weighted_loss: 0.2926, label: 1, bag_size: 4119
batch 279, loss: 0.1556, instance_loss: 0.5044, weighted_loss: 0.2602, label: 1, bag_size: 3493
batch 299, loss: 2.3151, instance_loss: 1.1319, weighted_loss: 1.9601, label: 2, bag_size: 909
batch 319, loss: 0.4346, instance_loss: 0.8978, weighted_loss: 0.5736, label: 0, bag_size: 4147
batch 339, loss: 0.0667, instance_loss: 0.3221, weighted_loss: 0.1433, label: 2, bag_size: 4856
batch 359, loss: 1.0406, instance_loss: 0.6203, weighted_loss: 0.9145, label: 1, bag_size: 4694
batch 379, loss: 0.0890, instance_loss: 0.4671, weighted_loss: 0.2024, label: 1, bag_size: 3677
batch 399, loss: 0.7306, instance_loss: 0.6930, weighted_loss: 0.7193, label: 2, bag_size: 4291
batch 419, loss: 0.0846, instance_loss: 0.1434, weighted_loss: 0.1022, label: 2, bag_size: 2997
batch 439, loss: 0.2174, instance_loss: 0.2108, weighted_loss: 0.2155, label: 0, bag_size: 6440
batch 459, loss: 2.2018, instance_loss: 1.0055, weighted_loss: 1.8429, label: 2, bag_size: 909
batch 479, loss: 4.1436, instance_loss: 1.6803, weighted_loss: 3.4046, label: 0, bag_size: 1755
batch 499, loss: 1.5680, instance_loss: 0.8189, weighted_loss: 1.3433, label: 1, bag_size: 3935
batch 519, loss: 0.1753, instance_loss: 0.4170, weighted_loss: 0.2478, label: 2, bag_size: 4555
batch 539, loss: 2.9458, instance_loss: 1.1499, weighted_loss: 2.4070, label: 0, bag_size: 2217
batch 559, loss: 0.1967, instance_loss: 0.4946, weighted_loss: 0.2861, label: 1, bag_size: 3337
batch 579, loss: 0.3797, instance_loss: 0.5188, weighted_loss: 0.4214, label: 2, bag_size: 22464
batch 599, loss: 0.2079, instance_loss: 0.3986, weighted_loss: 0.2651, label: 1, bag_size: 368
batch 619, loss: 1.0690, instance_loss: 0.9028, weighted_loss: 1.0191, label: 1, bag_size: 5693
batch 639, loss: 0.0769, instance_loss: 0.3256, weighted_loss: 0.1515, label: 1, bag_size: 3172
batch 659, loss: 0.2118, instance_loss: 0.2874, weighted_loss: 0.2345, label: 0, bag_size: 4577
batch 679, loss: 0.1110, instance_loss: 0.2347, weighted_loss: 0.1481, label: 0, bag_size: 4506
batch 699, loss: 3.4000, instance_loss: 1.4941, weighted_loss: 2.8282, label: 1, bag_size: 1097
batch 719, loss: 0.7305, instance_loss: 0.6726, weighted_loss: 0.7131, label: 0, bag_size: 2850
batch 739, loss: 0.6838, instance_loss: 0.4629, weighted_loss: 0.6175, label: 0, bag_size: 3709


class 0 clustering acc 0.9803691275167785: correct 17529/17880
class 1 clustering acc 0.22416107382550335: correct 1336/5960
Epoch: 11, train_loss: 0.7021, train_clustering_loss:  0.5902, train_error: 0.3034
class 0: acc 0.7406015037593985, correct 197/266
class 1: acc 0.5901639344262295, correct 144/244
class 2: acc 0.7574468085106383, correct 178/235

Val Set, val_loss: 0.6530, val_error: 0.2872, auc: 0.8609
class 0 clustering acc 0.9507978723404256: correct 2145/2256
class 1 clustering acc 0.3257978723404255: correct 245/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.750535 --> 0.653005).  Saving model ...


batch 19, loss: 0.3674, instance_loss: 0.4364, weighted_loss: 0.3881, label: 1, bag_size: 1042
batch 39, loss: 0.0240, instance_loss: 0.0832, weighted_loss: 0.0418, label: 2, bag_size: 3678
batch 59, loss: 0.5787, instance_loss: 0.6480, weighted_loss: 0.5995, label: 1, bag_size: 4438
batch 79, loss: 0.0732, instance_loss: 0.1329, weighted_loss: 0.0911, label: 0, bag_size: 5902
batch 99, loss: 1.2578, instance_loss: 0.8241, weighted_loss: 1.1277, label: 0, bag_size: 3268
batch 119, loss: 0.8387, instance_loss: 0.7006, weighted_loss: 0.7973, label: 1, bag_size: 5756
batch 139, loss: 1.2518, instance_loss: 1.3788, weighted_loss: 1.2899, label: 2, bag_size: 4241
batch 159, loss: 0.5096, instance_loss: 0.6329, weighted_loss: 0.5466, label: 2, bag_size: 4910
batch 179, loss: 1.6091, instance_loss: 0.7508, weighted_loss: 1.3516, label: 0, bag_size: 6249
batch 199, loss: 3.2681, instance_loss: 1.4398, weighted_loss: 2.7196, label: 1, bag_size: 1313
batch 219, loss: 2.1649, instance_loss: 1.1181, weighted_loss: 1.8508, label: 2, bag_size: 1050
batch 239, loss: 0.3228, instance_loss: 0.2892, weighted_loss: 0.3127, label: 0, bag_size: 5146
batch 259, loss: 0.3933, instance_loss: 0.4858, weighted_loss: 0.4211, label: 0, bag_size: 1234
batch 279, loss: 0.3965, instance_loss: 0.5278, weighted_loss: 0.4359, label: 1, bag_size: 3403
batch 299, loss: 0.5230, instance_loss: 0.6248, weighted_loss: 0.5535, label: 0, bag_size: 3268
batch 319, loss: 0.3951, instance_loss: 0.5287, weighted_loss: 0.4352, label: 1, bag_size: 2731
batch 339, loss: 0.4520, instance_loss: 0.6688, weighted_loss: 0.5170, label: 2, bag_size: 4372
batch 359, loss: 0.4593, instance_loss: 0.4708, weighted_loss: 0.4628, label: 1, bag_size: 2945
batch 379, loss: 0.5502, instance_loss: 0.7168, weighted_loss: 0.6002, label: 1, bag_size: 455
batch 399, loss: 1.3654, instance_loss: 0.8808, weighted_loss: 1.2200, label: 1, bag_size: 1542
batch 419, loss: 1.0979, instance_loss: 0.4633, weighted_loss: 0.9076, label: 2, bag_size: 3172
batch 439, loss: 0.6727, instance_loss: 0.7477, weighted_loss: 0.6952, label: 1, bag_size: 2859
batch 459, loss: 0.2312, instance_loss: 0.2869, weighted_loss: 0.2479, label: 0, bag_size: 5226
batch 479, loss: 0.6689, instance_loss: 0.5678, weighted_loss: 0.6386, label: 1, bag_size: 2248
batch 499, loss: 2.3297, instance_loss: 1.2284, weighted_loss: 1.9993, label: 1, bag_size: 2852
batch 519, loss: 1.3279, instance_loss: 0.9652, weighted_loss: 1.2191, label: 0, bag_size: 5585
batch 539, loss: 0.8102, instance_loss: 1.0185, weighted_loss: 0.8727, label: 2, bag_size: 3604
batch 559, loss: 0.4931, instance_loss: 0.5702, weighted_loss: 0.5162, label: 0, bag_size: 4147
batch 579, loss: 0.9437, instance_loss: 0.6698, weighted_loss: 0.8616, label: 1, bag_size: 4869
batch 599, loss: 0.0674, instance_loss: 0.1737, weighted_loss: 0.0993, label: 2, bag_size: 3497
batch 619, loss: 0.4263, instance_loss: 0.5895, weighted_loss: 0.4753, label: 2, bag_size: 6594
batch 639, loss: 0.3033, instance_loss: 0.3845, weighted_loss: 0.3276, label: 1, bag_size: 425
batch 659, loss: 0.4230, instance_loss: 0.5591, weighted_loss: 0.4638, label: 1, bag_size: 1807
batch 679, loss: 0.0349, instance_loss: 0.1430, weighted_loss: 0.0673, label: 0, bag_size: 5500
batch 699, loss: 0.3127, instance_loss: 0.5679, weighted_loss: 0.3893, label: 1, bag_size: 3885
batch 719, loss: 0.0190, instance_loss: 0.0530, weighted_loss: 0.0292, label: 2, bag_size: 3285
batch 739, loss: 0.4331, instance_loss: 0.7440, weighted_loss: 0.5264, label: 0, bag_size: 1883


class 0 clustering acc 0.9748881431767338: correct 17431/17880
class 1 clustering acc 0.2370805369127517: correct 1413/5960
Epoch: 12, train_loss: 0.7093, train_clustering_loss:  0.6027, train_error: 0.2872
class 0: acc 0.7530364372469636, correct 186/247
class 1: acc 0.6290322580645161, correct 156/248
class 2: acc 0.756, correct 189/250

Val Set, val_loss: 0.7226, val_error: 0.2979, auc: 0.8559
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.2327127659574468: correct 175/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.7655, instance_loss: 1.3655, weighted_loss: 2.3455, label: 0, bag_size: 1365
batch 39, loss: 0.1031, instance_loss: 0.2006, weighted_loss: 0.1323, label: 0, bag_size: 4229
batch 59, loss: 0.9625, instance_loss: 0.7993, weighted_loss: 0.9136, label: 2, bag_size: 1543
batch 79, loss: 1.7470, instance_loss: 0.8222, weighted_loss: 1.4696, label: 0, bag_size: 3475
batch 99, loss: 0.0299, instance_loss: 0.0796, weighted_loss: 0.0448, label: 0, bag_size: 6138
batch 119, loss: 0.1675, instance_loss: 0.8074, weighted_loss: 0.3594, label: 2, bag_size: 5472
batch 139, loss: 0.3967, instance_loss: 0.4894, weighted_loss: 0.4245, label: 1, bag_size: 3558
batch 159, loss: 0.1229, instance_loss: 0.5560, weighted_loss: 0.2528, label: 1, bag_size: 5229
batch 179, loss: 1.3000, instance_loss: 0.4659, weighted_loss: 1.0498, label: 0, bag_size: 3402
batch 199, loss: 0.9983, instance_loss: 0.8864, weighted_loss: 0.9648, label: 0, bag_size: 1808
batch 219, loss: 0.5082, instance_loss: 0.4775, weighted_loss: 0.4990, label: 1, bag_size: 1029
batch 239, loss: 0.7865, instance_loss: 0.7164, weighted_loss: 0.7655, label: 1, bag_size: 455
batch 259, loss: 2.2123, instance_loss: 1.0234, weighted_loss: 1.8556, label: 2, bag_size: 361
batch 279, loss: 0.6645, instance_loss: 0.7041, weighted_loss: 0.6764, label: 2, bag_size: 3618
batch 299, loss: 0.4200, instance_loss: 0.5909, weighted_loss: 0.4712, label: 2, bag_size: 3778
batch 319, loss: 0.0751, instance_loss: 0.4335, weighted_loss: 0.1826, label: 1, bag_size: 4134
batch 339, loss: 0.7941, instance_loss: 0.6067, weighted_loss: 0.7378, label: 1, bag_size: 4395
batch 359, loss: 0.3210, instance_loss: 0.6638, weighted_loss: 0.4238, label: 1, bag_size: 6243
batch 379, loss: 0.0781, instance_loss: 0.0533, weighted_loss: 0.0706, label: 2, bag_size: 1094
batch 399, loss: 0.1807, instance_loss: 0.2195, weighted_loss: 0.1923, label: 0, bag_size: 4131
batch 419, loss: 0.1686, instance_loss: 0.4402, weighted_loss: 0.2501, label: 1, bag_size: 3677
batch 439, loss: 0.4757, instance_loss: 0.6086, weighted_loss: 0.5155, label: 1, bag_size: 1197
batch 459, loss: 1.1183, instance_loss: 0.7909, weighted_loss: 1.0201, label: 1, bag_size: 1371
batch 479, loss: 0.0336, instance_loss: 0.6470, weighted_loss: 0.2176, label: 2, bag_size: 4497
batch 499, loss: 0.2968, instance_loss: 0.4415, weighted_loss: 0.3402, label: 2, bag_size: 4555
batch 519, loss: 0.2815, instance_loss: 0.4817, weighted_loss: 0.3416, label: 1, bag_size: 14449
batch 539, loss: 0.1719, instance_loss: 0.5215, weighted_loss: 0.2768, label: 2, bag_size: 5472
batch 559, loss: 0.0965, instance_loss: 0.3294, weighted_loss: 0.1664, label: 2, bag_size: 2422
batch 579, loss: 0.5698, instance_loss: 0.5237, weighted_loss: 0.5559, label: 1, bag_size: 2753
batch 599, loss: 4.2701, instance_loss: 1.9223, weighted_loss: 3.5658, label: 0, bag_size: 7504
batch 619, loss: 1.1197, instance_loss: 0.6788, weighted_loss: 0.9874, label: 2, bag_size: 1222
batch 639, loss: 0.0088, instance_loss: 0.4217, weighted_loss: 0.1326, label: 0, bag_size: 5487
batch 659, loss: 1.4026, instance_loss: 0.9428, weighted_loss: 1.2646, label: 1, bag_size: 1510
batch 679, loss: 0.1539, instance_loss: 0.6862, weighted_loss: 0.3136, label: 2, bag_size: 5472
batch 699, loss: 0.8882, instance_loss: 0.6309, weighted_loss: 0.8110, label: 1, bag_size: 574
batch 719, loss: 0.0860, instance_loss: 0.1031, weighted_loss: 0.0912, label: 2, bag_size: 2997
batch 739, loss: 1.3200, instance_loss: 0.8850, weighted_loss: 1.1895, label: 2, bag_size: 7607


class 0 clustering acc 0.9751677852348993: correct 17436/17880
class 1 clustering acc 0.2563758389261745: correct 1528/5960
Epoch: 13, train_loss: 0.6791, train_clustering_loss:  0.5917, train_error: 0.2980
class 0: acc 0.7708333333333334, correct 185/240
class 1: acc 0.5578512396694215, correct 135/242
class 2: acc 0.7718631178707225, correct 203/263

Val Set, val_loss: 1.0208, val_error: 0.4149, auc: 0.8495
class 0 clustering acc 0.9472517730496454: correct 2137/2256
class 1 clustering acc 0.2220744680851064: correct 167/752
class 0: acc 0.5, correct 26/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0780, instance_loss: 0.2288, weighted_loss: 0.1232, label: 0, bag_size: 5368
batch 39, loss: 0.3680, instance_loss: 0.5400, weighted_loss: 0.4196, label: 1, bag_size: 3983
batch 59, loss: 0.0905, instance_loss: 0.5062, weighted_loss: 0.2152, label: 2, bag_size: 4088
batch 79, loss: 0.0426, instance_loss: 0.2209, weighted_loss: 0.0961, label: 2, bag_size: 4140
batch 99, loss: 0.7647, instance_loss: 0.6751, weighted_loss: 0.7378, label: 2, bag_size: 5914
batch 119, loss: 0.1423, instance_loss: 0.2422, weighted_loss: 0.1723, label: 0, bag_size: 4071
batch 139, loss: 0.0194, instance_loss: 0.2061, weighted_loss: 0.0754, label: 2, bag_size: 2483
batch 159, loss: 0.0888, instance_loss: 0.2549, weighted_loss: 0.1386, label: 1, bag_size: 2453
batch 179, loss: 0.6542, instance_loss: 0.5658, weighted_loss: 0.6277, label: 0, bag_size: 4398
batch 199, loss: 0.3875, instance_loss: 0.3927, weighted_loss: 0.3891, label: 0, bag_size: 3368
batch 219, loss: 2.0028, instance_loss: 0.6810, weighted_loss: 1.6062, label: 0, bag_size: 4639
batch 239, loss: 1.0264, instance_loss: 0.7699, weighted_loss: 0.9494, label: 2, bag_size: 6644
batch 259, loss: 0.1594, instance_loss: 0.4077, weighted_loss: 0.2339, label: 1, bag_size: 3558
batch 279, loss: 4.2219, instance_loss: 1.8617, weighted_loss: 3.5139, label: 0, bag_size: 20234
batch 299, loss: 1.3980, instance_loss: 1.3476, weighted_loss: 1.3829, label: 0, bag_size: 4494
batch 319, loss: 0.5166, instance_loss: 0.4915, weighted_loss: 0.5090, label: 1, bag_size: 800
batch 339, loss: 0.0910, instance_loss: 0.3254, weighted_loss: 0.1613, label: 2, bag_size: 5011
batch 359, loss: 1.1984, instance_loss: 0.8342, weighted_loss: 1.0891, label: 0, bag_size: 8866
batch 379, loss: 0.0294, instance_loss: 0.0819, weighted_loss: 0.0452, label: 2, bag_size: 4856
batch 399, loss: 0.0723, instance_loss: 0.1931, weighted_loss: 0.1086, label: 2, bag_size: 5924
batch 419, loss: 0.3159, instance_loss: 0.5517, weighted_loss: 0.3866, label: 0, bag_size: 2608
batch 439, loss: 1.7020, instance_loss: 0.7389, weighted_loss: 1.4131, label: 1, bag_size: 3508
batch 459, loss: 0.0790, instance_loss: 0.5378, weighted_loss: 0.2167, label: 1, bag_size: 5026
batch 479, loss: 0.0417, instance_loss: 0.1010, weighted_loss: 0.0595, label: 2, bag_size: 2254
batch 499, loss: 0.3682, instance_loss: 0.4757, weighted_loss: 0.4005, label: 1, bag_size: 2122
batch 519, loss: 1.6466, instance_loss: 1.1795, weighted_loss: 1.5065, label: 2, bag_size: 724
batch 539, loss: 0.8490, instance_loss: 1.9392, weighted_loss: 1.1760, label: 0, bag_size: 1352
batch 559, loss: 1.8214, instance_loss: 0.6607, weighted_loss: 1.4732, label: 0, bag_size: 2217
batch 579, loss: 0.4567, instance_loss: 0.7063, weighted_loss: 0.5316, label: 2, bag_size: 5426
batch 599, loss: 0.1925, instance_loss: 0.2777, weighted_loss: 0.2180, label: 2, bag_size: 6704
batch 619, loss: 1.0241, instance_loss: 0.5390, weighted_loss: 0.8785, label: 2, bag_size: 5924
batch 639, loss: 0.3025, instance_loss: 0.3551, weighted_loss: 0.3183, label: 1, bag_size: 3007
batch 659, loss: 0.0050, instance_loss: 0.0562, weighted_loss: 0.0203, label: 2, bag_size: 4910
batch 679, loss: 0.7098, instance_loss: 0.7853, weighted_loss: 0.7324, label: 1, bag_size: 4960
batch 699, loss: 0.1111, instance_loss: 0.3130, weighted_loss: 0.1717, label: 0, bag_size: 1018
batch 719, loss: 0.7722, instance_loss: 0.7808, weighted_loss: 0.7748, label: 1, bag_size: 302
batch 739, loss: 0.4947, instance_loss: 0.7949, weighted_loss: 0.5847, label: 0, bag_size: 2038


class 0 clustering acc 0.9744407158836689: correct 17423/17880
class 1 clustering acc 0.25855704697986576: correct 1541/5960
Epoch: 14, train_loss: 0.6743, train_clustering_loss:  0.5942, train_error: 0.2953
class 0: acc 0.6651785714285714, correct 149/224
class 1: acc 0.6550387596899225, correct 169/258
class 2: acc 0.7870722433460076, correct 207/263

Val Set, val_loss: 0.7568, val_error: 0.2872, auc: 0.8683
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.13297872340425532: correct 100/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3154, instance_loss: 0.1549, weighted_loss: 0.2673, label: 2, bag_size: 2561
batch 39, loss: 2.8476, instance_loss: 1.1535, weighted_loss: 2.3393, label: 1, bag_size: 2727
batch 59, loss: 0.2210, instance_loss: 1.1650, weighted_loss: 0.5042, label: 1, bag_size: 3677
batch 79, loss: 0.5219, instance_loss: 0.5047, weighted_loss: 0.5167, label: 1, bag_size: 4599
batch 99, loss: 0.0385, instance_loss: 0.3531, weighted_loss: 0.1329, label: 2, bag_size: 5017
batch 119, loss: 0.4474, instance_loss: 0.5841, weighted_loss: 0.4884, label: 1, bag_size: 3009
batch 139, loss: 0.9124, instance_loss: 0.5829, weighted_loss: 0.8135, label: 0, bag_size: 7077
batch 159, loss: 0.3453, instance_loss: 0.4641, weighted_loss: 0.3810, label: 2, bag_size: 4056
batch 179, loss: 0.2787, instance_loss: 0.4875, weighted_loss: 0.3413, label: 1, bag_size: 440
batch 199, loss: 0.1489, instance_loss: 0.5354, weighted_loss: 0.2648, label: 2, bag_size: 2209
batch 219, loss: 0.1783, instance_loss: 0.2934, weighted_loss: 0.2128, label: 0, bag_size: 5377
batch 239, loss: 0.3517, instance_loss: 0.3457, weighted_loss: 0.3499, label: 2, bag_size: 2997
batch 259, loss: 0.3215, instance_loss: 0.6474, weighted_loss: 0.4193, label: 2, bag_size: 3604
batch 279, loss: 0.0100, instance_loss: 0.2684, weighted_loss: 0.0875, label: 1, bag_size: 4134
batch 299, loss: 0.7772, instance_loss: 0.7520, weighted_loss: 0.7696, label: 0, bag_size: 5585
batch 319, loss: 1.3625, instance_loss: 0.8746, weighted_loss: 1.2161, label: 1, bag_size: 3438
batch 339, loss: 0.7067, instance_loss: 0.6889, weighted_loss: 0.7014, label: 2, bag_size: 4096
batch 359, loss: 0.9743, instance_loss: 1.0187, weighted_loss: 0.9876, label: 1, bag_size: 4290
batch 379, loss: 0.6632, instance_loss: 1.1037, weighted_loss: 0.7953, label: 2, bag_size: 3299
batch 399, loss: 0.0843, instance_loss: 0.2468, weighted_loss: 0.1331, label: 2, bag_size: 3396
batch 419, loss: 0.1146, instance_loss: 0.1936, weighted_loss: 0.1383, label: 2, bag_size: 2049
batch 439, loss: 0.0390, instance_loss: 0.1297, weighted_loss: 0.0662, label: 2, bag_size: 4691
batch 459, loss: 0.1160, instance_loss: 0.2335, weighted_loss: 0.1513, label: 0, bag_size: 386
batch 479, loss: 1.0947, instance_loss: 0.7803, weighted_loss: 1.0004, label: 1, bag_size: 2481
batch 499, loss: 1.9204, instance_loss: 1.1983, weighted_loss: 1.7038, label: 0, bag_size: 1289
batch 519, loss: 0.3209, instance_loss: 0.3887, weighted_loss: 0.3412, label: 1, bag_size: 1807
batch 539, loss: 0.7635, instance_loss: 0.6680, weighted_loss: 0.7348, label: 0, bag_size: 3983
batch 559, loss: 0.6424, instance_loss: 0.5874, weighted_loss: 0.6259, label: 1, bag_size: 2945
batch 579, loss: 0.2127, instance_loss: 0.3298, weighted_loss: 0.2479, label: 0, bag_size: 4326
batch 599, loss: 0.3090, instance_loss: 0.4894, weighted_loss: 0.3631, label: 2, bag_size: 4535
batch 619, loss: 0.8943, instance_loss: 0.7653, weighted_loss: 0.8556, label: 2, bag_size: 4569
batch 639, loss: 1.1106, instance_loss: 1.2496, weighted_loss: 1.1523, label: 1, bag_size: 3596
batch 659, loss: 1.1411, instance_loss: 0.8525, weighted_loss: 1.0545, label: 1, bag_size: 4200
batch 679, loss: 0.8897, instance_loss: 0.6580, weighted_loss: 0.8202, label: 0, bag_size: 4351
batch 699, loss: 0.1941, instance_loss: 0.4366, weighted_loss: 0.2669, label: 1, bag_size: 5385
batch 719, loss: 1.6897, instance_loss: 0.7982, weighted_loss: 1.4223, label: 1, bag_size: 5035
batch 739, loss: 0.5368, instance_loss: 0.5745, weighted_loss: 0.5481, label: 2, bag_size: 4043


class 0 clustering acc 0.974496644295302: correct 17424/17880
class 1 clustering acc 0.2162751677852349: correct 1289/5960
Epoch: 15, train_loss: 0.6957, train_clustering_loss:  0.6118, train_error: 0.2980
class 0: acc 0.722007722007722, correct 187/259
class 1: acc 0.6374501992031872, correct 160/251
class 2: acc 0.7489361702127659, correct 176/235

Val Set, val_loss: 0.6224, val_error: 0.2553, auc: 0.8769
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.34308510638297873: correct 258/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.653005 --> 0.622371).  Saving model ...


batch 19, loss: 1.1480, instance_loss: 0.7488, weighted_loss: 1.0282, label: 0, bag_size: 3397
batch 39, loss: 1.7137, instance_loss: 1.1203, weighted_loss: 1.5357, label: 0, bag_size: 2915
batch 59, loss: 0.2206, instance_loss: 0.5430, weighted_loss: 0.3173, label: 2, bag_size: 3618
batch 79, loss: 0.2796, instance_loss: 0.3360, weighted_loss: 0.2965, label: 0, bag_size: 2897
batch 99, loss: 0.2943, instance_loss: 0.6117, weighted_loss: 0.3896, label: 2, bag_size: 4535
batch 119, loss: 2.3690, instance_loss: 1.6235, weighted_loss: 2.1454, label: 1, bag_size: 1477
batch 139, loss: 0.0760, instance_loss: 0.2450, weighted_loss: 0.1267, label: 2, bag_size: 5138
batch 159, loss: 0.4459, instance_loss: 0.6647, weighted_loss: 0.5115, label: 1, bag_size: 5532
batch 179, loss: 0.5712, instance_loss: 0.7153, weighted_loss: 0.6145, label: 1, bag_size: 667
batch 199, loss: 0.3105, instance_loss: 0.5607, weighted_loss: 0.3856, label: 2, bag_size: 4535
batch 219, loss: 0.0290, instance_loss: 0.1324, weighted_loss: 0.0600, label: 2, bag_size: 3285
batch 239, loss: 1.5174, instance_loss: 0.9743, weighted_loss: 1.3544, label: 1, bag_size: 5693
batch 259, loss: 0.3454, instance_loss: 0.4851, weighted_loss: 0.3873, label: 1, bag_size: 1042
batch 279, loss: 1.1690, instance_loss: 0.5571, weighted_loss: 0.9855, label: 0, bag_size: 4614
batch 299, loss: 0.0275, instance_loss: 0.2032, weighted_loss: 0.0802, label: 0, bag_size: 1744
batch 319, loss: 0.4122, instance_loss: 0.5505, weighted_loss: 0.4537, label: 2, bag_size: 4535
batch 339, loss: 0.2075, instance_loss: 0.4969, weighted_loss: 0.2943, label: 2, bag_size: 5037
batch 359, loss: 0.6571, instance_loss: 0.3161, weighted_loss: 0.5548, label: 0, bag_size: 3070
batch 379, loss: 0.0773, instance_loss: 0.1366, weighted_loss: 0.0951, label: 0, bag_size: 4071
batch 399, loss: 0.6575, instance_loss: 0.8411, weighted_loss: 0.7126, label: 1, bag_size: 683
batch 419, loss: 0.1948, instance_loss: 0.4210, weighted_loss: 0.2627, label: 0, bag_size: 4326
batch 439, loss: 0.0033, instance_loss: 0.2550, weighted_loss: 0.0788, label: 2, bag_size: 4497
batch 459, loss: 0.0166, instance_loss: 0.0583, weighted_loss: 0.0291, label: 0, bag_size: 7595
batch 479, loss: 0.1932, instance_loss: 0.2633, weighted_loss: 0.2142, label: 0, bag_size: 4157
batch 499, loss: 1.4130, instance_loss: 0.7494, weighted_loss: 1.2139, label: 2, bag_size: 5307
batch 519, loss: 0.6499, instance_loss: 0.5818, weighted_loss: 0.6295, label: 0, bag_size: 1245
batch 539, loss: 0.3547, instance_loss: 0.5572, weighted_loss: 0.4155, label: 0, bag_size: 4310
batch 559, loss: 0.5090, instance_loss: 0.6887, weighted_loss: 0.5629, label: 1, bag_size: 3396
batch 579, loss: 0.8294, instance_loss: 0.7313, weighted_loss: 0.8000, label: 1, bag_size: 2751
batch 599, loss: 0.4308, instance_loss: 0.4773, weighted_loss: 0.4448, label: 2, bag_size: 1103
batch 619, loss: 0.9511, instance_loss: 0.9072, weighted_loss: 0.9379, label: 0, bag_size: 4351
batch 639, loss: 0.4186, instance_loss: 0.5218, weighted_loss: 0.4496, label: 1, bag_size: 5532
batch 659, loss: 1.7760, instance_loss: 0.7913, weighted_loss: 1.4806, label: 2, bag_size: 909
batch 679, loss: 0.4519, instance_loss: 1.2055, weighted_loss: 0.6780, label: 2, bag_size: 22464
batch 699, loss: 1.1506, instance_loss: 0.8150, weighted_loss: 1.0499, label: 2, bag_size: 1050
batch 719, loss: 0.1759, instance_loss: 0.1449, weighted_loss: 0.1666, label: 2, bag_size: 2905
batch 739, loss: 0.0428, instance_loss: 0.3818, weighted_loss: 0.1445, label: 0, bag_size: 6182


class 0 clustering acc 0.971923937360179: correct 17378/17880
class 1 clustering acc 0.31828859060402687: correct 1897/5960
Epoch: 16, train_loss: 0.6386, train_clustering_loss:  0.5728, train_error: 0.2591
class 0: acc 0.7821011673151751, correct 201/257
class 1: acc 0.634453781512605, correct 151/238
class 2: acc 0.8, correct 200/250

Val Set, val_loss: 0.6456, val_error: 0.2234, auc: 0.8674
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.1901595744680851: correct 143/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1804, instance_loss: 0.1908, weighted_loss: 0.1835, label: 2, bag_size: 4203
batch 39, loss: 1.0643, instance_loss: 0.4963, weighted_loss: 0.8939, label: 1, bag_size: 1327
batch 59, loss: 0.5365, instance_loss: 0.2213, weighted_loss: 0.4419, label: 2, bag_size: 4691
batch 79, loss: 0.9385, instance_loss: 0.8547, weighted_loss: 0.9133, label: 1, bag_size: 3619
batch 99, loss: 0.3686, instance_loss: 0.5125, weighted_loss: 0.4117, label: 1, bag_size: 3460
batch 119, loss: 3.9716, instance_loss: 0.9249, weighted_loss: 3.0576, label: 0, bag_size: 2028
batch 139, loss: 0.5467, instance_loss: 0.7620, weighted_loss: 0.6113, label: 2, bag_size: 6644
batch 159, loss: 0.1784, instance_loss: 0.2856, weighted_loss: 0.2105, label: 0, bag_size: 6015
batch 179, loss: 0.2234, instance_loss: 0.3436, weighted_loss: 0.2594, label: 2, bag_size: 3172
batch 199, loss: 0.2648, instance_loss: 0.4918, weighted_loss: 0.3329, label: 1, bag_size: 1029
batch 219, loss: 0.0893, instance_loss: 0.1350, weighted_loss: 0.1030, label: 2, bag_size: 3285
batch 239, loss: 0.6588, instance_loss: 0.5867, weighted_loss: 0.6372, label: 1, bag_size: 2919
batch 259, loss: 1.6148, instance_loss: 0.8575, weighted_loss: 1.3876, label: 0, bag_size: 3709
batch 279, loss: 0.2271, instance_loss: 0.3241, weighted_loss: 0.2562, label: 0, bag_size: 2487
batch 299, loss: 0.4749, instance_loss: 0.4700, weighted_loss: 0.4734, label: 2, bag_size: 3396
batch 319, loss: 0.1482, instance_loss: 0.2726, weighted_loss: 0.1855, label: 2, bag_size: 2359
batch 339, loss: 1.0551, instance_loss: 0.5646, weighted_loss: 0.9079, label: 0, bag_size: 3475
batch 359, loss: 0.9334, instance_loss: 0.7406, weighted_loss: 0.8755, label: 0, bag_size: 5848
batch 379, loss: 0.1152, instance_loss: 0.2118, weighted_loss: 0.1442, label: 0, bag_size: 3690
batch 399, loss: 0.5504, instance_loss: 0.6214, weighted_loss: 0.5717, label: 0, bag_size: 3319
batch 419, loss: 0.6271, instance_loss: 0.9182, weighted_loss: 0.7144, label: 2, bag_size: 4571
batch 439, loss: 0.0511, instance_loss: 0.1524, weighted_loss: 0.0815, label: 0, bag_size: 1845
batch 459, loss: 0.9061, instance_loss: 0.6391, weighted_loss: 0.8260, label: 0, bag_size: 22822
batch 479, loss: 1.2226, instance_loss: 0.8635, weighted_loss: 1.1149, label: 0, bag_size: 1755
batch 499, loss: 0.8791, instance_loss: 0.5616, weighted_loss: 0.7838, label: 2, bag_size: 614
batch 519, loss: 1.3343, instance_loss: 0.5315, weighted_loss: 1.0935, label: 2, bag_size: 705
batch 539, loss: 0.4824, instance_loss: 0.9042, weighted_loss: 0.6089, label: 2, bag_size: 2486
batch 559, loss: 3.7336, instance_loss: 1.5840, weighted_loss: 3.0887, label: 1, bag_size: 4145
batch 579, loss: 0.4030, instance_loss: 0.3548, weighted_loss: 0.3885, label: 0, bag_size: 4228
batch 599, loss: 0.0353, instance_loss: 0.0955, weighted_loss: 0.0534, label: 0, bag_size: 2019
batch 619, loss: 0.4310, instance_loss: 0.4395, weighted_loss: 0.4335, label: 0, bag_size: 1795
batch 639, loss: 0.3732, instance_loss: 0.5539, weighted_loss: 0.4274, label: 1, bag_size: 368
batch 659, loss: 0.6753, instance_loss: 0.7053, weighted_loss: 0.6843, label: 1, bag_size: 2831
batch 679, loss: 0.6441, instance_loss: 0.6476, weighted_loss: 0.6451, label: 1, bag_size: 4694
batch 699, loss: 0.4223, instance_loss: 0.4187, weighted_loss: 0.4212, label: 1, bag_size: 779
batch 719, loss: 0.7176, instance_loss: 0.6498, weighted_loss: 0.6973, label: 1, bag_size: 5276
batch 739, loss: 0.8559, instance_loss: 0.7206, weighted_loss: 0.8153, label: 1, bag_size: 4187


class 0 clustering acc 0.9708053691275168: correct 17358/17880
class 1 clustering acc 0.32298657718120805: correct 1925/5960
Epoch: 17, train_loss: 0.6821, train_clustering_loss:  0.5817, train_error: 0.2685
class 0: acc 0.7651515151515151, correct 202/264
class 1: acc 0.6133333333333333, correct 138/225
class 2: acc 0.80078125, correct 205/256

Val Set, val_loss: 0.6220, val_error: 0.2553, auc: 0.8828
class 0 clustering acc 0.9844858156028369: correct 2221/2256
class 1 clustering acc 0.1276595744680851: correct 96/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.622371 --> 0.622038).  Saving model ...


batch 19, loss: 0.2725, instance_loss: 0.4477, weighted_loss: 0.3250, label: 0, bag_size: 5041
batch 39, loss: 0.7651, instance_loss: 0.5384, weighted_loss: 0.6971, label: 1, bag_size: 2859
batch 59, loss: 0.0467, instance_loss: 0.1502, weighted_loss: 0.0777, label: 2, bag_size: 3094
batch 79, loss: 0.0076, instance_loss: 0.3241, weighted_loss: 0.1026, label: 2, bag_size: 4497
batch 99, loss: 0.3887, instance_loss: 0.5764, weighted_loss: 0.4450, label: 2, bag_size: 3618
batch 119, loss: 0.3408, instance_loss: 0.5230, weighted_loss: 0.3954, label: 0, bag_size: 2257
batch 139, loss: 0.1505, instance_loss: 0.2698, weighted_loss: 0.1863, label: 1, bag_size: 3367
batch 159, loss: 0.0908, instance_loss: 0.1317, weighted_loss: 0.1031, label: 2, bag_size: 2905
batch 179, loss: 0.0537, instance_loss: 0.0986, weighted_loss: 0.0672, label: 2, bag_size: 1103
batch 199, loss: 0.6158, instance_loss: 0.7167, weighted_loss: 0.6461, label: 2, bag_size: 4569
batch 219, loss: 0.0125, instance_loss: 0.1076, weighted_loss: 0.0410, label: 0, bag_size: 1647
batch 239, loss: 4.5341, instance_loss: 1.9888, weighted_loss: 3.7705, label: 0, bag_size: 1886
batch 259, loss: 0.7146, instance_loss: 0.5843, weighted_loss: 0.6755, label: 1, bag_size: 6817
batch 279, loss: 1.0846, instance_loss: 0.8708, weighted_loss: 1.0204, label: 2, bag_size: 1543
batch 299, loss: 0.5610, instance_loss: 0.5004, weighted_loss: 0.5428, label: 2, bag_size: 5307
batch 319, loss: 0.9064, instance_loss: 0.7949, weighted_loss: 0.8730, label: 0, bag_size: 3675
batch 339, loss: 0.2878, instance_loss: 1.0076, weighted_loss: 0.5038, label: 2, bag_size: 3607
batch 359, loss: 0.0982, instance_loss: 0.2881, weighted_loss: 0.1552, label: 1, bag_size: 3043
batch 379, loss: 0.2913, instance_loss: 0.3873, weighted_loss: 0.3201, label: 0, bag_size: 4529
batch 399, loss: 0.2529, instance_loss: 0.3910, weighted_loss: 0.2943, label: 1, bag_size: 3460
batch 419, loss: 0.3347, instance_loss: 0.4227, weighted_loss: 0.3611, label: 0, bag_size: 3113
batch 439, loss: 0.0967, instance_loss: 0.1414, weighted_loss: 0.1101, label: 2, bag_size: 3094
batch 459, loss: 0.1273, instance_loss: 0.2193, weighted_loss: 0.1549, label: 0, bag_size: 3666
batch 479, loss: 0.7880, instance_loss: 0.8729, weighted_loss: 0.8135, label: 1, bag_size: 1066
batch 499, loss: 0.3419, instance_loss: 0.6492, weighted_loss: 0.4341, label: 2, bag_size: 5426
batch 519, loss: 0.2549, instance_loss: 0.3470, weighted_loss: 0.2825, label: 0, bag_size: 4865
batch 539, loss: 0.4268, instance_loss: 1.0512, weighted_loss: 0.6141, label: 2, bag_size: 5472
batch 559, loss: 0.3277, instance_loss: 0.2328, weighted_loss: 0.2992, label: 2, bag_size: 3176
batch 579, loss: 0.4854, instance_loss: 0.4508, weighted_loss: 0.4750, label: 0, bag_size: 5373
batch 599, loss: 0.5188, instance_loss: 0.5369, weighted_loss: 0.5242, label: 0, bag_size: 5646
batch 619, loss: 0.1063, instance_loss: 0.1131, weighted_loss: 0.1084, label: 2, bag_size: 6026
batch 639, loss: 0.0571, instance_loss: 0.2219, weighted_loss: 0.1065, label: 1, bag_size: 5018
batch 659, loss: 0.3834, instance_loss: 0.8306, weighted_loss: 0.5176, label: 0, bag_size: 889
batch 679, loss: 0.0368, instance_loss: 0.2549, weighted_loss: 0.1023, label: 1, bag_size: 3172
batch 699, loss: 2.4951, instance_loss: 0.9318, weighted_loss: 2.0261, label: 0, bag_size: 1910
batch 719, loss: 0.1347, instance_loss: 1.1566, weighted_loss: 0.4413, label: 0, bag_size: 1341
batch 739, loss: 0.1638, instance_loss: 0.5278, weighted_loss: 0.2730, label: 0, bag_size: 3219


class 0 clustering acc 0.9729306487695749: correct 17396/17880
class 1 clustering acc 0.31342281879194633: correct 1868/5960
Epoch: 18, train_loss: 0.6442, train_clustering_loss:  0.5652, train_error: 0.2752
class 0: acc 0.7537878787878788, correct 199/264
class 1: acc 0.6612903225806451, correct 164/248
class 2: acc 0.759656652360515, correct 177/233

Val Set, val_loss: 0.6123, val_error: 0.2553, auc: 0.8842
class 0 clustering acc 0.9782801418439716: correct 2207/2256
class 1 clustering acc 0.32313829787234044: correct 243/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (0.622038 --> 0.612330).  Saving model ...


batch 19, loss: 3.4030, instance_loss: 1.1223, weighted_loss: 2.7188, label: 1, bag_size: 32
batch 39, loss: 1.6720, instance_loss: 1.0133, weighted_loss: 1.4744, label: 2, bag_size: 223
batch 59, loss: 1.7045, instance_loss: 0.9135, weighted_loss: 1.4672, label: 1, bag_size: 2425
batch 79, loss: 0.2424, instance_loss: 0.4178, weighted_loss: 0.2950, label: 0, bag_size: 3289
batch 99, loss: 0.8003, instance_loss: 0.7677, weighted_loss: 0.7905, label: 1, bag_size: 2671
batch 119, loss: 0.0412, instance_loss: 0.2400, weighted_loss: 0.1008, label: 0, bag_size: 2339
batch 139, loss: 0.2811, instance_loss: 0.2298, weighted_loss: 0.2657, label: 2, bag_size: 88
batch 159, loss: 0.2605, instance_loss: 0.7640, weighted_loss: 0.4115, label: 2, bag_size: 3299
batch 179, loss: 0.0837, instance_loss: 0.3311, weighted_loss: 0.1579, label: 2, bag_size: 4535
batch 199, loss: 1.1164, instance_loss: 0.8852, weighted_loss: 1.0470, label: 0, bag_size: 3075
batch 219, loss: 0.3539, instance_loss: 0.5550, weighted_loss: 0.4143, label: 0, bag_size: 5646
batch 239, loss: 0.0105, instance_loss: 0.0700, weighted_loss: 0.0284, label: 2, bag_size: 4856
batch 259, loss: 0.1819, instance_loss: 0.2888, weighted_loss: 0.2140, label: 0, bag_size: 5236
batch 279, loss: 0.9757, instance_loss: 0.9650, weighted_loss: 0.9725, label: 1, bag_size: 4940
batch 299, loss: 0.2416, instance_loss: 0.6349, weighted_loss: 0.3596, label: 1, bag_size: 8482
batch 319, loss: 1.1384, instance_loss: 0.9594, weighted_loss: 1.0847, label: 1, bag_size: 4940
batch 339, loss: 0.2520, instance_loss: 0.6391, weighted_loss: 0.3682, label: 0, bag_size: 1814
batch 359, loss: 0.1098, instance_loss: 0.4347, weighted_loss: 0.2073, label: 0, bag_size: 4529
batch 379, loss: 0.1097, instance_loss: 0.4342, weighted_loss: 0.2071, label: 0, bag_size: 5459
batch 399, loss: 0.2497, instance_loss: 0.3529, weighted_loss: 0.2806, label: 0, bag_size: 3797
batch 419, loss: 0.0866, instance_loss: 0.3596, weighted_loss: 0.1685, label: 1, bag_size: 2809
batch 439, loss: 0.2576, instance_loss: 0.2559, weighted_loss: 0.2571, label: 2, bag_size: 3583
batch 459, loss: 0.0368, instance_loss: 0.1565, weighted_loss: 0.0727, label: 2, bag_size: 2209
batch 479, loss: 1.0369, instance_loss: 0.5217, weighted_loss: 0.8823, label: 2, bag_size: 4179
batch 499, loss: 0.1475, instance_loss: 0.8748, weighted_loss: 0.3657, label: 1, bag_size: 3677
batch 519, loss: 0.4451, instance_loss: 0.7352, weighted_loss: 0.5321, label: 2, bag_size: 3604
batch 539, loss: 1.3305, instance_loss: 0.7483, weighted_loss: 1.1558, label: 0, bag_size: 2915
batch 559, loss: 0.0956, instance_loss: 0.2762, weighted_loss: 0.1498, label: 2, bag_size: 3227
batch 579, loss: 0.0635, instance_loss: 0.2959, weighted_loss: 0.1332, label: 2, bag_size: 3778
batch 599, loss: 0.4784, instance_loss: 0.4005, weighted_loss: 0.4550, label: 0, bag_size: 3310
batch 619, loss: 0.0415, instance_loss: 0.1565, weighted_loss: 0.0760, label: 2, bag_size: 4569
batch 639, loss: 0.5022, instance_loss: 0.5747, weighted_loss: 0.5240, label: 2, bag_size: 2031
batch 659, loss: 0.2913, instance_loss: 0.3196, weighted_loss: 0.2998, label: 1, bag_size: 3009
batch 679, loss: 0.2697, instance_loss: 0.4537, weighted_loss: 0.3249, label: 1, bag_size: 2859
batch 699, loss: 0.3765, instance_loss: 0.3715, weighted_loss: 0.3750, label: 1, bag_size: 3755
batch 719, loss: 0.6048, instance_loss: 1.0584, weighted_loss: 0.7409, label: 0, bag_size: 1601
batch 739, loss: 0.1864, instance_loss: 0.3117, weighted_loss: 0.2240, label: 0, bag_size: 5915


class 0 clustering acc 0.974496644295302: correct 17424/17880
class 1 clustering acc 0.34043624161073827: correct 2029/5960
Epoch: 19, train_loss: 0.5902, train_clustering_loss:  0.5463, train_error: 0.2483
class 0: acc 0.764, correct 191/250
class 1: acc 0.6638655462184874, correct 158/238
class 2: acc 0.8210116731517509, correct 211/257

Val Set, val_loss: 0.6814, val_error: 0.2553, auc: 0.8737
class 0 clustering acc 0.9689716312056738: correct 2186/2256
class 1 clustering acc 0.19414893617021275: correct 146/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1765, instance_loss: 0.3379, weighted_loss: 0.2249, label: 1, bag_size: 3333
batch 39, loss: 0.0993, instance_loss: 0.2290, weighted_loss: 0.1382, label: 1, bag_size: 3333
batch 59, loss: 0.0664, instance_loss: 0.1057, weighted_loss: 0.0782, label: 0, bag_size: 4325
batch 79, loss: 0.6182, instance_loss: 0.8963, weighted_loss: 0.7016, label: 0, bag_size: 4494
batch 99, loss: 0.3144, instance_loss: 0.4127, weighted_loss: 0.3439, label: 0, bag_size: 1795
batch 119, loss: 0.0912, instance_loss: 0.3699, weighted_loss: 0.1748, label: 0, bag_size: 5226
batch 139, loss: 0.5678, instance_loss: 0.4314, weighted_loss: 0.5269, label: 0, bag_size: 3864
batch 159, loss: 1.4611, instance_loss: 1.4013, weighted_loss: 1.4432, label: 1, bag_size: 1549
batch 179, loss: 0.3468, instance_loss: 0.3897, weighted_loss: 0.3597, label: 1, bag_size: 3991
batch 199, loss: 0.5871, instance_loss: 0.7846, weighted_loss: 0.6463, label: 0, bag_size: 1170
batch 219, loss: 0.4178, instance_loss: 0.8240, weighted_loss: 0.5397, label: 0, bag_size: 1352
batch 239, loss: 0.1103, instance_loss: 0.3165, weighted_loss: 0.1722, label: 0, bag_size: 1647
batch 259, loss: 0.5304, instance_loss: 0.7349, weighted_loss: 0.5918, label: 1, bag_size: 5512
batch 279, loss: 0.0420, instance_loss: 0.2432, weighted_loss: 0.1024, label: 1, bag_size: 2809
batch 299, loss: 0.4813, instance_loss: 0.6149, weighted_loss: 0.5214, label: 2, bag_size: 3534
batch 319, loss: 0.0554, instance_loss: 0.4415, weighted_loss: 0.1712, label: 0, bag_size: 3820
batch 339, loss: 2.2699, instance_loss: 1.2896, weighted_loss: 1.9758, label: 2, bag_size: 724
batch 359, loss: 0.1483, instance_loss: 0.4001, weighted_loss: 0.2238, label: 2, bag_size: 2209
batch 379, loss: 0.1340, instance_loss: 0.4682, weighted_loss: 0.2342, label: 1, bag_size: 3398
batch 399, loss: 0.0693, instance_loss: 0.2857, weighted_loss: 0.1342, label: 1, bag_size: 712
batch 419, loss: 0.5052, instance_loss: 0.3812, weighted_loss: 0.4680, label: 2, bag_size: 2561
batch 439, loss: 0.1482, instance_loss: 0.2499, weighted_loss: 0.1787, label: 2, bag_size: 597
batch 459, loss: 0.1173, instance_loss: 0.3082, weighted_loss: 0.1745, label: 0, bag_size: 2884
batch 479, loss: 0.7809, instance_loss: 0.5034, weighted_loss: 0.6976, label: 2, bag_size: 3172
batch 499, loss: 1.3855, instance_loss: 1.0898, weighted_loss: 1.2968, label: 1, bag_size: 3533
batch 519, loss: 1.0376, instance_loss: 0.4571, weighted_loss: 0.8635, label: 2, bag_size: 2031
batch 539, loss: 0.0754, instance_loss: 0.1478, weighted_loss: 0.0971, label: 2, bag_size: 4302
batch 559, loss: 0.1751, instance_loss: 0.3932, weighted_loss: 0.2405, label: 0, bag_size: 3864
batch 579, loss: 0.6114, instance_loss: 0.6490, weighted_loss: 0.6226, label: 0, bag_size: 5011
batch 599, loss: 1.7821, instance_loss: 1.1667, weighted_loss: 1.5975, label: 1, bag_size: 3424
batch 619, loss: 1.1132, instance_loss: 0.9219, weighted_loss: 1.0558, label: 2, bag_size: 1050
batch 639, loss: 0.5118, instance_loss: 0.4852, weighted_loss: 0.5038, label: 1, bag_size: 2009
batch 659, loss: 0.9406, instance_loss: 0.7180, weighted_loss: 0.8738, label: 1, bag_size: 4940
batch 679, loss: 0.6201, instance_loss: 0.4402, weighted_loss: 0.5661, label: 1, bag_size: 4869
batch 699, loss: 0.5060, instance_loss: 0.6136, weighted_loss: 0.5383, label: 0, bag_size: 2579
batch 719, loss: 0.1090, instance_loss: 0.0995, weighted_loss: 0.1061, label: 2, bag_size: 4088
batch 739, loss: 0.1378, instance_loss: 0.4606, weighted_loss: 0.2347, label: 2, bag_size: 3227


class 0 clustering acc 0.9720917225950783: correct 17381/17880
class 1 clustering acc 0.3276845637583893: correct 1953/5960
Epoch: 20, train_loss: 0.6024, train_clustering_loss:  0.5541, train_error: 0.2416
class 0: acc 0.7207207207207207, correct 160/222
class 1: acc 0.7306273062730627, correct 198/271
class 2: acc 0.8214285714285714, correct 207/252

Val Set, val_loss: 1.2064, val_error: 0.5106, auc: 0.8412
class 0 clustering acc 0.9268617021276596: correct 2091/2256
class 1 clustering acc 0.21941489361702127: correct 165/752
class 0: acc 0.3076923076923077, correct 16/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0791, instance_loss: 0.2881, weighted_loss: 0.1418, label: 1, bag_size: 210
batch 39, loss: 0.0476, instance_loss: 0.1298, weighted_loss: 0.0722, label: 2, bag_size: 4203
batch 59, loss: 0.6863, instance_loss: 0.6449, weighted_loss: 0.6739, label: 1, bag_size: 3100
batch 79, loss: 0.9421, instance_loss: 0.9338, weighted_loss: 0.9396, label: 0, bag_size: 4310
batch 99, loss: 0.2411, instance_loss: 0.3900, weighted_loss: 0.2858, label: 0, bag_size: 1495
batch 119, loss: 1.3014, instance_loss: 1.1279, weighted_loss: 1.2493, label: 1, bag_size: 2751
batch 139, loss: 0.2031, instance_loss: 0.6470, weighted_loss: 0.3363, label: 2, bag_size: 3618
batch 159, loss: 0.1931, instance_loss: 0.3398, weighted_loss: 0.2371, label: 0, bag_size: 4734
batch 179, loss: 0.0584, instance_loss: 0.4013, weighted_loss: 0.1613, label: 2, bag_size: 4141
batch 199, loss: 0.0383, instance_loss: 0.0800, weighted_loss: 0.0508, label: 2, bag_size: 3583
batch 219, loss: 2.7520, instance_loss: 1.1238, weighted_loss: 2.2635, label: 2, bag_size: 223
batch 239, loss: 1.3643, instance_loss: 0.7235, weighted_loss: 1.1720, label: 0, bag_size: 3525
batch 259, loss: 0.6902, instance_loss: 0.2876, weighted_loss: 0.5694, label: 2, bag_size: 3172
batch 279, loss: 0.0561, instance_loss: 0.1803, weighted_loss: 0.0934, label: 0, bag_size: 3754
batch 299, loss: 0.3873, instance_loss: 0.4348, weighted_loss: 0.4015, label: 1, bag_size: 3438
batch 319, loss: 0.0380, instance_loss: 0.2704, weighted_loss: 0.1077, label: 0, bag_size: 4783
batch 339, loss: 0.3735, instance_loss: 0.7171, weighted_loss: 0.4766, label: 1, bag_size: 4534
batch 359, loss: 0.1352, instance_loss: 0.2626, weighted_loss: 0.1734, label: 0, bag_size: 5570
batch 379, loss: 0.6870, instance_loss: 0.9258, weighted_loss: 0.7586, label: 1, bag_size: 3619
batch 399, loss: 0.2559, instance_loss: 0.2688, weighted_loss: 0.2598, label: 0, bag_size: 3936
batch 419, loss: 0.3954, instance_loss: 0.7126, weighted_loss: 0.4906, label: 2, bag_size: 3746
batch 439, loss: 0.5572, instance_loss: 0.6587, weighted_loss: 0.5876, label: 1, bag_size: 3391
batch 459, loss: 0.0821, instance_loss: 0.1795, weighted_loss: 0.1113, label: 0, bag_size: 1947
batch 479, loss: 0.2612, instance_loss: 0.7077, weighted_loss: 0.3951, label: 0, bag_size: 3594
batch 499, loss: 0.4693, instance_loss: 0.9356, weighted_loss: 0.6092, label: 0, bag_size: 5226
batch 519, loss: 0.0229, instance_loss: 0.1160, weighted_loss: 0.0508, label: 2, bag_size: 6148
batch 539, loss: 0.0027, instance_loss: 0.0203, weighted_loss: 0.0080, label: 2, bag_size: 4910
batch 559, loss: 0.3530, instance_loss: 0.4559, weighted_loss: 0.3838, label: 2, bag_size: 3534
batch 579, loss: 2.0080, instance_loss: 0.7532, weighted_loss: 1.6315, label: 2, bag_size: 5307
batch 599, loss: 0.6495, instance_loss: 0.4912, weighted_loss: 0.6020, label: 0, bag_size: 3701
batch 619, loss: 0.1041, instance_loss: 0.1561, weighted_loss: 0.1197, label: 2, bag_size: 4372
batch 639, loss: 0.4321, instance_loss: 0.2245, weighted_loss: 0.3698, label: 0, bag_size: 5146
batch 659, loss: 0.1305, instance_loss: 0.2740, weighted_loss: 0.1736, label: 0, bag_size: 1883
batch 679, loss: 0.4274, instance_loss: 0.5132, weighted_loss: 0.4531, label: 2, bag_size: 2031
batch 699, loss: 0.2149, instance_loss: 0.2112, weighted_loss: 0.2138, label: 2, bag_size: 3176
batch 719, loss: 0.8814, instance_loss: 0.8702, weighted_loss: 0.8781, label: 1, bag_size: 1854
batch 739, loss: 0.4440, instance_loss: 0.7143, weighted_loss: 0.5251, label: 1, bag_size: 6025


class 0 clustering acc 0.9663870246085011: correct 17279/17880
class 1 clustering acc 0.38104026845637584: correct 2271/5960
Epoch: 21, train_loss: 0.5939, train_clustering_loss:  0.5522, train_error: 0.2416
class 0: acc 0.78515625, correct 201/256
class 1: acc 0.6595744680851063, correct 155/235
class 2: acc 0.8228346456692913, correct 209/254

Val Set, val_loss: 0.6042, val_error: 0.2340, auc: 0.8877
class 0 clustering acc 0.9840425531914894: correct 2220/2256
class 1 clustering acc 0.24601063829787234: correct 185/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.612330 --> 0.604235).  Saving model ...


batch 19, loss: 0.2559, instance_loss: 0.3211, weighted_loss: 0.2755, label: 2, bag_size: 2359
batch 39, loss: 0.0009, instance_loss: 0.1253, weighted_loss: 0.0382, label: 2, bag_size: 2422
batch 59, loss: 0.0089, instance_loss: 0.0922, weighted_loss: 0.0339, label: 2, bag_size: 4910
batch 79, loss: 0.1694, instance_loss: 0.3051, weighted_loss: 0.2101, label: 0, bag_size: 640
batch 99, loss: 1.3064, instance_loss: 0.8854, weighted_loss: 1.1801, label: 1, bag_size: 5873
batch 119, loss: 0.2750, instance_loss: 0.4076, weighted_loss: 0.3148, label: 0, bag_size: 1545
batch 139, loss: 0.7082, instance_loss: 0.8033, weighted_loss: 0.7367, label: 0, bag_size: 2153
batch 159, loss: 0.1624, instance_loss: 0.2756, weighted_loss: 0.1964, label: 0, bag_size: 8611
batch 179, loss: 2.2662, instance_loss: 0.9165, weighted_loss: 1.8613, label: 2, bag_size: 909
batch 199, loss: 0.1383, instance_loss: 0.2020, weighted_loss: 0.1574, label: 2, bag_size: 2481
batch 219, loss: 0.1986, instance_loss: 0.3910, weighted_loss: 0.2563, label: 0, bag_size: 829
batch 239, loss: 0.0121, instance_loss: 0.0404, weighted_loss: 0.0206, label: 2, bag_size: 6148
batch 259, loss: 0.4239, instance_loss: 0.5415, weighted_loss: 0.4592, label: 0, bag_size: 1373
batch 279, loss: 1.7922, instance_loss: 1.2550, weighted_loss: 1.6310, label: 1, bag_size: 2852
batch 299, loss: 0.2812, instance_loss: 0.3557, weighted_loss: 0.3036, label: 2, bag_size: 3583
batch 319, loss: 0.1357, instance_loss: 0.2413, weighted_loss: 0.1674, label: 0, bag_size: 3936
batch 339, loss: 0.1505, instance_loss: 0.2386, weighted_loss: 0.1769, label: 0, bag_size: 702
batch 359, loss: 0.3706, instance_loss: 0.3976, weighted_loss: 0.3787, label: 0, bag_size: 3532
batch 379, loss: 0.8895, instance_loss: 0.7607, weighted_loss: 0.8508, label: 0, bag_size: 3711
batch 399, loss: 0.0555, instance_loss: 0.2262, weighted_loss: 0.1067, label: 0, bag_size: 3666
batch 419, loss: 1.8930, instance_loss: 0.5731, weighted_loss: 1.4970, label: 0, bag_size: 3402
batch 439, loss: 0.4460, instance_loss: 1.2475, weighted_loss: 0.6865, label: 2, bag_size: 4241
batch 459, loss: 0.0823, instance_loss: 0.1261, weighted_loss: 0.0955, label: 2, bag_size: 4043
batch 479, loss: 0.7251, instance_loss: 0.4609, weighted_loss: 0.6458, label: 0, bag_size: 6285
batch 499, loss: 0.6019, instance_loss: 0.8126, weighted_loss: 0.6651, label: 1, bag_size: 5696
batch 519, loss: 0.2640, instance_loss: 0.6195, weighted_loss: 0.3707, label: 2, bag_size: 4132
batch 539, loss: 0.0932, instance_loss: 0.3203, weighted_loss: 0.1613, label: 0, bag_size: 6285
batch 559, loss: 0.4045, instance_loss: 0.8171, weighted_loss: 0.5283, label: 2, bag_size: 6148
batch 579, loss: 0.9211, instance_loss: 0.9991, weighted_loss: 0.9445, label: 2, bag_size: 4179
batch 599, loss: 0.7171, instance_loss: 0.7170, weighted_loss: 0.7171, label: 0, bag_size: 4416
batch 619, loss: 2.6796, instance_loss: 1.1823, weighted_loss: 2.2304, label: 1, bag_size: 4145
batch 639, loss: 0.4132, instance_loss: 0.5716, weighted_loss: 0.4607, label: 1, bag_size: 3391
batch 659, loss: 0.6536, instance_loss: 0.4947, weighted_loss: 0.6059, label: 1, bag_size: 2753
batch 679, loss: 0.0000, instance_loss: 0.2194, weighted_loss: 0.0658, label: 0, bag_size: 4918
batch 699, loss: 0.3694, instance_loss: 0.7497, weighted_loss: 0.4834, label: 0, bag_size: 4509
batch 719, loss: 1.9674, instance_loss: 1.0090, weighted_loss: 1.6799, label: 0, bag_size: 13770
batch 739, loss: 0.1144, instance_loss: 0.3465, weighted_loss: 0.1840, label: 2, bag_size: 3210


class 0 clustering acc 0.9720357941834452: correct 17380/17880
class 1 clustering acc 0.3201342281879195: correct 1908/5960
Epoch: 22, train_loss: 0.6179, train_clustering_loss:  0.5646, train_error: 0.2510
class 0: acc 0.756, correct 189/250
class 1: acc 0.6779661016949152, correct 160/236
class 2: acc 0.806949806949807, correct 209/259

Val Set, val_loss: 0.7836, val_error: 0.3298, auc: 0.8675
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.1702127659574468: correct 128/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2102, instance_loss: 1.0939, weighted_loss: 1.8753, label: 2, bag_size: 4316
batch 39, loss: 1.8517, instance_loss: 1.1999, weighted_loss: 1.6561, label: 0, bag_size: 4145
batch 59, loss: 0.1262, instance_loss: 0.3675, weighted_loss: 0.1986, label: 0, bag_size: 4547
batch 79, loss: 0.5038, instance_loss: 0.6001, weighted_loss: 0.5327, label: 2, bag_size: 3112
batch 99, loss: 1.0498, instance_loss: 0.7424, weighted_loss: 0.9576, label: 1, bag_size: 3533
batch 119, loss: 0.2443, instance_loss: 0.3246, weighted_loss: 0.2684, label: 2, bag_size: 4691
batch 139, loss: 0.2977, instance_loss: 0.5609, weighted_loss: 0.3766, label: 0, bag_size: 2189
batch 159, loss: 0.5502, instance_loss: 0.5384, weighted_loss: 0.5467, label: 1, bag_size: 712
batch 179, loss: 0.0675, instance_loss: 0.1718, weighted_loss: 0.0988, label: 0, bag_size: 4529
batch 199, loss: 0.6641, instance_loss: 0.8961, weighted_loss: 0.7337, label: 0, bag_size: 3841
batch 219, loss: 1.2774, instance_loss: 0.7150, weighted_loss: 1.1087, label: 1, bag_size: 1906
batch 239, loss: 0.1799, instance_loss: 0.2127, weighted_loss: 0.1897, label: 2, bag_size: 2049
batch 259, loss: 0.7420, instance_loss: 0.9359, weighted_loss: 0.8001, label: 0, bag_size: 1245
batch 279, loss: 0.1779, instance_loss: 0.2674, weighted_loss: 0.2047, label: 2, bag_size: 3176
batch 299, loss: 0.1257, instance_loss: 0.3481, weighted_loss: 0.1924, label: 2, bag_size: 4302
batch 319, loss: 0.1039, instance_loss: 0.2225, weighted_loss: 0.1395, label: 1, bag_size: 5086
batch 339, loss: 1.2304, instance_loss: 0.7319, weighted_loss: 1.0809, label: 0, bag_size: 726
batch 359, loss: 0.7438, instance_loss: 0.8350, weighted_loss: 0.7712, label: 1, bag_size: 5926
batch 379, loss: 0.6530, instance_loss: 0.3849, weighted_loss: 0.5725, label: 2, bag_size: 614
batch 399, loss: 1.3618, instance_loss: 1.2270, weighted_loss: 1.3214, label: 1, bag_size: 296
batch 419, loss: 0.5327, instance_loss: 0.8947, weighted_loss: 0.6413, label: 1, bag_size: 667
batch 439, loss: 0.4702, instance_loss: 0.6079, weighted_loss: 0.5115, label: 1, bag_size: 2921
batch 459, loss: 0.3162, instance_loss: 0.4137, weighted_loss: 0.3455, label: 0, bag_size: 999
batch 479, loss: 0.0975, instance_loss: 0.1345, weighted_loss: 0.1086, label: 2, bag_size: 2905
batch 499, loss: 4.5477, instance_loss: 1.9144, weighted_loss: 3.7577, label: 1, bag_size: 6717
batch 519, loss: 0.0107, instance_loss: 0.6787, weighted_loss: 0.2111, label: 1, bag_size: 5756
batch 539, loss: 0.1897, instance_loss: 0.2988, weighted_loss: 0.2224, label: 1, bag_size: 8802
batch 559, loss: 0.3985, instance_loss: 0.4203, weighted_loss: 0.4050, label: 0, bag_size: 702
batch 579, loss: 0.1616, instance_loss: 0.3825, weighted_loss: 0.2279, label: 2, bag_size: 3396
batch 599, loss: 0.2685, instance_loss: 0.4265, weighted_loss: 0.3159, label: 2, bag_size: 5037
batch 619, loss: 0.3880, instance_loss: 0.1508, weighted_loss: 0.3168, label: 2, bag_size: 88
batch 639, loss: 0.8180, instance_loss: 0.8520, weighted_loss: 0.8282, label: 0, bag_size: 3841
batch 659, loss: 0.0305, instance_loss: 0.1245, weighted_loss: 0.0587, label: 0, bag_size: 1132
batch 679, loss: 1.3556, instance_loss: 0.7345, weighted_loss: 1.1693, label: 2, bag_size: 909
batch 699, loss: 0.7298, instance_loss: 0.6086, weighted_loss: 0.6934, label: 1, bag_size: 3438
batch 719, loss: 0.8717, instance_loss: 0.5581, weighted_loss: 0.7776, label: 0, bag_size: 5041
batch 739, loss: 0.1015, instance_loss: 0.0730, weighted_loss: 0.0930, label: 2, bag_size: 5138


class 0 clustering acc 0.9717002237136465: correct 17374/17880
class 1 clustering acc 0.363758389261745: correct 2168/5960
Epoch: 23, train_loss: 0.5861, train_clustering_loss:  0.5404, train_error: 0.2403
class 0: acc 0.7862595419847328, correct 206/262
class 1: acc 0.6419213973799127, correct 147/229
class 2: acc 0.8385826771653543, correct 213/254

Val Set, val_loss: 0.7339, val_error: 0.2979, auc: 0.8724
class 0 clustering acc 0.9530141843971631: correct 2150/2256
class 1 clustering acc 0.28058510638297873: correct 211/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4333, instance_loss: 0.4404, weighted_loss: 0.4355, label: 1, bag_size: 3367
batch 39, loss: 0.0198, instance_loss: 0.0725, weighted_loss: 0.0356, label: 0, bag_size: 5795
batch 59, loss: 0.0254, instance_loss: 0.0965, weighted_loss: 0.0467, label: 0, bag_size: 2825
batch 79, loss: 1.0660, instance_loss: 0.8358, weighted_loss: 0.9970, label: 0, bag_size: 1762
batch 99, loss: 0.5586, instance_loss: 0.4867, weighted_loss: 0.5370, label: 0, bag_size: 2983
batch 119, loss: 1.3217, instance_loss: 1.3019, weighted_loss: 1.3157, label: 2, bag_size: 3299
batch 139, loss: 0.3883, instance_loss: 0.6277, weighted_loss: 0.4601, label: 0, bag_size: 5011
batch 159, loss: 0.0460, instance_loss: 0.1161, weighted_loss: 0.0671, label: 2, bag_size: 4088
batch 179, loss: 0.2875, instance_loss: 0.4514, weighted_loss: 0.3366, label: 1, bag_size: 14449
batch 199, loss: 0.7143, instance_loss: 0.7332, weighted_loss: 0.7200, label: 1, bag_size: 3261
batch 219, loss: 0.0025, instance_loss: 0.0432, weighted_loss: 0.0147, label: 1, bag_size: 460
batch 239, loss: 1.5891, instance_loss: 0.9519, weighted_loss: 1.3980, label: 0, bag_size: 272
batch 259, loss: 0.0428, instance_loss: 0.0858, weighted_loss: 0.0557, label: 2, bag_size: 4555
batch 279, loss: 0.1822, instance_loss: 0.1407, weighted_loss: 0.1697, label: 2, bag_size: 3583
batch 299, loss: 0.5695, instance_loss: 0.5797, weighted_loss: 0.5726, label: 1, bag_size: 2998
batch 319, loss: 0.3123, instance_loss: 0.5269, weighted_loss: 0.3767, label: 1, bag_size: 5696
batch 339, loss: 0.8148, instance_loss: 0.6195, weighted_loss: 0.7562, label: 1, bag_size: 1854
batch 359, loss: 1.1458, instance_loss: 0.7697, weighted_loss: 1.0330, label: 1, bag_size: 1854
batch 379, loss: 1.9375, instance_loss: 1.1476, weighted_loss: 1.7005, label: 2, bag_size: 7607
batch 399, loss: 0.1275, instance_loss: 0.4125, weighted_loss: 0.2130, label: 1, bag_size: 3558
batch 419, loss: 0.2327, instance_loss: 0.4526, weighted_loss: 0.2987, label: 1, bag_size: 2962
batch 439, loss: 0.3313, instance_loss: 0.4916, weighted_loss: 0.3794, label: 0, bag_size: 3833
batch 459, loss: 0.6552, instance_loss: 0.7574, weighted_loss: 0.6859, label: 2, bag_size: 4291
batch 479, loss: 0.3733, instance_loss: 0.4005, weighted_loss: 0.3814, label: 1, bag_size: 3009
batch 499, loss: 0.8799, instance_loss: 0.5910, weighted_loss: 0.7932, label: 0, bag_size: 893
batch 519, loss: 1.7482, instance_loss: 1.1165, weighted_loss: 1.5587, label: 1, bag_size: 6942
batch 539, loss: 0.3496, instance_loss: 0.6469, weighted_loss: 0.4388, label: 1, bag_size: 2055
batch 559, loss: 0.5919, instance_loss: 0.6396, weighted_loss: 0.6062, label: 1, bag_size: 1595
batch 579, loss: 0.3148, instance_loss: 0.3763, weighted_loss: 0.3332, label: 0, bag_size: 4648
batch 599, loss: 0.0283, instance_loss: 0.2025, weighted_loss: 0.0806, label: 0, bag_size: 3872
batch 619, loss: 0.3678, instance_loss: 0.3450, weighted_loss: 0.3610, label: 0, bag_size: 7177
batch 639, loss: 0.0191, instance_loss: 0.0769, weighted_loss: 0.0364, label: 2, bag_size: 2254
batch 659, loss: 0.0795, instance_loss: 0.2444, weighted_loss: 0.1290, label: 0, bag_size: 4479
batch 679, loss: 2.1270, instance_loss: 1.1220, weighted_loss: 1.8255, label: 1, bag_size: 2481
batch 699, loss: 1.5821, instance_loss: 1.0479, weighted_loss: 1.4218, label: 2, bag_size: 3274
batch 719, loss: 0.2438, instance_loss: 0.4682, weighted_loss: 0.3111, label: 0, bag_size: 4310
batch 739, loss: 0.0957, instance_loss: 0.4234, weighted_loss: 0.1940, label: 1, bag_size: 5696


class 0 clustering acc 0.9651006711409396: correct 17256/17880
class 1 clustering acc 0.3713087248322148: correct 2213/5960
Epoch: 24, train_loss: 0.5868, train_clustering_loss:  0.5681, train_error: 0.2430
class 0: acc 0.7782426778242678, correct 186/239
class 1: acc 0.7072243346007605, correct 186/263
class 2: acc 0.7901234567901234, correct 192/243

Val Set, val_loss: 0.7034, val_error: 0.2872, auc: 0.8705
class 0 clustering acc 0.9778368794326241: correct 2206/2256
class 1 clustering acc 0.21808510638297873: correct 164/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0630, instance_loss: 0.3226, weighted_loss: 0.1409, label: 0, bag_size: 4865
batch 39, loss: 0.1413, instance_loss: 0.2951, weighted_loss: 0.1875, label: 2, bag_size: 2359
batch 59, loss: 0.1552, instance_loss: 0.2465, weighted_loss: 0.1826, label: 0, bag_size: 2479
batch 79, loss: 0.4294, instance_loss: 0.2714, weighted_loss: 0.3820, label: 0, bag_size: 4614
batch 99, loss: 0.0850, instance_loss: 0.2408, weighted_loss: 0.1318, label: 2, bag_size: 5011
batch 119, loss: 0.5850, instance_loss: 0.6946, weighted_loss: 0.6179, label: 1, bag_size: 3296
batch 139, loss: 1.1102, instance_loss: 1.0544, weighted_loss: 1.0935, label: 0, bag_size: 893
batch 159, loss: 0.0922, instance_loss: 0.3219, weighted_loss: 0.1611, label: 0, bag_size: 5646
batch 179, loss: 0.3178, instance_loss: 0.4673, weighted_loss: 0.3627, label: 1, bag_size: 2453
batch 199, loss: 0.1095, instance_loss: 0.3546, weighted_loss: 0.1830, label: 1, bag_size: 3493
batch 219, loss: 0.8348, instance_loss: 0.7650, weighted_loss: 0.8139, label: 2, bag_size: 4179
batch 239, loss: 1.5817, instance_loss: 1.0271, weighted_loss: 1.4153, label: 1, bag_size: 3399
batch 259, loss: 0.7095, instance_loss: 0.4404, weighted_loss: 0.6288, label: 2, bag_size: 597
batch 279, loss: 0.7488, instance_loss: 0.5402, weighted_loss: 0.6862, label: 1, bag_size: 3221
batch 299, loss: 0.0764, instance_loss: 0.3669, weighted_loss: 0.1635, label: 0, bag_size: 4794
batch 319, loss: 0.0207, instance_loss: 0.0844, weighted_loss: 0.0398, label: 0, bag_size: 5757
batch 339, loss: 0.0034, instance_loss: 0.0815, weighted_loss: 0.0268, label: 0, bag_size: 3438
batch 359, loss: 0.0254, instance_loss: 0.1333, weighted_loss: 0.0578, label: 0, bag_size: 3641
batch 379, loss: 0.3910, instance_loss: 0.5208, weighted_loss: 0.4299, label: 0, bag_size: 4347
batch 399, loss: 1.9994, instance_loss: 1.3460, weighted_loss: 1.8034, label: 0, bag_size: 2736
batch 419, loss: 0.1433, instance_loss: 0.2672, weighted_loss: 0.1805, label: 0, bag_size: 3741
batch 439, loss: 1.4886, instance_loss: 1.0497, weighted_loss: 1.3569, label: 1, bag_size: 869
batch 459, loss: 1.3391, instance_loss: 0.7102, weighted_loss: 1.1504, label: 0, bag_size: 4524
batch 479, loss: 0.4470, instance_loss: 0.7350, weighted_loss: 0.5334, label: 0, bag_size: 5011
batch 499, loss: 0.0696, instance_loss: 0.3045, weighted_loss: 0.1401, label: 1, bag_size: 425
batch 519, loss: 0.5111, instance_loss: 0.7658, weighted_loss: 0.5875, label: 0, bag_size: 4544
batch 539, loss: 1.6264, instance_loss: 0.5244, weighted_loss: 1.2958, label: 1, bag_size: 4869
batch 559, loss: 0.1363, instance_loss: 0.2445, weighted_loss: 0.1688, label: 0, bag_size: 4531
batch 579, loss: 0.4434, instance_loss: 0.5612, weighted_loss: 0.4788, label: 1, bag_size: 10399
batch 599, loss: 0.1749, instance_loss: 0.3139, weighted_loss: 0.2166, label: 2, bag_size: 3397
batch 619, loss: 0.1640, instance_loss: 0.4133, weighted_loss: 0.2388, label: 0, bag_size: 4524
batch 639, loss: 1.2885, instance_loss: 1.0698, weighted_loss: 1.2229, label: 1, bag_size: 4940
batch 659, loss: 1.0180, instance_loss: 0.3752, weighted_loss: 0.8252, label: 2, bag_size: 3026
batch 679, loss: 0.5160, instance_loss: 0.5030, weighted_loss: 0.5121, label: 1, bag_size: 3357
batch 699, loss: 0.1951, instance_loss: 0.2935, weighted_loss: 0.2246, label: 0, bag_size: 4398
batch 719, loss: 0.7865, instance_loss: 0.6663, weighted_loss: 0.7504, label: 1, bag_size: 2083
batch 739, loss: 0.7997, instance_loss: 0.7960, weighted_loss: 0.7986, label: 1, bag_size: 1607


class 0 clustering acc 0.9725391498881432: correct 17389/17880
class 1 clustering acc 0.33993288590604026: correct 2026/5960
Epoch: 25, train_loss: 0.6125, train_clustering_loss:  0.5538, train_error: 0.2671
class 0: acc 0.769811320754717, correct 204/265
class 1: acc 0.6403508771929824, correct 146/228
class 2: acc 0.7777777777777778, correct 196/252

Val Set, val_loss: 0.7191, val_error: 0.3191, auc: 0.8748
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.20877659574468085: correct 157/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1074, instance_loss: 0.2743, weighted_loss: 0.1575, label: 0, bag_size: 2884
batch 39, loss: 0.0332, instance_loss: 0.2134, weighted_loss: 0.0873, label: 1, bag_size: 3493
batch 59, loss: 0.1030, instance_loss: 0.2509, weighted_loss: 0.1473, label: 0, bag_size: 3886
batch 79, loss: 0.4005, instance_loss: 0.3412, weighted_loss: 0.3827, label: 0, bag_size: 6927
batch 99, loss: 0.1116, instance_loss: 0.1979, weighted_loss: 0.1375, label: 0, bag_size: 3690
batch 119, loss: 0.7614, instance_loss: 0.8135, weighted_loss: 0.7770, label: 2, bag_size: 4316
batch 139, loss: 0.0319, instance_loss: 0.1352, weighted_loss: 0.0629, label: 2, bag_size: 4372
batch 159, loss: 0.0313, instance_loss: 0.1002, weighted_loss: 0.0520, label: 0, bag_size: 6221
batch 179, loss: 0.0253, instance_loss: 0.1225, weighted_loss: 0.0545, label: 2, bag_size: 6026
batch 199, loss: 0.0145, instance_loss: 0.3995, weighted_loss: 0.1300, label: 0, bag_size: 3920
batch 219, loss: 1.2399, instance_loss: 1.0674, weighted_loss: 1.1881, label: 2, bag_size: 4316
batch 239, loss: 0.1358, instance_loss: 0.3070, weighted_loss: 0.1871, label: 0, bag_size: 2756
batch 259, loss: 0.3975, instance_loss: 0.5905, weighted_loss: 0.4554, label: 1, bag_size: 1906
batch 279, loss: 0.8178, instance_loss: 0.9642, weighted_loss: 0.8617, label: 1, bag_size: 2671
batch 299, loss: 0.0548, instance_loss: 0.2209, weighted_loss: 0.1046, label: 2, bag_size: 4569
batch 319, loss: 0.2534, instance_loss: 0.6965, weighted_loss: 0.3863, label: 2, bag_size: 5472
batch 339, loss: 0.9564, instance_loss: 0.9796, weighted_loss: 0.9634, label: 2, bag_size: 4342
batch 359, loss: 0.1836, instance_loss: 0.3908, weighted_loss: 0.2458, label: 2, bag_size: 3534
batch 379, loss: 0.0116, instance_loss: 0.0665, weighted_loss: 0.0281, label: 2, bag_size: 2483
batch 399, loss: 0.3458, instance_loss: 0.1512, weighted_loss: 0.2874, label: 2, bag_size: 3583
batch 419, loss: 1.6680, instance_loss: 0.8644, weighted_loss: 1.4269, label: 2, bag_size: 4179
batch 439, loss: 0.0295, instance_loss: 0.2542, weighted_loss: 0.0969, label: 1, bag_size: 2254
batch 459, loss: 0.5183, instance_loss: 0.7319, weighted_loss: 0.5824, label: 1, bag_size: 3475
batch 479, loss: 0.1126, instance_loss: 0.3693, weighted_loss: 0.1896, label: 0, bag_size: 5656
batch 499, loss: 1.6069, instance_loss: 1.0771, weighted_loss: 1.4479, label: 1, bag_size: 2927
batch 519, loss: 0.0326, instance_loss: 0.0828, weighted_loss: 0.0477, label: 2, bag_size: 1094
batch 539, loss: 0.0248, instance_loss: 0.2367, weighted_loss: 0.0884, label: 0, bag_size: 3038
batch 559, loss: 0.3394, instance_loss: 0.6133, weighted_loss: 0.4216, label: 1, bag_size: 2905
batch 579, loss: 0.1308, instance_loss: 0.3295, weighted_loss: 0.1904, label: 0, bag_size: 6015
batch 599, loss: 0.7550, instance_loss: 0.7443, weighted_loss: 0.7518, label: 1, bag_size: 582
batch 619, loss: 0.0407, instance_loss: 0.3183, weighted_loss: 0.1240, label: 0, bag_size: 1006
batch 639, loss: 0.2998, instance_loss: 0.3990, weighted_loss: 0.3296, label: 0, bag_size: 4547
batch 659, loss: 0.0145, instance_loss: 0.6086, weighted_loss: 0.1927, label: 1, bag_size: 10399
batch 679, loss: 0.2988, instance_loss: 0.4891, weighted_loss: 0.3559, label: 1, bag_size: 4898
batch 699, loss: 0.0168, instance_loss: 0.0667, weighted_loss: 0.0318, label: 2, bag_size: 3285
batch 719, loss: 1.1379, instance_loss: 0.6812, weighted_loss: 1.0009, label: 1, bag_size: 11768
batch 739, loss: 0.6234, instance_loss: 0.8191, weighted_loss: 0.6821, label: 1, bag_size: 2831


class 0 clustering acc 0.9713087248322148: correct 17367/17880
class 1 clustering acc 0.3662751677852349: correct 2183/5960
Epoch: 26, train_loss: 0.5664, train_clustering_loss:  0.5483, train_error: 0.2523
class 0: acc 0.7862903225806451, correct 195/248
class 1: acc 0.6626984126984127, correct 167/252
class 2: acc 0.7959183673469388, correct 195/245

Val Set, val_loss: 0.8027, val_error: 0.3298, auc: 0.8563
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.16888297872340424: correct 127/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5916, instance_loss: 0.5827, weighted_loss: 0.5889, label: 1, bag_size: 4806
batch 39, loss: 2.2994, instance_loss: 0.4187, weighted_loss: 1.7352, label: 1, bag_size: 5760
batch 59, loss: 0.4671, instance_loss: 0.7437, weighted_loss: 0.5501, label: 1, bag_size: 1197
batch 79, loss: 0.6739, instance_loss: 0.5102, weighted_loss: 0.6248, label: 0, bag_size: 5340
batch 99, loss: 0.2869, instance_loss: 0.7638, weighted_loss: 0.4300, label: 1, bag_size: 2494
batch 119, loss: 0.2534, instance_loss: 0.3219, weighted_loss: 0.2740, label: 2, bag_size: 3172
batch 139, loss: 0.4258, instance_loss: 0.4852, weighted_loss: 0.4436, label: 1, bag_size: 800
batch 159, loss: 0.7818, instance_loss: 0.7962, weighted_loss: 0.7861, label: 2, bag_size: 22464
batch 179, loss: 0.9314, instance_loss: 0.7450, weighted_loss: 0.8755, label: 0, bag_size: 5023
batch 199, loss: 2.9915, instance_loss: 1.5421, weighted_loss: 2.5566, label: 2, bag_size: 4241
batch 219, loss: 0.0524, instance_loss: 0.1522, weighted_loss: 0.0824, label: 0, bag_size: 3883
batch 239, loss: 0.0088, instance_loss: 0.1193, weighted_loss: 0.0419, label: 0, bag_size: 3304
batch 259, loss: 0.1226, instance_loss: 0.3734, weighted_loss: 0.1978, label: 1, bag_size: 209
batch 279, loss: 0.0396, instance_loss: 0.1691, weighted_loss: 0.0785, label: 2, bag_size: 4745
batch 299, loss: 0.2503, instance_loss: 0.3067, weighted_loss: 0.2672, label: 0, bag_size: 1194
batch 319, loss: 1.3750, instance_loss: 1.1270, weighted_loss: 1.3006, label: 1, bag_size: 1250
batch 339, loss: 0.4612, instance_loss: 0.7074, weighted_loss: 0.5350, label: 1, bag_size: 2859
batch 359, loss: 1.4028, instance_loss: 1.2510, weighted_loss: 1.3573, label: 1, bag_size: 2055
batch 379, loss: 0.1541, instance_loss: 0.2427, weighted_loss: 0.1807, label: 0, bag_size: 5634
batch 399, loss: 0.0277, instance_loss: 0.1582, weighted_loss: 0.0668, label: 0, bag_size: 2825
batch 419, loss: 3.4927, instance_loss: 1.8935, weighted_loss: 3.0129, label: 1, bag_size: 1558
batch 439, loss: 0.0501, instance_loss: 0.0852, weighted_loss: 0.0606, label: 0, bag_size: 6182
batch 459, loss: 0.2178, instance_loss: 0.2574, weighted_loss: 0.2297, label: 0, bag_size: 789
batch 479, loss: 0.4253, instance_loss: 0.5082, weighted_loss: 0.4501, label: 1, bag_size: 5412
batch 499, loss: 0.1219, instance_loss: 0.2705, weighted_loss: 0.1665, label: 2, bag_size: 2905
batch 519, loss: 1.8326, instance_loss: 0.8794, weighted_loss: 1.5466, label: 1, bag_size: 782
batch 539, loss: 0.1132, instance_loss: 0.4834, weighted_loss: 0.2242, label: 1, bag_size: 5756
batch 559, loss: 0.1082, instance_loss: 0.4976, weighted_loss: 0.2250, label: 0, bag_size: 8088
batch 579, loss: 0.1018, instance_loss: 0.1725, weighted_loss: 0.1230, label: 1, bag_size: 4898
batch 599, loss: 0.0471, instance_loss: 0.3848, weighted_loss: 0.1484, label: 2, bag_size: 3607
batch 619, loss: 0.2786, instance_loss: 0.5576, weighted_loss: 0.3623, label: 2, bag_size: 3534
batch 639, loss: 0.2197, instance_loss: 0.3569, weighted_loss: 0.2609, label: 2, bag_size: 3396
batch 659, loss: 0.0187, instance_loss: 0.0904, weighted_loss: 0.0402, label: 2, bag_size: 2483
batch 679, loss: 0.0758, instance_loss: 0.1421, weighted_loss: 0.0957, label: 0, bag_size: 3883
batch 699, loss: 0.0925, instance_loss: 0.4152, weighted_loss: 0.1893, label: 1, bag_size: 5728
batch 719, loss: 0.1652, instance_loss: 0.6548, weighted_loss: 0.3121, label: 1, bag_size: 3497
batch 739, loss: 0.2014, instance_loss: 0.2115, weighted_loss: 0.2044, label: 1, bag_size: 6243


class 0 clustering acc 0.9686241610738255: correct 17319/17880
class 1 clustering acc 0.35083892617449663: correct 2091/5960
Epoch: 27, train_loss: 0.5518, train_clustering_loss:  0.5516, train_error: 0.2282
class 0: acc 0.7755102040816326, correct 190/245
class 1: acc 0.7318007662835249, correct 191/261
class 2: acc 0.8117154811715481, correct 194/239

Val Set, val_loss: 0.7539, val_error: 0.3298, auc: 0.8744
class 0 clustering acc 0.9543439716312057: correct 2153/2256
class 1 clustering acc 0.30319148936170215: correct 228/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5231, instance_loss: 0.4593, weighted_loss: 0.5040, label: 1, bag_size: 302
batch 39, loss: 0.6550, instance_loss: 0.5995, weighted_loss: 0.6384, label: 0, bag_size: 2927
batch 59, loss: 0.5381, instance_loss: 0.9945, weighted_loss: 0.6750, label: 1, bag_size: 2671
batch 79, loss: 0.0302, instance_loss: 0.1388, weighted_loss: 0.0627, label: 2, bag_size: 614
batch 99, loss: 0.1800, instance_loss: 0.3405, weighted_loss: 0.2281, label: 2, bag_size: 3778
batch 119, loss: 0.4826, instance_loss: 0.5102, weighted_loss: 0.4908, label: 2, bag_size: 2031
batch 139, loss: 0.4592, instance_loss: 0.4843, weighted_loss: 0.4667, label: 0, bag_size: 3834
batch 159, loss: 0.0005, instance_loss: 0.1060, weighted_loss: 0.0322, label: 2, bag_size: 4088
batch 179, loss: 1.6651, instance_loss: 1.1605, weighted_loss: 1.5137, label: 1, bag_size: 5693
batch 199, loss: 0.2581, instance_loss: 0.3837, weighted_loss: 0.2957, label: 2, bag_size: 3534
batch 219, loss: 1.0911, instance_loss: 1.2655, weighted_loss: 1.1434, label: 1, bag_size: 4694
batch 239, loss: 0.0266, instance_loss: 0.8455, weighted_loss: 0.2723, label: 1, bag_size: 6717
batch 259, loss: 0.1531, instance_loss: 0.3116, weighted_loss: 0.2006, label: 0, bag_size: 7595
batch 279, loss: 1.1020, instance_loss: 0.7744, weighted_loss: 1.0037, label: 2, bag_size: 4179
batch 299, loss: 0.0130, instance_loss: 0.1056, weighted_loss: 0.0408, label: 0, bag_size: 3741
batch 319, loss: 0.2024, instance_loss: 0.2965, weighted_loss: 0.2306, label: 2, bag_size: 1103
batch 339, loss: 0.1122, instance_loss: 0.3794, weighted_loss: 0.1923, label: 0, bag_size: 3319
batch 359, loss: 0.9306, instance_loss: 0.9036, weighted_loss: 0.9225, label: 2, bag_size: 7607
batch 379, loss: 0.2576, instance_loss: 0.5958, weighted_loss: 0.3591, label: 1, bag_size: 14449
batch 399, loss: 0.2193, instance_loss: 0.6747, weighted_loss: 0.3559, label: 0, bag_size: 889
batch 419, loss: 0.2856, instance_loss: 0.6469, weighted_loss: 0.3940, label: 1, bag_size: 3991
batch 439, loss: 0.3143, instance_loss: 0.7240, weighted_loss: 0.4372, label: 2, bag_size: 5472
batch 459, loss: 0.0457, instance_loss: 0.1490, weighted_loss: 0.0766, label: 0, bag_size: 873
batch 479, loss: 0.8666, instance_loss: 1.3726, weighted_loss: 1.0184, label: 1, bag_size: 3821
batch 499, loss: 1.5763, instance_loss: 1.0057, weighted_loss: 1.4051, label: 1, bag_size: 5572
batch 519, loss: 0.1346, instance_loss: 0.2385, weighted_loss: 0.1658, label: 0, bag_size: 3289
batch 539, loss: 0.2781, instance_loss: 0.5423, weighted_loss: 0.3574, label: 2, bag_size: 4372
batch 559, loss: 0.1880, instance_loss: 0.2289, weighted_loss: 0.2003, label: 2, bag_size: 3112
batch 579, loss: 0.0453, instance_loss: 0.2249, weighted_loss: 0.0992, label: 0, bag_size: 1845
batch 599, loss: 0.4464, instance_loss: 0.1999, weighted_loss: 0.3725, label: 2, bag_size: 4691
batch 619, loss: 0.0156, instance_loss: 0.2148, weighted_loss: 0.0754, label: 2, bag_size: 4497
batch 639, loss: 0.3118, instance_loss: 0.3503, weighted_loss: 0.3233, label: 2, bag_size: 4203
batch 659, loss: 1.3436, instance_loss: 0.9856, weighted_loss: 1.2362, label: 2, bag_size: 4316
batch 679, loss: 0.3794, instance_loss: 0.3999, weighted_loss: 0.3855, label: 2, bag_size: 4691
batch 699, loss: 0.1696, instance_loss: 0.3068, weighted_loss: 0.2108, label: 1, bag_size: 2731
batch 719, loss: 0.0110, instance_loss: 0.3585, weighted_loss: 0.1152, label: 0, bag_size: 4458
batch 739, loss: 0.2722, instance_loss: 0.4743, weighted_loss: 0.3328, label: 2, bag_size: 3546


class 0 clustering acc 0.9655480984340045: correct 17264/17880
class 1 clustering acc 0.4085570469798658: correct 2435/5960
Epoch: 28, train_loss: 0.5371, train_clustering_loss:  0.5313, train_error: 0.2201
class 0: acc 0.8378378378378378, correct 217/259
class 1: acc 0.65625, correct 147/224
class 2: acc 0.8282442748091603, correct 217/262

Val Set, val_loss: 0.6229, val_error: 0.2340, auc: 0.8871
class 0 clustering acc 0.9609929078014184: correct 2168/2256
class 1 clustering acc 0.3271276595744681: correct 246/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.6289, instance_loss: 1.2585, weighted_loss: 2.2178, label: 1, bag_size: 3399
batch 39, loss: 0.0696, instance_loss: 0.1878, weighted_loss: 0.1051, label: 0, bag_size: 5226
batch 59, loss: 0.1815, instance_loss: 0.6064, weighted_loss: 0.3090, label: 2, bag_size: 5037
batch 79, loss: 0.2942, instance_loss: 0.7114, weighted_loss: 0.4194, label: 1, bag_size: 11768
batch 99, loss: 2.5647, instance_loss: 1.2562, weighted_loss: 2.1722, label: 0, bag_size: 3402
batch 119, loss: 0.0524, instance_loss: 0.1282, weighted_loss: 0.0752, label: 0, bag_size: 5831
batch 139, loss: 1.1487, instance_loss: 0.6725, weighted_loss: 1.0059, label: 2, bag_size: 2326
batch 159, loss: 0.0159, instance_loss: 0.3645, weighted_loss: 0.1205, label: 1, bag_size: 6241
batch 179, loss: 0.2236, instance_loss: 0.1942, weighted_loss: 0.2148, label: 2, bag_size: 3396
batch 199, loss: 0.2920, instance_loss: 0.2751, weighted_loss: 0.2869, label: 2, bag_size: 3534
batch 219, loss: 0.0278, instance_loss: 0.2315, weighted_loss: 0.0889, label: 1, bag_size: 425
batch 239, loss: 1.9401, instance_loss: 1.0639, weighted_loss: 1.6773, label: 2, bag_size: 4316
batch 259, loss: 1.2529, instance_loss: 1.2467, weighted_loss: 1.2510, label: 0, bag_size: 4509
batch 279, loss: 0.1706, instance_loss: 0.1622, weighted_loss: 0.1681, label: 0, bag_size: 2378
batch 299, loss: 0.2423, instance_loss: 0.1928, weighted_loss: 0.2274, label: 2, bag_size: 4788
batch 319, loss: 0.2693, instance_loss: 0.5061, weighted_loss: 0.3403, label: 0, bag_size: 7177
batch 339, loss: 2.4957, instance_loss: 1.4674, weighted_loss: 2.1872, label: 2, bag_size: 4241
batch 359, loss: 0.5146, instance_loss: 0.8479, weighted_loss: 0.6146, label: 1, bag_size: 2744
batch 379, loss: 0.0507, instance_loss: 0.2639, weighted_loss: 0.1147, label: 2, bag_size: 2483
batch 399, loss: 0.3254, instance_loss: 0.5472, weighted_loss: 0.3919, label: 1, bag_size: 3396
batch 419, loss: 0.2768, instance_loss: 0.5358, weighted_loss: 0.3545, label: 0, bag_size: 3797
batch 439, loss: 0.0213, instance_loss: 0.2971, weighted_loss: 0.1041, label: 0, bag_size: 4083
batch 459, loss: 0.2627, instance_loss: 0.2708, weighted_loss: 0.2652, label: 2, bag_size: 3583
batch 479, loss: 0.1504, instance_loss: 0.2258, weighted_loss: 0.1730, label: 0, bag_size: 2601
batch 499, loss: 0.1942, instance_loss: 0.6286, weighted_loss: 0.3245, label: 1, bag_size: 683
batch 519, loss: 1.5494, instance_loss: 0.8880, weighted_loss: 1.3510, label: 0, bag_size: 14218
batch 539, loss: 1.4824, instance_loss: 0.8307, weighted_loss: 1.2869, label: 1, bag_size: 32
batch 559, loss: 0.7507, instance_loss: 0.3591, weighted_loss: 0.6333, label: 2, bag_size: 3026
batch 579, loss: 0.9455, instance_loss: 1.1520, weighted_loss: 1.0075, label: 2, bag_size: 4291
batch 599, loss: 0.4936, instance_loss: 0.4056, weighted_loss: 0.4672, label: 1, bag_size: 3586
batch 619, loss: 0.3468, instance_loss: 0.6891, weighted_loss: 0.4495, label: 0, bag_size: 1018
batch 639, loss: 0.3490, instance_loss: 0.7141, weighted_loss: 0.4585, label: 0, bag_size: 2153
batch 659, loss: 0.0108, instance_loss: 0.0563, weighted_loss: 0.0244, label: 2, bag_size: 3497
batch 679, loss: 0.0991, instance_loss: 0.4322, weighted_loss: 0.1990, label: 2, bag_size: 3604
batch 699, loss: 0.1558, instance_loss: 0.3263, weighted_loss: 0.2069, label: 2, bag_size: 3210
batch 719, loss: 0.2158, instance_loss: 0.3365, weighted_loss: 0.2520, label: 1, bag_size: 2319
batch 739, loss: 1.0495, instance_loss: 1.0939, weighted_loss: 1.0628, label: 2, bag_size: 223


class 0 clustering acc 0.9642617449664429: correct 17241/17880
class 1 clustering acc 0.386241610738255: correct 2302/5960
Epoch: 29, train_loss: 0.5860, train_clustering_loss:  0.5550, train_error: 0.2443
class 0: acc 0.782258064516129, correct 194/248
class 1: acc 0.6867469879518072, correct 171/249
class 2: acc 0.7983870967741935, correct 198/248

Val Set, val_loss: 0.7305, val_error: 0.2447, auc: 0.8672
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.2127659574468085: correct 160/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9837, instance_loss: 0.8721, weighted_loss: 0.9502, label: 2, bag_size: 3274
batch 39, loss: 0.0338, instance_loss: 0.1986, weighted_loss: 0.0833, label: 1, bag_size: 5026
batch 59, loss: 0.6560, instance_loss: 0.6151, weighted_loss: 0.6437, label: 2, bag_size: 5426
batch 79, loss: 0.0416, instance_loss: 0.1309, weighted_loss: 0.0684, label: 0, bag_size: 5634
batch 99, loss: 0.2418, instance_loss: 0.8153, weighted_loss: 0.4138, label: 1, bag_size: 20666
batch 119, loss: 0.0064, instance_loss: 0.1463, weighted_loss: 0.0484, label: 2, bag_size: 3497
batch 139, loss: 0.4741, instance_loss: 0.4465, weighted_loss: 0.4658, label: 1, bag_size: 3009
batch 159, loss: 0.0700, instance_loss: 0.1962, weighted_loss: 0.1078, label: 0, bag_size: 4325
batch 179, loss: 0.0209, instance_loss: 0.2198, weighted_loss: 0.0806, label: 1, bag_size: 1807
batch 199, loss: 2.8225, instance_loss: 1.4149, weighted_loss: 2.4002, label: 2, bag_size: 223
batch 219, loss: 0.0579, instance_loss: 0.1354, weighted_loss: 0.0812, label: 0, bag_size: 3649
batch 239, loss: 0.0122, instance_loss: 0.0828, weighted_loss: 0.0334, label: 1, bag_size: 1836
batch 259, loss: 0.7001, instance_loss: 0.4357, weighted_loss: 0.6208, label: 0, bag_size: 4450
batch 279, loss: 0.8649, instance_loss: 0.7849, weighted_loss: 0.8409, label: 2, bag_size: 5426
batch 299, loss: 2.0894, instance_loss: 1.2172, weighted_loss: 1.8277, label: 2, bag_size: 4910
batch 319, loss: 2.0328, instance_loss: 1.1991, weighted_loss: 1.7827, label: 0, bag_size: 14218
batch 339, loss: 0.4723, instance_loss: 0.4665, weighted_loss: 0.4706, label: 0, bag_size: 6927
batch 359, loss: 0.0257, instance_loss: 0.1912, weighted_loss: 0.0753, label: 1, bag_size: 3337
batch 379, loss: 0.0363, instance_loss: 0.1442, weighted_loss: 0.0687, label: 2, bag_size: 6026
batch 399, loss: 2.0608, instance_loss: 0.8228, weighted_loss: 1.6894, label: 0, bag_size: 877
batch 419, loss: 0.1015, instance_loss: 0.4480, weighted_loss: 0.2054, label: 0, bag_size: 6285
batch 439, loss: 0.1916, instance_loss: 0.5390, weighted_loss: 0.2958, label: 0, bag_size: 5646
batch 459, loss: 0.1336, instance_loss: 0.4930, weighted_loss: 0.2414, label: 0, bag_size: 5646
batch 479, loss: 0.6451, instance_loss: 0.6533, weighted_loss: 0.6475, label: 0, bag_size: 4105
batch 499, loss: 0.8071, instance_loss: 0.5705, weighted_loss: 0.7361, label: 0, bag_size: 7077
batch 519, loss: 0.0445, instance_loss: 0.2762, weighted_loss: 0.1140, label: 2, bag_size: 4745
batch 539, loss: 0.4263, instance_loss: 0.3524, weighted_loss: 0.4041, label: 0, bag_size: 4378
batch 559, loss: 1.3144, instance_loss: 1.1462, weighted_loss: 1.2640, label: 1, bag_size: 2055
batch 579, loss: 0.2019, instance_loss: 0.3080, weighted_loss: 0.2337, label: 0, bag_size: 2286
batch 599, loss: 0.4934, instance_loss: 0.3654, weighted_loss: 0.4550, label: 0, bag_size: 4292
batch 619, loss: 1.6798, instance_loss: 0.9968, weighted_loss: 1.4749, label: 2, bag_size: 909
batch 639, loss: 0.3558, instance_loss: 0.4979, weighted_loss: 0.3984, label: 0, bag_size: 3864
batch 659, loss: 0.0407, instance_loss: 0.3079, weighted_loss: 0.1208, label: 0, bag_size: 1812
batch 679, loss: 0.8726, instance_loss: 0.5790, weighted_loss: 0.7845, label: 1, bag_size: 800
batch 699, loss: 0.9339, instance_loss: 0.8568, weighted_loss: 0.9108, label: 0, bag_size: 5890
batch 719, loss: 0.1858, instance_loss: 0.3269, weighted_loss: 0.2281, label: 2, bag_size: 3172
batch 739, loss: 0.0254, instance_loss: 0.2344, weighted_loss: 0.0881, label: 1, bag_size: 5026


class 0 clustering acc 0.9678970917225951: correct 17306/17880
class 1 clustering acc 0.4083892617449664: correct 2434/5960
Epoch: 30, train_loss: 0.5133, train_clustering_loss:  0.5192, train_error: 0.2121
class 0: acc 0.813953488372093, correct 210/258
class 1: acc 0.716, correct 179/250
class 2: acc 0.8354430379746836, correct 198/237

Val Set, val_loss: 0.6413, val_error: 0.2340, auc: 0.8768
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.36436170212765956: correct 274/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0333, instance_loss: 0.1673, weighted_loss: 0.0735, label: 2, bag_size: 2770
batch 39, loss: 0.1450, instance_loss: 0.3663, weighted_loss: 0.2114, label: 2, bag_size: 4569
batch 59, loss: 0.0849, instance_loss: 0.2472, weighted_loss: 0.1336, label: 2, bag_size: 4372
batch 79, loss: 0.6234, instance_loss: 0.5035, weighted_loss: 0.5874, label: 0, bag_size: 3690
batch 99, loss: 1.3397, instance_loss: 0.9601, weighted_loss: 1.2258, label: 2, bag_size: 2326
batch 119, loss: 0.0111, instance_loss: 0.2544, weighted_loss: 0.0841, label: 2, bag_size: 4691
batch 139, loss: 0.0590, instance_loss: 0.4129, weighted_loss: 0.1651, label: 0, bag_size: 1812
batch 159, loss: 0.2967, instance_loss: 0.4022, weighted_loss: 0.3284, label: 2, bag_size: 4569
batch 179, loss: 0.1138, instance_loss: 0.2857, weighted_loss: 0.1654, label: 1, bag_size: 2921
batch 199, loss: 0.1633, instance_loss: 0.3631, weighted_loss: 0.2232, label: 1, bag_size: 1410
batch 219, loss: 0.4500, instance_loss: 0.5743, weighted_loss: 0.4873, label: 1, bag_size: 3391
batch 239, loss: 0.0047, instance_loss: 0.0300, weighted_loss: 0.0123, label: 2, bag_size: 6148
batch 259, loss: 0.3607, instance_loss: 0.3997, weighted_loss: 0.3724, label: 1, bag_size: 3391
batch 279, loss: 0.2359, instance_loss: 1.5492, weighted_loss: 0.6299, label: 1, bag_size: 3995
batch 299, loss: 0.6064, instance_loss: 0.6200, weighted_loss: 0.6104, label: 1, bag_size: 3422
batch 319, loss: 0.1927, instance_loss: 0.3608, weighted_loss: 0.2431, label: 2, bag_size: 6594
batch 339, loss: 0.0623, instance_loss: 0.3265, weighted_loss: 0.1416, label: 0, bag_size: 3833
batch 359, loss: 0.3267, instance_loss: 0.5816, weighted_loss: 0.4031, label: 0, bag_size: 4997
batch 379, loss: 0.0461, instance_loss: 0.2056, weighted_loss: 0.0939, label: 1, bag_size: 5385
batch 399, loss: 0.9307, instance_loss: 0.8130, weighted_loss: 0.8954, label: 2, bag_size: 4316
batch 419, loss: 0.2402, instance_loss: 0.4476, weighted_loss: 0.3025, label: 0, bag_size: 5373
batch 439, loss: 0.3720, instance_loss: 0.3663, weighted_loss: 0.3703, label: 1, bag_size: 3367
batch 459, loss: 0.0258, instance_loss: 0.1372, weighted_loss: 0.0592, label: 0, bag_size: 420
batch 479, loss: 1.7579, instance_loss: 0.9839, weighted_loss: 1.5257, label: 0, bag_size: 4639
batch 499, loss: 0.1115, instance_loss: 0.3072, weighted_loss: 0.1702, label: 2, bag_size: 3618
batch 519, loss: 0.5065, instance_loss: 0.8041, weighted_loss: 0.5958, label: 0, bag_size: 2392
batch 539, loss: 1.4675, instance_loss: 1.0683, weighted_loss: 1.3477, label: 1, bag_size: 1045
batch 559, loss: 0.1813, instance_loss: 0.1758, weighted_loss: 0.1797, label: 2, bag_size: 3026
batch 579, loss: 0.4044, instance_loss: 1.0970, weighted_loss: 0.6122, label: 1, bag_size: 3821
batch 599, loss: 0.2502, instance_loss: 0.2788, weighted_loss: 0.2588, label: 1, bag_size: 5693
batch 619, loss: 2.5345, instance_loss: 1.2698, weighted_loss: 2.1551, label: 2, bag_size: 3274
batch 639, loss: 0.6885, instance_loss: 1.1966, weighted_loss: 0.8409, label: 0, bag_size: 2608
batch 659, loss: 0.1696, instance_loss: 0.2467, weighted_loss: 0.1927, label: 2, bag_size: 4691
batch 679, loss: 0.3363, instance_loss: 0.2949, weighted_loss: 0.3239, label: 1, bag_size: 4708
batch 699, loss: 0.0389, instance_loss: 0.1769, weighted_loss: 0.0803, label: 0, bag_size: 3754
batch 719, loss: 5.0868, instance_loss: 1.9308, weighted_loss: 4.1400, label: 0, bag_size: 4605
batch 739, loss: 2.3256, instance_loss: 1.6758, weighted_loss: 2.1307, label: 0, bag_size: 15105


class 0 clustering acc 0.9623601789709172: correct 17207/17880
class 1 clustering acc 0.44546979865771813: correct 2655/5960
Epoch: 31, train_loss: 0.5299, train_clustering_loss:  0.5210, train_error: 0.2134
class 0: acc 0.8034934497816594, correct 184/229
class 1: acc 0.7378277153558053, correct 197/267
class 2: acc 0.8232931726907631, correct 205/249

Val Set, val_loss: 0.6655, val_error: 0.2766, auc: 0.8854
class 0 clustering acc 0.9596631205673759: correct 2165/2256
class 1 clustering acc 0.3324468085106383: correct 250/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.2082, instance_loss: 0.9488, weighted_loss: 1.1304, label: 1, bag_size: 3508
batch 39, loss: 0.1545, instance_loss: 0.2272, weighted_loss: 0.1763, label: 2, bag_size: 3172
batch 59, loss: 0.7199, instance_loss: 0.4776, weighted_loss: 0.6472, label: 0, bag_size: 4460
batch 79, loss: 2.5133, instance_loss: 1.5433, weighted_loss: 2.2223, label: 1, bag_size: 2852
batch 99, loss: 0.1724, instance_loss: 0.6087, weighted_loss: 0.3033, label: 1, bag_size: 2319
batch 119, loss: 0.3289, instance_loss: 0.4978, weighted_loss: 0.3796, label: 1, bag_size: 5276
batch 139, loss: 0.2673, instance_loss: 0.2099, weighted_loss: 0.2501, label: 2, bag_size: 4691
batch 159, loss: 0.0559, instance_loss: 0.1452, weighted_loss: 0.0827, label: 0, bag_size: 9897
batch 179, loss: 0.1616, instance_loss: 0.3844, weighted_loss: 0.2284, label: 0, bag_size: 5632
batch 199, loss: 0.1553, instance_loss: 0.1842, weighted_loss: 0.1639, label: 2, bag_size: 1094
batch 219, loss: 0.1555, instance_loss: 0.1773, weighted_loss: 0.1621, label: 0, bag_size: 7177
batch 239, loss: 0.0008, instance_loss: 0.0476, weighted_loss: 0.0148, label: 2, bag_size: 4497
batch 259, loss: 0.0904, instance_loss: 0.0934, weighted_loss: 0.0913, label: 0, bag_size: 3883
batch 279, loss: 0.4858, instance_loss: 0.4298, weighted_loss: 0.4690, label: 0, bag_size: 1025
batch 299, loss: 0.6687, instance_loss: 0.5004, weighted_loss: 0.6182, label: 0, bag_size: 4351
batch 319, loss: 0.0636, instance_loss: 0.2141, weighted_loss: 0.1087, label: 2, bag_size: 4302
batch 339, loss: 0.1743, instance_loss: 0.2970, weighted_loss: 0.2111, label: 0, bag_size: 5368
batch 359, loss: 0.2909, instance_loss: 0.8763, weighted_loss: 0.4665, label: 2, bag_size: 5472
batch 379, loss: 1.1807, instance_loss: 1.2672, weighted_loss: 1.2067, label: 1, bag_size: 1122
batch 399, loss: 0.0613, instance_loss: 0.2879, weighted_loss: 0.1293, label: 0, bag_size: 5036
batch 419, loss: 0.0619, instance_loss: 0.2269, weighted_loss: 0.1114, label: 2, bag_size: 3497
batch 439, loss: 0.0966, instance_loss: 0.3828, weighted_loss: 0.1824, label: 2, bag_size: 4372
batch 459, loss: 0.1746, instance_loss: 0.2395, weighted_loss: 0.1941, label: 2, bag_size: 597
batch 479, loss: 0.8839, instance_loss: 1.0353, weighted_loss: 0.9293, label: 1, bag_size: 2751
batch 499, loss: 1.2305, instance_loss: 1.0998, weighted_loss: 1.1913, label: 1, bag_size: 3322
batch 519, loss: 0.1136, instance_loss: 0.3223, weighted_loss: 0.1762, label: 2, bag_size: 2049
batch 539, loss: 0.1137, instance_loss: 0.2268, weighted_loss: 0.1476, label: 2, bag_size: 4141
batch 559, loss: 0.5768, instance_loss: 0.6858, weighted_loss: 0.6095, label: 0, bag_size: 789
batch 579, loss: 0.1474, instance_loss: 0.2299, weighted_loss: 0.1721, label: 2, bag_size: 2359
batch 599, loss: 0.0280, instance_loss: 0.1802, weighted_loss: 0.0737, label: 0, bag_size: 4529
batch 619, loss: 0.4930, instance_loss: 0.5061, weighted_loss: 0.4969, label: 1, bag_size: 800
batch 639, loss: 0.4358, instance_loss: 0.4981, weighted_loss: 0.4545, label: 1, bag_size: 800
batch 659, loss: 0.0041, instance_loss: 0.1440, weighted_loss: 0.0461, label: 2, bag_size: 2209
batch 679, loss: 0.2934, instance_loss: 0.4025, weighted_loss: 0.3262, label: 0, bag_size: 2671
batch 699, loss: 0.0586, instance_loss: 0.2400, weighted_loss: 0.1130, label: 2, bag_size: 614
batch 719, loss: 1.5451, instance_loss: 0.9917, weighted_loss: 1.3791, label: 1, bag_size: 574
batch 739, loss: 0.4466, instance_loss: 0.5787, weighted_loss: 0.4863, label: 1, bag_size: 779


class 0 clustering acc 0.9684563758389262: correct 17316/17880
class 1 clustering acc 0.3919463087248322: correct 2336/5960
Epoch: 32, train_loss: 0.5549, train_clustering_loss:  0.5368, train_error: 0.2268
class 0: acc 0.7717842323651453, correct 186/241
class 1: acc 0.6591928251121076, correct 147/223
class 2: acc 0.8647686832740213, correct 243/281

Val Set, val_loss: 1.2247, val_error: 0.4255, auc: 0.8388
class 0 clustering acc 0.910904255319149: correct 2055/2256
class 1 clustering acc 0.21808510638297873: correct 164/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.4, correct 12/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0272, instance_loss: 0.1745, weighted_loss: 0.0714, label: 0, bag_size: 2601
batch 39, loss: 0.2826, instance_loss: 0.2266, weighted_loss: 0.2658, label: 2, bag_size: 4788
batch 59, loss: 1.1736, instance_loss: 0.9639, weighted_loss: 1.1107, label: 0, bag_size: 3341
batch 79, loss: 0.4123, instance_loss: 0.6879, weighted_loss: 0.4950, label: 2, bag_size: 3604
batch 99, loss: 0.2736, instance_loss: 0.4298, weighted_loss: 0.3205, label: 0, bag_size: 3033
batch 119, loss: 0.1187, instance_loss: 0.3252, weighted_loss: 0.1807, label: 1, bag_size: 4595
batch 139, loss: 0.2593, instance_loss: 0.3459, weighted_loss: 0.2853, label: 0, bag_size: 1655
batch 159, loss: 0.6824, instance_loss: 0.7914, weighted_loss: 0.7151, label: 1, bag_size: 1066
batch 179, loss: 0.9883, instance_loss: 0.7165, weighted_loss: 0.9068, label: 1, bag_size: 4373
batch 199, loss: 0.0190, instance_loss: 0.1953, weighted_loss: 0.0719, label: 1, bag_size: 1836
batch 219, loss: 0.0667, instance_loss: 0.4488, weighted_loss: 0.1813, label: 1, bag_size: 425
batch 239, loss: 0.2379, instance_loss: 0.2788, weighted_loss: 0.2501, label: 2, bag_size: 3176
batch 259, loss: 2.2054, instance_loss: 0.9969, weighted_loss: 1.8429, label: 2, bag_size: 4241
batch 279, loss: 0.0203, instance_loss: 0.0689, weighted_loss: 0.0349, label: 1, bag_size: 2254
batch 299, loss: 0.0065, instance_loss: 0.0887, weighted_loss: 0.0312, label: 1, bag_size: 3172
batch 319, loss: 0.0416, instance_loss: 0.1118, weighted_loss: 0.0626, label: 1, bag_size: 3761
batch 339, loss: 1.6893, instance_loss: 1.1876, weighted_loss: 1.5388, label: 1, bag_size: 4200
batch 359, loss: 0.5482, instance_loss: 0.4390, weighted_loss: 0.5154, label: 1, bag_size: 5693
batch 379, loss: 0.5512, instance_loss: 0.4822, weighted_loss: 0.5305, label: 0, bag_size: 4347
batch 399, loss: 0.7973, instance_loss: 0.7953, weighted_loss: 0.7967, label: 0, bag_size: 6249
batch 419, loss: 0.9383, instance_loss: 1.1951, weighted_loss: 1.0154, label: 2, bag_size: 4342
batch 439, loss: 1.1349, instance_loss: 0.7011, weighted_loss: 1.0048, label: 1, bag_size: 3422
batch 459, loss: 0.0105, instance_loss: 0.0935, weighted_loss: 0.0354, label: 0, bag_size: 4312
batch 479, loss: 0.0415, instance_loss: 0.1241, weighted_loss: 0.0663, label: 0, bag_size: 4326
batch 499, loss: 1.4598, instance_loss: 0.9042, weighted_loss: 1.2931, label: 2, bag_size: 4179
batch 519, loss: 0.1367, instance_loss: 0.1461, weighted_loss: 0.1395, label: 2, bag_size: 4788
batch 539, loss: 0.6955, instance_loss: 0.4727, weighted_loss: 0.6287, label: 1, bag_size: 2342
batch 559, loss: 0.7428, instance_loss: 0.4333, weighted_loss: 0.6500, label: 1, bag_size: 3640
batch 579, loss: 0.0281, instance_loss: 0.0651, weighted_loss: 0.0392, label: 1, bag_size: 2643
batch 599, loss: 1.3407, instance_loss: 1.0914, weighted_loss: 1.2659, label: 2, bag_size: 4910
batch 619, loss: 0.0073, instance_loss: 0.5330, weighted_loss: 0.1650, label: 0, bag_size: 3983
batch 639, loss: 0.6502, instance_loss: 0.6812, weighted_loss: 0.6595, label: 1, bag_size: 2878
batch 659, loss: 0.0329, instance_loss: 0.3667, weighted_loss: 0.1330, label: 0, bag_size: 4070
batch 679, loss: 0.4013, instance_loss: 0.4652, weighted_loss: 0.4205, label: 0, bag_size: 893
batch 699, loss: 0.3796, instance_loss: 0.6386, weighted_loss: 0.4573, label: 1, bag_size: 3497
batch 719, loss: 0.0171, instance_loss: 0.1127, weighted_loss: 0.0458, label: 2, bag_size: 3285
batch 739, loss: 0.2586, instance_loss: 0.2139, weighted_loss: 0.2452, label: 2, bag_size: 6594


class 0 clustering acc 0.9657158836689038: correct 17267/17880
class 1 clustering acc 0.3996644295302013: correct 2382/5960
Epoch: 33, train_loss: 0.5350, train_clustering_loss:  0.5320, train_error: 0.2282
class 0: acc 0.7878787878787878, correct 182/231
class 1: acc 0.7049808429118773, correct 184/261
class 2: acc 0.8260869565217391, correct 209/253

Val Set, val_loss: 0.6160, val_error: 0.2340, auc: 0.8929
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.25132978723404253: correct 189/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4649, instance_loss: 0.5042, weighted_loss: 0.4767, label: 0, bag_size: 5098
batch 39, loss: 1.0314, instance_loss: 1.0546, weighted_loss: 1.0383, label: 1, bag_size: 5402
batch 59, loss: 0.0407, instance_loss: 0.3197, weighted_loss: 0.1244, label: 0, bag_size: 5953
batch 79, loss: 0.0360, instance_loss: 0.1329, weighted_loss: 0.0651, label: 2, bag_size: 4203
batch 99, loss: 0.0000, instance_loss: 0.3468, weighted_loss: 0.1040, label: 0, bag_size: 4582
batch 119, loss: 0.0264, instance_loss: 0.1361, weighted_loss: 0.0593, label: 0, bag_size: 5036
batch 139, loss: 0.3008, instance_loss: 0.4796, weighted_loss: 0.3544, label: 0, bag_size: 2927
batch 159, loss: 0.9034, instance_loss: 0.8043, weighted_loss: 0.8737, label: 1, bag_size: 4467
batch 179, loss: 0.0025, instance_loss: 0.0823, weighted_loss: 0.0264, label: 2, bag_size: 4497
batch 199, loss: 0.1109, instance_loss: 0.2934, weighted_loss: 0.1657, label: 2, bag_size: 5037
batch 219, loss: 0.1226, instance_loss: 0.2228, weighted_loss: 0.1527, label: 2, bag_size: 4571
batch 239, loss: 0.0845, instance_loss: 0.2426, weighted_loss: 0.1319, label: 0, bag_size: 3649
batch 259, loss: 0.0046, instance_loss: 0.1109, weighted_loss: 0.0365, label: 1, bag_size: 5018
batch 279, loss: 0.4043, instance_loss: 0.6775, weighted_loss: 0.4863, label: 0, bag_size: 4105
batch 299, loss: 0.5806, instance_loss: 0.7117, weighted_loss: 0.6199, label: 1, bag_size: 4200
batch 319, loss: 0.4534, instance_loss: 0.5674, weighted_loss: 0.4876, label: 0, bag_size: 1174
batch 339, loss: 0.0497, instance_loss: 0.3367, weighted_loss: 0.1358, label: 1, bag_size: 3050
batch 359, loss: 0.2554, instance_loss: 0.5034, weighted_loss: 0.3298, label: 2, bag_size: 4141
batch 379, loss: 0.0972, instance_loss: 0.3981, weighted_loss: 0.1875, label: 0, bag_size: 921
batch 399, loss: 0.1838, instance_loss: 0.5899, weighted_loss: 0.3056, label: 0, bag_size: 5036
batch 419, loss: 0.6361, instance_loss: 0.8700, weighted_loss: 0.7062, label: 0, bag_size: 4460
batch 439, loss: 1.0582, instance_loss: 0.3651, weighted_loss: 0.8503, label: 0, bag_size: 3070
batch 459, loss: 1.0064, instance_loss: 0.9601, weighted_loss: 0.9925, label: 1, bag_size: 1542
batch 479, loss: 0.0937, instance_loss: 0.2192, weighted_loss: 0.1314, label: 0, bag_size: 4994
batch 499, loss: 0.4542, instance_loss: 0.3727, weighted_loss: 0.4297, label: 2, bag_size: 3176
batch 519, loss: 0.3382, instance_loss: 1.0858, weighted_loss: 0.5625, label: 2, bag_size: 5472
batch 539, loss: 0.1910, instance_loss: 0.3205, weighted_loss: 0.2298, label: 2, bag_size: 22464
batch 559, loss: 0.5132, instance_loss: 0.2618, weighted_loss: 0.4378, label: 0, bag_size: 14070
batch 579, loss: 0.0382, instance_loss: 0.1104, weighted_loss: 0.0599, label: 0, bag_size: 6138
batch 599, loss: 0.4512, instance_loss: 0.3890, weighted_loss: 0.4325, label: 2, bag_size: 3112
batch 619, loss: 0.0368, instance_loss: 0.0643, weighted_loss: 0.0451, label: 2, bag_size: 3618
batch 639, loss: 0.3345, instance_loss: 0.7031, weighted_loss: 0.4451, label: 1, bag_size: 1906
batch 659, loss: 0.3562, instance_loss: 0.1876, weighted_loss: 0.3056, label: 2, bag_size: 2561
batch 679, loss: 2.1645, instance_loss: 1.1004, weighted_loss: 1.8453, label: 1, bag_size: 5402
batch 699, loss: 0.2595, instance_loss: 0.4548, weighted_loss: 0.3181, label: 1, bag_size: 4599
batch 719, loss: 0.0084, instance_loss: 0.0812, weighted_loss: 0.0302, label: 0, bag_size: 1485
batch 739, loss: 0.6058, instance_loss: 0.5807, weighted_loss: 0.5983, label: 2, bag_size: 2031


class 0 clustering acc 0.9664988814317673: correct 17281/17880
class 1 clustering acc 0.3894295302013423: correct 2321/5960
Epoch: 34, train_loss: 0.5489, train_clustering_loss:  0.5427, train_error: 0.2282
class 0: acc 0.7898832684824902, correct 203/257
class 1: acc 0.6987951807228916, correct 174/249
class 2: acc 0.8284518828451883, correct 198/239

Val Set, val_loss: 0.7017, val_error: 0.2766, auc: 0.8722
class 0 clustering acc 0.9552304964539007: correct 2155/2256
class 1 clustering acc 0.2393617021276596: correct 180/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1575, instance_loss: 0.1639, weighted_loss: 0.1594, label: 2, bag_size: 4788
batch 39, loss: 0.7199, instance_loss: 0.5159, weighted_loss: 0.6587, label: 0, bag_size: 5041
batch 59, loss: 0.2201, instance_loss: 0.1565, weighted_loss: 0.2010, label: 0, bag_size: 6797
batch 79, loss: 0.7889, instance_loss: 0.5648, weighted_loss: 0.7216, label: 2, bag_size: 5743
batch 99, loss: 0.1127, instance_loss: 0.1708, weighted_loss: 0.1301, label: 2, bag_size: 2359
batch 119, loss: 0.1789, instance_loss: 0.3604, weighted_loss: 0.2334, label: 2, bag_size: 614
batch 139, loss: 1.6613, instance_loss: 0.9869, weighted_loss: 1.4590, label: 0, bag_size: 3075
batch 159, loss: 0.4396, instance_loss: 0.3564, weighted_loss: 0.4146, label: 0, bag_size: 4935
batch 179, loss: 0.0923, instance_loss: 0.2645, weighted_loss: 0.1439, label: 1, bag_size: 5385
batch 199, loss: 1.7114, instance_loss: 0.4045, weighted_loss: 1.3193, label: 0, bag_size: 19216
batch 219, loss: 0.0461, instance_loss: 0.2501, weighted_loss: 0.1073, label: 1, bag_size: 3050
batch 239, loss: 0.7367, instance_loss: 0.9493, weighted_loss: 0.8005, label: 0, bag_size: 5125
batch 259, loss: 0.9602, instance_loss: 0.4753, weighted_loss: 0.8147, label: 1, bag_size: 3586
batch 279, loss: 0.1043, instance_loss: 0.4649, weighted_loss: 0.2125, label: 2, bag_size: 3618
batch 299, loss: 0.5257, instance_loss: 0.5297, weighted_loss: 0.5269, label: 0, bag_size: 726
batch 319, loss: 0.1133, instance_loss: 0.2602, weighted_loss: 0.1574, label: 0, bag_size: 4935
batch 339, loss: 0.0518, instance_loss: 0.1777, weighted_loss: 0.0896, label: 0, bag_size: 3901
batch 359, loss: 0.0511, instance_loss: 0.1153, weighted_loss: 0.0704, label: 0, bag_size: 3924
batch 379, loss: 0.0431, instance_loss: 0.2553, weighted_loss: 0.1068, label: 1, bag_size: 3265
batch 399, loss: 1.1288, instance_loss: 1.0282, weighted_loss: 1.0986, label: 1, bag_size: 3991
batch 419, loss: 0.0483, instance_loss: 0.1111, weighted_loss: 0.0671, label: 0, bag_size: 5368
batch 439, loss: 0.0614, instance_loss: 0.2404, weighted_loss: 0.1151, label: 0, bag_size: 2756
batch 459, loss: 0.0381, instance_loss: 0.1279, weighted_loss: 0.0651, label: 0, bag_size: 4741
batch 479, loss: 0.0296, instance_loss: 0.1853, weighted_loss: 0.0763, label: 2, bag_size: 2254
batch 499, loss: 0.0557, instance_loss: 0.2199, weighted_loss: 0.1049, label: 2, bag_size: 3397
batch 519, loss: 0.7274, instance_loss: 0.4549, weighted_loss: 0.6456, label: 1, bag_size: 1595
batch 539, loss: 0.3114, instance_loss: 0.3159, weighted_loss: 0.3128, label: 0, bag_size: 6797
batch 559, loss: 0.4435, instance_loss: 0.3040, weighted_loss: 0.4016, label: 1, bag_size: 4192
batch 579, loss: 0.0387, instance_loss: 0.1884, weighted_loss: 0.0836, label: 2, bag_size: 4555
batch 599, loss: 0.0036, instance_loss: 0.0531, weighted_loss: 0.0184, label: 2, bag_size: 3094
batch 619, loss: 0.0608, instance_loss: 0.1648, weighted_loss: 0.0920, label: 2, bag_size: 5924
batch 639, loss: 0.0382, instance_loss: 0.1374, weighted_loss: 0.0679, label: 2, bag_size: 3397
batch 659, loss: 0.0492, instance_loss: 0.1681, weighted_loss: 0.0848, label: 2, bag_size: 5924
batch 679, loss: 0.0043, instance_loss: 0.0392, weighted_loss: 0.0148, label: 0, bag_size: 4644
batch 699, loss: 0.1624, instance_loss: 0.2063, weighted_loss: 0.1756, label: 0, bag_size: 4562
batch 719, loss: 0.0310, instance_loss: 0.1199, weighted_loss: 0.0576, label: 0, bag_size: 2290
batch 739, loss: 0.8004, instance_loss: 1.0614, weighted_loss: 0.8787, label: 1, bag_size: 3533


class 0 clustering acc 0.968400447427293: correct 17315/17880
class 1 clustering acc 0.4243288590604027: correct 2529/5960
Epoch: 35, train_loss: 0.4662, train_clustering_loss:  0.5143, train_error: 0.2134
class 0: acc 0.8007968127490039, correct 201/251
class 1: acc 0.6974789915966386, correct 166/238
class 2: acc 0.85546875, correct 219/256

Val Set, val_loss: 0.6975, val_error: 0.2447, auc: 0.8710
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.3377659574468085: correct 254/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1897, instance_loss: 0.3792, weighted_loss: 0.2465, label: 1, bag_size: 2921
batch 39, loss: 0.0059, instance_loss: 0.0940, weighted_loss: 0.0323, label: 2, bag_size: 4856
batch 59, loss: 0.4292, instance_loss: 0.3131, weighted_loss: 0.3944, label: 0, bag_size: 3833
batch 79, loss: 1.1012, instance_loss: 0.9385, weighted_loss: 1.0524, label: 1, bag_size: 869
batch 99, loss: 2.3622, instance_loss: 1.1750, weighted_loss: 2.0060, label: 1, bag_size: 5035
batch 119, loss: 0.9753, instance_loss: 0.8897, weighted_loss: 0.9496, label: 1, bag_size: 5880
batch 139, loss: 0.1430, instance_loss: 0.2744, weighted_loss: 0.1824, label: 2, bag_size: 6704
batch 159, loss: 0.0894, instance_loss: 0.1707, weighted_loss: 0.1138, label: 0, bag_size: 5570
batch 179, loss: 0.9295, instance_loss: 1.0246, weighted_loss: 0.9580, label: 1, bag_size: 4438
batch 199, loss: 0.0002, instance_loss: 0.3825, weighted_loss: 0.1148, label: 2, bag_size: 2031
batch 219, loss: 0.9693, instance_loss: 0.6630, weighted_loss: 0.8774, label: 1, bag_size: 2642
batch 239, loss: 0.0413, instance_loss: 0.1907, weighted_loss: 0.0861, label: 2, bag_size: 4203
batch 259, loss: 0.1481, instance_loss: 0.2110, weighted_loss: 0.1670, label: 2, bag_size: 2561
batch 279, loss: 0.7649, instance_loss: 0.5147, weighted_loss: 0.6898, label: 1, bag_size: 1042
batch 299, loss: 0.0664, instance_loss: 0.3321, weighted_loss: 0.1462, label: 0, bag_size: 3871
batch 319, loss: 0.5816, instance_loss: 0.6138, weighted_loss: 0.5913, label: 0, bag_size: 1352
batch 339, loss: 0.8060, instance_loss: 0.6984, weighted_loss: 0.7737, label: 2, bag_size: 5743
batch 359, loss: 0.4093, instance_loss: 0.7855, weighted_loss: 0.5222, label: 1, bag_size: 2743
batch 379, loss: 1.1799, instance_loss: 0.6728, weighted_loss: 1.0277, label: 2, bag_size: 4132
batch 399, loss: 0.2502, instance_loss: 0.5257, weighted_loss: 0.3328, label: 2, bag_size: 4745
batch 419, loss: 0.2626, instance_loss: 0.5678, weighted_loss: 0.3542, label: 2, bag_size: 1543
batch 439, loss: 0.2539, instance_loss: 0.5842, weighted_loss: 0.3530, label: 2, bag_size: 1543
batch 459, loss: 0.2506, instance_loss: 0.3152, weighted_loss: 0.2700, label: 1, bag_size: 3367
batch 479, loss: 0.0363, instance_loss: 0.1323, weighted_loss: 0.0651, label: 0, bag_size: 5041
batch 499, loss: 1.6730, instance_loss: 0.7458, weighted_loss: 1.3949, label: 0, bag_size: 5125
batch 519, loss: 0.5705, instance_loss: 0.4200, weighted_loss: 0.5253, label: 1, bag_size: 2878
batch 539, loss: 0.0139, instance_loss: 0.1851, weighted_loss: 0.0652, label: 1, bag_size: 3534
batch 559, loss: 0.0024, instance_loss: 0.1073, weighted_loss: 0.0339, label: 2, bag_size: 5017
batch 579, loss: 0.0294, instance_loss: 0.1572, weighted_loss: 0.0678, label: 2, bag_size: 2049
batch 599, loss: 0.2588, instance_loss: 0.2518, weighted_loss: 0.2567, label: 2, bag_size: 1103
batch 619, loss: 0.0034, instance_loss: 0.0545, weighted_loss: 0.0187, label: 1, bag_size: 1836
batch 639, loss: 0.0772, instance_loss: 0.5816, weighted_loss: 0.2285, label: 1, bag_size: 1604
batch 659, loss: 0.0038, instance_loss: 0.0522, weighted_loss: 0.0183, label: 0, bag_size: 3304
batch 679, loss: 0.8728, instance_loss: 0.7351, weighted_loss: 0.8315, label: 0, bag_size: 7315
batch 699, loss: 2.7288, instance_loss: 0.8548, weighted_loss: 2.1666, label: 0, bag_size: 3525
batch 719, loss: 0.1826, instance_loss: 0.4845, weighted_loss: 0.2732, label: 2, bag_size: 5017
batch 739, loss: 0.0523, instance_loss: 0.2683, weighted_loss: 0.1171, label: 0, bag_size: 4344


class 0 clustering acc 0.9687919463087248: correct 17322/17880
class 1 clustering acc 0.3860738255033557: correct 2301/5960
Epoch: 36, train_loss: 0.4860, train_clustering_loss:  0.5319, train_error: 0.2067
class 0: acc 0.8042553191489362, correct 189/235
class 1: acc 0.7441860465116279, correct 192/258
class 2: acc 0.8333333333333334, correct 210/252

Val Set, val_loss: 1.2229, val_error: 0.3511, auc: 0.8575
class 0 clustering acc 0.9224290780141844: correct 2081/2256
class 1 clustering acc 0.25: correct 188/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0590, instance_loss: 0.2979, weighted_loss: 0.1307, label: 2, bag_size: 3227
batch 39, loss: 0.6921, instance_loss: 0.5920, weighted_loss: 0.6621, label: 1, bag_size: 2642
batch 59, loss: 0.2397, instance_loss: 0.7345, weighted_loss: 0.3881, label: 0, bag_size: 13540
batch 79, loss: 1.7085, instance_loss: 1.3286, weighted_loss: 1.5946, label: 1, bag_size: 1371
batch 99, loss: 0.0293, instance_loss: 1.4351, weighted_loss: 0.4510, label: 1, bag_size: 5756
batch 119, loss: 0.8718, instance_loss: 1.3185, weighted_loss: 1.0058, label: 2, bag_size: 3299
batch 139, loss: 0.0263, instance_loss: 0.1186, weighted_loss: 0.0540, label: 2, bag_size: 4555
batch 159, loss: 0.1097, instance_loss: 0.2258, weighted_loss: 0.1445, label: 1, bag_size: 2962
batch 179, loss: 0.4480, instance_loss: 0.3021, weighted_loss: 0.4042, label: 0, bag_size: 3038
batch 199, loss: 0.0402, instance_loss: 0.1668, weighted_loss: 0.0782, label: 0, bag_size: 3533
batch 219, loss: 0.0516, instance_loss: 0.0848, weighted_loss: 0.0616, label: 0, bag_size: 5915
batch 239, loss: 0.0208, instance_loss: 0.2769, weighted_loss: 0.0976, label: 0, bag_size: 3297
batch 259, loss: 0.6128, instance_loss: 0.6437, weighted_loss: 0.6220, label: 1, bag_size: 3823
batch 279, loss: 0.0375, instance_loss: 0.1410, weighted_loss: 0.0686, label: 2, bag_size: 4555
batch 299, loss: 0.3169, instance_loss: 0.4728, weighted_loss: 0.3636, label: 2, bag_size: 6644
batch 319, loss: 0.0122, instance_loss: 0.1655, weighted_loss: 0.0582, label: 2, bag_size: 3583
batch 339, loss: 0.2356, instance_loss: 0.3434, weighted_loss: 0.2679, label: 2, bag_size: 3778
batch 359, loss: 0.4358, instance_loss: 0.4944, weighted_loss: 0.4534, label: 0, bag_size: 4604
batch 379, loss: 1.3696, instance_loss: 0.9157, weighted_loss: 1.2334, label: 0, bag_size: 1025
batch 399, loss: 0.0461, instance_loss: 0.2996, weighted_loss: 0.1221, label: 0, bag_size: 2286
batch 419, loss: 0.0023, instance_loss: 0.0848, weighted_loss: 0.0271, label: 2, bag_size: 2209
batch 439, loss: 1.2916, instance_loss: 1.1382, weighted_loss: 1.2455, label: 2, bag_size: 7607
batch 459, loss: 0.3100, instance_loss: 0.4830, weighted_loss: 0.3619, label: 0, bag_size: 1492
batch 479, loss: 0.0697, instance_loss: 0.1240, weighted_loss: 0.0860, label: 0, bag_size: 3924
batch 499, loss: 0.5336, instance_loss: 0.7736, weighted_loss: 0.6056, label: 2, bag_size: 7607
batch 519, loss: 0.0105, instance_loss: 0.1676, weighted_loss: 0.0577, label: 0, bag_size: 1647
batch 539, loss: 0.4381, instance_loss: 0.5593, weighted_loss: 0.4745, label: 0, bag_size: 5098
batch 559, loss: 0.2021, instance_loss: 0.3647, weighted_loss: 0.2509, label: 1, bag_size: 3755
batch 579, loss: 0.6774, instance_loss: 0.8136, weighted_loss: 0.7183, label: 2, bag_size: 7607
batch 599, loss: 0.2703, instance_loss: 0.6735, weighted_loss: 0.3913, label: 0, bag_size: 2189
batch 619, loss: 1.0097, instance_loss: 0.7378, weighted_loss: 0.9281, label: 2, bag_size: 728
batch 639, loss: 0.6469, instance_loss: 0.5737, weighted_loss: 0.6249, label: 1, bag_size: 1042
batch 659, loss: 0.4318, instance_loss: 0.5082, weighted_loss: 0.4547, label: 2, bag_size: 3172
batch 679, loss: 0.3466, instance_loss: 0.5015, weighted_loss: 0.3930, label: 0, bag_size: 4274
batch 699, loss: 0.0813, instance_loss: 0.3087, weighted_loss: 0.1495, label: 1, bag_size: 3007
batch 719, loss: 0.0214, instance_loss: 0.1904, weighted_loss: 0.0721, label: 0, bag_size: 2607
batch 739, loss: 0.0097, instance_loss: 0.1626, weighted_loss: 0.0556, label: 2, bag_size: 614


class 0 clustering acc 0.9667785234899329: correct 17286/17880
class 1 clustering acc 0.43389261744966445: correct 2586/5960
Epoch: 37, train_loss: 0.4829, train_clustering_loss:  0.5150, train_error: 0.1960
class 0: acc 0.8333333333333334, correct 215/258
class 1: acc 0.6919642857142857, correct 155/224
class 2: acc 0.870722433460076, correct 229/263

Val Set, val_loss: 0.9424, val_error: 0.3298, auc: 0.8499
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.2898936170212766: correct 218/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0404, instance_loss: 0.2155, weighted_loss: 0.0929, label: 2, bag_size: 6594
batch 39, loss: 0.3744, instance_loss: 0.6924, weighted_loss: 0.4698, label: 1, bag_size: 5718
batch 59, loss: 1.2948, instance_loss: 1.5302, weighted_loss: 1.3654, label: 2, bag_size: 4910
batch 79, loss: 0.0111, instance_loss: 0.1501, weighted_loss: 0.0528, label: 0, bag_size: 4744
batch 99, loss: 0.0020, instance_loss: 0.0732, weighted_loss: 0.0233, label: 2, bag_size: 4140
batch 119, loss: 0.1070, instance_loss: 0.6369, weighted_loss: 0.2660, label: 1, bag_size: 2009
batch 139, loss: 0.3563, instance_loss: 0.2321, weighted_loss: 0.3190, label: 2, bag_size: 3026
batch 159, loss: 0.0911, instance_loss: 0.4592, weighted_loss: 0.2015, label: 1, bag_size: 6277
batch 179, loss: 0.0432, instance_loss: 0.1458, weighted_loss: 0.0740, label: 2, bag_size: 4569
batch 199, loss: 1.1720, instance_loss: 1.3018, weighted_loss: 1.2109, label: 1, bag_size: 4145
batch 219, loss: 1.0790, instance_loss: 0.5180, weighted_loss: 0.9107, label: 0, bag_size: 13770
batch 239, loss: 0.0005, instance_loss: 0.6228, weighted_loss: 0.1872, label: 1, bag_size: 4134
batch 259, loss: 0.1932, instance_loss: 0.4381, weighted_loss: 0.2667, label: 1, bag_size: 4869
batch 279, loss: 0.0457, instance_loss: 0.1239, weighted_loss: 0.0691, label: 0, bag_size: 4734
batch 299, loss: 0.5432, instance_loss: 0.7259, weighted_loss: 0.5980, label: 2, bag_size: 3112
batch 319, loss: 0.6967, instance_loss: 0.5759, weighted_loss: 0.6605, label: 2, bag_size: 1222
batch 339, loss: 0.1286, instance_loss: 0.7089, weighted_loss: 0.3027, label: 2, bag_size: 4910
batch 359, loss: 0.0427, instance_loss: 0.9913, weighted_loss: 0.3273, label: 0, bag_size: 2231
batch 379, loss: 0.1002, instance_loss: 0.1104, weighted_loss: 0.1033, label: 1, bag_size: 8802
batch 399, loss: 1.0984, instance_loss: 0.8340, weighted_loss: 1.0191, label: 0, bag_size: 421
batch 419, loss: 0.0116, instance_loss: 0.0819, weighted_loss: 0.0327, label: 2, bag_size: 3678
batch 439, loss: 0.0406, instance_loss: 0.1412, weighted_loss: 0.0708, label: 2, bag_size: 4788
batch 459, loss: 0.2187, instance_loss: 0.4233, weighted_loss: 0.2801, label: 2, bag_size: 3604
batch 479, loss: 0.0588, instance_loss: 0.1184, weighted_loss: 0.0767, label: 2, bag_size: 3497
batch 499, loss: 0.6478, instance_loss: 0.7970, weighted_loss: 0.6926, label: 2, bag_size: 22464
batch 519, loss: 0.0015, instance_loss: 0.1115, weighted_loss: 0.0345, label: 1, bag_size: 5229
batch 539, loss: 0.6528, instance_loss: 0.4822, weighted_loss: 0.6016, label: 2, bag_size: 597
batch 559, loss: 0.7297, instance_loss: 0.8671, weighted_loss: 0.7709, label: 1, bag_size: 869
batch 579, loss: 0.0518, instance_loss: 0.3967, weighted_loss: 0.1553, label: 1, bag_size: 209
batch 599, loss: 0.0503, instance_loss: 0.1410, weighted_loss: 0.0775, label: 2, bag_size: 4856
batch 619, loss: 0.2464, instance_loss: 0.6057, weighted_loss: 0.3541, label: 0, bag_size: 2139
batch 639, loss: 0.9836, instance_loss: 0.5670, weighted_loss: 0.8586, label: 1, bag_size: 1595
batch 659, loss: 2.1723, instance_loss: 0.8475, weighted_loss: 1.7749, label: 1, bag_size: 3508
batch 679, loss: 0.2655, instance_loss: 0.2606, weighted_loss: 0.2641, label: 0, bag_size: 6445
batch 699, loss: 0.0798, instance_loss: 0.2192, weighted_loss: 0.1216, label: 2, bag_size: 3327
batch 719, loss: 1.2278, instance_loss: 0.8582, weighted_loss: 1.1169, label: 1, bag_size: 667
batch 739, loss: 0.7261, instance_loss: 0.8530, weighted_loss: 0.7641, label: 0, bag_size: 8611


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.41375838926174496: correct 2466/5960
Epoch: 38, train_loss: 0.5032, train_clustering_loss:  0.5247, train_error: 0.2000
class 0: acc 0.8132780082987552, correct 196/241
class 1: acc 0.7449392712550608, correct 184/247
class 2: acc 0.8404669260700389, correct 216/257

Val Set, val_loss: 0.8279, val_error: 0.3191, auc: 0.8624
class 0 clustering acc 0.9685283687943262: correct 2185/2256
class 1 clustering acc 0.24601063829787234: correct 185/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.4282, instance_loss: 0.2711, weighted_loss: 0.3811, label: 2, bag_size: 3026
batch 39, loss: 0.6105, instance_loss: 0.6711, weighted_loss: 0.6287, label: 0, bag_size: 1141
batch 59, loss: 0.0058, instance_loss: 0.0709, weighted_loss: 0.0253, label: 2, bag_size: 6148
batch 79, loss: 0.1731, instance_loss: 0.3488, weighted_loss: 0.2258, label: 0, bag_size: 640
batch 99, loss: 0.1033, instance_loss: 0.2826, weighted_loss: 0.1571, label: 1, bag_size: 3296
batch 119, loss: 0.0015, instance_loss: 0.2541, weighted_loss: 0.0773, label: 2, bag_size: 4497
batch 139, loss: 0.2708, instance_loss: 0.5697, weighted_loss: 0.3605, label: 1, bag_size: 5118
batch 159, loss: 0.5208, instance_loss: 0.6279, weighted_loss: 0.5529, label: 0, bag_size: 4274
batch 179, loss: 0.0084, instance_loss: 0.2245, weighted_loss: 0.0733, label: 2, bag_size: 2770
batch 199, loss: 0.0171, instance_loss: 0.0888, weighted_loss: 0.0386, label: 2, bag_size: 2483
batch 219, loss: 0.4393, instance_loss: 0.7944, weighted_loss: 0.5458, label: 1, bag_size: 4069
batch 239, loss: 0.1384, instance_loss: 0.7043, weighted_loss: 0.3082, label: 1, bag_size: 3821
batch 259, loss: 1.0511, instance_loss: 0.5595, weighted_loss: 0.9036, label: 2, bag_size: 4241
batch 279, loss: 0.5755, instance_loss: 0.7469, weighted_loss: 0.6269, label: 0, bag_size: 1904
batch 299, loss: 1.4762, instance_loss: 1.2927, weighted_loss: 1.4211, label: 1, bag_size: 5693
batch 319, loss: 0.1532, instance_loss: 0.4389, weighted_loss: 0.2389, label: 1, bag_size: 4869
batch 339, loss: 0.1037, instance_loss: 0.4992, weighted_loss: 0.2223, label: 0, bag_size: 4485
batch 359, loss: 0.6186, instance_loss: 0.7334, weighted_loss: 0.6531, label: 1, bag_size: 5718
batch 379, loss: 0.7750, instance_loss: 1.0674, weighted_loss: 0.8627, label: 1, bag_size: 2743
batch 399, loss: 0.0518, instance_loss: 0.4814, weighted_loss: 0.1807, label: 0, bag_size: 1933
batch 419, loss: 0.1049, instance_loss: 0.3382, weighted_loss: 0.1749, label: 0, bag_size: 2286
batch 439, loss: 0.4989, instance_loss: 0.7995, weighted_loss: 0.5891, label: 1, bag_size: 3391
batch 459, loss: 1.8483, instance_loss: 1.1025, weighted_loss: 1.6246, label: 1, bag_size: 2481
batch 479, loss: 0.1394, instance_loss: 0.2543, weighted_loss: 0.1739, label: 0, bag_size: 3924
batch 499, loss: 0.0560, instance_loss: 0.2065, weighted_loss: 0.1012, label: 0, bag_size: 1233
batch 519, loss: 0.0092, instance_loss: 0.0672, weighted_loss: 0.0266, label: 0, bag_size: 3754
batch 539, loss: 0.0624, instance_loss: 0.3742, weighted_loss: 0.1559, label: 0, bag_size: 3319
batch 559, loss: 0.7915, instance_loss: 0.7095, weighted_loss: 0.7669, label: 0, bag_size: 3475
batch 579, loss: 0.0013, instance_loss: 0.0902, weighted_loss: 0.0280, label: 2, bag_size: 2422
batch 599, loss: 1.3449, instance_loss: 1.3225, weighted_loss: 1.3382, label: 1, bag_size: 4612
batch 619, loss: 1.3006, instance_loss: 0.5093, weighted_loss: 1.0632, label: 2, bag_size: 3112
batch 639, loss: 0.0626, instance_loss: 0.2945, weighted_loss: 0.1322, label: 2, bag_size: 5472
batch 659, loss: 0.0097, instance_loss: 0.2937, weighted_loss: 0.0949, label: 0, bag_size: 5646
batch 679, loss: 0.2106, instance_loss: 0.2610, weighted_loss: 0.2257, label: 0, bag_size: 4604
batch 699, loss: 0.5265, instance_loss: 0.8253, weighted_loss: 0.6161, label: 2, bag_size: 724
batch 719, loss: 0.0053, instance_loss: 0.0756, weighted_loss: 0.0264, label: 2, bag_size: 2483
batch 739, loss: 0.0389, instance_loss: 0.2427, weighted_loss: 0.1001, label: 2, bag_size: 614


class 0 clustering acc 0.9682885906040268: correct 17313/17880
class 1 clustering acc 0.4325503355704698: correct 2578/5960
Epoch: 39, train_loss: 0.4817, train_clustering_loss:  0.5071, train_error: 0.2121
class 0: acc 0.8301158301158301, correct 215/259
class 1: acc 0.6497695852534562, correct 141/217
class 2: acc 0.8587360594795539, correct 231/269

Val Set, val_loss: 0.7566, val_error: 0.2234, auc: 0.8606
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.3058510638297872: correct 230/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0458, instance_loss: 0.1916, weighted_loss: 0.0895, label: 0, bag_size: 6138
batch 39, loss: 0.0201, instance_loss: 0.2627, weighted_loss: 0.0929, label: 0, bag_size: 2257
batch 59, loss: 0.0737, instance_loss: 0.1921, weighted_loss: 0.1092, label: 0, bag_size: 4894
batch 79, loss: 4.0433, instance_loss: 1.6393, weighted_loss: 3.3221, label: 0, bag_size: 3750
batch 99, loss: 1.5245, instance_loss: 0.7587, weighted_loss: 1.2948, label: 2, bag_size: 6644
batch 119, loss: 0.2347, instance_loss: 0.1884, weighted_loss: 0.2208, label: 2, bag_size: 3396
batch 139, loss: 0.3199, instance_loss: 0.3351, weighted_loss: 0.3244, label: 2, bag_size: 5924
batch 159, loss: 0.0569, instance_loss: 0.1760, weighted_loss: 0.0926, label: 0, bag_size: 4092
batch 179, loss: 0.2612, instance_loss: 0.4531, weighted_loss: 0.3188, label: 0, bag_size: 5340
batch 199, loss: 0.0222, instance_loss: 0.1236, weighted_loss: 0.0526, label: 0, bag_size: 5459
batch 219, loss: 0.0059, instance_loss: 0.1702, weighted_loss: 0.0551, label: 0, bag_size: 855
batch 239, loss: 0.0531, instance_loss: 0.2436, weighted_loss: 0.1103, label: 2, bag_size: 5037
batch 259, loss: 1.9155, instance_loss: 0.9402, weighted_loss: 1.6229, label: 0, bag_size: 1025
batch 279, loss: 0.5995, instance_loss: 0.7012, weighted_loss: 0.6300, label: 1, bag_size: 5833
batch 299, loss: 0.3204, instance_loss: 0.5362, weighted_loss: 0.3851, label: 1, bag_size: 4869
batch 319, loss: 0.3162, instance_loss: 0.8265, weighted_loss: 0.4693, label: 2, bag_size: 3299
batch 339, loss: 0.0483, instance_loss: 0.2335, weighted_loss: 0.1039, label: 1, bag_size: 7135
batch 359, loss: 0.3795, instance_loss: 0.4628, weighted_loss: 0.4045, label: 1, bag_size: 1029
batch 379, loss: 0.0621, instance_loss: 0.1569, weighted_loss: 0.0905, label: 2, bag_size: 88
batch 399, loss: 1.7763, instance_loss: 0.7357, weighted_loss: 1.4641, label: 2, bag_size: 909
batch 419, loss: 0.0088, instance_loss: 0.0826, weighted_loss: 0.0309, label: 2, bag_size: 3094
batch 439, loss: 0.0119, instance_loss: 0.0791, weighted_loss: 0.0321, label: 2, bag_size: 3285
batch 459, loss: 0.0129, instance_loss: 0.1158, weighted_loss: 0.0438, label: 0, bag_size: 1845
batch 479, loss: 0.0510, instance_loss: 0.2504, weighted_loss: 0.1108, label: 0, bag_size: 3334
batch 499, loss: 1.0074, instance_loss: 0.6446, weighted_loss: 0.8986, label: 2, bag_size: 5743
batch 519, loss: 0.4312, instance_loss: 0.4912, weighted_loss: 0.4492, label: 0, bag_size: 3864
batch 539, loss: 1.0185, instance_loss: 0.6253, weighted_loss: 0.9006, label: 1, bag_size: 6243
batch 559, loss: 0.9946, instance_loss: 0.8585, weighted_loss: 0.9538, label: 1, bag_size: 11768
batch 579, loss: 0.0015, instance_loss: 0.1740, weighted_loss: 0.0532, label: 2, bag_size: 4497
batch 599, loss: 2.6425, instance_loss: 1.4075, weighted_loss: 2.2720, label: 1, bag_size: 3791
batch 619, loss: 2.6677, instance_loss: 1.6908, weighted_loss: 2.3746, label: 0, bag_size: 2392
batch 639, loss: 0.0480, instance_loss: 0.5072, weighted_loss: 0.1857, label: 0, bag_size: 1006
batch 659, loss: 1.3866, instance_loss: 0.6840, weighted_loss: 1.1759, label: 1, bag_size: 4373
batch 679, loss: 0.1575, instance_loss: 0.6806, weighted_loss: 0.3145, label: 1, bag_size: 832
batch 699, loss: 0.4994, instance_loss: 1.2180, weighted_loss: 0.7150, label: 1, bag_size: 3821
batch 719, loss: 0.0007, instance_loss: 0.1960, weighted_loss: 0.0593, label: 2, bag_size: 4497
batch 739, loss: 0.5322, instance_loss: 0.7077, weighted_loss: 0.5848, label: 1, bag_size: 4898


class 0 clustering acc 0.9668903803131991: correct 17288/17880
class 1 clustering acc 0.4343959731543624: correct 2589/5960
Epoch: 40, train_loss: 0.4689, train_clustering_loss:  0.5155, train_error: 0.1906
class 0: acc 0.8228346456692913, correct 209/254
class 1: acc 0.7333333333333333, correct 165/225
class 2: acc 0.8609022556390977, correct 229/266

Val Set, val_loss: 0.7572, val_error: 0.2340, auc: 0.8831
class 0 clustering acc 0.9441489361702128: correct 2130/2256
class 1 clustering acc 0.4654255319148936: correct 350/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0535, instance_loss: 0.3438, weighted_loss: 0.1406, label: 2, bag_size: 3172
batch 39, loss: 0.8970, instance_loss: 0.8849, weighted_loss: 0.8934, label: 0, bag_size: 4509
batch 59, loss: 0.0631, instance_loss: 0.3850, weighted_loss: 0.1597, label: 1, bag_size: 3398
batch 79, loss: 0.1407, instance_loss: 0.1876, weighted_loss: 0.1547, label: 2, bag_size: 2481
batch 99, loss: 0.1966, instance_loss: 0.3637, weighted_loss: 0.2467, label: 1, bag_size: 4898
batch 119, loss: 0.0533, instance_loss: 0.2346, weighted_loss: 0.1077, label: 0, bag_size: 3924
batch 139, loss: 0.2366, instance_loss: 0.6995, weighted_loss: 0.3754, label: 1, bag_size: 5718
batch 159, loss: 0.0969, instance_loss: 0.2584, weighted_loss: 0.1454, label: 2, bag_size: 614
batch 179, loss: 0.2003, instance_loss: 0.2143, weighted_loss: 0.2045, label: 2, bag_size: 597
batch 199, loss: 0.0265, instance_loss: 0.1887, weighted_loss: 0.0751, label: 0, bag_size: 4831
batch 219, loss: 1.9670, instance_loss: 1.0328, weighted_loss: 1.6868, label: 1, bag_size: 1477
batch 239, loss: 0.0733, instance_loss: 0.3216, weighted_loss: 0.1478, label: 2, bag_size: 3172
batch 259, loss: 0.0290, instance_loss: 0.1711, weighted_loss: 0.0717, label: 0, bag_size: 3304
batch 279, loss: 2.4319, instance_loss: 1.4069, weighted_loss: 2.1244, label: 0, bag_size: 557
batch 299, loss: 0.0144, instance_loss: 0.0658, weighted_loss: 0.0298, label: 0, bag_size: 3406
batch 319, loss: 0.0092, instance_loss: 0.1089, weighted_loss: 0.0391, label: 0, bag_size: 3641
batch 339, loss: 0.4820, instance_loss: 0.4454, weighted_loss: 0.4711, label: 0, bag_size: 2428
batch 359, loss: 0.0821, instance_loss: 0.1669, weighted_loss: 0.1075, label: 2, bag_size: 3396
batch 379, loss: 0.0891, instance_loss: 0.1581, weighted_loss: 0.1098, label: 2, bag_size: 1103
batch 399, loss: 0.6744, instance_loss: 0.7886, weighted_loss: 0.7086, label: 2, bag_size: 3604
batch 419, loss: 0.2807, instance_loss: 0.8574, weighted_loss: 0.4537, label: 2, bag_size: 4571
batch 439, loss: 0.0246, instance_loss: 0.1216, weighted_loss: 0.0537, label: 0, bag_size: 1485
batch 459, loss: 0.0789, instance_loss: 0.5344, weighted_loss: 0.2155, label: 0, bag_size: 889
batch 479, loss: 0.1158, instance_loss: 0.2499, weighted_loss: 0.1560, label: 1, bag_size: 3007
batch 499, loss: 0.3885, instance_loss: 0.7213, weighted_loss: 0.4884, label: 2, bag_size: 724
batch 519, loss: 0.0373, instance_loss: 0.0730, weighted_loss: 0.0480, label: 2, bag_size: 4140
batch 539, loss: 0.2506, instance_loss: 0.4029, weighted_loss: 0.2963, label: 0, bag_size: 4577
batch 559, loss: 0.3760, instance_loss: 0.1515, weighted_loss: 0.3086, label: 2, bag_size: 3026
batch 579, loss: 0.0148, instance_loss: 0.0877, weighted_loss: 0.0367, label: 2, bag_size: 5037
batch 599, loss: 0.8300, instance_loss: 0.9212, weighted_loss: 0.8574, label: 1, bag_size: 4694
batch 619, loss: 0.1968, instance_loss: 0.4521, weighted_loss: 0.2734, label: 2, bag_size: 1543
batch 639, loss: 1.5366, instance_loss: 1.2219, weighted_loss: 1.4422, label: 1, bag_size: 5880
batch 659, loss: 0.0174, instance_loss: 0.0658, weighted_loss: 0.0319, label: 0, bag_size: 4741
batch 679, loss: 0.0115, instance_loss: 0.1378, weighted_loss: 0.0494, label: 2, bag_size: 3810
batch 699, loss: 0.2497, instance_loss: 0.3932, weighted_loss: 0.2927, label: 0, bag_size: 7056
batch 719, loss: 1.3926, instance_loss: 1.0009, weighted_loss: 1.2751, label: 0, bag_size: 15388
batch 739, loss: 0.6809, instance_loss: 0.7273, weighted_loss: 0.6948, label: 2, bag_size: 4571


class 0 clustering acc 0.9656599552572707: correct 17266/17880
class 1 clustering acc 0.4442953020134228: correct 2648/5960
Epoch: 41, train_loss: 0.4834, train_clustering_loss:  0.5086, train_error: 0.2094
class 0: acc 0.7869565217391304, correct 181/230
class 1: acc 0.6767241379310345, correct 157/232
class 2: acc 0.8869257950530035, correct 251/283

Val Set, val_loss: 0.7417, val_error: 0.2660, auc: 0.8723
class 0 clustering acc 0.9791666666666666: correct 2209/2256
class 1 clustering acc 0.25: correct 188/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2867, instance_loss: 0.5419, weighted_loss: 0.3633, label: 2, bag_size: 4291
batch 39, loss: 1.0633, instance_loss: 0.7540, weighted_loss: 0.9705, label: 0, bag_size: 4201
batch 59, loss: 0.1712, instance_loss: 1.4465, weighted_loss: 0.5538, label: 0, bag_size: 1645
batch 79, loss: 0.0308, instance_loss: 0.2073, weighted_loss: 0.0837, label: 2, bag_size: 2422
batch 99, loss: 0.3170, instance_loss: 0.4004, weighted_loss: 0.3420, label: 1, bag_size: 3519
batch 119, loss: 0.0368, instance_loss: 0.2771, weighted_loss: 0.1089, label: 0, bag_size: 5782
batch 139, loss: 0.1522, instance_loss: 0.3744, weighted_loss: 0.2189, label: 0, bag_size: 6863
batch 159, loss: 0.0307, instance_loss: 0.0842, weighted_loss: 0.0468, label: 2, bag_size: 1094
batch 179, loss: 0.0353, instance_loss: 0.2670, weighted_loss: 0.1048, label: 0, bag_size: 1034
batch 199, loss: 0.2169, instance_loss: 0.2699, weighted_loss: 0.2328, label: 2, bag_size: 3546
batch 219, loss: 0.1534, instance_loss: 0.3186, weighted_loss: 0.2029, label: 0, bag_size: 4251
batch 239, loss: 0.4468, instance_loss: 0.4629, weighted_loss: 0.4516, label: 1, bag_size: 4184
batch 259, loss: 0.0408, instance_loss: 0.4554, weighted_loss: 0.1652, label: 1, bag_size: 5118
batch 279, loss: 0.0277, instance_loss: 0.2312, weighted_loss: 0.0887, label: 0, bag_size: 4092
batch 299, loss: 0.0651, instance_loss: 0.0621, weighted_loss: 0.0642, label: 2, bag_size: 4788
batch 319, loss: 0.3472, instance_loss: 0.2615, weighted_loss: 0.3215, label: 1, bag_size: 2919
batch 339, loss: 0.0229, instance_loss: 0.2551, weighted_loss: 0.0925, label: 2, bag_size: 4141
batch 359, loss: 0.0952, instance_loss: 0.2943, weighted_loss: 0.1549, label: 1, bag_size: 3983
batch 379, loss: 1.8346, instance_loss: 1.2248, weighted_loss: 1.6517, label: 0, bag_size: 603
batch 399, loss: 0.6002, instance_loss: 0.5128, weighted_loss: 0.5740, label: 1, bag_size: 578
batch 419, loss: 0.0128, instance_loss: 0.3298, weighted_loss: 0.1079, label: 1, bag_size: 7279
batch 439, loss: 0.0003, instance_loss: 0.1206, weighted_loss: 0.0364, label: 1, bag_size: 6277
batch 459, loss: 0.1215, instance_loss: 0.5262, weighted_loss: 0.2429, label: 0, bag_size: 3754
batch 479, loss: 0.9963, instance_loss: 0.9702, weighted_loss: 0.9885, label: 0, bag_size: 5023
batch 499, loss: 1.1755, instance_loss: 0.7898, weighted_loss: 1.0598, label: 0, bag_size: 4146
batch 519, loss: 0.0014, instance_loss: 0.0188, weighted_loss: 0.0066, label: 2, bag_size: 4910
batch 539, loss: 0.0136, instance_loss: 0.1587, weighted_loss: 0.0571, label: 0, bag_size: 3339
batch 559, loss: 0.0226, instance_loss: 0.1562, weighted_loss: 0.0627, label: 1, bag_size: 5026
batch 579, loss: 0.1603, instance_loss: 0.4650, weighted_loss: 0.2517, label: 1, bag_size: 2083
batch 599, loss: 0.0458, instance_loss: 0.2384, weighted_loss: 0.1036, label: 2, bag_size: 4569
batch 619, loss: 3.0654, instance_loss: 1.4420, weighted_loss: 2.5784, label: 1, bag_size: 1964
batch 639, loss: 0.0000, instance_loss: 0.6628, weighted_loss: 0.1989, label: 0, bag_size: 2028
batch 659, loss: 0.2723, instance_loss: 0.5022, weighted_loss: 0.3413, label: 2, bag_size: 3778
batch 679, loss: 0.0409, instance_loss: 0.1765, weighted_loss: 0.0816, label: 0, bag_size: 3368
batch 699, loss: 1.6683, instance_loss: 0.8623, weighted_loss: 1.4265, label: 2, bag_size: 4241
batch 719, loss: 1.8014, instance_loss: 1.0663, weighted_loss: 1.5809, label: 1, bag_size: 1313
batch 739, loss: 0.0885, instance_loss: 0.9694, weighted_loss: 0.3528, label: 1, bag_size: 20666


class 0 clustering acc 0.9645973154362416: correct 17247/17880
class 1 clustering acc 0.3838926174496644: correct 2288/5960
Epoch: 42, train_loss: 0.5231, train_clustering_loss:  0.5542, train_error: 0.2268
class 0: acc 0.7747747747747747, correct 172/222
class 1: acc 0.7213740458015268, correct 189/262
class 2: acc 0.8237547892720306, correct 215/261

Val Set, val_loss: 0.8790, val_error: 0.3298, auc: 0.8603
class 0 clustering acc 0.9818262411347518: correct 2215/2256
class 1 clustering acc 0.18085106382978725: correct 136/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1066, instance_loss: 0.1587, weighted_loss: 0.1222, label: 1, bag_size: 3425
batch 39, loss: 0.1007, instance_loss: 0.2573, weighted_loss: 0.1477, label: 2, bag_size: 4555
batch 59, loss: 0.6920, instance_loss: 0.8626, weighted_loss: 0.7432, label: 2, bag_size: 4179
batch 79, loss: 0.2113, instance_loss: 0.5372, weighted_loss: 0.3091, label: 0, bag_size: 1052
batch 99, loss: 0.1875, instance_loss: 0.3890, weighted_loss: 0.2479, label: 0, bag_size: 7177
batch 119, loss: 0.5361, instance_loss: 0.5569, weighted_loss: 0.5423, label: 2, bag_size: 1543
batch 139, loss: 2.5064, instance_loss: 1.3273, weighted_loss: 2.1527, label: 0, bag_size: 1886
batch 159, loss: 1.3655, instance_loss: 1.0327, weighted_loss: 1.2657, label: 1, bag_size: 1307
batch 179, loss: 0.4794, instance_loss: 0.8134, weighted_loss: 0.5796, label: 1, bag_size: 1307
batch 199, loss: 0.4787, instance_loss: 0.5067, weighted_loss: 0.4871, label: 2, bag_size: 4132
batch 219, loss: 1.4381, instance_loss: 0.7829, weighted_loss: 1.2416, label: 0, bag_size: 272
batch 239, loss: 0.2305, instance_loss: 0.3787, weighted_loss: 0.2750, label: 0, bag_size: 3690
batch 259, loss: 0.1569, instance_loss: 0.1866, weighted_loss: 0.1658, label: 2, bag_size: 3534
batch 279, loss: 1.5612, instance_loss: 1.1281, weighted_loss: 1.4312, label: 1, bag_size: 4467
batch 299, loss: 0.0415, instance_loss: 0.2135, weighted_loss: 0.0931, label: 0, bag_size: 3334
batch 319, loss: 0.0135, instance_loss: 0.1556, weighted_loss: 0.0561, label: 2, bag_size: 614
batch 339, loss: 0.3414, instance_loss: 0.0941, weighted_loss: 0.2672, label: 0, bag_size: 5902
batch 359, loss: 0.2597, instance_loss: 0.8875, weighted_loss: 0.4481, label: 2, bag_size: 4910
batch 379, loss: 0.0206, instance_loss: 0.1279, weighted_loss: 0.0528, label: 0, bag_size: 1132
batch 399, loss: 0.2851, instance_loss: 0.6830, weighted_loss: 0.4045, label: 1, bag_size: 5197
batch 419, loss: 0.0737, instance_loss: 0.1928, weighted_loss: 0.1095, label: 0, bag_size: 2479
batch 439, loss: 0.8193, instance_loss: 0.7576, weighted_loss: 0.8008, label: 2, bag_size: 1543
batch 459, loss: 0.6800, instance_loss: 0.9208, weighted_loss: 0.7522, label: 1, bag_size: 5276
batch 479, loss: 0.5664, instance_loss: 0.9231, weighted_loss: 0.6734, label: 1, bag_size: 5718
batch 499, loss: 0.2046, instance_loss: 0.3726, weighted_loss: 0.2550, label: 2, bag_size: 5307
batch 519, loss: 0.0545, instance_loss: 0.1211, weighted_loss: 0.0745, label: 2, bag_size: 4132
batch 539, loss: 0.0237, instance_loss: 0.1729, weighted_loss: 0.0685, label: 0, bag_size: 2019
batch 559, loss: 0.0156, instance_loss: 0.0838, weighted_loss: 0.0360, label: 2, bag_size: 4088
batch 579, loss: 0.4030, instance_loss: 0.3026, weighted_loss: 0.3729, label: 2, bag_size: 2561
batch 599, loss: 1.7690, instance_loss: 0.8952, weighted_loss: 1.5069, label: 1, bag_size: 3935
batch 619, loss: 2.7984, instance_loss: 1.8477, weighted_loss: 2.5131, label: 1, bag_size: 2927
batch 639, loss: 0.1107, instance_loss: 0.1820, weighted_loss: 0.1321, label: 1, bag_size: 2767
batch 659, loss: 0.5067, instance_loss: 0.7125, weighted_loss: 0.5685, label: 1, bag_size: 1607
batch 679, loss: 0.0773, instance_loss: 0.6173, weighted_loss: 0.2393, label: 0, bag_size: 1812
batch 699, loss: 0.2646, instance_loss: 0.3886, weighted_loss: 0.3018, label: 0, bag_size: 6927
batch 719, loss: 0.5984, instance_loss: 0.4461, weighted_loss: 0.5527, label: 0, bag_size: 7315
batch 739, loss: 0.0104, instance_loss: 0.1045, weighted_loss: 0.0386, label: 2, bag_size: 6148


class 0 clustering acc 0.9676733780760627: correct 17302/17880
class 1 clustering acc 0.4332214765100671: correct 2582/5960
Epoch: 43, train_loss: 0.4462, train_clustering_loss:  0.5011, train_error: 0.1812
class 0: acc 0.8204081632653061, correct 201/245
class 1: acc 0.751004016064257, correct 187/249
class 2: acc 0.8844621513944223, correct 222/251

Val Set, val_loss: 0.6723, val_error: 0.2234, auc: 0.8835
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.3882978723404255: correct 292/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1386, instance_loss: 0.2226, weighted_loss: 0.1638, label: 1, bag_size: 1807
batch 39, loss: 1.4843, instance_loss: 0.8345, weighted_loss: 1.2894, label: 2, bag_size: 2326
batch 59, loss: 0.6900, instance_loss: 0.7356, weighted_loss: 0.7037, label: 1, bag_size: 1607
batch 79, loss: 0.0043, instance_loss: 0.8011, weighted_loss: 0.2433, label: 0, bag_size: 1055
batch 99, loss: 0.1996, instance_loss: 0.3834, weighted_loss: 0.2547, label: 2, bag_size: 2359
batch 119, loss: 1.5836, instance_loss: 1.0165, weighted_loss: 1.4135, label: 1, bag_size: 4940
batch 139, loss: 0.3635, instance_loss: 0.4359, weighted_loss: 0.3853, label: 0, bag_size: 3904
batch 159, loss: 0.0252, instance_loss: 0.1279, weighted_loss: 0.0560, label: 2, bag_size: 4569
batch 179, loss: 0.0349, instance_loss: 0.2920, weighted_loss: 0.1120, label: 0, bag_size: 4251
batch 199, loss: 0.0039, instance_loss: 0.8147, weighted_loss: 0.2471, label: 2, bag_size: 2031
batch 219, loss: 0.4454, instance_loss: 0.5367, weighted_loss: 0.4728, label: 1, bag_size: 4184
batch 239, loss: 0.1170, instance_loss: 0.5573, weighted_loss: 0.2491, label: 0, bag_size: 3367
batch 259, loss: 0.7875, instance_loss: 0.7322, weighted_loss: 0.7709, label: 1, bag_size: 3508
batch 279, loss: 0.0695, instance_loss: 0.5402, weighted_loss: 0.2107, label: 0, bag_size: 3797
batch 299, loss: 0.5777, instance_loss: 0.5559, weighted_loss: 0.5711, label: 0, bag_size: 4562
batch 319, loss: 0.0062, instance_loss: 0.2684, weighted_loss: 0.0849, label: 1, bag_size: 4534
batch 339, loss: 0.0072, instance_loss: 0.1135, weighted_loss: 0.0391, label: 0, bag_size: 4783
batch 359, loss: 0.2517, instance_loss: 0.4818, weighted_loss: 0.3208, label: 1, bag_size: 6817
batch 379, loss: 0.0260, instance_loss: 0.4929, weighted_loss: 0.1660, label: 2, bag_size: 3607
batch 399, loss: 0.5180, instance_loss: 0.3700, weighted_loss: 0.4736, label: 1, bag_size: 1410
batch 419, loss: 0.0843, instance_loss: 0.2057, weighted_loss: 0.1207, label: 2, bag_size: 2997
batch 439, loss: 0.3697, instance_loss: 0.3238, weighted_loss: 0.3559, label: 1, bag_size: 4119
batch 459, loss: 0.3550, instance_loss: 0.7295, weighted_loss: 0.4674, label: 0, bag_size: 7177
batch 479, loss: 1.1710, instance_loss: 0.7993, weighted_loss: 1.0595, label: 1, bag_size: 782
batch 499, loss: 1.0822, instance_loss: 0.8808, weighted_loss: 1.0218, label: 2, bag_size: 7607
batch 519, loss: 1.0640, instance_loss: 0.3009, weighted_loss: 0.8351, label: 1, bag_size: 2643
batch 539, loss: 0.0042, instance_loss: 0.1692, weighted_loss: 0.0537, label: 2, bag_size: 4691
batch 559, loss: 0.6874, instance_loss: 0.9880, weighted_loss: 0.7776, label: 1, bag_size: 4824
batch 579, loss: 0.0025, instance_loss: 0.0823, weighted_loss: 0.0265, label: 1, bag_size: 3534
batch 599, loss: 2.5737, instance_loss: 1.2538, weighted_loss: 2.1777, label: 2, bag_size: 361
batch 619, loss: 0.6582, instance_loss: 0.4188, weighted_loss: 0.5863, label: 1, bag_size: 3755
batch 639, loss: 0.6537, instance_loss: 0.2931, weighted_loss: 0.5455, label: 1, bag_size: 6243
batch 659, loss: 0.0050, instance_loss: 0.1213, weighted_loss: 0.0399, label: 0, bag_size: 3438
batch 679, loss: 1.6178, instance_loss: 0.8821, weighted_loss: 1.3971, label: 1, bag_size: 3508
batch 699, loss: 0.8214, instance_loss: 0.5319, weighted_loss: 0.7346, label: 0, bag_size: 5890
batch 719, loss: 0.0134, instance_loss: 0.1199, weighted_loss: 0.0454, label: 0, bag_size: 3344
batch 739, loss: 1.3358, instance_loss: 1.2180, weighted_loss: 1.3004, label: 1, bag_size: 5532


class 0 clustering acc 0.9690715883668903: correct 17327/17880
class 1 clustering acc 0.4154362416107383: correct 2476/5960
Epoch: 44, train_loss: 0.5298, train_clustering_loss:  0.5207, train_error: 0.2255
class 0: acc 0.7478632478632479, correct 175/234
class 1: acc 0.7471264367816092, correct 195/261
class 2: acc 0.828, correct 207/250

Val Set, val_loss: 0.7767, val_error: 0.2660, auc: 0.8793
class 0 clustering acc 0.9463652482269503: correct 2135/2256
class 1 clustering acc 0.4720744680851064: correct 355/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1938, instance_loss: 0.3702, weighted_loss: 0.2467, label: 2, bag_size: 2359
batch 39, loss: 0.1588, instance_loss: 0.3298, weighted_loss: 0.2101, label: 1, bag_size: 2731
batch 59, loss: 0.0755, instance_loss: 0.1906, weighted_loss: 0.1100, label: 2, bag_size: 4302
batch 79, loss: 1.1022, instance_loss: 0.7010, weighted_loss: 0.9818, label: 1, bag_size: 302
batch 99, loss: 0.0602, instance_loss: 0.1247, weighted_loss: 0.0795, label: 2, bag_size: 2997
batch 119, loss: 0.1030, instance_loss: 0.3370, weighted_loss: 0.1732, label: 0, bag_size: 4827
batch 139, loss: 0.0049, instance_loss: 0.0597, weighted_loss: 0.0213, label: 0, bag_size: 1485
batch 159, loss: 0.2692, instance_loss: 0.6396, weighted_loss: 0.3803, label: 1, bag_size: 712
batch 179, loss: 0.5622, instance_loss: 0.6192, weighted_loss: 0.5793, label: 0, bag_size: 1808
batch 199, loss: 0.0079, instance_loss: 0.1606, weighted_loss: 0.0537, label: 2, bag_size: 2422
batch 219, loss: 0.4603, instance_loss: 0.8396, weighted_loss: 0.5741, label: 1, bag_size: 3619
batch 239, loss: 0.3897, instance_loss: 0.6853, weighted_loss: 0.4784, label: 0, bag_size: 4228
batch 259, loss: 0.6527, instance_loss: 0.4124, weighted_loss: 0.5806, label: 1, bag_size: 3357
batch 279, loss: 0.0060, instance_loss: 0.6945, weighted_loss: 0.2126, label: 1, bag_size: 10399
batch 299, loss: 0.0630, instance_loss: 0.1290, weighted_loss: 0.0828, label: 0, bag_size: 3924
batch 319, loss: 0.1057, instance_loss: 0.7843, weighted_loss: 0.3093, label: 1, bag_size: 1510
batch 339, loss: 0.3514, instance_loss: 0.8687, weighted_loss: 0.5066, label: 0, bag_size: 4808
batch 359, loss: 0.1367, instance_loss: 0.8066, weighted_loss: 0.3377, label: 1, bag_size: 5003
batch 379, loss: 0.0850, instance_loss: 0.1866, weighted_loss: 0.1155, label: 1, bag_size: 3333
batch 399, loss: 1.9999, instance_loss: 0.9487, weighted_loss: 1.6845, label: 1, bag_size: 32
batch 419, loss: 1.2614, instance_loss: 0.8442, weighted_loss: 1.1362, label: 2, bag_size: 3227
batch 439, loss: 0.0234, instance_loss: 0.1496, weighted_loss: 0.0612, label: 1, bag_size: 5086
batch 459, loss: 2.5189, instance_loss: 1.4900, weighted_loss: 2.2102, label: 1, bag_size: 1608
batch 479, loss: 0.6897, instance_loss: 0.1849, weighted_loss: 0.5382, label: 1, bag_size: 2643
batch 499, loss: 0.0178, instance_loss: 0.0839, weighted_loss: 0.0376, label: 1, bag_size: 3333
batch 519, loss: 0.0134, instance_loss: 0.0838, weighted_loss: 0.0345, label: 0, bag_size: 5282
batch 539, loss: 0.2109, instance_loss: 0.4768, weighted_loss: 0.2907, label: 2, bag_size: 1050
batch 559, loss: 0.0004, instance_loss: 1.0973, weighted_loss: 0.3295, label: 0, bag_size: 1981
batch 579, loss: 1.8841, instance_loss: 1.1784, weighted_loss: 1.6724, label: 1, bag_size: 628
batch 599, loss: 0.0106, instance_loss: 0.2189, weighted_loss: 0.0731, label: 2, bag_size: 2422
batch 619, loss: 0.9746, instance_loss: 0.6429, weighted_loss: 0.8751, label: 0, bag_size: 3661
batch 639, loss: 0.2800, instance_loss: 0.7649, weighted_loss: 0.4255, label: 2, bag_size: 1050
batch 659, loss: 0.5683, instance_loss: 0.7675, weighted_loss: 0.6281, label: 0, bag_size: 3864
batch 679, loss: 0.4649, instance_loss: 0.6986, weighted_loss: 0.5350, label: 1, bag_size: 4599
batch 699, loss: 1.4331, instance_loss: 1.2270, weighted_loss: 1.3712, label: 1, bag_size: 667
batch 719, loss: 0.1500, instance_loss: 0.5335, weighted_loss: 0.2650, label: 2, bag_size: 5017
batch 739, loss: 0.1973, instance_loss: 0.5974, weighted_loss: 0.3173, label: 0, bag_size: 3033


class 0 clustering acc 0.9672818791946308: correct 17295/17880
class 1 clustering acc 0.4545302013422819: correct 2709/5960
Epoch: 45, train_loss: 0.4359, train_clustering_loss:  0.4909, train_error: 0.1772
class 0: acc 0.8410852713178295, correct 217/258
class 1: acc 0.7807692307692308, correct 203/260
class 2: acc 0.8502202643171806, correct 193/227

Val Set, val_loss: 0.8244, val_error: 0.2660, auc: 0.8792
class 0 clustering acc 0.93927304964539: correct 2119/2256
class 1 clustering acc 0.3537234042553192: correct 266/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1666, instance_loss: 0.2600, weighted_loss: 0.1946, label: 2, bag_size: 1103
batch 39, loss: 0.2293, instance_loss: 0.2753, weighted_loss: 0.2431, label: 0, bag_size: 2983
batch 59, loss: 0.1179, instance_loss: 0.7267, weighted_loss: 0.3005, label: 0, bag_size: 4161
batch 79, loss: 0.4092, instance_loss: 0.6630, weighted_loss: 0.4854, label: 2, bag_size: 4342
batch 99, loss: 0.0655, instance_loss: 0.5960, weighted_loss: 0.2246, label: 2, bag_size: 2770
batch 119, loss: 0.0321, instance_loss: 0.2928, weighted_loss: 0.1103, label: 2, bag_size: 5017
batch 139, loss: 0.2510, instance_loss: 0.4555, weighted_loss: 0.3123, label: 2, bag_size: 22464
batch 159, loss: 0.0346, instance_loss: 0.4681, weighted_loss: 0.1647, label: 1, bag_size: 4599
batch 179, loss: 0.0001, instance_loss: 0.1856, weighted_loss: 0.0558, label: 2, bag_size: 2422
batch 199, loss: 0.0475, instance_loss: 0.2122, weighted_loss: 0.0969, label: 0, bag_size: 1233
batch 219, loss: 2.0780, instance_loss: 1.1183, weighted_loss: 1.7901, label: 2, bag_size: 728
batch 239, loss: 0.1114, instance_loss: 0.2109, weighted_loss: 0.1413, label: 0, bag_size: 4584
batch 259, loss: 2.1896, instance_loss: 0.9369, weighted_loss: 1.8138, label: 1, bag_size: 628
batch 279, loss: 0.3678, instance_loss: 0.4852, weighted_loss: 0.4030, label: 1, bag_size: 5532
batch 299, loss: 0.1592, instance_loss: 0.4092, weighted_loss: 0.2342, label: 2, bag_size: 614
batch 319, loss: 0.1140, instance_loss: 0.2463, weighted_loss: 0.1536, label: 0, bag_size: 5915
batch 339, loss: 0.0491, instance_loss: 0.1766, weighted_loss: 0.0874, label: 0, bag_size: 2767
batch 359, loss: 0.0821, instance_loss: 0.6422, weighted_loss: 0.2501, label: 1, bag_size: 1604
batch 379, loss: 0.5690, instance_loss: 0.8478, weighted_loss: 0.6526, label: 1, bag_size: 5167
batch 399, loss: 0.0073, instance_loss: 0.0814, weighted_loss: 0.0295, label: 2, bag_size: 3607
batch 419, loss: 0.2066, instance_loss: 0.1301, weighted_loss: 0.1837, label: 2, bag_size: 4788
batch 439, loss: 0.0186, instance_loss: 0.1568, weighted_loss: 0.0601, label: 0, bag_size: 4242
batch 459, loss: 0.2999, instance_loss: 0.5559, weighted_loss: 0.3767, label: 2, bag_size: 4291
batch 479, loss: 0.1044, instance_loss: 0.1534, weighted_loss: 0.1191, label: 2, bag_size: 2905
batch 499, loss: 0.0261, instance_loss: 0.1005, weighted_loss: 0.0484, label: 0, bag_size: 3289
batch 519, loss: 0.7636, instance_loss: 0.8245, weighted_loss: 0.7819, label: 1, bag_size: 3991
batch 539, loss: 0.0020, instance_loss: 0.1482, weighted_loss: 0.0458, label: 1, bag_size: 3172
batch 559, loss: 0.0066, instance_loss: 0.1023, weighted_loss: 0.0353, label: 2, bag_size: 5138
batch 579, loss: 0.1353, instance_loss: 0.9683, weighted_loss: 0.3852, label: 1, bag_size: 3821
batch 599, loss: 0.0116, instance_loss: 0.2626, weighted_loss: 0.0869, label: 2, bag_size: 3210
batch 619, loss: 0.5838, instance_loss: 0.5729, weighted_loss: 0.5805, label: 1, bag_size: 4184
batch 639, loss: 0.5263, instance_loss: 0.9842, weighted_loss: 0.6637, label: 1, bag_size: 3619
batch 659, loss: 1.8761, instance_loss: 1.0916, weighted_loss: 1.6408, label: 0, bag_size: 1755
batch 679, loss: 0.4520, instance_loss: 0.4157, weighted_loss: 0.4411, label: 1, bag_size: 2753
batch 699, loss: 0.0790, instance_loss: 0.4558, weighted_loss: 0.1921, label: 0, bag_size: 8088
batch 719, loss: 0.0059, instance_loss: 0.2254, weighted_loss: 0.0717, label: 2, bag_size: 3094
batch 739, loss: 0.9400, instance_loss: 1.0083, weighted_loss: 0.9605, label: 0, bag_size: 4105


class 0 clustering acc 0.9659955257270694: correct 17272/17880
class 1 clustering acc 0.42936241610738257: correct 2559/5960
Epoch: 46, train_loss: 0.4432, train_clustering_loss:  0.5057, train_error: 0.1812
class 0: acc 0.8436213991769548, correct 205/243
class 1: acc 0.7398373983739838, correct 182/246
class 2: acc 0.87109375, correct 223/256

Val Set, val_loss: 0.9030, val_error: 0.2979, auc: 0.8728
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.3045212765957447: correct 229/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0009, instance_loss: 0.2679, weighted_loss: 0.0810, label: 2, bag_size: 4140
batch 39, loss: 2.6837, instance_loss: 1.4314, weighted_loss: 2.3080, label: 0, bag_size: 1052
batch 59, loss: 0.0079, instance_loss: 0.0701, weighted_loss: 0.0266, label: 0, bag_size: 3437
batch 79, loss: 5.5982, instance_loss: 2.1917, weighted_loss: 4.5762, label: 0, bag_size: 2736
batch 99, loss: 0.0462, instance_loss: 0.1466, weighted_loss: 0.0763, label: 0, bag_size: 5570
batch 119, loss: 0.0529, instance_loss: 0.2120, weighted_loss: 0.1006, label: 1, bag_size: 3471
batch 139, loss: 0.0936, instance_loss: 0.4635, weighted_loss: 0.2046, label: 0, bag_size: 2232
batch 159, loss: 0.0202, instance_loss: 0.1740, weighted_loss: 0.0664, label: 0, bag_size: 7595
batch 179, loss: 0.0372, instance_loss: 0.1415, weighted_loss: 0.0685, label: 0, bag_size: 2884
batch 199, loss: 0.0880, instance_loss: 0.1666, weighted_loss: 0.1116, label: 2, bag_size: 1094
batch 219, loss: 0.0094, instance_loss: 0.2859, weighted_loss: 0.0924, label: 2, bag_size: 4569
batch 239, loss: 0.1420, instance_loss: 0.1744, weighted_loss: 0.1517, label: 0, bag_size: 1049
batch 259, loss: 0.2906, instance_loss: 0.2509, weighted_loss: 0.2787, label: 2, bag_size: 5743
batch 279, loss: 1.1300, instance_loss: 0.7804, weighted_loss: 1.0251, label: 0, bag_size: 4509
batch 299, loss: 0.0737, instance_loss: 0.4852, weighted_loss: 0.1972, label: 1, bag_size: 5118
batch 319, loss: 0.3968, instance_loss: 0.8278, weighted_loss: 0.5261, label: 1, bag_size: 4694
batch 339, loss: 0.0374, instance_loss: 0.1796, weighted_loss: 0.0800, label: 1, bag_size: 2092
batch 359, loss: 0.9894, instance_loss: 0.9805, weighted_loss: 0.9867, label: 1, bag_size: 1327
batch 379, loss: 0.0044, instance_loss: 0.2584, weighted_loss: 0.0806, label: 1, bag_size: 3337
batch 399, loss: 0.2885, instance_loss: 1.0883, weighted_loss: 0.5284, label: 1, bag_size: 3821
batch 419, loss: 1.0023, instance_loss: 1.1168, weighted_loss: 1.0366, label: 0, bag_size: 15388
batch 439, loss: 0.0582, instance_loss: 0.2795, weighted_loss: 0.1246, label: 0, bag_size: 2841
batch 459, loss: 0.0268, instance_loss: 0.0796, weighted_loss: 0.0427, label: 2, bag_size: 2905
batch 479, loss: 0.4299, instance_loss: 0.5876, weighted_loss: 0.4772, label: 1, bag_size: 800
batch 499, loss: 0.0258, instance_loss: 0.0829, weighted_loss: 0.0429, label: 0, bag_size: 5915
batch 519, loss: 0.0487, instance_loss: 0.2939, weighted_loss: 0.1223, label: 1, bag_size: 3333
batch 539, loss: 0.6664, instance_loss: 0.7558, weighted_loss: 0.6932, label: 1, bag_size: 6942
batch 559, loss: 0.0026, instance_loss: 0.2933, weighted_loss: 0.0898, label: 1, bag_size: 10941
batch 579, loss: 2.6720, instance_loss: 0.5013, weighted_loss: 2.0208, label: 0, bag_size: 4639
batch 599, loss: 1.3386, instance_loss: 0.6616, weighted_loss: 1.1355, label: 2, bag_size: 909
batch 619, loss: 0.0420, instance_loss: 0.1793, weighted_loss: 0.0832, label: 0, bag_size: 4531
batch 639, loss: 0.0468, instance_loss: 0.2172, weighted_loss: 0.0979, label: 2, bag_size: 3210
batch 659, loss: 0.0353, instance_loss: 0.2363, weighted_loss: 0.0956, label: 0, bag_size: 4398
batch 679, loss: 0.4647, instance_loss: 0.3872, weighted_loss: 0.4414, label: 2, bag_size: 5924
batch 699, loss: 0.0352, instance_loss: 0.3549, weighted_loss: 0.1311, label: 0, bag_size: 3038
batch 719, loss: 2.0560, instance_loss: 1.0834, weighted_loss: 1.7642, label: 1, bag_size: 1964
batch 739, loss: 0.8779, instance_loss: 0.5733, weighted_loss: 0.7865, label: 2, bag_size: 597


class 0 clustering acc 0.9620246085011186: correct 17201/17880
class 1 clustering acc 0.44412751677852347: correct 2647/5960
Epoch: 47, train_loss: 0.4568, train_clustering_loss:  0.5133, train_error: 0.1906
class 0: acc 0.828996282527881, correct 223/269
class 1: acc 0.731404958677686, correct 177/242
class 2: acc 0.8675213675213675, correct 203/234

Val Set, val_loss: 0.6208, val_error: 0.2340, auc: 0.8886
class 0 clustering acc 0.9813829787234043: correct 2214/2256
class 1 clustering acc 0.2978723404255319: correct 224/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2732, instance_loss: 0.3155, weighted_loss: 0.2859, label: 2, bag_size: 3026
batch 39, loss: 0.0171, instance_loss: 0.2874, weighted_loss: 0.0982, label: 1, bag_size: 1023
batch 59, loss: 3.8700, instance_loss: 1.2026, weighted_loss: 3.0698, label: 1, bag_size: 2927
batch 79, loss: 0.0050, instance_loss: 0.0914, weighted_loss: 0.0310, label: 1, bag_size: 3493
batch 99, loss: 0.1100, instance_loss: 0.7935, weighted_loss: 0.3150, label: 0, bag_size: 4161
batch 119, loss: 0.0198, instance_loss: 0.0867, weighted_loss: 0.0399, label: 0, bag_size: 4760
batch 139, loss: 0.1217, instance_loss: 0.5548, weighted_loss: 0.2516, label: 0, bag_size: 4997
batch 159, loss: 0.0160, instance_loss: 0.1103, weighted_loss: 0.0443, label: 0, bag_size: 4529
batch 179, loss: 0.0175, instance_loss: 0.0724, weighted_loss: 0.0339, label: 2, bag_size: 4788
batch 199, loss: 0.0694, instance_loss: 0.0877, weighted_loss: 0.0749, label: 2, bag_size: 3678
batch 219, loss: 0.0701, instance_loss: 0.5118, weighted_loss: 0.2026, label: 0, bag_size: 4147
batch 239, loss: 0.0553, instance_loss: 0.1829, weighted_loss: 0.0936, label: 0, bag_size: 5036
batch 259, loss: 0.5358, instance_loss: 0.6624, weighted_loss: 0.5738, label: 2, bag_size: 4096
batch 279, loss: 0.4273, instance_loss: 0.8252, weighted_loss: 0.5467, label: 2, bag_size: 4316
batch 299, loss: 0.0129, instance_loss: 0.2814, weighted_loss: 0.0935, label: 1, bag_size: 4134
batch 319, loss: 0.0031, instance_loss: 0.3123, weighted_loss: 0.0959, label: 1, bag_size: 4290
batch 339, loss: 0.3623, instance_loss: 0.5637, weighted_loss: 0.4227, label: 0, bag_size: 2501
batch 359, loss: 0.0169, instance_loss: 0.1221, weighted_loss: 0.0485, label: 0, bag_size: 2487
batch 379, loss: 0.6750, instance_loss: 0.6633, weighted_loss: 0.6715, label: 0, bag_size: 1052
batch 399, loss: 0.3691, instance_loss: 0.6218, weighted_loss: 0.4449, label: 1, bag_size: 4784
batch 419, loss: 0.0192, instance_loss: 0.1463, weighted_loss: 0.0573, label: 0, bag_size: 3694
batch 439, loss: 1.9759, instance_loss: 1.4444, weighted_loss: 1.8165, label: 0, bag_size: 1774
batch 459, loss: 0.0225, instance_loss: 0.2256, weighted_loss: 0.0834, label: 0, bag_size: 4797
batch 479, loss: 1.7600, instance_loss: 0.9530, weighted_loss: 1.5179, label: 1, bag_size: 1364
batch 499, loss: 0.1102, instance_loss: 0.3616, weighted_loss: 0.1856, label: 2, bag_size: 6704
batch 519, loss: 0.0413, instance_loss: 0.2655, weighted_loss: 0.1086, label: 2, bag_size: 6644
batch 539, loss: 0.0285, instance_loss: 0.5237, weighted_loss: 0.1771, label: 1, bag_size: 5512
batch 559, loss: 0.3489, instance_loss: 0.6140, weighted_loss: 0.4284, label: 1, bag_size: 5402
batch 579, loss: 0.0293, instance_loss: 0.1067, weighted_loss: 0.0525, label: 2, bag_size: 1094
batch 599, loss: 0.1112, instance_loss: 0.7554, weighted_loss: 0.3045, label: 2, bag_size: 4571
batch 619, loss: 0.6741, instance_loss: 0.4421, weighted_loss: 0.6045, label: 1, bag_size: 2945
batch 639, loss: 0.8462, instance_loss: 0.6372, weighted_loss: 0.7835, label: 2, bag_size: 597
batch 659, loss: 0.0294, instance_loss: 0.4973, weighted_loss: 0.1697, label: 1, bag_size: 5833
batch 679, loss: 0.4452, instance_loss: 0.9813, weighted_loss: 0.6060, label: 1, bag_size: 1510
batch 699, loss: 0.0945, instance_loss: 0.6062, weighted_loss: 0.2480, label: 1, bag_size: 1510
batch 719, loss: 0.0438, instance_loss: 0.1742, weighted_loss: 0.0830, label: 2, bag_size: 3396
batch 739, loss: 0.3077, instance_loss: 0.6496, weighted_loss: 0.4102, label: 1, bag_size: 3422


class 0 clustering acc 0.9640380313199105: correct 17237/17880
class 1 clustering acc 0.42818791946308726: correct 2552/5960
Epoch: 48, train_loss: 0.4736, train_clustering_loss:  0.5147, train_error: 0.1987
class 0: acc 0.8423076923076923, correct 219/260
class 1: acc 0.7298387096774194, correct 181/248
class 2: acc 0.8312236286919831, correct 197/237

Val Set, val_loss: 0.8109, val_error: 0.2766, auc: 0.8702
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.3803191489361702: correct 286/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.5518, instance_loss: 0.3712, weighted_loss: 0.4976, label: 2, bag_size: 3026
batch 39, loss: 0.0069, instance_loss: 0.0875, weighted_loss: 0.0311, label: 0, bag_size: 4918
batch 59, loss: 0.0899, instance_loss: 0.4887, weighted_loss: 0.2095, label: 2, bag_size: 88
batch 79, loss: 0.0650, instance_loss: 0.3582, weighted_loss: 0.1529, label: 2, bag_size: 3810
batch 99, loss: 0.1543, instance_loss: 0.3539, weighted_loss: 0.2142, label: 2, bag_size: 4535
batch 119, loss: 0.5986, instance_loss: 0.6864, weighted_loss: 0.6250, label: 1, bag_size: 455
batch 139, loss: 0.0003, instance_loss: 0.4435, weighted_loss: 0.1333, label: 1, bag_size: 4290
batch 159, loss: 1.3951, instance_loss: 0.9475, weighted_loss: 1.2608, label: 0, bag_size: 3402
batch 179, loss: 0.3624, instance_loss: 0.7902, weighted_loss: 0.4907, label: 1, bag_size: 2122
batch 199, loss: 0.3549, instance_loss: 0.4468, weighted_loss: 0.3824, label: 2, bag_size: 4342
batch 219, loss: 0.0582, instance_loss: 0.2132, weighted_loss: 0.1047, label: 1, bag_size: 259
batch 239, loss: 0.0089, instance_loss: 0.0583, weighted_loss: 0.0237, label: 2, bag_size: 3497
batch 259, loss: 0.1989, instance_loss: 0.2897, weighted_loss: 0.2262, label: 0, bag_size: 1049
batch 279, loss: 0.0238, instance_loss: 0.1275, weighted_loss: 0.0549, label: 0, bag_size: 1174
batch 299, loss: 0.0162, instance_loss: 0.4413, weighted_loss: 0.1437, label: 2, bag_size: 2770
batch 319, loss: 0.0527, instance_loss: 0.3287, weighted_loss: 0.1355, label: 2, bag_size: 1543
batch 339, loss: 1.0834, instance_loss: 0.8270, weighted_loss: 1.0064, label: 1, bag_size: 5693
batch 359, loss: 0.0671, instance_loss: 0.3479, weighted_loss: 0.1513, label: 0, bag_size: 3368
batch 379, loss: 2.1819, instance_loss: 1.5575, weighted_loss: 1.9946, label: 1, bag_size: 3644
batch 399, loss: 0.1215, instance_loss: 0.5261, weighted_loss: 0.2429, label: 2, bag_size: 1222
batch 419, loss: 0.0749, instance_loss: 0.3233, weighted_loss: 0.1494, label: 2, bag_size: 3534
batch 439, loss: 2.3375, instance_loss: 1.3511, weighted_loss: 2.0416, label: 1, bag_size: 5197
batch 459, loss: 0.2012, instance_loss: 0.7106, weighted_loss: 0.3540, label: 1, bag_size: 5003
batch 479, loss: 0.2187, instance_loss: 0.2043, weighted_loss: 0.2144, label: 2, bag_size: 2561
batch 499, loss: 0.1119, instance_loss: 0.3916, weighted_loss: 0.1958, label: 0, bag_size: 2094
batch 519, loss: 0.0770, instance_loss: 0.2000, weighted_loss: 0.1139, label: 2, bag_size: 5924
batch 539, loss: 0.3410, instance_loss: 0.6230, weighted_loss: 0.4256, label: 1, bag_size: 3396
batch 559, loss: 1.0192, instance_loss: 1.0102, weighted_loss: 1.0165, label: 1, bag_size: 2425
batch 579, loss: 0.2678, instance_loss: 0.3419, weighted_loss: 0.2900, label: 2, bag_size: 2049
batch 599, loss: 0.0110, instance_loss: 0.1054, weighted_loss: 0.0393, label: 0, bag_size: 3754
batch 619, loss: 0.0693, instance_loss: 0.5864, weighted_loss: 0.2244, label: 2, bag_size: 3604
batch 639, loss: 2.9792, instance_loss: 1.6896, weighted_loss: 2.5923, label: 0, bag_size: 3316
batch 659, loss: 0.4276, instance_loss: 0.6448, weighted_loss: 0.4928, label: 1, bag_size: 4145
batch 679, loss: 0.0204, instance_loss: 0.1476, weighted_loss: 0.0585, label: 0, bag_size: 3754
batch 699, loss: 0.0213, instance_loss: 0.1109, weighted_loss: 0.0482, label: 2, bag_size: 3094
batch 719, loss: 0.0363, instance_loss: 0.2770, weighted_loss: 0.1085, label: 2, bag_size: 4043
batch 739, loss: 0.0161, instance_loss: 0.2718, weighted_loss: 0.0928, label: 0, bag_size: 5029


class 0 clustering acc 0.9649888143176734: correct 17254/17880
class 1 clustering acc 0.4063758389261745: correct 2422/5960
Epoch: 49, train_loss: 0.4840, train_clustering_loss:  0.5283, train_error: 0.2067
class 0: acc 0.8097165991902834, correct 200/247
class 1: acc 0.7076923076923077, correct 184/260
class 2: acc 0.8697478991596639, correct 207/238

Val Set, val_loss: 0.6909, val_error: 0.2553, auc: 0.8867
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.375: correct 282/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0344, instance_loss: 0.2970, weighted_loss: 0.1132, label: 2, bag_size: 3210
batch 39, loss: 2.4795, instance_loss: 0.7134, weighted_loss: 1.9497, label: 0, bag_size: 4145
batch 59, loss: 0.0287, instance_loss: 0.1687, weighted_loss: 0.0707, label: 0, bag_size: 3690
batch 79, loss: 0.4859, instance_loss: 0.2975, weighted_loss: 0.4294, label: 0, bag_size: 3370
batch 99, loss: 0.4510, instance_loss: 0.4559, weighted_loss: 0.4525, label: 2, bag_size: 3026
batch 119, loss: 0.1054, instance_loss: 0.4332, weighted_loss: 0.2037, label: 0, bag_size: 3532
batch 139, loss: 0.0526, instance_loss: 0.3242, weighted_loss: 0.1340, label: 2, bag_size: 4140
batch 159, loss: 0.7747, instance_loss: 0.5365, weighted_loss: 0.7032, label: 2, bag_size: 3810
batch 179, loss: 2.8875, instance_loss: 1.7331, weighted_loss: 2.5412, label: 0, bag_size: 1774
batch 199, loss: 0.0441, instance_loss: 0.6487, weighted_loss: 0.2255, label: 1, bag_size: 2013
batch 219, loss: 0.1119, instance_loss: 0.4442, weighted_loss: 0.2116, label: 2, bag_size: 3299
batch 239, loss: 0.1622, instance_loss: 0.3020, weighted_loss: 0.2041, label: 2, bag_size: 4132
batch 259, loss: 0.0417, instance_loss: 0.1373, weighted_loss: 0.0704, label: 0, bag_size: 3883
batch 279, loss: 0.1013, instance_loss: 0.2218, weighted_loss: 0.1375, label: 0, bag_size: 2428
batch 299, loss: 0.0471, instance_loss: 0.1804, weighted_loss: 0.0871, label: 1, bag_size: 3471
batch 319, loss: 2.5787, instance_loss: 1.1091, weighted_loss: 2.1378, label: 1, bag_size: 3322
batch 339, loss: 0.6145, instance_loss: 0.2121, weighted_loss: 0.4938, label: 0, bag_size: 3777
batch 359, loss: 0.0524, instance_loss: 0.2109, weighted_loss: 0.1000, label: 0, bag_size: 4905
batch 379, loss: 0.1268, instance_loss: 0.3098, weighted_loss: 0.1817, label: 2, bag_size: 3534
batch 399, loss: 0.1160, instance_loss: 0.1315, weighted_loss: 0.1206, label: 2, bag_size: 3026
batch 419, loss: 0.4153, instance_loss: 1.0948, weighted_loss: 0.6192, label: 2, bag_size: 4910
batch 439, loss: 0.6894, instance_loss: 0.9173, weighted_loss: 0.7577, label: 1, bag_size: 1580
batch 459, loss: 0.3272, instance_loss: 0.7711, weighted_loss: 0.4603, label: 1, bag_size: 4200
batch 479, loss: 0.0450, instance_loss: 0.1465, weighted_loss: 0.0754, label: 2, bag_size: 4302
batch 499, loss: 0.0232, instance_loss: 0.2004, weighted_loss: 0.0764, label: 2, bag_size: 4203
batch 519, loss: 1.0272, instance_loss: 0.9450, weighted_loss: 1.0025, label: 2, bag_size: 4316
batch 539, loss: 0.5965, instance_loss: 0.5462, weighted_loss: 0.5814, label: 0, bag_size: 2601
batch 559, loss: 0.0160, instance_loss: 0.3281, weighted_loss: 0.1096, label: 0, bag_size: 5646
batch 579, loss: 0.1150, instance_loss: 0.7140, weighted_loss: 0.2947, label: 1, bag_size: 2494
batch 599, loss: 0.0166, instance_loss: 0.1865, weighted_loss: 0.0676, label: 0, bag_size: 6863
batch 619, loss: 0.1221, instance_loss: 0.2819, weighted_loss: 0.1700, label: 1, bag_size: 2921
batch 639, loss: 0.3400, instance_loss: 0.3345, weighted_loss: 0.3383, label: 1, bag_size: 1410
batch 659, loss: 0.0346, instance_loss: 0.1984, weighted_loss: 0.0838, label: 0, bag_size: 5459
batch 679, loss: 0.0027, instance_loss: 0.1526, weighted_loss: 0.0477, label: 1, bag_size: 425
batch 699, loss: 0.2437, instance_loss: 0.4136, weighted_loss: 0.2946, label: 1, bag_size: 14449
batch 719, loss: 0.0800, instance_loss: 0.4285, weighted_loss: 0.1845, label: 0, bag_size: 3586
batch 739, loss: 0.5748, instance_loss: 0.7250, weighted_loss: 0.6198, label: 1, bag_size: 2831


class 0 clustering acc 0.96582774049217: correct 17269/17880
class 1 clustering acc 0.4224832214765101: correct 2518/5960
Epoch: 50, train_loss: 0.4367, train_clustering_loss:  0.5172, train_error: 0.1678
class 0: acc 0.8414096916299559, correct 191/227
class 1: acc 0.8029197080291971, correct 220/274
class 2: acc 0.8565573770491803, correct 209/244

Val Set, val_loss: 0.8338, val_error: 0.3404, auc: 0.8696
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.28058510638297873: correct 211/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1923, instance_loss: 0.6639, weighted_loss: 0.3338, label: 1, bag_size: 2751
batch 39, loss: 2.0378, instance_loss: 0.9582, weighted_loss: 1.7139, label: 0, bag_size: 1289
batch 59, loss: 0.1739, instance_loss: 0.4586, weighted_loss: 0.2593, label: 2, bag_size: 6594
batch 79, loss: 0.4090, instance_loss: 1.0186, weighted_loss: 0.5919, label: 1, bag_size: 2122
batch 99, loss: 0.6313, instance_loss: 0.7305, weighted_loss: 0.6611, label: 1, bag_size: 1122
batch 119, loss: 0.3981, instance_loss: 0.5583, weighted_loss: 0.4462, label: 1, bag_size: 1607
batch 139, loss: 0.0568, instance_loss: 0.5624, weighted_loss: 0.2085, label: 0, bag_size: 4865
batch 159, loss: 2.0609, instance_loss: 1.3476, weighted_loss: 1.8469, label: 1, bag_size: 2927
batch 179, loss: 0.0419, instance_loss: 0.3383, weighted_loss: 0.1308, label: 0, bag_size: 5036
batch 199, loss: 0.0068, instance_loss: 0.1628, weighted_loss: 0.0536, label: 0, bag_size: 1710
batch 219, loss: 2.4656, instance_loss: 1.0084, weighted_loss: 2.0284, label: 0, bag_size: 877
batch 239, loss: 1.4565, instance_loss: 0.7231, weighted_loss: 1.2365, label: 2, bag_size: 909
batch 259, loss: 2.4257, instance_loss: 1.1977, weighted_loss: 2.0573, label: 0, bag_size: 2896
batch 279, loss: 0.9428, instance_loss: 0.5415, weighted_loss: 0.8224, label: 2, bag_size: 2561
batch 299, loss: 1.5665, instance_loss: 0.9330, weighted_loss: 1.3764, label: 1, bag_size: 2998
batch 319, loss: 0.0032, instance_loss: 0.1227, weighted_loss: 0.0390, label: 2, bag_size: 2422
batch 339, loss: 0.9235, instance_loss: 1.0194, weighted_loss: 0.9523, label: 0, bag_size: 3711
batch 359, loss: 0.8811, instance_loss: 0.9005, weighted_loss: 0.8869, label: 1, bag_size: 2055
batch 379, loss: 1.5407, instance_loss: 1.0852, weighted_loss: 1.4040, label: 2, bag_size: 4179
batch 399, loss: 0.1477, instance_loss: 0.3724, weighted_loss: 0.2151, label: 1, bag_size: 3586
batch 419, loss: 0.0295, instance_loss: 0.1106, weighted_loss: 0.0539, label: 2, bag_size: 1094
batch 439, loss: 0.2406, instance_loss: 0.8620, weighted_loss: 0.4270, label: 0, bag_size: 2153
batch 459, loss: 0.1271, instance_loss: 0.6302, weighted_loss: 0.2781, label: 2, bag_size: 724
batch 479, loss: 0.5152, instance_loss: 2.0403, weighted_loss: 0.9727, label: 1, bag_size: 1558
batch 499, loss: 0.0163, instance_loss: 0.2282, weighted_loss: 0.0799, label: 0, bag_size: 5330
batch 519, loss: 0.0145, instance_loss: 0.3550, weighted_loss: 0.1166, label: 1, bag_size: 1023
batch 539, loss: 0.9519, instance_loss: 0.4610, weighted_loss: 0.8046, label: 0, bag_size: 6223
batch 559, loss: 0.2030, instance_loss: 0.5375, weighted_loss: 0.3034, label: 0, bag_size: 16741
batch 579, loss: 1.2101, instance_loss: 1.0082, weighted_loss: 1.1495, label: 1, bag_size: 2481
batch 599, loss: 0.0898, instance_loss: 0.2804, weighted_loss: 0.1470, label: 0, bag_size: 3368
batch 619, loss: 0.0409, instance_loss: 0.1887, weighted_loss: 0.0853, label: 0, bag_size: 3188
batch 639, loss: 2.1435, instance_loss: 1.1322, weighted_loss: 1.8401, label: 2, bag_size: 3274
batch 659, loss: 0.1679, instance_loss: 0.8554, weighted_loss: 0.3741, label: 1, bag_size: 3497
batch 679, loss: 0.0111, instance_loss: 0.4833, weighted_loss: 0.1528, label: 2, bag_size: 2031
batch 699, loss: 0.0137, instance_loss: 0.0712, weighted_loss: 0.0310, label: 0, bag_size: 3793
batch 719, loss: 0.0030, instance_loss: 0.0356, weighted_loss: 0.0128, label: 2, bag_size: 4856
batch 739, loss: 0.8885, instance_loss: 0.5665, weighted_loss: 0.7919, label: 1, bag_size: 2962


class 0 clustering acc 0.9639261744966443: correct 17235/17880
class 1 clustering acc 0.41325503355704696: correct 2463/5960
Epoch: 51, train_loss: 0.4613, train_clustering_loss:  0.5358, train_error: 0.2054
class 0: acc 0.8171206225680934, correct 210/257
class 1: acc 0.7166666666666667, correct 172/240
class 2: acc 0.8467741935483871, correct 210/248

Val Set, val_loss: 0.6458, val_error: 0.2553, auc: 0.8903
class 0 clustering acc 0.9720744680851063: correct 2193/2256
class 1 clustering acc 0.3497340425531915: correct 263/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 30 out of 20
Early stopping
Val error: 0.2340, ROC AUC: 0.8877
Test error: 0.2553, ROC AUC: 0.8785
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.2684, instance_loss: 0.6338, weighted_loss: 0.3780, label: 1, bag_size: 2493
batch 39, loss: 1.1366, instance_loss: 0.7954, weighted_loss: 1.0342, label: 0, bag_size: 6430
batch 59, loss: 0.9914, instance_loss: 0.7064, weighted_loss: 0.9059, label: 2, bag_size: 3080
batch 79, loss: 1.1364, instance_loss: 0.8052, weighted_loss: 1.0371, label: 2, bag_size: 22464
batch 99, loss: 2.8658, instance_loss: 0.8600, weighted_loss: 2.2641, label: 1, bag_size: 1580
batch 119, loss: 2.0363, instance_loss: 0.7092, weighted_loss: 1.6381, label: 0, bag_size: 4935
batch 139, loss: 1.3837, instance_loss: 0.8505, weighted_loss: 1.2237, label: 1, bag_size: 5205
batch 159, loss: 1.2827, instance_loss: 0.7731, weighted_loss: 1.1298, label: 0, bag_size: 2736
batch 179, loss: 1.8093, instance_loss: 0.8547, weighted_loss: 1.5229, label: 0, bag_size: 3754
batch 199, loss: 1.1907, instance_loss: 0.7408, weighted_loss: 1.0557, label: 2, bag_size: 3080
batch 219, loss: 0.7672, instance_loss: 0.6211, weighted_loss: 0.7234, label: 2, bag_size: 4291
batch 239, loss: 1.4781, instance_loss: 0.8513, weighted_loss: 1.2900, label: 0, bag_size: 3438
batch 259, loss: 1.4759, instance_loss: 0.8232, weighted_loss: 1.2801, label: 2, bag_size: 5637
batch 279, loss: 0.7221, instance_loss: 0.9042, weighted_loss: 0.7768, label: 2, bag_size: 6644
batch 299, loss: 0.8598, instance_loss: 0.7152, weighted_loss: 0.8164, label: 0, bag_size: 789
batch 319, loss: 0.9415, instance_loss: 0.8163, weighted_loss: 0.9040, label: 2, bag_size: 4555
batch 339, loss: 1.4710, instance_loss: 0.8435, weighted_loss: 1.2828, label: 1, bag_size: 3755
batch 359, loss: 0.1336, instance_loss: 0.4992, weighted_loss: 0.2433, label: 1, bag_size: 874
batch 379, loss: 1.0367, instance_loss: 0.8369, weighted_loss: 0.9768, label: 0, bag_size: 3245
batch 399, loss: 0.5875, instance_loss: 0.5772, weighted_loss: 0.5844, label: 1, bag_size: 817
batch 419, loss: 0.7625, instance_loss: 0.8506, weighted_loss: 0.7889, label: 2, bag_size: 4140
batch 439, loss: 0.2553, instance_loss: 0.5931, weighted_loss: 0.3567, label: 2, bag_size: 4043
batch 459, loss: 0.8093, instance_loss: 0.7467, weighted_loss: 0.7905, label: 2, bag_size: 4372
batch 479, loss: 0.1753, instance_loss: 0.7720, weighted_loss: 0.3543, label: 0, bag_size: 3319
batch 499, loss: 0.4500, instance_loss: 0.6192, weighted_loss: 0.5007, label: 1, bag_size: 874
batch 519, loss: 0.6472, instance_loss: 0.5871, weighted_loss: 0.6292, label: 0, bag_size: 5519
batch 539, loss: 0.8655, instance_loss: 0.6077, weighted_loss: 0.7882, label: 0, bag_size: 3872
batch 559, loss: 1.0412, instance_loss: 0.8294, weighted_loss: 0.9776, label: 1, bag_size: 4940
batch 579, loss: 0.6626, instance_loss: 0.5988, weighted_loss: 0.6434, label: 0, bag_size: 5890
batch 599, loss: 0.4890, instance_loss: 0.5496, weighted_loss: 0.5072, label: 0, bag_size: 1174
batch 619, loss: 0.9922, instance_loss: 0.7552, weighted_loss: 0.9211, label: 0, bag_size: 2712
batch 639, loss: 0.2101, instance_loss: 0.3923, weighted_loss: 0.2647, label: 1, bag_size: 596
batch 659, loss: 0.0781, instance_loss: 0.3706, weighted_loss: 0.1658, label: 0, bag_size: 1709
batch 679, loss: 0.1925, instance_loss: 0.4197, weighted_loss: 0.2606, label: 1, bag_size: 460
batch 699, loss: 2.8122, instance_loss: 0.8235, weighted_loss: 2.2156, label: 2, bag_size: 223
batch 719, loss: 0.8335, instance_loss: 0.6034, weighted_loss: 0.7645, label: 1, bag_size: 6993
batch 739, loss: 1.9250, instance_loss: 0.9099, weighted_loss: 1.6205, label: 0, bag_size: 3664


class 0 clustering acc 0.9965883668903803: correct 17819/17880
class 1 clustering acc 0.012416107382550336: correct 74/5960
Epoch: 0, train_loss: 1.0242, train_clustering_loss:  0.7190, train_error: 0.4832
class 0: acc 0.48031496062992124, correct 122/254
class 1: acc 0.47540983606557374, correct 116/244
class 2: acc 0.5951417004048583, correct 147/247

Val Set, val_loss: 0.8864, val_error: 0.3830, auc: 0.7927
class 0 clustering acc 0.99822695035461: correct 2252/2256
class 1 clustering acc 0.015957446808510637: correct 12/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (inf --> 0.886354).  Saving model ...


batch 19, loss: 1.0338, instance_loss: 0.8717, weighted_loss: 0.9851, label: 2, bag_size: 6298
batch 39, loss: 0.4814, instance_loss: 0.7181, weighted_loss: 0.5524, label: 2, bag_size: 3810
batch 59, loss: 0.7278, instance_loss: 0.5563, weighted_loss: 0.6763, label: 1, bag_size: 1027
batch 79, loss: 0.9653, instance_loss: 0.7301, weighted_loss: 0.8947, label: 0, bag_size: 1352
batch 99, loss: 0.4982, instance_loss: 0.5648, weighted_loss: 0.5182, label: 0, bag_size: 6430
batch 119, loss: 1.0110, instance_loss: 0.7863, weighted_loss: 0.9436, label: 1, bag_size: 4708
batch 139, loss: 0.6896, instance_loss: 0.7426, weighted_loss: 0.7055, label: 2, bag_size: 597
batch 159, loss: 0.5906, instance_loss: 0.7068, weighted_loss: 0.6255, label: 0, bag_size: 4398
batch 179, loss: 0.9943, instance_loss: 0.6622, weighted_loss: 0.8947, label: 1, bag_size: 3837
batch 199, loss: 0.2484, instance_loss: 0.5367, weighted_loss: 0.3349, label: 2, bag_size: 5037
batch 219, loss: 0.9546, instance_loss: 0.6830, weighted_loss: 0.8731, label: 1, bag_size: 5926
batch 239, loss: 0.4505, instance_loss: 0.5977, weighted_loss: 0.4946, label: 2, bag_size: 88
batch 259, loss: 1.7151, instance_loss: 0.7686, weighted_loss: 1.4312, label: 1, bag_size: 5833
batch 279, loss: 0.7567, instance_loss: 0.5929, weighted_loss: 0.7076, label: 1, bag_size: 5276
batch 299, loss: 1.3190, instance_loss: 0.9241, weighted_loss: 1.2006, label: 0, bag_size: 4157
batch 319, loss: 0.7149, instance_loss: 0.6169, weighted_loss: 0.6855, label: 0, bag_size: 3924
batch 339, loss: 1.0762, instance_loss: 0.7978, weighted_loss: 0.9927, label: 2, bag_size: 4291
batch 359, loss: 0.8167, instance_loss: 0.7648, weighted_loss: 0.8012, label: 2, bag_size: 3746
batch 379, loss: 0.2562, instance_loss: 0.4262, weighted_loss: 0.3072, label: 0, bag_size: 873
batch 399, loss: 0.4308, instance_loss: 0.6869, weighted_loss: 0.5076, label: 2, bag_size: 5472
batch 419, loss: 0.4809, instance_loss: 0.6241, weighted_loss: 0.5239, label: 2, bag_size: 5011
batch 439, loss: 1.5426, instance_loss: 0.7280, weighted_loss: 1.2982, label: 2, bag_size: 705
batch 459, loss: 0.2103, instance_loss: 0.5569, weighted_loss: 0.3142, label: 1, bag_size: 5385
batch 479, loss: 0.6944, instance_loss: 0.6709, weighted_loss: 0.6874, label: 1, bag_size: 2013
batch 499, loss: 2.2436, instance_loss: 1.1670, weighted_loss: 1.9206, label: 2, bag_size: 3475
batch 519, loss: 0.2443, instance_loss: 0.5084, weighted_loss: 0.3236, label: 2, bag_size: 4056
batch 539, loss: 0.3109, instance_loss: 0.4312, weighted_loss: 0.3470, label: 1, bag_size: 2092
batch 559, loss: 1.0522, instance_loss: 0.7955, weighted_loss: 0.9752, label: 0, bag_size: 4639
batch 579, loss: 0.3160, instance_loss: 0.4044, weighted_loss: 0.3425, label: 0, bag_size: 3986
batch 599, loss: 0.4220, instance_loss: 0.3461, weighted_loss: 0.3993, label: 0, bag_size: 3936
batch 619, loss: 0.4538, instance_loss: 0.7060, weighted_loss: 0.5295, label: 1, bag_size: 3460
batch 639, loss: 0.0977, instance_loss: 0.4090, weighted_loss: 0.1911, label: 1, bag_size: 3425
batch 659, loss: 0.9383, instance_loss: 0.8225, weighted_loss: 0.9035, label: 2, bag_size: 4141
batch 679, loss: 1.0285, instance_loss: 0.7022, weighted_loss: 0.9306, label: 0, bag_size: 1774
batch 699, loss: 0.8912, instance_loss: 0.7435, weighted_loss: 0.8469, label: 2, bag_size: 3396
batch 719, loss: 0.2624, instance_loss: 0.3170, weighted_loss: 0.2788, label: 1, bag_size: 4253
batch 739, loss: 0.6661, instance_loss: 0.4414, weighted_loss: 0.5987, label: 1, bag_size: 4684


class 0 clustering acc 0.9972035794183445: correct 17830/17880
class 1 clustering acc 0.02080536912751678: correct 124/5960
Epoch: 1, train_loss: 0.9034, train_clustering_loss:  0.6786, train_error: 0.4040
class 0: acc 0.5910931174089069, correct 146/247
class 1: acc 0.5955056179775281, correct 159/267
class 2: acc 0.6017316017316018, correct 139/231

Val Set, val_loss: 1.1841, val_error: 0.6383, auc: 0.7587
class 0 clustering acc 0.9946808510638298: correct 2244/2256
class 1 clustering acc 0.06648936170212766: correct 50/752
class 0: acc 0.1346153846153846, correct 7/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2687, instance_loss: 0.5944, weighted_loss: 0.3664, label: 2, bag_size: 2049
batch 39, loss: 1.7400, instance_loss: 1.0632, weighted_loss: 1.5370, label: 0, bag_size: 3754
batch 59, loss: 1.4550, instance_loss: 0.8611, weighted_loss: 1.2768, label: 2, bag_size: 2326
batch 79, loss: 0.2946, instance_loss: 0.3800, weighted_loss: 0.3202, label: 1, bag_size: 4705
batch 99, loss: 1.1840, instance_loss: 0.8172, weighted_loss: 1.0739, label: 2, bag_size: 4141
batch 119, loss: 0.4602, instance_loss: 0.6225, weighted_loss: 0.5089, label: 0, bag_size: 4918
batch 139, loss: 0.1777, instance_loss: 0.4459, weighted_loss: 0.2581, label: 2, bag_size: 4088
batch 159, loss: 0.2963, instance_loss: 0.6177, weighted_loss: 0.3927, label: 2, bag_size: 4372
batch 179, loss: 0.0951, instance_loss: 0.3102, weighted_loss: 0.1597, label: 1, bag_size: 1836
batch 199, loss: 1.4834, instance_loss: 1.0004, weighted_loss: 1.3385, label: 2, bag_size: 1543
batch 219, loss: 0.6647, instance_loss: 0.6268, weighted_loss: 0.6533, label: 0, bag_size: 4460
batch 239, loss: 1.5910, instance_loss: 0.9952, weighted_loss: 1.4123, label: 1, bag_size: 3322
batch 259, loss: 1.1269, instance_loss: 0.4827, weighted_loss: 0.9336, label: 0, bag_size: 4808
batch 279, loss: 2.2821, instance_loss: 1.0649, weighted_loss: 1.9169, label: 1, bag_size: 4258
batch 299, loss: 1.7834, instance_loss: 0.9560, weighted_loss: 1.5352, label: 1, bag_size: 1604
batch 319, loss: 0.7310, instance_loss: 0.6445, weighted_loss: 0.7050, label: 1, bag_size: 3403
batch 339, loss: 0.5264, instance_loss: 0.5470, weighted_loss: 0.5326, label: 0, bag_size: 5899
batch 359, loss: 1.0028, instance_loss: 0.6780, weighted_loss: 0.9053, label: 1, bag_size: 3051
batch 379, loss: 0.4176, instance_loss: 0.5410, weighted_loss: 0.4546, label: 2, bag_size: 3778
batch 399, loss: 3.3780, instance_loss: 1.0402, weighted_loss: 2.6766, label: 1, bag_size: 3791
batch 419, loss: 0.8544, instance_loss: 0.6850, weighted_loss: 0.8036, label: 0, bag_size: 3188
batch 439, loss: 0.8532, instance_loss: 0.6572, weighted_loss: 0.7944, label: 2, bag_size: 597
batch 459, loss: 0.3357, instance_loss: 0.3877, weighted_loss: 0.3513, label: 2, bag_size: 4910
batch 479, loss: 0.8074, instance_loss: 0.6603, weighted_loss: 0.7633, label: 1, bag_size: 1394
batch 499, loss: 0.7526, instance_loss: 0.6943, weighted_loss: 0.7351, label: 0, bag_size: 3904
batch 519, loss: 1.3567, instance_loss: 0.7911, weighted_loss: 1.1870, label: 1, bag_size: 3261
batch 539, loss: 1.3334, instance_loss: 0.7740, weighted_loss: 1.1656, label: 1, bag_size: 1608
batch 559, loss: 0.1266, instance_loss: 0.2451, weighted_loss: 0.1622, label: 2, bag_size: 4088
batch 579, loss: 0.8313, instance_loss: 0.5669, weighted_loss: 0.7520, label: 2, bag_size: 3534
batch 599, loss: 0.7350, instance_loss: 0.5722, weighted_loss: 0.6862, label: 1, bag_size: 6992
batch 619, loss: 0.5398, instance_loss: 0.4506, weighted_loss: 0.5131, label: 0, bag_size: 3789
batch 639, loss: 0.3346, instance_loss: 0.4840, weighted_loss: 0.3795, label: 0, bag_size: 1399
batch 659, loss: 0.8054, instance_loss: 0.6578, weighted_loss: 0.7611, label: 1, bag_size: 2962
batch 679, loss: 0.0885, instance_loss: 0.2548, weighted_loss: 0.1384, label: 2, bag_size: 5426
batch 699, loss: 1.7409, instance_loss: 1.2720, weighted_loss: 1.6002, label: 1, bag_size: 936
batch 719, loss: 0.3549, instance_loss: 0.2389, weighted_loss: 0.3201, label: 2, bag_size: 4223
batch 739, loss: 0.3984, instance_loss: 0.5285, weighted_loss: 0.4374, label: 1, bag_size: 3367


class 0 clustering acc 0.993847874720358: correct 17770/17880
class 1 clustering acc 0.06359060402684563: correct 379/5960
Epoch: 2, train_loss: 0.8258, train_clustering_loss:  0.6433, train_error: 0.3638
class 0: acc 0.6160337552742616, correct 146/237
class 1: acc 0.522633744855967, correct 127/243
class 2: acc 0.7584905660377359, correct 201/265

Val Set, val_loss: 0.7945, val_error: 0.3404, auc: 0.8031
class 0 clustering acc 0.9929078014184397: correct 2240/2256
class 1 clustering acc 0.02127659574468085: correct 16/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.886354 --> 0.794526).  Saving model ...


batch 19, loss: 3.0331, instance_loss: 0.9358, weighted_loss: 2.4039, label: 0, bag_size: 4605
batch 39, loss: 0.5549, instance_loss: 0.5532, weighted_loss: 0.5544, label: 1, bag_size: 1558
batch 59, loss: 0.3883, instance_loss: 0.5787, weighted_loss: 0.4454, label: 1, bag_size: 2009
batch 79, loss: 0.2385, instance_loss: 0.4224, weighted_loss: 0.2937, label: 0, bag_size: 1640
batch 99, loss: 0.4613, instance_loss: 0.6212, weighted_loss: 0.5093, label: 2, bag_size: 614
batch 119, loss: 0.4765, instance_loss: 0.4585, weighted_loss: 0.4711, label: 0, bag_size: 13540
batch 139, loss: 0.5931, instance_loss: 0.4610, weighted_loss: 0.5535, label: 0, bag_size: 4946
batch 159, loss: 0.5772, instance_loss: 0.4282, weighted_loss: 0.5325, label: 0, bag_size: 1204
batch 179, loss: 2.7898, instance_loss: 1.0312, weighted_loss: 2.2622, label: 2, bag_size: 361
batch 199, loss: 0.4516, instance_loss: 0.5714, weighted_loss: 0.4876, label: 1, bag_size: 455
batch 219, loss: 0.3290, instance_loss: 0.4998, weighted_loss: 0.3803, label: 0, bag_size: 5632
batch 239, loss: 1.6581, instance_loss: 0.9171, weighted_loss: 1.4358, label: 1, bag_size: 4346
batch 259, loss: 1.0740, instance_loss: 0.7688, weighted_loss: 0.9824, label: 0, bag_size: 621
batch 279, loss: 1.1584, instance_loss: 0.6404, weighted_loss: 1.0030, label: 0, bag_size: 11141
batch 299, loss: 0.9417, instance_loss: 0.7041, weighted_loss: 0.8704, label: 0, bag_size: 5848
batch 319, loss: 0.2683, instance_loss: 0.4228, weighted_loss: 0.3147, label: 2, bag_size: 2501
batch 339, loss: 0.3301, instance_loss: 0.3937, weighted_loss: 0.3492, label: 2, bag_size: 4291
batch 359, loss: 0.4757, instance_loss: 0.8625, weighted_loss: 0.5917, label: 1, bag_size: 4812
batch 379, loss: 0.3124, instance_loss: 0.4614, weighted_loss: 0.3571, label: 2, bag_size: 2561
batch 399, loss: 1.2953, instance_loss: 0.8834, weighted_loss: 1.1717, label: 1, bag_size: 2831
batch 419, loss: 0.6264, instance_loss: 0.5881, weighted_loss: 0.6149, label: 0, bag_size: 1562
batch 439, loss: 0.3329, instance_loss: 0.3441, weighted_loss: 0.3363, label: 2, bag_size: 657
batch 459, loss: 0.6329, instance_loss: 0.8056, weighted_loss: 0.6847, label: 1, bag_size: 6315
batch 479, loss: 1.5104, instance_loss: 0.7540, weighted_loss: 1.2835, label: 2, bag_size: 3534
batch 499, loss: 0.8566, instance_loss: 0.7324, weighted_loss: 0.8194, label: 0, bag_size: 4460
batch 519, loss: 1.4370, instance_loss: 0.8219, weighted_loss: 1.2525, label: 1, bag_size: 3399
batch 539, loss: 0.3148, instance_loss: 0.5176, weighted_loss: 0.3757, label: 0, bag_size: 5226
batch 559, loss: 0.9241, instance_loss: 0.7079, weighted_loss: 0.8592, label: 1, bag_size: 4262
batch 579, loss: 0.6035, instance_loss: 0.8236, weighted_loss: 0.6695, label: 2, bag_size: 4978
batch 599, loss: 0.4234, instance_loss: 0.5775, weighted_loss: 0.4696, label: 0, bag_size: 1018
batch 619, loss: 0.2111, instance_loss: 0.2929, weighted_loss: 0.2356, label: 0, bag_size: 3986
batch 639, loss: 0.7091, instance_loss: 0.6125, weighted_loss: 0.6801, label: 0, bag_size: 4894
batch 659, loss: 0.1141, instance_loss: 0.1531, weighted_loss: 0.1258, label: 2, bag_size: 3176
batch 679, loss: 0.5354, instance_loss: 0.7340, weighted_loss: 0.5950, label: 2, bag_size: 5017
batch 699, loss: 0.8737, instance_loss: 0.8260, weighted_loss: 0.8594, label: 0, bag_size: 3182
batch 719, loss: 0.5554, instance_loss: 0.5210, weighted_loss: 0.5451, label: 1, bag_size: 3403
batch 739, loss: 0.0335, instance_loss: 0.1563, weighted_loss: 0.0703, label: 1, bag_size: 2493


class 0 clustering acc 0.9857941834451902: correct 17626/17880
class 1 clustering acc 0.11879194630872483: correct 708/5960
Epoch: 3, train_loss: 0.7679, train_clustering_loss:  0.6198, train_error: 0.3141
class 0: acc 0.728, correct 182/250
class 1: acc 0.5836734693877551, correct 143/245
class 2: acc 0.744, correct 186/250

Val Set, val_loss: 0.7702, val_error: 0.3191, auc: 0.7826
class 0 clustering acc 0.9831560283687943: correct 2218/2256
class 1 clustering acc 0.10904255319148937: correct 82/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.794526 --> 0.770170).  Saving model ...


batch 19, loss: 0.1426, instance_loss: 0.3808, weighted_loss: 0.2141, label: 0, bag_size: 2791
batch 39, loss: 0.5381, instance_loss: 0.4924, weighted_loss: 0.5244, label: 1, bag_size: 5276
batch 59, loss: 1.3217, instance_loss: 0.8297, weighted_loss: 1.1741, label: 2, bag_size: 1050
batch 79, loss: 0.1846, instance_loss: 0.4454, weighted_loss: 0.2628, label: 0, bag_size: 2339
batch 99, loss: 0.5158, instance_loss: 0.3460, weighted_loss: 0.4649, label: 2, bag_size: 3534
batch 119, loss: 0.0434, instance_loss: 0.2408, weighted_loss: 0.1026, label: 2, bag_size: 2254
batch 139, loss: 0.4808, instance_loss: 0.7162, weighted_loss: 0.5514, label: 2, bag_size: 2486
batch 159, loss: 1.0250, instance_loss: 0.7453, weighted_loss: 0.9411, label: 1, bag_size: 3422
batch 179, loss: 2.6417, instance_loss: 1.2521, weighted_loss: 2.2248, label: 0, bag_size: 1420
batch 199, loss: 0.0324, instance_loss: 0.2181, weighted_loss: 0.0881, label: 0, bag_size: 3437
batch 219, loss: 0.0450, instance_loss: 0.2220, weighted_loss: 0.0981, label: 2, bag_size: 1094
batch 239, loss: 0.2571, instance_loss: 0.5471, weighted_loss: 0.3441, label: 2, bag_size: 3172
batch 259, loss: 0.3495, instance_loss: 0.3505, weighted_loss: 0.3498, label: 0, bag_size: 3915
batch 279, loss: 0.1271, instance_loss: 0.4318, weighted_loss: 0.2185, label: 0, bag_size: 1485
batch 299, loss: 0.4858, instance_loss: 0.4030, weighted_loss: 0.4609, label: 0, bag_size: 5006
batch 319, loss: 1.5789, instance_loss: 0.9682, weighted_loss: 1.3957, label: 1, bag_size: 2229
batch 339, loss: 0.8937, instance_loss: 0.7520, weighted_loss: 0.8512, label: 0, bag_size: 4485
batch 359, loss: 0.8315, instance_loss: 0.5511, weighted_loss: 0.7474, label: 0, bag_size: 4201
batch 379, loss: 0.9234, instance_loss: 0.7595, weighted_loss: 0.8742, label: 1, bag_size: 6243
batch 399, loss: 1.7943, instance_loss: 1.0311, weighted_loss: 1.5653, label: 2, bag_size: 3475
batch 419, loss: 0.5602, instance_loss: 0.5620, weighted_loss: 0.5607, label: 0, bag_size: 4146
batch 439, loss: 0.5733, instance_loss: 0.4225, weighted_loss: 0.5281, label: 2, bag_size: 4096
batch 459, loss: 0.4477, instance_loss: 0.4603, weighted_loss: 0.4515, label: 2, bag_size: 3746
batch 479, loss: 0.3779, instance_loss: 0.6085, weighted_loss: 0.4471, label: 1, bag_size: 1599
batch 499, loss: 0.5636, instance_loss: 0.7135, weighted_loss: 0.6086, label: 1, bag_size: 3357
batch 519, loss: 1.2167, instance_loss: 0.7923, weighted_loss: 1.0894, label: 1, bag_size: 4824
batch 539, loss: 2.1908, instance_loss: 1.2732, weighted_loss: 1.9155, label: 0, bag_size: 455
batch 559, loss: 0.8998, instance_loss: 0.7880, weighted_loss: 0.8663, label: 1, bag_size: 2751
batch 579, loss: 0.7680, instance_loss: 0.5836, weighted_loss: 0.7127, label: 1, bag_size: 4373
batch 599, loss: 1.0493, instance_loss: 0.8682, weighted_loss: 0.9950, label: 1, bag_size: 1964
batch 619, loss: 0.6690, instance_loss: 0.6882, weighted_loss: 0.6748, label: 0, bag_size: 7330
batch 639, loss: 0.3597, instance_loss: 0.5510, weighted_loss: 0.4171, label: 0, bag_size: 640
batch 659, loss: 0.3969, instance_loss: 0.7769, weighted_loss: 0.5109, label: 0, bag_size: 3245
batch 679, loss: 0.6645, instance_loss: 0.5982, weighted_loss: 0.6446, label: 0, bag_size: 6015
batch 699, loss: 1.0363, instance_loss: 0.6843, weighted_loss: 0.9307, label: 1, bag_size: 6993
batch 719, loss: 0.2341, instance_loss: 0.5458, weighted_loss: 0.3276, label: 0, bag_size: 4070
batch 739, loss: 1.7696, instance_loss: 0.7546, weighted_loss: 1.4651, label: 2, bag_size: 2031


class 0 clustering acc 0.9832214765100671: correct 17580/17880
class 1 clustering acc 0.14513422818791946: correct 865/5960
Epoch: 4, train_loss: 0.7438, train_clustering_loss:  0.6205, train_error: 0.3154
class 0: acc 0.7413127413127413, correct 192/259
class 1: acc 0.5221238938053098, correct 118/226
class 2: acc 0.7692307692307693, correct 200/260

Val Set, val_loss: 0.8657, val_error: 0.4043, auc: 0.7906
class 0 clustering acc 0.988031914893617: correct 2229/2256
class 1 clustering acc 0.11835106382978723: correct 89/752
class 0: acc 0.5192307692307693, correct 27/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.7515, instance_loss: 1.3389, weighted_loss: 2.3277, label: 1, bag_size: 3159
batch 39, loss: 0.9568, instance_loss: 0.7426, weighted_loss: 0.8925, label: 1, bag_size: 1712
batch 59, loss: 1.8570, instance_loss: 0.7139, weighted_loss: 1.5141, label: 2, bag_size: 5307
batch 79, loss: 0.2778, instance_loss: 0.4736, weighted_loss: 0.3365, label: 1, bag_size: 3493
batch 99, loss: 0.3786, instance_loss: 0.3203, weighted_loss: 0.3611, label: 2, bag_size: 3080
batch 119, loss: 0.2321, instance_loss: 0.5256, weighted_loss: 0.3201, label: 0, bag_size: 2601
batch 139, loss: 0.2391, instance_loss: 0.2532, weighted_loss: 0.2433, label: 1, bag_size: 6475
batch 159, loss: 0.4573, instance_loss: 0.4304, weighted_loss: 0.4493, label: 2, bag_size: 4056
batch 179, loss: 0.2222, instance_loss: 0.3316, weighted_loss: 0.2550, label: 0, bag_size: 3936
batch 199, loss: 0.5864, instance_loss: 0.4783, weighted_loss: 0.5540, label: 2, bag_size: 3227
batch 219, loss: 0.1246, instance_loss: 0.3607, weighted_loss: 0.1954, label: 2, bag_size: 3678
batch 239, loss: 0.7498, instance_loss: 0.8134, weighted_loss: 0.7689, label: 1, bag_size: 3611
batch 259, loss: 0.3034, instance_loss: 0.3254, weighted_loss: 0.3100, label: 1, bag_size: 862
batch 279, loss: 0.5352, instance_loss: 0.6573, weighted_loss: 0.5718, label: 2, bag_size: 5472
batch 299, loss: 0.5198, instance_loss: 0.7436, weighted_loss: 0.5869, label: 0, bag_size: 6971
batch 319, loss: 0.8114, instance_loss: 0.7977, weighted_loss: 0.8073, label: 0, bag_size: 7177
batch 339, loss: 1.3967, instance_loss: 0.7797, weighted_loss: 1.2116, label: 0, bag_size: 5259
batch 359, loss: 0.3323, instance_loss: 0.6735, weighted_loss: 0.4347, label: 1, bag_size: 6315
batch 379, loss: 0.1273, instance_loss: 0.3942, weighted_loss: 0.2073, label: 2, bag_size: 4856
batch 399, loss: 0.5952, instance_loss: 0.4845, weighted_loss: 0.5620, label: 1, bag_size: 4438
batch 419, loss: 0.6160, instance_loss: 0.5396, weighted_loss: 0.5931, label: 1, bag_size: 2743
batch 439, loss: 0.5538, instance_loss: 0.5596, weighted_loss: 0.5555, label: 0, bag_size: 5260
batch 459, loss: 1.3711, instance_loss: 0.5959, weighted_loss: 1.1385, label: 2, bag_size: 3274
batch 479, loss: 0.9637, instance_loss: 0.5604, weighted_loss: 0.8427, label: 0, bag_size: 4921
batch 499, loss: 2.3015, instance_loss: 0.9471, weighted_loss: 1.8952, label: 2, bag_size: 361
batch 519, loss: 0.3248, instance_loss: 0.3099, weighted_loss: 0.3203, label: 2, bag_size: 2359
batch 539, loss: 0.4062, instance_loss: 0.3295, weighted_loss: 0.3832, label: 0, bag_size: 3915
batch 559, loss: 0.2366, instance_loss: 0.3541, weighted_loss: 0.2718, label: 2, bag_size: 657
batch 579, loss: 0.8505, instance_loss: 0.5291, weighted_loss: 0.7541, label: 0, bag_size: 3793
batch 599, loss: 0.5909, instance_loss: 0.7557, weighted_loss: 0.6403, label: 0, bag_size: 996
batch 619, loss: 0.4747, instance_loss: 0.5783, weighted_loss: 0.5058, label: 1, bag_size: 3821
batch 639, loss: 0.8472, instance_loss: 0.5667, weighted_loss: 0.7631, label: 1, bag_size: 5402
batch 659, loss: 0.0319, instance_loss: 0.2616, weighted_loss: 0.1008, label: 1, bag_size: 4134
batch 679, loss: 1.8806, instance_loss: 0.9827, weighted_loss: 1.6112, label: 1, bag_size: 5035
batch 699, loss: 0.4101, instance_loss: 0.5818, weighted_loss: 0.4616, label: 2, bag_size: 5637
batch 719, loss: 0.4545, instance_loss: 0.5836, weighted_loss: 0.4932, label: 1, bag_size: 1599
batch 739, loss: 0.2241, instance_loss: 0.3058, weighted_loss: 0.2486, label: 2, bag_size: 3210


class 0 clustering acc 0.9858501118568233: correct 17627/17880
class 1 clustering acc 0.10067114093959731: correct 600/5960
Epoch: 5, train_loss: 0.8160, train_clustering_loss:  0.6376, train_error: 0.3758
class 0: acc 0.6132075471698113, correct 130/212
class 1: acc 0.5272727272727272, correct 145/275
class 2: acc 0.7364341085271318, correct 190/258

Val Set, val_loss: 1.0457, val_error: 0.4362, auc: 0.7815
class 0 clustering acc 0.9867021276595744: correct 2226/2256
class 1 clustering acc 0.10904255319148937: correct 82/752
class 0: acc 0.36538461538461536, correct 19/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2591, instance_loss: 1.0032, weighted_loss: 1.1823, label: 0, bag_size: 3245
batch 39, loss: 0.8041, instance_loss: 0.7612, weighted_loss: 0.7913, label: 2, bag_size: 4162
batch 59, loss: 3.1006, instance_loss: 1.1468, weighted_loss: 2.5144, label: 2, bag_size: 361
batch 79, loss: 1.2991, instance_loss: 0.8809, weighted_loss: 1.1736, label: 0, bag_size: 1562
batch 99, loss: 0.4595, instance_loss: 0.4687, weighted_loss: 0.4623, label: 0, bag_size: 2190
batch 119, loss: 0.6667, instance_loss: 0.5656, weighted_loss: 0.6363, label: 1, bag_size: 1410
batch 139, loss: 0.2381, instance_loss: 0.3062, weighted_loss: 0.2585, label: 2, bag_size: 4088
batch 159, loss: 0.6454, instance_loss: 0.5482, weighted_loss: 0.6162, label: 0, bag_size: 1353
batch 179, loss: 0.8482, instance_loss: 0.6847, weighted_loss: 0.7991, label: 1, bag_size: 578
batch 199, loss: 0.0354, instance_loss: 0.2099, weighted_loss: 0.0877, label: 2, bag_size: 2422
batch 219, loss: 0.4949, instance_loss: 0.4207, weighted_loss: 0.4726, label: 1, bag_size: 4599
batch 239, loss: 0.5777, instance_loss: 0.4622, weighted_loss: 0.5431, label: 2, bag_size: 3778
batch 259, loss: 0.5893, instance_loss: 0.8279, weighted_loss: 0.6609, label: 0, bag_size: 1744
batch 279, loss: 0.3765, instance_loss: 0.3649, weighted_loss: 0.3730, label: 1, bag_size: 3403
batch 299, loss: 0.3112, instance_loss: 0.5842, weighted_loss: 0.3931, label: 2, bag_size: 3810
batch 319, loss: 2.2868, instance_loss: 1.2574, weighted_loss: 1.9780, label: 2, bag_size: 2326
batch 339, loss: 0.8583, instance_loss: 0.7296, weighted_loss: 0.8197, label: 1, bag_size: 4599
batch 359, loss: 0.2574, instance_loss: 0.4970, weighted_loss: 0.3293, label: 2, bag_size: 2313
batch 379, loss: 1.5157, instance_loss: 0.6697, weighted_loss: 1.2619, label: 2, bag_size: 4241
batch 399, loss: 0.6234, instance_loss: 0.8200, weighted_loss: 0.6824, label: 1, bag_size: 5512
batch 419, loss: 0.8748, instance_loss: 0.7849, weighted_loss: 0.8478, label: 1, bag_size: 2481
batch 439, loss: 0.6304, instance_loss: 0.5609, weighted_loss: 0.6096, label: 1, bag_size: 3786
batch 459, loss: 0.0946, instance_loss: 0.2655, weighted_loss: 0.1459, label: 2, bag_size: 3121
batch 479, loss: 1.2321, instance_loss: 0.7392, weighted_loss: 1.0842, label: 0, bag_size: 4220
batch 499, loss: 0.3480, instance_loss: 0.5722, weighted_loss: 0.4152, label: 0, bag_size: 5036
batch 519, loss: 0.0586, instance_loss: 0.2836, weighted_loss: 0.1261, label: 2, bag_size: 4088
batch 539, loss: 0.5697, instance_loss: 0.5535, weighted_loss: 0.5649, label: 1, bag_size: 3746
batch 559, loss: 0.1882, instance_loss: 0.5641, weighted_loss: 0.3010, label: 0, bag_size: 4914
batch 579, loss: 1.1180, instance_loss: 0.7954, weighted_loss: 1.0212, label: 2, bag_size: 3299
batch 599, loss: 1.9101, instance_loss: 1.2423, weighted_loss: 1.7098, label: 0, bag_size: 436
batch 619, loss: 0.3276, instance_loss: 0.4455, weighted_loss: 0.3630, label: 2, bag_size: 3678
batch 639, loss: 0.1663, instance_loss: 0.4010, weighted_loss: 0.2367, label: 0, bag_size: 5757
batch 659, loss: 0.4783, instance_loss: 0.5003, weighted_loss: 0.4849, label: 0, bag_size: 5368
batch 679, loss: 0.2402, instance_loss: 0.5331, weighted_loss: 0.3281, label: 1, bag_size: 1807
batch 699, loss: 1.3935, instance_loss: 0.9333, weighted_loss: 1.2555, label: 1, bag_size: 6942
batch 719, loss: 0.5969, instance_loss: 0.5905, weighted_loss: 0.5950, label: 1, bag_size: 2919
batch 739, loss: 0.5476, instance_loss: 0.6541, weighted_loss: 0.5796, label: 1, bag_size: 2962


class 0 clustering acc 0.9861297539149888: correct 17632/17880
class 1 clustering acc 0.11342281879194631: correct 676/5960
Epoch: 6, train_loss: 0.7692, train_clustering_loss:  0.6265, train_error: 0.3315
class 0: acc 0.6791666666666667, correct 163/240
class 1: acc 0.5882352941176471, correct 150/255
class 2: acc 0.74, correct 185/250

Val Set, val_loss: 0.7742, val_error: 0.3404, auc: 0.7881
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.2526595744680851: correct 190/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3925, instance_loss: 0.5530, weighted_loss: 0.4407, label: 0, bag_size: 5823
batch 39, loss: 1.8086, instance_loss: 1.5007, weighted_loss: 1.7162, label: 2, bag_size: 4241
batch 59, loss: 1.1436, instance_loss: 1.0788, weighted_loss: 1.1241, label: 0, bag_size: 893
batch 79, loss: 1.3646, instance_loss: 0.7342, weighted_loss: 1.1755, label: 1, bag_size: 1906
batch 99, loss: 0.0912, instance_loss: 0.3281, weighted_loss: 0.1623, label: 2, bag_size: 6273
batch 119, loss: 0.2161, instance_loss: 0.3793, weighted_loss: 0.2650, label: 2, bag_size: 3174
batch 139, loss: 0.1812, instance_loss: 0.3720, weighted_loss: 0.2384, label: 2, bag_size: 4043
batch 159, loss: 1.0514, instance_loss: 0.6233, weighted_loss: 0.9230, label: 1, bag_size: 1860
batch 179, loss: 0.2212, instance_loss: 0.3845, weighted_loss: 0.2702, label: 2, bag_size: 3534
batch 199, loss: 0.9596, instance_loss: 0.6452, weighted_loss: 0.8653, label: 1, bag_size: 1066
batch 219, loss: 0.4855, instance_loss: 0.5728, weighted_loss: 0.5117, label: 2, bag_size: 4140
batch 239, loss: 0.6087, instance_loss: 0.6691, weighted_loss: 0.6268, label: 2, bag_size: 2486
batch 259, loss: 1.7752, instance_loss: 0.9927, weighted_loss: 1.5405, label: 0, bag_size: 1695
batch 279, loss: 0.6627, instance_loss: 0.5695, weighted_loss: 0.6347, label: 0, bag_size: 5340
batch 299, loss: 0.2128, instance_loss: 0.4570, weighted_loss: 0.2861, label: 2, bag_size: 6273
batch 319, loss: 0.6005, instance_loss: 0.8586, weighted_loss: 0.6779, label: 2, bag_size: 5072
batch 339, loss: 0.2450, instance_loss: 0.3505, weighted_loss: 0.2766, label: 2, bag_size: 4223
batch 359, loss: 1.2379, instance_loss: 0.9241, weighted_loss: 1.1438, label: 1, bag_size: 5276
batch 379, loss: 0.4940, instance_loss: 0.4381, weighted_loss: 0.4772, label: 0, bag_size: 4935
batch 399, loss: 0.6204, instance_loss: 0.5570, weighted_loss: 0.6014, label: 1, bag_size: 1066
batch 419, loss: 1.0184, instance_loss: 0.8131, weighted_loss: 0.9568, label: 0, bag_size: 5848
batch 439, loss: 1.4791, instance_loss: 0.8729, weighted_loss: 1.2972, label: 1, bag_size: 1307
batch 459, loss: 0.3754, instance_loss: 0.9860, weighted_loss: 0.5586, label: 1, bag_size: 4067
batch 479, loss: 0.9182, instance_loss: 0.7697, weighted_loss: 0.8737, label: 1, bag_size: 3596
batch 499, loss: 0.3219, instance_loss: 0.4795, weighted_loss: 0.3692, label: 1, bag_size: 2009
batch 519, loss: 1.3699, instance_loss: 0.9382, weighted_loss: 1.2404, label: 0, bag_size: 1052
batch 539, loss: 0.7353, instance_loss: 0.7651, weighted_loss: 0.7443, label: 2, bag_size: 5406
batch 559, loss: 3.6545, instance_loss: 1.4626, weighted_loss: 2.9969, label: 0, bag_size: 3419
batch 579, loss: 0.1607, instance_loss: 0.4021, weighted_loss: 0.2331, label: 2, bag_size: 6273
batch 599, loss: 0.4288, instance_loss: 0.6404, weighted_loss: 0.4923, label: 1, bag_size: 2919
batch 619, loss: 0.1514, instance_loss: 0.5585, weighted_loss: 0.2735, label: 0, bag_size: 3539
batch 639, loss: 0.9734, instance_loss: 0.7068, weighted_loss: 0.8934, label: 2, bag_size: 3172
batch 659, loss: 0.2525, instance_loss: 0.2551, weighted_loss: 0.2533, label: 0, bag_size: 4070
batch 679, loss: 0.6001, instance_loss: 0.6857, weighted_loss: 0.6258, label: 1, bag_size: 700
batch 699, loss: 1.1454, instance_loss: 0.6610, weighted_loss: 1.0000, label: 0, bag_size: 6440
batch 719, loss: 0.1275, instance_loss: 0.3334, weighted_loss: 0.1893, label: 0, bag_size: 1845
batch 739, loss: 0.9978, instance_loss: 0.6778, weighted_loss: 0.9018, label: 0, bag_size: 4719


class 0 clustering acc 0.9812080536912752: correct 17544/17880
class 1 clustering acc 0.1407718120805369: correct 839/5960
Epoch: 7, train_loss: 0.7457, train_clustering_loss:  0.6322, train_error: 0.3315
class 0: acc 0.6739130434782609, correct 155/230
class 1: acc 0.5371900826446281, correct 130/242
class 2: acc 0.7802197802197802, correct 213/273

Val Set, val_loss: 0.7331, val_error: 0.3298, auc: 0.8003
class 0 clustering acc 0.9534574468085106: correct 2151/2256
class 1 clustering acc 0.3324468085106383: correct 250/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.770170 --> 0.733113).  Saving model ...


batch 19, loss: 0.6093, instance_loss: 0.3810, weighted_loss: 0.5408, label: 2, bag_size: 2031
batch 39, loss: 1.7252, instance_loss: 1.2292, weighted_loss: 1.5764, label: 0, bag_size: 1562
batch 59, loss: 0.1846, instance_loss: 0.3097, weighted_loss: 0.2221, label: 2, bag_size: 4856
batch 79, loss: 0.0500, instance_loss: 0.2945, weighted_loss: 0.1233, label: 1, bag_size: 2493
batch 99, loss: 0.4629, instance_loss: 0.7162, weighted_loss: 0.5389, label: 0, bag_size: 996
batch 119, loss: 0.2543, instance_loss: 0.7334, weighted_loss: 0.3981, label: 1, bag_size: 3493
batch 139, loss: 0.9012, instance_loss: 0.8490, weighted_loss: 0.8855, label: 2, bag_size: 2486
batch 159, loss: 0.1731, instance_loss: 0.2226, weighted_loss: 0.1880, label: 2, bag_size: 3026
batch 179, loss: 1.9333, instance_loss: 0.6096, weighted_loss: 1.5362, label: 2, bag_size: 2031
batch 199, loss: 0.3326, instance_loss: 0.4737, weighted_loss: 0.3749, label: 0, bag_size: 2884
batch 219, loss: 1.8790, instance_loss: 0.8279, weighted_loss: 1.5637, label: 2, bag_size: 552
batch 239, loss: 0.5478, instance_loss: 0.5983, weighted_loss: 0.5630, label: 1, bag_size: 582
batch 259, loss: 1.6505, instance_loss: 1.2279, weighted_loss: 1.5237, label: 2, bag_size: 4241
batch 279, loss: 1.5029, instance_loss: 0.7153, weighted_loss: 1.2666, label: 0, bag_size: 4347
batch 299, loss: 1.3488, instance_loss: 1.1053, weighted_loss: 1.2757, label: 1, bag_size: 1549
batch 319, loss: 0.9081, instance_loss: 0.7699, weighted_loss: 0.8666, label: 1, bag_size: 3533
batch 339, loss: 0.4355, instance_loss: 0.5503, weighted_loss: 0.4699, label: 0, bag_size: 4242
batch 359, loss: 1.0092, instance_loss: 0.6457, weighted_loss: 0.9001, label: 1, bag_size: 4784
batch 379, loss: 1.6995, instance_loss: 0.7116, weighted_loss: 1.4032, label: 0, bag_size: 3341
batch 399, loss: 0.1366, instance_loss: 0.2187, weighted_loss: 0.1612, label: 2, bag_size: 4043
batch 419, loss: 1.6081, instance_loss: 0.7777, weighted_loss: 1.3590, label: 2, bag_size: 3274
batch 439, loss: 0.9617, instance_loss: 0.6720, weighted_loss: 0.8748, label: 2, bag_size: 1050
batch 459, loss: 0.5659, instance_loss: 0.4524, weighted_loss: 0.5319, label: 2, bag_size: 2905
batch 479, loss: 0.6347, instance_loss: 0.7002, weighted_loss: 0.6544, label: 0, bag_size: 921
batch 499, loss: 0.6008, instance_loss: 0.7320, weighted_loss: 0.6402, label: 0, bag_size: 6285
batch 519, loss: 0.2863, instance_loss: 0.3504, weighted_loss: 0.3055, label: 0, bag_size: 3752
batch 539, loss: 0.6791, instance_loss: 0.4238, weighted_loss: 0.6025, label: 0, bag_size: 16741
batch 559, loss: 0.7245, instance_loss: 0.6455, weighted_loss: 0.7008, label: 0, bag_size: 5170
batch 579, loss: 3.2263, instance_loss: 1.2398, weighted_loss: 2.6304, label: 0, bag_size: 3750
batch 599, loss: 0.5580, instance_loss: 0.7879, weighted_loss: 0.6270, label: 2, bag_size: 3607
batch 619, loss: 0.7351, instance_loss: 0.4771, weighted_loss: 0.6577, label: 0, bag_size: 4541
batch 639, loss: 1.4860, instance_loss: 1.5585, weighted_loss: 1.5078, label: 0, bag_size: 2231
batch 659, loss: 0.1350, instance_loss: 0.4524, weighted_loss: 0.2302, label: 1, bag_size: 4027
batch 679, loss: 1.2883, instance_loss: 1.1204, weighted_loss: 1.2379, label: 2, bag_size: 2486
batch 699, loss: 1.1478, instance_loss: 0.7698, weighted_loss: 1.0344, label: 2, bag_size: 3112
batch 719, loss: 0.1039, instance_loss: 0.2628, weighted_loss: 0.1516, label: 2, bag_size: 4223
batch 739, loss: 0.3535, instance_loss: 0.3501, weighted_loss: 0.3525, label: 2, bag_size: 4223


class 0 clustering acc 0.9808165548098434: correct 17537/17880
class 1 clustering acc 0.16661073825503356: correct 993/5960
Epoch: 8, train_loss: 0.7304, train_clustering_loss:  0.6243, train_error: 0.3114
class 0: acc 0.7628458498023716, correct 193/253
class 1: acc 0.5992217898832685, correct 154/257
class 2: acc 0.7063829787234043, correct 166/235

Val Set, val_loss: 0.7000, val_error: 0.2979, auc: 0.8439
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.25398936170212766: correct 191/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.733113 --> 0.700020).  Saving model ...


batch 19, loss: 2.1872, instance_loss: 1.3430, weighted_loss: 1.9340, label: 1, bag_size: 4694
batch 39, loss: 0.0579, instance_loss: 0.3063, weighted_loss: 0.1324, label: 0, bag_size: 966
batch 59, loss: 2.2715, instance_loss: 1.5217, weighted_loss: 2.0466, label: 1, bag_size: 20666
batch 79, loss: 0.2360, instance_loss: 0.3661, weighted_loss: 0.2750, label: 0, bag_size: 2825
batch 99, loss: 0.8995, instance_loss: 0.9664, weighted_loss: 0.9196, label: 0, bag_size: 3033
batch 119, loss: 1.6670, instance_loss: 1.3282, weighted_loss: 1.5654, label: 1, bag_size: 5205
batch 139, loss: 0.4330, instance_loss: 0.5455, weighted_loss: 0.4668, label: 0, bag_size: 2479
batch 159, loss: 0.2989, instance_loss: 0.5633, weighted_loss: 0.3783, label: 0, bag_size: 4741
batch 179, loss: 0.3735, instance_loss: 0.2701, weighted_loss: 0.3425, label: 2, bag_size: 3583
batch 199, loss: 0.4290, instance_loss: 0.6559, weighted_loss: 0.4970, label: 1, bag_size: 2919
batch 219, loss: 3.0326, instance_loss: 0.9401, weighted_loss: 2.4049, label: 0, bag_size: 12971
batch 239, loss: 0.9096, instance_loss: 0.6366, weighted_loss: 0.8277, label: 0, bag_size: 2559
batch 259, loss: 0.5713, instance_loss: 0.5549, weighted_loss: 0.5664, label: 2, bag_size: 5406
batch 279, loss: 1.2445, instance_loss: 0.9301, weighted_loss: 1.1502, label: 2, bag_size: 6594
batch 299, loss: 0.4100, instance_loss: 0.6497, weighted_loss: 0.4819, label: 2, bag_size: 4132
batch 319, loss: 0.1229, instance_loss: 0.3012, weighted_loss: 0.1763, label: 0, bag_size: 4458
batch 339, loss: 0.8726, instance_loss: 0.7097, weighted_loss: 0.8237, label: 1, bag_size: 2859
batch 359, loss: 0.6413, instance_loss: 0.5242, weighted_loss: 0.6062, label: 1, bag_size: 3051
batch 379, loss: 0.4430, instance_loss: 0.3729, weighted_loss: 0.4219, label: 2, bag_size: 2501
batch 399, loss: 0.2168, instance_loss: 0.3309, weighted_loss: 0.2510, label: 2, bag_size: 4223
batch 419, loss: 1.8985, instance_loss: 0.6611, weighted_loss: 1.5273, label: 0, bag_size: 4639
batch 439, loss: 0.2483, instance_loss: 0.3998, weighted_loss: 0.2938, label: 2, bag_size: 597
batch 459, loss: 0.2764, instance_loss: 0.5191, weighted_loss: 0.3492, label: 0, bag_size: 2853
batch 479, loss: 0.0000, instance_loss: 0.0099, weighted_loss: 0.0030, label: 0, bag_size: 3445
batch 499, loss: 0.6092, instance_loss: 0.7461, weighted_loss: 0.6503, label: 1, bag_size: 4644
batch 519, loss: 0.3680, instance_loss: 0.2555, weighted_loss: 0.3343, label: 2, bag_size: 2501
batch 539, loss: 0.4167, instance_loss: 0.5611, weighted_loss: 0.4600, label: 2, bag_size: 4291
batch 559, loss: 2.2479, instance_loss: 1.0873, weighted_loss: 1.8997, label: 1, bag_size: 3791
batch 579, loss: 0.4266, instance_loss: 0.4942, weighted_loss: 0.4468, label: 1, bag_size: 5760
batch 599, loss: 0.9974, instance_loss: 0.7773, weighted_loss: 0.9314, label: 1, bag_size: 3106
batch 619, loss: 0.2637, instance_loss: 0.4798, weighted_loss: 0.3285, label: 0, bag_size: 2487
batch 639, loss: 0.2984, instance_loss: 0.4320, weighted_loss: 0.3385, label: 0, bag_size: 2038
batch 659, loss: 1.8234, instance_loss: 0.7166, weighted_loss: 1.4913, label: 2, bag_size: 728
batch 679, loss: 1.1458, instance_loss: 0.6595, weighted_loss: 0.9999, label: 2, bag_size: 728
batch 699, loss: 2.0552, instance_loss: 1.0583, weighted_loss: 1.7561, label: 1, bag_size: 3508
batch 719, loss: 1.5053, instance_loss: 1.0618, weighted_loss: 1.3723, label: 0, bag_size: 22822
batch 739, loss: 1.1121, instance_loss: 0.6756, weighted_loss: 0.9811, label: 0, bag_size: 4145


class 0 clustering acc 0.9743288590604027: correct 17421/17880
class 1 clustering acc 0.237751677852349: correct 1417/5960
Epoch: 9, train_loss: 0.6737, train_clustering_loss:  0.5951, train_error: 0.2792
class 0: acc 0.7698412698412699, correct 194/252
class 1: acc 0.6254980079681275, correct 157/251
class 2: acc 0.768595041322314, correct 186/242

Val Set, val_loss: 0.7209, val_error: 0.2872, auc: 0.8208
class 0 clustering acc 0.9849290780141844: correct 2222/2256
class 1 clustering acc 0.14361702127659576: correct 108/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1614, instance_loss: 1.0021, weighted_loss: 1.1136, label: 1, bag_size: 3619
batch 39, loss: 0.8714, instance_loss: 0.6471, weighted_loss: 0.8041, label: 0, bag_size: 1373
batch 59, loss: 0.6972, instance_loss: 0.8011, weighted_loss: 0.7284, label: 1, bag_size: 11974
batch 79, loss: 0.4153, instance_loss: 0.5766, weighted_loss: 0.4637, label: 2, bag_size: 5406
batch 99, loss: 0.4547, instance_loss: 0.5304, weighted_loss: 0.4774, label: 1, bag_size: 3935
batch 119, loss: 0.4788, instance_loss: 0.5821, weighted_loss: 0.5098, label: 0, bag_size: 4310
batch 139, loss: 0.7424, instance_loss: 0.8346, weighted_loss: 0.7701, label: 0, bag_size: 4351
batch 159, loss: 0.1669, instance_loss: 0.3949, weighted_loss: 0.2353, label: 0, bag_size: 3408
batch 179, loss: 0.6308, instance_loss: 0.6299, weighted_loss: 0.6305, label: 0, bag_size: 4146
batch 199, loss: 0.9360, instance_loss: 0.4946, weighted_loss: 0.8036, label: 0, bag_size: 4310
batch 219, loss: 0.5104, instance_loss: 0.5915, weighted_loss: 0.5347, label: 0, bag_size: 1270
batch 239, loss: 0.8138, instance_loss: 0.6978, weighted_loss: 0.7790, label: 1, bag_size: 5003
batch 259, loss: 0.5982, instance_loss: 0.6045, weighted_loss: 0.6001, label: 0, bag_size: 2712
batch 279, loss: 0.4675, instance_loss: 0.5508, weighted_loss: 0.4925, label: 0, bag_size: 3915
batch 299, loss: 0.1581, instance_loss: 0.3365, weighted_loss: 0.2116, label: 1, bag_size: 6992
batch 319, loss: 2.2674, instance_loss: 1.1031, weighted_loss: 1.9181, label: 2, bag_size: 4316
batch 339, loss: 0.5381, instance_loss: 0.5954, weighted_loss: 0.5553, label: 2, bag_size: 3746
batch 359, loss: 4.3567, instance_loss: 1.0561, weighted_loss: 3.3665, label: 0, bag_size: 4605
batch 379, loss: 1.6264, instance_loss: 1.6155, weighted_loss: 1.6232, label: 2, bag_size: 4571
batch 399, loss: 0.4908, instance_loss: 0.4851, weighted_loss: 0.4891, label: 2, bag_size: 3534
batch 419, loss: 0.4900, instance_loss: 0.5154, weighted_loss: 0.4976, label: 0, bag_size: 5634
batch 439, loss: 0.6005, instance_loss: 0.4820, weighted_loss: 0.5650, label: 2, bag_size: 1543
batch 459, loss: 0.2364, instance_loss: 0.2532, weighted_loss: 0.2414, label: 2, bag_size: 4223
batch 479, loss: 0.6306, instance_loss: 0.5352, weighted_loss: 0.6020, label: 2, bag_size: 4291
batch 499, loss: 2.5965, instance_loss: 1.3872, weighted_loss: 2.2337, label: 2, bag_size: 4316
batch 519, loss: 0.0782, instance_loss: 0.2956, weighted_loss: 0.1434, label: 2, bag_size: 5138
batch 539, loss: 0.0901, instance_loss: 0.1748, weighted_loss: 0.1155, label: 2, bag_size: 5914
batch 559, loss: 0.1810, instance_loss: 0.2765, weighted_loss: 0.2097, label: 1, bag_size: 4705
batch 579, loss: 0.9496, instance_loss: 1.3954, weighted_loss: 1.0833, label: 0, bag_size: 3038
batch 599, loss: 1.4762, instance_loss: 0.6018, weighted_loss: 1.2139, label: 2, bag_size: 4241
batch 619, loss: 1.0086, instance_loss: 0.5704, weighted_loss: 0.8772, label: 2, bag_size: 552
batch 639, loss: 0.0953, instance_loss: 0.2658, weighted_loss: 0.1464, label: 0, bag_size: 2791
batch 659, loss: 0.4889, instance_loss: 0.6848, weighted_loss: 0.5476, label: 0, bag_size: 4274
batch 679, loss: 0.4964, instance_loss: 0.3783, weighted_loss: 0.4610, label: 0, bag_size: 3915
batch 699, loss: 1.1975, instance_loss: 0.5627, weighted_loss: 1.0071, label: 1, bag_size: 4467
batch 719, loss: 2.3522, instance_loss: 1.4452, weighted_loss: 2.0801, label: 1, bag_size: 3159
batch 739, loss: 0.9113, instance_loss: 0.7991, weighted_loss: 0.8776, label: 0, bag_size: 3675


class 0 clustering acc 0.9792505592841163: correct 17509/17880
class 1 clustering acc 0.21879194630872484: correct 1304/5960
Epoch: 10, train_loss: 0.7179, train_clustering_loss:  0.6034, train_error: 0.3020
class 0: acc 0.70995670995671, correct 164/231
class 1: acc 0.5849802371541502, correct 148/253
class 2: acc 0.7969348659003831, correct 208/261

Val Set, val_loss: 0.7406, val_error: 0.3085, auc: 0.8490
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.2127659574468085: correct 160/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7871, instance_loss: 0.9837, weighted_loss: 1.5461, label: 1, bag_size: 2248
batch 39, loss: 0.3833, instance_loss: 0.8480, weighted_loss: 0.5227, label: 1, bag_size: 3460
batch 59, loss: 1.6662, instance_loss: 1.0563, weighted_loss: 1.4832, label: 0, bag_size: 4274
batch 79, loss: 1.3843, instance_loss: 0.7352, weighted_loss: 1.1896, label: 2, bag_size: 1543
batch 99, loss: 0.4390, instance_loss: 0.7366, weighted_loss: 0.5283, label: 2, bag_size: 4132
batch 119, loss: 0.2165, instance_loss: 0.2635, weighted_loss: 0.2306, label: 0, bag_size: 3382
batch 139, loss: 0.4640, instance_loss: 0.6301, weighted_loss: 0.5138, label: 2, bag_size: 3746
batch 159, loss: 0.6928, instance_loss: 0.9524, weighted_loss: 0.7707, label: 2, bag_size: 5072
batch 179, loss: 2.1120, instance_loss: 1.2883, weighted_loss: 1.8649, label: 0, bag_size: 313
batch 199, loss: 3.1141, instance_loss: 1.2165, weighted_loss: 2.5448, label: 2, bag_size: 361
batch 219, loss: 0.1414, instance_loss: 0.2859, weighted_loss: 0.1848, label: 2, bag_size: 3397
batch 239, loss: 0.9044, instance_loss: 0.9102, weighted_loss: 0.9061, label: 2, bag_size: 5072
batch 259, loss: 0.1912, instance_loss: 0.5217, weighted_loss: 0.2904, label: 1, bag_size: 4181
batch 279, loss: 1.5200, instance_loss: 0.9851, weighted_loss: 1.3595, label: 1, bag_size: 4145
batch 299, loss: 0.3225, instance_loss: 0.3307, weighted_loss: 0.3250, label: 2, bag_size: 3176
batch 319, loss: 0.8387, instance_loss: 1.0790, weighted_loss: 0.9108, label: 0, bag_size: 4678
batch 339, loss: 0.2045, instance_loss: 0.3032, weighted_loss: 0.2341, label: 2, bag_size: 3778
batch 359, loss: 0.0469, instance_loss: 0.4550, weighted_loss: 0.1693, label: 1, bag_size: 4027
batch 379, loss: 1.0808, instance_loss: 0.7580, weighted_loss: 0.9840, label: 1, bag_size: 2302
batch 399, loss: 0.2261, instance_loss: 0.2790, weighted_loss: 0.2420, label: 2, bag_size: 2905
batch 419, loss: 0.3955, instance_loss: 0.5349, weighted_loss: 0.4373, label: 2, bag_size: 5637
batch 439, loss: 0.1407, instance_loss: 0.2944, weighted_loss: 0.1868, label: 0, bag_size: 3348
batch 459, loss: 0.1265, instance_loss: 0.1933, weighted_loss: 0.1465, label: 2, bag_size: 3176
batch 479, loss: 3.0739, instance_loss: 1.4666, weighted_loss: 2.5917, label: 0, bag_size: 1755
batch 499, loss: 0.4633, instance_loss: 0.4791, weighted_loss: 0.4681, label: 1, bag_size: 2156
batch 519, loss: 1.3836, instance_loss: 0.9500, weighted_loss: 1.2535, label: 2, bag_size: 724
batch 539, loss: 0.2987, instance_loss: 0.4197, weighted_loss: 0.3350, label: 0, bag_size: 4905
batch 559, loss: 0.8191, instance_loss: 0.8648, weighted_loss: 0.8328, label: 1, bag_size: 4644
batch 579, loss: 0.7703, instance_loss: 0.7024, weighted_loss: 0.7500, label: 2, bag_size: 5406
batch 599, loss: 0.4299, instance_loss: 0.4656, weighted_loss: 0.4406, label: 1, bag_size: 2905
batch 619, loss: 1.1631, instance_loss: 0.8412, weighted_loss: 1.0665, label: 1, bag_size: 5693
batch 639, loss: 1.2854, instance_loss: 0.9367, weighted_loss: 1.1808, label: 1, bag_size: 2743
batch 659, loss: 0.6085, instance_loss: 0.4374, weighted_loss: 0.5572, label: 0, bag_size: 7077
batch 679, loss: 1.3201, instance_loss: 0.6592, weighted_loss: 1.1219, label: 0, bag_size: 3397
batch 699, loss: 0.4585, instance_loss: 0.5399, weighted_loss: 0.4829, label: 1, bag_size: 712
batch 719, loss: 0.0722, instance_loss: 0.3081, weighted_loss: 0.1430, label: 0, bag_size: 2841
batch 739, loss: 0.0562, instance_loss: 0.2689, weighted_loss: 0.1200, label: 0, bag_size: 1140


class 0 clustering acc 0.977572706935123: correct 17479/17880
class 1 clustering acc 0.1906040268456376: correct 1136/5960
Epoch: 11, train_loss: 0.7193, train_clustering_loss:  0.6061, train_error: 0.3181
class 0: acc 0.7368421052631579, correct 196/266
class 1: acc 0.5555555555555556, correct 135/243
class 2: acc 0.75, correct 177/236

Val Set, val_loss: 0.6912, val_error: 0.3298, auc: 0.8279
class 0 clustering acc 0.9268617021276596: correct 2091/2256
class 1 clustering acc 0.43617021276595747: correct 328/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.4166666666666667, correct 5/12
Validation loss decreased (0.700020 --> 0.691212).  Saving model ...


batch 19, loss: 0.5419, instance_loss: 0.5807, weighted_loss: 0.5535, label: 1, bag_size: 6025
batch 39, loss: 0.0795, instance_loss: 0.0833, weighted_loss: 0.0806, label: 2, bag_size: 4056
batch 59, loss: 0.1288, instance_loss: 0.3877, weighted_loss: 0.2065, label: 1, bag_size: 6243
batch 79, loss: 0.8989, instance_loss: 0.6590, weighted_loss: 0.8269, label: 0, bag_size: 8866
batch 99, loss: 0.4864, instance_loss: 0.6224, weighted_loss: 0.5272, label: 0, bag_size: 3864
batch 119, loss: 0.5515, instance_loss: 0.6457, weighted_loss: 0.5797, label: 1, bag_size: 5412
batch 139, loss: 0.0088, instance_loss: 0.1203, weighted_loss: 0.0423, label: 2, bag_size: 2422
batch 159, loss: 0.6659, instance_loss: 0.3472, weighted_loss: 0.5703, label: 2, bag_size: 3227
batch 179, loss: 0.1655, instance_loss: 0.7344, weighted_loss: 0.3361, label: 0, bag_size: 3601
batch 199, loss: 1.7327, instance_loss: 1.1574, weighted_loss: 1.5601, label: 1, bag_size: 1313
batch 219, loss: 1.3359, instance_loss: 0.6130, weighted_loss: 1.1190, label: 2, bag_size: 3746
batch 239, loss: 0.2676, instance_loss: 0.4029, weighted_loss: 0.3082, label: 0, bag_size: 2545
batch 259, loss: 0.3231, instance_loss: 0.4872, weighted_loss: 0.3723, label: 0, bag_size: 1233
batch 279, loss: 0.2295, instance_loss: 0.3832, weighted_loss: 0.2756, label: 1, bag_size: 1807
batch 299, loss: 0.4643, instance_loss: 0.4171, weighted_loss: 0.4501, label: 0, bag_size: 3864
batch 319, loss: 0.3808, instance_loss: 0.7238, weighted_loss: 0.4837, label: 1, bag_size: 3475
batch 339, loss: 0.3678, instance_loss: 0.6366, weighted_loss: 0.4484, label: 2, bag_size: 6644
batch 359, loss: 0.0701, instance_loss: 0.2335, weighted_loss: 0.1191, label: 1, bag_size: 3221
batch 379, loss: 0.0524, instance_loss: 0.4587, weighted_loss: 0.1743, label: 1, bag_size: 5760
batch 399, loss: 0.8958, instance_loss: 0.7039, weighted_loss: 0.8382, label: 1, bag_size: 4784
batch 419, loss: 0.3845, instance_loss: 0.3635, weighted_loss: 0.3782, label: 2, bag_size: 4241
batch 439, loss: 1.1124, instance_loss: 0.7364, weighted_loss: 0.9996, label: 1, bag_size: 6241
batch 459, loss: 0.1523, instance_loss: 0.3569, weighted_loss: 0.2137, label: 0, bag_size: 4994
batch 479, loss: 0.8859, instance_loss: 0.8007, weighted_loss: 0.8604, label: 1, bag_size: 475
batch 499, loss: 0.5081, instance_loss: 0.6331, weighted_loss: 0.5456, label: 1, bag_size: 5276
batch 519, loss: 0.9346, instance_loss: 1.1885, weighted_loss: 1.0108, label: 0, bag_size: 4161
batch 539, loss: 0.3193, instance_loss: 0.4890, weighted_loss: 0.3702, label: 2, bag_size: 3396
batch 559, loss: 0.3469, instance_loss: 0.7731, weighted_loss: 0.4747, label: 0, bag_size: 4678
batch 579, loss: 1.2655, instance_loss: 0.8605, weighted_loss: 1.1440, label: 1, bag_size: 4612
batch 599, loss: 0.1262, instance_loss: 0.1779, weighted_loss: 0.1417, label: 2, bag_size: 4856
batch 619, loss: 0.5597, instance_loss: 0.8652, weighted_loss: 0.6513, label: 2, bag_size: 3299
batch 639, loss: 1.0848, instance_loss: 1.0794, weighted_loss: 1.0832, label: 1, bag_size: 2751
batch 659, loss: 1.0927, instance_loss: 0.7546, weighted_loss: 0.9913, label: 1, bag_size: 3438
batch 679, loss: 0.1568, instance_loss: 0.4922, weighted_loss: 0.2574, label: 0, bag_size: 5170
batch 699, loss: 0.5106, instance_loss: 0.5459, weighted_loss: 0.5212, label: 1, bag_size: 578
batch 719, loss: 0.9315, instance_loss: 0.6377, weighted_loss: 0.8433, label: 2, bag_size: 552
batch 739, loss: 0.3700, instance_loss: 0.6063, weighted_loss: 0.4409, label: 0, bag_size: 1655


class 0 clustering acc 0.9737695749440716: correct 17411/17880
class 1 clustering acc 0.27365771812080536: correct 1631/5960
Epoch: 12, train_loss: 0.6354, train_clustering_loss:  0.5853, train_error: 0.2779
class 0: acc 0.7510204081632653, correct 184/245
class 1: acc 0.6205533596837944, correct 157/253
class 2: acc 0.7975708502024291, correct 197/247

Val Set, val_loss: 0.7573, val_error: 0.3298, auc: 0.8241
class 0 clustering acc 0.9929078014184397: correct 2240/2256
class 1 clustering acc 0.12898936170212766: correct 97/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3610, instance_loss: 0.6758, weighted_loss: 0.4555, label: 0, bag_size: 614
batch 39, loss: 0.4346, instance_loss: 0.4847, weighted_loss: 0.4496, label: 0, bag_size: 999
batch 59, loss: 0.9809, instance_loss: 0.3722, weighted_loss: 0.7983, label: 2, bag_size: 88
batch 79, loss: 0.6233, instance_loss: 0.4770, weighted_loss: 0.5794, label: 0, bag_size: 5890
batch 99, loss: 0.0365, instance_loss: 0.2165, weighted_loss: 0.0905, label: 0, bag_size: 4300
batch 119, loss: 0.1874, instance_loss: 0.7463, weighted_loss: 0.3551, label: 2, bag_size: 5472
batch 139, loss: 1.5664, instance_loss: 0.9117, weighted_loss: 1.3700, label: 1, bag_size: 2302
batch 159, loss: 0.1334, instance_loss: 1.0009, weighted_loss: 0.3936, label: 1, bag_size: 5084
batch 179, loss: 0.1065, instance_loss: 0.2949, weighted_loss: 0.1630, label: 0, bag_size: 2601
batch 199, loss: 0.6958, instance_loss: 0.7450, weighted_loss: 0.7106, label: 0, bag_size: 1808
batch 219, loss: 0.0852, instance_loss: 0.3585, weighted_loss: 0.1672, label: 1, bag_size: 1029
batch 239, loss: 1.6272, instance_loss: 0.5589, weighted_loss: 1.3067, label: 1, bag_size: 5760
batch 259, loss: 0.2419, instance_loss: 0.4643, weighted_loss: 0.3086, label: 2, bag_size: 4162
batch 279, loss: 1.0227, instance_loss: 0.7119, weighted_loss: 0.9295, label: 1, bag_size: 6942
batch 299, loss: 0.0879, instance_loss: 0.2523, weighted_loss: 0.1372, label: 2, bag_size: 5138
batch 319, loss: 1.2273, instance_loss: 0.8617, weighted_loss: 1.1176, label: 1, bag_size: 1327
batch 339, loss: 0.4645, instance_loss: 0.7543, weighted_loss: 0.5515, label: 1, bag_size: 11768
batch 359, loss: 0.7531, instance_loss: 0.7057, weighted_loss: 0.7389, label: 1, bag_size: 5512
batch 379, loss: 0.0899, instance_loss: 0.2027, weighted_loss: 0.1237, label: 2, bag_size: 5011
batch 399, loss: 0.7561, instance_loss: 0.4892, weighted_loss: 0.6760, label: 0, bag_size: 4921
batch 419, loss: 1.6145, instance_loss: 1.1815, weighted_loss: 1.4846, label: 1, bag_size: 2302
batch 439, loss: 1.5609, instance_loss: 1.4038, weighted_loss: 1.5138, label: 1, bag_size: 5880
batch 459, loss: 0.6847, instance_loss: 0.7219, weighted_loss: 0.6958, label: 2, bag_size: 3607
batch 479, loss: 1.0187, instance_loss: 0.9347, weighted_loss: 0.9935, label: 2, bag_size: 4571
batch 499, loss: 1.5920, instance_loss: 0.8895, weighted_loss: 1.3813, label: 2, bag_size: 724
batch 519, loss: 0.2402, instance_loss: 0.7237, weighted_loss: 0.3852, label: 1, bag_size: 3357
batch 539, loss: 0.1222, instance_loss: 0.3701, weighted_loss: 0.1965, label: 2, bag_size: 5472
batch 559, loss: 0.4758, instance_loss: 0.4815, weighted_loss: 0.4775, label: 2, bag_size: 1050
batch 579, loss: 0.0835, instance_loss: 0.4537, weighted_loss: 0.1946, label: 1, bag_size: 4578
batch 599, loss: 0.6905, instance_loss: 0.6532, weighted_loss: 0.6793, label: 0, bag_size: 5011
batch 619, loss: 0.0728, instance_loss: 0.1385, weighted_loss: 0.0925, label: 2, bag_size: 1094
batch 639, loss: 0.0521, instance_loss: 0.2892, weighted_loss: 0.1232, label: 0, bag_size: 4379
batch 659, loss: 0.5667, instance_loss: 0.6077, weighted_loss: 0.5790, label: 1, bag_size: 4705
batch 679, loss: 0.3394, instance_loss: 0.4943, weighted_loss: 0.3858, label: 2, bag_size: 4141
batch 699, loss: 1.3932, instance_loss: 0.9215, weighted_loss: 1.2517, label: 1, bag_size: 574
batch 719, loss: 0.2645, instance_loss: 0.4071, weighted_loss: 0.3073, label: 2, bag_size: 5426
batch 739, loss: 0.0189, instance_loss: 0.1339, weighted_loss: 0.0534, label: 2, bag_size: 4569


class 0 clustering acc 0.9730425055928411: correct 17398/17880
class 1 clustering acc 0.2568791946308725: correct 1531/5960
Epoch: 13, train_loss: 0.6292, train_clustering_loss:  0.5819, train_error: 0.2604
class 0: acc 0.8125, correct 195/240
class 1: acc 0.5975103734439834, correct 144/241
class 2: acc 0.803030303030303, correct 212/264

Val Set, val_loss: 0.8455, val_error: 0.3511, auc: 0.8280
class 0 clustering acc 0.9601063829787234: correct 2166/2256
class 1 clustering acc 0.261968085106383: correct 197/752
class 0: acc 0.5192307692307693, correct 27/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8968, instance_loss: 0.8408, weighted_loss: 0.8800, label: 0, bag_size: 3310
batch 39, loss: 1.6537, instance_loss: 1.0252, weighted_loss: 1.4652, label: 1, bag_size: 3261
batch 59, loss: 0.0404, instance_loss: 0.1180, weighted_loss: 0.0636, label: 2, bag_size: 1094
batch 79, loss: 0.0680, instance_loss: 0.3510, weighted_loss: 0.1529, label: 2, bag_size: 4555
batch 99, loss: 0.6575, instance_loss: 0.6130, weighted_loss: 0.6442, label: 2, bag_size: 3026
batch 119, loss: 0.2358, instance_loss: 0.4326, weighted_loss: 0.2948, label: 0, bag_size: 2671
batch 139, loss: 0.0180, instance_loss: 0.0997, weighted_loss: 0.0425, label: 2, bag_size: 2483
batch 159, loss: 0.1067, instance_loss: 0.3853, weighted_loss: 0.1903, label: 1, bag_size: 1599
batch 179, loss: 0.2006, instance_loss: 0.4780, weighted_loss: 0.2838, label: 0, bag_size: 2392
batch 199, loss: 0.2908, instance_loss: 0.6429, weighted_loss: 0.3964, label: 0, bag_size: 3182
batch 219, loss: 0.5768, instance_loss: 0.5918, weighted_loss: 0.5813, label: 0, bag_size: 16741
batch 239, loss: 0.3924, instance_loss: 0.4157, weighted_loss: 0.3994, label: 2, bag_size: 2561
batch 259, loss: 0.9611, instance_loss: 0.7880, weighted_loss: 0.9092, label: 1, bag_size: 2302
batch 279, loss: 0.4395, instance_loss: 0.7754, weighted_loss: 0.5402, label: 0, bag_size: 3219
batch 299, loss: 0.8320, instance_loss: 0.5349, weighted_loss: 0.7429, label: 0, bag_size: 5484
batch 319, loss: 0.4482, instance_loss: 0.7694, weighted_loss: 0.5446, label: 1, bag_size: 936
batch 339, loss: 0.6438, instance_loss: 1.0295, weighted_loss: 0.7595, label: 2, bag_size: 4571
batch 359, loss: 0.0600, instance_loss: 0.3734, weighted_loss: 0.1540, label: 0, bag_size: 4857
batch 379, loss: 0.1109, instance_loss: 0.3203, weighted_loss: 0.1737, label: 2, bag_size: 614
batch 399, loss: 0.6236, instance_loss: 0.6668, weighted_loss: 0.6366, label: 2, bag_size: 5072
batch 419, loss: 1.6874, instance_loss: 1.0566, weighted_loss: 1.4982, label: 0, bag_size: 7219
batch 439, loss: 0.1882, instance_loss: 0.4736, weighted_loss: 0.2738, label: 1, bag_size: 6156
batch 459, loss: 3.0814, instance_loss: 1.2538, weighted_loss: 2.5331, label: 1, bag_size: 3791
batch 479, loss: 1.6922, instance_loss: 1.0745, weighted_loss: 1.5069, label: 2, bag_size: 3475
batch 499, loss: 0.9896, instance_loss: 0.6953, weighted_loss: 0.9013, label: 1, bag_size: 4467
batch 519, loss: 0.3264, instance_loss: 0.2537, weighted_loss: 0.3046, label: 2, bag_size: 657
batch 539, loss: 0.3797, instance_loss: 0.7778, weighted_loss: 0.4991, label: 0, bag_size: 4274
batch 559, loss: 0.1391, instance_loss: 0.3740, weighted_loss: 0.2096, label: 0, bag_size: 4905
batch 579, loss: 0.3361, instance_loss: 0.4347, weighted_loss: 0.3657, label: 2, bag_size: 5637
batch 599, loss: 0.1544, instance_loss: 0.3915, weighted_loss: 0.2255, label: 2, bag_size: 3112
batch 619, loss: 0.8070, instance_loss: 0.7429, weighted_loss: 0.7877, label: 2, bag_size: 22464
batch 639, loss: 0.9251, instance_loss: 0.7253, weighted_loss: 0.8651, label: 1, bag_size: 1860
batch 659, loss: 0.0184, instance_loss: 0.1390, weighted_loss: 0.0546, label: 2, bag_size: 4910
batch 679, loss: 0.2566, instance_loss: 0.7984, weighted_loss: 0.4192, label: 1, bag_size: 3460
batch 699, loss: 0.1374, instance_loss: 0.3055, weighted_loss: 0.1878, label: 0, bag_size: 3641
batch 719, loss: 1.1627, instance_loss: 0.7838, weighted_loss: 1.0490, label: 1, bag_size: 6025
batch 739, loss: 2.1128, instance_loss: 1.1180, weighted_loss: 1.8144, label: 0, bag_size: 877


class 0 clustering acc 0.9738814317673378: correct 17413/17880
class 1 clustering acc 0.23825503355704697: correct 1420/5960
Epoch: 14, train_loss: 0.6598, train_clustering_loss:  0.6023, train_error: 0.2792
class 0: acc 0.7399103139013453, correct 165/223
class 1: acc 0.6550387596899225, correct 169/258
class 2: acc 0.7689393939393939, correct 203/264

Val Set, val_loss: 0.7000, val_error: 0.3511, auc: 0.8233
class 0 clustering acc 0.963209219858156: correct 2173/2256
class 1 clustering acc 0.3058510638297872: correct 230/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2259, instance_loss: 0.2846, weighted_loss: 0.2435, label: 2, bag_size: 2254
batch 39, loss: 2.0037, instance_loss: 1.0595, weighted_loss: 1.7204, label: 1, bag_size: 5402
batch 59, loss: 1.2144, instance_loss: 1.0410, weighted_loss: 1.1624, label: 1, bag_size: 2302
batch 79, loss: 0.9398, instance_loss: 0.8607, weighted_loss: 0.9161, label: 1, bag_size: 1580
batch 99, loss: 0.4594, instance_loss: 0.3305, weighted_loss: 0.4207, label: 2, bag_size: 597
batch 119, loss: 0.0683, instance_loss: 0.1783, weighted_loss: 0.1013, label: 1, bag_size: 2009
batch 139, loss: 0.1878, instance_loss: 0.3812, weighted_loss: 0.2458, label: 0, bag_size: 4131
batch 159, loss: 2.4529, instance_loss: 1.3711, weighted_loss: 2.1284, label: 2, bag_size: 4241
batch 179, loss: 1.7794, instance_loss: 1.2752, weighted_loss: 1.6281, label: 1, bag_size: 1549
batch 199, loss: 0.7804, instance_loss: 0.3997, weighted_loss: 0.6662, label: 2, bag_size: 4788
batch 219, loss: 0.7804, instance_loss: 0.8318, weighted_loss: 0.7958, label: 0, bag_size: 5656
batch 239, loss: 0.3361, instance_loss: 0.5526, weighted_loss: 0.4011, label: 2, bag_size: 5637
batch 259, loss: 0.2360, instance_loss: 0.2581, weighted_loss: 0.2426, label: 2, bag_size: 3396
batch 279, loss: 0.7364, instance_loss: 0.7225, weighted_loss: 0.7322, label: 1, bag_size: 1607
batch 299, loss: 0.4446, instance_loss: 0.5887, weighted_loss: 0.4879, label: 0, bag_size: 4161
batch 319, loss: 0.4048, instance_loss: 0.6491, weighted_loss: 0.4781, label: 1, bag_size: 8482
batch 339, loss: 0.0152, instance_loss: 0.1631, weighted_loss: 0.0596, label: 2, bag_size: 5914
batch 359, loss: 0.2442, instance_loss: 0.5250, weighted_loss: 0.3285, label: 1, bag_size: 4373
batch 379, loss: 0.4150, instance_loss: 0.7967, weighted_loss: 0.5295, label: 2, bag_size: 4372
batch 399, loss: 0.0384, instance_loss: 0.1518, weighted_loss: 0.0724, label: 2, bag_size: 5138
batch 419, loss: 0.2496, instance_loss: 0.2997, weighted_loss: 0.2646, label: 2, bag_size: 2049
batch 439, loss: 0.0151, instance_loss: 0.1054, weighted_loss: 0.0422, label: 2, bag_size: 4856
batch 459, loss: 0.2047, instance_loss: 0.2197, weighted_loss: 0.2092, label: 0, bag_size: 2019
batch 479, loss: 0.1419, instance_loss: 0.3294, weighted_loss: 0.1982, label: 1, bag_size: 3604
batch 499, loss: 1.0989, instance_loss: 1.0137, weighted_loss: 1.0733, label: 0, bag_size: 1289
batch 519, loss: 1.8487, instance_loss: 0.7706, weighted_loss: 1.5253, label: 1, bag_size: 3438
batch 539, loss: 1.3143, instance_loss: 0.7475, weighted_loss: 1.1442, label: 0, bag_size: 2579
batch 559, loss: 0.0356, instance_loss: 0.2895, weighted_loss: 0.1117, label: 1, bag_size: 3221
batch 579, loss: 0.0992, instance_loss: 0.2540, weighted_loss: 0.1456, label: 0, bag_size: 4994
batch 599, loss: 0.1168, instance_loss: 0.3359, weighted_loss: 0.1825, label: 2, bag_size: 3678
batch 619, loss: 0.7375, instance_loss: 0.4018, weighted_loss: 0.6368, label: 2, bag_size: 4043
batch 639, loss: 0.5389, instance_loss: 0.5867, weighted_loss: 0.5533, label: 1, bag_size: 5718
batch 659, loss: 0.4050, instance_loss: 0.8645, weighted_loss: 0.5428, label: 1, bag_size: 6315
batch 679, loss: 1.2105, instance_loss: 0.9664, weighted_loss: 1.1373, label: 0, bag_size: 4351
batch 699, loss: 0.8563, instance_loss: 0.8475, weighted_loss: 0.8536, label: 1, bag_size: 6993
batch 719, loss: 0.8005, instance_loss: 0.7568, weighted_loss: 0.7874, label: 1, bag_size: 4784
batch 739, loss: 0.8758, instance_loss: 0.5635, weighted_loss: 0.7821, label: 2, bag_size: 3174


class 0 clustering acc 0.9718680089485459: correct 17377/17880
class 1 clustering acc 0.24697986577181208: correct 1472/5960
Epoch: 15, train_loss: 0.6541, train_clustering_loss:  0.5974, train_error: 0.2913
class 0: acc 0.7470817120622568, correct 192/257
class 1: acc 0.6428571428571429, correct 162/252
class 2: acc 0.7372881355932204, correct 174/236

Val Set, val_loss: 0.6977, val_error: 0.2872, auc: 0.8429
class 0 clustering acc 0.9822695035460993: correct 2216/2256
class 1 clustering acc 0.2047872340425532: correct 154/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1741, instance_loss: 0.3848, weighted_loss: 0.2373, label: 0, bag_size: 4455
batch 39, loss: 0.1341, instance_loss: 0.3293, weighted_loss: 0.1927, label: 0, bag_size: 1399
batch 59, loss: 0.0054, instance_loss: 0.2480, weighted_loss: 0.0782, label: 1, bag_size: 3338
batch 79, loss: 0.3087, instance_loss: 0.5613, weighted_loss: 0.3845, label: 0, bag_size: 4479
batch 99, loss: 0.2906, instance_loss: 0.3510, weighted_loss: 0.3087, label: 2, bag_size: 3678
batch 119, loss: 0.7519, instance_loss: 0.7512, weighted_loss: 0.7517, label: 1, bag_size: 3746
batch 139, loss: 0.1217, instance_loss: 0.2214, weighted_loss: 0.1516, label: 2, bag_size: 2313
batch 159, loss: 1.1580, instance_loss: 1.0633, weighted_loss: 1.1296, label: 1, bag_size: 475
batch 179, loss: 0.7804, instance_loss: 0.5349, weighted_loss: 0.7067, label: 1, bag_size: 3422
batch 199, loss: 0.1895, instance_loss: 0.3226, weighted_loss: 0.2294, label: 2, bag_size: 3678
batch 219, loss: 2.0403, instance_loss: 1.0066, weighted_loss: 1.7302, label: 2, bag_size: 552
batch 239, loss: 1.1102, instance_loss: 0.8566, weighted_loss: 1.0341, label: 1, bag_size: 5693
batch 259, loss: 0.1276, instance_loss: 0.4463, weighted_loss: 0.2232, label: 1, bag_size: 3471
batch 279, loss: 0.5555, instance_loss: 0.5797, weighted_loss: 0.5628, label: 0, bag_size: 2884
batch 299, loss: 0.3008, instance_loss: 0.4352, weighted_loss: 0.3411, label: 0, bag_size: 1018
batch 319, loss: 0.4089, instance_loss: 0.3249, weighted_loss: 0.3837, label: 2, bag_size: 3678
batch 339, loss: 0.1333, instance_loss: 0.4769, weighted_loss: 0.2364, label: 2, bag_size: 5037
batch 359, loss: 0.1431, instance_loss: 0.2778, weighted_loss: 0.1835, label: 0, bag_size: 4914
batch 379, loss: 0.4546, instance_loss: 0.4732, weighted_loss: 0.4602, label: 0, bag_size: 2671
batch 399, loss: 0.4342, instance_loss: 0.6342, weighted_loss: 0.4942, label: 1, bag_size: 2319
batch 419, loss: 0.0961, instance_loss: 0.2456, weighted_loss: 0.1410, label: 0, bag_size: 4994
batch 439, loss: 0.8841, instance_loss: 0.9893, weighted_loss: 0.9157, label: 2, bag_size: 4571
batch 459, loss: 0.0665, instance_loss: 0.7941, weighted_loss: 0.2848, label: 0, bag_size: 2306
batch 479, loss: 0.0776, instance_loss: 0.2333, weighted_loss: 0.1243, label: 0, bag_size: 4157
batch 499, loss: 1.6888, instance_loss: 0.8701, weighted_loss: 1.4432, label: 2, bag_size: 5307
batch 519, loss: 0.0335, instance_loss: 1.5305, weighted_loss: 0.4826, label: 0, bag_size: 1981
batch 539, loss: 0.5981, instance_loss: 0.4728, weighted_loss: 0.5605, label: 0, bag_size: 4310
batch 559, loss: 0.2735, instance_loss: 0.7125, weighted_loss: 0.4052, label: 1, bag_size: 5003
batch 579, loss: 0.0043, instance_loss: 0.3857, weighted_loss: 0.1187, label: 1, bag_size: 3333
batch 599, loss: 0.0707, instance_loss: 0.1250, weighted_loss: 0.0870, label: 2, bag_size: 2501
batch 619, loss: 0.4658, instance_loss: 0.8169, weighted_loss: 0.5711, label: 0, bag_size: 4351
batch 639, loss: 0.5163, instance_loss: 0.5512, weighted_loss: 0.5268, label: 1, bag_size: 2248
batch 659, loss: 0.2513, instance_loss: 0.2904, weighted_loss: 0.2630, label: 2, bag_size: 3176
batch 679, loss: 0.1455, instance_loss: 0.1881, weighted_loss: 0.1583, label: 2, bag_size: 3210
batch 699, loss: 0.9612, instance_loss: 0.7733, weighted_loss: 0.9049, label: 2, bag_size: 3746
batch 719, loss: 0.0595, instance_loss: 0.1722, weighted_loss: 0.0933, label: 2, bag_size: 4775
batch 739, loss: 0.0829, instance_loss: 0.3545, weighted_loss: 0.1644, label: 0, bag_size: 4734


class 0 clustering acc 0.9776845637583893: correct 17481/17880
class 1 clustering acc 0.27416107382550337: correct 1634/5960
Epoch: 16, train_loss: 0.6215, train_clustering_loss:  0.5814, train_error: 0.2591
class 0: acc 0.7635658914728682, correct 197/258
class 1: acc 0.6595744680851063, correct 155/235
class 2: acc 0.7936507936507936, correct 200/252

Val Set, val_loss: 0.6903, val_error: 0.3404, auc: 0.8750
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.11170212765957446: correct 84/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.26666666666666666, correct 8/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.691212 --> 0.690337).  Saving model ...


batch 19, loss: 0.2170, instance_loss: 0.3820, weighted_loss: 0.2665, label: 2, bag_size: 3397
batch 39, loss: 0.0298, instance_loss: 0.2481, weighted_loss: 0.0953, label: 1, bag_size: 3156
batch 59, loss: 0.1184, instance_loss: 0.5782, weighted_loss: 0.2563, label: 2, bag_size: 5017
batch 79, loss: 0.4964, instance_loss: 0.7063, weighted_loss: 0.5594, label: 1, bag_size: 1221
batch 99, loss: 0.6625, instance_loss: 0.6403, weighted_loss: 0.6558, label: 1, bag_size: 4812
batch 119, loss: 0.1351, instance_loss: 0.3938, weighted_loss: 0.2127, label: 0, bag_size: 3694
batch 139, loss: 0.4509, instance_loss: 0.1706, weighted_loss: 0.3668, label: 2, bag_size: 2561
batch 159, loss: 0.1542, instance_loss: 0.2765, weighted_loss: 0.1908, label: 0, bag_size: 4544
batch 179, loss: 0.0375, instance_loss: 0.0682, weighted_loss: 0.0467, label: 2, bag_size: 3176
batch 199, loss: 0.2018, instance_loss: 0.4161, weighted_loss: 0.2661, label: 1, bag_size: 1029
batch 219, loss: 1.5807, instance_loss: 0.8193, weighted_loss: 1.3523, label: 2, bag_size: 552
batch 239, loss: 0.5444, instance_loss: 0.6216, weighted_loss: 0.5676, label: 1, bag_size: 2731
batch 259, loss: 0.1184, instance_loss: 0.7130, weighted_loss: 0.2968, label: 0, bag_size: 1140
batch 279, loss: 1.0267, instance_loss: 0.4153, weighted_loss: 0.8433, label: 0, bag_size: 5108
batch 299, loss: 0.4367, instance_loss: 0.4879, weighted_loss: 0.4520, label: 2, bag_size: 4978
batch 319, loss: 0.6994, instance_loss: 0.6062, weighted_loss: 0.6715, label: 2, bag_size: 6594
batch 339, loss: 0.3808, instance_loss: 0.4099, weighted_loss: 0.3896, label: 0, bag_size: 5890
batch 359, loss: 0.9355, instance_loss: 0.4920, weighted_loss: 0.8025, label: 0, bag_size: 3382
batch 379, loss: 1.8640, instance_loss: 1.2504, weighted_loss: 1.6799, label: 0, bag_size: 3419
batch 399, loss: 0.1037, instance_loss: 0.4776, weighted_loss: 0.2159, label: 0, bag_size: 873
batch 419, loss: 1.8342, instance_loss: 1.0795, weighted_loss: 1.6078, label: 2, bag_size: 22464
batch 439, loss: 1.4343, instance_loss: 1.1393, weighted_loss: 1.3458, label: 0, bag_size: 5017
batch 459, loss: 0.2556, instance_loss: 0.4216, weighted_loss: 0.3054, label: 0, bag_size: 2608
batch 479, loss: 2.5524, instance_loss: 1.3565, weighted_loss: 2.1936, label: 0, bag_size: 1755
batch 499, loss: 0.9836, instance_loss: 0.5216, weighted_loss: 0.8450, label: 2, bag_size: 4096
batch 519, loss: 0.0733, instance_loss: 0.1728, weighted_loss: 0.1032, label: 2, bag_size: 4088
batch 539, loss: 0.1840, instance_loss: 0.3261, weighted_loss: 0.2266, label: 2, bag_size: 4132
batch 559, loss: 2.7346, instance_loss: 1.2977, weighted_loss: 2.3035, label: 1, bag_size: 4145
batch 579, loss: 0.0501, instance_loss: 0.2820, weighted_loss: 0.1196, label: 0, bag_size: 4721
batch 599, loss: 0.6064, instance_loss: 0.8115, weighted_loss: 0.6679, label: 0, bag_size: 621
batch 619, loss: 0.2420, instance_loss: 0.2199, weighted_loss: 0.2354, label: 0, bag_size: 3334
batch 639, loss: 0.8605, instance_loss: 0.8808, weighted_loss: 0.8666, label: 1, bag_size: 2905
batch 659, loss: 1.2722, instance_loss: 0.7274, weighted_loss: 1.1088, label: 1, bag_size: 3261
batch 679, loss: 0.0230, instance_loss: 0.2910, weighted_loss: 0.1034, label: 1, bag_size: 2453
batch 699, loss: 0.3816, instance_loss: 0.4562, weighted_loss: 0.4040, label: 1, bag_size: 1042
batch 719, loss: 0.1296, instance_loss: 0.2596, weighted_loss: 0.1686, label: 1, bag_size: 7135
batch 739, loss: 0.9038, instance_loss: 0.8823, weighted_loss: 0.8973, label: 1, bag_size: 5873


class 0 clustering acc 0.9746644295302014: correct 17427/17880
class 1 clustering acc 0.30906040268456375: correct 1842/5960
Epoch: 17, train_loss: 0.6600, train_clustering_loss:  0.5750, train_error: 0.2846
class 0: acc 0.7689393939393939, correct 203/264
class 1: acc 0.5580357142857143, correct 125/224
class 2: acc 0.7976653696498055, correct 205/257

Val Set, val_loss: 0.7536, val_error: 0.3298, auc: 0.8326
class 0 clustering acc 0.9375: correct 2115/2256
class 1 clustering acc 0.26861702127659576: correct 202/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9286, instance_loss: 0.5983, weighted_loss: 0.8295, label: 0, bag_size: 3915
batch 39, loss: 1.4579, instance_loss: 0.8888, weighted_loss: 1.2872, label: 1, bag_size: 6241
batch 59, loss: 0.2277, instance_loss: 0.5687, weighted_loss: 0.3300, label: 2, bag_size: 5472
batch 79, loss: 0.8973, instance_loss: 0.9363, weighted_loss: 0.9090, label: 2, bag_size: 4571
batch 99, loss: 0.0620, instance_loss: 0.3639, weighted_loss: 0.1525, label: 1, bag_size: 3338
batch 119, loss: 0.2412, instance_loss: 0.2924, weighted_loss: 0.2565, label: 0, bag_size: 5041
batch 139, loss: 0.0418, instance_loss: 0.5177, weighted_loss: 0.1846, label: 1, bag_size: 2809
batch 159, loss: 0.0795, instance_loss: 0.0914, weighted_loss: 0.0831, label: 2, bag_size: 4775
batch 179, loss: 0.2965, instance_loss: 0.2857, weighted_loss: 0.2933, label: 2, bag_size: 2501
batch 199, loss: 0.6548, instance_loss: 0.3000, weighted_loss: 0.5483, label: 2, bag_size: 4043
batch 219, loss: 5.1974, instance_loss: 2.2300, weighted_loss: 4.3072, label: 0, bag_size: 2736
batch 239, loss: 2.5518, instance_loss: 1.3500, weighted_loss: 2.1912, label: 0, bag_size: 1774
batch 259, loss: 1.0103, instance_loss: 0.7702, weighted_loss: 0.9383, label: 1, bag_size: 2831
batch 279, loss: 0.7397, instance_loss: 0.6734, weighted_loss: 0.7198, label: 2, bag_size: 3746
batch 299, loss: 1.7337, instance_loss: 0.9242, weighted_loss: 1.4908, label: 2, bag_size: 5307
batch 319, loss: 0.7588, instance_loss: 0.4234, weighted_loss: 0.6582, label: 0, bag_size: 4201
batch 339, loss: 0.5353, instance_loss: 0.4643, weighted_loss: 0.5140, label: 2, bag_size: 6298
batch 359, loss: 0.0378, instance_loss: 0.3596, weighted_loss: 0.1344, label: 1, bag_size: 874
batch 379, loss: 0.1173, instance_loss: 0.4761, weighted_loss: 0.2249, label: 0, bag_size: 4529
batch 399, loss: 0.3720, instance_loss: 0.8323, weighted_loss: 0.5101, label: 1, bag_size: 1394
batch 419, loss: 0.0681, instance_loss: 0.2315, weighted_loss: 0.1171, label: 0, bag_size: 7169
batch 439, loss: 0.1413, instance_loss: 0.2139, weighted_loss: 0.1631, label: 2, bag_size: 3094
batch 459, loss: 0.0415, instance_loss: 0.2401, weighted_loss: 0.1011, label: 0, bag_size: 4326
batch 479, loss: 0.0917, instance_loss: 0.2451, weighted_loss: 0.1377, label: 0, bag_size: 1234
batch 499, loss: 0.1730, instance_loss: 0.5249, weighted_loss: 0.2786, label: 2, bag_size: 5637
batch 519, loss: 0.4584, instance_loss: 0.6396, weighted_loss: 0.5127, label: 0, bag_size: 4794
batch 539, loss: 0.5634, instance_loss: 0.7066, weighted_loss: 0.6064, label: 2, bag_size: 5472
batch 559, loss: 0.2981, instance_loss: 0.2772, weighted_loss: 0.2918, label: 2, bag_size: 4241
batch 579, loss: 3.8803, instance_loss: 1.4599, weighted_loss: 3.1542, label: 0, bag_size: 4605
batch 599, loss: 0.0817, instance_loss: 0.2059, weighted_loss: 0.1189, label: 0, bag_size: 5041
batch 619, loss: 0.7389, instance_loss: 0.7354, weighted_loss: 0.7379, label: 2, bag_size: 2486
batch 639, loss: 0.1229, instance_loss: 1.6441, weighted_loss: 0.5793, label: 1, bag_size: 4067
batch 659, loss: 0.0243, instance_loss: 0.4481, weighted_loss: 0.1514, label: 0, bag_size: 1417
batch 679, loss: 0.0713, instance_loss: 0.3326, weighted_loss: 0.1497, label: 1, bag_size: 3265
batch 699, loss: 0.1955, instance_loss: 0.2581, weighted_loss: 0.2143, label: 0, bag_size: 1385
batch 719, loss: 1.8050, instance_loss: 0.6938, weighted_loss: 1.4716, label: 0, bag_size: 2559
batch 739, loss: 0.7404, instance_loss: 0.5304, weighted_loss: 0.6774, label: 0, bag_size: 3664


class 0 clustering acc 0.9705816554809843: correct 17354/17880
class 1 clustering acc 0.3197986577181208: correct 1906/5960
Epoch: 18, train_loss: 0.6452, train_clustering_loss:  0.5791, train_error: 0.2872
class 0: acc 0.7556390977443609, correct 201/266
class 1: acc 0.6341463414634146, correct 156/246
class 2: acc 0.7467811158798283, correct 174/233

Val Set, val_loss: 0.7240, val_error: 0.3617, auc: 0.8151
class 0 clustering acc 0.9317375886524822: correct 2102/2256
class 1 clustering acc 0.3962765957446808: correct 298/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8941, instance_loss: 1.4392, weighted_loss: 1.0576, label: 1, bag_size: 5205
batch 39, loss: 0.5984, instance_loss: 0.3748, weighted_loss: 0.5313, label: 2, bag_size: 705
batch 59, loss: 0.0021, instance_loss: 0.4422, weighted_loss: 0.1341, label: 1, bag_size: 4067
batch 79, loss: 0.2115, instance_loss: 0.4592, weighted_loss: 0.2858, label: 0, bag_size: 5282
batch 99, loss: 1.2171, instance_loss: 0.8607, weighted_loss: 1.1102, label: 1, bag_size: 5693
batch 119, loss: 0.4796, instance_loss: 0.3661, weighted_loss: 0.4456, label: 0, bag_size: 4245
batch 139, loss: 1.1400, instance_loss: 0.8669, weighted_loss: 1.0581, label: 2, bag_size: 4179
batch 159, loss: 0.0556, instance_loss: 0.2800, weighted_loss: 0.1229, label: 2, bag_size: 4372
batch 179, loss: 0.0766, instance_loss: 0.2102, weighted_loss: 0.1167, label: 2, bag_size: 3678
batch 199, loss: 0.4135, instance_loss: 0.4888, weighted_loss: 0.4361, label: 0, bag_size: 16741
batch 219, loss: 0.4758, instance_loss: 0.5009, weighted_loss: 0.4833, label: 0, bag_size: 5041
batch 239, loss: 0.2404, instance_loss: 0.3308, weighted_loss: 0.2675, label: 2, bag_size: 3778
batch 259, loss: 1.1282, instance_loss: 0.9747, weighted_loss: 1.0821, label: 0, bag_size: 3675
batch 279, loss: 0.0471, instance_loss: 0.3940, weighted_loss: 0.1512, label: 1, bag_size: 4134
batch 299, loss: 0.6840, instance_loss: 0.7841, weighted_loss: 0.7140, label: 1, bag_size: 3619
batch 319, loss: 0.0328, instance_loss: 0.2723, weighted_loss: 0.1046, label: 1, bag_size: 4134
batch 339, loss: 0.3016, instance_loss: 0.4104, weighted_loss: 0.3342, label: 0, bag_size: 4105
batch 359, loss: 0.1591, instance_loss: 0.5342, weighted_loss: 0.2716, label: 0, bag_size: 4529
batch 379, loss: 0.7918, instance_loss: 0.5040, weighted_loss: 0.7055, label: 0, bag_size: 1018
batch 399, loss: 0.1859, instance_loss: 0.2943, weighted_loss: 0.2184, label: 0, bag_size: 3797
batch 419, loss: 0.4379, instance_loss: 0.7370, weighted_loss: 0.5277, label: 1, bag_size: 2248
batch 439, loss: 0.2997, instance_loss: 0.1902, weighted_loss: 0.2669, label: 2, bag_size: 3583
batch 459, loss: 0.2838, instance_loss: 0.1293, weighted_loss: 0.2375, label: 2, bag_size: 4788
batch 479, loss: 0.0499, instance_loss: 0.1267, weighted_loss: 0.0729, label: 2, bag_size: 4745
batch 499, loss: 0.7563, instance_loss: 0.6052, weighted_loss: 0.7110, label: 1, bag_size: 3558
batch 519, loss: 0.2170, instance_loss: 0.2379, weighted_loss: 0.2233, label: 2, bag_size: 3396
batch 539, loss: 0.0356, instance_loss: 0.1500, weighted_loss: 0.0699, label: 0, bag_size: 4783
batch 559, loss: 0.0729, instance_loss: 0.2177, weighted_loss: 0.1163, label: 1, bag_size: 460
batch 579, loss: 0.0160, instance_loss: 0.1524, weighted_loss: 0.0569, label: 2, bag_size: 5138
batch 599, loss: 0.2106, instance_loss: 0.3559, weighted_loss: 0.2542, label: 0, bag_size: 4378
batch 619, loss: 0.0766, instance_loss: 0.3720, weighted_loss: 0.1652, label: 2, bag_size: 4497
batch 639, loss: 0.6233, instance_loss: 0.6720, weighted_loss: 0.6379, label: 2, bag_size: 2031
batch 659, loss: 0.8547, instance_loss: 0.8656, weighted_loss: 0.8580, label: 1, bag_size: 1670
batch 679, loss: 0.9413, instance_loss: 0.7635, weighted_loss: 0.8880, label: 1, bag_size: 6241
batch 699, loss: 0.4134, instance_loss: 0.3263, weighted_loss: 0.3873, label: 1, bag_size: 3755
batch 719, loss: 0.8586, instance_loss: 0.6119, weighted_loss: 0.7846, label: 0, bag_size: 3075
batch 739, loss: 0.1722, instance_loss: 0.2980, weighted_loss: 0.2099, label: 0, bag_size: 2873


class 0 clustering acc 0.9724832214765101: correct 17388/17880
class 1 clustering acc 0.28741610738255036: correct 1713/5960
Epoch: 19, train_loss: 0.6435, train_clustering_loss:  0.5799, train_error: 0.2752
class 0: acc 0.752, correct 188/250
class 1: acc 0.6092436974789915, correct 145/238
class 2: acc 0.8054474708171206, correct 207/257

Val Set, val_loss: 0.7660, val_error: 0.3298, auc: 0.8395
class 0 clustering acc 0.9822695035460993: correct 2216/2256
class 1 clustering acc 0.2047872340425532: correct 154/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8630, instance_loss: 0.6973, weighted_loss: 0.8133, label: 1, bag_size: 19265
batch 39, loss: 0.4382, instance_loss: 0.5868, weighted_loss: 0.4828, label: 1, bag_size: 19265
batch 59, loss: 1.1049, instance_loss: 0.4774, weighted_loss: 0.9166, label: 0, bag_size: 4935
batch 79, loss: 0.3448, instance_loss: 0.5128, weighted_loss: 0.3952, label: 0, bag_size: 5484
batch 99, loss: 0.2468, instance_loss: 0.3127, weighted_loss: 0.2666, label: 0, bag_size: 3334
batch 119, loss: 0.1979, instance_loss: 0.2410, weighted_loss: 0.2108, label: 0, bag_size: 5893
batch 139, loss: 0.7948, instance_loss: 0.6149, weighted_loss: 0.7408, label: 0, bag_size: 3033
batch 159, loss: 0.0841, instance_loss: 0.4919, weighted_loss: 0.2064, label: 1, bag_size: 314
batch 179, loss: 1.0864, instance_loss: 0.6638, weighted_loss: 0.9596, label: 1, bag_size: 1500
batch 199, loss: 0.9842, instance_loss: 1.0220, weighted_loss: 0.9956, label: 0, bag_size: 1695
batch 219, loss: 0.2844, instance_loss: 0.7095, weighted_loss: 0.4119, label: 0, bag_size: 4274
batch 239, loss: 5.2146, instance_loss: 1.8028, weighted_loss: 4.1911, label: 0, bag_size: 2736
batch 259, loss: 0.1903, instance_loss: 0.3180, weighted_loss: 0.2286, label: 1, bag_size: 3322
batch 279, loss: 0.2323, instance_loss: 0.4209, weighted_loss: 0.2889, label: 1, bag_size: 5532
batch 299, loss: 0.3092, instance_loss: 0.3471, weighted_loss: 0.3206, label: 2, bag_size: 3534
batch 319, loss: 0.1070, instance_loss: 0.2768, weighted_loss: 0.1580, label: 0, bag_size: 4227
batch 339, loss: 0.8401, instance_loss: 0.9620, weighted_loss: 0.8766, label: 2, bag_size: 657
batch 359, loss: 0.0849, instance_loss: 0.0967, weighted_loss: 0.0885, label: 2, bag_size: 4788
batch 379, loss: 0.8020, instance_loss: 0.5150, weighted_loss: 0.7159, label: 2, bag_size: 6298
batch 399, loss: 0.4640, instance_loss: 0.5334, weighted_loss: 0.4849, label: 1, bag_size: 1045
batch 419, loss: 0.0992, instance_loss: 0.2146, weighted_loss: 0.1338, label: 2, bag_size: 2254
batch 439, loss: 0.2403, instance_loss: 0.4050, weighted_loss: 0.2897, label: 2, bag_size: 614
batch 459, loss: 0.0934, instance_loss: 0.3870, weighted_loss: 0.1815, label: 0, bag_size: 4071
batch 479, loss: 0.0200, instance_loss: 0.1529, weighted_loss: 0.0598, label: 2, bag_size: 3176
batch 499, loss: 0.4934, instance_loss: 0.6788, weighted_loss: 0.5490, label: 1, bag_size: 4346
batch 519, loss: 0.0747, instance_loss: 0.4257, weighted_loss: 0.1800, label: 2, bag_size: 2031
batch 539, loss: 0.0335, instance_loss: 0.0949, weighted_loss: 0.0519, label: 2, bag_size: 6001
batch 559, loss: 0.4188, instance_loss: 0.5485, weighted_loss: 0.4577, label: 0, bag_size: 3033
batch 579, loss: 0.2817, instance_loss: 0.3923, weighted_loss: 0.3149, label: 0, bag_size: 6863
batch 599, loss: 0.7702, instance_loss: 0.7033, weighted_loss: 0.7502, label: 1, bag_size: 1500
batch 619, loss: 1.2466, instance_loss: 0.4593, weighted_loss: 1.0104, label: 2, bag_size: 3746
batch 639, loss: 0.7059, instance_loss: 0.8251, weighted_loss: 0.7416, label: 1, bag_size: 1364
batch 659, loss: 0.0033, instance_loss: 0.1660, weighted_loss: 0.0521, label: 1, bag_size: 4134
batch 679, loss: 0.4420, instance_loss: 0.6152, weighted_loss: 0.4940, label: 1, bag_size: 4612
batch 699, loss: 0.0872, instance_loss: 0.2982, weighted_loss: 0.1505, label: 0, bag_size: 4760
batch 719, loss: 1.3420, instance_loss: 0.8513, weighted_loss: 1.1948, label: 2, bag_size: 7607
batch 739, loss: 0.3655, instance_loss: 0.4636, weighted_loss: 0.3949, label: 1, bag_size: 3935


class 0 clustering acc 0.9715324384787472: correct 17371/17880
class 1 clustering acc 0.2973154362416107: correct 1772/5960
Epoch: 20, train_loss: 0.6093, train_clustering_loss:  0.5758, train_error: 0.2456
class 0: acc 0.7747747747747747, correct 172/222
class 1: acc 0.6716417910447762, correct 180/268
class 2: acc 0.8235294117647058, correct 210/255

Val Set, val_loss: 0.9631, val_error: 0.3830, auc: 0.8391
class 0 clustering acc 0.9658687943262412: correct 2179/2256
class 1 clustering acc 0.16090425531914893: correct 121/752
class 0: acc 0.4423076923076923, correct 23/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.9707, instance_loss: 1.2227, weighted_loss: 1.7463, label: 1, bag_size: 20666
batch 39, loss: 0.3488, instance_loss: 0.4183, weighted_loss: 0.3697, label: 2, bag_size: 3397
batch 59, loss: 0.0804, instance_loss: 0.4311, weighted_loss: 0.1856, label: 2, bag_size: 3607
batch 79, loss: 1.1630, instance_loss: 0.6615, weighted_loss: 1.0126, label: 0, bag_size: 4310
batch 99, loss: 1.5262, instance_loss: 1.2683, weighted_loss: 1.4488, label: 0, bag_size: 909
batch 119, loss: 0.0669, instance_loss: 0.3341, weighted_loss: 0.1470, label: 1, bag_size: 3333
batch 139, loss: 1.7235, instance_loss: 1.0534, weighted_loss: 1.5225, label: 1, bag_size: 6942
batch 159, loss: 1.0940, instance_loss: 0.8734, weighted_loss: 1.0278, label: 0, bag_size: 3402
batch 179, loss: 0.0406, instance_loss: 0.1884, weighted_loss: 0.0850, label: 2, bag_size: 4141
batch 199, loss: 0.2364, instance_loss: 0.2370, weighted_loss: 0.2366, label: 2, bag_size: 4302
batch 219, loss: 2.1245, instance_loss: 0.9543, weighted_loss: 1.7735, label: 2, bag_size: 361
batch 239, loss: 0.3204, instance_loss: 0.5346, weighted_loss: 0.3847, label: 0, bag_size: 3525
batch 259, loss: 0.4984, instance_loss: 0.3258, weighted_loss: 0.4466, label: 2, bag_size: 4241
batch 279, loss: 0.0559, instance_loss: 0.5131, weighted_loss: 0.1931, label: 0, bag_size: 3408
batch 299, loss: 0.0342, instance_loss: 0.3040, weighted_loss: 0.1151, label: 1, bag_size: 8482
batch 319, loss: 0.1005, instance_loss: 0.4625, weighted_loss: 0.2091, label: 0, bag_size: 5459
batch 339, loss: 0.0875, instance_loss: 0.4529, weighted_loss: 0.1971, label: 1, bag_size: 4534
batch 359, loss: 0.0835, instance_loss: 0.2552, weighted_loss: 0.1350, label: 0, bag_size: 5377
batch 379, loss: 0.1605, instance_loss: 0.4264, weighted_loss: 0.2403, label: 1, bag_size: 1221
batch 399, loss: 0.0439, instance_loss: 0.2453, weighted_loss: 0.1043, label: 0, bag_size: 4229
batch 419, loss: 1.1692, instance_loss: 0.7524, weighted_loss: 1.0442, label: 2, bag_size: 4291
batch 439, loss: 0.2491, instance_loss: 0.5806, weighted_loss: 0.3486, label: 1, bag_size: 4644
batch 459, loss: 0.0878, instance_loss: 0.2388, weighted_loss: 0.1331, label: 0, bag_size: 5226
batch 479, loss: 0.0000, instance_loss: 0.0014, weighted_loss: 0.0004, label: 0, bag_size: 5003
batch 499, loss: 0.5176, instance_loss: 0.6525, weighted_loss: 0.5581, label: 0, bag_size: 5893
batch 519, loss: 2.6627, instance_loss: 1.4563, weighted_loss: 2.3008, label: 2, bag_size: 223
batch 539, loss: 0.0700, instance_loss: 0.2907, weighted_loss: 0.1362, label: 2, bag_size: 6001
batch 559, loss: 0.4516, instance_loss: 0.5048, weighted_loss: 0.4676, label: 2, bag_size: 3534
batch 579, loss: 2.3468, instance_loss: 1.0018, weighted_loss: 1.9433, label: 2, bag_size: 5307
batch 599, loss: 0.2130, instance_loss: 0.3209, weighted_loss: 0.2454, label: 0, bag_size: 4909
batch 619, loss: 0.1665, instance_loss: 0.2807, weighted_loss: 0.2007, label: 2, bag_size: 6644
batch 639, loss: 0.0779, instance_loss: 0.2829, weighted_loss: 0.1394, label: 0, bag_size: 2545
batch 659, loss: 0.5442, instance_loss: 0.6279, weighted_loss: 0.5693, label: 0, bag_size: 1270
batch 679, loss: 0.0117, instance_loss: 0.4090, weighted_loss: 0.1309, label: 2, bag_size: 2031
batch 699, loss: 0.0602, instance_loss: 0.2450, weighted_loss: 0.1156, label: 2, bag_size: 3121
batch 719, loss: 0.7586, instance_loss: 0.6818, weighted_loss: 0.7356, label: 1, bag_size: 3755
batch 739, loss: 0.7054, instance_loss: 0.8103, weighted_loss: 0.7369, label: 1, bag_size: 2998


class 0 clustering acc 0.9671700223713646: correct 17293/17880
class 1 clustering acc 0.34697986577181206: correct 2068/5960
Epoch: 21, train_loss: 0.5989, train_clustering_loss:  0.5624, train_error: 0.2510
class 0: acc 0.8062015503875969, correct 208/258
class 1: acc 0.6297872340425532, correct 148/235
class 2: acc 0.8015873015873016, correct 202/252

Val Set, val_loss: 0.6471, val_error: 0.2553, auc: 0.8672
class 0 clustering acc 0.9698581560283688: correct 2188/2256
class 1 clustering acc 0.3537234042553192: correct 266/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.690337 --> 0.647054).  Saving model ...


batch 19, loss: 0.6883, instance_loss: 0.5906, weighted_loss: 0.6590, label: 2, bag_size: 6594
batch 39, loss: 0.7280, instance_loss: 0.7279, weighted_loss: 0.7280, label: 2, bag_size: 1050
batch 59, loss: 0.0718, instance_loss: 0.4849, weighted_loss: 0.1958, label: 2, bag_size: 4910
batch 79, loss: 0.4711, instance_loss: 0.4045, weighted_loss: 0.4511, label: 0, bag_size: 4562
batch 99, loss: 0.0729, instance_loss: 1.0090, weighted_loss: 0.3537, label: 1, bag_size: 1604
batch 119, loss: 0.7784, instance_loss: 0.6296, weighted_loss: 0.7337, label: 0, bag_size: 3070
batch 139, loss: 1.4743, instance_loss: 0.6442, weighted_loss: 1.2253, label: 0, bag_size: 3387
batch 159, loss: 0.5442, instance_loss: 0.7671, weighted_loss: 0.6110, label: 0, bag_size: 609
batch 179, loss: 0.2462, instance_loss: 0.3777, weighted_loss: 0.2856, label: 2, bag_size: 3176
batch 199, loss: 0.2440, instance_loss: 0.2910, weighted_loss: 0.2581, label: 2, bag_size: 2481
batch 219, loss: 0.4491, instance_loss: 0.4197, weighted_loss: 0.4403, label: 0, bag_size: 3155
batch 239, loss: 0.9632, instance_loss: 0.6755, weighted_loss: 0.8769, label: 2, bag_size: 223
batch 259, loss: 0.2078, instance_loss: 0.4166, weighted_loss: 0.2704, label: 0, bag_size: 1373
batch 279, loss: 0.1075, instance_loss: 0.2887, weighted_loss: 0.1619, label: 1, bag_size: 7135
batch 299, loss: 0.3510, instance_loss: 0.1542, weighted_loss: 0.2920, label: 2, bag_size: 3583
batch 319, loss: 0.0689, instance_loss: 0.3357, weighted_loss: 0.1490, label: 0, bag_size: 4229
batch 339, loss: 0.4911, instance_loss: 0.4858, weighted_loss: 0.4895, label: 0, bag_size: 3864
batch 359, loss: 0.0203, instance_loss: 0.1583, weighted_loss: 0.0617, label: 0, bag_size: 5006
batch 379, loss: 0.0612, instance_loss: 0.2215, weighted_loss: 0.1093, label: 0, bag_size: 5036
batch 399, loss: 0.0187, instance_loss: 0.3246, weighted_loss: 0.1105, label: 0, bag_size: 4326
batch 419, loss: 0.2758, instance_loss: 0.2708, weighted_loss: 0.2743, label: 0, bag_size: 2601
batch 439, loss: 0.1561, instance_loss: 0.2025, weighted_loss: 0.1700, label: 2, bag_size: 2422
batch 459, loss: 0.4740, instance_loss: 0.3887, weighted_loss: 0.4484, label: 2, bag_size: 3174
batch 479, loss: 0.5289, instance_loss: 0.9891, weighted_loss: 0.6669, label: 0, bag_size: 889
batch 499, loss: 0.8499, instance_loss: 0.9138, weighted_loss: 0.8691, label: 1, bag_size: 1906
batch 519, loss: 0.6045, instance_loss: 0.3623, weighted_loss: 0.5318, label: 2, bag_size: 3583
batch 539, loss: 0.2361, instance_loss: 0.5959, weighted_loss: 0.3440, label: 0, bag_size: 889
batch 559, loss: 1.4735, instance_loss: 1.1352, weighted_loss: 1.3720, label: 2, bag_size: 223
batch 579, loss: 1.1987, instance_loss: 0.5534, weighted_loss: 1.0051, label: 2, bag_size: 705
batch 599, loss: 0.6456, instance_loss: 0.9377, weighted_loss: 0.7333, label: 0, bag_size: 6285
batch 619, loss: 0.0737, instance_loss: 0.2539, weighted_loss: 0.1277, label: 1, bag_size: 2878
batch 639, loss: 0.1970, instance_loss: 0.3563, weighted_loss: 0.2448, label: 1, bag_size: 6475
batch 659, loss: 0.0110, instance_loss: 0.2609, weighted_loss: 0.0860, label: 1, bag_size: 4578
batch 679, loss: 0.2091, instance_loss: 0.5310, weighted_loss: 0.3057, label: 0, bag_size: 1194
batch 699, loss: 0.3622, instance_loss: 0.4345, weighted_loss: 0.3839, label: 0, bag_size: 2428
batch 719, loss: 0.0544, instance_loss: 0.4665, weighted_loss: 0.1780, label: 0, bag_size: 2824
batch 739, loss: 0.5039, instance_loss: 0.5837, weighted_loss: 0.5278, label: 2, bag_size: 5406


class 0 clustering acc 0.9672259507829978: correct 17294/17880
class 1 clustering acc 0.3119127516778524: correct 1859/5960
Epoch: 22, train_loss: 0.6117, train_clustering_loss:  0.5751, train_error: 0.2497
class 0: acc 0.784, correct 196/250
class 1: acc 0.6448979591836734, correct 158/245
class 2: acc 0.82, correct 205/250

Val Set, val_loss: 0.8086, val_error: 0.3404, auc: 0.8526
class 0 clustering acc 0.9800531914893617: correct 2211/2256
class 1 clustering acc 0.12898936170212766: correct 97/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1881, instance_loss: 0.2498, weighted_loss: 0.2066, label: 2, bag_size: 4140
batch 39, loss: 1.8304, instance_loss: 1.1115, weighted_loss: 1.6147, label: 0, bag_size: 4528
batch 59, loss: 0.0521, instance_loss: 0.2679, weighted_loss: 0.1168, label: 0, bag_size: 5039
batch 79, loss: 0.5256, instance_loss: 0.7556, weighted_loss: 0.5946, label: 2, bag_size: 4316
batch 99, loss: 1.3245, instance_loss: 1.1036, weighted_loss: 1.2583, label: 1, bag_size: 3813
batch 119, loss: 0.0055, instance_loss: 0.1565, weighted_loss: 0.0508, label: 2, bag_size: 5017
batch 139, loss: 1.4104, instance_loss: 0.6225, weighted_loss: 1.1740, label: 0, bag_size: 8611
batch 159, loss: 1.4601, instance_loss: 1.2961, weighted_loss: 1.4109, label: 1, bag_size: 2614
batch 179, loss: 0.2603, instance_loss: 0.4060, weighted_loss: 0.3040, label: 0, bag_size: 6797
batch 199, loss: 0.1783, instance_loss: 0.3715, weighted_loss: 0.2363, label: 0, bag_size: 5519
batch 219, loss: 0.0354, instance_loss: 0.6589, weighted_loss: 0.2225, label: 1, bag_size: 3475
batch 239, loss: 0.4609, instance_loss: 0.8630, weighted_loss: 0.5815, label: 2, bag_size: 2049
batch 259, loss: 0.5808, instance_loss: 1.9495, weighted_loss: 0.9914, label: 0, bag_size: 1981
batch 279, loss: 0.0283, instance_loss: 0.1636, weighted_loss: 0.0689, label: 2, bag_size: 3121
batch 299, loss: 0.0671, instance_loss: 0.1319, weighted_loss: 0.0865, label: 2, bag_size: 6001
batch 319, loss: 0.8354, instance_loss: 0.9592, weighted_loss: 0.8726, label: 1, bag_size: 5423
batch 339, loss: 3.1393, instance_loss: 1.3337, weighted_loss: 2.5976, label: 0, bag_size: 1420
batch 359, loss: 1.9858, instance_loss: 0.7284, weighted_loss: 1.6086, label: 1, bag_size: 3786
batch 379, loss: 0.5436, instance_loss: 0.4278, weighted_loss: 0.5088, label: 2, bag_size: 4096
batch 399, loss: 0.3135, instance_loss: 0.5414, weighted_loss: 0.3819, label: 1, bag_size: 3761
batch 419, loss: 0.8632, instance_loss: 0.6506, weighted_loss: 0.7994, label: 1, bag_size: 3422
batch 439, loss: 0.3653, instance_loss: 0.5943, weighted_loss: 0.4340, label: 1, bag_size: 4612
batch 459, loss: 0.7807, instance_loss: 0.8997, weighted_loss: 0.8164, label: 0, bag_size: 1141
batch 479, loss: 0.0818, instance_loss: 0.2118, weighted_loss: 0.1208, label: 2, bag_size: 4775
batch 499, loss: 2.5518, instance_loss: 1.2997, weighted_loss: 2.1762, label: 1, bag_size: 1964
batch 519, loss: 0.9528, instance_loss: 0.5855, weighted_loss: 0.8426, label: 1, bag_size: 5412
batch 539, loss: 3.6373, instance_loss: 1.0187, weighted_loss: 2.8517, label: 1, bag_size: 3497
batch 559, loss: 0.7782, instance_loss: 0.6981, weighted_loss: 0.7541, label: 0, bag_size: 5015
batch 579, loss: 0.1580, instance_loss: 0.4085, weighted_loss: 0.2332, label: 2, bag_size: 4978
batch 599, loss: 0.0054, instance_loss: 0.3958, weighted_loss: 0.1225, label: 2, bag_size: 5017
batch 619, loss: 2.1284, instance_loss: 1.0068, weighted_loss: 1.7919, label: 2, bag_size: 4179
batch 639, loss: 0.2448, instance_loss: 0.7694, weighted_loss: 0.4022, label: 0, bag_size: 5519
batch 659, loss: 0.0426, instance_loss: 0.4050, weighted_loss: 0.1513, label: 0, bag_size: 1006
batch 679, loss: 0.1166, instance_loss: 0.2148, weighted_loss: 0.1460, label: 2, bag_size: 3176
batch 699, loss: 0.2599, instance_loss: 0.7563, weighted_loss: 0.4088, label: 1, bag_size: 8482
batch 719, loss: 1.0884, instance_loss: 0.6210, weighted_loss: 0.9482, label: 0, bag_size: 4450
batch 739, loss: 0.1204, instance_loss: 0.2479, weighted_loss: 0.1586, label: 2, bag_size: 2313


class 0 clustering acc 0.9657158836689038: correct 17267/17880
class 1 clustering acc 0.32483221476510066: correct 1936/5960
Epoch: 23, train_loss: 0.5737, train_clustering_loss:  0.5759, train_error: 0.2416
class 0: acc 0.8244274809160306, correct 216/262
class 1: acc 0.6336206896551724, correct 147/232
class 2: acc 0.8047808764940239, correct 202/251

Val Set, val_loss: 0.7169, val_error: 0.3404, auc: 0.8531
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.23803191489361702: correct 179/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3536, instance_loss: 0.5427, weighted_loss: 0.4103, label: 1, bag_size: 5532
batch 39, loss: 0.0816, instance_loss: 0.2501, weighted_loss: 0.1321, label: 0, bag_size: 3986
batch 59, loss: 0.0349, instance_loss: 0.2127, weighted_loss: 0.0882, label: 0, bag_size: 2825
batch 79, loss: 0.0613, instance_loss: 0.6965, weighted_loss: 0.2519, label: 0, bag_size: 4479
batch 99, loss: 0.5702, instance_loss: 0.6369, weighted_loss: 0.5902, label: 0, bag_size: 5368
batch 119, loss: 0.0421, instance_loss: 0.2357, weighted_loss: 0.1002, label: 2, bag_size: 4372
batch 139, loss: 0.2398, instance_loss: 0.2644, weighted_loss: 0.2472, label: 0, bag_size: 6863
batch 159, loss: 1.4793, instance_loss: 0.8193, weighted_loss: 1.2813, label: 2, bag_size: 7607
batch 179, loss: 0.1004, instance_loss: 0.5090, weighted_loss: 0.2230, label: 1, bag_size: 3357
batch 199, loss: 0.3963, instance_loss: 0.5136, weighted_loss: 0.4315, label: 1, bag_size: 4069
batch 219, loss: 0.1592, instance_loss: 0.6072, weighted_loss: 0.2936, label: 1, bag_size: 5728
batch 239, loss: 0.7924, instance_loss: 0.7102, weighted_loss: 0.7677, label: 0, bag_size: 4707
batch 259, loss: 1.9906, instance_loss: 1.0646, weighted_loss: 1.7128, label: 2, bag_size: 724
batch 279, loss: 0.2009, instance_loss: 0.2052, weighted_loss: 0.2022, label: 2, bag_size: 3583
batch 299, loss: 1.2725, instance_loss: 0.6105, weighted_loss: 1.0739, label: 1, bag_size: 1250
batch 319, loss: 0.9054, instance_loss: 0.6423, weighted_loss: 0.8265, label: 1, bag_size: 3786
batch 339, loss: 0.5613, instance_loss: 0.4978, weighted_loss: 0.5422, label: 1, bag_size: 1854
batch 359, loss: 0.3896, instance_loss: 0.5636, weighted_loss: 0.4418, label: 1, bag_size: 1854
batch 379, loss: 0.1278, instance_loss: 0.2959, weighted_loss: 0.1783, label: 2, bag_size: 5011
batch 399, loss: 1.0267, instance_loss: 0.8573, weighted_loss: 0.9759, label: 1, bag_size: 5197
batch 419, loss: 0.6344, instance_loss: 0.7744, weighted_loss: 0.6764, label: 1, bag_size: 4960
batch 439, loss: 1.1009, instance_loss: 0.9148, weighted_loss: 1.0451, label: 0, bag_size: 3833
batch 459, loss: 0.0444, instance_loss: 0.1157, weighted_loss: 0.0658, label: 2, bag_size: 2905
batch 479, loss: 0.0769, instance_loss: 0.3488, weighted_loss: 0.1585, label: 1, bag_size: 2009
batch 499, loss: 0.7995, instance_loss: 1.0593, weighted_loss: 0.8774, label: 0, bag_size: 1933
batch 519, loss: 0.4181, instance_loss: 0.3941, weighted_loss: 0.4109, label: 1, bag_size: 3296
batch 539, loss: 0.0385, instance_loss: 0.5229, weighted_loss: 0.1839, label: 1, bag_size: 862
batch 559, loss: 0.1109, instance_loss: 1.1299, weighted_loss: 0.4166, label: 1, bag_size: 4869
batch 579, loss: 0.0995, instance_loss: 0.5506, weighted_loss: 0.2348, label: 0, bag_size: 2610
batch 599, loss: 0.1770, instance_loss: 0.6105, weighted_loss: 0.3071, label: 0, bag_size: 1795
batch 619, loss: 3.0688, instance_loss: 1.1760, weighted_loss: 2.5010, label: 0, bag_size: 3830
batch 639, loss: 0.9055, instance_loss: 0.8279, weighted_loss: 0.8822, label: 2, bag_size: 3475
batch 659, loss: 1.4857, instance_loss: 0.5920, weighted_loss: 1.2176, label: 0, bag_size: 4626
batch 679, loss: 1.5181, instance_loss: 0.9894, weighted_loss: 1.3595, label: 1, bag_size: 1712
batch 699, loss: 0.2315, instance_loss: 0.4080, weighted_loss: 0.2844, label: 2, bag_size: 2359
batch 719, loss: 0.6462, instance_loss: 0.4165, weighted_loss: 0.5773, label: 0, bag_size: 4310
batch 739, loss: 0.9626, instance_loss: 0.7064, weighted_loss: 0.8858, label: 1, bag_size: 1906


class 0 clustering acc 0.9729306487695749: correct 17396/17880
class 1 clustering acc 0.3144295302013423: correct 1874/5960
Epoch: 24, train_loss: 0.5809, train_clustering_loss:  0.5675, train_error: 0.2282
class 0: acc 0.799163179916318, correct 191/239
class 1: acc 0.7072243346007605, correct 186/263
class 2: acc 0.8148148148148148, correct 198/243

Val Set, val_loss: 0.6927, val_error: 0.3404, auc: 0.8671
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.3537234042553192: correct 266/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4679, instance_loss: 0.5855, weighted_loss: 0.5032, label: 0, bag_size: 4794
batch 39, loss: 0.6914, instance_loss: 0.7649, weighted_loss: 0.7135, label: 2, bag_size: 6594
batch 59, loss: 0.0157, instance_loss: 0.1649, weighted_loss: 0.0605, label: 2, bag_size: 3121
batch 79, loss: 0.3879, instance_loss: 0.3451, weighted_loss: 0.3751, label: 0, bag_size: 2884
batch 99, loss: 0.2125, instance_loss: 0.5182, weighted_loss: 0.3043, label: 2, bag_size: 5924
batch 119, loss: 0.9011, instance_loss: 0.9652, weighted_loss: 0.9203, label: 1, bag_size: 1528
batch 139, loss: 0.9410, instance_loss: 1.1001, weighted_loss: 0.9888, label: 0, bag_size: 1933
batch 159, loss: 0.1707, instance_loss: 0.2888, weighted_loss: 0.2061, label: 0, bag_size: 5041
batch 179, loss: 0.9449, instance_loss: 0.6951, weighted_loss: 0.8700, label: 1, bag_size: 3009
batch 199, loss: 2.0112, instance_loss: 0.9211, weighted_loss: 1.6841, label: 1, bag_size: 4145
batch 219, loss: 0.0708, instance_loss: 0.7946, weighted_loss: 0.2879, label: 2, bag_size: 4745
batch 239, loss: 0.1643, instance_loss: 0.3576, weighted_loss: 0.2223, label: 1, bag_size: 440
batch 259, loss: 0.1396, instance_loss: 0.2678, weighted_loss: 0.1781, label: 2, bag_size: 614
batch 279, loss: 0.5007, instance_loss: 0.5304, weighted_loss: 0.5096, label: 1, bag_size: 6165
batch 299, loss: 0.0000, instance_loss: 0.9037, weighted_loss: 0.2711, label: 0, bag_size: 1709
batch 319, loss: 2.1515, instance_loss: 1.2960, weighted_loss: 1.8949, label: 0, bag_size: 11141
batch 339, loss: 0.3103, instance_loss: 0.3033, weighted_loss: 0.3082, label: 0, bag_size: 2189
batch 359, loss: 0.0410, instance_loss: 0.3360, weighted_loss: 0.1295, label: 0, bag_size: 5795
batch 379, loss: 0.2619, instance_loss: 0.5842, weighted_loss: 0.3586, label: 0, bag_size: 6445
batch 399, loss: 2.8893, instance_loss: 1.1790, weighted_loss: 2.3762, label: 0, bag_size: 7504
batch 419, loss: 0.1291, instance_loss: 0.2880, weighted_loss: 0.1768, label: 0, bag_size: 13540
batch 439, loss: 0.0300, instance_loss: 0.3717, weighted_loss: 0.1325, label: 1, bag_size: 6992
batch 459, loss: 0.8948, instance_loss: 0.6606, weighted_loss: 0.8245, label: 0, bag_size: 13770
batch 479, loss: 0.1988, instance_loss: 0.3486, weighted_loss: 0.2437, label: 0, bag_size: 6863
batch 499, loss: 0.6979, instance_loss: 0.7822, weighted_loss: 0.7232, label: 1, bag_size: 2751
batch 519, loss: 0.4400, instance_loss: 0.6697, weighted_loss: 0.5089, label: 0, bag_size: 4544
batch 539, loss: 0.7201, instance_loss: 0.7988, weighted_loss: 0.7437, label: 1, bag_size: 4612
batch 559, loss: 0.1846, instance_loss: 0.4989, weighted_loss: 0.2789, label: 1, bag_size: 2796
batch 579, loss: 0.5019, instance_loss: 0.5356, weighted_loss: 0.5120, label: 1, bag_size: 9099
batch 599, loss: 0.9964, instance_loss: 0.7418, weighted_loss: 0.9200, label: 2, bag_size: 3274
batch 619, loss: 0.8267, instance_loss: 0.5507, weighted_loss: 0.7439, label: 0, bag_size: 13770
batch 639, loss: 0.0083, instance_loss: 0.3115, weighted_loss: 0.0992, label: 1, bag_size: 4134
batch 659, loss: 0.1562, instance_loss: 0.2059, weighted_loss: 0.1711, label: 2, bag_size: 3026
batch 679, loss: 0.0227, instance_loss: 0.4446, weighted_loss: 0.1493, label: 1, bag_size: 874
batch 699, loss: 0.1894, instance_loss: 0.4494, weighted_loss: 0.2674, label: 0, bag_size: 2392
batch 719, loss: 0.0110, instance_loss: 0.3640, weighted_loss: 0.1169, label: 1, bag_size: 4253
batch 739, loss: 0.1130, instance_loss: 0.5671, weighted_loss: 0.2493, label: 1, bag_size: 3156


class 0 clustering acc 0.9692393736017897: correct 17330/17880
class 1 clustering acc 0.3352348993288591: correct 1998/5960
Epoch: 25, train_loss: 0.5752, train_clustering_loss:  0.5603, train_error: 0.2523
class 0: acc 0.7946768060836502, correct 209/263
class 1: acc 0.611353711790393, correct 140/229
class 2: acc 0.8221343873517787, correct 208/253

Val Set, val_loss: 0.6589, val_error: 0.2872, auc: 0.8678
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.30851063829787234: correct 232/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0894, instance_loss: 0.3494, weighted_loss: 0.1674, label: 0, bag_size: 4071
batch 39, loss: 1.3538, instance_loss: 0.9281, weighted_loss: 1.2261, label: 1, bag_size: 4145
batch 59, loss: 0.3153, instance_loss: 0.2859, weighted_loss: 0.3064, label: 0, bag_size: 3156
batch 79, loss: 2.0208, instance_loss: 0.9203, weighted_loss: 1.6907, label: 0, bag_size: 35080
batch 99, loss: 0.3696, instance_loss: 0.6503, weighted_loss: 0.4538, label: 0, bag_size: 4707
batch 119, loss: 0.0263, instance_loss: 0.2938, weighted_loss: 0.1065, label: 2, bag_size: 4140
batch 139, loss: 0.6190, instance_loss: 0.4562, weighted_loss: 0.5701, label: 2, bag_size: 6644
batch 159, loss: 0.4850, instance_loss: 0.3817, weighted_loss: 0.4540, label: 0, bag_size: 3368
batch 179, loss: 0.4212, instance_loss: 0.6661, weighted_loss: 0.4946, label: 2, bag_size: 2486
batch 199, loss: 0.5667, instance_loss: 0.4210, weighted_loss: 0.5230, label: 0, bag_size: 6440
batch 219, loss: 0.0271, instance_loss: 0.3074, weighted_loss: 0.1112, label: 2, bag_size: 4140
batch 239, loss: 0.1497, instance_loss: 0.3090, weighted_loss: 0.1975, label: 0, bag_size: 3883
batch 259, loss: 1.8935, instance_loss: 0.8282, weighted_loss: 1.5739, label: 1, bag_size: 3475
batch 279, loss: 1.3583, instance_loss: 1.0404, weighted_loss: 1.2629, label: 1, bag_size: 5693
batch 299, loss: 0.0136, instance_loss: 0.1226, weighted_loss: 0.0463, label: 2, bag_size: 4043
batch 319, loss: 0.0926, instance_loss: 0.4196, weighted_loss: 0.1907, label: 2, bag_size: 5472
batch 339, loss: 0.1439, instance_loss: 0.3279, weighted_loss: 0.1991, label: 2, bag_size: 2481
batch 359, loss: 0.5271, instance_loss: 0.3854, weighted_loss: 0.4846, label: 2, bag_size: 3534
batch 379, loss: 0.1094, instance_loss: 0.2256, weighted_loss: 0.1442, label: 2, bag_size: 3172
batch 399, loss: 0.2123, instance_loss: 0.3290, weighted_loss: 0.2473, label: 2, bag_size: 4302
batch 419, loss: 0.1375, instance_loss: 0.5297, weighted_loss: 0.2552, label: 2, bag_size: 4745
batch 439, loss: 0.4691, instance_loss: 0.5461, weighted_loss: 0.4922, label: 1, bag_size: 2753
batch 459, loss: 0.0982, instance_loss: 0.3832, weighted_loss: 0.1837, label: 1, bag_size: 2962
batch 479, loss: 0.0000, instance_loss: 0.0415, weighted_loss: 0.0124, label: 0, bag_size: 5487
batch 499, loss: 0.0187, instance_loss: 0.4264, weighted_loss: 0.1410, label: 1, bag_size: 3425
batch 519, loss: 0.0996, instance_loss: 0.2670, weighted_loss: 0.1498, label: 2, bag_size: 5011
batch 539, loss: 1.7889, instance_loss: 1.1880, weighted_loss: 1.6086, label: 0, bag_size: 893
batch 559, loss: 0.0145, instance_loss: 0.3460, weighted_loss: 0.1140, label: 1, bag_size: 3425
batch 579, loss: 0.3547, instance_loss: 0.8591, weighted_loss: 0.5060, label: 0, bag_size: 4544
batch 599, loss: 0.0924, instance_loss: 0.4913, weighted_loss: 0.2121, label: 1, bag_size: 862
batch 619, loss: 0.2393, instance_loss: 0.5331, weighted_loss: 0.3275, label: 0, bag_size: 5953
batch 639, loss: 0.0771, instance_loss: 0.3838, weighted_loss: 0.1691, label: 0, bag_size: 5039
batch 659, loss: 0.6827, instance_loss: 0.5555, weighted_loss: 0.6446, label: 1, bag_size: 9099
batch 679, loss: 0.0360, instance_loss: 0.5862, weighted_loss: 0.2010, label: 1, bag_size: 4898
batch 699, loss: 1.0686, instance_loss: 0.6568, weighted_loss: 0.9451, label: 2, bag_size: 552
batch 719, loss: 0.0538, instance_loss: 0.4619, weighted_loss: 0.1763, label: 1, bag_size: 3586
batch 739, loss: 1.8129, instance_loss: 0.8485, weighted_loss: 1.5236, label: 1, bag_size: 3261


class 0 clustering acc 0.9672818791946308: correct 17295/17880
class 1 clustering acc 0.35151006711409394: correct 2095/5960
Epoch: 26, train_loss: 0.5213, train_clustering_loss:  0.5463, train_error: 0.2188
class 0: acc 0.8326693227091634, correct 209/251
class 1: acc 0.7027027027027027, correct 182/259
class 2: acc 0.8127659574468085, correct 191/235

Val Set, val_loss: 0.7807, val_error: 0.3404, auc: 0.8472
class 0 clustering acc 0.9592198581560284: correct 2164/2256
class 1 clustering acc 0.3484042553191489: correct 262/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0017, instance_loss: 0.2181, weighted_loss: 0.0666, label: 1, bag_size: 4134
batch 39, loss: 0.0005, instance_loss: 0.1359, weighted_loss: 0.0411, label: 1, bag_size: 5018
batch 59, loss: 0.9250, instance_loss: 0.5124, weighted_loss: 0.8012, label: 1, bag_size: 4595
batch 79, loss: 0.3060, instance_loss: 0.8155, weighted_loss: 0.4589, label: 0, bag_size: 1910
batch 99, loss: 0.0189, instance_loss: 0.1981, weighted_loss: 0.0727, label: 1, bag_size: 796
batch 119, loss: 0.3703, instance_loss: 0.4947, weighted_loss: 0.4076, label: 2, bag_size: 4241
batch 139, loss: 0.3650, instance_loss: 0.4312, weighted_loss: 0.3849, label: 1, bag_size: 1510
batch 159, loss: 0.4217, instance_loss: 0.3798, weighted_loss: 0.4091, label: 2, bag_size: 3210
batch 179, loss: 0.0215, instance_loss: 0.2251, weighted_loss: 0.0825, label: 0, bag_size: 3539
batch 199, loss: 0.0127, instance_loss: 0.3306, weighted_loss: 0.1081, label: 2, bag_size: 2422
batch 219, loss: 0.0162, instance_loss: 0.1702, weighted_loss: 0.0624, label: 0, bag_size: 1655
batch 239, loss: 0.1337, instance_loss: 0.6956, weighted_loss: 0.3023, label: 0, bag_size: 3268
batch 259, loss: 0.0142, instance_loss: 0.3293, weighted_loss: 0.1087, label: 1, bag_size: 2493
batch 279, loss: 0.0856, instance_loss: 0.1225, weighted_loss: 0.0967, label: 2, bag_size: 2905
batch 299, loss: 0.0194, instance_loss: 0.1859, weighted_loss: 0.0693, label: 0, bag_size: 5500
batch 319, loss: 0.9779, instance_loss: 0.5345, weighted_loss: 0.8449, label: 1, bag_size: 3885
batch 339, loss: 1.2415, instance_loss: 1.1124, weighted_loss: 1.2028, label: 1, bag_size: 6241
batch 359, loss: 1.4634, instance_loss: 1.3086, weighted_loss: 1.4170, label: 1, bag_size: 3016
batch 379, loss: 0.1285, instance_loss: 0.3081, weighted_loss: 0.1824, label: 0, bag_size: 4827
batch 399, loss: 0.0361, instance_loss: 0.1367, weighted_loss: 0.0663, label: 0, bag_size: 2825
batch 419, loss: 0.3432, instance_loss: 0.5457, weighted_loss: 0.4039, label: 1, bag_size: 3604
batch 439, loss: 0.1344, instance_loss: 0.1923, weighted_loss: 0.1518, label: 0, bag_size: 4734
batch 459, loss: 0.1309, instance_loss: 0.3461, weighted_loss: 0.1955, label: 0, bag_size: 4282
batch 479, loss: 0.4203, instance_loss: 0.4999, weighted_loss: 0.4442, label: 1, bag_size: 3596
batch 499, loss: 0.0233, instance_loss: 0.1602, weighted_loss: 0.0644, label: 2, bag_size: 4775
batch 519, loss: 1.2930, instance_loss: 0.8013, weighted_loss: 1.1454, label: 1, bag_size: 3106
batch 539, loss: 2.3133, instance_loss: 1.2633, weighted_loss: 1.9983, label: 1, bag_size: 936
batch 559, loss: 0.0524, instance_loss: 0.4487, weighted_loss: 0.1713, label: 0, bag_size: 6015
batch 579, loss: 0.1229, instance_loss: 1.2755, weighted_loss: 0.4687, label: 1, bag_size: 4898
batch 599, loss: 0.0856, instance_loss: 0.4087, weighted_loss: 0.1825, label: 2, bag_size: 6273
batch 619, loss: 0.4736, instance_loss: 0.5123, weighted_loss: 0.4852, label: 2, bag_size: 3534
batch 639, loss: 0.0794, instance_loss: 0.2897, weighted_loss: 0.1425, label: 2, bag_size: 4978
batch 659, loss: 0.6118, instance_loss: 0.8521, weighted_loss: 0.6839, label: 2, bag_size: 3172
batch 679, loss: 0.0486, instance_loss: 0.3481, weighted_loss: 0.1384, label: 0, bag_size: 1655
batch 699, loss: 0.7507, instance_loss: 0.6054, weighted_loss: 0.7071, label: 1, bag_size: 2642
batch 719, loss: 1.0873, instance_loss: 0.7683, weighted_loss: 0.9916, label: 1, bag_size: 5926
batch 739, loss: 0.3968, instance_loss: 0.5023, weighted_loss: 0.4285, label: 1, bag_size: 5512


class 0 clustering acc 0.9649888143176734: correct 17254/17880
class 1 clustering acc 0.3427852348993289: correct 2043/5960
Epoch: 27, train_loss: 0.5508, train_clustering_loss:  0.5615, train_error: 0.2336
class 0: acc 0.7918367346938775, correct 194/245
class 1: acc 0.6911196911196911, correct 179/259
class 2: acc 0.8215767634854771, correct 198/241

Val Set, val_loss: 0.9338, val_error: 0.4043, auc: 0.8380
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.13829787234042554: correct 104/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0875, instance_loss: 0.4952, weighted_loss: 0.2098, label: 1, bag_size: 6025
batch 39, loss: 0.1385, instance_loss: 0.2988, weighted_loss: 0.1866, label: 0, bag_size: 5036
batch 59, loss: 0.7792, instance_loss: 0.6670, weighted_loss: 0.7455, label: 1, bag_size: 2671
batch 79, loss: 0.8005, instance_loss: 0.6397, weighted_loss: 0.7522, label: 2, bag_size: 4096
batch 99, loss: 0.0492, instance_loss: 0.1669, weighted_loss: 0.0845, label: 2, bag_size: 5138
batch 119, loss: 0.2359, instance_loss: 0.5571, weighted_loss: 0.3323, label: 2, bag_size: 2031
batch 139, loss: 0.0627, instance_loss: 0.2144, weighted_loss: 0.1082, label: 0, bag_size: 4577
batch 159, loss: 0.5817, instance_loss: 0.5050, weighted_loss: 0.5587, label: 2, bag_size: 7607
batch 179, loss: 0.0120, instance_loss: 0.2843, weighted_loss: 0.0937, label: 1, bag_size: 1836
batch 199, loss: 0.9545, instance_loss: 0.5151, weighted_loss: 0.8227, label: 2, bag_size: 3534
batch 219, loss: 0.0477, instance_loss: 0.6063, weighted_loss: 0.2152, label: 1, bag_size: 2453
batch 239, loss: 1.5620, instance_loss: 1.2083, weighted_loss: 1.4559, label: 1, bag_size: 1964
batch 259, loss: 0.0010, instance_loss: 0.5283, weighted_loss: 0.1592, label: 0, bag_size: 2306
batch 279, loss: 0.0359, instance_loss: 0.1339, weighted_loss: 0.0653, label: 2, bag_size: 4745
batch 299, loss: 0.1676, instance_loss: 0.3576, weighted_loss: 0.2246, label: 0, bag_size: 13540
batch 319, loss: 0.8622, instance_loss: 0.3765, weighted_loss: 0.7165, label: 2, bag_size: 2501
batch 339, loss: 0.0126, instance_loss: 0.2196, weighted_loss: 0.0747, label: 0, bag_size: 873
batch 359, loss: 0.1010, instance_loss: 0.2761, weighted_loss: 0.1535, label: 2, bag_size: 5011
batch 379, loss: 0.0682, instance_loss: 0.4095, weighted_loss: 0.1706, label: 1, bag_size: 3357
batch 399, loss: 0.0925, instance_loss: 0.4753, weighted_loss: 0.2074, label: 0, bag_size: 1417
batch 419, loss: 0.1859, instance_loss: 0.7664, weighted_loss: 0.3601, label: 1, bag_size: 4869
batch 439, loss: 0.2747, instance_loss: 0.6237, weighted_loss: 0.3794, label: 2, bag_size: 5472
batch 459, loss: 0.0513, instance_loss: 0.1219, weighted_loss: 0.0725, label: 0, bag_size: 2791
batch 479, loss: 0.6717, instance_loss: 0.8016, weighted_loss: 0.7107, label: 1, bag_size: 2671
batch 499, loss: 0.9417, instance_loss: 0.8598, weighted_loss: 0.9171, label: 1, bag_size: 5572
batch 519, loss: 0.0294, instance_loss: 0.1508, weighted_loss: 0.0658, label: 0, bag_size: 5282
batch 539, loss: 1.0992, instance_loss: 0.5409, weighted_loss: 0.9317, label: 2, bag_size: 6644
batch 559, loss: 1.2001, instance_loss: 0.9222, weighted_loss: 1.1167, label: 2, bag_size: 4316
batch 579, loss: 0.0000, instance_loss: 0.8818, weighted_loss: 0.2646, label: 0, bag_size: 5017
batch 599, loss: 0.0130, instance_loss: 0.3133, weighted_loss: 0.1031, label: 2, bag_size: 5017
batch 619, loss: 2.0075, instance_loss: 0.8526, weighted_loss: 1.6610, label: 2, bag_size: 4571
batch 639, loss: 0.2996, instance_loss: 0.3163, weighted_loss: 0.3046, label: 2, bag_size: 3397
batch 659, loss: 0.4433, instance_loss: 0.3384, weighted_loss: 0.4119, label: 2, bag_size: 4140
batch 679, loss: 0.0518, instance_loss: 0.4069, weighted_loss: 0.1583, label: 2, bag_size: 5017
batch 699, loss: 0.0194, instance_loss: 0.6701, weighted_loss: 0.2146, label: 1, bag_size: 3475
batch 719, loss: 0.0931, instance_loss: 0.1969, weighted_loss: 0.1243, label: 0, bag_size: 3741
batch 739, loss: 0.2941, instance_loss: 0.2748, weighted_loss: 0.2883, label: 2, bag_size: 2209


class 0 clustering acc 0.9681767337807606: correct 17311/17880
class 1 clustering acc 0.3738255033557047: correct 2228/5960
Epoch: 28, train_loss: 0.5361, train_clustering_loss:  0.5440, train_error: 0.2510
class 0: acc 0.7713178294573644, correct 199/258
class 1: acc 0.6621621621621622, correct 147/222
class 2: acc 0.8, correct 212/265

Val Set, val_loss: 0.7041, val_error: 0.3511, auc: 0.8589
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.29521276595744683: correct 222/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0294, instance_loss: 0.3738, weighted_loss: 0.1327, label: 1, bag_size: 440
batch 39, loss: 0.1486, instance_loss: 0.1852, weighted_loss: 0.1596, label: 0, bag_size: 4994
batch 59, loss: 0.0137, instance_loss: 0.1678, weighted_loss: 0.0599, label: 2, bag_size: 5037
batch 79, loss: 0.0786, instance_loss: 0.4503, weighted_loss: 0.1901, label: 1, bag_size: 3586
batch 99, loss: 0.1610, instance_loss: 0.3395, weighted_loss: 0.2145, label: 0, bag_size: 2601
batch 119, loss: 0.2463, instance_loss: 0.6538, weighted_loss: 0.3686, label: 0, bag_size: 4808
batch 139, loss: 0.0087, instance_loss: 0.0801, weighted_loss: 0.0301, label: 2, bag_size: 2483
batch 159, loss: 0.0502, instance_loss: 0.3309, weighted_loss: 0.1344, label: 1, bag_size: 425
batch 179, loss: 0.0343, instance_loss: 0.1533, weighted_loss: 0.0700, label: 2, bag_size: 5138
batch 199, loss: 0.5261, instance_loss: 0.4255, weighted_loss: 0.4959, label: 2, bag_size: 3534
batch 219, loss: 1.3187, instance_loss: 0.8187, weighted_loss: 1.1687, label: 1, bag_size: 2751
batch 239, loss: 1.6185, instance_loss: 0.5251, weighted_loss: 1.2904, label: 2, bag_size: 4140
batch 259, loss: 0.4157, instance_loss: 0.4350, weighted_loss: 0.4215, label: 0, bag_size: 2428
batch 279, loss: 0.2912, instance_loss: 0.3866, weighted_loss: 0.3198, label: 0, bag_size: 2378
batch 299, loss: 0.1962, instance_loss: 0.4601, weighted_loss: 0.2754, label: 2, bag_size: 3618
batch 319, loss: 2.9374, instance_loss: 0.9678, weighted_loss: 2.3466, label: 0, bag_size: 3830
batch 339, loss: 0.0881, instance_loss: 0.3359, weighted_loss: 0.1624, label: 2, bag_size: 1543
batch 359, loss: 0.9095, instance_loss: 0.7955, weighted_loss: 0.8753, label: 1, bag_size: 4467
batch 379, loss: 0.6170, instance_loss: 0.3372, weighted_loss: 0.5331, label: 2, bag_size: 3172
batch 399, loss: 0.2072, instance_loss: 0.5799, weighted_loss: 0.3190, label: 1, bag_size: 5003
batch 419, loss: 0.2196, instance_loss: 0.4456, weighted_loss: 0.2874, label: 0, bag_size: 3797
batch 439, loss: 4.4373, instance_loss: 0.9476, weighted_loss: 3.3904, label: 0, bag_size: 12971
batch 459, loss: 0.2866, instance_loss: 0.1739, weighted_loss: 0.2528, label: 2, bag_size: 3583
batch 479, loss: 0.0554, instance_loss: 0.4201, weighted_loss: 0.1648, label: 0, bag_size: 5837
batch 499, loss: 0.9997, instance_loss: 0.8573, weighted_loss: 0.9570, label: 1, bag_size: 5197
batch 519, loss: 0.4377, instance_loss: 0.4428, weighted_loss: 0.4393, label: 0, bag_size: 14218
batch 539, loss: 0.6353, instance_loss: 1.2310, weighted_loss: 0.8140, label: 1, bag_size: 5205
batch 559, loss: 0.6998, instance_loss: 0.3139, weighted_loss: 0.5840, label: 2, bag_size: 3026
batch 579, loss: 0.0623, instance_loss: 0.1753, weighted_loss: 0.0962, label: 2, bag_size: 2905
batch 599, loss: 0.6618, instance_loss: 1.0913, weighted_loss: 0.7907, label: 1, bag_size: 5035
batch 619, loss: 0.0921, instance_loss: 0.3197, weighted_loss: 0.1604, label: 0, bag_size: 1545
batch 639, loss: 1.6451, instance_loss: 0.7330, weighted_loss: 1.3714, label: 0, bag_size: 3387
batch 659, loss: 0.0901, instance_loss: 0.1248, weighted_loss: 0.1005, label: 2, bag_size: 597
batch 679, loss: 0.1054, instance_loss: 0.2242, weighted_loss: 0.1411, label: 2, bag_size: 3778
batch 699, loss: 0.3634, instance_loss: 0.6034, weighted_loss: 0.4354, label: 2, bag_size: 5406
batch 719, loss: 0.0220, instance_loss: 0.3308, weighted_loss: 0.1146, label: 1, bag_size: 3611
batch 739, loss: 1.5787, instance_loss: 1.2520, weighted_loss: 1.4807, label: 2, bag_size: 361


class 0 clustering acc 0.9694630872483222: correct 17334/17880
class 1 clustering acc 0.3773489932885906: correct 2249/5960
Epoch: 29, train_loss: 0.5092, train_clustering_loss:  0.5327, train_error: 0.1946
class 0: acc 0.8299595141700404, correct 205/247
class 1: acc 0.728, correct 182/250
class 2: acc 0.8588709677419355, correct 213/248

Val Set, val_loss: 0.7507, val_error: 0.3191, auc: 0.8602
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.32180851063829785: correct 242/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0795, instance_loss: 0.2423, weighted_loss: 0.1283, label: 2, bag_size: 2359
batch 39, loss: 0.8593, instance_loss: 1.2148, weighted_loss: 0.9659, label: 1, bag_size: 3791
batch 59, loss: 1.0861, instance_loss: 0.5232, weighted_loss: 0.9173, label: 2, bag_size: 5637
batch 79, loss: 0.0363, instance_loss: 0.1757, weighted_loss: 0.0781, label: 0, bag_size: 4827
batch 99, loss: 0.0018, instance_loss: 0.2274, weighted_loss: 0.0695, label: 1, bag_size: 3533
batch 119, loss: 0.2116, instance_loss: 0.4007, weighted_loss: 0.2684, label: 2, bag_size: 597
batch 139, loss: 0.0522, instance_loss: 0.2096, weighted_loss: 0.0994, label: 1, bag_size: 2009
batch 159, loss: 0.3730, instance_loss: 0.4539, weighted_loss: 0.3973, label: 0, bag_size: 4946
batch 179, loss: 2.1114, instance_loss: 0.8374, weighted_loss: 1.7292, label: 1, bag_size: 3438
batch 199, loss: 0.3904, instance_loss: 0.3761, weighted_loss: 0.3861, label: 2, bag_size: 705
batch 219, loss: 0.1682, instance_loss: 0.3218, weighted_loss: 0.2143, label: 0, bag_size: 3344
batch 239, loss: 1.2698, instance_loss: 0.7911, weighted_loss: 1.1262, label: 1, bag_size: 368
batch 259, loss: 0.0232, instance_loss: 0.3332, weighted_loss: 0.1162, label: 0, bag_size: 1204
batch 279, loss: 0.3847, instance_loss: 0.4114, weighted_loss: 0.3927, label: 2, bag_size: 5637
batch 299, loss: 0.8659, instance_loss: 0.5328, weighted_loss: 0.7659, label: 2, bag_size: 3227
batch 319, loss: 0.7486, instance_loss: 0.5450, weighted_loss: 0.6875, label: 0, bag_size: 14218
batch 339, loss: 1.3081, instance_loss: 0.8252, weighted_loss: 1.1632, label: 0, bag_size: 35080
batch 359, loss: 3.1813, instance_loss: 1.1835, weighted_loss: 2.5820, label: 1, bag_size: 1542
batch 379, loss: 1.1879, instance_loss: 0.8022, weighted_loss: 1.0722, label: 2, bag_size: 2486
batch 399, loss: 0.5306, instance_loss: 0.3745, weighted_loss: 0.4838, label: 0, bag_size: 6015
batch 419, loss: 0.6374, instance_loss: 0.9459, weighted_loss: 0.7300, label: 0, bag_size: 889
batch 439, loss: 0.1081, instance_loss: 0.2331, weighted_loss: 0.1456, label: 0, bag_size: 5041
batch 459, loss: 0.4136, instance_loss: 0.5149, weighted_loss: 0.4440, label: 0, bag_size: 5041
batch 479, loss: 2.4973, instance_loss: 1.1127, weighted_loss: 2.0819, label: 0, bag_size: 20234
batch 499, loss: 0.2671, instance_loss: 0.3005, weighted_loss: 0.2771, label: 0, bag_size: 4131
batch 519, loss: 0.0112, instance_loss: 0.1292, weighted_loss: 0.0466, label: 2, bag_size: 4088
batch 539, loss: 0.2013, instance_loss: 0.4359, weighted_loss: 0.2717, label: 0, bag_size: 2853
batch 559, loss: 0.0348, instance_loss: 0.1195, weighted_loss: 0.0603, label: 1, bag_size: 862
batch 579, loss: 0.0519, instance_loss: 0.4356, weighted_loss: 0.1670, label: 0, bag_size: 4242
batch 599, loss: 0.4338, instance_loss: 0.6954, weighted_loss: 0.5123, label: 0, bag_size: 3341
batch 619, loss: 0.9274, instance_loss: 0.4535, weighted_loss: 0.7852, label: 2, bag_size: 3172
batch 639, loss: 0.4448, instance_loss: 0.4279, weighted_loss: 0.4397, label: 0, bag_size: 3033
batch 659, loss: 0.6570, instance_loss: 0.4793, weighted_loss: 0.6037, label: 0, bag_size: 726
batch 679, loss: 0.6069, instance_loss: 1.1563, weighted_loss: 0.7717, label: 1, bag_size: 936
batch 699, loss: 0.0055, instance_loss: 0.1867, weighted_loss: 0.0599, label: 0, bag_size: 4196
batch 719, loss: 0.0218, instance_loss: 0.1070, weighted_loss: 0.0474, label: 2, bag_size: 3176
batch 739, loss: 2.1818, instance_loss: 1.8056, weighted_loss: 2.0689, label: 1, bag_size: 3791


class 0 clustering acc 0.9662751677852349: correct 17277/17880
class 1 clustering acc 0.35553691275167787: correct 2119/5960
Epoch: 30, train_loss: 0.5418, train_clustering_loss:  0.5612, train_error: 0.2228
class 0: acc 0.8423076923076923, correct 219/260
class 1: acc 0.6626016260162602, correct 163/246
class 2: acc 0.8242677824267782, correct 197/239

Val Set, val_loss: 0.8412, val_error: 0.3617, auc: 0.8473
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.3377659574468085: correct 254/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0320, instance_loss: 0.2091, weighted_loss: 0.0851, label: 2, bag_size: 3080
batch 39, loss: 0.0584, instance_loss: 0.1660, weighted_loss: 0.0906, label: 2, bag_size: 4043
batch 59, loss: 1.5544, instance_loss: 0.5572, weighted_loss: 1.2553, label: 2, bag_size: 6644
batch 79, loss: 1.8361, instance_loss: 1.2288, weighted_loss: 1.6539, label: 0, bag_size: 3419
batch 99, loss: 0.0292, instance_loss: 0.1300, weighted_loss: 0.0595, label: 2, bag_size: 2483
batch 119, loss: 0.0194, instance_loss: 0.2233, weighted_loss: 0.0806, label: 2, bag_size: 5017
batch 139, loss: 0.4554, instance_loss: 0.7143, weighted_loss: 0.5331, label: 0, bag_size: 726
batch 159, loss: 0.2621, instance_loss: 0.3230, weighted_loss: 0.2804, label: 2, bag_size: 4043
batch 179, loss: 0.3898, instance_loss: 0.4093, weighted_loss: 0.3957, label: 1, bag_size: 2919
batch 199, loss: 0.5514, instance_loss: 0.5942, weighted_loss: 0.5642, label: 1, bag_size: 2747
batch 219, loss: 0.0127, instance_loss: 0.3298, weighted_loss: 0.1078, label: 1, bag_size: 4644
batch 239, loss: 1.7454, instance_loss: 1.1095, weighted_loss: 1.5546, label: 2, bag_size: 223
batch 259, loss: 0.0593, instance_loss: 0.3524, weighted_loss: 0.1472, label: 1, bag_size: 4644
batch 279, loss: 0.5766, instance_loss: 1.1157, weighted_loss: 0.7383, label: 1, bag_size: 3995
batch 299, loss: 0.2164, instance_loss: 0.5902, weighted_loss: 0.3285, label: 1, bag_size: 3051
batch 319, loss: 0.5010, instance_loss: 0.7721, weighted_loss: 0.5823, label: 2, bag_size: 3299
batch 339, loss: 0.6657, instance_loss: 0.6985, weighted_loss: 0.6756, label: 0, bag_size: 3833
batch 359, loss: 0.8046, instance_loss: 0.4606, weighted_loss: 0.7014, label: 0, bag_size: 5098
batch 379, loss: 1.2963, instance_loss: 0.9800, weighted_loss: 1.2014, label: 1, bag_size: 6993
batch 399, loss: 0.0029, instance_loss: 0.1897, weighted_loss: 0.0589, label: 2, bag_size: 4140
batch 419, loss: 4.9754, instance_loss: 1.7154, weighted_loss: 3.9974, label: 0, bag_size: 4605
batch 439, loss: 0.2581, instance_loss: 0.6184, weighted_loss: 0.3662, label: 1, bag_size: 5532
batch 459, loss: 0.0142, instance_loss: 0.2556, weighted_loss: 0.0866, label: 0, bag_size: 3754
batch 479, loss: 0.9787, instance_loss: 0.6024, weighted_loss: 0.8658, label: 0, bag_size: 16741
batch 499, loss: 0.0006, instance_loss: 0.3329, weighted_loss: 0.1003, label: 1, bag_size: 3338
batch 519, loss: 0.3670, instance_loss: 0.4493, weighted_loss: 0.3916, label: 0, bag_size: 4325
batch 539, loss: 0.2552, instance_loss: 0.6771, weighted_loss: 0.3817, label: 1, bag_size: 5340
batch 559, loss: 0.4735, instance_loss: 0.3786, weighted_loss: 0.4450, label: 2, bag_size: 3026
batch 579, loss: 0.3696, instance_loss: 0.4918, weighted_loss: 0.4063, label: 1, bag_size: 2671
batch 599, loss: 0.4849, instance_loss: 0.3851, weighted_loss: 0.4550, label: 1, bag_size: 5693
batch 619, loss: 0.3410, instance_loss: 0.4944, weighted_loss: 0.3870, label: 2, bag_size: 2359
batch 639, loss: 2.8030, instance_loss: 1.3596, weighted_loss: 2.3700, label: 0, bag_size: 7219
batch 659, loss: 0.0338, instance_loss: 0.1007, weighted_loss: 0.0539, label: 2, bag_size: 4856
batch 679, loss: 0.1600, instance_loss: 0.1633, weighted_loss: 0.1610, label: 1, bag_size: 1410
batch 699, loss: 0.3394, instance_loss: 0.5052, weighted_loss: 0.3891, label: 0, bag_size: 3408
batch 719, loss: 0.4522, instance_loss: 0.6164, weighted_loss: 0.5015, label: 0, bag_size: 3245
batch 739, loss: 1.9568, instance_loss: 0.9522, weighted_loss: 1.6554, label: 0, bag_size: 15105


class 0 clustering acc 0.9672259507829978: correct 17294/17880
class 1 clustering acc 0.39630872483221474: correct 2362/5960
Epoch: 31, train_loss: 0.5205, train_clustering_loss:  0.5286, train_error: 0.2121
class 0: acc 0.777292576419214, correct 178/229
class 1: acc 0.7556390977443609, correct 201/266
class 2: acc 0.832, correct 208/250

Val Set, val_loss: 0.6342, val_error: 0.2872, auc: 0.8788
class 0 clustering acc 0.9534574468085106: correct 2151/2256
class 1 clustering acc 0.3816489361702128: correct 287/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.647054 --> 0.634181).  Saving model ...


batch 19, loss: 0.4134, instance_loss: 0.8468, weighted_loss: 0.5434, label: 1, bag_size: 6156
batch 39, loss: 0.8518, instance_loss: 0.5589, weighted_loss: 0.7639, label: 2, bag_size: 4241
batch 59, loss: 0.0753, instance_loss: 0.1875, weighted_loss: 0.1089, label: 0, bag_size: 3855
batch 79, loss: 0.0748, instance_loss: 0.4832, weighted_loss: 0.1973, label: 1, bag_size: 7135
batch 99, loss: 0.0102, instance_loss: 0.2151, weighted_loss: 0.0716, label: 1, bag_size: 3983
batch 119, loss: 0.0113, instance_loss: 0.1592, weighted_loss: 0.0556, label: 1, bag_size: 8802
batch 139, loss: 0.0563, instance_loss: 0.2768, weighted_loss: 0.1225, label: 2, bag_size: 5017
batch 159, loss: 0.0652, instance_loss: 0.2380, weighted_loss: 0.1170, label: 0, bag_size: 3690
batch 179, loss: 0.1902, instance_loss: 0.6933, weighted_loss: 0.3411, label: 0, bag_size: 4070
batch 199, loss: 0.1725, instance_loss: 0.3471, weighted_loss: 0.2249, label: 2, bag_size: 5011
batch 219, loss: 3.5801, instance_loss: 1.1400, weighted_loss: 2.8480, label: 0, bag_size: 3830
batch 239, loss: 0.5802, instance_loss: 1.0961, weighted_loss: 0.7349, label: 2, bag_size: 4571
batch 259, loss: 0.1772, instance_loss: 0.3626, weighted_loss: 0.2328, label: 0, bag_size: 1655
batch 279, loss: 0.7868, instance_loss: 0.6432, weighted_loss: 0.7437, label: 0, bag_size: 1025
batch 299, loss: 0.6804, instance_loss: 1.1953, weighted_loss: 0.8348, label: 0, bag_size: 4351
batch 319, loss: 0.0147, instance_loss: 0.0733, weighted_loss: 0.0322, label: 2, bag_size: 6001
batch 339, loss: 0.9544, instance_loss: 0.9641, weighted_loss: 0.9573, label: 0, bag_size: 3310
batch 359, loss: 0.1534, instance_loss: 0.5305, weighted_loss: 0.2665, label: 2, bag_size: 5472
batch 379, loss: 0.5492, instance_loss: 0.6568, weighted_loss: 0.5815, label: 1, bag_size: 3396
batch 399, loss: 0.2186, instance_loss: 0.3314, weighted_loss: 0.2524, label: 0, bag_size: 4228
batch 419, loss: 0.0245, instance_loss: 0.2147, weighted_loss: 0.0816, label: 2, bag_size: 4856
batch 439, loss: 0.4483, instance_loss: 0.7321, weighted_loss: 0.5335, label: 2, bag_size: 6644
batch 459, loss: 0.0747, instance_loss: 0.2495, weighted_loss: 0.1271, label: 2, bag_size: 4978
batch 479, loss: 0.0119, instance_loss: 0.3672, weighted_loss: 0.1185, label: 1, bag_size: 3333
batch 499, loss: 1.9548, instance_loss: 1.1626, weighted_loss: 1.7171, label: 1, bag_size: 2481
batch 519, loss: 0.1215, instance_loss: 0.1660, weighted_loss: 0.1349, label: 2, bag_size: 2049
batch 539, loss: 0.0070, instance_loss: 0.3148, weighted_loss: 0.0993, label: 2, bag_size: 5037
batch 559, loss: 0.2737, instance_loss: 0.4777, weighted_loss: 0.3349, label: 0, bag_size: 4282
batch 579, loss: 0.6689, instance_loss: 0.8147, weighted_loss: 0.7126, label: 2, bag_size: 6594
batch 599, loss: 0.1306, instance_loss: 0.5215, weighted_loss: 0.2479, label: 0, bag_size: 4529
batch 619, loss: 0.5512, instance_loss: 0.9025, weighted_loss: 0.6566, label: 1, bag_size: 1510
batch 639, loss: 0.3297, instance_loss: 0.9906, weighted_loss: 0.5280, label: 1, bag_size: 1510
batch 659, loss: 0.1613, instance_loss: 0.1500, weighted_loss: 0.1579, label: 2, bag_size: 4788
batch 679, loss: 0.0426, instance_loss: 0.3130, weighted_loss: 0.1237, label: 0, bag_size: 3901
batch 699, loss: 0.1726, instance_loss: 0.4851, weighted_loss: 0.2663, label: 2, bag_size: 4096
batch 719, loss: 0.8824, instance_loss: 0.7245, weighted_loss: 0.8350, label: 1, bag_size: 574
batch 739, loss: 3.7329, instance_loss: 2.0049, weighted_loss: 3.2145, label: 1, bag_size: 3399


class 0 clustering acc 0.9634228187919464: correct 17226/17880
class 1 clustering acc 0.43456375838926176: correct 2590/5960
Epoch: 32, train_loss: 0.4683, train_clustering_loss:  0.5167, train_error: 0.1946
class 0: acc 0.8589211618257261, correct 207/241
class 1: acc 0.6711711711711712, correct 149/222
class 2: acc 0.8652482269503546, correct 244/282

Val Set, val_loss: 0.7595, val_error: 0.3085, auc: 0.8668
class 0 clustering acc 0.9565602836879432: correct 2158/2256
class 1 clustering acc 0.31648936170212766: correct 238/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7470, instance_loss: 0.4314, weighted_loss: 0.6523, label: 0, bag_size: 5837
batch 39, loss: 0.3366, instance_loss: 0.5315, weighted_loss: 0.3951, label: 2, bag_size: 3618
batch 59, loss: 0.0644, instance_loss: 0.0964, weighted_loss: 0.0740, label: 0, bag_size: 5757
batch 79, loss: 0.1063, instance_loss: 0.3012, weighted_loss: 0.1648, label: 2, bag_size: 3396
batch 99, loss: 0.0478, instance_loss: 0.9997, weighted_loss: 0.3334, label: 0, bag_size: 3539
batch 119, loss: 2.4098, instance_loss: 1.5246, weighted_loss: 2.1442, label: 1, bag_size: 3508
batch 139, loss: 0.3161, instance_loss: 0.3097, weighted_loss: 0.3142, label: 0, bag_size: 5526
batch 159, loss: 0.4112, instance_loss: 0.6188, weighted_loss: 0.4735, label: 1, bag_size: 1066
batch 179, loss: 1.7533, instance_loss: 1.4740, weighted_loss: 1.6695, label: 1, bag_size: 1097
batch 199, loss: 0.0226, instance_loss: 0.2946, weighted_loss: 0.1042, label: 1, bag_size: 1836
batch 219, loss: 0.9336, instance_loss: 0.8121, weighted_loss: 0.8971, label: 1, bag_size: 2751
batch 239, loss: 0.0218, instance_loss: 0.1091, weighted_loss: 0.0480, label: 2, bag_size: 3121
batch 259, loss: 0.0101, instance_loss: 0.3476, weighted_loss: 0.1114, label: 2, bag_size: 2422
batch 279, loss: 0.5122, instance_loss: 0.6664, weighted_loss: 0.5585, label: 1, bag_size: 4708
batch 299, loss: 0.0822, instance_loss: 0.2922, weighted_loss: 0.1452, label: 1, bag_size: 3265
batch 319, loss: 1.1084, instance_loss: 1.2424, weighted_loss: 1.1486, label: 1, bag_size: 5205
batch 339, loss: 0.5903, instance_loss: 1.1317, weighted_loss: 0.7527, label: 1, bag_size: 7109
batch 359, loss: 0.0020, instance_loss: 0.1759, weighted_loss: 0.0542, label: 1, bag_size: 1836
batch 379, loss: 0.8483, instance_loss: 0.9925, weighted_loss: 0.8916, label: 0, bag_size: 6445
batch 399, loss: 0.0357, instance_loss: 0.5501, weighted_loss: 0.1900, label: 0, bag_size: 3601
batch 419, loss: 0.2692, instance_loss: 0.3728, weighted_loss: 0.3003, label: 2, bag_size: 2481
batch 439, loss: 0.0466, instance_loss: 0.4794, weighted_loss: 0.1764, label: 1, bag_size: 3051
batch 459, loss: 0.4411, instance_loss: 0.4528, weighted_loss: 0.4446, label: 0, bag_size: 5871
batch 479, loss: 0.0123, instance_loss: 0.3021, weighted_loss: 0.0992, label: 0, bag_size: 966
batch 499, loss: 0.1924, instance_loss: 0.3777, weighted_loss: 0.2480, label: 2, bag_size: 4745
batch 519, loss: 0.2452, instance_loss: 0.5060, weighted_loss: 0.3235, label: 2, bag_size: 3618
batch 539, loss: 1.1226, instance_loss: 1.5497, weighted_loss: 1.2508, label: 1, bag_size: 1608
batch 559, loss: 0.4973, instance_loss: 0.7518, weighted_loss: 0.5736, label: 1, bag_size: 7109
batch 579, loss: 0.0824, instance_loss: 0.5013, weighted_loss: 0.2080, label: 1, bag_size: 6513
batch 599, loss: 0.8377, instance_loss: 0.4571, weighted_loss: 0.7236, label: 2, bag_size: 3227
batch 619, loss: 1.5121, instance_loss: 0.9727, weighted_loss: 1.3503, label: 0, bag_size: 2579
batch 639, loss: 0.3078, instance_loss: 0.4940, weighted_loss: 0.3636, label: 1, bag_size: 2859
batch 659, loss: 0.0738, instance_loss: 0.4869, weighted_loss: 0.1977, label: 0, bag_size: 1611
batch 679, loss: 0.1111, instance_loss: 0.6305, weighted_loss: 0.2670, label: 0, bag_size: 1933
batch 699, loss: 0.6231, instance_loss: 0.6352, weighted_loss: 0.6268, label: 1, bag_size: 4395
batch 719, loss: 0.9205, instance_loss: 0.8348, weighted_loss: 0.8948, label: 2, bag_size: 552
batch 739, loss: 0.2242, instance_loss: 0.9966, weighted_loss: 0.4559, label: 2, bag_size: 3299


class 0 clustering acc 0.962248322147651: correct 17205/17880
class 1 clustering acc 0.4140939597315436: correct 2468/5960
Epoch: 33, train_loss: 0.4416, train_clustering_loss:  0.5301, train_error: 0.1732
class 0: acc 0.8181818181818182, correct 189/231
class 1: acc 0.7769230769230769, correct 202/260
class 2: acc 0.8858267716535433, correct 225/254

Val Set, val_loss: 0.6828, val_error: 0.3085, auc: 0.8656
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.3271276595744681: correct 246/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2775, instance_loss: 0.3663, weighted_loss: 0.3041, label: 0, bag_size: 5340
batch 39, loss: 0.0301, instance_loss: 0.5129, weighted_loss: 0.1749, label: 1, bag_size: 5084
batch 59, loss: 0.5688, instance_loss: 0.6747, weighted_loss: 0.6006, label: 0, bag_size: 4460
batch 79, loss: 0.1442, instance_loss: 0.2958, weighted_loss: 0.1897, label: 2, bag_size: 3397
batch 99, loss: 0.0171, instance_loss: 0.4404, weighted_loss: 0.1441, label: 0, bag_size: 1812
batch 119, loss: 0.0438, instance_loss: 0.1313, weighted_loss: 0.0701, label: 0, bag_size: 4855
batch 139, loss: 0.0877, instance_loss: 0.3058, weighted_loss: 0.1532, label: 0, bag_size: 5036
batch 159, loss: 0.0154, instance_loss: 0.3699, weighted_loss: 0.1218, label: 1, bag_size: 5385
batch 179, loss: 0.8732, instance_loss: 0.6407, weighted_loss: 0.8035, label: 2, bag_size: 4571
batch 199, loss: 0.0023, instance_loss: 0.3077, weighted_loss: 0.0939, label: 2, bag_size: 5037
batch 219, loss: 1.0709, instance_loss: 0.8701, weighted_loss: 1.0106, label: 2, bag_size: 22464
batch 239, loss: 0.4175, instance_loss: 0.6303, weighted_loss: 0.4813, label: 0, bag_size: 3344
batch 259, loss: 0.3371, instance_loss: 0.5623, weighted_loss: 0.4047, label: 1, bag_size: 6152
batch 279, loss: 1.4758, instance_loss: 1.1899, weighted_loss: 1.3900, label: 0, bag_size: 20234
batch 299, loss: 0.6143, instance_loss: 0.8258, weighted_loss: 0.6777, label: 1, bag_size: 7109
batch 319, loss: 0.5189, instance_loss: 0.5537, weighted_loss: 0.5293, label: 0, bag_size: 1174
batch 339, loss: 2.7562, instance_loss: 1.1131, weighted_loss: 2.2632, label: 1, bag_size: 32
batch 359, loss: 0.1871, instance_loss: 0.5179, weighted_loss: 0.2863, label: 2, bag_size: 4141
batch 379, loss: 0.0086, instance_loss: 0.0737, weighted_loss: 0.0282, label: 0, bag_size: 1845
batch 399, loss: 0.0059, instance_loss: 0.1961, weighted_loss: 0.0629, label: 0, bag_size: 3438
batch 419, loss: 0.1048, instance_loss: 0.2045, weighted_loss: 0.1347, label: 0, bag_size: 3855
batch 439, loss: 0.0421, instance_loss: 0.2835, weighted_loss: 0.1145, label: 0, bag_size: 4914
batch 459, loss: 0.9673, instance_loss: 0.6853, weighted_loss: 0.8827, label: 1, bag_size: 4784
batch 479, loss: 0.7832, instance_loss: 0.5680, weighted_loss: 0.7187, label: 0, bag_size: 3224
batch 499, loss: 0.0378, instance_loss: 0.2020, weighted_loss: 0.0870, label: 2, bag_size: 3121
batch 519, loss: 0.0505, instance_loss: 0.2841, weighted_loss: 0.1205, label: 2, bag_size: 4141
batch 539, loss: 1.2464, instance_loss: 0.7756, weighted_loss: 1.1051, label: 2, bag_size: 5406
batch 559, loss: 0.6698, instance_loss: 0.4380, weighted_loss: 0.6002, label: 0, bag_size: 14070
batch 579, loss: 0.0046, instance_loss: 0.1070, weighted_loss: 0.0353, label: 0, bag_size: 4300
batch 599, loss: 0.9331, instance_loss: 0.8364, weighted_loss: 0.9041, label: 2, bag_size: 4316
batch 619, loss: 0.0002, instance_loss: 0.1832, weighted_loss: 0.0551, label: 1, bag_size: 3338
batch 639, loss: 0.7092, instance_loss: 1.4330, weighted_loss: 0.9263, label: 1, bag_size: 3791
batch 659, loss: 0.1106, instance_loss: 0.2431, weighted_loss: 0.1504, label: 2, bag_size: 2254
batch 679, loss: 1.2471, instance_loss: 0.7320, weighted_loss: 1.0926, label: 1, bag_size: 5084
batch 699, loss: 1.4517, instance_loss: 1.2600, weighted_loss: 1.3942, label: 1, bag_size: 1580
batch 719, loss: 0.0435, instance_loss: 0.1732, weighted_loss: 0.0824, label: 0, bag_size: 6430
batch 739, loss: 0.0192, instance_loss: 0.6922, weighted_loss: 0.2211, label: 2, bag_size: 2031


class 0 clustering acc 0.9662192393736018: correct 17276/17880
class 1 clustering acc 0.363758389261745: correct 2168/5960
Epoch: 34, train_loss: 0.4971, train_clustering_loss:  0.5398, train_error: 0.1960
class 0: acc 0.8482490272373541, correct 218/257
class 1: acc 0.7349397590361446, correct 183/249
class 2: acc 0.8284518828451883, correct 198/239

Val Set, val_loss: 0.6843, val_error: 0.2766, auc: 0.8669
class 0 clustering acc 0.9321808510638298: correct 2103/2256
class 1 clustering acc 0.4175531914893617: correct 314/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4392, instance_loss: 0.5320, weighted_loss: 0.4671, label: 2, bag_size: 3618
batch 39, loss: 0.5685, instance_loss: 0.3742, weighted_loss: 0.5102, label: 0, bag_size: 4450
batch 59, loss: 0.0204, instance_loss: 0.1016, weighted_loss: 0.0448, label: 0, bag_size: 4741
batch 79, loss: 0.2444, instance_loss: 0.5852, weighted_loss: 0.3467, label: 2, bag_size: 1050
batch 99, loss: 0.4877, instance_loss: 0.7649, weighted_loss: 0.5709, label: 2, bag_size: 6594
batch 119, loss: 0.0691, instance_loss: 0.2197, weighted_loss: 0.1143, label: 2, bag_size: 4096
batch 139, loss: 0.1974, instance_loss: 0.3657, weighted_loss: 0.2479, label: 0, bag_size: 5915
batch 159, loss: 0.1490, instance_loss: 0.2252, weighted_loss: 0.1719, label: 0, bag_size: 4734
batch 179, loss: 1.1151, instance_loss: 0.7424, weighted_loss: 1.0033, label: 1, bag_size: 6993
batch 199, loss: 2.6976, instance_loss: 1.1294, weighted_loss: 2.2271, label: 0, bag_size: 19216
batch 219, loss: 2.0224, instance_loss: 0.8550, weighted_loss: 1.6722, label: 1, bag_size: 32
batch 239, loss: 0.0000, instance_loss: 0.0168, weighted_loss: 0.0051, label: 0, bag_size: 1106
batch 259, loss: 1.1937, instance_loss: 1.0394, weighted_loss: 1.1474, label: 1, bag_size: 5035
batch 279, loss: 1.7336, instance_loss: 1.3154, weighted_loss: 1.6081, label: 1, bag_size: 6942
batch 299, loss: 3.3736, instance_loss: 1.3249, weighted_loss: 2.7590, label: 0, bag_size: 1420
batch 319, loss: 0.0837, instance_loss: 0.2315, weighted_loss: 0.1281, label: 0, bag_size: 4734
batch 339, loss: 1.4071, instance_loss: 0.6766, weighted_loss: 1.1879, label: 0, bag_size: 5848
batch 359, loss: 0.0414, instance_loss: 0.2697, weighted_loss: 0.1099, label: 0, bag_size: 3924
batch 379, loss: 0.0366, instance_loss: 0.7482, weighted_loss: 0.2501, label: 1, bag_size: 3640
batch 399, loss: 0.5336, instance_loss: 0.5918, weighted_loss: 0.5511, label: 1, bag_size: 1500
batch 419, loss: 0.7852, instance_loss: 0.6679, weighted_loss: 0.7500, label: 0, bag_size: 3310
batch 439, loss: 0.2670, instance_loss: 0.4385, weighted_loss: 0.3184, label: 0, bag_size: 3883
batch 459, loss: 0.3313, instance_loss: 0.6813, weighted_loss: 0.4363, label: 0, bag_size: 4220
batch 479, loss: 2.6082, instance_loss: 1.3997, weighted_loss: 2.2456, label: 2, bag_size: 3475
batch 499, loss: 0.2398, instance_loss: 0.5383, weighted_loss: 0.3293, label: 2, bag_size: 3274
batch 519, loss: 0.0876, instance_loss: 0.5883, weighted_loss: 0.2378, label: 1, bag_size: 4869
batch 539, loss: 0.0489, instance_loss: 0.2259, weighted_loss: 0.1020, label: 0, bag_size: 4741
batch 559, loss: 1.7184, instance_loss: 0.9861, weighted_loss: 1.4987, label: 1, bag_size: 4395
batch 579, loss: 0.2716, instance_loss: 0.5274, weighted_loss: 0.3484, label: 2, bag_size: 724
batch 599, loss: 0.0130, instance_loss: 0.1148, weighted_loss: 0.0435, label: 2, bag_size: 3094
batch 619, loss: 2.1467, instance_loss: 1.1749, weighted_loss: 1.8551, label: 2, bag_size: 22464
batch 639, loss: 0.3533, instance_loss: 0.7284, weighted_loss: 0.4659, label: 2, bag_size: 3274
batch 659, loss: 0.4795, instance_loss: 0.8243, weighted_loss: 0.5829, label: 2, bag_size: 5072
batch 679, loss: 0.0138, instance_loss: 0.1259, weighted_loss: 0.0474, label: 0, bag_size: 4644
batch 699, loss: 0.1584, instance_loss: 0.4459, weighted_loss: 0.2447, label: 0, bag_size: 313
batch 719, loss: 0.0107, instance_loss: 0.1512, weighted_loss: 0.0529, label: 0, bag_size: 2290
batch 739, loss: 0.9906, instance_loss: 0.8233, weighted_loss: 0.9404, label: 1, bag_size: 3813


class 0 clustering acc 0.9652125279642059: correct 17258/17880
class 1 clustering acc 0.37651006711409396: correct 2244/5960
Epoch: 35, train_loss: 0.5385, train_clustering_loss:  0.5440, train_error: 0.2188
class 0: acc 0.8032128514056225, correct 200/249
class 1: acc 0.698744769874477, correct 167/239
class 2: acc 0.8365758754863813, correct 215/257

Val Set, val_loss: 0.7256, val_error: 0.2979, auc: 0.8745
class 0 clustering acc 0.925531914893617: correct 2088/2256
class 1 clustering acc 0.43617021276595747: correct 328/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8743, instance_loss: 0.6859, weighted_loss: 0.8178, label: 1, bag_size: 2919
batch 39, loss: 0.2454, instance_loss: 0.5462, weighted_loss: 0.3356, label: 2, bag_size: 3778
batch 59, loss: 0.2285, instance_loss: 0.4865, weighted_loss: 0.3059, label: 0, bag_size: 3833
batch 79, loss: 0.0411, instance_loss: 0.6206, weighted_loss: 0.2149, label: 1, bag_size: 3460
batch 99, loss: 0.9956, instance_loss: 0.6227, weighted_loss: 0.8837, label: 1, bag_size: 3106
batch 119, loss: 0.1328, instance_loss: 0.3753, weighted_loss: 0.2055, label: 1, bag_size: 1027
batch 139, loss: 0.9946, instance_loss: 0.5465, weighted_loss: 0.8601, label: 2, bag_size: 3112
batch 159, loss: 0.2077, instance_loss: 0.4894, weighted_loss: 0.2922, label: 0, bag_size: 5377
batch 179, loss: 1.0875, instance_loss: 0.7494, weighted_loss: 0.9860, label: 1, bag_size: 4438
batch 199, loss: 0.0006, instance_loss: 0.5515, weighted_loss: 0.1659, label: 2, bag_size: 2031
batch 219, loss: 0.9335, instance_loss: 0.7337, weighted_loss: 0.8735, label: 1, bag_size: 2342
batch 239, loss: 0.4094, instance_loss: 0.4908, weighted_loss: 0.4338, label: 2, bag_size: 3397
batch 259, loss: 0.0192, instance_loss: 0.1467, weighted_loss: 0.0574, label: 2, bag_size: 2254
batch 279, loss: 1.4136, instance_loss: 0.9740, weighted_loss: 1.2817, label: 1, bag_size: 6025
batch 299, loss: 0.8058, instance_loss: 0.8659, weighted_loss: 0.8239, label: 0, bag_size: 3871
batch 319, loss: 0.7811, instance_loss: 0.8605, weighted_loss: 0.8049, label: 0, bag_size: 4274
batch 339, loss: 0.1903, instance_loss: 0.4896, weighted_loss: 0.2801, label: 2, bag_size: 1543
batch 359, loss: 2.1467, instance_loss: 1.1004, weighted_loss: 1.8328, label: 1, bag_size: 5423
batch 379, loss: 0.4437, instance_loss: 0.3082, weighted_loss: 0.4031, label: 2, bag_size: 3583
batch 399, loss: 0.1349, instance_loss: 0.3170, weighted_loss: 0.1895, label: 2, bag_size: 2905
batch 419, loss: 0.0600, instance_loss: 0.2989, weighted_loss: 0.1316, label: 2, bag_size: 88
batch 439, loss: 0.1365, instance_loss: 0.5087, weighted_loss: 0.2481, label: 2, bag_size: 88
batch 459, loss: 0.1395, instance_loss: 0.4267, weighted_loss: 0.2257, label: 1, bag_size: 5532
batch 479, loss: 0.4272, instance_loss: 0.3564, weighted_loss: 0.4059, label: 0, bag_size: 3915
batch 499, loss: 0.0000, instance_loss: 0.0018, weighted_loss: 0.0005, label: 0, bag_size: 1106
batch 519, loss: 0.7746, instance_loss: 0.6741, weighted_loss: 0.7444, label: 1, bag_size: 2859
batch 539, loss: 1.0195, instance_loss: 0.9554, weighted_loss: 1.0002, label: 1, bag_size: 8632
batch 559, loss: 0.3602, instance_loss: 0.3999, weighted_loss: 0.3721, label: 2, bag_size: 597
batch 579, loss: 0.1215, instance_loss: 0.2456, weighted_loss: 0.1587, label: 2, bag_size: 2049
batch 599, loss: 0.4941, instance_loss: 0.3489, weighted_loss: 0.4506, label: 2, bag_size: 2501
batch 619, loss: 0.0526, instance_loss: 0.3521, weighted_loss: 0.1425, label: 1, bag_size: 1836
batch 639, loss: 0.0511, instance_loss: 0.6910, weighted_loss: 0.2431, label: 1, bag_size: 3995
batch 659, loss: 0.0105, instance_loss: 0.2932, weighted_loss: 0.0953, label: 0, bag_size: 3268
batch 679, loss: 0.8110, instance_loss: 0.6921, weighted_loss: 0.7753, label: 0, bag_size: 7315
batch 699, loss: 0.6066, instance_loss: 0.5906, weighted_loss: 0.6018, label: 0, bag_size: 3525
batch 719, loss: 0.3697, instance_loss: 0.4900, weighted_loss: 0.4058, label: 2, bag_size: 3396
batch 739, loss: 0.5175, instance_loss: 0.5107, weighted_loss: 0.5154, label: 0, bag_size: 622


class 0 clustering acc 0.9667785234899329: correct 17286/17880
class 1 clustering acc 0.2828859060402685: correct 1686/5960
Epoch: 36, train_loss: 0.5679, train_clustering_loss:  0.5853, train_error: 0.2322
class 0: acc 0.7863247863247863, correct 184/234
class 1: acc 0.6811023622047244, correct 173/254
class 2: acc 0.8365758754863813, correct 215/257

Val Set, val_loss: 0.7670, val_error: 0.3404, auc: 0.8685
class 0 clustering acc 0.9574468085106383: correct 2160/2256
class 1 clustering acc 0.19414893617021275: correct 146/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0060, instance_loss: 0.0801, weighted_loss: 0.0282, label: 1, bag_size: 460
batch 39, loss: 1.9044, instance_loss: 0.8563, weighted_loss: 1.5899, label: 1, bag_size: 2342
batch 59, loss: 1.6232, instance_loss: 0.9496, weighted_loss: 1.4211, label: 0, bag_size: 22822
batch 79, loss: 0.0915, instance_loss: 0.4715, weighted_loss: 0.2055, label: 2, bag_size: 3607
batch 99, loss: 2.1845, instance_loss: 1.4514, weighted_loss: 1.9646, label: 1, bag_size: 936
batch 119, loss: 0.0775, instance_loss: 0.2729, weighted_loss: 0.1361, label: 2, bag_size: 4372
batch 139, loss: 0.6502, instance_loss: 0.6325, weighted_loss: 0.6449, label: 2, bag_size: 724
batch 159, loss: 0.2625, instance_loss: 0.5248, weighted_loss: 0.3412, label: 1, bag_size: 4960
batch 179, loss: 3.0688, instance_loss: 1.5820, weighted_loss: 2.6228, label: 0, bag_size: 1071
batch 199, loss: 0.0840, instance_loss: 0.3163, weighted_loss: 0.1537, label: 0, bag_size: 2677
batch 219, loss: 0.0821, instance_loss: 0.1185, weighted_loss: 0.0930, label: 0, bag_size: 2873
batch 239, loss: 0.2417, instance_loss: 0.4909, weighted_loss: 0.3165, label: 0, bag_size: 789
batch 259, loss: 2.5951, instance_loss: 1.3329, weighted_loss: 2.2165, label: 1, bag_size: 6165
batch 279, loss: 0.1305, instance_loss: 0.4175, weighted_loss: 0.2166, label: 2, bag_size: 724
batch 299, loss: 0.3053, instance_loss: 0.2911, weighted_loss: 0.3010, label: 2, bag_size: 2561
batch 319, loss: 0.1174, instance_loss: 0.1328, weighted_loss: 0.1220, label: 2, bag_size: 3583
batch 339, loss: 0.5289, instance_loss: 0.5578, weighted_loss: 0.5376, label: 2, bag_size: 4096
batch 359, loss: 0.0041, instance_loss: 0.2585, weighted_loss: 0.0804, label: 0, bag_size: 3872
batch 379, loss: 1.9974, instance_loss: 0.8778, weighted_loss: 1.6615, label: 0, bag_size: 1025
batch 399, loss: 0.0571, instance_loss: 0.1520, weighted_loss: 0.0856, label: 0, bag_size: 4242
batch 419, loss: 0.3595, instance_loss: 0.2265, weighted_loss: 0.3196, label: 2, bag_size: 4788
batch 439, loss: 0.0091, instance_loss: 0.2055, weighted_loss: 0.0680, label: 2, bag_size: 4569
batch 459, loss: 0.5012, instance_loss: 0.4068, weighted_loss: 0.4729, label: 0, bag_size: 1662
batch 479, loss: 0.0465, instance_loss: 0.2975, weighted_loss: 0.1218, label: 0, bag_size: 3924
batch 499, loss: 0.4412, instance_loss: 0.5197, weighted_loss: 0.4647, label: 2, bag_size: 5011
batch 519, loss: 2.2943, instance_loss: 1.5346, weighted_loss: 2.0664, label: 0, bag_size: 2736
batch 539, loss: 0.2667, instance_loss: 0.2133, weighted_loss: 0.2507, label: 0, bag_size: 5340
batch 559, loss: 0.4141, instance_loss: 0.7863, weighted_loss: 0.5257, label: 1, bag_size: 3755
batch 579, loss: 0.0024, instance_loss: 0.1546, weighted_loss: 0.0481, label: 2, bag_size: 4569
batch 599, loss: 1.2263, instance_loss: 0.5525, weighted_loss: 1.0241, label: 0, bag_size: 8611
batch 619, loss: 0.1809, instance_loss: 0.3785, weighted_loss: 0.2401, label: 2, bag_size: 728
batch 639, loss: 0.4774, instance_loss: 0.6494, weighted_loss: 0.5290, label: 1, bag_size: 6025
batch 659, loss: 0.5073, instance_loss: 0.4172, weighted_loss: 0.4803, label: 2, bag_size: 4241
batch 679, loss: 0.0403, instance_loss: 0.3975, weighted_loss: 0.1475, label: 0, bag_size: 1353
batch 699, loss: 1.0117, instance_loss: 0.7062, weighted_loss: 0.9200, label: 1, bag_size: 1860
batch 719, loss: 0.1132, instance_loss: 0.2204, weighted_loss: 0.1454, label: 0, bag_size: 2756
batch 739, loss: 0.0804, instance_loss: 0.3076, weighted_loss: 0.1486, label: 2, bag_size: 4096


class 0 clustering acc 0.9677852348993289: correct 17304/17880
class 1 clustering acc 0.4145973154362416: correct 2471/5960
Epoch: 37, train_loss: 0.4751, train_clustering_loss:  0.5168, train_error: 0.1839
class 0: acc 0.8527131782945736, correct 220/258
class 1: acc 0.7066666666666667, correct 159/225
class 2: acc 0.8740458015267175, correct 229/262

Val Set, val_loss: 0.7746, val_error: 0.2872, auc: 0.8703
class 0 clustering acc 0.9410460992907801: correct 2123/2256
class 1 clustering acc 0.3829787234042553: correct 288/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0952, instance_loss: 0.5870, weighted_loss: 0.2427, label: 2, bag_size: 3299
batch 39, loss: 0.0084, instance_loss: 0.5432, weighted_loss: 0.1688, label: 1, bag_size: 4027
batch 59, loss: 0.2434, instance_loss: 0.2728, weighted_loss: 0.2522, label: 2, bag_size: 3227
batch 79, loss: 0.3362, instance_loss: 0.8223, weighted_loss: 0.4820, label: 0, bag_size: 6927
batch 99, loss: 0.0219, instance_loss: 0.1642, weighted_loss: 0.0646, label: 2, bag_size: 4555
batch 119, loss: 0.0727, instance_loss: 0.4945, weighted_loss: 0.1993, label: 1, bag_size: 4253
batch 139, loss: 0.6781, instance_loss: 0.3880, weighted_loss: 0.5910, label: 2, bag_size: 3026
batch 159, loss: 0.5364, instance_loss: 0.7328, weighted_loss: 0.5953, label: 1, bag_size: 11974
batch 179, loss: 0.1321, instance_loss: 0.6184, weighted_loss: 0.2780, label: 2, bag_size: 4497
batch 199, loss: 0.0324, instance_loss: 0.3180, weighted_loss: 0.1181, label: 1, bag_size: 2878
batch 219, loss: 0.0083, instance_loss: 0.6515, weighted_loss: 0.2012, label: 0, bag_size: 2824
batch 239, loss: 1.8782, instance_loss: 0.9959, weighted_loss: 1.6135, label: 1, bag_size: 1327
batch 259, loss: 1.0755, instance_loss: 0.8390, weighted_loss: 1.0046, label: 1, bag_size: 5926
batch 279, loss: 0.2751, instance_loss: 0.8922, weighted_loss: 0.4602, label: 0, bag_size: 3402
batch 299, loss: 2.7509, instance_loss: 1.3277, weighted_loss: 2.3239, label: 2, bag_size: 4316
batch 319, loss: 0.0256, instance_loss: 0.1199, weighted_loss: 0.0538, label: 2, bag_size: 1094
batch 339, loss: 0.3095, instance_loss: 0.3297, weighted_loss: 0.3156, label: 2, bag_size: 3227
batch 359, loss: 0.0004, instance_loss: 0.0652, weighted_loss: 0.0198, label: 0, bag_size: 5902
batch 379, loss: 0.8823, instance_loss: 0.6887, weighted_loss: 0.8242, label: 1, bag_size: 3497
batch 399, loss: 2.4935, instance_loss: 1.3824, weighted_loss: 2.1602, label: 0, bag_size: 421
batch 419, loss: 0.1442, instance_loss: 0.1865, weighted_loss: 0.1569, label: 2, bag_size: 4056
batch 439, loss: 0.1822, instance_loss: 0.4190, weighted_loss: 0.2532, label: 2, bag_size: 3618
batch 459, loss: 0.1889, instance_loss: 0.3571, weighted_loss: 0.2393, label: 2, bag_size: 3396
batch 479, loss: 0.0153, instance_loss: 0.0892, weighted_loss: 0.0374, label: 2, bag_size: 4856
batch 499, loss: 0.7119, instance_loss: 0.6656, weighted_loss: 0.6980, label: 2, bag_size: 5406
batch 519, loss: 0.0015, instance_loss: 0.7267, weighted_loss: 0.2190, label: 1, bag_size: 5084
batch 539, loss: 0.1664, instance_loss: 0.3788, weighted_loss: 0.2301, label: 2, bag_size: 614
batch 559, loss: 0.0234, instance_loss: 0.2377, weighted_loss: 0.0877, label: 1, bag_size: 6992
batch 579, loss: 0.0002, instance_loss: 0.2251, weighted_loss: 0.0676, label: 1, bag_size: 2493
batch 599, loss: 0.6322, instance_loss: 0.6978, weighted_loss: 0.6519, label: 2, bag_size: 3778
batch 619, loss: 0.1002, instance_loss: 0.3563, weighted_loss: 0.1771, label: 0, bag_size: 3247
batch 639, loss: 0.0644, instance_loss: 0.2373, weighted_loss: 0.1163, label: 1, bag_size: 2921
batch 659, loss: 0.0725, instance_loss: 0.4979, weighted_loss: 0.2001, label: 1, bag_size: 6156
batch 679, loss: 0.9519, instance_loss: 0.7967, weighted_loss: 0.9053, label: 0, bag_size: 4547
batch 699, loss: 0.1228, instance_loss: 0.7420, weighted_loss: 0.3086, label: 2, bag_size: 2770
batch 719, loss: 1.1481, instance_loss: 0.7143, weighted_loss: 1.0180, label: 1, bag_size: 3422
batch 739, loss: 1.5577, instance_loss: 1.0325, weighted_loss: 1.4001, label: 0, bag_size: 609


class 0 clustering acc 0.9635346756152126: correct 17228/17880
class 1 clustering acc 0.3629194630872483: correct 2163/5960
Epoch: 38, train_loss: 0.5079, train_clustering_loss:  0.5519, train_error: 0.2094
class 0: acc 0.8091286307053942, correct 195/241
class 1: acc 0.7028112449799196, correct 175/249
class 2: acc 0.8588235294117647, correct 219/255

Val Set, val_loss: 0.7220, val_error: 0.2872, auc: 0.8643
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.30319148936170215: correct 228/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.6431, instance_loss: 0.7600, weighted_loss: 1.3782, label: 2, bag_size: 3026
batch 39, loss: 0.3299, instance_loss: 0.6410, weighted_loss: 0.4232, label: 0, bag_size: 3752
batch 59, loss: 0.7445, instance_loss: 0.5457, weighted_loss: 0.6849, label: 2, bag_size: 223
batch 79, loss: 0.6167, instance_loss: 0.4959, weighted_loss: 0.5805, label: 0, bag_size: 4562
batch 99, loss: 0.4627, instance_loss: 0.6543, weighted_loss: 0.5202, label: 1, bag_size: 1528
batch 119, loss: 0.4254, instance_loss: 0.8952, weighted_loss: 0.5663, label: 2, bag_size: 4571
batch 139, loss: 1.7379, instance_loss: 1.2021, weighted_loss: 1.5772, label: 1, bag_size: 1558
batch 159, loss: 0.0563, instance_loss: 0.3777, weighted_loss: 0.1527, label: 0, bag_size: 1353
batch 179, loss: 0.1352, instance_loss: 0.4269, weighted_loss: 0.2227, label: 2, bag_size: 3080
batch 199, loss: 0.2794, instance_loss: 0.2442, weighted_loss: 0.2689, label: 2, bag_size: 3172
batch 219, loss: 0.6699, instance_loss: 1.0856, weighted_loss: 0.7946, label: 1, bag_size: 5340
batch 239, loss: 0.3329, instance_loss: 0.6747, weighted_loss: 0.4354, label: 1, bag_size: 2671
batch 259, loss: 0.2958, instance_loss: 0.6193, weighted_loss: 0.3928, label: 2, bag_size: 1543
batch 279, loss: 0.0604, instance_loss: 0.2816, weighted_loss: 0.1267, label: 0, bag_size: 1647
batch 299, loss: 0.8819, instance_loss: 0.6146, weighted_loss: 0.8017, label: 1, bag_size: 5693
batch 319, loss: 0.6222, instance_loss: 0.5510, weighted_loss: 0.6009, label: 1, bag_size: 5926
batch 339, loss: 0.1846, instance_loss: 0.6403, weighted_loss: 0.3213, label: 0, bag_size: 4485
batch 359, loss: 0.0622, instance_loss: 0.4119, weighted_loss: 0.1671, label: 1, bag_size: 1599
batch 379, loss: 0.0000, instance_loss: 0.3304, weighted_loss: 0.0991, label: 1, bag_size: 5760
batch 399, loss: 0.0000, instance_loss: 0.0925, weighted_loss: 0.0278, label: 0, bag_size: 5053
batch 419, loss: 0.0794, instance_loss: 0.1940, weighted_loss: 0.1138, label: 0, bag_size: 4242
batch 439, loss: 0.3366, instance_loss: 0.6397, weighted_loss: 0.4276, label: 1, bag_size: 6475
batch 459, loss: 0.8760, instance_loss: 0.7430, weighted_loss: 0.8361, label: 1, bag_size: 3604
batch 479, loss: 0.0159, instance_loss: 0.1616, weighted_loss: 0.0596, label: 0, bag_size: 3924
batch 499, loss: 0.0277, instance_loss: 0.1974, weighted_loss: 0.0786, label: 0, bag_size: 3789
batch 519, loss: 0.0261, instance_loss: 0.4391, weighted_loss: 0.1500, label: 0, bag_size: 3408
batch 539, loss: 0.0016, instance_loss: 0.1087, weighted_loss: 0.0338, label: 0, bag_size: 873
batch 559, loss: 0.2341, instance_loss: 0.3174, weighted_loss: 0.2591, label: 0, bag_size: 5890
batch 579, loss: 0.0402, instance_loss: 0.1878, weighted_loss: 0.0845, label: 2, bag_size: 88
batch 599, loss: 0.4451, instance_loss: 0.4908, weighted_loss: 0.4588, label: 1, bag_size: 1906
batch 619, loss: 2.4059, instance_loss: 1.0580, weighted_loss: 2.0015, label: 2, bag_size: 4316
batch 639, loss: 0.1815, instance_loss: 0.3707, weighted_loss: 0.2383, label: 2, bag_size: 5472
batch 659, loss: 0.0483, instance_loss: 0.1983, weighted_loss: 0.0933, label: 0, bag_size: 5041
batch 679, loss: 0.0113, instance_loss: 0.7556, weighted_loss: 0.2346, label: 0, bag_size: 3872
batch 699, loss: 0.0100, instance_loss: 0.1494, weighted_loss: 0.0518, label: 2, bag_size: 657
batch 719, loss: 0.2139, instance_loss: 0.1644, weighted_loss: 0.1991, label: 2, bag_size: 3172
batch 739, loss: 0.1915, instance_loss: 0.4987, weighted_loss: 0.2837, label: 2, bag_size: 4096


class 0 clustering acc 0.966834451901566: correct 17287/17880
class 1 clustering acc 0.4204697986577181: correct 2506/5960
Epoch: 39, train_loss: 0.4776, train_clustering_loss:  0.5274, train_error: 0.1799
class 0: acc 0.8798449612403101, correct 227/258
class 1: acc 0.6880733944954128, correct 150/218
class 2: acc 0.8698884758364313, correct 234/269

Val Set, val_loss: 0.9221, val_error: 0.3830, auc: 0.8639
class 0 clustering acc 0.9525709219858156: correct 2149/2256
class 1 clustering acc 0.3098404255319149: correct 233/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.8333333333333334, correct 25/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0470, instance_loss: 0.2343, weighted_loss: 0.1032, label: 0, bag_size: 4300
batch 39, loss: 0.3480, instance_loss: 0.6008, weighted_loss: 0.4238, label: 0, bag_size: 1052
batch 59, loss: 0.0383, instance_loss: 0.2923, weighted_loss: 0.1145, label: 0, bag_size: 4894
batch 79, loss: 0.1322, instance_loss: 0.2398, weighted_loss: 0.1645, label: 0, bag_size: 4524
batch 99, loss: 0.2573, instance_loss: 0.3387, weighted_loss: 0.2817, label: 2, bag_size: 2561
batch 119, loss: 0.0196, instance_loss: 0.0945, weighted_loss: 0.0421, label: 2, bag_size: 5138
batch 139, loss: 0.6286, instance_loss: 0.9206, weighted_loss: 0.7162, label: 2, bag_size: 5072
batch 159, loss: 0.6550, instance_loss: 0.7463, weighted_loss: 0.6824, label: 0, bag_size: 4719
batch 179, loss: 0.0052, instance_loss: 1.4410, weighted_loss: 0.4360, label: 0, bag_size: 1910
batch 199, loss: 0.9603, instance_loss: 1.2489, weighted_loss: 1.0469, label: 0, bag_size: 1018
batch 219, loss: 0.5925, instance_loss: 0.7006, weighted_loss: 0.6249, label: 0, bag_size: 3841
batch 239, loss: 0.0023, instance_loss: 0.1307, weighted_loss: 0.0408, label: 2, bag_size: 5037
batch 259, loss: 3.9419, instance_loss: 1.2558, weighted_loss: 3.1361, label: 0, bag_size: 1025
batch 279, loss: 0.4538, instance_loss: 0.4621, weighted_loss: 0.4563, label: 1, bag_size: 596
batch 299, loss: 0.4161, instance_loss: 0.6493, weighted_loss: 0.4861, label: 1, bag_size: 4612
batch 319, loss: 0.0604, instance_loss: 0.2137, weighted_loss: 0.1064, label: 2, bag_size: 4372
batch 339, loss: 0.0030, instance_loss: 0.0736, weighted_loss: 0.0242, label: 1, bag_size: 8802
batch 359, loss: 0.1158, instance_loss: 0.3765, weighted_loss: 0.1940, label: 1, bag_size: 1029
batch 379, loss: 0.4415, instance_loss: 0.7469, weighted_loss: 0.5332, label: 2, bag_size: 4179
batch 399, loss: 0.1688, instance_loss: 0.2511, weighted_loss: 0.1935, label: 2, bag_size: 3176
batch 419, loss: 0.2545, instance_loss: 0.4640, weighted_loss: 0.3173, label: 2, bag_size: 5472
batch 439, loss: 0.9973, instance_loss: 0.7726, weighted_loss: 0.9299, label: 2, bag_size: 552
batch 459, loss: 0.0005, instance_loss: 0.9328, weighted_loss: 0.2802, label: 0, bag_size: 5017
batch 479, loss: 0.2045, instance_loss: 0.4325, weighted_loss: 0.2729, label: 0, bag_size: 5260
batch 499, loss: 0.2277, instance_loss: 0.6810, weighted_loss: 0.3637, label: 2, bag_size: 1543
batch 519, loss: 0.8330, instance_loss: 0.6292, weighted_loss: 0.7719, label: 0, bag_size: 3743
batch 539, loss: 0.7673, instance_loss: 0.8062, weighted_loss: 0.7790, label: 1, bag_size: 5512
batch 559, loss: 0.1459, instance_loss: 0.3476, weighted_loss: 0.2064, label: 1, bag_size: 3586
batch 579, loss: 1.2890, instance_loss: 0.9987, weighted_loss: 1.2019, label: 2, bag_size: 4571
batch 599, loss: 0.0630, instance_loss: 0.3432, weighted_loss: 0.1471, label: 1, bag_size: 6475
batch 619, loss: 0.0019, instance_loss: 1.1903, weighted_loss: 0.3584, label: 0, bag_size: 1814
batch 639, loss: 0.1004, instance_loss: 0.4864, weighted_loss: 0.2162, label: 0, bag_size: 5953
batch 659, loss: 0.5136, instance_loss: 0.7161, weighted_loss: 0.5743, label: 1, bag_size: 2831
batch 679, loss: 0.5156, instance_loss: 0.4539, weighted_loss: 0.4971, label: 1, bag_size: 2767
batch 699, loss: 1.7517, instance_loss: 1.6577, weighted_loss: 1.7235, label: 1, bag_size: 5072
batch 719, loss: 0.6258, instance_loss: 0.8045, weighted_loss: 0.6794, label: 2, bag_size: 5072
batch 739, loss: 0.0507, instance_loss: 0.7991, weighted_loss: 0.2752, label: 1, bag_size: 4898


class 0 clustering acc 0.9620246085011186: correct 17201/17880
class 1 clustering acc 0.45033557046979866: correct 2684/5960
Epoch: 40, train_loss: 0.4401, train_clustering_loss:  0.5149, train_error: 0.1893
class 0: acc 0.8385826771653543, correct 213/254
class 1: acc 0.7180616740088106, correct 163/227
class 2: acc 0.8636363636363636, correct 228/264

Val Set, val_loss: 0.7220, val_error: 0.2872, auc: 0.8707
class 0 clustering acc 0.9375: correct 2115/2256
class 1 clustering acc 0.5172872340425532: correct 389/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.6008, instance_loss: 0.7171, weighted_loss: 1.3357, label: 2, bag_size: 4241
batch 39, loss: 0.8820, instance_loss: 0.6129, weighted_loss: 0.8013, label: 0, bag_size: 2428
batch 59, loss: 0.3900, instance_loss: 0.4209, weighted_loss: 0.3992, label: 2, bag_size: 6298
batch 79, loss: 1.0854, instance_loss: 0.6255, weighted_loss: 0.9474, label: 2, bag_size: 2326
batch 99, loss: 0.0663, instance_loss: 0.7438, weighted_loss: 0.2695, label: 1, bag_size: 4898
batch 119, loss: 0.1201, instance_loss: 0.3701, weighted_loss: 0.1951, label: 0, bag_size: 3924
batch 139, loss: 0.0001, instance_loss: 0.3209, weighted_loss: 0.0963, label: 1, bag_size: 4027
batch 159, loss: 0.4826, instance_loss: 0.4495, weighted_loss: 0.4726, label: 2, bag_size: 4096
batch 179, loss: 0.0508, instance_loss: 0.2669, weighted_loss: 0.1156, label: 2, bag_size: 614
batch 199, loss: 0.0095, instance_loss: 0.1801, weighted_loss: 0.0607, label: 0, bag_size: 4570
batch 219, loss: 1.0672, instance_loss: 0.9042, weighted_loss: 1.0183, label: 1, bag_size: 1477
batch 239, loss: 0.3275, instance_loss: 0.3682, weighted_loss: 0.3397, label: 2, bag_size: 4241
batch 259, loss: 0.0337, instance_loss: 0.5606, weighted_loss: 0.1918, label: 0, bag_size: 3268
batch 279, loss: 0.0602, instance_loss: 0.2024, weighted_loss: 0.1028, label: 0, bag_size: 5570
batch 299, loss: 1.6546, instance_loss: 0.5727, weighted_loss: 1.3300, label: 0, bag_size: 3639
batch 319, loss: 0.0051, instance_loss: 0.1979, weighted_loss: 0.0630, label: 0, bag_size: 5795
batch 339, loss: 0.5801, instance_loss: 0.2867, weighted_loss: 0.4921, label: 0, bag_size: 4245
batch 359, loss: 0.1602, instance_loss: 0.3215, weighted_loss: 0.2086, label: 2, bag_size: 4978
batch 379, loss: 0.2411, instance_loss: 0.2635, weighted_loss: 0.2479, label: 2, bag_size: 2501
batch 399, loss: 0.1666, instance_loss: 0.3599, weighted_loss: 0.2246, label: 2, bag_size: 3396
batch 419, loss: 1.1828, instance_loss: 0.7929, weighted_loss: 1.0659, label: 2, bag_size: 22464
batch 439, loss: 0.2041, instance_loss: 0.3017, weighted_loss: 0.2334, label: 0, bag_size: 6430
batch 459, loss: 0.0732, instance_loss: 0.7542, weighted_loss: 0.2775, label: 0, bag_size: 1417
batch 479, loss: 0.2948, instance_loss: 0.8193, weighted_loss: 0.4521, label: 1, bag_size: 4960
batch 499, loss: 0.1536, instance_loss: 0.1861, weighted_loss: 0.1634, label: 2, bag_size: 657
batch 519, loss: 0.0383, instance_loss: 0.2540, weighted_loss: 0.1030, label: 2, bag_size: 4555
batch 539, loss: 0.1549, instance_loss: 0.3875, weighted_loss: 0.2247, label: 0, bag_size: 7077
batch 559, loss: 0.1005, instance_loss: 0.1387, weighted_loss: 0.1120, label: 2, bag_size: 3026
batch 579, loss: 0.0007, instance_loss: 0.1928, weighted_loss: 0.0583, label: 2, bag_size: 5017
batch 599, loss: 0.0006, instance_loss: 0.4594, weighted_loss: 0.1383, label: 1, bag_size: 4027
batch 619, loss: 0.1908, instance_loss: 0.2007, weighted_loss: 0.1937, label: 2, bag_size: 3746
batch 639, loss: 0.8886, instance_loss: 0.7294, weighted_loss: 0.8408, label: 1, bag_size: 1027
batch 659, loss: 0.1845, instance_loss: 0.3963, weighted_loss: 0.2480, label: 0, bag_size: 4220
batch 679, loss: 0.1612, instance_loss: 0.5918, weighted_loss: 0.2904, label: 2, bag_size: 3810
batch 699, loss: 0.5209, instance_loss: 0.2966, weighted_loss: 0.4536, label: 0, bag_size: 5632
batch 719, loss: 0.4473, instance_loss: 0.6029, weighted_loss: 0.4940, label: 0, bag_size: 1170
batch 739, loss: 1.8078, instance_loss: 0.9041, weighted_loss: 1.5367, label: 2, bag_size: 22464


class 0 clustering acc 0.9611297539149888: correct 17185/17880
class 1 clustering acc 0.4203020134228188: correct 2505/5960
Epoch: 41, train_loss: 0.4454, train_clustering_loss:  0.5299, train_error: 0.1758
class 0: acc 0.8739130434782608, correct 201/230
class 1: acc 0.7004405286343612, correct 159/227
class 2: acc 0.8819444444444444, correct 254/288

Val Set, val_loss: 0.7099, val_error: 0.2979, auc: 0.8709
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.39893617021276595: correct 300/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 3.1960, instance_loss: 1.0604, weighted_loss: 2.5553, label: 2, bag_size: 361
batch 39, loss: 0.0077, instance_loss: 0.3513, weighted_loss: 0.1108, label: 0, bag_size: 4606
batch 59, loss: 0.0044, instance_loss: 0.2130, weighted_loss: 0.0670, label: 0, bag_size: 1647
batch 79, loss: 0.2366, instance_loss: 0.6465, weighted_loss: 0.3596, label: 2, bag_size: 1050
batch 99, loss: 0.0000, instance_loss: 0.1406, weighted_loss: 0.0422, label: 1, bag_size: 5462
batch 119, loss: 1.2535, instance_loss: 0.7970, weighted_loss: 1.1166, label: 0, bag_size: 4572
batch 139, loss: 0.3712, instance_loss: 0.5931, weighted_loss: 0.4378, label: 0, bag_size: 4161
batch 159, loss: 0.0606, instance_loss: 0.1860, weighted_loss: 0.0982, label: 2, bag_size: 5011
batch 179, loss: 0.1399, instance_loss: 0.2404, weighted_loss: 0.1701, label: 0, bag_size: 3376
batch 199, loss: 0.0861, instance_loss: 0.2082, weighted_loss: 0.1228, label: 2, bag_size: 2209
batch 219, loss: 0.1494, instance_loss: 0.2986, weighted_loss: 0.1941, label: 0, bag_size: 4251
batch 239, loss: 1.9685, instance_loss: 1.5898, weighted_loss: 1.8549, label: 1, bag_size: 5072
batch 259, loss: 0.0597, instance_loss: 0.3024, weighted_loss: 0.1325, label: 1, bag_size: 3322
batch 279, loss: 2.9912, instance_loss: 1.5633, weighted_loss: 2.5628, label: 0, bag_size: 4719
batch 299, loss: 0.4137, instance_loss: 0.5906, weighted_loss: 0.4668, label: 2, bag_size: 3618
batch 319, loss: 0.9640, instance_loss: 0.4576, weighted_loss: 0.8121, label: 1, bag_size: 2731
batch 339, loss: 0.0004, instance_loss: 0.3281, weighted_loss: 0.0987, label: 2, bag_size: 4141
batch 359, loss: 1.4440, instance_loss: 0.9116, weighted_loss: 1.2843, label: 1, bag_size: 3261
batch 379, loss: 0.6376, instance_loss: 0.5257, weighted_loss: 0.6040, label: 0, bag_size: 4584
batch 399, loss: 0.0017, instance_loss: 0.2170, weighted_loss: 0.0663, label: 1, bag_size: 3677
batch 419, loss: 0.0391, instance_loss: 0.2618, weighted_loss: 0.1059, label: 1, bag_size: 3127
batch 439, loss: 0.1088, instance_loss: 0.7365, weighted_loss: 0.2971, label: 1, bag_size: 11974
batch 459, loss: 0.1189, instance_loss: 0.5010, weighted_loss: 0.2335, label: 0, bag_size: 3754
batch 479, loss: 0.0145, instance_loss: 0.5368, weighted_loss: 0.1712, label: 0, bag_size: 3539
batch 499, loss: 0.9383, instance_loss: 0.7390, weighted_loss: 0.8786, label: 0, bag_size: 4146
batch 519, loss: 0.0021, instance_loss: 0.0600, weighted_loss: 0.0195, label: 2, bag_size: 4910
batch 539, loss: 0.0018, instance_loss: 0.2787, weighted_loss: 0.0849, label: 0, bag_size: 1545
batch 559, loss: 0.0985, instance_loss: 0.3518, weighted_loss: 0.1745, label: 1, bag_size: 3391
batch 579, loss: 0.2701, instance_loss: 0.5701, weighted_loss: 0.3601, label: 1, bag_size: 1371
batch 599, loss: 0.6839, instance_loss: 0.3304, weighted_loss: 0.5778, label: 2, bag_size: 4043
batch 619, loss: 1.1704, instance_loss: 0.6199, weighted_loss: 1.0052, label: 1, bag_size: 1023
batch 639, loss: 0.1662, instance_loss: 0.2306, weighted_loss: 0.1855, label: 0, bag_size: 3694
batch 659, loss: 0.3034, instance_loss: 0.5499, weighted_loss: 0.3774, label: 2, bag_size: 4096
batch 679, loss: 0.0011, instance_loss: 0.9710, weighted_loss: 0.2921, label: 0, bag_size: 3182
batch 699, loss: 0.0021, instance_loss: 0.1956, weighted_loss: 0.0601, label: 2, bag_size: 2422
batch 719, loss: 0.7732, instance_loss: 0.6086, weighted_loss: 0.7238, label: 1, bag_size: 1313
batch 739, loss: 0.1497, instance_loss: 0.6998, weighted_loss: 0.3147, label: 1, bag_size: 4346


class 0 clustering acc 0.9638702460850112: correct 17234/17880
class 1 clustering acc 0.4003355704697987: correct 2386/5960
Epoch: 42, train_loss: 0.4575, train_clustering_loss:  0.5284, train_error: 0.1826
class 0: acc 0.8295964125560538, correct 185/223
class 1: acc 0.7596899224806202, correct 196/258
class 2: acc 0.8636363636363636, correct 228/264

Val Set, val_loss: 0.7174, val_error: 0.2660, auc: 0.8706
class 0 clustering acc 0.9490248226950354: correct 2141/2256
class 1 clustering acc 0.3550531914893617: correct 267/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0437, instance_loss: 0.2215, weighted_loss: 0.0970, label: 1, bag_size: 4534
batch 39, loss: 0.5482, instance_loss: 0.9597, weighted_loss: 0.6717, label: 2, bag_size: 724
batch 59, loss: 0.5389, instance_loss: 0.4262, weighted_loss: 0.5051, label: 2, bag_size: 705
batch 79, loss: 0.0432, instance_loss: 0.2133, weighted_loss: 0.0943, label: 0, bag_size: 471
batch 99, loss: 3.6429, instance_loss: 1.0188, weighted_loss: 2.8556, label: 0, bag_size: 3830
batch 119, loss: 0.4524, instance_loss: 0.3715, weighted_loss: 0.4282, label: 2, bag_size: 3746
batch 139, loss: 2.6044, instance_loss: 1.3692, weighted_loss: 2.2338, label: 0, bag_size: 1774
batch 159, loss: 0.7335, instance_loss: 0.9789, weighted_loss: 0.8071, label: 1, bag_size: 1307
batch 179, loss: 0.8938, instance_loss: 1.0507, weighted_loss: 0.9409, label: 1, bag_size: 1307
batch 199, loss: 0.1284, instance_loss: 0.2117, weighted_loss: 0.1534, label: 2, bag_size: 3583
batch 219, loss: 0.3378, instance_loss: 0.7693, weighted_loss: 0.4673, label: 0, bag_size: 4707
batch 239, loss: 0.0289, instance_loss: 0.1643, weighted_loss: 0.0695, label: 0, bag_size: 1640
batch 259, loss: 0.1587, instance_loss: 0.2289, weighted_loss: 0.1797, label: 2, bag_size: 3534
batch 279, loss: 0.9027, instance_loss: 0.5024, weighted_loss: 0.7826, label: 1, bag_size: 5385
batch 299, loss: 0.1038, instance_loss: 0.2300, weighted_loss: 0.1417, label: 0, bag_size: 5260
batch 319, loss: 0.1317, instance_loss: 0.3493, weighted_loss: 0.1970, label: 2, bag_size: 4096
batch 339, loss: 1.3180, instance_loss: 0.6523, weighted_loss: 1.1183, label: 0, bag_size: 8866
batch 359, loss: 0.3575, instance_loss: 0.3864, weighted_loss: 0.3662, label: 2, bag_size: 3227
batch 379, loss: 0.0125, instance_loss: 0.5435, weighted_loss: 0.1718, label: 0, bag_size: 1006
batch 399, loss: 0.0677, instance_loss: 0.3696, weighted_loss: 0.1582, label: 1, bag_size: 3983
batch 419, loss: 0.0119, instance_loss: 0.0895, weighted_loss: 0.0351, label: 2, bag_size: 3121
batch 439, loss: 0.0472, instance_loss: 0.4302, weighted_loss: 0.1621, label: 2, bag_size: 88
batch 459, loss: 0.0028, instance_loss: 0.1280, weighted_loss: 0.0404, label: 1, bag_size: 8802
batch 479, loss: 0.0060, instance_loss: 0.5400, weighted_loss: 0.1662, label: 1, bag_size: 4027
batch 499, loss: 0.0707, instance_loss: 0.1961, weighted_loss: 0.1083, label: 2, bag_size: 5307
batch 519, loss: 0.0926, instance_loss: 0.1500, weighted_loss: 0.1098, label: 2, bag_size: 3583
batch 539, loss: 1.6465, instance_loss: 1.1979, weighted_loss: 1.5119, label: 0, bag_size: 621
batch 559, loss: 1.4491, instance_loss: 0.8877, weighted_loss: 1.2807, label: 2, bag_size: 7607
batch 579, loss: 0.0037, instance_loss: 0.0633, weighted_loss: 0.0216, label: 2, bag_size: 2254
batch 599, loss: 0.1948, instance_loss: 0.5918, weighted_loss: 0.3139, label: 1, bag_size: 2156
batch 619, loss: 1.2659, instance_loss: 1.1356, weighted_loss: 1.2268, label: 1, bag_size: 4258
batch 639, loss: 0.0764, instance_loss: 0.3716, weighted_loss: 0.1650, label: 1, bag_size: 2753
batch 659, loss: 0.0205, instance_loss: 0.4635, weighted_loss: 0.1534, label: 1, bag_size: 3156
batch 679, loss: 0.5197, instance_loss: 0.8296, weighted_loss: 0.6126, label: 0, bag_size: 726
batch 699, loss: 3.0073, instance_loss: 1.1355, weighted_loss: 2.4458, label: 0, bag_size: 35080
batch 719, loss: 0.5721, instance_loss: 0.6211, weighted_loss: 0.5868, label: 0, bag_size: 7315
batch 739, loss: 1.2399, instance_loss: 1.0541, weighted_loss: 1.1841, label: 2, bag_size: 223


class 0 clustering acc 0.9643176733780761: correct 17242/17880
class 1 clustering acc 0.44865771812080535: correct 2674/5960
Epoch: 43, train_loss: 0.4300, train_clustering_loss:  0.5111, train_error: 0.1745
class 0: acc 0.8333333333333334, correct 205/246
class 1: acc 0.7560975609756098, correct 186/246
class 2: acc 0.8853754940711462, correct 224/253

Val Set, val_loss: 0.6408, val_error: 0.2872, auc: 0.8824
class 0 clustering acc 0.9375: correct 2115/2256
class 1 clustering acc 0.4720744680851064: correct 355/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.3775, instance_loss: 0.6676, weighted_loss: 1.1645, label: 1, bag_size: 3438
batch 39, loss: 0.0055, instance_loss: 0.0911, weighted_loss: 0.0311, label: 2, bag_size: 2483
batch 59, loss: 0.0008, instance_loss: 0.4544, weighted_loss: 0.1369, label: 1, bag_size: 3156
batch 79, loss: 0.0304, instance_loss: 0.2015, weighted_loss: 0.0818, label: 0, bag_size: 1485
batch 99, loss: 0.3662, instance_loss: 0.6443, weighted_loss: 0.4496, label: 2, bag_size: 6594
batch 119, loss: 0.0000, instance_loss: 0.1070, weighted_loss: 0.0321, label: 1, bag_size: 4134
batch 139, loss: 2.3299, instance_loss: 0.8747, weighted_loss: 1.8933, label: 0, bag_size: 15388
batch 159, loss: 0.0033, instance_loss: 0.2968, weighted_loss: 0.0914, label: 2, bag_size: 4497
batch 179, loss: 0.0577, instance_loss: 0.1540, weighted_loss: 0.0866, label: 0, bag_size: 4251
batch 199, loss: 0.0643, instance_loss: 0.6513, weighted_loss: 0.2404, label: 2, bag_size: 2031
batch 219, loss: 1.3025, instance_loss: 0.7949, weighted_loss: 1.1503, label: 1, bag_size: 5072
batch 239, loss: 0.0243, instance_loss: 0.5816, weighted_loss: 0.1915, label: 0, bag_size: 2927
batch 259, loss: 0.9690, instance_loss: 0.9308, weighted_loss: 0.9575, label: 1, bag_size: 8632
batch 279, loss: 0.2179, instance_loss: 0.3750, weighted_loss: 0.2650, label: 0, bag_size: 3797
batch 299, loss: 1.3749, instance_loss: 1.2787, weighted_loss: 1.3460, label: 0, bag_size: 313
batch 319, loss: 1.3707, instance_loss: 1.0487, weighted_loss: 1.2741, label: 1, bag_size: 5402
batch 339, loss: 0.0042, instance_loss: 0.2445, weighted_loss: 0.0763, label: 0, bag_size: 5459
batch 359, loss: 0.6164, instance_loss: 0.6089, weighted_loss: 0.6141, label: 1, bag_size: 2831
batch 379, loss: 0.4177, instance_loss: 0.9013, weighted_loss: 0.5628, label: 2, bag_size: 6298
batch 399, loss: 0.4087, instance_loss: 0.6981, weighted_loss: 0.4955, label: 1, bag_size: 2747
batch 419, loss: 0.4756, instance_loss: 0.5519, weighted_loss: 0.4985, label: 2, bag_size: 5637
batch 439, loss: 0.0053, instance_loss: 0.7238, weighted_loss: 0.2208, label: 1, bag_size: 3159
batch 459, loss: 3.5810, instance_loss: 1.2578, weighted_loss: 2.8840, label: 0, bag_size: 3830
batch 479, loss: 1.3920, instance_loss: 0.6422, weighted_loss: 1.1670, label: 1, bag_size: 3106
batch 499, loss: 0.0682, instance_loss: 0.4947, weighted_loss: 0.1961, label: 2, bag_size: 4569
batch 519, loss: 0.0800, instance_loss: 0.6807, weighted_loss: 0.2602, label: 1, bag_size: 6513
batch 539, loss: 0.0021, instance_loss: 0.1661, weighted_loss: 0.0513, label: 2, bag_size: 5017
batch 559, loss: 0.7119, instance_loss: 0.9704, weighted_loss: 0.7895, label: 1, bag_size: 5276
batch 579, loss: 1.3979, instance_loss: 1.0864, weighted_loss: 1.3045, label: 1, bag_size: 8632
batch 599, loss: 0.4863, instance_loss: 0.5792, weighted_loss: 0.5142, label: 2, bag_size: 4162
batch 619, loss: 0.5725, instance_loss: 0.9048, weighted_loss: 0.6722, label: 1, bag_size: 3322
batch 639, loss: 0.9373, instance_loss: 0.8184, weighted_loss: 0.9016, label: 1, bag_size: 5512
batch 659, loss: 1.0416, instance_loss: 0.6598, weighted_loss: 0.9270, label: 0, bag_size: 2189
batch 679, loss: 0.1182, instance_loss: 0.7749, weighted_loss: 0.3152, label: 1, bag_size: 6156
batch 699, loss: 0.0195, instance_loss: 0.1611, weighted_loss: 0.0619, label: 0, bag_size: 4196
batch 719, loss: 0.7436, instance_loss: 0.3067, weighted_loss: 0.6126, label: 0, bag_size: 2190
batch 739, loss: 1.3113, instance_loss: 1.1191, weighted_loss: 1.2536, label: 1, bag_size: 475


class 0 clustering acc 0.9672259507829978: correct 17294/17880
class 1 clustering acc 0.37785234899328857: correct 2252/5960
Epoch: 44, train_loss: 0.4763, train_clustering_loss:  0.5344, train_error: 0.1946
class 0: acc 0.8111587982832618, correct 189/233
class 1: acc 0.7701149425287356, correct 201/261
class 2: acc 0.8366533864541833, correct 210/251

Val Set, val_loss: 0.7520, val_error: 0.3085, auc: 0.8613
class 0 clustering acc 0.9140070921985816: correct 2062/2256
class 1 clustering acc 0.5199468085106383: correct 391/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1242, instance_loss: 0.4476, weighted_loss: 0.2212, label: 2, bag_size: 6594
batch 39, loss: 0.3821, instance_loss: 1.0742, weighted_loss: 0.5898, label: 1, bag_size: 5035
batch 59, loss: 0.0625, instance_loss: 0.2174, weighted_loss: 0.1090, label: 2, bag_size: 6001
batch 79, loss: 0.2051, instance_loss: 0.8075, weighted_loss: 0.3858, label: 1, bag_size: 6025
batch 99, loss: 0.4135, instance_loss: 0.4578, weighted_loss: 0.4268, label: 2, bag_size: 5426
batch 119, loss: 1.7268, instance_loss: 0.4069, weighted_loss: 1.3309, label: 0, bag_size: 6252
batch 139, loss: 0.0137, instance_loss: 0.0901, weighted_loss: 0.0366, label: 0, bag_size: 6430
batch 159, loss: 2.6574, instance_loss: 1.3660, weighted_loss: 2.2700, label: 1, bag_size: 2614
batch 179, loss: 0.4396, instance_loss: 1.2360, weighted_loss: 0.6785, label: 0, bag_size: 1808
batch 199, loss: 0.4459, instance_loss: 0.6944, weighted_loss: 0.5205, label: 2, bag_size: 1050
batch 219, loss: 0.3925, instance_loss: 0.4861, weighted_loss: 0.4206, label: 1, bag_size: 1221
batch 239, loss: 0.0284, instance_loss: 0.4522, weighted_loss: 0.1555, label: 0, bag_size: 4721
batch 259, loss: 0.0023, instance_loss: 0.2315, weighted_loss: 0.0711, label: 1, bag_size: 874
batch 279, loss: 0.5868, instance_loss: 0.6631, weighted_loss: 0.6097, label: 1, bag_size: 11768
batch 299, loss: 0.0610, instance_loss: 0.3021, weighted_loss: 0.1333, label: 0, bag_size: 3924
batch 319, loss: 0.4165, instance_loss: 0.6056, weighted_loss: 0.4732, label: 1, bag_size: 4705
batch 339, loss: 0.0443, instance_loss: 0.3394, weighted_loss: 0.1329, label: 0, bag_size: 4744
batch 359, loss: 0.5250, instance_loss: 1.3092, weighted_loss: 0.7602, label: 1, bag_size: 5880
batch 379, loss: 0.3686, instance_loss: 0.5306, weighted_loss: 0.4172, label: 1, bag_size: 19265
batch 399, loss: 0.7395, instance_loss: 1.7941, weighted_loss: 1.0559, label: 1, bag_size: 5205
batch 419, loss: 0.8775, instance_loss: 0.8203, weighted_loss: 0.8603, label: 1, bag_size: 3935
batch 439, loss: 0.4364, instance_loss: 0.5785, weighted_loss: 0.4790, label: 1, bag_size: 3640
batch 459, loss: 0.8528, instance_loss: 0.6023, weighted_loss: 0.7777, label: 1, bag_size: 2494
batch 479, loss: 0.0775, instance_loss: 0.4645, weighted_loss: 0.1936, label: 1, bag_size: 6513
batch 499, loss: 0.9921, instance_loss: 0.4312, weighted_loss: 0.8238, label: 1, bag_size: 19265
batch 519, loss: 0.1576, instance_loss: 0.3774, weighted_loss: 0.2236, label: 0, bag_size: 2767
batch 539, loss: 0.3665, instance_loss: 0.4029, weighted_loss: 0.3774, label: 2, bag_size: 3746
batch 559, loss: 0.1900, instance_loss: 0.2137, weighted_loss: 0.1971, label: 0, bag_size: 2852
batch 579, loss: 0.5796, instance_loss: 1.0238, weighted_loss: 0.7129, label: 1, bag_size: 1371
batch 599, loss: 0.0869, instance_loss: 0.4347, weighted_loss: 0.1912, label: 2, bag_size: 1050
batch 619, loss: 0.5879, instance_loss: 0.6929, weighted_loss: 0.6194, label: 0, bag_size: 1782
batch 639, loss: 1.2187, instance_loss: 0.8851, weighted_loss: 1.1186, label: 2, bag_size: 4179
batch 659, loss: 0.2819, instance_loss: 0.5944, weighted_loss: 0.3756, label: 0, bag_size: 3033
batch 679, loss: 0.6251, instance_loss: 1.1470, weighted_loss: 0.7817, label: 1, bag_size: 1580
batch 699, loss: 0.9907, instance_loss: 1.0477, weighted_loss: 1.0078, label: 1, bag_size: 3422
batch 719, loss: 0.1709, instance_loss: 0.4322, weighted_loss: 0.2493, label: 2, bag_size: 3396
batch 739, loss: 0.0973, instance_loss: 0.7702, weighted_loss: 0.2991, label: 0, bag_size: 3539


class 0 clustering acc 0.9646532438478748: correct 17248/17880
class 1 clustering acc 0.38036912751677854: correct 2267/5960
Epoch: 45, train_loss: 0.4638, train_clustering_loss:  0.5355, train_error: 0.1839
class 0: acc 0.8560311284046692, correct 220/257
class 1: acc 0.7423076923076923, correct 193/260
class 2: acc 0.8552631578947368, correct 195/228

Val Set, val_loss: 0.8171, val_error: 0.3404, auc: 0.8775
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.2752659574468085: correct 207/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1048, instance_loss: 0.3237, weighted_loss: 0.1705, label: 2, bag_size: 2501
batch 39, loss: 0.3080, instance_loss: 0.2478, weighted_loss: 0.2899, label: 0, bag_size: 5368
batch 59, loss: 0.0296, instance_loss: 0.3013, weighted_loss: 0.1111, label: 0, bag_size: 2339
batch 79, loss: 0.0925, instance_loss: 0.2017, weighted_loss: 0.1253, label: 2, bag_size: 2481
batch 99, loss: 0.0197, instance_loss: 0.1846, weighted_loss: 0.0691, label: 2, bag_size: 3080
batch 119, loss: 0.4164, instance_loss: 0.4368, weighted_loss: 0.4225, label: 2, bag_size: 597
batch 139, loss: 1.1801, instance_loss: 0.7051, weighted_loss: 1.0376, label: 2, bag_size: 5406
batch 159, loss: 0.4440, instance_loss: 0.8276, weighted_loss: 0.5590, label: 1, bag_size: 5011
batch 179, loss: 0.1862, instance_loss: 0.1442, weighted_loss: 0.1736, label: 2, bag_size: 88
batch 199, loss: 0.6942, instance_loss: 0.3831, weighted_loss: 0.6009, label: 0, bag_size: 3789
batch 219, loss: 0.7739, instance_loss: 0.7750, weighted_loss: 0.7742, label: 2, bag_size: 728
batch 239, loss: 1.3275, instance_loss: 1.0533, weighted_loss: 1.2452, label: 0, bag_size: 2392
batch 259, loss: 0.0833, instance_loss: 0.4128, weighted_loss: 0.1822, label: 1, bag_size: 2092
batch 279, loss: 2.2086, instance_loss: 1.2617, weighted_loss: 1.9245, label: 1, bag_size: 475
batch 299, loss: 0.8007, instance_loss: 0.5158, weighted_loss: 0.7152, label: 2, bag_size: 4096
batch 319, loss: 0.0500, instance_loss: 0.1114, weighted_loss: 0.0684, label: 0, bag_size: 2873
batch 339, loss: 0.0440, instance_loss: 0.0939, weighted_loss: 0.0590, label: 0, bag_size: 3617
batch 359, loss: 0.2325, instance_loss: 1.3944, weighted_loss: 0.5811, label: 1, bag_size: 3995
batch 379, loss: 0.4601, instance_loss: 0.9691, weighted_loss: 0.6128, label: 1, bag_size: 2744
batch 399, loss: 0.0344, instance_loss: 0.1573, weighted_loss: 0.0713, label: 2, bag_size: 6273
batch 419, loss: 0.4603, instance_loss: 0.5297, weighted_loss: 0.4811, label: 2, bag_size: 3618
batch 439, loss: 0.1062, instance_loss: 0.6836, weighted_loss: 0.2794, label: 0, bag_size: 1652
batch 459, loss: 0.0596, instance_loss: 0.1603, weighted_loss: 0.0898, label: 2, bag_size: 2905
batch 479, loss: 0.0078, instance_loss: 0.1439, weighted_loss: 0.0486, label: 2, bag_size: 4775
batch 499, loss: 0.0655, instance_loss: 0.2634, weighted_loss: 0.1248, label: 0, bag_size: 5282
batch 519, loss: 0.0099, instance_loss: 0.4505, weighted_loss: 0.1421, label: 1, bag_size: 4869
batch 539, loss: 0.1468, instance_loss: 0.6453, weighted_loss: 0.2963, label: 1, bag_size: 3265
batch 559, loss: 0.0359, instance_loss: 0.1256, weighted_loss: 0.0628, label: 2, bag_size: 2313
batch 579, loss: 0.8371, instance_loss: 0.7531, weighted_loss: 0.8119, label: 1, bag_size: 2671
batch 599, loss: 1.0614, instance_loss: 0.9911, weighted_loss: 1.0403, label: 2, bag_size: 5406
batch 619, loss: 0.9958, instance_loss: 0.8369, weighted_loss: 0.9481, label: 1, bag_size: 5072
batch 639, loss: 0.2554, instance_loss: 0.6624, weighted_loss: 0.3775, label: 1, bag_size: 1221
batch 659, loss: 4.2160, instance_loss: 1.7363, weighted_loss: 3.4721, label: 0, bag_size: 1755
batch 679, loss: 0.0076, instance_loss: 0.3741, weighted_loss: 0.1176, label: 1, bag_size: 4578
batch 699, loss: 0.0506, instance_loss: 0.5365, weighted_loss: 0.1964, label: 0, bag_size: 6015
batch 719, loss: 0.0118, instance_loss: 0.3028, weighted_loss: 0.0991, label: 2, bag_size: 3094
batch 739, loss: 1.3139, instance_loss: 0.8866, weighted_loss: 1.1857, label: 0, bag_size: 20234


class 0 clustering acc 0.9646532438478748: correct 17248/17880
class 1 clustering acc 0.412751677852349: correct 2460/5960
Epoch: 46, train_loss: 0.4288, train_clustering_loss:  0.5220, train_error: 0.1799
class 0: acc 0.8401639344262295, correct 205/244
class 1: acc 0.7428571428571429, correct 182/245
class 2: acc 0.875, correct 224/256

Val Set, val_loss: 0.6190, val_error: 0.2447, auc: 0.8915
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.2712765957446808: correct 204/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.634181 --> 0.618996).  Saving model ...


batch 19, loss: 0.0443, instance_loss: 0.2198, weighted_loss: 0.0969, label: 2, bag_size: 4555
batch 39, loss: 0.0244, instance_loss: 0.3976, weighted_loss: 0.1363, label: 0, bag_size: 4227
batch 59, loss: 0.0097, instance_loss: 0.0871, weighted_loss: 0.0329, label: 0, bag_size: 3437
batch 79, loss: 3.9618, instance_loss: 1.4346, weighted_loss: 3.2036, label: 0, bag_size: 7504
batch 99, loss: 0.0525, instance_loss: 0.3028, weighted_loss: 0.1276, label: 0, bag_size: 5377
batch 119, loss: 0.0061, instance_loss: 0.5989, weighted_loss: 0.1840, label: 1, bag_size: 314
batch 139, loss: 0.0072, instance_loss: 0.2957, weighted_loss: 0.0937, label: 0, bag_size: 4458
batch 159, loss: 0.0001, instance_loss: 0.8822, weighted_loss: 0.2647, label: 0, bag_size: 2306
batch 179, loss: 0.0198, instance_loss: 0.1630, weighted_loss: 0.0627, label: 0, bag_size: 4071
batch 199, loss: 0.1379, instance_loss: 0.4894, weighted_loss: 0.2433, label: 2, bag_size: 5011
batch 219, loss: 0.1331, instance_loss: 0.3756, weighted_loss: 0.2059, label: 2, bag_size: 5924
batch 239, loss: 0.1929, instance_loss: 0.2971, weighted_loss: 0.2242, label: 0, bag_size: 1049
batch 259, loss: 0.1328, instance_loss: 0.5052, weighted_loss: 0.2445, label: 2, bag_size: 1543
batch 279, loss: 0.7922, instance_loss: 0.5706, weighted_loss: 0.7257, label: 0, bag_size: 2428
batch 299, loss: 0.0048, instance_loss: 0.2394, weighted_loss: 0.0752, label: 1, bag_size: 3322
batch 319, loss: 0.0299, instance_loss: 0.6375, weighted_loss: 0.2122, label: 1, bag_size: 2453
batch 339, loss: 0.0029, instance_loss: 0.2998, weighted_loss: 0.0920, label: 2, bag_size: 3607
batch 359, loss: 0.0453, instance_loss: 0.4459, weighted_loss: 0.1655, label: 1, bag_size: 3367
batch 379, loss: 0.0962, instance_loss: 1.2881, weighted_loss: 0.4538, label: 1, bag_size: 1542
batch 399, loss: 0.5588, instance_loss: 0.5862, weighted_loss: 0.5670, label: 1, bag_size: 2671
batch 419, loss: 0.1742, instance_loss: 0.7157, weighted_loss: 0.3367, label: 0, bag_size: 1170
batch 439, loss: 0.3595, instance_loss: 0.9951, weighted_loss: 0.5502, label: 0, bag_size: 2286
batch 459, loss: 0.0025, instance_loss: 0.0893, weighted_loss: 0.0285, label: 2, bag_size: 4775
batch 479, loss: 1.3294, instance_loss: 1.2384, weighted_loss: 1.3021, label: 1, bag_size: 936
batch 499, loss: 0.0084, instance_loss: 0.0396, weighted_loss: 0.0178, label: 0, bag_size: 2873
batch 519, loss: 0.9952, instance_loss: 0.7047, weighted_loss: 0.9081, label: 1, bag_size: 19265
batch 539, loss: 1.2466, instance_loss: 0.3968, weighted_loss: 0.9917, label: 1, bag_size: 3296
batch 559, loss: 0.8884, instance_loss: 0.9257, weighted_loss: 0.8996, label: 1, bag_size: 3399
batch 579, loss: 0.0639, instance_loss: 0.3127, weighted_loss: 0.1386, label: 0, bag_size: 16741
batch 599, loss: 0.0824, instance_loss: 0.3184, weighted_loss: 0.1532, label: 2, bag_size: 3176
batch 619, loss: 0.1135, instance_loss: 0.2551, weighted_loss: 0.1560, label: 0, bag_size: 4531
batch 639, loss: 0.3131, instance_loss: 0.6444, weighted_loss: 0.4125, label: 2, bag_size: 5406
batch 659, loss: 0.1335, instance_loss: 0.4608, weighted_loss: 0.2317, label: 0, bag_size: 2392
batch 679, loss: 1.2027, instance_loss: 0.7424, weighted_loss: 1.0646, label: 2, bag_size: 5072
batch 699, loss: 1.2871, instance_loss: 0.8080, weighted_loss: 1.1434, label: 0, bag_size: 1071
batch 719, loss: 0.5626, instance_loss: 0.5576, weighted_loss: 0.5611, label: 1, bag_size: 1023
batch 739, loss: 0.1313, instance_loss: 0.4536, weighted_loss: 0.2280, label: 2, bag_size: 614


class 0 clustering acc 0.9654921700223713: correct 17263/17880
class 1 clustering acc 0.4303691275167785: correct 2565/5960
Epoch: 47, train_loss: 0.4436, train_clustering_loss:  0.5202, train_error: 0.1812
class 0: acc 0.8666666666666667, correct 234/270
class 1: acc 0.7383966244725738, correct 175/237
class 2: acc 0.8445378151260504, correct 201/238

Val Set, val_loss: 0.6451, val_error: 0.2660, auc: 0.8948
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.34175531914893614: correct 257/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2253, instance_loss: 0.2538, weighted_loss: 0.2338, label: 2, bag_size: 3026
batch 39, loss: 0.3411, instance_loss: 0.7964, weighted_loss: 0.4777, label: 1, bag_size: 2229
batch 59, loss: 2.4066, instance_loss: 1.4342, weighted_loss: 2.1149, label: 1, bag_size: 4258
batch 79, loss: 2.4878, instance_loss: 1.2230, weighted_loss: 2.1084, label: 1, bag_size: 4145
batch 99, loss: 0.0298, instance_loss: 0.3607, weighted_loss: 0.1291, label: 0, bag_size: 2339
batch 119, loss: 0.0004, instance_loss: 0.9429, weighted_loss: 0.2832, label: 0, bag_size: 4841
batch 139, loss: 0.0730, instance_loss: 0.4666, weighted_loss: 0.1911, label: 0, bag_size: 5098
batch 159, loss: 0.0856, instance_loss: 0.3121, weighted_loss: 0.1536, label: 0, bag_size: 4529
batch 179, loss: 0.0575, instance_loss: 0.2854, weighted_loss: 0.1259, label: 2, bag_size: 3618
batch 199, loss: 0.2581, instance_loss: 0.2025, weighted_loss: 0.2414, label: 2, bag_size: 4056
batch 219, loss: 0.1144, instance_loss: 0.2324, weighted_loss: 0.1498, label: 0, bag_size: 4678
batch 239, loss: 0.0049, instance_loss: 0.0534, weighted_loss: 0.0194, label: 0, bag_size: 4855
batch 259, loss: 1.2082, instance_loss: 0.5888, weighted_loss: 1.0224, label: 2, bag_size: 5914
batch 279, loss: 0.0001, instance_loss: 0.2212, weighted_loss: 0.0664, label: 2, bag_size: 4140
batch 299, loss: 0.8264, instance_loss: 0.8511, weighted_loss: 0.8338, label: 1, bag_size: 1327
batch 319, loss: 0.0592, instance_loss: 0.4332, weighted_loss: 0.1714, label: 1, bag_size: 4373
batch 339, loss: 0.0117, instance_loss: 0.3211, weighted_loss: 0.1045, label: 0, bag_size: 5646
batch 359, loss: 0.5126, instance_loss: 0.1653, weighted_loss: 0.4084, label: 0, bag_size: 5108
batch 379, loss: 0.0307, instance_loss: 0.3525, weighted_loss: 0.1273, label: 0, bag_size: 471
batch 399, loss: 0.8185, instance_loss: 0.5961, weighted_loss: 0.7518, label: 1, bag_size: 1860
batch 419, loss: 0.0001, instance_loss: 1.1240, weighted_loss: 0.3373, label: 0, bag_size: 1645
batch 439, loss: 0.0628, instance_loss: 0.3449, weighted_loss: 0.1474, label: 0, bag_size: 4719
batch 459, loss: 0.0310, instance_loss: 0.1782, weighted_loss: 0.0752, label: 0, bag_size: 6765
batch 479, loss: 0.0279, instance_loss: 0.5887, weighted_loss: 0.1961, label: 2, bag_size: 3607
batch 499, loss: 0.5393, instance_loss: 0.4827, weighted_loss: 0.5223, label: 2, bag_size: 3112
batch 519, loss: 0.1936, instance_loss: 0.2595, weighted_loss: 0.2134, label: 2, bag_size: 2561
batch 539, loss: 0.1799, instance_loss: 0.2775, weighted_loss: 0.2092, label: 1, bag_size: 3322
batch 559, loss: 0.0002, instance_loss: 1.6522, weighted_loss: 0.4958, label: 1, bag_size: 5084
batch 579, loss: 0.0111, instance_loss: 0.1613, weighted_loss: 0.0562, label: 2, bag_size: 5011
batch 599, loss: 1.2637, instance_loss: 0.9550, weighted_loss: 1.1711, label: 2, bag_size: 22464
batch 619, loss: 0.0044, instance_loss: 0.6324, weighted_loss: 0.1928, label: 1, bag_size: 4898
batch 639, loss: 0.0359, instance_loss: 0.2784, weighted_loss: 0.1086, label: 2, bag_size: 614
batch 659, loss: 0.0386, instance_loss: 0.2269, weighted_loss: 0.0951, label: 1, bag_size: 596
batch 679, loss: 0.3523, instance_loss: 0.6137, weighted_loss: 0.4308, label: 1, bag_size: 1510
batch 699, loss: 0.0764, instance_loss: 0.6380, weighted_loss: 0.2449, label: 1, bag_size: 4705
batch 719, loss: 0.0069, instance_loss: 0.0711, weighted_loss: 0.0261, label: 2, bag_size: 5138
batch 739, loss: 0.0116, instance_loss: 0.3461, weighted_loss: 0.1119, label: 1, bag_size: 3051


class 0 clustering acc 0.9666107382550335: correct 17283/17880
class 1 clustering acc 0.4313758389261745: correct 2571/5960
Epoch: 48, train_loss: 0.4232, train_clustering_loss:  0.5213, train_error: 0.1866
class 0: acc 0.861003861003861, correct 223/259
class 1: acc 0.7224489795918367, correct 177/245
class 2: acc 0.8547717842323651, correct 206/241

Val Set, val_loss: 0.8170, val_error: 0.3085, auc: 0.8586
class 0 clustering acc 0.9352836879432624: correct 2110/2256
class 1 clustering acc 0.4627659574468085: correct 348/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4067, instance_loss: 0.2771, weighted_loss: 0.3678, label: 2, bag_size: 3026
batch 39, loss: 0.0188, instance_loss: 0.1096, weighted_loss: 0.0460, label: 0, bag_size: 4918
batch 59, loss: 2.1370, instance_loss: 1.4372, weighted_loss: 1.9270, label: 2, bag_size: 4179
batch 79, loss: 0.0491, instance_loss: 0.4894, weighted_loss: 0.1812, label: 2, bag_size: 3810
batch 99, loss: 0.0577, instance_loss: 0.2115, weighted_loss: 0.1038, label: 2, bag_size: 3678
batch 119, loss: 0.0000, instance_loss: 0.1770, weighted_loss: 0.0531, label: 1, bag_size: 5760
batch 139, loss: 0.0847, instance_loss: 0.4473, weighted_loss: 0.1935, label: 1, bag_size: 4373
batch 159, loss: 0.1025, instance_loss: 0.2602, weighted_loss: 0.1498, label: 0, bag_size: 2601
batch 179, loss: 0.4620, instance_loss: 0.7713, weighted_loss: 0.5548, label: 1, bag_size: 4467
batch 199, loss: 0.0989, instance_loss: 0.2215, weighted_loss: 0.1357, label: 2, bag_size: 2481
batch 219, loss: 0.6921, instance_loss: 0.6823, weighted_loss: 0.6892, label: 1, bag_size: 3391
batch 239, loss: 0.0179, instance_loss: 0.1954, weighted_loss: 0.0711, label: 2, bag_size: 4856
batch 259, loss: 0.0956, instance_loss: 0.3527, weighted_loss: 0.1727, label: 0, bag_size: 1049
batch 279, loss: 0.0436, instance_loss: 0.6899, weighted_loss: 0.2375, label: 0, bag_size: 1174
batch 299, loss: 0.0614, instance_loss: 0.2242, weighted_loss: 0.1102, label: 2, bag_size: 3080
batch 319, loss: 0.1272, instance_loss: 0.1604, weighted_loss: 0.1371, label: 2, bag_size: 3746
batch 339, loss: 0.0005, instance_loss: 0.1911, weighted_loss: 0.0577, label: 1, bag_size: 1836
batch 359, loss: 0.0086, instance_loss: 0.8195, weighted_loss: 0.2519, label: 0, bag_size: 3182
batch 379, loss: 0.2906, instance_loss: 0.3839, weighted_loss: 0.3186, label: 1, bag_size: 4262
batch 399, loss: 0.0240, instance_loss: 0.1665, weighted_loss: 0.0668, label: 2, bag_size: 1094
batch 419, loss: 1.3871, instance_loss: 0.5553, weighted_loss: 1.1376, label: 2, bag_size: 3534
batch 439, loss: 0.0104, instance_loss: 0.6523, weighted_loss: 0.2030, label: 1, bag_size: 3983
batch 459, loss: 1.6054, instance_loss: 1.1535, weighted_loss: 1.4699, label: 1, bag_size: 5880
batch 479, loss: 0.0260, instance_loss: 0.1632, weighted_loss: 0.0671, label: 2, bag_size: 2254
batch 499, loss: 0.0287, instance_loss: 0.1789, weighted_loss: 0.0738, label: 0, bag_size: 2094
batch 519, loss: 0.8402, instance_loss: 0.7717, weighted_loss: 0.8196, label: 2, bag_size: 5072
batch 539, loss: 0.1904, instance_loss: 0.6661, weighted_loss: 0.3331, label: 1, bag_size: 5003
batch 559, loss: 0.0001, instance_loss: 0.6991, weighted_loss: 0.2098, label: 1, bag_size: 4067
batch 579, loss: 0.0990, instance_loss: 0.2748, weighted_loss: 0.1518, label: 2, bag_size: 2049
batch 599, loss: 0.0264, instance_loss: 0.3223, weighted_loss: 0.1152, label: 0, bag_size: 3408
batch 619, loss: 0.0401, instance_loss: 0.2422, weighted_loss: 0.1007, label: 2, bag_size: 3396
batch 639, loss: 1.0564, instance_loss: 0.9421, weighted_loss: 1.0221, label: 0, bag_size: 1662
batch 659, loss: 0.1642, instance_loss: 1.0599, weighted_loss: 0.4329, label: 1, bag_size: 4145
batch 679, loss: 0.0497, instance_loss: 0.5138, weighted_loss: 0.1889, label: 0, bag_size: 3754
batch 699, loss: 1.6077, instance_loss: 0.6460, weighted_loss: 1.3192, label: 2, bag_size: 5472
batch 719, loss: 0.4605, instance_loss: 0.3723, weighted_loss: 0.4340, label: 2, bag_size: 3174
batch 739, loss: 0.0002, instance_loss: 0.7043, weighted_loss: 0.2114, label: 0, bag_size: 4083


class 0 clustering acc 0.9609619686800895: correct 17182/17880
class 1 clustering acc 0.401006711409396: correct 2390/5960
Epoch: 49, train_loss: 0.4657, train_clustering_loss:  0.5451, train_error: 0.1879
class 0: acc 0.8259109311740891, correct 204/247
class 1: acc 0.7586206896551724, correct 198/261
class 2: acc 0.8565400843881856, correct 203/237

Val Set, val_loss: 0.8356, val_error: 0.3511, auc: 0.8447
class 0 clustering acc 0.9419326241134752: correct 2125/2256
class 1 clustering acc 0.3603723404255319: correct 271/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0002, instance_loss: 0.5736, weighted_loss: 0.1722, label: 2, bag_size: 2031
batch 39, loss: 0.4934, instance_loss: 0.8191, weighted_loss: 0.5911, label: 0, bag_size: 4528
batch 59, loss: 2.6146, instance_loss: 1.3005, weighted_loss: 2.2204, label: 0, bag_size: 3419
batch 79, loss: 0.0000, instance_loss: 0.0024, weighted_loss: 0.0007, label: 0, bag_size: 4918
batch 99, loss: 0.3835, instance_loss: 0.3509, weighted_loss: 0.3737, label: 2, bag_size: 3026
batch 119, loss: 0.0002, instance_loss: 0.1731, weighted_loss: 0.0521, label: 0, bag_size: 5006
batch 139, loss: 0.0391, instance_loss: 0.2297, weighted_loss: 0.0963, label: 2, bag_size: 4555
batch 159, loss: 0.0373, instance_loss: 0.1989, weighted_loss: 0.0858, label: 2, bag_size: 3810
batch 179, loss: 0.8447, instance_loss: 1.0014, weighted_loss: 0.8917, label: 0, bag_size: 4719
batch 199, loss: 0.5362, instance_loss: 1.4801, weighted_loss: 0.8194, label: 1, bag_size: 3159
batch 219, loss: 0.0586, instance_loss: 0.2039, weighted_loss: 0.1022, label: 2, bag_size: 4372
batch 239, loss: 0.5470, instance_loss: 0.3475, weighted_loss: 0.4871, label: 2, bag_size: 3583
batch 259, loss: 0.3356, instance_loss: 0.8984, weighted_loss: 0.5044, label: 0, bag_size: 1655
batch 279, loss: 0.0118, instance_loss: 0.3716, weighted_loss: 0.1198, label: 0, bag_size: 1744
batch 299, loss: 0.0012, instance_loss: 0.8981, weighted_loss: 0.2702, label: 1, bag_size: 314
batch 319, loss: 0.6440, instance_loss: 1.0127, weighted_loss: 0.7546, label: 1, bag_size: 2481
batch 339, loss: 0.1175, instance_loss: 0.3825, weighted_loss: 0.1970, label: 0, bag_size: 4347
batch 359, loss: 0.6084, instance_loss: 0.4710, weighted_loss: 0.5672, label: 0, bag_size: 3061
batch 379, loss: 0.1197, instance_loss: 0.3604, weighted_loss: 0.1919, label: 2, bag_size: 3534
batch 399, loss: 0.2069, instance_loss: 0.3996, weighted_loss: 0.2647, label: 2, bag_size: 3026
batch 419, loss: 0.0288, instance_loss: 0.5335, weighted_loss: 0.1802, label: 2, bag_size: 3227
batch 439, loss: 0.4285, instance_loss: 0.4154, weighted_loss: 0.4245, label: 1, bag_size: 1066
batch 459, loss: 0.6448, instance_loss: 0.7845, weighted_loss: 0.6867, label: 1, bag_size: 7109
batch 479, loss: 0.0278, instance_loss: 0.4801, weighted_loss: 0.1635, label: 2, bag_size: 6001
batch 499, loss: 0.2370, instance_loss: 0.2970, weighted_loss: 0.2550, label: 2, bag_size: 3397
batch 519, loss: 0.7372, instance_loss: 0.5738, weighted_loss: 0.6882, label: 2, bag_size: 4140
batch 539, loss: 0.0000, instance_loss: 0.7090, weighted_loss: 0.2127, label: 0, bag_size: 5837
batch 559, loss: 0.2255, instance_loss: 0.1955, weighted_loss: 0.2165, label: 0, bag_size: 5041
batch 579, loss: 0.0239, instance_loss: 0.1488, weighted_loss: 0.0614, label: 1, bag_size: 796
batch 599, loss: 0.4707, instance_loss: 0.4860, weighted_loss: 0.4753, label: 0, bag_size: 4161
batch 619, loss: 0.5960, instance_loss: 0.7161, weighted_loss: 0.6321, label: 1, bag_size: 4612
batch 639, loss: 0.1062, instance_loss: 0.7167, weighted_loss: 0.2893, label: 1, bag_size: 2747
batch 659, loss: 0.1302, instance_loss: 0.6172, weighted_loss: 0.2763, label: 0, bag_size: 1018
batch 679, loss: 0.0860, instance_loss: 0.6606, weighted_loss: 0.2583, label: 1, bag_size: 2751
batch 699, loss: 0.0301, instance_loss: 0.4484, weighted_loss: 0.1556, label: 1, bag_size: 4705
batch 719, loss: 0.0018, instance_loss: 0.2521, weighted_loss: 0.0769, label: 0, bag_size: 1034
batch 739, loss: 0.0300, instance_loss: 0.2149, weighted_loss: 0.0855, label: 1, bag_size: 712


class 0 clustering acc 0.96582774049217: correct 17269/17880
class 1 clustering acc 0.38741610738255033: correct 2309/5960
Epoch: 50, train_loss: 0.4510, train_clustering_loss:  0.5330, train_error: 0.1772
class 0: acc 0.8355555555555556, correct 188/225
class 1: acc 0.7785714285714286, correct 218/280
class 2: acc 0.8625, correct 207/240

Val Set, val_loss: 0.7373, val_error: 0.3085, auc: 0.8809
class 0 clustering acc 0.9516843971631206: correct 2147/2256
class 1 clustering acc 0.3125: correct 235/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0025, instance_loss: 0.1418, weighted_loss: 0.0443, label: 1, bag_size: 3333
batch 39, loss: 0.9178, instance_loss: 1.0455, weighted_loss: 0.9561, label: 0, bag_size: 1289
batch 59, loss: 0.9126, instance_loss: 0.8207, weighted_loss: 0.8850, label: 2, bag_size: 3299
batch 79, loss: 0.2848, instance_loss: 0.6873, weighted_loss: 0.4056, label: 1, bag_size: 4467
batch 99, loss: 0.1444, instance_loss: 0.5057, weighted_loss: 0.2528, label: 1, bag_size: 3396
batch 119, loss: 0.8372, instance_loss: 0.8549, weighted_loss: 0.8425, label: 1, bag_size: 1327
batch 139, loss: 0.3570, instance_loss: 0.2680, weighted_loss: 0.3303, label: 0, bag_size: 4794
batch 159, loss: 0.5349, instance_loss: 0.8570, weighted_loss: 0.6315, label: 1, bag_size: 4258
batch 179, loss: 0.7153, instance_loss: 0.5151, weighted_loss: 0.6553, label: 0, bag_size: 4855
batch 199, loss: 0.2369, instance_loss: 0.6092, weighted_loss: 0.3486, label: 0, bag_size: 7927
batch 219, loss: 0.1097, instance_loss: 0.1930, weighted_loss: 0.1347, label: 0, bag_size: 6015
batch 239, loss: 0.3219, instance_loss: 0.6296, weighted_loss: 0.4142, label: 2, bag_size: 3172
batch 259, loss: 1.4690, instance_loss: 0.8846, weighted_loss: 1.2937, label: 0, bag_size: 2896
batch 279, loss: 0.0498, instance_loss: 0.1567, weighted_loss: 0.0819, label: 2, bag_size: 2254
batch 299, loss: 0.0958, instance_loss: 0.1644, weighted_loss: 0.1164, label: 1, bag_size: 4684
batch 319, loss: 0.2802, instance_loss: 0.6085, weighted_loss: 0.3786, label: 2, bag_size: 1050
batch 339, loss: 0.0519, instance_loss: 0.1004, weighted_loss: 0.0665, label: 0, bag_size: 5036
batch 359, loss: 0.0028, instance_loss: 0.2142, weighted_loss: 0.0662, label: 1, bag_size: 862
batch 379, loss: 0.0063, instance_loss: 0.3208, weighted_loss: 0.1006, label: 2, bag_size: 4745
batch 399, loss: 1.9072, instance_loss: 1.2803, weighted_loss: 1.7191, label: 1, bag_size: 5035
batch 419, loss: 0.1425, instance_loss: 0.2879, weighted_loss: 0.1861, label: 2, bag_size: 5011
batch 439, loss: 1.8477, instance_loss: 1.0566, weighted_loss: 1.6104, label: 0, bag_size: 3387
batch 459, loss: 0.0291, instance_loss: 0.0630, weighted_loss: 0.0393, label: 2, bag_size: 657
batch 479, loss: 0.6346, instance_loss: 1.0372, weighted_loss: 0.7554, label: 1, bag_size: 3604
batch 499, loss: 0.3134, instance_loss: 1.7043, weighted_loss: 0.7307, label: 0, bag_size: 2231
batch 519, loss: 0.1173, instance_loss: 0.8416, weighted_loss: 0.3346, label: 1, bag_size: 2229
batch 539, loss: 0.0728, instance_loss: 0.4190, weighted_loss: 0.1767, label: 0, bag_size: 1176
batch 559, loss: 0.3481, instance_loss: 1.1167, weighted_loss: 0.5787, label: 0, bag_size: 2069
batch 579, loss: 0.3148, instance_loss: 0.4134, weighted_loss: 0.3444, label: 1, bag_size: 1712
batch 599, loss: 0.0011, instance_loss: 0.5490, weighted_loss: 0.1655, label: 0, bag_size: 3182
batch 619, loss: 0.0360, instance_loss: 0.1624, weighted_loss: 0.0739, label: 0, bag_size: 3304
batch 639, loss: 0.1080, instance_loss: 0.2749, weighted_loss: 0.1581, label: 2, bag_size: 2359
batch 659, loss: 0.8720, instance_loss: 0.6566, weighted_loss: 0.8074, label: 1, bag_size: 5926
batch 679, loss: 0.0010, instance_loss: 0.5779, weighted_loss: 0.1741, label: 2, bag_size: 2031
batch 699, loss: 0.0118, instance_loss: 0.1714, weighted_loss: 0.0597, label: 0, bag_size: 4405
batch 719, loss: 0.1372, instance_loss: 0.3397, weighted_loss: 0.1980, label: 2, bag_size: 3778
batch 739, loss: 0.9004, instance_loss: 1.0594, weighted_loss: 0.9481, label: 1, bag_size: 869


class 0 clustering acc 0.9655480984340045: correct 17264/17880
class 1 clustering acc 0.38271812080536916: correct 2281/5960
Epoch: 51, train_loss: 0.4475, train_clustering_loss:  0.5366, train_error: 0.1933
class 0: acc 0.83984375, correct 215/256
class 1: acc 0.720164609053498, correct 175/243
class 2: acc 0.8577235772357723, correct 211/246

Val Set, val_loss: 0.6291, val_error: 0.2447, auc: 0.8941
class 0 clustering acc 0.9454787234042553: correct 2133/2256
class 1 clustering acc 0.44148936170212766: correct 332/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9275, instance_loss: 0.7188, weighted_loss: 0.8649, label: 1, bag_size: 1327
batch 39, loss: 0.7660, instance_loss: 0.7286, weighted_loss: 0.7548, label: 1, bag_size: 1097
batch 59, loss: 0.0183, instance_loss: 0.2035, weighted_loss: 0.0739, label: 2, bag_size: 4372
batch 79, loss: 3.9463, instance_loss: 1.5946, weighted_loss: 3.2408, label: 0, bag_size: 5259
batch 99, loss: 0.1692, instance_loss: 0.3948, weighted_loss: 0.2369, label: 2, bag_size: 2561
batch 119, loss: 0.3012, instance_loss: 0.4794, weighted_loss: 0.3547, label: 0, bag_size: 3075
batch 139, loss: 0.0902, instance_loss: 0.2004, weighted_loss: 0.1233, label: 2, bag_size: 3583
batch 159, loss: 0.0119, instance_loss: 0.0947, weighted_loss: 0.0367, label: 2, bag_size: 5138
batch 179, loss: 0.7859, instance_loss: 0.3126, weighted_loss: 0.6439, label: 0, bag_size: 3334
batch 199, loss: 0.0808, instance_loss: 0.8009, weighted_loss: 0.2969, label: 2, bag_size: 4141
batch 219, loss: 0.0628, instance_loss: 0.3583, weighted_loss: 0.1515, label: 2, bag_size: 4978
batch 239, loss: 0.9221, instance_loss: 0.9030, weighted_loss: 0.9164, label: 2, bag_size: 5072
batch 259, loss: 0.0671, instance_loss: 0.3674, weighted_loss: 0.1572, label: 2, bag_size: 4555
batch 279, loss: 0.0566, instance_loss: 0.2045, weighted_loss: 0.1010, label: 2, bag_size: 2209
batch 299, loss: 0.0515, instance_loss: 0.7121, weighted_loss: 0.2497, label: 0, bag_size: 6927
batch 319, loss: 0.0584, instance_loss: 0.2979, weighted_loss: 0.1302, label: 2, bag_size: 5017
batch 339, loss: 0.5985, instance_loss: 0.5916, weighted_loss: 0.5964, label: 0, bag_size: 2195
batch 359, loss: 0.9433, instance_loss: 0.8659, weighted_loss: 0.9200, label: 2, bag_size: 22464
batch 379, loss: 0.2216, instance_loss: 0.3365, weighted_loss: 0.2561, label: 2, bag_size: 2501
batch 399, loss: 0.0983, instance_loss: 0.6244, weighted_loss: 0.2561, label: 0, bag_size: 3904
batch 419, loss: 0.0154, instance_loss: 0.1060, weighted_loss: 0.0425, label: 2, bag_size: 6001
batch 439, loss: 0.1566, instance_loss: 0.2376, weighted_loss: 0.1809, label: 2, bag_size: 2209
batch 459, loss: 0.0355, instance_loss: 0.2241, weighted_loss: 0.0921, label: 0, bag_size: 3864
batch 479, loss: 0.0140, instance_loss: 0.1542, weighted_loss: 0.0561, label: 0, bag_size: 4165
batch 499, loss: 0.0625, instance_loss: 0.3110, weighted_loss: 0.1371, label: 0, bag_size: 3797
batch 519, loss: 0.1209, instance_loss: 0.4757, weighted_loss: 0.2274, label: 1, bag_size: 3885
batch 539, loss: 1.0330, instance_loss: 0.6105, weighted_loss: 0.9062, label: 2, bag_size: 3026
batch 559, loss: 0.0016, instance_loss: 0.2696, weighted_loss: 0.0820, label: 2, bag_size: 5037
batch 579, loss: 0.0594, instance_loss: 0.3191, weighted_loss: 0.1373, label: 0, bag_size: 3113
batch 599, loss: 0.0444, instance_loss: 0.3621, weighted_loss: 0.1397, label: 1, bag_size: 3640
batch 619, loss: 0.0007, instance_loss: 0.4269, weighted_loss: 0.1286, label: 2, bag_size: 5037
batch 639, loss: 0.2793, instance_loss: 0.5378, weighted_loss: 0.3568, label: 1, bag_size: 5512
batch 659, loss: 0.1041, instance_loss: 0.2506, weighted_loss: 0.1481, label: 2, bag_size: 3210
batch 679, loss: 0.0063, instance_loss: 0.0793, weighted_loss: 0.0282, label: 0, bag_size: 1845
batch 699, loss: 0.2710, instance_loss: 0.4705, weighted_loss: 0.3309, label: 1, bag_size: 2342
batch 719, loss: 0.0063, instance_loss: 0.1277, weighted_loss: 0.0427, label: 2, bag_size: 4856
batch 739, loss: 0.1141, instance_loss: 0.4929, weighted_loss: 0.2278, label: 0, bag_size: 3701


class 0 clustering acc 0.9681208053691275: correct 17310/17880
class 1 clustering acc 0.4040268456375839: correct 2408/5960
Epoch: 52, train_loss: 0.4390, train_clustering_loss:  0.5188, train_error: 0.1852
class 0: acc 0.8170212765957446, correct 192/235
class 1: acc 0.7424242424242424, correct 196/264
class 2: acc 0.8902439024390244, correct 219/246

Val Set, val_loss: 0.7477, val_error: 0.3298, auc: 0.8812
class 0 clustering acc 0.9468085106382979: correct 2136/2256
class 1 clustering acc 0.3816489361702128: correct 287/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5319, instance_loss: 0.5977, weighted_loss: 0.5517, label: 0, bag_size: 1373
batch 39, loss: 0.4948, instance_loss: 0.5250, weighted_loss: 0.5039, label: 2, bag_size: 1094
batch 59, loss: 0.0292, instance_loss: 0.3537, weighted_loss: 0.1265, label: 1, bag_size: 2919
batch 79, loss: 0.0914, instance_loss: 0.4731, weighted_loss: 0.2059, label: 1, bag_size: 2494
batch 99, loss: 0.1404, instance_loss: 0.6614, weighted_loss: 0.2967, label: 1, bag_size: 5340
batch 119, loss: 0.1191, instance_loss: 0.6574, weighted_loss: 0.2806, label: 1, bag_size: 5340
batch 139, loss: 0.0364, instance_loss: 0.4335, weighted_loss: 0.1555, label: 0, bag_size: 1545
batch 159, loss: 0.0759, instance_loss: 0.2948, weighted_loss: 0.1416, label: 2, bag_size: 1094
batch 179, loss: 0.4523, instance_loss: 0.8206, weighted_loss: 0.5628, label: 0, bag_size: 7056
batch 199, loss: 0.1652, instance_loss: 0.9702, weighted_loss: 0.4067, label: 1, bag_size: 1608
batch 219, loss: 0.5826, instance_loss: 0.8625, weighted_loss: 0.6666, label: 1, bag_size: 5728
batch 239, loss: 0.5341, instance_loss: 0.7034, weighted_loss: 0.5849, label: 1, bag_size: 4599
batch 259, loss: 0.1553, instance_loss: 0.6739, weighted_loss: 0.3109, label: 0, bag_size: 1018
batch 279, loss: 1.2331, instance_loss: 0.8306, weighted_loss: 1.1124, label: 1, bag_size: 5276
batch 299, loss: 1.3753, instance_loss: 0.6865, weighted_loss: 1.1687, label: 2, bag_size: 3112
batch 319, loss: 0.7185, instance_loss: 0.9421, weighted_loss: 0.7856, label: 1, bag_size: 5873
batch 339, loss: 0.0834, instance_loss: 0.2581, weighted_loss: 0.1358, label: 0, bag_size: 4562
batch 359, loss: 0.4411, instance_loss: 0.4461, weighted_loss: 0.4426, label: 2, bag_size: 4291
batch 379, loss: 0.0853, instance_loss: 0.2930, weighted_loss: 0.1476, label: 0, bag_size: 2339
batch 399, loss: 1.6370, instance_loss: 1.0751, weighted_loss: 1.4685, label: 1, bag_size: 9099
batch 419, loss: 0.0057, instance_loss: 0.2909, weighted_loss: 0.0913, label: 1, bag_size: 2453
batch 439, loss: 0.1897, instance_loss: 0.3054, weighted_loss: 0.2244, label: 2, bag_size: 3274
batch 459, loss: 0.0642, instance_loss: 0.2885, weighted_loss: 0.1315, label: 0, bag_size: 4644
batch 479, loss: 0.0618, instance_loss: 0.3408, weighted_loss: 0.1455, label: 0, bag_size: 667
batch 499, loss: 0.9937, instance_loss: 0.7954, weighted_loss: 0.9342, label: 2, bag_size: 552
batch 519, loss: 1.6678, instance_loss: 1.3221, weighted_loss: 1.5641, label: 1, bag_size: 869
batch 539, loss: 0.0001, instance_loss: 0.5821, weighted_loss: 0.1747, label: 1, bag_size: 4134
batch 559, loss: 0.0686, instance_loss: 0.1932, weighted_loss: 0.1060, label: 2, bag_size: 4775
batch 579, loss: 0.1188, instance_loss: 0.3637, weighted_loss: 0.1922, label: 0, bag_size: 4455
batch 599, loss: 0.1651, instance_loss: 0.5964, weighted_loss: 0.2945, label: 2, bag_size: 223
batch 619, loss: 0.0822, instance_loss: 0.2575, weighted_loss: 0.1348, label: 1, bag_size: 440
batch 639, loss: 0.5302, instance_loss: 0.6767, weighted_loss: 0.5741, label: 1, bag_size: 1607
batch 659, loss: 0.0870, instance_loss: 0.2686, weighted_loss: 0.1414, label: 0, bag_size: 2392
batch 679, loss: 0.0745, instance_loss: 0.2031, weighted_loss: 0.1130, label: 2, bag_size: 4056
batch 699, loss: 0.0010, instance_loss: 0.0828, weighted_loss: 0.0256, label: 1, bag_size: 7135
batch 719, loss: 0.1707, instance_loss: 0.3223, weighted_loss: 0.2162, label: 2, bag_size: 3778
batch 739, loss: 0.1043, instance_loss: 0.7001, weighted_loss: 0.2831, label: 0, bag_size: 3664


class 0 clustering acc 0.9641498881431767: correct 17239/17880
class 1 clustering acc 0.3907718120805369: correct 2329/5960
Epoch: 53, train_loss: 0.4232, train_clustering_loss:  0.5335, train_error: 0.1664
class 0: acc 0.8, correct 192/240
class 1: acc 0.8191881918819188, correct 222/271
class 2: acc 0.8846153846153846, correct 207/234

Val Set, val_loss: 0.7769, val_error: 0.2660, auc: 0.8656
class 0 clustering acc 0.9131205673758865: correct 2060/2256
class 1 clustering acc 0.4321808510638298: correct 325/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4980, instance_loss: 0.4412, weighted_loss: 0.4810, label: 2, bag_size: 597
batch 39, loss: 0.5255, instance_loss: 0.6159, weighted_loss: 0.5526, label: 2, bag_size: 5426
batch 59, loss: 0.2328, instance_loss: 0.5513, weighted_loss: 0.3283, label: 1, bag_size: 3322
batch 79, loss: 0.0352, instance_loss: 0.3398, weighted_loss: 0.1266, label: 1, bag_size: 8482
batch 99, loss: 0.2853, instance_loss: 0.4100, weighted_loss: 0.3227, label: 0, bag_size: 4251
batch 119, loss: 0.0218, instance_loss: 0.2810, weighted_loss: 0.0995, label: 0, bag_size: 1233
batch 139, loss: 0.5143, instance_loss: 0.9202, weighted_loss: 0.6361, label: 1, bag_size: 1250
batch 159, loss: 0.0454, instance_loss: 0.2252, weighted_loss: 0.0994, label: 2, bag_size: 3618
batch 179, loss: 0.0000, instance_loss: 0.7128, weighted_loss: 0.2138, label: 1, bag_size: 4181
batch 199, loss: 0.1164, instance_loss: 0.1590, weighted_loss: 0.1292, label: 2, bag_size: 4043
batch 219, loss: 0.0205, instance_loss: 0.1199, weighted_loss: 0.0503, label: 0, bag_size: 4918
batch 239, loss: 0.0408, instance_loss: 0.1601, weighted_loss: 0.0766, label: 2, bag_size: 6001
batch 259, loss: 0.0072, instance_loss: 0.1960, weighted_loss: 0.0638, label: 2, bag_size: 5017
batch 279, loss: 0.0068, instance_loss: 0.0942, weighted_loss: 0.0330, label: 0, bag_size: 1194
batch 299, loss: 0.5254, instance_loss: 0.6259, weighted_loss: 0.5555, label: 1, bag_size: 11768
batch 319, loss: 0.0014, instance_loss: 0.1157, weighted_loss: 0.0357, label: 1, bag_size: 4578
batch 339, loss: 0.0022, instance_loss: 0.4954, weighted_loss: 0.1502, label: 2, bag_size: 4497
batch 359, loss: 1.5724, instance_loss: 1.0973, weighted_loss: 1.4299, label: 0, bag_size: 4509
batch 379, loss: 2.0141, instance_loss: 1.0707, weighted_loss: 1.7311, label: 0, bag_size: 455
batch 399, loss: 0.0625, instance_loss: 0.3452, weighted_loss: 0.1473, label: 2, bag_size: 2770
batch 419, loss: 0.0983, instance_loss: 0.4369, weighted_loss: 0.1999, label: 0, bag_size: 3191
batch 439, loss: 0.0637, instance_loss: 0.8668, weighted_loss: 0.3047, label: 1, bag_size: 3995
batch 459, loss: 1.1251, instance_loss: 0.7402, weighted_loss: 1.0096, label: 1, bag_size: 1371
batch 479, loss: 0.0334, instance_loss: 0.2282, weighted_loss: 0.0918, label: 2, bag_size: 4132
batch 499, loss: 0.0129, instance_loss: 0.1093, weighted_loss: 0.0418, label: 2, bag_size: 3121
batch 519, loss: 0.0067, instance_loss: 0.7760, weighted_loss: 0.2375, label: 0, bag_size: 3182
batch 539, loss: 0.0868, instance_loss: 0.4031, weighted_loss: 0.1817, label: 2, bag_size: 4141
batch 559, loss: 0.0465, instance_loss: 0.2074, weighted_loss: 0.0948, label: 2, bag_size: 2049
batch 579, loss: 0.5304, instance_loss: 1.0708, weighted_loss: 0.6925, label: 0, bag_size: 3833
batch 599, loss: 0.0334, instance_loss: 0.2450, weighted_loss: 0.0969, label: 0, bag_size: 2841
batch 619, loss: 1.3248, instance_loss: 0.7253, weighted_loss: 1.1450, label: 1, bag_size: 3746
batch 639, loss: 0.0036, instance_loss: 0.2899, weighted_loss: 0.0894, label: 1, bag_size: 2796
batch 659, loss: 0.0176, instance_loss: 0.4558, weighted_loss: 0.1490, label: 1, bag_size: 5833
batch 679, loss: 0.2181, instance_loss: 0.7089, weighted_loss: 0.3654, label: 1, bag_size: 2122
batch 699, loss: 0.0020, instance_loss: 0.3209, weighted_loss: 0.0976, label: 2, bag_size: 4088
batch 719, loss: 0.1829, instance_loss: 0.8057, weighted_loss: 0.3697, label: 1, bag_size: 209
batch 739, loss: 0.0926, instance_loss: 0.6236, weighted_loss: 0.2519, label: 1, bag_size: 3225


class 0 clustering acc 0.9661633109619687: correct 17275/17880
class 1 clustering acc 0.4453020134228188: correct 2654/5960
Epoch: 54, train_loss: 0.4157, train_clustering_loss:  0.5130, train_error: 0.1705
class 0: acc 0.8532818532818532, correct 221/259
class 1: acc 0.7296137339055794, correct 170/233
class 2: acc 0.8972332015810277, correct 227/253

Val Set, val_loss: 0.7709, val_error: 0.2979, auc: 0.8672
class 0 clustering acc 0.93572695035461: correct 2111/2256
class 1 clustering acc 0.4734042553191489: correct 356/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2920, instance_loss: 0.6140, weighted_loss: 0.3886, label: 1, bag_size: 4467
batch 39, loss: 0.0363, instance_loss: 0.6707, weighted_loss: 0.2266, label: 1, bag_size: 4705
batch 59, loss: 2.2781, instance_loss: 0.9645, weighted_loss: 1.8840, label: 0, bag_size: 1774
batch 79, loss: 0.6045, instance_loss: 1.8614, weighted_loss: 0.9815, label: 1, bag_size: 3791
batch 99, loss: 0.5711, instance_loss: 0.7443, weighted_loss: 0.6231, label: 0, bag_size: 609
batch 119, loss: 0.0146, instance_loss: 0.1184, weighted_loss: 0.0458, label: 2, bag_size: 1094
batch 139, loss: 0.4102, instance_loss: 0.3608, weighted_loss: 0.3953, label: 0, bag_size: 2378
batch 159, loss: 0.0334, instance_loss: 0.1621, weighted_loss: 0.0720, label: 2, bag_size: 6001
batch 179, loss: 0.0911, instance_loss: 0.4729, weighted_loss: 0.2056, label: 1, bag_size: 3225
batch 199, loss: 0.0082, instance_loss: 0.1602, weighted_loss: 0.0538, label: 2, bag_size: 4856
batch 219, loss: 0.2751, instance_loss: 0.4620, weighted_loss: 0.3311, label: 2, bag_size: 3778
batch 239, loss: 0.0336, instance_loss: 0.2550, weighted_loss: 0.1000, label: 2, bag_size: 4372
batch 259, loss: 0.1084, instance_loss: 0.5688, weighted_loss: 0.2465, label: 1, bag_size: 3558
batch 279, loss: 1.8237, instance_loss: 0.6823, weighted_loss: 1.4813, label: 2, bag_size: 5307
batch 299, loss: 0.2055, instance_loss: 0.7001, weighted_loss: 0.3539, label: 1, bag_size: 4705
batch 319, loss: 1.3499, instance_loss: 0.8670, weighted_loss: 1.2050, label: 2, bag_size: 4291
batch 339, loss: 0.0902, instance_loss: 0.3910, weighted_loss: 0.1804, label: 2, bag_size: 4291
batch 359, loss: 0.0041, instance_loss: 0.6476, weighted_loss: 0.1972, label: 1, bag_size: 2493
batch 379, loss: 0.0437, instance_loss: 0.4013, weighted_loss: 0.1509, label: 1, bag_size: 4534
batch 399, loss: 1.1995, instance_loss: 0.6295, weighted_loss: 1.0285, label: 2, bag_size: 3112
batch 419, loss: 0.0187, instance_loss: 0.1605, weighted_loss: 0.0612, label: 0, bag_size: 4905
batch 439, loss: 0.0874, instance_loss: 0.6238, weighted_loss: 0.2483, label: 0, bag_size: 1933
batch 459, loss: 0.0858, instance_loss: 0.4466, weighted_loss: 0.1940, label: 2, bag_size: 724
batch 479, loss: 0.3217, instance_loss: 0.6539, weighted_loss: 0.4213, label: 1, bag_size: 2865
batch 499, loss: 0.2247, instance_loss: 1.0336, weighted_loss: 0.4674, label: 0, bag_size: 5656
batch 519, loss: 0.3216, instance_loss: 0.6641, weighted_loss: 0.4244, label: 1, bag_size: 3322
batch 539, loss: 0.1763, instance_loss: 0.6408, weighted_loss: 0.3156, label: 1, bag_size: 3558
batch 559, loss: 0.1814, instance_loss: 0.6861, weighted_loss: 0.3328, label: 1, bag_size: 1528
batch 579, loss: 0.0028, instance_loss: 0.4272, weighted_loss: 0.1301, label: 0, bag_size: 2824
batch 599, loss: 0.0421, instance_loss: 0.2242, weighted_loss: 0.0967, label: 2, bag_size: 4162
batch 619, loss: 1.0047, instance_loss: 1.4822, weighted_loss: 1.1479, label: 0, bag_size: 3419
batch 639, loss: 0.9018, instance_loss: 0.7690, weighted_loss: 0.8619, label: 1, bag_size: 1327
batch 659, loss: 2.9597, instance_loss: 1.3451, weighted_loss: 2.4753, label: 1, bag_size: 5423
batch 679, loss: 0.0263, instance_loss: 0.2742, weighted_loss: 0.1007, label: 0, bag_size: 1233
batch 699, loss: 0.2237, instance_loss: 0.4338, weighted_loss: 0.2867, label: 0, bag_size: 4524
batch 719, loss: 1.1171, instance_loss: 0.7277, weighted_loss: 1.0003, label: 1, bag_size: 5197
batch 739, loss: 0.0000, instance_loss: 0.2437, weighted_loss: 0.0731, label: 2, bag_size: 2422


class 0 clustering acc 0.9687919463087248: correct 17322/17880
class 1 clustering acc 0.40570469798657716: correct 2418/5960
Epoch: 55, train_loss: 0.4213, train_clustering_loss:  0.5212, train_error: 0.1691
class 0: acc 0.8122448979591836, correct 199/245
class 1: acc 0.8110236220472441, correct 206/254
class 2: acc 0.8699186991869918, correct 214/246

Val Set, val_loss: 0.6461, val_error: 0.2340, auc: 0.8790
class 0 clustering acc 0.9414893617021277: correct 2124/2256
class 1 clustering acc 0.4015957446808511: correct 302/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0004, instance_loss: 0.2111, weighted_loss: 0.0636, label: 2, bag_size: 4569
batch 39, loss: 0.0318, instance_loss: 0.1094, weighted_loss: 0.0551, label: 0, bag_size: 2873
batch 59, loss: 0.0008, instance_loss: 0.0542, weighted_loss: 0.0168, label: 1, bag_size: 3338
batch 79, loss: 0.0148, instance_loss: 0.9055, weighted_loss: 0.2820, label: 1, bag_size: 3159
batch 99, loss: 0.2466, instance_loss: 0.3290, weighted_loss: 0.2713, label: 2, bag_size: 2209
batch 119, loss: 0.1510, instance_loss: 0.3293, weighted_loss: 0.2045, label: 2, bag_size: 3618
batch 139, loss: 0.0281, instance_loss: 0.2213, weighted_loss: 0.0861, label: 1, bag_size: 3322
batch 159, loss: 0.0001, instance_loss: 0.2341, weighted_loss: 0.0703, label: 1, bag_size: 2493
batch 179, loss: 0.7679, instance_loss: 1.5727, weighted_loss: 1.0093, label: 0, bag_size: 996
batch 199, loss: 2.1861, instance_loss: 0.9587, weighted_loss: 1.8179, label: 1, bag_size: 5693
batch 219, loss: 0.0014, instance_loss: 0.0808, weighted_loss: 0.0252, label: 2, bag_size: 4910
batch 239, loss: 0.0210, instance_loss: 0.1253, weighted_loss: 0.0523, label: 0, bag_size: 4741
batch 259, loss: 0.4697, instance_loss: 0.3811, weighted_loss: 0.4431, label: 0, bag_size: 23335
batch 279, loss: 0.0271, instance_loss: 0.7281, weighted_loss: 0.2374, label: 0, bag_size: 3864
batch 299, loss: 0.0377, instance_loss: 0.5508, weighted_loss: 0.1916, label: 0, bag_size: 4274
batch 319, loss: 0.0001, instance_loss: 0.8408, weighted_loss: 0.2523, label: 1, bag_size: 4067
batch 339, loss: 0.0293, instance_loss: 0.3439, weighted_loss: 0.1236, label: 1, bag_size: 3885
batch 359, loss: 0.0073, instance_loss: 0.0633, weighted_loss: 0.0241, label: 0, bag_size: 1947
batch 379, loss: 0.0650, instance_loss: 0.3332, weighted_loss: 0.1454, label: 2, bag_size: 4132
batch 399, loss: 0.0453, instance_loss: 0.1283, weighted_loss: 0.0702, label: 0, bag_size: 5036
batch 419, loss: 3.5812, instance_loss: 1.4445, weighted_loss: 2.9402, label: 2, bag_size: 2326
batch 439, loss: 0.0032, instance_loss: 0.2467, weighted_loss: 0.0762, label: 0, bag_size: 1034
batch 459, loss: 1.5908, instance_loss: 1.0968, weighted_loss: 1.4426, label: 1, bag_size: 2859
batch 479, loss: 2.3734, instance_loss: 1.3199, weighted_loss: 2.0574, label: 1, bag_size: 5035
batch 499, loss: 0.1040, instance_loss: 0.4682, weighted_loss: 0.2133, label: 0, bag_size: 3038
batch 519, loss: 0.1225, instance_loss: 0.4747, weighted_loss: 0.2282, label: 0, bag_size: 3268
batch 539, loss: 0.0018, instance_loss: 0.6075, weighted_loss: 0.1835, label: 2, bag_size: 2031
batch 559, loss: 0.1057, instance_loss: 0.8601, weighted_loss: 0.3321, label: 0, bag_size: 5015
batch 579, loss: 1.4736, instance_loss: 0.7196, weighted_loss: 1.2474, label: 0, bag_size: 1695
batch 599, loss: 0.0261, instance_loss: 0.1014, weighted_loss: 0.0487, label: 0, bag_size: 4455
batch 619, loss: 0.1057, instance_loss: 0.3544, weighted_loss: 0.1803, label: 2, bag_size: 5307
batch 639, loss: 0.0265, instance_loss: 0.3648, weighted_loss: 0.1280, label: 2, bag_size: 3618
batch 659, loss: 0.0338, instance_loss: 0.5851, weighted_loss: 0.1992, label: 0, bag_size: 1006
batch 679, loss: 0.0314, instance_loss: 0.2685, weighted_loss: 0.1025, label: 2, bag_size: 4978
batch 699, loss: 0.6079, instance_loss: 1.3272, weighted_loss: 0.8236, label: 1, bag_size: 2744
batch 719, loss: 0.0573, instance_loss: 0.1091, weighted_loss: 0.0729, label: 0, bag_size: 3641
batch 739, loss: 0.3473, instance_loss: 0.6008, weighted_loss: 0.4233, label: 1, bag_size: 5926


class 0 clustering acc 0.9637024608501119: correct 17231/17880
class 1 clustering acc 0.47130872483221475: correct 2809/5960
Epoch: 56, train_loss: 0.4004, train_clustering_loss:  0.4888, train_error: 0.1570
class 0: acc 0.8932806324110671, correct 226/253
class 1: acc 0.7907949790794979, correct 189/239
class 2: acc 0.841897233201581, correct 213/253

Val Set, val_loss: 0.6517, val_error: 0.2660, auc: 0.8853
class 0 clustering acc 0.9556737588652482: correct 2156/2256
class 1 clustering acc 0.39361702127659576: correct 296/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0000, instance_loss: 0.1773, weighted_loss: 0.0532, label: 1, bag_size: 5018
batch 39, loss: 0.5938, instance_loss: 0.8807, weighted_loss: 0.6799, label: 2, bag_size: 223
batch 59, loss: 0.1843, instance_loss: 0.5221, weighted_loss: 0.2856, label: 2, bag_size: 728
batch 79, loss: 0.0019, instance_loss: 0.0527, weighted_loss: 0.0172, label: 0, bag_size: 4783
batch 99, loss: 0.0007, instance_loss: 0.2404, weighted_loss: 0.0726, label: 2, bag_size: 2422
batch 119, loss: 0.0695, instance_loss: 0.2745, weighted_loss: 0.1310, label: 0, bag_size: 3586
batch 139, loss: 0.2842, instance_loss: 0.7463, weighted_loss: 0.4228, label: 2, bag_size: 1543
batch 159, loss: 0.1370, instance_loss: 0.3506, weighted_loss: 0.2011, label: 1, bag_size: 11768
batch 179, loss: 2.1735, instance_loss: 0.9382, weighted_loss: 1.8029, label: 1, bag_size: 32
batch 199, loss: 0.0963, instance_loss: 0.1452, weighted_loss: 0.1110, label: 0, bag_size: 5500
batch 219, loss: 0.0243, instance_loss: 0.7297, weighted_loss: 0.2359, label: 0, bag_size: 5837
batch 239, loss: 0.0672, instance_loss: 0.2243, weighted_loss: 0.1143, label: 2, bag_size: 2481
batch 259, loss: 0.1998, instance_loss: 0.2880, weighted_loss: 0.2262, label: 2, bag_size: 6644
batch 279, loss: 3.3865, instance_loss: 1.7275, weighted_loss: 2.8888, label: 1, bag_size: 2425
batch 299, loss: 0.0000, instance_loss: 0.2591, weighted_loss: 0.0778, label: 1, bag_size: 10941
batch 319, loss: 1.4290, instance_loss: 0.3951, weighted_loss: 1.1188, label: 0, bag_size: 4647
batch 339, loss: 0.2314, instance_loss: 0.4254, weighted_loss: 0.2896, label: 0, bag_size: 3224
batch 359, loss: 2.0181, instance_loss: 1.1105, weighted_loss: 1.7458, label: 1, bag_size: 4258
batch 379, loss: 0.2005, instance_loss: 0.2006, weighted_loss: 0.2005, label: 0, bag_size: 4909
batch 399, loss: 0.0078, instance_loss: 0.1512, weighted_loss: 0.0509, label: 2, bag_size: 4088
batch 419, loss: 0.1009, instance_loss: 0.5081, weighted_loss: 0.2230, label: 2, bag_size: 552
batch 439, loss: 1.3481, instance_loss: 0.8588, weighted_loss: 1.2013, label: 1, bag_size: 2055
batch 459, loss: 0.1684, instance_loss: 0.4126, weighted_loss: 0.2417, label: 0, bag_size: 2153
batch 479, loss: 0.0087, instance_loss: 0.3798, weighted_loss: 0.1200, label: 0, bag_size: 1006
batch 499, loss: 0.0718, instance_loss: 0.2264, weighted_loss: 0.1182, label: 2, bag_size: 6298
batch 519, loss: 0.0473, instance_loss: 0.2269, weighted_loss: 0.1012, label: 0, bag_size: 4584
batch 539, loss: 0.1039, instance_loss: 0.6309, weighted_loss: 0.2620, label: 1, bag_size: 3619
batch 559, loss: 0.0184, instance_loss: 0.6405, weighted_loss: 0.2050, label: 1, bag_size: 582
batch 579, loss: 0.3176, instance_loss: 0.6870, weighted_loss: 0.4284, label: 1, bag_size: 1607
batch 599, loss: 0.0982, instance_loss: 0.5637, weighted_loss: 0.2378, label: 1, bag_size: 3640
batch 619, loss: 0.3706, instance_loss: 0.9976, weighted_loss: 0.5587, label: 1, bag_size: 5880
batch 639, loss: 0.0923, instance_loss: 0.7014, weighted_loss: 0.2750, label: 2, bag_size: 724
batch 659, loss: 0.0143, instance_loss: 0.1440, weighted_loss: 0.0532, label: 2, bag_size: 4043
batch 679, loss: 0.0480, instance_loss: 0.5150, weighted_loss: 0.1881, label: 1, bag_size: 2156
batch 699, loss: 0.4308, instance_loss: 0.3914, weighted_loss: 0.4190, label: 1, bag_size: 3296
batch 719, loss: 0.1605, instance_loss: 0.3672, weighted_loss: 0.2225, label: 2, bag_size: 4291
batch 739, loss: 0.1457, instance_loss: 0.9078, weighted_loss: 0.3743, label: 0, bag_size: 4398


class 0 clustering acc 0.9635346756152126: correct 17228/17880
class 1 clustering acc 0.4528523489932886: correct 2699/5960
Epoch: 57, train_loss: 0.3792, train_clustering_loss:  0.5018, train_error: 0.1463
class 0: acc 0.856, correct 214/250
class 1: acc 0.7933884297520661, correct 192/242
class 2: acc 0.9090909090909091, correct 230/253

Val Set, val_loss: 0.6983, val_error: 0.2766, auc: 0.8912
class 0 clustering acc 0.9375: correct 2115/2256
class 1 clustering acc 0.3523936170212766: correct 265/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0038, instance_loss: 0.1515, weighted_loss: 0.0481, label: 1, bag_size: 796
batch 39, loss: 0.3179, instance_loss: 0.7131, weighted_loss: 0.4364, label: 2, bag_size: 724
batch 59, loss: 0.2439, instance_loss: 0.3465, weighted_loss: 0.2747, label: 1, bag_size: 1221
batch 79, loss: 0.0001, instance_loss: 0.2779, weighted_loss: 0.0834, label: 2, bag_size: 2422
batch 99, loss: 1.4656, instance_loss: 1.1454, weighted_loss: 1.3695, label: 1, bag_size: 1964
batch 119, loss: 0.0080, instance_loss: 0.0751, weighted_loss: 0.0281, label: 0, bag_size: 1710
batch 139, loss: 0.0595, instance_loss: 0.2782, weighted_loss: 0.1251, label: 0, bag_size: 4570
batch 159, loss: 0.1734, instance_loss: 0.2484, weighted_loss: 0.1959, label: 0, bag_size: 3639
batch 179, loss: 0.1485, instance_loss: 0.4764, weighted_loss: 0.2469, label: 2, bag_size: 552
batch 199, loss: 0.2805, instance_loss: 0.4380, weighted_loss: 0.3278, label: 2, bag_size: 5637
batch 219, loss: 0.0027, instance_loss: 0.3790, weighted_loss: 0.1156, label: 2, bag_size: 4141
batch 239, loss: 0.3971, instance_loss: 0.5933, weighted_loss: 0.4559, label: 2, bag_size: 3227
batch 259, loss: 0.0000, instance_loss: 0.4362, weighted_loss: 0.1309, label: 1, bag_size: 3983
batch 279, loss: 0.6137, instance_loss: 0.5211, weighted_loss: 0.5859, label: 2, bag_size: 597
batch 299, loss: 0.0044, instance_loss: 0.2835, weighted_loss: 0.0881, label: 2, bag_size: 4140
batch 319, loss: 0.0000, instance_loss: 0.0005, weighted_loss: 0.0002, label: 0, bag_size: 5902
batch 339, loss: 0.0248, instance_loss: 0.1530, weighted_loss: 0.0633, label: 2, bag_size: 1094
batch 359, loss: 0.0489, instance_loss: 0.1705, weighted_loss: 0.0853, label: 0, bag_size: 4524
batch 379, loss: 0.1284, instance_loss: 0.3150, weighted_loss: 0.1844, label: 2, bag_size: 4555
batch 399, loss: 0.0200, instance_loss: 0.3562, weighted_loss: 0.1208, label: 0, bag_size: 1034
batch 419, loss: 0.0019, instance_loss: 0.5486, weighted_loss: 0.1659, label: 0, bag_size: 3182
batch 439, loss: 0.5754, instance_loss: 0.8199, weighted_loss: 0.6488, label: 2, bag_size: 361
batch 459, loss: 0.1881, instance_loss: 0.2280, weighted_loss: 0.2001, label: 2, bag_size: 4241
batch 479, loss: 1.5969, instance_loss: 0.8301, weighted_loss: 1.3669, label: 2, bag_size: 3274
batch 499, loss: 0.1946, instance_loss: 0.5554, weighted_loss: 0.3028, label: 1, bag_size: 5718
batch 519, loss: 0.0711, instance_loss: 0.3521, weighted_loss: 0.1554, label: 0, bag_size: 1385
batch 539, loss: 0.0150, instance_loss: 0.1378, weighted_loss: 0.0519, label: 2, bag_size: 2254
batch 559, loss: 0.0006, instance_loss: 0.3270, weighted_loss: 0.0985, label: 2, bag_size: 4497
batch 579, loss: 0.0389, instance_loss: 0.1798, weighted_loss: 0.0812, label: 2, bag_size: 4372
batch 599, loss: 0.0749, instance_loss: 0.3078, weighted_loss: 0.1447, label: 2, bag_size: 4978
batch 619, loss: 0.0758, instance_loss: 0.3971, weighted_loss: 0.1722, label: 1, bag_size: 3403
batch 639, loss: 0.0212, instance_loss: 0.0926, weighted_loss: 0.0427, label: 0, bag_size: 4783
batch 659, loss: 0.7935, instance_loss: 1.1784, weighted_loss: 0.9090, label: 0, bag_size: 889
batch 679, loss: 0.0495, instance_loss: 0.1262, weighted_loss: 0.0725, label: 2, bag_size: 2483
batch 699, loss: 1.0134, instance_loss: 1.2330, weighted_loss: 1.0792, label: 1, bag_size: 1307
batch 719, loss: 0.1544, instance_loss: 0.2069, weighted_loss: 0.1702, label: 2, bag_size: 4223
batch 739, loss: 0.0000, instance_loss: 0.1487, weighted_loss: 0.0446, label: 1, bag_size: 5364


class 0 clustering acc 0.9631991051454138: correct 17222/17880
class 1 clustering acc 0.45788590604026846: correct 2729/5960
Epoch: 58, train_loss: 0.3925, train_clustering_loss:  0.5107, train_error: 0.1517
class 0: acc 0.8425531914893617, correct 198/235
class 1: acc 0.7754237288135594, correct 183/236
class 2: acc 0.916058394160584, correct 251/274

Val Set, val_loss: 0.8669, val_error: 0.3085, auc: 0.8774
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.26595744680851063: correct 200/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2263, instance_loss: 0.2721, weighted_loss: 0.2401, label: 0, bag_size: 5871
batch 39, loss: 0.0102, instance_loss: 0.1400, weighted_loss: 0.0491, label: 0, bag_size: 1385
batch 59, loss: 0.0003, instance_loss: 0.2483, weighted_loss: 0.0747, label: 0, bag_size: 2853
batch 79, loss: 0.0111, instance_loss: 0.4731, weighted_loss: 0.1497, label: 2, bag_size: 3810
batch 99, loss: 0.0474, instance_loss: 0.1970, weighted_loss: 0.0923, label: 2, bag_size: 2313
batch 119, loss: 0.6604, instance_loss: 0.6374, weighted_loss: 0.6535, label: 0, bag_size: 22822
batch 139, loss: 0.3338, instance_loss: 0.5448, weighted_loss: 0.3971, label: 2, bag_size: 22464
batch 159, loss: 0.0350, instance_loss: 0.4428, weighted_loss: 0.1574, label: 2, bag_size: 2486
batch 179, loss: 0.6046, instance_loss: 1.0801, weighted_loss: 0.7472, label: 1, bag_size: 5880
batch 199, loss: 0.0069, instance_loss: 0.4075, weighted_loss: 0.1271, label: 1, bag_size: 5003
batch 219, loss: 0.0068, instance_loss: 0.1835, weighted_loss: 0.0598, label: 0, bag_size: 2841
batch 239, loss: 2.0476, instance_loss: 0.8380, weighted_loss: 1.6847, label: 0, bag_size: 4639
batch 259, loss: 0.0180, instance_loss: 0.1406, weighted_loss: 0.0548, label: 0, bag_size: 5757
batch 279, loss: 0.8055, instance_loss: 0.8233, weighted_loss: 0.8109, label: 2, bag_size: 361
batch 299, loss: 1.2598, instance_loss: 0.8001, weighted_loss: 1.1219, label: 0, bag_size: 2190
batch 319, loss: 0.0316, instance_loss: 0.5003, weighted_loss: 0.1722, label: 1, bag_size: 3221
batch 339, loss: 0.4360, instance_loss: 0.4289, weighted_loss: 0.4339, label: 2, bag_size: 3274
batch 359, loss: 0.9711, instance_loss: 1.0766, weighted_loss: 1.0028, label: 0, bag_size: 1562
batch 379, loss: 0.8713, instance_loss: 0.8661, weighted_loss: 0.8697, label: 1, bag_size: 3837
batch 399, loss: 0.3104, instance_loss: 0.6337, weighted_loss: 0.4074, label: 1, bag_size: 2744
batch 419, loss: 0.2791, instance_loss: 0.3612, weighted_loss: 0.3037, label: 2, bag_size: 3112
batch 439, loss: 1.7457, instance_loss: 0.9057, weighted_loss: 1.4937, label: 1, bag_size: 2614
batch 459, loss: 1.1707, instance_loss: 0.9702, weighted_loss: 1.1106, label: 2, bag_size: 22464
batch 479, loss: 0.0928, instance_loss: 0.3286, weighted_loss: 0.1635, label: 2, bag_size: 1094
batch 499, loss: 1.1433, instance_loss: 0.8221, weighted_loss: 1.0469, label: 2, bag_size: 361
batch 519, loss: 0.0607, instance_loss: 0.6402, weighted_loss: 0.2345, label: 1, bag_size: 1027
batch 539, loss: 0.3592, instance_loss: 0.4627, weighted_loss: 0.3903, label: 1, bag_size: 3425
batch 559, loss: 0.0878, instance_loss: 0.2450, weighted_loss: 0.1350, label: 0, bag_size: 2545
batch 579, loss: 0.0025, instance_loss: 0.1299, weighted_loss: 0.0407, label: 2, bag_size: 3094
batch 599, loss: 0.2761, instance_loss: 0.3699, weighted_loss: 0.3042, label: 2, bag_size: 3026
batch 619, loss: 0.0004, instance_loss: 0.2593, weighted_loss: 0.0780, label: 1, bag_size: 6315
batch 639, loss: 1.5046, instance_loss: 1.0301, weighted_loss: 1.3622, label: 1, bag_size: 2614
batch 659, loss: 0.1439, instance_loss: 0.2393, weighted_loss: 0.1725, label: 0, bag_size: 3936
batch 679, loss: 1.3262, instance_loss: 0.8080, weighted_loss: 1.1707, label: 2, bag_size: 4316
batch 699, loss: 0.2538, instance_loss: 0.6628, weighted_loss: 0.3765, label: 1, bag_size: 4940
batch 719, loss: 0.0042, instance_loss: 0.1781, weighted_loss: 0.0564, label: 0, bag_size: 1647
batch 739, loss: 0.0636, instance_loss: 0.4854, weighted_loss: 0.1901, label: 2, bag_size: 223


class 0 clustering acc 0.9638702460850112: correct 17234/17880
class 1 clustering acc 0.42533557046979864: correct 2535/5960
Epoch: 59, train_loss: 0.4457, train_clustering_loss:  0.5330, train_error: 0.1826
class 0: acc 0.8070866141732284, correct 205/254
class 1: acc 0.759493670886076, correct 180/237
class 2: acc 0.8818897637795275, correct 224/254

Val Set, val_loss: 0.6347, val_error: 0.2234, auc: 0.8850
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.23537234042553193: correct 177/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6492, instance_loss: 1.1629, weighted_loss: 0.8033, label: 0, bag_size: 609
batch 39, loss: 0.3149, instance_loss: 0.6598, weighted_loss: 0.4183, label: 2, bag_size: 5072
batch 59, loss: 0.0040, instance_loss: 0.3407, weighted_loss: 0.1050, label: 1, bag_size: 3333
batch 79, loss: 0.0000, instance_loss: 0.6742, weighted_loss: 0.2023, label: 1, bag_size: 4181
batch 99, loss: 0.5463, instance_loss: 0.7160, weighted_loss: 0.5972, label: 2, bag_size: 552
batch 119, loss: 0.4336, instance_loss: 0.8505, weighted_loss: 0.5587, label: 1, bag_size: 5011
batch 139, loss: 0.2012, instance_loss: 0.5322, weighted_loss: 0.3005, label: 1, bag_size: 2248
batch 159, loss: 1.7951, instance_loss: 0.8693, weighted_loss: 1.5173, label: 1, bag_size: 5197
batch 179, loss: 0.2139, instance_loss: 0.5103, weighted_loss: 0.3028, label: 1, bag_size: 2743
batch 199, loss: 0.1342, instance_loss: 0.4890, weighted_loss: 0.2406, label: 2, bag_size: 1050
batch 219, loss: 0.6755, instance_loss: 0.4520, weighted_loss: 0.6084, label: 2, bag_size: 3172
batch 239, loss: 0.0456, instance_loss: 0.2510, weighted_loss: 0.1072, label: 1, bag_size: 2962
batch 259, loss: 0.0234, instance_loss: 0.1666, weighted_loss: 0.0664, label: 2, bag_size: 6001
batch 279, loss: 0.1220, instance_loss: 0.2388, weighted_loss: 0.1571, label: 2, bag_size: 2501
batch 299, loss: 0.3099, instance_loss: 0.3141, weighted_loss: 0.3112, label: 2, bag_size: 2501
batch 319, loss: 1.5471, instance_loss: 1.2177, weighted_loss: 1.4483, label: 2, bag_size: 4179
batch 339, loss: 0.0168, instance_loss: 0.1368, weighted_loss: 0.0528, label: 2, bag_size: 2049
batch 359, loss: 0.8649, instance_loss: 0.6702, weighted_loss: 0.8065, label: 1, bag_size: 2753
batch 379, loss: 0.0012, instance_loss: 0.1107, weighted_loss: 0.0341, label: 0, bag_size: 4797
batch 399, loss: 0.0831, instance_loss: 0.3264, weighted_loss: 0.1561, label: 2, bag_size: 4978
batch 419, loss: 1.3485, instance_loss: 1.5782, weighted_loss: 1.4174, label: 1, bag_size: 5205
batch 439, loss: 0.0309, instance_loss: 0.8677, weighted_loss: 0.2820, label: 0, bag_size: 4725
batch 459, loss: 0.5711, instance_loss: 0.6872, weighted_loss: 0.6059, label: 1, bag_size: 3438
batch 479, loss: 0.0001, instance_loss: 0.2779, weighted_loss: 0.0835, label: 2, bag_size: 5017
batch 499, loss: 0.1146, instance_loss: 0.6264, weighted_loss: 0.2681, label: 1, bag_size: 11974
batch 519, loss: 0.0484, instance_loss: 0.2311, weighted_loss: 0.1032, label: 2, bag_size: 4088
batch 539, loss: 0.0679, instance_loss: 0.2346, weighted_loss: 0.1179, label: 0, bag_size: 2378
batch 559, loss: 0.0859, instance_loss: 0.5168, weighted_loss: 0.2152, label: 0, bag_size: 4146
batch 579, loss: 0.4235, instance_loss: 0.8599, weighted_loss: 0.5544, label: 2, bag_size: 724
batch 599, loss: 0.0105, instance_loss: 0.2444, weighted_loss: 0.0807, label: 0, bag_size: 3924
batch 619, loss: 0.1108, instance_loss: 0.4397, weighted_loss: 0.2095, label: 2, bag_size: 7607
batch 639, loss: 0.0555, instance_loss: 0.1641, weighted_loss: 0.0881, label: 2, bag_size: 3121
batch 659, loss: 0.0411, instance_loss: 0.1074, weighted_loss: 0.0610, label: 2, bag_size: 3210
batch 679, loss: 0.2343, instance_loss: 0.4066, weighted_loss: 0.2860, label: 0, bag_size: 4719
batch 699, loss: 0.0308, instance_loss: 0.1072, weighted_loss: 0.0537, label: 0, bag_size: 5437
batch 719, loss: 0.0153, instance_loss: 0.0698, weighted_loss: 0.0316, label: 0, bag_size: 3304
batch 739, loss: 0.0731, instance_loss: 0.2184, weighted_loss: 0.1167, label: 2, bag_size: 5914


class 0 clustering acc 0.9653243847874721: correct 17260/17880
class 1 clustering acc 0.4318791946308725: correct 2574/5960
Epoch: 60, train_loss: 0.4193, train_clustering_loss:  0.5176, train_error: 0.1651
class 0: acc 0.8284518828451883, correct 198/239
class 1: acc 0.7738095238095238, correct 195/252
class 2: acc 0.9015748031496063, correct 229/254

Val Set, val_loss: 0.7428, val_error: 0.2660, auc: 0.8846
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.3257978723404255: correct 245/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 2.4548, instance_loss: 1.1213, weighted_loss: 2.0548, label: 0, bag_size: 455
batch 39, loss: 1.4518, instance_loss: 0.8624, weighted_loss: 1.2750, label: 0, bag_size: 609
batch 59, loss: 0.1110, instance_loss: 0.4006, weighted_loss: 0.1979, label: 2, bag_size: 5138
batch 79, loss: 0.6633, instance_loss: 1.1065, weighted_loss: 0.7962, label: 2, bag_size: 361
batch 99, loss: 0.1325, instance_loss: 0.3251, weighted_loss: 0.1903, label: 2, bag_size: 3299
batch 119, loss: 0.0162, instance_loss: 0.2764, weighted_loss: 0.0943, label: 1, bag_size: 3497
batch 139, loss: 0.0449, instance_loss: 0.3069, weighted_loss: 0.1235, label: 2, bag_size: 3778
batch 159, loss: 0.6680, instance_loss: 0.7212, weighted_loss: 0.6840, label: 1, bag_size: 3009
batch 179, loss: 0.0125, instance_loss: 0.5049, weighted_loss: 0.1602, label: 1, bag_size: 5728
batch 199, loss: 0.0510, instance_loss: 0.2564, weighted_loss: 0.1126, label: 2, bag_size: 3396
batch 219, loss: 0.0307, instance_loss: 0.1263, weighted_loss: 0.0594, label: 0, bag_size: 4531
batch 239, loss: 0.0568, instance_loss: 0.2993, weighted_loss: 0.1295, label: 2, bag_size: 4140
batch 259, loss: 0.0021, instance_loss: 0.0954, weighted_loss: 0.0301, label: 0, bag_size: 3754
batch 279, loss: 0.0002, instance_loss: 0.0856, weighted_loss: 0.0258, label: 1, bag_size: 8802
batch 299, loss: 0.0299, instance_loss: 0.4795, weighted_loss: 0.1648, label: 2, bag_size: 3607
batch 319, loss: 0.1217, instance_loss: 0.3424, weighted_loss: 0.1880, label: 0, bag_size: 13540
batch 339, loss: 0.9467, instance_loss: 0.8708, weighted_loss: 0.9239, label: 1, bag_size: 3009
batch 359, loss: 1.0497, instance_loss: 1.0415, weighted_loss: 1.0473, label: 1, bag_size: 5512
batch 379, loss: 0.0177, instance_loss: 0.4888, weighted_loss: 0.1590, label: 1, bag_size: 455
batch 399, loss: 0.3774, instance_loss: 0.7464, weighted_loss: 0.4881, label: 0, bag_size: 1270
batch 419, loss: 1.7248, instance_loss: 1.2223, weighted_loss: 1.5741, label: 0, bag_size: 3419
batch 439, loss: 0.7137, instance_loss: 0.8379, weighted_loss: 0.7510, label: 1, bag_size: 4438
batch 459, loss: 0.0059, instance_loss: 0.2972, weighted_loss: 0.0932, label: 0, bag_size: 4721
batch 479, loss: 0.1464, instance_loss: 0.5686, weighted_loss: 0.2730, label: 0, bag_size: 2850
batch 499, loss: 0.1601, instance_loss: 0.3480, weighted_loss: 0.2165, label: 0, bag_size: 4524
batch 519, loss: 0.1550, instance_loss: 0.4972, weighted_loss: 0.2576, label: 0, bag_size: 7056
batch 539, loss: 0.0858, instance_loss: 0.2393, weighted_loss: 0.1318, label: 0, bag_size: 5915
batch 559, loss: 0.0012, instance_loss: 0.6009, weighted_loss: 0.1811, label: 0, bag_size: 4479
batch 579, loss: 0.0286, instance_loss: 0.1091, weighted_loss: 0.0528, label: 0, bag_size: 4914
batch 599, loss: 0.0282, instance_loss: 0.7657, weighted_loss: 0.2494, label: 1, bag_size: 3425
batch 619, loss: 0.8726, instance_loss: 0.7197, weighted_loss: 0.8267, label: 2, bag_size: 5426
batch 639, loss: 0.0001, instance_loss: 0.2702, weighted_loss: 0.0811, label: 2, bag_size: 4141
batch 659, loss: 0.0137, instance_loss: 0.1371, weighted_loss: 0.0507, label: 2, bag_size: 2483
batch 679, loss: 0.0164, instance_loss: 0.0838, weighted_loss: 0.0366, label: 2, bag_size: 2905
batch 699, loss: 1.3162, instance_loss: 0.9887, weighted_loss: 1.2180, label: 1, bag_size: 5340
batch 719, loss: 0.0468, instance_loss: 0.4112, weighted_loss: 0.1561, label: 1, bag_size: 6513
batch 739, loss: 0.0000, instance_loss: 0.2897, weighted_loss: 0.0869, label: 1, bag_size: 4067


class 0 clustering acc 0.9668903803131991: correct 17288/17880
class 1 clustering acc 0.44395973154362417: correct 2646/5960
Epoch: 61, train_loss: 0.4061, train_clustering_loss:  0.5064, train_error: 0.1597
class 0: acc 0.8346456692913385, correct 212/254
class 1: acc 0.7787234042553192, correct 183/235
class 2: acc 0.90234375, correct 231/256

Val Set, val_loss: 0.6699, val_error: 0.2660, auc: 0.8899
class 0 clustering acc 0.9273049645390071: correct 2092/2256
class 1 clustering acc 0.5252659574468085: correct 395/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0461, instance_loss: 0.1965, weighted_loss: 0.0913, label: 0, bag_size: 3641
batch 39, loss: 0.8345, instance_loss: 0.4178, weighted_loss: 0.7095, label: 1, bag_size: 1410
batch 59, loss: 0.0774, instance_loss: 0.4487, weighted_loss: 0.1888, label: 2, bag_size: 5011
batch 79, loss: 0.1349, instance_loss: 0.2803, weighted_loss: 0.1785, label: 2, bag_size: 6298
batch 99, loss: 0.1445, instance_loss: 0.5911, weighted_loss: 0.2784, label: 0, bag_size: 2850
batch 119, loss: 0.3856, instance_loss: 0.7701, weighted_loss: 0.5010, label: 1, bag_size: 2744
batch 139, loss: 0.1644, instance_loss: 0.9065, weighted_loss: 0.3870, label: 1, bag_size: 2229
batch 159, loss: 0.5530, instance_loss: 0.8406, weighted_loss: 0.6393, label: 2, bag_size: 3299
batch 179, loss: 0.0327, instance_loss: 0.1108, weighted_loss: 0.0561, label: 2, bag_size: 4056
batch 199, loss: 0.2556, instance_loss: 0.6562, weighted_loss: 0.3758, label: 2, bag_size: 3299
batch 219, loss: 0.0852, instance_loss: 0.4053, weighted_loss: 0.1812, label: 0, bag_size: 4479
batch 239, loss: 0.6832, instance_loss: 0.8090, weighted_loss: 0.7210, label: 2, bag_size: 6594
batch 259, loss: 1.9846, instance_loss: 1.1796, weighted_loss: 1.7431, label: 0, bag_size: 8866
batch 279, loss: 0.0107, instance_loss: 0.4720, weighted_loss: 0.1491, label: 0, bag_size: 3297
batch 299, loss: 0.0254, instance_loss: 0.1586, weighted_loss: 0.0654, label: 2, bag_size: 3210
batch 319, loss: 3.3481, instance_loss: 1.6310, weighted_loss: 2.8330, label: 0, bag_size: 877
batch 339, loss: 0.2501, instance_loss: 0.6884, weighted_loss: 0.3816, label: 1, bag_size: 2319
batch 359, loss: 0.0017, instance_loss: 0.1596, weighted_loss: 0.0491, label: 1, bag_size: 10941
batch 379, loss: 0.1025, instance_loss: 0.6090, weighted_loss: 0.2545, label: 0, bag_size: 5646
batch 399, loss: 0.0037, instance_loss: 0.1384, weighted_loss: 0.0441, label: 0, bag_size: 5282
batch 419, loss: 0.0862, instance_loss: 0.4437, weighted_loss: 0.1934, label: 1, bag_size: 4644
batch 439, loss: 0.0035, instance_loss: 0.2039, weighted_loss: 0.0636, label: 0, bag_size: 6015
batch 459, loss: 0.0035, instance_loss: 0.6319, weighted_loss: 0.1920, label: 1, bag_size: 4812
batch 479, loss: 0.5748, instance_loss: 1.0021, weighted_loss: 0.7030, label: 1, bag_size: 475
batch 499, loss: 0.1375, instance_loss: 0.3008, weighted_loss: 0.1865, label: 2, bag_size: 2501
batch 519, loss: 3.9423, instance_loss: 2.4403, weighted_loss: 3.4917, label: 1, bag_size: 1558
batch 539, loss: 0.1040, instance_loss: 0.3999, weighted_loss: 0.1928, label: 2, bag_size: 3299
batch 559, loss: 0.0007, instance_loss: 0.3664, weighted_loss: 0.1104, label: 2, bag_size: 4497
batch 579, loss: 0.3274, instance_loss: 0.4021, weighted_loss: 0.3498, label: 2, bag_size: 3080
batch 599, loss: 0.0154, instance_loss: 0.1776, weighted_loss: 0.0640, label: 1, bag_size: 712
batch 619, loss: 0.0216, instance_loss: 0.1469, weighted_loss: 0.0592, label: 2, bag_size: 4043
batch 639, loss: 0.0455, instance_loss: 0.7606, weighted_loss: 0.2600, label: 1, bag_size: 11974
batch 659, loss: 0.1991, instance_loss: 0.7123, weighted_loss: 0.3531, label: 1, bag_size: 1854
batch 679, loss: 0.0160, instance_loss: 0.2164, weighted_loss: 0.0761, label: 0, bag_size: 4300
batch 699, loss: 0.5161, instance_loss: 0.9563, weighted_loss: 0.6482, label: 1, bag_size: 1307
batch 719, loss: 1.1346, instance_loss: 0.6902, weighted_loss: 1.0013, label: 1, bag_size: 5412
batch 739, loss: 0.0724, instance_loss: 0.1378, weighted_loss: 0.0920, label: 2, bag_size: 4132


class 0 clustering acc 0.9601789709172259: correct 17168/17880
class 1 clustering acc 0.4483221476510067: correct 2672/5960
Epoch: 62, train_loss: 0.3956, train_clustering_loss:  0.5114, train_error: 0.1651
class 0: acc 0.8405172413793104, correct 195/232
class 1: acc 0.763265306122449, correct 187/245
class 2: acc 0.8955223880597015, correct 240/268

Val Set, val_loss: 0.7531, val_error: 0.2553, auc: 0.8730
class 0 clustering acc 0.9530141843971631: correct 2150/2256
class 1 clustering acc 0.300531914893617: correct 226/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.8666666666666667, correct 26/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 4.4677, instance_loss: 1.6378, weighted_loss: 3.6188, label: 0, bag_size: 4605
batch 39, loss: 0.0000, instance_loss: 0.9762, weighted_loss: 0.2929, label: 0, bag_size: 1709
batch 59, loss: 0.0597, instance_loss: 0.7003, weighted_loss: 0.2519, label: 1, bag_size: 1097
batch 79, loss: 0.0478, instance_loss: 0.1843, weighted_loss: 0.0888, label: 2, bag_size: 3396
batch 99, loss: 1.1652, instance_loss: 0.9053, weighted_loss: 1.0873, label: 1, bag_size: 869
batch 119, loss: 0.0916, instance_loss: 0.4784, weighted_loss: 0.2076, label: 1, bag_size: 5718
batch 139, loss: 2.2886, instance_loss: 0.8659, weighted_loss: 1.8618, label: 1, bag_size: 2751
batch 159, loss: 2.9169, instance_loss: 1.3365, weighted_loss: 2.4428, label: 1, bag_size: 3399
batch 179, loss: 0.5348, instance_loss: 0.4173, weighted_loss: 0.4995, label: 0, bag_size: 2884
batch 199, loss: 0.0327, instance_loss: 0.2231, weighted_loss: 0.0898, label: 2, bag_size: 4555
batch 219, loss: 0.2973, instance_loss: 0.2574, weighted_loss: 0.2853, label: 2, bag_size: 4241
batch 239, loss: 0.4414, instance_loss: 0.6348, weighted_loss: 0.4995, label: 1, bag_size: 3225
batch 259, loss: 0.0172, instance_loss: 0.1308, weighted_loss: 0.0513, label: 0, bag_size: 4741
batch 279, loss: 0.0034, instance_loss: 0.0751, weighted_loss: 0.0249, label: 2, bag_size: 4856
batch 299, loss: 0.0460, instance_loss: 0.2123, weighted_loss: 0.0959, label: 2, bag_size: 3227
batch 319, loss: 1.2871, instance_loss: 1.2567, weighted_loss: 1.2780, label: 1, bag_size: 1327
batch 339, loss: 0.0279, instance_loss: 0.0952, weighted_loss: 0.0481, label: 2, bag_size: 4056
batch 359, loss: 1.6844, instance_loss: 1.4520, weighted_loss: 1.6147, label: 1, bag_size: 1608
batch 379, loss: 0.0075, instance_loss: 0.1312, weighted_loss: 0.0446, label: 2, bag_size: 3094
batch 399, loss: 0.0073, instance_loss: 0.5142, weighted_loss: 0.1594, label: 2, bag_size: 5017
batch 419, loss: 0.1472, instance_loss: 0.1982, weighted_loss: 0.1625, label: 2, bag_size: 4223
batch 439, loss: 0.4568, instance_loss: 0.4266, weighted_loss: 0.4477, label: 0, bag_size: 2608
batch 459, loss: 0.0033, instance_loss: 0.5494, weighted_loss: 0.1671, label: 2, bag_size: 4497
batch 479, loss: 0.7903, instance_loss: 0.9828, weighted_loss: 0.8481, label: 2, bag_size: 4571
batch 499, loss: 0.0732, instance_loss: 0.9925, weighted_loss: 0.3490, label: 1, bag_size: 3995
batch 519, loss: 0.1198, instance_loss: 0.1822, weighted_loss: 0.1385, label: 0, bag_size: 2791
batch 539, loss: 0.0079, instance_loss: 0.1117, weighted_loss: 0.0390, label: 0, bag_size: 3816
batch 559, loss: 0.0036, instance_loss: 0.3022, weighted_loss: 0.0932, label: 1, bag_size: 3127
batch 579, loss: 0.0883, instance_loss: 0.2367, weighted_loss: 0.1328, label: 2, bag_size: 5924
batch 599, loss: 0.0202, instance_loss: 0.4957, weighted_loss: 0.1629, label: 0, bag_size: 1933
batch 619, loss: 0.0115, instance_loss: 0.5341, weighted_loss: 0.1683, label: 1, bag_size: 5385
batch 639, loss: 0.0142, instance_loss: 0.6761, weighted_loss: 0.2128, label: 1, bag_size: 5728
batch 659, loss: 0.1390, instance_loss: 0.6798, weighted_loss: 0.3013, label: 2, bag_size: 1050
batch 679, loss: 0.2885, instance_loss: 0.8130, weighted_loss: 0.4459, label: 0, bag_size: 4274
batch 699, loss: 0.5735, instance_loss: 0.5221, weighted_loss: 0.5581, label: 1, bag_size: 4960
batch 719, loss: 0.0064, instance_loss: 0.5787, weighted_loss: 0.1781, label: 1, bag_size: 8482
batch 739, loss: 0.0024, instance_loss: 0.4243, weighted_loss: 0.1290, label: 2, bag_size: 7607


class 0 clustering acc 0.9619686800894854: correct 17200/17880
class 1 clustering acc 0.4374161073825503: correct 2607/5960
Epoch: 63, train_loss: 0.3840, train_clustering_loss:  0.5210, train_error: 0.1503
class 0: acc 0.8699186991869918, correct 214/246
class 1: acc 0.7944664031620553, correct 201/253
class 2: acc 0.8861788617886179, correct 218/246

Val Set, val_loss: 0.8908, val_error: 0.2660, auc: 0.8778
class 0 clustering acc 0.9605496453900709: correct 2167/2256
class 1 clustering acc 0.33643617021276595: correct 253/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.9, correct 27/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1398, instance_loss: 0.5103, weighted_loss: 0.2509, label: 2, bag_size: 4162
batch 39, loss: 0.0602, instance_loss: 0.4491, weighted_loss: 0.1769, label: 1, bag_size: 3337
batch 59, loss: 1.3261, instance_loss: 0.7961, weighted_loss: 1.1671, label: 1, bag_size: 3225
batch 79, loss: 1.5377, instance_loss: 0.9602, weighted_loss: 1.3644, label: 2, bag_size: 4179
batch 99, loss: 0.0549, instance_loss: 0.3887, weighted_loss: 0.1550, label: 2, bag_size: 5011
batch 119, loss: 0.0395, instance_loss: 0.3935, weighted_loss: 0.1457, label: 0, bag_size: 2853
batch 139, loss: 1.2742, instance_loss: 0.8476, weighted_loss: 1.1462, label: 1, bag_size: 1670
batch 159, loss: 0.0022, instance_loss: 0.2055, weighted_loss: 0.0632, label: 0, bag_size: 5899
batch 179, loss: 1.4225, instance_loss: 0.7266, weighted_loss: 1.2137, label: 1, bag_size: 6513
batch 199, loss: 0.0000, instance_loss: 0.1630, weighted_loss: 0.0489, label: 1, bag_size: 4684
batch 219, loss: 0.0000, instance_loss: 0.2696, weighted_loss: 0.0809, label: 2, bag_size: 2422
batch 239, loss: 0.0324, instance_loss: 0.1586, weighted_loss: 0.0703, label: 2, bag_size: 3121
batch 259, loss: 0.9104, instance_loss: 0.7658, weighted_loss: 0.8670, label: 0, bag_size: 3155
batch 279, loss: 1.1630, instance_loss: 0.8236, weighted_loss: 1.0612, label: 1, bag_size: 5693
batch 299, loss: 0.1153, instance_loss: 0.5152, weighted_loss: 0.2353, label: 2, bag_size: 1543
batch 319, loss: 0.0369, instance_loss: 1.1038, weighted_loss: 0.3570, label: 1, bag_size: 3159
batch 339, loss: 0.0044, instance_loss: 0.1988, weighted_loss: 0.0627, label: 0, bag_size: 5226
batch 359, loss: 1.4347, instance_loss: 0.9400, weighted_loss: 1.2863, label: 1, bag_size: 3396
batch 379, loss: 0.1099, instance_loss: 0.8403, weighted_loss: 0.3290, label: 1, bag_size: 3159
batch 399, loss: 0.9285, instance_loss: 0.6280, weighted_loss: 0.8384, label: 1, bag_size: 1860
batch 419, loss: 0.0499, instance_loss: 0.3607, weighted_loss: 0.1431, label: 1, bag_size: 3519
batch 439, loss: 0.0697, instance_loss: 0.5589, weighted_loss: 0.2164, label: 2, bag_size: 5637
batch 459, loss: 0.0149, instance_loss: 0.1864, weighted_loss: 0.0664, label: 2, bag_size: 4910
batch 479, loss: 0.0618, instance_loss: 0.4949, weighted_loss: 0.1917, label: 2, bag_size: 4162
batch 499, loss: 0.0951, instance_loss: 0.2513, weighted_loss: 0.1420, label: 2, bag_size: 3210
batch 519, loss: 0.2846, instance_loss: 0.7885, weighted_loss: 0.4357, label: 2, bag_size: 4571
batch 539, loss: 0.0610, instance_loss: 0.1222, weighted_loss: 0.0794, label: 0, bag_size: 5570
batch 559, loss: 1.0566, instance_loss: 0.8983, weighted_loss: 1.0091, label: 1, bag_size: 5926
batch 579, loss: 0.0517, instance_loss: 0.1206, weighted_loss: 0.0724, label: 0, bag_size: 14070
batch 599, loss: 0.1753, instance_loss: 0.2460, weighted_loss: 0.1965, label: 0, bag_size: 4242
batch 619, loss: 0.0010, instance_loss: 0.0562, weighted_loss: 0.0176, label: 2, bag_size: 3094
batch 639, loss: 0.1815, instance_loss: 0.6367, weighted_loss: 0.3180, label: 2, bag_size: 4162
batch 659, loss: 0.5253, instance_loss: 0.2641, weighted_loss: 0.4469, label: 0, bag_size: 5413
batch 679, loss: 0.0233, instance_loss: 0.3943, weighted_loss: 0.1346, label: 0, bag_size: 1495
batch 699, loss: 0.6119, instance_loss: 0.3864, weighted_loss: 0.5442, label: 2, bag_size: 3274
batch 719, loss: 0.1686, instance_loss: 0.4688, weighted_loss: 0.2587, label: 0, bag_size: 3344
batch 739, loss: 0.1526, instance_loss: 0.2530, weighted_loss: 0.1827, label: 2, bag_size: 5426


class 0 clustering acc 0.9666666666666667: correct 17284/17880
class 1 clustering acc 0.46426174496644296: correct 2767/5960
Epoch: 64, train_loss: 0.4124, train_clustering_loss:  0.5087, train_error: 0.1490
class 0: acc 0.8656126482213439, correct 219/253
class 1: acc 0.7800829875518672, correct 188/241
class 2: acc 0.9043824701195219, correct 227/251

Val Set, val_loss: 0.7386, val_error: 0.3085, auc: 0.8871
class 0 clustering acc 0.9423758865248227: correct 2126/2256
class 1 clustering acc 0.35638297872340424: correct 268/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7666666666666667, correct 23/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2723, instance_loss: 0.4132, weighted_loss: 0.3146, label: 1, bag_size: 2998
batch 39, loss: 0.2953, instance_loss: 0.3400, weighted_loss: 0.3087, label: 2, bag_size: 2561
batch 59, loss: 0.0480, instance_loss: 0.4105, weighted_loss: 0.1568, label: 0, bag_size: 1018
batch 79, loss: 0.0334, instance_loss: 0.5455, weighted_loss: 0.1870, label: 0, bag_size: 3539
batch 99, loss: 0.0456, instance_loss: 0.4460, weighted_loss: 0.1658, label: 1, bag_size: 4869
batch 119, loss: 0.2615, instance_loss: 0.3025, weighted_loss: 0.2738, label: 1, bag_size: 3367
batch 139, loss: 0.0792, instance_loss: 0.4120, weighted_loss: 0.1790, label: 2, bag_size: 4856
batch 159, loss: 0.2156, instance_loss: 0.4142, weighted_loss: 0.2752, label: 1, bag_size: 5572
batch 179, loss: 0.0206, instance_loss: 0.5960, weighted_loss: 0.1932, label: 0, bag_size: 5585
batch 199, loss: 0.0968, instance_loss: 0.3981, weighted_loss: 0.1872, label: 0, bag_size: 2286
batch 219, loss: 0.4978, instance_loss: 1.1977, weighted_loss: 0.7078, label: 2, bag_size: 4571
batch 239, loss: 0.2250, instance_loss: 0.7625, weighted_loss: 0.3862, label: 1, bag_size: 1313
batch 259, loss: 0.0274, instance_loss: 0.8295, weighted_loss: 0.2680, label: 1, bag_size: 4192
batch 279, loss: 0.7960, instance_loss: 0.5373, weighted_loss: 0.7184, label: 1, bag_size: 2731
batch 299, loss: 0.3444, instance_loss: 0.4676, weighted_loss: 0.3813, label: 1, bag_size: 2998
batch 319, loss: 0.7982, instance_loss: 0.6123, weighted_loss: 0.7424, label: 1, bag_size: 4784
batch 339, loss: 0.0356, instance_loss: 0.4629, weighted_loss: 0.1638, label: 1, bag_size: 3640
batch 359, loss: 0.5161, instance_loss: 0.5519, weighted_loss: 0.5268, label: 1, bag_size: 3225
batch 379, loss: 0.0037, instance_loss: 0.1602, weighted_loss: 0.0507, label: 2, bag_size: 2483
batch 399, loss: 1.7925, instance_loss: 1.0878, weighted_loss: 1.5811, label: 1, bag_size: 8632
batch 419, loss: 1.4801, instance_loss: 0.9186, weighted_loss: 1.3117, label: 1, bag_size: 936
batch 439, loss: 0.0773, instance_loss: 0.3690, weighted_loss: 0.1648, label: 1, bag_size: 4069
batch 459, loss: 0.0230, instance_loss: 0.2742, weighted_loss: 0.0984, label: 2, bag_size: 3618
batch 479, loss: 0.0000, instance_loss: 0.6066, weighted_loss: 0.1820, label: 1, bag_size: 5084
batch 499, loss: 0.6593, instance_loss: 0.6279, weighted_loss: 0.6498, label: 1, bag_size: 3438
batch 519, loss: 0.4417, instance_loss: 0.7179, weighted_loss: 0.5246, label: 2, bag_size: 5072
batch 539, loss: 0.0874, instance_loss: 0.2620, weighted_loss: 0.1398, label: 2, bag_size: 614
batch 559, loss: 0.8132, instance_loss: 0.3254, weighted_loss: 0.6669, label: 0, bag_size: 4201
batch 579, loss: 0.0967, instance_loss: 0.4389, weighted_loss: 0.1993, label: 0, bag_size: 4220
batch 599, loss: 0.0407, instance_loss: 0.1787, weighted_loss: 0.0821, label: 0, bag_size: 4531
batch 619, loss: 0.0314, instance_loss: 0.1366, weighted_loss: 0.0629, label: 2, bag_size: 4775
batch 639, loss: 0.0076, instance_loss: 0.5155, weighted_loss: 0.1600, label: 2, bag_size: 4497
batch 659, loss: 0.1674, instance_loss: 0.2697, weighted_loss: 0.1981, label: 2, bag_size: 3080
batch 679, loss: 1.1229, instance_loss: 1.1794, weighted_loss: 1.1399, label: 0, bag_size: 313
batch 699, loss: 1.4247, instance_loss: 0.7190, weighted_loss: 1.2130, label: 0, bag_size: 35080
batch 719, loss: 0.0155, instance_loss: 0.1178, weighted_loss: 0.0462, label: 2, bag_size: 3210
batch 739, loss: 0.1592, instance_loss: 0.4128, weighted_loss: 0.2353, label: 0, bag_size: 5953


class 0 clustering acc 0.9675615212527964: correct 17300/17880
class 1 clustering acc 0.3800335570469799: correct 2265/5960
Epoch: 65, train_loss: 0.3817, train_clustering_loss:  0.5337, train_error: 0.1517
class 0: acc 0.84, correct 210/250
class 1: acc 0.8202247191011236, correct 219/267
class 2: acc 0.8903508771929824, correct 203/228

Val Set, val_loss: 0.6200, val_error: 0.2128, auc: 0.9005
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.5279255319148937: correct 397/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0043, instance_loss: 0.2894, weighted_loss: 0.0899, label: 0, bag_size: 4458
batch 39, loss: 0.4740, instance_loss: 0.8286, weighted_loss: 0.5804, label: 1, bag_size: 5276
batch 59, loss: 0.1274, instance_loss: 0.3654, weighted_loss: 0.1988, label: 2, bag_size: 4291
batch 79, loss: 0.0321, instance_loss: 0.4941, weighted_loss: 0.1707, label: 1, bag_size: 6513
batch 99, loss: 0.0670, instance_loss: 0.2891, weighted_loss: 0.1336, label: 2, bag_size: 4291
batch 119, loss: 0.0440, instance_loss: 0.0896, weighted_loss: 0.0577, label: 2, bag_size: 657
batch 139, loss: 0.0274, instance_loss: 0.1986, weighted_loss: 0.0788, label: 2, bag_size: 4372
batch 159, loss: 0.1260, instance_loss: 0.3586, weighted_loss: 0.1958, label: 2, bag_size: 3778
batch 179, loss: 0.0024, instance_loss: 0.1954, weighted_loss: 0.0603, label: 2, bag_size: 2422
batch 199, loss: 0.0000, instance_loss: 0.2644, weighted_loss: 0.0793, label: 0, bag_size: 3983
batch 219, loss: 0.0846, instance_loss: 0.3329, weighted_loss: 0.1591, label: 2, bag_size: 2313
batch 239, loss: 0.0481, instance_loss: 0.2034, weighted_loss: 0.0947, label: 2, bag_size: 2313
batch 259, loss: 0.0156, instance_loss: 0.1043, weighted_loss: 0.0422, label: 2, bag_size: 2049
batch 279, loss: 0.4101, instance_loss: 0.6321, weighted_loss: 0.4767, label: 0, bag_size: 893
batch 299, loss: 0.3272, instance_loss: 0.3265, weighted_loss: 0.3270, label: 2, bag_size: 4241
batch 319, loss: 0.2015, instance_loss: 0.5817, weighted_loss: 0.3155, label: 1, bag_size: 4346
batch 339, loss: 0.0031, instance_loss: 0.0473, weighted_loss: 0.0164, label: 0, bag_size: 4196
batch 359, loss: 0.0037, instance_loss: 0.2912, weighted_loss: 0.0899, label: 0, bag_size: 5585
batch 379, loss: 3.3149, instance_loss: 1.5898, weighted_loss: 2.7973, label: 0, bag_size: 1071
batch 399, loss: 0.0071, instance_loss: 0.2571, weighted_loss: 0.0821, label: 2, bag_size: 5037
batch 419, loss: 0.0850, instance_loss: 0.2284, weighted_loss: 0.1280, label: 2, bag_size: 4056
batch 439, loss: 0.0067, instance_loss: 0.1051, weighted_loss: 0.0362, label: 1, bag_size: 3611
batch 459, loss: 0.7309, instance_loss: 0.4427, weighted_loss: 0.6444, label: 0, bag_size: 2601
batch 479, loss: 1.6314, instance_loss: 0.9020, weighted_loss: 1.4126, label: 1, bag_size: 1313
batch 499, loss: 0.6079, instance_loss: 1.1071, weighted_loss: 0.7577, label: 1, bag_size: 2744
batch 519, loss: 0.3351, instance_loss: 0.8940, weighted_loss: 0.5028, label: 1, bag_size: 869
batch 539, loss: 0.0780, instance_loss: 0.3673, weighted_loss: 0.1648, label: 1, bag_size: 3885
batch 559, loss: 0.1951, instance_loss: 0.4892, weighted_loss: 0.2833, label: 1, bag_size: 5340
batch 579, loss: 0.2160, instance_loss: 0.2942, weighted_loss: 0.2395, label: 2, bag_size: 3172
batch 599, loss: 0.4063, instance_loss: 0.5580, weighted_loss: 0.4518, label: 2, bag_size: 5426
batch 619, loss: 0.2256, instance_loss: 0.7744, weighted_loss: 0.3902, label: 1, bag_size: 2747
batch 639, loss: 0.5405, instance_loss: 0.5459, weighted_loss: 0.5421, label: 0, bag_size: 4707
batch 659, loss: 0.0076, instance_loss: 0.2320, weighted_loss: 0.0749, label: 2, bag_size: 5924
batch 679, loss: 0.0660, instance_loss: 0.2710, weighted_loss: 0.1275, label: 0, bag_size: 3741
batch 699, loss: 5.0900, instance_loss: 1.5031, weighted_loss: 4.0139, label: 1, bag_size: 4694
batch 719, loss: 1.4098, instance_loss: 0.5378, weighted_loss: 1.1482, label: 1, bag_size: 1807
batch 739, loss: 1.7621, instance_loss: 0.7767, weighted_loss: 1.4665, label: 1, bag_size: 3225


class 0 clustering acc 0.9650447427293065: correct 17255/17880
class 1 clustering acc 0.4671140939597315: correct 2784/5960
Epoch: 66, train_loss: 0.3585, train_clustering_loss:  0.4948, train_error: 0.1248
class 0: acc 0.8774703557312253, correct 222/253
class 1: acc 0.8503937007874016, correct 216/254
class 2: acc 0.8991596638655462, correct 214/238

Val Set, val_loss: 0.6326, val_error: 0.2872, auc: 0.8987
class 0 clustering acc 0.9485815602836879: correct 2140/2256
class 1 clustering acc 0.43617021276595747: correct 328/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.2447, ROC AUC: 0.8915
Test error: 0.3298, ROC AUC: 0.7959
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.5833333333333334, correct 7/12

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.4592, instance_loss: 0.6526, weighted_loss: 0.5172, label: 1, bag_size: 6993
batch 39, loss: 1.5764, instance_loss: 0.6182, weighted_loss: 1.2889, label: 0, bag_size: 2853
batch 59, loss: 1.1184, instance_loss: 0.7569, weighted_loss: 1.0100, label: 2, bag_size: 3327
batch 79, loss: 0.9131, instance_loss: 0.7794, weighted_loss: 0.8730, label: 2, bag_size: 5406
batch 99, loss: 2.7617, instance_loss: 0.7817, weighted_loss: 2.1677, label: 1, bag_size: 817
batch 119, loss: 1.9978, instance_loss: 0.8079, weighted_loss: 1.6408, label: 0, bag_size: 4734
batch 139, loss: 0.6352, instance_loss: 0.7595, weighted_loss: 0.6725, label: 1, bag_size: 2767
batch 159, loss: 1.2009, instance_loss: 1.1417, weighted_loss: 1.1831, label: 0, bag_size: 4403
batch 179, loss: 0.8800, instance_loss: 0.8189, weighted_loss: 0.8616, label: 0, bag_size: 1174
batch 199, loss: 0.9083, instance_loss: 0.7601, weighted_loss: 0.8639, label: 2, bag_size: 3327
batch 219, loss: 0.9915, instance_loss: 0.7475, weighted_loss: 0.9183, label: 2, bag_size: 4291
batch 239, loss: 1.6692, instance_loss: 0.9288, weighted_loss: 1.4471, label: 0, bag_size: 5656
batch 259, loss: 0.6260, instance_loss: 0.6639, weighted_loss: 0.6374, label: 2, bag_size: 6001
batch 279, loss: 0.2245, instance_loss: 0.5801, weighted_loss: 0.3312, label: 2, bag_size: 2561
batch 299, loss: 0.2839, instance_loss: 0.4605, weighted_loss: 0.3369, label: 0, bag_size: 4282
batch 319, loss: 2.2546, instance_loss: 1.0869, weighted_loss: 1.9043, label: 2, bag_size: 4316
batch 339, loss: 1.9738, instance_loss: 1.0655, weighted_loss: 1.7013, label: 1, bag_size: 4346
batch 359, loss: 0.4767, instance_loss: 0.6756, weighted_loss: 0.5363, label: 1, bag_size: 5756
batch 379, loss: 0.5801, instance_loss: 0.7074, weighted_loss: 0.6183, label: 0, bag_size: 3245
batch 399, loss: 0.9884, instance_loss: 0.7074, weighted_loss: 0.9041, label: 1, bag_size: 2614
batch 419, loss: 1.0707, instance_loss: 0.8788, weighted_loss: 1.0131, label: 2, bag_size: 3080
batch 439, loss: 0.3535, instance_loss: 0.4861, weighted_loss: 0.3933, label: 2, bag_size: 6026
batch 459, loss: 1.0862, instance_loss: 0.8647, weighted_loss: 1.0197, label: 2, bag_size: 6644
batch 479, loss: 1.3712, instance_loss: 0.8311, weighted_loss: 1.2092, label: 0, bag_size: 4711
batch 499, loss: 1.7645, instance_loss: 0.7601, weighted_loss: 1.4632, label: 1, bag_size: 5756
batch 519, loss: 1.1467, instance_loss: 0.7166, weighted_loss: 1.0176, label: 0, bag_size: 5038
batch 539, loss: 1.1499, instance_loss: 0.7023, weighted_loss: 1.0156, label: 0, bag_size: 3872
batch 559, loss: 0.5141, instance_loss: 0.6536, weighted_loss: 0.5559, label: 1, bag_size: 4898
batch 579, loss: 0.5933, instance_loss: 0.6770, weighted_loss: 0.6184, label: 0, bag_size: 6015
batch 599, loss: 1.4091, instance_loss: 0.5312, weighted_loss: 1.1457, label: 0, bag_size: 4524
batch 619, loss: 0.4725, instance_loss: 0.5435, weighted_loss: 0.4938, label: 0, bag_size: 3348
batch 639, loss: 0.4370, instance_loss: 0.5041, weighted_loss: 0.4571, label: 1, bag_size: 3493
batch 659, loss: 0.8211, instance_loss: 0.6239, weighted_loss: 0.7619, label: 0, bag_size: 2579
batch 679, loss: 1.0202, instance_loss: 0.6533, weighted_loss: 0.9102, label: 1, bag_size: 6942
batch 699, loss: 3.0448, instance_loss: 0.8737, weighted_loss: 2.3935, label: 2, bag_size: 223
batch 719, loss: 0.8408, instance_loss: 0.6765, weighted_loss: 0.7915, label: 1, bag_size: 6717
batch 739, loss: 1.3761, instance_loss: 0.7667, weighted_loss: 1.1933, label: 0, bag_size: 20234


class 0 clustering acc 0.9968680089485459: correct 17824/17880
class 1 clustering acc 0.003691275167785235: correct 22/5960
Epoch: 0, train_loss: 1.0224, train_clustering_loss:  0.7199, train_error: 0.4953
class 0: acc 0.43410852713178294, correct 112/258
class 1: acc 0.45, correct 108/240
class 2: acc 0.631578947368421, correct 156/247

Val Set, val_loss: 0.8718, val_error: 0.3404, auc: 0.8044
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (inf --> 0.871775).  Saving model ...


batch 19, loss: 0.2880, instance_loss: 0.5975, weighted_loss: 0.3809, label: 2, bag_size: 6273
batch 39, loss: 0.5446, instance_loss: 0.6581, weighted_loss: 0.5786, label: 2, bag_size: 5637
batch 59, loss: 1.2504, instance_loss: 0.8626, weighted_loss: 1.1340, label: 1, bag_size: 2229
batch 79, loss: 0.5408, instance_loss: 0.6001, weighted_loss: 0.5586, label: 0, bag_size: 1647
batch 99, loss: 0.7148, instance_loss: 0.6763, weighted_loss: 0.7032, label: 0, bag_size: 2853
batch 119, loss: 1.0480, instance_loss: 0.7099, weighted_loss: 0.9466, label: 1, bag_size: 1410
batch 139, loss: 0.1573, instance_loss: 0.4639, weighted_loss: 0.2493, label: 2, bag_size: 4856
batch 159, loss: 0.8945, instance_loss: 0.6556, weighted_loss: 0.8228, label: 0, bag_size: 2392
batch 179, loss: 0.6097, instance_loss: 0.4785, weighted_loss: 0.5704, label: 1, bag_size: 5532
batch 199, loss: 0.1812, instance_loss: 0.4349, weighted_loss: 0.2573, label: 2, bag_size: 5037
batch 219, loss: 0.8964, instance_loss: 0.6946, weighted_loss: 0.8359, label: 1, bag_size: 3497
batch 239, loss: 1.0148, instance_loss: 1.0787, weighted_loss: 1.0339, label: 2, bag_size: 6148
batch 259, loss: 0.5873, instance_loss: 0.4959, weighted_loss: 0.5599, label: 1, bag_size: 1029
batch 279, loss: 0.6405, instance_loss: 0.5315, weighted_loss: 0.6078, label: 1, bag_size: 6152
batch 299, loss: 1.8801, instance_loss: 0.8478, weighted_loss: 1.5704, label: 0, bag_size: 4310
batch 319, loss: 0.8820, instance_loss: 0.6681, weighted_loss: 0.8178, label: 0, bag_size: 3924
batch 339, loss: 0.9286, instance_loss: 0.7139, weighted_loss: 0.8642, label: 2, bag_size: 4291
batch 359, loss: 0.9889, instance_loss: 0.8146, weighted_loss: 0.9366, label: 2, bag_size: 3746
batch 379, loss: 1.1485, instance_loss: 0.8158, weighted_loss: 1.0487, label: 0, bag_size: 436
batch 399, loss: 0.3117, instance_loss: 0.4889, weighted_loss: 0.3648, label: 2, bag_size: 3094
batch 419, loss: 0.4818, instance_loss: 0.5659, weighted_loss: 0.5070, label: 2, bag_size: 5924
batch 439, loss: 1.4183, instance_loss: 0.7135, weighted_loss: 1.2069, label: 2, bag_size: 705
batch 459, loss: 0.5686, instance_loss: 0.5693, weighted_loss: 0.5688, label: 1, bag_size: 3396
batch 479, loss: 0.3882, instance_loss: 0.4660, weighted_loss: 0.4116, label: 1, bag_size: 4119
batch 499, loss: 0.2296, instance_loss: 0.6514, weighted_loss: 0.3562, label: 2, bag_size: 2049
batch 519, loss: 0.3538, instance_loss: 0.3330, weighted_loss: 0.3476, label: 2, bag_size: 4056
batch 539, loss: 1.6787, instance_loss: 0.8673, weighted_loss: 1.4353, label: 2, bag_size: 6298
batch 559, loss: 0.9837, instance_loss: 0.8584, weighted_loss: 0.9461, label: 0, bag_size: 1904
batch 579, loss: 0.3517, instance_loss: 0.4778, weighted_loss: 0.3895, label: 0, bag_size: 5795
batch 599, loss: 0.2659, instance_loss: 0.4185, weighted_loss: 0.3117, label: 0, bag_size: 4855
batch 619, loss: 0.4138, instance_loss: 0.6756, weighted_loss: 0.4923, label: 1, bag_size: 3460
batch 639, loss: 0.7829, instance_loss: 0.6670, weighted_loss: 0.7481, label: 1, bag_size: 2671
batch 659, loss: 0.8533, instance_loss: 0.7705, weighted_loss: 0.8285, label: 2, bag_size: 4141
batch 679, loss: 1.4411, instance_loss: 0.8636, weighted_loss: 1.2679, label: 0, bag_size: 1774
batch 699, loss: 2.7402, instance_loss: 0.7725, weighted_loss: 2.1499, label: 2, bag_size: 597
batch 719, loss: 0.8822, instance_loss: 1.0065, weighted_loss: 0.9195, label: 2, bag_size: 3607
batch 739, loss: 0.6494, instance_loss: 0.7193, weighted_loss: 0.6704, label: 1, bag_size: 2998


class 0 clustering acc 0.9986577181208054: correct 17856/17880
class 1 clustering acc 0.008053691275167786: correct 48/5960
Epoch: 1, train_loss: 0.9257, train_clustering_loss:  0.6834, train_error: 0.4215
class 0: acc 0.5101214574898786, correct 126/247
class 1: acc 0.5303030303030303, correct 140/264
class 2: acc 0.7051282051282052, correct 165/234

Val Set, val_loss: 1.2467, val_error: 0.6809, auc: 0.7727
class 0 clustering acc 0.999113475177305: correct 2254/2256
class 1 clustering acc 0.030585106382978722: correct 23/752
class 0: acc 0.07692307692307693, correct 4/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5858, instance_loss: 0.7168, weighted_loss: 1.3251, label: 2, bag_size: 724
batch 39, loss: 0.5025, instance_loss: 0.6350, weighted_loss: 0.5422, label: 0, bag_size: 1174
batch 59, loss: 1.2057, instance_loss: 0.7778, weighted_loss: 1.0773, label: 2, bag_size: 2326
batch 79, loss: 0.6584, instance_loss: 0.5130, weighted_loss: 0.6148, label: 1, bag_size: 5412
batch 99, loss: 0.4517, instance_loss: 0.5010, weighted_loss: 0.4665, label: 2, bag_size: 3094
batch 119, loss: 1.5531, instance_loss: 0.8624, weighted_loss: 1.3459, label: 0, bag_size: 1373
batch 139, loss: 0.8057, instance_loss: 0.6572, weighted_loss: 0.7612, label: 2, bag_size: 4162
batch 159, loss: 0.5206, instance_loss: 0.6534, weighted_loss: 0.5604, label: 2, bag_size: 6644
batch 179, loss: 0.5150, instance_loss: 0.6220, weighted_loss: 0.5471, label: 1, bag_size: 4184
batch 199, loss: 1.1593, instance_loss: 0.8814, weighted_loss: 1.0759, label: 2, bag_size: 1543
batch 219, loss: 0.1756, instance_loss: 0.4065, weighted_loss: 0.2449, label: 0, bag_size: 3855
batch 239, loss: 1.0775, instance_loss: 0.5725, weighted_loss: 0.9260, label: 1, bag_size: 3813
batch 259, loss: 1.0947, instance_loss: 0.6185, weighted_loss: 0.9518, label: 0, bag_size: 5831
batch 279, loss: 0.2688, instance_loss: 0.4126, weighted_loss: 0.3119, label: 1, bag_size: 1836
batch 299, loss: 1.2397, instance_loss: 1.0289, weighted_loss: 1.1764, label: 1, bag_size: 3995
batch 319, loss: 0.3404, instance_loss: 0.4519, weighted_loss: 0.3738, label: 1, bag_size: 1807
batch 339, loss: 2.2107, instance_loss: 1.0644, weighted_loss: 1.8668, label: 0, bag_size: 5259
batch 359, loss: 0.1784, instance_loss: 0.1810, weighted_loss: 0.1791, label: 1, bag_size: 3761
batch 379, loss: 0.1995, instance_loss: 0.3924, weighted_loss: 0.2574, label: 2, bag_size: 3778
batch 399, loss: 0.3909, instance_loss: 0.3789, weighted_loss: 0.3873, label: 1, bag_size: 1906
batch 419, loss: 1.0386, instance_loss: 0.9420, weighted_loss: 1.0096, label: 0, bag_size: 1492
batch 439, loss: 0.3064, instance_loss: 0.2347, weighted_loss: 0.2849, label: 2, bag_size: 4856
batch 459, loss: 0.7192, instance_loss: 0.6675, weighted_loss: 0.7037, label: 2, bag_size: 4302
batch 479, loss: 1.5058, instance_loss: 0.7930, weighted_loss: 1.2919, label: 1, bag_size: 4187
batch 499, loss: 0.3351, instance_loss: 0.4798, weighted_loss: 0.3785, label: 0, bag_size: 5036
batch 519, loss: 1.1004, instance_loss: 0.7031, weighted_loss: 0.9812, label: 1, bag_size: 4373
batch 539, loss: 0.4472, instance_loss: 0.5415, weighted_loss: 0.4755, label: 1, bag_size: 3493
batch 559, loss: 0.3068, instance_loss: 0.5529, weighted_loss: 0.3806, label: 2, bag_size: 4162
batch 579, loss: 0.9412, instance_loss: 0.7043, weighted_loss: 0.8701, label: 2, bag_size: 3534
batch 599, loss: 0.6773, instance_loss: 0.5325, weighted_loss: 0.6339, label: 1, bag_size: 6992
batch 619, loss: 1.0931, instance_loss: 0.7476, weighted_loss: 0.9894, label: 1, bag_size: 1066
batch 639, loss: 0.3383, instance_loss: 0.5537, weighted_loss: 0.4029, label: 0, bag_size: 6015
batch 659, loss: 2.5951, instance_loss: 0.9429, weighted_loss: 2.0994, label: 1, bag_size: 5035
batch 679, loss: 0.0253, instance_loss: 0.0632, weighted_loss: 0.0366, label: 2, bag_size: 4910
batch 699, loss: 1.5067, instance_loss: 0.9923, weighted_loss: 1.3524, label: 1, bag_size: 4694
batch 719, loss: 0.3132, instance_loss: 0.2781, weighted_loss: 0.3027, label: 2, bag_size: 3026
batch 739, loss: 1.1411, instance_loss: 0.7642, weighted_loss: 1.0280, label: 1, bag_size: 4806


class 0 clustering acc 0.9941834451901566: correct 17776/17880
class 1 clustering acc 0.08171140939597316: correct 487/5960
Epoch: 2, train_loss: 0.8512, train_clustering_loss:  0.6425, train_error: 0.3745
class 0: acc 0.5872340425531914, correct 138/235
class 1: acc 0.5245901639344263, correct 128/244
class 2: acc 0.7518796992481203, correct 200/266

Val Set, val_loss: 0.8910, val_error: 0.4043, auc: 0.8147
class 0 clustering acc 0.9933510638297872: correct 2241/2256
class 1 clustering acc 0.0398936170212766: correct 30/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3492, instance_loss: 0.7358, weighted_loss: 1.1652, label: 0, bag_size: 5950
batch 39, loss: 1.2598, instance_loss: 0.9104, weighted_loss: 1.1550, label: 1, bag_size: 3322
batch 59, loss: 0.9371, instance_loss: 0.6267, weighted_loss: 0.8440, label: 1, bag_size: 3100
batch 79, loss: 0.2711, instance_loss: 0.4545, weighted_loss: 0.3261, label: 0, bag_size: 272
batch 99, loss: 1.2739, instance_loss: 0.5545, weighted_loss: 1.0581, label: 2, bag_size: 614
batch 119, loss: 0.3553, instance_loss: 0.4341, weighted_loss: 0.3790, label: 0, bag_size: 3741
batch 139, loss: 0.6990, instance_loss: 0.7228, weighted_loss: 0.7062, label: 0, bag_size: 4678
batch 159, loss: 0.2648, instance_loss: 0.3931, weighted_loss: 0.3033, label: 0, bag_size: 5038
batch 179, loss: 0.5626, instance_loss: 0.4735, weighted_loss: 0.5359, label: 2, bag_size: 705
batch 199, loss: 2.9039, instance_loss: 1.3428, weighted_loss: 2.4356, label: 1, bag_size: 2727
batch 219, loss: 0.3879, instance_loss: 0.4189, weighted_loss: 0.3972, label: 0, bag_size: 5632
batch 239, loss: 2.2203, instance_loss: 1.1112, weighted_loss: 1.8875, label: 1, bag_size: 20666
batch 259, loss: 0.1567, instance_loss: 0.2807, weighted_loss: 0.1939, label: 0, bag_size: 1087
batch 279, loss: 0.4755, instance_loss: 0.7337, weighted_loss: 0.5530, label: 0, bag_size: 2044
batch 299, loss: 0.7129, instance_loss: 0.7287, weighted_loss: 0.7177, label: 0, bag_size: 2671
batch 319, loss: 0.2037, instance_loss: 0.6335, weighted_loss: 0.3326, label: 2, bag_size: 4140
batch 339, loss: 0.2307, instance_loss: 0.4107, weighted_loss: 0.2847, label: 2, bag_size: 4291
batch 359, loss: 1.0860, instance_loss: 0.7105, weighted_loss: 0.9733, label: 1, bag_size: 4187
batch 379, loss: 0.1934, instance_loss: 0.2333, weighted_loss: 0.2054, label: 2, bag_size: 2254
batch 399, loss: 2.5790, instance_loss: 1.1831, weighted_loss: 2.1602, label: 1, bag_size: 4290
batch 419, loss: 0.9335, instance_loss: 0.8617, weighted_loss: 0.9120, label: 0, bag_size: 877
batch 439, loss: 0.4870, instance_loss: 0.6120, weighted_loss: 0.5245, label: 2, bag_size: 4555
batch 459, loss: 2.4176, instance_loss: 0.9002, weighted_loss: 1.9624, label: 1, bag_size: 5423
batch 479, loss: 1.4620, instance_loss: 0.8538, weighted_loss: 1.2795, label: 2, bag_size: 3534
batch 499, loss: 0.3729, instance_loss: 0.5127, weighted_loss: 0.4148, label: 0, bag_size: 3855
batch 519, loss: 0.5918, instance_loss: 0.4587, weighted_loss: 0.5518, label: 1, bag_size: 10941
batch 539, loss: 0.4331, instance_loss: 0.5932, weighted_loss: 0.4811, label: 0, bag_size: 3539
batch 559, loss: 1.0787, instance_loss: 0.4974, weighted_loss: 0.9043, label: 1, bag_size: 3644
batch 579, loss: 0.6343, instance_loss: 0.9798, weighted_loss: 0.7380, label: 2, bag_size: 4978
batch 599, loss: 0.3046, instance_loss: 0.5355, weighted_loss: 0.3739, label: 0, bag_size: 2290
batch 619, loss: 0.4040, instance_loss: 0.5905, weighted_loss: 0.4600, label: 0, bag_size: 4914
batch 639, loss: 1.4678, instance_loss: 0.9022, weighted_loss: 1.2981, label: 0, bag_size: 6223
batch 659, loss: 0.1652, instance_loss: 0.1325, weighted_loss: 0.1554, label: 2, bag_size: 3176
batch 679, loss: 0.7165, instance_loss: 0.4918, weighted_loss: 0.6491, label: 2, bag_size: 3497
batch 699, loss: 0.5912, instance_loss: 0.6613, weighted_loss: 0.6122, label: 0, bag_size: 3182
batch 719, loss: 0.5761, instance_loss: 0.3875, weighted_loss: 0.5195, label: 1, bag_size: 2744
batch 739, loss: 0.8806, instance_loss: 0.2920, weighted_loss: 0.7040, label: 1, bag_size: 6993


class 0 clustering acc 0.988255033557047: correct 17670/17880
class 1 clustering acc 0.08875838926174497: correct 529/5960
Epoch: 3, train_loss: 0.8340, train_clustering_loss:  0.6483, train_error: 0.3651
class 0: acc 0.6935483870967742, correct 172/248
class 1: acc 0.49387755102040815, correct 121/245
class 2: acc 0.7142857142857143, correct 180/252

Val Set, val_loss: 0.7358, val_error: 0.3085, auc: 0.8201
class 0 clustering acc 0.9827127659574468: correct 2217/2256
class 1 clustering acc 0.07180851063829788: correct 54/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.871775 --> 0.735778).  Saving model ...


batch 19, loss: 0.1305, instance_loss: 0.4387, weighted_loss: 0.2230, label: 0, bag_size: 873
batch 39, loss: 0.5064, instance_loss: 0.3784, weighted_loss: 0.4680, label: 1, bag_size: 6152
batch 59, loss: 0.1767, instance_loss: 0.1606, weighted_loss: 0.1719, label: 2, bag_size: 88
batch 79, loss: 0.3691, instance_loss: 0.4914, weighted_loss: 0.4058, label: 0, bag_size: 2339
batch 99, loss: 0.7595, instance_loss: 0.5790, weighted_loss: 0.7054, label: 2, bag_size: 3534
batch 119, loss: 0.7892, instance_loss: 0.4995, weighted_loss: 0.7023, label: 2, bag_size: 3475
batch 139, loss: 0.0816, instance_loss: 0.1430, weighted_loss: 0.1000, label: 2, bag_size: 4043
batch 159, loss: 1.6368, instance_loss: 1.0330, weighted_loss: 1.4556, label: 1, bag_size: 32
batch 179, loss: 0.7761, instance_loss: 0.6949, weighted_loss: 0.7517, label: 0, bag_size: 5377
batch 199, loss: 0.2927, instance_loss: 0.4528, weighted_loss: 0.3407, label: 0, bag_size: 4734
batch 219, loss: 0.3869, instance_loss: 0.7368, weighted_loss: 0.4919, label: 2, bag_size: 5011
batch 239, loss: 1.4002, instance_loss: 0.8017, weighted_loss: 1.2206, label: 2, bag_size: 909
batch 259, loss: 0.2725, instance_loss: 0.4633, weighted_loss: 0.3297, label: 0, bag_size: 2884
batch 279, loss: 0.5036, instance_loss: 0.4338, weighted_loss: 0.4827, label: 0, bag_size: 4378
batch 299, loss: 1.2000, instance_loss: 0.6079, weighted_loss: 1.0224, label: 0, bag_size: 14791
batch 319, loss: 1.0772, instance_loss: 0.7875, weighted_loss: 0.9903, label: 1, bag_size: 8632
batch 339, loss: 0.2803, instance_loss: 0.5219, weighted_loss: 0.3528, label: 0, bag_size: 3601
batch 359, loss: 0.2759, instance_loss: 0.4628, weighted_loss: 0.3320, label: 0, bag_size: 7169
batch 379, loss: 1.1045, instance_loss: 0.8424, weighted_loss: 1.0259, label: 1, bag_size: 5512
batch 399, loss: 0.7418, instance_loss: 1.1418, weighted_loss: 0.8618, label: 2, bag_size: 2049
batch 419, loss: 0.7477, instance_loss: 0.8684, weighted_loss: 0.7839, label: 0, bag_size: 3155
batch 439, loss: 0.7700, instance_loss: 0.6058, weighted_loss: 0.7208, label: 2, bag_size: 4096
batch 459, loss: 0.4985, instance_loss: 0.7362, weighted_loss: 0.5698, label: 2, bag_size: 3746
batch 479, loss: 2.1297, instance_loss: 1.2235, weighted_loss: 1.8578, label: 1, bag_size: 1670
batch 499, loss: 0.9664, instance_loss: 1.0552, weighted_loss: 0.9930, label: 1, bag_size: 936
batch 519, loss: 1.3175, instance_loss: 1.0275, weighted_loss: 1.2305, label: 1, bag_size: 6315
batch 539, loss: 0.0001, instance_loss: 0.0037, weighted_loss: 0.0012, label: 0, bag_size: 4918
batch 559, loss: 0.6911, instance_loss: 0.5334, weighted_loss: 0.6438, label: 1, bag_size: 3225
batch 579, loss: 0.1152, instance_loss: 0.5190, weighted_loss: 0.2363, label: 1, bag_size: 3558
batch 599, loss: 0.1578, instance_loss: 0.2535, weighted_loss: 0.1865, label: 1, bag_size: 4595
batch 619, loss: 0.9312, instance_loss: 0.7439, weighted_loss: 0.8750, label: 0, bag_size: 7330
batch 639, loss: 3.3884, instance_loss: 2.1517, weighted_loss: 3.0174, label: 0, bag_size: 434
batch 659, loss: 0.4141, instance_loss: 0.5984, weighted_loss: 0.4694, label: 0, bag_size: 3245
batch 679, loss: 2.2668, instance_loss: 0.8129, weighted_loss: 1.8307, label: 0, bag_size: 4572
batch 699, loss: 1.4827, instance_loss: 0.7105, weighted_loss: 1.2510, label: 1, bag_size: 5003
batch 719, loss: 0.4418, instance_loss: 0.5655, weighted_loss: 0.4789, label: 0, bag_size: 1611
batch 739, loss: 0.6774, instance_loss: 0.4182, weighted_loss: 0.5996, label: 2, bag_size: 2997


class 0 clustering acc 0.9886465324384788: correct 17677/17880
class 1 clustering acc 0.11728187919463087: correct 699/5960
Epoch: 4, train_loss: 0.8073, train_clustering_loss:  0.6338, train_error: 0.3530
class 0: acc 0.686046511627907, correct 177/258
class 1: acc 0.44493392070484583, correct 101/227
class 2: acc 0.7846153846153846, correct 204/260

Val Set, val_loss: 0.7229, val_error: 0.2979, auc: 0.8456
class 0 clustering acc 0.9889184397163121: correct 2231/2256
class 1 clustering acc 0.0678191489361702: correct 51/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
Validation loss decreased (0.735778 --> 0.722864).  Saving model ...


batch 19, loss: 0.0614, instance_loss: 0.1692, weighted_loss: 0.0938, label: 1, bag_size: 2796
batch 39, loss: 0.4911, instance_loss: 0.4082, weighted_loss: 0.4662, label: 1, bag_size: 3604
batch 59, loss: 1.2363, instance_loss: 0.5223, weighted_loss: 1.0221, label: 2, bag_size: 5307
batch 79, loss: 2.2179, instance_loss: 1.2470, weighted_loss: 1.9266, label: 1, bag_size: 2751
batch 99, loss: 0.1884, instance_loss: 0.1996, weighted_loss: 0.1918, label: 2, bag_size: 3327
batch 119, loss: 0.3204, instance_loss: 0.5137, weighted_loss: 0.3783, label: 0, bag_size: 2231
batch 139, loss: 1.0071, instance_loss: 0.8683, weighted_loss: 0.9654, label: 1, bag_size: 3475
batch 159, loss: 0.2385, instance_loss: 0.2760, weighted_loss: 0.2498, label: 2, bag_size: 4056
batch 179, loss: 0.1177, instance_loss: 0.3239, weighted_loss: 0.1796, label: 0, bag_size: 4855
batch 199, loss: 0.1164, instance_loss: 0.5171, weighted_loss: 0.2366, label: 2, bag_size: 3618
batch 219, loss: 0.1253, instance_loss: 0.3210, weighted_loss: 0.1840, label: 2, bag_size: 3678
batch 239, loss: 1.5400, instance_loss: 1.0858, weighted_loss: 1.4037, label: 1, bag_size: 2302
batch 259, loss: 0.1882, instance_loss: 0.5114, weighted_loss: 0.2852, label: 1, bag_size: 3357
batch 279, loss: 0.0817, instance_loss: 0.1445, weighted_loss: 0.1005, label: 2, bag_size: 3094
batch 299, loss: 0.6401, instance_loss: 0.6771, weighted_loss: 0.6512, label: 0, bag_size: 1097
batch 319, loss: 1.7864, instance_loss: 0.8814, weighted_loss: 1.5149, label: 0, bag_size: 3830
batch 339, loss: 1.6141, instance_loss: 1.1544, weighted_loss: 1.4762, label: 0, bag_size: 3709
batch 359, loss: 2.7206, instance_loss: 1.0301, weighted_loss: 2.2135, label: 1, bag_size: 5423
batch 379, loss: 0.1320, instance_loss: 0.5393, weighted_loss: 0.2542, label: 2, bag_size: 5017
batch 399, loss: 0.7222, instance_loss: 0.5608, weighted_loss: 0.6738, label: 1, bag_size: 4438
batch 419, loss: 1.0935, instance_loss: 0.6406, weighted_loss: 0.9576, label: 1, bag_size: 5402
batch 439, loss: 0.4525, instance_loss: 0.6954, weighted_loss: 0.5254, label: 0, bag_size: 2479
batch 459, loss: 0.3131, instance_loss: 0.2986, weighted_loss: 0.3088, label: 2, bag_size: 2359
batch 479, loss: 0.2716, instance_loss: 0.5221, weighted_loss: 0.3467, label: 0, bag_size: 5337
batch 499, loss: 4.1754, instance_loss: 1.0245, weighted_loss: 3.2301, label: 2, bag_size: 361
batch 519, loss: 0.3555, instance_loss: 0.6426, weighted_loss: 0.4416, label: 2, bag_size: 6594
batch 539, loss: 0.4492, instance_loss: 0.4956, weighted_loss: 0.4631, label: 0, bag_size: 2884
batch 559, loss: 0.1575, instance_loss: 0.4010, weighted_loss: 0.2305, label: 2, bag_size: 4555
batch 579, loss: 1.0482, instance_loss: 0.7598, weighted_loss: 0.9617, label: 0, bag_size: 1270
batch 599, loss: 0.7065, instance_loss: 0.6329, weighted_loss: 0.6844, label: 0, bag_size: 1071
batch 619, loss: 0.4172, instance_loss: 0.4297, weighted_loss: 0.4209, label: 1, bag_size: 1854
batch 639, loss: 0.0657, instance_loss: 0.1772, weighted_loss: 0.0992, label: 1, bag_size: 2905
batch 659, loss: 0.4154, instance_loss: 0.2460, weighted_loss: 0.3646, label: 1, bag_size: 2945
batch 679, loss: 0.2688, instance_loss: 0.3042, weighted_loss: 0.2794, label: 1, bag_size: 3586
batch 699, loss: 0.4877, instance_loss: 0.5129, weighted_loss: 0.4953, label: 2, bag_size: 6001
batch 719, loss: 0.0671, instance_loss: 0.1083, weighted_loss: 0.0795, label: 1, bag_size: 2009
batch 739, loss: 0.0049, instance_loss: 0.1108, weighted_loss: 0.0367, label: 2, bag_size: 2031


class 0 clustering acc 0.9814317673378076: correct 17548/17880
class 1 clustering acc 0.2041946308724832: correct 1217/5960
Epoch: 5, train_loss: 0.7505, train_clustering_loss:  0.6118, train_error: 0.3235
class 0: acc 0.6355140186915887, correct 136/214
class 1: acc 0.6236162361623616, correct 169/271
class 2: acc 0.7653846153846153, correct 199/260

Val Set, val_loss: 1.0270, val_error: 0.4468, auc: 0.7880
class 0 clustering acc 0.9397163120567376: correct 2120/2256
class 1 clustering acc 0.12367021276595745: correct 93/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5075, instance_loss: 0.8044, weighted_loss: 0.5966, label: 0, bag_size: 3245
batch 39, loss: 1.5969, instance_loss: 0.9357, weighted_loss: 1.3985, label: 2, bag_size: 1222
batch 59, loss: 3.4616, instance_loss: 1.0714, weighted_loss: 2.7445, label: 2, bag_size: 361
batch 79, loss: 1.3464, instance_loss: 0.7568, weighted_loss: 1.1695, label: 0, bag_size: 877
batch 99, loss: 0.2934, instance_loss: 0.4941, weighted_loss: 0.3536, label: 0, bag_size: 3649
batch 119, loss: 1.4155, instance_loss: 1.0404, weighted_loss: 1.3030, label: 1, bag_size: 3403
batch 139, loss: 0.5089, instance_loss: 0.5694, weighted_loss: 0.5271, label: 2, bag_size: 4162
batch 159, loss: 2.4714, instance_loss: 0.9798, weighted_loss: 2.0239, label: 0, bag_size: 4274
batch 179, loss: 1.1168, instance_loss: 0.8177, weighted_loss: 1.0270, label: 1, bag_size: 1250
batch 199, loss: 0.0186, instance_loss: 0.1553, weighted_loss: 0.0596, label: 2, bag_size: 2422
batch 219, loss: 1.1925, instance_loss: 0.8678, weighted_loss: 1.0951, label: 1, bag_size: 1045
batch 239, loss: 0.3292, instance_loss: 0.4597, weighted_loss: 0.3684, label: 2, bag_size: 3778
batch 259, loss: 0.5124, instance_loss: 0.6894, weighted_loss: 0.5655, label: 0, bag_size: 5899
batch 279, loss: 0.6117, instance_loss: 0.4364, weighted_loss: 0.5591, label: 1, bag_size: 2744
batch 299, loss: 0.3476, instance_loss: 0.5063, weighted_loss: 0.3952, label: 2, bag_size: 5637
batch 319, loss: 1.2413, instance_loss: 0.9077, weighted_loss: 1.1412, label: 2, bag_size: 2326
batch 339, loss: 1.4810, instance_loss: 0.9178, weighted_loss: 1.3120, label: 1, bag_size: 1045
batch 359, loss: 0.2583, instance_loss: 0.6011, weighted_loss: 0.3611, label: 2, bag_size: 2313
batch 379, loss: 2.3605, instance_loss: 0.7566, weighted_loss: 1.8793, label: 2, bag_size: 4241
batch 399, loss: 0.6596, instance_loss: 0.6794, weighted_loss: 0.6656, label: 1, bag_size: 5512
batch 419, loss: 1.1880, instance_loss: 0.7703, weighted_loss: 1.0627, label: 1, bag_size: 2481
batch 439, loss: 0.8130, instance_loss: 0.3308, weighted_loss: 0.6683, label: 1, bag_size: 5926
batch 459, loss: 0.0444, instance_loss: 0.1713, weighted_loss: 0.0825, label: 2, bag_size: 3121
batch 479, loss: 0.1293, instance_loss: 0.3197, weighted_loss: 0.1864, label: 0, bag_size: 622
batch 499, loss: 0.9966, instance_loss: 0.8221, weighted_loss: 0.9443, label: 0, bag_size: 6927
batch 519, loss: 0.7874, instance_loss: 0.8350, weighted_loss: 0.8017, label: 2, bag_size: 4162
batch 539, loss: 2.1517, instance_loss: 0.8798, weighted_loss: 1.7701, label: 1, bag_size: 12936
batch 559, loss: 0.3280, instance_loss: 0.5186, weighted_loss: 0.3852, label: 0, bag_size: 3694
batch 579, loss: 1.2886, instance_loss: 0.9118, weighted_loss: 1.1756, label: 2, bag_size: 1513
batch 599, loss: 2.1489, instance_loss: 0.9873, weighted_loss: 1.8004, label: 0, bag_size: 1365
batch 619, loss: 0.4436, instance_loss: 0.4661, weighted_loss: 0.4504, label: 2, bag_size: 3678
batch 639, loss: 2.2686, instance_loss: 1.3670, weighted_loss: 1.9981, label: 0, bag_size: 11141
batch 659, loss: 0.5068, instance_loss: 0.5731, weighted_loss: 0.5267, label: 0, bag_size: 1233
batch 679, loss: 0.2601, instance_loss: 0.2247, weighted_loss: 0.2495, label: 1, bag_size: 6277
batch 699, loss: 0.7150, instance_loss: 0.5209, weighted_loss: 0.6567, label: 1, bag_size: 3296
batch 719, loss: 0.8674, instance_loss: 0.5658, weighted_loss: 0.7769, label: 1, bag_size: 4395
batch 739, loss: 1.8513, instance_loss: 0.7837, weighted_loss: 1.5310, label: 1, bag_size: 5035


class 0 clustering acc 0.9843400447427293: correct 17600/17880
class 1 clustering acc 0.13523489932885907: correct 806/5960
Epoch: 6, train_loss: 0.7814, train_clustering_loss:  0.6351, train_error: 0.3329
class 0: acc 0.7166666666666667, correct 172/240
class 1: acc 0.5725490196078431, correct 146/255
class 2: acc 0.716, correct 179/250

Val Set, val_loss: 0.6692, val_error: 0.2660, auc: 0.8630
class 0 clustering acc 0.9929078014184397: correct 2240/2256
class 1 clustering acc 0.0425531914893617: correct 32/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.722864 --> 0.669198).  Saving model ...


batch 19, loss: 0.5024, instance_loss: 0.5897, weighted_loss: 0.5286, label: 0, bag_size: 11663
batch 39, loss: 1.1803, instance_loss: 0.9965, weighted_loss: 1.1252, label: 2, bag_size: 4241
batch 59, loss: 1.0977, instance_loss: 0.8283, weighted_loss: 1.0169, label: 0, bag_size: 1808
batch 79, loss: 0.5592, instance_loss: 0.5806, weighted_loss: 0.5656, label: 1, bag_size: 5696
batch 99, loss: 2.2732, instance_loss: 0.9432, weighted_loss: 1.8742, label: 2, bag_size: 728
batch 119, loss: 0.5649, instance_loss: 0.7837, weighted_loss: 0.6305, label: 2, bag_size: 2486
batch 139, loss: 0.1283, instance_loss: 0.1549, weighted_loss: 0.1363, label: 2, bag_size: 6026
batch 159, loss: 0.9196, instance_loss: 0.5915, weighted_loss: 0.8212, label: 1, bag_size: 1860
batch 179, loss: 0.4969, instance_loss: 0.5233, weighted_loss: 0.5048, label: 2, bag_size: 3534
batch 199, loss: 1.7635, instance_loss: 1.0943, weighted_loss: 1.5627, label: 1, bag_size: 1580
batch 219, loss: 0.3620, instance_loss: 0.3780, weighted_loss: 0.3668, label: 2, bag_size: 3080
batch 239, loss: 0.2760, instance_loss: 0.1589, weighted_loss: 0.2409, label: 2, bag_size: 4043
batch 259, loss: 0.2930, instance_loss: 0.5065, weighted_loss: 0.3570, label: 0, bag_size: 2897
batch 279, loss: 0.5169, instance_loss: 0.7373, weighted_loss: 0.5830, label: 0, bag_size: 4997
batch 299, loss: 2.4866, instance_loss: 1.0799, weighted_loss: 2.0646, label: 2, bag_size: 728
batch 319, loss: 0.1197, instance_loss: 0.2339, weighted_loss: 0.1539, label: 2, bag_size: 3210
batch 339, loss: 0.3683, instance_loss: 0.2023, weighted_loss: 0.3185, label: 2, bag_size: 3026
batch 359, loss: 1.1662, instance_loss: 1.0827, weighted_loss: 1.1412, label: 1, bag_size: 4824
batch 379, loss: 0.3290, instance_loss: 0.4784, weighted_loss: 0.3738, label: 0, bag_size: 4734
batch 399, loss: 0.8975, instance_loss: 0.6534, weighted_loss: 0.8243, label: 1, bag_size: 5011
batch 419, loss: 0.6808, instance_loss: 0.6427, weighted_loss: 0.6694, label: 0, bag_size: 2671
batch 439, loss: 0.5711, instance_loss: 0.5656, weighted_loss: 0.5695, label: 1, bag_size: 2472
batch 459, loss: 1.4628, instance_loss: 0.8734, weighted_loss: 1.2860, label: 1, bag_size: 2425
batch 479, loss: 1.0909, instance_loss: 0.5477, weighted_loss: 0.9280, label: 1, bag_size: 5718
batch 499, loss: 1.2562, instance_loss: 0.8271, weighted_loss: 1.1275, label: 1, bag_size: 3100
batch 519, loss: 0.2628, instance_loss: 0.2936, weighted_loss: 0.2720, label: 0, bag_size: 5041
batch 539, loss: 0.2508, instance_loss: 0.2159, weighted_loss: 0.2404, label: 2, bag_size: 2997
batch 559, loss: 0.7401, instance_loss: 0.4697, weighted_loss: 0.6590, label: 0, bag_size: 5413
batch 579, loss: 1.4651, instance_loss: 0.7266, weighted_loss: 1.2436, label: 2, bag_size: 728
batch 599, loss: 0.6745, instance_loss: 0.8366, weighted_loss: 0.7231, label: 1, bag_size: 10399
batch 619, loss: 0.2978, instance_loss: 0.5275, weighted_loss: 0.3667, label: 0, bag_size: 3743
batch 639, loss: 1.6031, instance_loss: 0.8745, weighted_loss: 1.3845, label: 2, bag_size: 909
batch 659, loss: 0.2462, instance_loss: 0.5950, weighted_loss: 0.3508, label: 0, bag_size: 1611
batch 679, loss: 2.2441, instance_loss: 1.2956, weighted_loss: 1.9595, label: 1, bag_size: 1712
batch 699, loss: 0.2747, instance_loss: 0.6996, weighted_loss: 0.4021, label: 0, bag_size: 2791
batch 719, loss: 0.6929, instance_loss: 0.4987, weighted_loss: 0.6347, label: 0, bag_size: 1662
batch 739, loss: 2.8733, instance_loss: 1.0601, weighted_loss: 2.3294, label: 0, bag_size: 4605


class 0 clustering acc 0.9835570469798658: correct 17586/17880
class 1 clustering acc 0.18540268456375839: correct 1105/5960
Epoch: 7, train_loss: 0.7424, train_clustering_loss:  0.6095, train_error: 0.3154
class 0: acc 0.6956521739130435, correct 160/230
class 1: acc 0.5806451612903226, correct 144/248
class 2: acc 0.7715355805243446, correct 206/267

Val Set, val_loss: 0.6582, val_error: 0.2766, auc: 0.8571
class 0 clustering acc 0.9694148936170213: correct 2187/2256
class 1 clustering acc 0.17420212765957446: correct 131/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5833333333333334, correct 7/12
Validation loss decreased (0.669198 --> 0.658226).  Saving model ...


batch 19, loss: 0.2543, instance_loss: 0.3240, weighted_loss: 0.2752, label: 2, bag_size: 5426
batch 39, loss: 3.1627, instance_loss: 1.3409, weighted_loss: 2.6161, label: 0, bag_size: 877
batch 59, loss: 0.1179, instance_loss: 0.7241, weighted_loss: 0.2998, label: 2, bag_size: 5017
batch 79, loss: 0.6011, instance_loss: 0.2466, weighted_loss: 0.4948, label: 1, bag_size: 6993
batch 99, loss: 0.3369, instance_loss: 0.4819, weighted_loss: 0.3804, label: 0, bag_size: 1071
batch 119, loss: 0.8345, instance_loss: 0.7729, weighted_loss: 0.8160, label: 1, bag_size: 7176
batch 139, loss: 0.3088, instance_loss: 0.2636, weighted_loss: 0.2953, label: 2, bag_size: 4043
batch 159, loss: 0.3140, instance_loss: 0.3504, weighted_loss: 0.3249, label: 2, bag_size: 3026
batch 179, loss: 0.9993, instance_loss: 0.6816, weighted_loss: 0.9040, label: 2, bag_size: 5426
batch 199, loss: 0.3684, instance_loss: 0.7380, weighted_loss: 0.4793, label: 0, bag_size: 3920
batch 219, loss: 1.9971, instance_loss: 0.9757, weighted_loss: 1.6907, label: 2, bag_size: 3112
batch 239, loss: 0.4501, instance_loss: 0.4866, weighted_loss: 0.4611, label: 1, bag_size: 800
batch 259, loss: 1.2178, instance_loss: 0.9657, weighted_loss: 1.1421, label: 2, bag_size: 4241
batch 279, loss: 0.9246, instance_loss: 0.6775, weighted_loss: 0.8505, label: 0, bag_size: 4584
batch 299, loss: 0.8196, instance_loss: 0.4900, weighted_loss: 0.7207, label: 1, bag_size: 6025
batch 319, loss: 0.4966, instance_loss: 0.6313, weighted_loss: 0.5370, label: 1, bag_size: 3746
batch 339, loss: 0.5064, instance_loss: 0.5361, weighted_loss: 0.5153, label: 0, bag_size: 2286
batch 359, loss: 0.4329, instance_loss: 0.3820, weighted_loss: 0.4177, label: 1, bag_size: 6475
batch 379, loss: 0.1060, instance_loss: 0.2742, weighted_loss: 0.1565, label: 0, bag_size: 5757
batch 399, loss: 0.0643, instance_loss: 0.0867, weighted_loss: 0.0710, label: 2, bag_size: 6026
batch 419, loss: 0.2448, instance_loss: 0.3250, weighted_loss: 0.2689, label: 2, bag_size: 2359
batch 439, loss: 0.3723, instance_loss: 0.1211, weighted_loss: 0.2969, label: 2, bag_size: 88
batch 459, loss: 3.1334, instance_loss: 1.2457, weighted_loss: 2.5671, label: 2, bag_size: 361
batch 479, loss: 0.4781, instance_loss: 0.5086, weighted_loss: 0.4872, label: 0, bag_size: 3864
batch 499, loss: 0.2485, instance_loss: 0.4255, weighted_loss: 0.3016, label: 0, bag_size: 6285
batch 519, loss: 0.0939, instance_loss: 0.1815, weighted_loss: 0.1202, label: 0, bag_size: 5006
batch 539, loss: 2.1693, instance_loss: 0.8622, weighted_loss: 1.7772, label: 0, bag_size: 4639
batch 559, loss: 1.4152, instance_loss: 0.8391, weighted_loss: 1.2424, label: 0, bag_size: 1025
batch 579, loss: 0.3124, instance_loss: 0.6630, weighted_loss: 0.4176, label: 0, bag_size: 3648
batch 599, loss: 2.3302, instance_loss: 1.2538, weighted_loss: 2.0073, label: 2, bag_size: 6298
batch 619, loss: 0.2113, instance_loss: 0.2888, weighted_loss: 0.2346, label: 0, bag_size: 2852
batch 639, loss: 1.1742, instance_loss: 0.6415, weighted_loss: 1.0144, label: 0, bag_size: 8866
batch 659, loss: 1.9571, instance_loss: 1.0448, weighted_loss: 1.6834, label: 1, bag_size: 1670
batch 679, loss: 0.3574, instance_loss: 0.3052, weighted_loss: 0.3417, label: 2, bag_size: 4043
batch 699, loss: 0.3195, instance_loss: 0.5996, weighted_loss: 0.4035, label: 2, bag_size: 2770
batch 719, loss: 0.4697, instance_loss: 0.2757, weighted_loss: 0.4115, label: 2, bag_size: 3026
batch 739, loss: 0.3381, instance_loss: 0.2253, weighted_loss: 0.3043, label: 2, bag_size: 3026


class 0 clustering acc 0.978076062639821: correct 17488/17880
class 1 clustering acc 0.23557046979865773: correct 1404/5960
Epoch: 8, train_loss: 0.7044, train_clustering_loss:  0.5879, train_error: 0.3181
class 0: acc 0.7450199203187251, correct 187/251
class 1: acc 0.6007751937984496, correct 155/258
class 2: acc 0.7033898305084746, correct 166/236

Val Set, val_loss: 0.6931, val_error: 0.2872, auc: 0.8658
class 0 clustering acc 0.9822695035460993: correct 2216/2256
class 1 clustering acc 0.18617021276595744: correct 140/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8877, instance_loss: 0.7357, weighted_loss: 0.8421, label: 1, bag_size: 5718
batch 39, loss: 0.4196, instance_loss: 0.5889, weighted_loss: 0.4704, label: 0, bag_size: 3268
batch 59, loss: 0.6622, instance_loss: 0.4954, weighted_loss: 0.6122, label: 1, bag_size: 3746
batch 79, loss: 0.2449, instance_loss: 0.5291, weighted_loss: 0.3301, label: 0, bag_size: 1981
batch 99, loss: 0.2038, instance_loss: 0.3564, weighted_loss: 0.2496, label: 0, bag_size: 921
batch 119, loss: 0.8635, instance_loss: 0.6658, weighted_loss: 0.8042, label: 1, bag_size: 2767
batch 139, loss: 0.5488, instance_loss: 0.5511, weighted_loss: 0.5495, label: 0, bag_size: 598
batch 159, loss: 0.4255, instance_loss: 0.5898, weighted_loss: 0.4748, label: 0, bag_size: 4344
batch 179, loss: 0.6207, instance_loss: 0.7415, weighted_loss: 0.6569, label: 2, bag_size: 3174
batch 199, loss: 1.0744, instance_loss: 0.5471, weighted_loss: 0.9162, label: 1, bag_size: 4395
batch 219, loss: 0.1429, instance_loss: 0.3235, weighted_loss: 0.1971, label: 0, bag_size: 4783
batch 239, loss: 2.0501, instance_loss: 1.0979, weighted_loss: 1.7645, label: 0, bag_size: 3075
batch 259, loss: 0.1159, instance_loss: 0.1250, weighted_loss: 0.1186, label: 2, bag_size: 2997
batch 279, loss: 1.7550, instance_loss: 1.1596, weighted_loss: 1.5764, label: 2, bag_size: 3299
batch 299, loss: 0.5345, instance_loss: 0.8559, weighted_loss: 0.6309, label: 2, bag_size: 4192
batch 319, loss: 2.4926, instance_loss: 1.0874, weighted_loss: 2.0711, label: 0, bag_size: 2915
batch 339, loss: 1.6570, instance_loss: 1.1587, weighted_loss: 1.5075, label: 1, bag_size: 667
batch 359, loss: 0.3247, instance_loss: 0.2540, weighted_loss: 0.3035, label: 1, bag_size: 3761
batch 379, loss: 0.0430, instance_loss: 0.4411, weighted_loss: 0.1625, label: 2, bag_size: 4140
batch 399, loss: 0.4168, instance_loss: 0.2385, weighted_loss: 0.3633, label: 2, bag_size: 3026
batch 419, loss: 0.1882, instance_loss: 0.3490, weighted_loss: 0.2364, label: 0, bag_size: 4405
batch 439, loss: 0.0524, instance_loss: 0.0992, weighted_loss: 0.0665, label: 2, bag_size: 4856
batch 459, loss: 0.3941, instance_loss: 0.3653, weighted_loss: 0.3855, label: 0, bag_size: 5368
batch 479, loss: 0.1581, instance_loss: 0.2925, weighted_loss: 0.1984, label: 0, bag_size: 14070
batch 499, loss: 1.8961, instance_loss: 1.1357, weighted_loss: 1.6680, label: 1, bag_size: 3791
batch 519, loss: 0.0618, instance_loss: 0.5108, weighted_loss: 0.1965, label: 2, bag_size: 4140
batch 539, loss: 1.1638, instance_loss: 0.9040, weighted_loss: 1.0859, label: 2, bag_size: 4291
batch 559, loss: 0.2000, instance_loss: 0.2285, weighted_loss: 0.2085, label: 1, bag_size: 2731
batch 579, loss: 0.0551, instance_loss: 0.3088, weighted_loss: 0.1312, label: 1, bag_size: 3172
batch 599, loss: 0.6178, instance_loss: 0.4020, weighted_loss: 0.5530, label: 1, bag_size: 6475
batch 619, loss: 0.2247, instance_loss: 0.2760, weighted_loss: 0.2401, label: 0, bag_size: 5108
batch 639, loss: 1.2323, instance_loss: 1.0049, weighted_loss: 1.1641, label: 0, bag_size: 313
batch 659, loss: 0.6763, instance_loss: 0.6518, weighted_loss: 0.6690, label: 2, bag_size: 4569
batch 679, loss: 0.6261, instance_loss: 0.5997, weighted_loss: 0.6182, label: 2, bag_size: 4569
batch 699, loss: 1.5692, instance_loss: 1.4643, weighted_loss: 1.5378, label: 1, bag_size: 2229
batch 719, loss: 0.7533, instance_loss: 0.6060, weighted_loss: 0.7091, label: 0, bag_size: 13540
batch 739, loss: 0.1131, instance_loss: 0.2141, weighted_loss: 0.1434, label: 0, bag_size: 5437


class 0 clustering acc 0.9766778523489933: correct 17463/17880
class 1 clustering acc 0.2174496644295302: correct 1296/5960
Epoch: 9, train_loss: 0.7478, train_clustering_loss:  0.6128, train_error: 0.3128
class 0: acc 0.7579365079365079, correct 191/252
class 1: acc 0.58203125, correct 149/256
class 2: acc 0.7257383966244726, correct 172/237

Val Set, val_loss: 0.7525, val_error: 0.3298, auc: 0.8443
class 0 clustering acc 0.9321808510638298: correct 2103/2256
class 1 clustering acc 0.24867021276595744: correct 187/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7070, instance_loss: 1.0176, weighted_loss: 1.5002, label: 1, bag_size: 1964
batch 39, loss: 0.5811, instance_loss: 0.4975, weighted_loss: 0.5560, label: 0, bag_size: 3367
batch 59, loss: 0.1512, instance_loss: 0.2797, weighted_loss: 0.1898, label: 1, bag_size: 3127
batch 79, loss: 0.0818, instance_loss: 0.1218, weighted_loss: 0.0938, label: 2, bag_size: 2997
batch 99, loss: 0.9637, instance_loss: 0.9352, weighted_loss: 0.9551, label: 1, bag_size: 6942
batch 119, loss: 0.2114, instance_loss: 0.6457, weighted_loss: 0.3417, label: 0, bag_size: 4485
batch 139, loss: 0.8124, instance_loss: 0.6398, weighted_loss: 0.7606, label: 0, bag_size: 4416
batch 159, loss: 0.3037, instance_loss: 0.4770, weighted_loss: 0.3557, label: 0, bag_size: 6971
batch 179, loss: 1.6086, instance_loss: 0.7100, weighted_loss: 1.3390, label: 0, bag_size: 3155
batch 199, loss: 0.0804, instance_loss: 0.5556, weighted_loss: 0.2230, label: 0, bag_size: 4485
batch 219, loss: 0.4335, instance_loss: 0.8176, weighted_loss: 0.5487, label: 0, bag_size: 3164
batch 239, loss: 1.7120, instance_loss: 1.0089, weighted_loss: 1.5011, label: 1, bag_size: 1964
batch 259, loss: 0.2810, instance_loss: 0.4351, weighted_loss: 0.3272, label: 0, bag_size: 3348
batch 279, loss: 0.3108, instance_loss: 0.4159, weighted_loss: 0.3423, label: 0, bag_size: 2884
batch 299, loss: 0.9545, instance_loss: 0.5450, weighted_loss: 0.8317, label: 1, bag_size: 6992
batch 319, loss: 0.7966, instance_loss: 0.4760, weighted_loss: 0.7004, label: 2, bag_size: 6704
batch 339, loss: 0.6036, instance_loss: 0.7640, weighted_loss: 0.6517, label: 2, bag_size: 3746
batch 359, loss: 1.4574, instance_loss: 1.0729, weighted_loss: 1.3421, label: 0, bag_size: 5950
batch 379, loss: 1.0448, instance_loss: 1.3562, weighted_loss: 1.1383, label: 2, bag_size: 5072
batch 399, loss: 0.3732, instance_loss: 0.7442, weighted_loss: 0.4845, label: 2, bag_size: 3534
batch 419, loss: 0.1138, instance_loss: 0.3955, weighted_loss: 0.1983, label: 0, bag_size: 4300
batch 439, loss: 0.8782, instance_loss: 0.7485, weighted_loss: 0.8393, label: 2, bag_size: 1543
batch 459, loss: 0.8881, instance_loss: 0.2552, weighted_loss: 0.6983, label: 2, bag_size: 3026
batch 479, loss: 0.7852, instance_loss: 0.6525, weighted_loss: 0.7454, label: 2, bag_size: 4291
batch 499, loss: 0.0303, instance_loss: 0.0512, weighted_loss: 0.0366, label: 2, bag_size: 6704
batch 519, loss: 0.1253, instance_loss: 0.2469, weighted_loss: 0.1618, label: 2, bag_size: 5138
batch 539, loss: 0.2387, instance_loss: 0.4094, weighted_loss: 0.2899, label: 2, bag_size: 5914
batch 559, loss: 0.4167, instance_loss: 0.3822, weighted_loss: 0.4064, label: 1, bag_size: 5412
batch 579, loss: 1.6604, instance_loss: 1.2262, weighted_loss: 1.5301, label: 0, bag_size: 893
batch 599, loss: 0.1510, instance_loss: 0.2964, weighted_loss: 0.1946, label: 2, bag_size: 3121
batch 619, loss: 0.4666, instance_loss: 0.5900, weighted_loss: 0.5036, label: 2, bag_size: 3112
batch 639, loss: 0.0908, instance_loss: 0.4862, weighted_loss: 0.2094, label: 0, bag_size: 873
batch 659, loss: 0.2392, instance_loss: 0.4136, weighted_loss: 0.2915, label: 0, bag_size: 1782
batch 679, loss: 0.2916, instance_loss: 0.3773, weighted_loss: 0.3173, label: 0, bag_size: 2884
batch 699, loss: 0.2485, instance_loss: 0.1325, weighted_loss: 0.2137, label: 1, bag_size: 6277
batch 719, loss: 0.8542, instance_loss: 1.0619, weighted_loss: 0.9165, label: 1, bag_size: 4181
batch 739, loss: 0.4040, instance_loss: 0.5090, weighted_loss: 0.4355, label: 0, bag_size: 3113


class 0 clustering acc 0.9787472035794184: correct 17500/17880
class 1 clustering acc 0.2302013422818792: correct 1372/5960
Epoch: 10, train_loss: 0.6873, train_clustering_loss:  0.5949, train_error: 0.2886
class 0: acc 0.70995670995671, correct 164/231
class 1: acc 0.6290322580645161, correct 156/248
class 2: acc 0.7894736842105263, correct 210/266

Val Set, val_loss: 0.7824, val_error: 0.3404, auc: 0.8484
class 0 clustering acc 0.9738475177304965: correct 2197/2256
class 1 clustering acc 0.09973404255319149: correct 75/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8473, instance_loss: 0.5419, weighted_loss: 0.7557, label: 1, bag_size: 3156
batch 39, loss: 0.5487, instance_loss: 0.5761, weighted_loss: 0.5569, label: 1, bag_size: 4812
batch 59, loss: 1.4562, instance_loss: 0.9225, weighted_loss: 1.2961, label: 0, bag_size: 1782
batch 79, loss: 1.0793, instance_loss: 0.6807, weighted_loss: 0.9597, label: 2, bag_size: 1543
batch 99, loss: 0.3367, instance_loss: 0.5229, weighted_loss: 0.3926, label: 2, bag_size: 4192
batch 119, loss: 2.6429, instance_loss: 1.2500, weighted_loss: 2.2250, label: 0, bag_size: 603
batch 139, loss: 0.1196, instance_loss: 0.2830, weighted_loss: 0.1686, label: 2, bag_size: 6148
batch 159, loss: 0.1313, instance_loss: 0.1822, weighted_loss: 0.1465, label: 2, bag_size: 3210
batch 179, loss: 0.8106, instance_loss: 0.5785, weighted_loss: 0.7409, label: 0, bag_size: 3571
batch 199, loss: 0.4490, instance_loss: 0.3374, weighted_loss: 0.4155, label: 2, bag_size: 705
batch 219, loss: 0.0624, instance_loss: 0.1772, weighted_loss: 0.0968, label: 2, bag_size: 4203
batch 239, loss: 0.5483, instance_loss: 0.5465, weighted_loss: 0.5478, label: 2, bag_size: 3210
batch 259, loss: 0.0837, instance_loss: 0.1785, weighted_loss: 0.1121, label: 1, bag_size: 2796
batch 279, loss: 0.1385, instance_loss: 0.3907, weighted_loss: 0.2141, label: 1, bag_size: 3333
batch 299, loss: 0.3955, instance_loss: 0.2287, weighted_loss: 0.3455, label: 2, bag_size: 3176
batch 319, loss: 0.4369, instance_loss: 0.4300, weighted_loss: 0.4348, label: 0, bag_size: 2487
batch 339, loss: 0.4377, instance_loss: 0.6307, weighted_loss: 0.4956, label: 2, bag_size: 3778
batch 359, loss: 0.0279, instance_loss: 0.1461, weighted_loss: 0.0634, label: 1, bag_size: 5364
batch 379, loss: 0.4644, instance_loss: 0.4718, weighted_loss: 0.4666, label: 1, bag_size: 3885
batch 399, loss: 0.1005, instance_loss: 0.1596, weighted_loss: 0.1182, label: 2, bag_size: 4088
batch 419, loss: 0.2765, instance_loss: 0.2143, weighted_loss: 0.2579, label: 2, bag_size: 6001
batch 439, loss: 0.3147, instance_loss: 0.5093, weighted_loss: 0.3731, label: 0, bag_size: 1170
batch 459, loss: 0.3764, instance_loss: 0.2825, weighted_loss: 0.3482, label: 2, bag_size: 3176
batch 479, loss: 3.1416, instance_loss: 1.6794, weighted_loss: 2.7030, label: 0, bag_size: 1886
batch 499, loss: 0.4544, instance_loss: 0.4349, weighted_loss: 0.4486, label: 1, bag_size: 3109
batch 519, loss: 1.8760, instance_loss: 0.9552, weighted_loss: 1.5998, label: 2, bag_size: 552
batch 539, loss: 0.3063, instance_loss: 0.3801, weighted_loss: 0.3284, label: 0, bag_size: 4905
batch 559, loss: 2.9325, instance_loss: 1.1949, weighted_loss: 2.4112, label: 1, bag_size: 3791
batch 579, loss: 0.2291, instance_loss: 0.2709, weighted_loss: 0.2416, label: 2, bag_size: 2997
batch 599, loss: 1.3203, instance_loss: 0.5133, weighted_loss: 1.0782, label: 1, bag_size: 5072
batch 619, loss: 0.4279, instance_loss: 0.6339, weighted_loss: 0.4897, label: 1, bag_size: 3437
batch 639, loss: 1.3311, instance_loss: 0.7137, weighted_loss: 1.1459, label: 1, bag_size: 5402
batch 659, loss: 0.4420, instance_loss: 0.4624, weighted_loss: 0.4481, label: 0, bag_size: 3834
batch 679, loss: 0.1498, instance_loss: 0.2825, weighted_loss: 0.1896, label: 0, bag_size: 4506
batch 699, loss: 0.9933, instance_loss: 0.7594, weighted_loss: 0.9231, label: 1, bag_size: 3983
batch 719, loss: 0.5570, instance_loss: 0.4972, weighted_loss: 0.5391, label: 0, bag_size: 2850
batch 739, loss: 0.0661, instance_loss: 0.2149, weighted_loss: 0.1107, label: 0, bag_size: 4015


class 0 clustering acc 0.9782997762863535: correct 17492/17880
class 1 clustering acc 0.24697986577181208: correct 1472/5960
Epoch: 11, train_loss: 0.7143, train_clustering_loss:  0.5900, train_error: 0.3208
class 0: acc 0.7056603773584905, correct 187/265
class 1: acc 0.6090534979423868, correct 148/243
class 2: acc 0.7215189873417721, correct 171/237

Val Set, val_loss: 0.6632, val_error: 0.2872, auc: 0.8622
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.3962765957446808: correct 298/752
class 0: acc 0.9423076923076923, correct 49/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5675, instance_loss: 0.5889, weighted_loss: 0.5739, label: 1, bag_size: 302
batch 39, loss: 0.1887, instance_loss: 0.0846, weighted_loss: 0.1575, label: 2, bag_size: 4056
batch 59, loss: 0.1451, instance_loss: 0.2939, weighted_loss: 0.1897, label: 1, bag_size: 6243
batch 79, loss: 2.2554, instance_loss: 1.1938, weighted_loss: 1.9369, label: 0, bag_size: 3419
batch 99, loss: 0.1594, instance_loss: 0.2619, weighted_loss: 0.1902, label: 0, bag_size: 1947
batch 119, loss: 1.3443, instance_loss: 1.0223, weighted_loss: 1.2477, label: 1, bag_size: 4694
batch 139, loss: 0.0014, instance_loss: 0.1346, weighted_loss: 0.0414, label: 2, bag_size: 2422
batch 159, loss: 0.5509, instance_loss: 0.7013, weighted_loss: 0.5960, label: 2, bag_size: 3618
batch 179, loss: 1.1965, instance_loss: 0.8529, weighted_loss: 1.0934, label: 0, bag_size: 6249
batch 199, loss: 0.8637, instance_loss: 0.7642, weighted_loss: 0.8339, label: 1, bag_size: 2859
batch 219, loss: 1.2960, instance_loss: 0.9804, weighted_loss: 1.2013, label: 2, bag_size: 3746
batch 239, loss: 1.3328, instance_loss: 0.7308, weighted_loss: 1.1522, label: 0, bag_size: 1755
batch 259, loss: 1.1473, instance_loss: 0.7410, weighted_loss: 1.0254, label: 1, bag_size: 1066
batch 279, loss: 0.6446, instance_loss: 0.5792, weighted_loss: 0.6250, label: 1, bag_size: 3438
batch 299, loss: 0.5572, instance_loss: 0.5665, weighted_loss: 0.5600, label: 0, bag_size: 3268
batch 319, loss: 0.3744, instance_loss: 0.4687, weighted_loss: 0.4027, label: 1, bag_size: 3586
batch 339, loss: 0.5699, instance_loss: 0.3114, weighted_loss: 0.4923, label: 2, bag_size: 2561
batch 359, loss: 1.9770, instance_loss: 1.3902, weighted_loss: 1.8010, label: 1, bag_size: 3016
batch 379, loss: 0.5316, instance_loss: 0.3092, weighted_loss: 0.4649, label: 1, bag_size: 2865
batch 399, loss: 0.5572, instance_loss: 0.4421, weighted_loss: 0.5226, label: 1, bag_size: 6475
batch 419, loss: 0.4872, instance_loss: 0.2744, weighted_loss: 0.4234, label: 2, bag_size: 4241
batch 439, loss: 0.9428, instance_loss: 0.6954, weighted_loss: 0.8686, label: 1, bag_size: 3422
batch 459, loss: 0.1930, instance_loss: 0.3103, weighted_loss: 0.2282, label: 0, bag_size: 4326
batch 479, loss: 0.2531, instance_loss: 0.3037, weighted_loss: 0.2683, label: 1, bag_size: 5532
batch 499, loss: 0.7921, instance_loss: 0.5286, weighted_loss: 0.7131, label: 1, bag_size: 6152
batch 519, loss: 2.3146, instance_loss: 1.0339, weighted_loss: 1.9304, label: 0, bag_size: 3387
batch 539, loss: 0.4592, instance_loss: 0.4335, weighted_loss: 0.4514, label: 2, bag_size: 597
batch 559, loss: 0.3141, instance_loss: 0.3215, weighted_loss: 0.3163, label: 0, bag_size: 2487
batch 579, loss: 0.5887, instance_loss: 0.5769, weighted_loss: 0.5852, label: 1, bag_size: 4869
batch 599, loss: 0.0167, instance_loss: 0.3806, weighted_loss: 0.1259, label: 2, bag_size: 5017
batch 619, loss: 1.3004, instance_loss: 1.0295, weighted_loss: 1.2191, label: 2, bag_size: 1513
batch 639, loss: 0.2791, instance_loss: 0.5822, weighted_loss: 0.3700, label: 1, bag_size: 3050
batch 659, loss: 0.1438, instance_loss: 0.5635, weighted_loss: 0.2697, label: 1, bag_size: 7279
batch 679, loss: 0.4045, instance_loss: 0.4538, weighted_loss: 0.4193, label: 0, bag_size: 1025
batch 699, loss: 0.4556, instance_loss: 0.6437, weighted_loss: 0.5120, label: 1, bag_size: 1250
batch 719, loss: 1.4257, instance_loss: 0.7433, weighted_loss: 1.2210, label: 2, bag_size: 3112
batch 739, loss: 0.3235, instance_loss: 0.5004, weighted_loss: 0.3765, label: 0, bag_size: 1883


class 0 clustering acc 0.9784116331096196: correct 17494/17880
class 1 clustering acc 0.23154362416107382: correct 1380/5960
Epoch: 12, train_loss: 0.7098, train_clustering_loss:  0.6029, train_error: 0.2953
class 0: acc 0.7224489795918367, correct 177/245
class 1: acc 0.6015625, correct 154/256
class 2: acc 0.7950819672131147, correct 194/244

Val Set, val_loss: 0.6959, val_error: 0.3085, auc: 0.8545
class 0 clustering acc 0.9884751773049646: correct 2230/2256
class 1 clustering acc 0.06914893617021277: correct 52/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3447, instance_loss: 0.5334, weighted_loss: 0.4013, label: 0, bag_size: 1812
batch 39, loss: 0.5550, instance_loss: 0.6011, weighted_loss: 0.5689, label: 0, bag_size: 4547
batch 59, loss: 0.2094, instance_loss: 0.5159, weighted_loss: 0.3014, label: 2, bag_size: 6148
batch 79, loss: 0.1777, instance_loss: 0.3495, weighted_loss: 0.2292, label: 0, bag_size: 6015
batch 99, loss: 0.0756, instance_loss: 0.1942, weighted_loss: 0.1112, label: 0, bag_size: 6138
batch 119, loss: 0.3057, instance_loss: 0.3340, weighted_loss: 0.3142, label: 2, bag_size: 3094
batch 139, loss: 1.1882, instance_loss: 0.8834, weighted_loss: 1.0967, label: 1, bag_size: 578
batch 159, loss: 0.0360, instance_loss: 0.3572, weighted_loss: 0.1324, label: 1, bag_size: 3425
batch 179, loss: 0.9945, instance_loss: 1.4132, weighted_loss: 1.1201, label: 0, bag_size: 2231
batch 199, loss: 0.6916, instance_loss: 0.6446, weighted_loss: 0.6775, label: 0, bag_size: 4541
batch 219, loss: 1.0345, instance_loss: 0.8318, weighted_loss: 0.9737, label: 1, bag_size: 2751
batch 239, loss: 0.4921, instance_loss: 0.3969, weighted_loss: 0.4635, label: 1, bag_size: 2865
batch 259, loss: 0.9514, instance_loss: 0.9738, weighted_loss: 0.9581, label: 2, bag_size: 1222
batch 279, loss: 0.4473, instance_loss: 0.4697, weighted_loss: 0.4540, label: 1, bag_size: 3296
batch 299, loss: 0.0616, instance_loss: 0.2216, weighted_loss: 0.1096, label: 2, bag_size: 5138
batch 319, loss: 1.0250, instance_loss: 0.6051, weighted_loss: 0.8990, label: 1, bag_size: 3221
batch 339, loss: 0.4400, instance_loss: 0.4227, weighted_loss: 0.4348, label: 1, bag_size: 10399
batch 359, loss: 0.7758, instance_loss: 0.6105, weighted_loss: 0.7262, label: 1, bag_size: 5512
batch 379, loss: 0.1637, instance_loss: 0.3178, weighted_loss: 0.2100, label: 2, bag_size: 5924
batch 399, loss: 0.0353, instance_loss: 0.1255, weighted_loss: 0.0623, label: 0, bag_size: 5337
batch 419, loss: 0.4538, instance_loss: 0.4521, weighted_loss: 0.4533, label: 1, bag_size: 3885
batch 439, loss: 0.7263, instance_loss: 0.9995, weighted_loss: 0.8083, label: 1, bag_size: 1221
batch 459, loss: 0.6545, instance_loss: 0.7598, weighted_loss: 0.6861, label: 2, bag_size: 6298
batch 479, loss: 0.7517, instance_loss: 0.5870, weighted_loss: 0.7023, label: 2, bag_size: 22464
batch 499, loss: 1.1316, instance_loss: 0.5645, weighted_loss: 0.9615, label: 2, bag_size: 552
batch 519, loss: 1.9152, instance_loss: 1.8099, weighted_loss: 1.8837, label: 1, bag_size: 936
batch 539, loss: 0.1522, instance_loss: 0.1097, weighted_loss: 0.1394, label: 2, bag_size: 3094
batch 559, loss: 1.1359, instance_loss: 0.1808, weighted_loss: 0.8494, label: 2, bag_size: 88
batch 579, loss: 1.2726, instance_loss: 1.0465, weighted_loss: 1.2048, label: 1, bag_size: 2747
batch 599, loss: 0.1725, instance_loss: 0.3109, weighted_loss: 0.2140, label: 0, bag_size: 2873
batch 619, loss: 0.0843, instance_loss: 0.4955, weighted_loss: 0.2077, label: 2, bag_size: 5011
batch 639, loss: 0.1523, instance_loss: 0.3292, weighted_loss: 0.2054, label: 0, bag_size: 1825
batch 659, loss: 0.8617, instance_loss: 0.8861, weighted_loss: 0.8690, label: 1, bag_size: 5412
batch 679, loss: 0.1021, instance_loss: 0.1459, weighted_loss: 0.1152, label: 2, bag_size: 3094
batch 699, loss: 0.0717, instance_loss: 0.3098, weighted_loss: 0.1432, label: 1, bag_size: 874
batch 719, loss: 0.0193, instance_loss: 0.0525, weighted_loss: 0.0293, label: 2, bag_size: 4910
batch 739, loss: 0.1217, instance_loss: 0.5712, weighted_loss: 0.2565, label: 2, bag_size: 4497


class 0 clustering acc 0.977013422818792: correct 17469/17880
class 1 clustering acc 0.3073825503355705: correct 1832/5960
Epoch: 13, train_loss: 0.6383, train_clustering_loss:  0.5529, train_error: 0.2658
class 0: acc 0.7634854771784232, correct 184/241
class 1: acc 0.5966386554621849, correct 142/238
class 2: acc 0.8308270676691729, correct 221/266

Val Set, val_loss: 0.6620, val_error: 0.2872, auc: 0.8888
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.2765957446808511: correct 208/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6116, instance_loss: 0.4883, weighted_loss: 0.5746, label: 0, bag_size: 3789
batch 39, loss: 0.6341, instance_loss: 0.4825, weighted_loss: 0.5886, label: 1, bag_size: 4373
batch 59, loss: 0.0447, instance_loss: 0.1944, weighted_loss: 0.0896, label: 2, bag_size: 4569
batch 79, loss: 1.8544, instance_loss: 1.1815, weighted_loss: 1.6526, label: 2, bag_size: 4316
batch 99, loss: 0.5037, instance_loss: 0.3578, weighted_loss: 0.4599, label: 2, bag_size: 3026
batch 119, loss: 0.2589, instance_loss: 0.4198, weighted_loss: 0.3071, label: 0, bag_size: 4479
batch 139, loss: 0.7786, instance_loss: 0.6114, weighted_loss: 0.7285, label: 2, bag_size: 909
batch 159, loss: 0.0125, instance_loss: 0.0211, weighted_loss: 0.0151, label: 1, bag_size: 2009
batch 179, loss: 0.2331, instance_loss: 0.3073, weighted_loss: 0.2554, label: 0, bag_size: 4325
batch 199, loss: 0.4010, instance_loss: 0.7366, weighted_loss: 0.5017, label: 0, bag_size: 3182
batch 219, loss: 1.8028, instance_loss: 0.8130, weighted_loss: 1.5059, label: 0, bag_size: 4639
batch 239, loss: 0.0845, instance_loss: 0.1475, weighted_loss: 0.1034, label: 2, bag_size: 2254
batch 259, loss: 1.0159, instance_loss: 0.6619, weighted_loss: 0.9097, label: 1, bag_size: 578
batch 279, loss: 3.6891, instance_loss: 1.4830, weighted_loss: 3.0273, label: 0, bag_size: 2392
batch 299, loss: 0.0965, instance_loss: 0.5723, weighted_loss: 0.2392, label: 0, bag_size: 996
batch 319, loss: 0.2503, instance_loss: 0.3556, weighted_loss: 0.2819, label: 1, bag_size: 2643
batch 339, loss: 0.7053, instance_loss: 1.0197, weighted_loss: 0.7997, label: 2, bag_size: 5072
batch 359, loss: 0.4846, instance_loss: 0.7622, weighted_loss: 0.5679, label: 0, bag_size: 4529
batch 379, loss: 0.1495, instance_loss: 0.2660, weighted_loss: 0.1845, label: 2, bag_size: 614
batch 399, loss: 0.0945, instance_loss: 0.2191, weighted_loss: 0.1319, label: 2, bag_size: 3210
batch 419, loss: 3.1997, instance_loss: 1.3084, weighted_loss: 2.6323, label: 0, bag_size: 2896
batch 439, loss: 0.5097, instance_loss: 0.7270, weighted_loss: 0.5749, label: 1, bag_size: 2013
batch 459, loss: 0.4010, instance_loss: 0.4499, weighted_loss: 0.4157, label: 1, bag_size: 1906
batch 479, loss: 0.1916, instance_loss: 0.2615, weighted_loss: 0.2126, label: 2, bag_size: 2049
batch 499, loss: 0.1965, instance_loss: 0.3393, weighted_loss: 0.2394, label: 1, bag_size: 5385
batch 519, loss: 0.1486, instance_loss: 0.3381, weighted_loss: 0.2054, label: 2, bag_size: 4555
batch 539, loss: 0.9838, instance_loss: 0.7787, weighted_loss: 0.9223, label: 0, bag_size: 1782
batch 559, loss: 0.1093, instance_loss: 0.2752, weighted_loss: 0.1591, label: 0, bag_size: 4905
batch 579, loss: 0.1080, instance_loss: 0.1382, weighted_loss: 0.1170, label: 2, bag_size: 6001
batch 599, loss: 0.1506, instance_loss: 0.2678, weighted_loss: 0.1857, label: 2, bag_size: 2770
batch 619, loss: 0.1749, instance_loss: 0.1848, weighted_loss: 0.1779, label: 2, bag_size: 3210
batch 639, loss: 1.5618, instance_loss: 0.8143, weighted_loss: 1.3375, label: 1, bag_size: 1860
batch 659, loss: 0.0767, instance_loss: 0.2421, weighted_loss: 0.1263, label: 2, bag_size: 4302
batch 679, loss: 0.3232, instance_loss: 0.4805, weighted_loss: 0.3704, label: 1, bag_size: 4812
batch 699, loss: 0.1046, instance_loss: 0.2115, weighted_loss: 0.1367, label: 0, bag_size: 5459
batch 719, loss: 0.9280, instance_loss: 0.6899, weighted_loss: 0.8566, label: 1, bag_size: 302
batch 739, loss: 0.0864, instance_loss: 0.2470, weighted_loss: 0.1346, label: 0, bag_size: 4744


class 0 clustering acc 0.976006711409396: correct 17451/17880
class 1 clustering acc 0.2912751677852349: correct 1736/5960
Epoch: 14, train_loss: 0.6798, train_clustering_loss:  0.5715, train_error: 0.2899
class 0: acc 0.6964285714285714, correct 156/224
class 1: acc 0.642023346303502, correct 165/257
class 2: acc 0.7878787878787878, correct 208/264

Val Set, val_loss: 0.6316, val_error: 0.2979, auc: 0.8861
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.3337765957446808: correct 251/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.658226 --> 0.631602).  Saving model ...


batch 19, loss: 2.3397, instance_loss: 1.2042, weighted_loss: 1.9991, label: 2, bag_size: 3475
batch 39, loss: 1.6674, instance_loss: 1.4553, weighted_loss: 1.6038, label: 1, bag_size: 2927
batch 59, loss: 0.3415, instance_loss: 0.3153, weighted_loss: 0.3336, label: 1, bag_size: 3885
batch 79, loss: 1.4807, instance_loss: 1.1039, weighted_loss: 1.3676, label: 1, bag_size: 817
batch 99, loss: 0.1024, instance_loss: 0.1078, weighted_loss: 0.1040, label: 2, bag_size: 4856
batch 119, loss: 0.3974, instance_loss: 0.3927, weighted_loss: 0.3960, label: 1, bag_size: 4253
batch 139, loss: 0.1663, instance_loss: 0.3181, weighted_loss: 0.2118, label: 0, bag_size: 855
batch 159, loss: 2.7086, instance_loss: 1.6439, weighted_loss: 2.3892, label: 2, bag_size: 4241
batch 179, loss: 0.1114, instance_loss: 0.5123, weighted_loss: 0.2317, label: 1, bag_size: 440
batch 199, loss: 0.1667, instance_loss: 0.1930, weighted_loss: 0.1746, label: 2, bag_size: 4788
batch 219, loss: 0.1276, instance_loss: 0.3022, weighted_loss: 0.1800, label: 0, bag_size: 5570
batch 239, loss: 0.1919, instance_loss: 0.1737, weighted_loss: 0.1865, label: 2, bag_size: 6001
batch 259, loss: 0.2850, instance_loss: 0.3021, weighted_loss: 0.2901, label: 2, bag_size: 597
batch 279, loss: 0.8371, instance_loss: 0.5379, weighted_loss: 0.7474, label: 1, bag_size: 3221
batch 299, loss: 2.0544, instance_loss: 0.7019, weighted_loss: 1.6487, label: 0, bag_size: 3387
batch 319, loss: 1.3196, instance_loss: 0.5109, weighted_loss: 1.0770, label: 1, bag_size: 6993
batch 339, loss: 0.3035, instance_loss: 0.4882, weighted_loss: 0.3589, label: 2, bag_size: 5914
batch 359, loss: 0.2788, instance_loss: 0.3381, weighted_loss: 0.2966, label: 1, bag_size: 3558
batch 379, loss: 0.4131, instance_loss: 0.7680, weighted_loss: 0.5195, label: 2, bag_size: 6644
batch 399, loss: 0.1808, instance_loss: 0.5048, weighted_loss: 0.2780, label: 2, bag_size: 4978
batch 419, loss: 1.3073, instance_loss: 0.9882, weighted_loss: 1.2116, label: 2, bag_size: 724
batch 439, loss: 0.0017, instance_loss: 0.2444, weighted_loss: 0.0745, label: 2, bag_size: 5017
batch 459, loss: 0.0556, instance_loss: 0.1804, weighted_loss: 0.0931, label: 0, bag_size: 2019
batch 479, loss: 0.7372, instance_loss: 0.7160, weighted_loss: 0.7308, label: 1, bag_size: 3604
batch 499, loss: 0.7236, instance_loss: 0.8660, weighted_loss: 0.7663, label: 0, bag_size: 2428
batch 519, loss: 0.2992, instance_loss: 0.4176, weighted_loss: 0.3347, label: 1, bag_size: 3396
batch 539, loss: 2.4648, instance_loss: 1.2870, weighted_loss: 2.1115, label: 0, bag_size: 3191
batch 559, loss: 2.2921, instance_loss: 1.4839, weighted_loss: 2.0497, label: 1, bag_size: 3016
batch 579, loss: 0.2045, instance_loss: 0.3469, weighted_loss: 0.2472, label: 0, bag_size: 4326
batch 599, loss: 0.1334, instance_loss: 0.1606, weighted_loss: 0.1416, label: 2, bag_size: 3678
batch 619, loss: 0.1223, instance_loss: 0.1497, weighted_loss: 0.1305, label: 2, bag_size: 6026
batch 639, loss: 0.3465, instance_loss: 0.5391, weighted_loss: 0.4042, label: 1, bag_size: 1599
batch 659, loss: 2.1977, instance_loss: 0.8125, weighted_loss: 1.7821, label: 1, bag_size: 5423
batch 679, loss: 1.7390, instance_loss: 0.6824, weighted_loss: 1.4220, label: 0, bag_size: 4416
batch 699, loss: 0.0899, instance_loss: 0.8907, weighted_loss: 0.3301, label: 1, bag_size: 6717
batch 719, loss: 0.1316, instance_loss: 0.4117, weighted_loss: 0.2156, label: 1, bag_size: 6475
batch 739, loss: 0.9351, instance_loss: 1.0303, weighted_loss: 0.9637, label: 2, bag_size: 2486


class 0 clustering acc 0.9701342281879195: correct 17346/17880
class 1 clustering acc 0.32734899328859063: correct 1951/5960
Epoch: 15, train_loss: 0.6203, train_clustering_loss:  0.5586, train_error: 0.2537
class 0: acc 0.7953667953667953, correct 206/259
class 1: acc 0.668, correct 167/250
class 2: acc 0.7754237288135594, correct 183/236

Val Set, val_loss: 0.6309, val_error: 0.3191, auc: 0.8980
class 0 clustering acc 0.949468085106383: correct 2142/2256
class 1 clustering acc 0.46941489361702127: correct 353/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.23333333333333334, correct 7/30
class 2: acc 0.9166666666666666, correct 11/12
Validation loss decreased (0.631602 --> 0.630885).  Saving model ...


batch 19, loss: 1.5039, instance_loss: 0.5762, weighted_loss: 1.2256, label: 0, bag_size: 3397
batch 39, loss: 0.1487, instance_loss: 0.3363, weighted_loss: 0.2049, label: 0, bag_size: 6015
batch 59, loss: 0.0005, instance_loss: 0.0246, weighted_loss: 0.0078, label: 1, bag_size: 5462
batch 79, loss: 1.4136, instance_loss: 0.6930, weighted_loss: 1.1974, label: 0, bag_size: 5867
batch 99, loss: 0.8262, instance_loss: 0.3031, weighted_loss: 0.6693, label: 2, bag_size: 3678
batch 119, loss: 2.5739, instance_loss: 1.9514, weighted_loss: 2.3872, label: 1, bag_size: 12936
batch 139, loss: 0.2217, instance_loss: 0.1127, weighted_loss: 0.1890, label: 2, bag_size: 2313
batch 159, loss: 0.3062, instance_loss: 0.4484, weighted_loss: 0.3488, label: 1, bag_size: 3367
batch 179, loss: 0.7757, instance_loss: 0.6035, weighted_loss: 0.7240, label: 1, bag_size: 296
batch 199, loss: 0.2106, instance_loss: 0.1026, weighted_loss: 0.1782, label: 2, bag_size: 3678
batch 219, loss: 2.0424, instance_loss: 0.8315, weighted_loss: 1.6792, label: 2, bag_size: 3112
batch 239, loss: 0.5998, instance_loss: 0.3808, weighted_loss: 0.5341, label: 1, bag_size: 4184
batch 259, loss: 0.3012, instance_loss: 0.3679, weighted_loss: 0.3212, label: 1, bag_size: 1042
batch 279, loss: 0.0157, instance_loss: 0.5525, weighted_loss: 0.1767, label: 0, bag_size: 3920
batch 299, loss: 0.0460, instance_loss: 0.1320, weighted_loss: 0.0718, label: 0, bag_size: 2290
batch 319, loss: 0.2286, instance_loss: 0.3850, weighted_loss: 0.2755, label: 2, bag_size: 3678
batch 339, loss: 0.0081, instance_loss: 0.3884, weighted_loss: 0.1222, label: 2, bag_size: 5037
batch 359, loss: 2.1470, instance_loss: 0.9201, weighted_loss: 1.7789, label: 0, bag_size: 3070
batch 379, loss: 0.1786, instance_loss: 0.2416, weighted_loss: 0.1975, label: 0, bag_size: 4479
batch 399, loss: 0.0241, instance_loss: 0.1695, weighted_loss: 0.0677, label: 1, bag_size: 3677
batch 419, loss: 0.3159, instance_loss: 0.2695, weighted_loss: 0.3020, label: 0, bag_size: 4326
batch 439, loss: 0.2879, instance_loss: 0.4630, weighted_loss: 0.3405, label: 2, bag_size: 22464
batch 459, loss: 2.0880, instance_loss: 0.8357, weighted_loss: 1.7123, label: 0, bag_size: 4032
batch 479, loss: 0.3725, instance_loss: 0.4257, weighted_loss: 0.3885, label: 0, bag_size: 4310
batch 499, loss: 2.0531, instance_loss: 1.0496, weighted_loss: 1.7521, label: 2, bag_size: 5307
batch 519, loss: 0.1614, instance_loss: 0.2095, weighted_loss: 0.1759, label: 0, bag_size: 7177
batch 539, loss: 0.0724, instance_loss: 0.5720, weighted_loss: 0.2223, label: 0, bag_size: 4485
batch 559, loss: 1.0128, instance_loss: 0.8102, weighted_loss: 0.9520, label: 1, bag_size: 3619
batch 579, loss: 0.5808, instance_loss: 0.4958, weighted_loss: 0.5553, label: 1, bag_size: 3225
batch 599, loss: 0.1663, instance_loss: 0.2706, weighted_loss: 0.1976, label: 2, bag_size: 4140
batch 619, loss: 0.7853, instance_loss: 0.6846, weighted_loss: 0.7551, label: 0, bag_size: 4416
batch 639, loss: 0.0892, instance_loss: 0.3245, weighted_loss: 0.1598, label: 1, bag_size: 3156
batch 659, loss: 0.5108, instance_loss: 0.3499, weighted_loss: 0.4625, label: 2, bag_size: 3176
batch 679, loss: 0.0695, instance_loss: 0.4788, weighted_loss: 0.1923, label: 2, bag_size: 2031
batch 699, loss: 0.6447, instance_loss: 0.7660, weighted_loss: 0.6811, label: 2, bag_size: 3746
batch 719, loss: 0.1818, instance_loss: 0.2077, weighted_loss: 0.1896, label: 2, bag_size: 1094
batch 739, loss: 0.2629, instance_loss: 0.4828, weighted_loss: 0.3288, label: 0, bag_size: 909


class 0 clustering acc 0.9689597315436241: correct 17325/17880
class 1 clustering acc 0.3030201342281879: correct 1806/5960
Epoch: 16, train_loss: 0.6777, train_clustering_loss:  0.5832, train_error: 0.2846
class 0: acc 0.7626459143968871, correct 196/257
class 1: acc 0.5798319327731093, correct 138/238
class 2: acc 0.796, correct 199/250

Val Set, val_loss: 0.6533, val_error: 0.2979, auc: 0.8672
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.23404255319148937: correct 176/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0044, instance_loss: 0.0457, weighted_loss: 0.0168, label: 2, bag_size: 4203
batch 39, loss: 1.0984, instance_loss: 0.7550, weighted_loss: 0.9954, label: 1, bag_size: 4806
batch 59, loss: 0.1368, instance_loss: 0.3539, weighted_loss: 0.2020, label: 2, bag_size: 3497
batch 79, loss: 0.3141, instance_loss: 0.3714, weighted_loss: 0.3313, label: 1, bag_size: 1027
batch 99, loss: 1.1122, instance_loss: 0.8359, weighted_loss: 1.0293, label: 1, bag_size: 4187
batch 119, loss: 1.9029, instance_loss: 1.0676, weighted_loss: 1.6523, label: 0, bag_size: 12971
batch 139, loss: 0.1568, instance_loss: 0.2148, weighted_loss: 0.1742, label: 2, bag_size: 2254
batch 159, loss: 2.5052, instance_loss: 0.9578, weighted_loss: 2.0410, label: 0, bag_size: 2597
batch 179, loss: 0.0874, instance_loss: 0.1487, weighted_loss: 0.1058, label: 2, bag_size: 3176
batch 199, loss: 0.8226, instance_loss: 0.7684, weighted_loss: 0.8063, label: 1, bag_size: 2751
batch 219, loss: 1.1855, instance_loss: 0.6603, weighted_loss: 1.0280, label: 2, bag_size: 3112
batch 239, loss: 0.6581, instance_loss: 0.5331, weighted_loss: 0.6206, label: 1, bag_size: 11768
batch 259, loss: 0.2084, instance_loss: 0.6488, weighted_loss: 0.3405, label: 0, bag_size: 1140
batch 279, loss: 0.5356, instance_loss: 0.5197, weighted_loss: 0.5308, label: 0, bag_size: 4529
batch 299, loss: 0.1956, instance_loss: 0.4720, weighted_loss: 0.2785, label: 2, bag_size: 4978
batch 319, loss: 1.0268, instance_loss: 1.1534, weighted_loss: 1.0648, label: 2, bag_size: 3299
batch 339, loss: 0.2280, instance_loss: 0.3905, weighted_loss: 0.2768, label: 0, bag_size: 6015
batch 359, loss: 3.2546, instance_loss: 1.3824, weighted_loss: 2.6929, label: 0, bag_size: 603
batch 379, loss: 0.1027, instance_loss: 0.1656, weighted_loss: 0.1216, label: 0, bag_size: 5413
batch 399, loss: 2.3192, instance_loss: 1.2562, weighted_loss: 2.0003, label: 0, bag_size: 436
batch 419, loss: 1.0924, instance_loss: 0.7132, weighted_loss: 0.9786, label: 2, bag_size: 5406
batch 439, loss: 0.0728, instance_loss: 0.1722, weighted_loss: 0.1027, label: 0, bag_size: 1845
batch 459, loss: 1.0361, instance_loss: 0.6741, weighted_loss: 0.9275, label: 0, bag_size: 7219
batch 479, loss: 2.5239, instance_loss: 1.6941, weighted_loss: 2.2749, label: 0, bag_size: 1886
batch 499, loss: 0.8586, instance_loss: 0.6507, weighted_loss: 0.7962, label: 2, bag_size: 4096
batch 519, loss: 0.3149, instance_loss: 0.4370, weighted_loss: 0.3515, label: 2, bag_size: 4162
batch 539, loss: 0.2490, instance_loss: 0.4585, weighted_loss: 0.3119, label: 2, bag_size: 4192
batch 559, loss: 0.1386, instance_loss: 0.4803, weighted_loss: 0.2411, label: 1, bag_size: 3333
batch 579, loss: 0.4583, instance_loss: 0.4258, weighted_loss: 0.4485, label: 0, bag_size: 4228
batch 599, loss: 0.0041, instance_loss: 0.1597, weighted_loss: 0.0508, label: 0, bag_size: 1087
batch 619, loss: 0.2907, instance_loss: 0.3742, weighted_loss: 0.3157, label: 0, bag_size: 1795
batch 639, loss: 2.0666, instance_loss: 1.4172, weighted_loss: 1.8718, label: 1, bag_size: 5072
batch 659, loss: 0.6855, instance_loss: 0.4860, weighted_loss: 0.6257, label: 1, bag_size: 4373
batch 679, loss: 0.0044, instance_loss: 0.1499, weighted_loss: 0.0480, label: 1, bag_size: 5364
batch 699, loss: 0.1550, instance_loss: 0.5099, weighted_loss: 0.2615, label: 1, bag_size: 779
batch 719, loss: 2.5103, instance_loss: 1.2555, weighted_loss: 2.1338, label: 1, bag_size: 2852
batch 739, loss: 0.0785, instance_loss: 0.7491, weighted_loss: 0.2797, label: 1, bag_size: 1604


class 0 clustering acc 0.9720917225950783: correct 17381/17880
class 1 clustering acc 0.3251677852348993: correct 1938/5960
Epoch: 17, train_loss: 0.6713, train_clustering_loss:  0.5637, train_error: 0.2725
class 0: acc 0.7689393939393939, correct 203/264
class 1: acc 0.6140350877192983, correct 140/228
class 2: acc 0.7865612648221344, correct 199/253

Val Set, val_loss: 0.6610, val_error: 0.2447, auc: 0.8685
class 0 clustering acc 0.9574468085106383: correct 2160/2256
class 1 clustering acc 0.36569148936170215: correct 275/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3956, instance_loss: 0.4715, weighted_loss: 0.4184, label: 0, bag_size: 2884
batch 39, loss: 0.8581, instance_loss: 0.4418, weighted_loss: 0.7332, label: 1, bag_size: 19265
batch 59, loss: 0.1275, instance_loss: 0.2760, weighted_loss: 0.1721, label: 2, bag_size: 3094
batch 79, loss: 0.1541, instance_loss: 0.3453, weighted_loss: 0.2115, label: 2, bag_size: 22464
batch 99, loss: 0.0162, instance_loss: 0.3089, weighted_loss: 0.1041, label: 1, bag_size: 5462
batch 119, loss: 0.0796, instance_loss: 0.3753, weighted_loss: 0.1683, label: 0, bag_size: 2257
batch 139, loss: 1.0062, instance_loss: 0.7982, weighted_loss: 0.9438, label: 1, bag_size: 1607
batch 159, loss: 0.2146, instance_loss: 0.1769, weighted_loss: 0.2033, label: 2, bag_size: 1094
batch 179, loss: 0.0294, instance_loss: 0.3476, weighted_loss: 0.1249, label: 2, bag_size: 4140
batch 199, loss: 0.1511, instance_loss: 0.1924, weighted_loss: 0.1635, label: 2, bag_size: 6026
batch 219, loss: 0.2436, instance_loss: 0.6935, weighted_loss: 0.3786, label: 0, bag_size: 1601
batch 239, loss: 0.5846, instance_loss: 0.3483, weighted_loss: 0.5137, label: 0, bag_size: 5950
batch 259, loss: 0.1157, instance_loss: 0.7298, weighted_loss: 0.2999, label: 1, bag_size: 4290
batch 279, loss: 0.6748, instance_loss: 0.8538, weighted_loss: 0.7285, label: 2, bag_size: 3746
batch 299, loss: 1.1567, instance_loss: 0.7362, weighted_loss: 1.0305, label: 2, bag_size: 5307
batch 319, loss: 0.0766, instance_loss: 0.1489, weighted_loss: 0.0983, label: 0, bag_size: 7169
batch 339, loss: 0.0627, instance_loss: 0.0639, weighted_loss: 0.0631, label: 2, bag_size: 6273
batch 359, loss: 0.3598, instance_loss: 0.5032, weighted_loss: 0.4028, label: 1, bag_size: 5756
batch 379, loss: 0.3378, instance_loss: 0.6321, weighted_loss: 0.4261, label: 0, bag_size: 1176
batch 399, loss: 1.4786, instance_loss: 0.9727, weighted_loss: 1.3268, label: 1, bag_size: 4187
batch 419, loss: 0.5890, instance_loss: 0.8425, weighted_loss: 0.6651, label: 0, bag_size: 3675
batch 439, loss: 0.6813, instance_loss: 0.8382, weighted_loss: 0.7283, label: 2, bag_size: 4342
batch 459, loss: 0.1800, instance_loss: 0.3722, weighted_loss: 0.2377, label: 0, bag_size: 3539
batch 479, loss: 2.1178, instance_loss: 1.4461, weighted_loss: 1.9163, label: 1, bag_size: 1580
batch 499, loss: 0.3022, instance_loss: 0.3248, weighted_loss: 0.3090, label: 2, bag_size: 6001
batch 519, loss: 0.5298, instance_loss: 0.5325, weighted_loss: 0.5306, label: 0, bag_size: 3983
batch 539, loss: 1.3176, instance_loss: 0.5469, weighted_loss: 1.0864, label: 2, bag_size: 3094
batch 559, loss: 0.1417, instance_loss: 0.4556, weighted_loss: 0.2358, label: 2, bag_size: 3121
batch 579, loss: 3.4231, instance_loss: 1.6958, weighted_loss: 2.9049, label: 0, bag_size: 4605
batch 599, loss: 0.3367, instance_loss: 0.4297, weighted_loss: 0.3646, label: 0, bag_size: 609
batch 619, loss: 0.4213, instance_loss: 0.2694, weighted_loss: 0.3757, label: 2, bag_size: 4043
batch 639, loss: 0.0032, instance_loss: 0.1013, weighted_loss: 0.0327, label: 1, bag_size: 5018
batch 659, loss: 0.2121, instance_loss: 0.4054, weighted_loss: 0.2701, label: 0, bag_size: 1417
batch 679, loss: 1.1644, instance_loss: 0.7586, weighted_loss: 1.0427, label: 1, bag_size: 5402
batch 699, loss: 0.3237, instance_loss: 0.2711, weighted_loss: 0.3079, label: 0, bag_size: 5340
batch 719, loss: 2.1523, instance_loss: 1.1592, weighted_loss: 1.8544, label: 0, bag_size: 3075
batch 739, loss: 1.4765, instance_loss: 1.1539, weighted_loss: 1.3797, label: 0, bag_size: 20234


class 0 clustering acc 0.9721476510067114: correct 17382/17880
class 1 clustering acc 0.28859060402684567: correct 1720/5960
Epoch: 18, train_loss: 0.7012, train_clustering_loss:  0.5842, train_error: 0.2940
class 0: acc 0.7910447761194029, correct 212/268
class 1: acc 0.563265306122449, correct 138/245
class 2: acc 0.7586206896551724, correct 176/232

Val Set, val_loss: 0.5927, val_error: 0.2979, auc: 0.8942
class 0 clustering acc 0.9397163120567376: correct 2120/2256
class 1 clustering acc 0.5199468085106383: correct 391/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.4166666666666667, correct 5/12
Validation loss decreased (0.630885 --> 0.592727).  Saving model ...


batch 19, loss: 0.2783, instance_loss: 0.2955, weighted_loss: 0.2835, label: 1, bag_size: 2254
batch 39, loss: 0.5193, instance_loss: 0.4463, weighted_loss: 0.4974, label: 2, bag_size: 705
batch 59, loss: 1.4426, instance_loss: 1.1796, weighted_loss: 1.3637, label: 1, bag_size: 2425
batch 79, loss: 0.3898, instance_loss: 1.1126, weighted_loss: 0.6067, label: 0, bag_size: 1910
batch 99, loss: 0.3915, instance_loss: 0.6074, weighted_loss: 0.4562, label: 1, bag_size: 3437
batch 119, loss: 0.2311, instance_loss: 0.4120, weighted_loss: 0.2854, label: 0, bag_size: 5899
batch 139, loss: 2.6712, instance_loss: 1.3103, weighted_loss: 2.2629, label: 2, bag_size: 4179
batch 159, loss: 0.2613, instance_loss: 0.3481, weighted_loss: 0.2873, label: 2, bag_size: 6644
batch 179, loss: 0.2755, instance_loss: 0.3048, weighted_loss: 0.2843, label: 2, bag_size: 3678
batch 199, loss: 1.3154, instance_loss: 0.6165, weighted_loss: 1.1057, label: 0, bag_size: 4639
batch 219, loss: 0.3302, instance_loss: 0.4827, weighted_loss: 0.3760, label: 0, bag_size: 609
batch 239, loss: 0.3241, instance_loss: 0.5838, weighted_loss: 0.4020, label: 2, bag_size: 3778
batch 259, loss: 0.4301, instance_loss: 0.3099, weighted_loss: 0.3940, label: 0, bag_size: 3113
batch 279, loss: 0.9048, instance_loss: 0.6014, weighted_loss: 0.8138, label: 1, bag_size: 2945
batch 299, loss: 2.9447, instance_loss: 1.4403, weighted_loss: 2.4934, label: 1, bag_size: 1964
batch 319, loss: 0.5591, instance_loss: 0.4565, weighted_loss: 0.5283, label: 1, bag_size: 2945
batch 339, loss: 1.2734, instance_loss: 0.6601, weighted_loss: 1.0894, label: 0, bag_size: 1373
batch 359, loss: 0.1697, instance_loss: 0.3801, weighted_loss: 0.2328, label: 0, bag_size: 1176
batch 379, loss: 0.0076, instance_loss: 0.2536, weighted_loss: 0.0814, label: 0, bag_size: 4083
batch 399, loss: 0.1334, instance_loss: 0.2330, weighted_loss: 0.1633, label: 0, bag_size: 4251
batch 419, loss: 0.0107, instance_loss: 0.0823, weighted_loss: 0.0322, label: 1, bag_size: 3156
batch 439, loss: 0.1584, instance_loss: 0.2020, weighted_loss: 0.1715, label: 2, bag_size: 3174
batch 459, loss: 0.3066, instance_loss: 0.4693, weighted_loss: 0.3554, label: 2, bag_size: 4788
batch 479, loss: 0.1039, instance_loss: 0.6236, weighted_loss: 0.2598, label: 2, bag_size: 4745
batch 499, loss: 0.5149, instance_loss: 0.4385, weighted_loss: 0.4920, label: 1, bag_size: 3885
batch 519, loss: 0.1031, instance_loss: 0.1311, weighted_loss: 0.1115, label: 2, bag_size: 597
batch 539, loss: 0.1727, instance_loss: 0.7841, weighted_loss: 0.3561, label: 0, bag_size: 4544
batch 559, loss: 0.0091, instance_loss: 0.0449, weighted_loss: 0.0198, label: 1, bag_size: 3338
batch 579, loss: 0.0821, instance_loss: 0.3030, weighted_loss: 0.1483, label: 2, bag_size: 5138
batch 599, loss: 0.2053, instance_loss: 0.2157, weighted_loss: 0.2085, label: 0, bag_size: 2983
batch 619, loss: 0.9596, instance_loss: 0.6987, weighted_loss: 0.8813, label: 2, bag_size: 2813
batch 639, loss: 1.2012, instance_loss: 0.8077, weighted_loss: 1.0832, label: 2, bag_size: 5426
batch 659, loss: 0.3366, instance_loss: 0.3671, weighted_loss: 0.3457, label: 1, bag_size: 4253
batch 679, loss: 0.9032, instance_loss: 0.6276, weighted_loss: 0.8205, label: 1, bag_size: 3422
batch 699, loss: 1.6726, instance_loss: 0.8679, weighted_loss: 1.4312, label: 1, bag_size: 3813
batch 719, loss: 0.3657, instance_loss: 0.7927, weighted_loss: 0.4938, label: 0, bag_size: 1601
batch 739, loss: 0.6197, instance_loss: 1.1313, weighted_loss: 0.7732, label: 0, bag_size: 2069


class 0 clustering acc 0.9739373601789709: correct 17414/17880
class 1 clustering acc 0.33003355704697984: correct 1967/5960
Epoch: 19, train_loss: 0.6113, train_clustering_loss:  0.5589, train_error: 0.2550
class 0: acc 0.78, correct 195/250
class 1: acc 0.6166666666666667, correct 148/240
class 2: acc 0.8313725490196079, correct 212/255

Val Set, val_loss: 0.7067, val_error: 0.3298, auc: 0.8752
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.2566489361702128: correct 193/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0048, instance_loss: 0.6070, weighted_loss: 0.8855, label: 1, bag_size: 296
batch 39, loss: 0.1646, instance_loss: 0.2505, weighted_loss: 0.1904, label: 1, bag_size: 3051
batch 59, loss: 0.5169, instance_loss: 0.5716, weighted_loss: 0.5333, label: 0, bag_size: 4734
batch 79, loss: 0.0342, instance_loss: 0.4094, weighted_loss: 0.1468, label: 0, bag_size: 996
batch 99, loss: 0.3359, instance_loss: 0.4350, weighted_loss: 0.3656, label: 0, bag_size: 5260
batch 119, loss: 0.0673, instance_loss: 0.1752, weighted_loss: 0.0997, label: 0, bag_size: 4326
batch 139, loss: 2.0443, instance_loss: 0.8399, weighted_loss: 1.6830, label: 0, bag_size: 5023
batch 159, loss: 1.1536, instance_loss: 1.5118, weighted_loss: 1.2611, label: 1, bag_size: 1549
batch 179, loss: 0.5419, instance_loss: 0.5952, weighted_loss: 0.5579, label: 1, bag_size: 3991
batch 199, loss: 0.2704, instance_loss: 0.4636, weighted_loss: 0.3283, label: 0, bag_size: 2897
batch 219, loss: 0.6750, instance_loss: 0.8727, weighted_loss: 0.7343, label: 0, bag_size: 1352
batch 239, loss: 0.2003, instance_loss: 0.8421, weighted_loss: 0.3928, label: 0, bag_size: 1601
batch 259, loss: 1.1368, instance_loss: 0.7720, weighted_loss: 1.0274, label: 1, bag_size: 5118
batch 279, loss: 0.1459, instance_loss: 0.3942, weighted_loss: 0.2204, label: 1, bag_size: 3156
batch 299, loss: 0.3660, instance_loss: 0.3738, weighted_loss: 0.3683, label: 2, bag_size: 3534
batch 319, loss: 0.3670, instance_loss: 0.4996, weighted_loss: 0.4068, label: 0, bag_size: 3841
batch 339, loss: 0.3384, instance_loss: 0.4574, weighted_loss: 0.3741, label: 2, bag_size: 4555
batch 359, loss: 0.1445, instance_loss: 0.2405, weighted_loss: 0.1733, label: 2, bag_size: 4788
batch 379, loss: 0.0737, instance_loss: 0.1910, weighted_loss: 0.1089, label: 2, bag_size: 6273
batch 399, loss: 0.0302, instance_loss: 0.1326, weighted_loss: 0.0609, label: 1, bag_size: 712
batch 419, loss: 1.5277, instance_loss: 1.1875, weighted_loss: 1.4256, label: 2, bag_size: 3475
batch 439, loss: 0.0476, instance_loss: 0.0844, weighted_loss: 0.0587, label: 2, bag_size: 614
batch 459, loss: 0.1714, instance_loss: 0.4098, weighted_loss: 0.2429, label: 0, bag_size: 7595
batch 479, loss: 0.4613, instance_loss: 0.5365, weighted_loss: 0.4838, label: 2, bag_size: 4241
batch 499, loss: 1.2076, instance_loss: 1.0610, weighted_loss: 1.1636, label: 1, bag_size: 20666
batch 519, loss: 0.3881, instance_loss: 0.3454, weighted_loss: 0.3753, label: 2, bag_size: 5426
batch 539, loss: 1.2959, instance_loss: 0.4477, weighted_loss: 1.0415, label: 2, bag_size: 3583
batch 559, loss: 1.9089, instance_loss: 0.8257, weighted_loss: 1.5840, label: 0, bag_size: 5023
batch 579, loss: 0.4910, instance_loss: 0.6650, weighted_loss: 0.5432, label: 0, bag_size: 4161
batch 599, loss: 0.8386, instance_loss: 0.9071, weighted_loss: 0.8591, label: 1, bag_size: 6689
batch 619, loss: 0.5422, instance_loss: 0.5404, weighted_loss: 0.5416, label: 2, bag_size: 3746
batch 639, loss: 0.1161, instance_loss: 0.5006, weighted_loss: 0.2315, label: 1, bag_size: 3398
batch 659, loss: 0.1583, instance_loss: 0.1777, weighted_loss: 0.1641, label: 1, bag_size: 2945
batch 679, loss: 1.7113, instance_loss: 0.7562, weighted_loss: 1.4248, label: 1, bag_size: 4869
batch 699, loss: 0.0520, instance_loss: 0.4267, weighted_loss: 0.1644, label: 0, bag_size: 4841
batch 719, loss: 0.1145, instance_loss: 0.2283, weighted_loss: 0.1486, label: 2, bag_size: 4569
batch 739, loss: 0.3520, instance_loss: 0.3250, weighted_loss: 0.3439, label: 1, bag_size: 2156


class 0 clustering acc 0.973434004474273: correct 17405/17880
class 1 clustering acc 0.3390939597315436: correct 2021/5960
Epoch: 20, train_loss: 0.6273, train_clustering_loss:  0.5538, train_error: 0.2523
class 0: acc 0.7511111111111111, correct 169/225
class 1: acc 0.6981132075471698, correct 185/265
class 2: acc 0.796078431372549, correct 203/255

Val Set, val_loss: 0.9384, val_error: 0.4362, auc: 0.8256
class 0 clustering acc 0.9379432624113475: correct 2116/2256
class 1 clustering acc 0.12101063829787234: correct 91/752
class 0: acc 0.4230769230769231, correct 22/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7920, instance_loss: 0.9116, weighted_loss: 0.8279, label: 1, bag_size: 1477
batch 39, loss: 0.0159, instance_loss: 0.2053, weighted_loss: 0.0727, label: 2, bag_size: 4203
batch 59, loss: 0.9409, instance_loss: 0.7761, weighted_loss: 0.8914, label: 2, bag_size: 6298
batch 79, loss: 0.4319, instance_loss: 0.9643, weighted_loss: 0.5916, label: 0, bag_size: 4485
batch 99, loss: 0.9479, instance_loss: 0.6956, weighted_loss: 0.8722, label: 0, bag_size: 5484
batch 119, loss: 0.5276, instance_loss: 0.6455, weighted_loss: 0.5630, label: 1, bag_size: 3051
batch 139, loss: 0.8417, instance_loss: 0.7661, weighted_loss: 0.8190, label: 1, bag_size: 2642
batch 159, loss: 1.2818, instance_loss: 0.8762, weighted_loss: 1.1602, label: 0, bag_size: 5330
batch 179, loss: 0.0115, instance_loss: 0.3801, weighted_loss: 0.1220, label: 2, bag_size: 4141
batch 199, loss: 0.0640, instance_loss: 0.1126, weighted_loss: 0.0786, label: 2, bag_size: 3415
batch 219, loss: 1.1158, instance_loss: 0.7662, weighted_loss: 1.0109, label: 2, bag_size: 705
batch 239, loss: 0.6364, instance_loss: 0.6028, weighted_loss: 0.6263, label: 0, bag_size: 3525
batch 259, loss: 0.9687, instance_loss: 0.5403, weighted_loss: 0.8402, label: 2, bag_size: 4241
batch 279, loss: 0.5849, instance_loss: 0.6704, weighted_loss: 0.6105, label: 0, bag_size: 6971
batch 299, loss: 2.3970, instance_loss: 0.8795, weighted_loss: 1.9418, label: 1, bag_size: 6993
batch 319, loss: 0.0829, instance_loss: 0.3355, weighted_loss: 0.1587, label: 0, bag_size: 5029
batch 339, loss: 0.2731, instance_loss: 0.3329, weighted_loss: 0.2911, label: 1, bag_size: 2905
batch 359, loss: 0.0405, instance_loss: 0.2373, weighted_loss: 0.0995, label: 0, bag_size: 3406
batch 379, loss: 0.2610, instance_loss: 0.4884, weighted_loss: 0.3292, label: 1, bag_size: 1023
batch 399, loss: 1.0944, instance_loss: 0.6570, weighted_loss: 0.9632, label: 0, bag_size: 4725
batch 419, loss: 0.3995, instance_loss: 0.5799, weighted_loss: 0.4536, label: 2, bag_size: 4291
batch 439, loss: 0.0998, instance_loss: 0.6079, weighted_loss: 0.2522, label: 1, bag_size: 3475
batch 459, loss: 0.2152, instance_loss: 0.2502, weighted_loss: 0.2257, label: 0, bag_size: 1947
batch 479, loss: 0.1315, instance_loss: 0.2094, weighted_loss: 0.1549, label: 0, bag_size: 3594
batch 499, loss: 0.2656, instance_loss: 0.4972, weighted_loss: 0.3351, label: 0, bag_size: 4326
batch 519, loss: 2.3923, instance_loss: 1.3109, weighted_loss: 2.0679, label: 2, bag_size: 223
batch 539, loss: 0.2241, instance_loss: 0.2077, weighted_loss: 0.2192, label: 2, bag_size: 3583
batch 559, loss: 0.3245, instance_loss: 0.4140, weighted_loss: 0.3514, label: 2, bag_size: 3534
batch 579, loss: 1.6157, instance_loss: 0.8178, weighted_loss: 1.3763, label: 2, bag_size: 5307
batch 599, loss: 0.2325, instance_loss: 0.3069, weighted_loss: 0.2548, label: 0, bag_size: 4909
batch 619, loss: 0.4742, instance_loss: 0.2186, weighted_loss: 0.3975, label: 2, bag_size: 2561
batch 639, loss: 2.1729, instance_loss: 1.2297, weighted_loss: 1.8899, label: 0, bag_size: 1755
batch 659, loss: 0.2804, instance_loss: 0.4124, weighted_loss: 0.3200, label: 0, bag_size: 1883
batch 679, loss: 0.4691, instance_loss: 0.5797, weighted_loss: 0.5023, label: 2, bag_size: 5426
batch 699, loss: 0.1083, instance_loss: 0.2172, weighted_loss: 0.1409, label: 2, bag_size: 3121
batch 719, loss: 0.0423, instance_loss: 0.2588, weighted_loss: 0.1073, label: 1, bag_size: 4346
batch 739, loss: 1.0393, instance_loss: 0.8945, weighted_loss: 0.9958, label: 1, bag_size: 6025


class 0 clustering acc 0.970413870246085: correct 17351/17880
class 1 clustering acc 0.3711409395973154: correct 2212/5960
Epoch: 21, train_loss: 0.5746, train_clustering_loss:  0.5400, train_error: 0.2443
class 0: acc 0.78515625, correct 201/256
class 1: acc 0.6694915254237288, correct 158/236
class 2: acc 0.8063241106719368, correct 204/253

Val Set, val_loss: 0.6800, val_error: 0.2660, auc: 0.8844
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.3377659574468085: correct 254/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4287, instance_loss: 0.7572, weighted_loss: 0.5273, label: 2, bag_size: 3299
batch 39, loss: 0.3372, instance_loss: 0.1886, weighted_loss: 0.2926, label: 2, bag_size: 88
batch 59, loss: 0.2821, instance_loss: 0.6368, weighted_loss: 0.3885, label: 2, bag_size: 4302
batch 79, loss: 0.4854, instance_loss: 0.5327, weighted_loss: 0.4996, label: 0, bag_size: 640
batch 99, loss: 0.7792, instance_loss: 0.9327, weighted_loss: 0.8252, label: 1, bag_size: 3995
batch 119, loss: 0.1037, instance_loss: 0.1538, weighted_loss: 0.1188, label: 0, bag_size: 3339
batch 139, loss: 0.0374, instance_loss: 0.1862, weighted_loss: 0.0820, label: 0, bag_size: 2339
batch 159, loss: 0.1746, instance_loss: 0.4671, weighted_loss: 0.2623, label: 0, bag_size: 8611
batch 179, loss: 0.1683, instance_loss: 0.2206, weighted_loss: 0.1840, label: 2, bag_size: 3176
batch 199, loss: 0.8177, instance_loss: 0.6344, weighted_loss: 0.7627, label: 2, bag_size: 2326
batch 219, loss: 0.0612, instance_loss: 0.4007, weighted_loss: 0.1630, label: 0, bag_size: 829
batch 239, loss: 2.0420, instance_loss: 0.9707, weighted_loss: 1.7206, label: 2, bag_size: 223
batch 259, loss: 0.1229, instance_loss: 0.2082, weighted_loss: 0.1485, label: 0, bag_size: 6765
batch 279, loss: 1.0479, instance_loss: 0.7863, weighted_loss: 0.9694, label: 1, bag_size: 4824
batch 299, loss: 0.2553, instance_loss: 0.4062, weighted_loss: 0.3006, label: 2, bag_size: 3174
batch 319, loss: 1.6857, instance_loss: 0.9769, weighted_loss: 1.4730, label: 0, bag_size: 4725
batch 339, loss: 0.0679, instance_loss: 0.1654, weighted_loss: 0.0972, label: 0, bag_size: 3443
batch 359, loss: 1.9679, instance_loss: 1.1340, weighted_loss: 1.7177, label: 0, bag_size: 14791
batch 379, loss: 1.7800, instance_loss: 0.8415, weighted_loss: 1.4985, label: 0, bag_size: 4717
batch 399, loss: 0.0907, instance_loss: 0.1172, weighted_loss: 0.0986, label: 0, bag_size: 3666
batch 419, loss: 0.2130, instance_loss: 0.7927, weighted_loss: 0.3869, label: 0, bag_size: 2231
batch 439, loss: 0.0001, instance_loss: 0.1098, weighted_loss: 0.0330, label: 2, bag_size: 2422
batch 459, loss: 0.9441, instance_loss: 0.8282, weighted_loss: 0.9093, label: 2, bag_size: 2486
batch 479, loss: 0.5940, instance_loss: 1.1658, weighted_loss: 0.7656, label: 0, bag_size: 889
batch 499, loss: 0.3475, instance_loss: 0.6498, weighted_loss: 0.4382, label: 1, bag_size: 5696
batch 519, loss: 0.2211, instance_loss: 0.2797, weighted_loss: 0.2387, label: 2, bag_size: 3174
batch 539, loss: 1.1093, instance_loss: 1.0994, weighted_loss: 1.1063, label: 0, bag_size: 889
batch 559, loss: 1.3428, instance_loss: 1.1079, weighted_loss: 1.2723, label: 2, bag_size: 223
batch 579, loss: 0.7567, instance_loss: 0.7085, weighted_loss: 0.7422, label: 2, bag_size: 705
batch 599, loss: 0.3328, instance_loss: 0.5032, weighted_loss: 0.3839, label: 0, bag_size: 6285
batch 619, loss: 0.7329, instance_loss: 0.5693, weighted_loss: 0.6838, label: 1, bag_size: 667
batch 639, loss: 0.0648, instance_loss: 0.4149, weighted_loss: 0.1698, label: 1, bag_size: 3475
batch 659, loss: 0.7261, instance_loss: 0.5307, weighted_loss: 0.6675, label: 1, bag_size: 3482
batch 679, loss: 0.1249, instance_loss: 0.3542, weighted_loss: 0.1937, label: 0, bag_size: 5170
batch 699, loss: 0.3123, instance_loss: 0.3145, weighted_loss: 0.3130, label: 0, bag_size: 2428
batch 719, loss: 3.7613, instance_loss: 1.9735, weighted_loss: 3.2249, label: 0, bag_size: 3750
batch 739, loss: 0.0881, instance_loss: 0.1091, weighted_loss: 0.0944, label: 2, bag_size: 2997


class 0 clustering acc 0.9674496644295302: correct 17298/17880
class 1 clustering acc 0.337248322147651: correct 2010/5960
Epoch: 22, train_loss: 0.6378, train_clustering_loss:  0.5696, train_error: 0.2725
class 0: acc 0.7312252964426877, correct 185/253
class 1: acc 0.6487603305785123, correct 157/242
class 2: acc 0.8, correct 200/250

Val Set, val_loss: 0.9397, val_error: 0.3617, auc: 0.8370
class 0 clustering acc 0.9525709219858156: correct 2149/2256
class 1 clustering acc 0.21808510638297873: correct 164/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1742, instance_loss: 0.2684, weighted_loss: 0.2024, label: 2, bag_size: 3080
batch 39, loss: 0.9502, instance_loss: 0.4646, weighted_loss: 0.8045, label: 0, bag_size: 4648
batch 59, loss: 0.1281, instance_loss: 0.3125, weighted_loss: 0.1834, label: 0, bag_size: 6445
batch 79, loss: 0.1161, instance_loss: 0.0786, weighted_loss: 0.1049, label: 2, bag_size: 6704
batch 99, loss: 0.4546, instance_loss: 0.8844, weighted_loss: 0.5835, label: 1, bag_size: 20666
batch 119, loss: 0.0941, instance_loss: 0.2491, weighted_loss: 0.1406, label: 2, bag_size: 3497
batch 139, loss: 1.1387, instance_loss: 0.8171, weighted_loss: 1.0422, label: 0, bag_size: 2189
batch 159, loss: 0.2951, instance_loss: 0.4640, weighted_loss: 0.3458, label: 1, bag_size: 712
batch 179, loss: 0.0509, instance_loss: 0.1100, weighted_loss: 0.0686, label: 0, bag_size: 4741
batch 199, loss: 0.1118, instance_loss: 0.4876, weighted_loss: 0.2245, label: 0, bag_size: 1204
batch 219, loss: 0.3648, instance_loss: 0.4504, weighted_loss: 0.3905, label: 1, bag_size: 2731
batch 239, loss: 2.2154, instance_loss: 1.3623, weighted_loss: 1.9595, label: 2, bag_size: 724
batch 259, loss: 0.1653, instance_loss: 0.2934, weighted_loss: 0.2037, label: 0, bag_size: 7177
batch 279, loss: 0.0778, instance_loss: 0.2369, weighted_loss: 0.1255, label: 2, bag_size: 3121
batch 299, loss: 0.5373, instance_loss: 0.3160, weighted_loss: 0.4709, label: 2, bag_size: 3583
batch 319, loss: 0.0396, instance_loss: 0.2581, weighted_loss: 0.1052, label: 1, bag_size: 455
batch 339, loss: 0.3424, instance_loss: 0.4359, weighted_loss: 0.3704, label: 0, bag_size: 5377
batch 359, loss: 1.1264, instance_loss: 0.8098, weighted_loss: 1.0314, label: 1, bag_size: 5926
batch 379, loss: 0.3263, instance_loss: 0.2743, weighted_loss: 0.3107, label: 2, bag_size: 4096
batch 399, loss: 2.6567, instance_loss: 1.7837, weighted_loss: 2.3948, label: 1, bag_size: 5205
batch 419, loss: 0.7513, instance_loss: 0.6704, weighted_loss: 0.7270, label: 1, bag_size: 296
batch 439, loss: 0.8181, instance_loss: 0.5781, weighted_loss: 0.7461, label: 1, bag_size: 4395
batch 459, loss: 1.0630, instance_loss: 0.4990, weighted_loss: 0.8938, label: 0, bag_size: 3664
batch 479, loss: 0.2134, instance_loss: 0.2981, weighted_loss: 0.2388, label: 2, bag_size: 1094
batch 499, loss: 0.8504, instance_loss: 0.7004, weighted_loss: 0.8054, label: 1, bag_size: 5195
batch 519, loss: 1.1748, instance_loss: 1.1985, weighted_loss: 1.1819, label: 1, bag_size: 4694
batch 539, loss: 0.0093, instance_loss: 0.0994, weighted_loss: 0.0363, label: 1, bag_size: 8802
batch 559, loss: 1.1465, instance_loss: 0.8722, weighted_loss: 1.0642, label: 0, bag_size: 1492
batch 579, loss: 0.2523, instance_loss: 0.4159, weighted_loss: 0.3014, label: 2, bag_size: 4978
batch 599, loss: 0.0040, instance_loss: 0.4484, weighted_loss: 0.1373, label: 2, bag_size: 5037
batch 619, loss: 3.0760, instance_loss: 1.2199, weighted_loss: 2.5192, label: 2, bag_size: 4179
batch 639, loss: 0.2058, instance_loss: 0.4566, weighted_loss: 0.2811, label: 0, bag_size: 1204
batch 659, loss: 0.1357, instance_loss: 0.3000, weighted_loss: 0.1850, label: 0, bag_size: 1006
batch 679, loss: 0.1644, instance_loss: 0.2958, weighted_loss: 0.2038, label: 2, bag_size: 3176
batch 699, loss: 0.2023, instance_loss: 0.4352, weighted_loss: 0.2722, label: 1, bag_size: 3127
batch 719, loss: 0.0402, instance_loss: 0.2131, weighted_loss: 0.0921, label: 0, bag_size: 855
batch 739, loss: 0.0590, instance_loss: 0.0795, weighted_loss: 0.0652, label: 2, bag_size: 2313


class 0 clustering acc 0.9667225950782998: correct 17285/17880
class 1 clustering acc 0.3724832214765101: correct 2220/5960
Epoch: 23, train_loss: 0.6128, train_clustering_loss:  0.5481, train_error: 0.2497
class 0: acc 0.7824427480916031, correct 205/262
class 1: acc 0.6043478260869565, correct 139/230
class 2: acc 0.849802371541502, correct 215/253

Val Set, val_loss: 1.1355, val_error: 0.4574, auc: 0.8139
class 0 clustering acc 0.961436170212766: correct 2169/2256
class 1 clustering acc 0.13696808510638298: correct 103/752
class 0: acc 0.4807692307692308, correct 25/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2658, instance_loss: 0.7805, weighted_loss: 1.1202, label: 1, bag_size: 1327
batch 39, loss: 0.2590, instance_loss: 0.3665, weighted_loss: 0.2912, label: 0, bag_size: 4914
batch 59, loss: 0.0018, instance_loss: 0.5399, weighted_loss: 0.1632, label: 0, bag_size: 1981
batch 79, loss: 0.5580, instance_loss: 0.5538, weighted_loss: 0.5568, label: 0, bag_size: 4398
batch 99, loss: 0.3033, instance_loss: 0.5598, weighted_loss: 0.3803, label: 0, bag_size: 1233
batch 119, loss: 0.3093, instance_loss: 0.5532, weighted_loss: 0.3825, label: 2, bag_size: 6644
batch 139, loss: 0.1290, instance_loss: 0.3634, weighted_loss: 0.1993, label: 0, bag_size: 4161
batch 159, loss: 0.0129, instance_loss: 0.2154, weighted_loss: 0.0736, label: 2, bag_size: 4569
batch 179, loss: 0.7631, instance_loss: 0.6851, weighted_loss: 0.7397, label: 1, bag_size: 936
batch 199, loss: 0.9029, instance_loss: 0.9017, weighted_loss: 0.9026, label: 1, bag_size: 3261
batch 219, loss: 0.7740, instance_loss: 0.5631, weighted_loss: 0.7107, label: 1, bag_size: 2642
batch 239, loss: 0.0734, instance_loss: 0.1395, weighted_loss: 0.0932, label: 0, bag_size: 2607
batch 259, loss: 1.2914, instance_loss: 0.7461, weighted_loss: 1.1278, label: 2, bag_size: 552
batch 279, loss: 0.1421, instance_loss: 0.1849, weighted_loss: 0.1549, label: 2, bag_size: 3415
batch 299, loss: 0.9588, instance_loss: 0.9306, weighted_loss: 0.9503, label: 1, bag_size: 2998
batch 319, loss: 0.0558, instance_loss: 0.1972, weighted_loss: 0.0983, label: 1, bag_size: 5696
batch 339, loss: 0.1659, instance_loss: 0.3665, weighted_loss: 0.2261, label: 1, bag_size: 4346
batch 359, loss: 0.0475, instance_loss: 0.2079, weighted_loss: 0.0956, label: 1, bag_size: 4346
batch 379, loss: 0.0643, instance_loss: 0.3606, weighted_loss: 0.1532, label: 2, bag_size: 4497
batch 399, loss: 0.8931, instance_loss: 0.5117, weighted_loss: 0.7787, label: 1, bag_size: 578
batch 419, loss: 1.7656, instance_loss: 0.9097, weighted_loss: 1.5088, label: 1, bag_size: 3106
batch 439, loss: 0.0723, instance_loss: 0.1955, weighted_loss: 0.1092, label: 0, bag_size: 1018
batch 459, loss: 1.5049, instance_loss: 0.7646, weighted_loss: 1.2828, label: 2, bag_size: 361
batch 479, loss: 0.0771, instance_loss: 0.2164, weighted_loss: 0.1189, label: 1, bag_size: 4253
batch 499, loss: 0.1325, instance_loss: 0.3792, weighted_loss: 0.2065, label: 0, bag_size: 4178
batch 519, loss: 0.0536, instance_loss: 0.1453, weighted_loss: 0.0811, label: 1, bag_size: 596
batch 539, loss: 0.0019, instance_loss: 0.2616, weighted_loss: 0.0798, label: 1, bag_size: 3043
batch 559, loss: 0.9682, instance_loss: 0.7601, weighted_loss: 0.9058, label: 1, bag_size: 1595
batch 579, loss: 0.3878, instance_loss: 0.6906, weighted_loss: 0.4786, label: 0, bag_size: 999
batch 599, loss: 0.4458, instance_loss: 0.5977, weighted_loss: 0.4914, label: 0, bag_size: 1795
batch 619, loss: 0.5280, instance_loss: 0.4110, weighted_loss: 0.4929, label: 0, bag_size: 3368
batch 639, loss: 0.1796, instance_loss: 0.1665, weighted_loss: 0.1756, label: 2, bag_size: 2049
batch 659, loss: 0.1297, instance_loss: 0.4903, weighted_loss: 0.2379, label: 0, bag_size: 6440
batch 679, loss: 0.9037, instance_loss: 0.8379, weighted_loss: 0.8840, label: 1, bag_size: 3604
batch 699, loss: 1.0304, instance_loss: 0.9155, weighted_loss: 0.9959, label: 2, bag_size: 6594
batch 719, loss: 1.2777, instance_loss: 0.6570, weighted_loss: 1.0915, label: 0, bag_size: 4485
batch 739, loss: 0.1559, instance_loss: 0.4387, weighted_loss: 0.2408, label: 1, bag_size: 5696


class 0 clustering acc 0.9689597315436241: correct 17325/17880
class 1 clustering acc 0.4080536912751678: correct 2432/5960
Epoch: 24, train_loss: 0.5842, train_clustering_loss:  0.5284, train_error: 0.2403
class 0: acc 0.7941176470588235, correct 189/238
class 1: acc 0.6954887218045113, correct 185/266
class 2: acc 0.7966804979253111, correct 192/241

Val Set, val_loss: 0.7240, val_error: 0.2766, auc: 0.8762
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.3816489361702128: correct 287/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0023, instance_loss: 0.2926, weighted_loss: 0.0894, label: 0, bag_size: 3983
batch 39, loss: 1.4716, instance_loss: 1.2265, weighted_loss: 1.3980, label: 2, bag_size: 3299
batch 59, loss: 0.0344, instance_loss: 0.0990, weighted_loss: 0.0538, label: 2, bag_size: 3121
batch 79, loss: 0.0000, instance_loss: 0.1664, weighted_loss: 0.0499, label: 0, bag_size: 3920
batch 99, loss: 0.2293, instance_loss: 0.6174, weighted_loss: 0.3457, label: 2, bag_size: 5072
batch 119, loss: 1.1207, instance_loss: 0.9360, weighted_loss: 1.0653, label: 1, bag_size: 1313
batch 139, loss: 0.2338, instance_loss: 0.6957, weighted_loss: 0.3723, label: 0, bag_size: 4178
batch 159, loss: 0.2535, instance_loss: 0.3626, weighted_loss: 0.2863, label: 0, bag_size: 609
batch 179, loss: 0.0025, instance_loss: 0.2752, weighted_loss: 0.0843, label: 1, bag_size: 2009
batch 199, loss: 1.4617, instance_loss: 1.0373, weighted_loss: 1.3344, label: 1, bag_size: 7176
batch 219, loss: 0.0379, instance_loss: 0.0730, weighted_loss: 0.0484, label: 2, bag_size: 4745
batch 239, loss: 2.2528, instance_loss: 1.6650, weighted_loss: 2.0764, label: 1, bag_size: 3399
batch 259, loss: 1.0424, instance_loss: 0.4419, weighted_loss: 0.8623, label: 2, bag_size: 614
batch 279, loss: 1.2417, instance_loss: 0.6966, weighted_loss: 1.0782, label: 1, bag_size: 5572
batch 299, loss: 0.6017, instance_loss: 0.6176, weighted_loss: 0.6065, label: 0, bag_size: 2579
batch 319, loss: 1.5218, instance_loss: 1.0355, weighted_loss: 1.3759, label: 0, bag_size: 2044
batch 339, loss: 0.0145, instance_loss: 0.1196, weighted_loss: 0.0460, label: 0, bag_size: 4379
batch 359, loss: 0.1870, instance_loss: 0.3831, weighted_loss: 0.2459, label: 0, bag_size: 3070
batch 379, loss: 0.4855, instance_loss: 0.5092, weighted_loss: 0.4926, label: 0, bag_size: 3475
batch 399, loss: 0.1243, instance_loss: 0.2596, weighted_loss: 0.1649, label: 0, bag_size: 1341
batch 419, loss: 0.1624, instance_loss: 0.3364, weighted_loss: 0.2146, label: 0, bag_size: 3741
batch 439, loss: 0.3093, instance_loss: 0.5293, weighted_loss: 0.3753, label: 1, bag_size: 3460
batch 459, loss: 0.0279, instance_loss: 0.9425, weighted_loss: 0.3023, label: 0, bag_size: 1055
batch 479, loss: 0.3496, instance_loss: 0.4461, weighted_loss: 0.3785, label: 0, bag_size: 4161
batch 499, loss: 0.7672, instance_loss: 0.7842, weighted_loss: 0.7723, label: 1, bag_size: 3050
batch 519, loss: 0.2608, instance_loss: 0.2178, weighted_loss: 0.2479, label: 0, bag_size: 8088
batch 539, loss: 0.6197, instance_loss: 0.9865, weighted_loss: 0.7298, label: 1, bag_size: 4869
batch 559, loss: 0.0583, instance_loss: 0.1332, weighted_loss: 0.0808, label: 0, bag_size: 2545
batch 579, loss: 0.0507, instance_loss: 0.2125, weighted_loss: 0.0993, label: 1, bag_size: 758
batch 599, loss: 0.1778, instance_loss: 0.2560, weighted_loss: 0.2013, label: 2, bag_size: 2359
batch 619, loss: 0.0060, instance_loss: 0.7947, weighted_loss: 0.2426, label: 0, bag_size: 1055
batch 639, loss: 0.2105, instance_loss: 0.2566, weighted_loss: 0.2243, label: 1, bag_size: 2945
batch 659, loss: 1.3631, instance_loss: 0.7471, weighted_loss: 1.1783, label: 2, bag_size: 4535
batch 679, loss: 0.0327, instance_loss: 0.3140, weighted_loss: 0.1170, label: 1, bag_size: 5756
batch 699, loss: 0.2530, instance_loss: 0.2437, weighted_loss: 0.2502, label: 0, bag_size: 4325
batch 719, loss: 0.0154, instance_loss: 0.6464, weighted_loss: 0.2047, label: 2, bag_size: 3607
batch 739, loss: 0.7508, instance_loss: 1.0980, weighted_loss: 0.8550, label: 1, bag_size: 3823


class 0 clustering acc 0.9675055928411633: correct 17299/17880
class 1 clustering acc 0.39848993288590606: correct 2375/5960
Epoch: 25, train_loss: 0.5942, train_clustering_loss:  0.5379, train_error: 0.2604
class 0: acc 0.8202247191011236, correct 219/267
class 1: acc 0.5758928571428571, correct 129/224
class 2: acc 0.7992125984251969, correct 203/254

Val Set, val_loss: 0.8107, val_error: 0.2979, auc: 0.8676
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.3603723404255319: correct 271/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2251, instance_loss: 0.2888, weighted_loss: 0.2442, label: 0, bag_size: 7595
batch 39, loss: 0.1155, instance_loss: 0.3943, weighted_loss: 0.1991, label: 1, bag_size: 3333
batch 59, loss: 0.2675, instance_loss: 0.2733, weighted_loss: 0.2693, label: 0, bag_size: 1353
batch 79, loss: 0.0000, instance_loss: 0.0784, weighted_loss: 0.0235, label: 0, bag_size: 2306
batch 99, loss: 0.7233, instance_loss: 0.5388, weighted_loss: 0.6680, label: 0, bag_size: 272
batch 119, loss: 0.2155, instance_loss: 0.4464, weighted_loss: 0.2847, label: 2, bag_size: 3080
batch 139, loss: 0.7911, instance_loss: 0.2186, weighted_loss: 0.6194, label: 2, bag_size: 2561
batch 159, loss: 0.7087, instance_loss: 0.3864, weighted_loss: 0.6120, label: 0, bag_size: 5459
batch 179, loss: 0.3374, instance_loss: 0.2026, weighted_loss: 0.2970, label: 2, bag_size: 4043
batch 199, loss: 0.0692, instance_loss: 0.1382, weighted_loss: 0.0899, label: 0, bag_size: 2791
batch 219, loss: 0.2677, instance_loss: 0.3690, weighted_loss: 0.2981, label: 2, bag_size: 3080
batch 239, loss: 0.3796, instance_loss: 0.4637, weighted_loss: 0.4048, label: 0, bag_size: 2756
batch 259, loss: 0.3695, instance_loss: 0.6001, weighted_loss: 0.4387, label: 1, bag_size: 2731
batch 279, loss: 0.1058, instance_loss: 0.6612, weighted_loss: 0.2724, label: 1, bag_size: 3437
batch 299, loss: 0.0200, instance_loss: 0.0375, weighted_loss: 0.0253, label: 2, bag_size: 6026
batch 319, loss: 0.1116, instance_loss: 0.0514, weighted_loss: 0.0935, label: 2, bag_size: 3094
batch 339, loss: 0.3802, instance_loss: 0.3957, weighted_loss: 0.3849, label: 2, bag_size: 2481
batch 359, loss: 0.2299, instance_loss: 0.3723, weighted_loss: 0.2726, label: 2, bag_size: 3534
batch 379, loss: 1.3155, instance_loss: 0.7904, weighted_loss: 1.1580, label: 2, bag_size: 909
batch 399, loss: 0.0974, instance_loss: 0.1341, weighted_loss: 0.1085, label: 2, bag_size: 3415
batch 419, loss: 0.4270, instance_loss: 0.6216, weighted_loss: 0.4854, label: 2, bag_size: 4745
batch 439, loss: 0.2792, instance_loss: 0.2931, weighted_loss: 0.2833, label: 1, bag_size: 1410
batch 459, loss: 2.0419, instance_loss: 1.2682, weighted_loss: 1.8098, label: 1, bag_size: 5035
batch 479, loss: 0.0000, instance_loss: 0.1335, weighted_loss: 0.0400, label: 0, bag_size: 3445
batch 499, loss: 0.0135, instance_loss: 0.3282, weighted_loss: 0.1079, label: 1, bag_size: 1836
batch 519, loss: 0.0879, instance_loss: 0.2424, weighted_loss: 0.1342, label: 2, bag_size: 5924
batch 539, loss: 0.8501, instance_loss: 1.1305, weighted_loss: 0.9342, label: 0, bag_size: 1808
batch 559, loss: 0.7791, instance_loss: 0.6428, weighted_loss: 0.7382, label: 1, bag_size: 2671
batch 579, loss: 2.2701, instance_loss: 0.9380, weighted_loss: 1.8705, label: 0, bag_size: 2597
batch 599, loss: 0.2549, instance_loss: 0.4517, weighted_loss: 0.3139, label: 1, bag_size: 3357
batch 619, loss: 0.3523, instance_loss: 0.5810, weighted_loss: 0.4209, label: 0, bag_size: 5953
batch 639, loss: 0.3773, instance_loss: 0.5170, weighted_loss: 0.4192, label: 0, bag_size: 6445
batch 659, loss: 0.0302, instance_loss: 0.1976, weighted_loss: 0.0804, label: 1, bag_size: 758
batch 679, loss: 0.0757, instance_loss: 0.1455, weighted_loss: 0.0967, label: 1, bag_size: 862
batch 699, loss: 4.1294, instance_loss: 0.8001, weighted_loss: 3.1306, label: 2, bag_size: 3112
batch 719, loss: 0.0068, instance_loss: 0.0859, weighted_loss: 0.0306, label: 1, bag_size: 259
batch 739, loss: 0.2643, instance_loss: 0.3429, weighted_loss: 0.2879, label: 1, bag_size: 3983


class 0 clustering acc 0.9644295302013423: correct 17244/17880
class 1 clustering acc 0.36828859060402686: correct 2195/5960
Epoch: 26, train_loss: 0.6186, train_clustering_loss:  0.5599, train_error: 0.2711
class 0: acc 0.764, correct 191/250
class 1: acc 0.6525096525096525, correct 169/259
class 2: acc 0.7754237288135594, correct 183/236

Val Set, val_loss: 0.7380, val_error: 0.3085, auc: 0.8730
class 0 clustering acc 0.9787234042553191: correct 2208/2256
class 1 clustering acc 0.25132978723404253: correct 189/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.1038, instance_loss: 0.6399, weighted_loss: 0.9646, label: 1, bag_size: 1161
batch 39, loss: 0.1303, instance_loss: 0.5439, weighted_loss: 0.2544, label: 1, bag_size: 5086
batch 59, loss: 0.2370, instance_loss: 0.4773, weighted_loss: 0.3091, label: 1, bag_size: 1221
batch 79, loss: 2.1196, instance_loss: 1.2548, weighted_loss: 1.8601, label: 0, bag_size: 5098
batch 99, loss: 0.2347, instance_loss: 0.3452, weighted_loss: 0.2679, label: 1, bag_size: 2878
batch 119, loss: 0.5594, instance_loss: 0.4549, weighted_loss: 0.5281, label: 2, bag_size: 4241
batch 139, loss: 0.1919, instance_loss: 0.3952, weighted_loss: 0.2529, label: 1, bag_size: 2643
batch 159, loss: 0.0017, instance_loss: 0.2000, weighted_loss: 0.0612, label: 2, bag_size: 2031
batch 179, loss: 0.2823, instance_loss: 0.4486, weighted_loss: 0.3322, label: 0, bag_size: 3743
batch 199, loss: 0.0332, instance_loss: 0.4270, weighted_loss: 0.1514, label: 2, bag_size: 2422
batch 219, loss: 0.0531, instance_loss: 0.1309, weighted_loss: 0.0764, label: 0, bag_size: 1640
batch 239, loss: 0.0366, instance_loss: 0.0908, weighted_loss: 0.0529, label: 0, bag_size: 1845
batch 259, loss: 1.0401, instance_loss: 1.0228, weighted_loss: 1.0349, label: 1, bag_size: 11974
batch 279, loss: 0.0132, instance_loss: 0.0708, weighted_loss: 0.0304, label: 2, bag_size: 4088
batch 299, loss: 0.1077, instance_loss: 0.1807, weighted_loss: 0.1296, label: 0, bag_size: 3437
batch 319, loss: 0.3926, instance_loss: 0.8520, weighted_loss: 0.5304, label: 1, bag_size: 314
batch 339, loss: 0.4096, instance_loss: 0.3808, weighted_loss: 0.4009, label: 1, bag_size: 19265
batch 359, loss: 0.0048, instance_loss: 0.2878, weighted_loss: 0.0897, label: 1, bag_size: 3043
batch 379, loss: 0.2099, instance_loss: 0.4861, weighted_loss: 0.2928, label: 0, bag_size: 5375
batch 399, loss: 0.0165, instance_loss: 0.6442, weighted_loss: 0.2048, label: 0, bag_size: 1981
batch 419, loss: 0.6392, instance_loss: 0.6013, weighted_loss: 0.6279, label: 1, bag_size: 2481
batch 439, loss: 0.2605, instance_loss: 0.4516, weighted_loss: 0.3178, label: 0, bag_size: 909
batch 459, loss: 0.0000, instance_loss: 0.3284, weighted_loss: 0.0985, label: 0, bag_size: 5053
batch 479, loss: 0.4983, instance_loss: 0.5733, weighted_loss: 0.5208, label: 1, bag_size: 5718
batch 499, loss: 0.3346, instance_loss: 0.2025, weighted_loss: 0.2950, label: 2, bag_size: 1094
batch 519, loss: 0.1589, instance_loss: 0.3699, weighted_loss: 0.2222, label: 1, bag_size: 4644
batch 539, loss: 0.7962, instance_loss: 0.8118, weighted_loss: 0.8009, label: 1, bag_size: 4694
batch 559, loss: 2.1117, instance_loss: 0.9692, weighted_loss: 1.7690, label: 0, bag_size: 4572
batch 579, loss: 0.1097, instance_loss: 0.2420, weighted_loss: 0.1494, label: 1, bag_size: 862
batch 599, loss: 1.8500, instance_loss: 0.9380, weighted_loss: 1.5764, label: 2, bag_size: 728
batch 619, loss: 0.4112, instance_loss: 0.5042, weighted_loss: 0.4391, label: 2, bag_size: 3534
batch 639, loss: 0.1532, instance_loss: 0.4044, weighted_loss: 0.2285, label: 2, bag_size: 4978
batch 659, loss: 1.2993, instance_loss: 0.8113, weighted_loss: 1.1529, label: 2, bag_size: 909
batch 679, loss: 0.0974, instance_loss: 0.1473, weighted_loss: 0.1124, label: 0, bag_size: 1640
batch 699, loss: 0.4386, instance_loss: 0.4227, weighted_loss: 0.4338, label: 1, bag_size: 596
batch 719, loss: 2.0516, instance_loss: 0.8799, weighted_loss: 1.7001, label: 1, bag_size: 3497
batch 739, loss: 0.6811, instance_loss: 0.6240, weighted_loss: 0.6640, label: 1, bag_size: 5512


class 0 clustering acc 0.9678411633109619: correct 17305/17880
class 1 clustering acc 0.35369127516778526: correct 2108/5960
Epoch: 27, train_loss: 0.6209, train_clustering_loss:  0.5550, train_error: 0.2725
class 0: acc 0.78099173553719, correct 189/242
class 1: acc 0.6439393939393939, correct 170/264
class 2: acc 0.7656903765690377, correct 183/239

Val Set, val_loss: 1.0584, val_error: 0.4681, auc: 0.8278
class 0 clustering acc 0.964095744680851: correct 2175/2256
class 1 clustering acc 0.16090425531914893: correct 121/752
class 0: acc 0.4230769230769231, correct 22/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.0154, instance_loss: 0.7361, weighted_loss: 0.9316, label: 1, bag_size: 302
batch 39, loss: 0.2210, instance_loss: 0.2861, weighted_loss: 0.2405, label: 0, bag_size: 6927
batch 59, loss: 0.1304, instance_loss: 0.6592, weighted_loss: 0.2891, label: 1, bag_size: 3437
batch 79, loss: 0.5682, instance_loss: 0.4483, weighted_loss: 0.5322, label: 2, bag_size: 4096
batch 99, loss: 0.0634, instance_loss: 0.0935, weighted_loss: 0.0725, label: 2, bag_size: 5138
batch 119, loss: 1.3449, instance_loss: 0.8816, weighted_loss: 1.2059, label: 2, bag_size: 5426
batch 139, loss: 2.9633, instance_loss: 1.6635, weighted_loss: 2.5734, label: 0, bag_size: 455
batch 159, loss: 0.0202, instance_loss: 0.1242, weighted_loss: 0.0514, label: 2, bag_size: 4569
batch 179, loss: 0.9965, instance_loss: 0.9103, weighted_loss: 0.9706, label: 1, bag_size: 4184
batch 199, loss: 0.3337, instance_loss: 0.3170, weighted_loss: 0.3287, label: 2, bag_size: 3534
batch 219, loss: 0.0073, instance_loss: 0.2494, weighted_loss: 0.0799, label: 1, bag_size: 5364
batch 239, loss: 0.1489, instance_loss: 0.4498, weighted_loss: 0.2391, label: 1, bag_size: 5195
batch 259, loss: 2.1616, instance_loss: 1.2961, weighted_loss: 1.9020, label: 0, bag_size: 4032
batch 279, loss: 0.0672, instance_loss: 0.1896, weighted_loss: 0.1039, label: 2, bag_size: 4745
batch 299, loss: 0.0768, instance_loss: 0.1715, weighted_loss: 0.1052, label: 0, bag_size: 3741
batch 319, loss: 0.0358, instance_loss: 0.2878, weighted_loss: 0.1114, label: 2, bag_size: 4140
batch 339, loss: 2.4575, instance_loss: 1.3636, weighted_loss: 2.1293, label: 0, bag_size: 436
batch 359, loss: 0.1535, instance_loss: 0.2677, weighted_loss: 0.1877, label: 2, bag_size: 5924
batch 379, loss: 1.2008, instance_loss: 0.8674, weighted_loss: 1.1008, label: 1, bag_size: 936
batch 399, loss: 0.0390, instance_loss: 0.4129, weighted_loss: 0.1512, label: 0, bag_size: 1417
batch 419, loss: 0.6769, instance_loss: 0.7668, weighted_loss: 0.7039, label: 1, bag_size: 3991
batch 439, loss: 0.0385, instance_loss: 0.0332, weighted_loss: 0.0369, label: 2, bag_size: 3094
batch 459, loss: 0.0039, instance_loss: 0.0546, weighted_loss: 0.0191, label: 0, bag_size: 873
batch 479, loss: 2.0734, instance_loss: 1.5394, weighted_loss: 1.9132, label: 1, bag_size: 3322
batch 499, loss: 0.4761, instance_loss: 0.7891, weighted_loss: 0.5700, label: 1, bag_size: 582
batch 519, loss: 0.0836, instance_loss: 1.1059, weighted_loss: 0.3903, label: 0, bag_size: 1910
batch 539, loss: 0.7901, instance_loss: 0.1403, weighted_loss: 0.5952, label: 2, bag_size: 2561
batch 559, loss: 0.0318, instance_loss: 0.1832, weighted_loss: 0.0772, label: 2, bag_size: 6704
batch 579, loss: 0.0764, instance_loss: 0.1429, weighted_loss: 0.0964, label: 0, bag_size: 1845
batch 599, loss: 0.1538, instance_loss: 0.3587, weighted_loss: 0.2153, label: 2, bag_size: 3497
batch 619, loss: 0.4219, instance_loss: 0.5613, weighted_loss: 0.4638, label: 2, bag_size: 22464
batch 639, loss: 0.0216, instance_loss: 0.3427, weighted_loss: 0.1180, label: 2, bag_size: 4203
batch 659, loss: 0.3375, instance_loss: 0.3731, weighted_loss: 0.3482, label: 2, bag_size: 3080
batch 679, loss: 0.2216, instance_loss: 0.3319, weighted_loss: 0.2547, label: 2, bag_size: 3497
batch 699, loss: 0.1280, instance_loss: 0.6220, weighted_loss: 0.2762, label: 1, bag_size: 2731
batch 719, loss: 0.1789, instance_loss: 0.3339, weighted_loss: 0.2254, label: 0, bag_size: 5823
batch 739, loss: 0.8065, instance_loss: 1.1120, weighted_loss: 0.8982, label: 2, bag_size: 4910


class 0 clustering acc 0.9666666666666667: correct 17284/17880
class 1 clustering acc 0.3864093959731544: correct 2303/5960
Epoch: 28, train_loss: 0.5611, train_clustering_loss:  0.5426, train_error: 0.2336
class 0: acc 0.7984496124031008, correct 206/258
class 1: acc 0.639269406392694, correct 140/219
class 2: acc 0.8395522388059702, correct 225/268

Val Set, val_loss: 0.7659, val_error: 0.2979, auc: 0.8821
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.21010638297872342: correct 158/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.9979, instance_loss: 1.4362, weighted_loss: 1.8294, label: 1, bag_size: 3399
batch 39, loss: 0.0362, instance_loss: 0.1613, weighted_loss: 0.0737, label: 0, bag_size: 4326
batch 59, loss: 0.0792, instance_loss: 0.2832, weighted_loss: 0.1404, label: 2, bag_size: 5037
batch 79, loss: 0.0028, instance_loss: 0.1333, weighted_loss: 0.0419, label: 1, bag_size: 259
batch 99, loss: 1.6600, instance_loss: 1.3683, weighted_loss: 1.5725, label: 0, bag_size: 2231
batch 119, loss: 0.0866, instance_loss: 0.3266, weighted_loss: 0.1586, label: 0, bag_size: 5831
batch 139, loss: 0.0306, instance_loss: 0.0860, weighted_loss: 0.0472, label: 2, bag_size: 2483
batch 159, loss: 0.8153, instance_loss: 0.5381, weighted_loss: 0.7321, label: 1, bag_size: 3422
batch 179, loss: 0.0857, instance_loss: 0.2736, weighted_loss: 0.1421, label: 2, bag_size: 5138
batch 199, loss: 0.3875, instance_loss: 0.3920, weighted_loss: 0.3888, label: 2, bag_size: 3534
batch 219, loss: 0.7372, instance_loss: 0.5812, weighted_loss: 0.6904, label: 1, bag_size: 3225
batch 239, loss: 0.2036, instance_loss: 0.2942, weighted_loss: 0.2308, label: 2, bag_size: 3080
batch 259, loss: 1.2741, instance_loss: 0.5826, weighted_loss: 1.0666, label: 0, bag_size: 4245
batch 279, loss: 0.1287, instance_loss: 0.3087, weighted_loss: 0.1827, label: 0, bag_size: 2378
batch 299, loss: 0.7278, instance_loss: 0.7007, weighted_loss: 0.7197, label: 1, bag_size: 3935
batch 319, loss: 0.3939, instance_loss: 0.4208, weighted_loss: 0.4020, label: 0, bag_size: 3368
batch 339, loss: 0.2090, instance_loss: 0.4555, weighted_loss: 0.2830, label: 2, bag_size: 1543
batch 359, loss: 0.0562, instance_loss: 0.5187, weighted_loss: 0.1950, label: 1, bag_size: 5385
batch 379, loss: 0.7866, instance_loss: 0.6683, weighted_loss: 0.7511, label: 2, bag_size: 909
batch 399, loss: 1.9631, instance_loss: 1.1039, weighted_loss: 1.7053, label: 1, bag_size: 1964
batch 419, loss: 0.0506, instance_loss: 0.2585, weighted_loss: 0.1130, label: 0, bag_size: 4251
batch 439, loss: 0.0166, instance_loss: 0.0450, weighted_loss: 0.0251, label: 0, bag_size: 4783
batch 459, loss: 0.3794, instance_loss: 0.5323, weighted_loss: 0.4253, label: 2, bag_size: 3174
batch 479, loss: 0.1740, instance_loss: 0.3599, weighted_loss: 0.2298, label: 0, bag_size: 4494
batch 499, loss: 0.7815, instance_loss: 0.6228, weighted_loss: 0.7339, label: 1, bag_size: 578
batch 519, loss: 1.1536, instance_loss: 0.5530, weighted_loss: 0.9734, label: 0, bag_size: 14218
batch 539, loss: 0.1172, instance_loss: 0.2291, weighted_loss: 0.1508, label: 1, bag_size: 2767
batch 559, loss: 0.5676, instance_loss: 0.5594, weighted_loss: 0.5651, label: 2, bag_size: 4535
batch 579, loss: 0.0795, instance_loss: 0.0995, weighted_loss: 0.0855, label: 2, bag_size: 4088
batch 599, loss: 0.1716, instance_loss: 0.4012, weighted_loss: 0.2405, label: 1, bag_size: 3337
batch 619, loss: 0.0275, instance_loss: 0.2458, weighted_loss: 0.0930, label: 0, bag_size: 5459
batch 639, loss: 0.0422, instance_loss: 0.3580, weighted_loss: 0.1369, label: 0, bag_size: 2139
batch 659, loss: 0.0170, instance_loss: 0.0544, weighted_loss: 0.0282, label: 2, bag_size: 4856
batch 679, loss: 0.1735, instance_loss: 0.2160, weighted_loss: 0.1863, label: 2, bag_size: 597
batch 699, loss: 0.0619, instance_loss: 0.1354, weighted_loss: 0.0840, label: 2, bag_size: 2997
batch 719, loss: 0.2489, instance_loss: 0.3870, weighted_loss: 0.2903, label: 1, bag_size: 2302
batch 739, loss: 2.0292, instance_loss: 1.0565, weighted_loss: 1.7373, label: 2, bag_size: 361


class 0 clustering acc 0.9670022371364653: correct 17290/17880
class 1 clustering acc 0.40184563758389263: correct 2395/5960
Epoch: 29, train_loss: 0.5449, train_clustering_loss:  0.5281, train_error: 0.2389
class 0: acc 0.7983870967741935, correct 198/248
class 1: acc 0.6600790513833992, correct 167/253
class 2: acc 0.8278688524590164, correct 202/244

Val Set, val_loss: 0.9728, val_error: 0.3830, auc: 0.8411
class 0 clustering acc 0.973404255319149: correct 2196/2256
class 1 clustering acc 0.20877659574468085: correct 157/752
class 0: acc 0.5, correct 26/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9160, instance_loss: 0.7014, weighted_loss: 0.8516, label: 2, bag_size: 6594
batch 39, loss: 0.4088, instance_loss: 0.5024, weighted_loss: 0.4369, label: 1, bag_size: 1906
batch 59, loss: 0.0237, instance_loss: 0.1363, weighted_loss: 0.0575, label: 2, bag_size: 6001
batch 79, loss: 0.0934, instance_loss: 0.2264, weighted_loss: 0.1333, label: 0, bag_size: 5375
batch 99, loss: 0.2102, instance_loss: 0.3259, weighted_loss: 0.2449, label: 1, bag_size: 210
batch 119, loss: 0.0172, instance_loss: 0.2117, weighted_loss: 0.0756, label: 2, bag_size: 5017
batch 139, loss: 0.0484, instance_loss: 0.2277, weighted_loss: 0.1022, label: 1, bag_size: 4253
batch 159, loss: 0.2433, instance_loss: 0.6123, weighted_loss: 0.3540, label: 0, bag_size: 4678
batch 179, loss: 0.0953, instance_loss: 0.2330, weighted_loss: 0.1366, label: 1, bag_size: 7279
batch 199, loss: 0.8801, instance_loss: 0.4836, weighted_loss: 0.7611, label: 2, bag_size: 705
batch 219, loss: 0.2420, instance_loss: 0.3835, weighted_loss: 0.2845, label: 0, bag_size: 5871
batch 239, loss: 1.2131, instance_loss: 0.9189, weighted_loss: 1.1248, label: 1, bag_size: 3821
batch 259, loss: 0.0567, instance_loss: 0.2230, weighted_loss: 0.1066, label: 0, bag_size: 471
batch 279, loss: 0.1024, instance_loss: 0.0950, weighted_loss: 0.1002, label: 2, bag_size: 6001
batch 299, loss: 0.4178, instance_loss: 0.5952, weighted_loss: 0.4710, label: 2, bag_size: 3618
batch 319, loss: 1.6021, instance_loss: 0.7658, weighted_loss: 1.3512, label: 0, bag_size: 14218
batch 339, loss: 0.0000, instance_loss: 0.2290, weighted_loss: 0.0687, label: 0, bag_size: 2306
batch 359, loss: 1.5585, instance_loss: 1.2777, weighted_loss: 1.4742, label: 1, bag_size: 3791
batch 379, loss: 0.2380, instance_loss: 0.1802, weighted_loss: 0.2206, label: 2, bag_size: 4043
batch 399, loss: 0.1451, instance_loss: 0.2916, weighted_loss: 0.1891, label: 0, bag_size: 2293
batch 419, loss: 0.5227, instance_loss: 0.6192, weighted_loss: 0.5516, label: 0, bag_size: 889
batch 439, loss: 0.2885, instance_loss: 0.4687, weighted_loss: 0.3426, label: 0, bag_size: 609
batch 459, loss: 0.3609, instance_loss: 0.5937, weighted_loss: 0.4307, label: 0, bag_size: 609
batch 479, loss: 0.5756, instance_loss: 0.6148, weighted_loss: 0.5874, label: 0, bag_size: 5848
batch 499, loss: 0.0113, instance_loss: 0.1734, weighted_loss: 0.0600, label: 0, bag_size: 855
batch 519, loss: 0.3647, instance_loss: 0.5383, weighted_loss: 0.4168, label: 2, bag_size: 4162
batch 539, loss: 0.0847, instance_loss: 0.2541, weighted_loss: 0.1355, label: 0, bag_size: 5368
batch 559, loss: 0.5243, instance_loss: 0.6102, weighted_loss: 0.5501, label: 1, bag_size: 3357
batch 579, loss: 0.2233, instance_loss: 0.4754, weighted_loss: 0.2989, label: 0, bag_size: 2286
batch 599, loss: 0.0261, instance_loss: 0.0953, weighted_loss: 0.0468, label: 0, bag_size: 5757
batch 619, loss: 1.1109, instance_loss: 0.8159, weighted_loss: 1.0224, label: 2, bag_size: 909
batch 639, loss: 1.5820, instance_loss: 0.5776, weighted_loss: 1.2807, label: 0, bag_size: 5023
batch 659, loss: 0.0000, instance_loss: 0.1380, weighted_loss: 0.0414, label: 0, bag_size: 4582
batch 679, loss: 1.4606, instance_loss: 0.8938, weighted_loss: 1.2905, label: 1, bag_size: 4694
batch 699, loss: 0.1412, instance_loss: 0.2446, weighted_loss: 0.1722, label: 0, bag_size: 5036
batch 719, loss: 0.9765, instance_loss: 0.5547, weighted_loss: 0.8499, label: 2, bag_size: 4241
batch 739, loss: 0.5939, instance_loss: 0.5685, weighted_loss: 0.5863, label: 1, bag_size: 1906


class 0 clustering acc 0.9680089485458613: correct 17308/17880
class 1 clustering acc 0.3870805369127517: correct 2307/5960
Epoch: 30, train_loss: 0.5665, train_clustering_loss:  0.5333, train_error: 0.2523
class 0: acc 0.796875, correct 204/256
class 1: acc 0.6706349206349206, correct 169/252
class 2: acc 0.7763713080168776, correct 184/237

Val Set, val_loss: 0.6867, val_error: 0.2660, auc: 0.8939
class 0 clustering acc 0.9685283687943262: correct 2185/2256
class 1 clustering acc 0.49069148936170215: correct 369/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1135, instance_loss: 0.2046, weighted_loss: 0.1408, label: 2, bag_size: 3327
batch 39, loss: 0.0397, instance_loss: 0.0858, weighted_loss: 0.0536, label: 2, bag_size: 6026
batch 59, loss: 0.7134, instance_loss: 0.1372, weighted_loss: 0.5406, label: 2, bag_size: 2561
batch 79, loss: 0.3249, instance_loss: 0.1908, weighted_loss: 0.2847, label: 0, bag_size: 5413
batch 99, loss: 0.0115, instance_loss: 0.0710, weighted_loss: 0.0294, label: 2, bag_size: 2483
batch 119, loss: 0.0315, instance_loss: 0.1181, weighted_loss: 0.0575, label: 2, bag_size: 3497
batch 139, loss: 0.0000, instance_loss: 0.2049, weighted_loss: 0.0615, label: 0, bag_size: 4582
batch 159, loss: 0.1402, instance_loss: 0.1743, weighted_loss: 0.1504, label: 2, bag_size: 6026
batch 179, loss: 0.5902, instance_loss: 0.4811, weighted_loss: 0.5575, label: 1, bag_size: 4395
batch 199, loss: 0.3139, instance_loss: 0.4721, weighted_loss: 0.3613, label: 1, bag_size: 3403
batch 219, loss: 0.1946, instance_loss: 0.4176, weighted_loss: 0.2615, label: 1, bag_size: 3475
batch 239, loss: 3.6381, instance_loss: 1.2862, weighted_loss: 2.9325, label: 2, bag_size: 223
batch 259, loss: 0.8245, instance_loss: 0.6388, weighted_loss: 0.7688, label: 1, bag_size: 3475
batch 279, loss: 2.4739, instance_loss: 1.4978, weighted_loss: 2.1811, label: 1, bag_size: 1307
batch 299, loss: 0.1231, instance_loss: 0.4225, weighted_loss: 0.2129, label: 1, bag_size: 3761
batch 319, loss: 1.0166, instance_loss: 0.9115, weighted_loss: 0.9851, label: 2, bag_size: 1513
batch 339, loss: 0.1229, instance_loss: 0.2436, weighted_loss: 0.1591, label: 0, bag_size: 1018
batch 359, loss: 0.6318, instance_loss: 0.1911, weighted_loss: 0.4996, label: 0, bag_size: 4131
batch 379, loss: 0.1148, instance_loss: 0.6907, weighted_loss: 0.2876, label: 1, bag_size: 6717
batch 399, loss: 0.0969, instance_loss: 0.1507, weighted_loss: 0.1130, label: 2, bag_size: 3080
batch 419, loss: 4.1602, instance_loss: 1.9624, weighted_loss: 3.5008, label: 0, bag_size: 4605
batch 439, loss: 2.3735, instance_loss: 1.0283, weighted_loss: 1.9699, label: 1, bag_size: 1327
batch 459, loss: 0.0400, instance_loss: 0.2391, weighted_loss: 0.0997, label: 0, bag_size: 3408
batch 479, loss: 1.9743, instance_loss: 0.8232, weighted_loss: 1.6290, label: 0, bag_size: 4639
batch 499, loss: 0.5050, instance_loss: 0.3584, weighted_loss: 0.4610, label: 1, bag_size: 3296
batch 519, loss: 0.7448, instance_loss: 0.6851, weighted_loss: 0.7269, label: 0, bag_size: 4946
batch 539, loss: 0.1852, instance_loss: 0.3963, weighted_loss: 0.2485, label: 1, bag_size: 4069
batch 559, loss: 1.4860, instance_loss: 0.9099, weighted_loss: 1.3132, label: 2, bag_size: 4535
batch 579, loss: 1.0522, instance_loss: 1.1225, weighted_loss: 1.0733, label: 1, bag_size: 3322
batch 599, loss: 0.2507, instance_loss: 0.5847, weighted_loss: 0.3509, label: 1, bag_size: 3437
batch 619, loss: 1.2728, instance_loss: 0.9800, weighted_loss: 1.1850, label: 2, bag_size: 6594
batch 639, loss: 3.6456, instance_loss: 1.2469, weighted_loss: 2.9260, label: 0, bag_size: 2896
batch 659, loss: 0.0190, instance_loss: 0.4118, weighted_loss: 0.1369, label: 2, bag_size: 5017
batch 679, loss: 0.5483, instance_loss: 0.4586, weighted_loss: 0.5214, label: 1, bag_size: 3482
batch 699, loss: 0.6659, instance_loss: 0.7926, weighted_loss: 0.7039, label: 0, bag_size: 6971
batch 719, loss: 0.2788, instance_loss: 0.8143, weighted_loss: 0.4394, label: 0, bag_size: 3245
batch 739, loss: 1.1599, instance_loss: 0.9144, weighted_loss: 1.0863, label: 0, bag_size: 15105


class 0 clustering acc 0.9644854586129754: correct 17245/17880
class 1 clustering acc 0.3634228187919463: correct 2166/5960
Epoch: 31, train_loss: 0.6411, train_clustering_loss:  0.5607, train_error: 0.2430
class 0: acc 0.7729257641921398, correct 177/229
class 1: acc 0.7218045112781954, correct 192/266
class 2: acc 0.78, correct 195/250

Val Set, val_loss: 0.8999, val_error: 0.3191, auc: 0.8537
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.300531914893617: correct 226/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4260, instance_loss: 0.5710, weighted_loss: 0.4695, label: 1, bag_size: 4119
batch 39, loss: 0.6650, instance_loss: 0.4947, weighted_loss: 0.6139, label: 2, bag_size: 4241
batch 59, loss: 0.6640, instance_loss: 0.7865, weighted_loss: 0.7007, label: 0, bag_size: 3701
batch 79, loss: 0.9576, instance_loss: 0.8346, weighted_loss: 0.9207, label: 1, bag_size: 4824
batch 99, loss: 0.1830, instance_loss: 0.4331, weighted_loss: 0.2581, label: 1, bag_size: 683
batch 119, loss: 1.9996, instance_loss: 1.0684, weighted_loss: 1.7202, label: 1, bag_size: 2852
batch 139, loss: 0.2279, instance_loss: 0.3468, weighted_loss: 0.2636, label: 2, bag_size: 3497
batch 159, loss: 0.4386, instance_loss: 0.5873, weighted_loss: 0.4832, label: 0, bag_size: 4018
batch 179, loss: 1.4374, instance_loss: 0.6736, weighted_loss: 1.2082, label: 0, bag_size: 1611
batch 199, loss: 0.3328, instance_loss: 0.5195, weighted_loss: 0.3888, label: 2, bag_size: 5924
batch 219, loss: 0.1473, instance_loss: 0.2833, weighted_loss: 0.1881, label: 0, bag_size: 3368
batch 239, loss: 0.1856, instance_loss: 0.5620, weighted_loss: 0.2985, label: 2, bag_size: 22464
batch 259, loss: 0.2698, instance_loss: 0.5269, weighted_loss: 0.3470, label: 0, bag_size: 1883
batch 279, loss: 0.0000, instance_loss: 0.2134, weighted_loss: 0.0640, label: 0, bag_size: 6182
batch 299, loss: 0.9939, instance_loss: 0.7653, weighted_loss: 0.9253, label: 0, bag_size: 4416
batch 319, loss: 0.1205, instance_loss: 0.1007, weighted_loss: 0.1146, label: 2, bag_size: 3583
batch 339, loss: 0.4198, instance_loss: 0.4144, weighted_loss: 0.4182, label: 0, bag_size: 3789
batch 359, loss: 0.1607, instance_loss: 0.3532, weighted_loss: 0.2184, label: 2, bag_size: 3094
batch 379, loss: 1.5575, instance_loss: 0.9787, weighted_loss: 1.3838, label: 1, bag_size: 11974
batch 399, loss: 0.4002, instance_loss: 0.3465, weighted_loss: 0.3840, label: 0, bag_size: 3586
batch 419, loss: 0.0264, instance_loss: 0.4021, weighted_loss: 0.1391, label: 2, bag_size: 5017
batch 439, loss: 1.2374, instance_loss: 0.4786, weighted_loss: 1.0098, label: 2, bag_size: 2561
batch 459, loss: 0.4679, instance_loss: 0.2931, weighted_loss: 0.4155, label: 2, bag_size: 614
batch 479, loss: 1.3870, instance_loss: 0.9832, weighted_loss: 1.2658, label: 1, bag_size: 3225
batch 499, loss: 0.7112, instance_loss: 1.1975, weighted_loss: 0.8571, label: 1, bag_size: 1558
batch 519, loss: 0.5218, instance_loss: 0.5807, weighted_loss: 0.5395, label: 2, bag_size: 724
batch 539, loss: 0.0697, instance_loss: 0.4454, weighted_loss: 0.1824, label: 2, bag_size: 5037
batch 559, loss: 0.0000, instance_loss: 0.2294, weighted_loss: 0.0688, label: 0, bag_size: 5053
batch 579, loss: 0.8978, instance_loss: 1.1133, weighted_loss: 0.9624, label: 2, bag_size: 3299
batch 599, loss: 0.0412, instance_loss: 0.2627, weighted_loss: 0.1076, label: 0, bag_size: 1176
batch 619, loss: 0.0034, instance_loss: 0.0967, weighted_loss: 0.0314, label: 1, bag_size: 2643
batch 639, loss: 0.0034, instance_loss: 0.0947, weighted_loss: 0.0308, label: 1, bag_size: 2643
batch 659, loss: 0.0671, instance_loss: 0.1096, weighted_loss: 0.0798, label: 2, bag_size: 4788
batch 679, loss: 0.0267, instance_loss: 0.2289, weighted_loss: 0.0874, label: 0, bag_size: 4071
batch 699, loss: 0.7103, instance_loss: 0.6211, weighted_loss: 0.6835, label: 2, bag_size: 4096
batch 719, loss: 0.0302, instance_loss: 0.3589, weighted_loss: 0.1288, label: 1, bag_size: 874
batch 739, loss: 0.0537, instance_loss: 0.3526, weighted_loss: 0.1434, label: 1, bag_size: 779


class 0 clustering acc 0.9722035794183446: correct 17383/17880
class 1 clustering acc 0.36828859060402686: correct 2195/5960
Epoch: 32, train_loss: 0.5365, train_clustering_loss:  0.5288, train_error: 0.2242
class 0: acc 0.799163179916318, correct 191/239
class 1: acc 0.6415929203539823, correct 145/226
class 2: acc 0.8642857142857143, correct 242/280

Val Set, val_loss: 1.0730, val_error: 0.3936, auc: 0.8442
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.2300531914893617: correct 173/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0921, instance_loss: 0.3986, weighted_loss: 0.1840, label: 0, bag_size: 4494
batch 39, loss: 0.6221, instance_loss: 0.6177, weighted_loss: 0.6208, label: 1, bag_size: 3935
batch 59, loss: 2.9372, instance_loss: 1.5230, weighted_loss: 2.5130, label: 0, bag_size: 11141
batch 79, loss: 0.3776, instance_loss: 0.3410, weighted_loss: 0.3666, label: 2, bag_size: 597
batch 99, loss: 1.3052, instance_loss: 0.7034, weighted_loss: 1.1247, label: 0, bag_size: 3033
batch 119, loss: 2.0145, instance_loss: 1.5070, weighted_loss: 1.8623, label: 1, bag_size: 8632
batch 139, loss: 0.4723, instance_loss: 0.6486, weighted_loss: 0.5252, label: 0, bag_size: 1655
batch 159, loss: 1.3612, instance_loss: 1.0601, weighted_loss: 1.2709, label: 1, bag_size: 5011
batch 179, loss: 0.3330, instance_loss: 0.7413, weighted_loss: 0.4555, label: 1, bag_size: 6817
batch 199, loss: 0.6782, instance_loss: 0.8590, weighted_loss: 0.7325, label: 1, bag_size: 3821
batch 219, loss: 1.5523, instance_loss: 0.9088, weighted_loss: 1.3593, label: 1, bag_size: 3225
batch 239, loss: 0.1236, instance_loss: 0.2289, weighted_loss: 0.1552, label: 2, bag_size: 3121
batch 259, loss: 0.2502, instance_loss: 0.4541, weighted_loss: 0.3114, label: 2, bag_size: 2422
batch 279, loss: 0.4424, instance_loss: 0.3821, weighted_loss: 0.4243, label: 1, bag_size: 1410
batch 299, loss: 3.9590, instance_loss: 0.8568, weighted_loss: 3.0283, label: 1, bag_size: 5402
batch 319, loss: 0.0121, instance_loss: 0.0437, weighted_loss: 0.0216, label: 1, bag_size: 2254
batch 339, loss: 0.0004, instance_loss: 0.3220, weighted_loss: 0.0968, label: 1, bag_size: 5760
batch 359, loss: 0.1182, instance_loss: 0.2761, weighted_loss: 0.1656, label: 1, bag_size: 4184
batch 379, loss: 1.3682, instance_loss: 0.8094, weighted_loss: 1.2006, label: 0, bag_size: 3475
batch 399, loss: 0.4340, instance_loss: 0.4007, weighted_loss: 0.4240, label: 0, bag_size: 6249
batch 419, loss: 0.1510, instance_loss: 0.1986, weighted_loss: 0.1653, label: 2, bag_size: 2481
batch 439, loss: 0.1265, instance_loss: 0.4368, weighted_loss: 0.2196, label: 1, bag_size: 3761
batch 459, loss: 0.7560, instance_loss: 0.9669, weighted_loss: 0.8192, label: 0, bag_size: 673
batch 479, loss: 0.0000, instance_loss: 1.7718, weighted_loss: 0.5315, label: 0, bag_size: 5017
batch 499, loss: 0.0354, instance_loss: 0.0976, weighted_loss: 0.0541, label: 2, bag_size: 4745
batch 519, loss: 0.0034, instance_loss: 0.0947, weighted_loss: 0.0308, label: 1, bag_size: 460
batch 539, loss: 0.2634, instance_loss: 0.5117, weighted_loss: 0.3379, label: 1, bag_size: 3126
batch 559, loss: 0.0057, instance_loss: 0.3220, weighted_loss: 0.1006, label: 1, bag_size: 5760
batch 579, loss: 0.0235, instance_loss: 0.3616, weighted_loss: 0.1249, label: 1, bag_size: 4111
batch 599, loss: 0.3569, instance_loss: 0.3388, weighted_loss: 0.3515, label: 2, bag_size: 3618
batch 619, loss: 1.4686, instance_loss: 0.9352, weighted_loss: 1.3086, label: 0, bag_size: 3191
batch 639, loss: 0.9300, instance_loss: 0.5064, weighted_loss: 0.8029, label: 1, bag_size: 19265
batch 659, loss: 0.2749, instance_loss: 0.7309, weighted_loss: 0.4117, label: 0, bag_size: 4351
batch 679, loss: 0.0657, instance_loss: 0.5761, weighted_loss: 0.2188, label: 0, bag_size: 4178
batch 699, loss: 0.2159, instance_loss: 1.1454, weighted_loss: 0.4948, label: 1, bag_size: 4192
batch 719, loss: 0.8127, instance_loss: 0.5618, weighted_loss: 0.7375, label: 2, bag_size: 3112
batch 739, loss: 0.9279, instance_loss: 0.7437, weighted_loss: 0.8727, label: 2, bag_size: 1513


class 0 clustering acc 0.9649328859060403: correct 17253/17880
class 1 clustering acc 0.3421140939597315: correct 2039/5960
Epoch: 33, train_loss: 0.6017, train_clustering_loss:  0.5627, train_error: 0.2537
class 0: acc 0.7939914163090128, correct 185/233
class 1: acc 0.6641221374045801, correct 174/262
class 2: acc 0.788, correct 197/250

Val Set, val_loss: 0.8543, val_error: 0.2872, auc: 0.8697
class 0 clustering acc 0.974290780141844: correct 2198/2256
class 1 clustering acc 0.3803191489361702: correct 286/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1506, instance_loss: 0.3545, weighted_loss: 0.2118, label: 0, bag_size: 4997
batch 39, loss: 2.9338, instance_loss: 1.4169, weighted_loss: 2.4787, label: 1, bag_size: 4258
batch 59, loss: 0.2892, instance_loss: 0.3555, weighted_loss: 0.3091, label: 0, bag_size: 3855
batch 79, loss: 0.0221, instance_loss: 0.3058, weighted_loss: 0.1072, label: 2, bag_size: 4203
batch 99, loss: 2.8788, instance_loss: 1.0021, weighted_loss: 2.3158, label: 0, bag_size: 557
batch 119, loss: 1.6766, instance_loss: 0.8308, weighted_loss: 1.4229, label: 0, bag_size: 35080
batch 139, loss: 0.1518, instance_loss: 0.5049, weighted_loss: 0.2577, label: 0, bag_size: 6927
batch 159, loss: 0.1138, instance_loss: 0.3079, weighted_loss: 0.1721, label: 1, bag_size: 3396
batch 179, loss: 0.9794, instance_loss: 0.7575, weighted_loss: 0.9129, label: 2, bag_size: 22464
batch 199, loss: 0.0061, instance_loss: 0.4361, weighted_loss: 0.1351, label: 2, bag_size: 5037
batch 219, loss: 0.7845, instance_loss: 0.5647, weighted_loss: 0.7186, label: 2, bag_size: 5406
batch 239, loss: 0.9916, instance_loss: 0.9403, weighted_loss: 0.9762, label: 0, bag_size: 5871
batch 259, loss: 0.0000, instance_loss: 0.1586, weighted_loss: 0.0476, label: 1, bag_size: 5018
batch 279, loss: 0.5553, instance_loss: 0.4657, weighted_loss: 0.5284, label: 0, bag_size: 5848
batch 299, loss: 0.0001, instance_loss: 0.3542, weighted_loss: 0.1063, label: 1, bag_size: 5760
batch 319, loss: 0.7126, instance_loss: 0.4263, weighted_loss: 0.6267, label: 0, bag_size: 4524
batch 339, loss: 0.4559, instance_loss: 0.6108, weighted_loss: 0.5024, label: 1, bag_size: 832
batch 359, loss: 0.0317, instance_loss: 0.6523, weighted_loss: 0.2179, label: 2, bag_size: 4141
batch 379, loss: 0.1164, instance_loss: 0.3712, weighted_loss: 0.1928, label: 0, bag_size: 3743
batch 399, loss: 1.2051, instance_loss: 0.8683, weighted_loss: 1.1041, label: 0, bag_size: 5656
batch 419, loss: 0.1704, instance_loss: 0.6628, weighted_loss: 0.3181, label: 0, bag_size: 3701
batch 439, loss: 0.1689, instance_loss: 0.2031, weighted_loss: 0.1792, label: 0, bag_size: 3694
batch 459, loss: 0.0714, instance_loss: 0.5124, weighted_loss: 0.2037, label: 1, bag_size: 6475
batch 479, loss: 0.1800, instance_loss: 0.1393, weighted_loss: 0.1678, label: 0, bag_size: 4994
batch 499, loss: 0.0289, instance_loss: 0.1115, weighted_loss: 0.0537, label: 2, bag_size: 3121
batch 519, loss: 0.0377, instance_loss: 0.2201, weighted_loss: 0.0924, label: 2, bag_size: 4141
batch 539, loss: 0.0816, instance_loss: 0.3435, weighted_loss: 0.1602, label: 2, bag_size: 2031
batch 559, loss: 0.0415, instance_loss: 0.3234, weighted_loss: 0.1261, label: 0, bag_size: 4337
batch 579, loss: 0.0238, instance_loss: 0.1069, weighted_loss: 0.0488, label: 0, bag_size: 6138
batch 599, loss: 0.0321, instance_loss: 0.0482, weighted_loss: 0.0370, label: 2, bag_size: 6704
batch 619, loss: 0.0002, instance_loss: 0.0576, weighted_loss: 0.0174, label: 1, bag_size: 5462
batch 639, loss: 0.5147, instance_loss: 0.6004, weighted_loss: 0.5404, label: 1, bag_size: 2731
batch 659, loss: 1.4402, instance_loss: 1.4039, weighted_loss: 1.4293, label: 2, bag_size: 3475
batch 679, loss: 0.0173, instance_loss: 0.6018, weighted_loss: 0.1926, label: 1, bag_size: 3425
batch 699, loss: 1.5206, instance_loss: 1.0155, weighted_loss: 1.3690, label: 1, bag_size: 817
batch 719, loss: 0.1555, instance_loss: 0.7083, weighted_loss: 0.3213, label: 0, bag_size: 2853
batch 739, loss: 0.9650, instance_loss: 0.7973, weighted_loss: 0.9147, label: 2, bag_size: 5426


class 0 clustering acc 0.9671700223713646: correct 17293/17880
class 1 clustering acc 0.3864093959731544: correct 2303/5960
Epoch: 34, train_loss: 0.5390, train_clustering_loss:  0.5351, train_error: 0.2362
class 0: acc 0.7567567567567568, correct 196/259
class 1: acc 0.6963562753036437, correct 172/247
class 2: acc 0.8410041841004184, correct 201/239

Val Set, val_loss: 0.9229, val_error: 0.3511, auc: 0.8385
class 0 clustering acc 0.9773936170212766: correct 2205/2256
class 1 clustering acc 0.36569148936170215: correct 275/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0036, instance_loss: 0.1019, weighted_loss: 0.0331, label: 1, bag_size: 460
batch 39, loss: 0.0189, instance_loss: 0.2984, weighted_loss: 0.1027, label: 0, bag_size: 855
batch 59, loss: 0.0093, instance_loss: 0.2151, weighted_loss: 0.0710, label: 0, bag_size: 4344
batch 79, loss: 0.1317, instance_loss: 0.0890, weighted_loss: 0.1189, label: 2, bag_size: 88
batch 99, loss: 1.0177, instance_loss: 1.4425, weighted_loss: 1.1452, label: 2, bag_size: 3299
batch 119, loss: 0.1261, instance_loss: 0.2393, weighted_loss: 0.1601, label: 2, bag_size: 4096
batch 139, loss: 1.4011, instance_loss: 1.0157, weighted_loss: 1.2855, label: 0, bag_size: 3075
batch 159, loss: 1.4555, instance_loss: 0.5917, weighted_loss: 1.1964, label: 0, bag_size: 3402
batch 179, loss: 0.0957, instance_loss: 0.8498, weighted_loss: 0.3219, label: 1, bag_size: 6717
batch 199, loss: 2.9873, instance_loss: 1.3842, weighted_loss: 2.5064, label: 0, bag_size: 19216
batch 219, loss: 0.4109, instance_loss: 1.1374, weighted_loss: 0.6289, label: 1, bag_size: 5205
batch 239, loss: 5.2143, instance_loss: 2.9152, weighted_loss: 4.5245, label: 0, bag_size: 2736
batch 259, loss: 0.4905, instance_loss: 0.3157, weighted_loss: 0.4381, label: 1, bag_size: 3586
batch 279, loss: 0.5831, instance_loss: 0.7395, weighted_loss: 0.6300, label: 1, bag_size: 2642
batch 299, loss: 0.1478, instance_loss: 0.2671, weighted_loss: 0.1836, label: 0, bag_size: 5377
batch 319, loss: 1.7563, instance_loss: 0.9743, weighted_loss: 1.5217, label: 0, bag_size: 3402
batch 339, loss: 0.2886, instance_loss: 0.4251, weighted_loss: 0.3295, label: 0, bag_size: 2671
batch 359, loss: 0.0427, instance_loss: 0.2578, weighted_loss: 0.1072, label: 0, bag_size: 3924
batch 379, loss: 0.3322, instance_loss: 0.5919, weighted_loss: 0.4101, label: 1, bag_size: 2743
batch 399, loss: 0.2175, instance_loss: 0.5069, weighted_loss: 0.3043, label: 1, bag_size: 3991
batch 419, loss: 0.3289, instance_loss: 0.2746, weighted_loss: 0.3126, label: 0, bag_size: 3789
batch 439, loss: 0.4096, instance_loss: 0.3074, weighted_loss: 0.3789, label: 0, bag_size: 2756
batch 459, loss: 0.4219, instance_loss: 0.4158, weighted_loss: 0.4201, label: 0, bag_size: 622
batch 479, loss: 0.2031, instance_loss: 0.3409, weighted_loss: 0.2444, label: 2, bag_size: 2049
batch 499, loss: 0.1387, instance_loss: 0.1968, weighted_loss: 0.1562, label: 2, bag_size: 2359
batch 519, loss: 0.2381, instance_loss: 0.5811, weighted_loss: 0.3410, label: 1, bag_size: 3991
batch 539, loss: 0.0145, instance_loss: 0.1813, weighted_loss: 0.0646, label: 0, bag_size: 4344
batch 559, loss: 0.0946, instance_loss: 0.5112, weighted_loss: 0.2196, label: 1, bag_size: 4192
batch 579, loss: 0.9002, instance_loss: 0.6546, weighted_loss: 0.8265, label: 2, bag_size: 552
batch 599, loss: 0.8420, instance_loss: 0.9583, weighted_loss: 0.8769, label: 2, bag_size: 4342
batch 619, loss: 0.9361, instance_loss: 0.6252, weighted_loss: 0.8428, label: 2, bag_size: 5406
batch 639, loss: 0.1035, instance_loss: 0.2047, weighted_loss: 0.1338, label: 2, bag_size: 2359
batch 659, loss: 0.0705, instance_loss: 0.2418, weighted_loss: 0.1219, label: 2, bag_size: 3210
batch 679, loss: 0.0069, instance_loss: 0.1634, weighted_loss: 0.0538, label: 0, bag_size: 4644
batch 699, loss: 0.3604, instance_loss: 0.3989, weighted_loss: 0.3719, label: 0, bag_size: 3571
batch 719, loss: 0.2197, instance_loss: 0.4312, weighted_loss: 0.2831, label: 0, bag_size: 4146
batch 739, loss: 0.7336, instance_loss: 1.5648, weighted_loss: 0.9830, label: 1, bag_size: 20666


class 0 clustering acc 0.9667785234899329: correct 17286/17880
class 1 clustering acc 0.387751677852349: correct 2311/5960
Epoch: 35, train_loss: 0.5506, train_clustering_loss:  0.5393, train_error: 0.2416
class 0: acc 0.7857142857142857, correct 198/252
class 1: acc 0.6413502109704642, correct 152/237
class 2: acc 0.83984375, correct 215/256

Val Set, val_loss: 0.8382, val_error: 0.3085, auc: 0.8841
class 0 clustering acc 0.9636524822695035: correct 2174/2256
class 1 clustering acc 0.44813829787234044: correct 337/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.7559, instance_loss: 0.6261, weighted_loss: 0.7170, label: 1, bag_size: 4395
batch 39, loss: 0.2464, instance_loss: 0.3323, weighted_loss: 0.2721, label: 2, bag_size: 3778
batch 59, loss: 0.0932, instance_loss: 0.3011, weighted_loss: 0.1555, label: 0, bag_size: 1018
batch 79, loss: 0.5599, instance_loss: 0.8153, weighted_loss: 0.6365, label: 1, bag_size: 3460
batch 99, loss: 0.0169, instance_loss: 0.3299, weighted_loss: 0.1108, label: 1, bag_size: 4644
batch 119, loss: 1.1025, instance_loss: 0.9413, weighted_loss: 1.0541, label: 1, bag_size: 2229
batch 139, loss: 0.0686, instance_loss: 0.1434, weighted_loss: 0.0910, label: 2, bag_size: 2770
batch 159, loss: 0.0356, instance_loss: 0.2512, weighted_loss: 0.1003, label: 0, bag_size: 3406
batch 179, loss: 0.1037, instance_loss: 0.6975, weighted_loss: 0.2819, label: 1, bag_size: 6243
batch 199, loss: 0.2644, instance_loss: 0.3280, weighted_loss: 0.2835, label: 2, bag_size: 5426
batch 219, loss: 2.0898, instance_loss: 0.9301, weighted_loss: 1.7419, label: 1, bag_size: 1313
batch 239, loss: 0.0025, instance_loss: 0.1160, weighted_loss: 0.0366, label: 2, bag_size: 4203
batch 259, loss: 0.7824, instance_loss: 0.9870, weighted_loss: 0.8438, label: 2, bag_size: 3475
batch 279, loss: 0.6055, instance_loss: 0.4948, weighted_loss: 0.5723, label: 1, bag_size: 1042
batch 299, loss: 0.0133, instance_loss: 0.3047, weighted_loss: 0.1007, label: 0, bag_size: 2824
batch 319, loss: 1.4663, instance_loss: 0.7417, weighted_loss: 1.2489, label: 0, bag_size: 1782
batch 339, loss: 0.1285, instance_loss: 0.3381, weighted_loss: 0.1914, label: 2, bag_size: 1543
batch 359, loss: 0.0234, instance_loss: 0.5104, weighted_loss: 0.1695, label: 1, bag_size: 3172
batch 379, loss: 0.3680, instance_loss: 0.4891, weighted_loss: 0.4043, label: 2, bag_size: 3174
batch 399, loss: 0.0103, instance_loss: 0.0828, weighted_loss: 0.0321, label: 2, bag_size: 4088
batch 419, loss: 0.0863, instance_loss: 0.2517, weighted_loss: 0.1359, label: 2, bag_size: 6148
batch 439, loss: 0.0789, instance_loss: 0.3766, weighted_loss: 0.1682, label: 2, bag_size: 6148
batch 459, loss: 0.7042, instance_loss: 0.6091, weighted_loss: 0.6757, label: 1, bag_size: 1327
batch 479, loss: 0.1417, instance_loss: 0.2797, weighted_loss: 0.1831, label: 0, bag_size: 2884
batch 499, loss: 0.0000, instance_loss: 0.4716, weighted_loss: 0.1415, label: 0, bag_size: 1106
batch 519, loss: 0.4729, instance_loss: 0.8426, weighted_loss: 0.5838, label: 1, bag_size: 667
batch 539, loss: 0.4955, instance_loss: 0.5527, weighted_loss: 0.5127, label: 1, bag_size: 6156
batch 559, loss: 0.0237, instance_loss: 0.0703, weighted_loss: 0.0377, label: 2, bag_size: 4856
batch 579, loss: 0.4153, instance_loss: 0.7253, weighted_loss: 0.5083, label: 2, bag_size: 724
batch 599, loss: 0.0748, instance_loss: 0.2577, weighted_loss: 0.1297, label: 2, bag_size: 4140
batch 619, loss: 0.9926, instance_loss: 1.0639, weighted_loss: 1.0140, label: 1, bag_size: 3821
batch 639, loss: 1.5569, instance_loss: 0.9430, weighted_loss: 1.3728, label: 1, bag_size: 1307
batch 659, loss: 0.0158, instance_loss: 0.0745, weighted_loss: 0.0334, label: 0, bag_size: 3304
batch 679, loss: 1.9123, instance_loss: 1.0787, weighted_loss: 1.6622, label: 0, bag_size: 7315
batch 699, loss: 0.9593, instance_loss: 0.5621, weighted_loss: 0.8402, label: 0, bag_size: 3525
batch 719, loss: 1.0762, instance_loss: 0.4739, weighted_loss: 0.8955, label: 2, bag_size: 597
batch 739, loss: 0.0754, instance_loss: 0.3448, weighted_loss: 0.1562, label: 0, bag_size: 4760


class 0 clustering acc 0.970413870246085: correct 17351/17880
class 1 clustering acc 0.4001677852348993: correct 2385/5960
Epoch: 36, train_loss: 0.5204, train_clustering_loss:  0.5219, train_error: 0.2215
class 0: acc 0.7932489451476793, correct 188/237
class 1: acc 0.688, correct 172/250
class 2: acc 0.8527131782945736, correct 220/258

Val Set, val_loss: 1.0589, val_error: 0.3511, auc: 0.8447
class 0 clustering acc 0.9534574468085106: correct 2151/2256
class 1 clustering acc 0.2473404255319149: correct 186/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.2073, instance_loss: 0.6653, weighted_loss: 1.0447, label: 1, bag_size: 6942
batch 39, loss: 0.5906, instance_loss: 0.4740, weighted_loss: 0.5556, label: 1, bag_size: 1029
batch 59, loss: 0.5677, instance_loss: 0.4965, weighted_loss: 0.5463, label: 0, bag_size: 13540
batch 79, loss: 0.3571, instance_loss: 0.4792, weighted_loss: 0.3938, label: 2, bag_size: 6298
batch 99, loss: 1.3742, instance_loss: 0.8918, weighted_loss: 1.2294, label: 1, bag_size: 4694
batch 119, loss: 0.2505, instance_loss: 0.4370, weighted_loss: 0.3064, label: 2, bag_size: 6644
batch 139, loss: 1.9653, instance_loss: 0.7996, weighted_loss: 1.6156, label: 2, bag_size: 552
batch 159, loss: 2.1783, instance_loss: 1.0079, weighted_loss: 1.8272, label: 1, bag_size: 3106
batch 179, loss: 0.4934, instance_loss: 0.5335, weighted_loss: 0.5055, label: 0, bag_size: 4865
batch 199, loss: 0.0416, instance_loss: 0.1857, weighted_loss: 0.0848, label: 0, bag_size: 3533
batch 219, loss: 0.2000, instance_loss: 0.2461, weighted_loss: 0.2138, label: 0, bag_size: 2069
batch 239, loss: 0.0681, instance_loss: 0.2734, weighted_loss: 0.1297, label: 0, bag_size: 4282
batch 259, loss: 0.1851, instance_loss: 0.6882, weighted_loss: 0.3360, label: 1, bag_size: 4898
batch 279, loss: 0.6682, instance_loss: 0.5024, weighted_loss: 0.6184, label: 2, bag_size: 552
batch 299, loss: 0.0425, instance_loss: 0.0692, weighted_loss: 0.0505, label: 2, bag_size: 2254
batch 319, loss: 0.0511, instance_loss: 0.0807, weighted_loss: 0.0600, label: 2, bag_size: 3415
batch 339, loss: 0.4919, instance_loss: 0.3570, weighted_loss: 0.4515, label: 2, bag_size: 4096
batch 359, loss: 0.0170, instance_loss: 0.8737, weighted_loss: 0.2741, label: 0, bag_size: 3872
batch 379, loss: 0.0012, instance_loss: 0.2983, weighted_loss: 0.0903, label: 0, bag_size: 6182
batch 399, loss: 0.0420, instance_loss: 0.1887, weighted_loss: 0.0861, label: 0, bag_size: 2286
batch 419, loss: 0.2974, instance_loss: 0.2515, weighted_loss: 0.2836, label: 2, bag_size: 4788
batch 439, loss: 0.0497, instance_loss: 0.2223, weighted_loss: 0.1015, label: 2, bag_size: 4497
batch 459, loss: 0.0596, instance_loss: 0.2212, weighted_loss: 0.1081, label: 0, bag_size: 3864
batch 479, loss: 0.0164, instance_loss: 0.2389, weighted_loss: 0.0832, label: 0, bag_size: 3924
batch 499, loss: 0.0822, instance_loss: 0.3083, weighted_loss: 0.1500, label: 2, bag_size: 4497
batch 519, loss: 0.0269, instance_loss: 0.3841, weighted_loss: 0.1340, label: 0, bag_size: 4403
batch 539, loss: 0.1582, instance_loss: 0.3087, weighted_loss: 0.2034, label: 0, bag_size: 4997
batch 559, loss: 0.8671, instance_loss: 1.0386, weighted_loss: 0.9185, label: 1, bag_size: 3813
batch 579, loss: 0.0762, instance_loss: 0.3008, weighted_loss: 0.1436, label: 2, bag_size: 4497
batch 599, loss: 1.1202, instance_loss: 1.0686, weighted_loss: 1.1047, label: 0, bag_size: 2189
batch 619, loss: 0.0294, instance_loss: 0.0550, weighted_loss: 0.0371, label: 2, bag_size: 4569
batch 639, loss: 0.1861, instance_loss: 0.4907, weighted_loss: 0.2775, label: 1, bag_size: 1042
batch 659, loss: 1.0148, instance_loss: 0.7226, weighted_loss: 0.9272, label: 2, bag_size: 4241
batch 679, loss: 0.2940, instance_loss: 0.2489, weighted_loss: 0.2805, label: 0, bag_size: 3886
batch 699, loss: 0.9864, instance_loss: 0.8399, weighted_loss: 0.9425, label: 1, bag_size: 1860
batch 719, loss: 0.0235, instance_loss: 0.2315, weighted_loss: 0.0859, label: 0, bag_size: 5893
batch 739, loss: 0.3813, instance_loss: 0.3384, weighted_loss: 0.3684, label: 2, bag_size: 4096


class 0 clustering acc 0.9670022371364653: correct 17290/17880
class 1 clustering acc 0.4231543624161074: correct 2522/5960
Epoch: 37, train_loss: 0.5109, train_clustering_loss:  0.5196, train_error: 0.2295
class 0: acc 0.8255813953488372, correct 213/258
class 1: acc 0.6233183856502242, correct 139/223
class 2: acc 0.8409090909090909, correct 222/264

Val Set, val_loss: 0.9022, val_error: 0.2872, auc: 0.8706
class 0 clustering acc 0.9703014184397163: correct 2189/2256
class 1 clustering acc 0.4109042553191489: correct 309/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.8182, instance_loss: 0.7824, weighted_loss: 0.8074, label: 2, bag_size: 1513
batch 39, loss: 2.4707, instance_loss: 1.3860, weighted_loss: 2.1453, label: 1, bag_size: 1670
batch 59, loss: 0.2931, instance_loss: 0.5393, weighted_loss: 0.3669, label: 2, bag_size: 3618
batch 79, loss: 0.0176, instance_loss: 0.3042, weighted_loss: 0.1036, label: 0, bag_size: 5646
batch 99, loss: 0.2144, instance_loss: 0.5771, weighted_loss: 0.3232, label: 2, bag_size: 4316
batch 119, loss: 0.0003, instance_loss: 0.2391, weighted_loss: 0.0719, label: 2, bag_size: 3607
batch 139, loss: 0.4616, instance_loss: 0.4027, weighted_loss: 0.4439, label: 2, bag_size: 4535
batch 159, loss: 0.0184, instance_loss: 0.5122, weighted_loss: 0.1665, label: 1, bag_size: 3127
batch 179, loss: 0.4759, instance_loss: 0.5814, weighted_loss: 0.5076, label: 2, bag_size: 2813
batch 199, loss: 0.1726, instance_loss: 0.4742, weighted_loss: 0.2631, label: 1, bag_size: 3333
batch 219, loss: 2.6375, instance_loss: 1.7043, weighted_loss: 2.3576, label: 0, bag_size: 3750
batch 239, loss: 0.0958, instance_loss: 0.5450, weighted_loss: 0.2306, label: 1, bag_size: 3221
batch 259, loss: 0.1680, instance_loss: 0.5491, weighted_loss: 0.2824, label: 1, bag_size: 4869
batch 279, loss: 2.1354, instance_loss: 1.1337, weighted_loss: 1.8349, label: 0, bag_size: 5330
batch 299, loss: 0.1508, instance_loss: 0.2341, weighted_loss: 0.1758, label: 2, bag_size: 6704
batch 319, loss: 0.1383, instance_loss: 0.3347, weighted_loss: 0.1972, label: 2, bag_size: 5011
batch 339, loss: 0.1766, instance_loss: 0.4087, weighted_loss: 0.2463, label: 2, bag_size: 3618
batch 359, loss: 0.1086, instance_loss: 0.3288, weighted_loss: 0.1746, label: 0, bag_size: 3038
batch 379, loss: 0.0848, instance_loss: 0.3354, weighted_loss: 0.1600, label: 1, bag_size: 8802
batch 399, loss: 0.5668, instance_loss: 0.4107, weighted_loss: 0.5199, label: 0, bag_size: 13770
batch 419, loss: 0.2353, instance_loss: 0.1420, weighted_loss: 0.2073, label: 2, bag_size: 4056
batch 439, loss: 0.0002, instance_loss: 0.1382, weighted_loss: 0.0416, label: 1, bag_size: 3338
batch 459, loss: 0.5099, instance_loss: 0.2546, weighted_loss: 0.4333, label: 2, bag_size: 597
batch 479, loss: 0.0000, instance_loss: 0.1760, weighted_loss: 0.0528, label: 2, bag_size: 5017
batch 499, loss: 0.1870, instance_loss: 0.1757, weighted_loss: 0.1836, label: 2, bag_size: 2997
batch 519, loss: 0.0002, instance_loss: 0.1576, weighted_loss: 0.0474, label: 1, bag_size: 3425
batch 539, loss: 0.0660, instance_loss: 0.2301, weighted_loss: 0.1153, label: 2, bag_size: 614
batch 559, loss: 0.1351, instance_loss: 0.5394, weighted_loss: 0.2564, label: 1, bag_size: 6992
batch 579, loss: 0.5154, instance_loss: 0.7410, weighted_loss: 0.5831, label: 1, bag_size: 11974
batch 599, loss: 0.4708, instance_loss: 0.5799, weighted_loss: 0.5035, label: 2, bag_size: 3778
batch 619, loss: 0.7497, instance_loss: 0.3966, weighted_loss: 0.6438, label: 0, bag_size: 4245
batch 639, loss: 0.0055, instance_loss: 0.4028, weighted_loss: 0.1247, label: 1, bag_size: 1595
batch 659, loss: 0.0192, instance_loss: 0.6231, weighted_loss: 0.2004, label: 1, bag_size: 2013
batch 679, loss: 0.0103, instance_loss: 0.0926, weighted_loss: 0.0350, label: 0, bag_size: 4196
batch 699, loss: 0.1390, instance_loss: 0.3244, weighted_loss: 0.1946, label: 2, bag_size: 2209
batch 719, loss: 1.4623, instance_loss: 0.9109, weighted_loss: 1.2969, label: 1, bag_size: 296
batch 739, loss: 1.0506, instance_loss: 0.7563, weighted_loss: 0.9623, label: 0, bag_size: 8611


class 0 clustering acc 0.9642617449664429: correct 17241/17880
class 1 clustering acc 0.4028523489932886: correct 2401/5960
Epoch: 38, train_loss: 0.5353, train_clustering_loss:  0.5369, train_error: 0.2215
class 0: acc 0.7916666666666666, correct 190/240
class 1: acc 0.6972111553784861, correct 175/251
class 2: acc 0.8464566929133859, correct 215/254

Val Set, val_loss: 1.1101, val_error: 0.3723, auc: 0.8452
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.3390957446808511: correct 255/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.5962, instance_loss: 0.6790, weighted_loss: 0.6210, label: 2, bag_size: 4535
batch 39, loss: 0.0035, instance_loss: 0.0989, weighted_loss: 0.0321, label: 0, bag_size: 5006
batch 59, loss: 1.0978, instance_loss: 0.8493, weighted_loss: 1.0233, label: 2, bag_size: 223
batch 79, loss: 0.6578, instance_loss: 0.5811, weighted_loss: 0.6348, label: 0, bag_size: 640
batch 99, loss: 0.1778, instance_loss: 0.3177, weighted_loss: 0.2198, label: 1, bag_size: 796
batch 119, loss: 0.5075, instance_loss: 0.6360, weighted_loss: 0.5461, label: 2, bag_size: 22464
batch 139, loss: 0.2541, instance_loss: 0.3930, weighted_loss: 0.2958, label: 1, bag_size: 3322
batch 159, loss: 0.2346, instance_loss: 0.4239, weighted_loss: 0.2914, label: 0, bag_size: 3886
batch 179, loss: 0.1645, instance_loss: 0.3344, weighted_loss: 0.2155, label: 2, bag_size: 3327
batch 199, loss: 0.8526, instance_loss: 0.5283, weighted_loss: 0.7553, label: 2, bag_size: 909
batch 219, loss: 0.8704, instance_loss: 0.8879, weighted_loss: 0.8756, label: 1, bag_size: 4069
batch 239, loss: 1.1239, instance_loss: 0.9652, weighted_loss: 1.0763, label: 1, bag_size: 3322
batch 259, loss: 0.1303, instance_loss: 0.2298, weighted_loss: 0.1602, label: 2, bag_size: 2422
batch 279, loss: 0.0809, instance_loss: 0.3036, weighted_loss: 0.1477, label: 0, bag_size: 4405
batch 299, loss: 0.5818, instance_loss: 0.7434, weighted_loss: 0.6303, label: 1, bag_size: 4184
batch 319, loss: 0.1236, instance_loss: 0.6937, weighted_loss: 0.2946, label: 1, bag_size: 4869
batch 339, loss: 0.2527, instance_loss: 0.6618, weighted_loss: 0.3754, label: 0, bag_size: 3601
batch 359, loss: 1.4375, instance_loss: 1.1308, weighted_loss: 1.3455, label: 1, bag_size: 1670
batch 379, loss: 0.0147, instance_loss: 0.4764, weighted_loss: 0.1532, label: 1, bag_size: 3172
batch 399, loss: 0.0096, instance_loss: 0.1921, weighted_loss: 0.0644, label: 0, bag_size: 2825
batch 419, loss: 0.0861, instance_loss: 0.4637, weighted_loss: 0.1994, label: 0, bag_size: 2286
batch 439, loss: 0.3062, instance_loss: 0.9052, weighted_loss: 0.4859, label: 1, bag_size: 3475
batch 459, loss: 0.7091, instance_loss: 0.6100, weighted_loss: 0.6794, label: 1, bag_size: 3604
batch 479, loss: 0.0490, instance_loss: 0.2790, weighted_loss: 0.1180, label: 0, bag_size: 3924
batch 499, loss: 0.6779, instance_loss: 0.7910, weighted_loss: 0.7119, label: 1, bag_size: 1066
batch 519, loss: 0.0588, instance_loss: 0.3311, weighted_loss: 0.1405, label: 0, bag_size: 6971
batch 539, loss: 2.9285, instance_loss: 1.6140, weighted_loss: 2.5341, label: 0, bag_size: 436
batch 559, loss: 0.0685, instance_loss: 0.1636, weighted_loss: 0.0970, label: 0, bag_size: 6015
batch 579, loss: 0.1077, instance_loss: 0.0787, weighted_loss: 0.0990, label: 2, bag_size: 88
batch 599, loss: 0.1439, instance_loss: 0.3859, weighted_loss: 0.2165, label: 1, bag_size: 5696
batch 619, loss: 0.0707, instance_loss: 0.1561, weighted_loss: 0.0963, label: 2, bag_size: 6704
batch 639, loss: 0.0525, instance_loss: 0.1090, weighted_loss: 0.0695, label: 2, bag_size: 3094
batch 659, loss: 0.1913, instance_loss: 0.3905, weighted_loss: 0.2510, label: 0, bag_size: 609
batch 679, loss: 0.1983, instance_loss: 0.3105, weighted_loss: 0.2320, label: 0, bag_size: 4604
batch 699, loss: 0.0933, instance_loss: 0.1852, weighted_loss: 0.1209, label: 2, bag_size: 4555
batch 719, loss: 0.7366, instance_loss: 0.5253, weighted_loss: 0.6732, label: 2, bag_size: 909
batch 739, loss: 0.0832, instance_loss: 0.2035, weighted_loss: 0.1193, label: 2, bag_size: 4096


class 0 clustering acc 0.9675615212527964: correct 17300/17880
class 1 clustering acc 0.41711409395973154: correct 2486/5960
Epoch: 39, train_loss: 0.5288, train_clustering_loss:  0.5296, train_error: 0.2174
class 0: acc 0.8203125, correct 210/256
class 1: acc 0.6621004566210046, correct 145/219
class 2: acc 0.8444444444444444, correct 228/270

Val Set, val_loss: 1.1112, val_error: 0.3936, auc: 0.8436
class 0 clustering acc 0.9530141843971631: correct 2150/2256
class 1 clustering acc 0.16622340425531915: correct 125/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.5, correct 15/30
class 2: acc 1.0, correct 12/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0601, instance_loss: 0.4590, weighted_loss: 0.1798, label: 0, bag_size: 6138
batch 39, loss: 0.5150, instance_loss: 0.2600, weighted_loss: 0.4385, label: 0, bag_size: 5041
batch 59, loss: 0.3522, instance_loss: 0.3560, weighted_loss: 0.3533, label: 0, bag_size: 6223
batch 79, loss: 0.0291, instance_loss: 0.1316, weighted_loss: 0.0598, label: 0, bag_size: 3816
batch 99, loss: 0.0650, instance_loss: 0.2832, weighted_loss: 0.1304, label: 2, bag_size: 2254
batch 119, loss: 0.0369, instance_loss: 0.2043, weighted_loss: 0.0871, label: 2, bag_size: 5138
batch 139, loss: 0.3167, instance_loss: 0.4724, weighted_loss: 0.3634, label: 2, bag_size: 3210
batch 159, loss: 0.1455, instance_loss: 0.2153, weighted_loss: 0.1665, label: 0, bag_size: 4092
batch 179, loss: 3.9516, instance_loss: 1.0662, weighted_loss: 3.0860, label: 0, bag_size: 5098
batch 199, loss: 0.0000, instance_loss: 0.2522, weighted_loss: 0.0756, label: 0, bag_size: 4083
batch 219, loss: 0.0135, instance_loss: 0.1722, weighted_loss: 0.0611, label: 0, bag_size: 855
batch 239, loss: 0.0008, instance_loss: 0.1564, weighted_loss: 0.0475, label: 2, bag_size: 5037
batch 259, loss: 0.0002, instance_loss: 0.2849, weighted_loss: 0.0856, label: 0, bag_size: 6182
batch 279, loss: 1.5050, instance_loss: 1.0388, weighted_loss: 1.3651, label: 1, bag_size: 4145
batch 299, loss: 0.9099, instance_loss: 0.8477, weighted_loss: 0.8913, label: 1, bag_size: 4869
batch 319, loss: 0.1203, instance_loss: 0.2144, weighted_loss: 0.1485, label: 2, bag_size: 6644
batch 339, loss: 0.0554, instance_loss: 0.4458, weighted_loss: 0.1725, label: 1, bag_size: 7135
batch 359, loss: 0.0192, instance_loss: 0.1087, weighted_loss: 0.0461, label: 1, bag_size: 425
batch 379, loss: 1.3647, instance_loss: 0.8652, weighted_loss: 1.2149, label: 2, bag_size: 4179
batch 399, loss: 0.0564, instance_loss: 0.1775, weighted_loss: 0.0928, label: 2, bag_size: 3176
batch 419, loss: 0.0215, instance_loss: 0.0961, weighted_loss: 0.0439, label: 2, bag_size: 3094
batch 439, loss: 1.6645, instance_loss: 0.6560, weighted_loss: 1.3619, label: 2, bag_size: 3112
batch 459, loss: 0.0121, instance_loss: 0.0655, weighted_loss: 0.0281, label: 0, bag_size: 1845
batch 479, loss: 0.1449, instance_loss: 0.3032, weighted_loss: 0.1924, label: 0, bag_size: 5260
batch 499, loss: 0.6343, instance_loss: 0.5991, weighted_loss: 0.6238, label: 2, bag_size: 1543
batch 519, loss: 0.1503, instance_loss: 0.4662, weighted_loss: 0.2451, label: 0, bag_size: 921
batch 539, loss: 1.4330, instance_loss: 0.9853, weighted_loss: 1.2987, label: 1, bag_size: 5512
batch 559, loss: 1.2376, instance_loss: 0.8295, weighted_loss: 1.1151, label: 1, bag_size: 11768
batch 579, loss: 0.3353, instance_loss: 0.5335, weighted_loss: 0.3948, label: 2, bag_size: 22464
batch 599, loss: 0.3865, instance_loss: 0.4570, weighted_loss: 0.4077, label: 1, bag_size: 782
batch 619, loss: 0.2887, instance_loss: 0.6112, weighted_loss: 0.3854, label: 0, bag_size: 2830
batch 639, loss: 0.0928, instance_loss: 0.2869, weighted_loss: 0.1511, label: 0, bag_size: 5953
batch 659, loss: 0.0088, instance_loss: 0.2081, weighted_loss: 0.0686, label: 1, bag_size: 4290
batch 679, loss: 1.5942, instance_loss: 0.8501, weighted_loss: 1.3709, label: 1, bag_size: 4708
batch 699, loss: 2.0347, instance_loss: 1.0998, weighted_loss: 1.7542, label: 1, bag_size: 3322
batch 719, loss: 0.0450, instance_loss: 0.0677, weighted_loss: 0.0518, label: 2, bag_size: 3210
batch 739, loss: 0.0586, instance_loss: 0.1884, weighted_loss: 0.0975, label: 1, bag_size: 862


class 0 clustering acc 0.9669463087248322: correct 17289/17880
class 1 clustering acc 0.44412751677852347: correct 2647/5960
Epoch: 40, train_loss: 0.5198, train_clustering_loss:  0.5113, train_error: 0.2067
class 0: acc 0.8443579766536965, correct 217/257
class 1: acc 0.6724890829694323, correct 154/229
class 2: acc 0.8494208494208494, correct 220/259

Val Set, val_loss: 0.9249, val_error: 0.3511, auc: 0.8460
class 0 clustering acc 0.9463652482269503: correct 2135/2256
class 1 clustering acc 0.4321808510638298: correct 325/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.26666666666666666, correct 8/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3649, instance_loss: 0.5049, weighted_loss: 0.4069, label: 2, bag_size: 4241
batch 39, loss: 0.3069, instance_loss: 0.3205, weighted_loss: 0.3110, label: 0, bag_size: 2428
batch 59, loss: 0.0401, instance_loss: 0.0801, weighted_loss: 0.0521, label: 2, bag_size: 6273
batch 79, loss: 0.8605, instance_loss: 0.5155, weighted_loss: 0.7570, label: 2, bag_size: 2326
batch 99, loss: 0.0948, instance_loss: 0.1411, weighted_loss: 0.1087, label: 1, bag_size: 862
batch 119, loss: 0.0697, instance_loss: 0.2626, weighted_loss: 0.1276, label: 0, bag_size: 3924
batch 139, loss: 2.7679, instance_loss: 1.5988, weighted_loss: 2.4172, label: 1, bag_size: 1670
batch 159, loss: 0.3324, instance_loss: 0.3234, weighted_loss: 0.3297, label: 2, bag_size: 4096
batch 179, loss: 0.3667, instance_loss: 0.4558, weighted_loss: 0.3934, label: 2, bag_size: 614
batch 199, loss: 0.0519, instance_loss: 0.1256, weighted_loss: 0.0740, label: 0, bag_size: 3319
batch 219, loss: 1.8889, instance_loss: 1.0805, weighted_loss: 1.6464, label: 1, bag_size: 3837
batch 239, loss: 0.6556, instance_loss: 0.3799, weighted_loss: 0.5729, label: 2, bag_size: 4241
batch 259, loss: 0.0529, instance_loss: 0.1449, weighted_loss: 0.0805, label: 0, bag_size: 3304
batch 279, loss: 0.0762, instance_loss: 0.4031, weighted_loss: 0.1743, label: 0, bag_size: 420
batch 299, loss: 0.0798, instance_loss: 0.2809, weighted_loss: 0.1401, label: 0, bag_size: 3754
batch 319, loss: 0.0143, instance_loss: 0.1708, weighted_loss: 0.0612, label: 0, bag_size: 3641
batch 339, loss: 0.0075, instance_loss: 0.1192, weighted_loss: 0.0410, label: 0, bag_size: 5899
batch 359, loss: 0.2577, instance_loss: 0.2834, weighted_loss: 0.2654, label: 2, bag_size: 4978
batch 379, loss: 0.0508, instance_loss: 0.2591, weighted_loss: 0.1133, label: 2, bag_size: 4140
batch 399, loss: 0.2285, instance_loss: 0.2209, weighted_loss: 0.2262, label: 2, bag_size: 597
batch 419, loss: 0.4838, instance_loss: 0.6122, weighted_loss: 0.5223, label: 2, bag_size: 5406
batch 439, loss: 0.3167, instance_loss: 0.6223, weighted_loss: 0.4084, label: 0, bag_size: 2853
batch 459, loss: 0.0690, instance_loss: 0.4551, weighted_loss: 0.1848, label: 0, bag_size: 1417
batch 479, loss: 1.7012, instance_loss: 0.7592, weighted_loss: 1.4186, label: 1, bag_size: 1860
batch 499, loss: 0.1281, instance_loss: 0.2196, weighted_loss: 0.1555, label: 2, bag_size: 4555
batch 519, loss: 2.2504, instance_loss: 1.2952, weighted_loss: 1.9638, label: 2, bag_size: 4316
batch 539, loss: 0.3326, instance_loss: 0.4670, weighted_loss: 0.3729, label: 0, bag_size: 3834
batch 559, loss: 0.3634, instance_loss: 0.5461, weighted_loss: 0.4182, label: 2, bag_size: 4535
batch 579, loss: 0.0001, instance_loss: 0.0982, weighted_loss: 0.0295, label: 2, bag_size: 5037
batch 599, loss: 0.0063, instance_loss: 0.1330, weighted_loss: 0.0443, label: 1, bag_size: 5364
batch 619, loss: 0.0153, instance_loss: 0.0953, weighted_loss: 0.0393, label: 2, bag_size: 6148
batch 639, loss: 2.2305, instance_loss: 1.6459, weighted_loss: 2.0551, label: 1, bag_size: 2229
batch 659, loss: 0.2939, instance_loss: 0.4815, weighted_loss: 0.3502, label: 0, bag_size: 622
batch 679, loss: 0.1760, instance_loss: 0.4790, weighted_loss: 0.2669, label: 2, bag_size: 5637
batch 699, loss: 0.1820, instance_loss: 0.4381, weighted_loss: 0.2588, label: 0, bag_size: 5632
batch 719, loss: 0.0580, instance_loss: 0.3786, weighted_loss: 0.1542, label: 0, bag_size: 4721
batch 739, loss: 0.3130, instance_loss: 0.6311, weighted_loss: 0.4084, label: 2, bag_size: 5406


class 0 clustering acc 0.9631991051454138: correct 17222/17880
class 1 clustering acc 0.45151006711409397: correct 2691/5960
Epoch: 41, train_loss: 0.4690, train_clustering_loss:  0.5008, train_error: 0.1933
class 0: acc 0.8181818181818182, correct 189/231
class 1: acc 0.6711111111111111, correct 151/225
class 2: acc 0.903114186851211, correct 261/289

Val Set, val_loss: 1.0484, val_error: 0.4149, auc: 0.8125
class 0 clustering acc 0.9583333333333334: correct 2162/2256
class 1 clustering acc 0.22872340425531915: correct 172/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.9603, instance_loss: 0.8652, weighted_loss: 0.9318, label: 2, bag_size: 361
batch 39, loss: 0.6521, instance_loss: 0.4691, weighted_loss: 0.5972, label: 0, bag_size: 4201
batch 59, loss: 0.0617, instance_loss: 0.3205, weighted_loss: 0.1393, label: 0, bag_size: 4914
batch 79, loss: 0.0940, instance_loss: 0.1407, weighted_loss: 0.1080, label: 2, bag_size: 88
batch 99, loss: 0.6414, instance_loss: 0.6398, weighted_loss: 0.6409, label: 1, bag_size: 1528
batch 119, loss: 1.6635, instance_loss: 0.9435, weighted_loss: 1.4475, label: 0, bag_size: 4572
batch 139, loss: 2.7228, instance_loss: 1.1339, weighted_loss: 2.2462, label: 0, bag_size: 3387
batch 159, loss: 0.1133, instance_loss: 0.2588, weighted_loss: 0.1569, label: 2, bag_size: 5924
batch 179, loss: 0.0072, instance_loss: 0.1034, weighted_loss: 0.0360, label: 0, bag_size: 1034
batch 199, loss: 0.3612, instance_loss: 0.6444, weighted_loss: 0.4462, label: 2, bag_size: 4910
batch 219, loss: 0.0841, instance_loss: 0.4770, weighted_loss: 0.2020, label: 0, bag_size: 4165
batch 239, loss: 0.0233, instance_loss: 0.3129, weighted_loss: 0.1102, label: 1, bag_size: 3755
batch 259, loss: 0.1475, instance_loss: 0.4185, weighted_loss: 0.2288, label: 1, bag_size: 3322
batch 279, loss: 0.5467, instance_loss: 0.4412, weighted_loss: 0.5150, label: 0, bag_size: 5526
batch 299, loss: 0.0001, instance_loss: 0.0050, weighted_loss: 0.0016, label: 1, bag_size: 460
batch 319, loss: 0.6613, instance_loss: 0.7815, weighted_loss: 0.6974, label: 1, bag_size: 11768
batch 339, loss: 0.0001, instance_loss: 0.1990, weighted_loss: 0.0598, label: 2, bag_size: 4141
batch 359, loss: 0.1787, instance_loss: 0.4194, weighted_loss: 0.2509, label: 1, bag_size: 4373
batch 379, loss: 0.0981, instance_loss: 0.2559, weighted_loss: 0.1454, label: 0, bag_size: 3915
batch 399, loss: 0.3362, instance_loss: 0.4740, weighted_loss: 0.3775, label: 1, bag_size: 4262
batch 419, loss: 0.0103, instance_loss: 0.5144, weighted_loss: 0.1616, label: 1, bag_size: 5003
batch 439, loss: 0.0029, instance_loss: 0.5247, weighted_loss: 0.1594, label: 1, bag_size: 6717
batch 459, loss: 0.0572, instance_loss: 0.2113, weighted_loss: 0.1034, label: 0, bag_size: 1174
batch 479, loss: 0.4372, instance_loss: 0.7247, weighted_loss: 0.5235, label: 0, bag_size: 3743
batch 499, loss: 1.1820, instance_loss: 1.5974, weighted_loss: 1.3066, label: 0, bag_size: 3155
batch 519, loss: 0.0370, instance_loss: 0.0676, weighted_loss: 0.0461, label: 2, bag_size: 4302
batch 539, loss: 0.0034, instance_loss: 0.1209, weighted_loss: 0.0387, label: 0, bag_size: 5459
batch 559, loss: 0.0021, instance_loss: 0.1679, weighted_loss: 0.0519, label: 1, bag_size: 5026
batch 579, loss: 0.1465, instance_loss: 0.7443, weighted_loss: 0.3259, label: 2, bag_size: 3607
batch 599, loss: 0.0187, instance_loss: 0.0902, weighted_loss: 0.0402, label: 2, bag_size: 6026
batch 619, loss: 0.1433, instance_loss: 0.4661, weighted_loss: 0.2402, label: 1, bag_size: 1027
batch 639, loss: 4.2948, instance_loss: 1.5203, weighted_loss: 3.4625, label: 0, bag_size: 12971
batch 659, loss: 0.0933, instance_loss: 0.2373, weighted_loss: 0.1365, label: 2, bag_size: 5138
batch 679, loss: 0.0120, instance_loss: 0.5364, weighted_loss: 0.1693, label: 0, bag_size: 3182
batch 699, loss: 0.0432, instance_loss: 0.2464, weighted_loss: 0.1042, label: 2, bag_size: 2422
batch 719, loss: 0.0217, instance_loss: 0.1411, weighted_loss: 0.0575, label: 1, bag_size: 425
batch 739, loss: 0.4104, instance_loss: 0.3726, weighted_loss: 0.3991, label: 1, bag_size: 210


class 0 clustering acc 0.9657718120805369: correct 17268/17880
class 1 clustering acc 0.4181208053691275: correct 2492/5960
Epoch: 42, train_loss: 0.5027, train_clustering_loss:  0.5226, train_error: 0.2134
class 0: acc 0.7927927927927928, correct 176/222
class 1: acc 0.7452471482889734, correct 196/263
class 2: acc 0.823076923076923, correct 214/260

Val Set, val_loss: 0.9036, val_error: 0.3298, auc: 0.8568
class 0 clustering acc 0.9720744680851063: correct 2193/2256
class 1 clustering acc 0.3351063829787234: correct 252/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.4255, instance_loss: 0.3710, weighted_loss: 0.4092, label: 1, bag_size: 368
batch 39, loss: 1.7846, instance_loss: 0.8487, weighted_loss: 1.5039, label: 2, bag_size: 552
batch 59, loss: 0.0319, instance_loss: 0.0944, weighted_loss: 0.0506, label: 2, bag_size: 4745
batch 79, loss: 0.0264, instance_loss: 0.2017, weighted_loss: 0.0790, label: 0, bag_size: 471
batch 99, loss: 0.0845, instance_loss: 0.2730, weighted_loss: 0.1411, label: 0, bag_size: 3368
batch 119, loss: 0.0404, instance_loss: 0.1051, weighted_loss: 0.0598, label: 2, bag_size: 6148
batch 139, loss: 2.5123, instance_loss: 1.1393, weighted_loss: 2.1004, label: 0, bag_size: 1774
batch 159, loss: 0.7396, instance_loss: 0.8169, weighted_loss: 0.7628, label: 1, bag_size: 2472
batch 179, loss: 0.8864, instance_loss: 0.7011, weighted_loss: 0.8308, label: 1, bag_size: 4438
batch 199, loss: 0.1040, instance_loss: 0.2585, weighted_loss: 0.1504, label: 2, bag_size: 3174
batch 219, loss: 0.0199, instance_loss: 0.3093, weighted_loss: 0.1068, label: 0, bag_size: 2607
batch 239, loss: 0.3020, instance_loss: 0.4619, weighted_loss: 0.3500, label: 0, bag_size: 272
batch 259, loss: 0.3303, instance_loss: 0.3019, weighted_loss: 0.3218, label: 2, bag_size: 3534
batch 279, loss: 0.6983, instance_loss: 0.7781, weighted_loss: 0.7223, label: 1, bag_size: 3396
batch 299, loss: 0.0670, instance_loss: 0.2583, weighted_loss: 0.1244, label: 0, bag_size: 2479
batch 319, loss: 0.3478, instance_loss: 0.3530, weighted_loss: 0.3494, label: 2, bag_size: 4096
batch 339, loss: 2.7245, instance_loss: 1.1207, weighted_loss: 2.2434, label: 0, bag_size: 3419
batch 359, loss: 0.2252, instance_loss: 0.4728, weighted_loss: 0.2995, label: 2, bag_size: 3618
batch 379, loss: 0.0346, instance_loss: 0.2395, weighted_loss: 0.0961, label: 0, bag_size: 1006
batch 399, loss: 0.0868, instance_loss: 0.5074, weighted_loss: 0.2130, label: 1, bag_size: 683
batch 419, loss: 0.0116, instance_loss: 0.0586, weighted_loss: 0.0257, label: 2, bag_size: 3121
batch 439, loss: 0.1051, instance_loss: 0.4074, weighted_loss: 0.1958, label: 2, bag_size: 6148
batch 459, loss: 1.1842, instance_loss: 0.9813, weighted_loss: 1.1234, label: 1, bag_size: 2852
batch 479, loss: 1.6009, instance_loss: 1.2545, weighted_loss: 1.4970, label: 1, bag_size: 1670
batch 499, loss: 1.1545, instance_loss: 0.5411, weighted_loss: 0.9705, label: 2, bag_size: 5307
batch 519, loss: 0.0829, instance_loss: 0.1774, weighted_loss: 0.1112, label: 2, bag_size: 3174
batch 539, loss: 0.0000, instance_loss: 0.3304, weighted_loss: 0.0991, label: 0, bag_size: 1087
batch 559, loss: 0.0391, instance_loss: 0.1481, weighted_loss: 0.0718, label: 2, bag_size: 4569
batch 579, loss: 2.5469, instance_loss: 1.4418, weighted_loss: 2.2154, label: 2, bag_size: 3475
batch 599, loss: 0.4460, instance_loss: 0.6531, weighted_loss: 0.5081, label: 1, bag_size: 1528
batch 619, loss: 0.0044, instance_loss: 0.1705, weighted_loss: 0.0543, label: 1, bag_size: 1836
batch 639, loss: 0.0243, instance_loss: 0.2155, weighted_loss: 0.0817, label: 1, bag_size: 4578
batch 659, loss: 1.2496, instance_loss: 0.8471, weighted_loss: 1.1288, label: 1, bag_size: 3823
batch 679, loss: 0.0000, instance_loss: 0.1209, weighted_loss: 0.0363, label: 0, bag_size: 4582
batch 699, loss: 0.0000, instance_loss: 0.4407, weighted_loss: 0.1322, label: 0, bag_size: 2306
batch 719, loss: 0.1175, instance_loss: 0.2569, weighted_loss: 0.1594, label: 0, bag_size: 7315
batch 739, loss: 2.9968, instance_loss: 1.2638, weighted_loss: 2.4769, label: 2, bag_size: 223


class 0 clustering acc 0.9661633109619687: correct 17275/17880
class 1 clustering acc 0.45100671140939597: correct 2688/5960
Epoch: 43, train_loss: 0.4777, train_clustering_loss:  0.5047, train_error: 0.1933
class 0: acc 0.8244897959183674, correct 202/245
class 1: acc 0.7346938775510204, correct 180/245
class 2: acc 0.8588235294117647, correct 219/255

Val Set, val_loss: 0.7838, val_error: 0.3085, auc: 0.8487
class 0 clustering acc 0.9676418439716312: correct 2183/2256
class 1 clustering acc 0.4428191489361702: correct 333/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0666, instance_loss: 0.3827, weighted_loss: 0.1614, label: 1, bag_size: 7279
batch 39, loss: 0.0283, instance_loss: 0.0683, weighted_loss: 0.0403, label: 2, bag_size: 2483
batch 59, loss: 0.5260, instance_loss: 0.8768, weighted_loss: 0.6312, label: 1, bag_size: 3823
batch 79, loss: 0.3861, instance_loss: 0.4925, weighted_loss: 0.4180, label: 0, bag_size: 4378
batch 99, loss: 0.1531, instance_loss: 0.7124, weighted_loss: 0.3209, label: 2, bag_size: 3299
batch 119, loss: 0.9914, instance_loss: 0.5401, weighted_loss: 0.8560, label: 1, bag_size: 2945
batch 139, loss: 0.2852, instance_loss: 0.6676, weighted_loss: 0.3999, label: 0, bag_size: 3904
batch 159, loss: 0.2865, instance_loss: 0.5267, weighted_loss: 0.3585, label: 2, bag_size: 2813
batch 179, loss: 0.0406, instance_loss: 0.2548, weighted_loss: 0.1049, label: 0, bag_size: 4165
batch 199, loss: 1.0928, instance_loss: 0.8981, weighted_loss: 1.0344, label: 2, bag_size: 5426
batch 219, loss: 0.3276, instance_loss: 0.3292, weighted_loss: 0.3281, label: 1, bag_size: 3755
batch 239, loss: 0.2889, instance_loss: 0.4364, weighted_loss: 0.3332, label: 0, bag_size: 5041
batch 259, loss: 1.1978, instance_loss: 0.8625, weighted_loss: 1.0972, label: 1, bag_size: 2013
batch 279, loss: 0.2046, instance_loss: 0.4161, weighted_loss: 0.2681, label: 0, bag_size: 4251
batch 299, loss: 0.3374, instance_loss: 0.5258, weighted_loss: 0.3939, label: 0, bag_size: 3571
batch 319, loss: 0.6065, instance_loss: 0.8554, weighted_loss: 0.6812, label: 1, bag_size: 2905
batch 339, loss: 0.0190, instance_loss: 0.1126, weighted_loss: 0.0471, label: 0, bag_size: 5029
batch 359, loss: 0.0032, instance_loss: 0.2405, weighted_loss: 0.0744, label: 1, bag_size: 4290
batch 379, loss: 0.1122, instance_loss: 0.2703, weighted_loss: 0.1596, label: 2, bag_size: 6273
batch 399, loss: 0.3886, instance_loss: 0.6959, weighted_loss: 0.4808, label: 1, bag_size: 2744
batch 419, loss: 0.1118, instance_loss: 0.4325, weighted_loss: 0.2080, label: 2, bag_size: 6001
batch 439, loss: 0.0070, instance_loss: 0.1305, weighted_loss: 0.0441, label: 1, bag_size: 2796
batch 459, loss: 0.1837, instance_loss: 0.5017, weighted_loss: 0.2791, label: 0, bag_size: 3368
batch 479, loss: 0.0498, instance_loss: 0.3412, weighted_loss: 0.1372, label: 1, bag_size: 4644
batch 499, loss: 0.0495, instance_loss: 0.4222, weighted_loss: 0.1613, label: 2, bag_size: 4497
batch 519, loss: 0.0119, instance_loss: 0.4375, weighted_loss: 0.1396, label: 1, bag_size: 4111
batch 539, loss: 0.0877, instance_loss: 0.1521, weighted_loss: 0.1070, label: 2, bag_size: 3497
batch 559, loss: 0.3671, instance_loss: 0.5157, weighted_loss: 0.4117, label: 1, bag_size: 6152
batch 579, loss: 0.0677, instance_loss: 0.3399, weighted_loss: 0.1494, label: 1, bag_size: 6156
batch 599, loss: 0.9924, instance_loss: 0.8162, weighted_loss: 0.9396, label: 2, bag_size: 1222
batch 619, loss: 1.1701, instance_loss: 0.6316, weighted_loss: 1.0085, label: 1, bag_size: 3813
batch 639, loss: 0.5448, instance_loss: 0.5958, weighted_loss: 0.5601, label: 1, bag_size: 5512
batch 659, loss: 0.0174, instance_loss: 0.3998, weighted_loss: 0.1321, label: 0, bag_size: 4379
batch 679, loss: 0.1867, instance_loss: 0.3924, weighted_loss: 0.2484, label: 1, bag_size: 4119
batch 699, loss: 0.1578, instance_loss: 0.3278, weighted_loss: 0.2088, label: 0, bag_size: 5036
batch 719, loss: 0.0771, instance_loss: 0.1698, weighted_loss: 0.1049, label: 0, bag_size: 3649
batch 739, loss: 0.9696, instance_loss: 0.6900, weighted_loss: 0.8858, label: 1, bag_size: 3367


class 0 clustering acc 0.9662192393736018: correct 17276/17880
class 1 clustering acc 0.37651006711409396: correct 2244/5960
Epoch: 44, train_loss: 0.5002, train_clustering_loss:  0.5429, train_error: 0.1852
class 0: acc 0.8382978723404255, correct 197/235
class 1: acc 0.7403100775193798, correct 191/258
class 2: acc 0.8690476190476191, correct 219/252

Val Set, val_loss: 0.7970, val_error: 0.3191, auc: 0.8884
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.5093085106382979: correct 383/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.9950, instance_loss: 1.6604, weighted_loss: 1.8947, label: 2, bag_size: 3299
batch 39, loss: 0.0864, instance_loss: 0.4816, weighted_loss: 0.2049, label: 1, bag_size: 3586
batch 59, loss: 0.6856, instance_loss: 0.2704, weighted_loss: 0.5610, label: 2, bag_size: 3583
batch 79, loss: 0.2055, instance_loss: 0.8403, weighted_loss: 0.3959, label: 1, bag_size: 302
batch 99, loss: 0.0223, instance_loss: 0.0613, weighted_loss: 0.0340, label: 2, bag_size: 4910
batch 119, loss: 0.0909, instance_loss: 0.2543, weighted_loss: 0.1399, label: 0, bag_size: 4827
batch 139, loss: 0.4909, instance_loss: 0.7286, weighted_loss: 0.5622, label: 0, bag_size: 2853
batch 159, loss: 0.1226, instance_loss: 0.3877, weighted_loss: 0.2021, label: 1, bag_size: 712
batch 179, loss: 0.5532, instance_loss: 0.6108, weighted_loss: 0.5705, label: 0, bag_size: 4541
batch 199, loss: 0.1824, instance_loss: 0.1118, weighted_loss: 0.1612, label: 2, bag_size: 88
batch 219, loss: 0.0680, instance_loss: 0.5193, weighted_loss: 0.2033, label: 1, bag_size: 1023
batch 239, loss: 1.2155, instance_loss: 0.6333, weighted_loss: 1.0408, label: 0, bag_size: 4228
batch 259, loss: 0.0677, instance_loss: 0.5773, weighted_loss: 0.2206, label: 1, bag_size: 5756
batch 279, loss: 0.0021, instance_loss: 0.0777, weighted_loss: 0.0248, label: 1, bag_size: 758
batch 299, loss: 0.0331, instance_loss: 0.2323, weighted_loss: 0.0929, label: 0, bag_size: 3924
batch 319, loss: 0.7124, instance_loss: 0.6183, weighted_loss: 0.6842, label: 1, bag_size: 5412
batch 339, loss: 0.1261, instance_loss: 0.8120, weighted_loss: 0.3319, label: 0, bag_size: 4808
batch 359, loss: 0.0618, instance_loss: 0.2883, weighted_loss: 0.1298, label: 1, bag_size: 1221
batch 379, loss: 1.7277, instance_loss: 1.0012, weighted_loss: 1.5097, label: 1, bag_size: 296
batch 399, loss: 0.2250, instance_loss: 0.3050, weighted_loss: 0.2490, label: 1, bag_size: 2767
batch 419, loss: 0.5085, instance_loss: 0.8482, weighted_loss: 0.6104, label: 1, bag_size: 6942
batch 439, loss: 0.0213, instance_loss: 0.3482, weighted_loss: 0.1194, label: 1, bag_size: 455
batch 459, loss: 0.1453, instance_loss: 0.2147, weighted_loss: 0.1661, label: 1, bag_size: 2878
batch 479, loss: 0.0157, instance_loss: 0.2192, weighted_loss: 0.0768, label: 1, bag_size: 4111
batch 499, loss: 0.0258, instance_loss: 0.4530, weighted_loss: 0.1539, label: 1, bag_size: 3051
batch 519, loss: 0.1120, instance_loss: 0.4059, weighted_loss: 0.2002, label: 0, bag_size: 1385
batch 539, loss: 0.1792, instance_loss: 0.3716, weighted_loss: 0.2369, label: 2, bag_size: 3746
batch 559, loss: 0.0067, instance_loss: 0.1035, weighted_loss: 0.0358, label: 0, bag_size: 6221
batch 579, loss: 0.0379, instance_loss: 0.5769, weighted_loss: 0.1996, label: 2, bag_size: 3607
batch 599, loss: 1.1796, instance_loss: 0.1715, weighted_loss: 0.8772, label: 2, bag_size: 88
batch 619, loss: 0.3368, instance_loss: 0.7434, weighted_loss: 0.4588, label: 0, bag_size: 1352
batch 639, loss: 3.3102, instance_loss: 1.7022, weighted_loss: 2.8278, label: 2, bag_size: 4179
batch 659, loss: 1.5198, instance_loss: 0.6202, weighted_loss: 1.2499, label: 0, bag_size: 5023
batch 679, loss: 0.9362, instance_loss: 0.8386, weighted_loss: 0.9070, label: 1, bag_size: 817
batch 699, loss: 0.8466, instance_loss: 0.6984, weighted_loss: 0.8021, label: 1, bag_size: 296
batch 719, loss: 0.5074, instance_loss: 0.3895, weighted_loss: 0.4721, label: 2, bag_size: 597
batch 739, loss: 0.2654, instance_loss: 0.3949, weighted_loss: 0.3043, label: 0, bag_size: 3033


class 0 clustering acc 0.9667225950782998: correct 17285/17880
class 1 clustering acc 0.41325503355704696: correct 2463/5960
Epoch: 45, train_loss: 0.4917, train_clustering_loss:  0.5185, train_error: 0.2040
class 0: acc 0.8560311284046692, correct 220/257
class 1: acc 0.6988416988416989, correct 181/259
class 2: acc 0.8384279475982532, correct 192/229

Val Set, val_loss: 0.7128, val_error: 0.2660, auc: 0.8870
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.36569148936170215: correct 275/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1800, instance_loss: 0.3963, weighted_loss: 0.2449, label: 2, bag_size: 4140
batch 39, loss: 0.0116, instance_loss: 0.2166, weighted_loss: 0.0731, label: 0, bag_size: 1233
batch 59, loss: 0.0068, instance_loss: 0.1907, weighted_loss: 0.0620, label: 0, bag_size: 2339
batch 79, loss: 0.1685, instance_loss: 0.1132, weighted_loss: 0.1519, label: 2, bag_size: 2481
batch 99, loss: 0.1663, instance_loss: 0.2167, weighted_loss: 0.1814, label: 2, bag_size: 3327
batch 119, loss: 0.0628, instance_loss: 0.1194, weighted_loss: 0.0798, label: 2, bag_size: 4856
batch 139, loss: 0.2649, instance_loss: 0.2163, weighted_loss: 0.2503, label: 2, bag_size: 2997
batch 159, loss: 1.3622, instance_loss: 1.0226, weighted_loss: 1.2603, label: 1, bag_size: 817
batch 179, loss: 0.0697, instance_loss: 0.1539, weighted_loss: 0.0950, label: 2, bag_size: 6148
batch 199, loss: 0.8659, instance_loss: 0.5942, weighted_loss: 0.7844, label: 1, bag_size: 1066
batch 219, loss: 0.0724, instance_loss: 0.2644, weighted_loss: 0.1300, label: 2, bag_size: 4569
batch 239, loss: 0.0202, instance_loss: 0.3581, weighted_loss: 0.1215, label: 0, bag_size: 2927
batch 259, loss: 0.0169, instance_loss: 0.6115, weighted_loss: 0.1952, label: 2, bag_size: 3607
batch 279, loss: 0.3263, instance_loss: 0.4506, weighted_loss: 0.3636, label: 1, bag_size: 3367
batch 299, loss: 0.1558, instance_loss: 0.2981, weighted_loss: 0.1985, label: 2, bag_size: 4096
batch 319, loss: 1.3042, instance_loss: 1.4165, weighted_loss: 1.3379, label: 0, bag_size: 2069
batch 339, loss: 0.4755, instance_loss: 0.4067, weighted_loss: 0.4548, label: 0, bag_size: 4647
batch 359, loss: 1.2933, instance_loss: 1.1151, weighted_loss: 1.2398, label: 1, bag_size: 1307
batch 379, loss: 0.2932, instance_loss: 0.8954, weighted_loss: 0.4739, label: 1, bag_size: 4467
batch 399, loss: 1.2860, instance_loss: 0.7945, weighted_loss: 1.1385, label: 2, bag_size: 728
batch 419, loss: 0.5789, instance_loss: 0.7785, weighted_loss: 0.6387, label: 1, bag_size: 3935
batch 439, loss: 0.2295, instance_loss: 0.3181, weighted_loss: 0.2561, label: 0, bag_size: 4242
batch 459, loss: 0.5360, instance_loss: 0.7972, weighted_loss: 0.6143, label: 2, bag_size: 361
batch 479, loss: 0.0454, instance_loss: 0.0943, weighted_loss: 0.0601, label: 2, bag_size: 1094
batch 499, loss: 0.0260, instance_loss: 0.9889, weighted_loss: 0.3149, label: 0, bag_size: 1910
batch 519, loss: 0.4762, instance_loss: 0.6435, weighted_loss: 0.5264, label: 1, bag_size: 3991
batch 539, loss: 1.2422, instance_loss: 0.8735, weighted_loss: 1.1316, label: 1, bag_size: 5402
batch 559, loss: 0.0442, instance_loss: 0.0804, weighted_loss: 0.0550, label: 2, bag_size: 2313
batch 579, loss: 1.8650, instance_loss: 1.0451, weighted_loss: 1.6190, label: 1, bag_size: 3322
batch 599, loss: 0.0780, instance_loss: 0.1691, weighted_loss: 0.1053, label: 2, bag_size: 2997
batch 619, loss: 0.1646, instance_loss: 0.5439, weighted_loss: 0.2784, label: 1, bag_size: 3755
batch 639, loss: 0.0289, instance_loss: 0.3718, weighted_loss: 0.1318, label: 1, bag_size: 1027
batch 659, loss: 0.2946, instance_loss: 0.5035, weighted_loss: 0.3573, label: 0, bag_size: 5373
batch 679, loss: 0.2393, instance_loss: 0.6349, weighted_loss: 0.3580, label: 1, bag_size: 2747
batch 699, loss: 1.7532, instance_loss: 1.0544, weighted_loss: 1.5436, label: 0, bag_size: 4572
batch 719, loss: 1.3023, instance_loss: 1.0431, weighted_loss: 1.2245, label: 2, bag_size: 4342
batch 739, loss: 1.0754, instance_loss: 0.7302, weighted_loss: 0.9718, label: 0, bag_size: 5848


class 0 clustering acc 0.9654362416107383: correct 17262/17880
class 1 clustering acc 0.4248322147651007: correct 2532/5960
Epoch: 46, train_loss: 0.4813, train_clustering_loss:  0.5176, train_error: 0.2027
class 0: acc 0.8132780082987552, correct 196/241
class 1: acc 0.7228915662650602, correct 180/249
class 2: acc 0.8549019607843137, correct 218/255

Val Set, val_loss: 0.7595, val_error: 0.3085, auc: 0.8714
class 0 clustering acc 0.9596631205673759: correct 2165/2256
class 1 clustering acc 0.4228723404255319: correct 318/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.4894, instance_loss: 0.7421, weighted_loss: 0.5652, label: 2, bag_size: 4316
batch 39, loss: 0.6573, instance_loss: 0.9581, weighted_loss: 0.7475, label: 0, bag_size: 3841
batch 59, loss: 0.1865, instance_loss: 0.2113, weighted_loss: 0.1940, label: 0, bag_size: 4734
batch 79, loss: 2.3780, instance_loss: 1.3946, weighted_loss: 2.0830, label: 0, bag_size: 2736
batch 99, loss: 0.0316, instance_loss: 0.2688, weighted_loss: 0.1028, label: 0, bag_size: 3406
batch 119, loss: 0.0760, instance_loss: 0.3930, weighted_loss: 0.1711, label: 1, bag_size: 3471
batch 139, loss: 0.9448, instance_loss: 0.8950, weighted_loss: 0.9299, label: 0, bag_size: 2915
batch 159, loss: 2.4728, instance_loss: 1.2294, weighted_loss: 2.0998, label: 0, bag_size: 4032
batch 179, loss: 0.0478, instance_loss: 0.1750, weighted_loss: 0.0859, label: 0, bag_size: 7595
batch 199, loss: 0.1614, instance_loss: 0.5882, weighted_loss: 0.2894, label: 2, bag_size: 5924
batch 219, loss: 0.7209, instance_loss: 0.9755, weighted_loss: 0.7972, label: 2, bag_size: 2813
batch 239, loss: 0.1064, instance_loss: 0.3648, weighted_loss: 0.1839, label: 0, bag_size: 2094
batch 259, loss: 0.0540, instance_loss: 0.2834, weighted_loss: 0.1228, label: 2, bag_size: 1543
batch 279, loss: 0.9055, instance_loss: 0.9193, weighted_loss: 0.9097, label: 0, bag_size: 2428
batch 299, loss: 0.0847, instance_loss: 0.6489, weighted_loss: 0.2539, label: 1, bag_size: 3322
batch 319, loss: 0.1237, instance_loss: 0.2424, weighted_loss: 0.1593, label: 1, bag_size: 5364
batch 339, loss: 0.0996, instance_loss: 0.2136, weighted_loss: 0.1338, label: 2, bag_size: 6273
batch 359, loss: 0.9450, instance_loss: 1.0590, weighted_loss: 0.9792, label: 1, bag_size: 4806
batch 379, loss: 2.9678, instance_loss: 1.7391, weighted_loss: 2.5992, label: 1, bag_size: 3791
batch 399, loss: 0.8461, instance_loss: 1.2932, weighted_loss: 0.9802, label: 1, bag_size: 3322
batch 419, loss: 0.0522, instance_loss: 0.4686, weighted_loss: 0.1771, label: 0, bag_size: 4721
batch 439, loss: 0.1238, instance_loss: 0.4218, weighted_loss: 0.2132, label: 0, bag_size: 2841
batch 459, loss: 0.0541, instance_loss: 0.1615, weighted_loss: 0.0863, label: 2, bag_size: 1094
batch 479, loss: 0.0092, instance_loss: 0.3597, weighted_loss: 0.1143, label: 1, bag_size: 2643
batch 499, loss: 0.0508, instance_loss: 0.4606, weighted_loss: 0.1737, label: 0, bag_size: 2069
batch 519, loss: 0.1089, instance_loss: 0.5527, weighted_loss: 0.2420, label: 1, bag_size: 3051
batch 539, loss: 0.0116, instance_loss: 0.1275, weighted_loss: 0.0464, label: 1, bag_size: 596
batch 559, loss: 0.0557, instance_loss: 0.3571, weighted_loss: 0.1461, label: 1, bag_size: 10941
batch 579, loss: 0.0006, instance_loss: 0.0496, weighted_loss: 0.0153, label: 0, bag_size: 4403
batch 599, loss: 0.0767, instance_loss: 0.1819, weighted_loss: 0.1083, label: 2, bag_size: 3176
batch 619, loss: 0.0257, instance_loss: 0.1542, weighted_loss: 0.0643, label: 0, bag_size: 2545
batch 639, loss: 0.1448, instance_loss: 0.1684, weighted_loss: 0.1519, label: 2, bag_size: 2997
batch 659, loss: 0.5314, instance_loss: 0.3692, weighted_loss: 0.4827, label: 0, bag_size: 4325
batch 679, loss: 0.1323, instance_loss: 0.1737, weighted_loss: 0.1447, label: 2, bag_size: 3210
batch 699, loss: 0.1522, instance_loss: 0.2234, weighted_loss: 0.1736, label: 0, bag_size: 4865
batch 719, loss: 0.0300, instance_loss: 0.5753, weighted_loss: 0.1936, label: 1, bag_size: 1027
batch 739, loss: 0.8313, instance_loss: 0.4467, weighted_loss: 0.7159, label: 2, bag_size: 614


class 0 clustering acc 0.9681767337807606: correct 17311/17880
class 1 clustering acc 0.4380872483221476: correct 2611/5960
Epoch: 47, train_loss: 0.5035, train_clustering_loss:  0.5142, train_error: 0.2067
class 0: acc 0.8191881918819188, correct 222/271
class 1: acc 0.7222222222222222, correct 169/234
class 2: acc 0.8333333333333334, correct 200/240

Val Set, val_loss: 0.6874, val_error: 0.3085, auc: 0.8775
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.46808510638297873: correct 352/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.5879, instance_loss: 0.7396, weighted_loss: 0.6334, label: 2, bag_size: 4535
batch 39, loss: 0.7297, instance_loss: 1.0404, weighted_loss: 0.8229, label: 1, bag_size: 8632
batch 59, loss: 0.0001, instance_loss: 0.0775, weighted_loss: 0.0233, label: 1, bag_size: 1836
batch 79, loss: 0.0058, instance_loss: 0.3082, weighted_loss: 0.0965, label: 1, bag_size: 3333
batch 99, loss: 0.8956, instance_loss: 0.5730, weighted_loss: 0.7988, label: 0, bag_size: 2428
batch 119, loss: 0.0000, instance_loss: 0.9999, weighted_loss: 0.3000, label: 0, bag_size: 3038
batch 139, loss: 0.3460, instance_loss: 0.4432, weighted_loss: 0.3752, label: 0, bag_size: 4131
batch 159, loss: 0.0275, instance_loss: 0.5173, weighted_loss: 0.1744, label: 0, bag_size: 1176
batch 179, loss: 0.0003, instance_loss: 0.0512, weighted_loss: 0.0156, label: 1, bag_size: 460
batch 199, loss: 0.1233, instance_loss: 0.1100, weighted_loss: 0.1193, label: 2, bag_size: 4056
batch 219, loss: 0.0132, instance_loss: 0.1994, weighted_loss: 0.0690, label: 0, bag_size: 2487
batch 239, loss: 2.1939, instance_loss: 0.8076, weighted_loss: 1.7780, label: 0, bag_size: 35080
batch 259, loss: 0.3765, instance_loss: 0.2462, weighted_loss: 0.3374, label: 2, bag_size: 5914
batch 279, loss: 0.1037, instance_loss: 0.3302, weighted_loss: 0.1717, label: 2, bag_size: 3080
batch 299, loss: 0.0225, instance_loss: 0.4219, weighted_loss: 0.1423, label: 1, bag_size: 3221
batch 319, loss: 0.0112, instance_loss: 0.2322, weighted_loss: 0.0775, label: 1, bag_size: 3558
batch 339, loss: 0.1668, instance_loss: 0.4373, weighted_loss: 0.2480, label: 0, bag_size: 4562
batch 359, loss: 0.0357, instance_loss: 0.2301, weighted_loss: 0.0940, label: 0, bag_size: 4529
batch 379, loss: 0.8373, instance_loss: 0.7839, weighted_loss: 0.8213, label: 0, bag_size: 3841
batch 399, loss: 0.6296, instance_loss: 0.5721, weighted_loss: 0.6124, label: 1, bag_size: 1860
batch 419, loss: 0.0028, instance_loss: 0.2213, weighted_loss: 0.0683, label: 0, bag_size: 5795
batch 439, loss: 0.5985, instance_loss: 0.5479, weighted_loss: 0.5833, label: 0, bag_size: 4719
batch 459, loss: 0.0140, instance_loss: 0.3525, weighted_loss: 0.1155, label: 0, bag_size: 3752
batch 479, loss: 0.2366, instance_loss: 0.6644, weighted_loss: 0.3649, label: 2, bag_size: 6298
batch 499, loss: 0.0635, instance_loss: 0.1210, weighted_loss: 0.0807, label: 2, bag_size: 2770
batch 519, loss: 0.0297, instance_loss: 0.0841, weighted_loss: 0.0460, label: 2, bag_size: 2254
batch 539, loss: 0.4413, instance_loss: 0.5269, weighted_loss: 0.4670, label: 1, bag_size: 5118
batch 559, loss: 0.0003, instance_loss: 0.3768, weighted_loss: 0.1132, label: 1, bag_size: 3425
batch 579, loss: 0.0692, instance_loss: 0.2321, weighted_loss: 0.1181, label: 2, bag_size: 5924
batch 599, loss: 0.4180, instance_loss: 0.4979, weighted_loss: 0.4420, label: 2, bag_size: 5406
batch 619, loss: 0.6485, instance_loss: 1.6221, weighted_loss: 0.9406, label: 1, bag_size: 3016
batch 639, loss: 0.3317, instance_loss: 0.3552, weighted_loss: 0.3388, label: 2, bag_size: 614
batch 659, loss: 0.0127, instance_loss: 0.2364, weighted_loss: 0.0798, label: 1, bag_size: 3493
batch 679, loss: 0.5763, instance_loss: 0.9782, weighted_loss: 0.6969, label: 1, bag_size: 5412
batch 699, loss: 0.3752, instance_loss: 0.5491, weighted_loss: 0.4274, label: 1, bag_size: 5412
batch 719, loss: 0.0790, instance_loss: 0.3123, weighted_loss: 0.1490, label: 2, bag_size: 4978
batch 739, loss: 0.1506, instance_loss: 0.4528, weighted_loss: 0.2413, label: 1, bag_size: 832


class 0 clustering acc 0.9670022371364653: correct 17290/17880
class 1 clustering acc 0.44345637583892616: correct 2643/5960
Epoch: 48, train_loss: 0.4706, train_clustering_loss:  0.5131, train_error: 0.1919
class 0: acc 0.8244274809160306, correct 216/262
class 1: acc 0.7269076305220884, correct 181/249
class 2: acc 0.8760683760683761, correct 205/234

Val Set, val_loss: 0.7145, val_error: 0.2553, auc: 0.8879
class 0 clustering acc 0.976063829787234: correct 2202/2256
class 1 clustering acc 0.33111702127659576: correct 249/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.8, correct 24/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.4910, instance_loss: 0.6882, weighted_loss: 0.5502, label: 2, bag_size: 4535
batch 39, loss: 0.5759, instance_loss: 0.5772, weighted_loss: 0.5763, label: 0, bag_size: 1373
batch 59, loss: 1.9960, instance_loss: 1.0340, weighted_loss: 1.7074, label: 2, bag_size: 4179
batch 79, loss: 0.1488, instance_loss: 0.3901, weighted_loss: 0.2212, label: 2, bag_size: 5637
batch 99, loss: 0.1149, instance_loss: 0.3215, weighted_loss: 0.1769, label: 2, bag_size: 3678
batch 119, loss: 0.9260, instance_loss: 0.6873, weighted_loss: 0.8544, label: 1, bag_size: 2865
batch 139, loss: 0.0714, instance_loss: 0.5194, weighted_loss: 0.2058, label: 1, bag_size: 3558
batch 159, loss: 0.1013, instance_loss: 0.9992, weighted_loss: 0.3707, label: 0, bag_size: 2231
batch 179, loss: 0.0022, instance_loss: 0.1315, weighted_loss: 0.0410, label: 1, bag_size: 6277
batch 199, loss: 0.1238, instance_loss: 0.2877, weighted_loss: 0.1729, label: 2, bag_size: 2481
batch 219, loss: 0.0098, instance_loss: 0.1512, weighted_loss: 0.0522, label: 1, bag_size: 5026
batch 239, loss: 0.0323, instance_loss: 0.3942, weighted_loss: 0.1408, label: 2, bag_size: 5017
batch 259, loss: 0.0491, instance_loss: 0.3660, weighted_loss: 0.1441, label: 0, bag_size: 2094
batch 279, loss: 0.1688, instance_loss: 0.3408, weighted_loss: 0.2204, label: 0, bag_size: 4524
batch 299, loss: 0.1535, instance_loss: 0.3745, weighted_loss: 0.2198, label: 2, bag_size: 3327
batch 319, loss: 0.0357, instance_loss: 0.1137, weighted_loss: 0.0591, label: 2, bag_size: 6148
batch 339, loss: 0.2009, instance_loss: 0.3960, weighted_loss: 0.2595, label: 1, bag_size: 4184
batch 359, loss: 0.1126, instance_loss: 0.4750, weighted_loss: 0.2213, label: 0, bag_size: 3182
batch 379, loss: 0.7536, instance_loss: 0.8319, weighted_loss: 0.7771, label: 1, bag_size: 3644
batch 399, loss: 0.0888, instance_loss: 0.2479, weighted_loss: 0.1365, label: 2, bag_size: 5011
batch 419, loss: 0.1484, instance_loss: 0.2389, weighted_loss: 0.1756, label: 2, bag_size: 3534
batch 439, loss: 0.3759, instance_loss: 0.5340, weighted_loss: 0.4233, label: 1, bag_size: 683
batch 459, loss: 0.0843, instance_loss: 0.4178, weighted_loss: 0.1843, label: 1, bag_size: 1221
batch 479, loss: 3.0031, instance_loss: 1.1174, weighted_loss: 2.4374, label: 2, bag_size: 3475
batch 499, loss: 0.4080, instance_loss: 0.7129, weighted_loss: 0.4995, label: 0, bag_size: 3833
batch 519, loss: 0.0288, instance_loss: 0.1014, weighted_loss: 0.0506, label: 2, bag_size: 3210
batch 539, loss: 0.8018, instance_loss: 0.8335, weighted_loss: 0.8113, label: 1, bag_size: 3619
batch 559, loss: 0.6438, instance_loss: 1.4087, weighted_loss: 0.8732, label: 1, bag_size: 2425
batch 579, loss: 1.1301, instance_loss: 0.9075, weighted_loss: 1.0633, label: 2, bag_size: 724
batch 599, loss: 0.1601, instance_loss: 0.4008, weighted_loss: 0.2323, label: 0, bag_size: 6971
batch 619, loss: 0.2601, instance_loss: 0.3327, weighted_loss: 0.2819, label: 2, bag_size: 597
batch 639, loss: 0.0253, instance_loss: 0.3879, weighted_loss: 0.1341, label: 0, bag_size: 3188
batch 659, loss: 0.1260, instance_loss: 0.7373, weighted_loss: 0.3094, label: 1, bag_size: 3333
batch 679, loss: 0.0532, instance_loss: 0.2948, weighted_loss: 0.1257, label: 0, bag_size: 1174
batch 699, loss: 1.1648, instance_loss: 1.1129, weighted_loss: 1.1492, label: 2, bag_size: 4342
batch 719, loss: 0.0964, instance_loss: 0.3661, weighted_loss: 0.1773, label: 2, bag_size: 2486
batch 739, loss: 0.5749, instance_loss: 1.0437, weighted_loss: 0.7155, label: 0, bag_size: 2915


class 0 clustering acc 0.9706935123042506: correct 17356/17880
class 1 clustering acc 0.36526845637583893: correct 2177/5960
Epoch: 49, train_loss: 0.5220, train_clustering_loss:  0.5459, train_error: 0.2134
class 0: acc 0.8016194331983806, correct 198/247
class 1: acc 0.7307692307692307, correct 190/260
class 2: acc 0.8319327731092437, correct 198/238

Val Set, val_loss: 0.8583, val_error: 0.3404, auc: 0.8480
class 0 clustering acc 0.975177304964539: correct 2200/2256
class 1 clustering acc 0.2393617021276596: correct 180/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0784, instance_loss: 0.1260, weighted_loss: 0.0927, label: 2, bag_size: 2997
batch 39, loss: 0.9109, instance_loss: 0.8280, weighted_loss: 0.8860, label: 0, bag_size: 4648
batch 59, loss: 0.2249, instance_loss: 0.2802, weighted_loss: 0.2415, label: 0, bag_size: 5413
batch 79, loss: 0.0095, instance_loss: 0.0548, weighted_loss: 0.0231, label: 0, bag_size: 5500
batch 99, loss: 0.7340, instance_loss: 0.8331, weighted_loss: 0.7637, label: 2, bag_size: 4535
batch 119, loss: 2.1859, instance_loss: 0.8803, weighted_loss: 1.7942, label: 0, bag_size: 14791
batch 139, loss: 1.9826, instance_loss: 1.2666, weighted_loss: 1.7678, label: 2, bag_size: 4316
batch 159, loss: 1.3618, instance_loss: 0.7598, weighted_loss: 1.1812, label: 2, bag_size: 5637
batch 179, loss: 2.3926, instance_loss: 1.6393, weighted_loss: 2.1666, label: 0, bag_size: 4605
batch 199, loss: 0.0073, instance_loss: 0.2618, weighted_loss: 0.0837, label: 1, bag_size: 4181
batch 219, loss: 0.1675, instance_loss: 0.3421, weighted_loss: 0.2198, label: 2, bag_size: 6644
batch 239, loss: 0.4306, instance_loss: 0.4482, weighted_loss: 0.4359, label: 2, bag_size: 3174
batch 259, loss: 0.1046, instance_loss: 0.3580, weighted_loss: 0.1806, label: 0, bag_size: 1640
batch 279, loss: 0.0225, instance_loss: 0.1841, weighted_loss: 0.0710, label: 0, bag_size: 3525
batch 299, loss: 0.1064, instance_loss: 0.5643, weighted_loss: 0.2438, label: 1, bag_size: 3471
batch 319, loss: 0.4233, instance_loss: 0.9239, weighted_loss: 0.5735, label: 1, bag_size: 1558
batch 339, loss: 0.6410, instance_loss: 0.5996, weighted_loss: 0.6286, label: 0, bag_size: 4584
batch 359, loss: 0.6258, instance_loss: 0.5814, weighted_loss: 0.6125, label: 0, bag_size: 3061
batch 379, loss: 0.3990, instance_loss: 0.3429, weighted_loss: 0.3822, label: 2, bag_size: 3534
batch 399, loss: 0.7712, instance_loss: 0.7241, weighted_loss: 0.7571, label: 2, bag_size: 4535
batch 419, loss: 0.5201, instance_loss: 0.5575, weighted_loss: 0.5313, label: 2, bag_size: 3618
batch 439, loss: 0.6794, instance_loss: 0.7392, weighted_loss: 0.6974, label: 1, bag_size: 5011
batch 459, loss: 0.0023, instance_loss: 0.1441, weighted_loss: 0.0448, label: 1, bag_size: 5760
batch 479, loss: 0.3726, instance_loss: 0.3302, weighted_loss: 0.3599, label: 2, bag_size: 3583
batch 499, loss: 0.0040, instance_loss: 0.2577, weighted_loss: 0.0801, label: 2, bag_size: 4203
batch 519, loss: 0.2494, instance_loss: 0.4669, weighted_loss: 0.3146, label: 2, bag_size: 3080
batch 539, loss: 0.0070, instance_loss: 0.5061, weighted_loss: 0.1568, label: 0, bag_size: 4494
batch 559, loss: 0.4197, instance_loss: 0.5721, weighted_loss: 0.4654, label: 0, bag_size: 609
batch 579, loss: 1.3344, instance_loss: 0.7936, weighted_loss: 1.1721, label: 1, bag_size: 2859
batch 599, loss: 2.6805, instance_loss: 1.2115, weighted_loss: 2.2398, label: 0, bag_size: 3387
batch 619, loss: 0.0260, instance_loss: 0.5678, weighted_loss: 0.1885, label: 1, bag_size: 4869
batch 639, loss: 0.1602, instance_loss: 0.5978, weighted_loss: 0.2915, label: 1, bag_size: 3403
batch 659, loss: 0.0059, instance_loss: 0.3051, weighted_loss: 0.0957, label: 0, bag_size: 4458
batch 679, loss: 0.7340, instance_loss: 0.7592, weighted_loss: 0.7415, label: 1, bag_size: 3050
batch 699, loss: 1.3460, instance_loss: 0.9416, weighted_loss: 1.2247, label: 1, bag_size: 936
batch 719, loss: 0.0005, instance_loss: 0.0888, weighted_loss: 0.0270, label: 0, bag_size: 3438
batch 739, loss: 0.0358, instance_loss: 0.2321, weighted_loss: 0.0947, label: 1, bag_size: 3983


class 0 clustering acc 0.9668903803131991: correct 17288/17880
class 1 clustering acc 0.3793624161073825: correct 2261/5960
Epoch: 50, train_loss: 0.5023, train_clustering_loss:  0.5388, train_error: 0.2228
class 0: acc 0.7876106194690266, correct 178/226
class 1: acc 0.7224199288256228, correct 203/281
class 2: acc 0.8319327731092437, correct 198/238

Val Set, val_loss: 0.8721, val_error: 0.2979, auc: 0.8785
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.3829787234042553: correct 288/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.9166666666666666, correct 11/12
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0344, instance_loss: 0.2841, weighted_loss: 0.1093, label: 1, bag_size: 3051
batch 39, loss: 0.0127, instance_loss: 0.2276, weighted_loss: 0.0771, label: 0, bag_size: 2428
batch 59, loss: 2.4698, instance_loss: 1.0273, weighted_loss: 2.0370, label: 2, bag_size: 1513
batch 79, loss: 0.0001, instance_loss: 0.0980, weighted_loss: 0.0294, label: 1, bag_size: 6277
batch 99, loss: 0.2382, instance_loss: 0.9582, weighted_loss: 0.4542, label: 1, bag_size: 8482
batch 119, loss: 1.5956, instance_loss: 0.9384, weighted_loss: 1.3984, label: 1, bag_size: 3823
batch 139, loss: 0.0069, instance_loss: 0.3168, weighted_loss: 0.0999, label: 0, bag_size: 3983
batch 159, loss: 0.0037, instance_loss: 0.3361, weighted_loss: 0.1034, label: 1, bag_size: 1836
batch 179, loss: 2.9220, instance_loss: 1.1656, weighted_loss: 2.3951, label: 0, bag_size: 35080
batch 199, loss: 0.0557, instance_loss: 0.4458, weighted_loss: 0.1727, label: 0, bag_size: 7927
batch 219, loss: 0.0256, instance_loss: 0.4048, weighted_loss: 0.1393, label: 0, bag_size: 2293
batch 239, loss: 1.2833, instance_loss: 0.8463, weighted_loss: 1.1522, label: 2, bag_size: 909
batch 259, loss: 0.0175, instance_loss: 0.3187, weighted_loss: 0.1079, label: 0, bag_size: 2826
batch 279, loss: 3.7228, instance_loss: 1.7610, weighted_loss: 3.1342, label: 2, bag_size: 3475
batch 299, loss: 0.7358, instance_loss: 0.5407, weighted_loss: 0.6773, label: 1, bag_size: 2998
batch 319, loss: 1.4856, instance_loss: 0.3193, weighted_loss: 1.1357, label: 2, bag_size: 88
batch 339, loss: 1.2543, instance_loss: 0.6345, weighted_loss: 1.0684, label: 0, bag_size: 4717
batch 359, loss: 0.0995, instance_loss: 0.3447, weighted_loss: 0.1731, label: 1, bag_size: 3357
batch 379, loss: 6.4446, instance_loss: 0.8470, weighted_loss: 4.7654, label: 2, bag_size: 4745
batch 399, loss: 0.2525, instance_loss: 0.5115, weighted_loss: 0.3302, label: 1, bag_size: 3586
batch 419, loss: 0.1178, instance_loss: 0.2742, weighted_loss: 0.1647, label: 2, bag_size: 5924
batch 439, loss: 0.0169, instance_loss: 0.3364, weighted_loss: 0.1127, label: 0, bag_size: 2139
batch 459, loss: 0.0473, instance_loss: 0.1540, weighted_loss: 0.0793, label: 2, bag_size: 4555
batch 479, loss: 0.7155, instance_loss: 0.6934, weighted_loss: 0.7088, label: 1, bag_size: 2481
batch 499, loss: 0.3969, instance_loss: 0.4159, weighted_loss: 0.4026, label: 0, bag_size: 8866
batch 519, loss: 0.0935, instance_loss: 0.3076, weighted_loss: 0.1577, label: 1, bag_size: 6156
batch 539, loss: 0.0326, instance_loss: 0.2231, weighted_loss: 0.0897, label: 0, bag_size: 3797
batch 559, loss: 0.7204, instance_loss: 1.1170, weighted_loss: 0.8394, label: 0, bag_size: 2069
batch 579, loss: 0.8591, instance_loss: 0.5712, weighted_loss: 0.7727, label: 1, bag_size: 3604
batch 599, loss: 0.1074, instance_loss: 0.5031, weighted_loss: 0.2261, label: 0, bag_size: 3182
batch 619, loss: 0.7883, instance_loss: 0.6568, weighted_loss: 0.7489, label: 0, bag_size: 5023
batch 639, loss: 0.2459, instance_loss: 0.6171, weighted_loss: 0.3573, label: 2, bag_size: 6594
batch 659, loss: 0.1004, instance_loss: 0.3658, weighted_loss: 0.1800, label: 1, bag_size: 3497
batch 679, loss: 0.9063, instance_loss: 0.6393, weighted_loss: 0.8262, label: 2, bag_size: 5426
batch 699, loss: 0.1846, instance_loss: 0.3024, weighted_loss: 0.2199, label: 0, bag_size: 5526
batch 719, loss: 0.1142, instance_loss: 0.2719, weighted_loss: 0.1615, label: 2, bag_size: 3778
batch 739, loss: 1.2936, instance_loss: 0.9580, weighted_loss: 1.1929, label: 1, bag_size: 3106


class 0 clustering acc 0.9675055928411633: correct 17299/17880
class 1 clustering acc 0.4221476510067114: correct 2516/5960
Epoch: 51, train_loss: 0.4769, train_clustering_loss:  0.5174, train_error: 0.1826
class 0: acc 0.8604651162790697, correct 222/258
class 1: acc 0.7531914893617021, correct 177/235
class 2: acc 0.8333333333333334, correct 210/252

Val Set, val_loss: 0.7684, val_error: 0.3191, auc: 0.8491
class 0 clustering acc 0.9450354609929078: correct 2132/2256
class 1 clustering acc 0.4734042553191489: correct 356/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 33 out of 20
Early stopping
Val error: 0.2979, ROC AUC: 0.8942
Test error: 0.3085, ROC AUC: 0.8510
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.5833333333333334, correct 7/12

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 745 samples
Validating on 94 samples
Testing on 94 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
Model__:
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0-2): 3 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.2720, instance_loss: 0.6349, weighted_loss: 0.3809, label: 1, bag_size: 209
batch 39, loss: 2.0453, instance_loss: 0.6847, weighted_loss: 1.6371, label: 0, bag_size: 2853
batch 59, loss: 1.0784, instance_loss: 0.7112, weighted_loss: 0.9682, label: 2, bag_size: 6704
batch 79, loss: 1.3378, instance_loss: 0.8222, weighted_loss: 1.1831, label: 2, bag_size: 5406
batch 99, loss: 1.3923, instance_loss: 0.9385, weighted_loss: 1.2561, label: 1, bag_size: 4599
batch 119, loss: 2.3825, instance_loss: 0.7509, weighted_loss: 1.8930, label: 0, bag_size: 6182
batch 139, loss: 1.4518, instance_loss: 0.8333, weighted_loss: 1.2663, label: 1, bag_size: 3225
batch 159, loss: 0.7971, instance_loss: 0.8081, weighted_loss: 0.8004, label: 0, bag_size: 1883
batch 179, loss: 1.2569, instance_loss: 0.8108, weighted_loss: 1.1230, label: 0, bag_size: 1174
batch 199, loss: 1.2401, instance_loss: 0.8182, weighted_loss: 1.1135, label: 2, bag_size: 6704
batch 219, loss: 1.1809, instance_loss: 0.8302, weighted_loss: 1.0757, label: 2, bag_size: 223
batch 239, loss: 1.5092, instance_loss: 0.8533, weighted_loss: 1.3124, label: 0, bag_size: 5036
batch 259, loss: 1.1965, instance_loss: 0.7304, weighted_loss: 1.0567, label: 2, bag_size: 4302
batch 279, loss: 0.4314, instance_loss: 0.6313, weighted_loss: 0.4914, label: 2, bag_size: 2254
batch 299, loss: 0.4815, instance_loss: 0.7052, weighted_loss: 0.5486, label: 0, bag_size: 3038
batch 319, loss: 0.6918, instance_loss: 0.8876, weighted_loss: 0.7505, label: 2, bag_size: 4140
batch 339, loss: 1.9026, instance_loss: 0.9591, weighted_loss: 1.6195, label: 1, bag_size: 1854
batch 359, loss: 0.2835, instance_loss: 0.6250, weighted_loss: 0.3859, label: 1, bag_size: 4705
batch 379, loss: 0.6173, instance_loss: 0.4937, weighted_loss: 0.5802, label: 1, bag_size: 2796
batch 399, loss: 0.3638, instance_loss: 0.4655, weighted_loss: 0.3943, label: 1, bag_size: 4069
batch 419, loss: 2.5402, instance_loss: 1.1737, weighted_loss: 2.1303, label: 2, bag_size: 4316
batch 439, loss: 0.4997, instance_loss: 0.7808, weighted_loss: 0.5840, label: 2, bag_size: 4569
batch 459, loss: 0.4366, instance_loss: 0.5514, weighted_loss: 0.4710, label: 2, bag_size: 2561
batch 479, loss: 1.0267, instance_loss: 0.8147, weighted_loss: 0.9631, label: 0, bag_size: 614
batch 499, loss: 1.0885, instance_loss: 0.7677, weighted_loss: 0.9923, label: 1, bag_size: 1510
batch 519, loss: 1.0279, instance_loss: 0.6536, weighted_loss: 0.9156, label: 0, bag_size: 1782
batch 539, loss: 1.1321, instance_loss: 0.6899, weighted_loss: 0.9994, label: 0, bag_size: 2139
batch 559, loss: 0.7565, instance_loss: 0.6753, weighted_loss: 0.7321, label: 1, bag_size: 5572
batch 579, loss: 0.7510, instance_loss: 0.6939, weighted_loss: 0.7338, label: 0, bag_size: 1562
batch 599, loss: 1.1098, instance_loss: 0.6867, weighted_loss: 0.9829, label: 0, bag_size: 13770
batch 619, loss: 0.6324, instance_loss: 0.6087, weighted_loss: 0.6253, label: 0, bag_size: 4626
batch 639, loss: 0.5464, instance_loss: 0.6051, weighted_loss: 0.5640, label: 1, bag_size: 2342
batch 659, loss: 0.5785, instance_loss: 0.6393, weighted_loss: 0.5967, label: 0, bag_size: 5526
batch 679, loss: 0.2256, instance_loss: 0.4623, weighted_loss: 0.2966, label: 2, bag_size: 4788
batch 699, loss: 1.6589, instance_loss: 1.1143, weighted_loss: 1.4955, label: 2, bag_size: 4179
batch 719, loss: 0.2236, instance_loss: 0.3781, weighted_loss: 0.2700, label: 1, bag_size: 5385
batch 739, loss: 0.8710, instance_loss: 0.7146, weighted_loss: 0.8241, label: 0, bag_size: 3936


class 0 clustering acc 0.9963087248322148: correct 17814/17880
class 1 clustering acc 0.006040268456375839: correct 36/5960
Epoch: 0, train_loss: 1.0302, train_clustering_loss:  0.7290, train_error: 0.5020
class 0: acc 0.48091603053435117, correct 126/262
class 1: acc 0.45643153526970953, correct 110/241
class 2: acc 0.5578512396694215, correct 135/242

Val Set, val_loss: 0.8700, val_error: 0.3830, auc: 0.7342
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.25, correct 3/12
Validation loss decreased (inf --> 0.869978).  Saving model ...


batch 19, loss: 0.9571, instance_loss: 0.8950, weighted_loss: 0.9385, label: 2, bag_size: 6298
batch 39, loss: 0.2938, instance_loss: 0.4783, weighted_loss: 0.3492, label: 2, bag_size: 4910
batch 59, loss: 0.8263, instance_loss: 0.6698, weighted_loss: 0.7793, label: 1, bag_size: 1964
batch 79, loss: 0.8477, instance_loss: 0.7004, weighted_loss: 0.8035, label: 0, bag_size: 5459
batch 99, loss: 0.7850, instance_loss: 0.7476, weighted_loss: 0.7738, label: 0, bag_size: 2853
batch 119, loss: 0.4752, instance_loss: 0.5254, weighted_loss: 0.4903, label: 1, bag_size: 3761
batch 139, loss: 1.8827, instance_loss: 1.1453, weighted_loss: 1.6615, label: 2, bag_size: 3604
batch 159, loss: 0.5093, instance_loss: 0.6072, weighted_loss: 0.5387, label: 0, bag_size: 5003
batch 179, loss: 0.6947, instance_loss: 0.5487, weighted_loss: 0.6509, label: 1, bag_size: 1607
batch 199, loss: 0.2874, instance_loss: 0.6039, weighted_loss: 0.3824, label: 2, bag_size: 4141
batch 219, loss: 0.9063, instance_loss: 0.6636, weighted_loss: 0.8335, label: 1, bag_size: 1500
batch 239, loss: 0.3015, instance_loss: 0.4846, weighted_loss: 0.3564, label: 2, bag_size: 88
batch 259, loss: 1.2517, instance_loss: 0.7488, weighted_loss: 1.1009, label: 1, bag_size: 2642
batch 279, loss: 0.9169, instance_loss: 0.6226, weighted_loss: 0.8286, label: 1, bag_size: 4824
batch 299, loss: 1.6255, instance_loss: 0.8466, weighted_loss: 1.3918, label: 0, bag_size: 4310
batch 319, loss: 0.6414, instance_loss: 0.6451, weighted_loss: 0.6425, label: 0, bag_size: 3294
batch 339, loss: 2.3123, instance_loss: 0.9906, weighted_loss: 1.9158, label: 2, bag_size: 223
batch 359, loss: 1.0978, instance_loss: 0.8067, weighted_loss: 1.0105, label: 2, bag_size: 6148
batch 379, loss: 1.0737, instance_loss: 0.7461, weighted_loss: 0.9754, label: 0, bag_size: 4228
batch 399, loss: 0.3059, instance_loss: 0.4405, weighted_loss: 0.3463, label: 2, bag_size: 3094
batch 419, loss: 0.6144, instance_loss: 0.6213, weighted_loss: 0.6165, label: 2, bag_size: 5924
batch 439, loss: 0.5737, instance_loss: 0.9530, weighted_loss: 0.6875, label: 2, bag_size: 4745
batch 459, loss: 0.5021, instance_loss: 0.4747, weighted_loss: 0.4939, label: 1, bag_size: 2744
batch 479, loss: 0.7862, instance_loss: 0.5683, weighted_loss: 0.7209, label: 1, bag_size: 3534
batch 499, loss: 0.2529, instance_loss: 0.3940, weighted_loss: 0.2952, label: 2, bag_size: 657
batch 519, loss: 0.3244, instance_loss: 0.4217, weighted_loss: 0.3536, label: 2, bag_size: 4056
batch 539, loss: 0.6461, instance_loss: 1.0124, weighted_loss: 0.7560, label: 2, bag_size: 3607
batch 559, loss: 0.4576, instance_loss: 0.5940, weighted_loss: 0.4986, label: 0, bag_size: 2756
batch 579, loss: 0.3077, instance_loss: 0.4200, weighted_loss: 0.3414, label: 0, bag_size: 4083
batch 599, loss: 0.8447, instance_loss: 0.5333, weighted_loss: 0.7513, label: 0, bag_size: 4347
batch 619, loss: 0.5292, instance_loss: 0.6276, weighted_loss: 0.5588, label: 1, bag_size: 2870
batch 639, loss: 1.4045, instance_loss: 0.7754, weighted_loss: 1.2158, label: 1, bag_size: 2927
batch 659, loss: 1.4895, instance_loss: 1.0111, weighted_loss: 1.3460, label: 2, bag_size: 5472
batch 679, loss: 0.6201, instance_loss: 0.6793, weighted_loss: 0.6379, label: 1, bag_size: 4119
batch 699, loss: 0.3168, instance_loss: 0.5842, weighted_loss: 0.3970, label: 2, bag_size: 4856
batch 719, loss: 0.2586, instance_loss: 0.4328, weighted_loss: 0.3109, label: 1, bag_size: 4253
batch 739, loss: 0.6674, instance_loss: 0.6690, weighted_loss: 0.6679, label: 1, bag_size: 3471


class 0 clustering acc 0.9988814317673378: correct 17860/17880
class 1 clustering acc 0.0087248322147651: correct 52/5960
Epoch: 1, train_loss: 0.9027, train_clustering_loss:  0.6844, train_error: 0.4067
class 0: acc 0.5546558704453441, correct 137/247
class 1: acc 0.5660377358490566, correct 150/265
class 2: acc 0.6652360515021459, correct 155/233

Val Set, val_loss: 1.0085, val_error: 0.5106, auc: 0.7359
class 0 clustering acc 1.0: correct 2256/2256
class 1 clustering acc 0.0: correct 0/752
class 0: acc 0.46153846153846156, correct 24/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.8333333333333334, correct 10/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.1082, instance_loss: 0.8449, weighted_loss: 1.7292, label: 2, bag_size: 724
batch 39, loss: 0.3095, instance_loss: 0.5758, weighted_loss: 0.3894, label: 0, bag_size: 1174
batch 59, loss: 0.1926, instance_loss: 0.3545, weighted_loss: 0.2412, label: 2, bag_size: 2483
batch 79, loss: 0.6060, instance_loss: 0.6373, weighted_loss: 0.6154, label: 1, bag_size: 800
batch 99, loss: 0.3364, instance_loss: 0.4043, weighted_loss: 0.3568, label: 2, bag_size: 3094
batch 119, loss: 0.6233, instance_loss: 0.5868, weighted_loss: 0.6124, label: 0, bag_size: 6765
batch 139, loss: 0.3379, instance_loss: 0.3018, weighted_loss: 0.3271, label: 2, bag_size: 4088
batch 159, loss: 0.2592, instance_loss: 0.2773, weighted_loss: 0.2646, label: 2, bag_size: 2561
batch 179, loss: 0.9506, instance_loss: 0.7216, weighted_loss: 0.8819, label: 1, bag_size: 2671
batch 199, loss: 2.3469, instance_loss: 1.0739, weighted_loss: 1.9650, label: 2, bag_size: 1543
batch 219, loss: 0.8923, instance_loss: 0.5736, weighted_loss: 0.7967, label: 0, bag_size: 3701
batch 239, loss: 0.9526, instance_loss: 0.6389, weighted_loss: 0.8585, label: 1, bag_size: 1854
batch 259, loss: 1.6785, instance_loss: 0.9285, weighted_loss: 1.4535, label: 0, bag_size: 15388
batch 279, loss: 1.6896, instance_loss: 0.9322, weighted_loss: 1.4624, label: 1, bag_size: 2927
batch 299, loss: 0.3222, instance_loss: 0.4503, weighted_loss: 0.3606, label: 1, bag_size: 4960
batch 319, loss: 0.3585, instance_loss: 0.5139, weighted_loss: 0.4051, label: 1, bag_size: 4708
batch 339, loss: 0.2510, instance_loss: 0.4855, weighted_loss: 0.3214, label: 0, bag_size: 2873
batch 359, loss: 1.1497, instance_loss: 0.8158, weighted_loss: 1.0496, label: 1, bag_size: 667
batch 379, loss: 0.4299, instance_loss: 0.7071, weighted_loss: 0.5131, label: 2, bag_size: 597
batch 399, loss: 1.3896, instance_loss: 0.9721, weighted_loss: 1.2644, label: 1, bag_size: 9099
batch 419, loss: 0.5168, instance_loss: 0.5267, weighted_loss: 0.5197, label: 0, bag_size: 5041
batch 439, loss: 1.6066, instance_loss: 0.9089, weighted_loss: 1.3973, label: 2, bag_size: 3604
batch 459, loss: 0.8157, instance_loss: 0.6306, weighted_loss: 0.7602, label: 2, bag_size: 3583
batch 479, loss: 1.1176, instance_loss: 0.5801, weighted_loss: 0.9563, label: 1, bag_size: 4784
batch 499, loss: 1.1114, instance_loss: 0.8552, weighted_loss: 1.0345, label: 0, bag_size: 436
batch 519, loss: 0.9638, instance_loss: 0.7121, weighted_loss: 0.8883, label: 1, bag_size: 4373
batch 539, loss: 0.7389, instance_loss: 0.6956, weighted_loss: 0.7259, label: 1, bag_size: 1528
batch 559, loss: 0.0684, instance_loss: 0.2894, weighted_loss: 0.1347, label: 2, bag_size: 4088
batch 579, loss: 1.2041, instance_loss: 0.7058, weighted_loss: 1.0546, label: 2, bag_size: 3534
batch 599, loss: 0.5291, instance_loss: 0.7263, weighted_loss: 0.5883, label: 1, bag_size: 2962
batch 619, loss: 1.1886, instance_loss: 0.8227, weighted_loss: 1.0788, label: 1, bag_size: 1066
batch 639, loss: 2.0970, instance_loss: 1.2214, weighted_loss: 1.8343, label: 0, bag_size: 1886
batch 659, loss: 2.7967, instance_loss: 1.0942, weighted_loss: 2.2859, label: 1, bag_size: 3791
batch 679, loss: 0.1357, instance_loss: 0.6192, weighted_loss: 0.2808, label: 2, bag_size: 6001
batch 699, loss: 0.8203, instance_loss: 0.8089, weighted_loss: 0.8169, label: 1, bag_size: 5412
batch 719, loss: 0.1943, instance_loss: 0.4089, weighted_loss: 0.2587, label: 2, bag_size: 5914
batch 739, loss: 0.8927, instance_loss: 0.7570, weighted_loss: 0.8520, label: 1, bag_size: 6165


class 0 clustering acc 0.9941275167785235: correct 17775/17880
class 1 clustering acc 0.06291946308724833: correct 375/5960
Epoch: 2, train_loss: 0.8585, train_clustering_loss:  0.6539, train_error: 0.3893
class 0: acc 0.5785123966942148, correct 140/242
class 1: acc 0.4765957446808511, correct 112/235
class 2: acc 0.7574626865671642, correct 203/268

Val Set, val_loss: 0.8947, val_error: 0.4255, auc: 0.7581
class 0 clustering acc 0.9915780141843972: correct 2237/2256
class 1 clustering acc 0.014627659574468085: correct 11/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4055, instance_loss: 0.5349, weighted_loss: 0.4443, label: 1, bag_size: 4119
batch 39, loss: 1.3054, instance_loss: 0.7668, weighted_loss: 1.1438, label: 1, bag_size: 5873
batch 59, loss: 1.8550, instance_loss: 1.1696, weighted_loss: 1.6494, label: 1, bag_size: 628
batch 79, loss: 0.2832, instance_loss: 0.5026, weighted_loss: 0.3490, label: 0, bag_size: 1845
batch 99, loss: 0.3109, instance_loss: 0.4276, weighted_loss: 0.3460, label: 2, bag_size: 3396
batch 119, loss: 1.2356, instance_loss: 0.7620, weighted_loss: 1.0935, label: 0, bag_size: 2896
batch 139, loss: 0.6331, instance_loss: 0.4656, weighted_loss: 0.5828, label: 0, bag_size: 2392
batch 159, loss: 0.3819, instance_loss: 0.4577, weighted_loss: 0.4047, label: 0, bag_size: 1782
batch 179, loss: 0.0937, instance_loss: 0.7275, weighted_loss: 0.2838, label: 2, bag_size: 4745
batch 199, loss: 0.2608, instance_loss: 0.6778, weighted_loss: 0.3859, label: 1, bag_size: 3172
batch 219, loss: 1.0850, instance_loss: 0.6319, weighted_loss: 0.9491, label: 0, bag_size: 7056
batch 239, loss: 0.5904, instance_loss: 0.6293, weighted_loss: 0.6021, label: 1, bag_size: 210
batch 259, loss: 0.3967, instance_loss: 0.3457, weighted_loss: 0.3814, label: 0, bag_size: 4165
batch 279, loss: 0.6339, instance_loss: 0.3280, weighted_loss: 0.5422, label: 0, bag_size: 4794
batch 299, loss: 0.3353, instance_loss: 0.3717, weighted_loss: 0.3462, label: 0, bag_size: 2830
batch 319, loss: 0.6036, instance_loss: 0.4602, weighted_loss: 0.5606, label: 2, bag_size: 1103
batch 339, loss: 2.4403, instance_loss: 0.9121, weighted_loss: 1.9819, label: 2, bag_size: 223
batch 359, loss: 0.4972, instance_loss: 0.6007, weighted_loss: 0.5283, label: 1, bag_size: 3106
batch 379, loss: 3.2839, instance_loss: 1.2102, weighted_loss: 2.6618, label: 2, bag_size: 3475
batch 399, loss: 1.7662, instance_loss: 0.8682, weighted_loss: 1.4968, label: 1, bag_size: 5197
batch 419, loss: 0.3116, instance_loss: 0.4703, weighted_loss: 0.3593, label: 0, bag_size: 6015
batch 439, loss: 0.5842, instance_loss: 0.4469, weighted_loss: 0.5430, label: 2, bag_size: 2501
batch 459, loss: 0.0671, instance_loss: 0.4266, weighted_loss: 0.1749, label: 1, bag_size: 5018
batch 479, loss: 1.9427, instance_loss: 0.7946, weighted_loss: 1.5983, label: 2, bag_size: 3534
batch 499, loss: 0.7040, instance_loss: 0.5452, weighted_loss: 0.6563, label: 0, bag_size: 3701
batch 519, loss: 0.2816, instance_loss: 0.5527, weighted_loss: 0.3629, label: 1, bag_size: 1558
batch 539, loss: 0.3987, instance_loss: 0.4610, weighted_loss: 0.4174, label: 0, bag_size: 3443
batch 559, loss: 0.5111, instance_loss: 0.6106, weighted_loss: 0.5410, label: 1, bag_size: 3471
batch 579, loss: 1.6338, instance_loss: 0.6834, weighted_loss: 1.3487, label: 2, bag_size: 614
batch 599, loss: 0.6157, instance_loss: 0.5912, weighted_loss: 0.6084, label: 0, bag_size: 3833
batch 619, loss: 0.2288, instance_loss: 0.5573, weighted_loss: 0.3274, label: 0, bag_size: 4083
batch 639, loss: 0.5215, instance_loss: 0.6403, weighted_loss: 0.5572, label: 0, bag_size: 4678
batch 659, loss: 1.4613, instance_loss: 0.7203, weighted_loss: 1.2390, label: 0, bag_size: 5260
batch 679, loss: 0.4416, instance_loss: 0.5478, weighted_loss: 0.4735, label: 2, bag_size: 3497
batch 699, loss: 1.6205, instance_loss: 0.9353, weighted_loss: 1.4149, label: 0, bag_size: 5840
batch 719, loss: 0.3617, instance_loss: 0.5176, weighted_loss: 0.4085, label: 1, bag_size: 2753
batch 739, loss: 0.9774, instance_loss: 0.4728, weighted_loss: 0.8260, label: 1, bag_size: 209


class 0 clustering acc 0.9905480984340045: correct 17711/17880
class 1 clustering acc 0.07298657718120806: correct 435/5960
Epoch: 3, train_loss: 0.7987, train_clustering_loss:  0.6355, train_error: 0.3557
class 0: acc 0.6825396825396826, correct 172/252
class 1: acc 0.5245901639344263, correct 128/244
class 2: acc 0.7228915662650602, correct 180/249

Val Set, val_loss: 0.7992, val_error: 0.2979, auc: 0.7791
class 0 clustering acc 0.9973404255319149: correct 2250/2256
class 1 clustering acc 0.006648936170212766: correct 5/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5, correct 6/12
Validation loss decreased (0.869978 --> 0.799239).  Saving model ...


batch 19, loss: 0.2853, instance_loss: 0.4837, weighted_loss: 0.3448, label: 0, bag_size: 4721
batch 39, loss: 0.4733, instance_loss: 0.4833, weighted_loss: 0.4763, label: 1, bag_size: 4824
batch 59, loss: 1.2643, instance_loss: 0.8765, weighted_loss: 1.1480, label: 2, bag_size: 1050
batch 79, loss: 0.5680, instance_loss: 0.5312, weighted_loss: 0.5569, label: 0, bag_size: 16741
batch 99, loss: 0.7620, instance_loss: 0.5552, weighted_loss: 0.7000, label: 2, bag_size: 3534
batch 119, loss: 0.2420, instance_loss: 0.3052, weighted_loss: 0.2609, label: 2, bag_size: 2049
batch 139, loss: 0.0444, instance_loss: 0.1645, weighted_loss: 0.0804, label: 2, bag_size: 6026
batch 159, loss: 0.2946, instance_loss: 0.6942, weighted_loss: 0.4145, label: 1, bag_size: 3333
batch 179, loss: 2.8379, instance_loss: 1.2965, weighted_loss: 2.3755, label: 0, bag_size: 3711
batch 199, loss: 0.0676, instance_loss: 0.2639, weighted_loss: 0.1265, label: 0, bag_size: 4325
batch 219, loss: 0.0697, instance_loss: 0.1429, weighted_loss: 0.0917, label: 2, bag_size: 1094
batch 239, loss: 0.9212, instance_loss: 0.5793, weighted_loss: 0.8186, label: 2, bag_size: 4241
batch 259, loss: 0.1374, instance_loss: 0.3343, weighted_loss: 0.1965, label: 0, bag_size: 3348
batch 279, loss: 0.8490, instance_loss: 0.5085, weighted_loss: 0.7468, label: 0, bag_size: 4378
batch 299, loss: 0.4386, instance_loss: 0.6261, weighted_loss: 0.4949, label: 0, bag_size: 3219
batch 319, loss: 1.5865, instance_loss: 0.9171, weighted_loss: 1.3857, label: 1, bag_size: 5880
batch 339, loss: 1.0052, instance_loss: 0.7202, weighted_loss: 0.9197, label: 0, bag_size: 7315
batch 359, loss: 0.2437, instance_loss: 0.3637, weighted_loss: 0.2797, label: 0, bag_size: 4606
batch 379, loss: 2.0502, instance_loss: 1.0534, weighted_loss: 1.7512, label: 1, bag_size: 4187
batch 399, loss: 0.1539, instance_loss: 0.2342, weighted_loss: 0.1780, label: 2, bag_size: 657
batch 419, loss: 0.1428, instance_loss: 0.2343, weighted_loss: 0.1703, label: 0, bag_size: 1744
batch 439, loss: 0.3504, instance_loss: 0.6606, weighted_loss: 0.4435, label: 2, bag_size: 5138
batch 459, loss: 0.1040, instance_loss: 0.7247, weighted_loss: 0.2902, label: 2, bag_size: 6148
batch 479, loss: 0.7868, instance_loss: 0.7113, weighted_loss: 0.7642, label: 1, bag_size: 1599
batch 499, loss: 0.7979, instance_loss: 0.8851, weighted_loss: 0.8240, label: 1, bag_size: 1510
batch 519, loss: 2.7105, instance_loss: 1.1306, weighted_loss: 2.2365, label: 1, bag_size: 4067
batch 539, loss: 0.5553, instance_loss: 0.4923, weighted_loss: 0.5364, label: 0, bag_size: 3370
batch 559, loss: 0.4476, instance_loss: 0.5037, weighted_loss: 0.4644, label: 1, bag_size: 425
batch 579, loss: 0.2374, instance_loss: 0.4282, weighted_loss: 0.2947, label: 1, bag_size: 3677
batch 599, loss: 1.1148, instance_loss: 0.6104, weighted_loss: 0.9635, label: 1, bag_size: 6993
batch 619, loss: 0.5469, instance_loss: 0.4257, weighted_loss: 0.5106, label: 0, bag_size: 6863
batch 639, loss: 0.4273, instance_loss: 0.6866, weighted_loss: 0.5051, label: 0, bag_size: 1034
batch 659, loss: 3.0326, instance_loss: 1.4740, weighted_loss: 2.5650, label: 1, bag_size: 4181
batch 679, loss: 0.2070, instance_loss: 0.3206, weighted_loss: 0.2411, label: 0, bag_size: 2545
batch 699, loss: 0.2119, instance_loss: 0.5465, weighted_loss: 0.3122, label: 1, bag_size: 7279
batch 719, loss: 0.4170, instance_loss: 0.5123, weighted_loss: 0.4456, label: 0, bag_size: 5632
batch 739, loss: 0.4455, instance_loss: 0.7818, weighted_loss: 0.5464, label: 2, bag_size: 3810


class 0 clustering acc 0.9869686800894855: correct 17647/17880
class 1 clustering acc 0.1307046979865772: correct 779/5960
Epoch: 4, train_loss: 0.7544, train_clustering_loss:  0.6167, train_error: 0.3315
class 0: acc 0.7310606060606061, correct 193/264
class 1: acc 0.47555555555555556, correct 107/225
class 2: acc 0.7734375, correct 198/256

Val Set, val_loss: 0.8644, val_error: 0.3191, auc: 0.7581
class 0 clustering acc 0.9977836879432624: correct 2251/2256
class 1 clustering acc 0.030585106382978722: correct 23/752
class 0: acc 0.75, correct 39/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8670, instance_loss: 0.6425, weighted_loss: 0.7996, label: 1, bag_size: 3508
batch 39, loss: 1.0395, instance_loss: 0.7181, weighted_loss: 0.9430, label: 1, bag_size: 2472
batch 59, loss: 0.1263, instance_loss: 0.3623, weighted_loss: 0.1971, label: 2, bag_size: 4203
batch 79, loss: 0.4755, instance_loss: 0.4528, weighted_loss: 0.4687, label: 1, bag_size: 2494
batch 99, loss: 0.2497, instance_loss: 0.3198, weighted_loss: 0.2707, label: 2, bag_size: 6704
batch 119, loss: 0.2584, instance_loss: 0.3788, weighted_loss: 0.2945, label: 0, bag_size: 1495
batch 139, loss: 0.1044, instance_loss: 0.2772, weighted_loss: 0.1562, label: 1, bag_size: 3337
batch 159, loss: 0.4154, instance_loss: 0.5872, weighted_loss: 0.4670, label: 2, bag_size: 4056
batch 179, loss: 0.8180, instance_loss: 0.4982, weighted_loss: 0.7220, label: 0, bag_size: 4347
batch 199, loss: 0.3559, instance_loss: 0.5740, weighted_loss: 0.4213, label: 2, bag_size: 2209
batch 219, loss: 0.0686, instance_loss: 0.2854, weighted_loss: 0.1336, label: 2, bag_size: 3678
batch 239, loss: 0.9908, instance_loss: 0.7445, weighted_loss: 0.9169, label: 1, bag_size: 5197
batch 259, loss: 0.0760, instance_loss: 0.2192, weighted_loss: 0.1190, label: 1, bag_size: 3043
batch 279, loss: 0.1224, instance_loss: 0.2854, weighted_loss: 0.1713, label: 2, bag_size: 3094
batch 299, loss: 0.6994, instance_loss: 0.6745, weighted_loss: 0.6919, label: 0, bag_size: 1289
batch 319, loss: 0.9353, instance_loss: 0.8104, weighted_loss: 0.8979, label: 0, bag_size: 7177
batch 339, loss: 0.7542, instance_loss: 0.5630, weighted_loss: 0.6968, label: 0, bag_size: 5011
batch 359, loss: 0.9740, instance_loss: 0.6231, weighted_loss: 0.8688, label: 1, bag_size: 7109
batch 379, loss: 0.4206, instance_loss: 0.6441, weighted_loss: 0.4877, label: 2, bag_size: 5017
batch 399, loss: 0.4270, instance_loss: 0.4483, weighted_loss: 0.4334, label: 1, bag_size: 4812
batch 419, loss: 0.6687, instance_loss: 0.5450, weighted_loss: 0.6316, label: 1, bag_size: 455
batch 439, loss: 0.1644, instance_loss: 0.3998, weighted_loss: 0.2350, label: 0, bag_size: 3247
batch 459, loss: 0.2895, instance_loss: 0.5387, weighted_loss: 0.3642, label: 2, bag_size: 6594
batch 479, loss: 1.5007, instance_loss: 0.8474, weighted_loss: 1.3047, label: 0, bag_size: 4921
batch 499, loss: 1.0441, instance_loss: 0.5890, weighted_loss: 0.9076, label: 2, bag_size: 705
batch 519, loss: 1.0702, instance_loss: 0.9068, weighted_loss: 1.0212, label: 2, bag_size: 3299
batch 539, loss: 0.1383, instance_loss: 0.2866, weighted_loss: 0.1828, label: 0, bag_size: 3348
batch 559, loss: 0.2367, instance_loss: 0.3092, weighted_loss: 0.2585, label: 2, bag_size: 2501
batch 579, loss: 0.6182, instance_loss: 0.6017, weighted_loss: 0.6132, label: 0, bag_size: 3864
batch 599, loss: 0.6105, instance_loss: 0.3196, weighted_loss: 0.5232, label: 0, bag_size: 4018
batch 619, loss: 0.6815, instance_loss: 0.6085, weighted_loss: 0.6596, label: 1, bag_size: 3322
batch 639, loss: 1.3989, instance_loss: 1.0848, weighted_loss: 1.3047, label: 1, bag_size: 4258
batch 659, loss: 0.1294, instance_loss: 0.1913, weighted_loss: 0.1480, label: 1, bag_size: 4898
batch 679, loss: 0.6057, instance_loss: 0.6184, weighted_loss: 0.6095, label: 1, bag_size: 3786
batch 699, loss: 0.8737, instance_loss: 0.6045, weighted_loss: 0.7929, label: 2, bag_size: 4302
batch 719, loss: 0.1436, instance_loss: 0.2828, weighted_loss: 0.1854, label: 1, bag_size: 3009
batch 739, loss: 0.7892, instance_loss: 0.4668, weighted_loss: 0.6925, label: 2, bag_size: 2031


class 0 clustering acc 0.9816554809843401: correct 17552/17880
class 1 clustering acc 0.16291946308724833: correct 971/5960
Epoch: 5, train_loss: 0.7621, train_clustering_loss:  0.6192, train_error: 0.3208
class 0: acc 0.6333333333333333, correct 133/210
class 1: acc 0.6176470588235294, correct 168/272
class 2: acc 0.779467680608365, correct 205/263

Val Set, val_loss: 1.2055, val_error: 0.4787, auc: 0.7187
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.09973404255319149: correct 75/752
class 0: acc 0.40384615384615385, correct 21/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1376, instance_loss: 0.3293, weighted_loss: 0.1951, label: 1, bag_size: 2796
batch 39, loss: 0.9948, instance_loss: 0.8514, weighted_loss: 0.9518, label: 2, bag_size: 4162
batch 59, loss: 1.0407, instance_loss: 0.8470, weighted_loss: 0.9826, label: 2, bag_size: 705
batch 79, loss: 0.3639, instance_loss: 0.4241, weighted_loss: 0.3820, label: 0, bag_size: 6015
batch 99, loss: 0.5039, instance_loss: 0.4311, weighted_loss: 0.4820, label: 0, bag_size: 3155
batch 119, loss: 0.6361, instance_loss: 0.4561, weighted_loss: 0.5821, label: 1, bag_size: 2254
batch 139, loss: 0.2261, instance_loss: 0.2106, weighted_loss: 0.2214, label: 2, bag_size: 4088
batch 159, loss: 0.1824, instance_loss: 0.3233, weighted_loss: 0.2247, label: 0, bag_size: 3641
batch 179, loss: 1.3503, instance_loss: 0.7379, weighted_loss: 1.1666, label: 1, bag_size: 3644
batch 199, loss: 0.0788, instance_loss: 0.2090, weighted_loss: 0.1178, label: 2, bag_size: 2422
batch 219, loss: 0.6141, instance_loss: 0.4129, weighted_loss: 0.5538, label: 1, bag_size: 4069
batch 239, loss: 0.3022, instance_loss: 0.3636, weighted_loss: 0.3206, label: 2, bag_size: 597
batch 259, loss: 0.0005, instance_loss: 0.1708, weighted_loss: 0.0516, label: 0, bag_size: 1106
batch 279, loss: 0.5378, instance_loss: 0.5037, weighted_loss: 0.5276, label: 1, bag_size: 4708
batch 299, loss: 0.0388, instance_loss: 0.0886, weighted_loss: 0.0537, label: 2, bag_size: 4910
batch 319, loss: 0.1888, instance_loss: 0.2995, weighted_loss: 0.2220, label: 2, bag_size: 2483
batch 339, loss: 0.9808, instance_loss: 0.6784, weighted_loss: 0.8901, label: 1, bag_size: 4069
batch 359, loss: 0.5048, instance_loss: 0.4779, weighted_loss: 0.4968, label: 2, bag_size: 4096
batch 379, loss: 0.5030, instance_loss: 0.3317, weighted_loss: 0.4516, label: 0, bag_size: 4604
batch 399, loss: 0.7747, instance_loss: 0.7015, weighted_loss: 0.7527, label: 1, bag_size: 1394
batch 419, loss: 1.0290, instance_loss: 0.8590, weighted_loss: 0.9780, label: 1, bag_size: 3995
batch 439, loss: 0.2274, instance_loss: 0.4294, weighted_loss: 0.2880, label: 1, bag_size: 758
batch 459, loss: 0.2786, instance_loss: 0.6688, weighted_loss: 0.3957, label: 0, bag_size: 1744
batch 479, loss: 0.0003, instance_loss: 0.6157, weighted_loss: 0.1850, label: 0, bag_size: 1709
batch 499, loss: 0.3135, instance_loss: 0.4801, weighted_loss: 0.3635, label: 0, bag_size: 2927
batch 519, loss: 0.0977, instance_loss: 0.1259, weighted_loss: 0.1062, label: 2, bag_size: 4088
batch 539, loss: 0.3106, instance_loss: 0.3637, weighted_loss: 0.3265, label: 1, bag_size: 5532
batch 559, loss: 0.2381, instance_loss: 0.4571, weighted_loss: 0.3038, label: 0, bag_size: 4783
batch 579, loss: 1.6479, instance_loss: 0.9237, weighted_loss: 1.4306, label: 2, bag_size: 1513
batch 599, loss: 1.5279, instance_loss: 0.6735, weighted_loss: 1.2716, label: 0, bag_size: 4711
batch 619, loss: 0.2043, instance_loss: 0.2503, weighted_loss: 0.2181, label: 2, bag_size: 3678
batch 639, loss: 1.0647, instance_loss: 0.8855, weighted_loss: 1.0109, label: 0, bag_size: 4865
batch 659, loss: 0.3237, instance_loss: 0.3951, weighted_loss: 0.3451, label: 0, bag_size: 1234
batch 679, loss: 0.6726, instance_loss: 0.5712, weighted_loss: 0.6422, label: 1, bag_size: 5167
batch 699, loss: 1.4211, instance_loss: 0.7253, weighted_loss: 1.2124, label: 2, bag_size: 3227
batch 719, loss: 0.4869, instance_loss: 0.4729, weighted_loss: 0.4827, label: 1, bag_size: 2921
batch 739, loss: 2.0518, instance_loss: 1.1198, weighted_loss: 1.7722, label: 1, bag_size: 3791


class 0 clustering acc 0.9832214765100671: correct 17580/17880
class 1 clustering acc 0.17986577181208055: correct 1072/5960
Epoch: 6, train_loss: 0.7069, train_clustering_loss:  0.6007, train_error: 0.3060
class 0: acc 0.7131147540983607, correct 174/244
class 1: acc 0.584, correct 146/250
class 2: acc 0.7848605577689243, correct 197/251

Val Set, val_loss: 0.7851, val_error: 0.3298, auc: 0.7731
class 0 clustering acc 0.9902482269503546: correct 2234/2256
class 1 clustering acc 0.047872340425531915: correct 36/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.4166666666666667, correct 5/12
Validation loss decreased (0.799239 --> 0.785122).  Saving model ...


batch 19, loss: 0.9805, instance_loss: 0.6824, weighted_loss: 0.8910, label: 0, bag_size: 22822
batch 39, loss: 0.8928, instance_loss: 0.8630, weighted_loss: 0.8839, label: 2, bag_size: 5743
batch 59, loss: 0.8989, instance_loss: 0.8192, weighted_loss: 0.8750, label: 0, bag_size: 1933
batch 79, loss: 0.1154, instance_loss: 0.3293, weighted_loss: 0.1796, label: 1, bag_size: 758
batch 99, loss: 0.0415, instance_loss: 0.2388, weighted_loss: 0.1007, label: 2, bag_size: 6273
batch 119, loss: 0.0916, instance_loss: 0.2276, weighted_loss: 0.1324, label: 2, bag_size: 4043
batch 139, loss: 0.0847, instance_loss: 0.1552, weighted_loss: 0.1058, label: 2, bag_size: 6026
batch 159, loss: 0.2089, instance_loss: 0.3828, weighted_loss: 0.2611, label: 1, bag_size: 2962
batch 179, loss: 0.6258, instance_loss: 0.5544, weighted_loss: 0.6044, label: 2, bag_size: 3534
batch 199, loss: 1.1289, instance_loss: 0.6480, weighted_loss: 0.9846, label: 1, bag_size: 5011
batch 219, loss: 1.4114, instance_loss: 0.7941, weighted_loss: 1.2262, label: 2, bag_size: 4316
batch 239, loss: 0.0341, instance_loss: 0.1210, weighted_loss: 0.0602, label: 2, bag_size: 6026
batch 259, loss: 1.1680, instance_loss: 1.0301, weighted_loss: 1.1266, label: 0, bag_size: 313
batch 279, loss: 0.7903, instance_loss: 0.5727, weighted_loss: 0.7251, label: 0, bag_size: 5340
batch 299, loss: 0.2606, instance_loss: 0.3035, weighted_loss: 0.2735, label: 2, bag_size: 6273
batch 319, loss: 0.1691, instance_loss: 0.3045, weighted_loss: 0.2097, label: 2, bag_size: 3210
batch 339, loss: 0.0823, instance_loss: 0.2605, weighted_loss: 0.1358, label: 2, bag_size: 5914
batch 359, loss: 0.6844, instance_loss: 0.9604, weighted_loss: 0.7672, label: 1, bag_size: 4824
batch 379, loss: 0.0023, instance_loss: 0.0884, weighted_loss: 0.0281, label: 0, bag_size: 6182
batch 399, loss: 0.7915, instance_loss: 0.5921, weighted_loss: 0.7317, label: 1, bag_size: 5011
batch 419, loss: 0.5616, instance_loss: 0.5966, weighted_loss: 0.5721, label: 0, bag_size: 2830
batch 439, loss: 0.3368, instance_loss: 0.6261, weighted_loss: 0.4236, label: 1, bag_size: 3460
batch 459, loss: 0.0868, instance_loss: 0.4261, weighted_loss: 0.1886, label: 1, bag_size: 6315
batch 479, loss: 1.7011, instance_loss: 1.1558, weighted_loss: 1.5375, label: 1, bag_size: 4694
batch 499, loss: 1.2218, instance_loss: 0.6539, weighted_loss: 1.0514, label: 1, bag_size: 628
batch 519, loss: 0.2582, instance_loss: 1.0096, weighted_loss: 0.4837, label: 0, bag_size: 1645
batch 539, loss: 0.0465, instance_loss: 0.2755, weighted_loss: 0.1152, label: 2, bag_size: 3810
batch 559, loss: 4.5139, instance_loss: 1.7912, weighted_loss: 3.6971, label: 0, bag_size: 3419
batch 579, loss: 0.0425, instance_loss: 0.2100, weighted_loss: 0.0928, label: 2, bag_size: 6273
batch 599, loss: 0.8933, instance_loss: 0.6940, weighted_loss: 0.8335, label: 1, bag_size: 2921
batch 619, loss: 0.6315, instance_loss: 0.6473, weighted_loss: 0.6363, label: 0, bag_size: 4122
batch 639, loss: 1.1130, instance_loss: 0.8322, weighted_loss: 1.0287, label: 2, bag_size: 4241
batch 659, loss: 0.1010, instance_loss: 0.2021, weighted_loss: 0.1313, label: 0, bag_size: 5632
batch 679, loss: 1.7804, instance_loss: 1.1136, weighted_loss: 1.5803, label: 1, bag_size: 2472
batch 699, loss: 0.6270, instance_loss: 0.4625, weighted_loss: 0.5776, label: 0, bag_size: 4808
batch 719, loss: 0.3204, instance_loss: 0.5698, weighted_loss: 0.3952, label: 0, bag_size: 471
batch 739, loss: 0.8689, instance_loss: 1.0345, weighted_loss: 0.9186, label: 1, bag_size: 4181


class 0 clustering acc 0.978076062639821: correct 17488/17880
class 1 clustering acc 0.20369127516778524: correct 1214/5960
Epoch: 7, train_loss: 0.7244, train_clustering_loss:  0.6108, train_error: 0.3181
class 0: acc 0.683982683982684, correct 158/231
class 1: acc 0.5708502024291497, correct 141/247
class 2: acc 0.7827715355805244, correct 209/267

Val Set, val_loss: 0.7385, val_error: 0.3404, auc: 0.7996
class 0 clustering acc 0.9796099290780141: correct 2210/2256
class 1 clustering acc 0.08244680851063829: correct 62/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.3333333333333333, correct 4/12
Validation loss decreased (0.785122 --> 0.738469).  Saving model ...


batch 19, loss: 0.0770, instance_loss: 0.1027, weighted_loss: 0.0847, label: 2, bag_size: 2997
batch 39, loss: 0.2762, instance_loss: 0.4181, weighted_loss: 0.3188, label: 0, bag_size: 6015
batch 59, loss: 0.7527, instance_loss: 0.5981, weighted_loss: 0.7063, label: 2, bag_size: 5017
batch 79, loss: 0.6262, instance_loss: 0.5215, weighted_loss: 0.5948, label: 1, bag_size: 209
batch 99, loss: 0.3858, instance_loss: 0.3405, weighted_loss: 0.3722, label: 0, bag_size: 4018
batch 119, loss: 0.1750, instance_loss: 0.3415, weighted_loss: 0.2250, label: 1, bag_size: 796
batch 139, loss: 0.0293, instance_loss: 0.0935, weighted_loss: 0.0486, label: 2, bag_size: 6026
batch 159, loss: 0.1439, instance_loss: 0.4716, weighted_loss: 0.2422, label: 2, bag_size: 5914
batch 179, loss: 0.0850, instance_loss: 0.1235, weighted_loss: 0.0965, label: 2, bag_size: 2997
batch 199, loss: 2.0535, instance_loss: 1.0787, weighted_loss: 1.7611, label: 0, bag_size: 5867
batch 219, loss: 0.0790, instance_loss: 0.1508, weighted_loss: 0.1005, label: 2, bag_size: 3285
batch 239, loss: 0.3987, instance_loss: 0.4725, weighted_loss: 0.4209, label: 1, bag_size: 14449
batch 259, loss: 1.8718, instance_loss: 1.1377, weighted_loss: 1.6515, label: 2, bag_size: 5743
batch 279, loss: 0.8320, instance_loss: 0.6070, weighted_loss: 0.7645, label: 0, bag_size: 5890
batch 299, loss: 2.3673, instance_loss: 1.5454, weighted_loss: 2.1207, label: 1, bag_size: 3399
batch 319, loss: 0.5349, instance_loss: 0.5722, weighted_loss: 0.5461, label: 1, bag_size: 3746
batch 339, loss: 0.3485, instance_loss: 0.5353, weighted_loss: 0.4045, label: 0, bag_size: 4458
batch 359, loss: 1.1982, instance_loss: 0.8859, weighted_loss: 1.1045, label: 1, bag_size: 782
batch 379, loss: 2.0981, instance_loss: 1.0466, weighted_loss: 1.7826, label: 0, bag_size: 3341
batch 399, loss: 0.4501, instance_loss: 0.4589, weighted_loss: 0.4527, label: 2, bag_size: 4569
batch 419, loss: 0.2963, instance_loss: 0.6049, weighted_loss: 0.3889, label: 2, bag_size: 6594
batch 439, loss: 1.2559, instance_loss: 0.9018, weighted_loss: 1.1497, label: 2, bag_size: 1050
batch 459, loss: 0.6438, instance_loss: 0.5612, weighted_loss: 0.6190, label: 2, bag_size: 705
batch 479, loss: 0.9285, instance_loss: 0.7016, weighted_loss: 0.8604, label: 0, bag_size: 3820
batch 499, loss: 0.5500, instance_loss: 0.6763, weighted_loss: 0.5879, label: 0, bag_size: 4351
batch 519, loss: 0.1162, instance_loss: 0.2514, weighted_loss: 0.1567, label: 0, bag_size: 5006
batch 539, loss: 0.6255, instance_loss: 0.9084, weighted_loss: 0.7104, label: 0, bag_size: 3164
batch 559, loss: 0.2887, instance_loss: 0.4067, weighted_loss: 0.3241, label: 0, bag_size: 5170
batch 579, loss: 0.0974, instance_loss: 0.2911, weighted_loss: 0.1555, label: 0, bag_size: 3816
batch 599, loss: 0.1105, instance_loss: 0.9229, weighted_loss: 0.3542, label: 2, bag_size: 3607
batch 619, loss: 0.2405, instance_loss: 0.5291, weighted_loss: 0.3271, label: 0, bag_size: 1245
batch 639, loss: 0.1962, instance_loss: 0.5410, weighted_loss: 0.2997, label: 0, bag_size: 5902
batch 659, loss: 0.1284, instance_loss: 0.4344, weighted_loss: 0.2202, label: 1, bag_size: 4027
batch 679, loss: 0.0500, instance_loss: 0.1974, weighted_loss: 0.0942, label: 2, bag_size: 6026
batch 699, loss: 0.2932, instance_loss: 0.4595, weighted_loss: 0.3431, label: 2, bag_size: 3080
batch 719, loss: 0.0536, instance_loss: 0.1743, weighted_loss: 0.0898, label: 2, bag_size: 5914
batch 739, loss: 0.1774, instance_loss: 0.3705, weighted_loss: 0.2353, label: 2, bag_size: 5914


class 0 clustering acc 0.9836129753914988: correct 17587/17880
class 1 clustering acc 0.19211409395973153: correct 1145/5960
Epoch: 8, train_loss: 0.7119, train_clustering_loss:  0.6053, train_error: 0.3154
class 0: acc 0.7171314741035857, correct 180/251
class 1: acc 0.594488188976378, correct 151/254
class 2: acc 0.7458333333333333, correct 179/240

Val Set, val_loss: 0.7867, val_error: 0.3404, auc: 0.8030
class 0 clustering acc 0.9649822695035462: correct 2177/2256
class 1 clustering acc 0.30186170212765956: correct 227/752
class 0: acc 0.9615384615384616, correct 50/52
class 1: acc 0.23333333333333334, correct 7/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9640, instance_loss: 1.3978, weighted_loss: 1.7941, label: 1, bag_size: 4694
batch 39, loss: 2.0764, instance_loss: 0.5582, weighted_loss: 1.6209, label: 0, bag_size: 3316
batch 59, loss: 1.4393, instance_loss: 0.6457, weighted_loss: 1.2012, label: 1, bag_size: 3837
batch 79, loss: 0.8288, instance_loss: 0.6814, weighted_loss: 0.7846, label: 0, bag_size: 4541
batch 99, loss: 0.7364, instance_loss: 0.7628, weighted_loss: 0.7443, label: 0, bag_size: 3841
batch 119, loss: 0.3011, instance_loss: 0.3216, weighted_loss: 0.3073, label: 1, bag_size: 3225
batch 139, loss: 0.8658, instance_loss: 0.4901, weighted_loss: 0.7531, label: 0, bag_size: 4245
batch 159, loss: 2.2517, instance_loss: 1.8088, weighted_loss: 2.1188, label: 0, bag_size: 2044
batch 179, loss: 0.3222, instance_loss: 0.5834, weighted_loss: 0.4006, label: 2, bag_size: 4192
batch 199, loss: 0.5785, instance_loss: 0.5471, weighted_loss: 0.5691, label: 1, bag_size: 2921
batch 219, loss: 0.7143, instance_loss: 0.7702, weighted_loss: 0.7311, label: 0, bag_size: 3245
batch 239, loss: 0.6315, instance_loss: 0.7060, weighted_loss: 0.6539, label: 0, bag_size: 5526
batch 259, loss: 0.0833, instance_loss: 0.2914, weighted_loss: 0.1457, label: 2, bag_size: 3810
batch 279, loss: 0.0716, instance_loss: 0.3405, weighted_loss: 0.1523, label: 2, bag_size: 4372
batch 299, loss: 1.2315, instance_loss: 0.9522, weighted_loss: 1.1477, label: 2, bag_size: 2486
batch 319, loss: 2.1155, instance_loss: 1.1489, weighted_loss: 1.8255, label: 0, bag_size: 1774
batch 339, loss: 0.5903, instance_loss: 0.5780, weighted_loss: 0.5866, label: 1, bag_size: 2878
batch 359, loss: 1.7323, instance_loss: 1.0392, weighted_loss: 1.5244, label: 1, bag_size: 667
batch 379, loss: 0.3000, instance_loss: 0.3291, weighted_loss: 0.3087, label: 2, bag_size: 1103
batch 399, loss: 0.1907, instance_loss: 0.3540, weighted_loss: 0.2397, label: 2, bag_size: 5914
batch 419, loss: 0.4266, instance_loss: 0.3521, weighted_loss: 0.4042, label: 0, bag_size: 3690
batch 439, loss: 0.6832, instance_loss: 0.8527, weighted_loss: 0.7341, label: 2, bag_size: 3604
batch 459, loss: 0.2468, instance_loss: 0.4096, weighted_loss: 0.2956, label: 0, bag_size: 2983
batch 479, loss: 0.3907, instance_loss: 0.6039, weighted_loss: 0.4547, label: 0, bag_size: 14070
batch 499, loss: 0.1092, instance_loss: 0.3138, weighted_loss: 0.1706, label: 1, bag_size: 2731
batch 519, loss: 0.2136, instance_loss: 0.2625, weighted_loss: 0.2283, label: 2, bag_size: 1103
batch 539, loss: 3.9674, instance_loss: 1.3012, weighted_loss: 3.1675, label: 2, bag_size: 223
batch 559, loss: 1.3922, instance_loss: 0.7473, weighted_loss: 1.1987, label: 1, bag_size: 9099
batch 579, loss: 0.2138, instance_loss: 0.5215, weighted_loss: 0.3061, label: 1, bag_size: 5086
batch 599, loss: 1.6318, instance_loss: 1.1103, weighted_loss: 1.4753, label: 1, bag_size: 782
batch 619, loss: 0.6536, instance_loss: 0.4581, weighted_loss: 0.5950, label: 0, bag_size: 4147
batch 639, loss: 0.2943, instance_loss: 0.4497, weighted_loss: 0.3410, label: 0, bag_size: 4634
batch 659, loss: 2.9457, instance_loss: 1.1497, weighted_loss: 2.4069, label: 2, bag_size: 728
batch 679, loss: 1.8795, instance_loss: 1.0226, weighted_loss: 1.6225, label: 2, bag_size: 728
batch 699, loss: 2.7861, instance_loss: 1.3904, weighted_loss: 2.3674, label: 1, bag_size: 1964
batch 719, loss: 0.8242, instance_loss: 0.8049, weighted_loss: 0.8184, label: 0, bag_size: 768
batch 739, loss: 0.5208, instance_loss: 0.5638, weighted_loss: 0.5337, label: 0, bag_size: 999


class 0 clustering acc 0.9740492170022371: correct 17416/17880
class 1 clustering acc 0.2593959731543624: correct 1546/5960
Epoch: 9, train_loss: 0.7030, train_clustering_loss:  0.5981, train_error: 0.3047
class 0: acc 0.75, correct 189/252
class 1: acc 0.6115384615384616, correct 159/260
class 2: acc 0.7296137339055794, correct 170/233

Val Set, val_loss: 0.8337, val_error: 0.3298, auc: 0.7623
class 0 clustering acc 0.9875886524822695: correct 2228/2256
class 1 clustering acc 0.08909574468085106: correct 67/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6811, instance_loss: 0.6477, weighted_loss: 0.6711, label: 1, bag_size: 8482
batch 39, loss: 0.4916, instance_loss: 0.4785, weighted_loss: 0.4876, label: 0, bag_size: 2712
batch 59, loss: 0.3831, instance_loss: 0.5774, weighted_loss: 0.4414, label: 1, bag_size: 5385
batch 79, loss: 0.0709, instance_loss: 0.3050, weighted_loss: 0.1411, label: 2, bag_size: 3810
batch 99, loss: 0.0984, instance_loss: 0.1469, weighted_loss: 0.1129, label: 2, bag_size: 4788
batch 119, loss: 1.1683, instance_loss: 0.9026, weighted_loss: 1.0886, label: 0, bag_size: 6249
batch 139, loss: 0.3769, instance_loss: 0.5458, weighted_loss: 0.4276, label: 0, bag_size: 1611
batch 159, loss: 0.4821, instance_loss: 0.5364, weighted_loss: 0.4984, label: 0, bag_size: 6971
batch 179, loss: 0.2006, instance_loss: 0.2769, weighted_loss: 0.2235, label: 0, bag_size: 1744
batch 199, loss: 0.9998, instance_loss: 0.6154, weighted_loss: 0.8845, label: 0, bag_size: 6249
batch 219, loss: 6.0875, instance_loss: 1.9627, weighted_loss: 4.8501, label: 0, bag_size: 5017
batch 239, loss: 0.3875, instance_loss: 0.5777, weighted_loss: 0.4446, label: 1, bag_size: 8482
batch 259, loss: 1.2148, instance_loss: 0.8640, weighted_loss: 1.1095, label: 0, bag_size: 4626
batch 279, loss: 0.1150, instance_loss: 0.2494, weighted_loss: 0.1553, label: 0, bag_size: 3348
batch 299, loss: 0.2595, instance_loss: 0.3447, weighted_loss: 0.2850, label: 1, bag_size: 3007
batch 319, loss: 1.0069, instance_loss: 0.4978, weighted_loss: 0.8542, label: 2, bag_size: 3112
batch 339, loss: 0.0490, instance_loss: 0.1412, weighted_loss: 0.0766, label: 2, bag_size: 6148
batch 359, loss: 0.4839, instance_loss: 0.6501, weighted_loss: 0.5338, label: 1, bag_size: 4119
batch 379, loss: 2.3097, instance_loss: 1.5925, weighted_loss: 2.0946, label: 2, bag_size: 4571
batch 399, loss: 0.3426, instance_loss: 0.3823, weighted_loss: 0.3545, label: 2, bag_size: 3534
batch 419, loss: 0.4381, instance_loss: 0.6736, weighted_loss: 0.5088, label: 0, bag_size: 7927
batch 439, loss: 0.8305, instance_loss: 0.6464, weighted_loss: 0.7753, label: 2, bag_size: 1543
batch 459, loss: 0.1663, instance_loss: 0.3233, weighted_loss: 0.2134, label: 2, bag_size: 5914
batch 479, loss: 2.5414, instance_loss: 1.1014, weighted_loss: 2.1094, label: 2, bag_size: 223
batch 499, loss: 0.8681, instance_loss: 0.7142, weighted_loss: 0.8219, label: 2, bag_size: 3112
batch 519, loss: 0.1617, instance_loss: 0.6490, weighted_loss: 0.3079, label: 2, bag_size: 4978
batch 539, loss: 0.0373, instance_loss: 0.1726, weighted_loss: 0.0779, label: 2, bag_size: 2313
batch 559, loss: 2.0597, instance_loss: 1.7014, weighted_loss: 1.9523, label: 1, bag_size: 936
batch 579, loss: 0.5552, instance_loss: 0.5418, weighted_loss: 0.5512, label: 0, bag_size: 4282
batch 599, loss: 0.1308, instance_loss: 0.2820, weighted_loss: 0.1761, label: 0, bag_size: 4015
batch 619, loss: 0.0535, instance_loss: 0.1550, weighted_loss: 0.0839, label: 2, bag_size: 3285
batch 639, loss: 0.5418, instance_loss: 0.6886, weighted_loss: 0.5858, label: 0, bag_size: 4721
batch 659, loss: 0.0790, instance_loss: 0.8022, weighted_loss: 0.2960, label: 0, bag_size: 2028
batch 679, loss: 0.1660, instance_loss: 0.2775, weighted_loss: 0.1995, label: 0, bag_size: 3348
batch 699, loss: 0.4955, instance_loss: 0.5489, weighted_loss: 0.5115, label: 1, bag_size: 5167
batch 719, loss: 0.6938, instance_loss: 0.6489, weighted_loss: 0.6803, label: 1, bag_size: 3508
batch 739, loss: 0.3789, instance_loss: 0.5520, weighted_loss: 0.4308, label: 0, bag_size: 7169


class 0 clustering acc 0.9762863534675615: correct 17456/17880
class 1 clustering acc 0.20604026845637585: correct 1228/5960
Epoch: 10, train_loss: 0.7180, train_clustering_loss:  0.6117, train_error: 0.3074
class 0: acc 0.6796536796536796, correct 157/231
class 1: acc 0.62890625, correct 161/256
class 2: acc 0.7674418604651163, correct 198/258

Val Set, val_loss: 1.0307, val_error: 0.3511, auc: 0.7212
class 0 clustering acc 0.9822695035460993: correct 2216/2256
class 1 clustering acc 0.05053191489361702: correct 38/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2562, instance_loss: 0.3953, weighted_loss: 0.2979, label: 1, bag_size: 4134
batch 39, loss: 0.7436, instance_loss: 0.5176, weighted_loss: 0.6758, label: 1, bag_size: 2870
batch 59, loss: 0.0532, instance_loss: 1.0963, weighted_loss: 0.3661, label: 0, bag_size: 2028
batch 79, loss: 1.0573, instance_loss: 1.0848, weighted_loss: 1.0655, label: 2, bag_size: 1543
batch 99, loss: 0.8017, instance_loss: 0.8469, weighted_loss: 0.8153, label: 2, bag_size: 2486
batch 119, loss: 0.3673, instance_loss: 0.4666, weighted_loss: 0.3971, label: 0, bag_size: 4584
batch 139, loss: 0.1929, instance_loss: 0.1991, weighted_loss: 0.1948, label: 2, bag_size: 88
batch 159, loss: 0.1375, instance_loss: 0.2399, weighted_loss: 0.1682, label: 2, bag_size: 3210
batch 179, loss: 0.1418, instance_loss: 0.5076, weighted_loss: 0.2515, label: 0, bag_size: 3920
batch 199, loss: 0.3705, instance_loss: 1.0355, weighted_loss: 0.5700, label: 2, bag_size: 4745
batch 219, loss: 0.0717, instance_loss: 0.2912, weighted_loss: 0.1375, label: 2, bag_size: 3397
batch 239, loss: 1.3287, instance_loss: 0.7148, weighted_loss: 1.1445, label: 2, bag_size: 3210
batch 259, loss: 0.8961, instance_loss: 0.6822, weighted_loss: 0.8320, label: 1, bag_size: 3508
batch 279, loss: 0.1726, instance_loss: 0.3013, weighted_loss: 0.2112, label: 1, bag_size: 3493
batch 299, loss: 0.1128, instance_loss: 0.3621, weighted_loss: 0.1876, label: 0, bag_size: 2479
batch 319, loss: 0.3913, instance_loss: 0.6225, weighted_loss: 0.4607, label: 0, bag_size: 3298
batch 339, loss: 0.3076, instance_loss: 0.5694, weighted_loss: 0.3861, label: 2, bag_size: 597
batch 359, loss: 0.0500, instance_loss: 0.4712, weighted_loss: 0.1764, label: 1, bag_size: 4027
batch 379, loss: 0.4341, instance_loss: 0.2677, weighted_loss: 0.3842, label: 1, bag_size: 3885
batch 399, loss: 1.4849, instance_loss: 1.0431, weighted_loss: 1.3524, label: 2, bag_size: 705
batch 419, loss: 0.0949, instance_loss: 0.4106, weighted_loss: 0.1896, label: 2, bag_size: 4302
batch 439, loss: 0.3838, instance_loss: 0.4625, weighted_loss: 0.4074, label: 0, bag_size: 6440
batch 459, loss: 0.3117, instance_loss: 0.3406, weighted_loss: 0.3203, label: 0, bag_size: 3334
batch 479, loss: 0.3454, instance_loss: 0.6135, weighted_loss: 0.4258, label: 1, bag_size: 6156
batch 499, loss: 0.2902, instance_loss: 0.4711, weighted_loss: 0.3445, label: 2, bag_size: 3618
batch 519, loss: 0.0761, instance_loss: 0.3417, weighted_loss: 0.1557, label: 2, bag_size: 4555
batch 539, loss: 1.6673, instance_loss: 0.7389, weighted_loss: 1.3888, label: 0, bag_size: 2217
batch 559, loss: 0.6833, instance_loss: 0.5023, weighted_loss: 0.6290, label: 1, bag_size: 1906
batch 579, loss: 0.1619, instance_loss: 0.5317, weighted_loss: 0.2728, label: 2, bag_size: 3810
batch 599, loss: 0.4627, instance_loss: 0.7098, weighted_loss: 0.5369, label: 1, bag_size: 2905
batch 619, loss: 2.2119, instance_loss: 1.1442, weighted_loss: 1.8916, label: 1, bag_size: 5072
batch 639, loss: 0.3812, instance_loss: 0.5780, weighted_loss: 0.4402, label: 1, bag_size: 455
batch 659, loss: 0.5030, instance_loss: 0.4442, weighted_loss: 0.4854, label: 0, bag_size: 3834
batch 679, loss: 0.4201, instance_loss: 0.4982, weighted_loss: 0.4435, label: 0, bag_size: 23335
batch 699, loss: 0.8887, instance_loss: 0.6285, weighted_loss: 0.8106, label: 1, bag_size: 3983
batch 719, loss: 0.4117, instance_loss: 0.6599, weighted_loss: 0.4862, label: 0, bag_size: 1652
batch 739, loss: 0.3505, instance_loss: 0.4766, weighted_loss: 0.3884, label: 0, bag_size: 5585


class 0 clustering acc 0.9798657718120806: correct 17520/17880
class 1 clustering acc 0.1901006711409396: correct 1133/5960
Epoch: 11, train_loss: 0.6916, train_clustering_loss:  0.6075, train_error: 0.2819
class 0: acc 0.7433962264150943, correct 197/265
class 1: acc 0.6169354838709677, correct 153/248
class 2: acc 0.7974137931034483, correct 185/232

Val Set, val_loss: 0.8994, val_error: 0.3404, auc: 0.7658
class 0 clustering acc 0.9534574468085106: correct 2151/2256
class 1 clustering acc 0.3776595744680851: correct 284/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3551, instance_loss: 0.5161, weighted_loss: 0.4034, label: 1, bag_size: 700
batch 39, loss: 0.0775, instance_loss: 0.1043, weighted_loss: 0.0856, label: 2, bag_size: 4056
batch 59, loss: 0.2486, instance_loss: 0.3535, weighted_loss: 0.2800, label: 1, bag_size: 4812
batch 79, loss: 0.8426, instance_loss: 0.7365, weighted_loss: 0.8108, label: 0, bag_size: 8866
batch 99, loss: 1.3709, instance_loss: 0.7781, weighted_loss: 1.1930, label: 0, bag_size: 1492
batch 119, loss: 0.6591, instance_loss: 0.7654, weighted_loss: 0.6910, label: 1, bag_size: 2182
batch 139, loss: 0.0513, instance_loss: 0.1685, weighted_loss: 0.0864, label: 2, bag_size: 2422
batch 159, loss: 0.1161, instance_loss: 0.2309, weighted_loss: 0.1505, label: 2, bag_size: 2209
batch 179, loss: 0.2057, instance_loss: 0.4421, weighted_loss: 0.2766, label: 0, bag_size: 3530
batch 199, loss: 0.1274, instance_loss: 0.3919, weighted_loss: 0.2068, label: 1, bag_size: 596
batch 219, loss: 0.0249, instance_loss: 0.1068, weighted_loss: 0.0494, label: 2, bag_size: 6148
batch 239, loss: 0.3090, instance_loss: 0.6943, weighted_loss: 0.4246, label: 1, bag_size: 6156
batch 259, loss: 0.4643, instance_loss: 0.8681, weighted_loss: 0.5854, label: 1, bag_size: 1580
batch 279, loss: 0.6666, instance_loss: 0.6096, weighted_loss: 0.6495, label: 1, bag_size: 2747
batch 299, loss: 0.9372, instance_loss: 0.7927, weighted_loss: 0.8939, label: 0, bag_size: 3316
batch 319, loss: 0.1239, instance_loss: 0.5915, weighted_loss: 0.2642, label: 1, bag_size: 5026
batch 339, loss: 0.1016, instance_loss: 0.2118, weighted_loss: 0.1347, label: 2, bag_size: 2254
batch 359, loss: 1.3637, instance_loss: 1.0081, weighted_loss: 1.2570, label: 1, bag_size: 3016
batch 379, loss: 0.1244, instance_loss: 0.4669, weighted_loss: 0.2272, label: 1, bag_size: 5086
batch 399, loss: 0.5858, instance_loss: 0.8229, weighted_loss: 0.6569, label: 1, bag_size: 1542
batch 419, loss: 0.2743, instance_loss: 0.2564, weighted_loss: 0.2690, label: 0, bag_size: 4604
batch 439, loss: 0.3689, instance_loss: 0.5837, weighted_loss: 0.4333, label: 1, bag_size: 2859
batch 459, loss: 0.2977, instance_loss: 0.5252, weighted_loss: 0.3660, label: 0, bag_size: 3188
batch 479, loss: 0.7821, instance_loss: 0.7050, weighted_loss: 0.7590, label: 1, bag_size: 1607
batch 499, loss: 0.6719, instance_loss: 0.6489, weighted_loss: 0.6650, label: 1, bag_size: 4824
batch 519, loss: 2.0287, instance_loss: 1.2809, weighted_loss: 1.8043, label: 0, bag_size: 1341
batch 539, loss: 0.0366, instance_loss: 0.2223, weighted_loss: 0.0923, label: 2, bag_size: 4856
batch 559, loss: 0.0011, instance_loss: 0.1235, weighted_loss: 0.0379, label: 0, bag_size: 3298
batch 579, loss: 0.5663, instance_loss: 0.5448, weighted_loss: 0.5598, label: 1, bag_size: 1500
batch 599, loss: 0.1668, instance_loss: 0.5468, weighted_loss: 0.2808, label: 2, bag_size: 5017
batch 619, loss: 1.1779, instance_loss: 0.7597, weighted_loss: 1.0525, label: 2, bag_size: 1513
batch 639, loss: 0.0858, instance_loss: 0.1945, weighted_loss: 0.1184, label: 1, bag_size: 425
batch 659, loss: 0.5741, instance_loss: 0.5654, weighted_loss: 0.5715, label: 1, bag_size: 2744
batch 679, loss: 0.0700, instance_loss: 0.2133, weighted_loss: 0.1130, label: 0, bag_size: 5170
batch 699, loss: 0.9672, instance_loss: 0.5655, weighted_loss: 0.8467, label: 1, bag_size: 1250
batch 719, loss: 0.0255, instance_loss: 0.0948, weighted_loss: 0.0463, label: 2, bag_size: 3285
batch 739, loss: 0.6654, instance_loss: 0.8708, weighted_loss: 0.7270, label: 0, bag_size: 3268


class 0 clustering acc 0.9757829977628635: correct 17447/17880
class 1 clustering acc 0.27298657718120806: correct 1627/5960
Epoch: 12, train_loss: 0.6229, train_clustering_loss:  0.5770, train_error: 0.2631
class 0: acc 0.7740585774058577, correct 185/239
class 1: acc 0.6352941176470588, correct 162/255
class 2: acc 0.8047808764940239, correct 202/251

Val Set, val_loss: 0.8760, val_error: 0.3191, auc: 0.7754
class 0 clustering acc 0.9618794326241135: correct 2170/2256
class 1 clustering acc 0.2925531914893617: correct 220/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2781, instance_loss: 0.8266, weighted_loss: 1.1427, label: 0, bag_size: 726
batch 39, loss: 1.2329, instance_loss: 1.0434, weighted_loss: 1.1761, label: 0, bag_size: 4547
batch 59, loss: 0.9197, instance_loss: 0.6048, weighted_loss: 0.8253, label: 2, bag_size: 88
batch 79, loss: 1.3702, instance_loss: 0.8970, weighted_loss: 1.2283, label: 0, bag_size: 1562
batch 99, loss: 0.1794, instance_loss: 0.4560, weighted_loss: 0.2624, label: 0, bag_size: 673
batch 119, loss: 0.1696, instance_loss: 0.1984, weighted_loss: 0.1782, label: 2, bag_size: 3094
batch 139, loss: 0.7216, instance_loss: 0.6796, weighted_loss: 0.7090, label: 1, bag_size: 3885
batch 159, loss: 1.7401, instance_loss: 1.0323, weighted_loss: 1.5278, label: 1, bag_size: 5402
batch 179, loss: 0.1536, instance_loss: 0.2717, weighted_loss: 0.1890, label: 0, bag_size: 1495
batch 199, loss: 0.6355, instance_loss: 0.7227, weighted_loss: 0.6617, label: 0, bag_size: 4178
batch 219, loss: 0.1284, instance_loss: 0.3065, weighted_loss: 0.1818, label: 1, bag_size: 2494
batch 239, loss: 0.0689, instance_loss: 0.4286, weighted_loss: 0.1768, label: 1, bag_size: 5086
batch 259, loss: 0.2980, instance_loss: 0.5458, weighted_loss: 0.3724, label: 2, bag_size: 4162
batch 279, loss: 0.2876, instance_loss: 0.3726, weighted_loss: 0.3131, label: 2, bag_size: 3227
batch 299, loss: 0.2697, instance_loss: 0.5765, weighted_loss: 0.3618, label: 2, bag_size: 4978
batch 319, loss: 0.4156, instance_loss: 0.5505, weighted_loss: 0.4561, label: 1, bag_size: 3221
batch 339, loss: 1.1348, instance_loss: 0.9062, weighted_loss: 1.0662, label: 1, bag_size: 4395
batch 359, loss: 0.1888, instance_loss: 0.4906, weighted_loss: 0.2793, label: 1, bag_size: 1394
batch 379, loss: 0.0730, instance_loss: 0.1703, weighted_loss: 0.1022, label: 2, bag_size: 5924
batch 399, loss: 0.6024, instance_loss: 0.4861, weighted_loss: 0.5675, label: 0, bag_size: 4921
batch 419, loss: 0.6847, instance_loss: 0.5069, weighted_loss: 0.6314, label: 1, bag_size: 3885
batch 439, loss: 0.3723, instance_loss: 0.6198, weighted_loss: 0.4466, label: 1, bag_size: 3127
batch 459, loss: 0.1276, instance_loss: 0.5546, weighted_loss: 0.2557, label: 2, bag_size: 3607
batch 479, loss: 0.5388, instance_loss: 0.7895, weighted_loss: 0.6140, label: 2, bag_size: 22464
batch 499, loss: 0.1343, instance_loss: 0.5160, weighted_loss: 0.2488, label: 2, bag_size: 4555
batch 519, loss: 1.6508, instance_loss: 1.1011, weighted_loss: 1.4859, label: 1, bag_size: 1510
batch 539, loss: 0.1529, instance_loss: 0.1788, weighted_loss: 0.1607, label: 2, bag_size: 3094
batch 559, loss: 1.0601, instance_loss: 0.8512, weighted_loss: 0.9974, label: 2, bag_size: 1050
batch 579, loss: 2.2012, instance_loss: 1.1540, weighted_loss: 1.8871, label: 1, bag_size: 5205
batch 599, loss: 1.0423, instance_loss: 0.8158, weighted_loss: 0.9743, label: 0, bag_size: 1904
batch 619, loss: 0.1120, instance_loss: 0.1226, weighted_loss: 0.1152, label: 2, bag_size: 1094
batch 639, loss: 0.0000, instance_loss: 0.4846, weighted_loss: 0.1454, label: 0, bag_size: 5487
batch 659, loss: 1.4812, instance_loss: 1.1022, weighted_loss: 1.3675, label: 1, bag_size: 936
batch 679, loss: 0.1726, instance_loss: 0.1767, weighted_loss: 0.1738, label: 2, bag_size: 3094
batch 699, loss: 0.0691, instance_loss: 0.2655, weighted_loss: 0.1280, label: 1, bag_size: 582
batch 719, loss: 0.0183, instance_loss: 0.0699, weighted_loss: 0.0338, label: 2, bag_size: 6001
batch 739, loss: 0.0542, instance_loss: 0.5156, weighted_loss: 0.1926, label: 2, bag_size: 4497


class 0 clustering acc 0.9749440715883669: correct 17432/17880
class 1 clustering acc 0.28070469798657716: correct 1673/5960
Epoch: 13, train_loss: 0.6306, train_clustering_loss:  0.5768, train_error: 0.2564
class 0: acc 0.7702127659574468, correct 181/235
class 1: acc 0.6188524590163934, correct 151/244
class 2: acc 0.8345864661654135, correct 222/266

Val Set, val_loss: 0.8897, val_error: 0.3723, auc: 0.7767
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.12632978723404256: correct 95/752
class 0: acc 0.6538461538461539, correct 34/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1542, instance_loss: 0.4307, weighted_loss: 0.2372, label: 0, bag_size: 1233
batch 39, loss: 0.3732, instance_loss: 0.5253, weighted_loss: 0.4188, label: 1, bag_size: 6817
batch 59, loss: 2.1070, instance_loss: 0.9797, weighted_loss: 1.7688, label: 2, bag_size: 7607
batch 79, loss: 0.1373, instance_loss: 0.4110, weighted_loss: 0.2194, label: 2, bag_size: 4140
batch 99, loss: 0.0799, instance_loss: 0.1974, weighted_loss: 0.1152, label: 2, bag_size: 5914
batch 119, loss: 0.1609, instance_loss: 0.6122, weighted_loss: 0.2963, label: 0, bag_size: 2293
batch 139, loss: 0.5422, instance_loss: 0.5344, weighted_loss: 0.5399, label: 2, bag_size: 4241
batch 159, loss: 0.1800, instance_loss: 0.2186, weighted_loss: 0.1916, label: 1, bag_size: 3009
batch 179, loss: 0.3093, instance_loss: 0.5588, weighted_loss: 0.3842, label: 0, bag_size: 1762
batch 199, loss: 1.6436, instance_loss: 1.1085, weighted_loss: 1.4831, label: 0, bag_size: 5840
batch 219, loss: 0.7942, instance_loss: 0.7764, weighted_loss: 0.7888, label: 0, bag_size: 3164
batch 239, loss: 3.1535, instance_loss: 1.5151, weighted_loss: 2.6620, label: 2, bag_size: 3475
batch 259, loss: 1.4474, instance_loss: 0.7599, weighted_loss: 1.2411, label: 1, bag_size: 3885
batch 279, loss: 0.5583, instance_loss: 0.5616, weighted_loss: 0.5593, label: 0, bag_size: 4725
batch 299, loss: 1.4517, instance_loss: 0.9349, weighted_loss: 1.2967, label: 0, bag_size: 1753
batch 319, loss: 0.5666, instance_loss: 0.5202, weighted_loss: 0.5527, label: 1, bag_size: 5412
batch 339, loss: 1.5082, instance_loss: 1.0897, weighted_loss: 1.3826, label: 2, bag_size: 4571
batch 359, loss: 0.0685, instance_loss: 0.2938, weighted_loss: 0.1361, label: 0, bag_size: 4857
batch 379, loss: 0.1052, instance_loss: 0.2576, weighted_loss: 0.1509, label: 2, bag_size: 3396
batch 399, loss: 0.0659, instance_loss: 0.1355, weighted_loss: 0.0868, label: 2, bag_size: 3210
batch 419, loss: 0.0517, instance_loss: 0.8517, weighted_loss: 0.2917, label: 0, bag_size: 2354
batch 439, loss: 0.3949, instance_loss: 0.5443, weighted_loss: 0.4398, label: 1, bag_size: 3534
batch 459, loss: 0.0331, instance_loss: 0.1175, weighted_loss: 0.0584, label: 1, bag_size: 259
batch 479, loss: 0.0164, instance_loss: 0.0437, weighted_loss: 0.0246, label: 2, bag_size: 657
batch 499, loss: 0.8011, instance_loss: 0.5922, weighted_loss: 0.7384, label: 1, bag_size: 3403
batch 519, loss: 0.2261, instance_loss: 0.2047, weighted_loss: 0.2197, label: 2, bag_size: 2501
batch 539, loss: 0.0058, instance_loss: 0.9496, weighted_loss: 0.2890, label: 0, bag_size: 2028
batch 559, loss: 1.9843, instance_loss: 0.8407, weighted_loss: 1.6412, label: 0, bag_size: 2217
batch 579, loss: 0.1348, instance_loss: 0.2919, weighted_loss: 0.1820, label: 2, bag_size: 4302
batch 599, loss: 0.3446, instance_loss: 0.4240, weighted_loss: 0.3684, label: 2, bag_size: 3080
batch 619, loss: 0.1907, instance_loss: 0.4619, weighted_loss: 0.2720, label: 2, bag_size: 3210
batch 639, loss: 0.2648, instance_loss: 0.7153, weighted_loss: 0.4000, label: 1, bag_size: 2962
batch 659, loss: 0.0571, instance_loss: 0.2219, weighted_loss: 0.1066, label: 2, bag_size: 3583
batch 679, loss: 0.2213, instance_loss: 0.3879, weighted_loss: 0.2713, label: 1, bag_size: 2870
batch 699, loss: 1.0689, instance_loss: 0.7751, weighted_loss: 0.9808, label: 0, bag_size: 2597
batch 719, loss: 1.4069, instance_loss: 0.8692, weighted_loss: 1.2456, label: 1, bag_size: 1712
batch 739, loss: 0.0793, instance_loss: 0.3615, weighted_loss: 0.1639, label: 0, bag_size: 2038


class 0 clustering acc 0.9772930648769574: correct 17474/17880
class 1 clustering acc 0.27818791946308724: correct 1658/5960
Epoch: 14, train_loss: 0.6505, train_clustering_loss:  0.5770, train_error: 0.2779
class 0: acc 0.7455357142857143, correct 167/224
class 1: acc 0.6332046332046332, correct 164/259
class 2: acc 0.7900763358778626, correct 207/262

Val Set, val_loss: 0.7706, val_error: 0.2872, auc: 0.8080
class 0 clustering acc 0.9499113475177305: correct 2143/2256
class 1 clustering acc 0.3670212765957447: correct 276/752
class 0: acc 0.8846153846153846, correct 46/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1128, instance_loss: 0.1902, weighted_loss: 0.1360, label: 2, bag_size: 2049
batch 39, loss: 0.3192, instance_loss: 0.5378, weighted_loss: 0.3847, label: 1, bag_size: 4534
batch 59, loss: 0.8983, instance_loss: 0.9193, weighted_loss: 0.9046, label: 1, bag_size: 4262
batch 79, loss: 1.2283, instance_loss: 0.9243, weighted_loss: 1.1371, label: 1, bag_size: 817
batch 99, loss: 0.3032, instance_loss: 0.5686, weighted_loss: 0.3829, label: 2, bag_size: 3604
batch 119, loss: 0.7827, instance_loss: 0.6091, weighted_loss: 0.7306, label: 1, bag_size: 2083
batch 139, loss: 1.2523, instance_loss: 0.6913, weighted_loss: 1.0840, label: 0, bag_size: 7077
batch 159, loss: 1.3465, instance_loss: 0.8594, weighted_loss: 1.2003, label: 2, bag_size: 5743
batch 179, loss: 0.6780, instance_loss: 0.9094, weighted_loss: 0.7474, label: 1, bag_size: 10941
batch 199, loss: 0.1968, instance_loss: 0.2471, weighted_loss: 0.2119, label: 2, bag_size: 3546
batch 219, loss: 0.0000, instance_loss: 0.0604, weighted_loss: 0.0181, label: 0, bag_size: 4582
batch 239, loss: 0.1492, instance_loss: 0.3710, weighted_loss: 0.2158, label: 2, bag_size: 4302
batch 259, loss: 0.0135, instance_loss: 0.0873, weighted_loss: 0.0356, label: 2, bag_size: 4856
batch 279, loss: 0.8838, instance_loss: 0.7038, weighted_loss: 0.8298, label: 1, bag_size: 1161
batch 299, loss: 0.0361, instance_loss: 0.4865, weighted_loss: 0.1712, label: 0, bag_size: 1341
batch 319, loss: 0.5205, instance_loss: 0.3917, weighted_loss: 0.4819, label: 1, bag_size: 209
batch 339, loss: 0.1027, instance_loss: 0.1345, weighted_loss: 0.1123, label: 2, bag_size: 2313
batch 359, loss: 0.9572, instance_loss: 0.8034, weighted_loss: 0.9110, label: 1, bag_size: 2302
batch 379, loss: 0.3727, instance_loss: 0.4422, weighted_loss: 0.3935, label: 2, bag_size: 2561
batch 399, loss: 0.0288, instance_loss: 0.0867, weighted_loss: 0.0461, label: 2, bag_size: 614
batch 419, loss: 1.4401, instance_loss: 1.1309, weighted_loss: 1.3473, label: 2, bag_size: 724
batch 439, loss: 0.2286, instance_loss: 0.5059, weighted_loss: 0.3118, label: 2, bag_size: 5017
batch 459, loss: 2.1676, instance_loss: 1.6133, weighted_loss: 2.0013, label: 0, bag_size: 621
batch 479, loss: 0.9342, instance_loss: 0.7003, weighted_loss: 0.8640, label: 1, bag_size: 1307
batch 499, loss: 0.2164, instance_loss: 0.3839, weighted_loss: 0.2666, label: 0, bag_size: 1097
batch 519, loss: 0.6144, instance_loss: 0.5887, weighted_loss: 0.6067, label: 1, bag_size: 2744
batch 539, loss: 1.4184, instance_loss: 0.7650, weighted_loss: 1.2224, label: 0, bag_size: 4220
batch 559, loss: 1.6238, instance_loss: 1.3500, weighted_loss: 1.5416, label: 1, bag_size: 3016
batch 579, loss: 0.3283, instance_loss: 0.6269, weighted_loss: 0.4178, label: 0, bag_size: 3188
batch 599, loss: 0.0457, instance_loss: 0.0544, weighted_loss: 0.0483, label: 2, bag_size: 3678
batch 619, loss: 0.3636, instance_loss: 0.5720, weighted_loss: 0.4262, label: 2, bag_size: 4569
batch 639, loss: 0.0397, instance_loss: 0.3552, weighted_loss: 0.1344, label: 1, bag_size: 4111
batch 659, loss: 0.0105, instance_loss: 0.2767, weighted_loss: 0.0904, label: 1, bag_size: 5018
batch 679, loss: 0.1949, instance_loss: 0.6807, weighted_loss: 0.3407, label: 0, bag_size: 1611
batch 699, loss: 0.2613, instance_loss: 0.6133, weighted_loss: 0.3669, label: 1, bag_size: 5385
batch 719, loss: 0.9056, instance_loss: 0.6984, weighted_loss: 0.8434, label: 1, bag_size: 782
batch 739, loss: 0.1042, instance_loss: 0.1923, weighted_loss: 0.1306, label: 2, bag_size: 4043


class 0 clustering acc 0.9738814317673378: correct 17413/17880
class 1 clustering acc 0.2924496644295302: correct 1743/5960
Epoch: 15, train_loss: 0.6332, train_clustering_loss:  0.5744, train_error: 0.2711
class 0: acc 0.7509881422924901, correct 190/253
class 1: acc 0.6731517509727627, correct 173/257
class 2: acc 0.7659574468085106, correct 180/235

Val Set, val_loss: 0.7764, val_error: 0.3191, auc: 0.7971
class 0 clustering acc 0.9423758865248227: correct 2126/2256
class 1 clustering acc 0.4002659574468085: correct 301/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.4, correct 12/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0483, instance_loss: 0.2588, weighted_loss: 0.1115, label: 0, bag_size: 4644
batch 39, loss: 2.6243, instance_loss: 1.4360, weighted_loss: 2.2678, label: 0, bag_size: 1886
batch 59, loss: 0.7975, instance_loss: 0.6710, weighted_loss: 0.7595, label: 2, bag_size: 3227
batch 79, loss: 0.3438, instance_loss: 0.4402, weighted_loss: 0.3727, label: 0, bag_size: 1170
batch 99, loss: 0.1267, instance_loss: 0.2029, weighted_loss: 0.1496, label: 2, bag_size: 3678
batch 119, loss: 1.2093, instance_loss: 0.8794, weighted_loss: 1.1103, label: 1, bag_size: 475
batch 139, loss: 0.7530, instance_loss: 0.5980, weighted_loss: 0.7065, label: 2, bag_size: 4096
batch 159, loss: 0.0029, instance_loss: 0.1450, weighted_loss: 0.0455, label: 1, bag_size: 4134
batch 179, loss: 0.7851, instance_loss: 0.8591, weighted_loss: 0.8073, label: 1, bag_size: 7176
batch 199, loss: 0.0548, instance_loss: 0.1192, weighted_loss: 0.0741, label: 2, bag_size: 3678
batch 219, loss: 0.0116, instance_loss: 0.0464, weighted_loss: 0.0220, label: 2, bag_size: 3285
batch 239, loss: 1.1346, instance_loss: 0.7726, weighted_loss: 1.0260, label: 1, bag_size: 5072
batch 259, loss: 0.4144, instance_loss: 0.6485, weighted_loss: 0.4846, label: 1, bag_size: 10941
batch 279, loss: 2.0674, instance_loss: 1.0894, weighted_loss: 1.7740, label: 0, bag_size: 5867
batch 299, loss: 0.2389, instance_loss: 0.3109, weighted_loss: 0.2605, label: 0, bag_size: 3833
batch 319, loss: 0.3454, instance_loss: 0.2536, weighted_loss: 0.3179, label: 2, bag_size: 3678
batch 339, loss: 0.1087, instance_loss: 0.4973, weighted_loss: 0.2253, label: 2, bag_size: 4141
batch 359, loss: 0.0165, instance_loss: 0.1434, weighted_loss: 0.0546, label: 0, bag_size: 5029
batch 379, loss: 0.1366, instance_loss: 0.5746, weighted_loss: 0.2680, label: 0, bag_size: 2293
batch 399, loss: 1.0589, instance_loss: 0.7566, weighted_loss: 0.9682, label: 1, bag_size: 578
batch 419, loss: 0.2436, instance_loss: 0.5167, weighted_loss: 0.3255, label: 0, bag_size: 3188
batch 439, loss: 1.2281, instance_loss: 1.2025, weighted_loss: 1.2204, label: 2, bag_size: 22464
batch 459, loss: 0.0247, instance_loss: 0.1580, weighted_loss: 0.0647, label: 0, bag_size: 7595
batch 479, loss: 0.3598, instance_loss: 0.4757, weighted_loss: 0.3945, label: 0, bag_size: 4310
batch 499, loss: 0.1381, instance_loss: 0.2673, weighted_loss: 0.1769, label: 2, bag_size: 4203
batch 519, loss: 0.0088, instance_loss: 0.1501, weighted_loss: 0.0512, label: 0, bag_size: 1981
batch 539, loss: 1.4068, instance_loss: 1.0999, weighted_loss: 1.3148, label: 0, bag_size: 6249
batch 559, loss: 0.2353, instance_loss: 0.4339, weighted_loss: 0.2949, label: 1, bag_size: 8482
batch 579, loss: 0.0809, instance_loss: 0.2265, weighted_loss: 0.1246, label: 1, bag_size: 425
batch 599, loss: 0.1360, instance_loss: 0.1111, weighted_loss: 0.1286, label: 2, bag_size: 1103
batch 619, loss: 0.1360, instance_loss: 0.5160, weighted_loss: 0.2500, label: 0, bag_size: 1611
batch 639, loss: 0.0037, instance_loss: 0.1043, weighted_loss: 0.0339, label: 1, bag_size: 4134
batch 659, loss: 0.0880, instance_loss: 0.2493, weighted_loss: 0.1364, label: 0, bag_size: 2479
batch 679, loss: 0.4151, instance_loss: 0.3741, weighted_loss: 0.4028, label: 2, bag_size: 2031
batch 699, loss: 0.0174, instance_loss: 0.0874, weighted_loss: 0.0384, label: 2, bag_size: 6148
batch 719, loss: 0.0508, instance_loss: 0.1692, weighted_loss: 0.0863, label: 2, bag_size: 4775
batch 739, loss: 0.1584, instance_loss: 0.3562, weighted_loss: 0.2178, label: 0, bag_size: 2601


class 0 clustering acc 0.9717561521252797: correct 17375/17880
class 1 clustering acc 0.3667785234899329: correct 2186/5960
Epoch: 16, train_loss: 0.5662, train_clustering_loss:  0.5401, train_error: 0.2389
class 0: acc 0.8045112781954887, correct 214/266
class 1: acc 0.6379310344827587, correct 148/232
class 2: acc 0.8299595141700404, correct 205/247

Val Set, val_loss: 0.8326, val_error: 0.3191, auc: 0.7928
class 0 clustering acc 0.9432624113475178: correct 2128/2256
class 1 clustering acc 0.32180851063829785: correct 242/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0484, instance_loss: 0.1572, weighted_loss: 0.0810, label: 2, bag_size: 3397
batch 39, loss: 1.2196, instance_loss: 0.7907, weighted_loss: 1.0909, label: 1, bag_size: 3823
batch 59, loss: 0.0077, instance_loss: 0.0678, weighted_loss: 0.0257, label: 2, bag_size: 3497
batch 79, loss: 0.4294, instance_loss: 0.5101, weighted_loss: 0.4536, label: 1, bag_size: 1197
batch 99, loss: 0.8954, instance_loss: 0.7697, weighted_loss: 0.8577, label: 1, bag_size: 3106
batch 119, loss: 1.5522, instance_loss: 0.7465, weighted_loss: 1.3105, label: 0, bag_size: 2915
batch 139, loss: 2.0799, instance_loss: 1.0768, weighted_loss: 1.7790, label: 2, bag_size: 3475
batch 159, loss: 2.5853, instance_loss: 1.1683, weighted_loss: 2.1602, label: 0, bag_size: 1755
batch 179, loss: 0.0668, instance_loss: 0.8235, weighted_loss: 0.2938, label: 0, bag_size: 3872
batch 199, loss: 0.2160, instance_loss: 0.3615, weighted_loss: 0.2596, label: 1, bag_size: 2494
batch 219, loss: 0.0326, instance_loss: 0.1185, weighted_loss: 0.0583, label: 2, bag_size: 3285
batch 239, loss: 1.1543, instance_loss: 1.0344, weighted_loss: 1.1183, label: 1, bag_size: 4612
batch 259, loss: 0.4587, instance_loss: 0.6191, weighted_loss: 0.5068, label: 0, bag_size: 5585
batch 279, loss: 0.3978, instance_loss: 0.5027, weighted_loss: 0.4293, label: 0, bag_size: 4946
batch 299, loss: 0.1056, instance_loss: 0.1809, weighted_loss: 0.1282, label: 2, bag_size: 614
batch 319, loss: 0.0276, instance_loss: 0.2480, weighted_loss: 0.0937, label: 2, bag_size: 4372
batch 339, loss: 1.8414, instance_loss: 1.4721, weighted_loss: 1.7306, label: 0, bag_size: 1562
batch 359, loss: 0.1601, instance_loss: 0.3440, weighted_loss: 0.2153, label: 0, bag_size: 4584
batch 379, loss: 2.1312, instance_loss: 1.5333, weighted_loss: 1.9519, label: 0, bag_size: 3419
batch 399, loss: 0.5196, instance_loss: 0.7092, weighted_loss: 0.5765, label: 0, bag_size: 4228
batch 419, loss: 0.8066, instance_loss: 0.6166, weighted_loss: 0.7496, label: 2, bag_size: 5406
batch 439, loss: 0.2089, instance_loss: 0.4551, weighted_loss: 0.2827, label: 0, bag_size: 5519
batch 459, loss: 0.1027, instance_loss: 0.6155, weighted_loss: 0.2565, label: 0, bag_size: 2826
batch 479, loss: 0.3912, instance_loss: 0.5869, weighted_loss: 0.4499, label: 1, bag_size: 6156
batch 499, loss: 0.0966, instance_loss: 0.3814, weighted_loss: 0.1820, label: 2, bag_size: 5138
batch 519, loss: 0.0367, instance_loss: 0.1150, weighted_loss: 0.0602, label: 2, bag_size: 4088
batch 539, loss: 0.7509, instance_loss: 0.6943, weighted_loss: 0.7339, label: 2, bag_size: 2486
batch 559, loss: 0.0976, instance_loss: 0.4140, weighted_loss: 0.1925, label: 1, bag_size: 3493
batch 579, loss: 0.1119, instance_loss: 0.2432, weighted_loss: 0.1513, label: 0, bag_size: 4570
batch 599, loss: 0.0974, instance_loss: 0.2781, weighted_loss: 0.1516, label: 0, bag_size: 4165
batch 619, loss: 0.0153, instance_loss: 0.1254, weighted_loss: 0.0484, label: 0, bag_size: 2339
batch 639, loss: 1.5381, instance_loss: 0.9914, weighted_loss: 1.3741, label: 1, bag_size: 5693
batch 659, loss: 0.4520, instance_loss: 0.6154, weighted_loss: 0.5010, label: 1, bag_size: 4373
batch 679, loss: 0.0045, instance_loss: 0.2431, weighted_loss: 0.0761, label: 1, bag_size: 4111
batch 699, loss: 0.3911, instance_loss: 0.6159, weighted_loss: 0.4585, label: 1, bag_size: 3604
batch 719, loss: 1.2740, instance_loss: 0.8087, weighted_loss: 1.1344, label: 1, bag_size: 5276
batch 739, loss: 0.5582, instance_loss: 0.6639, weighted_loss: 0.5899, label: 1, bag_size: 4784


class 0 clustering acc 0.9701342281879195: correct 17346/17880
class 1 clustering acc 0.3585570469798658: correct 2137/5960
Epoch: 17, train_loss: 0.5902, train_clustering_loss:  0.5548, train_error: 0.2376
class 0: acc 0.796078431372549, correct 203/255
class 1: acc 0.6610169491525424, correct 156/236
class 2: acc 0.8228346456692913, correct 209/254

Val Set, val_loss: 0.9924, val_error: 0.3936, auc: 0.7770
class 0 clustering acc 0.9570035460992907: correct 2159/2256
class 1 clustering acc 0.18351063829787234: correct 138/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1567, instance_loss: 0.2438, weighted_loss: 0.1828, label: 0, bag_size: 3348
batch 39, loss: 0.0768, instance_loss: 0.1609, weighted_loss: 0.1020, label: 1, bag_size: 2878
batch 59, loss: 0.3618, instance_loss: 0.2136, weighted_loss: 0.3173, label: 2, bag_size: 3094
batch 79, loss: 0.7292, instance_loss: 0.8727, weighted_loss: 0.7722, label: 2, bag_size: 22464
batch 99, loss: 0.1358, instance_loss: 0.1350, weighted_loss: 0.1355, label: 2, bag_size: 3227
batch 119, loss: 0.0451, instance_loss: 0.2642, weighted_loss: 0.1108, label: 0, bag_size: 4914
batch 139, loss: 0.4485, instance_loss: 0.5811, weighted_loss: 0.4883, label: 1, bag_size: 4940
batch 159, loss: 0.1976, instance_loss: 0.4130, weighted_loss: 0.2622, label: 2, bag_size: 4775
batch 179, loss: 0.1435, instance_loss: 0.1818, weighted_loss: 0.1550, label: 2, bag_size: 1103
batch 199, loss: 0.3978, instance_loss: 0.3845, weighted_loss: 0.3938, label: 2, bag_size: 4569
batch 219, loss: 0.1049, instance_loss: 0.3446, weighted_loss: 0.1768, label: 0, bag_size: 1640
batch 239, loss: 0.1809, instance_loss: 0.5717, weighted_loss: 0.2981, label: 1, bag_size: 4119
batch 259, loss: 1.3786, instance_loss: 1.1818, weighted_loss: 1.3195, label: 1, bag_size: 2319
batch 279, loss: 1.1978, instance_loss: 0.8072, weighted_loss: 1.0807, label: 2, bag_size: 88
batch 299, loss: 0.0410, instance_loss: 0.3417, weighted_loss: 0.1312, label: 2, bag_size: 4203
batch 319, loss: 0.0799, instance_loss: 0.3520, weighted_loss: 0.1615, label: 0, bag_size: 4606
batch 339, loss: 1.2772, instance_loss: 0.7240, weighted_loss: 1.1113, label: 2, bag_size: 6298
batch 359, loss: 0.3796, instance_loss: 0.4960, weighted_loss: 0.4145, label: 1, bag_size: 4705
batch 379, loss: 0.0902, instance_loss: 0.3476, weighted_loss: 0.1674, label: 0, bag_size: 2487
batch 399, loss: 0.9126, instance_loss: 0.7987, weighted_loss: 0.8784, label: 1, bag_size: 3106
batch 419, loss: 0.7852, instance_loss: 0.5615, weighted_loss: 0.7181, label: 0, bag_size: 4201
batch 439, loss: 1.5726, instance_loss: 1.1304, weighted_loss: 1.4399, label: 2, bag_size: 4342
batch 459, loss: 0.0731, instance_loss: 0.2299, weighted_loss: 0.1201, label: 0, bag_size: 3443
batch 479, loss: 1.4228, instance_loss: 0.8888, weighted_loss: 1.2626, label: 1, bag_size: 5011
batch 499, loss: 0.0758, instance_loss: 0.1572, weighted_loss: 0.1002, label: 2, bag_size: 4302
batch 519, loss: 0.1728, instance_loss: 0.2411, weighted_loss: 0.1933, label: 0, bag_size: 4741
batch 539, loss: 0.0876, instance_loss: 0.2378, weighted_loss: 0.1326, label: 2, bag_size: 3094
batch 559, loss: 0.1015, instance_loss: 0.2616, weighted_loss: 0.1495, label: 0, bag_size: 4015
batch 579, loss: 0.1961, instance_loss: 0.4397, weighted_loss: 0.2692, label: 1, bag_size: 4119
batch 599, loss: 0.1654, instance_loss: 0.5966, weighted_loss: 0.2947, label: 0, bag_size: 5646
batch 619, loss: 0.0406, instance_loss: 0.1533, weighted_loss: 0.0744, label: 2, bag_size: 6026
batch 639, loss: 0.2502, instance_loss: 0.6931, weighted_loss: 0.3831, label: 1, bag_size: 6315
batch 659, loss: 0.8523, instance_loss: 0.9693, weighted_loss: 0.8874, label: 0, bag_size: 889
batch 679, loss: 1.0824, instance_loss: 0.7609, weighted_loss: 0.9859, label: 1, bag_size: 2743
batch 699, loss: 0.0702, instance_loss: 0.3426, weighted_loss: 0.1520, label: 0, bag_size: 1385
batch 719, loss: 1.4643, instance_loss: 0.8412, weighted_loss: 1.2774, label: 0, bag_size: 5526
batch 739, loss: 0.0936, instance_loss: 0.4578, weighted_loss: 0.2029, label: 0, bag_size: 3936


class 0 clustering acc 0.9728187919463087: correct 17394/17880
class 1 clustering acc 0.3226510067114094: correct 1923/5960
Epoch: 18, train_loss: 0.6061, train_clustering_loss:  0.5637, train_error: 0.2604
class 0: acc 0.769811320754717, correct 204/265
class 1: acc 0.6403162055335968, correct 162/253
class 2: acc 0.8149779735682819, correct 185/227

Val Set, val_loss: 0.8281, val_error: 0.3085, auc: 0.8136
class 0 clustering acc 0.9335106382978723: correct 2106/2256
class 1 clustering acc 0.42819148936170215: correct 322/752
class 0: acc 0.9615384615384616, correct 50/52
class 1: acc 0.3333333333333333, correct 10/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2467, instance_loss: 0.4159, weighted_loss: 0.2975, label: 1, bag_size: 3051
batch 39, loss: 0.0452, instance_loss: 0.2846, weighted_loss: 0.1170, label: 2, bag_size: 4745
batch 59, loss: 0.5567, instance_loss: 0.6564, weighted_loss: 0.5866, label: 1, bag_size: 7109
batch 79, loss: 0.1421, instance_loss: 0.4995, weighted_loss: 0.2493, label: 0, bag_size: 5282
batch 99, loss: 1.4668, instance_loss: 0.8782, weighted_loss: 1.2902, label: 1, bag_size: 5072
batch 119, loss: 0.0003, instance_loss: 0.4555, weighted_loss: 0.1369, label: 0, bag_size: 1106
batch 139, loss: 0.3437, instance_loss: 0.6245, weighted_loss: 0.4279, label: 2, bag_size: 3746
batch 159, loss: 0.0602, instance_loss: 0.2045, weighted_loss: 0.1035, label: 2, bag_size: 2561
batch 179, loss: 0.0292, instance_loss: 0.0875, weighted_loss: 0.0467, label: 2, bag_size: 3678
batch 199, loss: 0.3862, instance_loss: 0.7236, weighted_loss: 0.4874, label: 0, bag_size: 3164
batch 219, loss: 0.1725, instance_loss: 0.3466, weighted_loss: 0.2247, label: 0, bag_size: 5646
batch 239, loss: 0.2802, instance_loss: 0.3588, weighted_loss: 0.3038, label: 2, bag_size: 597
batch 259, loss: 0.1841, instance_loss: 0.3430, weighted_loss: 0.2317, label: 0, bag_size: 7169
batch 279, loss: 0.0346, instance_loss: 0.4236, weighted_loss: 0.1513, label: 1, bag_size: 4898
batch 299, loss: 0.1491, instance_loss: 0.3993, weighted_loss: 0.2241, label: 1, bag_size: 8482
batch 319, loss: 0.2945, instance_loss: 0.2892, weighted_loss: 0.2929, label: 1, bag_size: 2945
batch 339, loss: 2.0159, instance_loss: 1.0270, weighted_loss: 1.7192, label: 0, bag_size: 2392
batch 359, loss: 0.0400, instance_loss: 0.2211, weighted_loss: 0.0943, label: 0, bag_size: 2487
batch 379, loss: 2.2503, instance_loss: 0.8388, weighted_loss: 1.8268, label: 0, bag_size: 18038
batch 399, loss: 0.0956, instance_loss: 0.4552, weighted_loss: 0.2035, label: 0, bag_size: 4529
batch 419, loss: 1.1253, instance_loss: 0.6938, weighted_loss: 0.9959, label: 1, bag_size: 4806
batch 439, loss: 0.3666, instance_loss: 0.6497, weighted_loss: 0.4516, label: 2, bag_size: 3174
batch 459, loss: 0.3437, instance_loss: 0.4043, weighted_loss: 0.3619, label: 2, bag_size: 3546
batch 479, loss: 0.9152, instance_loss: 0.8578, weighted_loss: 0.8980, label: 2, bag_size: 4291
batch 499, loss: 1.2350, instance_loss: 0.7152, weighted_loss: 1.0790, label: 1, bag_size: 4262
batch 519, loss: 0.0208, instance_loss: 0.1474, weighted_loss: 0.0588, label: 2, bag_size: 4856
batch 539, loss: 0.2722, instance_loss: 0.3211, weighted_loss: 0.2868, label: 0, bag_size: 5373
batch 559, loss: 0.0501, instance_loss: 0.0668, weighted_loss: 0.0551, label: 2, bag_size: 4788
batch 579, loss: 0.0829, instance_loss: 0.2995, weighted_loss: 0.1479, label: 2, bag_size: 4978
batch 599, loss: 0.2253, instance_loss: 0.3606, weighted_loss: 0.2659, label: 0, bag_size: 3789
batch 619, loss: 0.5559, instance_loss: 0.4637, weighted_loss: 0.5283, label: 2, bag_size: 2813
batch 639, loss: 0.1963, instance_loss: 0.2028, weighted_loss: 0.1983, label: 2, bag_size: 2997
batch 659, loss: 0.7640, instance_loss: 0.6440, weighted_loss: 0.7280, label: 1, bag_size: 2083
batch 679, loss: 0.8936, instance_loss: 0.6637, weighted_loss: 0.8246, label: 1, bag_size: 2859
batch 699, loss: 0.9619, instance_loss: 0.6332, weighted_loss: 0.8633, label: 1, bag_size: 1854
batch 719, loss: 0.2596, instance_loss: 0.4131, weighted_loss: 0.3056, label: 0, bag_size: 1640
batch 739, loss: 0.5929, instance_loss: 0.3680, weighted_loss: 0.5254, label: 0, bag_size: 4405


class 0 clustering acc 0.9743288590604027: correct 17421/17880
class 1 clustering acc 0.32919463087248324: correct 1962/5960
Epoch: 19, train_loss: 0.6006, train_clustering_loss:  0.5610, train_error: 0.2497
class 0: acc 0.7992125984251969, correct 203/254
class 1: acc 0.6092436974789915, correct 145/238
class 2: acc 0.83399209486166, correct 211/253

Val Set, val_loss: 1.0049, val_error: 0.3830, auc: 0.7513
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.1622340425531915: correct 122/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4669, instance_loss: 0.7323, weighted_loss: 0.5465, label: 1, bag_size: 7176
batch 39, loss: 0.8115, instance_loss: 0.6907, weighted_loss: 0.7753, label: 1, bag_size: 2751
batch 59, loss: 0.0000, instance_loss: 0.1284, weighted_loss: 0.0385, label: 0, bag_size: 6182
batch 79, loss: 1.3323, instance_loss: 1.0656, weighted_loss: 1.2523, label: 0, bag_size: 1753
batch 99, loss: 0.5171, instance_loss: 0.5209, weighted_loss: 0.5182, label: 0, bag_size: 2428
batch 119, loss: 0.2886, instance_loss: 0.2459, weighted_loss: 0.2758, label: 0, bag_size: 3188
batch 139, loss: 0.4953, instance_loss: 0.4293, weighted_loss: 0.4755, label: 0, bag_size: 4227
batch 159, loss: 0.3432, instance_loss: 0.3421, weighted_loss: 0.3429, label: 1, bag_size: 1042
batch 179, loss: 0.1608, instance_loss: 0.4742, weighted_loss: 0.2548, label: 1, bag_size: 6689
batch 199, loss: 2.8025, instance_loss: 1.6887, weighted_loss: 2.4684, label: 0, bag_size: 313
batch 219, loss: 0.6918, instance_loss: 0.5896, weighted_loss: 0.6611, label: 0, bag_size: 1018
batch 239, loss: 0.1001, instance_loss: 0.3132, weighted_loss: 0.1641, label: 0, bag_size: 1640
batch 259, loss: 0.2136, instance_loss: 0.5294, weighted_loss: 0.3083, label: 1, bag_size: 1394
batch 279, loss: 1.0086, instance_loss: 0.6699, weighted_loss: 0.9070, label: 1, bag_size: 4806
batch 299, loss: 0.7033, instance_loss: 0.4506, weighted_loss: 0.6275, label: 2, bag_size: 3534
batch 319, loss: 0.6548, instance_loss: 0.6131, weighted_loss: 0.6423, label: 0, bag_size: 3661
batch 339, loss: 2.0356, instance_loss: 0.8125, weighted_loss: 1.6687, label: 2, bag_size: 2501
batch 359, loss: 0.0166, instance_loss: 0.0980, weighted_loss: 0.0410, label: 2, bag_size: 3546
batch 379, loss: 2.5531, instance_loss: 0.8513, weighted_loss: 2.0426, label: 2, bag_size: 6298
batch 399, loss: 0.7480, instance_loss: 0.6434, weighted_loss: 0.7166, label: 1, bag_size: 2831
batch 419, loss: 0.0881, instance_loss: 0.1540, weighted_loss: 0.1079, label: 2, bag_size: 2049
batch 439, loss: 0.0379, instance_loss: 0.1891, weighted_loss: 0.0833, label: 2, bag_size: 3396
batch 459, loss: 0.1362, instance_loss: 0.3922, weighted_loss: 0.2130, label: 0, bag_size: 4744
batch 479, loss: 0.2549, instance_loss: 1.1007, weighted_loss: 0.5086, label: 0, bag_size: 3872
batch 499, loss: 0.7661, instance_loss: 0.5741, weighted_loss: 0.7085, label: 1, bag_size: 210
batch 519, loss: 0.0104, instance_loss: 0.0573, weighted_loss: 0.0245, label: 2, bag_size: 2997
batch 539, loss: 0.2126, instance_loss: 0.3680, weighted_loss: 0.2592, label: 2, bag_size: 4132
batch 559, loss: 0.3242, instance_loss: 0.5355, weighted_loss: 0.3876, label: 0, bag_size: 4227
batch 579, loss: 1.2153, instance_loss: 0.7260, weighted_loss: 1.0685, label: 0, bag_size: 4639
batch 599, loss: 1.5285, instance_loss: 1.0268, weighted_loss: 1.3780, label: 1, bag_size: 3424
batch 619, loss: 0.0465, instance_loss: 0.3479, weighted_loss: 0.1369, label: 2, bag_size: 6148
batch 639, loss: 0.0570, instance_loss: 0.1821, weighted_loss: 0.0945, label: 1, bag_size: 4253
batch 659, loss: 0.0312, instance_loss: 0.5037, weighted_loss: 0.1730, label: 1, bag_size: 4898
batch 679, loss: 0.0521, instance_loss: 0.4064, weighted_loss: 0.1584, label: 1, bag_size: 4869
batch 699, loss: 0.2103, instance_loss: 0.3287, weighted_loss: 0.2458, label: 0, bag_size: 4760
batch 719, loss: 1.6213, instance_loss: 1.0151, weighted_loss: 1.4394, label: 2, bag_size: 7607
batch 739, loss: 0.0343, instance_loss: 0.0632, weighted_loss: 0.0429, label: 2, bag_size: 4788


class 0 clustering acc 0.9737136465324385: correct 17410/17880
class 1 clustering acc 0.3313758389261745: correct 1975/5960
Epoch: 20, train_loss: 0.5851, train_clustering_loss:  0.5445, train_error: 0.2617
class 0: acc 0.7432432432432432, correct 165/222
class 1: acc 0.6479400749063671, correct 173/267
class 2: acc 0.828125, correct 212/256

Val Set, val_loss: 1.0437, val_error: 0.4574, auc: 0.7892
class 0 clustering acc 0.9671985815602837: correct 2182/2256
class 1 clustering acc 0.07712765957446809: correct 58/752
class 0: acc 0.46153846153846156, correct 24/52
class 1: acc 0.7, correct 21/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.7024, instance_loss: 1.0520, weighted_loss: 1.5073, label: 1, bag_size: 3837
batch 39, loss: 0.0397, instance_loss: 0.1926, weighted_loss: 0.0856, label: 2, bag_size: 3397
batch 59, loss: 0.0106, instance_loss: 0.5527, weighted_loss: 0.1732, label: 2, bag_size: 3607
batch 79, loss: 1.6147, instance_loss: 0.9801, weighted_loss: 1.4243, label: 0, bag_size: 6249
batch 99, loss: 0.2093, instance_loss: 0.6983, weighted_loss: 0.3560, label: 0, bag_size: 4494
batch 119, loss: 0.8426, instance_loss: 0.8443, weighted_loss: 0.8431, label: 1, bag_size: 2751
batch 139, loss: 0.7496, instance_loss: 0.4968, weighted_loss: 0.6738, label: 2, bag_size: 3227
batch 159, loss: 0.6699, instance_loss: 0.4808, weighted_loss: 0.6131, label: 0, bag_size: 5837
batch 179, loss: 0.3159, instance_loss: 0.8495, weighted_loss: 0.4760, label: 2, bag_size: 5472
batch 199, loss: 0.2669, instance_loss: 0.3448, weighted_loss: 0.2903, label: 2, bag_size: 3174
batch 219, loss: 0.0372, instance_loss: 0.2041, weighted_loss: 0.0873, label: 2, bag_size: 4745
batch 239, loss: 0.4519, instance_loss: 0.4284, weighted_loss: 0.4448, label: 0, bag_size: 2841
batch 259, loss: 0.6148, instance_loss: 0.5312, weighted_loss: 0.5897, label: 0, bag_size: 4604
batch 279, loss: 0.4242, instance_loss: 0.4262, weighted_loss: 0.4248, label: 0, bag_size: 6971
batch 299, loss: 0.2144, instance_loss: 0.3368, weighted_loss: 0.2511, label: 1, bag_size: 209
batch 319, loss: 1.6040, instance_loss: 1.2665, weighted_loss: 1.5027, label: 0, bag_size: 4605
batch 339, loss: 2.1405, instance_loss: 1.1582, weighted_loss: 1.8458, label: 1, bag_size: 4258
batch 359, loss: 0.0841, instance_loss: 0.3301, weighted_loss: 0.1579, label: 0, bag_size: 3406
batch 379, loss: 0.5216, instance_loss: 0.7119, weighted_loss: 0.5787, label: 1, bag_size: 1197
batch 399, loss: 0.1832, instance_loss: 0.3411, weighted_loss: 0.2306, label: 0, bag_size: 6445
batch 419, loss: 1.5331, instance_loss: 0.8968, weighted_loss: 1.3422, label: 2, bag_size: 223
batch 439, loss: 0.5010, instance_loss: 0.7583, weighted_loss: 0.5782, label: 1, bag_size: 2731
batch 459, loss: 0.9875, instance_loss: 0.7947, weighted_loss: 0.9296, label: 0, bag_size: 1492
batch 479, loss: 0.7589, instance_loss: 0.5784, weighted_loss: 0.7048, label: 0, bag_size: 3397
batch 499, loss: 0.4636, instance_loss: 0.5820, weighted_loss: 0.4991, label: 0, bag_size: 3188
batch 519, loss: 2.1488, instance_loss: 1.2165, weighted_loss: 1.8691, label: 2, bag_size: 4179
batch 539, loss: 0.0330, instance_loss: 0.2234, weighted_loss: 0.0901, label: 2, bag_size: 3583
batch 559, loss: 1.6999, instance_loss: 0.8131, weighted_loss: 1.4339, label: 2, bag_size: 3534
batch 579, loss: 0.1175, instance_loss: 0.2496, weighted_loss: 0.1571, label: 2, bag_size: 4203
batch 599, loss: 0.2029, instance_loss: 0.2023, weighted_loss: 0.2027, label: 0, bag_size: 2019
batch 619, loss: 0.0251, instance_loss: 0.1180, weighted_loss: 0.0529, label: 2, bag_size: 2254
batch 639, loss: 0.3040, instance_loss: 0.7850, weighted_loss: 0.4483, label: 1, bag_size: 6156
batch 659, loss: 0.0800, instance_loss: 0.3646, weighted_loss: 0.1653, label: 0, bag_size: 3268
batch 679, loss: 0.1904, instance_loss: 0.2409, weighted_loss: 0.2056, label: 2, bag_size: 2997
batch 699, loss: 1.9096, instance_loss: 1.1465, weighted_loss: 1.6807, label: 0, bag_size: 5259
batch 719, loss: 0.9779, instance_loss: 0.9871, weighted_loss: 0.9806, label: 1, bag_size: 1854
batch 739, loss: 0.8219, instance_loss: 0.7159, weighted_loss: 0.7901, label: 1, bag_size: 302


class 0 clustering acc 0.9722595078299776: correct 17384/17880
class 1 clustering acc 0.35067114093959734: correct 2090/5960
Epoch: 21, train_loss: 0.5713, train_clustering_loss:  0.5510, train_error: 0.2389
class 0: acc 0.7906976744186046, correct 204/258
class 1: acc 0.6483050847457628, correct 153/236
class 2: acc 0.8366533864541833, correct 210/251

Val Set, val_loss: 0.8967, val_error: 0.3404, auc: 0.7931
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.10505319148936171: correct 79/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0595, instance_loss: 0.2005, weighted_loss: 0.1018, label: 2, bag_size: 4372
batch 39, loss: 1.1239, instance_loss: 1.0443, weighted_loss: 1.1000, label: 2, bag_size: 1050
batch 59, loss: 0.5286, instance_loss: 0.4749, weighted_loss: 0.5125, label: 2, bag_size: 3583
batch 79, loss: 0.2564, instance_loss: 0.4289, weighted_loss: 0.3082, label: 0, bag_size: 3376
batch 99, loss: 0.3864, instance_loss: 0.4939, weighted_loss: 0.4187, label: 1, bag_size: 4960
batch 119, loss: 0.1256, instance_loss: 0.2828, weighted_loss: 0.1728, label: 0, bag_size: 1399
batch 139, loss: 0.8203, instance_loss: 0.7629, weighted_loss: 0.8031, label: 0, bag_size: 16741
batch 159, loss: 0.7390, instance_loss: 0.5793, weighted_loss: 0.6911, label: 0, bag_size: 2501
batch 179, loss: 0.2846, instance_loss: 0.3480, weighted_loss: 0.3036, label: 0, bag_size: 5260
batch 199, loss: 0.0038, instance_loss: 0.0227, weighted_loss: 0.0095, label: 2, bag_size: 2483
batch 219, loss: 0.0268, instance_loss: 0.1254, weighted_loss: 0.0564, label: 0, bag_size: 2290
batch 239, loss: 1.7652, instance_loss: 0.9681, weighted_loss: 1.5261, label: 2, bag_size: 4179
batch 259, loss: 0.3816, instance_loss: 0.5038, weighted_loss: 0.4183, label: 0, bag_size: 4528
batch 279, loss: 0.6070, instance_loss: 0.7168, weighted_loss: 0.6399, label: 1, bag_size: 5276
batch 299, loss: 0.1487, instance_loss: 0.3764, weighted_loss: 0.2170, label: 2, bag_size: 4192
batch 319, loss: 0.2382, instance_loss: 0.4312, weighted_loss: 0.2961, label: 0, bag_size: 6445
batch 339, loss: 0.1988, instance_loss: 0.7902, weighted_loss: 0.3762, label: 0, bag_size: 2257
batch 359, loss: 0.0256, instance_loss: 0.3606, weighted_loss: 0.1261, label: 0, bag_size: 3219
batch 379, loss: 0.0175, instance_loss: 0.1565, weighted_loss: 0.0592, label: 0, bag_size: 1825
batch 399, loss: 0.0458, instance_loss: 0.2021, weighted_loss: 0.0927, label: 0, bag_size: 4922
batch 419, loss: 0.0369, instance_loss: 0.1931, weighted_loss: 0.0838, label: 0, bag_size: 1495
batch 439, loss: 0.1415, instance_loss: 0.1622, weighted_loss: 0.1477, label: 2, bag_size: 2422
batch 459, loss: 0.0166, instance_loss: 0.0548, weighted_loss: 0.0280, label: 2, bag_size: 4043
batch 479, loss: 0.7125, instance_loss: 1.0321, weighted_loss: 0.8084, label: 0, bag_size: 6285
batch 499, loss: 0.4137, instance_loss: 0.6082, weighted_loss: 0.4721, label: 1, bag_size: 5696
batch 519, loss: 0.0388, instance_loss: 0.3032, weighted_loss: 0.1181, label: 2, bag_size: 4192
batch 539, loss: 0.5451, instance_loss: 0.6017, weighted_loss: 0.5621, label: 0, bag_size: 6285
batch 559, loss: 2.1737, instance_loss: 1.1361, weighted_loss: 1.8624, label: 2, bag_size: 4179
batch 579, loss: 0.0145, instance_loss: 0.2762, weighted_loss: 0.0930, label: 2, bag_size: 4745
batch 599, loss: 0.4793, instance_loss: 0.5945, weighted_loss: 0.5139, label: 0, bag_size: 4351
batch 619, loss: 1.8395, instance_loss: 0.8474, weighted_loss: 1.5418, label: 1, bag_size: 4145
batch 639, loss: 0.1069, instance_loss: 0.4326, weighted_loss: 0.2046, label: 1, bag_size: 3337
batch 659, loss: 0.0677, instance_loss: 0.4135, weighted_loss: 0.1714, label: 1, bag_size: 2767
batch 679, loss: 0.0412, instance_loss: 0.2481, weighted_loss: 0.1032, label: 0, bag_size: 1194
batch 699, loss: 0.0737, instance_loss: 0.3519, weighted_loss: 0.1572, label: 0, bag_size: 5915
batch 719, loss: 4.4918, instance_loss: 1.8156, weighted_loss: 3.6889, label: 0, bag_size: 3750
batch 739, loss: 0.0722, instance_loss: 0.2172, weighted_loss: 0.1157, label: 2, bag_size: 3810


class 0 clustering acc 0.9738814317673378: correct 17413/17880
class 1 clustering acc 0.3875838926174497: correct 2310/5960
Epoch: 22, train_loss: 0.5425, train_clustering_loss:  0.5309, train_error: 0.2188
class 0: acc 0.8095238095238095, correct 204/252
class 1: acc 0.6861924686192469, correct 164/239
class 2: acc 0.84251968503937, correct 214/254

Val Set, val_loss: 0.8178, val_error: 0.3404, auc: 0.8057
class 0 clustering acc 0.9654255319148937: correct 2178/2256
class 1 clustering acc 0.17819148936170212: correct 134/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 2.2943, instance_loss: 1.1647, weighted_loss: 1.9554, label: 2, bag_size: 4316
batch 39, loss: 0.9070, instance_loss: 0.6538, weighted_loss: 0.8310, label: 0, bag_size: 3752
batch 59, loss: 0.2555, instance_loss: 0.2596, weighted_loss: 0.2567, label: 0, bag_size: 3532
batch 79, loss: 0.1265, instance_loss: 0.1985, weighted_loss: 0.1481, label: 2, bag_size: 3112
batch 99, loss: 1.3951, instance_loss: 1.2350, weighted_loss: 1.3471, label: 1, bag_size: 20666
batch 119, loss: 0.0115, instance_loss: 0.0676, weighted_loss: 0.0283, label: 2, bag_size: 3497
batch 139, loss: 0.1105, instance_loss: 0.2749, weighted_loss: 0.1598, label: 0, bag_size: 873
batch 159, loss: 1.0941, instance_loss: 0.7930, weighted_loss: 1.0038, label: 1, bag_size: 2831
batch 179, loss: 1.6345, instance_loss: 1.3378, weighted_loss: 1.5454, label: 0, bag_size: 11141
batch 199, loss: 0.1068, instance_loss: 0.4147, weighted_loss: 0.1992, label: 0, bag_size: 4274
batch 219, loss: 0.8361, instance_loss: 0.7578, weighted_loss: 0.8126, label: 1, bag_size: 9099
batch 239, loss: 1.3972, instance_loss: 0.9777, weighted_loss: 1.2713, label: 2, bag_size: 724
batch 259, loss: 0.0005, instance_loss: 0.5133, weighted_loss: 0.1544, label: 0, bag_size: 1981
batch 279, loss: 0.0897, instance_loss: 0.3063, weighted_loss: 0.1547, label: 0, bag_size: 5899
batch 299, loss: 0.6581, instance_loss: 0.6621, weighted_loss: 0.6593, label: 2, bag_size: 4132
batch 319, loss: 0.1429, instance_loss: 0.5086, weighted_loss: 0.2526, label: 1, bag_size: 3265
batch 339, loss: 1.9876, instance_loss: 0.7445, weighted_loss: 1.6147, label: 0, bag_size: 3711
batch 359, loss: 0.0592, instance_loss: 0.3387, weighted_loss: 0.1431, label: 1, bag_size: 758
batch 379, loss: 0.0523, instance_loss: 0.1897, weighted_loss: 0.0935, label: 2, bag_size: 5138
batch 399, loss: 0.6039, instance_loss: 0.8605, weighted_loss: 0.6809, label: 1, bag_size: 3050
batch 419, loss: 0.8580, instance_loss: 0.8146, weighted_loss: 0.8450, label: 1, bag_size: 7176
batch 439, loss: 0.0888, instance_loss: 0.4225, weighted_loss: 0.1889, label: 1, bag_size: 4869
batch 459, loss: 1.6862, instance_loss: 0.8651, weighted_loss: 1.4398, label: 0, bag_size: 3664
batch 479, loss: 0.0338, instance_loss: 0.1122, weighted_loss: 0.0573, label: 2, bag_size: 4775
batch 499, loss: 1.4403, instance_loss: 0.7113, weighted_loss: 1.2216, label: 1, bag_size: 6993
batch 519, loss: 0.4904, instance_loss: 0.5344, weighted_loss: 0.5036, label: 1, bag_size: 2182
batch 539, loss: 0.0617, instance_loss: 0.1412, weighted_loss: 0.0856, label: 1, bag_size: 8802
batch 559, loss: 0.3797, instance_loss: 0.3737, weighted_loss: 0.3779, label: 0, bag_size: 5041
batch 579, loss: 0.0129, instance_loss: 0.0942, weighted_loss: 0.0373, label: 2, bag_size: 614
batch 599, loss: 0.3282, instance_loss: 0.6407, weighted_loss: 0.4219, label: 2, bag_size: 4141
batch 619, loss: 0.3681, instance_loss: 0.5113, weighted_loss: 0.4111, label: 2, bag_size: 3746
batch 639, loss: 0.2539, instance_loss: 0.7633, weighted_loss: 0.4067, label: 0, bag_size: 4274
batch 659, loss: 0.0380, instance_loss: 0.2323, weighted_loss: 0.0963, label: 0, bag_size: 1006
batch 679, loss: 0.2290, instance_loss: 0.2889, weighted_loss: 0.2470, label: 0, bag_size: 3334
batch 699, loss: 0.8114, instance_loss: 0.8224, weighted_loss: 0.8147, label: 1, bag_size: 3438
batch 719, loss: 0.1997, instance_loss: 0.2647, weighted_loss: 0.2192, label: 0, bag_size: 3986
batch 739, loss: 1.0297, instance_loss: 0.6448, weighted_loss: 0.9142, label: 2, bag_size: 4096


class 0 clustering acc 0.9735458612975392: correct 17407/17880
class 1 clustering acc 0.36090604026845635: correct 2151/5960
Epoch: 23, train_loss: 0.5639, train_clustering_loss:  0.5441, train_error: 0.2443
class 0: acc 0.7878787878787878, correct 208/264
class 1: acc 0.6437768240343348, correct 150/233
class 2: acc 0.8266129032258065, correct 205/248

Val Set, val_loss: 0.9314, val_error: 0.4149, auc: 0.7886
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.15824468085106383: correct 119/752
class 0: acc 0.5769230769230769, correct 30/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2476, instance_loss: 0.6989, weighted_loss: 0.3830, label: 1, bag_size: 4940
batch 39, loss: 0.0099, instance_loss: 0.4020, weighted_loss: 0.1275, label: 0, bag_size: 4083
batch 59, loss: 0.5603, instance_loss: 0.7997, weighted_loss: 0.6321, label: 0, bag_size: 4541
batch 79, loss: 2.2448, instance_loss: 1.0174, weighted_loss: 1.8766, label: 0, bag_size: 2618
batch 99, loss: 0.1792, instance_loss: 0.4671, weighted_loss: 0.2655, label: 0, bag_size: 1234
batch 119, loss: 0.2814, instance_loss: 0.3878, weighted_loss: 0.3133, label: 2, bag_size: 2561
batch 139, loss: 2.0603, instance_loss: 0.5970, weighted_loss: 1.6213, label: 0, bag_size: 4639
batch 159, loss: 2.1408, instance_loss: 1.0883, weighted_loss: 1.8251, label: 2, bag_size: 7607
batch 179, loss: 0.2127, instance_loss: 0.3852, weighted_loss: 0.2645, label: 1, bag_size: 800
batch 199, loss: 0.4869, instance_loss: 0.5127, weighted_loss: 0.4947, label: 1, bag_size: 3611
batch 219, loss: 0.2687, instance_loss: 0.5057, weighted_loss: 0.3398, label: 2, bag_size: 3618
batch 239, loss: 0.0513, instance_loss: 0.2498, weighted_loss: 0.1108, label: 0, bag_size: 3304
batch 259, loss: 0.0344, instance_loss: 0.2321, weighted_loss: 0.0937, label: 2, bag_size: 4555
batch 279, loss: 0.6371, instance_loss: 0.6714, weighted_loss: 0.6474, label: 2, bag_size: 3174
batch 299, loss: 0.9538, instance_loss: 0.6478, weighted_loss: 0.8620, label: 1, bag_size: 6025
batch 319, loss: 0.0378, instance_loss: 0.0810, weighted_loss: 0.0508, label: 1, bag_size: 758
batch 339, loss: 2.0191, instance_loss: 0.9465, weighted_loss: 1.6973, label: 1, bag_size: 3533
batch 359, loss: 1.3830, instance_loss: 1.1650, weighted_loss: 1.3176, label: 1, bag_size: 3533
batch 379, loss: 0.2700, instance_loss: 0.4049, weighted_loss: 0.3104, label: 2, bag_size: 4497
batch 399, loss: 0.4209, instance_loss: 0.5008, weighted_loss: 0.4449, label: 1, bag_size: 578
batch 419, loss: 0.2056, instance_loss: 0.4857, weighted_loss: 0.2896, label: 1, bag_size: 6475
batch 439, loss: 0.2035, instance_loss: 0.3229, weighted_loss: 0.2393, label: 0, bag_size: 2094
batch 459, loss: 1.2028, instance_loss: 0.6327, weighted_loss: 1.0318, label: 2, bag_size: 705
batch 479, loss: 1.1790, instance_loss: 0.8133, weighted_loss: 1.0693, label: 1, bag_size: 2083
batch 499, loss: 0.0086, instance_loss: 0.7081, weighted_loss: 0.2184, label: 0, bag_size: 5053
batch 519, loss: 0.7984, instance_loss: 0.8532, weighted_loss: 0.8148, label: 1, bag_size: 6942
batch 539, loss: 0.0047, instance_loss: 0.3141, weighted_loss: 0.0976, label: 1, bag_size: 3043
batch 559, loss: 0.0462, instance_loss: 0.3970, weighted_loss: 0.1514, label: 1, bag_size: 3991
batch 579, loss: 0.0622, instance_loss: 0.3483, weighted_loss: 0.1480, label: 0, bag_size: 5039
batch 599, loss: 0.0847, instance_loss: 0.3902, weighted_loss: 0.1763, label: 0, bag_size: 2339
batch 619, loss: 0.0453, instance_loss: 0.2861, weighted_loss: 0.1175, label: 0, bag_size: 6221
batch 639, loss: 0.0100, instance_loss: 0.0684, weighted_loss: 0.0275, label: 2, bag_size: 657
batch 659, loss: 1.2521, instance_loss: 0.7120, weighted_loss: 1.0901, label: 0, bag_size: 1695
batch 679, loss: 1.2191, instance_loss: 0.8093, weighted_loss: 1.0962, label: 1, bag_size: 1307
batch 699, loss: 1.5266, instance_loss: 1.1498, weighted_loss: 1.4136, label: 2, bag_size: 3299
batch 719, loss: 1.8197, instance_loss: 0.8942, weighted_loss: 1.5421, label: 0, bag_size: 6249
batch 739, loss: 0.8059, instance_loss: 0.6621, weighted_loss: 0.7627, label: 1, bag_size: 5696


class 0 clustering acc 0.9735458612975392: correct 17407/17880
class 1 clustering acc 0.3327181208053691: correct 1983/5960
Epoch: 24, train_loss: 0.5975, train_clustering_loss:  0.5619, train_error: 0.2564
class 0: acc 0.7732793522267206, correct 191/247
class 1: acc 0.6653992395437263, correct 175/263
class 2: acc 0.8, correct 188/235

Val Set, val_loss: 0.8319, val_error: 0.3830, auc: 0.8047
class 0 clustering acc 0.9685283687943262: correct 2185/2256
class 1 clustering acc 0.20345744680851063: correct 153/752
class 0: acc 0.6346153846153846, correct 33/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1763, instance_loss: 0.3591, weighted_loss: 0.2312, label: 0, bag_size: 4741
batch 39, loss: 0.1072, instance_loss: 0.3815, weighted_loss: 0.1895, label: 2, bag_size: 4372
batch 59, loss: 0.1533, instance_loss: 0.5644, weighted_loss: 0.2767, label: 0, bag_size: 1744
batch 79, loss: 0.7849, instance_loss: 0.4941, weighted_loss: 0.6977, label: 0, bag_size: 5867
batch 99, loss: 0.9420, instance_loss: 0.8092, weighted_loss: 0.9022, label: 2, bag_size: 4571
batch 119, loss: 2.2311, instance_loss: 0.9127, weighted_loss: 1.8356, label: 1, bag_size: 3296
batch 139, loss: 0.0001, instance_loss: 0.3809, weighted_loss: 0.1144, label: 0, bag_size: 5053
batch 159, loss: 0.1297, instance_loss: 0.4822, weighted_loss: 0.2354, label: 0, bag_size: 5646
batch 179, loss: 0.4744, instance_loss: 0.7250, weighted_loss: 0.5496, label: 1, bag_size: 3009
batch 199, loss: 0.1629, instance_loss: 0.4815, weighted_loss: 0.2585, label: 1, bag_size: 3493
batch 219, loss: 0.0992, instance_loss: 0.2003, weighted_loss: 0.1295, label: 2, bag_size: 4291
batch 239, loss: 0.2362, instance_loss: 0.6556, weighted_loss: 0.3620, label: 1, bag_size: 1712
batch 259, loss: 0.0718, instance_loss: 0.2302, weighted_loss: 0.1193, label: 2, bag_size: 3396
batch 279, loss: 0.7299, instance_loss: 0.5021, weighted_loss: 0.6616, label: 1, bag_size: 5572
batch 299, loss: 0.2904, instance_loss: 0.3238, weighted_loss: 0.3004, label: 0, bag_size: 5526
batch 319, loss: 0.0213, instance_loss: 0.1994, weighted_loss: 0.0747, label: 0, bag_size: 4794
batch 339, loss: 0.0429, instance_loss: 0.1801, weighted_loss: 0.0841, label: 0, bag_size: 3586
batch 359, loss: 0.0223, instance_loss: 0.2049, weighted_loss: 0.0771, label: 0, bag_size: 5029
batch 379, loss: 0.2039, instance_loss: 0.3045, weighted_loss: 0.2341, label: 0, bag_size: 4105
batch 399, loss: 0.0941, instance_loss: 0.1443, weighted_loss: 0.1092, label: 0, bag_size: 3793
batch 419, loss: 2.4117, instance_loss: 0.7992, weighted_loss: 1.9280, label: 0, bag_size: 2896
batch 439, loss: 0.2410, instance_loss: 0.4761, weighted_loss: 0.3115, label: 1, bag_size: 3007
batch 459, loss: 0.2367, instance_loss: 0.5528, weighted_loss: 0.3316, label: 0, bag_size: 6430
batch 479, loss: 1.1998, instance_loss: 0.7748, weighted_loss: 1.0723, label: 0, bag_size: 4639
batch 499, loss: 0.0157, instance_loss: 0.1159, weighted_loss: 0.0458, label: 1, bag_size: 425
batch 519, loss: 0.6158, instance_loss: 0.6013, weighted_loss: 0.6114, label: 0, bag_size: 6630
batch 539, loss: 1.3571, instance_loss: 0.9276, weighted_loss: 1.2283, label: 1, bag_size: 1500
batch 559, loss: 1.1351, instance_loss: 0.8939, weighted_loss: 1.0627, label: 1, bag_size: 8632
batch 579, loss: 0.5854, instance_loss: 0.6722, weighted_loss: 0.6114, label: 1, bag_size: 10399
batch 599, loss: 1.4206, instance_loss: 0.7808, weighted_loss: 1.2286, label: 2, bag_size: 6594
batch 619, loss: 0.0987, instance_loss: 0.4188, weighted_loss: 0.1947, label: 0, bag_size: 6430
batch 639, loss: 0.5542, instance_loss: 0.4310, weighted_loss: 0.5172, label: 1, bag_size: 2945
batch 659, loss: 2.0278, instance_loss: 0.6528, weighted_loss: 1.6153, label: 2, bag_size: 3026
batch 679, loss: 0.1484, instance_loss: 0.4817, weighted_loss: 0.2484, label: 1, bag_size: 4705
batch 699, loss: 0.3893, instance_loss: 0.6421, weighted_loss: 0.4651, label: 0, bag_size: 1762
batch 719, loss: 0.0575, instance_loss: 0.3630, weighted_loss: 0.1492, label: 1, bag_size: 4253
batch 739, loss: 0.4034, instance_loss: 0.5708, weighted_loss: 0.4536, label: 1, bag_size: 3221


class 0 clustering acc 0.9742729306487695: correct 17420/17880
class 1 clustering acc 0.3518456375838926: correct 2097/5960
Epoch: 25, train_loss: 0.5421, train_clustering_loss:  0.5427, train_error: 0.2242
class 0: acc 0.8108108108108109, correct 210/259
class 1: acc 0.6695278969957081, correct 156/233
class 2: acc 0.8379446640316206, correct 212/253

Val Set, val_loss: 0.8740, val_error: 0.3085, auc: 0.8168
class 0 clustering acc 0.962322695035461: correct 2171/2256
class 1 clustering acc 0.2912234042553192: correct 219/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0402, instance_loss: 0.3695, weighted_loss: 0.1390, label: 0, bag_size: 4744
batch 39, loss: 0.0538, instance_loss: 0.3380, weighted_loss: 0.1390, label: 1, bag_size: 3493
batch 59, loss: 0.0515, instance_loss: 0.2329, weighted_loss: 0.1059, label: 0, bag_size: 3694
batch 79, loss: 0.0683, instance_loss: 0.2361, weighted_loss: 0.1187, label: 0, bag_size: 4071
batch 99, loss: 0.0560, instance_loss: 0.1802, weighted_loss: 0.0933, label: 0, bag_size: 1845
batch 119, loss: 1.5583, instance_loss: 0.9947, weighted_loss: 1.3892, label: 2, bag_size: 4316
batch 139, loss: 0.0267, instance_loss: 0.1013, weighted_loss: 0.0491, label: 2, bag_size: 2254
batch 159, loss: 2.0915, instance_loss: 0.8334, weighted_loss: 1.7141, label: 0, bag_size: 3830
batch 179, loss: 0.0160, instance_loss: 0.0841, weighted_loss: 0.0365, label: 2, bag_size: 6026
batch 199, loss: 0.1419, instance_loss: 0.2164, weighted_loss: 0.1642, label: 0, bag_size: 4808
batch 219, loss: 1.3560, instance_loss: 0.9071, weighted_loss: 1.2214, label: 2, bag_size: 4316
batch 239, loss: 0.0470, instance_loss: 0.3769, weighted_loss: 0.1460, label: 0, bag_size: 3539
batch 259, loss: 0.4846, instance_loss: 0.4801, weighted_loss: 0.4833, label: 1, bag_size: 9099
batch 279, loss: 1.8802, instance_loss: 0.9401, weighted_loss: 1.5981, label: 1, bag_size: 5072
batch 299, loss: 0.1335, instance_loss: 0.3946, weighted_loss: 0.2119, label: 2, bag_size: 4569
batch 319, loss: 0.1636, instance_loss: 0.1209, weighted_loss: 0.1508, label: 2, bag_size: 3094
batch 339, loss: 0.3017, instance_loss: 0.2874, weighted_loss: 0.2974, label: 2, bag_size: 2481
batch 359, loss: 0.7210, instance_loss: 0.4582, weighted_loss: 0.6421, label: 2, bag_size: 3534
batch 379, loss: 1.3334, instance_loss: 0.5288, weighted_loss: 1.0920, label: 2, bag_size: 4241
batch 399, loss: 0.4391, instance_loss: 0.4761, weighted_loss: 0.4502, label: 2, bag_size: 3174
batch 419, loss: 0.6732, instance_loss: 0.4789, weighted_loss: 0.6149, label: 2, bag_size: 4291
batch 439, loss: 0.1215, instance_loss: 0.2339, weighted_loss: 0.1552, label: 1, bag_size: 3761
batch 459, loss: 2.4686, instance_loss: 1.4238, weighted_loss: 2.1551, label: 1, bag_size: 3791
batch 479, loss: 0.9227, instance_loss: 0.6979, weighted_loss: 0.8552, label: 0, bag_size: 4717
batch 499, loss: 0.5575, instance_loss: 1.1926, weighted_loss: 0.7480, label: 1, bag_size: 2927
batch 519, loss: 0.0706, instance_loss: 0.3290, weighted_loss: 0.1481, label: 2, bag_size: 5924
batch 539, loss: 0.2486, instance_loss: 0.5737, weighted_loss: 0.3461, label: 0, bag_size: 1933
batch 559, loss: 0.2727, instance_loss: 0.6227, weighted_loss: 0.3777, label: 1, bag_size: 2905
batch 579, loss: 2.3369, instance_loss: 1.2995, weighted_loss: 2.0257, label: 0, bag_size: 1755
batch 599, loss: 0.1733, instance_loss: 0.4615, weighted_loss: 0.2597, label: 1, bag_size: 3357
batch 619, loss: 0.4051, instance_loss: 0.3802, weighted_loss: 0.3976, label: 0, bag_size: 5953
batch 639, loss: 0.4719, instance_loss: 0.3797, weighted_loss: 0.4442, label: 0, bag_size: 3532
batch 659, loss: 0.8109, instance_loss: 0.7590, weighted_loss: 0.7953, label: 1, bag_size: 4395
batch 679, loss: 0.1631, instance_loss: 0.2146, weighted_loss: 0.1786, label: 1, bag_size: 862
batch 699, loss: 0.0024, instance_loss: 0.0164, weighted_loss: 0.0066, label: 2, bag_size: 3285
batch 719, loss: 0.3555, instance_loss: 0.4839, weighted_loss: 0.3940, label: 1, bag_size: 2919
batch 739, loss: 0.1728, instance_loss: 0.6950, weighted_loss: 0.3294, label: 1, bag_size: 4373


class 0 clustering acc 0.9710290827740492: correct 17362/17880
class 1 clustering acc 0.3593959731543624: correct 2142/5960
Epoch: 26, train_loss: 0.5838, train_clustering_loss:  0.5413, train_error: 0.2510
class 0: acc 0.7439024390243902, correct 183/246
class 1: acc 0.6988416988416989, correct 181/259
class 2: acc 0.8083333333333333, correct 194/240

Val Set, val_loss: 0.9007, val_error: 0.3404, auc: 0.7975
class 0 clustering acc 0.9804964539007093: correct 2212/2256
class 1 clustering acc 0.2127659574468085: correct 160/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3213, instance_loss: 0.3062, weighted_loss: 0.3168, label: 1, bag_size: 2945
batch 39, loss: 1.1898, instance_loss: 0.7156, weighted_loss: 1.0476, label: 1, bag_size: 4200
batch 59, loss: 0.1062, instance_loss: 0.3749, weighted_loss: 0.1868, label: 1, bag_size: 3127
batch 79, loss: 0.1889, instance_loss: 0.5474, weighted_loss: 0.2964, label: 0, bag_size: 3289
batch 99, loss: 0.2013, instance_loss: 0.8566, weighted_loss: 0.3979, label: 1, bag_size: 5833
batch 119, loss: 0.3792, instance_loss: 0.4880, weighted_loss: 0.4119, label: 0, bag_size: 4604
batch 139, loss: 0.7915, instance_loss: 0.6232, weighted_loss: 0.7410, label: 1, bag_size: 5412
batch 159, loss: 0.8672, instance_loss: 0.5903, weighted_loss: 0.7841, label: 2, bag_size: 2031
batch 179, loss: 0.1976, instance_loss: 0.5271, weighted_loss: 0.2965, label: 0, bag_size: 4122
batch 199, loss: 0.0499, instance_loss: 0.1638, weighted_loss: 0.0840, label: 2, bag_size: 2422
batch 219, loss: 0.0666, instance_loss: 0.1176, weighted_loss: 0.0819, label: 0, bag_size: 1947
batch 239, loss: 0.2211, instance_loss: 0.3820, weighted_loss: 0.2694, label: 0, bag_size: 5519
batch 259, loss: 0.8499, instance_loss: 0.8634, weighted_loss: 0.8539, label: 1, bag_size: 1122
batch 279, loss: 0.0420, instance_loss: 0.1196, weighted_loss: 0.0653, label: 2, bag_size: 2905
batch 299, loss: 0.0520, instance_loss: 0.0798, weighted_loss: 0.0604, label: 0, bag_size: 5500
batch 319, loss: 0.5690, instance_loss: 0.9112, weighted_loss: 0.6717, label: 1, bag_size: 2998
batch 339, loss: 0.8448, instance_loss: 0.4888, weighted_loss: 0.7380, label: 1, bag_size: 2878
batch 359, loss: 0.0034, instance_loss: 0.1756, weighted_loss: 0.0550, label: 1, bag_size: 3043
batch 379, loss: 0.0311, instance_loss: 0.1260, weighted_loss: 0.0596, label: 0, bag_size: 6138
batch 399, loss: 1.3161, instance_loss: 0.6970, weighted_loss: 1.1304, label: 0, bag_size: 4541
batch 419, loss: 1.5968, instance_loss: 1.5574, weighted_loss: 1.5850, label: 1, bag_size: 3995
batch 439, loss: 0.2419, instance_loss: 0.3738, weighted_loss: 0.2815, label: 0, bag_size: 2601
batch 459, loss: 0.5752, instance_loss: 0.6976, weighted_loss: 0.6119, label: 0, bag_size: 893
batch 479, loss: 1.3347, instance_loss: 0.9545, weighted_loss: 1.2206, label: 1, bag_size: 4694
batch 499, loss: 0.0877, instance_loss: 0.1525, weighted_loss: 0.1071, label: 2, bag_size: 4775
batch 519, loss: 0.3173, instance_loss: 0.8259, weighted_loss: 0.4698, label: 1, bag_size: 3475
batch 539, loss: 0.3809, instance_loss: 0.5273, weighted_loss: 0.4248, label: 1, bag_size: 2182
batch 559, loss: 0.1075, instance_loss: 0.1746, weighted_loss: 0.1277, label: 0, bag_size: 2545
batch 579, loss: 0.3895, instance_loss: 0.4429, weighted_loss: 0.4055, label: 1, bag_size: 2055
batch 599, loss: 0.1931, instance_loss: 0.3201, weighted_loss: 0.2312, label: 2, bag_size: 6273
batch 619, loss: 0.7454, instance_loss: 0.7031, weighted_loss: 0.7327, label: 2, bag_size: 3534
batch 639, loss: 0.0540, instance_loss: 0.3816, weighted_loss: 0.1523, label: 2, bag_size: 614
batch 659, loss: 1.6226, instance_loss: 0.6767, weighted_loss: 1.3388, label: 2, bag_size: 4241
batch 679, loss: 0.1027, instance_loss: 0.2436, weighted_loss: 0.1450, label: 0, bag_size: 1947
batch 699, loss: 0.3978, instance_loss: 0.5774, weighted_loss: 0.4517, label: 1, bag_size: 2156
batch 719, loss: 0.8916, instance_loss: 0.7669, weighted_loss: 0.8542, label: 1, bag_size: 1500
batch 739, loss: 0.1266, instance_loss: 0.3924, weighted_loss: 0.2063, label: 1, bag_size: 1394


class 0 clustering acc 0.9741610738255033: correct 17418/17880
class 1 clustering acc 0.3521812080536913: correct 2099/5960
Epoch: 27, train_loss: 0.5369, train_clustering_loss:  0.5461, train_error: 0.2282
class 0: acc 0.8130081300813008, correct 200/246
class 1: acc 0.7022900763358778, correct 184/262
class 2: acc 0.8059071729957806, correct 191/237

Val Set, val_loss: 0.8946, val_error: 0.3191, auc: 0.7948
class 0 clustering acc 0.9725177304964538: correct 2194/2256
class 1 clustering acc 0.1901595744680851: correct 143/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.3370, instance_loss: 0.7034, weighted_loss: 0.4470, label: 1, bag_size: 1712
batch 39, loss: 0.2342, instance_loss: 1.1155, weighted_loss: 0.4986, label: 0, bag_size: 2927
batch 59, loss: 0.7744, instance_loss: 0.7978, weighted_loss: 0.7814, label: 1, bag_size: 3821
batch 79, loss: 0.0575, instance_loss: 0.2618, weighted_loss: 0.1188, label: 2, bag_size: 5138
batch 99, loss: 0.1847, instance_loss: 0.4587, weighted_loss: 0.2669, label: 2, bag_size: 4978
batch 119, loss: 0.0288, instance_loss: 0.1664, weighted_loss: 0.0700, label: 2, bag_size: 2997
batch 139, loss: 2.1403, instance_loss: 1.1951, weighted_loss: 1.8568, label: 0, bag_size: 455
batch 159, loss: 2.3999, instance_loss: 1.1216, weighted_loss: 2.0164, label: 2, bag_size: 7607
batch 179, loss: 0.8670, instance_loss: 0.6605, weighted_loss: 0.8050, label: 1, bag_size: 2671
batch 199, loss: 0.4353, instance_loss: 0.3092, weighted_loss: 0.3975, label: 2, bag_size: 3534
batch 219, loss: 0.0451, instance_loss: 0.8612, weighted_loss: 0.2900, label: 1, bag_size: 4027
batch 239, loss: 0.9486, instance_loss: 0.7563, weighted_loss: 0.8909, label: 1, bag_size: 11974
batch 259, loss: 0.1960, instance_loss: 0.2485, weighted_loss: 0.2117, label: 0, bag_size: 7595
batch 279, loss: 0.2742, instance_loss: 0.5487, weighted_loss: 0.3565, label: 2, bag_size: 4291
batch 299, loss: 1.8064, instance_loss: 0.8153, weighted_loss: 1.5091, label: 0, bag_size: 2896
batch 319, loss: 0.3928, instance_loss: 0.3949, weighted_loss: 0.3934, label: 2, bag_size: 1103
batch 339, loss: 1.0312, instance_loss: 0.6469, weighted_loss: 0.9159, label: 0, bag_size: 4228
batch 359, loss: 0.1679, instance_loss: 0.4259, weighted_loss: 0.2453, label: 2, bag_size: 5924
batch 379, loss: 0.5365, instance_loss: 0.5774, weighted_loss: 0.5487, label: 1, bag_size: 800
batch 399, loss: 0.1115, instance_loss: 0.4646, weighted_loss: 0.2175, label: 0, bag_size: 889
batch 419, loss: 0.4293, instance_loss: 0.9384, weighted_loss: 0.5820, label: 1, bag_size: 6689
batch 439, loss: 0.1290, instance_loss: 0.2270, weighted_loss: 0.1584, label: 2, bag_size: 3094
batch 459, loss: 0.0578, instance_loss: 0.3983, weighted_loss: 0.1600, label: 0, bag_size: 4721
batch 479, loss: 0.7715, instance_loss: 1.0853, weighted_loss: 0.8656, label: 1, bag_size: 3821
batch 499, loss: 0.4951, instance_loss: 0.8539, weighted_loss: 0.6028, label: 1, bag_size: 582
batch 519, loss: 0.1107, instance_loss: 0.1470, weighted_loss: 0.1216, label: 0, bag_size: 5282
batch 539, loss: 0.0347, instance_loss: 0.1513, weighted_loss: 0.0696, label: 2, bag_size: 2254
batch 559, loss: 0.4952, instance_loss: 0.4008, weighted_loss: 0.4669, label: 2, bag_size: 3112
batch 579, loss: 0.2916, instance_loss: 0.5577, weighted_loss: 0.3714, label: 0, bag_size: 5519
batch 599, loss: 0.0284, instance_loss: 0.2101, weighted_loss: 0.0829, label: 2, bag_size: 3497
batch 619, loss: 0.4439, instance_loss: 0.6542, weighted_loss: 0.5070, label: 2, bag_size: 22464
batch 639, loss: 0.0689, instance_loss: 0.2740, weighted_loss: 0.1304, label: 2, bag_size: 3397
batch 659, loss: 2.3602, instance_loss: 1.2029, weighted_loss: 2.0130, label: 2, bag_size: 4316
batch 679, loss: 0.0342, instance_loss: 0.2373, weighted_loss: 0.0952, label: 2, bag_size: 3497
batch 699, loss: 0.0569, instance_loss: 0.5237, weighted_loss: 0.1969, label: 1, bag_size: 5026
batch 719, loss: 1.6192, instance_loss: 1.0048, weighted_loss: 1.4349, label: 0, bag_size: 7219
batch 739, loss: 0.4369, instance_loss: 0.3897, weighted_loss: 0.4228, label: 2, bag_size: 3327


class 0 clustering acc 0.9721476510067114: correct 17382/17880
class 1 clustering acc 0.3528523489932886: correct 2103/5960
Epoch: 28, train_loss: 0.5936, train_clustering_loss:  0.5478, train_error: 0.2523
class 0: acc 0.7857142857142857, correct 209/266
class 1: acc 0.6118721461187214, correct 134/219
class 2: acc 0.823076923076923, correct 214/260

Val Set, val_loss: 1.0894, val_error: 0.3617, auc: 0.7530
class 0 clustering acc 0.9645390070921985: correct 2176/2256
class 1 clustering acc 0.14893617021276595: correct 112/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.5994, instance_loss: 0.4404, weighted_loss: 0.5517, label: 1, bag_size: 3604
batch 39, loss: 0.2301, instance_loss: 0.4361, weighted_loss: 0.2919, label: 0, bag_size: 3188
batch 59, loss: 0.0722, instance_loss: 0.2110, weighted_loss: 0.1138, label: 2, bag_size: 4141
batch 79, loss: 0.4590, instance_loss: 0.4966, weighted_loss: 0.4703, label: 1, bag_size: 2919
batch 99, loss: 0.1641, instance_loss: 0.5613, weighted_loss: 0.2833, label: 0, bag_size: 1495
batch 119, loss: 1.0924, instance_loss: 0.8852, weighted_loss: 1.0302, label: 0, bag_size: 15388
batch 139, loss: 0.0763, instance_loss: 0.1338, weighted_loss: 0.0935, label: 2, bag_size: 3176
batch 159, loss: 0.7968, instance_loss: 0.6536, weighted_loss: 0.7538, label: 1, bag_size: 6241
batch 179, loss: 0.1348, instance_loss: 0.3978, weighted_loss: 0.2137, label: 2, bag_size: 4978
batch 199, loss: 0.5262, instance_loss: 0.4493, weighted_loss: 0.5031, label: 2, bag_size: 3534
batch 219, loss: 0.0402, instance_loss: 0.1626, weighted_loss: 0.0769, label: 1, bag_size: 425
batch 239, loss: 2.6369, instance_loss: 1.4336, weighted_loss: 2.2759, label: 2, bag_size: 4316
batch 259, loss: 0.9027, instance_loss: 0.6302, weighted_loss: 0.8210, label: 0, bag_size: 2559
batch 279, loss: 0.0798, instance_loss: 0.2546, weighted_loss: 0.1322, label: 0, bag_size: 4157
batch 299, loss: 0.4550, instance_loss: 1.0293, weighted_loss: 0.6273, label: 2, bag_size: 4910
batch 319, loss: 0.0295, instance_loss: 0.1139, weighted_loss: 0.0548, label: 0, bag_size: 6221
batch 339, loss: 0.3936, instance_loss: 0.4565, weighted_loss: 0.4125, label: 2, bag_size: 1543
batch 359, loss: 1.1197, instance_loss: 0.7424, weighted_loss: 1.0065, label: 1, bag_size: 3403
batch 379, loss: 2.0702, instance_loss: 0.8245, weighted_loss: 1.6965, label: 2, bag_size: 4241
batch 399, loss: 0.1957, instance_loss: 0.2864, weighted_loss: 0.2229, label: 1, bag_size: 8482
batch 419, loss: 0.0909, instance_loss: 0.6568, weighted_loss: 0.2607, label: 0, bag_size: 4529
batch 439, loss: 0.0277, instance_loss: 0.0531, weighted_loss: 0.0353, label: 0, bag_size: 5782
batch 459, loss: 0.0479, instance_loss: 0.0870, weighted_loss: 0.0596, label: 2, bag_size: 4192
batch 479, loss: 0.2417, instance_loss: 0.5381, weighted_loss: 0.3307, label: 0, bag_size: 909
batch 499, loss: 0.3116, instance_loss: 0.4116, weighted_loss: 0.3416, label: 1, bag_size: 578
batch 519, loss: 0.6221, instance_loss: 0.6685, weighted_loss: 0.6360, label: 0, bag_size: 14218
batch 539, loss: 0.2666, instance_loss: 0.5130, weighted_loss: 0.3405, label: 1, bag_size: 3225
batch 559, loss: 0.1521, instance_loss: 0.2577, weighted_loss: 0.1838, label: 2, bag_size: 3026
batch 579, loss: 0.0589, instance_loss: 0.1040, weighted_loss: 0.0724, label: 2, bag_size: 2905
batch 599, loss: 0.5031, instance_loss: 0.6139, weighted_loss: 0.5363, label: 1, bag_size: 3786
batch 619, loss: 2.5871, instance_loss: 0.9746, weighted_loss: 2.1033, label: 0, bag_size: 2597
batch 639, loss: 0.1509, instance_loss: 0.2901, weighted_loss: 0.1927, label: 0, bag_size: 5125
batch 659, loss: 0.1336, instance_loss: 0.4754, weighted_loss: 0.2361, label: 2, bag_size: 3604
batch 679, loss: 0.0066, instance_loss: 0.0944, weighted_loss: 0.0329, label: 2, bag_size: 4856
batch 699, loss: 0.0722, instance_loss: 0.2810, weighted_loss: 0.1349, label: 2, bag_size: 3810
batch 719, loss: 0.6765, instance_loss: 0.8769, weighted_loss: 0.7366, label: 1, bag_size: 5197
batch 739, loss: 0.7800, instance_loss: 0.5507, weighted_loss: 0.7112, label: 2, bag_size: 705


class 0 clustering acc 0.9724832214765101: correct 17388/17880
class 1 clustering acc 0.3756711409395973: correct 2239/5960
Epoch: 29, train_loss: 0.5312, train_clustering_loss:  0.5329, train_error: 0.2295
class 0: acc 0.7952755905511811, correct 202/254
class 1: acc 0.6720647773279352, correct 166/247
class 2: acc 0.8442622950819673, correct 206/244

Val Set, val_loss: 1.1241, val_error: 0.4255, auc: 0.7406
class 0 clustering acc 0.9667553191489362: correct 2181/2256
class 1 clustering acc 0.19680851063829788: correct 148/752
class 0: acc 0.5576923076923077, correct 29/52
class 1: acc 0.6666666666666666, correct 20/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.7259, instance_loss: 1.1412, weighted_loss: 0.8505, label: 2, bag_size: 3299
batch 39, loss: 0.0091, instance_loss: 0.1292, weighted_loss: 0.0452, label: 1, bag_size: 259
batch 59, loss: 0.0479, instance_loss: 0.1340, weighted_loss: 0.0737, label: 2, bag_size: 4302
batch 79, loss: 0.0309, instance_loss: 0.2649, weighted_loss: 0.1011, label: 0, bag_size: 6138
batch 99, loss: 0.2516, instance_loss: 0.4144, weighted_loss: 0.3004, label: 1, bag_size: 3746
batch 119, loss: 0.0865, instance_loss: 0.2568, weighted_loss: 0.1376, label: 2, bag_size: 5017
batch 139, loss: 0.8330, instance_loss: 0.5943, weighted_loss: 0.7614, label: 1, bag_size: 2083
batch 159, loss: 0.4091, instance_loss: 0.7178, weighted_loss: 0.5017, label: 0, bag_size: 2392
batch 179, loss: 0.2199, instance_loss: 0.4111, weighted_loss: 0.2773, label: 1, bag_size: 2122
batch 199, loss: 0.2457, instance_loss: 0.5465, weighted_loss: 0.3359, label: 2, bag_size: 4745
batch 219, loss: 0.1376, instance_loss: 0.3612, weighted_loss: 0.2047, label: 0, bag_size: 829
batch 239, loss: 1.1134, instance_loss: 0.8169, weighted_loss: 1.0245, label: 1, bag_size: 2671
batch 259, loss: 0.9849, instance_loss: 0.5706, weighted_loss: 0.8606, label: 0, bag_size: 1352
batch 279, loss: 0.1025, instance_loss: 0.2081, weighted_loss: 0.1342, label: 2, bag_size: 4302
batch 299, loss: 0.0543, instance_loss: 0.2007, weighted_loss: 0.0982, label: 2, bag_size: 2209
batch 319, loss: 1.0804, instance_loss: 0.6681, weighted_loss: 0.9567, label: 0, bag_size: 14218
batch 339, loss: 0.0784, instance_loss: 0.2741, weighted_loss: 0.1371, label: 0, bag_size: 4071
batch 359, loss: 0.5573, instance_loss: 0.6499, weighted_loss: 0.5851, label: 1, bag_size: 1906
batch 379, loss: 0.0285, instance_loss: 0.1311, weighted_loss: 0.0593, label: 2, bag_size: 6026
batch 399, loss: 0.2911, instance_loss: 0.4342, weighted_loss: 0.3340, label: 0, bag_size: 2671
batch 419, loss: 0.4370, instance_loss: 0.9030, weighted_loss: 0.5768, label: 0, bag_size: 6285
batch 439, loss: 0.0493, instance_loss: 0.2709, weighted_loss: 0.1158, label: 0, bag_size: 5646
batch 459, loss: 0.1419, instance_loss: 0.8087, weighted_loss: 0.3419, label: 0, bag_size: 5646
batch 479, loss: 0.0217, instance_loss: 0.0821, weighted_loss: 0.0398, label: 0, bag_size: 4196
batch 499, loss: 0.5832, instance_loss: 0.6585, weighted_loss: 0.6058, label: 0, bag_size: 7077
batch 519, loss: 0.0142, instance_loss: 0.0666, weighted_loss: 0.0299, label: 2, bag_size: 4088
batch 539, loss: 0.8005, instance_loss: 0.8716, weighted_loss: 0.8218, label: 0, bag_size: 2983
batch 559, loss: 0.0018, instance_loss: 0.2958, weighted_loss: 0.0900, label: 1, bag_size: 3043
batch 579, loss: 0.0036, instance_loss: 0.3315, weighted_loss: 0.1019, label: 0, bag_size: 4458
batch 599, loss: 0.7425, instance_loss: 0.6923, weighted_loss: 0.7275, label: 0, bag_size: 3341
batch 619, loss: 2.4368, instance_loss: 0.9240, weighted_loss: 1.9829, label: 2, bag_size: 4241
batch 639, loss: 0.1311, instance_loss: 0.4472, weighted_loss: 0.2260, label: 0, bag_size: 4227
batch 659, loss: 0.0000, instance_loss: 0.1446, weighted_loss: 0.0434, label: 0, bag_size: 3445
batch 679, loss: 1.1177, instance_loss: 0.7892, weighted_loss: 1.0191, label: 1, bag_size: 5412
batch 699, loss: 0.0322, instance_loss: 0.1582, weighted_loss: 0.0700, label: 0, bag_size: 4855
batch 719, loss: 0.0438, instance_loss: 0.4236, weighted_loss: 0.1577, label: 0, bag_size: 3872
batch 739, loss: 0.0052, instance_loss: 0.0548, weighted_loss: 0.0201, label: 1, bag_size: 259


class 0 clustering acc 0.9718120805369127: correct 17376/17880
class 1 clustering acc 0.4033557046979866: correct 2404/5960
Epoch: 30, train_loss: 0.4938, train_clustering_loss:  0.5185, train_error: 0.1973
class 0: acc 0.8146718146718147, correct 211/259
class 1: acc 0.746031746031746, correct 188/252
class 2: acc 0.8504273504273504, correct 199/234

Val Set, val_loss: 0.9066, val_error: 0.2766, auc: 0.8043
class 0 clustering acc 0.9676418439716312: correct 2183/2256
class 1 clustering acc 0.30186170212765956: correct 227/752
class 0: acc 0.8461538461538461, correct 44/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.2132, instance_loss: 0.5477, weighted_loss: 0.3135, label: 2, bag_size: 6704
batch 39, loss: 0.2188, instance_loss: 0.3832, weighted_loss: 0.2681, label: 2, bag_size: 4569
batch 59, loss: 0.0329, instance_loss: 0.1593, weighted_loss: 0.0708, label: 2, bag_size: 2254
batch 79, loss: 2.6655, instance_loss: 0.9825, weighted_loss: 2.1606, label: 0, bag_size: 3419
batch 99, loss: 0.0966, instance_loss: 0.1854, weighted_loss: 0.1232, label: 2, bag_size: 3176
batch 119, loss: 0.0308, instance_loss: 0.1849, weighted_loss: 0.0770, label: 2, bag_size: 3497
batch 139, loss: 0.0000, instance_loss: 0.0710, weighted_loss: 0.0213, label: 0, bag_size: 3445
batch 159, loss: 0.1929, instance_loss: 0.2079, weighted_loss: 0.1974, label: 2, bag_size: 4569
batch 179, loss: 0.0186, instance_loss: 0.6248, weighted_loss: 0.2005, label: 1, bag_size: 4869
batch 199, loss: 0.0025, instance_loss: 0.0333, weighted_loss: 0.0117, label: 1, bag_size: 2254
batch 219, loss: 0.2333, instance_loss: 0.4021, weighted_loss: 0.2840, label: 1, bag_size: 2731
batch 239, loss: 0.7835, instance_loss: 1.0978, weighted_loss: 0.8778, label: 2, bag_size: 4179
batch 259, loss: 0.4618, instance_loss: 0.5988, weighted_loss: 0.5029, label: 1, bag_size: 2731
batch 279, loss: 1.1630, instance_loss: 0.7852, weighted_loss: 1.0496, label: 1, bag_size: 1860
batch 299, loss: 0.8720, instance_loss: 0.7595, weighted_loss: 0.8382, label: 1, bag_size: 667
batch 319, loss: 1.3925, instance_loss: 0.7757, weighted_loss: 1.2074, label: 2, bag_size: 1513
batch 339, loss: 0.0367, instance_loss: 0.3617, weighted_loss: 0.1342, label: 0, bag_size: 2094
batch 359, loss: 1.0113, instance_loss: 0.4926, weighted_loss: 0.8557, label: 0, bag_size: 5098
batch 379, loss: 0.1213, instance_loss: 0.4370, weighted_loss: 0.2161, label: 1, bag_size: 5385
batch 399, loss: 0.8123, instance_loss: 0.8300, weighted_loss: 0.8177, label: 2, bag_size: 4316
batch 419, loss: 0.3501, instance_loss: 0.6591, weighted_loss: 0.4428, label: 1, bag_size: 4119
batch 439, loss: 0.3135, instance_loss: 0.5520, weighted_loss: 0.3850, label: 1, bag_size: 4940
batch 459, loss: 0.0749, instance_loss: 0.5026, weighted_loss: 0.2032, label: 0, bag_size: 3408
batch 479, loss: 0.1536, instance_loss: 0.3318, weighted_loss: 0.2070, label: 0, bag_size: 3164
batch 499, loss: 0.5310, instance_loss: 0.3159, weighted_loss: 0.4665, label: 2, bag_size: 3227
batch 519, loss: 0.3807, instance_loss: 0.7058, weighted_loss: 0.4782, label: 0, bag_size: 4398
batch 539, loss: 0.1638, instance_loss: 0.2658, weighted_loss: 0.1944, label: 1, bag_size: 712
batch 559, loss: 0.1961, instance_loss: 0.3086, weighted_loss: 0.2299, label: 2, bag_size: 3026
batch 579, loss: 0.9352, instance_loss: 0.7795, weighted_loss: 0.8885, label: 1, bag_size: 3821
batch 599, loss: 1.0739, instance_loss: 0.6043, weighted_loss: 0.9330, label: 1, bag_size: 5072
batch 619, loss: 0.2276, instance_loss: 0.7255, weighted_loss: 0.3769, label: 2, bag_size: 3299
batch 639, loss: 0.0045, instance_loss: 0.7088, weighted_loss: 0.2158, label: 0, bag_size: 2354
batch 659, loss: 0.1272, instance_loss: 0.4293, weighted_loss: 0.2178, label: 2, bag_size: 5017
batch 679, loss: 0.1954, instance_loss: 0.5227, weighted_loss: 0.2936, label: 1, bag_size: 2767
batch 699, loss: 0.8521, instance_loss: 0.8088, weighted_loss: 0.8391, label: 0, bag_size: 6971
batch 719, loss: 0.0611, instance_loss: 0.3196, weighted_loss: 0.1387, label: 1, bag_size: 2796
batch 739, loss: 0.8961, instance_loss: 0.6404, weighted_loss: 0.8194, label: 0, bag_size: 14432


class 0 clustering acc 0.9751677852348993: correct 17436/17880
class 1 clustering acc 0.35453020134228186: correct 2113/5960
Epoch: 31, train_loss: 0.5433, train_clustering_loss:  0.5436, train_error: 0.2174
class 0: acc 0.7887931034482759, correct 183/232
class 1: acc 0.7368421052631579, correct 196/266
class 2: acc 0.8259109311740891, correct 204/247

Val Set, val_loss: 1.1038, val_error: 0.3723, auc: 0.7297
class 0 clustering acc 0.9521276595744681: correct 2148/2256
class 1 clustering acc 0.29388297872340424: correct 221/752
class 0: acc 0.7884615384615384, correct 41/52
class 1: acc 0.43333333333333335, correct 13/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 24 out of 20


batch 19, loss: 1.3106, instance_loss: 0.6718, weighted_loss: 1.1190, label: 1, bag_size: 3534
batch 39, loss: 0.1814, instance_loss: 0.3379, weighted_loss: 0.2284, label: 0, bag_size: 4604
batch 59, loss: 0.0840, instance_loss: 0.2097, weighted_loss: 0.1217, label: 0, bag_size: 386
batch 79, loss: 0.8972, instance_loss: 0.7817, weighted_loss: 0.8625, label: 1, bag_size: 4824
batch 99, loss: 0.0001, instance_loss: 0.0772, weighted_loss: 0.0232, label: 1, bag_size: 4290
batch 119, loss: 1.5864, instance_loss: 0.9453, weighted_loss: 1.3941, label: 1, bag_size: 5276
batch 139, loss: 0.0214, instance_loss: 0.2007, weighted_loss: 0.0752, label: 2, bag_size: 3497
batch 159, loss: 0.2994, instance_loss: 0.3189, weighted_loss: 0.3052, label: 0, bag_size: 3690
batch 179, loss: 0.1117, instance_loss: 0.3374, weighted_loss: 0.1794, label: 0, bag_size: 5632
batch 199, loss: 0.1270, instance_loss: 0.3090, weighted_loss: 0.1816, label: 2, bag_size: 5924
batch 219, loss: 0.0359, instance_loss: 0.1278, weighted_loss: 0.0635, label: 0, bag_size: 6221
batch 239, loss: 0.7204, instance_loss: 0.8357, weighted_loss: 0.7550, label: 2, bag_size: 22464
batch 259, loss: 0.0198, instance_loss: 0.5184, weighted_loss: 0.1694, label: 0, bag_size: 3268
batch 279, loss: 0.3101, instance_loss: 0.2223, weighted_loss: 0.2838, label: 0, bag_size: 4734
batch 299, loss: 0.4305, instance_loss: 0.4926, weighted_loss: 0.4492, label: 0, bag_size: 1611
batch 319, loss: 0.0666, instance_loss: 0.2510, weighted_loss: 0.1219, label: 2, bag_size: 4132
batch 339, loss: 0.0341, instance_loss: 0.1642, weighted_loss: 0.0731, label: 0, bag_size: 1233
batch 359, loss: 0.0896, instance_loss: 0.1805, weighted_loss: 0.1168, label: 2, bag_size: 3094
batch 379, loss: 0.7095, instance_loss: 0.7074, weighted_loss: 0.7089, label: 1, bag_size: 1122
batch 399, loss: 2.6199, instance_loss: 1.2100, weighted_loss: 2.1969, label: 0, bag_size: 434
batch 419, loss: 0.1846, instance_loss: 0.4479, weighted_loss: 0.2636, label: 2, bag_size: 5017
batch 439, loss: 0.0133, instance_loss: 0.0500, weighted_loss: 0.0243, label: 2, bag_size: 2254
batch 459, loss: 0.0651, instance_loss: 0.2445, weighted_loss: 0.1189, label: 2, bag_size: 3396
batch 479, loss: 0.0305, instance_loss: 0.1637, weighted_loss: 0.0704, label: 1, bag_size: 425
batch 499, loss: 1.6357, instance_loss: 1.4240, weighted_loss: 1.5722, label: 1, bag_size: 3995
batch 519, loss: 1.1171, instance_loss: 0.9648, weighted_loss: 1.0714, label: 2, bag_size: 724
batch 539, loss: 0.0906, instance_loss: 0.3697, weighted_loss: 0.1744, label: 2, bag_size: 4141
batch 559, loss: 1.1693, instance_loss: 0.7787, weighted_loss: 1.0521, label: 0, bag_size: 893
batch 579, loss: 0.0390, instance_loss: 0.1554, weighted_loss: 0.0739, label: 2, bag_size: 4372
batch 599, loss: 0.0577, instance_loss: 0.1959, weighted_loss: 0.0992, label: 0, bag_size: 2487
batch 619, loss: 1.4024, instance_loss: 0.9949, weighted_loss: 1.2802, label: 1, bag_size: 936
batch 639, loss: 0.6674, instance_loss: 0.7213, weighted_loss: 0.6835, label: 1, bag_size: 5412
batch 659, loss: 0.0834, instance_loss: 0.1441, weighted_loss: 0.1016, label: 2, bag_size: 3546
batch 679, loss: 4.9051, instance_loss: 1.5589, weighted_loss: 3.9012, label: 0, bag_size: 35080
batch 699, loss: 0.0269, instance_loss: 0.0930, weighted_loss: 0.0468, label: 2, bag_size: 5138
batch 719, loss: 0.0395, instance_loss: 0.2553, weighted_loss: 0.1043, label: 1, bag_size: 874
batch 739, loss: 1.4482, instance_loss: 1.5138, weighted_loss: 1.4679, label: 1, bag_size: 1558


class 0 clustering acc 0.971420581655481: correct 17369/17880
class 1 clustering acc 0.43104026845637583: correct 2569/5960
Epoch: 32, train_loss: 0.4989, train_clustering_loss:  0.5106, train_error: 0.2188
class 0: acc 0.8091286307053942, correct 195/241
class 1: acc 0.6355555555555555, correct 143/225
class 2: acc 0.8745519713261649, correct 244/279

Val Set, val_loss: 0.9927, val_error: 0.3936, auc: 0.8089
class 0 clustering acc 0.9627659574468085: correct 2172/2256
class 1 clustering acc 0.09308510638297872: correct 70/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.75, correct 9/12
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2884, instance_loss: 0.7372, weighted_loss: 0.4230, label: 0, bag_size: 909
batch 39, loss: 1.0960, instance_loss: 0.7810, weighted_loss: 1.0015, label: 2, bag_size: 4910
batch 59, loss: 0.6219, instance_loss: 0.4746, weighted_loss: 0.5777, label: 0, bag_size: 4865
batch 79, loss: 0.0227, instance_loss: 0.1485, weighted_loss: 0.0604, label: 2, bag_size: 4856
batch 99, loss: 0.0505, instance_loss: 0.5638, weighted_loss: 0.2045, label: 0, bag_size: 1204
batch 119, loss: 1.1253, instance_loss: 1.0211, weighted_loss: 1.0940, label: 1, bag_size: 5880
batch 139, loss: 0.0200, instance_loss: 0.2035, weighted_loss: 0.0751, label: 0, bag_size: 4326
batch 159, loss: 0.8831, instance_loss: 0.7175, weighted_loss: 0.8334, label: 1, bag_size: 5011
batch 179, loss: 0.5889, instance_loss: 0.6065, weighted_loss: 0.5942, label: 1, bag_size: 6817
batch 199, loss: 0.9347, instance_loss: 0.7125, weighted_loss: 0.8681, label: 1, bag_size: 2671
batch 219, loss: 0.0547, instance_loss: 0.2686, weighted_loss: 0.1189, label: 1, bag_size: 425
batch 239, loss: 0.0287, instance_loss: 0.2437, weighted_loss: 0.0932, label: 0, bag_size: 5899
batch 259, loss: 0.1290, instance_loss: 0.5127, weighted_loss: 0.2441, label: 2, bag_size: 2422
batch 279, loss: 0.0458, instance_loss: 0.1196, weighted_loss: 0.0679, label: 1, bag_size: 3761
batch 299, loss: 0.5913, instance_loss: 0.6693, weighted_loss: 0.6147, label: 1, bag_size: 2743
batch 319, loss: 0.0765, instance_loss: 0.3690, weighted_loss: 0.1642, label: 1, bag_size: 3051
batch 339, loss: 0.0005, instance_loss: 0.1506, weighted_loss: 0.0455, label: 1, bag_size: 5018
batch 359, loss: 0.9746, instance_loss: 0.7910, weighted_loss: 0.9195, label: 1, bag_size: 5072
batch 379, loss: 1.1632, instance_loss: 0.6571, weighted_loss: 1.0114, label: 0, bag_size: 4105
batch 399, loss: 0.0945, instance_loss: 0.1856, weighted_loss: 0.1218, label: 0, bag_size: 3530
batch 419, loss: 0.0968, instance_loss: 0.1645, weighted_loss: 0.1171, label: 2, bag_size: 2481
batch 439, loss: 0.8281, instance_loss: 0.7706, weighted_loss: 0.8108, label: 1, bag_size: 667
batch 459, loss: 0.5100, instance_loss: 0.4074, weighted_loss: 0.4792, label: 0, bag_size: 3344
batch 479, loss: 0.2494, instance_loss: 0.4255, weighted_loss: 0.3023, label: 0, bag_size: 3864
batch 499, loss: 0.3203, instance_loss: 0.6154, weighted_loss: 0.4088, label: 2, bag_size: 4291
batch 519, loss: 0.4785, instance_loss: 0.8039, weighted_loss: 0.5761, label: 2, bag_size: 4910
batch 539, loss: 1.3794, instance_loss: 0.9434, weighted_loss: 1.2486, label: 1, bag_size: 3109
batch 559, loss: 2.5922, instance_loss: 1.7285, weighted_loss: 2.3331, label: 1, bag_size: 2425
batch 579, loss: 0.8185, instance_loss: 0.7468, weighted_loss: 0.7970, label: 1, bag_size: 5718
batch 599, loss: 0.0554, instance_loss: 0.1071, weighted_loss: 0.0709, label: 2, bag_size: 2209
batch 619, loss: 0.6820, instance_loss: 0.6452, weighted_loss: 0.6710, label: 0, bag_size: 4220
batch 639, loss: 0.0054, instance_loss: 0.0912, weighted_loss: 0.0312, label: 1, bag_size: 2878
batch 659, loss: 0.0267, instance_loss: 0.2915, weighted_loss: 0.1061, label: 0, bag_size: 4070
batch 679, loss: 0.0408, instance_loss: 0.4923, weighted_loss: 0.1762, label: 0, bag_size: 5053
batch 699, loss: 0.7732, instance_loss: 0.4262, weighted_loss: 0.6691, label: 1, bag_size: 3497
batch 719, loss: 0.0082, instance_loss: 0.0546, weighted_loss: 0.0221, label: 2, bag_size: 3285
batch 739, loss: 2.0572, instance_loss: 0.9880, weighted_loss: 1.7365, label: 2, bag_size: 1513


class 0 clustering acc 0.9690715883668903: correct 17327/17880
class 1 clustering acc 0.38859060402684564: correct 2316/5960
Epoch: 33, train_loss: 0.5279, train_clustering_loss:  0.5394, train_error: 0.2336
class 0: acc 0.7619047619047619, correct 176/231
class 1: acc 0.7061068702290076, correct 185/262
class 2: acc 0.8333333333333334, correct 210/252

Val Set, val_loss: 1.3420, val_error: 0.3404, auc: 0.7398
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.24335106382978725: correct 183/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.4666666666666667, correct 14/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2759, instance_loss: 0.3716, weighted_loss: 0.3046, label: 0, bag_size: 5340
batch 39, loss: 1.0507, instance_loss: 0.9169, weighted_loss: 1.0106, label: 1, bag_size: 5402
batch 59, loss: 0.0906, instance_loss: 0.5830, weighted_loss: 0.2384, label: 0, bag_size: 3701
batch 79, loss: 0.0814, instance_loss: 0.3158, weighted_loss: 0.1517, label: 2, bag_size: 3397
batch 99, loss: 0.8198, instance_loss: 0.4376, weighted_loss: 0.7051, label: 0, bag_size: 3639
batch 119, loss: 0.0170, instance_loss: 0.1576, weighted_loss: 0.0592, label: 0, bag_size: 3901
batch 139, loss: 0.0583, instance_loss: 0.5219, weighted_loss: 0.1974, label: 0, bag_size: 2927
batch 159, loss: 0.5960, instance_loss: 0.8044, weighted_loss: 0.6585, label: 1, bag_size: 2744
batch 179, loss: 0.5440, instance_loss: 0.7332, weighted_loss: 0.6007, label: 2, bag_size: 22464
batch 199, loss: 0.0658, instance_loss: 0.3316, weighted_loss: 0.1455, label: 2, bag_size: 4141
batch 219, loss: 1.2733, instance_loss: 0.7646, weighted_loss: 1.1207, label: 2, bag_size: 5406
batch 239, loss: 1.0231, instance_loss: 1.0027, weighted_loss: 1.0170, label: 0, bag_size: 829
batch 259, loss: 0.2945, instance_loss: 0.7611, weighted_loss: 0.4345, label: 1, bag_size: 3184
batch 279, loss: 0.0220, instance_loss: 0.0968, weighted_loss: 0.0444, label: 0, bag_size: 4196
batch 299, loss: 0.0009, instance_loss: 0.1899, weighted_loss: 0.0576, label: 1, bag_size: 5018
batch 319, loss: 1.6383, instance_loss: 0.8335, weighted_loss: 1.3969, label: 0, bag_size: 13770
batch 339, loss: 0.3969, instance_loss: 0.6805, weighted_loss: 0.4820, label: 1, bag_size: 19265
batch 359, loss: 0.5687, instance_loss: 0.8449, weighted_loss: 0.6516, label: 2, bag_size: 5472
batch 379, loss: 0.7343, instance_loss: 0.5884, weighted_loss: 0.6905, label: 0, bag_size: 4122
batch 399, loss: 0.1248, instance_loss: 0.2081, weighted_loss: 0.1498, label: 0, bag_size: 5036
batch 419, loss: 0.0784, instance_loss: 0.3257, weighted_loss: 0.1526, label: 0, bag_size: 386
batch 439, loss: 0.0133, instance_loss: 0.1069, weighted_loss: 0.0414, label: 0, bag_size: 4783
batch 459, loss: 0.2116, instance_loss: 1.0360, weighted_loss: 0.4589, label: 1, bag_size: 1542
batch 479, loss: 0.2807, instance_loss: 0.7886, weighted_loss: 0.4331, label: 0, bag_size: 3743
batch 499, loss: 0.0548, instance_loss: 0.3903, weighted_loss: 0.1555, label: 0, bag_size: 1744
batch 519, loss: 0.0527, instance_loss: 0.3168, weighted_loss: 0.1319, label: 2, bag_size: 5472
batch 539, loss: 0.5044, instance_loss: 0.4372, weighted_loss: 0.4843, label: 2, bag_size: 2031
batch 559, loss: 0.0804, instance_loss: 0.4601, weighted_loss: 0.1943, label: 0, bag_size: 4337
batch 579, loss: 0.1032, instance_loss: 0.3444, weighted_loss: 0.1756, label: 0, bag_size: 673
batch 599, loss: 1.1143, instance_loss: 0.5213, weighted_loss: 0.9364, label: 2, bag_size: 3112
batch 619, loss: 0.0888, instance_loss: 0.1506, weighted_loss: 0.1074, label: 2, bag_size: 3227
batch 639, loss: 0.3655, instance_loss: 0.6244, weighted_loss: 0.4432, label: 1, bag_size: 9099
batch 659, loss: 0.1329, instance_loss: 0.2023, weighted_loss: 0.1537, label: 2, bag_size: 2049
batch 679, loss: 3.1233, instance_loss: 1.3125, weighted_loss: 2.5801, label: 1, bag_size: 5402
batch 699, loss: 0.0856, instance_loss: 0.2447, weighted_loss: 0.1333, label: 1, bag_size: 4599
batch 719, loss: 0.0042, instance_loss: 0.1566, weighted_loss: 0.0499, label: 0, bag_size: 2853
batch 739, loss: 0.0390, instance_loss: 0.1518, weighted_loss: 0.0729, label: 2, bag_size: 2997


class 0 clustering acc 0.9742170022371365: correct 17419/17880
class 1 clustering acc 0.38540268456375837: correct 2297/5960
Epoch: 34, train_loss: 0.4868, train_clustering_loss:  0.5247, train_error: 0.1987
class 0: acc 0.8, correct 200/250
class 1: acc 0.7272727272727273, correct 184/253
class 2: acc 0.8801652892561983, correct 213/242

Val Set, val_loss: 0.9384, val_error: 0.3617, auc: 0.8120
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.2247340425531915: correct 169/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.1551, instance_loss: 1.2411, weighted_loss: 1.1809, label: 2, bag_size: 4910
batch 39, loss: 0.0329, instance_loss: 0.1579, weighted_loss: 0.0704, label: 0, bag_size: 3986
batch 59, loss: 0.0048, instance_loss: 1.2378, weighted_loss: 0.3747, label: 0, bag_size: 2044
batch 79, loss: 0.4004, instance_loss: 0.6833, weighted_loss: 0.4853, label: 2, bag_size: 1050
batch 99, loss: 0.1770, instance_loss: 0.2810, weighted_loss: 0.2082, label: 2, bag_size: 4372
batch 119, loss: 0.0088, instance_loss: 0.1136, weighted_loss: 0.0402, label: 2, bag_size: 5138
batch 139, loss: 0.9706, instance_loss: 0.5861, weighted_loss: 0.8552, label: 0, bag_size: 5526
batch 159, loss: 0.0944, instance_loss: 0.1355, weighted_loss: 0.1067, label: 0, bag_size: 4734
batch 179, loss: 0.0030, instance_loss: 0.0113, weighted_loss: 0.0055, label: 1, bag_size: 7279
batch 199, loss: 0.5937, instance_loss: 0.6114, weighted_loss: 0.5990, label: 0, bag_size: 4509
batch 219, loss: 0.8405, instance_loss: 0.6096, weighted_loss: 0.7712, label: 1, bag_size: 3050
batch 239, loss: 0.9475, instance_loss: 0.7603, weighted_loss: 0.8914, label: 0, bag_size: 1543
batch 259, loss: 0.3373, instance_loss: 0.5514, weighted_loss: 0.4015, label: 1, bag_size: 3786
batch 279, loss: 1.3795, instance_loss: 0.4371, weighted_loss: 1.0968, label: 2, bag_size: 3227
batch 299, loss: 2.5469, instance_loss: 1.0926, weighted_loss: 2.1106, label: 0, bag_size: 3711
batch 319, loss: 0.3663, instance_loss: 0.3009, weighted_loss: 0.3467, label: 0, bag_size: 4734
batch 339, loss: 0.5350, instance_loss: 0.6407, weighted_loss: 0.5667, label: 0, bag_size: 2830
batch 359, loss: 0.4302, instance_loss: 0.3818, weighted_loss: 0.4157, label: 0, bag_size: 3294
batch 379, loss: 0.1073, instance_loss: 0.3919, weighted_loss: 0.1926, label: 1, bag_size: 3640
batch 399, loss: 0.1534, instance_loss: 0.6085, weighted_loss: 0.2899, label: 1, bag_size: 6689
batch 419, loss: 0.0434, instance_loss: 0.2978, weighted_loss: 0.1197, label: 0, bag_size: 1233
batch 439, loss: 0.0323, instance_loss: 0.2874, weighted_loss: 0.1088, label: 0, bag_size: 3539
batch 459, loss: 0.0000, instance_loss: 1.1257, weighted_loss: 0.3377, label: 0, bag_size: 1709
batch 479, loss: 0.0435, instance_loss: 0.1359, weighted_loss: 0.0712, label: 2, bag_size: 657
batch 499, loss: 0.3479, instance_loss: 0.6328, weighted_loss: 0.4334, label: 2, bag_size: 6594
batch 519, loss: 0.2660, instance_loss: 0.8283, weighted_loss: 0.4347, label: 1, bag_size: 3991
batch 539, loss: 0.0000, instance_loss: 0.5123, weighted_loss: 0.1537, label: 0, bag_size: 2044
batch 559, loss: 0.2733, instance_loss: 0.5206, weighted_loss: 0.3475, label: 1, bag_size: 1595
batch 579, loss: 0.0459, instance_loss: 0.1203, weighted_loss: 0.0683, label: 2, bag_size: 4555
batch 599, loss: 1.2442, instance_loss: 0.9826, weighted_loss: 1.1658, label: 2, bag_size: 4342
batch 619, loss: 0.1099, instance_loss: 0.1736, weighted_loss: 0.1290, label: 2, bag_size: 3210
batch 639, loss: 0.4329, instance_loss: 0.6594, weighted_loss: 0.5008, label: 2, bag_size: 6594
batch 659, loss: 0.1375, instance_loss: 0.2181, weighted_loss: 0.1616, label: 2, bag_size: 3210
batch 679, loss: 0.0425, instance_loss: 0.4654, weighted_loss: 0.1694, label: 0, bag_size: 3648
batch 699, loss: 0.0000, instance_loss: 0.1351, weighted_loss: 0.0405, label: 0, bag_size: 3920
batch 719, loss: 0.1761, instance_loss: 0.3218, weighted_loss: 0.2198, label: 0, bag_size: 1018
batch 739, loss: 1.1587, instance_loss: 0.5547, weighted_loss: 0.9775, label: 1, bag_size: 210


class 0 clustering acc 0.9743288590604027: correct 17421/17880
class 1 clustering acc 0.38104026845637584: correct 2271/5960
Epoch: 35, train_loss: 0.5490, train_clustering_loss:  0.5347, train_error: 0.2322
class 0: acc 0.7651821862348178, correct 189/247
class 1: acc 0.6887966804979253, correct 166/241
class 2: acc 0.8443579766536965, correct 217/257

Val Set, val_loss: 0.9219, val_error: 0.3511, auc: 0.8020
class 0 clustering acc 0.9361702127659575: correct 2112/2256
class 1 clustering acc 0.3949468085106383: correct 297/752
class 0: acc 0.7115384615384616, correct 37/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.5989, instance_loss: 0.7748, weighted_loss: 0.6517, label: 1, bag_size: 2921
batch 39, loss: 0.6166, instance_loss: 0.3024, weighted_loss: 0.5223, label: 2, bag_size: 597
batch 59, loss: 0.0369, instance_loss: 0.2976, weighted_loss: 0.1151, label: 0, bag_size: 2094
batch 79, loss: 0.1051, instance_loss: 0.4032, weighted_loss: 0.1945, label: 1, bag_size: 2870
batch 99, loss: 0.1905, instance_loss: 0.9728, weighted_loss: 0.4252, label: 1, bag_size: 782
batch 119, loss: 2.2212, instance_loss: 1.5640, weighted_loss: 2.0241, label: 1, bag_size: 1964
batch 139, loss: 0.7413, instance_loss: 0.5399, weighted_loss: 0.6809, label: 2, bag_size: 3080
batch 159, loss: 0.0394, instance_loss: 0.3006, weighted_loss: 0.1178, label: 0, bag_size: 3406
batch 179, loss: 0.9822, instance_loss: 0.7496, weighted_loss: 0.9124, label: 1, bag_size: 4812
batch 199, loss: 0.0997, instance_loss: 0.0916, weighted_loss: 0.0973, label: 2, bag_size: 2997
batch 219, loss: 0.6911, instance_loss: 0.4117, weighted_loss: 0.6073, label: 1, bag_size: 3296
batch 239, loss: 0.1018, instance_loss: 0.2500, weighted_loss: 0.1463, label: 2, bag_size: 3397
batch 259, loss: 0.1569, instance_loss: 0.2258, weighted_loss: 0.1776, label: 2, bag_size: 2049
batch 279, loss: 0.4562, instance_loss: 0.4817, weighted_loss: 0.4638, label: 1, bag_size: 700
batch 299, loss: 0.0275, instance_loss: 0.4426, weighted_loss: 0.1521, label: 0, bag_size: 2824
batch 319, loss: 0.0000, instance_loss: 0.8831, weighted_loss: 0.2649, label: 0, bag_size: 2028
batch 339, loss: 0.1015, instance_loss: 0.2705, weighted_loss: 0.1522, label: 2, bag_size: 1543
batch 359, loss: 0.0163, instance_loss: 0.4251, weighted_loss: 0.1389, label: 1, bag_size: 5086
batch 379, loss: 0.2255, instance_loss: 0.4084, weighted_loss: 0.2804, label: 2, bag_size: 4192
batch 399, loss: 0.0582, instance_loss: 0.1839, weighted_loss: 0.0959, label: 2, bag_size: 2905
batch 419, loss: 0.0710, instance_loss: 0.5430, weighted_loss: 0.2126, label: 2, bag_size: 88
batch 439, loss: 0.3122, instance_loss: 0.4264, weighted_loss: 0.3465, label: 2, bag_size: 88
batch 459, loss: 0.1825, instance_loss: 0.6645, weighted_loss: 0.3271, label: 1, bag_size: 4940
batch 479, loss: 0.0125, instance_loss: 0.0544, weighted_loss: 0.0251, label: 0, bag_size: 3348
batch 499, loss: 0.8368, instance_loss: 0.5157, weighted_loss: 0.7405, label: 0, bag_size: 4719
batch 519, loss: 1.0087, instance_loss: 0.9880, weighted_loss: 1.0025, label: 1, bag_size: 4145
batch 539, loss: 0.0585, instance_loss: 0.5737, weighted_loss: 0.2130, label: 1, bag_size: 5195
batch 559, loss: 0.5919, instance_loss: 0.5393, weighted_loss: 0.5761, label: 2, bag_size: 3604
batch 579, loss: 0.2898, instance_loss: 0.5706, weighted_loss: 0.3740, label: 2, bag_size: 724
batch 599, loss: 0.1653, instance_loss: 0.1960, weighted_loss: 0.1745, label: 2, bag_size: 1103
batch 619, loss: 0.8460, instance_loss: 0.7151, weighted_loss: 0.8067, label: 1, bag_size: 2671
batch 639, loss: 1.1315, instance_loss: 0.8851, weighted_loss: 1.0576, label: 1, bag_size: 1860
batch 659, loss: 0.1768, instance_loss: 0.2510, weighted_loss: 0.1991, label: 0, bag_size: 702
batch 679, loss: 0.1345, instance_loss: 0.2483, weighted_loss: 0.1687, label: 0, bag_size: 4827
batch 699, loss: 0.2187, instance_loss: 0.3435, weighted_loss: 0.2562, label: 0, bag_size: 2841
batch 719, loss: 0.0365, instance_loss: 0.2014, weighted_loss: 0.0860, label: 2, bag_size: 4856
batch 739, loss: 0.4305, instance_loss: 0.4867, weighted_loss: 0.4474, label: 0, bag_size: 622


class 0 clustering acc 0.9687360178970917: correct 17321/17880
class 1 clustering acc 0.4063758389261745: correct 2422/5960
Epoch: 36, train_loss: 0.5097, train_clustering_loss:  0.5306, train_error: 0.2081
class 0: acc 0.7923728813559322, correct 187/236
class 1: acc 0.7125984251968503, correct 181/254
class 2: acc 0.8705882352941177, correct 222/255

Val Set, val_loss: 1.0800, val_error: 0.3085, auc: 0.7837
class 0 clustering acc 0.9561170212765957: correct 2157/2256
class 1 clustering acc 0.2898936170212766: correct 218/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.7333333333333333, correct 22/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.2925, instance_loss: 0.2835, weighted_loss: 0.2898, label: 2, bag_size: 4788
batch 39, loss: 1.3618, instance_loss: 0.8746, weighted_loss: 1.2156, label: 1, bag_size: 2642
batch 59, loss: 0.4900, instance_loss: 0.5251, weighted_loss: 0.5005, label: 0, bag_size: 768
batch 79, loss: 0.3527, instance_loss: 0.6693, weighted_loss: 0.4477, label: 2, bag_size: 3607
batch 99, loss: 1.7845, instance_loss: 0.8950, weighted_loss: 1.5176, label: 1, bag_size: 5412
batch 119, loss: 0.3322, instance_loss: 0.7337, weighted_loss: 0.4526, label: 2, bag_size: 2561
batch 139, loss: 0.0717, instance_loss: 0.2246, weighted_loss: 0.1176, label: 2, bag_size: 4555
batch 159, loss: 0.2049, instance_loss: 0.4902, weighted_loss: 0.2905, label: 1, bag_size: 6475
batch 179, loss: 0.3335, instance_loss: 0.5707, weighted_loss: 0.4047, label: 0, bag_size: 4529
batch 199, loss: 1.0728, instance_loss: 0.5291, weighted_loss: 0.9097, label: 0, bag_size: 4647
batch 219, loss: 0.0079, instance_loss: 0.1537, weighted_loss: 0.0516, label: 0, bag_size: 4405
batch 239, loss: 0.0111, instance_loss: 0.1476, weighted_loss: 0.0520, label: 0, bag_size: 3038
batch 259, loss: 0.7120, instance_loss: 0.5640, weighted_loss: 0.6676, label: 1, bag_size: 5572
batch 279, loss: 0.0348, instance_loss: 0.1717, weighted_loss: 0.0759, label: 2, bag_size: 4555
batch 299, loss: 1.4817, instance_loss: 1.0112, weighted_loss: 1.3406, label: 2, bag_size: 3475
batch 319, loss: 0.0559, instance_loss: 0.1485, weighted_loss: 0.0837, label: 2, bag_size: 3174
batch 339, loss: 0.0916, instance_loss: 0.2782, weighted_loss: 0.1475, label: 2, bag_size: 5138
batch 359, loss: 0.1125, instance_loss: 0.4344, weighted_loss: 0.2091, label: 0, bag_size: 2139
batch 379, loss: 0.4682, instance_loss: 0.4999, weighted_loss: 0.4777, label: 0, bag_size: 4734
batch 399, loss: 0.0003, instance_loss: 0.0365, weighted_loss: 0.0112, label: 0, bag_size: 4458
batch 419, loss: 0.2028, instance_loss: 0.1643, weighted_loss: 0.1912, label: 2, bag_size: 3546
batch 439, loss: 0.0054, instance_loss: 0.1691, weighted_loss: 0.0546, label: 2, bag_size: 4497
batch 459, loss: 0.1524, instance_loss: 0.5143, weighted_loss: 0.2610, label: 0, bag_size: 3820
batch 479, loss: 0.1093, instance_loss: 0.2008, weighted_loss: 0.1367, label: 0, bag_size: 3294
batch 499, loss: 0.0050, instance_loss: 0.1617, weighted_loss: 0.0520, label: 2, bag_size: 4497
batch 519, loss: 0.4690, instance_loss: 0.6542, weighted_loss: 0.5246, label: 0, bag_size: 1883
batch 539, loss: 0.3130, instance_loss: 0.3424, weighted_loss: 0.3218, label: 0, bag_size: 5340
batch 559, loss: 0.5743, instance_loss: 0.6974, weighted_loss: 0.6112, label: 1, bag_size: 1854
batch 579, loss: 0.0153, instance_loss: 0.3219, weighted_loss: 0.1073, label: 2, bag_size: 4497
batch 599, loss: 0.0755, instance_loss: 0.2690, weighted_loss: 0.1336, label: 0, bag_size: 873
batch 619, loss: 2.2931, instance_loss: 1.0589, weighted_loss: 1.9228, label: 2, bag_size: 728
batch 639, loss: 0.2316, instance_loss: 0.4461, weighted_loss: 0.2960, label: 1, bag_size: 700
batch 659, loss: 1.8006, instance_loss: 1.1531, weighted_loss: 1.6064, label: 0, bag_size: 19216
batch 679, loss: 0.0666, instance_loss: 0.2570, weighted_loss: 0.1237, label: 0, bag_size: 3070
batch 699, loss: 0.2804, instance_loss: 0.4626, weighted_loss: 0.3350, label: 1, bag_size: 6475
batch 719, loss: 0.9604, instance_loss: 0.4724, weighted_loss: 0.8140, label: 0, bag_size: 3033
batch 739, loss: 0.0054, instance_loss: 0.0341, weighted_loss: 0.0140, label: 2, bag_size: 5138


class 0 clustering acc 0.9718680089485459: correct 17377/17880
class 1 clustering acc 0.4152684563758389: correct 2475/5960
Epoch: 37, train_loss: 0.5009, train_clustering_loss:  0.5092, train_error: 0.2215
class 0: acc 0.8359375, correct 214/256
class 1: acc 0.6266666666666667, correct 141/225
class 2: acc 0.8522727272727273, correct 225/264

Val Set, val_loss: 1.0980, val_error: 0.3723, auc: 0.7874
class 0 clustering acc 0.9574468085106383: correct 2160/2256
class 1 clustering acc 0.17154255319148937: correct 129/752
class 0: acc 0.6923076923076923, correct 36/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 30 out of 20


batch 19, loss: 2.0943, instance_loss: 0.7693, weighted_loss: 1.6968, label: 2, bag_size: 1513
batch 39, loss: 0.4616, instance_loss: 0.7248, weighted_loss: 0.5406, label: 1, bag_size: 1599
batch 59, loss: 0.0319, instance_loss: 0.1604, weighted_loss: 0.0705, label: 2, bag_size: 2209
batch 79, loss: 0.2750, instance_loss: 0.3632, weighted_loss: 0.3015, label: 0, bag_size: 4479
batch 99, loss: 0.0338, instance_loss: 0.1583, weighted_loss: 0.0712, label: 2, bag_size: 4140
batch 119, loss: 0.2031, instance_loss: 0.2595, weighted_loss: 0.2200, label: 1, bag_size: 4253
batch 139, loss: 0.0792, instance_loss: 0.1410, weighted_loss: 0.0978, label: 2, bag_size: 3026
batch 159, loss: 0.7795, instance_loss: 0.4920, weighted_loss: 0.6932, label: 1, bag_size: 3438
batch 179, loss: 0.5156, instance_loss: 0.6070, weighted_loss: 0.5431, label: 2, bag_size: 2813
batch 199, loss: 1.8433, instance_loss: 1.1594, weighted_loss: 1.6381, label: 1, bag_size: 4145
batch 219, loss: 5.7046, instance_loss: 2.0226, weighted_loss: 4.6000, label: 0, bag_size: 3750
batch 239, loss: 0.2106, instance_loss: 0.5864, weighted_loss: 0.3234, label: 1, bag_size: 3221
batch 259, loss: 1.0236, instance_loss: 0.6587, weighted_loss: 0.9141, label: 1, bag_size: 1500
batch 279, loss: 0.2152, instance_loss: 0.5004, weighted_loss: 0.3008, label: 0, bag_size: 5837
batch 299, loss: 0.0414, instance_loss: 0.1293, weighted_loss: 0.0677, label: 2, bag_size: 3112
batch 319, loss: 0.0442, instance_loss: 0.1930, weighted_loss: 0.0889, label: 2, bag_size: 1094
batch 339, loss: 0.0209, instance_loss: 0.1031, weighted_loss: 0.0455, label: 2, bag_size: 2209
batch 359, loss: 0.8251, instance_loss: 0.4950, weighted_loss: 0.7261, label: 0, bag_size: 5484
batch 379, loss: 1.3170, instance_loss: 0.9547, weighted_loss: 1.2083, label: 1, bag_size: 3424
batch 399, loss: 0.0666, instance_loss: 0.3795, weighted_loss: 0.1605, label: 0, bag_size: 2705
batch 419, loss: 0.0682, instance_loss: 0.2590, weighted_loss: 0.1254, label: 2, bag_size: 4056
batch 439, loss: 0.4819, instance_loss: 0.9142, weighted_loss: 0.6116, label: 2, bag_size: 4910
batch 459, loss: 0.0014, instance_loss: 0.0311, weighted_loss: 0.0103, label: 2, bag_size: 4856
batch 479, loss: 0.1602, instance_loss: 0.4628, weighted_loss: 0.2510, label: 2, bag_size: 5017
batch 499, loss: 0.0518, instance_loss: 0.2140, weighted_loss: 0.1004, label: 2, bag_size: 3810
batch 519, loss: 0.5533, instance_loss: 0.6411, weighted_loss: 0.5796, label: 1, bag_size: 5402
batch 539, loss: 0.0339, instance_loss: 0.1583, weighted_loss: 0.0712, label: 2, bag_size: 3396
batch 559, loss: 0.0884, instance_loss: 0.3348, weighted_loss: 0.1623, label: 1, bag_size: 3007
batch 579, loss: 0.0726, instance_loss: 0.3108, weighted_loss: 0.1441, label: 1, bag_size: 209
batch 599, loss: 0.9318, instance_loss: 0.4328, weighted_loss: 0.7821, label: 2, bag_size: 597
batch 619, loss: 2.3301, instance_loss: 1.3069, weighted_loss: 2.0231, label: 0, bag_size: 7504
batch 639, loss: 0.7578, instance_loss: 1.0249, weighted_loss: 0.8379, label: 1, bag_size: 1595
batch 659, loss: 0.0706, instance_loss: 0.3179, weighted_loss: 0.1448, label: 1, bag_size: 1221
batch 679, loss: 1.4786, instance_loss: 0.9357, weighted_loss: 1.3157, label: 0, bag_size: 14791
batch 699, loss: 0.0428, instance_loss: 0.3123, weighted_loss: 0.1236, label: 2, bag_size: 2770
batch 719, loss: 0.0674, instance_loss: 0.5716, weighted_loss: 0.2186, label: 1, bag_size: 3333
batch 739, loss: 1.0483, instance_loss: 1.3793, weighted_loss: 1.1476, label: 0, bag_size: 2501


class 0 clustering acc 0.9713646532438479: correct 17368/17880
class 1 clustering acc 0.3855704697986577: correct 2298/5960
Epoch: 38, train_loss: 0.4994, train_clustering_loss:  0.5260, train_error: 0.2201
class 0: acc 0.788135593220339, correct 186/236
class 1: acc 0.688, correct 172/250
class 2: acc 0.861003861003861, correct 223/259

Val Set, val_loss: 1.1842, val_error: 0.4043, auc: 0.7702
class 0 clustering acc 0.9570035460992907: correct 2159/2256
class 1 clustering acc 0.22340425531914893: correct 168/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.1052, instance_loss: 0.2893, weighted_loss: 0.1604, label: 2, bag_size: 3026
batch 39, loss: 0.0131, instance_loss: 0.1348, weighted_loss: 0.0496, label: 0, bag_size: 5006
batch 59, loss: 1.1084, instance_loss: 0.9727, weighted_loss: 1.0677, label: 2, bag_size: 4179
batch 79, loss: 0.2687, instance_loss: 0.2412, weighted_loss: 0.2605, label: 0, bag_size: 3376
batch 99, loss: 0.2879, instance_loss: 0.2769, weighted_loss: 0.2846, label: 1, bag_size: 3296
batch 119, loss: 0.6256, instance_loss: 0.7902, weighted_loss: 0.6750, label: 2, bag_size: 22464
batch 139, loss: 1.6301, instance_loss: 1.1821, weighted_loss: 1.4957, label: 1, bag_size: 5873
batch 159, loss: 0.2458, instance_loss: 0.4580, weighted_loss: 0.3094, label: 0, bag_size: 3070
batch 179, loss: 0.0431, instance_loss: 0.1968, weighted_loss: 0.0892, label: 2, bag_size: 6704
batch 199, loss: 0.1273, instance_loss: 0.4570, weighted_loss: 0.2262, label: 2, bag_size: 4241
batch 219, loss: 0.0627, instance_loss: 0.1386, weighted_loss: 0.0854, label: 1, bag_size: 712
batch 239, loss: 0.3091, instance_loss: 0.6447, weighted_loss: 0.4098, label: 1, bag_size: 4184
batch 259, loss: 0.3245, instance_loss: 0.1878, weighted_loss: 0.2835, label: 2, bag_size: 2422
batch 279, loss: 0.7776, instance_loss: 0.5699, weighted_loss: 0.7153, label: 0, bag_size: 3690
batch 299, loss: 0.8761, instance_loss: 0.7190, weighted_loss: 0.8289, label: 1, bag_size: 5072
batch 319, loss: 0.9228, instance_loss: 0.9438, weighted_loss: 0.9291, label: 1, bag_size: 1500
batch 339, loss: 0.5554, instance_loss: 0.5934, weighted_loss: 0.5668, label: 0, bag_size: 7315
batch 359, loss: 0.2731, instance_loss: 0.5392, weighted_loss: 0.3529, label: 1, bag_size: 1599
batch 379, loss: 0.0029, instance_loss: 0.3161, weighted_loss: 0.0968, label: 1, bag_size: 5086
batch 399, loss: 1.6221, instance_loss: 1.3219, weighted_loss: 1.5321, label: 0, bag_size: 1808
batch 419, loss: 0.0003, instance_loss: 0.0259, weighted_loss: 0.0080, label: 0, bag_size: 4458
batch 439, loss: 0.2212, instance_loss: 0.4937, weighted_loss: 0.3030, label: 1, bag_size: 3337
batch 459, loss: 1.3760, instance_loss: 1.3660, weighted_loss: 1.3730, label: 1, bag_size: 1307
batch 479, loss: 0.5576, instance_loss: 0.4503, weighted_loss: 0.5254, label: 0, bag_size: 3294
batch 499, loss: 0.3527, instance_loss: 0.7376, weighted_loss: 0.4682, label: 1, bag_size: 1066
batch 519, loss: 0.4503, instance_loss: 0.5626, weighted_loss: 0.4840, label: 0, bag_size: 6971
batch 539, loss: 0.3621, instance_loss: 0.3735, weighted_loss: 0.3655, label: 0, bag_size: 4228
batch 559, loss: 1.1542, instance_loss: 1.0757, weighted_loss: 1.1307, label: 0, bag_size: 1562
batch 579, loss: 0.1800, instance_loss: 0.4735, weighted_loss: 0.2680, label: 2, bag_size: 1050
batch 599, loss: 0.0244, instance_loss: 0.1730, weighted_loss: 0.0690, label: 1, bag_size: 5696
batch 619, loss: 0.2930, instance_loss: 0.2983, weighted_loss: 0.2946, label: 2, bag_size: 3112
batch 639, loss: 0.0119, instance_loss: 0.0795, weighted_loss: 0.0322, label: 2, bag_size: 3094
batch 659, loss: 0.0555, instance_loss: 0.5986, weighted_loss: 0.2184, label: 0, bag_size: 5646
batch 679, loss: 2.4274, instance_loss: 0.7546, weighted_loss: 1.9255, label: 0, bag_size: 3387
batch 699, loss: 1.4092, instance_loss: 0.8708, weighted_loss: 1.2477, label: 2, bag_size: 2501
batch 719, loss: 0.0664, instance_loss: 0.1394, weighted_loss: 0.0883, label: 2, bag_size: 4241
batch 739, loss: 0.0085, instance_loss: 0.1027, weighted_loss: 0.0368, label: 2, bag_size: 5138


class 0 clustering acc 0.9723713646532438: correct 17386/17880
class 1 clustering acc 0.4810402684563758: correct 2867/5960
Epoch: 39, train_loss: 0.4448, train_clustering_loss:  0.4916, train_error: 0.1893
class 0: acc 0.8555133079847909, correct 225/263
class 1: acc 0.6787330316742082, correct 150/221
class 2: acc 0.8773946360153256, correct 229/261

Val Set, val_loss: 1.0024, val_error: 0.3936, auc: 0.8045
class 0 clustering acc 0.9680851063829787: correct 2184/2256
class 1 clustering acc 0.16622340425531915: correct 125/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.4105, instance_loss: 0.7312, weighted_loss: 0.5067, label: 0, bag_size: 673
batch 39, loss: 0.2330, instance_loss: 1.5274, weighted_loss: 0.6213, label: 0, bag_size: 1645
batch 59, loss: 0.0348, instance_loss: 0.1298, weighted_loss: 0.0633, label: 0, bag_size: 4678
batch 79, loss: 0.0006, instance_loss: 0.4835, weighted_loss: 0.1455, label: 0, bag_size: 1055
batch 99, loss: 2.1225, instance_loss: 1.2563, weighted_loss: 1.8626, label: 2, bag_size: 3475
batch 119, loss: 0.1308, instance_loss: 0.1198, weighted_loss: 0.1275, label: 2, bag_size: 614
batch 139, loss: 0.0715, instance_loss: 0.1277, weighted_loss: 0.0884, label: 2, bag_size: 3210
batch 159, loss: 0.0198, instance_loss: 0.2423, weighted_loss: 0.0865, label: 0, bag_size: 966
batch 179, loss: 0.1193, instance_loss: 0.4199, weighted_loss: 0.2095, label: 0, bag_size: 3289
batch 199, loss: 3.7023, instance_loss: 1.7371, weighted_loss: 3.1128, label: 0, bag_size: 18038
batch 219, loss: 0.0253, instance_loss: 0.2341, weighted_loss: 0.0880, label: 0, bag_size: 3986
batch 239, loss: 0.0646, instance_loss: 0.3712, weighted_loss: 0.1566, label: 2, bag_size: 4141
batch 259, loss: 0.4249, instance_loss: 0.5099, weighted_loss: 0.4504, label: 0, bag_size: 4734
batch 279, loss: 0.3215, instance_loss: 0.7879, weighted_loss: 0.4615, label: 1, bag_size: 2342
batch 299, loss: 0.6215, instance_loss: 0.6492, weighted_loss: 0.6298, label: 1, bag_size: 1500
batch 319, loss: 0.6026, instance_loss: 2.4300, weighted_loss: 1.1508, label: 2, bag_size: 2561
batch 339, loss: 0.0135, instance_loss: 0.0355, weighted_loss: 0.0201, label: 1, bag_size: 7135
batch 359, loss: 0.1794, instance_loss: 0.3677, weighted_loss: 0.2359, label: 1, bag_size: 2494
batch 379, loss: 0.0686, instance_loss: 0.1569, weighted_loss: 0.0951, label: 2, bag_size: 3746
batch 399, loss: 0.0231, instance_loss: 0.2030, weighted_loss: 0.0771, label: 0, bag_size: 598
batch 419, loss: 0.0359, instance_loss: 0.1329, weighted_loss: 0.0650, label: 2, bag_size: 3094
batch 439, loss: 0.0068, instance_loss: 0.1021, weighted_loss: 0.0354, label: 2, bag_size: 3285
batch 459, loss: 0.1021, instance_loss: 0.7119, weighted_loss: 0.2850, label: 0, bag_size: 5519
batch 479, loss: 0.3265, instance_loss: 0.3629, weighted_loss: 0.3374, label: 0, bag_size: 2428
batch 499, loss: 0.5655, instance_loss: 0.5872, weighted_loss: 0.5720, label: 2, bag_size: 1543
batch 519, loss: 0.6453, instance_loss: 0.8915, weighted_loss: 0.7192, label: 0, bag_size: 3841
batch 539, loss: 0.1517, instance_loss: 0.5256, weighted_loss: 0.2639, label: 1, bag_size: 1394
batch 559, loss: 0.3717, instance_loss: 0.5764, weighted_loss: 0.4331, label: 1, bag_size: 2919
batch 579, loss: 0.1763, instance_loss: 0.4418, weighted_loss: 0.2560, label: 2, bag_size: 22464
batch 599, loss: 0.0302, instance_loss: 0.4479, weighted_loss: 0.1555, label: 1, bag_size: 3337
batch 619, loss: 0.8450, instance_loss: 0.7489, weighted_loss: 0.8162, label: 0, bag_size: 5848
batch 639, loss: 0.0717, instance_loss: 0.2406, weighted_loss: 0.1224, label: 0, bag_size: 5953
batch 659, loss: 0.5627, instance_loss: 0.6238, weighted_loss: 0.5810, label: 1, bag_size: 2319
batch 679, loss: 1.2497, instance_loss: 0.7714, weighted_loss: 1.1062, label: 1, bag_size: 296
batch 699, loss: 0.4946, instance_loss: 0.8452, weighted_loss: 0.5998, label: 1, bag_size: 4184
batch 719, loss: 0.0635, instance_loss: 0.1246, weighted_loss: 0.0818, label: 2, bag_size: 3210
batch 739, loss: 0.0837, instance_loss: 0.4112, weighted_loss: 0.1819, label: 1, bag_size: 862


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.4323825503355705: correct 2577/5960
Epoch: 40, train_loss: 0.4773, train_clustering_loss:  0.5186, train_error: 0.2000
class 0: acc 0.8237547892720306, correct 215/261
class 1: acc 0.6832579185520362, correct 151/221
class 2: acc 0.8745247148288974, correct 230/263

Val Set, val_loss: 0.8540, val_error: 0.3298, auc: 0.8238
class 0 clustering acc 0.9463652482269503: correct 2135/2256
class 1 clustering acc 0.46675531914893614: correct 351/752
class 0: acc 0.9038461538461539, correct 47/52
class 1: acc 0.3, correct 9/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0371, instance_loss: 0.4881, weighted_loss: 0.1724, label: 0, bag_size: 3872
batch 39, loss: 0.7972, instance_loss: 0.6604, weighted_loss: 0.7561, label: 0, bag_size: 2559
batch 59, loss: 0.7900, instance_loss: 0.6035, weighted_loss: 0.7340, label: 2, bag_size: 6298
batch 79, loss: 0.0024, instance_loss: 0.0559, weighted_loss: 0.0185, label: 2, bag_size: 2483
batch 99, loss: 0.4952, instance_loss: 0.5386, weighted_loss: 0.5083, label: 1, bag_size: 2055
batch 119, loss: 0.4356, instance_loss: 0.3933, weighted_loss: 0.4229, label: 0, bag_size: 3294
batch 139, loss: 0.0767, instance_loss: 0.5817, weighted_loss: 0.2282, label: 1, bag_size: 4027
batch 159, loss: 0.0067, instance_loss: 0.0592, weighted_loss: 0.0224, label: 2, bag_size: 5138
batch 179, loss: 0.0928, instance_loss: 0.2417, weighted_loss: 0.1375, label: 2, bag_size: 3396
batch 199, loss: 0.1427, instance_loss: 0.5154, weighted_loss: 0.2545, label: 0, bag_size: 3904
batch 219, loss: 0.3200, instance_loss: 0.4909, weighted_loss: 0.3713, label: 1, bag_size: 5532
batch 239, loss: 0.1415, instance_loss: 0.6635, weighted_loss: 0.2981, label: 0, bag_size: 3872
batch 259, loss: 0.6530, instance_loss: 0.5825, weighted_loss: 0.6318, label: 0, bag_size: 702
batch 279, loss: 0.0925, instance_loss: 0.4116, weighted_loss: 0.1882, label: 0, bag_size: 420
batch 299, loss: 0.0061, instance_loss: 0.1245, weighted_loss: 0.0416, label: 0, bag_size: 3754
batch 319, loss: 0.0231, instance_loss: 0.1800, weighted_loss: 0.0702, label: 0, bag_size: 5029
batch 339, loss: 0.0001, instance_loss: 0.8288, weighted_loss: 0.2487, label: 0, bag_size: 1106
batch 359, loss: 0.0426, instance_loss: 0.2412, weighted_loss: 0.1022, label: 2, bag_size: 614
batch 379, loss: 0.0924, instance_loss: 0.2038, weighted_loss: 0.1258, label: 2, bag_size: 1103
batch 399, loss: 0.0195, instance_loss: 0.1839, weighted_loss: 0.0688, label: 2, bag_size: 4856
batch 419, loss: 0.8606, instance_loss: 0.6968, weighted_loss: 0.8115, label: 2, bag_size: 5406
batch 439, loss: 0.0387, instance_loss: 0.2960, weighted_loss: 0.1159, label: 0, bag_size: 2853
batch 459, loss: 0.2131, instance_loss: 0.5355, weighted_loss: 0.3098, label: 0, bag_size: 889
batch 479, loss: 0.2581, instance_loss: 0.4504, weighted_loss: 0.3158, label: 1, bag_size: 6475
batch 499, loss: 0.8295, instance_loss: 0.5240, weighted_loss: 0.7379, label: 2, bag_size: 2501
batch 519, loss: 0.0356, instance_loss: 0.1543, weighted_loss: 0.0712, label: 2, bag_size: 4140
batch 539, loss: 0.4244, instance_loss: 0.4614, weighted_loss: 0.4355, label: 0, bag_size: 3834
batch 559, loss: 0.0860, instance_loss: 0.1721, weighted_loss: 0.1119, label: 2, bag_size: 3026
batch 579, loss: 0.0059, instance_loss: 0.0829, weighted_loss: 0.0290, label: 2, bag_size: 4141
batch 599, loss: 0.0428, instance_loss: 0.6385, weighted_loss: 0.2215, label: 1, bag_size: 4027
batch 619, loss: 0.1551, instance_loss: 0.8677, weighted_loss: 0.3689, label: 2, bag_size: 88
batch 639, loss: 2.5527, instance_loss: 1.4336, weighted_loss: 2.2169, label: 1, bag_size: 1964
batch 659, loss: 2.1436, instance_loss: 1.7784, weighted_loss: 2.0341, label: 0, bag_size: 1709
batch 679, loss: 0.0048, instance_loss: 0.0550, weighted_loss: 0.0199, label: 2, bag_size: 4910
batch 699, loss: 1.8579, instance_loss: 0.8665, weighted_loss: 1.5605, label: 0, bag_size: 7056
batch 719, loss: 0.0292, instance_loss: 0.0925, weighted_loss: 0.0482, label: 0, bag_size: 2791
batch 739, loss: 1.5468, instance_loss: 0.7934, weighted_loss: 1.3208, label: 2, bag_size: 5406


class 0 clustering acc 0.9696868008948546: correct 17338/17880
class 1 clustering acc 0.46308724832214765: correct 2760/5960
Epoch: 41, train_loss: 0.4633, train_clustering_loss:  0.4964, train_error: 0.1919
class 0: acc 0.8205128205128205, correct 192/234
class 1: acc 0.6902654867256637, correct 156/226
class 2: acc 0.8912280701754386, correct 254/285

Val Set, val_loss: 0.8277, val_error: 0.3085, auc: 0.8141
class 0 clustering acc 0.9809397163120568: correct 2213/2256
class 1 clustering acc 0.1702127659574468: correct 128/752
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.9860, instance_loss: 0.5239, weighted_loss: 0.8474, label: 2, bag_size: 705
batch 39, loss: 0.3543, instance_loss: 0.4854, weighted_loss: 0.3936, label: 0, bag_size: 2378
batch 59, loss: 0.0001, instance_loss: 0.3045, weighted_loss: 0.0914, label: 0, bag_size: 4083
batch 79, loss: 0.4071, instance_loss: 0.5173, weighted_loss: 0.4402, label: 2, bag_size: 1050
batch 99, loss: 0.2334, instance_loss: 0.8546, weighted_loss: 0.4198, label: 1, bag_size: 3519
batch 119, loss: 0.0411, instance_loss: 0.1829, weighted_loss: 0.0836, label: 0, bag_size: 2545
batch 139, loss: 1.5566, instance_loss: 2.6909, weighted_loss: 1.8969, label: 0, bag_size: 1341
batch 159, loss: 0.0812, instance_loss: 0.2182, weighted_loss: 0.1223, label: 2, bag_size: 5924
batch 179, loss: 0.1034, instance_loss: 0.2813, weighted_loss: 0.1567, label: 0, bag_size: 5831
batch 199, loss: 0.0614, instance_loss: 0.2758, weighted_loss: 0.1258, label: 2, bag_size: 3327
batch 219, loss: 0.3130, instance_loss: 0.5440, weighted_loss: 0.3823, label: 0, bag_size: 3797
batch 239, loss: 0.3619, instance_loss: 0.5255, weighted_loss: 0.4110, label: 1, bag_size: 3437
batch 259, loss: 1.4974, instance_loss: 0.8906, weighted_loss: 1.3153, label: 1, bag_size: 5873
batch 279, loss: 0.6640, instance_loss: 0.6322, weighted_loss: 0.6544, label: 0, bag_size: 5893
batch 299, loss: 0.3057, instance_loss: 0.6636, weighted_loss: 0.4130, label: 2, bag_size: 4910
batch 319, loss: 1.5707, instance_loss: 1.2781, weighted_loss: 1.4829, label: 1, bag_size: 4612
batch 339, loss: 0.4272, instance_loss: 0.4889, weighted_loss: 0.4457, label: 2, bag_size: 5472
batch 359, loss: 0.1163, instance_loss: 0.5415, weighted_loss: 0.2439, label: 1, bag_size: 4373
batch 379, loss: 3.0331, instance_loss: 0.9474, weighted_loss: 2.4074, label: 0, bag_size: 603
batch 399, loss: 0.6810, instance_loss: 0.8114, weighted_loss: 0.7201, label: 1, bag_size: 4684
batch 419, loss: 0.0495, instance_loss: 0.4159, weighted_loss: 0.1594, label: 1, bag_size: 7279
batch 439, loss: 0.0768, instance_loss: 0.2762, weighted_loss: 0.1366, label: 1, bag_size: 5385
batch 459, loss: 0.0838, instance_loss: 0.3858, weighted_loss: 0.1744, label: 0, bag_size: 1174
batch 479, loss: 0.0197, instance_loss: 0.5595, weighted_loss: 0.1817, label: 0, bag_size: 1204
batch 499, loss: 0.0633, instance_loss: 0.1546, weighted_loss: 0.0907, label: 0, bag_size: 1744
batch 519, loss: 0.0225, instance_loss: 0.1280, weighted_loss: 0.0541, label: 2, bag_size: 3583
batch 539, loss: 2.2450, instance_loss: 0.9970, weighted_loss: 1.8706, label: 0, bag_size: 2597
batch 559, loss: 0.0022, instance_loss: 0.1174, weighted_loss: 0.0368, label: 1, bag_size: 259
batch 579, loss: 1.2629, instance_loss: 0.6447, weighted_loss: 1.0775, label: 1, bag_size: 3100
batch 599, loss: 0.0628, instance_loss: 0.3494, weighted_loss: 0.1488, label: 2, bag_size: 4569
batch 619, loss: 0.1996, instance_loss: 0.4996, weighted_loss: 0.2896, label: 1, bag_size: 1197
batch 639, loss: 0.7024, instance_loss: 1.6463, weighted_loss: 0.9856, label: 0, bag_size: 2232
batch 659, loss: 0.0835, instance_loss: 0.3565, weighted_loss: 0.1654, label: 2, bag_size: 4978
batch 679, loss: 0.3081, instance_loss: 0.6867, weighted_loss: 0.4217, label: 0, bag_size: 5840
batch 699, loss: 0.0831, instance_loss: 0.2052, weighted_loss: 0.1198, label: 2, bag_size: 2422
batch 719, loss: 0.3815, instance_loss: 0.4467, weighted_loss: 0.4010, label: 1, bag_size: 596
batch 739, loss: 0.2896, instance_loss: 0.5726, weighted_loss: 0.3745, label: 1, bag_size: 3746


class 0 clustering acc 0.9742170022371365: correct 17419/17880
class 1 clustering acc 0.4006711409395973: correct 2388/5960
Epoch: 42, train_loss: 0.4913, train_clustering_loss:  0.5136, train_error: 0.2148
class 0: acc 0.7695652173913043, correct 177/230
class 1: acc 0.7153846153846154, correct 186/260
class 2: acc 0.8705882352941177, correct 222/255

Val Set, val_loss: 1.3146, val_error: 0.4468, auc: 0.7091
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.16356382978723405: correct 123/752
class 0: acc 0.5384615384615384, correct 28/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.9920, instance_loss: 0.8372, weighted_loss: 0.9456, label: 1, bag_size: 4258
batch 39, loss: 0.0588, instance_loss: 0.2771, weighted_loss: 0.1243, label: 2, bag_size: 4555
batch 59, loss: 0.3314, instance_loss: 0.5682, weighted_loss: 0.4025, label: 2, bag_size: 4291
batch 79, loss: 1.1762, instance_loss: 0.7573, weighted_loss: 1.0506, label: 0, bag_size: 1352
batch 99, loss: 0.0295, instance_loss: 0.2186, weighted_loss: 0.0862, label: 0, bag_size: 6221
batch 119, loss: 0.4233, instance_loss: 0.9393, weighted_loss: 0.5781, label: 2, bag_size: 88
batch 139, loss: 0.2142, instance_loss: 0.5669, weighted_loss: 0.3200, label: 1, bag_size: 4119
batch 159, loss: 0.1382, instance_loss: 0.6078, weighted_loss: 0.2791, label: 1, bag_size: 3460
batch 179, loss: 0.1026, instance_loss: 0.5388, weighted_loss: 0.2335, label: 1, bag_size: 3460
batch 199, loss: 0.0942, instance_loss: 0.3420, weighted_loss: 0.1685, label: 2, bag_size: 4192
batch 219, loss: 0.0239, instance_loss: 0.1890, weighted_loss: 0.0734, label: 0, bag_size: 1845
batch 239, loss: 0.0151, instance_loss: 0.0968, weighted_loss: 0.0396, label: 0, bag_size: 1845
batch 259, loss: 0.4240, instance_loss: 0.3307, weighted_loss: 0.3960, label: 2, bag_size: 3534
batch 279, loss: 1.0794, instance_loss: 0.9331, weighted_loss: 1.0355, label: 1, bag_size: 2744
batch 299, loss: 0.1648, instance_loss: 0.3104, weighted_loss: 0.2085, label: 0, bag_size: 3247
batch 319, loss: 0.0062, instance_loss: 0.1274, weighted_loss: 0.0426, label: 2, bag_size: 5138
batch 339, loss: 0.8261, instance_loss: 0.5594, weighted_loss: 0.7461, label: 0, bag_size: 8866
batch 359, loss: 0.0347, instance_loss: 0.1292, weighted_loss: 0.0630, label: 2, bag_size: 2209
batch 379, loss: 0.0823, instance_loss: 0.2929, weighted_loss: 0.1455, label: 0, bag_size: 1006
batch 399, loss: 0.2583, instance_loss: 0.7074, weighted_loss: 0.3930, label: 1, bag_size: 2302
batch 419, loss: 0.2697, instance_loss: 0.5108, weighted_loss: 0.3420, label: 0, bag_size: 1744
batch 439, loss: 0.0069, instance_loss: 0.2488, weighted_loss: 0.0795, label: 2, bag_size: 88
batch 459, loss: 0.8229, instance_loss: 0.8005, weighted_loss: 0.8162, label: 1, bag_size: 5276
batch 479, loss: 0.6561, instance_loss: 0.6052, weighted_loss: 0.6409, label: 1, bag_size: 1599
batch 499, loss: 0.0035, instance_loss: 0.0241, weighted_loss: 0.0097, label: 2, bag_size: 4203
batch 519, loss: 0.2303, instance_loss: 0.4272, weighted_loss: 0.2894, label: 2, bag_size: 4192
batch 539, loss: 0.0594, instance_loss: 0.3046, weighted_loss: 0.1330, label: 0, bag_size: 4165
batch 559, loss: 2.0286, instance_loss: 0.8846, weighted_loss: 1.6854, label: 2, bag_size: 7607
batch 579, loss: 0.0523, instance_loss: 0.1044, weighted_loss: 0.0679, label: 2, bag_size: 2049
batch 599, loss: 0.0629, instance_loss: 0.3036, weighted_loss: 0.1351, label: 2, bag_size: 3618
batch 619, loss: 0.0670, instance_loss: 0.2438, weighted_loss: 0.1201, label: 1, bag_size: 3425
batch 639, loss: 2.3773, instance_loss: 1.0916, weighted_loss: 1.9916, label: 1, bag_size: 32
batch 659, loss: 0.0475, instance_loss: 0.2364, weighted_loss: 0.1042, label: 1, bag_size: 3221
batch 679, loss: 0.0000, instance_loss: 0.0533, weighted_loss: 0.0160, label: 0, bag_size: 3445
batch 699, loss: 0.0371, instance_loss: 0.2563, weighted_loss: 0.1028, label: 0, bag_size: 4071
batch 719, loss: 0.0848, instance_loss: 0.3033, weighted_loss: 0.1504, label: 0, bag_size: 4827
batch 739, loss: 2.8035, instance_loss: 1.7638, weighted_loss: 2.4916, label: 2, bag_size: 4179


class 0 clustering acc 0.974496644295302: correct 17424/17880
class 1 clustering acc 0.44916107382550335: correct 2677/5960
Epoch: 43, train_loss: 0.4132, train_clustering_loss:  0.4903, train_error: 0.1705
class 0: acc 0.8185483870967742, correct 203/248
class 1: acc 0.7540322580645161, correct 187/248
class 2: acc 0.9156626506024096, correct 228/249

Val Set, val_loss: 1.0385, val_error: 0.3298, auc: 0.7798
class 0 clustering acc 0.9729609929078015: correct 2195/2256
class 1 clustering acc 0.3484042553191489: correct 262/752
class 0: acc 0.7307692307692307, correct 38/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.1628, instance_loss: 0.4724, weighted_loss: 0.2556, label: 1, bag_size: 2122
batch 39, loss: 0.0590, instance_loss: 0.1818, weighted_loss: 0.0958, label: 2, bag_size: 3176
batch 59, loss: 1.0067, instance_loss: 0.8847, weighted_loss: 0.9701, label: 1, bag_size: 3823
batch 79, loss: 0.6665, instance_loss: 0.5139, weighted_loss: 0.6207, label: 0, bag_size: 4378
batch 99, loss: 0.0162, instance_loss: 0.1820, weighted_loss: 0.0660, label: 2, bag_size: 4372
batch 119, loss: 0.0267, instance_loss: 0.5094, weighted_loss: 0.1715, label: 1, bag_size: 4898
batch 139, loss: 0.2286, instance_loss: 0.3463, weighted_loss: 0.2639, label: 0, bag_size: 8611
batch 159, loss: 0.1677, instance_loss: 0.4434, weighted_loss: 0.2504, label: 2, bag_size: 2813
batch 179, loss: 0.0299, instance_loss: 0.2236, weighted_loss: 0.0880, label: 0, bag_size: 3797
batch 199, loss: 0.0219, instance_loss: 0.0845, weighted_loss: 0.0407, label: 2, bag_size: 2997
batch 219, loss: 0.0823, instance_loss: 0.3117, weighted_loss: 0.1511, label: 1, bag_size: 4184
batch 239, loss: 0.2764, instance_loss: 0.4107, weighted_loss: 0.3167, label: 0, bag_size: 6927
batch 259, loss: 0.0374, instance_loss: 0.3435, weighted_loss: 0.1292, label: 1, bag_size: 1221
batch 279, loss: 0.0551, instance_loss: 0.4573, weighted_loss: 0.1758, label: 0, bag_size: 4529
batch 299, loss: 0.0001, instance_loss: 0.1451, weighted_loss: 0.0436, label: 0, bag_size: 3920
batch 319, loss: 0.8863, instance_loss: 1.2740, weighted_loss: 1.0026, label: 1, bag_size: 4258
batch 339, loss: 3.8699, instance_loss: 1.6870, weighted_loss: 3.2150, label: 0, bag_size: 4605
batch 359, loss: 0.8497, instance_loss: 0.6905, weighted_loss: 0.8019, label: 1, bag_size: 5197
batch 379, loss: 0.4156, instance_loss: 0.4854, weighted_loss: 0.4365, label: 2, bag_size: 6298
batch 399, loss: 0.1842, instance_loss: 0.2516, weighted_loss: 0.2044, label: 1, bag_size: 2753
batch 419, loss: 0.1504, instance_loss: 0.3344, weighted_loss: 0.2056, label: 2, bag_size: 4302
batch 439, loss: 0.7751, instance_loss: 0.8673, weighted_loss: 0.8028, label: 1, bag_size: 3508
batch 459, loss: 0.0223, instance_loss: 0.2789, weighted_loss: 0.0993, label: 0, bag_size: 6221
batch 479, loss: 0.4876, instance_loss: 0.6230, weighted_loss: 0.5282, label: 1, bag_size: 782
batch 499, loss: 0.0391, instance_loss: 0.4056, weighted_loss: 0.1491, label: 2, bag_size: 4497
batch 519, loss: 0.0252, instance_loss: 0.7350, weighted_loss: 0.2382, label: 1, bag_size: 6513
batch 539, loss: 0.0023, instance_loss: 0.0590, weighted_loss: 0.0193, label: 2, bag_size: 3497
batch 559, loss: 2.3784, instance_loss: 1.5412, weighted_loss: 2.1273, label: 1, bag_size: 4824
batch 579, loss: 0.0061, instance_loss: 0.2150, weighted_loss: 0.0688, label: 1, bag_size: 5195
batch 599, loss: 0.1390, instance_loss: 0.3724, weighted_loss: 0.2090, label: 2, bag_size: 4162
batch 619, loss: 0.2567, instance_loss: 0.6651, weighted_loss: 0.3792, label: 1, bag_size: 1854
batch 639, loss: 0.1062, instance_loss: 0.5972, weighted_loss: 0.2535, label: 1, bag_size: 1394
batch 659, loss: 0.0838, instance_loss: 0.2013, weighted_loss: 0.1191, label: 0, bag_size: 3586
batch 679, loss: 0.3212, instance_loss: 0.4525, weighted_loss: 0.3606, label: 1, bag_size: 3534
batch 699, loss: 0.0213, instance_loss: 0.1947, weighted_loss: 0.0734, label: 0, bag_size: 4855
batch 719, loss: 1.9034, instance_loss: 0.9734, weighted_loss: 1.6244, label: 0, bag_size: 3155
batch 739, loss: 1.6108, instance_loss: 1.1701, weighted_loss: 1.4786, label: 1, bag_size: 1607


class 0 clustering acc 0.9732662192393736: correct 17402/17880
class 1 clustering acc 0.412751677852349: correct 2460/5960
Epoch: 44, train_loss: 0.4644, train_clustering_loss:  0.5157, train_error: 0.1772
class 0: acc 0.8076923076923077, correct 189/234
class 1: acc 0.7713178294573644, correct 199/258
class 2: acc 0.8893280632411067, correct 225/253

Val Set, val_loss: 0.9818, val_error: 0.2872, auc: 0.8162
class 0 clustering acc 0.9507978723404256: correct 2145/2256
class 1 clustering acc 0.3523936170212766: correct 265/752
class 0: acc 0.9423076923076923, correct 49/52
class 1: acc 0.36666666666666664, correct 11/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0958, instance_loss: 0.4331, weighted_loss: 0.1970, label: 2, bag_size: 4372
batch 39, loss: 0.5597, instance_loss: 0.7135, weighted_loss: 0.6058, label: 1, bag_size: 3786
batch 59, loss: 0.3807, instance_loss: 0.3317, weighted_loss: 0.3660, label: 2, bag_size: 4132
batch 79, loss: 0.6064, instance_loss: 0.7776, weighted_loss: 0.6578, label: 1, bag_size: 1712
batch 99, loss: 0.0160, instance_loss: 0.0660, weighted_loss: 0.0310, label: 2, bag_size: 6001
batch 119, loss: 0.0540, instance_loss: 0.1961, weighted_loss: 0.0966, label: 0, bag_size: 4300
batch 139, loss: 0.0005, instance_loss: 0.3019, weighted_loss: 0.0909, label: 0, bag_size: 2853
batch 159, loss: 1.5940, instance_loss: 1.0370, weighted_loss: 1.4269, label: 1, bag_size: 2831
batch 179, loss: 0.0443, instance_loss: 0.3650, weighted_loss: 0.1405, label: 0, bag_size: 4178
batch 199, loss: 0.3581, instance_loss: 0.5896, weighted_loss: 0.4275, label: 2, bag_size: 1050
batch 219, loss: 0.0766, instance_loss: 0.5190, weighted_loss: 0.2093, label: 1, bag_size: 5003
batch 239, loss: 0.1630, instance_loss: 0.2621, weighted_loss: 0.1928, label: 0, bag_size: 4570
batch 259, loss: 0.4074, instance_loss: 0.6769, weighted_loss: 0.4883, label: 1, bag_size: 4705
batch 279, loss: 0.2900, instance_loss: 0.5828, weighted_loss: 0.3778, label: 1, bag_size: 4395
batch 299, loss: 0.7206, instance_loss: 0.4957, weighted_loss: 0.6531, label: 0, bag_size: 3294
batch 319, loss: 0.0643, instance_loss: 0.3565, weighted_loss: 0.1520, label: 1, bag_size: 800
batch 339, loss: 1.4778, instance_loss: 0.9070, weighted_loss: 1.3066, label: 0, bag_size: 609
batch 359, loss: 0.1268, instance_loss: 0.5409, weighted_loss: 0.2510, label: 1, bag_size: 3127
batch 379, loss: 0.5794, instance_loss: 1.0711, weighted_loss: 0.7269, label: 1, bag_size: 7176
batch 399, loss: 1.3095, instance_loss: 0.8625, weighted_loss: 1.1754, label: 1, bag_size: 3225
batch 419, loss: 0.1187, instance_loss: 0.1405, weighted_loss: 0.1253, label: 2, bag_size: 4788
batch 439, loss: 0.0361, instance_loss: 0.2691, weighted_loss: 0.1060, label: 1, bag_size: 3265
batch 459, loss: 0.0624, instance_loss: 1.1791, weighted_loss: 0.3974, label: 1, bag_size: 5833
batch 479, loss: 0.0129, instance_loss: 0.8560, weighted_loss: 0.2658, label: 1, bag_size: 6513
batch 499, loss: 0.2253, instance_loss: 0.5714, weighted_loss: 0.3291, label: 1, bag_size: 2751
batch 519, loss: 1.1354, instance_loss: 0.8990, weighted_loss: 1.0645, label: 0, bag_size: 3533
batch 539, loss: 0.0070, instance_loss: 0.1470, weighted_loss: 0.0490, label: 2, bag_size: 6148
batch 559, loss: 0.0219, instance_loss: 0.2525, weighted_loss: 0.0911, label: 0, bag_size: 2852
batch 579, loss: 0.9878, instance_loss: 0.9723, weighted_loss: 0.9831, label: 1, bag_size: 1371
batch 599, loss: 0.1509, instance_loss: 0.4260, weighted_loss: 0.2334, label: 2, bag_size: 1050
batch 619, loss: 0.5465, instance_loss: 0.5196, weighted_loss: 0.5384, label: 0, bag_size: 1018
batch 639, loss: 0.6663, instance_loss: 0.4337, weighted_loss: 0.5965, label: 2, bag_size: 3746
batch 659, loss: 0.5626, instance_loss: 0.7791, weighted_loss: 0.6276, label: 0, bag_size: 4227
batch 679, loss: 0.9700, instance_loss: 0.9736, weighted_loss: 0.9711, label: 1, bag_size: 817
batch 699, loss: 0.0423, instance_loss: 0.2847, weighted_loss: 0.1150, label: 1, bag_size: 3333
batch 719, loss: 0.0150, instance_loss: 0.1123, weighted_loss: 0.0442, label: 2, bag_size: 4856
batch 739, loss: 0.0038, instance_loss: 0.2809, weighted_loss: 0.0870, label: 0, bag_size: 1204


class 0 clustering acc 0.9697427293064877: correct 17339/17880
class 1 clustering acc 0.4312080536912752: correct 2570/5960
Epoch: 45, train_loss: 0.4448, train_clustering_loss:  0.5064, train_error: 0.1852
class 0: acc 0.8203125, correct 210/256
class 1: acc 0.7335907335907336, correct 190/259
class 2: acc 0.9, correct 207/230

Val Set, val_loss: 0.9209, val_error: 0.3191, auc: 0.8078
class 0 clustering acc 0.9765070921985816: correct 2203/2256
class 1 clustering acc 0.21675531914893617: correct 163/752
class 0: acc 0.8269230769230769, correct 43/52
class 1: acc 0.5333333333333333, correct 16/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1344, instance_loss: 0.2095, weighted_loss: 0.1569, label: 2, bag_size: 1103
batch 39, loss: 0.0568, instance_loss: 0.2331, weighted_loss: 0.1097, label: 0, bag_size: 1234
batch 59, loss: 0.1298, instance_loss: 0.4015, weighted_loss: 0.2113, label: 0, bag_size: 16741
batch 79, loss: 0.0372, instance_loss: 0.2659, weighted_loss: 0.1058, label: 2, bag_size: 2481
batch 99, loss: 0.0176, instance_loss: 0.2610, weighted_loss: 0.0906, label: 2, bag_size: 6704
batch 119, loss: 0.0606, instance_loss: 0.7510, weighted_loss: 0.2677, label: 2, bag_size: 3604
batch 139, loss: 0.0351, instance_loss: 0.2613, weighted_loss: 0.1029, label: 2, bag_size: 3810
batch 159, loss: 0.2285, instance_loss: 0.6662, weighted_loss: 0.3598, label: 1, bag_size: 4599
batch 179, loss: 0.1766, instance_loss: 0.5340, weighted_loss: 0.2838, label: 2, bag_size: 1050
batch 199, loss: 0.2350, instance_loss: 0.5040, weighted_loss: 0.3157, label: 1, bag_size: 1066
batch 219, loss: 0.8587, instance_loss: 0.7326, weighted_loss: 0.8209, label: 2, bag_size: 728
batch 239, loss: 0.2634, instance_loss: 0.3061, weighted_loss: 0.2762, label: 0, bag_size: 1373
batch 259, loss: 0.3281, instance_loss: 0.6805, weighted_loss: 0.4338, label: 1, bag_size: 1371
batch 279, loss: 0.3865, instance_loss: 0.6808, weighted_loss: 0.4748, label: 1, bag_size: 1607
batch 299, loss: 0.2785, instance_loss: 0.4232, weighted_loss: 0.3219, label: 2, bag_size: 5138
batch 319, loss: 0.0299, instance_loss: 0.1782, weighted_loss: 0.0744, label: 0, bag_size: 4405
batch 339, loss: 0.1550, instance_loss: 0.4604, weighted_loss: 0.2466, label: 0, bag_size: 2677
batch 359, loss: 0.1436, instance_loss: 0.5659, weighted_loss: 0.2703, label: 1, bag_size: 4960
batch 379, loss: 0.4687, instance_loss: 0.4067, weighted_loss: 0.4501, label: 1, bag_size: 1410
batch 399, loss: 0.0299, instance_loss: 0.1168, weighted_loss: 0.0560, label: 2, bag_size: 6273
batch 419, loss: 0.7247, instance_loss: 1.4765, weighted_loss: 0.9502, label: 2, bag_size: 4910
batch 439, loss: 0.0654, instance_loss: 0.2174, weighted_loss: 0.1110, label: 0, bag_size: 3741
batch 459, loss: 0.8824, instance_loss: 0.5573, weighted_loss: 0.7849, label: 2, bag_size: 705
batch 479, loss: 0.0501, instance_loss: 0.2094, weighted_loss: 0.0979, label: 2, bag_size: 4775
batch 499, loss: 0.0617, instance_loss: 0.3401, weighted_loss: 0.1452, label: 0, bag_size: 5282
batch 519, loss: 0.0461, instance_loss: 0.5432, weighted_loss: 0.1952, label: 1, bag_size: 3991
batch 539, loss: 0.0261, instance_loss: 0.3250, weighted_loss: 0.1157, label: 1, bag_size: 455
batch 559, loss: 0.1922, instance_loss: 0.1580, weighted_loss: 0.1820, label: 2, bag_size: 4096
batch 579, loss: 0.8783, instance_loss: 0.8930, weighted_loss: 0.8827, label: 1, bag_size: 3821
batch 599, loss: 0.0564, instance_loss: 0.5689, weighted_loss: 0.2101, label: 2, bag_size: 3810
batch 619, loss: 0.0598, instance_loss: 0.4890, weighted_loss: 0.1885, label: 1, bag_size: 3437
batch 639, loss: 0.1565, instance_loss: 0.5117, weighted_loss: 0.2631, label: 1, bag_size: 1197
batch 659, loss: 4.1448, instance_loss: 2.0325, weighted_loss: 3.5111, label: 1, bag_size: 3159
batch 679, loss: 2.1544, instance_loss: 1.2959, weighted_loss: 1.8969, label: 1, bag_size: 5205
batch 699, loss: 0.0962, instance_loss: 0.2522, weighted_loss: 0.1430, label: 0, bag_size: 2545
batch 719, loss: 0.7541, instance_loss: 0.7082, weighted_loss: 0.7403, label: 2, bag_size: 4342
batch 739, loss: 0.0576, instance_loss: 0.2746, weighted_loss: 0.1227, label: 0, bag_size: 4196


class 0 clustering acc 0.969407158836689: correct 17333/17880
class 1 clustering acc 0.4040268456375839: correct 2408/5960
Epoch: 46, train_loss: 0.4920, train_clustering_loss:  0.5323, train_error: 0.2013
class 0: acc 0.8049792531120332, correct 194/241
class 1: acc 0.7108433734939759, correct 177/249
class 2: acc 0.8784313725490196, correct 224/255

Val Set, val_loss: 1.1046, val_error: 0.4149, auc: 0.7586
class 0 clustering acc 0.975177304964539: correct 2200/2256
class 1 clustering acc 0.14760638297872342: correct 111/752
class 0: acc 0.5961538461538461, correct 31/52
class 1: acc 0.6, correct 18/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.1060, instance_loss: 0.2701, weighted_loss: 0.1552, label: 2, bag_size: 4140
batch 39, loss: 1.0499, instance_loss: 0.5728, weighted_loss: 0.9067, label: 0, bag_size: 3661
batch 59, loss: 0.0314, instance_loss: 0.1321, weighted_loss: 0.0616, label: 0, bag_size: 4325
batch 79, loss: 0.7340, instance_loss: 0.5709, weighted_loss: 0.6850, label: 0, bag_size: 1543
batch 99, loss: 0.0241, instance_loss: 0.2523, weighted_loss: 0.0925, label: 0, bag_size: 3406
batch 119, loss: 0.2886, instance_loss: 0.6509, weighted_loss: 0.3973, label: 1, bag_size: 1042
batch 139, loss: 1.9621, instance_loss: 0.9411, weighted_loss: 1.6558, label: 0, bag_size: 1774
batch 159, loss: 0.0816, instance_loss: 0.3732, weighted_loss: 0.1691, label: 0, bag_size: 7595
batch 179, loss: 0.0062, instance_loss: 0.2226, weighted_loss: 0.0711, label: 0, bag_size: 4744
batch 199, loss: 0.1721, instance_loss: 0.2833, weighted_loss: 0.2054, label: 2, bag_size: 5924
batch 219, loss: 1.4541, instance_loss: 1.0329, weighted_loss: 1.3278, label: 2, bag_size: 2813
batch 239, loss: 0.2244, instance_loss: 0.3482, weighted_loss: 0.2615, label: 0, bag_size: 3885
batch 259, loss: 0.0727, instance_loss: 0.4424, weighted_loss: 0.1836, label: 2, bag_size: 1543
batch 279, loss: 0.0905, instance_loss: 0.3195, weighted_loss: 0.1592, label: 0, bag_size: 5915
batch 299, loss: 1.3562, instance_loss: 0.7452, weighted_loss: 1.1729, label: 1, bag_size: 5873
batch 319, loss: 0.0028, instance_loss: 0.3721, weighted_loss: 0.1136, label: 1, bag_size: 4111
batch 339, loss: 0.3096, instance_loss: 0.4881, weighted_loss: 0.3631, label: 2, bag_size: 6298
batch 359, loss: 0.5138, instance_loss: 0.6268, weighted_loss: 0.5477, label: 1, bag_size: 6165
batch 379, loss: 0.4065, instance_loss: 0.5694, weighted_loss: 0.4554, label: 1, bag_size: 1906
batch 399, loss: 0.5866, instance_loss: 0.7103, weighted_loss: 0.6237, label: 1, bag_size: 3821
batch 419, loss: 0.0753, instance_loss: 0.1515, weighted_loss: 0.0982, label: 0, bag_size: 2791
batch 439, loss: 0.0348, instance_loss: 0.2315, weighted_loss: 0.0938, label: 0, bag_size: 5823
batch 459, loss: 0.0204, instance_loss: 0.0518, weighted_loss: 0.0298, label: 2, bag_size: 4775
batch 479, loss: 1.1457, instance_loss: 0.8013, weighted_loss: 1.0424, label: 1, bag_size: 5412
batch 499, loss: 0.0178, instance_loss: 0.1558, weighted_loss: 0.0592, label: 0, bag_size: 4405
batch 519, loss: 1.0690, instance_loss: 0.8642, weighted_loss: 1.0076, label: 1, bag_size: 7176
batch 539, loss: 0.5226, instance_loss: 0.6181, weighted_loss: 0.5513, label: 1, bag_size: 6942
batch 559, loss: 0.1005, instance_loss: 0.4015, weighted_loss: 0.1908, label: 1, bag_size: 3322
batch 579, loss: 0.0241, instance_loss: 0.4263, weighted_loss: 0.1448, label: 0, bag_size: 3164
batch 599, loss: 0.0360, instance_loss: 0.1466, weighted_loss: 0.0692, label: 0, bag_size: 2479
batch 619, loss: 0.9078, instance_loss: 1.4103, weighted_loss: 1.0586, label: 1, bag_size: 8632
batch 639, loss: 0.0415, instance_loss: 0.2154, weighted_loss: 0.0937, label: 2, bag_size: 3810
batch 659, loss: 0.3487, instance_loss: 0.4152, weighted_loss: 0.3687, label: 0, bag_size: 1762
batch 679, loss: 0.0543, instance_loss: 0.1152, weighted_loss: 0.0726, label: 2, bag_size: 3210
batch 699, loss: 0.0427, instance_loss: 0.3004, weighted_loss: 0.1200, label: 0, bag_size: 4529
batch 719, loss: 0.2470, instance_loss: 0.5374, weighted_loss: 0.3341, label: 1, bag_size: 1197
batch 739, loss: 0.5838, instance_loss: 0.4840, weighted_loss: 0.5539, label: 2, bag_size: 3396


class 0 clustering acc 0.9722595078299776: correct 17384/17880
class 1 clustering acc 0.4063758389261745: correct 2422/5960
Epoch: 47, train_loss: 0.5185, train_clustering_loss:  0.5188, train_error: 0.2161
class 0: acc 0.7955390334572491, correct 214/269
class 1: acc 0.6932773109243697, correct 165/238
class 2: acc 0.8613445378151261, correct 205/238

Val Set, val_loss: 0.9547, val_error: 0.3085, auc: 0.8072
class 0 clustering acc 0.9707446808510638: correct 2190/2256
class 1 clustering acc 0.29521276595744683: correct 222/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.25, correct 3/12
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0645, instance_loss: 0.2745, weighted_loss: 0.1275, label: 2, bag_size: 3026
batch 39, loss: 1.1523, instance_loss: 1.1139, weighted_loss: 1.1408, label: 1, bag_size: 5880
batch 59, loss: 0.8099, instance_loss: 0.8241, weighted_loss: 0.8141, label: 1, bag_size: 2927
batch 79, loss: 0.1324, instance_loss: 0.5365, weighted_loss: 0.2537, label: 1, bag_size: 3493
batch 99, loss: 0.1085, instance_loss: 0.4292, weighted_loss: 0.2047, label: 0, bag_size: 5915
batch 119, loss: 0.0169, instance_loss: 0.2309, weighted_loss: 0.0811, label: 0, bag_size: 4841
batch 139, loss: 2.1778, instance_loss: 0.9117, weighted_loss: 1.7980, label: 0, bag_size: 5098
batch 159, loss: 0.0173, instance_loss: 0.1841, weighted_loss: 0.0673, label: 0, bag_size: 2487
batch 179, loss: 0.5983, instance_loss: 0.6614, weighted_loss: 0.6172, label: 2, bag_size: 4910
batch 199, loss: 0.0287, instance_loss: 0.1805, weighted_loss: 0.0742, label: 2, bag_size: 4056
batch 219, loss: 0.0010, instance_loss: 1.1431, weighted_loss: 0.3436, label: 0, bag_size: 3298
batch 239, loss: 0.0173, instance_loss: 0.2015, weighted_loss: 0.0726, label: 0, bag_size: 3901
batch 259, loss: 0.0144, instance_loss: 0.0726, weighted_loss: 0.0319, label: 2, bag_size: 2313
batch 279, loss: 1.4189, instance_loss: 1.0600, weighted_loss: 1.3112, label: 2, bag_size: 4316
batch 299, loss: 0.1840, instance_loss: 0.4080, weighted_loss: 0.2512, label: 1, bag_size: 3221
batch 319, loss: 0.0015, instance_loss: 0.0290, weighted_loss: 0.0098, label: 1, bag_size: 3677
batch 339, loss: 0.4092, instance_loss: 0.5213, weighted_loss: 0.4428, label: 0, bag_size: 4614
batch 359, loss: 0.3722, instance_loss: 0.4572, weighted_loss: 0.3977, label: 0, bag_size: 4946
batch 379, loss: 0.7191, instance_loss: 0.5551, weighted_loss: 0.6699, label: 0, bag_size: 3661
batch 399, loss: 0.0988, instance_loss: 0.3849, weighted_loss: 0.1846, label: 1, bag_size: 2962
batch 419, loss: 0.0138, instance_loss: 0.2009, weighted_loss: 0.0699, label: 0, bag_size: 4458
batch 439, loss: 0.0000, instance_loss: 0.2184, weighted_loss: 0.0655, label: 1, bag_size: 4181
batch 459, loss: 0.0424, instance_loss: 0.4168, weighted_loss: 0.1547, label: 0, bag_size: 2610
batch 479, loss: 0.0004, instance_loss: 0.4712, weighted_loss: 0.1417, label: 2, bag_size: 3607
batch 499, loss: 0.2854, instance_loss: 0.4162, weighted_loss: 0.3247, label: 2, bag_size: 3080
batch 519, loss: 0.1055, instance_loss: 0.5513, weighted_loss: 0.2393, label: 2, bag_size: 3475
batch 539, loss: 0.0607, instance_loss: 0.4421, weighted_loss: 0.1751, label: 1, bag_size: 1394
batch 559, loss: 0.6094, instance_loss: 0.8103, weighted_loss: 0.6697, label: 1, bag_size: 5402
batch 579, loss: 0.0480, instance_loss: 0.1953, weighted_loss: 0.0922, label: 2, bag_size: 5924
batch 599, loss: 0.4525, instance_loss: 0.5400, weighted_loss: 0.4787, label: 2, bag_size: 5406
batch 619, loss: 0.0151, instance_loss: 0.1038, weighted_loss: 0.0417, label: 1, bag_size: 862
batch 639, loss: 0.0937, instance_loss: 0.3354, weighted_loss: 0.1662, label: 2, bag_size: 3396
batch 659, loss: 0.5328, instance_loss: 0.6342, weighted_loss: 0.5632, label: 1, bag_size: 1528
batch 679, loss: 1.1820, instance_loss: 1.0984, weighted_loss: 1.1569, label: 1, bag_size: 936
batch 699, loss: 0.9963, instance_loss: 0.9656, weighted_loss: 0.9871, label: 1, bag_size: 936
batch 719, loss: 0.0785, instance_loss: 0.1993, weighted_loss: 0.1147, label: 2, bag_size: 614
batch 739, loss: 0.4993, instance_loss: 0.5791, weighted_loss: 0.5232, label: 1, bag_size: 19265


class 0 clustering acc 0.9705257270693513: correct 17353/17880
class 1 clustering acc 0.4140939597315436: correct 2468/5960
Epoch: 48, train_loss: 0.4494, train_clustering_loss:  0.5067, train_error: 0.1732
class 0: acc 0.8365758754863813, correct 215/257
class 1: acc 0.7327935222672065, correct 181/247
class 2: acc 0.9128630705394191, correct 220/241

Val Set, val_loss: 1.1844, val_error: 0.4043, auc: 0.7680
class 0 clustering acc 0.9711879432624113: correct 2191/2256
class 1 clustering acc 0.17287234042553193: correct 130/752
class 0: acc 0.6153846153846154, correct 32/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2565, instance_loss: 0.3183, weighted_loss: 0.2750, label: 2, bag_size: 3026
batch 39, loss: 0.0203, instance_loss: 0.2570, weighted_loss: 0.0913, label: 0, bag_size: 6765
batch 59, loss: 0.1120, instance_loss: 0.2440, weighted_loss: 0.1516, label: 2, bag_size: 3746
batch 79, loss: 0.0023, instance_loss: 0.0504, weighted_loss: 0.0167, label: 2, bag_size: 4910
batch 99, loss: 0.0112, instance_loss: 0.1562, weighted_loss: 0.0547, label: 2, bag_size: 3678
batch 119, loss: 0.0926, instance_loss: 0.6527, weighted_loss: 0.2606, label: 1, bag_size: 5086
batch 139, loss: 0.3596, instance_loss: 0.6033, weighted_loss: 0.4327, label: 1, bag_size: 2302
batch 159, loss: 0.0284, instance_loss: 0.4059, weighted_loss: 0.1416, label: 0, bag_size: 1495
batch 179, loss: 0.3377, instance_loss: 0.5480, weighted_loss: 0.4008, label: 1, bag_size: 3403
batch 199, loss: 0.0267, instance_loss: 0.1681, weighted_loss: 0.0691, label: 2, bag_size: 2481
batch 219, loss: 0.0022, instance_loss: 0.1098, weighted_loss: 0.0345, label: 1, bag_size: 259
batch 239, loss: 0.1871, instance_loss: 0.4257, weighted_loss: 0.2586, label: 2, bag_size: 5017
batch 259, loss: 0.4915, instance_loss: 0.6081, weighted_loss: 0.5265, label: 0, bag_size: 3885
batch 279, loss: 0.4846, instance_loss: 0.6123, weighted_loss: 0.5229, label: 0, bag_size: 13770
batch 299, loss: 0.0342, instance_loss: 0.1650, weighted_loss: 0.0734, label: 2, bag_size: 6704
batch 319, loss: 0.0922, instance_loss: 0.7262, weighted_loss: 0.2824, label: 2, bag_size: 88
batch 339, loss: 1.2347, instance_loss: 1.2054, weighted_loss: 1.2259, label: 1, bag_size: 5072
batch 359, loss: 0.3345, instance_loss: 0.9036, weighted_loss: 0.5052, label: 0, bag_size: 5840
batch 379, loss: 0.6325, instance_loss: 0.5069, weighted_loss: 0.5948, label: 1, bag_size: 2998
batch 399, loss: 0.0035, instance_loss: 0.0745, weighted_loss: 0.0248, label: 2, bag_size: 1094
batch 419, loss: 0.3626, instance_loss: 0.2513, weighted_loss: 0.3292, label: 2, bag_size: 3534
batch 439, loss: 0.8994, instance_loss: 0.9203, weighted_loss: 0.9057, label: 1, bag_size: 2302
batch 459, loss: 0.2649, instance_loss: 0.4783, weighted_loss: 0.3290, label: 1, bag_size: 3127
batch 479, loss: 0.0548, instance_loss: 0.1162, weighted_loss: 0.0732, label: 2, bag_size: 2049
batch 499, loss: 0.2599, instance_loss: 0.4654, weighted_loss: 0.3215, label: 0, bag_size: 1049
batch 519, loss: 0.1063, instance_loss: 0.3161, weighted_loss: 0.1692, label: 2, bag_size: 3210
batch 539, loss: 0.4481, instance_loss: 0.7164, weighted_loss: 0.5286, label: 1, bag_size: 3396
batch 559, loss: 0.3525, instance_loss: 0.6551, weighted_loss: 0.4433, label: 1, bag_size: 6315
batch 579, loss: 0.5465, instance_loss: 0.9172, weighted_loss: 0.6577, label: 2, bag_size: 724
batch 599, loss: 0.1585, instance_loss: 0.2971, weighted_loss: 0.2001, label: 0, bag_size: 6971
batch 619, loss: 0.0014, instance_loss: 0.0365, weighted_loss: 0.0119, label: 2, bag_size: 4856
batch 639, loss: 2.1914, instance_loss: 1.4772, weighted_loss: 1.9771, label: 0, bag_size: 1052
batch 659, loss: 0.1027, instance_loss: 0.3167, weighted_loss: 0.1669, label: 1, bag_size: 3493
batch 679, loss: 0.1236, instance_loss: 0.3820, weighted_loss: 0.2011, label: 0, bag_size: 1174
batch 699, loss: 1.2319, instance_loss: 1.1191, weighted_loss: 1.1981, label: 2, bag_size: 4342
batch 719, loss: 0.2130, instance_loss: 0.2359, weighted_loss: 0.2199, label: 2, bag_size: 4043
batch 739, loss: 2.0018, instance_loss: 1.2869, weighted_loss: 1.7874, label: 0, bag_size: 1774


class 0 clustering acc 0.9653803131991051: correct 17261/17880
class 1 clustering acc 0.41308724832214766: correct 2462/5960
Epoch: 49, train_loss: 0.4715, train_clustering_loss:  0.5276, train_error: 0.1946
class 0: acc 0.7951807228915663, correct 198/249
class 1: acc 0.7683397683397684, correct 199/259
class 2: acc 0.8565400843881856, correct 203/237

Val Set, val_loss: 0.9646, val_error: 0.3191, auc: 0.7925
class 0 clustering acc 0.9756205673758865: correct 2201/2256
class 1 clustering acc 0.2553191489361702: correct 192/752
class 0: acc 0.8076923076923077, correct 42/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0435, instance_loss: 0.2557, weighted_loss: 0.1072, label: 2, bag_size: 3810
batch 39, loss: 0.2424, instance_loss: 0.5752, weighted_loss: 0.3423, label: 0, bag_size: 3752
batch 59, loss: 2.5442, instance_loss: 1.1745, weighted_loss: 2.1333, label: 0, bag_size: 3419
batch 79, loss: 0.0000, instance_loss: 0.0605, weighted_loss: 0.0181, label: 0, bag_size: 4918
batch 99, loss: 0.0788, instance_loss: 0.2093, weighted_loss: 0.1179, label: 2, bag_size: 3026
batch 119, loss: 0.0121, instance_loss: 0.3926, weighted_loss: 0.1262, label: 0, bag_size: 3219
batch 139, loss: 0.0626, instance_loss: 0.2173, weighted_loss: 0.1090, label: 2, bag_size: 4140
batch 159, loss: 0.0034, instance_loss: 0.1172, weighted_loss: 0.0375, label: 2, bag_size: 4910
batch 179, loss: 0.0000, instance_loss: 0.0454, weighted_loss: 0.0136, label: 1, bag_size: 4181
batch 199, loss: 0.0061, instance_loss: 0.1965, weighted_loss: 0.0632, label: 1, bag_size: 1027
batch 219, loss: 0.0323, instance_loss: 1.0259, weighted_loss: 0.3304, label: 2, bag_size: 2561
batch 239, loss: 0.0325, instance_loss: 0.1705, weighted_loss: 0.0739, label: 2, bag_size: 4192
batch 259, loss: 0.0238, instance_loss: 0.2528, weighted_loss: 0.0925, label: 0, bag_size: 1947
batch 279, loss: 0.0128, instance_loss: 0.5860, weighted_loss: 0.1847, label: 0, bag_size: 2069
batch 299, loss: 0.5608, instance_loss: 0.5687, weighted_loss: 0.5632, label: 1, bag_size: 302
batch 319, loss: 0.3379, instance_loss: 0.8750, weighted_loss: 0.4991, label: 1, bag_size: 1604
batch 339, loss: 1.1919, instance_loss: 0.5791, weighted_loss: 1.0081, label: 0, bag_size: 5890
batch 359, loss: 0.1209, instance_loss: 0.2111, weighted_loss: 0.1479, label: 0, bag_size: 4905
batch 379, loss: 0.8864, instance_loss: 0.6994, weighted_loss: 0.8303, label: 2, bag_size: 3534
batch 399, loss: 0.0851, instance_loss: 0.2833, weighted_loss: 0.1446, label: 2, bag_size: 3026
batch 419, loss: 0.0268, instance_loss: 0.1219, weighted_loss: 0.0553, label: 2, bag_size: 2209
batch 439, loss: 0.8458, instance_loss: 0.8074, weighted_loss: 0.8343, label: 1, bag_size: 5011
batch 459, loss: 0.0052, instance_loss: 0.1800, weighted_loss: 0.0577, label: 1, bag_size: 5018
batch 479, loss: 0.2286, instance_loss: 0.3743, weighted_loss: 0.2723, label: 2, bag_size: 4132
batch 499, loss: 0.0647, instance_loss: 0.3107, weighted_loss: 0.1385, label: 2, bag_size: 3397
batch 519, loss: 0.8904, instance_loss: 0.7959, weighted_loss: 0.8620, label: 2, bag_size: 4316
batch 539, loss: 0.1945, instance_loss: 0.5564, weighted_loss: 0.3031, label: 0, bag_size: 909
batch 559, loss: 0.0185, instance_loss: 0.6206, weighted_loss: 0.1991, label: 0, bag_size: 5646
batch 579, loss: 1.4322, instance_loss: 1.1875, weighted_loss: 1.3588, label: 1, bag_size: 1608
batch 599, loss: 0.0003, instance_loss: 1.9557, weighted_loss: 0.5869, label: 0, bag_size: 1341
batch 619, loss: 0.1909, instance_loss: 0.9079, weighted_loss: 0.4060, label: 1, bag_size: 4869
batch 639, loss: 0.0008, instance_loss: 0.0552, weighted_loss: 0.0172, label: 1, bag_size: 2254
batch 659, loss: 0.0231, instance_loss: 0.0810, weighted_loss: 0.0404, label: 0, bag_size: 5782
batch 679, loss: 0.0393, instance_loss: 0.1768, weighted_loss: 0.0806, label: 1, bag_size: 425
batch 699, loss: 0.1993, instance_loss: 0.4733, weighted_loss: 0.2815, label: 1, bag_size: 800
batch 719, loss: 0.0760, instance_loss: 0.4044, weighted_loss: 0.1745, label: 0, bag_size: 5036
batch 739, loss: 0.0278, instance_loss: 0.2292, weighted_loss: 0.0882, label: 1, bag_size: 3983


class 0 clustering acc 0.9723713646532438: correct 17386/17880
class 1 clustering acc 0.4223154362416107: correct 2517/5960
Epoch: 50, train_loss: 0.4044, train_clustering_loss:  0.4986, train_error: 0.1651
class 0: acc 0.8504273504273504, correct 199/234
class 1: acc 0.7859778597785978, correct 213/271
class 2: acc 0.875, correct 210/240

Val Set, val_loss: 1.0308, val_error: 0.4043, auc: 0.7855
class 0 clustering acc 0.9769503546099291: correct 2204/2256
class 1 clustering acc 0.19946808510638298: correct 150/752
class 0: acc 0.6730769230769231, correct 35/52
class 1: acc 0.5, correct 15/30
class 2: acc 0.5, correct 6/12
EarlyStopping counter: 43 out of 20


batch 19, loss: 1.9144, instance_loss: 0.9161, weighted_loss: 1.6150, label: 1, bag_size: 2751
batch 39, loss: 0.0494, instance_loss: 0.2230, weighted_loss: 0.1015, label: 0, bag_size: 1097
batch 59, loss: 1.5302, instance_loss: 0.8242, weighted_loss: 1.3184, label: 2, bag_size: 1513
batch 79, loss: 0.2874, instance_loss: 0.2246, weighted_loss: 0.2686, label: 1, bag_size: 5167
batch 99, loss: 0.4235, instance_loss: 0.5403, weighted_loss: 0.4585, label: 1, bag_size: 1807
batch 119, loss: 0.0221, instance_loss: 0.4026, weighted_loss: 0.1363, label: 1, bag_size: 3221
batch 139, loss: 0.0361, instance_loss: 0.2088, weighted_loss: 0.0880, label: 0, bag_size: 4741
batch 159, loss: 0.0991, instance_loss: 0.1607, weighted_loss: 0.1176, label: 1, bag_size: 3425
batch 179, loss: 0.0202, instance_loss: 0.2360, weighted_loss: 0.0849, label: 0, bag_size: 3901
batch 199, loss: 0.0360, instance_loss: 0.2308, weighted_loss: 0.0945, label: 0, bag_size: 4312
batch 219, loss: 0.2392, instance_loss: 0.5560, weighted_loss: 0.3343, label: 0, bag_size: 2671
batch 239, loss: 0.0132, instance_loss: 0.1142, weighted_loss: 0.0435, label: 0, bag_size: 598
batch 259, loss: 0.0219, instance_loss: 0.2618, weighted_loss: 0.0939, label: 0, bag_size: 477
batch 279, loss: 0.2895, instance_loss: 0.1559, weighted_loss: 0.2494, label: 2, bag_size: 2049
batch 299, loss: 0.3212, instance_loss: 0.7633, weighted_loss: 0.4538, label: 1, bag_size: 6025
batch 319, loss: 0.1192, instance_loss: 0.5011, weighted_loss: 0.2338, label: 2, bag_size: 1050
batch 339, loss: 0.0009, instance_loss: 0.0232, weighted_loss: 0.0076, label: 0, bag_size: 1825
batch 359, loss: 0.0068, instance_loss: 0.3235, weighted_loss: 0.1018, label: 1, bag_size: 3043
batch 379, loss: 0.0722, instance_loss: 0.3326, weighted_loss: 0.1503, label: 2, bag_size: 4291
batch 399, loss: 0.4558, instance_loss: 0.5085, weighted_loss: 0.4716, label: 1, bag_size: 3786
batch 419, loss: 0.0581, instance_loss: 0.1832, weighted_loss: 0.0956, label: 2, bag_size: 5924
batch 439, loss: 2.5930, instance_loss: 2.4643, weighted_loss: 2.5544, label: 0, bag_size: 5125
batch 459, loss: 0.2404, instance_loss: 0.2376, weighted_loss: 0.2395, label: 2, bag_size: 2501
batch 479, loss: 0.8554, instance_loss: 1.0181, weighted_loss: 0.9042, label: 1, bag_size: 1307
batch 499, loss: 0.0721, instance_loss: 0.2637, weighted_loss: 0.1296, label: 0, bag_size: 5902
batch 519, loss: 0.0091, instance_loss: 0.2802, weighted_loss: 0.0904, label: 1, bag_size: 5195
batch 539, loss: 0.9867, instance_loss: 0.2565, weighted_loss: 0.7677, label: 0, bag_size: 5108
batch 559, loss: 0.0432, instance_loss: 0.1075, weighted_loss: 0.0625, label: 0, bag_size: 4405
batch 579, loss: 0.1569, instance_loss: 0.6701, weighted_loss: 0.3108, label: 1, bag_size: 2472
batch 599, loss: 0.1777, instance_loss: 1.0849, weighted_loss: 0.4499, label: 0, bag_size: 5840
batch 619, loss: 0.1525, instance_loss: 0.6071, weighted_loss: 0.2889, label: 0, bag_size: 4227
batch 639, loss: 1.0989, instance_loss: 1.7968, weighted_loss: 1.3083, label: 2, bag_size: 3299
batch 659, loss: 0.5629, instance_loss: 1.0464, weighted_loss: 0.7080, label: 1, bag_size: 3497
batch 679, loss: 0.0296, instance_loss: 0.0775, weighted_loss: 0.0440, label: 2, bag_size: 2997
batch 699, loss: 0.4075, instance_loss: 0.3409, weighted_loss: 0.3875, label: 0, bag_size: 5893
batch 719, loss: 0.3392, instance_loss: 0.3570, weighted_loss: 0.3445, label: 2, bag_size: 597
batch 739, loss: 0.1132, instance_loss: 0.5148, weighted_loss: 0.2337, label: 1, bag_size: 4644


class 0 clustering acc 0.9699664429530201: correct 17343/17880
class 1 clustering acc 0.4677852348993289: correct 2788/5960
Epoch: 51, train_loss: 0.4456, train_clustering_loss:  0.4929, train_error: 0.1718
class 0: acc 0.8560311284046692, correct 220/257
class 1: acc 0.731404958677686, correct 177/242
class 2: acc 0.8943089430894309, correct 220/246

Val Set, val_loss: 0.7951, val_error: 0.2872, auc: 0.8260
class 0 clustering acc 0.9578900709219859: correct 2161/2256
class 1 clustering acc 0.425531914893617: correct 320/752
class 0: acc 0.8653846153846154, correct 45/52
class 1: acc 0.5666666666666667, correct 17/30
class 2: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 44 out of 20
Early stopping
Val error: 0.3404, ROC AUC: 0.7996
Test error: 0.3085, ROC AUC: 0.8449
class 0: acc 0.7692307692307693, correct 40/52
class 1: acc 0.6333333333333333, correct 19/30
class 2: acc 0.5, correct 6/12
finished!
end script
